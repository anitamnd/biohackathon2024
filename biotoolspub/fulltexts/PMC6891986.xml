<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6891986</article-id>
    <article-id pub-id-type="publisher-id">1872</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1872-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Afann: bias adjustment for alignment-free sequence comparison based on sequencing data using neural network regression</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tang</surname>
          <given-names>Kujin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ren</surname>
          <given-names>Jie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8552-043X</contrib-id>
        <name>
          <surname>Sun</surname>
          <given-names>Fengzhu</given-names>
        </name>
        <address>
          <email>fsun@usc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2156 6853</institution-id><institution-id institution-id-type="GRID">grid.42505.36</institution-id><institution>Quantitative and Computational Biology Program, Department of Biological Sciences, </institution><institution>University of Southern California, </institution></institution-wrap>Los Angeles, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>266</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>5</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Alignment-free methods, more time and memory efficient than alignment-based methods, have been widely used for comparing genome sequences or raw sequencing samples without assembly. However, in this study, we show that alignment-free dissimilarity calculated based on sequencing samples can be overestimated compared with the dissimilarity calculated based on their genomes, and this bias can significantly decrease the performance of the alignment-free analysis. Here, we introduce a new alignment-free tool, Alignment-Free methods Adjusted by Neural Network (Afann) that successfully adjusts this bias and achieves excellent performance on various independent datasets. Afann is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/GeniusTang/Afann">https://github.com/GeniusTang/Afann</ext-link>.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Alignment-free</kwd>
      <kwd>Neural network regression</kwd>
      <kwd><italic>k</italic>mer</kwd>
      <kwd>
        <inline-formula id="IEq1">
          <alternatives>
            <tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}, \protect d_{2}^{s}$\end{document}</tex-math>
            <mml:math id="M2">
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>∗</mml:mo>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>,</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:math>
            <inline-graphic xlink:href="13059_2019_1872_Article_IEq1.gif"/>
          </alternatives>
        </inline-formula>
      </kwd>
      <kwd>NGS</kwd>
      <kwd>Bias adjustment</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>With the advent of next-generation sequencing (NGS) technologies, enormous amounts of sequence data are emerging rapidly. Although alignment-based approaches for sequence comparison are generally accurate and powerful, their applications are being challenged by the size of sequence data that increases at an exponential rate. More importantly, the application of alignment-based methods in NGS analysis could also be limited when the sequencing depth is low so that assembled contigs might not share long homologous regions that could be aligned. Throughout the paper, the sequencing depth (fold coverage) is measured by the total number of sequenced bases divided by the genome length. Therefore, alignment-free methods, alternatives over alignment-based methods, have recently received increasing attention because they are generally more memory and time efficient [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]. Moreover, alignment-free methods, especially <italic>k</italic>mer-based approaches that use the frequencies of <italic>k</italic>mers (<italic>k</italic>-words or <italic>k</italic>-grams) for sequence comparison can be naturally adapted to shotgun NGS sequencing data without assembly [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. Recently, Zielezinski et al. [<xref ref-type="bibr" rid="CR9">9</xref>] published a comprehensive comparison over 74 alignment-free methods for 5 research applications including <italic>cis</italic>-regulatory module detection, protein sequence classification, gene tree inference, genome-based phylogeny, and reconstruction of species trees under sequence rearrangements.</p>
    <p>Based on the rationale that similar sequences share similar <italic>k</italic>mer frequency profile, also known as genomic signature [<xref ref-type="bibr" rid="CR13">13</xref>], <italic>k</italic>mer-based alignment-free methods first count the number of occurrences of <italic>k</italic>mers along a sequence or in an NGS sample and characterize each sequence or an NGS sample as a feature vector of length 4<sup><italic>K</italic></sup>. Second, transformation can be applied to normalize the <italic>k</italic>mer count vector or to remove the random background of <italic>k</italic>mer counts using a Markov model [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Alignment-free methods that remove the random background are also known as background-adjusted methods such as <italic>CVTree</italic>[<xref ref-type="bibr" rid="CR1">1</xref>], <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq2.gif"/></alternatives></inline-formula>[<xref ref-type="bibr" rid="CR2">2</xref>], and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq3.gif"/></alternatives></inline-formula>[<xref ref-type="bibr" rid="CR2">2</xref>]. In addition, dissimilarity measures such as Manhattan distance, Euclidean distance, Mash (Jaccard distance) [<xref ref-type="bibr" rid="CR5">5</xref>], and Cosine distance are used to compare any pair of sequence-representing feature vectors.</p>
    <p>Since <italic>k</italic>mer frequency can be counted directly from raw NGS samples, <italic>k</italic>mer-based alignment-free methods can be easily adapted to compare NGS samples without assembly. This adaptation relies on a strong assumption that the sequence-representing feature vectors of NGS samples can be used as alternatives of sequence-representing feature vectors of their genomes, and thus, the alignment-free dissimilarity calculated based on the NGS samples should be close to the dissimilarity calculated based on their genomes. While this assumption is reasonable when sequencing depth is high because of the law of large numbers, it can nevertheless be compromised by low sequencing depth, sequencing error, and sequencing bias. For example, for any alignment-free method, the dissimilarity between a genome and itself should be 0 because their feature vectors should be exactly the same whereas the dissimilarity between two NGS samples sampled from the same genome will be greater than 0 since their feature vectors will be different due to the stochastic distribution of reads along the genomes. Therefore, it is expected that the dissimilarity calculated based on the NGS samples will most likely be overestimated than the dissimilarity calculated based on their genomes, and the overestimation will increase as the sequencing depth decreases, which has also been revealed in several studies based on various alignment-free methods [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. This bias, which refers to the overestimated dissimilarity based on NGS samples, is a common problem for all alignment-free methods since it results from the intrinsic stochastic distribution of short reads regardless of the choice of dissimilarity measures.</p>
    <p>The alignment-free dissimilarity between two NGS samples A and B is determined by three factors which are alignment-free dissimilarity estimated based on their genomes, the bias caused by random sampling of NGS sample A, and the bias caused by random sampling of NGS sample B. Comparing NGS samples without bias adjustment may thus be misguided and be prone to drawing conclusions that are inconsistent with analysis based on their genomes. This can be explained by the fact that the high dissimilarity between two NGS samples does not necessarily imply the high dissimilarity between their genomes. It could also result from the large bias caused by low sequencing depth. Therefore, the relative order of pairwise dissimilarity between NGS samples and dissimilarity between genomes will be different if the sequencing depths of NGS samples are different. For example, suppose genome A is closer to genome B than to genome C based on their complete genomes. All three genomes are sequenced using NGS, and the sequencing depth of genome B is lower than that of genome C. Since the dissimilarity between two genomes using NGS data increases as the sequencing depth decreases, it is possible that the dissimilarity between A and B is higher than that between A and C based on NGS data, resulting in incorrect relationships among the genomes A, B, and C.</p>
    <p>One feasible solution is to downsample all NGS samples to the same number of reads or the same total number of sequenced bases if the lengths of reads are different [<xref ref-type="bibr" rid="CR12">12</xref>]. While biases are not adjusted, they can nevertheless be controlled at the same level after downsampling. As a result, the dissimilarity between NGS samples is affected by the same level of bias, and the relative order of pairwise dissimilarity between NGS samples should be determined only by their genome dissimilarity. However, this method causes a huge waste of reads since all samples will be downsampled to the same sequencing quantity as the smallest sample, and thus, a vast majority of informative reads in other samples will be discarded, which could have been included to improve the performance.</p>
    <p>Another solution is to modify the formula of alignment-free dissimilarity by considering sequencing depth and sequencing error. To the best of our knowledge, AAF [<xref ref-type="bibr" rid="CR4">4</xref>] and Skmer [<xref ref-type="bibr" rid="CR8">8</xref>] are the only existing methods that account for sequencing depth and sequencing error and adjust the alignment-free dissimilarity accordingly. AAF first infers a phylogenetic tree of a group of genomes and then corrects all branch lengths (tip correction) based on the average fold coverage of all NGS samples. However, since samples of high sequencing depth tend to group together as aforementioned, tip correction after phylogeny inference is not capable of correcting the structure of the misleading phylogeny. In addition, AAF corrects every branch length by the same amount, which does not solve the problem caused by samples of different biases. Moreover, this correction depends on the estimation of sequencing depth and sequencing error rate, which complicates the problem. On the other hand, Skmer is able to adjust the bias between any pair of NGS samples differently, but it also requires to estimate sequencing depth and sequencing error rate first and then adjust the formula of Mash (Jaccard distance) [<xref ref-type="bibr" rid="CR5">5</xref>] accordingly. Although this bias adjustment method works for simple dissimilarity measures such as Jaccard distance, adjusting the formula of more complicated background-adjusted methods such as <italic>CVTree</italic>[<xref ref-type="bibr" rid="CR1">1</xref>], <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq4.gif"/></alternatives></inline-formula>[<xref ref-type="bibr" rid="CR2">2</xref>], and <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq5.gif"/></alternatives></inline-formula>[<xref ref-type="bibr" rid="CR2">2</xref>] can be a daunting, if not impossible, task.</p>
    <p>Therefore, a method that can adjust the bias for alignment-free dissimilarity based on NGS samples without downsampling and without introducing new estimations such as sequencing depth or sequencing error rate is necessary. Since background-adjusted dissimilarity measures have been shown to outperform other methods for solving different problems ranging from evolutionary distance estimation [<xref ref-type="bibr" rid="CR14">14</xref>] to virus-host interaction prediction [<xref ref-type="bibr" rid="CR15">15</xref>], geographic location prediction [<xref ref-type="bibr" rid="CR12">12</xref>], horizontal gene transfer detection [<xref ref-type="bibr" rid="CR16">16</xref>], and metagenome and metatranscriptome comparison [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR17">17</xref>], we focused on the bias adjustment for two background-adjusted dissimilarity measures <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq6.gif"/></alternatives></inline-formula> and <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq7.gif"/></alternatives></inline-formula> in this study. Nevertheless, our method can be naturally generalized to adjust the bias for other alignment-free methods.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Alignemt-free methods overestimate distance between NGS samples</title>
      <p>The bias caused by NGS samples can be illustrated by a simplified example in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Figure <xref rid="Fig1" ref-type="fig">1</xref>a shows two fictitious 12-bp genomes that differ by 1 bp (A-T ⇔ G-C), and Fig. <xref rid="Fig1" ref-type="fig">1</xref>b shows two 12-bp genomes that are exactly the same. The dissimilarity measured by any reasonable alignment-free method between two genomes in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b should be 0 and is thus smaller than the dissimilarity between two genomes in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a. However, the dissimilarity between their NGS samples can show opposite results. For example, if the short reads (red arrows) in NGS samples fully cover the two genomes in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a whereas the short reads (blue arrows) only partially cover the two genomes in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, it is clear that the dissimilarity based on the two NGS samples in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b is greater than the dissimilarity based on the two NGS samples in Fig. <xref rid="Fig1" ref-type="fig">1</xref>a. This apparent contradiction can be explained by different biases of NGS samples caused by different sequencing depths.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Bias caused by NGS sampling. <bold>a</bold> Two genomes that differ by only 1 bp, marked in red. Both of their NGS samples (red arrows) perfectly cover their genomes. <bold>b</bold> Two genomes that are exactly the same. Their NGS samples (blue arrows) only partially cover their genomes</p></caption><graphic xlink:href="13059_2019_1872_Fig1_HTML" id="MO1"/></fig></p>
      <p>Although Fig. <xref rid="Fig1" ref-type="fig">1</xref> illustrates this bias by a simplified and extreme example, we used a real dataset of 21 primates from [<xref ref-type="bibr" rid="CR18">18</xref>] and simulated NGS samples to show this bias. In our previous study [<xref ref-type="bibr" rid="CR14">14</xref>], we calculated pairwise <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq9.gif"/></alternatives></inline-formula> using <italic>K</italic>=5 to <italic>K</italic>=14 where <italic>K</italic> is the length of the <italic>k</italic>mer with Markovian order <italic>M</italic>=<italic>K</italic>−2 for the background sequences between these 21 primate genomes and compared them with their pairwise evolutionary distances estimated by alignment-based methods. Our results showed that pairwise <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq11.gif"/></alternatives></inline-formula> with <italic>K</italic>=14 and <italic>M</italic>=12 are highly correlated with their evolutionary distances based on the alignments with Spearman correlation coefficients 0.979 for <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq12.gif"/></alternatives></inline-formula> and 0.970 for <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq13.gif"/></alternatives></inline-formula> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1–S4).</p>
      <p>To study the influence of sequencing depths on <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq15.gif"/></alternatives></inline-formula>, we simulated 8 NGS samples of different numbers of 150-bp Illumina reads (1 M, 3 M, 5 M, 7 M, 9 M, 11 M, 13 M, and 15 M) for each primate genome, corresponding to sequencing depths from 0.05× to 0.75× (see the “<xref rid="Sec13" ref-type="sec">Methods</xref>” section). A total 8×21=168 NGS samples with different sequencing depths were generated and mixed together. We then calculated their pairwise <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq17.gif"/></alternatives></inline-formula> values and compared them with the pairwise <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq19.gif"/></alternatives></inline-formula> calculated based on their complete genomes. The result of <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq20.gif"/></alternatives></inline-formula> using <italic>K</italic>=14 and <italic>M</italic>=12 is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The results of <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq21.gif"/></alternatives></inline-formula> using other <italic>k</italic>mer lengths and Markovian orders are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5. The results of <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq22.gif"/></alternatives></inline-formula> using different <italic>k</italic>mer lengths are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S6–S7. Both <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq23.gif"/></alternatives></inline-formula> and <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M48"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq24.gif"/></alternatives></inline-formula> have been transformed to their corresponding similarity measures where <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s} = 1 - 2 \times d_{2}^{s}$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{*} = 1 - 2 \times d_{2}^{*}$\end{document}</tex-math><mml:math id="M52"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq26.gif"/></alternatives></inline-formula>.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Relationship between pairwise <inline-formula id="IEq27"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M54"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq27.gif"/></alternatives></inline-formula> estimated by primate genomes and NGS samples using <italic>K</italic>=14 and <italic>M</italic>=12 of different numbers of reads without bias adjustment. <italic>X</italic>-axis is the pairwise <inline-formula id="IEq28"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq28.gif"/></alternatives></inline-formula> estimated by genomes, and <italic>Y</italic>-axis is the pairwise <inline-formula id="IEq29"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq29.gif"/></alternatives></inline-formula> estimated based on NGS samples. <bold>a</bold>–<bold>h</bold> Relationship between <inline-formula id="IEq30"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq30.gif"/></alternatives></inline-formula> estimated by primate genomes and <inline-formula id="IEq31"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq31.gif"/></alternatives></inline-formula> estimated based on NGS samples of only 1 M, 3 M, 5 M, 7 M, 9 M, 11 M, 13 M, or 15 M reads, respectively. <bold>i</bold> Pairwise <inline-formula id="IEq32"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq32.gif"/></alternatives></inline-formula> estimated based on mixed NGS samples. NGS samples of different numbers of reads are colored accordingly. “Mix” means two NGS samples have different numbers of reads (e.g., between 1 and 5 M or between 7 and 11 M) and is colored in gray. The root mean squared error (RMSE) and Spearman correlation coefficients (SPC) between pairwise <inline-formula id="IEq33"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq33.gif"/></alternatives></inline-formula> estimated based on NGS samples and genomes are shown on each subplot</p></caption><graphic xlink:href="13059_2019_1872_Fig2_HTML" id="MO2"/></fig></p>
      <p>As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a–h, it is clear that <inline-formula id="IEq34"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M68"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq34.gif"/></alternatives></inline-formula> estimated from NGS samples is lower than <inline-formula id="IEq35"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M70"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq35.gif"/></alternatives></inline-formula> estimated from genomes as all scatter points are below the dashed blue line across the diagonal and the bias, visualized as the gap between the scatter points and the diagonal, decreases when the sequencing depth increases. In addition, Fig. <xref rid="Fig2" ref-type="fig">2</xref>a–h clearly illustrate that <inline-formula id="IEq36"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M72"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq36.gif"/></alternatives></inline-formula> calculated based on NGS strongly correlates with <inline-formula id="IEq37"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M74"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq37.gif"/></alternatives></inline-formula> calculated based on the whole genomes if all samples have the same sequencing depth even when the sequencing depth is as low as 0.05× (1 M). The Spearman correlation coefficients between <inline-formula id="IEq38"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M76"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq38.gif"/></alternatives></inline-formula> based on NGS samples of 1 M reads and <inline-formula id="IEq39"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq39.gif"/></alternatives></inline-formula> based on genomes is as high as 0.969. However, if not all samples have the same sequencing depth, the Spearman correlation coefficient dropped significantly even when we analyzed more number of reads in total, supported by comparing Figs. <xref rid="Fig2" ref-type="fig">2</xref>a and i. In Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, all samples have only 1 M reads whereas in Fig. <xref rid="Fig2" ref-type="fig">2</xref>i, each sample has a different number of reads ranging from 1 to 15 M. The most likely reason is that if <inline-formula id="IEq40"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M80"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq40.gif"/></alternatives></inline-formula> calculated between two NGS samples A and B of 15 M reads (Fig. <xref rid="Fig1" ref-type="fig">1</xref>h) is greater than <inline-formula id="IEq41"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M82"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq41.gif"/></alternatives></inline-formula> calculated between two NGS samples C and D of 1 M reads (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), it does not necessarily mean the genome <inline-formula id="IEq42"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M84"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq42.gif"/></alternatives></inline-formula> between A and B is greater than that between C and D. The reason is that samples of 15 M reads have smaller bias than samples of 1 M reads and thereby <inline-formula id="IEq43"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq43.gif"/></alternatives></inline-formula> calculated from samples of 15 M reads will be generally greater than samples of 1 M reads regardless of their genome <inline-formula id="IEq44"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M88"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq44.gif"/></alternatives></inline-formula>. This observation supports our argument that bias caused by different sequencing depths markedly decrease the performance of alignment-free analysis based on NGS sequencing data. The same observation can be made for <inline-formula id="IEq45"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M90"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq45.gif"/></alternatives></inline-formula> using different <italic>k</italic>mer lengths (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5) and for <inline-formula id="IEq46"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq46.gif"/></alternatives></inline-formula> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S6–S7). A more detailed results of the “Mix” label in Fig. <xref rid="Fig2" ref-type="fig">2</xref>i was reported in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8a in which “Mix” was divided into more specific labels such as “1 M and 5 M”, “1 M and 15 M,” and “5 M and 15 M.”</p>
      <p>To show that this bias is a common problem for all alignment-free methods, we did the same analysis for another state-of-the-art alignment-free method Mash [<xref ref-type="bibr" rid="CR5">5</xref>] which is based on Jaccard distance. We first calculated pairwise Mash distances based on 21 primate genomes using <italic>K</italic>=14 (the same <italic>k</italic>mer length as we used for <inline-formula id="IEq47"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M94"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq47.gif"/></alternatives></inline-formula> and <inline-formula id="IEq48"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M96"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq48.gif"/></alternatives></inline-formula>), <italic>K</italic>=21 (default <italic>k</italic>mer length for Mash), <italic>K</italic>=31 (maximum <italic>k</italic>mer length allowed by Mash), and sketch sizes <italic>s</italic>=10<sup>3</sup>,<italic>s</italic>=10<sup>5</sup>, and <italic>s</italic>=10<sup>7</sup> and compared them with the pairwise evolutionary distances estimated by alignment-based methods. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9 shows that the pairwise Mash distances and the evolutionary distances have the highest Spearman correlation coefficient of 0.984 when using <italic>K</italic>=21 and <italic>s</italic>=10<sup>7</sup>.</p>
      <p>We then chose the <italic>k</italic>mer length <italic>K</italic>=21 and sketch size <italic>s</italic>=10<sup>7</sup> and compared Mash distances estimated from primate genomes and Mash distances estimated from primate NGS samples. The results are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10, and Mash distance has been transformed to the corresponding Mash similarity that equals to 1 - Mash distance. Similar to <inline-formula id="IEq49"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{*}$\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq49.gif"/></alternatives></inline-formula> and <inline-formula id="IEq50"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M100"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq50.gif"/></alternatives></inline-formula>, Mash similarity estimated from NGS samples is also lower than Mash similarity estimated from genomes, and this bias increases as the sequencing depth decreases as shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10a–h. As a consequence, the Spearman correlation coefficient (0.860) between Mash similarity based on genomes and Mash similarity based on NGS samples of 1 M to 15 M reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10i) is even lower than the corresponding Spearman correlation coefficient (0.943) based on NGS samples of only 1 M reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10a).</p>
      <p>As aforementioned, one solution is to downsample all NGS samples to have the same number of reads as the smallest sample, which is 1 M reads in this example, as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a. This method does not adjust the bias of <inline-formula id="IEq51"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq51.gif"/></alternatives></inline-formula> calculated based on NGS samples, but it controls that all samples have similar biases. The performance after downsampling is acceptable with Spearman correlation coefficient 0.969 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) and is better than the performance without bias adjustment or downsampling (Fig. <xref rid="Fig2" ref-type="fig">2</xref>i). However, the vast majority of reads are discarded by downsampling, and thereby, much information is lost. For instance, in order to downsample a sample of 15 M reads to 1 M reads, we need to discard 93.3% of the reads in this sample.</p>
    </sec>
    <sec id="Sec4">
      <title>Bias adjustment by a neural network regression model</title>
      <p>We characterize the bias adjustment process as a regression problem that predicts the dissimilarity based on genomes from the dissimilarity based on NGS samples and their biases. It can be clearly seen in Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S8a and S10 that the alignment-free dissimilarity between any pair of NGS samples <italic>d</italic>(<italic>A</italic><sub>NGS</sub>,<italic>B</italic><sub>NGS</sub>) is determined by the alignment-free dissimilarity based on their genomes <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) and the bias caused by each NGS sample Bias(<italic>A</italic><sub>NGS</sub>) and Bias(<italic>B</italic><sub>NGS</sub>):
<disp-formula id="Equa"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ d(A_{\text{NGS}}, B_{\text{NGS}}) = F(d(A_{G}, B_{G}), \text{Bias}(A_{\text{NGS}}), \text{Bias}(B_{\text{NGS}})) $$ \end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mspace width="-14.0pt"/><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext>Bias</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext>Bias</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2019_1872_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> In other words, if we know the function <italic>F</italic>, alignment-free dissimilarity between a pair of NGS samples, and their corresponding biases, then the alignment-free dissimilarity based on their genomes which is not biased by the sequencing depths in NGS samples can be predicted. Although it is hard to infer a closed-form formula for function <italic>F</italic> for background-adjusted methods such as <italic>CVTree</italic>[<xref ref-type="bibr" rid="CR1">1</xref>], <inline-formula id="IEq52"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M106"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq52.gif"/></alternatives></inline-formula>[<xref ref-type="bibr" rid="CR2">2</xref>], and <inline-formula id="IEq53"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M108"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq53.gif"/></alternatives></inline-formula>[<xref ref-type="bibr" rid="CR2">2</xref>], a neural network regression model can be trained to approximate it, see the “<xref rid="Sec13" ref-type="sec">Methods</xref>” section for more details about the definition of Bias(<italic>A</italic><sub>NGS</sub>),Bias(<italic>B</italic><sub>NGS</sub>), and model training and evaluation.</p>
    </sec>
    <sec id="Sec5">
      <title>The correlation between the adjusted dissimilarity measures based on NGS samples and genomes of 21 primates is markedly increased</title>
      <p>Two neural network regression models were trained using the 21 primate dataset for <inline-formula id="IEq54"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M110"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq54.gif"/></alternatives></inline-formula> and <inline-formula id="IEq55"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M112"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq55.gif"/></alternatives></inline-formula> separately and used to adjust the bias of primate NGS samples (see the “<xref rid="Sec13" ref-type="sec">Methods</xref>” section). Using the resulting neural network model, we adjusted the pairwise <inline-formula id="IEq56"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M114"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq56.gif"/></alternatives></inline-formula> and <inline-formula id="IEq57"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M116"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq57.gif"/></alternatives></inline-formula> dissimilarity measures described in the above section. We then calculated the Spearman correlation between the adjusted dissimilarity measures with the corresponding values using the whole genomes. The correlations between adjusted <inline-formula id="IEq58"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M118"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq58.gif"/></alternatives></inline-formula> (adjusted <inline-formula id="IEq59"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M120"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq59.gif"/></alternatives></inline-formula>) and their genome <inline-formula id="IEq60"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq60.gif"/></alternatives></inline-formula> (<inline-formula id="IEq61"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M124"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq61.gif"/></alternatives></inline-formula>) were calculated, and the results of <inline-formula id="IEq62"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M126"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq62.gif"/></alternatives></inline-formula> using <italic>K</italic>=14 and <italic>M</italic>=12 were transformed to <inline-formula id="IEq63"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq63.gif"/></alternatives></inline-formula> and shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8b in which “Mix” was divided into more specific labels such as “1 M and 5 M.” The results of bias adjustment for <inline-formula id="IEq64"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M130"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq64.gif"/></alternatives></inline-formula> using other <italic>k</italic>mer lengths and Markovian orders were shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11. The results of bias adjustment for <inline-formula id="IEq65"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M132"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq65.gif"/></alternatives></inline-formula> using different <italic>k</italic>mer lengths were transformed to <inline-formula id="IEq66"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{*}$\end{document}</tex-math><mml:math id="M134"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq66.gif"/></alternatives></inline-formula> and shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S12–S13. By comparing Figs. <xref rid="Fig2" ref-type="fig">2</xref> and <xref rid="Fig3" ref-type="fig">3</xref>, we can conclude that our model successfully adjusted the bias between NGS <inline-formula id="IEq67"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M136"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq67.gif"/></alternatives></inline-formula> and genome <inline-formula id="IEq68"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M138"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq68.gif"/></alternatives></inline-formula>, supported by the observation that most scatter points fall on the diagonal in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. In addition, the root mean squared error was decreased, and the Spearman correlation coefficient was increased after bias adjustment. More importantly, Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S8 and S11–13 revealed that our bias adjustment method works for both <inline-formula id="IEq69"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M140"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M142"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq70.gif"/></alternatives></inline-formula>, regardless of the chosen <italic>k</italic>mer length, Markovian order, or sequencing depth. It should be noticed that our bias adjustment model is capable of increasing the Spearman correlation coefficients even when all samples have the same number of reads by comparing Fig. <xref rid="Fig3" ref-type="fig">3</xref>a–h to the corresponding Fig. <xref rid="Fig2" ref-type="fig">2</xref>a–h. A possible explanation could be that the same number of reads cannot guarantee the same sequencing depth if genome lengths are different. Moreover, the bias might also be caused by other factors such as sequencing errors and sequencing bias that cannot be controlled by downsampling. Therefore, we suggest always using our model to adjust the bias in the alignment-free analysis based on NGS sequencing data even when each sample has a similar number of reads to achieve better performance.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Relationship between pairwise <inline-formula id="IEq71"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M144"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq71.gif"/></alternatives></inline-formula> estimated by primate genomes and NGS samples using <italic>K</italic>=14 and <italic>M</italic>=12 of different numbers of reads with bias adjustment. X-axis is the pairwise <inline-formula id="IEq72"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M146"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq72.gif"/></alternatives></inline-formula> estimated by genomes and Y-axis is the pairwise <inline-formula id="IEq73"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M148"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq73.gif"/></alternatives></inline-formula> estimated based on NGS samples after bias adjustment. <bold>a</bold>–<bold>h</bold> show the relationship between <inline-formula id="IEq74"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M150"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq74.gif"/></alternatives></inline-formula> estimated by primate genomes and adjusted <inline-formula id="IEq75"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M152"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq75.gif"/></alternatives></inline-formula> based on NGS samples of only 1 M, 3M, 5 M, 7M, 9 M, 11 M, 13 M or 15 M reads, respectively. <bold>i</bold> shows pairwise adjusted <inline-formula id="IEq76"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M154"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq76.gif"/></alternatives></inline-formula> based on mixed NGS samples. NGS samples of different numbers of reads are colored accordingly. ‘Mix’ means two NGS samples have different numbers of reads (e.g., between 1 M and 5 M or between 7 M and 11 M) and is colored in gray. The root mean squared error (RMSE) and Spearman correlation coefficients (SPC) between pairwise <inline-formula id="IEq77"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M156"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq77.gif"/></alternatives></inline-formula> estimated based on NGS samples and genomes are shown on each subplot</p></caption><graphic xlink:href="13059_2019_1872_Fig3_HTML" id="MO3"/></fig></p>
      <p>We also evaluated the performance of Skmer [<xref ref-type="bibr" rid="CR8">8</xref>] on the same primate dataset using <italic>k</italic>mer length <italic>K</italic>=21 and sketch size <italic>s</italic>=10<sup>7</sup>, which is a recent alignment-free method that corrects the formula of Mash distance based on NGS samples by estimating the sequencing depth and sequencing error rate. The relationship between the Skemr distances using the whole genomes and the Skmer distances using the NGS samples are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14, and Skmer distance has been transformed to the corresponding Skmer similarity that equals to 1 - Skmer distance. By comparing Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10a–h to the corresponding Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14a–h, we can see that Skmer adjusted Mash similarity by increasing its value estimated from NGS samples to compensate for the low sequencing depths and sequencing errors as more points fall on diagonals in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14. However, Skmer decreased the Spearman correlation coefficients, especially when NGS samples have different sequencing depths by comparing the coefficient of Mash (0.860) in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10i and the coefficient of Skmer (0.766) in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14i. A possible explanation could be that the formula that Skmer used in [<xref ref-type="bibr" rid="CR8">8</xref>] to correct Mash distance by estimating sequencing depth and sequencing error rate is not accurate when two NGS samples have different sequencing depths. As a comparison, Fig. <xref rid="Fig3" ref-type="fig">3</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S10 and S12 demonstrated that adjusted <inline-formula id="IEq78"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M158"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq78.gif"/></alternatives></inline-formula> and <inline-formula id="IEq79"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M160"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq79.gif"/></alternatives></inline-formula> outperform Mash and Skmer in all circumstances, especially when the sequencing depth is low (&lt; 9 M reads) or samples have different sequencing depths.</p>
    </sec>
    <sec id="Sec6">
      <title>The correlation between the adjusted dissimilarity measures based on NGS samples and genomes of 28 mammals is markedly increased</title>
      <p>We tested our model for <inline-formula id="IEq80"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M162"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq80.gif"/></alternatives></inline-formula> bias adjustment on an independent dataset of 28 mammals from [<xref ref-type="bibr" rid="CR19">19</xref>]. In our previous study [<xref ref-type="bibr" rid="CR14">14</xref>], we have calculated pairwise <inline-formula id="IEq81"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M164"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq81.gif"/></alternatives></inline-formula> using <italic>K</italic>=14 and <italic>M</italic>=12 between these 28 mammalian genomes and showed that their pairwise <inline-formula id="IEq82"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M166"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq82.gif"/></alternatives></inline-formula> are highly correlated with their pairwise evolutionary distances estimated by alignment-based methods with Spearman correlation coefficient of 0.927, and the result is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S15. We simulated 3 NGS samples of different numbers of 150-bp Illumina reads (1 M, 5 M, and 15 M) for each mammalian genome, corresponding to sequencing depths from 0.05× to 0.75×, resulting in a total of 28×3=84 samples (see the “<xref rid="Sec13" ref-type="sec">Methods</xref>” section). We then calculated pairwise <inline-formula id="IEq83"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M168"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq83.gif"/></alternatives></inline-formula> between all 84 NGS samples, adjusted them using our neural network model and then compared them with the pairwise <inline-formula id="IEq84"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M170"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq84.gif"/></alternatives></inline-formula> calculated from their complete genomes. The result was transformed to <inline-formula id="IEq85"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M172"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq85.gif"/></alternatives></inline-formula> and shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. It can be clearly seen in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a that pairwise NGS <inline-formula id="IEq86"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M174"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq86.gif"/></alternatives></inline-formula> was overestimated before adjustment since all scatter points were below the diagonal whereas most scatter points after bias adjustment in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b fall on the diagonal, which proved that our model has successfully adjusted the bias of <inline-formula id="IEq87"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M176"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq87.gif"/></alternatives></inline-formula>. In addition, the root mean squared error was decreased, and the Spearman correlation coefficient was increased after bias adjustment.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Relationship between pairwise <inline-formula id="IEq88"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M178"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq88.gif"/></alternatives></inline-formula> estimated using <italic>K</italic>=14 and <italic>M</italic>=12 based on 28 mammalian genomes and NGS samples of different numbers of reads. <bold>a</bold> shows the relationship before bias adjustment. <bold>b</bold> shows the relationship after bias adjustment for NGS <inline-formula id="IEq89"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M180"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq89.gif"/></alternatives></inline-formula>. The root mean squared error (RMSE) was decreased and the Spearman correlation coeffient (SPC) between pairwise genome <inline-formula id="IEq90"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M182"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq90.gif"/></alternatives></inline-formula> and NGS <inline-formula id="IEq91"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M184"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq91.gif"/></alternatives></inline-formula> was increased after bias adjustment</p></caption><graphic xlink:href="13059_2019_1872_Fig4_HTML" id="MO4"/></fig></p>
      <p>We next tested the performance of Mash and Skmer on the same mammalian dataset. We first calculated pairwise Mash distances based on the 28 mammalian genomes using <italic>K</italic>=14,<italic>K</italic>=21, and <italic>K</italic>=31 and sketch size <italic>s</italic>=10<sup>3</sup>,<italic>s</italic>=10<sup>5</sup>, and <italic>s</italic>=10<sup>7</sup> and compared them with the pairwise evolutionary distances estimated by alignment-based methods. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S16 shows that pairwise Mash distances and the evolutionary distances have the highest Spearman correlation coefficient of 0.943 when using <italic>K</italic>=31 and <italic>s</italic>=10<sup>7</sup>. We then chose <italic>k</italic>mer length <italic>K</italic>=31 and sketch size <italic>s</italic>=10<sup>7</sup> and compared Mash distance and Skmer distance estimated from mammalian genomes and estimated from NGS samples. The results are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S17. The Spearman correlation coefficient (0.967) between adjusted <inline-formula id="IEq92"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M186"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq92.gif"/></alternatives></inline-formula> based on NGS samples and genomes is significantly higher than that for Mash (0.789) and Skmer (0.688).</p>
    </sec>
    <sec id="Sec7">
      <title>The accuracy on predicting continental origins of white oak NGS samples using <italic>k</italic>-NN is markedly increased</title>
      <p>We tested our model for <inline-formula id="IEq93"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M188"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq93.gif"/></alternatives></inline-formula> bias adjustment on a dataset of 92 white oak NGS samples collected from 3 continents (North America, Asia, and Europe). In our previous study [<xref ref-type="bibr" rid="CR12">12</xref>], we downsampled each sample to 3 different sequencing quantities (50 Mbp, 100 Mbp, and 300 Mbp), corresponding to sequencing depths from 0.07× to 0.42×. At each sequencing quantity, samples were randomly divided into reference and query set, and for each sample in the query set, we found its <italic>k</italic>-nearest neighbors (<italic>k</italic>-NN) measured by <inline-formula id="IEq94"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M190"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq94.gif"/></alternatives></inline-formula> with <italic>K</italic>=12 and <italic>M</italic>=10 in the reference set and predicted its continental origin by a majority vote approach (see the “<xref rid="Sec13" ref-type="sec">Methods</xref>” section). <italic>k</italic>-NN accuracy at all these 3 sequencing quantities is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1, and it can be clearly seen that the accuracy increases with sequencing quantity.</p>
      <p>We randomly selected 30 samples from 50 Mbp dataset, 31 samples from 100 Mbp dataset, and 31 samples from 300 Mbp dataset and mixed them together to build a new dataset of NGS samples with different sequencing quantities. We predicted the continental origins of the samples in the query set using the same method, and results are shown at the top of Table <xref rid="Tab1" ref-type="table">1</xref>. Unsurprisingly, the accuracy was lower than even when we downsampled all samples to 50 Mbp (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1) because a sample from Asia might have smaller <inline-formula id="IEq95"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M192"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq95.gif"/></alternatives></inline-formula> to a sample from Europe of 300 Mbp than another sample from Asia of 50 Mbp, and it is likely to be misclassified. We used our model for <inline-formula id="IEq96"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M194"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq96.gif"/></alternatives></inline-formula> to adjust the bias and predicted their continental origins again based on the dissimilarity after bias adjustment, and the prediction accuracy is shown at the bottom of Table <xref rid="Tab1" ref-type="table">1</xref>. It is clear that our bias adjustment model was capable of increasing the accuracy markedly, especially when the reference size is small. It should be noticed that the accuracy after bias adjustment is higher than the accuracy by downsampling all samples to 50 Mbp or 100 Mbp, and it is comparable to the accuracy when all samples are of 300 Mbp, which shows that bias adjustment can achieve better performance than downsampling since the vast majority of reads are discarded by downsampling whereas bias adjustment still analyzes all the reads.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Prediction accuracy using <italic>k</italic>-NN on 92 white oak datasets of mixed sequence quantity based on <inline-formula id="IEq97"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M196"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq97.gif"/></alternatives></inline-formula> before and after bias adjustment for different query sizes, reference sizes, and different numbers of neighbors <italic>k</italic> used</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Query size</th><th align="left">Reference size</th><th align="left"><italic>k</italic> = 1</th><th align="left"><italic>k</italic> = 2</th><th align="left"><italic>k</italic> = 3</th><th align="left"><italic>k</italic> = 4</th><th align="left"><italic>k</italic> =5</th><th align="left"><italic>k</italic> = 6</th><th align="left"><italic>k</italic> = 7</th><th align="left"><italic>k</italic> = 8</th><th align="left"><italic>k</italic> = 9</th><th align="left"><italic>k</italic> = 10</th></tr></thead><tbody><tr><td align="left" colspan="12">Before bias adjustment</td></tr><tr><td align="left">1</td><td align="left">91</td><td align="left">0.97</td><td align="left">0.97</td><td align="left">0.97</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">0.98</td><td align="left">0.95</td><td align="left">0.91</td><td align="left">0.91</td></tr><tr><td align="left">17</td><td align="left">75</td><td align="left">0.98</td><td align="left">0.98</td><td align="left">0.96</td><td align="left">0.99</td><td align="left">0.96</td><td align="left">0.98</td><td align="left">0.96</td><td align="left">0.95</td><td align="left">0.91</td><td align="left">0.91</td></tr><tr><td align="left">32</td><td align="left">60</td><td align="left">0.97</td><td align="left">0.97</td><td align="left">0.94</td><td align="left">0.96</td><td align="left">0.94</td><td align="left">0.95</td><td align="left">0.91</td><td align="left">0.92</td><td align="left">0.88</td><td align="left">0.89</td></tr><tr><td align="left">47</td><td align="left">45</td><td align="left">0.95</td><td align="left">0.95</td><td align="left">0.93</td><td align="left">0.94</td><td align="left">0.91</td><td align="left">0.91</td><td align="left">0.88</td><td align="left">0.89</td><td align="left">0.87</td><td align="left">0.88</td></tr><tr><td align="left">62</td><td align="left">30</td><td align="left">0.93</td><td align="left">0.93</td><td align="left">0.88</td><td align="left">0.89</td><td align="left">0.85</td><td align="left">0.87</td><td align="left">0.83</td><td align="left">0.84</td><td align="left">0.82</td><td align="left">0.81</td></tr><tr><td align="left">77</td><td align="left">15</td><td align="left">0.84</td><td align="left">0.84</td><td align="left">0.77</td><td align="left">0.78</td><td align="left">0.75</td><td align="left">0.74</td><td align="left">0.69</td><td align="left">0.70</td><td align="left">0.67</td><td align="left">0.65</td></tr><tr><td align="left" colspan="12">After bias adjustment</td></tr><tr><td align="left">1</td><td align="left">91</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">17</td><td align="left">75</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">0.99</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">32</td><td align="left">60</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">0.99</td><td align="left">1.00</td><td align="left">0.99</td><td align="left">1.00</td><td align="left">0.99</td><td align="left">0.99</td></tr><tr><td align="left">47</td><td align="left">45</td><td align="left">1.00</td><td align="left">1.00</td><td align="left">0.99</td><td align="left">1.00</td><td align="left">0.99</td><td align="left">0.99</td><td align="left">0.98</td><td align="left">0.99</td><td align="left">0.97</td><td align="left">0.98</td></tr><tr><td align="left">62</td><td align="left">30</td><td align="left">0.99</td><td align="left">0.99</td><td align="left">0.97</td><td align="left">0.97</td><td align="left">0.94</td><td align="left">0.95</td><td align="left">0.92</td><td align="left">0.93</td><td align="left">0.90</td><td align="left">0.91</td></tr><tr><td align="left">77</td><td align="left">15</td><td align="left">0.96</td><td align="left">0.96</td><td align="left">0.92</td><td align="left">0.93</td><td align="left">0.87</td><td align="left">0.87</td><td align="left">0.81</td><td align="left">0.79</td><td align="left">0.74</td><td align="left">0.70</td></tr></tbody></table><table-wrap-foot><p>For each query sizes and reference sizes, the dataset was randomly split 100 times and an average prediction accuracy was calculated over 100 splits</p></table-wrap-foot></table-wrap></p>
      <p>The prediction accuracy of Mash and Skmer was tested on the same oak dataset using <italic>K</italic>=12,<italic>K</italic>=21, and <italic>K</italic>=31 and sketch size <italic>s</italic>=10<sup>3</sup>,<italic>s</italic>=10<sup>5</sup>, and <italic>s</italic>=10<sup>7</sup>, and results are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S2 and S3, respectively. It is clear that the adjusted <inline-formula id="IEq98"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M198"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq98.gif"/></alternatives></inline-formula> has higher prediction accuracy than Mash and Skmer, especially when the reference size is small. For instance, when there are only 15 samples in the reference set, the adjusted <inline-formula id="IEq99"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M200"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq99.gif"/></alternatives></inline-formula> can still achieve an average prediction accuracy of 0.96 whereas the highest average prediction accuracies of Mash and Skmer using <italic>K</italic>=31 and <italic>s</italic>=10<sup>7</sup> are 0.64 and 0.73, respectively.</p>
    </sec>
    <sec id="Sec8">
      <title>The prediction accuracy of geographic origin at finer scales for white oak NGS samples is markedly increased</title>
      <p>Without downsampling, we calculated the pairwise <inline-formula id="IEq100"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M202"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq100.gif"/></alternatives></inline-formula> using <italic>K</italic>=12 and Markovian order <italic>M</italic>=10 between all 92 white oak tree NGS samples with sequencing quantity ranging from 379 to 1852 Mbp, corresponding to sequencing depths from 0.53× to 2.59×. For each sample, we first found its closest sample according to <inline-formula id="IEq101"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M204"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq101.gif"/></alternatives></inline-formula> and linked them together as shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a. Although the most similar sample to each sample according to <inline-formula id="IEq102"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M206"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq102.gif"/></alternatives></inline-formula> is from the same continent-of-origin, it does not perform well at finer geographic scales. It is clear that there are 2 sink nodes SRR2053099 (blue arrow) and SRR2053115 (orange arrow) in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a. According to <inline-formula id="IEq103"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M208"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq103.gif"/></alternatives></inline-formula>, SRR2053099 was predicted as the most similar sample to 19 out of 31 Asian samples, and SRR2053115 was predicted as the most similar sample to 8 out of 16 European samples. The reason is that SRR2053099 (1414 Mbp) is one of the largest samples among all samples from Asia and SRR2053115 (1852 Mbp) is the largest sample among all samples from Europe, so they have the smallest biases in the samples from Asia and Europe, respectively. Therefore, they are more likely to be predicted as the closest samples to other samples according to <inline-formula id="IEq104"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M210"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq104.gif"/></alternatives></inline-formula>.
<fig id="Fig5"><label>Fig. 5</label><caption><p>The circular plots of 92 white oak tree samples based on <inline-formula id="IEq105"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M212"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq105.gif"/></alternatives></inline-formula> with <italic>K</italic>=12 and <italic>M</italic>=10 before and after bias adjustment. Different sectors correspond to different continents, with North America (NA) in red, Europe (EU) in orange, and Asia (AS) in blue. Within each sector, samples are sorted by their longitude, so that samples that are geographically close are also close to each other in the figure. The most similar tree sample to each sample is linked</p></caption><graphic xlink:href="13059_2019_1872_Fig5_HTML" id="MO5"/></fig></p>
      <p>We adjusted the biases of <inline-formula id="IEq106"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M214"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq106.gif"/></alternatives></inline-formula> using Afann, and the results are shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>b. It can be clearly seen that there is no sink node such as SRR2053099 and SRR2053115 in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a, which proves that the adjusted <inline-formula id="IEq107"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M216"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq107.gif"/></alternatives></inline-formula> is not biased by sequencing depth. In order to show that bias adjustment can improve the prediction accuracy at finer geographic scales, we calculated the average distance between each sample and its closest sample according to <inline-formula id="IEq108"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M218"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq108.gif"/></alternatives></inline-formula> before and after bias adjustment. In Fig. <xref rid="Fig5" ref-type="fig">5</xref>, all samples are sorted by their longitude, so we define the distance between each sample and its closest sample based on their distance in the circular plots. For each sample, the minimum distance should be 1 if and only if its closest sample according to <inline-formula id="IEq109"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M220"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq109.gif"/></alternatives></inline-formula> is next to it in the circular plots. The average distances between all 92 samples and their closest samples are 7.42 before bias adjustment and 5.85 after bias adjustment. A paired sample <italic>t</italic> test showed that the average distance after bias adjustment is significantly lower than before adjustment with a <italic>p</italic> value of 0.023. Therefore, although <inline-formula id="IEq110"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M222"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq110.gif"/></alternatives></inline-formula> based on NGS samples without downsampling or bias adjustment can successfully predict their continental origins, we proved that bias adjustment can further increase the prediction accuracy at finer geographic scales.</p>
    </sec>
    <sec id="Sec9">
      <title>The correlation between the adjusted dissimilarity measures based on NGS samples and genomes of 67 vertebrates is markedly increased</title>
      <p>Since our previous datasets all consist of sequencing reads coming from closely related species, we constructed a dataset that contains samples from 67 vertebrates to evaluate the performance of our method on diverse datasets. It contains vertebrate genomes of 67 species from 5 different classes including fish, amphibians, reptiles, birds, and mammals. Among these 67 vertebrate genomes, we randomly selected 23, 22, and 22 genomes and simulated their NGS samples of 1 M, 5 M, and 15 M 150-bp Illumina reads, respectively, and mixed all 67 NGS samples together. The sequencing depths of all NGS samples range from 0.024× to 3.49×.</p>
      <p>We then calculated pairwise <inline-formula id="IEq111"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M224"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq111.gif"/></alternatives></inline-formula> and <inline-formula id="IEq112"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M226"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq112.gif"/></alternatives></inline-formula> using <italic>K</italic>=14 and <italic>M</italic>=12 between all 67 NGS samples with and without bias adjustment and compared them with the pairwise <inline-formula id="IEq113"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M228"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq113.gif"/></alternatives></inline-formula> and <inline-formula id="IEq114"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M230"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq114.gif"/></alternatives></inline-formula> calculated from their complete genomes. The result of <inline-formula id="IEq115"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M232"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq115.gif"/></alternatives></inline-formula> was transformed to <inline-formula id="IEq116"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{*}$\end{document}</tex-math><mml:math id="M234"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq116.gif"/></alternatives></inline-formula> and shown in Fig <xref rid="Fig6" ref-type="fig">6</xref>. It can be demonstrated from Fig. <xref rid="Fig6" ref-type="fig">6</xref> that our method markedly decreased the root mean squared error and increased the Spearman correlation coefficient from 0.727 to 0.959. The result of <inline-formula id="IEq117"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M236"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq117.gif"/></alternatives></inline-formula> was transformed to <inline-formula id="IEq118"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M238"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq118.gif"/></alternatives></inline-formula> and shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S18, and the bias adjustment of <inline-formula id="IEq119"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M240"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq119.gif"/></alternatives></inline-formula> increased the Spearman correlation coefficient from 0.701 to 0.935.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Relationship between pairwise <inline-formula id="IEq120"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{*}$\end{document}</tex-math><mml:math id="M242"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq120.gif"/></alternatives></inline-formula> estimated using <italic>K</italic>=14 and <italic>M</italic>=12 based on 67 vertebrate genomes and NGS samples of different numbers of reads. <bold>a</bold> The relationship before bias adjustment. <bold>b</bold> The relationship after bias adjustment for NGS <inline-formula id="IEq121"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{*}$\end{document}</tex-math><mml:math id="M244"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq121.gif"/></alternatives></inline-formula>. The root mean squared error was decreased, and the Spearman correlation coefficient between pairwise genome <inline-formula id="IEq122"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{*}$\end{document}</tex-math><mml:math id="M246"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq122.gif"/></alternatives></inline-formula> and NGS <inline-formula id="IEq123"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{*}$\end{document}</tex-math><mml:math id="M248"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq123.gif"/></alternatives></inline-formula> was increased after bias adjustment</p></caption><graphic xlink:href="13059_2019_1872_Fig6_HTML" id="MO6"/></fig></p>
      <p>The performance of Mash and Skmer using <italic>K</italic>=31 and <italic>s</italic>=10<sup>7</sup> was tested on the same vertebrate dataset and shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19. The Spearman correlation coefficients between adjusted <inline-formula id="IEq124"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M250"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq124.gif"/></alternatives></inline-formula> (0.959) and adjusted <inline-formula id="IEq125"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M252"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq125.gif"/></alternatives></inline-formula> (0.935) based on vertebrate NGS samples and genomes are significantly higher than that for Mash (0.747) and Skmer (0.735).</p>
    </sec>
    <sec id="Sec10">
      <title>Running time and memory</title>
      <p>Although background-adjusted alignment-free methods such as <italic>CVTree</italic> [<xref ref-type="bibr" rid="CR1">1</xref>], <inline-formula id="IEq126"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M254"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq126.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR2">2</xref>], and <inline-formula id="IEq127"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M256"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq127.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR2">2</xref>] have been shown to achieve better performance than simple <italic>Manhattan</italic> and <italic>Euclidean</italic> distances [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>], their applications have been limited due to the high time and memory cost in the random background removing step. To overcome this bottleneck, we improved the speed and memory usage of background-adjusted methods in Afann by hashing, multi-threading, and vectorization and compared it with our previous program Cafe [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
      <p>Both tools were used to calculate the pairwise <inline-formula id="IEq128"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}, d_{2}^{*}$\end{document}</tex-math><mml:math id="M258"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq128.gif"/></alternatives></inline-formula>, and <italic>CVTree</italic> among the white oak datasets of 92 NGS samples with 300 Mbp sequencing quantity using <italic>K</italic>=12 and <italic>M</italic>=10 and among the primate dataset of 21 genomes using <italic>K</italic>=14 and <italic>M</italic>=12. Comparisons of time and memory based on white oak datasets and primate dataset were shown in Table <xref rid="Tab2" ref-type="table">2</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4, respectively. The total time was divided into <italic>k</italic>mer counting time and dissimilarity calculation time. It can be clearly seen in Table <xref rid="Tab2" ref-type="table">2</xref> that the total speedup ratio of Afann is around 100× for all 3 background-adjusted methods whereas the memory usage is only one fifth of the memory of Cafe. Afann also supports fast calculation mode for <inline-formula id="IEq129"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M260"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq129.gif"/></alternatives></inline-formula> and <italic>CVTree</italic> which further increases the calculation speed by using more memory. The memory usage is <italic>O</italic>(4<sup><italic>K</italic></sup>) for normal mode and <italic>O</italic>(<italic>N</italic>×4<sup><italic>K</italic></sup>) for the fast mode where <italic>K</italic> is the <italic>k</italic>mer length and <italic>N</italic> is the number of samples. It should be noticed that the counting time is <italic>O</italic>(<italic>N</italic>×4<sup><italic>K</italic></sup>) whereas the calculation time is <italic>O</italic>(<italic>N</italic><sup>2</sup>×4<sup><italic>K</italic></sup>); the total speedup ratio will thereby be close to the speedup ratio of dissimilarity calculation as the number of samples <italic>N</italic> increases. We suggest using fast mode when memory allows. For example, it is common to compare the pairwise dissimilarity among thousands of bacterial genomes using small <italic>k</italic>mer length 5 or 6 which does not require much memory, then the speedup ratio of fast mode can be more than 5000×.
<table-wrap id="Tab2"><label>Table 2</label><caption><p><italic>k</italic>mer counting time, dissimilarity calculation time, and total time as well as memory usage used by Cafe and Afann to calculate the pairwise <inline-formula id="IEq130"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}, d_{2}^{*}$\end{document}</tex-math><mml:math id="M262"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq130.gif"/></alternatives></inline-formula>, and <italic>CVTree</italic> using <italic>K</italic>=12 and <italic>M</italic>=10 among a dataset of 92 white oak NGS samples of 300 Mbp</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Counting (min)</th><th align="left">Calculation (min)</th><th align="left">Total time (min)</th><th align="left">Memory (Mb)</th></tr></thead><tbody><tr><td align="left">Cafe-<inline-formula id="IEq131"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M264"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq131.gif"/></alternatives></inline-formula></td><td align="justify">450.2</td><td align="justify">4260.2</td><td align="justify">4710.4</td><td align="justify">1916</td></tr><tr><td align="left">Afann-<inline-formula id="IEq132"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M266"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq132.gif"/></alternatives></inline-formula></td><td align="justify">21.9</td><td align="justify">31.2</td><td align="justify">53.1</td><td align="justify">449</td></tr><tr><td align="left">Cafe-<inline-formula id="IEq133"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M268"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq133.gif"/></alternatives></inline-formula></td><td align="justify">450.2</td><td align="justify">4224.1</td><td align="justify">4764.3</td><td align="justify">1928</td></tr><tr><td align="left">Afann-<inline-formula id="IEq134"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M270"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq134.gif"/></alternatives></inline-formula></td><td align="justify">21.9</td><td align="justify">14.2</td><td align="justify">36.1</td><td align="justify">304</td></tr><tr><td align="left">Afann-<inline-formula id="IEq135"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M272"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq135.gif"/></alternatives></inline-formula>-fast</td><td align="justify">21.9</td><td align="justify">0.3</td><td align="justify">22.2</td><td align="justify">11953</td></tr><tr><td align="left">Cafe-<italic>CVTree</italic></td><td align="justify">450.2</td><td align="justify">4295.4</td><td align="justify">4745.6</td><td align="justify">1960</td></tr><tr><td align="left">Afann-<italic>CVTree</italic></td><td align="justify">21.9</td><td align="justify">14.1</td><td align="justify">36.0</td><td align="justify">304</td></tr><tr><td align="left">Afann-<italic>CVTree</italic>-fast</td><td align="justify">21.9</td><td align="justify">0.3</td><td align="justify">22.2</td><td align="justify">11953</td></tr><tr><td align="left">Mash <sup>min</sup></td><td align="justify">21.5</td><td align="justify">0.1</td><td align="justify">21.5</td><td align="justify">3</td></tr><tr><td align="left">Mash <sup>opt</sup></td><td align="justify">125.6</td><td align="justify">25.5</td><td align="justify">151.1</td><td align="justify">20830</td></tr><tr><td align="left">Skmer <sup>min</sup></td><td align="justify">NA</td><td align="justify">NA</td><td align="justify">111.9</td><td align="justify">565</td></tr><tr><td align="left">Skmer <sup>opt</sup></td><td align="justify">NA</td><td align="justify">NA</td><td align="justify">656.9</td><td align="justify">2556</td></tr></tbody></table><table-wrap-foot><p>Afann-<inline-formula id="IEq136"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M274"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq136.gif"/></alternatives></inline-formula>-fast and Afann-<italic>CVTree</italic>-fast stand for the fast mode of <inline-formula id="IEq137"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M276"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq137.gif"/></alternatives></inline-formula> and <italic>CVTree</italic> supported in Afann. Running time and memory usage of Mash and Skmer were also included. Mash <sup>min</sup> and Skmer <sup>min</sup> used <italic>K</italic>=12 and <italic>s</italic>=10<sup>3</sup> which require the minimum computing power. Mash <sup>opt</sup> and Skmer <sup>opt</sup> used <italic>K</italic>=31 and <italic>s</italic>=10<sup>7</sup> which have the optimal performance among Mash and Skmer using different combinations of <italic>k</italic>mer lengths and sketch sizes as shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 and Table S3</p></table-wrap-foot></table-wrap></p>
      <p>The running time and memory usage of other fast alignment-free tools Mash [<xref ref-type="bibr" rid="CR5">5</xref>] and Skmer [<xref ref-type="bibr" rid="CR8">8</xref>] on the same oak NGS and primate genome datasets were also calculated and reported in Table <xref rid="Tab2" ref-type="table">2</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4, respectively. The running time and memory usage of an alignment-free genome comparison tool FFP [<xref ref-type="bibr" rid="CR3">3</xref>] on the primate genome dataset using <italic>K</italic>=16 as suggested in [<xref ref-type="bibr" rid="CR3">3</xref>] were reported in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4. It should be noticed that the running time of Mash and Skmer using <italic>K</italic>=12 nad <italic>s</italic>=10<sup>3</sup> for oak NGS dataset and <italic>K</italic>=14 and <italic>s</italic>=10<sup>3</sup> for primate genome dataset was only included to test their speed when using the same <italic>k</italic>mer length as <inline-formula id="IEq138"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M278"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq138.gif"/></alternatives></inline-formula> and <inline-formula id="IEq139"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M280"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq139.gif"/></alternatives></inline-formula>. In practice, <italic>k</italic>mer length shorter than 21 is not recommended for Mash and Skmer [<xref ref-type="bibr" rid="CR8">8</xref>]. We can see in Table <xref rid="Tab2" ref-type="table">2</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4 that Cafe calculates <inline-formula id="IEq140"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}, d_{2}^{*}$\end{document}</tex-math><mml:math id="M282"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq140.gif"/></alternatives></inline-formula>, and <italic>CVTree</italic> much slower than Mash, Skmer, and FFP whereas Afann is capable of calculating <inline-formula id="IEq141"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}, d_{2}^{*}$\end{document}</tex-math><mml:math id="M284"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq141.gif"/></alternatives></inline-formula>, and <italic>CVTree</italic> in a comparable amount of time as Mash, Skmer, and FFP. The pairwise dissimilarity measures among primate genomes calculated by different methods were compared with their evolutionary distances estimated by alignment-based methods in [<xref ref-type="bibr" rid="CR18">18</xref>] and shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S20. All dissimilarity measures except FFP are highly correlated with the evolutionary distance with Spearman correlation coefficients higher than 0.95 which demonstrated the applicability of alignment-free methods in genome comparisons. However, our evaluations based on different independent datasets in previous sections showed that Afann significantly outperforms others in comparing NGS samples.</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="discussion">
    <title>Discussion</title>
    <p>Alignment-free sequence comparison methods, especially <italic>k</italic>mer-based methods have been widely used in NGS analysis without assembly or alignment. However, several studies have revealed that the alignment-free dissimilarity calculated based on NGS samples tends to be over-estimated compared to the alignment-free dissimilarity calculated based on their genomes caused by the stochastic distribution of short reads [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. In this study, we showed that this bias could significantly decrease the performance of alignment-free analysis based on NGS samples of different sequencing depths by investigating four independent datasets. For the primate, mammalian, and vertebrate datasets, the correlation between pairwise NGS dissimilarity and pairwise genome dissimilarity dropped markedly if NGS samples of different numbers of reads were mixed together. For the white oak dataset, the <italic>k</italic>-NN prediction accuracy of their continental origins based on a dataset of samples with 50 M, 100 M, and 300 M sequencing quantity is even much lower than the accuracy based on a dataset of all samples with only 50 M sequencing quantity.</p>
    <p>This problem was previously solved by downsampling [<xref ref-type="bibr" rid="CR12">12</xref>] or modifying the specific dissimilarity formula by estimating the sequencing depth and sequencing error rate [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. However, the first method discards the vast majority of reads that could have been informative, and the second method depends on the estimation of sequencing depth and sequencing error rate and cannot be generalized to adjust the bias for other alignment-free methods calculated by a different formula. In addition, it can be extremely hard to adjust the formula of several complicated background-adjusted methods such as <italic>CVTree</italic>[<xref ref-type="bibr" rid="CR1">1</xref>], <inline-formula id="IEq142"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M286"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq142.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR2">2</xref>], and <inline-formula id="IEq143"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M288"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq143.gif"/></alternatives></inline-formula>[<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p>Therefore, we introduced a de novo method in this study to adjust bias without estimating the sequencing depth or sequencing error rate explicitly by defining <inline-formula id="IEq144"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {Bias}(A_{\text {NGS}}) = d(A_{\text {NGS}}, A_{\text {NGS}}^{R})$\end{document}</tex-math><mml:math id="M290"><mml:mtext>Bias</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq144.gif"/></alternatives></inline-formula>. This bias estimator will increase as the sequencing depth decreases or sequencing error rate increases and thus implicitly capture information from sequencing depth and sequencing error rate. Therefore, bias adjustment could be characterized as a regression problem that uses <italic>d</italic>(<italic>A</italic><sub>NGS</sub>,<italic>B</italic><sub>NGS</sub>),Bias(<italic>A</italic><sub>NGS</sub>), and Bias(<italic>B</italic><sub>NGS</sub>) to predict <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>). Two neural network regression models were trained for <inline-formula id="IEq145"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M292"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq145.gif"/></alternatives></inline-formula> and <inline-formula id="IEq146"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M294"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq146.gif"/></alternatives></inline-formula> separately using the primate dataset. Our results showed that bias was successfully adjusted for NGS samples of different sequencing depth and calculated by using different <italic>k</italic>mer length, supported by the large improvement of root mean squared error and Spearman correlation coefficient between dissimilarity based on NGS samples after bias adjustment and dissimilarity based on genomes.</p>
    <p>Without changing any parameters, the performance of our models was tested on 3 independent datasets. A 28 mammalian dataset was used to test our bias adjustment model for <inline-formula id="IEq147"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M296"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq147.gif"/></alternatives></inline-formula>. Each genome was simulated to 3 NGS samples of 1 M, 5 M, and 15 M Illumina 150-bp reads and mixed together. Pairwise <inline-formula id="IEq148"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M298"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq148.gif"/></alternatives></inline-formula> values using <italic>K</italic>=14 and <italic>M</italic>=12 between all 84 samples were calculated without and with bias adjustment and compared with pairwise genome <inline-formula id="IEq149"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M300"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq149.gif"/></alternatives></inline-formula>. The results showed that our method successfully adjusted the bias and greatly improved both root mean squared error and Spearman correlation coefficient. A 92 white oak dataset was used to test our bias adjustment model for <inline-formula id="IEq150"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M302"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq150.gif"/></alternatives></inline-formula>. We randomly selected 30 samples from the 50 Mbp dataset, 31 samples from the 100 Mbp dataset, and 31 samples from the 300 Mbp dataset and mixed them together. Pairwise <inline-formula id="IEq151"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M304"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq151.gif"/></alternatives></inline-formula> values using <italic>K</italic>=12 and <italic>M</italic>=10 between all 92 samples were calculated without and with bias adjustment, and <italic>k</italic>-NN was used to predict the continental origins of test samples based on <inline-formula id="IEq152"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M306"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq152.gif"/></alternatives></inline-formula>. Our result showed that the prediction accuracy of the mixed dataset using <italic>k</italic>-NN is even lower than that using a dataset of all 50 Mbp samples before bias adjustment. After bias adjustment, the <italic>k</italic>-NN accuracy markedly increased and was comparable to the accuracy based on a dataset of all 300 Mbp samples. In addition, we proved that bias adjustment could increase the accuracy of prediction not only at continental level but also at finer geographic scales. At last, a 67 vertebrate dataset consisting of species from 5 different classes was used to demonstrate the reliability of our method on datasets composed of diverse species. In all datasets, our method outperformed other alignment-free methods including Mash [<xref ref-type="bibr" rid="CR5">5</xref>] and Skmer [<xref ref-type="bibr" rid="CR8">8</xref>] in terms of the Spearman correlation coefficient and prediction accuracy.</p>
    <p>It should be noticed that while our bias adjustment method is capable of successfully predicting the alignment-free dissimilarity based on genomes regardless of the chosen <italic>k</italic>mer length, it is, nevertheless, important to choose a proper <italic>k</italic>mer length so that the alignment-free dissimilarity based on genomes is highly correlated with their evolutionary distance. For instance, while Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11 shows that our model successfully adjusted the bias of <inline-formula id="IEq153"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M308"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq153.gif"/></alternatives></inline-formula> using <italic>K</italic>=5 to <italic>K</italic>=13 based on primate NGS samples, it can be clearly seen in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 that the correlation between <inline-formula id="IEq154"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M310"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq154.gif"/></alternatives></inline-formula> based on primate genomes and their evolutionary distance is lower than 0.90 when <italic>K</italic>&lt;10 is used. Therefore, even if our model can adjust the bias of <italic>K</italic>&lt;10, the performance might not increase as we expected. There have been several investigations into the choice of optimal <italic>k</italic>mer length [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. In practice, shorter <italic>k</italic>mers are optimal when sequences are short or obviously different, whereas longer <italic>k</italic>mers should be used when sequences are from very closely related species in order to reduce the probability that a <italic>k</italic>mer commonly appear in a sequence by chance [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p>In conclusion, our study showed that bias adjustment is a necessary step to increase the performance of alignment-free methods based on NGS samples. Although our models were trained only on the primate dataset, it was able to adjust the bias for independent mammalian, vertebrate, and white oak datasets, which proved that our model is generalizable to adjust the bias of NGS samples from different species, sequencing depths using different <italic>k</italic>mer lengths. Future work could train our models using more samples from different species with more variant sequencing depths to further improve the performance. In addition, since our bias adjustment method only relies on the alignment-free dissimilarity calculated between <italic>A</italic><sub>NGS</sub> and <inline-formula id="IEq155"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A_{\text {NGS}}^{R}$\end{document}</tex-math><mml:math id="M312"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq155.gif"/></alternatives></inline-formula> without estimating sequencing depths and sequencing error rates or considering the actual formula of the dissimilarity measures, it can be easily generalized to adjust the bias of all alignment-free dissimilarity measures by training their own regression models. In this paper, we showed the success of our bias adjustment model for two background-adjusted methods <inline-formula id="IEq156"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M314"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq156.gif"/></alternatives></inline-formula> and <inline-formula id="IEq157"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M316"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq157.gif"/></alternatives></inline-formula>; the framework developed in this paper can be easily adapted to adjust bias in other alignment-free dissimilarity measures.</p>
  </sec>
  <sec id="Sec12" sec-type="conclusion">
    <title>Conclusion</title>
    <p>Afann is a fast tool to calculate background-adjusted alignment-free dissimilarity measures <italic>CVTree</italic>, <inline-formula id="IEq158"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M318"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq158.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq159"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M320"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq159.gif"/></alternatives></inline-formula> between genome sequences and NGS samples. In addition, it can adjust the biases caused by NGS samples of different sequencing depths for <inline-formula id="IEq160"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M322"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq160.gif"/></alternatives></inline-formula> and <inline-formula id="IEq161"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M324"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq161.gif"/></alternatives></inline-formula> without downsampling or estimating the sequencing depth. Our results showed that the adjusted <inline-formula id="IEq162"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M326"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq162.gif"/></alternatives></inline-formula> and <inline-formula id="IEq163"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M328"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq163.gif"/></alternatives></inline-formula> are not biased by sequencing depth and can significantly increase the performance of studies based on NGS samples.</p>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <p>See Appendix A of Additional file <xref rid="MOESM1" ref-type="media">1</xref> for more details about different alignment-free dissimilarity measures including <italic>CVTree</italic>[<xref ref-type="bibr" rid="CR1">1</xref>], <inline-formula id="IEq164"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M330"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq164.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR2">2</xref>], and <inline-formula id="IEq165"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M332"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq165.gif"/></alternatives></inline-formula>[<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <sec id="Sec14">
      <title>Genomic datasets and simulation of NGS samples</title>
      <p>The primate dataset consists of 21 complete primate genome sequences downloaded from NCBI. In [<xref ref-type="bibr" rid="CR18">18</xref>], the author estimated the evolutionary distances among 186 primates based on the alignment of 54 nuclear gene regions. In our previous study [<xref ref-type="bibr" rid="CR14">14</xref>], we found 21 complete representative genomes on NCBI among these 186 primates and demonstrated that their pairwise <inline-formula id="IEq166"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M334"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq166.gif"/></alternatives></inline-formula> and <inline-formula id="IEq167"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M336"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq167.gif"/></alternatives></inline-formula> with <italic>K</italic>=14 and <italic>M</italic>=12 are highly correlated with their evolutionary distances estimated in [<xref ref-type="bibr" rid="CR18">18</xref>]. The species names, assembly accession numbers, and total sequence lengths of these 21 primate genomes are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5. For each genome, we used ART [<xref ref-type="bibr" rid="CR22">22</xref>] to simulate different numbers of Illumina HiSeq 2500 reads of length 150 bp with default sequencing error profile. We produced 8 different datasets with 1 M, 3 M, 5 M, 7 M, 9 M, 11 M, 13 M, and 15 M reads for each NGS sample. We then mixed all 21×8=168 NGS samples to generate a new dataset of primate NGS samples.</p>
      <p>Similarly, the mammalian dataset consists of 28 complete vertebrate genome sequences downloaded from NCBI, with evolutionary distances calculated by the alignment-based method in [<xref ref-type="bibr" rid="CR19">19</xref>]. The species names, assembly accession numbers, and total sequence lengths of these 28 mammalian genomes are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6. For each genome, we used ART [<xref ref-type="bibr" rid="CR22">22</xref>] to simulate different numbers of Illumina HiSeq 2500 reads of length 150 bp with default sequencing error profile. We produced 3 different datasets with 1 M, 5 M, and 15 M reads for each NGS sample. We then mixed all 28×3=84 NGS samples to generate a new dataset of mammalian NGS samples.</p>
      <p>The white oak tree dataset consists of whole-genome shotgun (WGS) sequencing data of 92 white oaks from North America, Europe, and Asia with sequencing quantity ranging from 379 to 1852 Mbp from NCBI BioProject PRJNA269970 [<xref ref-type="bibr" rid="CR23">23</xref>]. The run accession numbers, number of bases, and continental origins for these 92 samples are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S7. We downsampled all 92 samples to produce 3 different datasets with 50 Mbp, 100 Mbp, and 300 Mbp, for each sample, respectively. Then, we randomly chose 30 samples from the 50 Mbp dataset, 31 samples from the 100 Mbp dataset, and 31 samples from the 300 Mbp and mixed them together to generate a new dataset of 92 NGS samples with different sequencing quantities. All samples were divided into 3 geographic categories (North America, Europe, and Asia) based on their continental origins.</p>
      <p>The vertebrate dataset consists of 67 complete vertebrate genome sequences downloaded from NCBI. The species are from 5 different classes, including 15 fish, 7 amphibians, 15 reptiles, 15 birds, and 15 mammals. All 15 species were randomly selected from the corresponding classes except for amphibian where there are only 7 amphibian complete genome sequences available on NCBI, and thereby, they were all included in the dataset. The species names, classes, assembly accession numbers, and total sequence lengths of these 67 vertebrate genomes are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S8. Among these 67 vertebrate genomes, we randomly selected 23, 22, and 22 genomes and simulated their NGS samples of 1 M, 5 M, and 15 M 150 bp Illumina reads, respectively, by ART [<xref ref-type="bibr" rid="CR22">22</xref>] and mixed them together to generate a dataset of 67 vertebrate NGS samples.</p>
    </sec>
    <sec id="Sec15">
      <title>Developing a bias adjustment model</title>
      <p>For any pair of NGS samples, their alignment-free dissimilairty <italic>d</italic>(<italic>A</italic><sub>NGS</sub>,<italic>B</italic><sub>NGS</sub>) is determined by three variables, which are the alignment-free dissimilairty based on their genomes <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) and the bias caused by each sample Bias(<italic>A</italic><sub>NGS</sub>) and Bias(<italic>B</italic><sub>NGS</sub>):
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ d(A_{\text{NGS}}, B_{\text{NGS}}) = F(d(A_{G}, B_{G}), \text{Bias}(A_{\text{NGS}}), \text{Bias}(B_{\text{NGS}}))  $$ \end{document}</tex-math><mml:math id="M338"><mml:mspace width="-15.0pt"/><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext>Bias</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext>Bias</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><graphic xlink:href="13059_2019_1872_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>We define the bias of an NGS sample A by the following equation:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \text{Bias}(A_{\text{NGS}}) = d\left(A_{\text{NGS}}, A_{\text{NGS}}^{R}\right)  $$ \end{document}</tex-math><mml:math id="M340"><mml:mtext>Bias</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1872_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>A</italic><sub>NGS</sub> is the original NGS sample and <inline-formula id="IEq168"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A_{\text {NGS}}^{R}$\end{document}</tex-math><mml:math id="M342"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq168.gif"/></alternatives></inline-formula> is a mapped NGS sample that each read in it is a reverse complementary mapping of a read in the original NGS sample. For example, the NGS sample in the left of Fig. <xref rid="Fig1" ref-type="fig">1</xref>a has reads {AACT, GACG, TTAT, ATAA, CGTC, AGTT}, and its corresponding <inline-formula id="IEq169"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A_{\text {NGS}}^{R}$\end{document}</tex-math><mml:math id="M344"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq169.gif"/></alternatives></inline-formula> can be inferred by mapping each read in <italic>A</italic><sub>NGS</sub> to its reverse complementary read and thus is {AGTT, CGTC, ATAA, TTAT, GACG, AACT}, which is exactly the same as <italic>A</italic><sub>NGS</sub>. The NGS sample in the left of Fig. <xref rid="Fig1" ref-type="fig">1</xref>b has reads {ACTG, GTTA, ATAA}, and its <inline-formula id="IEq170"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A_{\text {NGS}}^{R}$\end{document}</tex-math><mml:math id="M346"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq170.gif"/></alternatives></inline-formula> should be {CAGT, TAAC, TTAT} accordingly, which is apparently different from <italic>A</italic><sub>NGS</sub>.</p>
      <p>Given an dissimilarity measure, such as <inline-formula id="IEq171"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M348"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq171.gif"/></alternatives></inline-formula> or <inline-formula id="IEq172"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M350"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq172.gif"/></alternatives></inline-formula>, the Bias(<italic>A</italic><sub>NGS</sub>) can then be calculated between <italic>A</italic><sub>NGS</sub> and <inline-formula id="IEq173"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A_{\text {NGS}}^{R}$\end{document}</tex-math><mml:math id="M352"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq173.gif"/></alternatives></inline-formula>. We expect that Bias(<italic>A</italic><sub>NGS</sub>) will increase as the sequencing depth of <italic>A</italic><sub>NGS</sub> decreases or the sequencing error rate increases, as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b. The advantage of defining Bias(<italic>A</italic><sub>NGS</sub>) in this way is that we do not need to estimate sequencing depth or sequencing error rate explicitly, but this information has already been implicitly considered when we compare <italic>A</italic><sub>NGS</sub> with <inline-formula id="IEq174"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$A_{\text {NGS}}^{R}$\end{document}</tex-math><mml:math id="M354"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>R</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq174.gif"/></alternatives></inline-formula>.</p>
      <p>Given <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>),<italic>d</italic>(<italic>A</italic><sub>NGS</sub>,<italic>B</italic><sub>NGS</sub>) will increase as Bias(<italic>A</italic><sub>NGS</sub>) or Bias(<italic>B</italic><sub>NGS</sub>) increases, as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>i that samples of high sequencing depth and thus low bias (red points) have higher NGS <inline-formula id="IEq175"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$s_{2}^{s}$\end{document}</tex-math><mml:math id="M356"><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq175.gif"/></alternatives></inline-formula> (lower NGS <inline-formula id="IEq176"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M358"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq176.gif"/></alternatives></inline-formula>) than samples of low sequencing depth and thus high bias (blue points) even when their genome <italic>s</italic> of interest are the same. In addition, if Bias(<italic>A</italic><sub>NGS</sub>) and Bias(<italic>B</italic><sub>NGS</sub>) do not change, <italic>d</italic>(<italic>A</italic><sub>NGS</sub>,<italic>B</italic><sub>NGS</sub>) will increase as <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) increases, as shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a–h. Since NGS samples in the same subplot have the same number of reads and thus have similar Bias(<italic>A</italic><sub>NGS</sub>) and Bias(<italic>B</italic><sub>NGS</sub>), their pairwise <italic>d</italic>(<italic>A</italic><sub>NGS</sub>,<italic>B</italic><sub>NGS</sub>) value increases with <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>).</p>
      <p>Because of this partial monotonic relationship between <italic>d</italic>(<italic>A</italic><sub>NGS</sub>,<italic>B</italic><sub>NGS</sub>) and <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) given Bias(<italic>A</italic><sub>NGS</sub>) and Bias(<italic>B</italic><sub>NGS</sub>), Eq. (<xref rid="Equ1" ref-type="">1</xref>) can be rewritten as:
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  d(A_{G}, B_{G}) = G(d(A_{\text{NGS}}, B_{\text{NGS}}), Bias(A_{\text{NGS}}), \text{Bias}(B_{\text{NGS}}))  $$ \end{document}</tex-math><mml:math id="M360"><mml:mspace width="-14.0pt"/><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext mathvariant="italic">Bias</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mtext>Bias</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><graphic xlink:href="13059_2019_1872_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>G</italic> is a general function. Therefore, the bias adjustment process can be characterized as a regression problem that is capable of predicting the real genome dissimilarity <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) between any pair of NGS samples. To solve this supervised learning problem, we can first train our regression models on datasets of known <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>),<italic>d</italic>(<italic>A</italic><sub>NGS</sub>,<italic>B</italic><sub>NGS</sub>),Bias(<italic>A</italic><sub>NGS</sub>), and Bias(<italic>B</italic><sub>NGS</sub>). Then, for any new pair of NGS samples, we first calculate their <italic>d</italic>(<italic>A</italic><sub>NGS</sub>,<italic>B</italic><sub>NGS</sub>),Bias(<italic>A</italic><sub>NGS</sub>), and Bias(<italic>B</italic><sub>NGS</sub>) and use our model to predict its <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>). After bias adjustment, our sequence comparison can be based on the predicted unbiased <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) instead of biased <italic>d</italic>(<italic>A</italic><sub>NGS</sub>,<italic>B</italic><sub>NGS</sub>).</p>
    </sec>
    <sec id="Sec16">
      <title>Model training and evaluation</title>
      <sec id="Sec17">
        <title>Creating training samples</title>
        <p>We trained 2 neural network regression models that are widely used to solve nonlinear regression problems for <inline-formula id="IEq177"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M362"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq177.gif"/></alternatives></inline-formula> and <inline-formula id="IEq178"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M364"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq178.gif"/></alternatives></inline-formula> separately using the 21 primate dataset. Instead of training on NGS samples we generated previously to plot Fig. <xref rid="Fig2" ref-type="fig">2</xref>, we generated a new dataset by simulating 8 NGS samples of different number of reads (1 M, 3 M, 5 M, 7 M, 9 M, 11 M, 13 M, and 15 M) for each genome again and mixed them together. The samples are denoted from <inline-formula id="IEq179"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P^{1}_{\text {NGS}}$\end{document}</tex-math><mml:math id="M366"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq179.gif"/></alternatives></inline-formula> to <inline-formula id="IEq180"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P^{168}_{\text {NGS}}$\end{document}</tex-math><mml:math id="M368"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mn>168</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq180.gif"/></alternatives></inline-formula>, respectively. We describe how we trained the bias adjustment model for <inline-formula id="IEq181"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M370"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq181.gif"/></alternatives></inline-formula> in the following section. The same training method was used for <inline-formula id="IEq182"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M372"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq182.gif"/></alternatives></inline-formula> and can be easily generalized for other alignment-free methods.</p>
        <p>For each pair of NGS samples <inline-formula id="IEq183"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P^{i}_{\text {NGS}}$\end{document}</tex-math><mml:math id="M374"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq183.gif"/></alternatives></inline-formula> and <inline-formula id="IEq184"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P^{j}_{\text {NGS}}$\end{document}</tex-math><mml:math id="M376"><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq184.gif"/></alternatives></inline-formula>, we calculated their NGS dissimilarity <inline-formula id="IEq185"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (d_{2}^{s}\left (P^{i}_{\text {NGS}}, P^{j}_{\text {NGS}}\right)\right)$\end{document}</tex-math><mml:math id="M378"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq185.gif"/></alternatives></inline-formula>, their genome dissimilarity <inline-formula id="IEq186"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (d_{2}^{s}\left (P^{i}_{G}, P^{j}_{G}\right)\right), \text {Bias}\left (P^{i}_{\text {NGS}}\right),$\end{document}</tex-math><mml:math id="M380"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mtext>Bias</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq186.gif"/></alternatives></inline-formula> and <inline-formula id="IEq187"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {Bias}\left (P^{j}_{\text {NGS}}\right)$\end{document}</tex-math><mml:math id="M382"><mml:mtext>Bias</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq187.gif"/></alternatives></inline-formula> using <italic>k</italic>mer length from 5 to 14 and Markovian order = <italic>k</italic>−2. For each <italic>k</italic>mer length, there are 168×167=28,056 pairs, so that <italic>X</italic><sub><italic>k</italic></sub> will be a matrix of dimension 28,056×3 and <italic>y</italic><sub><italic>k</italic></sub> will be a vector of length 28,056 as shown below. To ensure that our model can train <inline-formula id="IEq188"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {Bias}\left (P^{i}_{\text {NGS}}\right)$\end{document}</tex-math><mml:math id="M384"><mml:mtext>Bias</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq188.gif"/></alternatives></inline-formula> and <inline-formula id="IEq189"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {Bias}\left (P^{j}_{\text {NGS}}\right)$\end{document}</tex-math><mml:math id="M386"><mml:mtext>Bias</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq189.gif"/></alternatives></inline-formula> symmetrically, both <inline-formula id="IEq190"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}\left (P^{i}_{\text {NGS}}, P^{j}_{\text {NGS}}\right)$\end{document}</tex-math><mml:math id="M388"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq190.gif"/></alternatives></inline-formula> and <inline-formula id="IEq191"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}\left (P^{j}_{\text {NGS}}, P^{i}_{\text {NGS}}\right)$\end{document}</tex-math><mml:math id="M390"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mtext>NGS</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq191.gif"/></alternatives></inline-formula> were included in the training samples, which was verified after model training and shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S21. In order to build a regression model that is capable of adjusting the bias for different <italic>k</italic>mer lengths, we concatenated <italic>X</italic><sub><italic>k</italic></sub> from <italic>X</italic><sub>5</sub> to <italic>X</italic><sub>14</sub> vertically and concatenated <italic>y</italic><sub><italic>k</italic></sub> from <italic>y</italic><sub>5</sub> to <italic>y</italic><sub>14</sub>. Therefore, our final <inline-formula id="IEq192"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X = \left [X_{5}^{T}, X_{6}^{T} \dots X_{14}^{T}\right ]^{T}$\end{document}</tex-math><mml:math id="M392"><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>…</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>14</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq192.gif"/></alternatives></inline-formula> is a 280,560×3 matrix and <inline-formula id="IEq193"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$y = \left [y_{5}^{T}, y_{6}^{T}, \dots y_{14}^{T}\right ]^{T}$\end{document}</tex-math><mml:math id="M394"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>14</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq193.gif"/></alternatives></inline-formula> is a 280,560×1 vector.</p>
        <p>
          <disp-formula id="Equb">
            <alternatives>
              <tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} \underbrace{ \left[\begin{array}{ccc} d_{2}^{s}\left(P^{1}_{\text{NGS}}, P^{2}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{1}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{2}_{\text{NGS}}\right)\\ d_{2}^{s}\left(P^{1}_{\text{NGS}}, P^{3}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{1}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{3}_{\text{NGS}}\right)\\ d_{2}^{s}\left(P^{1}_{\text{NGS}}, P^{4}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{1}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{4}_{\text{NGS}}\right)\\ \vdots &amp; \vdots &amp; \vdots \\ d_{2}^{s}\left(P^{1}_{\text{NGS}}, P^{168}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{1}_{NGS}\right) &amp; \text{Bias}\left(P^{168}_{\text{NGS}}\right)\\ d_{2}^{s}\left(P^{2}_{\text{NGS}}, P^{1}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{2}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{1}_{\text{NGS}}\right)\\ d_{2}^{s}\left(P^{2}_{\text{NGS}}, P^{3}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{2}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{3}_{\text{NGS}}\right)\\ d_{2}^{s}\left(P^{2}_{\text{NGS}}, P^{4}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{2}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{4}_{\text{NGS}}\right) \\ \vdots &amp; \vdots &amp; \vdots \\ d_{2}^{s}\left(P^{168}_{\text{NGS}}, P^{167}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{168}_{\text{NGS}}\right) &amp; \text{Bias}\left(P^{167}_{\text{NGS}}\right) \end{array}\right] }_{X_{k}} \sim \underbrace{ \left[\begin{array}{c} d_{2}^{s}\left(P^{1}_{G}, P^{2}_{G}\right) \\ d_{2}^{s}\left(P^{1}_{G}, P^{3}_{G}\right) \\ d_{2}^{s}\left(P^{1}_{G}, P^{4}_{G}\right) \\ \vdots \\ d_{2}^{s}\left(P^{1}_{G}, P^{168}_{G}\right) \\ d_{2}^{s}\left(P^{2}_{G}, P^{1}_{G}\right) \\ d_{2}^{s}\left(P^{2}_{G}, P^{3}_{G}\right) \\ d_{2}^{s}\left(P^{2}_{G}, P^{4}_{G}\right) \\ \vdots \\ d_{2}^{s}\left(P^{168}_{G}, P^{167}_{G}\right) \end{array}\right] }_{y_{k}} \end{aligned} $$ \end{document}</tex-math>
              <mml:math id="M396">
                <mml:mrow>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:munder>
                          <mml:mrow>
                            <mml:munder accentunder="false">
                              <mml:mrow>
                                <mml:mfenced close="]" open="[" separators="">
                                  <mml:mrow>
                                    <mml:mtable class="array" columnalign="left">
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>3</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>3</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>4</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>4</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:mo>⋮</mml:mo>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mo>⋮</mml:mo>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mo>⋮</mml:mo>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>168</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext mathvariant="italic">NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>168</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>3</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>3</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>4</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>4</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:mo>⋮</mml:mo>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mo>⋮</mml:mo>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mo>⋮</mml:mo>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>168</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>167</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>168</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                        <mml:mtd>
                                          <mml:mtext>Bias</mml:mtext>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mtext>NGS</mml:mtext>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>167</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                    </mml:mtable>
                                  </mml:mrow>
                                </mml:mfenced>
                              </mml:mrow>
                              <mml:mo>⏟</mml:mo>
                            </mml:munder>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>X</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:munder>
                        <mml:mo>∼</mml:mo>
                        <mml:munder>
                          <mml:mrow>
                            <mml:munder accentunder="false">
                              <mml:mrow>
                                <mml:mfenced close="]" open="[" separators="">
                                  <mml:mrow>
                                    <mml:mtable class="array" columnalign="left">
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>3</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>4</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:mo>⋮</mml:mo>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>168</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>1</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>3</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>4</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:mo>⋮</mml:mo>
                                        </mml:mtd>
                                      </mml:mtr>
                                      <mml:mtr>
                                        <mml:mtd>
                                          <mml:msubsup>
                                            <mml:mrow>
                                              <mml:mi>d</mml:mi>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mn>2</mml:mn>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                          </mml:msubsup>
                                          <mml:mfenced close=")" open="(" separators="">
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>168</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                              <mml:mo>,</mml:mo>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>P</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mi>G</mml:mi>
                                                </mml:mrow>
                                                <mml:mrow>
                                                  <mml:mn>167</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mfenced>
                                        </mml:mtd>
                                      </mml:mtr>
                                    </mml:mtable>
                                  </mml:mrow>
                                </mml:mfenced>
                              </mml:mrow>
                              <mml:mo>⏟</mml:mo>
                            </mml:munder>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>y</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:munder>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:math>
              <graphic xlink:href="13059_2019_1872_Article_Equb.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
      </sec>
      <sec id="Sec18">
        <title>Training samples augmentation</title>
        <p>A data augmentation technique based on prior knowledge was used to further increase the training samples. If there is no bias in NGS samples, then the alignment-free dissimilarity based on NGS samples should be equal to the dissimilarity based on their genomes (<italic>d</italic>(<italic>A</italic><sub>NGS</sub>,<italic>B</italic><sub>NGS</sub>)=<italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) ⇔ Bias(<italic>A</italic><sub>NGS</sub>)=Bias(<italic>B</italic><sub>NGS</sub>)=0). Therefore, we defined a hyperparameter augmentation ratio as <italic>r</italic>, and randomly simulated <italic>d</italic><sub>1</sub> to <italic>d</italic><sub><italic>m</italic></sub> (<italic>d</italic><sub><italic>i</italic></sub>∼<italic>U</italic>(0,1)) and concatenated <italic>X</italic><sub><italic>A</italic></sub> and <italic>y</italic><sub><italic>A</italic></sub> shown as below to our training samples <italic>X</italic> and <italic>y</italic>, respectively, to fit our model. The sizes of <italic>X</italic><sub><italic>A</italic></sub> and <italic>y</italic><sub><italic>A</italic></sub> were determined by the size of training samples and augmentation ratio <italic>r</italic> where <italic>m</italic>=|<italic>X</italic>|×<italic>r</italic>.
<disp-formula id="Equc"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \underbrace{ \left[\begin{array}{ccc} d_{1} &amp; 0 &amp; 0\\ d_{2} &amp; 0&amp; 0\\ d_{3} &amp; 0&amp; 0\\ \vdots &amp; \vdots &amp; \vdots \\ d_{m} &amp; 0 &amp; 0 \end{array}\right] }_{X_{A}} \sim \underbrace{ \left[\begin{array}{c} d_{1} \\ d_{2} \\ d_{3} \\ \vdots \\ d_{m} \end{array}\right] }_{y_{A}} $$ \end{document}</tex-math><mml:math id="M398"><mml:mrow><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>∼</mml:mo><mml:munder><mml:mrow><mml:munder accentunder="false"><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mo>⏟</mml:mo></mml:munder></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow></mml:math><graphic xlink:href="13059_2019_1872_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec19">
        <title>Hyperparameter tuning and evaluation</title>
        <p>A neural network regression model with ReLU activation (sklearn.neural_network.MLPRegressor), was trained and a grid search algorithm was implemented to find the optimal combination of hyperparameters such as hidden layer sizes, regularization term, and augmentation ratio. The workflow is described below and also shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>.
<list list-type="order"><list-item><p>Twenty-eight thousand fifty-six (10%) samples were randomly selected as a held-out test set. The remaining 252,504 (90%) samples were used as a training set.</p></list-item><list-item><p>A given combination of hyperparameters was chosen. Steps 3–4 were repeated 10 times, and the average <italic>R</italic><sup>2</sup> under this combination of hyperparameters were calculated (10-fold cross-validation).</p></list-item><list-item><p>Ten percent of the samples from the training set were randomly chosen as a validation set, the other 90% of the samples were first augmented as aforementioned and then used to fit our model.</p></list-item><list-item><p>The trained model was used to predict <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) for the validation set, and <italic>R</italic><sup>2</sup> was calculated.</p></list-item><list-item><p>Repeat steps 2–4 with different hyperparameters, and the optimal combination of hyperparameters with the highest average <italic>R</italic><sup>2</sup> was chosen (hyperparameter tuning).</p></list-item><list-item><p>The optimal combination of hyperparameters was chosen, and trained on all training set, and the final model was used to predict <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) for the held-out test set and <italic>R</italic><sup>2</sup> was calculated (evaluation).</p></list-item></list>
<fig id="Fig7"><label>Fig. 7</label><caption><p>Diagram of hyperparameter tuning and evaluation. (1) Trainig set is augmented. (2) Training set after data augmentation is used to fit the model. (3) The trained model is used to predict <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) for the validation set. For each combination of hyperparameters, we repeated steps 1–3 ten times to calculate the average <italic>R</italic><sup>2</sup>, and the combination of hyperparameters with the highest average <italic>R</italic><sup>2</sup> was chosen. (4) After hyperparameter tuning, the final model is tested on the test set</p></caption><graphic xlink:href="13059_2019_1872_Fig7_HTML" id="MO7"/></fig></p>
        <p>Finally, the combination of hyperparameters with the highest cross-validation score was chosen (1 hidden layer with 2000 neurons, regularization term 0.0001, and augmentation ratio 2) and tested on the held-out test data with an <italic>R</italic><sup>2</sup> value 0.98 for <inline-formula id="IEq194"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M400"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq194.gif"/></alternatives></inline-formula> and 0.99 for <inline-formula id="IEq195"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M402"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq195.gif"/></alternatives></inline-formula>. The final models for <inline-formula id="IEq196"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{s}$\end{document}</tex-math><mml:math id="M404"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq196.gif"/></alternatives></inline-formula> and <inline-formula id="IEq197"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M406"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq197.gif"/></alternatives></inline-formula> were then used to adjust the bias for primate, mammalian, vertebrate, and white oak NGS datasets. It should be mentioned that altough <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) and <italic>d</italic>(<italic>B</italic><sub><italic>G</italic></sub>,<italic>A</italic><sub><italic>G</italic></sub>) were almost identical as shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S21, we take the average of <italic>d</italic>(<italic>A</italic><sub><italic>G</italic></sub>,<italic>B</italic><sub><italic>G</italic></sub>) and <italic>d</italic>(<italic>B</italic><sub><italic>G</italic></sub>,<italic>A</italic><sub><italic>G</italic></sub>) as the final predicted dissimilarity between A and B to strictly satisfy the symmetry property.</p>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>White oak continental origin prediction by <italic>k</italic>-NN and <inline-formula id="IEq198"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M408"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq198.gif"/></alternatives></inline-formula></title>
      <p>For each sequencing quantity (50, 100, and 300 Mbp), we first calculated the pairwise <inline-formula id="IEq199"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M410"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq199.gif"/></alternatives></inline-formula> using <italic>K</italic>=12 and <italic>M</italic>=10 between each pair of samples in the dataset. Then, 92 samples were randomly divided into the reference set and query set. The number of samples in the reference set ranges from 91 (leave-one-out), 77, 60, 45, and 30 to 15. For each sample in the query set, we found its <italic>k</italic>-nearest (<italic>k</italic>=1–10) neighbors measured by <inline-formula id="IEq200"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$d_{2}^{*}$\end{document}</tex-math><mml:math id="M412"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2019_1872_Article_IEq200.gif"/></alternatives></inline-formula> in the reference set and predicted its continental origin by a majority vote. For each reference size, we split 100 times and the prediction accuracy was averaged over 100 splits and shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. We then randomly selected 30 samples from the 50 Mbp dataset, 31 samples from the 100 Mbp dataset, and the 300 Mbp dataset as a mixed dataset. The same prediction method was used, and accuracies with and without bias adjustment were shown in Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1872_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplementary methods, supplementary figures, supplementary tables.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1872_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-019-1872-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This research utilized resources of high-performance computing (HPC), which is supported by the University of Southern California.</p>
    <sec id="d29e8691">
      <title>Review history</title>
      <p>The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref></p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>KT, JR, and FS conceived the project. KT developed the algorithm, implemented the software, carried out the computational analyses, and wrote the paper. JR revised the paper. FS led the project and finalized the paper. All authors agree to the content of the final paper. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was partially supported by the US National Science Foundation (NSF) [DMS-1518001] and National Institutes of Health (NIH) [R01GM120624, 1R01GM131407].</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>CVTree: a phylogenetic tree reconstruction tool based on whole genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <issue>suppl_2</issue>
        <fpage>W45</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh362</pub-id>
        <pub-id pub-id-type="pmid">15215347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinert</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chew</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence comparison (i): statistics and power</article-title>
        <source>J Comput Biol</source>
        <year>2009</year>
        <volume>16</volume>
        <issue>12</issue>
        <fpage>1615</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2009.0198</pub-id>
        <pub-id pub-id-type="pmid">20001252</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sims</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Jun</surname>
            <given-names>S-R</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>GA</given-names>
          </name>
          <collab>Kim</collab>
          <collab>S-H</collab>
        </person-group>
        <article-title>Alignment-free genome comparison with feature frequency profiles (FFP) and optimal resolutions</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>8</issue>
        <fpage>2677</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0813249106</pub-id>
        <pub-id pub-id-type="pmid">19188606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ives</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Surget-Groba</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cannon</surname>
            <given-names>CH</given-names>
          </name>
        </person-group>
        <article-title>An assembly and alignment-free method of phylogeny reconstruction from next-generation sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>522</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1647-5</pub-id>
        <pub-id pub-id-type="pmid">26169061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mallonee</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Bergman</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Mash: fast genome and metagenome distance estimation using Minhash</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>132</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0997-x</pub-id>
        <pub-id pub-id-type="pmid">27323842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zielezinski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karlowski</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence comparison: benefits, applications, and tools</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>186</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1319-7</pub-id>
        <pub-id pub-id-type="pmid">28974235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence analysis and applications</article-title>
        <source>Ann Rev Biomed Data Sci</source>
        <year>2018</year>
        <volume>1</volume>
        <fpage>93</fpage>
        <lpage>114</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-biodatasci-080917-013431</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sarmashghi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bohmann</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>MTP</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Skmer: assembly-free and alignment-free sample identification using genome skims</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>34</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1632-4</pub-id>
        <pub-id pub-id-type="pmid">30760303</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zielezinski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Girgis</surname>
            <given-names>HZ</given-names>
          </name>
          <name>
            <surname>Bernard</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Leimeister</surname>
            <given-names>C-A</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dencker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Röhling</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking of alignment-free sequence comparison methods</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>144</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1755-7</pub-id>
        <pub-id pub-id-type="pmid">31345254</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Comparison of metagenomic samples using sequence signatures</article-title>
        <source>BMC Genomics</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>730</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-13-730</pub-id>
        <pub-id pub-id-type="pmid">23268604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence comparison based on next-generation sequencing reads</article-title>
        <source>J Comput Biol</source>
        <year>2013</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>64</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2012.0228</pub-id>
        <pub-id pub-id-type="pmid">23383994</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cronn</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Erickson</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Milligan</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>Parker-Forney</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Spouge</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free genome comparison enables accurate geographic sourcing of white oak DNA</article-title>
        <source>BMC Genomics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>896</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-018-5253-1</pub-id>
        <pub-id pub-id-type="pmid">30526482</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karlin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Burge</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Dinucleotide relative abundance extremes: a genomic signature</article-title>
        <source>Trends Genet</source>
        <year>1995</year>
        <volume>11</volume>
        <issue>7</issue>
        <fpage>283</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1016/S0168-9525(00)89076-9</pub-id>
        <pub-id pub-id-type="pmid">7482779</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>CAFE: aCcelerated Alignment-FrEe sequence analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>W1</issue>
        <fpage>W554</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx351</pub-id>
        <pub-id pub-id-type="pmid">28472388</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ahlgren</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Fuhrman</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free oligonucleotide frequency dissimilarity measure improves prediction of hosts from metagenomically-derived viral sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>39</fpage>
        <lpage>53</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1002</pub-id>
        <pub-id pub-id-type="pmid">27899557</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Background adjusted alignment-free dissimilarity measures improve the detection of horizontal gene transfer</article-title>
        <source>Front Microbiol</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>711</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2018.00711</pub-id>
        <pub-id pub-id-type="pmid">29713314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free transcriptomic and metatranscriptomic comparison using sequencing signatures with variable length Markov chains</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>37243</fpage>
        <pub-id pub-id-type="doi">10.1038/srep37243</pub-id>
        <pub-id pub-id-type="pmid">27876823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perelman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>WE</given-names>
          </name>
          <name>
            <surname>Roos</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Seuánez</surname>
            <given-names>HN</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Moreira</surname>
            <given-names>MAM</given-names>
          </name>
          <name>
            <surname>Kessing</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Pontius</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roelke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rumpler</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A molecular phylogeny of living primates</article-title>
        <source>PLOS Genet</source>
        <year>2011</year>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>e1001342</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1001342</pub-id>
        <pub-id pub-id-type="pmid">21436896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Rosenbloom</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Raney</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Burhans</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Baertsch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Blankenberg</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>28-way vertebrate alignment and conservation track in the UCSC genome browser</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <issue>12</issue>
        <fpage>1797</fpage>
        <lpage>808</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.6761107</pub-id>
        <pub-id pub-id-type="pmid">17984227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>T-J</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y-H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L-A</given-names>
          </name>
        </person-group>
        <article-title>Optimal word sizes for dissimilarity measures and estimation of the degree of dissimilarity between DNA sequences</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>22</issue>
        <fpage>4125</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti658</pub-id>
        <pub-id pub-id-type="pmid">16144805</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Optimal choice of word length when comparing two Markov sequences using a <italic>χ</italic><sup>2</sup>-statistic</article-title>
        <source>BMC Genomics</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>6</issue>
        <fpage>732</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-017-4020-z</pub-id>
        <pub-id pub-id-type="pmid">28984181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>Art: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>28</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <mixed-citation publication-type="other">ID 269970 - BioProject - NCBI. USDA Forest Service. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA269970">https://www.ncbi.nlm.nih.gov/bioproject/PRJNA269970</ext-link>. Accessed 13 Oct 2019.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <mixed-citation publication-type="other">Tang K, Ren J, Sun F. Afann: bias adjustment for alignment-free sequence comparison based on sequencing data using neural network regression. Github. 2019. <ext-link ext-link-type="uri" xlink:href="https://github.com/GeniusTang/Afann">https://github.com/GeniusTang/Afann</ext-link>. Accessed 13 Oct 2019.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <mixed-citation publication-type="other">Tang K, Ren J, Sun F. Afann: bias adjustment for alignment-free sequence comparison based on sequencing data using neural network regression. Zenodo. 2019. 10.5281/zenodo.3483847. Accessed 13 Oct 2019.</mixed-citation>
    </ref>
  </ref-list>
</back>
