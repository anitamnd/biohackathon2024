<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7850135</article-id>
    <article-id pub-id-type="pmid">32726397</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa661</article-id>
    <article-id pub-id-type="publisher-id">btaa661</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FANCY: fast estimation of privacy risk in functional genomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gürsoy</surname>
          <given-names>Gamze</given-names>
        </name>
        <aff><institution>Computational Biology and Bioinformatics</institution>, New Haven, CT 06520, <country country="US">USA</country></aff>
        <aff><institution>Molecular Biophysics and Biochemistry</institution>, New Haven, CT 06520, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brannon</surname>
          <given-names>Charlotte M</given-names>
        </name>
        <aff><institution>Computational Biology and Bioinformatics</institution>, New Haven, CT 06520, <country country="US">USA</country></aff>
        <aff><institution>Molecular Biophysics and Biochemistry</institution>, New Haven, CT 06520, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Navarro</surname>
          <given-names>Fabio C P</given-names>
        </name>
        <aff><institution>Computational Biology and Bioinformatics</institution>, New Haven, CT 06520, <country country="US">USA</country></aff>
        <aff><institution>Molecular Biophysics and Biochemistry</institution>, New Haven, CT 06520, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Gerstein</surname>
          <given-names>Mark</given-names>
        </name>
        <xref rid="btaa661-cor1" ref-type="corresp"/>
        <aff><institution>Computational Biology and Bioinformatics</institution>, New Haven, CT 06520, <country country="US">USA</country></aff>
        <aff><institution>Molecular Biophysics and Biochemistry</institution>, New Haven, CT 06520, <country country="US">USA</country></aff>
        <aff><institution>Computer Science, Yale University</institution>, New Haven, CT 06520, <country country="US">USA</country></aff>
        <!--mark@gersteinlab.org-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa661-cor1">To whom correspondence should be addressed. <email>mark@gersteinlab.org</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-07-29">
      <day>29</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <volume>36</volume>
    <issue>21</issue>
    <fpage>5145</fpage>
    <lpage>5150</lpage>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>16</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>11</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa661.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Functional genomics data are becoming clinically actionable, raising privacy concerns. However, quantifying privacy leakage via genotyping is difficult due to the heterogeneous nature of sequencing techniques. Thus, we present FANCY, a tool that rapidly estimates the number of leaking variants from raw RNA-Seq, ATAC-Seq and ChIP-Seq reads, without explicit genotyping. FANCY employs supervised regression using overall sequencing statistics as features and provides an estimate of the overall privacy risk before data release.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>FANCY can predict the cumulative number of leaking SNVs with an average 0.95 <italic toggle="yes">R</italic><sup>2</sup> for all independent test sets. We realize the importance of accurate prediction when the number of leaked variants is low. Thus, we develop a special version of the model, which can make predictions with higher accuracy when the number of leaking variants is low.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>A python and MATLAB implementation of FANCY, as well as custom scripts to generate the features can be found at <ext-link xlink:href="https://github.com/gersteinlab/FANCY" ext-link-type="uri">https://github.com/gersteinlab/FANCY</ext-link>. We also provide jupyter notebooks so that users can optimize the parameters in the regression model based on their own data. An easy-to-use webserver that takes inputs and displays results can be found at fancy.gersteinlab.org.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>US National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>K99 HG010909</award-id>
        <award-id>R01 HG010749</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>AL Williams Professorship</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>With the surge of genomics data and the decreasing cost of sequencing (<xref rid="btaa661-B17" ref-type="bibr">Sboner <italic toggle="yes">et al.</italic>, 2011</xref>), genome privacy is an increasingly important area of study. Traditional DNA sequencing, functional genomics (<xref rid="btaa661-B6" ref-type="bibr">Harmanci and Gerstein, 2018</xref>) and molecular phenotype (<xref rid="btaa661-B5" ref-type="bibr">Harmanci and Gerstein, 2016</xref>; <xref rid="btaa661-B18" ref-type="bibr">Schadt <italic toggle="yes">et al.</italic>, 2012</xref>) datasets create quasi-identifiers, which in turn can be used to re-identify or characterize individuals without their consent. The surge in widely available functional genomics data increases correlations between phenotype and genotype datasets, which amplifies the possibility of re-identification and characterization of the individuals who participate in these studies. Functional genomics data allow for a detailed characterization of disease states and susceptibility, and broad dissemination of this data can promote key scientific advances. Unlike DNA sequencing, functional genomics experiments are not performed for genotyping purposes (rather, for understanding phenotypes and basic biology). Yet, they still yield next-generation sequencing reads containing a substantial amount of patients’ variants, which raises privacy concerns. Thus, there is a trade-off between utility and privacy when it comes to sharing functional genomics data. This trade-off can be difficult for scientists to navigate. For example, scientific funding agencies’ data-sharing and privacy policies about controlled-access can prevent the release of data, sometimes as late as after the relevant article has published (<xref rid="btaa661-B15" ref-type="bibr">NIH, 2018</xref>).</p>
    <p>In contrast to DNA sequencing-based data, such as genome-wide association study (GWAS), few tools currently exist to assess the risk of privacy loss from functional genomics data. In order to protect patient privacy while promoting scientific progress through data-sharing, it is essential that we develop robust methods for making these assessments. Such assessments may bolster informed consent and empower scientists to plan functional genomics experiments with patient privacy in mind. Previous studies suggest that 30–80 independent single nucleotide polymorphisms (SNPs) can be enough to re-identify an individual (<xref rid="btaa661-B12" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2004</xref>). Although the majority of genome-wide functional genomics datasets will likely contain more than 80 SNPs, the number of required SNPs to re-identify individuals are highly dependent on the number of individuals sequenced in other databases. It is envisioned that more individuals will be sequenced moving forward and more SNPs will be needed to re-identify individuals in these databases. Therefore, estimating the number of SNPs leaked in omics datasets is important for understanding the risk of privacy. In addition, another privacy risk to the participants is the risk of characterization, i.e. the risk of inferring stigmatizing phenotypes by using the genotype–phenotype relationship. Clearly, the more variants leaked, the greater the chances of being characterized (e.g. through GWAS overlap). In this sense, knowing the number of variants that leak in a given functional genomics dataset helps us to understand the loss of privacy.</p>
    <p>Before the release of data from a functional genomics experiment, it is essential to be able to rapidly quantify the number of leaking variants. This is particularly important as different assays target different regions of the genome with different coverage profiles [e.g. RNA sequencing (RNA-Seq) targets expressed exons, whereas H3K27ac chromatin immunoprecipitation sequencing (ChIP-Seq) targets the non-coding genome on the promoter and enhancer regions] and depth profiles (i.e. some assays have spread out peaks while others are more punctuated). The quantification of the number of leaking variants is possible by genotyping the raw sequences and overlapping them with gold-standard genotypes (e.g. those obtained from whole-genome sequencing). The use of a gold-standard is necessary because functional genomics data alone provides a less reliable picture of an individual’s genotypes, and may lead to false positives due to the targeted nature of the assays. For example, it has been shown that the variants called using RNA-Seq data of 432 individuals from the gEUVADIS project (<xref rid="btaa661-B9" ref-type="bibr">Lappalainen <italic toggle="yes">et al.</italic>, 2013</xref>) have a precision of <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> (<xref rid="btaa661-B4" ref-type="bibr">Gursoy <italic toggle="yes">et al.</italic>, 2019</xref>). The limitations of directly genotyping the functional genomics dataset are (i) the large resources required for genotyping-in principle, it is possible to genotype the raw reads with current genotyping tools, but an average variant calling pipeline would need to be radically re-parameterized to suit different assays, as traditional genotyping software are typically optimized for whole-genome sequencing and (ii) the need for a gold-standard genotype dataset belonging to the patient to check the correctness of the called variants, which may not be readily available in every case.</p>
    <p>In this study, we developed <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:math></inline-formula>, a supervised learning method to infer the number of leaking single nucleotide variants (SNVs) from reference-aligned functional genomics data. Our primary goal was to quantify the SNV leaks in raw sequences without needing genotyping or a gold-standard genotype list. We built a Gaussian Process Regression (GPR) model that takes the assay type, sequencing features, such as mean depth (<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>) and breadth (<italic toggle="yes">b</italic>) of the coverage, and the statistical properties of the depth distribution, such as standard deviation(<italic toggle="yes">σ</italic>), skewness (<inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mo>±</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>) and kurtosis(<italic toggle="yes">k</italic>) as input, and predicts the cumulative number of leaking SNVs. <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:math></inline-formula> can separately estimate the number of rare and common variants, and outputs each estimated number with a predicted upper and lower bound in the 95% confidence level. In addition to estimating privacy risk, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:math></inline-formula> can be used to plan functional genomics experiments; for a target number of SNVs, one can back-calculate the required sequencing statistics. The privacy risk assessment is of critical value when the number of leaking variants is low, as in critical ranges, leakage of a few additional variants can change the status of the privacy risk from ‘can be shared’ to ‘cannot be shared’. Therefore, we also trained our model with data that has SNV leakage fewer than 1000 variants to obtain more accurate results in the lower ranges. This model is called <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. A user can first predict the leakage with <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:math></inline-formula>. If the number of predicted SNVs is below 1000, the user can then use <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to fine-tune the accuracy of the prediction.</p>
    <p>In addition to <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:math></inline-formula>, we also developed a Random Forest classifier plug-in that predicts the type of assay [RNA-Seq versus Assay for Transposase-Accessible Chromatin using sequencing (ATAC-Seq) versus ChIP-Seq] used to obtain a given dataset by using the sequencing statistics as features. This kind of reverse identification of data may be useful to the community for samples with missing metadata.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:math></inline-formula> details</title>
      <p><inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:math></inline-formula> is a two-step method. The first step is a regression framework that uses a GPR model with a Matern kernel (<xref rid="btaa661-B16" ref-type="bibr">Rasmussen and Williams, 2006</xref>). We obtained the features as follows: we first aligned the raw functional genomics reads to the reference genome [bwa (<xref rid="btaa661-B10" ref-type="bibr">Li and Durbin, 2009</xref>) is used for ChIP and ATAC-seq data; STAR (<xref rid="btaa661-B3" ref-type="bibr">Dobin <italic toggle="yes">et al.</italic>, 2013</xref>) is used for RNA-Seq data]. We then calculated the depth per base pair using samtools (<xref rid="btaa661-B11" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2009</xref>) and calculated the following statistics: depth (<inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>) and breadth (<italic toggle="yes">b</italic>) of the coverage, and the statistical properties of the depth distribution, such as standard deviation(<italic toggle="yes">σ</italic>), skewness (<inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mo>±</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>) and kurtosis(<italic toggle="yes">k</italic>) (<xref rid="btaa661-F1" ref-type="fig">Fig. 1a</xref>). For the true number of SNVs, we used GATK (<xref rid="btaa661-B2" ref-type="bibr">DePristo <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btaa661-B1" ref-type="bibr">Van der Auwera <italic toggle="yes">et al.</italic>, 2013</xref>) (with appropriate parameterization for each assay type) to call the SNVs. After filtering low-quality SNVs as suggested by the GATK Best Practices (<xref rid="btaa661-B2" ref-type="bibr">DePristo <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btaa661-B1" ref-type="bibr">Van der Auwera <italic toggle="yes">et al.</italic>, 2013</xref>), we overlapped the remaining SNVs with the gold-standard SNVs generated from whole-genome sequencing data to obtain the true number of leaking SNVs (<xref rid="btaa661-F1" ref-type="fig">Fig. 1c</xref>). The second step is the estimation of rare versus common variants. We divided the 1000 Genomes data (<xref rid="btaa661-B19" ref-type="bibr">The 1000 Genomes Project Consortium, 2010</xref>) into rare and common categories based on minor allele frequency of the SNVs. For each individual in the 1000 Genomes Project (<xref rid="btaa661-B19" ref-type="bibr">The 1000 Genomes Project Consortium, 2010</xref>), given an assay, we found the rare variant density and used the mean density of all individuals with the predicted number of total leaking variants to estimate the number of rare versus common variants.
</p>
      <fig position="float" id="btaa661-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Details of FANCY. (<bold>a</bold>) The schematic of the features of FANCY: average depth; breadth, i.e. number of nucleotides represented with at least one read; first, second and third moment of the depth distribution (SD, skewness and kurtosis). If the distribution is skewed to the right-hand side of the mode (mean is larger than the mode), the skewness is positive. It is negative if the mean is smaller than the mode. (<bold>b</bold>) The schematic of inputs and outputs of FANCY. (<bold>c</bold>) The process of determining true number of leaking variants from functional genomics reads. (<bold>d</bold>) The regions represented by each assay type. The reads of RNA-Seq are concentrated on the gene bodies, H3K27ac ChIP-Seq is concentrated on the non-coding genome (enhancers and promoters), and because ATAC-Seq covers the open chromatin, the reads are concentrated on both coding and non-coding regions</p>
        </caption>
        <graphic xlink:href="btaa661f1" position="float"/>
      </fig>
      <p><inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> uses the same regressor with the same set of features. However, the training data used in <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> contains leaking SNVs up to 1000 to increase the accuracy when the number of leaking variants is low.</p>
    </sec>
    <sec>
      <title>2.2 Gaussian process regression</title>
      <p>GPR is a supervised learning method that is based on learning fitting functions to a given set of training data. In comparison, traditional regression models learn the parameters of a given function. GPR is a non-parametric method used to calculate the probability distribution over all functions that fit the data instead of calculating the probability distribution of a specific function’s parameters. The advantage of using GPR is its ability to provide uncertainty estimations at a given confidence level. The disadvantage of this method is the computational complexity, which makes it infeasible for large datasets. Since the sequencing statistics relate to the number of inferred variants differently in different regimes and for different assays (<xref rid="btaa661-F1" ref-type="fig">Fig. 1c</xref>), the relationship between features and the number of leaking variants cannot be modeled by general mathematical approaches, such as generalized linear models (<xref rid="btaa661-F2" ref-type="fig">Fig. 2</xref>). A Gaussian process can be defined by its mean and covariance functions as
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <fig position="float" id="btaa661-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Relationship between sequencing statistics and number of leaking variants. Overall, breadth of the coverage has the highest correlation with the number of leaking variants, while other statistics still show a decent correlation</p>
        </caption>
        <graphic xlink:href="btaa661f2" position="float"/>
      </fig>
      <p>A Gaussian process assumes that the distribution of the values of functions <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at a set of points <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is jointly Gaussian with a mean <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and covariance <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. <italic toggle="yes">K</italic> is a kernel function, which determines the similarity between data points <italic toggle="yes">x<sub>i</sub></italic> and <italic toggle="yes">x<sub>j</sub></italic>. If these points are deemed similar by the kernel, we expect the output of the functions at these points to be similar as well. For each <italic toggle="yes">x<sub>i</sub></italic>, <italic toggle="yes">y<sub>i</sub></italic> in our training dataset, we can write a function <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> such that
<disp-formula id="E2"><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ϵ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Therefore, for any input vector <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <italic toggle="yes">f</italic>(<italic toggle="yes">x</italic>) has a joint Gaussian distribution. The covariance (kernel) function <italic toggle="yes">k</italic> is generally taken as Gaussian (i.e. squared exponential kernel). However, in this application, we found that a Matern kernel performs better. We used 5-fold cross-validation to avoid over-fitting and a separate test dataset to validate our model. We tried other regression models, such as linear regression with and without interactions, different regression trees, neural networks and support vector machine (SVM) regression models. GPR outperformed other models in training [both in terms of root-mean-squared error (RMSE) and <italic toggle="yes">R</italic><sup>2</sup>, <italic toggle="yes">P</italic>-value &lt;<inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mo>−</mml:mo></mml:msup><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>; see <xref rid="btaa661-T1" ref-type="table">Table 1</xref> for results and <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref> for statistics]. We have also compared the training times of different regression models in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>.
</p>
      <table-wrap position="float" id="btaa661-T1">
        <label>Table 1.</label>
        <caption>
          <p>Comparison of different regression model performances on training dataset</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="±" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Model</th>
              <th align="center" rowspan="1" colspan="1">RMSE</th>
              <th rowspan="1" colspan="1"><italic toggle="yes">R</italic>
 <sup>2</sup></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Linear regression</td>
              <td rowspan="1" colspan="1">8066.4±7.03</td>
              <td rowspan="1" colspan="1">0.96</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Decision tree</td>
              <td rowspan="1" colspan="1">5559.0±90.82</td>
              <td rowspan="1" colspan="1">0.98</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Boosted tree</td>
              <td rowspan="1" colspan="1">66518.8±8.19</td>
              <td rowspan="1" colspan="1">0.98</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Bagged tree</td>
              <td rowspan="1" colspan="1">5148.4±37.86</td>
              <td rowspan="1" colspan="1">0.98</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SVM</td>
              <td rowspan="1" colspan="1">5754.5±13.96</td>
              <td rowspan="1" colspan="1">0.99</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">NeuralNet</td>
              <td rowspan="1" colspan="1">8190.7±799.37</td>
              <td rowspan="1" colspan="1">0.99</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GPR</td>
              <td rowspan="1" colspan="1">4302.3±14.20</td>
              <td rowspan="1" colspan="1">0.96</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>2.3 Dataset</title>
      <p>We used RNA-Seq data from 432 individuals generated by the gEUVADIS project (<xref rid="btaa661-B9" ref-type="bibr">Lappalainen <italic toggle="yes">et al.</italic>, 2013</xref>), H3K27ac ChIP-Seq data from 100 individuals generated by the PsychENCODE Consortium (<xref rid="btaa661-B20" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2018</xref>), ATAC-Seq data from 344 individuals generated by the BrainGVEX project(<xref rid="btaa661-B20" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2018</xref>) and ATAC-Seq data from 288 individuals generated by the PsychENCODE Consortium (<xref rid="btaa661-B20" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2018</xref>). We then used the GATK Best Practices from RNA-Seq and DNA data (<xref rid="btaa661-B2" ref-type="bibr">DePristo <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btaa661-B1" ref-type="bibr">Van der Auwera <italic toggle="yes">et al.</italic>, 2013</xref>) to call SNVs and small insertions and deletions (<xref rid="btaa661-F3" ref-type="fig">Fig. 3</xref>). We treated each chromosome separately, which resulted in 25 152 data points. In total, we had 13 537 data points from ATAC-Seq, 9456 data points from RNA-Seq and 2159 from ChIP-Seq. We randomly divided the entire dataset in half to use as training and test sets, which preserved the ratio of each assay type in training and test sets. We used 5-fold cross-validation while training on the training dataset to prevent over-fitting. We also separately validated our model by using 308 data points from the RNA-Seq study by <xref rid="btaa661-B7" ref-type="bibr">Kilpinen <italic toggle="yes">et al.</italic> (2013)</xref>. Since there is an imbalance in the number of datapoints coming from different assays, we wanted to understand if such imbalance is affecting our model selection. To this end, we repeatedly sub-sampled 2159 data points from the RNA-Seq and ATAC-Seq categories (to match it to the most under-represented category of ChIP-Seq) and trained multiple regression models. We found that GPR is still the best regression model with the smallest RMSE in each case (<italic toggle="yes">P</italic>-value &lt;<inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mo>−</mml:mo></mml:msup><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>; see <xref rid="btaa661-T2" ref-type="table">Table 2</xref> for results and <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S4 and S5</xref> for statistics).
</p>
      <fig position="float" id="btaa661-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Distribution of the number of called SNPs and indels from functional genomics data. We used the GATK Best Practices from RNA-Seq and DNA data to call SNVs and small insertions and deletions</p>
        </caption>
        <graphic xlink:href="btaa661f3" position="float"/>
      </fig>
      <table-wrap position="float" id="btaa661-T2">
        <label>Table 2.</label>
        <caption>
          <p>Comparison of different regression model performances when the training data are sub-sampled</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="±" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Model</th>
              <th rowspan="1" colspan="1">RMSE</th>
              <th rowspan="1" colspan="1"><italic toggle="yes">R</italic>
 <sup>2</sup></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Linear regression</td>
              <td rowspan="1" colspan="1">6714.5±21.74</td>
              <td rowspan="1" colspan="1">0.95</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Decision tree</td>
              <td rowspan="1" colspan="1">7133.8±121.86</td>
              <td rowspan="1" colspan="1">0.94</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Boosted tree</td>
              <td rowspan="1" colspan="1">6708.1±53.98</td>
              <td rowspan="1" colspan="1">0.95</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Bagged tree</td>
              <td rowspan="1" colspan="1">6923.6 ±135.39</td>
              <td rowspan="1" colspan="1">0.95</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SVM</td>
              <td rowspan="1" colspan="1">7903.8±197.08</td>
              <td rowspan="1" colspan="1">0.93</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">NeuralNet</td>
              <td rowspan="1" colspan="1">8376.1±973.26</td>
              <td rowspan="1" colspan="1">0.92</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GPR</td>
              <td rowspan="1" colspan="1">5474.1±65.74</td>
              <td rowspan="1" colspan="1">0.97</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>2.4 Random Forest details</title>
      <p>Random Forest was used as a plug-in to <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:math></inline-formula> in order to predict the assay type of the data from the sequencing statistics in the case that metadata is missing. Random Forest classifiers combine several decision trees that use multiple subsets of data from a training sample to produce better predictive performance than that of a single decision tree. The advantage of a Random Forest classifier is that it handles high dimensionality in data, as well as missing values. It works via the following principles: assume we have an observation <italic toggle="yes">y<sub>i</sub></italic> and the feature associated with it is <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Here, <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">N</italic> and <italic toggle="yes">M</italic> are the number of observations and features, respectively. We first take a subset from <italic toggle="yes">N</italic> number of training data randomly with replacement. We then take a subset of <italic toggle="yes">M</italic> features randomly. We split the node iteratively by finding the feature associated with the best split. With this iteration, we grow the largest tree. We then repeat these steps to aggregate <italic toggle="yes">n</italic> number of trees to create our Random Forest. We generated 30 trees using a 5-fold cross-validation and an independent test set to validate our model.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>Genotyping from DNA sequences is the process of comparing the DNA sequence of an individual to that of the reference human genome. To be able to successfully genotype, one needs a substantial depth of sequencing reads for each base pair. According to the Lander–Waterman statistics for DNA sequencing, when random chunks of DNA are sequenced repeatedly, the depth per base pair follows a Poisson distribution with a mean that can be estimated from the read length, number of reads and the length of the genome (<xref rid="btaa661-B8" ref-type="bibr">Lander and Waterman, 1988</xref>). For example, as RNA-Seq aims to sequence expressed genes, one would expect that sequencing depth per base pair does not follow Poisson statistics. Genotyping using reads from RNA-Seq experiments is biased toward variants that are in the exonic regions. Conversely, ChIP-Seq is biased against RNA-Seq, as it targets non-coding genome, such as promoters and enhancers (see <xref rid="btaa661-F1" ref-type="fig">Fig. 1d</xref>).</p>
    <p>We hypothesized that the statistical properties of the depth per base pair distribution are strong indicators of the number of variants that can be inferred from functional genomics data. We used a total of six sequencing features: (i) the average depth per base pair (<inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>); (ii) the total fraction of the genome that is represented at least by one read [i.e. the breadth, <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, such that <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, <italic toggle="yes">b</italic> = 0 otherwise and <italic toggle="yes">N</italic> is the total number of nucleotides in the genome]; (iii) the SD of the depth distribution; (iv) skewness (i.e. whether the distribution is larger on the right or left side of the mean); (v) kurtosis (i.e. whether or not the depth distribution has big tails); and (vi) the type of the experiment (i.e. RNA-Seq, ATAC-Seq or ChIP-Seq).</p>
    <p>FANCY predicts the cumulative number of leaking SNVs with an <italic toggle="yes">R</italic><sup>2</sup> of 0.99 for training (with 5-fold cross-validation) and 0.90 for independent test RNA-Seq, 0.99 for independent test ATAC-Seq and 0.99 for independent test ChIP-Seq datasets (<xref rid="btaa661-F4" ref-type="fig">Fig. 4</xref> and <xref rid="btaa661-T3" ref-type="table">Table 3</xref>). We used mean squared error as our loss function in the regression model (see <xref rid="btaa661-T1" ref-type="table">Tables 1–3</xref> for RMSE). Our predictions are in strong agreement with the true number of leaking variants in all the independent test datasets (<xref rid="btaa661-F4" ref-type="fig">Fig. 4a</xref>). To easily interpret the performance of our predictions, we calculated the deviation from the true values by calculating <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">y</italic><sub>p</sub> is the predicted value and <italic toggle="yes">y</italic><sub>r</sub> is the real value of the number of SNPs. The negative values indicate under-prediction (i.e. the number of predicted SNVs is lower than the true number of leaking SNVs). On average, we had 8% prediction error for all of the independent test sets (<xref rid="btaa661-F4" ref-type="fig">Fig. 4b</xref>).
</p>
    <fig position="float" id="btaa661-F4">
      <label>Fig. 4.</label>
      <caption>
        <p>Details of FANCY. (<bold>a</bold>) The performance of FANCY on the independent test datasets. (<bold>b</bold>) The ratio of the error in the predictions with respect to true values. Negative values indicate that the predicted values are lower than the true values, and positive values indicate the predicted values are greater than the true values. Zero indicates perfect prediction</p>
      </caption>
      <graphic xlink:href="btaa661f4" position="float"/>
    </fig>
    <table-wrap position="float" id="btaa661-T3">
      <label>Table 3.</label>
      <caption>
        <p>The maximum and minimum number of variants leaked in each experiment and the RMSE of our predictions in these test datasets</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col valign="top" align="left" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
          <col valign="top" align="center" span="1"/>
          <col valign="top" align="char" char="." span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th rowspan="1" colspan="1">Assay</th>
            <th rowspan="1" colspan="1">Number of test</th>
            <th rowspan="1" colspan="1">Max. number</th>
            <th rowspan="1" colspan="1">Min. number</th>
            <th rowspan="1" colspan="1">Total number</th>
            <th rowspan="1" colspan="1">RMSE</th>
          </tr>
          <tr>
            <th rowspan="1" colspan="1"/>
            <th rowspan="1" colspan="1">data points</th>
            <th rowspan="1" colspan="1">of variants</th>
            <th rowspan="1" colspan="1">of variants</th>
            <th rowspan="1" colspan="1">of variants</th>
            <th rowspan="1" colspan="1"/>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">RNA-Seq</td>
            <td rowspan="1" colspan="1">4740</td>
            <td rowspan="1" colspan="1">12 928</td>
            <td rowspan="1" colspan="1">379</td>
            <td rowspan="1" colspan="1">12 062 696</td>
            <td rowspan="1" colspan="1">422.76</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">ATAC-Seq</td>
            <td rowspan="1" colspan="1">6753</td>
            <td rowspan="1" colspan="1">238 481</td>
            <td rowspan="1" colspan="1">65</td>
            <td rowspan="1" colspan="1">339 606 218</td>
            <td rowspan="1" colspan="1">4503.10</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">ChIP-Seq</td>
            <td rowspan="1" colspan="1">1082</td>
            <td rowspan="1" colspan="1">210 567</td>
            <td rowspan="1" colspan="1">2665</td>
            <td rowspan="1" colspan="1">57 921 174</td>
            <td rowspan="1" colspan="1">5381.22</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>We also assessed the performance of our model on RNA-Seq data that was obtained using different experimental protocols. We were able to test FANCY on poly-A minus, poly-A plus and total RNA-Seq data obtained by different labs. The selection of these test datasets was limited by the number of available functional genomics datasets with accompanying WGS data (required for the validation of our model). We found that our model works equally well with independent datasets obtained using different protocols than those used to obtain the training data (<italic toggle="yes">R</italic><sup>2</sup> 0.97–0.98, see <xref rid="btaa661-F5" ref-type="fig">Fig. 5</xref>).
</p>
    <fig position="float" id="btaa661-F5">
      <label>Fig. 5.</label>
      <caption>
        <p>Performance of FANCY on different RNA-Seq protocols. The performance of FANCY on the independent test RNA-Seq datasets that were obtained using different protocols and in different labs &amp; consortia</p>
      </caption>
      <graphic xlink:href="btaa661f5" position="float"/>
    </fig>
    <p>If a functional genomics experiment is leaking more than 1000 variants, the associated privacy risk for re-identification and characterization is at the maximum, regardless of the absolute value of the number of variants. However, re-identification might require a lower number of leaking variants than characterization. Thus, the risk assessment for re-identification can be more valuable for experiments that are leaking a low number of variants, as mis-predicting these values only slightly may result in the release of private data. Thus, we developed another regression model (see Section 2) that aims to predict the leakage more precisely when the number of leaking variants is low. This second model had an RMSE of 75.64, 74.8 and 74.0 for independent test RNA-Seq, ATAC-Seq and ChIP-Seq datasets, respectively, in which the maximum number of leaking variants is 1000 (<xref rid="btaa661-F5" ref-type="fig">Figs 6</xref>). We also calculated the number of under-predicted (predicted value is lower than true value) leaking variants and found that we have no under-predicted leaking variants when the total number of leaking variants is lower than 400, and only three under-predicted leaking variants when the total number of leaking variants is between 400 and 500. Moreover, both FANCY and <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> can also output the number of leaking variants within 95% confidence interval (<xref rid="btaa661-F7" ref-type="fig">Fig. 7</xref>).
</p>
    <fig position="float" id="btaa661-F6">
      <label>Fig. 6.</label>
      <caption>
        <p>Performance of <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> when the number of leaked variants is &lt;1000. Performance for the test dataset, RNA-Seq, ATAC-Seq and ChIP-Seq are shown separately. For RNA-Seq, we validated our model with two datasets, shown in red and black. (Color version of this figure is available at <italic toggle="yes">Bioinformatics</italic> online.)</p>
      </caption>
      <graphic xlink:href="btaa661f6" position="float"/>
    </fig>
    <fig position="float" id="btaa661-F7">
      <label>Fig. 7.</label>
      <caption>
        <p>Predicted versus true values within 95% confidence level</p>
      </caption>
      <graphic xlink:href="btaa661f7" position="float"/>
    </fig>
    <p>To further understand the role of the features on the prediction performance, we did a ‘leave one feature out’ test and found that the mean depth (<inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>) and breadth (<italic toggle="yes">b</italic>) of the coverage had the greatest effect on the performance of the predictor (<xref rid="btaa661-F7" ref-type="fig">Fig. 8a</xref>) 8. We then created predictors by using only (i) mean depth, (ii) breadth and (iii) mean depth and breadth as the features. However, these predictors performed worse than the original model (<xref rid="btaa661-F8" ref-type="fig">Fig. 8a</xref>). These results show that although breadth is the highest contributing feature, all of our features contributed to the final model; indeed, the RMSE is the lowest when we use all of the features (<xref rid="btaa661-F8" ref-type="fig">Fig. 8a</xref>, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref> for the statistics). We further changed the depth cut-off used for defining the breadth of the coverage from 1 to 2, 4 and 8 and re-trained a model using the 9456 data points from RNA-Seq data. We found that although overall performance of the regression slightly improved, the best performance was still obtained when we used all of the features (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). This is likely because the correlation between the breadth (feature) and the number of SNPs (outcome) is only slightly improved when we use different thresholds (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). In addition to estimating privacy risk, FANCY can also be used to plan functional genomics experiments (i.e. for a target number of callable SNVs, one can back-calculate the required sequencing statistics). This can be done by using the empirical depth distribution of available data from different assays and calculating the required number of reads to reach the desired statistical properties, such as mean depth, skewness and kurtosis. Moreover, we also developed a Random Forest classifier as a plug-in that predicts the type of the assay (RNA-Seq versus ATAC-Seq versus ChIP-Seq) by using the sequencing statistics as features, which can be broadly useful to the community for characterizing samples with missing metadata. This classifier has an average accuracy of 96.8%, precision of 94.9%, recall of 90.2% and <italic toggle="yes">F</italic>1 score of 93.3% (<xref rid="btaa661-F8" ref-type="fig">Fig. 8b</xref>).
</p>
    <fig position="float" id="btaa661-F8">
      <label>Fig. 8.</label>
      <caption>
        <p>Feature importance and classifier performance. (<bold>a</bold>) Lower RMSE corresponds to better predictions. The difference between the first five points on the figure is smaller compared to other data points, however, lowest RMSE is still observed when using all the features in the model. (<bold>b</bold>) A Random Forest Classifier is developed to predict the type of the experimental assay by using sequencing statistics as features. Here we show the performance of this classifier</p>
      </caption>
      <graphic xlink:href="btaa661f8" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>How can we quantify the privacy risk that accompanies collection and sharing of functional genomics data? In this study, we addressed this question with FANCY, a model using GPR followed by rare versus common variant estimation to predict the number of total leaking variants in a functional genomics dataset. We showed that this prediction can be generated with high accuracy without relying on genotyping or a gold-standard genotype list, which requires significant resources to obtain and may not always be obtainable for every individual. We determined that the depth and breadth of sequencing coverage had the greatest influence on the predictor, and that using all of the features yielded the most accurate prediction. Not only does FANCY quantify the risk of privacy leaks from an existing dataset, but it also allows experimentalists to design functional genomics sequencing experiments, before collecting data, with the goal of obtaining a desired number of variants.</p>
    <p>In this study, we used available data types from different projects, including RNA-Seq, ATAC-Seq and ChIP-Seq H3K27ac. However, as sequencing costs decrease, we will soon have access to a surge of datasets from a wider range of experimental protocols using large cohorts of individuals (e.g. 10x single-cell RNA-Seq, different ChIP-Seq targets, etc.). Therefore, we also provide users our workflow and source code, which can be used as a base framework to adapt prediction methods according to the ever evolving privacy landscape.</p>
    <p>FANCY can also be used to accelerate sharing of functional genomics datasets. Functional genomics researchers may want to share their data alongside their published results. However, funding agencies’ data-sharing policies typically require extensive privacy risk assessments before the data are released. These assessments can be lengthy and costly, and can significantly delay data release (sometimes until after the relevant article has been published) (<xref rid="btaa661-B13" ref-type="bibr">Mailman <italic toggle="yes">et al.</italic>, 2007</xref>). Our tool will allow for fast assessments of privacy risk in functional genomics datasets, which will permit faster release of data. After FANCY, further assessments may be done of the data with significant risk.</p>
    <p>If a functional genomics dataset leaks more than 1000 variants, the risk of re-identifying an individual from that dataset is maximized. However, when the number of leaking variants is low, the qualitative measurements of sharing risk commonly given in consent documents may not be accurate and will not give the individual a sense of the true risk of privacy loss. Therefore, we designed <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>FANCY</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>low</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, a specially modified version of FANCY with improved precision just for a low number of leaking variants. Given that an individual’s privacy is at stake, it was important to minimize under-predictions of leaking variants as this could lead to a dataset being labeled safe to share when it actually permits re-identification.</p>
    <p>Privacy protection is the core goal of developing FANCY and related tools, but they have other uses in genomics research. In cases where whole-genome sequence data are missing, e.g. FANCY can also be used to determine whether SNP calling is possible using a particular dataset. Additionally, our Random Forest Classifier, which we developed alongside FANCY, can be used to identify the kind of experiment a dataset came from in the case of missing metadata. This latter tool does not protect privacy, but helps to maximize data utility.</p>
    <p>One limitation of the current version of FANCY is the lack of joint predictions of the same sample from different assays. We envision that in the future multiple assays will be performed on samples from the same individuals. In other words, a single data type may not leak enough variants for privacy to be a concern, but a combination of different functional genomics data can pose significant privacy risk. Some of these assays likely contain overlapping SNPs, but such overlap can easily be estimated by using the overlapping signal coverage and incorporated into the FANCY framework.</p>
    <p>We understand that genome privacy is a complex issue and can be discussed beyond the number of leaking SNVs. For example, data from an experiment may leak a small number of SNVs, but when overlapped with GWAS results can reveal sensitive information about the individual, such as risk for a particular stigmatizing disease. Because the SNVs obtained from functional genomics experiments are likely present in the functional regions of the genome, we believe that quantifying the number of leaked SNVs will be a useful initial assessment of the risk of privacy loss.</p>
    <p>We also think that our training data will be useful to the community. For example, even before mapping the reads to the genome, one can look at the training data to see roughly how many reads in an assay type lead to how much leakage in order to have a rough estimate and then perform the mapping and FANCY calculations if more precision is needed.</p>
    <p>The privacy risk associated with human DNA sequencing has been acknowledged for years. Yet, as scientists have become increasingly interested in a more diverse set of experimental human omics data, it is critical to develop companion tools to assess the privacy risk of those data. In this study, we contribute FANCY to the toolbox. Importantly, these tools must be convenient for scientists to use and easy for patients/individuals to understand. FANCY requires only a few files and can be run easily from the command line. Furthermore, we set up a simple web page, which allows users to input statistics about their dataset and runs FANCY to output a leakage prediction and qualitative privacy risk assessment. These user-friendly components are a key benefit of FANCY, and require no private information to be input to our servers, making it convenient for experimentalists to rapidly assess the risk of privacy before they release the data.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work is supported by US National Institutes of Health K99 HG010909 and R01 HG010749 grants and and by AL Williams Professorship funds.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa661_Supplementary_Data</label>
      <media xlink:href="btaa661_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa661-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Auwera</surname>
 <given-names>G.A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>From FastQ data to high-confidence variant calls: the Genome Analysis Toolkit best practices pipeline</article-title>. <source>Curr. Protoc. Bioinformatics</source>, <volume>43</volume>, <fpage>10.1</fpage>–<lpage>10.33</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa661-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DePristo</surname>
 <given-names>M.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2011</year>) 
<article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat. Genet</source>., <volume>43</volume>, <fpage>491</fpage>–<lpage>498</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dobin</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>15</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gursoy</surname>
 <given-names>G.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2019</year>) 
<article-title>Private information leakage from functional genomics data: quantification with calibration experiments and reduction via data sanitization protocols</article-title>. <source>Biorxiv</source>, doi: <pub-id pub-id-type="doi">10.1101/345074</pub-id>.</mixed-citation>
    </ref>
    <ref id="btaa661-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harmanci</surname>
 <given-names>A.</given-names></string-name>, <string-name><surname>Gerstein</surname><given-names>M.</given-names></string-name></person-group> (<year>2016</year>) 
<article-title>Quantification of private information leakage from phenotype-genotype data: linking attacks</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>251</fpage>–<lpage>256</lpage>.<pub-id pub-id-type="pmid">26828419</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harmanci</surname>
 <given-names>A.</given-names></string-name>, <string-name><surname>Gerstein</surname><given-names>M.</given-names></string-name></person-group> (<year>2018</year>) 
<article-title>Analysis of sensitive information leakage in functional genomics signal profiles through genomic deletions</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>2453</fpage>.<pub-id pub-id-type="pmid">29934598</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kilpinen</surname>
 <given-names>H.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2013</year>) 
<article-title>Coordinated effects of sequence variation on DNA binding, chromatin structure, and transcription</article-title>. <source>Science</source>, <volume>342</volume>, <fpage>744</fpage>–<lpage>747</lpage>.<pub-id pub-id-type="pmid">24136355</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lander</surname>
 <given-names>E.S.</given-names></string-name>, <string-name><surname>Waterman</surname><given-names>M.S.</given-names></string-name></person-group> (<year>1988</year>) 
<article-title>Genomic mapping by fingerprinting random clones: a mathematical analysis</article-title>. <source>Genomics</source>, <volume>2</volume>, <fpage>231</fpage>–<lpage>239</lpage>.<pub-id pub-id-type="pmid">3294162</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lappalainen</surname>
 <given-names>T.</given-names></string-name></person-group>
 <etal>et al</etal>; The Geuvadis Consortium. (<year>2013</year>) 
<article-title>Transcriptome and genome sequencing uncovers functional variation in humans</article-title>. <source>Nature</source>, <volume>501</volume>, <fpage>506</fpage>–<lpage>511</lpage>.<pub-id pub-id-type="pmid">24037378</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>
 <given-names>H.</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R.</given-names></string-name></person-group> (<year>2009</year>) 
<article-title>Fast and accurate short read alignment with Burrows-Wheeler Transform</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>
 <given-names>H.</given-names></string-name></person-group>
 <etal>et al</etal>; 1000 Genome Project Data Processing Subgroup. (<year>2009</year>) 
<article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname>
 <given-names>Z.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2004</year>) 
<article-title>Genomic research and human subject privacy</article-title>. <source>Science</source>, <volume>305</volume>, <fpage>183</fpage>.<pub-id pub-id-type="pmid">15247459</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mailman</surname>
 <given-names>M.D.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2007</year>) 
<article-title>The NCBI dbGaP database of genotypes and phenotypes</article-title>. <source>Nat. Genet</source>., <volume>39</volume>, <fpage>1181</fpage>–<lpage>1186</lpage>.<pub-id pub-id-type="pmid">17898773</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B15">
      <mixed-citation publication-type="other">NIH (<year>2018</year>) National Institute of Health Data Sharing Policy. <ext-link xlink:href="https://grants.nih.gov/grants/guide/notice-files/NOT-OD-19-023.html" ext-link-type="uri">https://grants.nih.gov/grants/guide/notice-files/NOT-OD-19-023.html (30 July 2020, date last accessed)</ext-link>.</mixed-citation>
    </ref>
    <ref id="btaa661-B16">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Rasmussen</surname>
 <given-names>C.E.</given-names></string-name>, <string-name><surname>Williams</surname><given-names>C.K.I.</given-names></string-name></person-group> (<year>2006</year>) <source>Gaussian Processes for Machine Learning</source>. 
<publisher-name>The MIT Press, Cambridge, MA</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btaa661-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sboner</surname>
 <given-names>A.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2011</year>) 
<article-title>The real cost of sequencing: higher than you think</article-title>! <source>Genome Biol</source>., <volume>12</volume>, <fpage>125</fpage>.<pub-id pub-id-type="pmid">21867570</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schadt</surname>
 <given-names>E.E.</given-names></string-name></person-group>
 <etal>et al</etal> (<year>2012</year>) 
<article-title>Bayesian method to predict individual SNP genotypes from gene expression data</article-title>. <source>Nature</source>, <volume>44</volume>, <fpage>603</fpage>–<lpage>608</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa661-B19">
      <mixed-citation publication-type="journal">The 1000 Genomes Project Consortium (<year>2010</year>) 
<article-title>A map of human genome variation from population-scale sequencing</article-title>. <source>Nature</source>, <volume>467</volume>, <fpage>1061</fpage>–<lpage>1073</lpage>.<pub-id pub-id-type="pmid">20981092</pub-id></mixed-citation>
    </ref>
    <ref id="btaa661-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>
 <given-names>D.</given-names></string-name></person-group>
 <etal>et al</etal>; PsychENCODE Consortium. (<year>2018</year>) 
<article-title>Comprehensive functional genomic resource and integrative model for the human brain</article-title>. <source>Science</source>, <volume>362</volume>, <fpage>eaat8464</fpage>.<pub-id pub-id-type="pmid">30545857</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
