<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7487613</article-id>
    <article-id pub-id-type="pmid">32907531</article-id>
    <article-id pub-id-type="publisher-id">3726</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03726-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>IonCRAM: a reference-based compression tool for ion torrent sequence files</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Shokrof</surname>
          <given-names>Moustafa</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3483-2644</contrib-id>
        <name>
          <surname>Abouelhoda</surname>
          <given-names>Mohamed</given-names>
        </name>
        <address>
          <email>mabouelhoda@yahoo.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.27860.3b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 9684</institution-id><institution>Faculty of Computer Science, </institution><institution>University of California at Davis, </institution></institution-wrap>Davis, CA, USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.415310.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2191 4301</institution-id><institution>King Faisal Specialist Hospital and Research Center, </institution></institution-wrap>Riyadh, Saudi Arabia </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.452562.2</institution-id><institution-id institution-id-type="ISNI">0000 0000 8808 6435</institution-id><institution>Saudi Human Genome Program, </institution><institution>King Abdulaziz City for Science and Technology (KACST), </institution></institution-wrap>Riyadh, Saudi Arabia </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.7776.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 0639 9286</institution-id><institution>Systems and Biomedical Engineering Department, Faculty of Engineering, </institution><institution>Cairo University, </institution></institution-wrap>University Square, Giza, Egypt </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>9</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>397</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Ion Torrent is one of the major next generation sequencing (NGS) technologies and it is frequently used in medical research and diagnosis. The built-in software for the Ion Torrent sequencing machines delivers the sequencing results in the BAM format. In addition to the usual SAM/BAM fields, the Ion Torrent BAM file includes technology-specific <italic>flow signal</italic> data. The flow signals occupy a big portion of the BAM file (about 75% for the human genome). Compressing SAM/BAM into CRAM format significantly reduces the space needed to store the NGS results. However, the tools for generating the CRAM formats are not designed to handle the flow signals. This missing feature has motivated us to develop a new program to improve the compression of the Ion Torrent files for long term archiving.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this paper, we present IonCRAM, the first reference-based compression tool to compress Ion Torrent BAM files for long term archiving. For the BAM files, IonCRAM could achieve a space saving of about 43%. This space saving is superior to what achieved with the CRAM format by about 8–9%.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Reducing the space consumption of NGS data reduces the cost of storage and data transfer. Therefore, developing efficient compression software for clinical NGS data goes beyond the computational interest; as it ultimately contributes to the overall cost reduction of the clinical test. The space saving achieved by our tool is a practical step in this direction. The tool is open source and available at Code Ocean, github, and <ext-link ext-link-type="uri" xlink:href="http://ioncram.saudigenomeproject.com">http://ioncram.saudigenomeproject.com</ext-link>.</p>
      </sec>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par8">Ion Torrent is one of the widely used Next Generation Sequencing (NGS) technologies, with a market share of 20% (Research and Market Report 2016). This technology is particularly popular in the medical domain, because it is fast and cost effective. It is basically used for clinical gene panels and whole exome sequencing. Gene panels are used to read the sequences of selected genes to screen for variations related to some inherited disorders [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref>] and cancer [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Whole exome sequencing covers the whole set of genes and is mostly used to identify novel mutations and genes [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. The Ion Torrent technology is not favored for whole genome sequencing due to its limited throughput, which would lead to insufficient depth for clinical use.</p>
    <p id="Par9">For clinical labs, the NGS data should be retained for a certain period of time [<xref ref-type="bibr" rid="CR13">13</xref>]. Accreditation entities, such as the College of American Pathologists, require that the NGS laboratory maintains the data (as it is) for at least two years (2017 CAP Regulation MOL.35870, revised 08/17/2016). This requirement necessitates that the NGS lab possesses a high capacity storage systems either in site or in the cloud. For either option, the cost of data storage is part of the total cost for provisioning the service per sample. Therefore, efficient data compression should be implemented to reduce the storage footprint, which in turn reduces the cost of the test.</p>
    <p id="Par10">For medical applications, the NGS analytical pipeline starts with the step of base calling, where the physical signals (either images or electrical signals) are translated to sequences of nucleotide bases. The output of this step is a sequence file composed of a set of reads in the fastq format as in Illumina technology or in the unaligned BAM format as in Ion Torrent technology. (The read is the sequence of a DNA fragment). The BAM file is the binary version of the readable SAM text file [<xref ref-type="bibr" rid="CR14">14</xref>]. The fastq/SAM/BAM format includes the NGS reads and related quality scores [<xref ref-type="bibr" rid="CR14">14</xref>]. The next step of the pipeline is to align the NGS reads to the reference human genome. The output of this step is a file in the SAM/BAM format with alignment information. Ion Torrent machines have a built in software for base calling and alignment, called Torrent Suite (<ext-link ext-link-type="uri" xlink:href="https://github.com/iontorrent/TS">https://github.com/iontorrent/TS</ext-link>). The Torrent Suite delivers the sequencing results in <italic>unaligned</italic> BAM format. If the user runs the alignment and variant calling workflow, then the reads are aligned to the reference human genome and the results are kept in an <italic>aligned</italic> BAM format. The unaligned reads are kept as well in the aligned BAM file but without mapping information. The unaligned BAM file is deleted after the successful generation of the BAM file. In the following parts of the paper, we will use the word “BAM” to simply refer to the “aligned BAM”. The final step of the analysis pipeline is the variant calling step to identify variants (mutations) compared to the reference human genome. The challenge in this step is to discriminate genuine variants from sequencing errors. The output of this step is tabular file (VCF format) including list of mutations.</p>
    <p id="Par11">The NGS data access cycle is composed of three main phases:
<list list-type="order"><list-item><p id="Par12"><italic>Analysis</italic>, where the NGS files are accessed to run the alignment and variant calling steps of the variant analysis workflow. This phase requires direct access to the reads from a fast storage at very high IO speed. It is preferred to run this step on SSD based storage [<xref ref-type="bibr" rid="CR15">15</xref>].</p></list-item><list-item><p id="Par13"><italic>Interpretation</italic>, where the clinical experts sometimes access the BAM/CRAM files to visualize and review the alignment at certain positions. This phase does not involve computation, and it is fine that the data moves to moderate speed storage (hard-disk based). The interpretation phase terminates by issuing a clinical report to the patient with the findings and the case is then considered closed.</p></list-item><list-item><p id="Par14"><italic>Long term archiving</italic>, where the data can move to high capacity slow storage (disk based or tapes) and kept inert, unless needed.</p></list-item></list></p>
    <p id="Par15">The BAM file is the largest output of this step and this is the one that should be the main target of compression. For a whole exome sequencing in clinical setting, the BAM file is in the range of 30–50 GB. The Gene Panel file is in the range of 1G–10G, but usually one runs multiple samples in the same run. The VCF files are relatively small and they are in the range of a few Megabytes. Optimizing the cost of the storage is critical for the third phase including long term archiving, where the data is kept inert for long time and is only decompressed if needed.</p>
    <p id="Par16">Different compression tools have been developed to compress the SAM/BAM files. The recent survey papers [<xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR18">18</xref>] include a description and comparison of these software tools. Broadly, these tools can be categorized into two big groups: 1) Non-reference based compression and 2) Reference based compression. Non-reference based methods compress the data by making use of its intrinsic characteristics. Reference-based methods work as follows: They first align the reads to a reference sequence. Then they compress the alignment information, which is enough to decompress the reads given the reference sequence. The reference based methods achieve high compression ratio, because the reads are almost identical to the reference except for few individual variations and sequencing errors. Reference and non-reference based compression tools can have a lossy and lossless version. For medical applications, only the lossless version should be used.</p>
    <p id="Par17">For medical applications, where the human genome (hg19 or GRC38) is used as a reference, the reference-based compression would be the method of choice for compressing the NGS data. Fritz et al. have introduced the CRAM format and related reference based compression tool [<xref ref-type="bibr" rid="CR19">19</xref>]. Shortly after its introduction, the CRAM format became so popular that it is currently accepted by the major public NGS repositories, such as NCBI and ENA. The CRAM related method has been implemented in different tools, such as CRAMtools (<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/ena/software/cram-toolkit">www.ebi.ac.uk/ena/software/cram-toolkit</ext-link>), SAMtools [<xref ref-type="bibr" rid="CR14">14</xref>] (<ext-link ext-link-type="uri" xlink:href="https://github.com/samtools">https://github.com/samtools</ext-link>), Picard (<ext-link ext-link-type="uri" xlink:href="http://picard.sourceforge.net">http://picard.sourceforge.net</ext-link>), and Scramble [<xref ref-type="bibr" rid="CR20">20</xref>]. These tools can produce output in CRAM format from SAM or BAM files.</p>
    <p id="Par18">In addition to its usual fields, the Ion Torrent BAM file includes flow signal data for each read. The flow signal is a vector of numerical integer values ∈ Z, usually bounded in practice. The flow signal vectors represent the measurements corresponding to the change in pH during base hybridization. The flow signal data cannot be discarded because it is used by the Torrent Suite to improve the accuracy of the variant calling.</p>
    <p id="Par19">As we will demonstrate in the experiment section, the flow signals occupy about 75% of the BAM file size for the human genome. Converting the BAM files to CRAM files lead to about 35% reduction in the file size. By examining the CRAM files, we figured out that the flow signals occupy about 77% of the file size. This shows that there a room for improvement and extra compression can be achieved by targeting the flow signals with a special compression procedure.</p>
    <p id="Par20">In this paper, we present the IonCRAM program to compress the Ion Torrent BAM files for long term archiving. It is <italic>lossless reference-based compression</italic> tool aiming at improving the space saving compared to the BAM and CRAM formats.</p>
    <p id="Par21">As we will show in the experimental results, IonCRAM could achieve an average space saving of about 43% compared to the BAM file. Compared to the CRAM format, IonCRAM achieves an extra space saving of about 8–9%.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>The flow signals</title>
      <p id="Par22">In this section, we provide information about the flow signals and explain how they are generated and stored in the BAM file. Ion Torrent is a Next Generation Sequencing technology based on the use of CMOS semiconductor chips, where the DNA bases are determined by sensing the release of hydrogen atoms during the hybridization process [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. The details are as follows: The DNA molecule is first fragmented into short fragments, usually around 500–1000 bps. Each single-stranded fragment is attached to a bead (a particle called ion sphere), where it undergoes a reaction to produce multiple copies of the same fragment. These copies are referred to as the <italic>template</italic>. The beads are then moved to the sequencing CMOS chip. The chip is composed of millions of wells and each well includes a sensor to detect the change in pH. Ideally, each ion sphere should reside in one well in the sequencing ship.</p>
      <p id="Par23">The chip is then placed in the sequencer and the sequencing process proceeds as follows: The sequencer introduces the four bases (A, T, G, and C) one at a time during the run in a cyclic fashion. The order in which the nucleotides are introduced is referred to as <italic>flow cycle</italic>. An introduced nucleotide hybridizes to the template base if it is complementary to it, and a change in pH takes place. If the template at one site includes a polymer (e.g., AAA), then multiple bases can hybridize in the same round of the cycle, and this leads to a stronger change in pH. If no change is measured in one round of the cycle, then the base in the template does not match the one in the flow cycle and no hybridization reaction takes place. A wash step occurs after the introduction of each type of nucleotide to ensure no nucleotide remains in the well before the introduction of the next one in the flow cycle. The changes in pH at each round in the flow cycle are recorded, and a vector called the <italic>raw flow-signal</italic> is produced. The signal processing software analyzes the raw flow signals and produces a vector of processed flow signals that are eventually stored in the BAM file [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. The flow signals are numerical integer values, usually bounded in practice. The number of flow signal points is the same as the number of bases in the flow cycle. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows an example DNA fragment and shows how the information related to the flow cycle and the flow signals are stored in the SAM/BAM file. The string defining the flow cycle is stored once in the header of the BAM file. As also shown in the figure, each read includes information related to the quality and alignment. It also includes the flow signal vector in the “ZM” field.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Flow Signals and their position in the SAM/BAM file. The upper part shows an example DNA fragment to be sequenced by an Ion Torrent machine. The key and bar code sequences are ligated (pre-pended) to the fragment. The key sequence (TCAG) is a control sequence to ensure correct sequencing. A barcode sequence is added to a certain group of fragments. The use of barcodes makes it possible to sequence the DNA of different samples/patients in one run. The lower part of the figure shows a schematic representation of the fields in the SAM file. The SAM file is the non-binary readable version of the BAM. The header part includes the flow cycle and the key sequence. Each line in the SAM file represents one read, aligned to the reference genome. The remaining rows include the read information in a tab-separated format: We show only the columns/fields of relevance to this paper. We show the fields including the read ID, the physical position and the CGAR string which represents the alignment, the bases of the DNA sequence in the read, the quality field, and the flow signals in the ZM field</p></caption><graphic xlink:href="12859_2020_3726_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par24">Figure <xref rid="Fig2" ref-type="fig">2</xref> explains the steps of the base calling by demonstrating how the flow signals are analyzed to call the bases of an example fragment using a given flow cycle. The base calling software uses the flow signals to call the bases in the target DNA as follows: The algorithm simultaneously scans the flow signal and the bases in the flow cycle. If there is a signal peak exceeding a certain threshold, then the corresponding base in the flow-cycle is the base in the target DNA and it is reported. If the flow signal value doubles, this indicates a polymer of identical bases. The base calling software calibrates the signal values and decides the length of the homopolymer. One can see in the figure that the flow signals can have ‘noisy’ negative values (around zero). Theoretically, the flow signal value can go to infinity for a DNA fragment of infinite number of the same nucleotide, (e.g., AAAAA…); but this does not occur in practice.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Base calling based on flow signals. The upper part shows an example DNA fragment to be sequenced. The second part shows the sequence of nucleotides in the flow cycle. It also shows the values of the sensed flow signals and the called bases. A flow signal value exceeding a certain threshold means that a base had hybridized to the template and the corresponding base in the flow cycle is reported. If the flow signal value doubles, this indicates a polymer of identical bases. The base calling software calibrates the signal values and decides the length of the polymer</p></caption><graphic xlink:href="12859_2020_3726_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>The compression algorithm</title>
      <p id="Par25">Our approach to improve the compression of the Ion Torrent BAM file is based on improving the compression of the flow signals. The idea of our algorithm is that the reads with similar sequences aligned to the same locus should have similar flow signals. Therefore, exploiting such similarity across multiple identical reads would lead to better compression.</p>
      <p id="Par26">Our algorithm sorts the reads in the BAM file first by genomic coordinates then by their prefix via sorting the respective CIGAR string in order to bring the similar reads closer to each other. By scanning the sorted reads, the algorithm identifies blocks of reads mapped to the same locus. We collect the flow signals in each block and compress them together as detailed in the algorithm below. Other fields of the BAM file are compressed using Scramble [<xref ref-type="bibr" rid="CR20">20</xref>]. The details of our method is in Algorithm <italic>IonCRAM-CompressBAM,</italic> presented below.</p>
      <p id="Par27">We implemented Algorithm 1 in the IonCRAM program. In actual implementation, Steps 2 and 3 are implemented together via Linux pipes. For Step 4.1, it is worth mentioning that we tried a different option to select a reference vector other than <italic>F</italic><sub><italic>1</italic></sub>, such as computing a median vector among all <italic>F</italic> vectors in <italic>B.</italic> The other option increased the running time and did not lead to tangible improvement of compression. So, we decided to use <italic>F</italic><sub><italic>1</italic></sub> as the reference flow signal vector.</p>
      <p id="Par28">For Step 4.3, there are multiple options for compressing the flow signals: XZ (<ext-link ext-link-type="uri" xlink:href="https://tukaani.org/xz/">https://tukaani.org/xz/</ext-link>), gzip (<ext-link ext-link-type="uri" xlink:href="http://www.gzip.org">http://www.gzip.org</ext-link>), or zstd (<ext-link ext-link-type="uri" xlink:href="https://github.com/facebook/zstd">https://github.com/facebook/zstd</ext-link>). The XZ method is the default one. All these implementations are based on the dictionary based approach using Lempel Ziv decomposition. Each tool implements different tuning steps in terms of encoding and algorithm engineering. The gzip technique is based on the LZSS method which is a variation of the LZ77 algorithm as well as on Huffman coding [<xref ref-type="bibr" rid="CR23">23</xref>]. The XZ algorithm is also based on LZ77 plus Huffman coding but is enhanced with Markov chain models to further improve the compression (The Tukaani project: <ext-link ext-link-type="uri" xlink:href="https://tukaani.org/xz/">https://tukaani.org/xz/</ext-link>). Zstd is a Facebook developed package, also based on LZ77 but enhanced with tuned levels of compression using Finite State Entropy [<xref ref-type="bibr" rid="CR24">24</xref>]. Zstd follows speed-first design approach and it can provide ultra-compression ratios.</p>
      <p id="Par29">For Step 5, we use the Linux tar package for creating an archive of all compressed files. This archive includes the CRAM file for the input BAM file minus the flow signals computed in Steps 2 and 3, and the compressed blocks for the flow signals computed in Step 4.</p>
      <p id="Par30">The decompression algorithm starts with un-archiving the tar folder using the tar program. Then we use Scramble to decompress the CRAM part. For each block of the compressed flow signals, the <italic>V</italic> vectors are decompressed and the <italic>D</italic> vectors are reconstructed. The reference <italic>F</italic><sub><italic>1</italic></sub> is used to reconstruct <italic>F</italic><sub><italic>2</italic></sub> vector using both <italic>D</italic><sub><italic>1</italic></sub> and <italic>F</italic><sub><italic>1</italic></sub> via the equation <italic>F</italic><sub><italic>2</italic></sub> = <italic>F</italic><sub><italic>1</italic></sub> - <italic>D</italic><sub><italic>1</italic></sub>. Then <italic>F</italic><sub><italic>2</italic></sub> is used to reconstruct <italic>F</italic><sub><italic>3</italic></sub> using the equation <italic>F</italic><sub><italic>3</italic></sub> = <italic>F</italic><sub><italic>2</italic></sub> – <italic>D</italic><sub><italic>2</italic></sub>. The vector <italic>F</italic><sub><italic>3</italic></sub> is used to reconstruct <italic>F</italic><sub><italic>4,</italic></sub> and so on. The decompressed flow signals are finally added to the BAM file.</p>
    </sec>
    <sec id="Sec5">
      <title>Parallel processing</title>
      <p id="Par31">Parallel processing is used in IonCRAM at different levels in compressing the BAM files. First, the flow signals of the forward and reverse reads are processed in parallel. Second, the compression of the blocks to compress the flow signals can also run in parallel. Third, Scramble compresses the BAM file minus the flow signal in parallel. Finally, one can decompose the BAM file intro sub-files, each correspond to a certain genomic region. These regions are independent from one another and they can be also processed in parallel.</p>
      <p id="Par32">Parallel processing is also used during decompression. We decompress the BAM part which was compressed by Scramble in parallel with decompressing the flow signals. Also the compressed flow signal blocks are decompressed in parallel.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results and discussion</title>
    <sec id="Sec7">
      <title>The test dataset</title>
      <p id="Par33">The genome NGS file (ERR317482) used to test the original CRAM tool [<xref ref-type="bibr" rid="CR19">19</xref>] and Scramble [<xref ref-type="bibr" rid="CR20">20</xref>] was produced by Illumina. Later, the MPEG HTS consortium has compiled genomic test data to evaluate the available compression methods at that time [<xref ref-type="bibr" rid="CR17">17</xref>]. The benchmarking dataset included many genomic files from different technologies and different organisms. However, there is only one small genome (ERR303541) from the early days of NGS, sequenced at very low depth of 0.6X. This low depth is no longer used in practice, neither in research nor in clinical diagnosis. To cope with recent advances in the Ion Torrent technology, we compiled a dataset for Ion Torrent BAMs, whose depth is similar to what is used in clinical practice (Table <xref rid="Tab1" ref-type="table">1</xref>). This set includes four public standard exomes from the NIST and “Genome in a Bottle” Consortium [<xref ref-type="bibr" rid="CR25">25</xref>]. These exomes were sequenced using modern Ion Proton platform with the following parameters: Ion AmpliSeq™ Exome RDY Kit for library preparation, with a mean insert size of 215 bp, Ion PI™ Sequencing 200 Kit v4 for sequencing, and Torrent Suite v4.2 for base calling and alignment. For an up-to-date version of the kits, chemistry, and analysis package, we also added a set of three test exomes and eleven test gene panels, generated at clinical grade quality from the Saudi Human Genome Program. They were sequenced using the Ion Proton Platform with the following parameters: Ion Proton Hi-Q kits for library preparation, Ion PI Hi-Q Sequencing 200 Kit for sequencing, and Torrent Suite v5.0.4 for base calling and alignment. All these files are available to download from the program website.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Test datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Bam Name</th><th>Source</th><th>Bam Size GB</th><th>No. Reads</th><th>Average Depth (reads)</th></tr></thead><tbody><tr><td>GP1.bam</td><td>In-house</td><td>1.04</td><td>1,675,346</td><td>75</td></tr><tr><td>GP2.bam</td><td>In-house</td><td>1.1</td><td>1,747,374</td><td>80</td></tr><tr><td>GP3.bam</td><td>In-house</td><td>1.46</td><td>2,355,416</td><td>109</td></tr><tr><td>GP4.bam</td><td>In-house</td><td>1.01</td><td>1,603,486</td><td>145</td></tr><tr><td>GP5.bam</td><td>In-house</td><td>1.47</td><td>2,362,387</td><td>210</td></tr><tr><td>GP6.bam</td><td>In-house</td><td>1.41</td><td>2,269,592</td><td>201</td></tr><tr><td>GP7.bam</td><td>In-house</td><td>1.44</td><td>2,352,413</td><td>470</td></tr><tr><td>GP8.bam</td><td>In-house</td><td>1.42</td><td>2,271,890</td><td>485</td></tr><tr><td>GP9.bam</td><td>In-house</td><td>2.13</td><td>3,480,496</td><td>711</td></tr><tr><td>GP10.bam</td><td>In-house</td><td>2.14</td><td>3,494,124</td><td>1053</td></tr><tr><td>GP11.bam</td><td>In-house</td><td>2.83</td><td>4,637,535</td><td>1400</td></tr><tr><td>WES1</td><td>In-house</td><td>53.6</td><td>91,339,566</td><td>172</td></tr><tr><td>WES2</td><td>In-house</td><td>60.2</td><td>97,605,030</td><td>202</td></tr><tr><td>WES3</td><td>In-house</td><td>57.3</td><td>92,927,166</td><td>293</td></tr><tr><td>HG002_NA24385_SRR1767406</td><td>NCBI (<ext-link ext-link-type="uri" xlink:href="ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/">ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/</ext-link> AshkenazimTrio/HG002_NA24385_son/ion_exome/HG002_NA24385_SRR1767406_IonXpress_020_rawlib_24028.bam)</td><td>50.0</td><td>82,654,309</td><td>201</td></tr><tr><td>HG003_NA24149_SRR1767411</td><td>NCBI (<ext-link ext-link-type="uri" xlink:href="ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/">ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/</ext-link> AshkenazimTrio/HG003_NA24149_father/ion_exome/HG003_NA24149_SRR1767411_IonXpress_022_rawlib_24022.bam)</td><td>43.8</td><td>73,777,136</td><td>185</td></tr><tr><td>HG004_NA24143_SRR1767448</td><td>NCBI (<ext-link ext-link-type="uri" xlink:href="ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/">ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/</ext-link> AshkenazimTrio/HG004_NA24143_mother/ion_exome/HG004_NA24143_SRR1767448_IonXpress_024_rawlib_24026.bam)</td><td>50.6</td><td>83,487,089</td><td>214</td></tr><tr><td>NA12878</td><td>NCBI (<ext-link ext-link-type="uri" xlink:href="ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/">ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/</ext-link> NA12878/ion_exome/IonXpress_020_rawlib.hg19.bam)</td><td>25.1</td><td>41,792,386</td><td>131</td></tr></tbody></table></table-wrap></p>
      <p id="Par34">The table includes gene panel and exome data used for measuring the performance of IonCRAM. The BAM file size is given in MB and GB. The size of the target region is 57.7 Mbp for whole exome sequencing and about 0.48 Mbp for gene panels. The average depth is the average number of reads covering a target base.</p>
    </sec>
    <sec id="Sec8">
      <title>Measuring the flow signal content</title>
      <p id="Par35">As we mentioned in the introduction, the flow signals occupy a big portion of the BAM file. In this experiment, we measured how big that portion is in the test dataset. Also in this experiment, we measured the size of the flow signals in the corresponding CRAM files, after converting the BAM files into CRAM format using the program Scramble. Table <xref rid="Tab2" ref-type="table">2</xref> shows that the size of the flow signals in the BAM and CRAM files. The results show that the flow signals occupy about 75 and 77% of the BAM and CRAM file size, respectively.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Flow signal size in the BAM and CRAM files in GB</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Bam Name</th><th>Bam Size GB</th><th>Flow signal Size (GB)</th><th>% Flow signal in BAM</th><th>Flow signal size in CRAM</th><th>%Flow Signal in CRAM</th></tr></thead><tbody><tr><td>GP1.bam</td><td>1.02</td><td>0.77</td><td>75.5%</td><td>0.52</td><td>77.4%</td></tr><tr><td>GP2.bam</td><td>1.06</td><td>0.80</td><td>75.5%</td><td>0.54</td><td>77.5%</td></tr><tr><td>GP3.bam</td><td>1.43</td><td>1.08</td><td>75.7%</td><td>0.73</td><td>77.6%</td></tr><tr><td>GP4.bam</td><td>0.98</td><td>0.74</td><td>75.9%</td><td>0.50</td><td>77.58%</td></tr><tr><td>GP5.bam</td><td>1.44</td><td>1.09</td><td>75.8%</td><td>0.73</td><td>77.5%</td></tr><tr><td>GP6.bam</td><td>1.37</td><td>1.04</td><td>75.8%</td><td>0.70</td><td>77.47%</td></tr><tr><td>GP7.bam</td><td>1.40</td><td>1.07</td><td>75.9%</td><td>0.71</td><td>77.62%</td></tr><tr><td>GP8.bam</td><td>1.38</td><td>1.06</td><td>76.4%</td><td>0.71</td><td>76.90%</td></tr><tr><td>GP9.bam</td><td>2.08</td><td>1.59</td><td>76.3%</td><td>1.06</td><td>77.52%</td></tr><tr><td>GP10.bam</td><td>2.09</td><td>1.60</td><td>76.5%</td><td>1.07</td><td>77.76%</td></tr><tr><td>GP11.bam</td><td>2.76</td><td>2.12</td><td>76.6%</td><td>1.41</td><td>77.67%</td></tr><tr><td>WES1</td><td>53.64</td><td>39.80</td><td>74.2%</td><td>26.42</td><td>76.94%</td></tr><tr><td>WES2</td><td>60.25</td><td>45.24</td><td>75.1%</td><td>30.11</td><td>77.47%</td></tr><tr><td>WES3</td><td>57.33</td><td>43.60</td><td>76.1%</td><td>29.18</td><td>78.15%</td></tr><tr><td>HG002_NA24385_SRR1767406</td><td>50.04</td><td>37.66</td><td>75.3%</td><td>26.73</td><td>78.03%</td></tr><tr><td>HG003_NA24149_SRR1767411</td><td>43.79</td><td>33.00</td><td>75.6%</td><td>23.41</td><td>78.12%</td></tr><tr><td>HG004_NA24143_SRR1767448</td><td>50.60</td><td>38.20</td><td>75.6%</td><td>27.09</td><td>78.15%</td></tr><tr><td>NA12878</td><td>25.11</td><td>18.78</td><td>74.8%</td><td>13.33</td><td>77.86%</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec9">
      <title>Measuring the space saving</title>
      <p id="Par36">In this experiment, we measured the compression power of IonCRAM compared to the BAM and CRAM formats. For the CRAM format, we used the program Scramble to compress the test BAM files in the CRAM format. Scramble is currently the most stable, optimized and popular implementation of the CRAM related methods, and its techniques are now part of the samtools/htslib package. Best compression options for Scramble were used (−9 for highest level of compression, −Z for using lzma method, and –p –P for preserving all tags in SAM/BAM file). The same options are also used when IonCRAM invokes Scramble to compress the part of the BAM file not including the flow signals (Step 2 Algorithm <italic>IonCRAM-CompressBAM</italic>). The experiments ran on a Dell server R940 of 88 physical Cores (Intel Gold 222), 128 GB RAM, and 8 TB SSD disks with Centos 7 OS. As a measure of compression, we use the percent space saving defined as follows:
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{l} space\ saving=\left(1\hbox{-} \frac{compressed\ file\ size}{uncompressed\ file\ size}\right)=\left(1\hbox{-} \frac{1}{compression\ ratio}\right)\\ {} percent\ space\ saving=100\ast space\kern0.5em saving\\ {}\ \end{array}} $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mtable columnalign="left" displaystyle="true"><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">space saving</mml:mtext><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>‐</mml:mo><mml:mfrac><mml:mtext mathvariant="italic">compressed file size</mml:mtext><mml:mtext mathvariant="italic">uncompressed file size</mml:mtext></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>‐</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mtext mathvariant="italic">compression ratio</mml:mtext></mml:mfrac></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">percent space saving</mml:mtext><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>∗</mml:mo><mml:mtext mathvariant="italic">space</mml:mtext><mml:mspace width="0.5em"/><mml:mtext mathvariant="italic">saving</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.25em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3726_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par37">We used this measure because it directly reflects the amount of saving in physical storage, which directly leads to cost reduction.</p>
      <p id="Par38">Table <xref rid="Tab3" ref-type="table">3</xref> shows the results of compressing the test BAM files using Scramble and our program IonCRAM. The table also shows the results for a naïve implementation, where the flow signals are removed from the BAM file and compressed without any pre-processing. That is, in the naive implementation, no pre-processing as explained above in Algorithm <italic>IonCRAM-CompressBAM</italic> is performed. The table shows the average file sizes and average space saving for each group of files. Supplementary File 1 includes the details for each test file.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Space saving of Scramble and IonCRAM</p></caption><table frame="hsides" rules="groups"><thead><tr><th>File</th><th>Bam Size (GB)</th><th>CRAM Size (GB)</th><th>Scramble CRAM %saving of flow signal compared to BAM</th><th>Overall Scramble CRAM %Saving w.r.t. BAM</th><th>Naïve (Scramble + XZ/Zstd)</th><th>%saving Naïve</th><th>IonCRAM Size (GB)</th><th>IonCRAM %saving of flow signal compared to BAM</th><th>Overall IonCRAM %Saving w.r.t. BAM</th><th>Improvement over CRAM</th></tr></thead><tbody><tr><td colspan="11"><bold>Gene Panels</bold></td></tr><tr><td> <bold>Average values for Gene Panels</bold></td><td>1.55</td><td>1.02</td><td>33.03%</td><td>34.36%</td><td>1.28</td><td>17.11%</td><td>0.89</td><td>45.09%</td><td>42.60%</td><td>8.24%</td></tr><tr><td> <bold>Min values for Gene Panels</bold></td><td>1.02</td><td>0.67</td><td>32.82%</td><td>34.00%</td><td>0.85</td><td>16.77%</td><td>0.59</td><td>44.73%</td><td>42.39%</td><td>7.46%</td></tr><tr><td> <bold>Max values for Gene Panels</bold></td><td>2.76</td><td>1.82</td><td>33.23%</td><td>35.00%</td><td>2.28</td><td>17.44%</td><td>1.59</td><td>45.67%</td><td>42.90%</td><td>8.90%</td></tr><tr><td colspan="11"><bold>In house Exomes</bold></td></tr><tr><td> <bold>Average values for In house Exomes</bold></td><td>57.07</td><td>36.85</td><td>33.37%</td><td>35.33%</td><td>48.61</td><td>18.19%</td><td>32.17</td><td>45.36%</td><td>43.59%</td><td>8.31%</td></tr><tr><td> <bold>Min</bold></td><td>53.64</td><td>34.34</td><td>33.06%</td><td>35%</td><td>44.51</td><td>13.89%</td><td>30.31</td><td>44.97%</td><td>43.37%</td><td>7.49%</td></tr><tr><td> <bold>Max</bold></td><td>60.25</td><td>38.87</td><td>33.61%</td><td>36%</td><td>51.88</td><td>22.36%</td><td>34.12</td><td>45.94%</td><td>43.90%</td><td>9.06%</td></tr><tr><td colspan="11"><bold>Public Standard Exomes</bold></td></tr><tr><td> <bold>Average values for public Exomes</bold></td><td>42.39</td><td>29.01</td><td>29.05%</td><td>31.75%</td><td>36.57</td><td>13.71%</td><td>25.445</td><td>41.71%</td><td>39.84%</td><td>8.09%</td></tr><tr><td> <bold>Min</bold></td><td>25.11</td><td>17.12</td><td>29.01%</td><td>31%</td><td>21.75</td><td>13.33%</td><td>14.99</td><td>41.34%</td><td>39.7%</td><td>7.80%</td></tr><tr><td> <bold>Max</bold></td><td>50.60</td><td>34.67</td><td>29.09%</td><td>32%</td><td>43.72</td><td>14.55%</td><td>30.35</td><td>41.92%</td><td>40.0%</td><td>8.70%</td></tr></tbody></table><table-wrap-foot><p>Space saving of Scramble and IonCRAM for groups of test files. The second and third columns include the BAM and CRAM file sizes in GB, respectively. In Column 4, we show the saving in flow signal achieved by Scramble in the CRAM format. In Column 5, the overall space saving achieved by Scramble in the CRAM format compared to the original BAM file. Columns 6, 7, and 8 show the IonCRAM file size, percent saving in flow signals and overall saving, respectively. The final column compares overall percentage saving of IonCRAM compared to the respective CRAM files produced by Scramble.</p></table-wrap-foot></table-wrap></p>
      <p id="Par39">The results show that the naïve method could achieve improvement in compression compared to the BAM file. But its performance is still inferior to Scramble and IonCRAM. The results also show that IonCRAM achieves consistent improvement by about 7.5–9% compared to Scramble. The space saving with respect to the BAM file has improved to reach a range between 40 and 44%. In other words, we use 56% of the storage space for storing an NGS file. From the experiments, we observe little improvement of compression when the depth increases. The gene panel files with higher depth are compressed little bit better than those with lower depth. Another observation is that the space saving of the four public exomes is less than that of the in-house BAM files (WES1-WES3). The reason for this is that these public exomes were sequenced using older chemistry and an older base calling program. The new chemistry achieves more consistent readings of the signal at the same position in the read and accordingly lead to more similar flow signal value, which ultimately leads to better compression.</p>
    </sec>
    <sec id="Sec10">
      <title>Testing different compression options</title>
      <p id="Par40">Our implementation of IonCRAM includes three compression options: gzip (version 1.5), XZ (version 5,2,2), and Zsdt (version 1.4.4). Table <xref rid="Tab4" ref-type="table">4</xref> shows the performance of IonCRAM using these different compression options to compress the flow signal part. To achieve maximum compression, we used the option “--ultra” for Zstd, and “-9” for gzip and XZ. It can be observed that XZ achieves the best compression. Zsdt is in second place with very comparable results to XZ. The gzip tool is in third place with a reduction in space saving of about 2%.
<table-wrap id="Tab4"><label>Table 4</label><caption><p>Space saving of IonCRAM using different options</p></caption><table frame="hsides" rules="groups"><thead><tr><th>File</th><th>Bam Size (GB)</th><th>CRAM Size (GB)</th><th>IonCRAM Size with xz (GB)</th><th>IonCRAM %Saving w.r.t. BAM (xz)</th><th>IonCRAM File Size (MB, gzip)</th><th>IonCRAM %Saving (gzip)</th><th>IonCRAM size (zstd)</th><th>IonCRAM %Saving (zstd)</th></tr></thead><tbody><tr><td colspan="9"><bold>Gene Panels</bold></td></tr><tr><td> <bold>Average values for Gene Panels</bold></td><td>1.55</td><td>1.02</td><td>0.89</td><td>42.60%</td><td>0.92</td><td>40.56%</td><td>0.90</td><td>42.10%</td></tr><tr><td> <bold>Min</bold></td><td>1.02</td><td>0.67</td><td>0.59</td><td>42.46%</td><td>0.61</td><td>40.13%</td><td>0.59</td><td>41.83%</td></tr><tr><td> <bold>Max</bold></td><td>2.76</td><td>1.82</td><td>1.59</td><td>42.90%</td><td>1.63</td><td>41.13%</td><td>1.59</td><td>42.40%</td></tr><tr><td colspan="9"><bold>In house Exomes</bold></td></tr><tr><td> <bold>Average values for In-house Exomes</bold></td><td>57.07</td><td>36.85</td><td>32.17</td><td>43.64%</td><td>33.80</td><td>40.77%</td><td>32.84</td><td>42.46%</td></tr><tr><td> <bold>Min</bold></td><td>53.64</td><td>34.34</td><td>30.31</td><td>43.37%</td><td>31.84</td><td>40.53%</td><td>30.86</td><td>42.18%</td></tr><tr><td> <bold>Max</bold></td><td>60.25</td><td>38.87</td><td>34.12</td><td>44.06%</td><td>35.83</td><td>41.14%</td><td>34.83</td><td>42.72%</td></tr><tr><td colspan="9"><bold>Public Standard Exomes</bold></td></tr><tr><td> <bold>Average values for public Exomes</bold></td><td>42.39</td><td>29.01</td><td>25.45</td><td>40.04%</td><td>26.46</td><td>37.59%</td><td>25.86</td><td>40.01%</td></tr><tr><td> <bold>Min</bold></td><td>25.11</td><td>17.12</td><td>14.99</td><td>39.70%</td><td>15.64</td><td>37.42%</td><td>15.27</td><td>39.70%</td></tr><tr><td> <bold>Max</bold></td><td>50.60</td><td>34.67</td><td>30.35</td><td>40.31%</td><td>31.56</td><td>37.74%</td><td>30.82</td><td>40.31%</td></tr></tbody></table></table-wrap></p>
      <p id="Par41">Space saving of IonCRAM using different options: Columns 4, 6, and 8 show the average file sizes after compression using the options xz, gzip, and Zstd, respectively. Columns 5, 7, and 9 show the percentage space saving with the options xz, gzip, and Zstd, respectively.</p>
    </sec>
    <sec id="Sec11">
      <title>Measuring the running time and RAM consumption</title>
      <p id="Par42">Figures <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref> summarize the running time and RAM consumption when running Scramble and IonCRAM using different options. Supplementary File 1 includes detailed experiments in tabular and graphical formats. As expected, IonCRAM takes more time and uses more RAM than Scramble. This is mainly due to the extra work for processing the flow signals. The running time of IonCRAM improves when it runs in parallel using multiple cores, which shows very good scalability. For whole exome sequencing, it takes about 30 min in average using 8 cores and it takes 18 min using 24 cores. This is very affordable to cope with the rate of data production, even for labs with moderate computing power. (An Ion Torrent system is usually shipped with a tower server with 16 cores and 64 GB RAM.) We did not observe significant speedup beyond 24 cores. The RAM consumption increases with the use of more cores. It does not increase beyond 64 GB. From the results, we would recommend best parameters at 24 cores if high specification server is available. For workstations with moderate computing power, we would recommend the use of 16 cores so that the memory consumption does not exceed 32 GB RAM.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Compression Running times and space consumption. Compression running times and RAM consumption: Average running times for compressing (<bold>a</bold>) gene panels in seconds, (<bold>c</bold>) in-house exomes in minutes, (<bold>e</bold>) and public exomes in minutes. The measurements are for using Scramble and for using IonCRAM with the gzip, xz, and Zstd options. The average running time for gene panels is the average running times of the 11 gene panel files, and so did we for the set of the three public exomes and the set of four public exomes. The average RAM consumption in GB for gene panels, in-house exomes, and public exomes is shown in (<bold>b</bold>), (<bold>d</bold>), and (<bold>f</bold>)</p></caption><graphic xlink:href="12859_2020_3726_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Decompression Running times and space consumption. Decompression running times and RAM consumption: Average running times for decompressing (a) gene panels in seconds, (<bold>c</bold>) in-house exomes in minutes, (<bold>e</bold>) and public exomes in minutes. The measurements are for using Scramble and for using IonCRAM with the gzip, xz, and Zstd options. The average running time for gene panels is the average running times of the 11 gene panel files, and so did we for the set of the three public exomes and the set of four public exomes. The average RAM consumption in GB for gene panels, in-house exomes, and public exomes is shown in (<bold>b</bold>), (<bold>d</bold>), and (<bold>f</bold>)</p></caption><graphic xlink:href="12859_2020_3726_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par43">We also tested the running times and space consumption of IonCRAM with the gzip, xz, and Zstd options. The use of gzip option in IonCRAM leads to the best running time and best RAM consumption. It can be 50% faster and saves about 50% of the RAM consumption. Using Zstd leads to running time that is little bit faster than that of xz but still slower than gzip. As indicated by the Zstd authors in the program manual, the “ultra compression” option uses huge RAM; we could observe that in the experiment.</p>
      <p id="Par44">Recalling from Table <xref rid="Tab4" ref-type="table">4</xref> that the space saving of IonCRAM using gzip is 2% less than that using xz, then there is a kind of a trade-off, In our view, we think that the differences in running time, which is still in the range of few minutes, cannot weigh out the advantage of extra saving in storage.</p>
    </sec>
    <sec id="Sec12">
      <title>Extra experiments</title>
      <sec id="Sec13">
        <title>Use of median flow signal</title>
        <p id="Par45">As explained in the Methodology section, we use the first flow signal <italic>F</italic><sub><italic>1</italic></sub> as a reference sequence, from which differences are computed. We also tried to use the median sequence as a reference instead of <italic>F</italic><sub><italic>1,</italic></sub> but the results shown in the supplementary file (Sheet 2) shows no improvement. (The median flow signal is composed of the average signal value of each point, which minimizes the total distances. Specifically, for a block of signals <italic>F</italic><sub><italic>1</italic></sub> .. <italic>F</italic><sub><italic>j,</italic></sub> the median signal <italic>F</italic><sub><italic>m</italic></sub> is computed as follows: <italic>F</italic><sub><italic>m</italic></sub>[<italic>i</italic>] = average (<italic>F</italic><sub><italic>1</italic></sub>[<italic>i</italic>] .. <italic>F</italic><sub><italic>m</italic></sub>[<italic>i</italic>]), where 1 ≤ <italic>i</italic> ≤ <italic>n.</italic> The average value is the point that minimizes the function (<italic>F</italic><sub><italic>m</italic></sub>[<italic>i</italic>] - <italic>F</italic><sub><italic>1</italic></sub>[<italic>i</italic>]) + .. + <italic>(F</italic><sub><italic>m</italic></sub>[<italic>i</italic>] - <italic>F</italic><sub><italic>m</italic></sub>[<italic>i</italic>]). The reason why taking <italic>F</italic><sub><italic>1</italic></sub> as a reference has better performance may be attributed to better locality and is favored by the subsequent XZ and gzip compression.</p>
      </sec>
      <sec id="Sec14">
        <title>Comparison to genozip and use of binning option</title>
        <p id="Par46">We also compared IonCRAM to the program genozip [<xref ref-type="bibr" rid="CR26">26</xref>], using the lossless and lossy (−-optimize) options. Supplementary File 1 (Sheet 2) shows the results of this experiment. For the lossless version, IonCRAM and Scramble is superior to genozip. For the lossy version based on binning the flow signal values, genozip performs well compared to the equivalent binning option of IonCRAM. The binning option sets the negative values to zeros and maps the flow signals to certain bins, similar to the binning procedure introduced initially by Illumina to reduce the space of quality scores [<xref ref-type="bibr" rid="CR27">27</xref>]. The binning options of IonCRAM allows the user to select the level of binning; I.e., the user select the value <italic>x</italic> to map each value <italic>y</italic> to <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ z=\Big(\left\lceil \frac{y}{x}\right\rceil \times x $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mfenced close="⌉" open="⌈"><mml:mfrac><mml:mi>y</mml:mi><mml:mi>x</mml:mi></mml:mfrac></mml:mfenced><mml:mo>×</mml:mo><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3726_Article_IEq1.gif"/></alternatives></inline-formula>). From the results in the supplementary file, one can see that the binning option to the nearest 10 (x = 10) could lead to extra 8–9% space saving.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Conclusions</title>
    <p id="Par47">Compression of NGS data is important to reduce the storage requirement. It is also important to speed up the transmission of data and overcome the bandwidth issues. The research community has focused on compressing NGS data produced by Illumina platforms and no work addressed NGS data out of the Ion Torrent ones. The Ion Torrent files include extra technology-specific data fields not included in the Illumina file. This data is of large size and requires extra and should be specially addressed in compression. In this paper, we have presented the program IonCRAM for compressing the Ion Torrent BAM files. IonCRAM is the first program that could achieve significant lossless compression for such type of files. IonCRAM could achieve a space saving of about 43%, which improves upon the CRAM format by about 8–9%. This directly leads to great savings in storage, backup, and bandwidth cost.</p>
    <p id="Par48">Future research for reducing the space consumption of the Ion Torrent BAM files would include the binning of the flow signal and quality values. The idea of binning was initially introduced by Illumina [<xref ref-type="bibr" rid="CR27">27</xref>] to reduce the space consumption of the quality values. This initiative was immediately followed by intensive research to optimize the binning procedure and address its effect on the downstream analysis, especially on the variant calling step [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR31">31</xref>]. We think that the binning of flow signals and quality data of Ion Torrent would also be successful, provided that the manufacturer contribute to this research. We added an option to IonCRAM for binning the flow signals, in a similar way to the binning method implemented in [<xref ref-type="bibr" rid="CR26">26</xref>], and measured its effect on compression (Supplementary File 1). We left the step for investigating the effect of this binning on the downstream analysis to further research.</p>
    <p id="Par49">It is worth mentioning that IonCRAM has not been only used for the test data in the paper, it has also been used to compress and backup thousands of files for the Saudi Human Genome Program. IonCRAM is an open source and it is available for free along with the related test data at the tool website <ext-link ext-link-type="uri" xlink:href="http://ioncram.saudigenomeproject.com">http://ioncram.saudigenomeproject.com</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3726_MOESM1_ESM.xlsx">
            <caption>
              <p>
                <bold>Additional file 1.</bold>
              </p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>SAM</term>
        <def>
          <p id="Par4">Sequence Alignment Mapping</p>
        </def>
      </def-item>
      <def-item>
        <term>BAM</term>
        <def>
          <p id="Par5">Binary Alignment/Mapping</p>
        </def>
      </def-item>
      <def-item>
        <term>RAM</term>
        <def>
          <p id="Par6">Random Access Memory</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p id="Par7">Next-generation sequencing</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03726-9.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We acknowledge the Saudi Human Genome Program, King Abdulaziz City for Science and Technology (KACST). The authors also thanks Mohamed El-Kalioby and Zeeshan Shah for their support.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MA conceived the development of IonCRAM. MA and MS made the implementation and reviewed methods and results. All authors wrote the paper and revised it. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Not Applicable.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p><bold>Project name:</bold> IonCRAM.</p>
    <p><bold>Project home page:</bold><ext-link ext-link-type="uri" xlink:href="http://ioncram.saudigenomeproject.com">http://ioncram.saudigenomeproject.com</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://codeocean.com/capsule/0889064/tree/v2">https://codeocean.com/capsule/0889064/tree/v2</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/ionCRAM/ionCRAM">https://github.com/ionCRAM/ionCRAM</ext-link></p>
    <p><bold>Operating system(s):</bold> Linux.</p>
    <p><bold>Programming language:</bold> Python, C, C++.</p>
    <p><bold>Other requirements:</bold> NA.</p>
    <p><bold>License:</bold> GPL.</p>
    <p><bold>Any restrictions to use by non-academics:</bold> No restrictions.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par50">Not Applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par51">Not Applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par52">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The Saudi Mendliome Group</collab>
        </person-group>
        <article-title>Comprehensive gene panels provide advantages over clinical exome sequencing for Mendelian diseases</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>134</fpage>
        <pub-id pub-id-type="pmid">26112015</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rehm</surname>
            <given-names>HL</given-names>
          </name>
        </person-group>
        <article-title>Disease-targeted sequencing: A cornerstone in the clinic</article-title>
        <source>Nat Rev Genet</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>4</issue>
        <fpage>295</fpage>
        <lpage>300</lpage>
        <?supplied-pmid 23478348?>
        <pub-id pub-id-type="pmid">23478348</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xue</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ankala</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wilcox</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Hegde</surname>
            <given-names>MR</given-names>
          </name>
        </person-group>
        <article-title>Solving the molecular diagnostic testing conundrum for Mendelian disorders in the era of next-generation sequencing: Single-gene, gene panel, or exome/genome sequencing</article-title>
        <source>Genet Med</source>
        <year>2015</year>
        <volume>17</volume>
        <issue>6</issue>
        <fpage>444</fpage>
        <lpage>451</lpage>
        <?supplied-pmid 25232854?>
        <pub-id pub-id-type="pmid">25232854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCullough</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Non-Invasive Prenatal Chromosomal Aneuploidy Testing - Clinical Experience: 100,000 Clinical Samples</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>e109173</fpage>
        <?supplied-pmid 25289665?>
        <pub-id pub-id-type="pmid">25289665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clinical experience of non-invasive prenatal chromosomal aneuploidy testing in 190,277 patient samples</article-title>
        <source>Curr Mol Med</source>
        <year>2016</year>
        <volume>16</volume>
        <issue>8</issue>
        <fpage>759</fpage>
        <lpage>766</lpage>
        <?supplied-pmid 27739366?>
        <pub-id pub-id-type="pmid">27739366</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suhaimi</surname>
            <given-names>SS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Targeted next-generation sequencing identifies actionable targets in estrogen receptor positive and estrogen receptor negative Endometriod endometrial Cancer</article-title>
        <source>Front Pharmacol</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>750</fpage>
        <?supplied-pmid 30057548?>
        <pub-id pub-id-type="pmid">30057548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid detection of genetic mutations in individual breast cancer patients by next-generation DNA sequencing</article-title>
        <source>Hum Genom</source>
        <year>2015</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>2</fpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yohe</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Thyagarajan</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Review of clinical next-generation sequencing</article-title>
        <source>Arch Pathol Lab Med</source>
        <year>2017</year>
        <volume>141</volume>
        <issue>11</issue>
        <fpage>1544</fpage>
        <lpage>1557</lpage>
        <?supplied-pmid 28782984?>
        <pub-id pub-id-type="pmid">28782984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caspar</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Dubacher</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kopps</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Meienberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Henggeler</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Matyas</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Clinical sequencing: from raw data to diagnosis with lifetime value</article-title>
        <source>Clin Genet</source>
        <year>2018</year>
        <volume>93</volume>
        <issue>3</issue>
        <fpage>508</fpage>
        <lpage>519</lpage>
        <?supplied-pmid 29206278?>
        <pub-id pub-id-type="pmid">29206278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peterson</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Doughty</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kann</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>Towards precision medicine: advances in computational approaches for the analysis of human variants</article-title>
        <source>J Mol Biol</source>
        <year>2013</year>
        <volume>425</volume>
        <issue>21</issue>
        <fpage>4047</fpage>
        <lpage>4063</lpage>
        <?supplied-pmid 23962656?>
        <pub-id pub-id-type="pmid">23962656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bamshad</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Exome sequencing as a tool for Mendelian disease gene discovery</article-title>
        <source>Nat. Rev. Genet.</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>11</issue>
        <fpage>745</fpage>
        <lpage>755</lpage>
        <?supplied-pmid 21946919?>
        <pub-id pub-id-type="pmid">21946919</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boycott</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Vanstone</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Bulman</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>MacKenzie</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Rare-disease genetics in the era of next-generation sequencing: discovery to translation</article-title>
        <source>Nat Rev Genet</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>10</issue>
        <fpage>681</fpage>
        <lpage>691</lpage>
        <?supplied-pmid 23999272?>
        <pub-id pub-id-type="pmid">23999272</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Rehm HL, et al. ACMG clinical laboratory standards for next-generation sequencing. Genet Med. 2013;15(9):733–47.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kaul</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>ZA</given-names>
          </name>
          <name>
            <surname>Abouelhoda</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>A high performance storage appliance for genomic data</source>
        <year>2017</year>
        <publisher-loc>Cham</publisher-loc>
        <publisher-name>Springer</publisher-name>
        <fpage>480</fpage>
        <lpage>488</lpage>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>High-throughput DNA sequence data compression</article-title>
        <source>Brief Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <?supplied-pmid 24300111?>
        <pub-id pub-id-type="pmid">24300111</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Numanagic</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of high-throughput sequencing data compression tools</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>12</issue>
        <fpage>1005</fpage>
        <lpage>1008</lpage>
        <?supplied-pmid 27776113?>
        <pub-id pub-id-type="pmid">27776113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hosseini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pratas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pinho</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A Survey on Data Compression Methods for Biological Sequences</article-title>
        <source>Information</source>
        <year>2016</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>56</fpage>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsi-Yang Fritz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Leinonen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cochrane</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Efficient storage of high throughput {DNA} sequencing data using reference-based compression</article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <issue>5</issue>
        <fpage>734</fpage>
        <lpage>740</lpage>
        <?supplied-pmid 21245279?>
        <pub-id pub-id-type="pmid">21245279</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonfield</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>The scramble conversion tool</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>19</issue>
        <fpage>2818</fpage>
        <lpage>2819</lpage>
        <?supplied-pmid 24930138?>
        <pub-id pub-id-type="pmid">24930138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rothberg</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated semiconductor device enabling non-optical genome sequencing</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>475</volume>
        <issue>7356</issue>
        <fpage>348</fpage>
        <lpage>352</lpage>
        <?supplied-pmid 21776081?>
        <pub-id pub-id-type="pmid">21776081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merriman</surname>
            <given-names>B</given-names>
          </name>
          <collab>I. T. R&amp;D Team</collab>
          <name>
            <surname>Rothberg</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Progress in ion torrent semiconductor chip based sequencing</article-title>
        <source>Electrophoresis</source>
        <year>2012</year>
        <volume>33</volume>
        <issue>23</issue>
        <fpage>3397</fpage>
        <lpage>3417</lpage>
        <pub-id pub-id-type="pmid">23208921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storer</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Szymanski</surname>
            <given-names>TG</given-names>
          </name>
        </person-group>
        <article-title>Data Compression via Textual Substitution</article-title>
        <source>J ACM</source>
        <year>1982</year>
        <volume>29</volume>
        <issue>4</issue>
        <fpage>928</fpage>
        <lpage>951</lpage>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">J. Duda, “[0902.0271] Asymmetric numeral systems.” [Online]. Available: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/0902.0271">https://arxiv.org/abs/0902.0271</ext-link>. Accessed 07 Mar 2020.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Zook JM, et al. Extensive sequencing of seven human genomes to characterize benchmark reference materials. Sci Data. 2016;3. <ext-link ext-link-type="uri" xlink:href="https://pubmed.ncbi.nlm.nih.gov/27271295/">https://pubmed.ncbi.nlm.nih.gov/27271295/</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/sdata201625">https://www.nature.com/articles/sdata201625</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">B. L. Divon Lan, Raymond Tobler, Yassine Souilmi, “genozip: a fast and efficient compression tool for VCF files | Bioinformatics | Oxford Academic.” [Online]. Available: <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bioinformatics/article/doi/10.1093/bioinformatics/btaa290/5837110">https://academic.oup.com/bioinformatics/article/doi/10.1093/bioinformatics/btaa290/5837110</ext-link>. [Accessed: 27 Jun 2020].</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>Illumina inc</collab>
        </person-group>
        <source>Understanding Illumina Quality Scores</source>
        <year>2012</year>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greenfield</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Rrustemi</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>GeneCodeq: quality score compression and improved genotyping using a Bayesian framework</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>20</issue>
        <fpage>3124</fpage>
        <lpage>3132</lpage>
        <?supplied-pmid 27354700?>
        <pub-id pub-id-type="pmid">27354700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>YW</given-names>
          </name>
          <name>
            <surname>Yorukoglu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Quality score compression improves genotyping accuracy</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>3</issue>
        <fpage>240</fpage>
        <lpage>243</lpage>
        <?supplied-pmid 25748910?>
        <pub-id pub-id-type="pmid">25748910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cánovas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Moffat</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Turpin</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Lossy compression of quality scores in genomic data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>15</issue>
        <fpage>2130</fpage>
        <lpage>2136</lpage>
        <?supplied-pmid 24728856?>
        <pub-id pub-id-type="pmid">24728856</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Ochoa I, Asnani H, Bharadia D, Chowdhury M, Weissman T, Yona G. QualComp: A new lossy compressor for quality scores based on rate distortion theory. BMC Bioinformatics. 2013;14(1). <ext-link ext-link-type="uri" xlink:href="https://pubmed.ncbi.nlm.nih.gov/23758828/">https://pubmed.ncbi.nlm.nih.gov/23758828/</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-187">https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-187</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
