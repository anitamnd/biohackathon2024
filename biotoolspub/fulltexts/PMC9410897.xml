<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9410897</article-id>
    <article-id pub-id-type="pmid">35641016</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkac405</article-id>
    <article-id pub-id-type="publisher-id">gkac405</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>Narese/14</subject>
        <subject>Narese/22</subject>
        <subject>Narese/24</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><sc>ShapeSorter</sc>: a fully probabilistic method for detecting conserved RNA structure features supported by SHAPE evidence</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tsybulskyi</surname>
          <given-names>Volodymyr</given-names>
        </name>
        <aff><institution>Berlin Institute for Medical Systems Biology, Max Delbrück Center for Molecular Medicine in the Helmholtz Association</institution>, Hannoversche Str. 28, 10115 Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>Freie Universität Berlin, Department of Mathematics and Computer Science, Institute of Computer Science</institution>, Takustraße 9, 14195 Berlin, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4048-3479</contrib-id>
        <name>
          <surname>Meyer</surname>
          <given-names>Irmtraud M</given-names>
        </name>
        <!--irmtraud.meyer@cantab.net-->
        <aff><institution>Berlin Institute for Medical Systems Biology, Max Delbrück Center for Molecular Medicine in the Helmholtz Association</institution>, Hannoversche Str. 28, 10115 Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>Freie Universität Berlin, Department of Biology, Chemistry and Pharmacy, Institute of Chemistry and Biochemistry</institution>, Thielallee 63, 14195 Berlin, <country country="DE">Germany</country></aff>
        <aff><institution>Freie Universität Berlin, Department of Mathematics and Computer Science, Institute of Computer Science</institution>, Takustraße 9, 14195 Berlin, <country country="DE">Germany</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +49 30 9406 3292; Fax: +49 30 9406 3291; Email: <email>irmtraud.meyer@cantab.net</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>26</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-05-31">
      <day>31</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <volume>50</volume>
    <issue>15</issue>
    <fpage>e85</fpage>
    <lpage>e85</lpage>
    <history>
      <date date-type="accepted">
        <day>09</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="received">
        <day>18</day>
        <month>1</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkac405.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>There is an increased interest in the determination of RNA structures <italic toggle="yes">in vivo</italic> as it is now possible to probe them in a high-throughput manner, e.g. using SHAPE protocols. By now, there exist a range of computational methods that integrate experimental SHAPE-probing evidence into computational RNA secondary structure prediction. The state-of-the-art in this field is currently provided by computational methods that employ the minimum-free energy strategy for prediction RNA secondary structures with SHAPE-probing evidence. These methods, however, rely on the assumption that transcripts <italic toggle="yes">in vivo</italic> fold into the thermodynamically most stable configuration and ignore evolutionary evidence for conserved RNA structure features. We here present a new computational method, <sc>ShapeSorter</sc>, that predicts RNA structure features without employing the thermodynamic strategy. Instead, <sc>ShapeSorter</sc> employs a fully probabilistic framework to identify RNA structure features that are supported by evolutionary and SHAPE-probing evidence. Our method can capture RNA structure heterogeneity, pseudo-knotted RNA structures as well as transient and mutually exclusive RNA structure features. Moreover, it estimates <italic toggle="yes">P</italic>-values for the predicted RNA structure features which allows for easy filtering and ranking. We investigate the merits of our method in a comprehensive performance benchmarking and conclude that <sc>ShapeSorter</sc> has a significantly superior performance for predicting base-pairs than the existing state-of-the-art methods.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Helmholtz Association</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001656</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="17"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>The transcriptome is the key layer that links any genome to its functional products (proteins, RNA genes etc). As we know by now, RNA structure features are not only involved in regulating the expression of protein-coding transcripts (splicing, translation initiation, transcript degradation etc.), but are also key for the defining the functional roles of many non-coding genes (<xref rid="B1" ref-type="bibr">1–12</xref>). The transcriptome thus not only comprises mRNAs which yield proteins, but also transcripts that correspond to the final, functional products of RNA genes. Moreover, many viral genomes exhibit functional RNA structures that regulate the expression of their genes and key steps of their life cycle (<xref rid="B2" ref-type="bibr">2</xref>,<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B14" ref-type="bibr">14</xref>). Yet, gaining large-scale insight into functional RNA structural features <italic toggle="yes">in vivo</italic> has only been recently become possible. Several new, experimental protocols now enable us to probe the RNA structurome <italic toggle="yes">in vivo</italic> and in a high-throughput manner. One such type of experiment is SHAPE-probing (<bold>s</bold>elective 2’-<bold>h</bold>ydroxyl <bold>a</bold>cylation analyzed by <bold>p</bold>rimer <bold>e</bold>xtension), where the spatial RNA configuration of transcripts <italic toggle="yes">in vivo</italic> is probed with a range of chemicals (<xref rid="B15" ref-type="bibr">15–19</xref>). By recording the results of this chemical probing in complementary, linear molecules that are amenable to high-throughput sequencing, the research community has established high-throughput protocols for RNA structure probing that have already generated a wealth of new biological insight.</p>
    <p>Apart from SHAPE-based RNA structure probing, there also exist numerous other, closely related techniques such as DMS (<xref rid="B20" ref-type="bibr">20</xref>) and, in particular, DMS-MaPseq (<xref rid="B21" ref-type="bibr">21</xref>,<xref rid="B22" ref-type="bibr">22</xref>). The raw output of DMS-MaPseq corresponds to short reads that may contain several modifications w.r.t. the underlying, typically longer transcript that encode information on its structure probing.</p>
    <p>There already exist several computational methods that directly utilize these DMS-MaPseq reads (and the RNA structure information that each of them encode) as direct input information in order to detect interesting RNA structure properties.</p>
    <p>One such method is <sc>Sleq</sc> (<xref rid="B23" ref-type="bibr">23</xref>), which takes as input a set of user-specified candidate RNA structures as well as structure profiling data in terms of individual sequence reads obtained by DMS-MaPseq and predicts as output so-called RNA structure landscapes.</p>
    <p>Similarly to <sc>Sleq</sc>, <sc>patteRNA</sc> (<xref rid="B24" ref-type="bibr">24</xref>) also takes as input user-specified RNA structure motifs as well as reads obtained by structure profiling experiments and predicts as output evidence for these input motifs. Internally, it employs a Gaussian-mixture-model hidden Markov model (GMM-HMM) to capture the patterns within the experimental input information in training using Baum–Welch training. The GMM-HMM only distinguishes between paired and unpaired nucleotide positions and does not aim to capture base-pairs. The trained model underlying <sc>patteRNA</sc> can then be used to discover the probability for a user-defined input motif in input RNA structure probing reads, where the underlying RNA sequences can be provided as optional additional input information.</p>
    <p>In addition to <sc>Sleq</sc> and <sc>patteRNA</sc>, there also exist recent methods that also utilize DMS-MaPseq reads as direct input to detect evidence for one or more RNA secondary structures. Unlike <sc>Sleq</sc> and <sc>patteRNA</sc>, however, the user is not required to specify input RNA structure motifs.</p>
    <p><sc>Dreem</sc> (<xref rid="B25" ref-type="bibr">25</xref>) takes as input a single RNA sequence as well as the corresponding DMS-MaPseq data which are summarized in terms of a binary readout of mutations and matches. This information is subsequently utilized as input constraints to <sc>RNAstructure</sc> (<xref rid="B32" ref-type="bibr">32–34</xref>) to predict minimum-free-energy (MFE) RNA secondary structures for each so-called cluster that is obtained by analysing the experimental input evidence with an expectation-maximization (EM) algorithm. As output, <sc>Dreem</sc> produces an ensemble of RNA secondary structures (the default is two) and can thereby capture RNA structure heterogeneity so a certain extent. <sc>Dreem</sc> requires as input, however, DMS-MaPseq reads covering the entire transcript of interest.</p>
    <p>Similar to <sc>Dreem</sc>, <sc>Draco</sc> (<xref rid="B26" ref-type="bibr">26</xref>) also takes as input the raw reads obtained from DMS-MaPseq structure profiling experiments. Internally, <sc>Draco</sc> employs a prediction pipeline which utilizes a range of existing tools and two different clustering strategies to predict a set of RNA secondary structures. Some steps in the prediction pipeline of <sc>Draco</sc> are guided by minimum-free-energy considerations and some are guided by evolutionary conservation. Unlike <sc>Dreem</sc>, <sc>Draco</sc> can also utilize short DMS-MaPseq reads that do not cover the entire transcript of interest. Its prediction performance thus naturally depends on the coverage and read depth along this transcript.</p>
    <p>Both, <sc>Dreem</sc> and <sc>Draco</sc> are capable of detecting evidence for RNA structure heterogeneity by detecting different patterns of mutations in DMS-MaPseq reads that map to the same location in the transcript of interest.</p>
    <p>Typically, the raw data generated by any SHAPE-probing experiment is summarized into a so-called SHAPE reactivity profile along the transcript of interest. This profile consists of individual reactivity values for each nucleotide position in the transcript. These values quantify the rigidity of the RNA backbone at the respective nucleotide position that was chemically probed with the SHAPE-reagent. In order to gain evidence for specific RNA structure features such as base-pairs, however, this raw reactivity data first needs to be interpreted computationally. This requires the conversion of the linear signal along the sequence (i.e. the sequence-position specific reactivity values) into evidence for individual base-pairs of an RNA secondary structures, i.e. information on which sequence position base-pairs with which other sequence position. As valid base-pairs, we consider in the following the six consensus base-pairs {{<italic toggle="yes">G</italic>, <italic toggle="yes">C</italic>}, {<italic toggle="yes">C</italic>, <italic toggle="yes">G</italic>}, {<italic toggle="yes">G</italic>, <italic toggle="yes">U</italic>}, {<italic toggle="yes">U</italic>, <italic toggle="yes">G</italic>}, {<italic toggle="yes">A</italic>, <italic toggle="yes">U</italic>}, {<italic toggle="yes">U</italic>, <italic toggle="yes">A</italic>}}, i.e. both Watson–Crick and non-Watson–Crick base-pairs. There already exists a range of computational methods that take as input the sequence of interest as well as the corresponding SHAPE reactivity profile and predict as output an RNA secondary structure. Most of these methods, however, employ the so-called minimum-free energy (MFE) or thermodynamic strategy for RNA secondary structure prediction which assumes that the transcript of interest folds into the thermodynamically most stable RNA secondary structure. In any biological context <italic toggle="yes">in vivo</italic>, however, the validity of this assumption can to be questioned due to the known influence of processes such as co-transcriptional folding, i.e. the RNA folding kinetics, and the impact of potential <italic toggle="yes">trans</italic> binding partners such as proteins, other transcripts or ligands (<xref rid="B27" ref-type="bibr">27–31</xref>).</p>
    <p>All of the existing state-of-the-art methods take as input a SHAPE reactivity profile and interpret the experimental SHAPE-probing reactivities as many position-specific modifications to the nominal free-energy parameters on which the predictions of these thermodynamic methods depend. Moreover, they consider as sequence input only the transcript of interest (<xref rid="B32" ref-type="bibr">32–38</xref>). This so-called MFE strategy has been extended to also handle pseudo-knotted RNA secondary structures (<xref rid="B35" ref-type="bibr">35</xref>). As an alternative to the MFE approach, several other methods have been proposed for integrating experimental SHAPE-probing data into computational RNA secondary structure prediction (<xref rid="B39" ref-type="bibr">39–41</xref>). These methods employ different concepts and strategies, both for predicting RNA secondary structures and for integrating SHAPE-probing evidence, but all employ fully probabilistic frameworks, both for modelling RNA secondary structure features and for integrating SHAPE-probing evidence.</p>
    <p>One such method is <sc>PPfold</sc> (<xref rid="B39" ref-type="bibr">39</xref>), which is a comparative method that takes as input a multiple-sequence alignment. It models RNA secondary structures via a stochastic context-free grammar (SCFG). It integrates evolutionary evidence for RNA structure features into RNA structure prediction and incorporates experimental evidence via dedicated probability terms that capture the SHAPE-probing data along the reference sequence in the input alignment. <sc>ProbFold</sc> (<xref rid="B40" ref-type="bibr">40</xref>) is a method that employs an extended version of the SCFG underlying <sc>PPfold</sc> for modelling RNA secondary structures which considers pairs of neighbouring base-pairs (so-called stacking interactions). Unlike <sc>PPfold</sc>, however, it does not capture evolutionary evidence for RNA structure features and takes as input only the transcript of interest. Compared to <sc>PPfold</sc>, <sc>ProbFold</sc> employs a more sophisticated concept for incorporating SHAPE-reactivities which captures correlations between the SHAPE-reactivities of neighbouring sequence positions.</p>
    <p>We here propose a new method for incorporating SHAPE-probing evidence into RNA secondary structure prediction, called <sc>ShapeSorter</sc>. As comparative methods are known to significantly outperform non-comparative ones in RNA secondary structure prediction (<xref rid="B42" ref-type="bibr">42</xref>), we also employ a comparative strategy to capture evolutionary evidence for conserved RNA structure features by taking a multiple-sequence alignment (MSA) as input. This alignment contains the un-gapped transcript of interest as reference sequence on top. This reference sequence is the sequence from which the experimental SHAPE-reactivities derive. The input of <sc>ShapeSorter</sc> thus consists of a multiple-sequence alignment and a SHAPE reactivity profile for the reference sequence in the input alignment. <sc>ShapeSorter</sc> employs a fully probabilistic framework, both for modelling RNA structure features and for integrating experimental SHAPE-evidence into RNA structure prediction. <sc>ShapeSorter</sc> predicts as output RNA structure features with estimated <italic toggle="yes">P</italic>-values. The probabilistic framework underlying <sc>ShapeSorter</sc> captures the known correlations between SHAPE-reactivities of neighbouring sequence positions and also models correlations between stacking base-pairs (<xref rid="B39" ref-type="bibr">39</xref>). Unlike the existing methods, we model RNA structure features on the level of individual helices, i.e. contiguous stretches of base-pairs, rather than an entire RNA secondary structure. There are two main reasons for doing so.</p>
    <p>First, it allows us to mirror the fact that SHAPE-evidence is experimentally gathered via individual reads that are sequenced as part of the primary SHAPE-experiment read-out. These reads are typically short and do not span the entire entire transcript that was probed. Moreover, the resulting reads do not retain any additional information on the identity of the transcript from which they derive. More importantly, these SHAPE-reads are typically mapped to the same transcript and subsequently shoehorned into a single RNA secondary structure by the existing methods, thereby implicitly assuming that they derive from <italic toggle="yes">probing one and the same molecule</italic>. SHAPE-reads deriving from several, identical copies of the same transcript with <italic toggle="yes">different RNA secondary structures</italic> will, however, result in an ensemble of reads that encode this RNA structure heterogeneity. These reads should therefore <italic toggle="yes">not</italic> be mapped and interpreted in this simplistic manner. This is, however, what the existing methods for integrating SHAPE-reactivities into RNA secondary structure prediction do.</p>
    <p>Second, by gathering evolutionary and experimental SHAPE-evidence for individual helices rather than entire RNA secondary structure, <sc>ShapeSorter</sc> can naturally detect RNA structure heterogeneity, pseudo-knotted RNA structure features, as well as transient RNA structure features. Another unique feature of <sc>ShapeSorter</sc> is its ability to estimate <italic toggle="yes">P</italic>-values for its predicted RNA structure features which allows users to easily filter and rank them, e.g. as input information to dedicated follow-up experiments.</p>
    <p>In the following, we first introduce our method and its underlying algorithm and theoretical framework. We then investigates the merits of <sc>ShapeSorter</sc> in a comprehensive benchmarking of its predictive performance. This benchmarking evaluates the predictive performance in terms of <italic toggle="yes">F</italic><sub>measure</sub> as well as <italic toggle="yes">MCC</italic>, not only for individual nucleotides, but also for base-pairs which constitute the elementary building blocks of RNA secondary structures.</p>
  </sec>
  <sec sec-type="methods" id="SEC2">
    <title>METHODS</title>
    <sec id="SEC2-1">
      <title>The prediction program <sc>ShapeSorter</sc></title>
      <p>The raw experimental data derived from experimentally probing RNA secondary structures with SHAPE chemistry consists of a reactivity profile along the transcript in question, i.e. a reactivity value for each nucleotide position.</p>
      <p>This information along the sequence is derived by mapping the raw SHAPE probing data of many high-throughput sequencing reads to the sequence transcript of interest. It is important to recall that these reads are (i) typically much shorter than the transcript itself and—importantly—(ii) derive from the probing of many identical copies of the same transcript. These sequence-wise identical copies of the same molecule may, however, assume different RNA secondary structures <italic toggle="yes">in vivo</italic>. By mapping the reads deriving from multiple copies of the same transcript to one sequence, we therefore have to keep in mind that they may contain information about multiple RNA secondary structures rather than a unique one. The existing computational methods for integrating experimental SHAPE-information into RNA secondary structure prediction, however, implicitly assume that the experimental evidence derives from a <italic toggle="yes">unique</italic> RNA secondary structure and correspondingly predict a <italic toggle="yes">single, unique</italic> RNA secondary structure. As there is sufficient evidence that RNA-structured transcripts can assume several functional RNA structures <italic toggle="yes">in vivo</italic> (<xref rid="B27" ref-type="bibr">27</xref>), one goal in devising <sc>ShapeSorter</sc> was to predict RNA structure features on the level of helices, i.e. consecutive stretches of base-pairs. By predicting RNA structure features as individual helices rather than a single, unique RNA secondary structure, <sc>ShapeSorter</sc> can therefore detect (i) RNA structure heterogeneity, (ii) pseudo-knotted RNA secondary structures as well as (iii) transient and (iv) mutually exclusive RNA structure features.</p>
      <p>A second major goal in devising <sc>ShapeSorter</sc>, was to use a fully probabilistic approach (i) for capturing evidence for conserved RNA structure features from evolutionarily related transcripts (<italic toggle="yes">P</italic><sub>evol</sub>), (ii) for capturing experimental SHAPE-evidence along the reference sequence (<italic toggle="yes">P</italic><sub>SHAPE</sub>) and (iii) for combining both types of evidence into one integrated theoretical framework. This not only results in a mathematically elegant concept, but also has practical advantages. It allows us to estimate <italic toggle="yes">P</italic>-values for <sc>ShapeSorter</sc>’s predictions and also enables a retraining of <sc>ShapeSorter</sc>’s free parameters, e.g. when new sets of training data become available. To summarize, our goals in devising <sc>ShapeSorter</sc> were:</p>
      <list list-type="bullet">
        <list-item>
          <p>Goal 1: to detect RNA structure features which are supported by evolutionary and experimental SHAPE-derived evidence</p>
        </list-item>
        <list-item>
          <p>Goal 2: to identify evidence for RNA structure heterogeneity, i.e. in terms of multiple functional RNA structures, pseudo-knotted RNA structures, transient RNA structure features and mutually incompatible RNA structure features</p>
        </list-item>
        <list-item>
          <p>Goal 3: to employ a fully probabilistic theoretical framework to seamlessly integrate both types of evidence (evolutionary, experimental SHAPE-derived) and to estimate <italic toggle="yes">P</italic>-values for the predicted RNA structure features</p>
        </list-item>
      </list>
      <sec id="SEC2-1-1">
        <title>Overall algorithmic flow of <sc>ShapeSorter</sc></title>
        <p>As we explain already above, <sc>ShapeSorter</sc> models RNA structures on the level of individual helices rather than a unique RNA secondary structure (i.e. a set of mutually compatible base-pairs that could be formed at the same time), see also goal 2 above.</p>
        <p><sc>ShapeSorter</sc> requires as input (i) a multiple-sequence alignment (MSA) containing the un-gapped reference sequence on top (fasta format), see Figure <xref rid="F1" ref-type="fig">1</xref>, and (ii) a SHAPE reactivity profile for the reference sequence in the input alignment. In addition, the user can optionally also supply as input an evolutionary tree relating the sequences of the input alignment (binary, rooted tree in Newick format). If this input tree is not supplied by the user, <sc>ShapeSorter</sc> automatically estimates a maximum-likelihood tree (<xref rid="B41" ref-type="bibr">41</xref>). As output, <sc>ShapeSorter</sc> predicts individual helices with estimated <italic toggle="yes">P</italic>-values.</p>
        <fig position="float" id="F1">
          <label>Figure 1.</label>
          <caption>
            <p>Overall algorithmic strategy of <sc>ShapeSorter</sc>. <sc>ShapeSorter</sc> uses as input a multiple-sequence alignment with the un-gapped reference sequence at the top, an un-normalized SHAPE-probing reactivity profile for the reference sequence in the input alignment and, optionally, an evolutionary tree linking the sequencing in the input alignment. The un-normalized SHAPE-probing reactivity profile consists of reactivity values for the nucleotide positions along the reference sequence in the input alignment, see the reactivities shown along the y-axis in the top part of the figure. The algorithm underlying <sc>ShapeSorter</sc> (1) first identifies all candidate helices in the reference sequence and (2) then projects those onto the input alignment. It then calculates a log-likelihood score <inline-formula><tex-math id="M0001" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Delta _{{\small ShapeSorter}}(h)$\end{document}</tex-math></inline-formula> for every projected candidate helix <italic toggle="yes">h</italic> (3) and, finally, estimates <italic toggle="yes">P</italic>-values for each helix (4). The <italic toggle="yes">P</italic>-value of each helix quantifies the probability that the helix with the same log-likelihood score could have arisen by chance, i.e. the lower this value the higher the confidence that helix <italic toggle="yes">h</italic> is real, please see the text on ‘Overall algorithmic flow of <sc>ShapeSorter</sc>’ for more details.</p>
          </caption>
          <graphic xlink:href="gkac405fig1" position="float"/>
        </fig>
        <p><sc>ShapeSorter</sc> then normalizes the input SHAPE reactivity profile for the reference sequence in a well established manner, see <sc>RNAstructure</sc> (<xref rid="B32" ref-type="bibr">32–34</xref>), <sc>ProbFold</sc> (<xref rid="B40" ref-type="bibr">40</xref>) and <sc>ShapeKnots</sc> (<xref rid="B35" ref-type="bibr">35</xref>), by scaling the input SHAPE reactivities so they range between 0 and 1. This results in a normalized SHAPE reactivity profile which is subsequently used within <sc>ShapeSorter</sc>.</p>
        <p><sc>ShapeSorter</sc> then considers the input multiple sequence alignment. The first step consists of identifying all candidate helices of minimum length (the default is <italic toggle="yes">L</italic><sub><italic toggle="yes">min</italic></sub> = 3) in the reference sequence, see step (1) in Figure <xref rid="F1" ref-type="fig">1</xref>. This is done using an efficient dynamic programming algorithm that requires quadratic memory and time as function of the reference sequence’s length <italic toggle="yes">L</italic> (in nucleotides), i.e. <inline-formula><tex-math id="M0001a" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}(L^2)$\end{document}</tex-math></inline-formula> memory and time. This steps returns all candidate helices <italic toggle="yes">h</italic> within the input sequence. Each helix <italic toggle="yes">h</italic> = <italic toggle="yes">h</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) can be denoted by a triple <italic toggle="yes">h</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) = (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>, <italic toggle="yes">L</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>)) specifying its outermost base-pair at (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>), <italic toggle="yes">i</italic> &lt; <italic toggle="yes">j</italic>, and its <italic toggle="yes">L</italic>(<italic toggle="yes">h</italic>) = <italic toggle="yes">L</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) (in base-pairs). Each of these candidate helices <italic toggle="yes">h</italic> then gets projected onto the input alignment, see step (2) in Figure <xref rid="F1" ref-type="fig">1</xref>. Note that after this projection, each candidate helix <italic toggle="yes">h</italic> = <italic toggle="yes">h</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) within the alignment corresponds to a helix with the outer base-pair linking alignment columns <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>, <italic toggle="yes">i</italic> &lt; <italic toggle="yes">j</italic>, comprising <italic toggle="yes">L</italic>(<italic toggle="yes">h</italic>) = <italic toggle="yes">L</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) consecutive base-pairs. As the reference sequence in the alignment is un-gapped, the coordinates of the candidate helices within the reference sequence remain the unchanged when mapped to the alignment. Each candidate helix within the alignment then gets assigned an overall quantitative score <inline-formula><tex-math id="M0002" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Lambda _{{\small ShapeSorter}}(h)$\end{document}</tex-math></inline-formula>. This so-called log-likelihood score compares two competing hypotheses, one in favour of the helix <italic toggle="yes">h</italic> being indeed a helix, i.e. a stretch of consecutive base-pairs, and one in favour of the helix <italic toggle="yes">h</italic> rather corresponding to unpaired positions. As evidence for <italic toggle="yes">h</italic>, we take two contributions into account:</p>
        <list list-type="bullet">
          <list-item>
            <p>evolutionary evidence for <italic toggle="yes">h</italic> in terms of sequence- and RNA structure features encoded in the alignment, see Λ<sub>evol</sub>(<italic toggle="yes">h</italic>) below</p>
          </list-item>
          <list-item>
            <p>experimental evidence for <italic toggle="yes">h</italic> in terms of SHAPE-values along the experimentally probed reference sequence, see Λ<sub>exp</sub>(<italic toggle="yes">h</italic>) below</p>
          </list-item>
        </list>
        <p>Overall, we express:<disp-formula id="M1"><label>(1)</label><tex-math id="M0003" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \Lambda _{{\small ShapeSorter}}(h) = \Lambda _{{\rm evol}}(h) + \Lambda _{{\rm exp}}(h) \end{equation*}$$\end{document}</tex-math></disp-formula></p>
        <p>A log-likelihood <inline-formula><tex-math id="M0004" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Lambda _{{\small ShapeSorter}}(h) &gt;0$\end{document}</tex-math></inline-formula> is interpreted as evidence for the helix, whereas a log-likelihood smaller zero is interpreted as evidence against it.</p>
        <p>Once the <inline-formula><tex-math id="M0005" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Lambda _{{\small ShapeSorter}}(h)$\end{document}</tex-math></inline-formula> values for all candidate helices <italic toggle="yes">h</italic> in the alignment have been calculated, <sc>ShapeSorter</sc> estimates <italic toggle="yes">P</italic>-values or reliability values for them. This step is required in order to make <inline-formula><tex-math id="M0006" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Lambda _{{\small ShapeSorter}}(h)$\end{document}</tex-math></inline-formula> values deriving from different alignments comparable. It is a well-known fact that the overall propensity of any alignment to form spurious helices depends on features such as its di-nucleotide distribution and the gap pattern. In order to estimate the probability that a candidate helix <italic toggle="yes">h</italic> with log-likelihood score <inline-formula><tex-math id="M0007" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Lambda _{{\small ShapeSorter}}(h)$\end{document}</tex-math></inline-formula> may have arisen by chance, we need to estimate <italic toggle="yes">P</italic>-values <italic toggle="yes">p</italic><sub><italic toggle="yes">value</italic></sub>(<italic toggle="yes">h</italic>) for each candidate helix <italic toggle="yes">h</italic>. This is done by shuffling the original input alignment and the corresponding values of the SHAPE reactivity profile in a manner which preserves key properties such as the sequence conversation and gap pattern while erasing any patterns resembling real RNA structure features (<xref rid="B43" ref-type="bibr">43</xref>,<xref rid="B44" ref-type="bibr">44</xref>).</p>
        <p>In the final step, <sc>ShapeSorter</sc> reports as output a list of potential helices <italic toggle="yes">h</italic> for the reference sequence that can be readily ranked by their <italic toggle="yes">P</italic>-values. By choosing a higher or lower <italic toggle="yes">P</italic>-value threshold, the user can decide on the level of trustworthiness of the remaining RNA structure features. The predicted features and their corresponding evidence can then be visualized, e.g. with <sc>R-Chie</sc> (<xref rid="B45" ref-type="bibr">45</xref>,<xref rid="B46" ref-type="bibr">46</xref>) which was used to make the RNA structure visualizations here.</p>
      </sec>
      <sec id="SEC2-1-2">
        <title>Capturing evolutionary evidence in Λ<sub>evol</sub>(<italic toggle="yes">h</italic>)</title>
        <p>The state-of-art programs for RNA secondary structure prediction all capture evolutionary evidence for RNA structure features (<xref rid="B42" ref-type="bibr">42</xref>), i.e. they work in a comparative manner by investigating as input a set of evolutionarily related sequences rather than only the transcript of interest. Example of these programs comprise (<xref rid="B13" ref-type="bibr">13</xref>,<xref rid="B47" ref-type="bibr">47</xref>,<xref rid="B48" ref-type="bibr">48</xref>). One goal in devising <sc>ShapeSorter</sc> was to be able to detect all RNA structure features of potential functional relevance <italic toggle="yes">in vivo</italic>, including multiple, pseudo-knotted, transient and mutually exclusive RNA structure features, see goal 2 above. Previous research has shown that these structure features can be conserved on the same or similar evolutionary level as features of the nominal, final RNA structure (<xref rid="B27" ref-type="bibr">27</xref>,<xref rid="B28" ref-type="bibr">28</xref>) We therefore adopt the same strategy within <sc>ShapeSorter</sc> for gathering evidence for RNA structure features of potential functional importance <italic toggle="yes">in vivo</italic>. The beauty of this so-called evolutionary strategy is that it is allows us to detect RNA structure features of potential functional importance <italic toggle="yes">without forcing us to first understand why these features are important for the transcript in</italic> in vivo.</p>
        <p><sc>ShapeSorter</sc> captures evidence for evolutionarily conserved RNA structure features in terms of a log-likelihood score Λ<sub>evol</sub>(<italic toggle="yes">h</italic>), which is calculated for each candidate helix <italic toggle="yes">h</italic>, see also Figure <xref rid="F2" ref-type="fig">2</xref>. This log-likelihood score evaluates two competing hypotheses. It compares the likelihood in support of the hypothesis θ<sub><italic toggle="yes">pair</italic></sub> that the alignment columns comprising helix <italic toggle="yes">h</italic> evolved as base-paired alignment columns, i.e. <italic toggle="yes">P</italic><sub>evol</sub>(<italic toggle="yes">h</italic>∣θ<sub><italic toggle="yes">pair</italic></sub>), to the competing hypothesis θ<sub><italic toggle="yes">single</italic></sub> that these two alignment columns evolved independently, i.e. <italic toggle="yes">P</italic><sub>evol</sub>(<italic toggle="yes">h</italic>∣θ<sub><italic toggle="yes">single</italic></sub>). We can express the overall log-likelihood Λ<sub>evol</sub>(<italic toggle="yes">h</italic>) as the sum of log-likelihood contributions from individual pairs of base-paired alignment columns at (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>), (<italic toggle="yes">i</italic> + 1, <italic toggle="yes">j</italic> − 1) ... and (<italic toggle="yes">i</italic> + <italic toggle="yes">L</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) − 1, <italic toggle="yes">j</italic> − <italic toggle="yes">L</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) + 1). For a given helix <italic toggle="yes">h</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) of length <italic toggle="yes">L</italic>(<italic toggle="yes">h</italic>) can write:<disp-formula id="M2"><label>(2)</label><tex-math id="M0008" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} \Lambda _{{\rm evol}}(h) &amp; =&amp; \log _2\left({\dfrac{P_{{\rm evol}}(h\mid \theta _{pair})}{P_{{\rm evol}}(h\mid \theta _{single})}}\right) \nonumber\\ P_{{\rm evol}}(h\mid \theta _{pair}) &amp;=&amp; \Pi ^{L(h)}_{k=1} P_{{\rm evol}}((i + k -1, j - k - 1)\mid \theta _{pair}) \nonumber\\ P_{{\rm evol}}(h\mid \theta _{single}) &amp;=&amp; \Pi ^{L(h)}_{k=1} P_{{\rm evol}}(i + k -1\mid \theta _{single}) \cdot \nonumber\\ &amp;&amp; P_{{\rm evol}}(j - k - 1\mid \theta _{single}) \end{eqnarray*}$$\end{document}</tex-math></disp-formula></p>
        <fig position="float" id="F2">
          <label>Figure 2.</label>
          <caption>
            <p>Sources of evidence captured by <sc>ShapeSorter</sc>. <sc>ShapeSorter</sc> captures two main types of evidence to predict RNA secondary structure features. One type of evidence is evolutionary evidence. This type of evidence—for unpaired and base-paired positions in the input reference sequence—is derived from the evolutionary signals encoded in in the input alignment (not shown here). In a nutshell, evolutionary evidence for base-pairs is derived from pairs of co-evolving alignment columns, whereas evolutionary evidence for unpaired nucleotides is extracted from independently evolving alignment columns. Please see the section on ‘Overall algorithmic flow of <sc>ShapeSorter</sc>’ for more details on how evolutionary evidence is captured quantitatively. The second type of evidence are correlations within RNA structure features and within the experimental SHAPE-probing data. It is a well-known fact that the chemical stacking interaction between directly adjacent base-pairs in helices is important, see the two base-pairs highlighted in green inside the helix. SHAPE-probing chemically assesses the rigidity of the RNA backbone which is why SHAPE-reactivities of adjacent nucleotides along the linear sequence tend to have correlated reactivity values, see the sequence positions marked by stars (⋆), both within base-pair regions (filled stars in green) and unpaired regions (open stars in blue). Please see the section on ‘Overall algorithmic flow of <sc>ShapeSorter</sc>’ for more details on how this second type of evidence is captured within <sc>ShapeSorter</sc>.</p>
          </caption>
          <graphic xlink:href="gkac405fig2" position="float"/>
        </fig>
        <p>Here, <italic toggle="yes">P</italic><sub>evol</sub>((<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>)∣θ<sub><italic toggle="yes">pair</italic></sub>) denotes the likelihood of observing the pair of base-paired alignment columns <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> that evolved according to our probabilistic evolutionary model for base-pairs and the input evolutionary tree linking the sequences in the input alignment. This probabilistic model of evolution spells out quantitatively how individual base-pairs evolve as function of evolutionary time <italic toggle="yes">t</italic>. The model is formally defined via a 16 × 16 rate matrix <italic toggle="yes">R</italic> = (<italic toggle="yes">r</italic><sub>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>), (<italic toggle="yes">k</italic>, <italic toggle="yes">m</italic>)</sub>), where each entry <italic toggle="yes">r</italic><sub>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>), (<italic toggle="yes">k</italic>, <italic toggle="yes">m</italic>)</sub> (in units time<sup>−1</sup>) specifies the rate at which base-pair (<italic toggle="yes">k</italic>, <italic toggle="yes">m</italic>) evolves into (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) per unit of time. Here, the indices are nucleotides from the RNA alphabet, i.e. <inline-formula><tex-math id="M0009" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$k,m,i,j \in \mathcal {A} =\lbrace A, C, G, U\rbrace$\end{document}</tex-math></inline-formula>. This model has been well-established earlier (<xref rid="B41" ref-type="bibr">41</xref>) and is used by us in conjunction with the Felsenstein algorithm (<xref rid="B49" ref-type="bibr">49</xref>) to calculate <italic toggle="yes">P</italic><sub>evol</sub>((<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>)∣θ<sub><italic toggle="yes">pair</italic></sub>) in the same manner as in (<xref rid="B41" ref-type="bibr">41</xref>). This is done by evolving base-pairs according to the topology and branch lengths specified in the input tree from the root node of the tree to its leave nodes with the observed nucleotides and gaps in the respective columns of the input alignment. As usual, gaps in the alignment are treated as missing information. As the reference sequence in the alignment is un-gapped, gaps may only occur in other sequences.</p>
        <p>Similarly, <italic toggle="yes">P</italic><sub>evol</sub>(<italic toggle="yes">i</italic>∣θ<sub><italic toggle="yes">single</italic></sub>) denotes the log-likelihood of observing the un-paired alignment column <italic toggle="yes">i</italic> that evolved according to our probabilistic evolutionary model for individual nucleotides. This log-likelihood is calculated using the probabilistic model of evolution for individual nucleotides which is specified by a 4 × 4 rate matrix <italic toggle="yes">R</italic> = (<italic toggle="yes">r</italic><sub><italic toggle="yes">i</italic>, <italic toggle="yes">k</italic></sub>), where each entry <italic toggle="yes">r</italic><sub><italic toggle="yes">i</italic>, <italic toggle="yes">k</italic></sub> (units time<sup>−1</sup>) specifies the rate at which nucleotide <italic toggle="yes">k</italic> evolves into <italic toggle="yes">i</italic> per unit of time, where the indices <italic toggle="yes">i</italic> and <italic toggle="yes">k</italic> once again derive from the RNA alphabet <inline-formula><tex-math id="M00010" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {A}$\end{document}</tex-math></inline-formula>. Once again, the log-likelihood calculation for individual alignment columns is done analogous to the log-likelihood calculation for base-paired alignment columns (<xref rid="B41" ref-type="bibr">41</xref>,<xref rid="B49" ref-type="bibr">49</xref>).</p>
      </sec>
      <sec id="SEC2-1-3">
        <title>Capturing experimental SHAPE-derived evidence in Λ<sub>exp</sub>(<italic toggle="yes">h</italic>)</title>
        <p>Similarly to Λ<sub>evol</sub>(<italic toggle="yes">h</italic>), also Λ<sub>exp</sub>(<italic toggle="yes">h</italic>) compares two competing hypotheses for any candidate helix <italic toggle="yes">h</italic> in <sc>ShapeSorter</sc>, see Figure <xref rid="F2" ref-type="fig">2</xref>.</p>
        <p>The first hypothesis θ<sub><italic toggle="yes">stack</italic></sub> assumes that experimental evidence for helix <italic toggle="yes">h</italic> can be attributing to corresponding SHAPE-probing values for stacking base-pairs, as captured by the likelihood <italic toggle="yes">P</italic><sub><italic toggle="yes">exp</italic></sub>(<italic toggle="yes">h</italic>∣θ<sub><italic toggle="yes">stack</italic></sub>), where each stacking interaction involves two directly adjacent base-pairs (see the green base-pairs in Figure <xref rid="F2" ref-type="fig">2</xref>). The corresponding competing hypothesis θ<sub><italic toggle="yes">single</italic></sub> assumes that experimental evidence for helix <italic toggle="yes">h</italic> can be better explained by corresponding SHAPE-probing values for un-paired nucleotides, as captured by the likelihood <italic toggle="yes">P</italic><sub><italic toggle="yes">exp</italic></sub>(<italic toggle="yes">h</italic>∣θ<sub><italic toggle="yes">single</italic></sub>) (see the nucleotides marked in blue in Figure <xref rid="F2" ref-type="fig">2</xref>). For a helix <italic toggle="yes">h</italic> of length <italic toggle="yes">L</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) with outermost base-pair (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>), we can thus write:<disp-formula id="M3"><label>(3)</label><tex-math id="M00011" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} \Lambda _{{\rm exp}}(h) &amp;=&amp; \log _2\left({\dfrac{P_{exp}(h\mid \theta _{stack})}{P_{exp}(h\mid \theta _{single})}}\right) \nonumber\\ P_{exp}(h\mid \theta _{stack}) &amp;=&amp; \Pi ^{L(i,j)}_{k=1} P_{exp}((i + k -1, j - k - 1)\mid \theta _{stack}) \nonumber\\ P_{exp}(h\mid \theta _{single}) &amp;=&amp; \Pi ^{L(i,j)}_{k=1} P_{exp}(i + k -1\mid \theta _{single}) \cdot \nonumber\\ &amp;&amp; P_{exp}(j - k - 1\mid \theta _{single}) \end{eqnarray*}$$\end{document}</tex-math></disp-formula>where<disp-formula id="M4"><label>(4)</label><tex-math id="M00012" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} P_{exp}((i, j)\mid \theta _{stack}) &amp;=&amp; P((x_{i-1}, x_{j+1}), (x_{i}, x_{j})) \cdot \nonumber\\ &amp;&amp; P_{exp}^{pair}(i) \cdot P_{exp}^{pair}(j+1) \cdot \nonumber\\ &amp;&amp; P_{exp}^{pair}(i\mid i-1) \cdot P_{exp}^{pair}(j+1\mid j) \nonumber\\ P_{exp}((i, j)\mid \theta _{single}) &amp;=&amp; P(x_i) \cdot P(x_j) \cdot P_{exp}^{single}(i) \cdot \nonumber\\ &amp;&amp; P_{exp}^{single}(j) \cdot P_{exp}^{single}(i\mid i-1) \cdot \nonumber\\ &amp;&amp; P_{exp}^{single}(j+1\mid j) \end{eqnarray*}$$\end{document}</tex-math></disp-formula></p>
        <p>Here, <inline-formula><tex-math id="M00013" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P_{exp}^{pair}(i)$\end{document}</tex-math></inline-formula> denotes the probability of the SHAPE-reactivity at position <italic toggle="yes">i</italic> of the reference sequence, if this position is base-paired. <inline-formula><tex-math id="M00014" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P_{exp}^{pair}(i\mid i-1)$\end{document}</tex-math></inline-formula> corresponds to the conditional probability of the SHAPE-reactivity at sequence position <italic toggle="yes">i</italic>, given the SHAPE-reactivity at the next neighbouring position up-stream <italic toggle="yes">i</italic> − 1, if both positions are base-paired. Likewise, <inline-formula><tex-math id="M00015" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P_{exp}^{single}(i)$\end{document}</tex-math></inline-formula> corresponds to the probability of the SHAPE-reactivity at <italic toggle="yes">i</italic>, if this position is unpaired. And <inline-formula><tex-math id="M00016" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$P_{exp}^{single}(i \mid i-1)$\end{document}</tex-math></inline-formula> denotes the conditional probability of observing the SHAPE-reactivity at <italic toggle="yes">i</italic>, given the SHAPE-reactivity at the next neighbouring position upstream <italic toggle="yes">i</italic> − 1, if both are unpaired. <italic toggle="yes">P</italic>((<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic> − 1</sub>, <italic toggle="yes">x</italic><sub><italic toggle="yes">j</italic> + 1</sub>), (<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">x</italic><sub><italic toggle="yes">j</italic></sub>)) is the joint probability of observing nucleotides (<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>, <italic toggle="yes">x</italic><sub><italic toggle="yes">j</italic></sub>) as base-pair at sequence position pair (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) and nucleotides (<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic> − 1</sub>, <italic toggle="yes">x</italic><sub><italic toggle="yes">j</italic> + 1</sub>) as directly adjacent, inner base-pair at sequence position pair (<italic toggle="yes">i</italic> − 1, <italic toggle="yes">j</italic> + 1), see the two base-pairs highlighted in green in Figure <xref rid="F2" ref-type="fig">2</xref>. Lastly, <italic toggle="yes">P</italic>(<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>) is the probability of observing nucleotide <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>.</p>
        <p>The term <italic toggle="yes">P</italic><sub><italic toggle="yes">exp</italic></sub>((<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>)∣θ<sub><italic toggle="yes">stack</italic></sub>) therefore not only considers the SHAPE-contribution from the nucleotides forming base-pair at (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>), but also from the nucleotides of the inner, directly adjacent base-pair at (<italic toggle="yes">i</italic> − 1, <italic toggle="yes">j</italic> + 1). Similarly, <italic toggle="yes">P</italic><sub><italic toggle="yes">exp</italic></sub>((<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>)∣θ<sub><italic toggle="yes">single</italic></sub>) not only considers the SHAPE-contribution from sequence position <italic toggle="yes">i</italic>, but also from sequence position <italic toggle="yes">i</italic> − 1. This captures the fact that SHAPE-experiments chemically probe the rigidity of the RNA’s backbone (<xref rid="B50" ref-type="bibr">50</xref>,<xref rid="B51" ref-type="bibr">51</xref>). And the rigidity for one nucleotide position in the sequence is known to be correlated to the rigidity of its neighbouring sequence positions along the linear sequence (<xref rid="B40" ref-type="bibr">40</xref>).</p>
        <p>In order to keep the notation in the above formulae as simple as possible, we do not explicitly mention so-called boundary effects, i.e. the fact that the innermost base-pair of any helix has no inner, neighbouring base-pair to stack with; and that there may be an un-paired sequence position <italic toggle="yes">i</italic> which does not have an unpaired, previous sequence position <italic toggle="yes">i</italic> − 1. In those cases, we derive the required mathematical terms by summing over the respective conditional probabilities, see Section 3 in the supplementary information.</p>
        <p>For calculating <italic toggle="yes">P</italic><sub><italic toggle="yes">exp</italic></sub>((<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>)∣θ<sub><italic toggle="yes">stack</italic></sub>) and <italic toggle="yes">P</italic><sub><italic toggle="yes">exp</italic></sub>((<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>)∣θ<sub><italic toggle="yes">single</italic></sub>), we use the same mathematical terms as <sc>ProbFold</sc> (<xref rid="B40" ref-type="bibr">40</xref>), but retrain the discretised, numerical values of these terms for our own, larger training set, see details below.</p>
      </sec>
      <sec id="SEC2-1-4">
        <title>Treatment of missing input SHAPE reactivity values in <sc>ShapeSorter</sc></title>
        <p>The input SHAPE reactivities for the reference sequence in the input alignment to <sc>ShapeSorter</sc> may contain sequence positions without SHAPE reactivities, <italic toggle="yes">i.e</italic>. where the corresponding reactivity value is unknown, i.e. ‘NA’. <sc>ShapeSorter</sc> covers these cases in the following manner when calculating <inline-formula><tex-math id="M00017" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Lambda _{{\small ShapeSorter}}(h)$\end{document}</tex-math></inline-formula> values that involve these sequence positions. If sequence position <italic toggle="yes">i</italic> does not have an experimental SHAPE probing reactivity associated with it, we sum over the probabilities of all possibilities when calculating the term <italic toggle="yes">P</italic><sub><italic toggle="yes">exp</italic></sub>((<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>)∣θ<sub><italic toggle="yes">single</italic></sub>) (in case the position <italic toggle="yes">i</italic> is hypothesized to be unpaired) and the term <italic toggle="yes">P</italic><sub><italic toggle="yes">exp</italic></sub>((<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>)∣θ<sub><italic toggle="yes">stack</italic></sub>) (in case <italic toggle="yes">i</italic> is hypothesized to be base-paired).</p>
      </sec>
      <sec id="SEC2-1-5">
        <title>Free parameters in <sc>ShapeSorter</sc></title>
        <p>Any predictive, computational model depends on a range of parameters which decide upon the fate of its predictions. In case of <sc>ShapeSorter</sc>, they comprise the two evolutionary models (the two rate matrices for capturing the evolution of base-paired and unpaired nucleotides, respectively), the minimum number of base-pairs required for a helix to be considered a candidate helix in <sc>ShapeSorter</sc>, <italic toggle="yes">L</italic><sub><italic toggle="yes">min</italic></sub>, and the probabilities and conditional probabilities required for calculating Λ<sub>exp</sub>(<italic toggle="yes">h</italic>), see Equations (<xref rid="M4" ref-type="disp-formula">4</xref>). As the two evolutionary models and the minimum required helix length (the default is <italic toggle="yes">L</italic><sub><italic toggle="yes">min</italic></sub> = 3), have already been well-established (<xref rid="B41" ref-type="bibr">41</xref>,<xref rid="B48" ref-type="bibr">48</xref>), we only train the parameters required for deriving the discretized values of Λ<sub>exp</sub>(<italic toggle="yes">h</italic>) (<xref rid="B40" ref-type="bibr">40</xref>), see below for more details. Users of <sc>ShapeSorter</sc> can readily change the default value of <italic toggle="yes">L</italic><sub><italic toggle="yes">min</italic></sub> via the command-line and via the web-server of <sc>ShapeSorter</sc>.</p>
      </sec>
      <sec id="SEC2-1-6">
        <title>Training of <sc>ShapeSorter</sc></title>
        <p>For calculating Λ<sub>exp</sub>(<italic toggle="yes">h</italic>), we use the same mathematical terms that were originally introduced in <sc>ProbFold</sc> (<xref rid="B40" ref-type="bibr">40</xref>) and keep the corresponding numerical values unchanged. In order to establish a biologically and structurally diverse training set, we compiled a dedicated training set of 22 reference sequences with known, experimentally confirmed RNA structures, corresponding SHAPE-probing reactivities and newly established, high-quality multiple sequence alignments, see the section on ‘Training and test set ’ below for details as well as <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref> in the supplementary information.</p>
        <p>As the predictive performance of <sc>ShapeSorter</sc> depends on the stringency of the <italic toggle="yes">p</italic><sub><italic toggle="yes">value</italic></sub> applied to filtering the predicted RNA structure features, we report any performance measures for <sc>ShapeSorter</sc> a function of the <italic toggle="yes">P</italic>-value threshold <italic toggle="yes">p</italic><sub><italic toggle="yes">threshold</italic></sub>, see Figures <xref rid="F3" ref-type="fig">3</xref> and <xref rid="F4" ref-type="fig">4</xref>. In order to compare the predictive performance of <sc>ShapeSorter</sc> to those of the other programs which do not estimate <italic toggle="yes">P</italic>-values for their predictions, we report <sc>ShapeSorter</sc>’s performance for a <italic toggle="yes">p</italic><sub><italic toggle="yes">threshold</italic></sub> value that optimizes the base-pair performance of <sc>ShapeSorter</sc> in terms of <italic toggle="yes">MCC</italic> (Mathews’ correlation coefficient) (<xref rid="B52" ref-type="bibr">52</xref>) <italic toggle="yes">for the training set</italic>, see the corresponding figures in the supplementary information. The thus derived value of <italic toggle="yes">p</italic><sub><italic toggle="yes">threshold</italic></sub> = 7 × 10<sup>−4</sup> is also the value we recommend as a reasonable default value for analysing new data where the RNA structures are yet unknown.</p>
        <fig position="float" id="F3">
          <label>Figure 3.</label>
          <caption>
            <p>Predictive performance of <sc>ShapeSorter</sc> and other programs in terms of <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> for nucleotides (left) and base-pairs (right). The symbols and dashed vertical lines for <sc>ShapeSorter</sc> (pink dashed line) and <sc>Transat</sc> (blue dashed line) are positioned at the <italic toggle="yes">P</italic>-values that correspond to the respective <italic toggle="yes">P</italic>-value threshold values. These were determined by optimizing the <italic toggle="yes">MCC</italic> for base-pairs <italic toggle="yes">for the training set</italic>, see the dashed vertical lines in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref> in the supplementary information. Note that the <italic toggle="yes">optimal performance</italic> for both programs can be different and even higher, as can be seen here for the test set, see the maxima of the pink and blue lines here. The symbols for all other programs apart from <sc>ShapeSorter</sc> and <sc>Transat</sc> are positioned at the average MFE-value of their respective, predicted RNA secondary structures, see the x-axis at the top which shows free energies in kcal/Mol.</p>
          </caption>
          <graphic xlink:href="gkac405fig3" position="float"/>
        </fig>
        <fig position="float" id="F4">
          <label>Figure 4.</label>
          <caption>
            <p>Predictive performance of <sc>ShapeSorter</sc> and other programs in terms of MCC for nucleotides (left) and base-pairs (right). The symbols and dashed vertical lines for <sc>ShapeSorter</sc> (pink dashed line) and <sc>Transat</sc> (blue dashed line) are positioned at the <italic toggle="yes">P</italic>-values that corresponds to the respective <italic toggle="yes">P</italic>-value threshold values. These were determined by optimizing the <italic toggle="yes">MCC</italic> for base-pairs <italic toggle="yes">on the training set</italic>, see the pink and blue dashed vertical lines in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref> in the supplementary information. Note that the optimal performance for both programs can be different and even higher as can be seen for this test set, see the maxima of the pink and blue lines here. The symbols for all other programs apart from <sc>ShapeSorter</sc> and <sc>Transat</sc> are positioned at the average MFE-value of their respective, predicted RNA secondary structures, see the x-axis at the top which shows free energies in kcal/Mol.</p>
          </caption>
          <graphic xlink:href="gkac405fig4" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec id="SEC2-2">
      <title>Availability of <sc>ShapeSorter</sc></title>
      <p><sc>ShapeSorter</sc> is available at <ext-link xlink:href="http://www.e-rna.org/shapesorter" ext-link-type="uri">www.e-rna.org/shapesorter</ext-link>. This contains an easy-to-use web-server with information on the input and output of the method as well as detailed documentation on how to use <sc>ShapeSorter</sc>. In addition, the web-page allows for an easy visualization of <sc>ShapeSorter</sc>’s predictions with <sc>R-Chie</sc> (<xref rid="B45" ref-type="bibr">45</xref>,<xref rid="B46" ref-type="bibr">46</xref>) that was used to generate the arc-plots here.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Other prediction programs</title>
      <p>To test the merits of our new method, we compare <sc>ShapeSorter</sc> to existing computational methods for incorporating SHAPE-probing reactivity profiles into computational RNA secondary structure prediction. These methods can be divided into subgroups based on two criteria: (i) the theoretical framework and conceptual strategy used for modelling RNA structures, namely minimum free-energy (MFE) methods that employ the thermodynamic approach versus probabilistic methods and (ii) the type of input evidence captured by the method, e.g. comparative methods (which take as input several, evolutionarily related sequences) versus non-comparative methods (which only consider the sequence of interest). The comparative methods all take as input a pre-compiled multiple sequence alignment.</p>
      <sec id="SEC2-3-1">
        <title>
          <sc>PPfold</sc>
        </title>
        <p><sc>PPfold</sc> (<xref rid="B39" ref-type="bibr">39</xref>) is a comparative method that combines a probabilistic approach for capturing RNA secondary structures, a so-called stochastic context-free grammar (SCFG), with a probabilistic framework for capturing evolutionary signals in the input alignment. It is a direct extension of the RNA secondary structure prediction program <sc>Pfold</sc> (<xref rid="B41" ref-type="bibr">41</xref>) that was extended to also take SHAPE-probing data for the reference sequence into account.</p>
        <p><sc>PPfold</sc> integrates SHAPE-reactivities via the additional terms <italic toggle="yes">P</italic>(<italic toggle="yes">r</italic>(<italic toggle="yes">i</italic>)∣θ<sub><italic toggle="yes">paired</italic></sub>) and <italic toggle="yes">P</italic>(<italic toggle="yes">r</italic>(<italic toggle="yes">i</italic>)∣θ<sub><italic toggle="yes">single</italic></sub>) that specify the probability of observing the reactivity value <italic toggle="yes">r</italic>(<italic toggle="yes">i</italic>) at sequence position <italic toggle="yes">i</italic> given that this position is either base-paired (hypothesis θ<sub><italic toggle="yes">paired</italic></sub>) or unpaired (hypothesis θ<sub><italic toggle="yes">single</italic></sub>). Sequence positions that are predicted to be base-paired at (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) by the SCFG get thus assigned a combined SHAPE-contribution of <italic toggle="yes">P</italic>(<italic toggle="yes">r</italic>(<italic toggle="yes">i</italic>)∣θ<sub><italic toggle="yes">paired</italic></sub>) · <italic toggle="yes">P</italic>(<italic toggle="yes">r</italic>(<italic toggle="yes">j</italic>)∣θ<sub><italic toggle="yes">paired</italic></sub>). Unlike <sc>ShapeSorter</sc>, the SCFG underlying <sc>PPfold</sc> does not capture interactions of stacking base-pairs and its theoretical framework for integrating experimental evidence also does not model correlations between the SHAPE-reactivities of neighbouring positions along the linear reference sequence.</p>
      </sec>
      <sec id="SEC2-3-2">
        <title>
          <sc>ProbFold</sc>
        </title>
        <p>Similarly to <sc>PPfold</sc>, <sc>ProbFold</sc> (<xref rid="B40" ref-type="bibr">40</xref>) also employs a fully probabilistic framework, both for modelling RNA secondary structures and for incorporating experimental SHAPE-probing information. In fact, for modelling RNA secondary structures <sc>ProbFold</sc> employs an extended version of the SCFG of <sc>PPfold</sc>. This SCFG can also capture the stacking interaction of pairs of directly adjacent base-pairs. Unlike <sc>PPfold</sc>, however, it does not work in a comparative way, but only takes the transcript of interest as sequence input. It therefore cannot capture evolutionary evidence for conserved RNA secondary structure features. Compared to <sc>PPfold</sc>, <sc>ProbFold</sc> uses a more elaborate concept of incorporating SHAPE-reactivities. The authors of <sc>ProbFold</sc> find that experimental SHAPE-probing results in marked correlations between the SHAPE-reactivities of neighbouring sequence positions. This is due to the fact that chemically, SHAPE-probing judges the rigidity of the RNA sequence’s backbone which can be expected to result in similar values for directly adjacent sequence positions. After thoroughly testing a number of potential probabilistic concepts for capturing SHAPE-evidence best, they conclude that the overall model capturing stacking base-pairs as well as correlated SHAPE-reactivities between neighbouring positions along the linear reference sequence provides the best overall predictive performance. In their assessment, they took great care to ensure that the number of free parameters in the model is in line with the amount of information provided by their training set to ensure that they did not over-fit the model’s parameters.</p>
      </sec>
      <sec id="SEC2-3-3">
        <title>
          <sc>RNAstructure</sc>
        </title>
        <p><sc>RNAstructure</sc> (<xref rid="B32" ref-type="bibr">32–34</xref>) employs the classical minimum-free-energy strategy for predicting the RNA secondary structure with lowest overall Gibbs free energy. The method thus assumes that any transcript of interest will assume its most stable RNA secondary structure configuration and that both the environment and the transcript of interest are in thermodynamic equilibrium. <sc>RNAstructure</sc> considers as input only the transcript of interest and is thereby oblivious to any evolutionary evidence for conserved RNA structure features. The input profile of SHAPE-probing reactivities is incorporated via a transformation into pseudo-energy contributions using the strategy proposed by Deigan <italic toggle="yes">et al.</italic> (<xref rid="B53" ref-type="bibr">53</xref>). Experimental SHAPE-based evidence is thus incorporated into the default thermodynamic algorithm for predicting RNA structures by interpreting SHAPE-reactivities as many, sequence-position-specific free-energy-perturbations to the unperturbed free energy parameters that would nominally be used in the algorithm. The output of <sc>RNAstructure</sc> consists of a single RNA secondary structure. In our benchmarking of the prediction performance, we also consider the following variant of <sc>RNAstructure</sc>: <sc>RNAstructure</sc> Multiple. This variant incorporates the input SHAPE-probing evidence in the same manner as <sc>RNAstructure</sc>, but predicts as output up to 20 different RNA secondary structures which are obtained by sampling these RNA structures according to their probabilities in the Boltzmann distribution of (pseudo-knot free) RNA structures in thermodynamic equilibrium.</p>
      </sec>
      <sec id="SEC2-3-4">
        <title>
          <sc>ShapeKnots</sc>
        </title>
        <p>Similarly to <sc>RNAstructure</sc>, <sc>ShapeKnots</sc> (<xref rid="B35" ref-type="bibr">35</xref>) is also a non-comparative method that employs the minimum-free energy approach for predicting a single RNA secondary structure. It utilizes the same approach by Deigan for converting experimental SHAPE-probing evidence into position-specific, pseudo-energy perturbations. Unlike <sc>RNAstructure</sc>, <sc>ShapeKnots</sc> can also predict pseudo-knotted RNA secondary structures. This is done using a heuristic approach were the minimum-free energy (MFE) RNA structure returned from the dynamic programming algorithm is potentially modified into a pseudo-knotted one, in case helices (above a certain energy threshold) can be readily added to the helices of the already predicted, pseudo-knot-free MFE RNA structure. The underlying algorithm uses additional free-energy parameters to also capture the additional entropic cost of the pseudo-knot formation.</p>
      </sec>
      <sec id="SEC2-3-5">
        <title>
          <sc>GTFold</sc>
        </title>
        <p><sc>GTFold</sc> (<xref rid="B36" ref-type="bibr">36</xref>,<xref rid="B37" ref-type="bibr">37</xref>) is conceptually identical to <sc>RNAstructure</sc>, but differs in a technical aspect in that it allows for the parallelized execution of the software on different compute nodes. It also employs <sc>RNAstructure</sc>’s parameter values in its version from 2016.</p>
      </sec>
      <sec id="SEC2-3-6">
        <title>
          <sc>Transat</sc>
        </title>
        <p>Lastly, we include <sc>Transat</sc> (<xref rid="B48" ref-type="bibr">48</xref>) in the listing here, even though it does not integrate experimental SHAPE-probing evidence in the prediction of RNA structure features. Similarly to <sc>ShapeSorter</sc>, <sc>Transat</sc> also works in a comparative way and also employs a fully probabilistic framework to detect conserved RNA structure features. These are also captured in terms of helices, i.e. consecutive stretches of base-pairs. Moreover, <sc>Transat</sc> and <sc>ShapeSorter</sc> utilize the same probabilistic evolutionary models for capturing the evolution of base-pairs and unpaired nucleotides. Unlike <sc>ShapeSorter</sc>, however, <sc>Transat</sc> treats all sequences in the input alignment on an equal footing, i.e. candidate helices can be proposed by any sequence including the reference sequence itself. And unlike <sc>ShapeSorter</sc>, <sc>Transat</sc> also accepts input alignments where the reference sequence has gaps. Despite these algorithmic differences, we still include <sc>Transat</sc> here to compare it to <sc>ShapeSorter</sc> and to assess the merits of including SHAPE-probing evidence into the detection of evolutionarily conserved RNA structure features with potential functional roles.</p>
        <p>For an overview of the key features of all programs included in the performance benchmarking, please see Table <xref rid="tbl1" ref-type="table">1</xref>.</p>
        <table-wrap position="float" id="tbl1">
          <label>Table 1.</label>
          <caption>
            <p>Overview of existing methods for integrating experimental SHAPE reactivity profiles into the computational prediction of RNA secondary structures. ‘Strategy’ refers to key underlying concept employed by the program. Here, ‘Prob’ refers to a fully probabilistic theoretical framework, whereas ‘MFE’ refers to the minimum-free-energy approach of identifying the RNA secondary structure with the lowest overall Gibbs free-energy and of assuming thermodynamic equilibrium. ‘Input’ distinguishes between methods that take as input only the sequence of interest (‘single’) and comparative methods that take a multiple-sequence input alignment (‘MSA’) thereby also harnessing evolutionary evidence. Please refer to the text for a more a detailed description of each program</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Method</th>
                <th rowspan="1" colspan="1">
                  <sc>PPfold</sc>
                </th>
                <th rowspan="1" colspan="1">
                  <sc>ProbFold</sc>
                </th>
                <th rowspan="1" colspan="1">
                  <sc>RNAstructure</sc>
                </th>
                <th rowspan="1" colspan="1">
                  <sc>ShapeKnots</sc>
                </th>
                <th rowspan="1" colspan="1">
                  <sc>GTFold</sc>
                </th>
                <th rowspan="1" colspan="1">
                  <sc>ShapeSorter</sc>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Strategy</td>
                <td rowspan="1" colspan="1">Prob.</td>
                <td rowspan="1" colspan="1">Prob.</td>
                <td rowspan="1" colspan="1">MFE</td>
                <td rowspan="1" colspan="1">MFE</td>
                <td rowspan="1" colspan="1">MFE</td>
                <td rowspan="1" colspan="1">Prob.</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Input</td>
                <td rowspan="1" colspan="1">MSA</td>
                <td rowspan="1" colspan="1">Single</td>
                <td rowspan="1" colspan="1">Single</td>
                <td rowspan="1" colspan="1">Single</td>
                <td rowspan="1" colspan="1">Single</td>
                <td rowspan="1" colspan="1">MSA</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>Training and test set</title>
      <p>To assess the merits of <sc>ShapeSorter</sc>, we compile a new test set that is disjoint from any set on which <sc>ShapeSorter</sc> or any other method included in the performance benchmarking was trained, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> in supplementary information. This test set consists of seven reference sequences that were initially introduced as test set for <sc>ShapeKnots</sc>. We established dedicated alignments for these seven sequences, thereby compiling a new test set that can now be used to assess both, comparative and non-comparative methods for predicting RNA secondary structures by incorporating SHAPE-probing reactivity profiles, see Table <xref rid="tbl1" ref-type="table">1</xref>.</p>
      <p>As training set for <sc>ShapeSorter</sc>, we combine the sequences of the training sets of <sc>ShapeKnots</sc> and <sc>ProbFold</sc> and establish corresponding alignments in the same manner as for the test set, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> in supplementary information and the text below for more details. Our resulting, new training set comprises 22 reference sequences as well as the corresponding, experimentally confirmed reference RNA secondary structures, SHAPE-probing data and newly established multiple-sequence alignments. This set constitutes the largest and biologically most diverse training set established so far and can be used to assess both comparative and non-comparative methods for predicting RNA secondary structures that take experimental SHAPE-probing reactivity profiles into account.</p>
      <p>The following describes our procedure for compiling alignments for the individual sequences of our test and training sets. In the first step, each sequence is searched against all existing RNA families in the comprehensive, structural database <sc>Rfam</sc> (<xref rid="B54" ref-type="bibr">54</xref>,<xref rid="B55" ref-type="bibr">55</xref>), the largest collection of non-coding RNA families with corresponding multiple sequence alignments. This involves searching the reference sequence via local alignments to the family consensus sequences to identify the best-matching <sc>Rfam</sc> family employing dedicated tools such as utilizing tools <sc>nhmmer</sc> (<xref rid="B56" ref-type="bibr">56</xref>). In the second step, the sequence of interest is either already part of the corresponding alignment of the best-fitting family (in which case it gets moved to the top of the alignment) or the sequence is mapped to the corresponding alignment using <sc>mafft</sc> (<xref rid="B57" ref-type="bibr">57</xref>) with the <monospace>–add</monospace> option. This allows the reference sequence to be mapped to the alignment without modifying the original <sc>Rfam</sc> alignment. In the third step, a corresponding rooted, binary phylogenetic tree is generated for this alignment using <sc>FastTree</sc> (<xref rid="B58" ref-type="bibr">58</xref>). The multiple sequence alignment is then projected onto the reference sequence, by removing any alignment columns with gaps in the reference sequence. Lastly, the alignment is checked for sequence duplicates which are removed.</p>
      <p>Overall, we thereby obtain 29 alignments with corresponding reference sequences, reference RNA secondary structures and SHAPE-probing reactivity profiles, 7 comprising our test set and 22 comprising our training set. Please see <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref> in the supplementary information for more details on both sets.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Performance evaluation</title>
      <p>In order to assess the merits of <sc>ShapeSorter</sc>, we investigate its ability to correctly predict the known RNA secondary structure features of the reference sequences in the test set. For this, we measure the predictive performance not only for individual nucleotides (<italic toggle="yes">nucleotide performance</italic>)—which is how existing benchmarkings have assessed the predictive performance of these methods so far—, but also for base-pairs (<italic toggle="yes">base-pair performance</italic>). As base-pairs constitute the natural structural building blocks of RNA secondary structures, we are primarily interested in the base-pair performance of all methods. For this, we consider the following six consensus base-pairs {{<italic toggle="yes">G</italic>, <italic toggle="yes">C</italic>}, {<italic toggle="yes">C</italic>, <italic toggle="yes">G</italic>}, {<italic toggle="yes">G</italic>, <italic toggle="yes">U</italic>}, {<italic toggle="yes">U</italic>, <italic toggle="yes">G</italic>}, {<italic toggle="yes">A</italic>, <italic toggle="yes">U</italic>}, {<italic toggle="yes">U</italic>, <italic toggle="yes">A</italic>}}, i.e. both Watson–Crick and non-Watson–Crick base-pairs. For both performance levels, we calculate two commonly used performance measures, the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> and the Mathews correlation coefficient (<italic toggle="yes">MCC</italic>) (<xref rid="B52" ref-type="bibr">52</xref>) which are defined as follows:<disp-formula id="M5"><label>(5)</label><tex-math id="M00018" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} F_{measure} &amp;=&amp; \frac{2 \cdot TP}{2 \cdot TP+FP+FN} \nonumber\\ MCC &amp;=&amp; \frac{TP \cdot TN}{\sqrt{(TP+FP) \cdot (TN+FN) \cdot (TP+FN) \cdot (TN+FP)}} \end{eqnarray*}$$\end{document}</tex-math></disp-formula>where <italic toggle="yes">TP</italic> (true positives), <italic toggle="yes">FP</italic> (false positives), <italic toggle="yes">TN</italic> (true negatives) and <italic toggle="yes">FN</italic> (false negatives) denote the counts of nucleotides or base-pairs in the respective category. So, <italic toggle="yes">TP</italic> denotes the number of nucleotides that were correctly predicted to be base-paired (when the performance is assessed on nucleotide level). For the base-pair performance, <italic toggle="yes">TP</italic> corresponds to the number of base-pairs that were correctly predicted to be paired to the correct base-pairing partner. The base-pair performance is therefore key for quantifying the performance for correct RNA secondary structure prediction. For assessing <sc>ShapeSorter</sc> (and <sc>Transat</sc>) which both assign <italic toggle="yes">P</italic>-values to their predicted RNA structure features, we first apply as filter the respective, previously determined <italic toggle="yes">P</italic>-value threshold (<xref rid="B48" ref-type="bibr">48</xref>).</p>
      <p>Values of the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> generally range between 0 (worst) and 1 (best) and measure the harmonic mean of specificity (<italic toggle="yes">TP</italic>/(<italic toggle="yes">TP</italic> + <italic toggle="yes">FP</italic>)) and sensitivity (<italic toggle="yes">TP</italic>/(<italic toggle="yes">TP</italic> + <italic toggle="yes">FN</italic>)). The <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub>, however, does not capture the amount of <italic toggle="yes">FP</italic>s, <italic toggle="yes">i.e</italic>. the number of nucleotides or base-pairs, respectively, that were erroneously predicted to be base-paired. This is captured by the <italic toggle="yes">MCC</italic> which has values ranging from -1 (worst) to 1 (best) (<xref rid="B52" ref-type="bibr">52</xref>).</p>
      <p>For <sc>ShapeSorter</sc> (and <sc>Transat</sc>), both <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> and <italic toggle="yes">MCC</italic> are naturally functions of the <italic toggle="yes">P</italic>-value threshold <italic toggle="yes">p</italic><sub><italic toggle="yes">threshold</italic></sub> applied to the predicted RNA structure features. For all other programs, we report single <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> and <italic toggle="yes">MCC</italic> performance values as they do not estimate reliability values for their predictions, see Figures <xref rid="F3" ref-type="fig">3</xref>, <xref rid="F4" ref-type="fig">4</xref>, Tables <xref rid="tbl2" ref-type="table">2</xref> and <xref rid="tbl3" ref-type="table">3</xref>. As explained earlier, we derive the optimal <italic toggle="yes">P</italic>-value threshold values for <sc>ShapeSorter</sc> and <sc>Transat</sc> by maximizing the respective <italic toggle="yes">MCC</italic> performance for base-pairs as function of the <italic toggle="yes">P</italic>-value <italic toggle="yes">for the training set</italic>, see the dashed vertical lines in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref> in the supplementary information. This optimization results in a value of <italic toggle="yes">p</italic><sub><italic toggle="yes">threshold</italic></sub> = 7 × 10<sup>−4</sup> for <sc>ShapeSorter</sc> (and <italic toggle="yes">p</italic><sub><italic toggle="yes">threshold</italic></sub> = 2 × 10<sup>−4</sup> for <sc>Transat</sc>). These are the threshold values we apply for quoting the official performance numbers of <sc>ShapeSorter</sc> (and <sc>Transat</sc>) in terms of <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> and <italic toggle="yes">MCC</italic> to enable a direct comparison to the performance of the other programs, see Tables <xref rid="tbl2" ref-type="table">2</xref> and <xref rid="tbl3" ref-type="table">3</xref>.</p>
      <table-wrap position="float" id="tbl2">
        <label>Table 2.</label>
        <caption>
          <p>Predictive performance in terms of <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub>. The first row of numbers indicate the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> values for the nucleotide and the base-pair performance, respectively. Underneath, the difference in <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> with respect to the performance by <sc>ShapeSorter</sc> is shown for easy comparison. The best performance for the nucleotide and for the base-pair performance is indicated by a number in <bold>bold</bold>, respectively</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">ShapeSorter</th>
              <th rowspan="1" colspan="1">Transat</th>
              <th rowspan="1" colspan="1">ProbFold</th>
              <th rowspan="1" colspan="1">RNAstructure</th>
              <th rowspan="1" colspan="1">RNAstructure Multiple</th>
              <th rowspan="1" colspan="1">PPfold</th>
              <th rowspan="1" colspan="1">GTFold</th>
              <th rowspan="1" colspan="1">ShapeKnots</th>
              <th rowspan="1" colspan="1">ShapeKnots multiple</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="9" align="center" rowspan="1"><italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub>: nucleotide performance</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">0.737</td>
              <td align="center" rowspan="1" colspan="1">0.642</td>
              <td align="center" rowspan="1" colspan="1">0.389</td>
              <td align="center" rowspan="1" colspan="1">0.804</td>
              <td align="center" rowspan="1" colspan="1">0.659</td>
              <td align="center" rowspan="1" colspan="1">0.45</td>
              <td align="center" rowspan="1" colspan="1">0.712</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.847</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.728</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">−0.095</td>
              <td align="center" rowspan="1" colspan="1">−0.347</td>
              <td align="center" rowspan="1" colspan="1">0.067</td>
              <td align="center" rowspan="1" colspan="1">−0.077</td>
              <td align="center" rowspan="1" colspan="1">−0.286</td>
              <td align="center" rowspan="1" colspan="1">−0.025</td>
              <td align="center" rowspan="1" colspan="1">0.111</td>
              <td align="center" rowspan="1" colspan="1">−0.009</td>
            </tr>
            <tr>
              <td colspan="9" align="center" rowspan="1"><italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub>: base-pair performance</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.764</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.631</td>
              <td align="center" rowspan="1" colspan="1">0.287</td>
              <td align="center" rowspan="1" colspan="1">0.544</td>
              <td align="center" rowspan="1" colspan="1">0.449</td>
              <td align="center" rowspan="1" colspan="1">0.315</td>
              <td align="center" rowspan="1" colspan="1">0.479</td>
              <td align="center" rowspan="1" colspan="1">0.571</td>
              <td align="center" rowspan="1" colspan="1">0.491</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">−0.133</td>
              <td align="center" rowspan="1" colspan="1">−0.478</td>
              <td align="center" rowspan="1" colspan="1">−0.220</td>
              <td align="center" rowspan="1" colspan="1">−0.315</td>
              <td align="center" rowspan="1" colspan="1">−0.449</td>
              <td align="center" rowspan="1" colspan="1">−0.285</td>
              <td align="center" rowspan="1" colspan="1">−0.193</td>
              <td align="center" rowspan="1" colspan="1">−0.273</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="tbl3">
        <label>Table 3.</label>
        <caption>
          <p>Predictive performance in terms of <italic toggle="yes">MCC</italic>. The first row of numbers indicate the <italic toggle="yes">MCC</italic> values for the nucleotide and the base-pair performance, respectively. Underneath, the difference in <italic toggle="yes">MCC</italic> with respect to the performance by <sc>ShapeSorter</sc> is shown for easy comparison. The best performance for the nucleotide and for the base-pair performance is indicated by a number in <bold>bold</bold>, respectively</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">ShapeSorter</th>
              <th rowspan="1" colspan="1">Transat</th>
              <th rowspan="1" colspan="1">ProbFold</th>
              <th rowspan="1" colspan="1">RNAstructure</th>
              <th rowspan="1" colspan="1">RNAstructure Multiple</th>
              <th rowspan="1" colspan="1">PPfold</th>
              <th rowspan="1" colspan="1">GTFold</th>
              <th rowspan="1" colspan="1">ShapeKnots</th>
              <th rowspan="1" colspan="1">ShapeKnots multiple</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="9" align="center" rowspan="1">Matthews correlation coefficient (MCC): nucleotide performance</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">0.596</td>
              <td align="center" rowspan="1" colspan="1">0.462</td>
              <td align="center" rowspan="1" colspan="1">0.217</td>
              <td align="center" rowspan="1" colspan="1">0.602</td>
              <td align="center" rowspan="1" colspan="1">0.362</td>
              <td align="center" rowspan="1" colspan="1">0.063</td>
              <td align="center" rowspan="1" colspan="1">0.457</td>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.689</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.482</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">−0.134</td>
              <td align="center" rowspan="1" colspan="1">−0.379</td>
              <td align="center" rowspan="1" colspan="1">0.006</td>
              <td align="center" rowspan="1" colspan="1">−0.234</td>
              <td align="center" rowspan="1" colspan="1">−0.532</td>
              <td align="center" rowspan="1" colspan="1">−0.139</td>
              <td align="center" rowspan="1" colspan="1">0.094</td>
              <td align="center" rowspan="1" colspan="1">−0.114</td>
            </tr>
            <tr>
              <td colspan="9" align="center" rowspan="1">Matthews correlation coefficient (MCC): base-pair performance</td>
            </tr>
            <tr>
              <td align="center" rowspan="1" colspan="1">
                <bold>0.773</bold>
              </td>
              <td align="center" rowspan="1" colspan="1">0.659</td>
              <td align="center" rowspan="1" colspan="1">0.167</td>
              <td align="center" rowspan="1" colspan="1">0.285</td>
              <td align="center" rowspan="1" colspan="1">0.108</td>
              <td align="center" rowspan="1" colspan="1">−0.057</td>
              <td align="center" rowspan="1" colspan="1">0.167</td>
              <td align="center" rowspan="1" colspan="1">0.325</td>
              <td align="center" rowspan="1" colspan="1">0.164</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">0</td>
              <td align="center" rowspan="1" colspan="1">−0.114</td>
              <td align="center" rowspan="1" colspan="1">−0.606</td>
              <td align="center" rowspan="1" colspan="1">−0.488</td>
              <td align="center" rowspan="1" colspan="1">−0.665</td>
              <td align="center" rowspan="1" colspan="1">−0.83</td>
              <td align="center" rowspan="1" colspan="1">−0.606</td>
              <td align="center" rowspan="1" colspan="1">−0.448</td>
              <td align="center" rowspan="1" colspan="1">−0.609</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <sec id="SEC3-2-1">
        <title>Nucleotide versus base-pair performance of programs</title>
        <p>To start with, it is best to look at the results for the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> and <italic toggle="yes">MCC</italic> shown as function of the <italic toggle="yes">P</italic>-value for <sc>ShapeSorter</sc> shown in Figures <xref rid="F3" ref-type="fig">3</xref> and <xref rid="F4" ref-type="fig">4</xref>. Whereas <sc>ShapeSorter</sc> and <sc>Transat</sc> have performance values that are a function of the <italic toggle="yes">P</italic>-value threshold applied (see the two lines), all other programs have a single performance value, see the respective symbols which are positions along the second x-axis at the average MFE value of their predicted RNA secondary structures.</p>
        <p>The first thing to notice is that the performance of all programs apart from <sc>ShapeSorter</sc> (and <sc>Transat</sc>) markedly decreases from nucleotide to base-pair performance, both in terms of <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> and <italic toggle="yes">MCC</italic>. For <sc>ShapeSorter</sc>, the performance even increases (compare the max of the pink lines between the nucleotide and base-pair performance, for the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> and for the <italic toggle="yes">MCC</italic>). The official performance values that we report for <sc>ShapeSorter</sc> (and <sc>Transat</sc>) in Tables <xref rid="tbl2" ref-type="table">2</xref> and <xref rid="tbl3" ref-type="table">3</xref> to enable a comparison to the performance of the other programs are derived from the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> and <italic toggle="yes">MCC</italic> values in the Figures <xref rid="F3" ref-type="fig">3</xref> and <xref rid="F4" ref-type="fig">4</xref> at the respective <italic toggle="yes">P</italic>-value threshold values that was optimized for the base-pair MCC performance <italic toggle="yes">on the training set</italic>, see the dashed vertical lines in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref> in the supplementary information. This is where the respective symbols for <sc>ShapeSorter</sc> and <sc>Transat</sc> are positioned along the x-axis in Figures <xref rid="F3" ref-type="fig">3</xref> and <xref rid="F4" ref-type="fig">4</xref>. Note that the optimal performance values of <sc>ShapeSorter</sc> (and <sc>Transat</sc>) on the test set are even higher than the official values that we quote in Tables <xref rid="tbl2" ref-type="table">2</xref> and <xref rid="tbl3" ref-type="table">3</xref>. For <sc>ShapeSorter</sc>, the optimal performance values for base-pairs are <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> = 0.798 (official <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> = 0.764) and <italic toggle="yes">MCC</italic> = 0.796 (official <italic toggle="yes">MCC</italic> = 0.773) and those for nucleotides <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> = 0.805 (official <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> = 0.737) and <italic toggle="yes">MCC</italic> = 0.634 (official <italic toggle="yes">MCC</italic> = 0.596).</p>
        <p>To conclude, all programs apart from <sc>ShapeSorter</sc> (and <sc>Transat</sc>) have trouble detecting the correcting base-pairing partners as their performance markedly decreases when comparing their nucleotide performance to their respective base-pair performance.</p>
      </sec>
      <sec id="SEC3-2-2">
        <title>Performance of programs in terms of <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub></title>
        <p>More detailed information on all programs can be gleaned from the numbers in Tables <xref rid="tbl2" ref-type="table">2</xref> and <xref rid="tbl3" ref-type="table">3</xref>. (We ignore <sc>Transat</sc> for now as it is the only program that does not take as input a SHAPE-probing reactivity profile.)</p>
        <p>In terms of <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub>, see Table <xref rid="tbl2" ref-type="table">2</xref>, <sc>ShapeKnots</sc> comes first (<inline-formula><tex-math id="M00019" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 84.7\%$\end{document}</tex-math></inline-formula>), second <sc>RNAstructure</sc> (<inline-formula><tex-math id="M00020" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 80.4\%$\end{document}</tex-math></inline-formula> (minus <inline-formula><tex-math id="M00021" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$4.3\%$\end{document}</tex-math></inline-formula>)) and <sc>ShapeSorter</sc> third (<inline-formula><tex-math id="M00022" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 73.7\%$\end{document}</tex-math></inline-formula> (minus <inline-formula><tex-math id="M00023" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$11\%$\end{document}</tex-math></inline-formula>)) for the nucleotide performance. As we primarily care about correctly predicting base-pairs, however, considering the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> for the base-pair performance is more important. Here, <sc>ShapeSorter</sc> comes first (<italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> = 76.4), with <sc>ShapeKnots</sc> coming second (<inline-formula><tex-math id="M00024" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 57.1\%$\end{document}</tex-math></inline-formula> (minus <inline-formula><tex-math id="M00025" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$19.3\%$\end{document}</tex-math></inline-formula>)) and <sc>RNAstructure</sc> third (<inline-formula><tex-math id="M00026" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 54.4\%$\end{document}</tex-math></inline-formula> (minus <inline-formula><tex-math id="M00027" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$22\%$\end{document}</tex-math></inline-formula>)). These differences between programs are in the two-digit percentage rage and therefore considerable. Note that <sc>ShapeSorter</sc>’s performance remains fairly stable <inline-formula><tex-math id="M00028" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 73.7\%$\end{document}</tex-math></inline-formula> for the nucleotide performance versus <inline-formula><tex-math id="M00029" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 76.4\%$\end{document}</tex-math></inline-formula> for the base-pair performance, while the performance of all other programs significantly <italic toggle="yes">decreases</italic> (by at least <inline-formula><tex-math id="M00030" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$10\%$\end{document}</tex-math></inline-formula> or more, <inline-formula><tex-math id="M00031" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$26\%$\end{document}</tex-math></inline-formula> for <sc>RNAstructure</sc> and <inline-formula><tex-math id="M00032" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$27.6\%$\end{document}</tex-math></inline-formula> for <sc>ShapeKnots</sc>) when going from the nucleotide to the base-pair performance.</p>
        <p>This stability of performance can also be observed for <sc>Transat</sc> (<inline-formula><tex-math id="M00033" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$64.2\%$\end{document}</tex-math></inline-formula> for the nucleotide performance versus <inline-formula><tex-math id="M00034" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$63.1\%$\end{document}</tex-math></inline-formula> for the base-pair performance). The difference in performance between <sc>ShapeSorter</sc> and <sc>Transat</sc> can be primarily attributed to <sc>ShapeSorter</sc> taking SHAPE-probing reactivity profiles as additional input evidence into account. The corresponding gain in <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> is <inline-formula><tex-math id="M00035" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$9.5\%$\end{document}</tex-math></inline-formula> for the nucleotide and <inline-formula><tex-math id="M00036" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$13.3\%$\end{document}</tex-math></inline-formula> for the base-pair performance. The theoretical framework underlying <sc>ShapeSorter</sc> thus does a decent job of capturing additional SHAPE-probing evidence well.</p>
        <p>If we compare <sc>ShapeSorter</sc> to <sc>ProbFold</sc> (which employs the same probabilistic models to capture SHAPE-probing data, but utilizes a non-comparative strategy involving an SCFG for capturing RNA secondary structures), we see that <sc>ShapeSorter</sc> significantly outperforms <sc>ProbFold</sc> on all accounts: the <inline-formula><tex-math id="M00037" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 73.7\%$\end{document}</tex-math></inline-formula> for <sc>ShapeSorter</sc> for the nucleotide performance is <inline-formula><tex-math id="M00038" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$34.8\%$\end{document}</tex-math></inline-formula> higher and the <inline-formula><tex-math id="M00039" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 76.4\%$\end{document}</tex-math></inline-formula> for the base-pair performance is even <inline-formula><tex-math id="M00040" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$47.7\%$\end{document}</tex-math></inline-formula> higher than for <sc>ProbFold</sc>. Based on these numbers, we conclude that the comparative strategy employed by <sc>ShapeSorter</sc> which can harness evolutionary evidence for conserved base-pairs from the input alignment is superior to the non-comparative approach which lacks this extra information. This overall advantage is not compensated for by the fairly sophisticated SCFG within <sc>ProbFold</sc> that models stacking interactions between neighbouring base-pairs.</p>
        <p>Apart from <sc>ShapeSorter</sc>, <sc>PPfold</sc> is the only other programs that works in a comparative way by taking a multiple-sequence alignment as input information. RNA secondary structures within <sc>PPfold</sc> are modelled by an SCFG (which cannot capture stacking interactions) which is more simplistic than the SCFG utilized within <sc>ProbFold</sc>. Unlike <sc>ShapeSorter</sc>, <sc>PPfold</sc> captures SHAPE-derived evidence without capturing the known correlations between SHAPE-reactivities of neighbouring positions along the reference sequence. If we compare the performance numbers for <sc>ShapeSorter</sc> and <sc>PPfold</sc> in terms of <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub>, it is clear that <sc>ShapeSorter</sc> outperforms <sc>PPfold</sc> on all accounts: the <inline-formula><tex-math id="M00041" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 73.7\%$\end{document}</tex-math></inline-formula> of <sc>ShapeSorter</sc> for nucleotides is <inline-formula><tex-math id="M00042" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$28.7\%$\end{document}</tex-math></inline-formula> higher than for <sc>ProbFold</sc> and the <inline-formula><tex-math id="M00043" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 76.4\%$\end{document}</tex-math></inline-formula> of <sc>ShapeSorter</sc> for base-pairs is even <inline-formula><tex-math id="M00044" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$44.9\%$\end{document}</tex-math></inline-formula> higher than for <sc>ProbFold</sc>. Based on this comparison, we conclude that it is key to capture known correlations well, both for SHAPE-reactivities (i.e. correlations along the sequence) as well as RNA structure features (i.e. stacking base-pairs).</p>
        <p>When analysing the RNA secondary structures predicted by <sc>ShapeKnots</sc> in more detail by visualizing the known and predicted structures, we find that <sc>ShapeKnots</sc> erroneously over-predicts pseudo-knotted RNA secondary structures for three out of the seven references sequences in the test set which are known to be pseudo-knot free, see also <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1 and S2</xref> in the supplementary information.</p>
      </sec>
      <sec id="SEC3-2-3">
        <title>Performance of programs in terms of <italic toggle="yes">MCC</italic></title>
        <p>Unlike the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub>, the <italic toggle="yes">MCC</italic> also capture the number of false positives (<italic toggle="yes">FP</italic>), i.e. the number of nucleotides or base-pairs, respectively, that were erroneously predicted to be base-paired.</p>
        <p>If we look at the corresponding numbers for the nucleotide and base-pair performance in Table <xref rid="tbl3" ref-type="table">3</xref>, we find that <sc>ShapeKnots</sc> comes first (<italic toggle="yes">MCC</italic> = 0.689), <sc>RNAstructure</sc> second (<italic toggle="yes">MCC</italic> = 0.602 (minus 0.087)) and <sc>ShapeSorter</sc> third (<italic toggle="yes">MCC</italic> = 0.596 (minus 0.093)) on nucleotide level. For the base-pair performance, however, which we care most about, <sc>ShapeSorter</sc> comes first (<italic toggle="yes">MCC</italic> = 0.773), <sc>ShapeKnots</sc> second (<italic toggle="yes">MCC</italic> = 0.325 (minus 0.448)) and <sc>RNAstructure</sc> third (<italic toggle="yes">MCC</italic> = 0.285 (minus 0.488)). Similarly to the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub>, the base-pair <italic toggle="yes">MCC</italic> performance for <sc>ShapeSorter</sc> (and <sc>Transat</sc>) increases compared to the nucleotide performance, whereas all other programs suffer a significant decrease in <italic toggle="yes">MCC</italic> (by 0.364 for <sc>ShapeKnots</sc> and 0.317 for <sc>RNAstructure</sc>). Based on these performance figures, <sc>ShapeSorter</sc> clearly outperforms all other program in terms of <italic toggle="yes">MCC</italic> for base-pairs.</p>
        <p>Comparing the <italic toggle="yes">MCC</italic> performance of <sc>ShapeSorter</sc> to that of <sc>Transat</sc>, we can once again conclude that the theoretical framework and algorithms underlying <sc>ShapeSorter</sc> capture the additional evidence in terms of the SHAPE-probing reactivity profile well.</p>
        <p>The comparison between <sc>ShapeSorter</sc> and <sc>ProbFold</sc> shows—also for the <italic toggle="yes">MCC</italic>—that <sc>ShapeSorter</sc> significantly outperforms <sc>ProbFold</sc>. The <italic toggle="yes">MCC</italic> = 0.596 for nucleotides is significantly higher (by 0.379) than that of <sc>ProbFold</sc>, and even higher (by 0.606) than <sc>ShapeSorter</sc>’s <italic toggle="yes">MCC</italic> = 0.773 for base-pairs. Our earlier conclusions based on the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> performance (see the above paragraph) thus also remain valid for the <italic toggle="yes">MCC</italic>.</p>
        <p>Moreover, also the comparison between <sc>ShapeSorter</sc> and <sc>PPfold</sc> for the <italic toggle="yes">MCC</italic> performance is in line with our earlier comparison for the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub>. Once again, it is clear that <sc>ShapeSorter</sc> clearly outperforms <sc>PPfold</sc> in terms of <italic toggle="yes">MCC</italic>, both on nucleotide level (<italic toggle="yes">MCC</italic> = 0.596 for <sc>ShapeSorter</sc> versus <italic toggle="yes">MCC</italic> = 0.0663 for <sc>PPfold</sc>) and base-pair level (<italic toggle="yes">MCC</italic> = 0.773 for <sc>ShapeSorter</sc> versus <italic toggle="yes">MCC</italic> = 0.057 for <sc>PPfold</sc>). As before for the <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub>, we can conclude that <sc>ShapeSorter</sc>’s ability to capture key correlations in terms of stacking interactions of base-pair and SHAPE-reactivities along the sequence are key for its superior performance.</p>
      </sec>
      <sec id="SEC3-2-4">
        <title>Overall performance comparison of programs</title>
        <p>Based on the detailed performance evaluation and comparison above, we can overall conclude that <sc>ShapeSorter</sc> offers a base-pair performance that is significantly higher than that of any other state-of-the-art program which takes SHAPE-probing evidence in terms of a reactivity profile into account, both in terms of <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> = 0.764 (<inline-formula><tex-math id="M00045" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$19.3\%$\end{document}</tex-math></inline-formula> higher than the second-best program) and <italic toggle="yes">MCC</italic> = 0.773 (0.448 higher than the second-best program).</p>
        <p>The superior performance of <sc>ShapeSorter</sc> can be attributed to its ability to capture evolutionary evidence encoded in the input alignment as well as SHAPE-derived experimental evidence by modelling known correlations within RNA structure features (i.e. stacking base-pairs) as well as known correlations between the SHAPE reactivities of neighbouring positions along the reference sequence.</p>
        <p>As <sc>ShapeSorter</sc> is the only program that estimates <italic toggle="yes">P</italic>-values for its predicted RNA structure features, its performance is naturally a function of the <italic toggle="yes">P</italic>-value threshold that is applied to the predicted RNA structure features. Based on our investigation here, we recommend a <italic toggle="yes">P</italic>-value threshold of <italic toggle="yes">p</italic><sub><italic toggle="yes">threshold</italic></sub> = 7 × 10<sup>−4</sup>. As we explain in detail above, this value was obtained by maximizing the base-pair <italic toggle="yes">MCC</italic> performance of <sc>ShapeSorter</sc> for the <italic toggle="yes">training set</italic>, see the pink dashed line in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref> of the supplementary information. The official performance numbers of <sc>ShapeSorter</sc> that we report in Tables <xref rid="tbl2" ref-type="table">2</xref> and <xref rid="tbl3" ref-type="table">3</xref> are based on applying this <italic toggle="yes">P</italic>-value threshold value to the predictions for the <italic toggle="yes">test set</italic> which has no overlap with the training set. The optimal performance of <sc>ShapeSorter</sc> for data sets on which the method has not been trained may be different (and can be significantly higher) than the official performance values of <sc>ShapeSorter</sc> reported here in Tables <xref rid="tbl2" ref-type="table">2</xref> and <xref rid="tbl3" ref-type="table">3</xref>. This is actually the case here, see the maximum <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> and <italic toggle="yes">MCC</italic> values for the test set shown by the pink curves for <sc>ShapeSorter</sc> in Figures <xref rid="F3" ref-type="fig">3</xref> and <xref rid="F4" ref-type="fig">4</xref>. These optimal values correspond to a base-pair performance of <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> = 0.798 (official <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> = 0.764 for the default <italic toggle="yes">P</italic>-value threshold) and of <italic toggle="yes">MCC</italic> = 0.796 (official <italic toggle="yes">MCC</italic> = 0.773 for the default <italic toggle="yes">P</italic>-value threshold). This goes to show that we certainly did not over-train <sc>ShapeSorter</sc> based on our training set.</p>
        <p>We also include three figures that show examples of how RNA structure features predicted by <sc>ShapeSorter</sc> compare to those predicted by relevant other programs, see Figures <xref rid="F5" ref-type="fig">5–7</xref> and the corresponding captions.</p>
        <fig position="float" id="F5">
          <label>Figure 5.</label>
          <caption>
            <p>Example of the predictions by <sc>Transat</sc> (left) versus those by <sc>ShapeSorter</sc> (right) for the human signal recognition particle RNA. Each image depicts a so-called sensitivity-specificity arc-plot where the known RNA structure is shown alongside the sensitivity and specificity of the predicted RNA structure features. The horizontal line indicates the reference sequence. Every semi-circle or arc below or above the horizontal line corresponds to a base-pair involving the two respective positions along the sequence. Arcs above the horizontal line show all known base-pairs: those in blue indicate correctly predicted base-pairs, whereas those in back indicate known base-pairs that are missing from the prediction. The sensitivity of the prediction can thus be seen from the arcs above the horizontal line. Arcs in green below the horizontal show all base-pairs that were erroneously predicted, i.e. that are not part of the known reference RNA secondary structure. The specificity of the prediction is therefore easy to spot by the arcs below the horizontal line (<italic toggle="yes">i.e</italic>. no arcs below would correspond to a perfect specificity). <sc>Transat</sc> and <sc>ShapeSorter</sc> both have a high sensitivity (see the fraction of correctly predicted base-pairs (blue arcs) above the line), but <sc>Transat</sc> has a significantly higher number of incorrectly predicted base-pairs, i.e. false positives, than <sc>ShapeSorter</sc> which has close to none (compare the number of green base-pairs below the horizontal lines). The additional evidence in terms of experimental SHAPE-probing reactivity data thus helps <sc>ShapeSorter</sc> to predict RNA structure features with considerably higher specificity. The raw performance numbers for <sc>ShapeSorter</sc> (S) and <sc>Transat</sc> (T) for this particular example are: TP (5704 (S), 28226 (T)), TN (72 (S), 72 (T)), FP (3 (S), 13 (T) and FN (20 (S), 26 (T)). For both <sc>Transat</sc> and <sc>ShapeSorter</sc>, only RNA structure features with <italic toggle="yes">P</italic>-values below the respective <italic toggle="yes">P</italic>-value threshold values are shown. Arc-plots made with <sc>R-Chie</sc> (<xref rid="B45" ref-type="bibr">45</xref>,<xref rid="B46" ref-type="bibr">46</xref>).</p>
          </caption>
          <graphic xlink:href="gkac405fig5" position="float"/>
        </fig>
        <fig position="float" id="F6">
          <label>Figure 6.</label>
          <caption>
            <p>Example of the predictions by <sc>ShapeKnots</sc> (left) versus those by <sc>ShapeSorter</sc> (right) for the human signal recognition particle RNA. Both images show a sensitivity-specificity arc-plot where the known RNA structure can be readily visualized alongside the sensitivity (above the horizontal line) and specificity (below) of the predicted RNA structure features. Please the caption of Figure <xref rid="F5" ref-type="fig">5</xref> above for more general information on this type of plots. <sc>ShapeSorter</sc> not only has a much higher sensitivity than <sc>ShapeKnots</sc> (compare the fraction of blue versus black arcs on top of the lines), but also a much higher specificity than <sc>ShapeKnots</sc> (compare the number of erroneously predicted base-pairs below the lines). In addition, <sc>ShapeKnots</sc> predicts several features that render the predicted RNA structure pseudo-knotted (see the union of blue top arcs and green bottom arcs that would result in crossing arcs), whereas the reference RNA structure is not pseudo-knotted (no crossing arcs above the line). The raw performance numbers for <sc>ShapeSorter</sc> (S) and <sc>ShapeKnots</sc> (SK) for this particular example are: TP ( 5704 (S), 33 (SK)), TN ( 72 (S), 62 (SK)), FP ( 3 (S), 66 (SK)) and FN ( 20 (S), 100 (SK)). For <sc>ShapeSorter</sc>, only RNA structure features with <italic toggle="yes">P</italic>-values below the <italic toggle="yes">P</italic>-value threshold value are shown. Arc-plots made with <sc>R-Chie</sc> (<xref rid="B45" ref-type="bibr">45</xref>,<xref rid="B46" ref-type="bibr">46</xref>).</p>
          </caption>
          <graphic xlink:href="gkac405fig6" position="float"/>
        </fig>
        <fig position="float" id="F7">
          <label>Figure 7.</label>
          <caption>
            <p>Example of the predictions by <sc>RNAstructure</sc> (left) versus those by <sc>ShapeSorter</sc> (right) for the 5S RNA of <italic toggle="yes">E. coli</italic>. Both images show a sensitivity-specificity arc-plot where the known RNA structure can be readily visualized alongside the sensitivity (above the horizontal line) and specificity (below) of the the predicted RNA structure features. Please the caption of Figure <xref rid="F5" ref-type="fig">5</xref> for more general information on this type of plot. <sc>ShapeSorter</sc> has a higher sensitivity than <sc>RNAstructure</sc> (compare the fraction of blue versus black arcs on top of the lines), but also a higher specificity than <sc>RNAstructure</sc> (compare the number of erroneously predicted base-pairs below the lines). The raw performance numbers for <sc>ShapeSorter</sc> (S) and <sc>RNAstructure</sc> (RS) for this particular example are: TP ( 865 (S), 9 (RS)), TN ( 19 (S), 76 (RS)), FP ( 2 (S), 31 (RS)) and FN ( 11 (S), 34 (RS)). For <sc>ShapeSorter</sc>, only RNA structure features with <italic toggle="yes">P</italic>-values below the <italic toggle="yes">P</italic>-value threshold value are shown. Arc-plots made with <sc>R-Chie</sc> (<xref rid="B45" ref-type="bibr">45</xref>,<xref rid="B46" ref-type="bibr">46</xref>).</p>
          </caption>
          <graphic xlink:href="gkac405fig7" position="float"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>Recent experimental progress allows us for the first time to investigate the RNA structurome <italic toggle="yes">in vivo</italic> and in a high-throughput manner. SHAPE-probing is one such technique. The resulting raw data, however, first need to be extensively interpreted computationally in order to be converted the experimental data in actual evidence for actual RNA structure features.</p>
    <p>We here introduce a new, fully probabilistic method, called <sc>ShapeSorter</sc>, which leverages evolutionary evidence (in terms of a multiple-sequence input alignment) as well as experimental SHAPE-probing evidence (in terms of an input SHAPE reactivity profile for the reference sequence in the input alignment) to predict RNA secondary structure features that are supported by both types of evidence.</p>
    <p>There already exist a range of computational programs for integrating experimental SHAPE-reactivity profiles into computational RNA secondary structure prediction. Most of these methods work in a non-comparative way and employ the traditional minimum-free energy strategy for predicting a single RNA secondary structure, assuming thermodynamic equilibrium for the biological setting from which the experimental SHAPE-probing data derive. These methods incorporate SHAPE-probing evidence into the RNA structure prediction algorithm via so-called pseudo-energies by converting SHAPE reactivities into physical free-energy terms that bias the nominal prediction procedure via pseudo-energies in a sequence-position-specific manner. In addition to this minimum-free-energy strategy, there also exist a few computational methods that employ fully probabilistic frameworks, both for predicting RNA structures and for incorporating experimental SHAPE-probing evidence into the RNA structure prediction. Only one of these method, <sc>PPfold</sc>, works in a comparative manner by taking an input alignment and thereby leverages both, evolutionary and experimental evidence for functional RNA structure features.</p>
    <p>Our new method <sc>ShapeSorter</sc> employs a fully probabilistic theoretical framework for predicting RNA secondary structure features that are supported both, by evolutionary and by experimental SHAPE-probing evidence. Our method takes as input a multiple-sequence alignment containing the (un-gapped) reference sequence for which the SHAPE reactivity profile was derived. The output of <sc>ShapeSorter</sc> consists of helices, <italic toggle="yes">i.e</italic>. consecutive stretches of base-pairs with estimated <italic toggle="yes">P</italic>-values. This unique features of <sc>ShapeSorter</sc> allows users to readily filter and rank the predicted RNA structure features based on their level of reliability, e.g. to choose priorities for dedicated follow-up experiments. Our method does not assume that the input SHAPE-probing evidence derives from a single, unique RNA structure. As it predicts individual helices rather than global RNA secondary structures, <sc>ShapeSorter</sc> can naturally capture RNA structure heterogeneity as well as pseudo-knotted, transient or mutually exclusive RNA structure features such as those of ribo-switches.</p>
    <p>In order to investigate the merits of our new method, we present a comprehensive performance benchmarking involving related computational methods for RNA secondary structure prediction that also take a SHAPE reactivity profile as input. Unlike existing performance comparisons, we assess the predictive performance of all methods both in terms of <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> and of Mathews’ correlation coefficient (<italic toggle="yes">MCC</italic>) (which also considers false positives), not only for individual nucleotides, but especially for base-pairs. As base-pairs constitute the natural building blocks of RNA secondary structures, our special focus is the base-pair performance.</p>
    <p>Based on our performance benchmarking, we conclude that <sc>ShapeSorter</sc> significantly outperforms all state-of-the-art methods in terms of <italic toggle="yes">F</italic><sub><italic toggle="yes">measure</italic></sub> and <italic toggle="yes">MCC</italic> for base-pairs. For the test set investigated here, <sc>ShapeSorter</sc> has an <inline-formula><tex-math id="M00046" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 76.4\%$\end{document}</tex-math></inline-formula>, the second best method (<sc>ShapeKnots</sc>) <inline-formula><tex-math id="M00047" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 57.1\%$\end{document}</tex-math></inline-formula> (minus <inline-formula><tex-math id="M00048" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$19.3\%$\end{document}</tex-math></inline-formula>) and the third (<sc>RNAstructure</sc>) <inline-formula><tex-math id="M00049" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$F_{measure} = 54.4\%$\end{document}</tex-math></inline-formula> (minus <inline-formula><tex-math id="M00050" notation="LaTeX">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$22\%$\end{document}</tex-math></inline-formula>). <sc>ShapeSorter</sc> has an <italic toggle="yes">MCC</italic> = 0.773, the second best method (<sc>ShapeKnots</sc>) <italic toggle="yes">MCC</italic> = 0.325 (minus 0.448) and the third (<sc>RNAstructure</sc>) <italic toggle="yes">MCC</italic> = 0.285 (minus 0.488).</p>
    <p>We find that <sc>ShapeSorter</sc>’s superior performance can be primarily attributed to its ability to capture (i) evolutionary evidence for conserved base-pairs encoded in the input alignment, (ii) evidence for RNA structure features (in particular stacking base-pairs) as well as (iii) experimental SHAPE-probing evidence (in particular correlations of SHAPE-reactivities for neighbouring sequence positions along the reference sequence). The beauty of the comparative approach is that it is allows us to detect RNA structure features of potential functional importance without first having to understand why these features are important for the transcript in <italic toggle="yes">in vivo</italic>. On the contrary, if are prepared to ‘listen to evolution’ by devising dedicated methods for detecting evolutionarily conserved sequence and RNA structure signals (such as the probabilistic models of evolution used within <sc>ShapeSorter</sc>), we can even hope to learn more about the contraints that the biological transcript encounters in its <italic toggle="yes">in vivo</italic> environment.</p>
    <p>As part of our performance benchmarking, we contribute two dedicated new data sets that we use for training (22 sequences) and testing (7 sequences). Both sets comprise custom, high-quality sequence alignments that can serve as reference data sets for devising and assessing future computational methods.</p>
    <p>In the future, the probabilistic framework underlying <sc>ShapeSorter</sc> could be readily extended to also take DMS-based RNA structure probing evidence into account, see <sc>RNAprob</sc> (<xref rid="B38" ref-type="bibr">38</xref>) and <sc>ProbFold</sc> (<xref rid="B40" ref-type="bibr">40</xref>).</p>
    <p>As we already briefly mentioned in the introduction, there already exist methods such as <sc>Dreem</sc> (<xref rid="B25" ref-type="bibr">25</xref>) and <sc>Draco</sc> (<xref rid="B26" ref-type="bibr">26</xref>) that consider individual DMS-MaPseq reads as input information. They aim to disentangle the RNA structure evidence encoded in individual reads to find evidence for RNA structure heterogeneity. This conceptual strategy will become more powerful as the length of these reads continues to cover more of the entire transcript that is being probed.</p>
    <p>The ultimate goal in the exciting field of <italic toggle="yes">in vivo</italic> RNA structurome probing is to come up with experimental and computational methods that would allow us to retain information on the RNA structure probing of entire individual transcripts. This will require a concerted effort on both fronts in order to combine the best experimental and computational methods into strategies that will allow us to investigate how individual transcripts go about their different jobs in living cells. There is already ample evidence that transcripts can encode a range of sequence and RNA structure features that are differentially expressed depending on the particular <italic toggle="yes">in vivo</italic> environment that they encounter at different stages of their cellular life. This constitutes the key idea behind the concept of alternative RNA structure expression <italic toggle="yes">in vivo</italic> (<xref rid="B27" ref-type="bibr">27</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>gkac405_Supplemental_File</label>
      <media xlink:href="gkac405_supplemental_file.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>I.M. Meyer would like to thank Elena Rivas, Eric Westhof and the participants of the computational RNA workshop in Benasque, Spain, for inspiring discussions. We also thank the three anonymous reviewers of our manuscript their valuable feedback.</p>
  </ack>
  <sec id="SEC5">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkac405#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC6">
    <title>FUNDING</title>
    <p>Funding for open access charge: Helmholtz Association.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baralle</surname><given-names>F.E.</given-names></string-name>, <string-name><surname>Singh</surname><given-names>R.N.</given-names></string-name>, <string-name><surname>Stamm</surname><given-names>S.</given-names></string-name></person-group><article-title>RNA structure and splicing regulation</article-title>. <source>Biochim. Biophys. Acta Gene Regul. Mech.</source><year>2019</year>; <volume>1862</volume>:<fpage>194448</fpage>.<pub-id pub-id-type="pmid">31730825</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adams</surname><given-names>R.L.</given-names></string-name>, <string-name><surname>Pirakitikulr</surname><given-names>N.</given-names></string-name>, <string-name><surname>Pyle</surname><given-names>A.M.</given-names></string-name></person-group><article-title>Functional RNA structures throughout the hepatitis C virus genome</article-title>. <source>Curr. Opin. Virol.</source><year>2017</year>; <volume>24</volume>:<fpage>79</fpage>–<lpage>86</lpage>.<pub-id pub-id-type="pmid">28511116</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>C.C.</given-names></string-name>, <string-name><surname>Grimbaldeston</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Tsai</surname><given-names>M.</given-names></string-name>, <string-name><surname>Weissman</surname><given-names>I.L.</given-names></string-name>, <string-name><surname>Galli</surname><given-names>S.J.</given-names></string-name></person-group><article-title>Identification of mast cell progenitors in adult mice</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2005</year>; <volume>102</volume>:<fpage>11408</fpage>–<lpage>11413</lpage>.<pub-id pub-id-type="pmid">16006518</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chillón</surname><given-names>I.</given-names></string-name>, <string-name><surname>Marcia</surname><given-names>M.</given-names></string-name></person-group><article-title>The molecular structure of long non-coding RNAs: emerging patterns and functional implications</article-title>. <source>Crit. Rev. Biochem. Mol. Biol.</source><year>2020</year>; <volume>55</volume>:<fpage>662</fpage>–<lpage>690</lpage>.<pub-id pub-id-type="pmid">33043695</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lord</surname><given-names>J.</given-names></string-name>, <string-name><surname>Baralle</surname><given-names>D.</given-names></string-name></person-group><article-title>Splicing in the diagnosis of rare disease: advances and challenges</article-title>. <source>Front. Genet.</source><year>2021</year>; <volume>12</volume>:<fpage>1146</fpage>.</mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bogdanow</surname><given-names>B.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X.</given-names></string-name>, <string-name><surname>Eichelbaum</surname><given-names>K.</given-names></string-name>, <string-name><surname>Sadewasser</surname><given-names>A.</given-names></string-name>, <string-name><surname>Husic</surname><given-names>I.</given-names></string-name>, <string-name><surname>Paki</surname><given-names>K.</given-names></string-name>, <string-name><surname>Budt</surname><given-names>M.</given-names></string-name>, <string-name><surname>Hergeselle</surname><given-names>M.</given-names></string-name>, <string-name><surname>Vetter</surname><given-names>B.</given-names></string-name>, <string-name><surname>Hou</surname><given-names>J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The dynamic proteome of influenza A virus infection identifies M segment splicing as a host range determinant</article-title>. <source>Nat. Commun.</source><year>2019</year>; <volume>10</volume>:<fpage>5518</fpage>.<pub-id pub-id-type="pmid">31797923</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mazloomian</surname><given-names>A.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name></person-group><article-title>Genome-wide identification and characterization of tissue-specific RNA editing events in D. melanogaster and their potential role in regulating alternative splicing</article-title>. <source>RNA Biol.</source><year>2015</year>; <volume>12</volume>:<fpage>1391</fpage>–<lpage>1401</lpage>.<pub-id pub-id-type="pmid">26512413</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yen</surname><given-names>Z.C.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name>, <string-name><surname>Karalic</surname><given-names>S.</given-names></string-name>, <string-name><surname>Brown</surname><given-names>C.J.</given-names></string-name></person-group><article-title>A cross-species comparison of X-chromosome inactivation in Eutheria</article-title>. <source>Genomics</source>. <year>2007</year>; <volume>90</volume>:<fpage>453</fpage>–<lpage>463</lpage>.<pub-id pub-id-type="pmid">17728098</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schöning</surname><given-names>J.C.</given-names></string-name>, <string-name><surname>Streitner</surname><given-names>C.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name>, <string-name><surname>Gao</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Staiger</surname><given-names>D.</given-names></string-name></person-group><article-title>Reciprocal regulation of glycine-rich RNA-binding proteins via an interlocked feedback loop coupling alternative splicing to nonsense-mediated decay in Arabidopsis</article-title>. <source>Nucleic Acids Res.</source><year>2008</year>; <volume>36</volume>:<fpage>6977</fpage>–<lpage>6987</lpage>.<pub-id pub-id-type="pmid">18987006</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pagani</surname><given-names>F.</given-names></string-name>, <string-name><surname>Raponi</surname><given-names>M.</given-names></string-name>, <string-name><surname>Baralle</surname><given-names>F.E.</given-names></string-name></person-group><article-title>Synonymous mutations in CFTR exon 12 affect splicing and are not neutral in evolution</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2005</year>; <volume>102</volume>:<fpage>6368</fpage>–<lpage>6372</lpage>.<pub-id pub-id-type="pmid">15840711</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buratti</surname><given-names>E.</given-names></string-name>, <string-name><surname>Baralle</surname><given-names>F.E.</given-names></string-name></person-group><article-title>Influence of RNA secondary structure on the pre-mRNA splicing process</article-title>. <source>Mol. Cell. Biol.</source><year>2004</year>; <volume>24</volume>:<fpage>10505</fpage>–<lpage>10514</lpage>.<pub-id pub-id-type="pmid">15572659</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name>, <string-name><surname>Miklos</surname><given-names>I.</given-names></string-name></person-group><article-title>Statistical evidence for conserved, local secondary structure in the coding regions of eukaryotic mRNAs and pre-mRNAs</article-title>. <source>Nucleic Acids Res.</source><year>2005</year>; <volume>33</volume>:<fpage>6338</fpage>–<lpage>6348</lpage>.<pub-id pub-id-type="pmid">16275783</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedersen</surname><given-names>J.S.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name>, <string-name><surname>Forsberg</surname><given-names>R.</given-names></string-name>, <string-name><surname>Simmonds</surname><given-names>P.</given-names></string-name>, <string-name><surname>Hein</surname><given-names>J.</given-names></string-name></person-group><article-title>A comparative method for finding and folding RNA secondary structures within protein-coding regions</article-title>. <source>Nucleic Acids Res.</source><year>2004</year>; <volume>32</volume>:<fpage>4925</fpage>–<lpage>4936</lpage>.<pub-id pub-id-type="pmid">15448187</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Centlivre</surname><given-names>M.</given-names></string-name>, <string-name><surname>Klaver</surname><given-names>B.</given-names></string-name>, <string-name><surname>Berkhout</surname><given-names>B.</given-names></string-name>, <string-name><surname>Das</surname><given-names>A.T.</given-names></string-name></person-group><article-title>Functional analysis of the complex trans-activating response element RNA structure in simian immunodeficiency virus</article-title>. <source>J. Virol.</source><year>2008</year>; <volume>82</volume>:<fpage>9171</fpage>–<lpage>9178</lpage>.<pub-id pub-id-type="pmid">18596090</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McGinnis</surname><given-names>J.L.</given-names></string-name>, <string-name><surname>Dunkle</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Cate</surname><given-names>J.H.D.</given-names></string-name>, <string-name><surname>Weeks</surname><given-names>K.M.</given-names></string-name></person-group><article-title>The mechanisms of RNA SHAPE chemistry</article-title>. <source>J. Am. Chem. Soc.</source><year>2012</year>; <volume>134</volume>:<fpage>6617</fpage>–<lpage>6624</lpage>.<pub-id pub-id-type="pmid">22475022</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merino</surname><given-names>E.J.</given-names></string-name>, <string-name><surname>Wilkinson</surname><given-names>K.A.</given-names></string-name>, <string-name><surname>Coughlan</surname><given-names>J.L.</given-names></string-name>, <string-name><surname>Weeks</surname><given-names>K.M.</given-names></string-name></person-group><article-title>RNA structure analysis at single nucleotide resolution by selective 2′-hydroxyl acylation and primer extension (SHAPE)</article-title>. <source>J. Am. Chem. Soc.</source><year>2005</year>; <volume>127</volume>:<fpage>4223</fpage>–<lpage>4231</lpage>.<pub-id pub-id-type="pmid">15783204</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weeks</surname><given-names>K.M.</given-names></string-name></person-group><article-title>Advances in RNA structure analysis by chemical probing</article-title>. <source>Curr. Opin. Struct. Biol.</source><year>2010</year>; <volume>20</volume>:<fpage>295</fpage>–<lpage>304</lpage>.<pub-id pub-id-type="pmid">20447823</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weeks</surname><given-names>K.M.</given-names></string-name></person-group><article-title>SHAPE directed discovery of new functions in large RNAs</article-title>. <source>Acc. Chem. Res.</source><year>2021</year>; <volume>54</volume>:<fpage>2502</fpage>–<lpage>2517</lpage>.<pub-id pub-id-type="pmid">33960770</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rice</surname><given-names>G.M.</given-names></string-name>, <string-name><surname>Busan</surname><given-names>S.</given-names></string-name>, <string-name><surname>Karabiber</surname><given-names>F.</given-names></string-name>, <string-name><surname>Favorov</surname><given-names>O.V.</given-names></string-name>, <string-name><surname>Weeks</surname><given-names>K.M.</given-names></string-name></person-group><article-title>SHAPE analysis of small RNAs and riboswitches</article-title>. <source>Methods Enzymol.</source><year>2014</year>; <volume>549</volume>:<fpage>165</fpage>–<lpage>187</lpage>.<pub-id pub-id-type="pmid">25432749</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tijerina</surname><given-names>P.</given-names></string-name>, <string-name><surname>Mohr</surname><given-names>S.</given-names></string-name>, <string-name><surname>Russell</surname><given-names>R.</given-names></string-name></person-group><article-title>DMS footprinting of structured RNAs and RNA–protein complexes</article-title>. <source>Nat. Protoc.</source><year>2007</year>; <volume>2</volume>:<fpage>2608</fpage>–<lpage>2623</lpage>.<pub-id pub-id-type="pmid">17948004</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zubradt</surname><given-names>M.</given-names></string-name>, <string-name><surname>Gupta</surname><given-names>P.</given-names></string-name>, <string-name><surname>Persad</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lambowitz</surname><given-names>A.M.</given-names></string-name>, <string-name><surname>Weissman</surname><given-names>J.S.</given-names></string-name>, <string-name><surname>Rouskin</surname><given-names>S.</given-names></string-name></person-group><article-title>DMS-MaPseq for genome-wide or targeted RNA structure probing in vivo</article-title>. <source>Nat. Methods</source>. <year>2017</year>; <volume>14</volume>:<fpage>75</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">27819661</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Tomezsko</surname><given-names>P.</given-names></string-name>, <string-name><surname>Swaminathan</surname><given-names>H.</given-names></string-name>, <string-name><surname>Rouskin</surname><given-names>S.</given-names></string-name></person-group><article-title>DMS-MaPseq for genome-wide or targeted RNA structure probing in vitro and in vivo</article-title>. <source>Functional Analysis of Long Non-Coding RNAs</source>. <year>2021</year>; <publisher-name>Springer</publisher-name><fpage>219</fpage>–<lpage>238</lpage>.</mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name>, <string-name><surname>Aviran</surname><given-names>S.</given-names></string-name></person-group><article-title>Statistical modeling of RNA structure profiling experiments enables parsimonious reconstruction of structure landscapes</article-title>. <source>Nat. Commun.</source><year>2018</year>; <volume>9</volume>:<fpage>606</fpage>.<pub-id pub-id-type="pmid">29426922</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ledda</surname><given-names>M.</given-names></string-name>, <string-name><surname>Aviran</surname><given-names>S.</given-names></string-name></person-group><article-title>PATTERNA: transcriptome-wide search for functional RNA elements via structural data signatures</article-title>. <source>Genome Biol.</source><year>2018</year>; <volume>19</volume>:<fpage>28</fpage>.<pub-id pub-id-type="pmid">29495968</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tomezsko</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Corbin</surname><given-names>V.D.</given-names></string-name>, <string-name><surname>Gupta</surname><given-names>P.</given-names></string-name>, <string-name><surname>Swaminathan</surname><given-names>H.</given-names></string-name>, <string-name><surname>Glasgow</surname><given-names>M.</given-names></string-name>, <string-name><surname>Persad</surname><given-names>S.</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Mcintosh</surname><given-names>L.</given-names></string-name>, <string-name><surname>Papenfuss</surname><given-names>A.T.</given-names></string-name>, <string-name><surname>Emery</surname><given-names>A.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Determination of RNA structural diversity and its role in HIV-1 RNA splicing</article-title>. <source>Nature</source>. <year>2020</year>; <volume>582</volume>:<fpage>438</fpage>–<lpage>442</lpage>.<pub-id pub-id-type="pmid">32555469</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morandi</surname><given-names>E.</given-names></string-name>, <string-name><surname>Manfredonia</surname><given-names>I.</given-names></string-name>, <string-name><surname>Simon</surname><given-names>L.M.</given-names></string-name>, <string-name><surname>Anselmi</surname><given-names>F.</given-names></string-name>, <string-name><surname>van Hemert</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Oliviero</surname><given-names>S.</given-names></string-name>, <string-name><surname>Incarnato</surname><given-names>D.</given-names></string-name></person-group><article-title>Genome-scale deconvolution of RNA structure ensembles</article-title>. <source>Nat. Methods</source>. <year>2021</year>; <volume>18</volume>:<fpage>249</fpage>–<lpage>252</lpage>.<pub-id pub-id-type="pmid">33619392</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name></person-group><article-title>In silico methods for co-transcriptional RNA secondary structure prediction and for investigating alternative RNA structure expression</article-title>. <source>Methods</source>. <year>2017</year>; <volume>120</volume>:<fpage>3</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">28433606</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>J.Y.A.</given-names></string-name>, <string-name><surname>Steif</surname><given-names>A.</given-names></string-name>, <string-name><surname>Proctor</surname><given-names>J.R.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name></person-group><article-title>Transient RNA structure features are evolutionarily conserved and can be computationally predicted</article-title>. <source>Nucleic Acids Res.</source><year>2013</year>; <volume>41</volume>:<fpage>6273</fpage>–<lpage>6285</lpage>.<pub-id pub-id-type="pmid">23625966</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>J.Y.A.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name></person-group><article-title>Four RNA families with functional transient structures</article-title>. <source>RNA Biol.</source><year>2015</year>; <volume>12</volume>:<fpage>5</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">25751035</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martín</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Mounir</surname><given-names>M.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name></person-group><article-title>CoBold: a method for identifying different functional classes of transient RNA structure features that can impact RNA structure formation in vivo</article-title>. <source>Nucleic Acids Res.</source><year>2021</year>; <volume>49</volume>:<fpage>e19</fpage>.<pub-id pub-id-type="pmid">33095878</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fernández</surname><given-names>A.</given-names></string-name></person-group><article-title>Functional metastable structures in RNA replication</article-title>. <source>Phys. A Stat. Mech. its Appl.</source><year>1991</year>; <volume>176</volume>:<fpage>499</fpage>–<lpage>513</lpage>.</mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xia</surname><given-names>T.</given-names></string-name>, <string-name><surname>SantaLucia</surname><given-names>J.</given-names><suffix>Jr</suffix></string-name>, <string-name><surname>Burkard</surname><given-names>M.E.</given-names></string-name>, <string-name><surname>Kierzek</surname><given-names>R.</given-names></string-name>, <string-name><surname>Schroeder</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Jiao</surname><given-names>X.</given-names></string-name>, <string-name><surname>Cox</surname><given-names>C.</given-names></string-name>, <string-name><surname>Turner</surname><given-names>D.H.</given-names></string-name></person-group><article-title>Thermodynamic parameters for an expanded nearest-neighbor model for formation of RNA duplexes with Watson-Crick base pairs</article-title>. <source>Biochemistry</source>. <year>1998</year>; <volume>37</volume>:<fpage>14719</fpage>–<lpage>14735</lpage>.<pub-id pub-id-type="pmid">9778347</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathews</surname><given-names>D.H.</given-names></string-name>, <string-name><surname>Sabina</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zuker</surname><given-names>M.</given-names></string-name>, <string-name><surname>Turner</surname><given-names>D.H.</given-names></string-name></person-group><article-title>Expanded sequence dependence of thermodynamic parameters improves prediction of RNA secondary structure</article-title>. <source>J. Mol. Biol.</source><year>1999</year>; <volume>288</volume>:<fpage>911</fpage>–<lpage>940</lpage>.<pub-id pub-id-type="pmid">10329189</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathews</surname><given-names>D.H.</given-names></string-name>, <string-name><surname>Disney</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Childs</surname><given-names>J.L.</given-names></string-name>, <string-name><surname>Schroeder</surname><given-names>S.J.</given-names></string-name>, <string-name><surname>Zuker</surname><given-names>M.</given-names></string-name>, <string-name><surname>Turner</surname><given-names>D.H.</given-names></string-name></person-group><article-title>Incorporating chemical modification constraints into a dynamic programming algorithm for prediction of RNA secondary structure</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2004</year>; <volume>101</volume>:<fpage>7287</fpage>–<lpage>7292</lpage>.<pub-id pub-id-type="pmid">15123812</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hajdin</surname><given-names>C.E.</given-names></string-name>, <string-name><surname>Bellaousov</surname><given-names>S.</given-names></string-name>, <string-name><surname>Huggins</surname><given-names>W.</given-names></string-name>, <string-name><surname>Leonard</surname><given-names>C.W.</given-names></string-name>, <string-name><surname>Mathews</surname><given-names>D.H.</given-names></string-name>, <string-name><surname>Weeks</surname><given-names>K.M.</given-names></string-name></person-group><article-title>Accurate SHAPE-directed RNA secondary structure modeling, including pseudoknots</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2013</year>; <volume>110</volume>:<fpage>5498</fpage>–<lpage>5503</lpage>.<pub-id pub-id-type="pmid">23503844</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Mathuriya</surname><given-names>A.</given-names></string-name>, <string-name><surname>Bader</surname><given-names>D.A.</given-names></string-name>, <string-name><surname>Heitsch</surname><given-names>C.E.</given-names></string-name>, <string-name><surname>Harvey</surname><given-names>S.C.</given-names></string-name></person-group><article-title>GTfold: a scalable multicore code for RNA secondary structure prediction</article-title>. <source>Proceedings of the 2009 ACM symposium on Applied Computing</source>. <year>2009</year>; <fpage>981</fpage>–<lpage>988</lpage>.</mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Swenson</surname><given-names>M.S.</given-names></string-name>, <string-name><surname>Anderson</surname><given-names>J.</given-names></string-name>, <string-name><surname>Ash</surname><given-names>A.</given-names></string-name>, <string-name><surname>Gaurav</surname><given-names>P.</given-names></string-name>, <string-name><surname>Sükösd</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Bader</surname><given-names>D.A.</given-names></string-name>, <string-name><surname>Harvey</surname><given-names>S.C.</given-names></string-name>, <string-name><surname>Heitsch</surname><given-names>C.E.</given-names></string-name></person-group><article-title>GTfold: enabling parallel RNA secondary structure prediction on multi-core desktops</article-title>. <source>BMC Res. Notes</source>. <year>2012</year>; <volume>5</volume>:<fpage>341</fpage>.<pub-id pub-id-type="pmid">22747589</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fei Deng</surname><given-names>F.</given-names></string-name>, <string-name><surname>Ledda</surname><given-names>M.</given-names></string-name>, <string-name><surname>Vaziri</surname><given-names>S.</given-names></string-name>, <string-name><surname>Aviran</surname><given-names>S.A.</given-names></string-name></person-group><article-title>Data-directed RNA secondary structure prediction using probabilistic modeling</article-title>. <source>RNA</source>. <year>2016</year>; <volume>22</volume>:<fpage>1109</fpage>–<lpage>1119</lpage>.<pub-id pub-id-type="pmid">27251549</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sükösd</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Knudsen</surname><given-names>B.</given-names></string-name>, <string-name><surname>Kjems</surname><given-names>J.</given-names></string-name>, <string-name><surname>Pedersen</surname><given-names>C.N.S.</given-names></string-name></person-group><article-title>PPfold 3.0: fast RNA secondary structure prediction using phylogeny and auxiliary data</article-title>. <source>Bioinformatics</source>. <year>2012</year>; <volume>28</volume>:<fpage>2691</fpage>–<lpage>2692</lpage>.<pub-id pub-id-type="pmid">22877864</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sahoo</surname><given-names>S.</given-names></string-name>, <string-name><surname>Świtnicki</surname><given-names>M.</given-names></string-name>, <string-name><surname>Pedersen</surname><given-names>J.S.</given-names></string-name></person-group><article-title>ProbFold: a probabilistic method for integration of probing data in RNA secondary structure prediction</article-title>. <source>Bioinformatics</source>. <year>2016</year>; <volume>32</volume>:<fpage>2626</fpage>–<lpage>2635</lpage>.<pub-id pub-id-type="pmid">27153612</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knudsen</surname><given-names>B.</given-names></string-name>, <string-name><surname>Hein</surname><given-names>J.</given-names></string-name></person-group><article-title>Pfold: RNA secondary structure prediction using stochastic context-free grammars</article-title>. <source>Nucleic Acids Res.</source><year>2003</year>; <volume>31</volume>:<fpage>3423</fpage>–<lpage>3428</lpage>.<pub-id pub-id-type="pmid">12824339</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gardner</surname><given-names>P.P.</given-names></string-name>, <string-name><surname>Giegerich</surname><given-names>R.</given-names></string-name></person-group><article-title>A comprehensive comparison of comparative RNA structure prediction approaches</article-title>. <source>BMC Bioinformatics</source>. <year>2004</year>; <volume>5</volume>:<fpage>140</fpage>.<pub-id pub-id-type="pmid">15458580</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Notredame</surname><given-names>C.</given-names></string-name>, <string-name><surname>Higgins</surname><given-names>D.G.</given-names></string-name>, <string-name><surname>Heringa</surname><given-names>J.</given-names></string-name></person-group><article-title>T-Coffee: a novel method for fast and accurate multiple sequence alignment</article-title>. <source>J. Mol. Biol.</source><year>2000</year>; <volume>302</volume>:<fpage>205</fpage>–<lpage>217</lpage>.<pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Washietl</surname><given-names>S.</given-names></string-name>, <string-name><surname>Hofacker</surname><given-names>I.L.</given-names></string-name></person-group><article-title>Consensus folding of aligned sequences as a new measure for the detection of functional RNAs by comparative genomics</article-title>. <source>J. Mol. Biol.</source><year>2004</year>; <volume>342</volume>:<fpage>19</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">15313604</pub-id></mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lai</surname><given-names>D.</given-names></string-name>, <string-name><surname>Proctor</surname><given-names>J.R.</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>J.Y.A.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name></person-group><article-title>R-CHIE: a web server and R package for visualizing RNA secondary structures</article-title>. <source>Nucleic Acids Res.</source><year>2012</year>; <volume>40</volume>:<fpage>e95</fpage>.<pub-id pub-id-type="pmid">22434875</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tsybulskyi</surname><given-names>V.</given-names></string-name>, <string-name><surname>Mounir</surname><given-names>M.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name></person-group><article-title>R-chie: A web server and R package for visualizing cis and trans RNA–RNA, RNA–DNA and DNA–DNA interactions</article-title>. <source>Nucleic Acids Res.</source><year>2020</year>; <volume>48</volume>:<fpage>e105</fpage>.<pub-id pub-id-type="pmid">32976561</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name>, <string-name><surname>Miklós</surname><given-names>I.</given-names></string-name></person-group><article-title>SimulFold: simultaneously inferring RNA structures including pseudoknots, alignments, and trees using a Bayesian MCMC framework</article-title>. <source>PLoS Comput. Biol.</source><year>2007</year>; <volume>3</volume>:<fpage>e149</fpage>.<pub-id pub-id-type="pmid">17696604</pub-id></mixed-citation>
    </ref>
    <ref id="B48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wiebe</surname><given-names>N.J.P.</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>I.M.</given-names></string-name></person-group><article-title>Transat–a method for detecting the conserved helices of functional RNA structures, including transient, pseudo-knotted and alternative structures</article-title>. <source>PLoS Comput. Biol.</source><year>2010</year>; <volume>6</volume>:<fpage>e1000823</fpage>.<pub-id pub-id-type="pmid">20589081</pub-id></mixed-citation>
    </ref>
    <ref id="B49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Felsenstein</surname><given-names>J.</given-names></string-name></person-group><article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>J. Mol. Evol.</source><year>1981</year>; <volume>17</volume>:<fpage>368</fpage>–<lpage>376</lpage>.<pub-id pub-id-type="pmid">7288891</pub-id></mixed-citation>
    </ref>
    <ref id="B50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilkinson</surname><given-names>K.A.</given-names></string-name>, <string-name><surname>Merino</surname><given-names>E.J.</given-names></string-name>, <string-name><surname>Weeks</surname><given-names>K.M.</given-names></string-name></person-group><article-title>Selective 2’-hydroxyl acylation analyzed by primer extension (SHAPE): quantitative RNA structure analysis at single nucleotide resolution</article-title>. <source>Nat. Protoc.</source><year>2006</year>; <volume>1</volume>:<fpage>1610</fpage>–<lpage>1616</lpage>.<pub-id pub-id-type="pmid">17406453</pub-id></mixed-citation>
    </ref>
    <ref id="B51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smola</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Rice</surname><given-names>G.M.</given-names></string-name>, <string-name><surname>Busan</surname><given-names>S.</given-names></string-name>, <string-name><surname>Siegfried</surname><given-names>N.A.</given-names></string-name>, <string-name><surname>Weeks</surname><given-names>K.M.</given-names></string-name></person-group><article-title>Selective 2’-hydroxyl acylation analyzed by primer extension and mutational profiling (SHAPE-MaP) for direct, versatile and accurate RNA structure analysis</article-title>. <source>Nat. Protoc.</source><year>2015</year>; <volume>10</volume>:<fpage>1643</fpage>–<lpage>1669</lpage>.<pub-id pub-id-type="pmid">26426499</pub-id></mixed-citation>
    </ref>
    <ref id="B52">
      <label>52.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gardner</surname><given-names>P.P.</given-names></string-name>, <string-name><surname>Giegerich</surname><given-names>R.</given-names></string-name></person-group><article-title>A comprehensive comparison of comparative RNA structure prediction approaches</article-title>. <source>BMC Bioinformatics</source>. <year>2004</year>; <volume>5</volume>:<fpage>140</fpage>.<pub-id pub-id-type="pmid">15458580</pub-id></mixed-citation>
    </ref>
    <ref id="B53">
      <label>53.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deigan</surname><given-names>K.E.</given-names></string-name>, <string-name><surname>Li</surname><given-names>T.W.</given-names></string-name>, <string-name><surname>Mathews</surname><given-names>D.H.</given-names></string-name>, <string-name><surname>Weeks</surname><given-names>K.M.</given-names></string-name></person-group><article-title>Accurate SHAPE-directed RNA structure determination</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2009</year>; <volume>106</volume>:<fpage>97</fpage>–<lpage>102</lpage>.<pub-id pub-id-type="pmid">19109441</pub-id></mixed-citation>
    </ref>
    <ref id="B54">
      <label>54.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Griffiths-Jones</surname><given-names>S.</given-names></string-name>, <string-name><surname>Bateman</surname><given-names>A.</given-names></string-name>, <string-name><surname>Marshall</surname><given-names>M.</given-names></string-name>, <string-name><surname>Khanna</surname><given-names>A.</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>S.R.</given-names></string-name></person-group><article-title>Rfam: an RNA family database</article-title>. <source>Nucleic Acids Res.</source><year>2003</year>; <volume>31</volume>:<fpage>439</fpage>–<lpage>441</lpage>.<pub-id pub-id-type="pmid">12520045</pub-id></mixed-citation>
    </ref>
    <ref id="B55">
      <label>55.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kalvari</surname><given-names>I.</given-names></string-name>, <string-name><surname>Nawrocki</surname><given-names>E.P.</given-names></string-name>, <string-name><surname>Ontiveros-Palacios</surname><given-names>N.</given-names></string-name>, <string-name><surname>Argasinska</surname><given-names>J.</given-names></string-name>, <string-name><surname>Lamkiewicz</surname><given-names>K.</given-names></string-name>, <string-name><surname>Marz</surname><given-names>M.</given-names></string-name>, <string-name><surname>Griffiths-Jones</surname><given-names>S.</given-names></string-name>, <string-name><surname>Toffano-Nioche</surname><given-names>C.</given-names></string-name>, <string-name><surname>Gautheret</surname><given-names>D.</given-names></string-name>, <string-name><surname>Weinberg</surname><given-names>Z.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Rfam 14: expanded coverage of metagenomic, viral and microRNA families</article-title>. <source>Nucleic Acids Res.</source><year>2021</year>; <volume>49</volume>:<fpage>D192</fpage>–<lpage>D200</lpage>.<pub-id pub-id-type="pmid">33211869</pub-id></mixed-citation>
    </ref>
    <ref id="B56">
      <label>56.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wheeler</surname><given-names>T.J.</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>S.R.</given-names></string-name></person-group><article-title>nhmmer: DNA homology search with profile HMMs</article-title>. <source>Bioinformatics</source>. <year>2013</year>; <volume>29</volume>:<fpage>2487</fpage>–<lpage>2489</lpage>.<pub-id pub-id-type="pmid">23842809</pub-id></mixed-citation>
    </ref>
    <ref id="B57">
      <label>57.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katoh</surname><given-names>K.</given-names></string-name>, <string-name><surname>Toh</surname><given-names>H.</given-names></string-name></person-group><article-title>Parallelization of the MAFFT multiple sequence alignment program</article-title>. <source>Bioinformatics</source>. <year>2010</year>; <volume>26</volume>:<fpage>1899</fpage>–<lpage>1900</lpage>.<pub-id pub-id-type="pmid">20427515</pub-id></mixed-citation>
    </ref>
    <ref id="B58">
      <label>58.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname><given-names>M.N.</given-names></string-name>, <string-name><surname>Dehal</surname><given-names>P.S.</given-names></string-name>, <string-name><surname>Arkin</surname><given-names>A.P.</given-names></string-name></person-group><article-title>FastTree 2–approximately maximum-likelihood trees for large alignments</article-title>. <source>PLoS One</source>. <year>2010</year>; <volume>5</volume>:<fpage>e9490</fpage>.<pub-id pub-id-type="pmid">20224823</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
