<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8128458</article-id>
    <article-id pub-id-type="pmid">32821900</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa742</article-id>
    <article-id pub-id-type="publisher-id">btaa742</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CLoNe: automated clustering based on local density neighborhoods for application to biomolecular structural ensembles</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Träger</surname>
          <given-names>Sylvain</given-names>
        </name>
        <aff><institution>Institute of Bioengineering, School of Life Sciences, Ecole Polytechnique Fédérale de Lausanne</institution>, Lausanne 1025, <country country="CH">Switzerland</country></aff>
        <aff><institution>Swiss Institute of Bioinformatics</institution>, Lausanne 1015, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tamò</surname>
          <given-names>Giorgio</given-names>
        </name>
        <aff><institution>Institute of Bioengineering, School of Life Sciences, Ecole Polytechnique Fédérale de Lausanne</institution>, Lausanne 1025, <country country="CH">Switzerland</country></aff>
        <aff><institution>Swiss Institute of Bioinformatics</institution>, Lausanne 1015, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aydin</surname>
          <given-names>Deniz</given-names>
        </name>
        <aff><institution>Institute of Bioengineering, School of Life Sciences, Ecole Polytechnique Fédérale de Lausanne</institution>, Lausanne 1025, <country country="CH">Switzerland</country></aff>
        <aff><institution>Swiss Institute of Bioinformatics</institution>, Lausanne 1015, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fonti</surname>
          <given-names>Giulia</given-names>
        </name>
        <aff><institution>Institute of Bioengineering, School of Life Sciences, Ecole Polytechnique Fédérale de Lausanne</institution>, Lausanne 1025, <country country="CH">Switzerland</country></aff>
        <aff><institution>Swiss Institute of Bioinformatics</institution>, Lausanne 1015, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Audagnotto</surname>
          <given-names>Martina</given-names>
        </name>
        <aff><institution>Institute of Bioengineering, School of Life Sciences, Ecole Polytechnique Fédérale de Lausanne</institution>, Lausanne 1025, <country country="CH">Switzerland</country></aff>
        <aff><institution>Swiss Institute of Bioinformatics</institution>, Lausanne 1015, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Dal Peraro</surname>
          <given-names>Matteo</given-names>
        </name>
        <xref rid="btaa742-cor1" ref-type="corresp"/>
        <aff><institution>Institute of Bioengineering, School of Life Sciences, Ecole Polytechnique Fédérale de Lausanne</institution>, Lausanne 1025, <country country="CH">Switzerland</country></aff>
        <aff><institution>Swiss Institute of Bioinformatics</institution>, Lausanne 1015, <country country="CH">Switzerland</country></aff>
        <!--matteo.dalperaro@epfl.ch-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cowen</surname>
          <given-names>Lenore</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa742-cor1">To whom correspondence should be addressed. <email>matteo.dalperaro@epfl.ch</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-08-20">
      <day>20</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <volume>37</volume>
    <issue>7</issue>
    <fpage>921</fpage>
    <lpage>928</lpage>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>12</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa742.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Proteins are intrinsically dynamic entities. Flexibility sampling methods, such as molecular dynamics or those arising from integrative modeling strategies, are now commonplace and enable the study of molecular conformational landscapes in many contexts. Resulting structural ensembles increase in size as technological and algorithmic advancements take place, making their analysis increasingly demanding. In this regard, cluster analysis remains a go-to approach for their classification. However, many state-of-the-art algorithms are restricted to specific cluster properties. Combined with tedious parameter fine-tuning, cluster analysis of protein structural ensembles suffers from the lack of a generally applicable and easy to use clustering scheme.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present CLoNe, an original Python-based clustering scheme that builds on the Density Peaks algorithm of Rodriguez and Laio. CLoNe relies on a probabilistic analysis of local density distributions derived from nearest neighbors to find relevant clusters regardless of cluster shape, size, distribution and amount. We show its capabilities on many toy datasets with properties otherwise dividing state-of-the-art approaches and improves on the original algorithm in key aspects. Applied to structural ensembles, CLoNe was able to extract meaningful conformations from membrane binding events and ligand-binding pocket opening as well as identify dominant dimerization motifs or inter-domain organization. CLoNe additionally saves clusters as individual trajectories for further analysis and provides scripts for automated use with molecular visualization software.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="http://www.epfl.ch/labs/lbm/resources" ext-link-type="uri">www.epfl.ch/labs/lbm/resources</ext-link>, github.com/LBM-EPFL/CLoNe.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swiss National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001711</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>200021_157217</award-id>
        <award-id>31003A_170154</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The perception of molecular structures, especially proteins, is gradually shifting from the concept of one single and rigid structure to the idea that biomolecules natively exhibit a continuum of states (<xref rid="btaa742-B25" ref-type="bibr">Frank, 2018</xref>). Protein folding, post-translational modifications (<xref rid="btaa742-B5" ref-type="bibr">Audagnotto and Dal Peraro, 2017</xref>), binding to other molecules or their involvement in catalytic events result in vast and complex conformational landscapes. Molecular dynamics (MD), thanks to progress in both its technological and algorithmic aspects, allows for the simulation of key biomolecular events. Their observability, however, tends to be limited by currently accessible timescales. Researchers consistently come up with innovative protocols to push this limit further (<xref rid="btaa742-B7" ref-type="bibr">Barducci <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btaa742-B10" ref-type="bibr">Bussi, 2014</xref>; <xref rid="btaa742-B13" ref-type="bibr">Chavent <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa742-B21" ref-type="bibr">Doerr <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa742-B29" ref-type="bibr">Hamelberg <italic toggle="yes">et al.</italic>, 2004</xref>; <xref rid="btaa742-B47" ref-type="bibr">Noé <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa742-B58" ref-type="bibr">Shirts and Pande, 2000</xref>; <xref rid="btaa742-B59" ref-type="bibr">Sultan <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa742-B65" ref-type="bibr">Wassenaar <italic toggle="yes">et al.</italic>, 2015</xref>) granting us with the ability to capture protein folding as well as protein–protein, protein–membrane and protein–ligand interactions (<xref rid="btaa742-B6" ref-type="bibr">Audagnotto <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa742-B18" ref-type="bibr">De Vivo <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa742-B43" ref-type="bibr">McKiernan <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btaa742-B48" ref-type="bibr">Oleinikovas <italic toggle="yes">et al.</italic>, 2016</xref>). State-of-the-art protocols for small-molecule docking (<xref rid="btaa742-B3" ref-type="bibr">Amaro <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa742-B36" ref-type="bibr">Kokh <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btaa742-B61" ref-type="bibr">Vahl Quevedo <italic toggle="yes">et al.</italic>, 2014</xref>), protein–protein docking and integrative modeling strategies, in general, have shifted toward the integration of dynamics in some form as well (<xref rid="btaa742-B1" ref-type="bibr">Abriata and Dal Peraro, 2020</xref>; <xref rid="btaa742-B41" ref-type="bibr">Malhotra <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa742-B60" ref-type="bibr">Tamò <italic toggle="yes">et al.</italic>, 2015</xref>). All of the aforementioned aspects advocate dynamics as a cornerstone of modern structural biology and push the need for efficient tools to extract functional insight from structural ensembles in general.</p>
    <p>However, these advances come at a price. The sheer size, the intrinsic complexity and redundancy of structural ensembles makes their successful analysis and computational integration non-trivial. Coarse-graining tools such as cluster analysis effectively reduce simulations of thousands of conformations to few key biological states and hence constitute a go-to approach with countless applications to date [(<xref rid="btaa742-B14" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btaa742-B16" ref-type="bibr">De Paris <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btaa742-B17" ref-type="bibr">de Souza <italic toggle="yes">et al.</italic>, 2017</xref>), reviewed in (<xref rid="btaa742-B51" ref-type="bibr">Peng <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa742-B57" ref-type="bibr">Shao <italic toggle="yes">et al.</italic>, 2007</xref>)]. Such states may serve as basis of Markov state models (<xref rid="btaa742-B32" ref-type="bibr">Husic and Pande, 2018</xref>; <xref rid="btaa742-B62" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2018</xref>). To our knowledge, however, an algorithm able to cluster data efficiently irrespective of their properties is still missing. Indeed, different cluster shapes, sizes and densities usually dictate which clustering approach is best suited for a given task. The most known and widely used scheme is probably that of k-means and its many variations (<xref rid="btaa742-B34" ref-type="bibr">Jain, 2010</xref>). This center-based clustering scheme, however, suffers from unequal results due to random initializations, the <italic toggle="yes">a priori</italic> setting of the number of clusters and its limitation to spherical clusters. Alternatively, hierarchical schemes such as the Ward-linkage agglomerative algorithm (<xref rid="btaa742-B64" ref-type="bibr">Ward, 1963</xref>) do not require pre-setting the number of clusters and are popular for building Markov state models (<xref rid="btaa742-B8" ref-type="bibr">Beauchamp <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btaa742-B33" ref-type="bibr">Husic and Pande, 2017</xref>; <xref rid="btaa742-B49" ref-type="bibr">Paris <italic toggle="yes">et al.</italic>, 2015</xref>)<italic toggle="yes">.</italic> They are however sensitive to noise and outliers and may suffer from non-spherical clusters (<xref rid="btaa742-B51" ref-type="bibr">Peng <italic toggle="yes">et al.</italic>, 2018</xref>). Conversely, DBSCAN (<xref rid="btaa742-B23" ref-type="bibr">Ester <italic toggle="yes">et al.</italic>, 1996</xref>) is able to manage clusters regardless of shape by utilizing density differences between clusters and noise. However, setting its parameter is not trivial and its optimal value may not be unique throughout the dataset when clusters of largely different densities are present. This limitation is at the core of OPTICS, which can be seen as an extension of DBSCAN (<xref rid="btaa742-B4" ref-type="bibr">Ankerst <italic toggle="yes">et al.</italic>, 1999</xref>), although not strictly advertised as a clustering algorithm.</p>
    <p>Defining metastable states of proteins is non-trivial due to the large and often redundant number of internal degrees of freedom, yielding sampled conformational spaces with local minima often devoid of biological significance. We can make the assumption that, given enough sampling and a choice of relevant features, metastable states would lie in regions or clusters of high density, which would be separated by valleys of different density levels that would correspond to transitional states. Furthermore, no assumption can be made on the shape or relative densities of clusters, which would depend on both conformational sampling and target system. <xref rid="btaa742-B54" ref-type="bibr">Rodriguez and Laio (2014)</xref> designed the Density Peaks (DP) algorithm aimed at clustering regardless of shape and dimensionality. Their algorithm generated significant interest thanks to their clever definition of cluster centers, which states that a cluster center should display a higher density (<italic toggle="yes">ρ</italic>) than its neighbors and a high distance to another point of higher density (<italic toggle="yes">δ</italic>). DP takes a single input parameter, which relates to a cutoff distance for the computation of <italic toggle="yes">ρ</italic>. However, it requires the user to specify thresholds for both <italic toggle="yes">ρ</italic> and <italic toggle="yes">δ</italic> mid-computation in order to select the cluster centers, which prevents a fully automated clustering process. DP has since been improved by the inclusion of k nearest neighbors (kNN) (<xref rid="btaa742-B22" ref-type="bibr">Du <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa742-B67" ref-type="bibr">Xie <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa742-B68" ref-type="bibr">Zhang and Li, 2015</xref>) or heat diffusion (<xref rid="btaa742-B44" ref-type="bibr">Mehmood <italic toggle="yes">et al.</italic>, 2016</xref>) for a more robust estimation of <italic toggle="yes">ρ</italic>, which allows for a better handling of cases where clusters have significantly different densities. These improvements still require user intervention for selecting cluster centers. Conversely, <xref rid="btaa742-B63" ref-type="bibr">Wang and Xu (2017)</xref> built on DP to automatically select cluster centers based on maximizing an average silhouette index, although other input parameters are required instead. Liang and Cheng coupled principles from DBSCAN with a divide-and-conquer approach to recursively and automatically select cluster centers (<xref rid="btaa742-B38" ref-type="bibr">Liang and Chen, 2016</xref>). Recently, d’Errico <italic toggle="yes">et al.</italic> coupled DP with a non-parametric density estimator (<xref rid="btaa742-B53" ref-type="bibr">Rodriguez <italic toggle="yes">et al.</italic>, 2018</xref>), yielding Density Peaks Advanced (DPA; <xref rid="btaa742-B15" ref-type="bibr">d’Errico <italic toggle="yes">et al.</italic>, 2018</xref>). While exhibiting impressive robustness to a variety of cluster shapes, densities and to outliers, DPA still suffers from a few issues. We found that it performed worse than the original on some typical benchmark datasets, and requires a sensitive albeit unique input parameter. Moreover, both DP and DPA exhibit an inconsistent outlier removal procedure. These drawbacks may prove crucial when targeting structural biological data, where regions at lower effective density may have equal or even increased significance than others at higher densities. The complexity of biological structures leads to numerous unique yet equally relevant choices of features, each with their own topology. The analysis of such datasets is greatly hindered by sensitivity to input parameters, which implies that tedious fine-tuning steps have to be undertaken.</p>
    <p>Here, we introduce an approach to remedy these drawbacks, enabling a facilitated analysis of complex real-world datasets from structural biology. Our approach builds on the original DP algorithm by introducing a fragmenting of the data into specific density distributions. In essence, the local densities of each point are computed using nearest neighbors and a Gaussian kernel and points associated with local density maxima are identified as putative cluster centers. To increase robustness to non-spherical cluster shapes, clusters are merged using the Bhattacaryaa coefficient (<xref rid="btaa742-B9" ref-type="bibr">Bhattacharyya, 1943</xref>) by comparing density distributions derived from putative cluster cores and boundaries. Finally, outliers from impromptu noise fluctuations are removed by means of a Bayes classifier. This, to the best of our knowledge, constitute an original contribution to the density peaks algorithm. Termed <italic toggle="yes">Clustering based on Local density Neighborhoods</italic> (CLoNe), our approach relies on a single input parameter that is both robust and intuitive to set. We test it on many typical benchmark datasets and against state-of-the-art clustering schemes. The local focus of CLoNe allows for the detection of biological states of smaller frequency while its ease of use allows the researcher to focus on choosing relevant biological features for pre-processing or analyzing their structural ensemble without being hindered by algorithmic limitations. Furthermore, CLoNe outputs useful molecular visualization scripts for the validation of cluster relevance in the target biological context (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). We apply CLoNe on a range of structural datasets from MD simulations or integrative modeling studies, each time detailing the feature selection process and which information can be extracted from the results. Our examples cover previously published studies on protein–membrane interactions, internal structural rearrangements of disordered proteins, cryptic allosteric pocket formation and transmembrane dimerization motifs, and highlight the broad advantages of CLoNe for the analysis of molecular structural ensembles.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>An overview and basic usage of CLoNe is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>, on GitHub and the webpage of our laboratory (see Abstract section). We created a synthetic dataset containing clusters of significantly different densities and various shapes in order to showcase the procedure behind our approach. CLoNe starts by finding the k nearest neighbors of each point in a dataset <italic toggle="yes">X</italic> of <italic toggle="yes">N</italic> points using k-nearest neighbors (kNN) (<xref rid="btaa742-B50" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic>, 2011</xref>), yielding a neighbor matrix <italic toggle="yes">M</italic> where each row <italic toggle="yes">i</italic> contains all the neighbors <italic toggle="yes">j</italic> of point <italic toggle="yes">i</italic> in increasing order of Euclidean distance. To account for significant density differences between clusters, we initially assume that all points are cluster centers. In a first step, we estimate the local density <italic toggle="yes">ρ</italic> of each point <italic toggle="yes">i</italic> using a Gaussian kernel:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>ϵ</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">kNN</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>-</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>ϵ</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">kNN</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula>where kNN<sub>i</sub> is the set of nearest neighbors of <italic toggle="yes">i</italic> in increasing order of distance and <italic toggle="yes">d<sub>c</sub></italic> is a cutoff distance defined as to be superior to a user-defined percentage <italic toggle="yes">p<sub>dc</sub></italic> (the single input parameter of CLoNe) of all distances within <italic toggle="yes">M</italic>, similar to the original DP algorithm (<xref rid="btaa742-B54" ref-type="bibr">Rodriguez and Laio, 2014</xref>). We define the core of putative cluster <italic toggle="yes">i</italic> as the set of neighbors that contribute to <italic toggle="yes">ρ<sub>i</sub></italic> at least as much of the <italic toggle="yes">j−1</italic> previous neighbors on average:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="italic">core</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mi>j</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>ϵ</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">kNN</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:math></disp-formula></p>
    <p>We show in <xref rid="btaa742-F1" ref-type="fig">Figure 1a</xref> the cardinality (number of elements) of the core of each point in our synthetic dataset. As expected, this number is higher for points closer to real cluster centers and lower for points laying on the outskirt of clusters. The visualization of core cardinalities is an efficient way to observe the underlying topology of the dataset. In order to identify if <italic toggle="yes">i</italic> is a genuine candidate for cluster center, we identify its first neighbor <italic toggle="yes">j</italic> of higher density. If neighbor <italic toggle="yes">j</italic> belongs to <italic toggle="yes">core<sub>i</sub></italic>, then neighbor <italic toggle="yes">j</italic> is a better candidate for cluster center in this region than <italic toggle="yes">i.</italic> Conversely, <italic toggle="yes">i</italic> is a genuine candidate for cluster center if <italic toggle="yes">j</italic> is not in the core of <italic toggle="yes">i</italic>. Cluster assignation is done in a single step by assigning a point to the same cluster as its nearest point of higher density, in order of decreasing local density, similar to the original DP approach. The results at this stage of CLoNe are shown in <xref rid="btaa742-F1" ref-type="fig">Figure 1a</xref>.
</p>
    <fig position="float" id="btaa742-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Clustering based on local density neighborhoods. We created a synthetic dataset that contains four croissant-shaped clusters of 500 elements each with different scaling as well as a cluster in the shape of a cross with 4000 elements and added Gaussian noise. (<bold>a</bold>) On the left, the cardinality of the core of each point in the dataset. On the right, the clusters obtained after the first stage of clustering. (<bold>b</bold>) The average Bhattacaryya coefficient <italic toggle="yes">B(A,B)</italic> between two Clusters A and B is shown. The upper left plots show an example of two clusters being merged corresponding to the upper square in panel (a). The lower left plots show an example of two clusters that will not be merged corresponding to the lower square in panel (a). Points belonging to the core of each cluster are shown in black, regular points in shades of gray and points belonging to the boundary in red. The plot on the right shows the clustering after merging clusters. (<bold>c</bold>) CLoNe uses a Bayesian classifier to decide if a cluster is genuine or arises from noise fluctuations. On the left, the corresponding probability density functions of points belonging to any cluster cores (black), noise (blue), or to individual cluster cores (light blue). The range of local density of clusters classified as noise fluctuations are shown on the secondary <italic toggle="yes">y</italic>-axis (dark blue). The final clustering result is shown on the right, with identified outliers shown as black crosses</p>
      </caption>
      <graphic xlink:href="btaa742f1" position="float"/>
    </fig>
    <p>One of the drawbacks of the DP algorithm is its limited ability to deal with clusters with more than one peak or those with an elongated region of similar density, such as the noisy circles benchmark dataset (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). This is true at this stage of CLoNe as well, as the Gaussian kernel in (1) is biased toward determining cores with spherical shapes (<xref rid="btaa742-F1" ref-type="fig">Fig. 1b</xref>). We can make the assumptions that if two existing clusters <italic toggle="yes">A</italic> and <italic toggle="yes">B</italic> should be merged, then the density from one core to the other should be relatively constant. This can be estimated by looking at the core cardinality distribution of the points belonging to the core of both clusters as well as that of the points from the boundary between them (<xref rid="btaa742-F1" ref-type="fig">Fig. 1b</xref>, left), which can be defined as:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="italic">boundary</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{" close="|" separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mfenced><mml:mi>|</mml:mi><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></disp-formula></p>
    <p>Then, we define the following probability density function for the ensemble of points belonging to either cluster cores or the boundary from (3):
where <italic toggle="yes">S</italic> denotes one of the aforementioned ensembles and <italic toggle="yes">#core<sub>i</sub></italic> the core cardinality of point <italic toggle="yes">i</italic> and KDE refers to the probability density function estimated by unimodal Gaussian kernel density estimation. Similarity between probability distributions can be measured using the Bhattacharyya coefficient (BC) (<xref rid="btaa742-B9" ref-type="bibr">Bhattacharyya, 1943</xref>), which is bound between 0 and 1. Thus, the formula to compute the BC between the core of cluster A with the boundary from (3) becomes:
</p>
    <list list-type="simple">
      <list-item>
        <p><inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">KDE</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>#</mml:mo><mml:mi mathvariant="italic">core</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula>    (4)</p>
      </list-item>
    </list>
    <list list-type="simple">
      <list-item>
        <p><inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">bound</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">core</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:msqrt></mml:math></inline-formula>     (5)</p>
      </list-item>
    </list>
    <p>We take the decision of merging Clusters A and B if the mean of their respective BC with their boundary is above a threshold <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>:
<disp-formula id="E4"><label>(6)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mi>B</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></disp-formula>where <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">core</mml:mi></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is obtained as for cluster A in (5) and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was chosen to be the 65th percentile to limit uncertainty and based on benchmarks (<xref rid="btaa742-F1" ref-type="fig">Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Taking the mean of both coefficients prevents the merging of a cluster whose probability density is similar to that of its boundary with a cluster of significantly higher density. This enabled us to identify clusters that can hardly be defined with a single density peak, such as uniform density over non-spherical shapes (<xref rid="btaa742-F1" ref-type="fig">Figs 1b and 2a</xref>). The point with highest <italic toggle="yes">ρ</italic> is chosen as the new cluster center. If <italic toggle="yes">p<sub>dc</sub></italic> is chosen too small, clusters may be split into sub-clusters. Within our approach, these sub-clusters are likely to be merged into clusters matching the original topology, expanding the range of acceptable values for <italic toggle="yes">p<sub>dc</sub></italic> and making it an input parameter less sensitive than the one of DPA (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>).
</p>
    <fig position="float" id="btaa742-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>Local neighborhood density analysis for automated center and cluster determination. For each panel, the cardinality of the core of each point as detailed in the Section 2 is shown on the left. The resulting clusters are shown on the right, with clusters in different colors and identified outliers as black crosses. (<bold>a</bold>) Noisy circles dataset. (<bold>b</bold> and <bold>c</bold>) Four instances of spiral dataset with different values of the input parameter yielding different yet valid clusters. (<bold>d</bold>) The a3 dataset containing 50 Gaussian clusters. (<bold>e</bold>) The s4 dataset with highly overlapping Gaussian clusters, some with anisotropic distributions. (<bold>f</bold>) A synthetic dataset with clusters of significantly different sizes and densities taken from Density Peaks Advanced</p>
      </caption>
      <graphic xlink:href="btaa742f2" position="float"/>
    </fig>
    <p>The second drawback of using the Gaussian kernel in (1) is that it may falsely identify impromptu local noise fluctuations as cluster centers (<xref rid="btaa742-F1" ref-type="fig">Fig. 1b</xref>). To remedy this, we define two probability density functions. <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">cores</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the probability density of the local density of all points belonging to any cluster core as per (2):
<disp-formula id="E5"><label>(7)</label><mml:math id="M5" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">cores</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">KDE</mml:mi><mml:mo>(</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">core</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mfenced><mml:mo>)</mml:mo></mml:math></disp-formula>where <italic toggle="yes">C</italic> is the set of cluster centers remaining after the previous merging step. <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">outliers</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the equivalent function for all points identified as outliers:
<disp-formula id="E6"><label>(8)</label><mml:math id="M6" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">outliers</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">KDE</mml:mi><mml:mo>(</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>x</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mo>∈</mml:mo><mml:mi>X</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>f</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">center</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>)</mml:mo></mml:math></disp-formula>where <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">center</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> is the local density of the center of the cluster <italic toggle="yes">x</italic> belongs to and <italic toggle="yes">f</italic> an arbitrary fraction chosen to be 0.1 by default and used throughout this article. To determine if an identified cluster is more probable to be derived from noise than to be a genuine cluster, we use a Bayesian classifier. For each cluster core <italic toggle="yes">c<sub>i</sub></italic>, we derive the following posterior probabilities using Bayes’ theorem:
<disp-formula id="E7"><label>(9)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>;</mml:mo><mml:mi>Y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="italic">outliers</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="italic">cores</mml:mi><mml:mo>}</mml:mo></mml:math></disp-formula>where the prior probabilities are defined as follows:
<disp-formula id="E8"><label>(10)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>;</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>Y</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="italic">outliers</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="italic">cores</mml:mi><mml:mo>}</mml:mo></mml:math></disp-formula>where |Y| denotes the cardinality of the corresponding class. The likelihoods <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> can be computed by evaluating the previously defined probability distributions (7) and (8) at <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Disregarding the evidence <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> common for both <italic toggle="yes">outliers</italic> and <italic toggle="yes">cores</italic> classes, we thus obtain the following Bayesian classifier:
<disp-formula id="E9"><label>(11)</label><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">argmax</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>∈</mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mi mathvariant="italic">outliers</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="italic">cores</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:msub><mml:mo stretchy="false">∏</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula></p>
    <p>This classifier enabled us to remove all cluster centers arising from noise fluctuations. Combined with the previous merging step, the clustering is now complete (<xref rid="btaa742-F1" ref-type="fig">Fig. 1c</xref>).</p>
    <p>The software has been written using Python3.7. When used on structural biological data, CLoNe outputs cluster centers as separate PDB files, individual clusters as XTC trajectories and Tcl scripts for automated loading within the visualization software VMD (Visual Molecular Dynamics, (<xref rid="btaa742-B31" ref-type="bibr">Humphrey <italic toggle="yes">et al.</italic>, 1996</xref>)). The loading of MD trajectories as well as the saving of cluster centers and cluster sub-trajectories is done through the MDTraj package (<xref rid="btaa742-B42" ref-type="bibr">McGibbon <italic toggle="yes">et al.</italic>, 2015</xref>). We use the scipy (<xref rid="btaa742-B35" ref-type="bibr">Jones <italic toggle="yes">et al.</italic>, 2001</xref>), scikit-learn (<xref rid="btaa742-B50" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic>, 2011</xref>) and Statsmodels (<xref rid="btaa742-B56" ref-type="bibr">Seabold and Perktold, 2010</xref>) packages for many operations described in the previous subsection and to compare CLoNe to other clustering algorithms.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Automatic cluster center determination from local density neighborhood analysis</title>
      <p>We applied CLoNe to a large set of common benchmark datasets from various sources (<xref rid="btaa742-B12" ref-type="bibr">Chang and Yeung, 2008</xref>; <xref rid="btaa742-B15" ref-type="bibr">d’Errico <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa742-B26" ref-type="bibr">Fränti and Sieranoja, 2018</xref>; <xref rid="btaa742-B27" ref-type="bibr">Fu and Medico, 2007</xref>; <xref rid="btaa742-B28" ref-type="bibr">Gionis <italic toggle="yes">et al.</italic>, 2007</xref>; <xref rid="btaa742-B50" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic>, 2011</xref>), covering different key properties of clusters, such as non-spherical shapes, anisotropy, as well as significant size and density differences, all of which can be expected from real-world datasets from structural biology. In the previous section, we detailed how CLoNe automatically detects cluster centers, accurately merges clusters and removes outliers, succeeding in cases where previous iterations of DP did not (<xref rid="btaa742-F2" ref-type="fig">Fig. 2a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). Similarly to the original DP algorithm (<xref rid="btaa742-B54" ref-type="bibr">Rodriguez and Laio, 2014</xref>), CLoNe requires a single input parameter <italic toggle="yes">p<sub>dc</sub></italic>, which relates to a cutoff distance used in the estimation of local densities (see Section 2). In general, <italic toggle="yes">p<sub>dc</sub></italic> takes a value in a small range and is intuitive to set. For instance, with <italic toggle="yes">p<sub>dc</sub></italic> values of 1 or 2 local densities will be estimated considering neighborhoods small enough to identify individual spiral branches as clusters (<xref rid="btaa742-F2" ref-type="fig">Fig. 2b</xref>). For higher values of <italic toggle="yes">p<sub>dc</sub></italic>, the scale of the Gaussian kernel in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> will increase and merge individual branches into whole spirals, allowing the study of multiple hierarchies intuitively (<xref rid="btaa742-F2" ref-type="fig">Fig. 2c</xref>). Other than clusters with non-spherical shapes, CLoNe identifies successfully the numerous Gaussian clusters of the A3 dataset (<xref rid="btaa742-F2" ref-type="fig">Fig. 2d</xref>). Some degree of overlapping in real-world datasets is to be expected. The S4 dataset contains 15 highly overlapping Gaussian clusters of varying densities and shapes but equal size. As with the A3 dataset, CLoNe does not perform unnecessary merging with nearby clusters (<xref rid="btaa742-F2" ref-type="fig">Fig. 2e</xref>) and is robust to large amounts of outliers on top of clusters with significantly different densities (<xref rid="btaa742-F2" ref-type="fig">Fig. 2f</xref>). This general applicability of CLoNe coupled with a single, robust and easy to set input parameter (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>) is unique among the commonly used clustering algorithms found in the Scikit-learn package (<xref rid="btaa742-B50" ref-type="bibr">Pedregosa <italic toggle="yes">et al.</italic>, 2011</xref>). In fact, CLoNe is among the fastest algorithms from that package in addition to both DP and DPA and the most accurate on the available benchmark cases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). The only other algorithm succeeding on all benchmark cases is OPTICS (<xref rid="btaa742-B4" ref-type="bibr">Ankerst <italic toggle="yes">et al.</italic>, 1999</xref>), which runs slightly slower than CLoNe on these datasets and tends to classify too many points as outliers. Similar to the original implementation of DP, CLoNe is applicable to high dimensionality datasets as well (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
      <p>One of the principal aims of this work is to offer a clustering algorithm able to classify unlabeled biological structural ensembles into relevant states associated with their function and mechanism of action. We have applied CLoNe to real-world structural biology data reporting on the dynamic conformational space of a protein that associates with its specific biological membrane, cryptic allosteric pocket opening and dimerization of transmembrane proteins.</p>
    </sec>
    <sec>
      <title>3.2 Determining relevant states within protein conformational ensembles</title>
      <p>COQ9 is a lipid-binding protein associated with the biosynthesis of coenzyme Q (CoQ), a redox-active lipid that is essential for cellular respiration (<xref rid="btaa742-B40" ref-type="bibr">Lohman <italic toggle="yes">et al.</italic>, 2014</xref>). Recently, coarse-grained molecular dynamics (CG-MD) simulations and liposome co-flotation assays were used together to reveal that COQ9 accesses membranes in a multi-step fashion through a distinct, C-terminal amphipathic helix (α10) (<xref rid="btaa742-B39" ref-type="bibr">Lohman <italic toggle="yes">et al.</italic>, 2019</xref>). In these simulations, COQ9 first diffused in the aqueous environment, then underwent various conformational changes upon membrane binding (<xref rid="btaa742-B39" ref-type="bibr">Lohman <italic toggle="yes">et al.</italic>, 2019</xref>). We applied CLoNe to the CG-MD trajectory used in the latter study and sought to identify the main binding events pertaining to the protein itself. To this end, we extracted features characterizing both its movements in the aqueous environment through monitoring its distance to the membrane as well as key conformational changes based on the angle between the unique α10 helix of COQ9 and its globular domain (<xref rid="btaa742-F3" ref-type="fig">Fig. 3a</xref>, left). Using these two features, CLoNe outputs three clusters, each of which seem to follow Gaussian distributions (<xref rid="btaa742-F3" ref-type="fig">Fig. 3b</xref>). One cluster regroups all conformations that correspond to diffusion movements in the aqueous environment, while the other two highlight the membrane association of α10 first followed by the globular domain as a converging step (<xref rid="btaa742-F3" ref-type="fig">Fig. 3a</xref>), thus its higher density (<xref rid="btaa742-F3" ref-type="fig">Fig. 3b</xref>). Similar results can be obtained hypothesis-free by using raw atomic spatial coordinates (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). The Gaussian distribution of structural clusters has also been observed in a recent study from our group involving the KAP1 protein, where CLoNe was also successfully applied (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>) (<xref rid="btaa742-B24" ref-type="bibr">Fonti <italic toggle="yes">et al.</italic>, 2019</xref>).
</p>
      <fig position="float" id="btaa742-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Utilizing Gaussian cluster properties to extract centers as key biological states of the COQ9 membrane protein. (<bold>a</bold>) COQ9 and its associated features, which include an internal angle <italic toggle="yes">θ</italic> and its distance to the membrane <italic toggle="yes">d</italic> (left). Cluster centers are shown on the right side of the panel. (<bold>b</bold>) Every frame is plotted in the mentioned feature space and color coded according to their core cardinality (left) and cluster assignation (right), which follows the same color code as in (a). Outliers are shown as black crosses and centers as black stars</p>
        </caption>
        <graphic xlink:href="btaa742f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Isolating sub-ensembles of relevant conformations for ligand–target interactions</title>
      <p>In recent years, small-molecule docking software is no stranger to dynamics, taking into account ensembles of ligand conformations (<xref rid="btaa742-B3" ref-type="bibr">Amaro <italic toggle="yes">et al.</italic>, 2018</xref>) or receptor flexibility (<xref rid="btaa742-B36" ref-type="bibr">Kokh <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btaa742-B55" ref-type="bibr">Salmaso and Moro, 2018</xref>; <xref rid="btaa742-B61" ref-type="bibr">Vahl Quevedo <italic toggle="yes">et al.</italic>, 2014</xref>). A recent study highlighted a novel replica exchange-based MD protocol combined with benzene probes, where each replica harbors a different scaling of water–protein interactions (<xref rid="btaa742-B48" ref-type="bibr">Oleinikovas <italic toggle="yes">et al.</italic>, 2016</xref>). Using this method, the authors could observe the opening of cryptic allosteric pockets in several systems, including that of the TEM1 β-lactamase, which plays a critical role in antibiotic resistance (<xref rid="btaa742-B30" ref-type="bibr">Horn and Shoichet, 2004</xref>). The simulations were started from the <italic toggle="yes">apo</italic> crystal structure with a closed allosteric pocket (<xref rid="btaa742-F4" ref-type="fig">Fig. 4a</xref>). Out of the eight replicas of the simulation, we chose three with neutral (first), medium (fourth) and highest (last) scaling factors as a tradeoff between maximizing the sampled conformational space and limiting redundancy of the over-represented closed conformations (<xref rid="btaa742-B48" ref-type="bibr">Oleinikovas <italic toggle="yes">et al.</italic>, 2016</xref>) (<xref rid="btaa742-F4" ref-type="fig">Fig. 4b</xref>). Along with key residue R244 on the opposite wall of the pocket, the opening of α-helices H11 and H12 and key residues L220 and N276 dictate pocket opening and allow two inhibitors to be accommodated (<xref rid="btaa742-B30" ref-type="bibr">Horn and Shoichet, 2004</xref>), while the three mentioned residues form a triad when the pocket is closed. In addition to the opening of the two helices, visual inspection of the simulations indicated a deepening of the pocket. As a result, we chose features tracking the distance between the Cα of residues L220 and N276 as well as that of their sidechains to monitor pocket opening as well as the distance between the Cα of I263 and I279 as a measure of pocket depth (<xref rid="btaa742-F4" ref-type="fig">Fig. 4a</xref>). The original study used <italic toggle="yes">fpocket</italic> (<xref rid="btaa742-B37" ref-type="bibr">Le Guilloux <italic toggle="yes">et al.</italic>, 2009</xref>) to monitor pocket exposure in each replica (<xref rid="btaa742-F4" ref-type="fig">Fig. 4b</xref>, top). The same was done on the clusters obtained by CLoNe (<xref rid="btaa742-F4" ref-type="fig">Fig. 4b</xref>, bottom), showing different levels of pocket openness. Corresponding cluster centers highlight key structural differences between each state (<xref rid="btaa742-F4" ref-type="fig">Fig. 4c</xref>), which are representative of the feature distribution per cluster (<xref rid="btaa742-F4" ref-type="fig">Fig. 4d</xref>, top). Cluster assignation follows the observation of the original publication, where open states were more prevalent in the replica of medium scaling (<xref rid="btaa742-F4" ref-type="fig">Fig. 4d</xref>, bottom).
</p>
      <fig position="float" id="btaa742-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Identification of different opening states of the allosteric cryptic pocket in TEM1 β-lactamase. (<bold>a</bold>) <italic toggle="yes">apo</italic> and <italic toggle="yes">Holo</italic> structures (left and right, respectively). Allosteric inhibitors are shown in gray and white. Features following helical opening include the distance between Cα atoms of N276 and L220 (medium blue) and the Cγ of their sidechain (light blue). Pocket depth is monitored by the distance between Cα-carbons of I263 and 279 (dark blue). (<bold>b</bold>) The pocket exposure calculated using the <italic toggle="yes">fpocket</italic> software for the original replicas (top) and for each clusters (bottom). The dotted line in both is the reference value of the <italic toggle="yes">holo</italic> crystal structure used in the original paper. (<bold>c</bold>) The center of each cluster in cartoon representation on top of a surface representation of the allosteric pocket, highlighting the different states of helical openness and pocket depth. The triad N276-L220-R244 governing pocket opening and closing are shown as gray sticks. (<bold>c</bold>) The distribution of each feature for each cluster (top) and the cluster assignation along the three chosen replicas (bottom)</p>
        </caption>
        <graphic xlink:href="btaa742f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Identifying dominant conformational motifs in protein oligomerization</title>
      <p>Another challenge in structural biology is the understanding of how biomolecules oligomerize to distinctive functional states. One of these cases, the transmembrane α-helix of the Amyloid Precursor Protein (termed APP hereafter), has recently been studied by our lab through the high-throughput MD protocol DAFT (Docking Assay For Transmembrane components, (<xref rid="btaa742-B65" ref-type="bibr">Wassenaar <italic toggle="yes">et al.</italic>, 2015</xref>)) in order to identify which of two dimerization motifs is promoted depending on the lipid composition of the synaptic plasma membrane (<xref rid="btaa742-B6" ref-type="bibr">Audagnotto <italic toggle="yes">et al.</italic>, 2016</xref>). The G<sub>700</sub>G<sub>704</sub>G<sub>708</sub> motif is thought to direct the binding of APP to regulators promoting cholesterol biosynthesis, while the G<sub>709</sub>A<sub>713</sub> motif would bind to cholesterol molecules (<xref rid="btaa742-F5" ref-type="fig">Fig. 5a</xref>). Extracting features from molecular datasets is not always straightforward. Macromolecular movements possess an inherent redundancy due to the sheer number of internal degrees of freedom or prior knowledge may be lacking in order to select meaningful features, such as those highlighted in <xref rid="btaa742-F3" ref-type="fig">Figures 3</xref> and <xref rid="btaa742-F4" ref-type="fig">4</xref>. The use of dimensionality reduction methods, such as principal component analysis (PCA) has been seen for clustering of MD simulations (<xref rid="btaa742-B66" ref-type="bibr">Wolf and Kirschner, 2013</xref>) and can help identifying coordinates of significance while discarding less useful dimensions. The DAFT simulations of APP from (<xref rid="btaa742-B6" ref-type="bibr">Audagnotto <italic toggle="yes">et al.</italic>, 2016</xref>) are over 2 ms in total and contain countless states, many corresponding to unbound monomers. The first principal component based on the Cartesian coordinates of the coarse grain backbone covers 77% of the variability in the simulation, highlighting two clusters (<xref rid="btaa742-F5" ref-type="fig">Fig. 5b</xref>). The blue cluster of lower amplitude corresponds to all states exhibiting unbound monomers (<xref rid="btaa742-F5" ref-type="fig">Fig. 5e</xref>, left), while the second cluster regroups all the dimerized states regardless of motif. Focusing on that cluster, we calculated the pair-wise distances between the backbone atoms of each motifs in both helices (<xref rid="btaa742-F5" ref-type="fig">Fig. 5a</xref>) and reduced these features to a two-dimensional principal space covering 94% of the variability before clustering (<xref rid="btaa742-F5" ref-type="fig">Fig. 5c</xref>). We want to highlight CLoNe’s ability to analyze the neighborhood of low-density clusters without influence from high-density regions (<xref rid="btaa742-F5" ref-type="fig">Fig. 5c</xref> and Supplementary Table S2). Clusters in blue in <xref rid="btaa742-F5" ref-type="fig">Figure 5d</xref> all depict states close to the G<sub>700</sub>G<sub>704</sub>G<sub>708</sub> motifs and those in green the G<sub>709</sub>A<sub>713</sub> motif. In the middle are two clusters, shown in brown, that we interpret as hybrid. In all cases, the darker-shaded clusters of each group correspond to the closest to the optimal motif arrangement, while the others can be considered as closely related metastable states (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>). Similar to the original study (<xref rid="btaa742-B6" ref-type="bibr">Audagnotto <italic toggle="yes">et al.</italic>, 2016</xref>), CLoNe finds the preferred dimerization motif to be G<sub>700</sub>G<sub>704</sub>G<sub>708</sub> as evidenced by the corresponding centers’ local densities, cluster population and core cardinality (<xref rid="btaa742-F5" ref-type="fig">Fig. 5c</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). A comparison between CLoNe and other state-of-the-art algorithms on all the structural data shown in this section demonstrates the advantages of CLoNe for analysis of molecular structural ensembles (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>).
</p>
      <fig position="float" id="btaa742-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Classification and frequency estimation of APP dimerization motifs in the plasma membrane. (<bold>a</bold>) The two known dimerization motifs of the transmembrane helix of APP. Membrane is depicted with gray spheres, the G<sub>700</sub>G<sub>704</sub>G<sub>708</sub> motif with teal spheres and the G<sub>709</sub>A<sub>713</sub> motif with gold spheres. (<bold>b</bold>) The black line depicts the probability density distribution of the trajectory along the first principal component, which covers 77% of variability. Obtained clusters are shown in colors underneath, with their centers as black stars. Below the clusters is the distribution of core cardinalities, with the corresponding color bar below it. (<bold>c</bold>) The cluster of bound dimers of (b) was extracted and the pair-wise distances between the backbone atoms of each motifs in both helices was computed for every frame. The plot shows the first two principal components of the resulting dataset (with eigenvalues of 0.66 and 0.28, respectively), where each point is color-coded according to the cardinality of its core. Stars represent cluster centers. (<bold>d</bold>) The clusters obtained from the aforementioned dataset of bound conformations. (<bold>e</bold>) Renders of the unbound and dimerized APP cluster centers and their respective frequency after outlier removal. Dimerized APP centers shown correspond to the dark blue, dark brown and dark green clusters. Sidechains have been hidden for better visualization</p>
        </caption>
        <graphic xlink:href="btaa742f5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Many clustering methods rely on parameters that are often non-trivial to optimize or on random initial conditions that may drastically change the outcome. Commonly used algorithms are generally restricted to specific cluster properties, forcing the researcher through a process of trial and error. Moreover, choosing relevant features from structural datasets is challenging and different features may generate different cluster topologies, sometimes irrelevant. CLoNe was designed with these issues in mind and aims to provide a stream-lined analytic process to yield results rapidly along with helpful visualization scripts to analyze and confirm the relevance of the clusters in the target biological context (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). CLoNe’s only parameter regulates the size of the local neighborhood considered around each data point, which can be regarded as cluster sizing parameter. Its value need only be decreased if clusters seem too inclusive and vice-versa, making CLoNe an intuitive algorithm to use in addition to its general applicability. For structural datasets, CLoNe is able to extract clusters as separate trajectories and provides scripts for their automatic loading in the visualization software VMD (<xref rid="btaa742-B31" ref-type="bibr">Humphrey <italic toggle="yes">et al.</italic>, 1996</xref>). For larger macromolecules, the concept of a conformational state is blurry, hard to determine and often depends on context. It is not always clear which features to use to obtain an accurate partition of the structural ensemble. The results obtained on COQ9 can be obtained hypothesis-free on raw spatial coordinates or using PCA to extract relevant features (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). This was done in the case of APP as well as to reduce an otherwise redundant feature space to one of lower dimensionality. If one wishes to disentangle internal from overall motion, dihedral PCA was used with success to study peptide folding (<xref rid="btaa742-B2" ref-type="bibr">Altis <italic toggle="yes">et al.</italic>, 2007</xref>; <xref rid="btaa742-B45" ref-type="bibr">Mu <italic toggle="yes">et al.</italic>, 2004</xref>). However, when other features than the chosen ones can be expected to exhibit motions of larger amplitudes, PCA will favor the latter over the former. This is true for the TEM1 β-lactamase, where internal structural motions will be more prevalent than the fluctuations of the selected key pocket residues. In such cases, a feature-based approach is to be preferred. Alternatively, some will advocate the use of time-lagged independent component analysis (TICA) (<xref rid="btaa742-B46" ref-type="bibr">Naritomi and Fuchigami, 2011</xref>) instead. TICA was found to be the better alternative for building Markov state models (<xref rid="btaa742-B32" ref-type="bibr">Husic and Pande, 2018</xref>; <xref rid="btaa742-B52" ref-type="bibr">Pérez-Hernández <italic toggle="yes">et al.</italic>, 2013</xref>). However, in cases where large amplitude fluctuations are the target or when there is redundancy in features, we believe that PCA remains a safe approach.</p>
    <p>As the conformational ensembles presented in this study tend to exhibit Gaussian distributions, CLoNe may thus be used to extract cluster centers as higher probability states. Such states offer an overview of the ensemble and may serve as starting models for building Markov state models in general. Moreover, the precision of the classification achieved by CLoNe enables the identification of dominant biological states from large datasets. Beyond the case of APP, CLoNe identified different key pocket conformations in the case of TEM1 β-lactamase. Further clustering efforts on this system should target the different positions of R244, which was not tracked in this study but was previously shown to play a dual role between TEM1’s active site and allosteric pocket (<xref rid="btaa742-B30" ref-type="bibr">Horn and Shoichet, 2004</xref>). CLoNe may then be used as a pre-processing tool prior to small-molecule docking studies, where accounting for receptor flexibility is an active development area (<xref rid="btaa742-B36" ref-type="bibr">Kokh <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btaa742-B61" ref-type="bibr">Vahl Quevedo <italic toggle="yes">et al.</italic>, 2014</xref>).</p>
    <p>Integrative modeling aims at incorporating data from multiple sources to determine the structure of macromolecular complexes. Such hybrid strategies typically combine low resolution data of whole complexes with high resolution structures of their components so as to predict the quaternary structure of the former (<xref rid="btaa742-B11" ref-type="bibr">Cassidy <italic toggle="yes">et al.</italic>, 2018</xref>). This process is however severely hindered by structural dynamics differing between a complex and its isolated components. For this reason, many hybrid modeling strategies now incorporate some form of dynamics to bridge this gap (<xref rid="btaa742-B41" ref-type="bibr">Malhotra <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa742-B60" ref-type="bibr">Tamò <italic toggle="yes">et al.</italic>, 2015</xref>). While we previously utilized classical MD for the prediction of heptameric aerolysin pores (<xref rid="btaa742-B20" ref-type="bibr">Degiacomi <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btaa742-B19" ref-type="bibr">Degiacomi and Dal Peraro, 2013</xref>), such an approach would not be feasible for heteromultimeric assemblies where multiple conformational ensembles are required simultaneously. Reducing them to their crucial components may enable the structural characterization of large macromolecular complexes, which may otherwise be intractable. Applied to the fields of small-molecule docking, integrative modeling and structural dynamics studies, CLoNe presents itself as a versatile and powerful tool for modern computational structural biology.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa742_Supplementary_Data</label>
      <media xlink:href="btaa742_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Vladimiras Oleinikovas and Francesco L. Gervasio for providing the simulations of the TEM1 β-lactamase as well as offering general advice; Lucien F. Krapp and Romain Groux for helpful discussions.</p>
    <sec>
      <title>Funding</title>
      <p>M.D.P. lab was supported by the Swiss National Science Foundation (grants number 200021_157217 and 31003A_170154).</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa742-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abriata</surname><given-names>L.A.</given-names></string-name>, <string-name><surname>Dal Peraro</surname><given-names>M.</given-names></string-name></person-group> (<year>2020</year>) 
<article-title>Will cryo-electron microscopy shift the current paradigm in protein structure prediction?</article-title>  <source>J. Chem. Inf. Model</source>., <volume>60</volume>, <fpage>2443</fpage>–<lpage>2447</lpage>.<pub-id pub-id-type="pmid">32134661</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altis</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) 
<article-title>Dihedral angle principal component analysis of molecular dynamics simulations</article-title>. <source>J. Chem. Phys</source>., <volume>126</volume>, <fpage>244111</fpage>.<pub-id pub-id-type="pmid">17614541</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amaro</surname><given-names>R.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Ensemble docking in drug discovery</article-title>. <source>Biophys. J</source>., <volume>114</volume>, <fpage>2271</fpage>–<lpage>2278</lpage>.<pub-id pub-id-type="pmid">29606412</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ankerst</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1999</year>) OPTICS: Ordering Points to Identify the Clustering Structure. In: <italic toggle="yes">Proceedings of the 1999 ACM SIGMOD International Conference on Management of Data, SIGMOD ’99</italic>, pp. 49–60. ACM, New York, NY, USA.</mixed-citation>
    </ref>
    <ref id="btaa742-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Audagnotto</surname><given-names>M.</given-names></string-name>, <string-name><surname>Dal Peraro</surname><given-names>M.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>Protein post-translational modifications: in silico prediction tools and molecular modeling</article-title>. <source>Comput. Struct. Biotechnol. J</source>., <volume>15</volume>, <fpage>307</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">28458782</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Audagnotto</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Effect of the synaptic plasma membrane on the stability of the amyloid precursor protein homodimer</article-title>. <source>J. Phys. Chem. Lett</source>., <volume>7</volume>, <fpage>3572</fpage>–<lpage>3578</lpage>.<pub-id pub-id-type="pmid">27518597</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barducci</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>Metadynamics</article-title>. <source>Wiley Interdiscip. Rev. Comput. Mol. Sci</source>., <volume>1</volume>, <fpage>826</fpage>–<lpage>843</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beauchamp</surname><given-names>K.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) 
<article-title>Simple few-state models reveal hidden complexity in protein folding</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>109</volume>, <fpage>17807</fpage>–<lpage>17813</lpage>.<pub-id pub-id-type="pmid">22778442</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bhattacharyya</surname><given-names>A.</given-names></string-name></person-group> (<year>1943</year>) 
<article-title>On a measure of divergence between two statistical populations defined by their probability distributions</article-title>. <source>Bull. Calcutta Math. Soc</source>., <volume>35</volume>, <fpage>99</fpage>–<lpage>109</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bussi</surname><given-names>G.</given-names></string-name></person-group> (<year>2014</year>) 
<article-title>Hamiltonian replica exchange in GROMACS: a flexible implementation</article-title>. <source>Mol. Phys</source>., <volume>112</volume>, <fpage>379</fpage>–<lpage>384</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cassidy</surname><given-names>C.K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>CryoEM-based hybrid modeling approaches for structure determination</article-title>. <source>Curr. Opin. Microbiol</source>., <volume>43</volume>, <fpage>14</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">29107896</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>H.</given-names></string-name>, <string-name><surname>Yeung</surname><given-names>D.-Y.</given-names></string-name></person-group> (<year>2008</year>) 
<article-title>Robust path-based spectral clustering</article-title>. <source>Pattern Recogn</source>., <volume>41</volume>, <fpage>191</fpage>–<lpage>203</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chavent</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Molecular dynamics simulations of membrane proteins and their interactions: from nanoscale to mesoscale</article-title>. <source>Curr. Opin. Struct. Biol</source>., <volume>40</volume>, <fpage>8</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">27341016</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>L.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) 
<article-title>Ensemble-based virtual screening reveals potential novel antiviral compounds for avian influenza neuraminidase</article-title>. <source>J. Med. Chem</source>., <volume>51</volume>, <fpage>3878</fpage>–<lpage>3894</lpage>.<pub-id pub-id-type="pmid">18558668</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>d’Errico</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) Automatic topography of high-dimensional data sets by non-parametric density peak clustering. arXiv:1802.10549v1 [stat.ML]</mixed-citation>
    </ref>
    <ref id="btaa742-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Paris</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Clustering molecular dynamics trajectories for optimizing docking experiments</article-title>. <source>Comput. Intell. Neurosci</source>., <volume>2015</volume>, <fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>de Souza</surname><given-names>V.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) Clustering algorithms applied on analysis of protein molecular dynamics. In: <italic toggle="yes">2017 IEEE Latin American Conference on Computational Intelligence (LA-CCI)</italic>. Arequipa, 2017, pp. 1–6. <pub-id pub-id-type="doi">10.1109/LA-CCI.2017.8285695</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Vivo</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Role of molecular dynamics and related methods in drug discovery</article-title>. <source>J. Med. Chem</source>., <volume>59</volume>, <fpage>4035</fpage>–<lpage>4061</lpage>.<pub-id pub-id-type="pmid">26807648</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Degiacomi</surname><given-names>M.T.</given-names></string-name>, <string-name><surname>Dal Peraro</surname><given-names>M.</given-names></string-name></person-group> (<year>2013</year>) 
<article-title>Macromolecular symmetric assembly prediction using swarm intelligence dynamic modeling</article-title>. <source>Structure</source>, <volume>21</volume>, <fpage>1097</fpage>–<lpage>1106</lpage>.<pub-id pub-id-type="pmid">23810695</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Degiacomi</surname><given-names>M.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Molecular assembly of the aerolysin pore reveals a swirling membrane-insertion mechanism</article-title>. <source>Nat. Chem. Biol</source>., <volume>9</volume>, <fpage>623</fpage>–<lpage>629</lpage>.<pub-id pub-id-type="pmid">23912165</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Doerr</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>HTMD: high-throughput molecular dynamics for molecular discovery</article-title>. <source>J. Chem. Theory Comput</source>., <volume>12</volume>, <fpage>1845</fpage>–<lpage>1852</lpage>.<pub-id pub-id-type="pmid">26949976</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Du</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Study on density peaks clustering based on k-nearest neighbors and principal component analysis</article-title>. <source>Knowl. Based Syst</source>., <volume>99</volume>, <fpage>135</fpage>–<lpage>145</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B23">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ester</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1996</year>) <part-title>A density-based algorithm for discovering clusters a density-based algorithm for discovering clusters in large spatial databases with noise</part-title>. In: <source>Proceedings of the Second International Conference on Knowledge Discovery and Data Mining, KDD’96</source>, pp. <fpage>226</fpage>–<lpage>231</lpage>. 
<publisher-name>AAAI Press</publisher-name>, 
<publisher-loc>Portland, OR, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btaa742-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fonti</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>KAP1 is an antiparallel dimer with a natively functional asymmetry</article-title>. <source>Life Science Alliance</source>, <volume>2</volume>(4), e201900349.</mixed-citation>
    </ref>
    <ref id="btaa742-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frank</surname><given-names>J.</given-names></string-name></person-group> (<year>2018</year>) 
<article-title>New opportunities created by single-particle cryo-EM: the mapping of conformational space</article-title>. <source>Biochemistry</source>, <volume>57</volume>, <fpage>888</fpage>–<lpage>888</lpage>.<pub-id pub-id-type="pmid">29368918</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fränti</surname>,<given-names>P.</given-names></string-name>
 <string-name><surname>Sieranoja</surname>,<given-names>S.</given-names></string-name></person-group> (<year>2018</year>) 
<article-title>K-means properties on six clustering benchmark datasets</article-title>. <source><italic toggle="yes">Applied Intelligence</italic></source>, <volume>48</volume>, <fpage>4743</fpage>–<lpage>4759</lpage>. <pub-id pub-id-type="doi">10.1007/s10489-018-1238-7</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fu</surname><given-names>L.</given-names></string-name>, <string-name><surname>Medico</surname><given-names>E.</given-names></string-name></person-group> (<year>2007</year>) 
<article-title>FLAME, a novel fuzzy clustering method for the analysis of DNA microarray data</article-title>. <source>BMC Bioinformatics</source>, <volume>8</volume>, <fpage>3</fpage>.<pub-id pub-id-type="pmid">17204155</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gionis</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) 
<article-title>Clustering aggregation</article-title>. <source>ACM Trans. Knowl. Discov. Data</source>, <volume>1</volume>, <fpage>4</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamelberg</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2004</year>) 
<article-title>Accelerated molecular dynamics: a promising and efficient simulation method for biomolecules</article-title>. <source>J. Chem. Phys</source>., <volume>120</volume>, <fpage>11919</fpage>–<lpage>11929</lpage>.<pub-id pub-id-type="pmid">15268227</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Horn</surname><given-names>J.R.</given-names></string-name>, <string-name><surname>Shoichet</surname><given-names>B.K.</given-names></string-name></person-group> (<year>2004</year>) 
<article-title>Allosteric inhibition through core disruption</article-title>. <source>J. Mol. Biol</source>, <volume>336</volume>, <fpage>1283</fpage>–<lpage>1291</lpage>.<pub-id pub-id-type="pmid">15037085</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Humphrey</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1996</year>) 
<article-title>VMD: visual molecular dynamics</article-title>. <source>J. Mol. Graph</source>, <volume>14</volume>, <fpage>33</fpage>–<lpage>38</lpage>.<pub-id pub-id-type="pmid">8744570</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Husic</surname><given-names>B.E.</given-names></string-name>, <string-name><surname>Pande</surname><given-names>V.S.</given-names></string-name></person-group> (<year>2018</year>) 
<article-title>Markov state models: from an art to a science</article-title>. <source>J. Am. Chem. Soc</source>., <volume>140</volume>, <fpage>2386</fpage>–<lpage>2396</lpage>.<pub-id pub-id-type="pmid">29323881</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Husic</surname><given-names>B.E.</given-names></string-name>, <string-name><surname>Pande</surname><given-names>V.S.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>Ward clustering improves cross-validated Markov state models of protein folding</article-title>. <source>J. Chem. Theory Comput</source>., <volume>13</volume>, <fpage>963</fpage>–<lpage>967</lpage>.<pub-id pub-id-type="pmid">28195713</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jain</surname><given-names>A.K.</given-names></string-name></person-group> (<year>2010</year>) 
<article-title>Data clustering: 50 years beyond K-means</article-title>. <source>Pattern Recognit. Lett</source>., <volume>31</volume>, <fpage>651</fpage>–<lpage>666</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B35">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Jones</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2001</year>) SciPy: open source scientific tools for Python. <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>.</mixed-citation>
    </ref>
    <ref id="btaa742-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kokh</surname><given-names>D.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>Receptor flexibility in small-molecule docking calculations</article-title>. <source>Wiley Interdiscip. Rev. Comput. Mol. Sci</source>., <volume>1</volume>, <fpage>298</fpage>–<lpage>314</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Le Guilloux</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) 
<article-title>Fpocket: an open source platform for ligand pocket detection</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>, <fpage>168</fpage>.<pub-id pub-id-type="pmid">19486540</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liang</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>P.</given-names></string-name></person-group> (<year>2016</year>) 
<article-title>Delta-density based clustering with a divide-and-conquer strategy: 3DC clustering</article-title>. <source>Pattern Recognit. Lett</source>., <volume>73</volume>, <fpage>52</fpage>–<lpage>59</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lohman</surname><given-names>D.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>An isoprene lipid-binding protein promotes eukaryotic coenzyme Q biosynthesis</article-title>. <source>Mol. Cell</source>, <volume>73</volume>, <fpage>763</fpage>–<lpage>774.e10</lpage>.<pub-id pub-id-type="pmid">30661980</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lohman</surname><given-names>D.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Mitochondrial COQ9 is a lipid-binding protein that associates with COQ7 to enable coenzyme Q biosynthesis</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>111</volume>, <fpage>E4697</fpage>–E<lpage>4705</lpage>.<pub-id pub-id-type="pmid">25339443</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Malhotra</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Modelling structures in cryo-EM maps</article-title>. <source>Curr. Opin. Struct. Biol</source>., <volume>58</volume>, <fpage>105</fpage>–<lpage>114</lpage>.<pub-id pub-id-type="pmid">31394387</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McGibbon</surname><given-names>R.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>MDTraj: a modern open library for the analysis of molecular dynamics trajectories</article-title>. <source>Biophys. J</source>., <volume>109</volume>, <fpage>1528</fpage>–<lpage>1532</lpage>.<pub-id pub-id-type="pmid">26488642</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKiernan</surname>,<given-names>K. A.</given-names></string-name>  <etal>et al</etal>. </person-group> (<year>2017</year>) 
<article-title>Modeling the mechanism of CLN025 beta-hairpin formation</article-title>. <source><italic toggle="yes">The Journal of Chemical Physics</italic></source>, <volume>147</volume>, <fpage>104107</fpage>.<pub-id pub-id-type="pmid">28915754</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mehmood</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Clustering by fast search and find of density peaks via heat diffusion</article-title>. <source>Neurocomputing</source>, <volume>208</volume>, <fpage>210</fpage>–<lpage>217</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mu</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2004</year>) 
<article-title>Energy landscape of a small peptide revealed by dihedral angle principal component analysis</article-title>. <source>Proteins Struct. Funct. Bioinform</source>., <volume>58</volume>, <fpage>45</fpage>–<lpage>52</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Naritomi</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Fuchigami</surname><given-names>S.</given-names></string-name></person-group> (<year>2011</year>) 
<article-title>Slow dynamics in protein fluctuations revealed by time-structure based independent component analysis: the case of domain motions</article-title>. <source>J. Chem. Phys</source>., <volume>134</volume>, <fpage>065101</fpage>.<pub-id pub-id-type="pmid">21322734</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Noé</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Boltzmann generators: sampling equilibrium states of many-body systems with deep learning</article-title>. <source>Science</source>, <volume>365</volume>, <fpage>eaaw1147</fpage>.<pub-id pub-id-type="pmid">31488660</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oleinikovas</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Understanding cryptic pocket formation in protein targets by enhanced sampling simulations</article-title>. <source>J. Am. Chem. Soc</source>., <volume>138</volume>, <fpage>14257</fpage>–<lpage>14263</lpage>.<pub-id pub-id-type="pmid">27726386</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paris</surname><given-names>R.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>An effective approach for clustering InhA molecular dynamics trajectory using substrate-binding cavity features</article-title>. <source>PLoS One</source>, <volume>10</volume>, <fpage>e0133172</fpage>.<pub-id pub-id-type="pmid">26218832</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>Scikit-learn: machine learning in Python</article-title>. <source>J. Mach. Learn. Res</source>., <volume>12</volume>, <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Clustering algorithms to analyze molecular dynamics simulation trajectories for complex chemical and biological systems</article-title>. <source>Chin. J. Chem. Phys</source>., <volume>31</volume>, <fpage>404</fpage>–<lpage>420</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pérez-Hernández</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Identification of slow molecular order parameters for Markov model construction</article-title>. <source>J. Chem. Phys</source>., <volume>139</volume>, <fpage>015102</fpage>.<pub-id pub-id-type="pmid">23822324</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rodriguez</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Computing the free energy without collective variables</article-title>. <source>J. Chem. Theory Comput</source>., <volume>14</volume>, <fpage>1206</fpage>–<lpage>1215</lpage>.<pub-id pub-id-type="pmid">29401379</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rodriguez</surname><given-names>A.</given-names></string-name>, <string-name><surname>Laio</surname><given-names>A.</given-names></string-name></person-group> (<year>2014</year>) 
<article-title>Clustering by fast search and find of density peaks</article-title>. <source>Science</source>, <volume>344</volume>, <fpage>1492</fpage>–<lpage>1496</lpage>.<pub-id pub-id-type="pmid">24970081</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salmaso</surname>,<given-names>V.</given-names></string-name>
 <string-name><surname>Moro</surname>,<given-names>S.</given-names></string-name></person-group> (<year>2018</year>) 
<article-title>Bridging molecular docking to molecular dynamics in exploring ligand-protein recognition process: an overview</article-title>. <source><italic toggle="yes">Front. Pharmacol</italic></source>, <volume>9</volume>, <fpage>923</fpage>.<pub-id pub-id-type="pmid">30186166</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B56">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Seabold</surname><given-names>S.</given-names></string-name>, <string-name><surname>Perktold</surname><given-names>J.</given-names></string-name></person-group> (<year>2010</year>) Statsmodels: econometric and statistical modeling with python. In: <italic toggle="yes">9th Python in Science Conference</italic>. <ext-link xlink:href="https://www.statsmodels.org/devel/#citation" ext-link-type="uri">https://www.statsmodels.org/devel/#citation</ext-link>.</mixed-citation>
    </ref>
    <ref id="btaa742-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shao</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) 
<article-title>Clustering molecular dynamics trajectories: 1. Characterizing the performance of different clustering algorithms</article-title>. <source>J. Chem. Theory Comput</source>., <volume>3</volume>, <fpage>2312</fpage>–<lpage>2334</lpage>.<pub-id pub-id-type="pmid">26636222</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shirts</surname><given-names>M.</given-names></string-name>, <string-name><surname>Pande</surname><given-names>V.S.</given-names></string-name></person-group> (<year>2000</year>) 
<article-title>Screen savers of the World Unite</article-title>! <source>Science</source>, <volume>290</volume>, <fpage>1903</fpage>–<lpage>1904</lpage>.<pub-id pub-id-type="pmid">17742054</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sultan</surname><given-names>M.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Transferable neural networks for enhanced sampling of protein dynamics</article-title>. <source>J. Chem. Theory Comput</source>., <volume>14</volume>, <fpage>1887</fpage>–<lpage>1894</lpage>.<pub-id pub-id-type="pmid">29529369</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tamò</surname><given-names>G.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>The importance of dynamics in integrative modeling of supramolecular assemblies</article-title>. <source>Curr. Opin. Struct. Biol</source>., <volume>31</volume>, <fpage>28</fpage>–<lpage>34</lpage>.<pub-id pub-id-type="pmid">25795087</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vahl Quevedo</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>A strategic solution to optimize molecular docking simulations using Fully-Flexible Receptor models</article-title>. <source>Expert Syst. Appl</source>., <volume>41</volume>, <fpage>7608</fpage>–<lpage>7620</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Constructing Markov state models to elucidate the functional conformational changes of complex biomolecules</article-title>. <source>Wiley Interdiscip. Rev. Comput. Mol. Sci</source>., <volume>8</volume>, <fpage>e1343</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>X.-F.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>Y.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>Fast clustering using adaptive density peak detection</article-title>. <source>Stat. Methods Med. Res</source>., <volume>26</volume>, <fpage>2800</fpage>–<lpage>2811</lpage>.<pub-id pub-id-type="pmid">26475830</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ward</surname><given-names>J.H.</given-names></string-name></person-group> (<year>1963</year>) 
<article-title>Hierarchical grouping to optimize an objective function</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>58</volume>, <fpage>236</fpage>–<lpage>244</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wassenaar</surname><given-names>T.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>High-throughput simulations of dimer and trimer assembly of membrane proteins. the DAFT Approach</article-title>. <source>J. Chem. Theory Comput</source>., <volume>11</volume>, <fpage>2278</fpage>–<lpage>2291</lpage>.<pub-id pub-id-type="pmid">26574426</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>A.</given-names></string-name>, <string-name><surname>Kirschner</surname><given-names>K.N.</given-names></string-name></person-group> (<year>2013</year>) 
<article-title>Principal component and clustering analysis on molecular dynamics data of the ribosomal L11·23S subdomain</article-title>. <source>J. Mol. Model</source>., <volume>19</volume>, <fpage>539</fpage>–<lpage>549</lpage>.<pub-id pub-id-type="pmid">22961589</pub-id></mixed-citation>
    </ref>
    <ref id="btaa742-B67">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Robust clustering by detecting density peaks and assigning points based on fuzzy weighted K-nearest neighbors</article-title>. <source>Inf. Sci</source>., <volume>354</volume>, <fpage>19</fpage>–<lpage>40</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa742-B68">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>W.</given-names></string-name>, <string-name><surname>Li</surname><given-names>J.</given-names></string-name></person-group> (<year>2015</year>) Extended fast search clustering algorithm: widely density clusters, no density peaks. arXiv:1505.05610 [cs.DS].</mixed-citation>
    </ref>
  </ref-list>
</back>
