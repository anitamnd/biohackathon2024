<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6477968</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty802</article-id>
    <article-id pub-id-type="publisher-id">bty802</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GenomeFlow: a comprehensive graphical tool for modeling and analyzing 3D genome structure</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Trieu</surname>
          <given-names>Tuan</given-names>
        </name>
        <xref ref-type="author-notes" rid="bty802-FM2"/>
        <xref ref-type="aff" rid="bty802-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Oluwadare</surname>
          <given-names>Oluwatosin</given-names>
        </name>
        <xref ref-type="aff" rid="bty802-aff1"/>
        <xref ref-type="author-notes" rid="bty802-FM2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wopata</surname>
          <given-names>Julia</given-names>
        </name>
        <xref ref-type="aff" rid="bty802-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cheng</surname>
          <given-names>Jianlin</given-names>
        </name>
        <xref ref-type="aff" rid="bty802-aff1"/>
        <xref ref-type="corresp" rid="bty802-cor1"/>
        <!--<email>chengji@missouri.edu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty802-aff1">Department of Electrical Engineering and Computer Science, University of Missouri, Columbia, MO, USA</aff>
    <author-notes>
      <corresp id="bty802-cor1">To whom correspondence should be addressed. <email>chengji@missouri.edu</email></corresp>
      <fn id="bty802-FM2">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-09-12">
      <day>12</day>
      <month>9</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>9</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>8</issue>
    <fpage>1416</fpage>
    <lpage>1418</lpage>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>6</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>8</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>9</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty802.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Three-dimensional (3D) genome organization plays important functional roles in cells. User-friendly tools for reconstructing 3D genome models from chromosomal conformation capturing data and analyzing them are needed for the study of 3D genome organization.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We built a comprehensive graphical tool (GenomeFlow) to facilitate the entire process of modeling and analysis of 3D genome organization. This process includes the mapping of Hi-C data to one-dimensional (1D) reference genomes, the generation, normalization and visualization of two-dimensional (2D) chromosomal contact maps, the reconstruction and the visualization of the 3D models of chromosome and genome, the analysis of 3D models and the integration of these models with functional genomics data. This graphical tool is the first of its kind in reconstructing, storing, analyzing and annotating 3D genome models. It can reconstruct 3D genome models from Hi-C data and visualize them in real-time. This tool also allows users to overlay gene annotation, gene expression data and genome methylation data on top of 3D genome models.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The source code and user manual: <ext-link ext-link-type="uri" xlink:href="https://github.com/jianlin-cheng/GenomeFlow">https://github.com/jianlin-cheng/GenomeFlow</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The three-dimensional genome organization is important for cellular function (<xref rid="bty802-B4" ref-type="bibr">Lieberman-Aiden <italic>et al.</italic>, 2009</xref>; <xref rid="bty802-B8" ref-type="bibr">Rao <italic>et al.</italic>, 2014</xref>). Chromosome conformation capture techniques like Hi-C (<xref rid="bty802-B4" ref-type="bibr">Lieberman-Aiden <italic>et al.</italic>, 2009</xref>) has enabled the study of 3D genome organization in high resolution and high throughput. Graphical tools such as Juicer (<xref rid="bty802-B1" ref-type="bibr">Durand <italic>et al.</italic>, 2016</xref>) have been developed to process and analyze Hi-C data. Several algorithms have been proposed to reconstruct 3D genome models from Hi-C data (<xref rid="bty802-B9" ref-type="bibr">Segal and Bengtsson, 2015</xref>; <xref rid="bty802-B10" ref-type="bibr">Serra <italic>et al.</italic>, 2015</xref>; <xref rid="bty802-B12" ref-type="bibr">Varoquaux <italic>et al.</italic>, 2014</xref>). But there is no graphical tool with an easy user interface to build, analyze 3D genome models and integrate modeling with functional genomics data. To fill the gap, we built a comprehensive tool, GenomeFlow, for processing Hi-C data, reconstructing and analyzing 3D genome models, and integrating 3D models with functional genomics data.</p>
  </sec>
  <sec>
    <title>2 Function</title>
    <p>The function of GenomeFlow is organized in three categories: 1D function, 2D function and 3D function. 1D function allows users to map raw Hi-C pair-end reads to a reference genome to identify chromosomal contacts. 2D function is used to create, normalize and visualize contact matrices. 3D function is for reconstructing and analyzing 3D models. <xref ref-type="fig" rid="bty802-F1">Figure 1</xref> shows four typical 2D and 3D functional features: visualization of contact matrix and topologically associating domains (TADs), 3D model reconstruction, chromatin loop identification and model annotation. The most important function features of GenomeFlow are described below. 
</p>
    <fig id="bty802-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>A</bold>) Visualization of a contact matrix and its TADs; (<bold>B</bold>) reconstruction of a genome model in real time; (<bold>C</bold>) chromatin loops are identified and highlighted; (<bold>D</bold>) a model is annotated by two groups of genes (in red and green)</p>
      </caption>
      <graphic xlink:href="bty802f1"/>
    </fig>
    <sec>
      <title>2.1 Map Hi-C reads to 1D genome sequence</title>
      <p>GenomeFlow allows users to map raw pair-end Hi-C reads to a reference genome to generate chromosomal contacts. GenomeFlow calls external genome mapping tools such as Bowtie2 (<xref rid="bty802-B3" ref-type="bibr">Langmead &amp; Salzberg, 2012</xref>) to perform the indexing and mapping operations. It stores the mapped data file in a text file format, which can be used by the 2D function to generate contact matrices. This 1D function is optional since users can load their already mapped reads files into GenomeFlow for 2D and 3D analysis.</p>
    </sec>
    <sec>
      <title>2.2 Conversion of mapped reads to 2D contact matrices</title>
      <p>GenomeFlow provides a function to convert a mapped Hi-C reads file from the text format into a compressed file containing chromosomal contact matrices in the binary hic format (<xref rid="bty802-B1" ref-type="bibr">Durand <italic>et al.</italic>, 2016</xref>). The function normalizes chromosomal contacts with Knight-Ruiz matrix balancing normalization (<xref rid="bty802-B8" ref-type="bibr">Rao <italic>et al.</italic>, 2014</xref>) and Vanilla-Coverage normalization (<xref rid="bty802-B4" ref-type="bibr">Lieberman-Aiden <italic>et al.</italic>, 2009</xref>). It also provides options to create contact matrices at specific resolutions and for specific chromosomes.</p>
    </sec>
    <sec>
      <title>2.3 Extracting 2D contact matrices from a compressed contact file</title>
      <p>A binary contact file in hic format can contain contact matrices at different resolutions. GenomeFlow can read the header of the file first to display information about the genome version, chromosomes, resolutions and normalization methods. Users can then choose the contact matrix of a chromosome at a resolution and normalization method to be exported.</p>
    </sec>
    <sec>
      <title>2.4 Normalization, visualization and analysis of 2D contacts</title>
      <p>GenomeFlow provides a function to normalize contact matrices in sparse matrix format using the ICE normalization method (<xref rid="bty802-B2" ref-type="bibr">Imakaev <italic>et al.</italic>, 2012</xref>). GenomeFlow can visualize a contact matrix as a heat map, where numeric values in the input contact matrix are represented as colors according to a selected color gradient (<xref ref-type="fig" rid="bty802-F1">Fig. 1A</xref>). GenomeFlow also uses the ClusterTAD (<xref rid="bty802-B6" ref-type="bibr">Oluwadare and Cheng, 2017</xref>) algorithm to identify topological associated domains (TADs) of contact matrices which can be visualized on the heat map of the contact matrix (<xref ref-type="fig" rid="bty802-F1">Fig. 1A</xref>).</p>
    </sec>
    <sec>
      <title>2.5 Reconstruction of 3D genome model in real time</title>
      <p>GenomeFlow implements two 3D genome reconstruction algorithms [LorDG (<xref rid="bty802-B11" ref-type="bibr">Trieu and Cheng, 2016</xref>) and 3DMax (<xref rid="bty802-B7" ref-type="bibr">Oluwadare <italic>et al.</italic>, 2018</xref>)] to reconstruct 3D genome models from contact matrices. Both functions have a user-friendly graphical user interface (GUI) and visualize how models are being reconstructed in real time (<xref ref-type="fig" rid="bty802-F1">Fig. 1B</xref>). The input of the function is a contact matrix in sparse matrix format. The output 3D models are stored in the GSS format files (<xref rid="bty802-B5" ref-type="bibr">Nowotny <italic>et al.</italic>, 2016</xref>) that contain both <italic>x</italic>, <italic>y</italic>, <italic>z</italic> coordinates and genomic locations of loci, chromosome number and genome version. Compared to the protein data bank (PDB) format for protein structures, the GSS format can store much larger structures of a chromosome or genome in high resolution and can include extra genomic information needed for function analysis.</p>
    </sec>
    <sec>
      <title>2.6 Loop identification in 3D genome models</title>
      <p>GenomeFlow provides a function to identify pairs of loci that are very close in 3D space. A pair of loci are considered to be endpoints of chromatin loops if their distance is significantly smaller than loci pairs of the same genomic distance (see details in the supplemental document). This function highlights chromatin loops in 3D genome models (<xref ref-type="fig" rid="bty802-F1">Fig. 1C</xref><bold>)</bold>.</p>
    </sec>
    <sec>
      <title>2.7 Annotation of 3D models</title>
      <p>GenomeFlow has a function to annotate 3D models by displaying genome annotation tracks in the BED format in the 3D space. Multiple annotations can be displayed in contrasting colors. The function also allows users to visualize genes, enhancers, variants, methylation and other information such as gene expression data on top of 3D genome/chromosome models. This function facilitates the study of the relationship between 3D genome organization and the function (<xref ref-type="fig" rid="bty802-F1">Fig. 1D</xref><bold>)</bold>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>We introduced a comprehensive software tool for processing Hi-C data and reconstructing and analyzing 3D genome models. It provides a user-friendly GUI to carry out many steps of analysis and modeling of 3D genome conformation. Users without prior knowledge of the 3D genome can use the tool to build and analyze a 3D genome in their research and work.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty802_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bty802-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Durand</surname><given-names>N.C.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>95</fpage>–<lpage>98</lpage>.<pub-id pub-id-type="pmid">27467249</pub-id></mixed-citation>
    </ref>
    <ref id="bty802-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Imakaev</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>999</fpage>–<lpage>1003</lpage>.<pub-id pub-id-type="pmid">22941365</pub-id></mixed-citation>
    </ref>
    <ref id="bty802-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Langmead</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>357.</fpage><pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="bty802-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lieberman-Aiden</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source>, <volume>326</volume>, <fpage>289</fpage>–<lpage>293</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="bty802-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nowotny</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>GMOL: an interactive tool for 3D genome structure visualization</article-title>. <source>Sci. Rep</source>., <volume>6</volume>.</mixed-citation>
    </ref>
    <ref id="bty802-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Oluwadare</surname><given-names>O.</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>J.</given-names></name></person-group> (<year>2017</year>) 
<article-title>ClusterTAD: an unsupervised machine learning approach to detecting topologically associated domains of chromosomes from Hi-C data</article-title>. <source>BMC Bioinformatics</source>, <volume>18</volume>, <fpage>480.</fpage><pub-id pub-id-type="pmid">29137603</pub-id></mixed-citation>
    </ref>
    <ref id="bty802-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Oluwadare</surname><given-names>O.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>A maximum likelihood algorithm for reconstructing 3D structures of human chromosomes from chromosomal contact data</article-title>. <source>BMC Genomics</source>, <volume>19</volume>, <fpage>161.</fpage><pub-id pub-id-type="pmid">29471801</pub-id></mixed-citation>
    </ref>
    <ref id="bty802-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rao</surname><given-names>S.S.P.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>. <source>Cell</source>, <volume>159</volume>, <fpage>1665</fpage>–<lpage>1680</lpage>.<pub-id pub-id-type="pmid">25497547</pub-id></mixed-citation>
    </ref>
    <ref id="bty802-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Segal</surname><given-names>M.R.</given-names></name>, <name name-style="western"><surname>Bengtsson</surname><given-names>H.L.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Reconstruction of 3D genome architecture via a two-stage algorithm</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>, <fpage>373.</fpage><pub-id pub-id-type="pmid">26553003</pub-id></mixed-citation>
    </ref>
    <ref id="bty802-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Serra</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Restraint-based three-dimensional modeling of genomes and genomic domains</article-title>. <source>FEBS Lett</source>., <volume>589</volume>, <fpage>2987</fpage>–<lpage>2995</lpage>.<pub-id pub-id-type="pmid">25980604</pub-id></mixed-citation>
    </ref>
    <ref id="bty802-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Trieu</surname><given-names>T.</given-names></name>, <name name-style="western"><surname>Cheng</surname><given-names>J.</given-names></name></person-group> (<year>2016</year>) 
<article-title>3D genome structure modeling by Lorentzian objective function</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>1049</fpage>–<lpage>1058</lpage>.</mixed-citation>
    </ref>
    <ref id="bty802-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Varoquaux</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A statistical approach for inferring the 3D structure of the genome</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>i26</fpage>–<lpage>i33</lpage>.<pub-id pub-id-type="pmid">24931992</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
