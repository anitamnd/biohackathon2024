<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860609</article-id>
    <article-id pub-id-type="pmid">29028961</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx631</article-id>
    <article-id pub-id-type="publisher-id">btx631</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Towards unified quality verification of synthetic count data with <italic>countsimQC</italic></article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Soneson</surname>
          <given-names>Charlotte</given-names>
        </name>
        <xref ref-type="aff" rid="btx631-aff1">1</xref>
        <xref ref-type="aff" rid="btx631-aff2">2</xref>
        <xref ref-type="corresp" rid="btx631-cor1"/>
        <!--<email>charlotte.soneson@uzh.ch</email>-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-3048-5518</contrib-id>
        <name>
          <surname>Robinson</surname>
          <given-names>Mark D</given-names>
        </name>
        <xref ref-type="aff" rid="btx631-aff1">1</xref>
        <xref ref-type="aff" rid="btx631-aff2">2</xref>
        <xref ref-type="corresp" rid="btx631-cor1"/>
        <!--<email>mark.robinson@imls.uzh.ch</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Bar-Joseph</surname>
          <given-names>Ziv</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx631-aff1"><label>1</label>Institute of Molecular Life Sciences, University of Zurich, Zurich, Switzerland</aff>
    <aff id="btx631-aff2"><label>2</label>SIB Swiss Institute of Bioinformatics, Zurich, Switzerland</aff>
    <author-notes>
      <corresp id="btx631-cor1">To whom correspondence should be addressed. Email: <email>charlotte.soneson@uzh.ch</email> or <email>mark.robinson@imls.uzh.ch</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-10-04">
      <day>04</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>4</issue>
    <fpage>691</fpage>
    <lpage>692</lpage>
    <history>
      <date date-type="received">
        <day>07</day>
        <month>6</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>9</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>10</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx631.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Statistical tools for biological data analysis are often evaluated using synthetic data, designed to mimic the features of a specific type of experimental data. The generalizability of such evaluations depends on how well the synthetic data reproduce the main characteristics of the experimental data, and we argue that an assessment of this similarity should accompany any synthetic dataset used for method evaluation. We describe <italic>countsimQC</italic>, which provides a straightforward way to generate a stand-alone report that shows the main characteristics of (e.g. RNA-seq) count data and can be provided alongside a publication as verification of the appropriateness of any utilized synthetic data.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p><italic>countsimQC</italic> is implemented as an R package (for R versions ≥ 3.4) and is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/csoneson/countsimQC">https://github.com/csoneson/countsimQC</ext-link> under a GPL (≥2) license.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The analysis of biological data, for example those coming from high-throughput sequencing applications, is often highly dependent on sophisticated statistical tools and algorithms. Each such tool aims to extract a specific type of biologically relevant information from data, and its ability to perform the intended task is usually evaluated at the time of publication. Although the ultimate aim is to develop methods that give accurate results for real, experimental data, this is often difficult to assess in practice due to the lack of an independently validated ground truth. Thus, most statistical data analysis tools are (at least partly) evaluated on <italic>synthetic</italic> data, obtained either via parametric simulation or via sampling from experimental data. The synthetic data are assumed to share important characteristics with experimental data, but the signal of interest as well as other, potentially confounding, signals are completely controlled in the data generation. In such cases, the usefulness of any performance evaluation ultimately comes down to how realistic the synthetic data are. Thus, we argue that any evaluation relying on synthetic datasets should take care to verify that these reflect the most important characteristics of the data type of interest. Currently, many studies whose conclusions crucially depend on synthetic data do not provide extensive evidence of such similarity. We hypothesize that one reason for this is a lack of general guidelines regarding the set of aspects that should be investigated, as well as a straightforward way to easily generate a quality evaluation report for synthetic data, which exists for other aspects of high-throughput sequencing data analysis [e.g. FastQC (<ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/">http://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>), MultiQC (<xref rid="btx631-B1" ref-type="bibr">Ewels <italic>et al.</italic>, 2016</xref>)].</p>
    <p>To fill this gap, we developed <italic>countsimQC</italic>, an R package that allows the user to quickly explore and compare a variety of characteristics across one or more count datasets and generate a summary report for evaluation and dissemination. For example, a user can visualize the characteristics of a synthetic dataset (e.g. a simulated RNA-seq count matrix) side by side with those of an experimental dataset of the type that it is intended to mimic. However, the package is not limited to such comparisons, and can be used to summarize and compare the properties of any collection of one or more count datasets.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>To run <italic>countsimQC</italic>, the user provides a count matrix and information about the experimental design for each dataset. The software then calculates a set of characteristics for each dataset and generates a stand-alone pdf or html report, which can be used to assess the properties of, and similarities between, the provided datasets. The evaluation criteria have been specifically selected to cover a broad range of important aspects of RNA-seq data and include the mean-dispersion relationship, library size distribution, expression distribution, and the fraction of zero counts per gene and sample as well as the relationship between these and a gene’s expression level or the total number of reads in a sample. The latter type of evaluation criteria is particularly useful for single-cell RNA-seq applications and other types of sparse count data. In addition to the graphical output, the <italic>countsimQC</italic> reports also contain a range of quantitative evaluation criteria comparing the distributions of the calculated statistics between datasets. The package is modular, and new evaluation criteria can easily be added by the user if desired. Moreover, the principles of <italic>countsimQC</italic> are not limited to count data, and given suitable quality assessment criteria the package can easily be extended to generate reports appropriate also for other data types.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>To illustrate the output generated by <italic>countsimQC</italic>, we use two recently published R packages [the ’splat’ framework from splatter (v1.0.2) (<xref rid="btx631-B7" ref-type="bibr">Zappia <italic>et al.</italic>, 2017</xref>) and powsim (v1.0.1) (<xref rid="btx631-B6" ref-type="bibr">Vieth <italic>et al.</italic>, 2017</xref>)] to generate synthetic single-cell RNA-seq count matrices from an underlying, experimentally obtained count matrix [GSE48968-GPL13112 (<xref rid="btx631-B3" ref-type="bibr">Shalek <italic>et al.</italic>, 2014</xref>)], downloaded from the conquer repository [<ext-link ext-link-type="uri" xlink:href="http://imlspenticton.uzh.ch:3838/conquer/">http://imlspenticton.uzh.ch:3838/conquer/</ext-link> (<xref rid="btx631-B5" ref-type="bibr">Soneson and Robinson, 2017</xref>)]. <xref ref-type="fig" rid="btx631-F1">Figure 1</xref> shows a subset of the figures that are included in the <italic>countsimQC</italic> report. From these plots, it is clear that a single evaluation criterion is not enough to fully capture the degree of similarity between datasets, and that the simulation that is most similar to the underlying real data in one aspect can be far from it when another criterion is considered. Thus, having a comprehensive report illustrating the level of similarity from different aspects is useful not only for the synthetic data generator but also for the reader interested in judging the degree of generalizability of conclusions based on the synthetic data. The full report of the comparison summarized in <xref ref-type="fig" rid="btx631-F1">Figure 1</xref>, as well as additional example reports for various types of real and synthetic count datasets can be accessed from <ext-link ext-link-type="uri" xlink:href="https://github.com/csoneson/countsimQC">https://github.com/csoneson/countsimQC</ext-link>.
</p>
    <fig id="btx631-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>Example illustrations from a <italic>countsimQC</italic> report, comparing characteristics of three datasets: one real single-cell RNA-seq dataset (Original) and two datasets simulated using the real dataset as the underlying source of population parameters (powsim, splat). (<bold>A</bold>) BCV (biological coefficient of variation) as a function of average expression level, both calculated by edgeR (<xref rid="btx631-B2" ref-type="bibr">Robinson <italic>et al.</italic>, 2010</xref>). (<bold>B</bold>) Distribution of library sizes (total count sum) across all cells. (<bold>C</bold>) Distribution of average expression levels (log count per million, as calculated by edgeR) across all genes. (<bold>D</bold>) Distribution of the fraction of zeros across all genes. (<bold>E</bold>) Relationship between the average expression level (log count per million) and the fraction of zeros for all genes</p>
      </caption>
      <graphic xlink:href="btx631f1"/>
    </fig>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>With the <italic>countsimQC</italic> package, we wish to spark a discussion about the importance of evaluating the suitability of synthetic data. We encourage researchers who use synthetic data to draw conclusions to provide a report, such as that generated by <italic>countsimQC</italic>, as evidence that the synthetic data mimic real data, since this is not always easy to assess from a text description of a simulation model. We note that it is not the first effort in this direction; the compcodeR package (<xref rid="btx631-B4" ref-type="bibr">Soneson, 2014</xref>) as well as powsim (<xref rid="btx631-B6" ref-type="bibr">Vieth <italic>et al.</italic>, 2017</xref>) contain functions for summarizing the characteristics of a single dataset, and the splatter package (<xref rid="btx631-B7" ref-type="bibr">Zappia <italic>et al.</italic>, 2017</xref>) also provides the opportunity to generate figures comparing various aspects of a collection of single-cell RNA-seq datasets. However, to our knowledge it is the first independent, ‘one-stop’ solution to generate an extensive, publishable report comparing multiple count datasets, optionally including the code that was used to generate the plots.</p>
    <p>There are of course situations where a high degree of similarity between the synthetic data and real data is less critical. For example, synthetic data are often used to illustrate the ability of algorithms and tools to correctly estimate hyperparameters of underlying data distributions, or to illustrate the influence of changing particular features of a dataset, possibly out of the realistic range, for better understanding of the advantages, disadvantages and sensitivities of the methodology. However, even in such situations we argue that it can be useful, both for the analyst and for the reader, to understand the characteristics of the generated data and how it compares to what would be seen in practice.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Forschungskredit of the University of Zurich [grant no. FK-16-107 to C.S.].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx631-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ewels</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>MultiQC: summarize analysis results for multiple tools and samples in a single report</article-title>. <source>Bioinformatics</source>, <fpage>btw354</fpage>.</mixed-citation>
    </ref>
    <ref id="btx631-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>edger: a bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btx631-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shalek</surname><given-names>A.K.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Single-cell RNA-seq reveals dynamic paracrine control of cellular variation</article-title>. <source>Nature</source>, <volume>509</volume>, <fpage>363</fpage>–<lpage>369</lpage>.</mixed-citation>
    </ref>
    <ref id="btx631-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Soneson</surname><given-names>C.</given-names></name></person-group> (<year>2014</year>) 
<article-title>compcoder – an R package for benchmarking differential expression methods for RNA-seq data</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2517</fpage>–<lpage>2518</lpage>.<pub-id pub-id-type="pmid">24813215</pub-id></mixed-citation>
    </ref>
    <ref id="btx631-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Soneson</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name></person-group> (<year>2017</year>) Bias, robustness and scalability in differential expression analysis of single-cell RNA-Seq data. <italic>bioRxiv</italic>, doi:10.1101/143289.</mixed-citation>
    </ref>
    <ref id="btx631-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Vieth</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) powsim: power analysis for bulk and single cell RNA-seq experiments. <italic>bioRxiv</italic>, doi:10.1101/117150.</mixed-citation>
    </ref>
    <ref id="btx631-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zappia</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>174</fpage>.<pub-id pub-id-type="pmid">28899397</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
