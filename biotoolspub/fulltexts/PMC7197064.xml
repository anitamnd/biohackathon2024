<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?covid-19-tdm?>
<?noissn?>
<front>
  <journal-meta>
    <journal-id journal-id-type="publisher-id">978-3-030-42266-0</journal-id>
    <journal-id journal-id-type="doi">10.1007/978-3-030-42266-0</journal-id>
    <journal-id journal-id-type="nlm-ta">Algorithms for Computational Biology</journal-id>
    <journal-title-group>
      <journal-title>Algorithms for Computational Biology</journal-title>
      <journal-subtitle>7th International Conference, AlCoB 2020, Missoula, MT, USA, April 13–15, 2020, Proceedings</journal-subtitle>
    </journal-title-group>
    <isbn publication-format="print">978-3-030-42265-3</isbn>
    <isbn publication-format="electronic">978-3-030-42266-0</isbn>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7197064</article-id>
    <article-id pub-id-type="publisher-id">15</article-id>
    <article-id pub-id-type="doi">10.1007/978-3-030-42266-0_15</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BOAssembler: A Bayesian Optimization Framework to Improve RNA-Seq Assembly Performance</article-title>
    </title-group>
    <contrib-group content-type="book editors">
      <contrib contrib-type="editor">
        <name>
          <surname>Martín-Vide</surname>
          <given-names>Carlos</given-names>
        </name>
        <address>
          <email>carlos.martin@urv.cat</email>
        </address>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="editor">
        <name>
          <surname>Vega-Rodríguez</surname>
          <given-names>Miguel A.</given-names>
        </name>
        <address>
          <email>mavega@unex.es</email>
        </address>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="editor">
        <name>
          <surname>Wheeler</surname>
          <given-names>Travis</given-names>
        </name>
        <address>
          <email>travis.wheeler@umontana.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff10">10</xref>
      </contrib>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.410367.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 2284 9230</institution-id><institution>Rovira i Virgili University, </institution></institution-wrap>Tarragona, Spain </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="GRID">grid.8393.1</institution-id><institution-id institution-id-type="ISNI">0000000119412521</institution-id><institution>University of Extremadura, </institution></institution-wrap>Cáceres, Spain </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="GRID">grid.253613.0</institution-id><institution-id institution-id-type="ISNI">0000 0001 2192 5772</institution-id><institution>University of Montana, </institution></institution-wrap>Missoula, MT USA </aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8203-0507</contrib-id>
        <name>
          <surname>Mao</surname>
          <given-names>Shunfu</given-names>
        </name>
        <address>
          <email>shunfu@uw.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff11"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1399-7909</contrib-id>
        <name>
          <surname>Jiang</surname>
          <given-names>Yihan</given-names>
        </name>
        <address>
          <email>yij021@uw.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff11"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5307-6645</contrib-id>
        <name>
          <surname>Mathew</surname>
          <given-names>Edwin Basil</given-names>
        </name>
        <address>
          <email>edwin100@uw.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff11"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kannan</surname>
          <given-names>Sreeram</given-names>
        </name>
        <address>
          <email>ksreeram@uw.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff11"/>
      </contrib>
      <aff id="Aff11"><institution-wrap><institution-id institution-id-type="GRID">grid.34477.33</institution-id><institution-id institution-id-type="ISNI">0000000122986657</institution-id><institution>University of Washington, </institution></institution-wrap>Seattle, WA 98195 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>01</day>
      <month>02</month>
      <year>2020</year>
    </pub-date>
    <volume>12099</volume>
    <fpage>188</fpage>
    <lpage>197</lpage>
    <permissions>
      <copyright-statement>© Springer Nature Switzerland AG 2020</copyright-statement>
      <license>
        <license-p>This article is made available via the PMC Open Access Subset for unrestricted research re-use and secondary analysis in any form or by any means with acknowledgement of the original source. These permissions are granted for the duration of the World Health Organization (WHO) declaration of COVID-19 as a global pandemic.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">High throughput sequencing of RNA (RNA-Seq) can provide us with millions of short fragments of RNA transcripts from a sample. How to better recover the original RNA transcripts from those fragments (RNA-Seq assembly) is still a difficult task. For example, RNA-Seq assembly tools typically require hyper-parameter tuning to achieve good performance for particular datasets. This kind of tuning is usually unintuitive and time-consuming. Consequently, users often resort to default parameters, which do not guarantee consistent good performance for various datasets.</p>
      <p id="Par2"><bold>Results:</bold> Here we propose BOAssembler, a framework that enables end-to-end automatic tuning of RNA-Seq assemblers, based on Bayesian Optimization principles. Experiments show this data-driven approach is effective to improve the overall assembly performance. The approach would be helpful for downstream (e.g. gene, protein, cell) analysis, and more broadly, for future bioinformatics benchmark studies.</p>
      <p id="Par3"><bold>Availability:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/shunfumao/boassembler">https://github.com/shunfumao/boassembler</ext-link>.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>RNA-Seq</kwd>
      <kwd>Assembly</kwd>
      <kwd>Bayesian Optimization</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Switzerland AG 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par4">Sequence assembly is a process to recover the original genomic sequences from their sampled reads. Based on sequence type (DNA/RNA) and the availability of reference genome, there are different assembly problems. In this study, we focus on reference-based RNA-Seq assembly, which is a critical step to understand gene, protein and cell functions.</p>
    <p id="Par5">Existing popular reference-based RNA-Seq assemblers include Cufflinks [<xref ref-type="bibr" rid="CR3">3</xref>] and Stringtie [<xref ref-type="bibr" rid="CR2">2</xref>]. They usually align reads onto reference genome first, and utilize the read alignments to build a graph where each node represents a genome region (exon) and each edge represents the connection between two nodes by some reads. They then traverse the graph to find paths as the reconstructed RNA transcripts.</p>
    <p id="Par6">These assembly problems are essentially NP-hard [<xref ref-type="bibr" rid="CR7">7</xref>] and existing tools resort to heuristic methods. For example, from the graph, Stringtie will extract the heaviest paths iteratively. Due to the heuristic approaches, these methods usually require parameter tuning to achieve good performance for particular datasets. Since most users may not understand the meaning of the parameters well and tuning itself is tedious and time-consuming, they usually end up with default settings. An automatic tuning framework, therefore, is necessary.</p>
    <p id="Par7">In machine learning (ML), Bayesian Optimization (BO) is gaining a surge of interest as its usefulness in tuning hyper-parameters for modern deep learning systems [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. BO is favorable for optimizing objective functions that are expensive to evaluate and are over continuous domains of less than 20 dimensions [<xref ref-type="bibr" rid="CR12">12</xref>]. BO has been widely used in most deep learning systems such as Natural Language Processing (NLP) [<xref ref-type="bibr" rid="CR13">13</xref>], Reinforcement Learning (RL) [<xref ref-type="bibr" rid="CR14">14</xref>], and Channel Coding [<xref ref-type="bibr" rid="CR15">15</xref>]. Depending on algorithms and programming languages, several popular BO packages have been developed, such as GPyOpt [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    <p id="Par8">There are limited work to introduce BO into computational biology fields. Recently [<xref ref-type="bibr" rid="CR17">17</xref>] applies BO to improve eQTL analysis. To the best of our knowledge, no work has introduced BO to assembly tasks yet, which are fundamentally graph problems with their own unique challenges. To fill this gap, we have developed BOAssembler, which is a framework able to incorporate existing assemblers (such as Stringtie) and BO methods (such as GPyOpt) to assist assembler developers and biologists to spend minimal efforts to obtain better assembly hyper-parameters automatically fine-tuned for particular datasets.</p>
    <p id="Par9">Our contributions include: (a) We firstly explore the BO methods in (reference-based RNA-Seq) assembly tasks. (b) Our designed experiments show that BO is overall effective to improve assembly. (c) An open source end-to-end framework (BOAssembler) is provided for the assembly community to use.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Assembly</title>
      <p id="Par10">There are two kinds of RNA-Seq assembly problems: de novo assembly and reference-based assembly. For de novo assembly, we only have RNA-Seq reads, which is common in non-model organisms. For reference-based assembly, there is additional knowledge on the genome of the organism. De novo assembly is apparently more challenging and typical tools (such as Trinity [<xref ref-type="bibr" rid="CR4">4</xref>] and recently Shannon [<xref ref-type="bibr" rid="CR5">5</xref>]) require much more computational resources and more complicated evaluations. As the first step to bridge assembly and BO, we focus on reference-based RNA-Seq assembler. In particular, we focus on the widely used Stringtie, as recommended in [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
      <p id="Par11">A typical reference-based RNA-Seq assembly includes aligning sampled RNA-Seq reads onto a reference genome using external tools such as STAR [<xref ref-type="bibr" rid="CR1">1</xref>] etc. For Stringtie, a (splice) graph will be prepared where each node represents a unique exonic region supported by aligned reads and edges indicate how nodes are bridged by reads. Graph traversal algorithms will be applied to find paths as transcripts to best explain the constraints from graph nodes and edges.</p>
      <p id="Par12">Since assembly problems are NP hard [<xref ref-type="bibr" rid="CR7">7</xref>], existing algorithms take a lot of heuristics (predefined threshold values). Therefore, assembler performance heavily depends on its parameters. For example in Stringtie, the parameter ‘-f’ sets a fractional threshold so that the predicted transcripts having a lower relative abundance level than this will be discarded; a reduced ‘-f’ threshold therefore encourages transcripts to be retained to improve sensitivity.</p>
      <p id="Par13">Developers of assemblers typically tune parameters by intuition on a few datasets, and offer selected parameters for assembler users to use. As the assembly performance for various datasets are usually parameter dependent, a more systematic method of tuning parameter is needed. Naive approaches would include grid search or random search. However, because typical assembly parameters are continuous, and of around 10 to 20 dimensions, which could make grid search on all possible combinations prohibitive. Random search [<xref ref-type="bibr" rid="CR9">9</xref>], on the other hand, are expensive to guarantee good coverage.</p>
    </sec>
    <sec id="Sec4">
      <title>Bayesian Optimization</title>
      <p id="Par14">BO aims at maximizing a real-value black-box function <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(\theta )$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq1.gif"/></alternatives></inline-formula> with respect to <inline-formula id="IEq2"><alternatives><tex-math id="M2">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq2.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR8">8</xref>] in a gradient-free approach. BO consists of a statistical surrogate objective function to model the input-output relationship between <inline-formula id="IEq3"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M4">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(\theta )$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq4.gif"/></alternatives></inline-formula>, and an acquisition function to decide what to sample next. Firstly BO evaluates randomly chosen <italic>K</italic> datapoints of <inline-formula id="IEq5"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq5.gif"/></alternatives></inline-formula>, and fits the prior statistical objective model. Then BO iteratively updates the posterior model with newly acquired <inline-formula id="IEq6"><alternatives><tex-math id="M6">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(\theta _k)$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq6.gif"/></alternatives></inline-formula>, and selects <inline-formula id="IEq7"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{k+1}$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq7.gif"/></alternatives></inline-formula> to evaluate according to posterior. BO is a systematic approach to explore the parameter space according to a Bayesian model with limited allowed evaluations (i.e. iterations).</p>
      <p id="Par15">Our BOAssembler primarily uses Gaussian Process (GP) with Matern Kernel [<xref ref-type="bibr" rid="CR11">11</xref>] as a natural model for statistical objective function, and Expected Improvement (EI) as a commonly used acquisition function. Specifically, assume we want to sample a new datapoint <inline-formula id="IEq8"><alternatives><tex-math id="M8">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq8.gif"/></alternatives></inline-formula>, and our current best parameter is <inline-formula id="IEq9"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta ^*$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq9.gif"/></alternatives></inline-formula>. Then the improvement is defined as <inline-formula id="IEq10"><alternatives><tex-math id="M10">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[f(\theta ) - f(\theta ^*)]^{+}$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq10.gif"/></alternatives></inline-formula>. Note that the improvement is positive only when <inline-formula id="IEq11"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(\theta )$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq11.gif"/></alternatives></inline-formula> is larger than <inline-formula id="IEq12"><alternatives><tex-math id="M12">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(\theta ^*)$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq12.gif"/></alternatives></inline-formula>. Then the expected improvement can be taken under posterior distributions of <italic>f</italic> given <inline-formula id="IEq13"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{1:k}$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq13.gif"/></alternatives></inline-formula>:<disp-formula id="Equ1"><label>1</label><graphic xlink:href="495634_1_En_15_Equ1_HTML.gif" position="anchor"/></disp-formula>As the expected improvement can be computed in closed-form, we can select the point with largest expected improvement to sample: <inline-formula id="IEq14"><alternatives><tex-math id="M14">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{k+1} = \mathrm {arg\,max} EI_{k}(\theta )$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq14.gif"/></alternatives></inline-formula>.</p>
      <p id="Par16">The procedure of iterative update, based on GP and EI, is described in Algorithm 1, which includes <italic>K</italic> datapoints for BO initialization, and <italic>T</italic> iterations to acquire.<graphic position="anchor" xlink:href="495634_1_En_15_Figa_HTML" id="MO2"/>
</p>
    </sec>
    <sec id="Sec5">
      <title>Combine BO and Assembly</title>
      <p id="Par17"><bold>The Motivation to Combine.</bold> We can formulate the problem of assembly parameter tuning as follows. The reference-based assembler together with its performance evaluation can be represented as an abstract function <inline-formula id="IEq15"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(D, \theta )$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq15.gif"/></alternatives></inline-formula>, where <italic>D</italic> includes both the read alignments used for assembly and the reference transcriptome (a set of ground truth RNA transcripts) used for evaluation, and <inline-formula id="IEq16"><alternatives><tex-math id="M16">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq16.gif"/></alternatives></inline-formula> refers to the parameters of <italic>f</italic>. After read alignments are assembled with given parameter <inline-formula id="IEq17"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq17.gif"/></alternatives></inline-formula>, the assembly output (a set of RNA transcripts) will be compared with the reference transcriptome, and the quality of assembly is measured by scalar metrics such as precision <italic>p</italic> and sensitivity <italic>s</italic>. <inline-formula id="IEq18"><alternatives><tex-math id="M18">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(D, \theta )$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq18.gif"/></alternatives></inline-formula> outputs an evaluation score based on <italic>p</italic> and <italic>s</italic>. Our goal is to find a global optimal <inline-formula id="IEq19"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq19.gif"/></alternatives></inline-formula> which maximizes <inline-formula id="IEq20"><alternatives><tex-math id="M20">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(D, \theta )$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq20.gif"/></alternatives></inline-formula> under limited number of iterations, as running assembler per iteration is time consuming.</p>
      <p id="Par18">Bayesian optimization works well for black-box gradient-free global optimization with moderate dimensionality. It is thus favorable to apply BO to optimize assembler parameters due to the following reasons: (a) Empirically BO works well for parameters with moderate dimensionality (less than 20). This is consistent with assemblers which typically have this number of parameters. (b) <italic>f</italic>(.) is continuous, and the parameter <inline-formula id="IEq21"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq21.gif"/></alternatives></inline-formula> are correlated, and has well-defined feasible set. The assembler parameters usually have continuous values within certain ranges. (c) The function <italic>f</italic>(.) is expensive to evaluate, thus to evaluate all possible combinations of parameters is prohibitive. Indeed, assembly tasks are time consuming. (d) <italic>f</italic>(.) is a ‘black-box’, while gradient-based optimization methods cannot be applied. Assemblers typically do not have a gradient due to the usage of thresholds, which makes black-box method favorable.</p>
      <p id="Par19"><bold>The Architecture.</bold> Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates the overall architecture of BOAssembler. There are two parts: the assembly part (e.g. <inline-formula id="IEq22"><alternatives><tex-math id="M22">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(D, \theta )$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq22.gif"/></alternatives></inline-formula>) and BO part.<fig id="Fig1"><label>Fig. 1.</label><caption><p>BOAssembler architecture.</p></caption><graphic xlink:href="495634_1_En_15_Fig1_HTML" id="MO3"/></fig>
</p>
      <p id="Par20">The assembly part wraps up the RNA-Seq reference-based assembler (here Stringtie), which takes fixed read alignments as well as adjustable assembler parameters as input, and outputs assembled RNA transcripts (in gtf format). In addition, the assembly part includes an evaluator block to access the assembly output. Basically, it calls the gffcompare<xref ref-type="fn" rid="Fn1">1</xref> tool, which takes as input the assembly output and reference transcriptome, and outputs sensitivity and precision statistics. The sensitivity is the percentage of reference RNA transcripts that have been correctly recovered, and the precision means the percentage of assembled transcripts that correctly match the reference transcriptome. We further combine the sensitivity and precision (such as F1 score) as <inline-formula id="IEq23"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(D,\theta )$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq23.gif"/></alternatives></inline-formula>, to be used by the BO part. The evaluator may also take adjustable parameters as discussed in Sect. <xref rid="Sec5" ref-type="sec">2.3</xref>.</p>
      <p id="Par22">The BO part has its theory described in Sect. <xref rid="Sec4" ref-type="sec">2.2</xref>. The BO part mainly relies on GPyOpt, which implements the core BO methods (e.g. the GP + EI approach). The BO part treats the assembly part as a black box, where the input to the box is the parameters for assembler and evaluator, and the output of the box is the combined performance metric for the assembler (such as F1 score). The BO part will iteratively optimize the parameters for the black box function (e.g. the assembly part) based on the feedback of performance metric.</p>
      <p id="Par23"><bold>Metrics to Optimize.</bold> The assembly part outputs <inline-formula id="IEq24"><alternatives><tex-math id="M24">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(D,\theta )$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq24.gif"/></alternatives></inline-formula>, which is a metric score and serves as an input to BO part. In particular, it is defined as a weighted F1 score (<inline-formula id="IEq25"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_w=\frac{\lambda p\,\times \,(1\,-\,\lambda )s}{\lambda p\,+\,(1\,-\,\lambda )s}$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq25.gif"/></alternatives></inline-formula>) on top of the evaluator’s output in terms of sensitivity <italic>s</italic> and precision <italic>p</italic> of the assembly. <inline-formula id="IEq26"><alternatives><tex-math id="M26">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda \in (0,0.5)$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq26.gif"/></alternatives></inline-formula> is also BO tunable.</p>
      <p id="Par24">There are several candidate metrics including the mean value (<inline-formula id="IEq27"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_m=\frac{s\,+\,p}{2}$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq27.gif"/></alternatives></inline-formula>) and the F1 score (<inline-formula id="IEq28"><alternatives><tex-math id="M28">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{F1}=\frac{2 s p}{s\,+\,p}$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq28.gif"/></alternatives></inline-formula>). We found the BO part tends to overfit either <italic>s</italic> or <italic>p</italic> towards 1 when using <inline-formula id="IEq29"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_m$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq29.gif"/></alternatives></inline-formula>. Though <inline-formula id="IEq30"><alternatives><tex-math id="M30">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{F1}$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq30.gif"/></alternatives></inline-formula> is able to balance <italic>s</italic> and <italic>p</italic>, we find <inline-formula id="IEq31"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_w$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq31.gif"/></alternatives></inline-formula> is better to improve the final performance of sensitivity and precision. In our experiments, <italic>s</italic> tends to have a lower value range than <italic>p</italic> (due to many reference RNA transcripts do not have enough coverage), we hope to reward more for sensitivity improvement but still have gain on precision. Therefore, we come up with the weighted F1 score <inline-formula id="IEq32"><alternatives><tex-math id="M32">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_w$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq32.gif"/></alternatives></inline-formula>, which uses BO to figure out how much percentage we want to reward especially for the improvement of sensitivity.</p>
      <p id="Par25"><bold>Hyper-parameters.</bold> Our final goal is to find good assembler parameters. To achieve this, we hope to find hyper-parameters (<inline-formula id="IEq33"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq33.gif"/></alternatives></inline-formula>) that achieves high metric score <inline-formula id="IEq34"><alternatives><tex-math id="M34">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_w$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq34.gif"/></alternatives></inline-formula>. <inline-formula id="IEq35"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta $$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq35.gif"/></alternatives></inline-formula> include both assembler parameters and evaluator parameter (<inline-formula id="IEq36"><alternatives><tex-math id="M36">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda $$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq36.gif"/></alternatives></inline-formula>). Each parameter has its name, type, default value and range. For example, Stringtie has a parameter ‘-f’ with type float, default value 0.1 and range (0.0, 1.0)<xref ref-type="fn" rid="Fn2">2</xref>.</p>
      <p id="Par27"><bold>Usage and Extension of BOAssembler.</bold> To tune assembler parameters for a particular dataset in BOAssembler, the user only needs to provide a small sample of read alignments of the target dataset. The sampling can be done by our provided scripts. After some iterations, BOAssembler will report suggested parameters and its tuning history.</p>
      <p id="Par28">BOAssembler currently uses Stringtie as its default assembler. It supports Cufflinks as well. Extension to use other reference-based RNA-Seq assemblers is also straightforward. The user only needs to follow the Stringtie example, to add a line of Python code in a specified Python file, and to add a config file which contains the parameters to be tuned.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Result and Discussion</title>
    <sec id="Sec7">
      <title>Datasets</title>
      <p id="Par29">Our goal is to use BOAssembler to tune assembler’s hyper-parameters on a smaller dataset, and apply recommended hyper-parameters on a large assembly task. Since the smaller dataset has representative data of large assembly task, we expect tuned hyper-parameters can overall improve the large assembly task in terms of sensitivity and precision.</p>
      <p id="Par30">We build our results based on simulated datasets, since real datasets lack ground truth and it is hard to judge if an assembled RNA transcript is a false positive, or a new RNA transcript that has yet to be discovered. Consequently, the evaluator metric <inline-formula id="IEq37"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_w$$\end{document}</tex-math><inline-graphic xlink:href="495634_1_En_15_Chapter_IEq37.gif"/></alternatives></inline-formula> is not feasible for real datasets. The simulated datasets are generated based on real ones in the following steps.</p>
      <p id="Par31">Firstly we prepare three real datasets, including: 132.05M Illumina single end reads (50-bp) sampled from human embryonic stem cells (HESC) (GSE51861, used in [<xref ref-type="bibr" rid="CR18">18</xref>]), 115.36M Illumina pair end reads (101-bp) sampled from Lymphoblastoid cells (LC) (SRP036136, used in [<xref ref-type="bibr" rid="CR19">19</xref>]), and 183.53M Illumina pair end reads (100-bp) sampled from HEK293T (Kidney) cells (SRX541227), previously produced and studied in StringTie [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
      <p id="Par32">Secondly, we use RSEM [<xref ref-type="bibr" rid="CR20">20</xref>] to generate simulated reads from real datasets. To begin with, we choose LC reference transcripts (containing 207266 RNA transcripts) as the ground truth reference transcriptome annotations. We then do quantification of real datasets using RSEM and get learned statistics from real datasets. Based on learned statistics, we use RSEM to sample simulated reads from ground truth reference transcriptome. The simulated HESC has 150M 50-bp single-end reads, the simulated LC dataset has 150M 101-bp pair end reads and the simulated Kidney dataset has 150M 100-bp pair end reads.</p>
      <p id="Par33">Lastly, we use STAR [<xref ref-type="bibr" rid="CR1">1</xref>] (2-pass strategy) to align three simulated datasets onto the human reference genome (hg19)<xref ref-type="fn" rid="Fn3">3</xref>. From each alignment (in bam format), we subsample to get smaller alignment files of chromosome15 as fixed datasets for BOAssembler. The small datasets are about 1.5%, 3.1%, and 2.1% of large datasets for HESC, LC and Kidney respectively. We’ve proposed another more complicated sampling method (available at Github site) across chromosomes, which offers similar performance.</p>
    </sec>
    <sec id="Sec8">
      <title>Experiment Procedure</title>
      <p id="Par35">For each dataset, we run BOAssembler on the smaller datasets. The evaluation for metric also uses a subset (e.g. chromosome 15) of reference transcriptome. Each iteration takes around 1 min, and we typically see convergence of metric score around 40 to 50 iterations. Compared to grid search for possible combinations of 10 to 20 parameters, BOAssembler is much more efficient.</p>
      <p id="Par36">After automatic tuning, BOAssembler will recommend parameters with high metric scores. We then apply these parameters on large datasets, which typically take several hours to finish the assembly tasks using 25 cores of a linux server.</p>
    </sec>
    <sec id="Sec9">
      <title>Experiment Results</title>
      <p id="Par37">Table <xref rid="Tab1" ref-type="table">1</xref> compares the performance of default parameters (Default) and BOAssembler-tuned parameters (Tuned) for each simulated dataset, in terms of sensitivity and precision. We also list their standard F1 score here since it’s related to the metric BOAssembler tries to optimize. But we’ll focus on sensitivity and precision which are of practical interest.<table-wrap id="Tab1"><label>Table 1.</label><caption><p>Performance on different simulated datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Dataset</th><th align="left" colspan="2">Sensitivity (%)</th><th align="left" colspan="2">Precision (%)</th><th align="left" colspan="2">F1</th></tr><tr><th align="left">Default</th><th align="left">Tuned</th><th align="left">Default</th><th align="left">Tuned</th><th align="left">Default</th><th align="left">Tuned</th></tr></thead><tbody><tr><td align="left">HESC (small)</td><td align="left">22.1</td><td align="left">39</td><td align="left">31.9</td><td align="left">59.3</td><td align="left">26.11</td><td align="left">47.05</td></tr><tr><td align="left">HESC (large)</td><td align="left">14.3</td><td align="left">20.8</td><td align="left">54.2</td><td align="left">86.4</td><td align="left">22.63</td><td align="left">33.53</td></tr><tr><td align="left">LC (small)</td><td align="left">25.8</td><td align="left">27</td><td align="left">40</td><td align="left">53.1</td><td align="left">31.37</td><td align="left">35.8</td></tr><tr><td align="left">LC (large)</td><td align="left">15.7</td><td align="left">14.5</td><td align="left">64.3</td><td align="left">74.3</td><td align="left">25.24</td><td align="left">24.26</td></tr><tr><td align="left">Kidney (small)</td><td align="left">20.1</td><td align="left">23.3</td><td align="left">27.9</td><td align="left">33.4</td><td align="left">23.37</td><td align="left">27.45</td></tr><tr><td align="left">Kidney (large)</td><td align="left">14.8</td><td align="left">15.1</td><td align="left">54.1</td><td align="left">54.7</td><td align="left">23.24</td><td align="left">23.67</td></tr></tbody></table></table-wrap>
</p>
      <p id="Par38">As Table <xref rid="Tab1" ref-type="table">1</xref> shows, BOAssembler has improved sensitivity, and precision for all small datasets. In particular, HESC small is improved by 16.9% in sensitivity and 27.4% in precision, LC small is improved by 1.2% in sensitivity and 13.1% in precision, Kidney small is improved by 3.2% in sensitivity and 5.5% in precision. Notice that the real Kidney dataset has been used in Stringtie’s original work, so the default parameters of Stringtie should have been adjusted for this dataset statistics. Still BOAssembler improves the its performance further.</p>
      <p id="Par39">The trend of performance improvement is mostly reflected in assembly tasks on large datasets, which is mostly interesting to us. In particular, HESC large is improved by 6.5% in sensitivity and 32.2% in precision, Kidney large is improved by 0.3% in sensitivity and 0.6% in precision. LC large has a small loss around 1.2% in sensitivity, but it gains 10%, which is significant, in precision. The experiments show that by tuning hyper-parameters through BOAssembler on small datasets, we are able to improve large assembly tasks overall (though there could be fluctuations) to a smaller extent.</p>
      <p id="Par40">The diminished performance gain of tuned parameters on large datasets, compared to the gain on small ones, may be because of an averaging effects across more variant alignment statistics in large datasets. To better catch up large dataset statistics, we have also prepared small datasets selected from certain regions, the performance improvement trend is similar.</p>
      <p id="Par41">By comparing the BOAssembler suggested parameters with assembler’s default ones, we could also gain more insights into the datasets. For example, in HESC small datasets, the parameter ‘f’ is suggested to decrease from 0.1 to 0, this will allow more transcripts of low expression levels to also be considered as assembly output (hereby improve sensitivity). Meanwhile, the parameter ‘m’ is suggested to increase from 200 to 500 to allow only longer (e.g. at least 500) assembled transcripts to be considered (hereby improve precision).</p>
    </sec>
    <sec id="Sec10">
      <title>Discussion</title>
      <p id="Par42">We expect our study and developed BOAssembler will contribute to the assembly community as follows: (a) For bioinformaticians who develop assembly algorithms, the framework or ideas behind it could provide them with more convenient ways to set default parameters for their assemblers. (b) For biologists who use reference-based RNA-Seq assemblers, BOAssembler can help them improve assembly performance, so they can gain better insights into the datasets, and the improved assembled RNA transcripts will be helpful for downstream gene, protein and cell related analysis. (c) For benchmark work of assemblers, typically several datasets are prepared and different assemblers are compared by using their default parameters. BOAssembler or its ideas will help the benchmark work in a fairer basis, since default parameters can not guarantee consistent good performance across various datasets.</p>
      <p id="Par43">Whereas this is, to our best knowledge, the first efforts to bring assembly and BO together, there are several interesting future directions. (a) As from experiments, we have observed that the gain of tuned parameters gets diminished for larger datasets, which implies BO tuned parameter overfits to small training dataset. Since evaluating assembler is expensive, more efficient data subsampling and cross-validation methods to avoid overfitting will be helpful. (b) Another interesting exploration is how to define a metric score that is better than the current weighted F1 score for Bayesian Optimization, to better balance sensitivity and precision. (c) There’re many problems in assembly areas (including variant calling) that heavily relay on hyper-parameter tuning for better performance. Introduce similar frameworks to these problems shall have wide applications.</p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par21"><ext-link ext-link-type="uri" xlink:href="https://ccb.jhu.edu/software/stringtie/gffcompare.shtml">https://ccb.jhu.edu/software/stringtie/gffcompare.shtml</ext-link>.</p>
    </fn>
    <fn id="Fn2">
      <label>2</label>
      <p id="Par26">See <ext-link ext-link-type="uri" xlink:href="http://ccb.jhu.edu/software/stringtie/index.shtml?t=manual">http://ccb.jhu.edu/software/stringtie/index.shtml?t=manual</ext-link> for an example of Stringtie’s parameters.</p>
    </fn>
    <fn id="Fn3">
      <label>3</label>
      <p id="Par34"><ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/goldenpath/hg19/bigZips/">http://hgdownload.cse.ucsc.edu/goldenpath/hg19/bigZips/</ext-link>.</p>
    </fn>
    <fn>
      <p>S. Mao and Y. Jiang—Equal contributors.</p>
    </fn>
  </fn-group>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This project is funded by NIH R01 Award 1R01HG008164 by NHGRI and NSF CCF Award 1703403.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Dobin, A., et al.: STAR: ultrafast universal RNA-seq aligner. Bioinformatics <bold>29</bold>(1), 15–21 (2013). <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bioinformatics/article/29/1/15/272537">https://academic.oup.com/bioinformatics/article/29/1/15/272537</ext-link></mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pertea</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Antonescu</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>T-C</given-names>
          </name>
          <name>
            <surname>Mendell</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>StringTie enables improved reconstruction of a transcriptome from RNA-seq reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>290</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3122</pub-id>
        <pub-id pub-id-type="pmid">25690850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>5</issue>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grabherr</surname>
            <given-names>MG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full-length transcriptome assembly from RNA-seq data without a reference genome</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2011</year>
        <volume>29</volume>
        <issue>7</issue>
        <fpage>644</fpage>
        <lpage>652</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1883</pub-id>
        <pub-id pub-id-type="pmid">21572440</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Kannan, S., Hui, J., Mazooji, K., Pachter, L., Tse, D.: Shannon: an information-optimal de Novo RNA-seq assembler. bioRxiv (2016)</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hayer</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Pizarro</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lahens</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Hogenesch</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>GR</given-names>
          </name>
        </person-group>
        <article-title>Benchmark analysis of algorithms for determining and quantifying full-length mRNA splice forms from RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>3938</fpage>
        <lpage>3945</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv488</pub-id>
        <pub-id pub-id-type="pmid">26338770</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kececioglu</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
        </person-group>
        <article-title>Combinatorial algorithms for DNA sequence assembly</article-title>
        <source>Algorithmica</source>
        <year>1995</year>
        <volume>13</volume>
        <issue>1–2</issue>
        <fpage>7</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01188580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Frazier, P.I.: A tutorial on Bayesian optimization. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1807.02811">arXiv:1807.02811</ext-link>, 8 July 2018</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bergstra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Random search for hyper-parameter optimization</article-title>
        <source>J. Mach. Learn. Res.</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>Feb</issue>
        <fpage>281</fpage>
        <lpage>305</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Snoek, J., et al.: Scalable Bayesian optimization using deep neural networks. In: International Conference on Machine Learning, pp. 2171–2180, 1 June 2015
</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Snoek, J., Larochelle, H., Adams, R.P.: Practical Bayesian optimization of machine learning algorithms. In: Proceedings of the 25th International Conference on Neural Information Processing Systems - Volume 2, NIPS 2012, USA, pp. 2951–2959. Curran Associates Inc. (2012)</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Frazier, P.I.: A tutorial on Bayesian optimization (2018)</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Wang, L., Feng, M., Zhou, B., Xiang, B., Mahadevan, S.: Efficient hyper-parameter optimization for NLP applications. In: Proceedings of the 2015 Conference on Empirical Methods in Natural Language Processing, pp. 2112–2117 (2015)</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Brochu, E., Cora, V.M., De Freitas, N.: A tutorial on Bayesian optimization of expensive cost functions, with application to active user modeling and hierarchical reinforcement learning. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1012.2599">arXiv:1012.2599</ext-link>, 12 December 2010</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Jiang, Y., Kim, H., Asnani, H., Kannan, S., Oh, S., Viswanath, P.: LEARN codes: inventing low-latency codes via recurrent neural networks. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1811.12707">arXiv:1811.12707</ext-link>, 30 November 2018</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">The GPyOpt authors. GPyOpt: A Bayesian optimization framework in python (2016). <ext-link ext-link-type="uri" xlink:href="http://github.com/SheffieldML/GPyOpt">http://github.com/SheffieldML/GPyOpt</ext-link></mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Quitadadmo, A., Johnson, J., Shi, X.: Bayesian hyperparameter optimization for machine learning based eQTL analysis. In: Proceedings of the 8th ACM International Conference on Bioinformatics, Computational Biology, and Health Informatics - ACM-BCB 2017. ACM Press (2017)</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Au</surname>
            <given-names>KF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterization of the human ESC transcriptome by hybrid sequencing</article-title>
        <source>Proc. Natl. Acad. Sci. U.S.A.</source>
        <year>2013</year>
        <volume>110</volume>
        <issue>50</issue>
        <fpage>E4821</fpage>
        <lpage>4830</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1320101110</pub-id>
        <pub-id pub-id-type="pmid">24282307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tilgner</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Grubert</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sharon</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Defining a personal, allele-specific, and single-molecule long-read transcriptome</article-title>
        <source>Proc. Natl. Acad. Sci. U.S.A.</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>27</issue>
        <fpage>9869</fpage>
        <lpage>9874</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1400447111</pub-id>
        <pub-id pub-id-type="pmid">24961374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dewey</surname>
            <given-names>CN</given-names>
          </name>
        </person-group>
        <article-title>RSEM: accurate transcript quantification from RNA-seq data with or without a reference genome</article-title>
        <source>BMC Bioinform.</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>323</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
