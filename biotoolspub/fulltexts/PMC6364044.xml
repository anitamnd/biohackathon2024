<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.5.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art550.dtd?>
<?SourceDTD.Version 5.5.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_GPB318 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEmmc1 docx ?>
<?FILEmmc2 pdf ?>
<?FILEsi1 gif ?>
<?FILEsi2 gif ?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genomics Proteomics Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genomics Proteomics Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Genomics, Proteomics &amp; Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1672-0229</issn>
    <issn pub-type="epub">2210-3244</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6364044</article-id>
    <article-id pub-id-type="publisher-id">S1672-0229(18)30433-9</article-id>
    <article-id pub-id-type="doi">10.1016/j.gpb.2018.06.006</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GITAR: An Open Source Tool for Analysis and Visualization of Hi-C Data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Calandrelli</surname>
          <given-names>Riccardo</given-names>
        </name>
        <email>rcalandrelli@eng.ucsd.edu</email>
        <xref rid="af005" ref-type="aff">1</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
        <xref rid="fn1" ref-type="fn">#</xref>
        <xref rid="fn2" ref-type="fn">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Qiuyang</given-names>
        </name>
        <xref rid="af010" ref-type="aff">2</xref>
        <xref rid="fn1" ref-type="fn">#</xref>
        <xref rid="fn3" ref-type="fn">b</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Guan</surname>
          <given-names>Jihong</given-names>
        </name>
        <xref rid="af010" ref-type="aff">2</xref>
        <xref rid="fn4" ref-type="fn">c</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhong</surname>
          <given-names>Sheng</given-names>
        </name>
        <xref rid="af005" ref-type="aff">1</xref>
        <xref rid="fn5" ref-type="fn">d</xref>
      </contrib>
    </contrib-group>
    <aff id="af005"><label>1</label>Department of Bioengineering, University of California San Diego, La Jolla, CA 92093, USA</aff>
    <aff id="af010"><label>2</label>Department of Computer Science and Technology, Tongji University, Shanghai 200092, China</aff>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding author. <email>rcalandrelli@eng.ucsd.edu</email></corresp>
      <fn id="fn1">
        <label>#</label>
        <p id="np010">Equal contribution.</p>
      </fn>
      <fn id="fn2">
        <label>a</label>
        <p id="np015">ORCID: 0000-0002-4541-6320.</p>
      </fn>
      <fn id="fn3">
        <label>b</label>
        <p id="np020">ORCID: 0000-0002-0879-1236.</p>
      </fn>
      <fn id="fn4">
        <label>c</label>
        <p id="np025">ORCID: 0000-0003-2313-7635.</p>
      </fn>
      <fn id="fn5">
        <label>d</label>
        <p id="np030">ORCID: 0000-0001-6419-7453.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="ppub">
      <month>10</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <volume>16</volume>
    <issue>5</issue>
    <fpage>365</fpage>
    <lpage>372</lpage>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>2</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>20</day>
        <month>5</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>6</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2018 The Authors</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="CC BY" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="ab005">
      <p>Interactions between chromatin segments play a large role in functional genomic assays and developments in genomic interaction detection methods have shown interacting topological domains within the genome. Among these methods, Hi-C plays a key role. Here, we present the Genome Interaction Tools and Resources (GITAR), a software to perform a comprehensive Hi-C data analysis, including data preprocessing, normalization, and visualization, as well as analysis of <bold>topologically-associated domains</bold> (TADs). GITAR is composed of two main modules: (1) HiCtool, a Python library to process and visualize Hi-C data, including TAD analysis; and (2) processed data library, a large collection of human and mouse datasets processed using HiCtool. HiCtool leads the user step-by-step through a <bold>pipeline</bold>, which goes from the raw Hi-C data to the computation, visualization, and optimized storage of intra-chromosomal contact matrices and TAD coordinates. A large collection of standardized processed data allows the users to compare different datasets in a consistent way, while saving time to obtain data for visualization or additional analyses. More importantly, GITAR enables users without any programming or bioinformatic expertise to work with Hi-C data. GITAR is publicly available at <ext-link ext-link-type="uri" xlink:href="http://genomegitar.org" id="ir025">http://genomegitar.org</ext-link> as an open-source software.</p>
    </abstract>
    <kwd-group id="kg005">
      <title>Keywords</title>
      <kwd>Chromatin interaction</kwd>
      <kwd>Pipeline</kwd>
      <kwd>Hi-C data normalization</kwd>
      <kwd>Topologically-associated domain</kwd>
      <kwd>Processed Hi-C data library</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="ms005">Handled by Zhihua Zhang</p>
  </notes>
</front>
<body>
  <sec id="s0005">
    <title>Introduction</title>
    <p id="p0005">Genomes are more than linear sequences, with DNA folded up into elaborate physical structures that allow extreme spatial compactness of the genetic material and play also an important role in epigenetic regulation <xref rid="b0005" ref-type="bibr">[1]</xref>, <xref rid="b0010" ref-type="bibr">[2]</xref>. During the past fifteen years, several techniques have been developed to explore the genome architecture, such as Chromosome Conformation Capture (3C) <xref rid="b0015" ref-type="bibr">[3]</xref>, Circular Chromosome Conformation Capture (4C) <xref rid="b0020" ref-type="bibr">[4]</xref>, Chromosome Conformation Capture Carbon Copy (5C) <xref rid="b0025" ref-type="bibr">[5]</xref>, Hi-C <xref rid="b0030" ref-type="bibr">[6]</xref>, and chromatin interaction analysis by paired-end tag sequencing (ChIA-PET) <xref rid="b0035" ref-type="bibr">[7]</xref>. Among them, Hi-C is one of the most important techniques, allowing for the first time a genome-wide mapping of chromatin interactions. In 2012, Dixon et al. <xref rid="b0040" ref-type="bibr">[8]</xref> exploited Hi-C data to identify local chromosomal interacting domains that they named “topological domains”. These megabase-sized structures appear to be widespread along the genome, conserved between mice and humans, and stable across different cell types <xref rid="b0040" ref-type="bibr">[8]</xref>. Later in 2014, Rao and colleagues generated higher resolution contact maps by performing Hi-C in intact nuclei (<italic>in situ</italic> Hi-C) <xref rid="b0045" ref-type="bibr">[9]</xref>.</p>
    <p id="p0010">Several steps are needed to process Hi-C data. First, raw data are subjected to preprocessing, including read alignment and filtering to remove low-quality mapped reads, PCR duplicates, as well as non-informative pairs. Some strategies could be implemented to improve the mapping outcome, such as pre-truncating reads, iterative mapping, allowing split alignments, and splitting if not mapped as mentioned by Ay and Noble <xref rid="b0050" ref-type="bibr">[10]</xref>. Next, contact matrices are generated. To do so, the linear genome is divided into loci of a definite size, to create the matrix rows and columns. Given that, the entries of the matrix contain the number of contacts observed among each pair of loci. Contact matrices are then normalized to remove major systematic biases introduced during the experiment. These matrices are usually visualized using heatmaps, with pixel intensity proportional to the contact count within each entry.</p>
    <p id="p0015">Currently, there are several published tools to process and analyze Hi-C data (<xref rid="t0005" ref-type="table">Table 1</xref>). While most of the software are focused just on specific parts of the analysis, only few of them present the entire Hi-C data processing pipeline mentioned above. The former usually contain additional features related to the specific parts of analysis, but it is often difficult for the users to provide the input data requested, especially for those who are not very familiar with Hi-C data analysis or programming in general. Instead, a single comprehensive tool would provide all the means needed to carry out the entire analysis, thus helpful in circumventing the difficulty related to data integration. This is particularly valuable, when different tasks are performed by several software and the user needs to figure out which tools to use and if the data are in the specific format required by each of them. A few software are comprehensive and allow for data preprocessing, contact matrix normalization, visualization, and topologically-associated domain (TAD) analysis. In addition, they may include other functions such as annotation of genomic features and chromatin loops over interactions, or interactive Hi-C map visualization. However, input file generation could be left to the user (for example, tracks such as GC content or mappability) and programming skills are often required to exploit the full capabilities of these tools.<table-wrap id="t0005" position="float"><label>Table 1</label><caption><p><bold>Summary of Hi-C data analysis software and related features</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th><bold>Software</bold></th><th><bold>Data preprocessing</bold></th><th><bold>Data normalization</bold></th><th><bold>Data visualization</bold></th><th><bold>TAD analysis</bold></th><th><bold>Processed data library</bold></th><th><bold>Ref.</bold></th></tr></thead><tbody><tr><td>chromoR</td><td/><td>+</td><td/><td/><td/><td><xref rid="b0055" ref-type="bibr">[11]</xref></td></tr><tr><td>diffHiC</td><td>+</td><td>+</td><td>+</td><td>+</td><td/><td><xref rid="b0060" ref-type="bibr">[12]</xref></td></tr><tr><td>HiCapp</td><td>+</td><td>+</td><td/><td/><td/><td><xref rid="b0065" ref-type="bibr">[13]</xref></td></tr><tr><td>HiC-bench</td><td>+</td><td>+</td><td>+</td><td>+</td><td/><td><xref rid="b0070" ref-type="bibr">[14]</xref></td></tr><tr><td>HiCdat</td><td>+</td><td>+</td><td>+</td><td>+</td><td/><td><xref rid="b0075" ref-type="bibr">[15]</xref></td></tr><tr><td>HiC-inspector</td><td>+</td><td/><td>+</td><td/><td/><td/></tr><tr><td>hiclib</td><td>+</td><td>+</td><td>+</td><td/><td/><td><xref rid="b0080" ref-type="bibr">[16]</xref></td></tr><tr><td>HiCNorm</td><td/><td>+</td><td/><td/><td/><td><xref rid="b0085" ref-type="bibr">[17]</xref></td></tr><tr><td>Hi-Corrector</td><td/><td>+</td><td/><td/><td/><td><xref rid="b0090" ref-type="bibr">[18]</xref></td></tr><tr><td>Hicpipe</td><td/><td>+</td><td/><td/><td/><td><xref rid="b0095" ref-type="bibr">[19]</xref></td></tr><tr><td>HiCPlotter</td><td/><td/><td>+</td><td/><td/><td><xref rid="b0100" ref-type="bibr">[20]</xref></td></tr><tr><td>HiC-Pro</td><td>+</td><td>+</td><td/><td/><td/><td><xref rid="b0105" ref-type="bibr">[21]</xref></td></tr><tr><td>HiCseg</td><td/><td/><td/><td>+</td><td/><td><xref rid="b0110" ref-type="bibr">[22]</xref></td></tr><tr><td>HiCUP</td><td>+</td><td/><td/><td/><td/><td><xref rid="b0115" ref-type="bibr">[23]</xref></td></tr><tr><td>HiFive</td><td/><td>+</td><td>+</td><td/><td/><td><xref rid="b0120" ref-type="bibr">[24]</xref></td></tr><tr><td>HiGlass</td><td/><td/><td>+</td><td/><td/><td><xref rid="b0125" ref-type="bibr">[25]</xref></td></tr><tr><td>HIPPIE</td><td>+</td><td/><td/><td/><td/><td><xref rid="b0130" ref-type="bibr">[26]</xref></td></tr><tr><td>HiTC</td><td/><td>+</td><td>+</td><td>+</td><td/><td><xref rid="b0135" ref-type="bibr">[27]</xref></td></tr><tr><td>HOMER</td><td/><td>+</td><td>+</td><td>+</td><td/><td/></tr><tr><td>HubPredictor</td><td/><td/><td/><td>+</td><td/><td><xref rid="b0140" ref-type="bibr">[28]</xref></td></tr><tr><td>Juicer</td><td>+</td><td>+</td><td>+<sup>*</sup></td><td>+</td><td>+</td><td><xref rid="b0145" ref-type="bibr">[29]</xref></td></tr><tr><td>TADbit</td><td>+</td><td>+</td><td>+</td><td>+</td><td/><td><xref rid="b0150" ref-type="bibr">[30]</xref></td></tr><tr><td>TADtree</td><td/><td/><td/><td>+</td><td/><td><xref rid="b0155" ref-type="bibr">[31]</xref></td></tr><tr><td><bold>GITAR</bold></td><td><bold>+</bold></td><td><bold>+</bold></td><td><bold>+</bold></td><td><bold>+</bold></td><td><bold>+</bold></td><td><bold>Current study</bold></td></tr></tbody></table><table-wrap-foot><fn><p><italic>Note</italic>: * indicates that the data visualization in Juicer is provided by the “associated” visualization software Juicebox <xref rid="b0160" ref-type="bibr">[32]</xref>, <xref rid="b0165" ref-type="bibr">[33]</xref>. There are no publications associated with HiC-inspector and HOMER, which can be accessed at <ext-link ext-link-type="uri" xlink:href="https://github.com/HiC-inspector" id="ir005">https://github.com/HiC-inspector</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://homer.ucsd.edu/homer/interactions/" id="ir010">http://homer.ucsd.edu/homer/interactions/</ext-link>, respectively. GITAR is reported in the current study and can be accessed at <ext-link ext-link-type="uri" xlink:href="https://www.genomegitar.org/" id="ir015">https://www.genomegitar.org/</ext-link>. TAD, topologically-associated domain.</p></fn></table-wrap-foot></table-wrap></p>
    <p id="p0020">Here, we present the Genome Interaction Tools and Resources (GITAR), a standardized, easy to use, and flexible solution, to manage Hi-C genomic interaction data, from processing, to storage and visualization. GITAR comprises two modules: HiCtool and the processed data library. All the codes of GITAR are available as open source and the complete pipeline is explicitly provided step-by-step in the documentation. Nothing is left to be programmed by the user, except for parameter tuning to allow full customizability. Therefore, with GITAR, we achieved the goal of building a comprehensive tool, which includes the fundamental steps of the Hi-C data analysis to make it accessible for every type of users, including, for example, experimental biologists or anyone else with no programming or bioinformatic expertise.</p>
  </sec>
  <sec id="s0010">
    <title>Implementation</title>
    <sec id="s0015">
      <title>HiCtool: a standardized pipeline to process and visualize Hi-C data</title>
      <p id="p0025">HiCtool is an open-source bioinformatic tool based on Python, which integrates several software to perform a standardized Hi-C data analysis, from the processing of raw data, to the visualization of intra-chromosomal heatmaps and the identification of TADs. We implemented a pipeline that is divided into three main sections: data preprocessing, data normalization and visualization, and TAD analysis (<xref rid="f0005" ref-type="fig">Figure 1</xref>). HiCtool documentation and code are available at <ext-link ext-link-type="uri" xlink:href="http://doc.genomegitar.org" id="ir030">http://doc.genomegitar.org</ext-link>.<fig id="f0005"><label>Figure 1</label><caption><p><bold>HiCtool workflow</bold></p><p>HiCtool is a pipeline comprising three main sections: data preprocessing, data normalization and visualization (to normalize the contact data and plot heatmaps), and TAD analysis (to calculate the observed DI and “true” DI using HMM, as well as TAD coordinates). TAD, topologically-associated domain; GEO, Gene Expression Omnibus; FEND, fragment end; DI, directionality index; HMM, hidden Markov model; MAPQ, mapping quality.</p></caption><graphic xlink:href="gr1"/></fig></p>
      <p id="p0030">The data preprocessing pipeline takes files downloaded in SRA format and it requires several steps to generate input files for the normalization procedure. To do so, HiCtool integrates Python code, Unix code, and several software including SRA Toolkit, Bowtie 2, SAMtools, and BEDTools. SRA Toolkit is used for downloading the SRA raw data and conversion to fastq format; then Python code is used to pre-truncate the reads that contain potential ligation junctions as a mapping improvement strategy <xref rid="b0050" ref-type="bibr">[10]</xref>. Mapping of the read pairs over the reference genome independently is performed subsequently using Bowtie 2 to avoid any proximity constraint; and finally, unmapped and low-quality mapped reads with map quality (MAPQ) &lt;30 are filtered out and only the paired reads are selected using SAMtools and Unix code. Log files are generated at each step for quality control purpose, including number of truncated reads and length distribution plots after pre-truncation, read alignment ratio before and after filtering, and final pairing statistics. At the end, the pipeline enables the generation of the fragment-end (FEND) file used to normalize the data. The FEND file contains restriction site coordinates and additional information such as GC content and mappability score of FENDs <xref rid="b0095" ref-type="bibr">[19]</xref>. The generation of the FEND file was optimized using parallelized computation to sensibly reduce the time complexity, while we provide the FEND files for human (<italic>hg38</italic>) and mouse (<italic>mm10</italic>) for the most commonly-used restriction enzymes (<italic>Hin</italic>dIII, <italic>Nco</italic>I, <italic>Dpn</italic>II, and <italic>Mbo</italic>I). The outputs of the data preprocessing section include two BAM files corresponding to the first and second reads in the pairs and the FEND file in BED format.</p>
      <p id="p0035">The data normalization and visualization pipeline provides the code to normalize the data and plot the contact heatmaps. The complex experimental Hi-C protocol unavoidably produces several technical biases, which are related to spurious ligation products between fragments, as well as length, GC content, and mappability of the fragments <xref rid="b0095" ref-type="bibr">[19]</xref>. Moreover, it has been observed that transcription start sites (TSSs) and CTCF binding sites influence the frequency of interactions, due to the local chromatin conformation around them <xref rid="b0095" ref-type="bibr">[19]</xref>.</p>
      <p id="p0040">To normalize the data, we use the Python package HiFive <xref rid="b0120" ref-type="bibr">[24]</xref>, which has been demonstrated before to efficiently handle high-resolution data <xref rid="b0120" ref-type="bibr">[24]</xref>. HiFive allows to correct all the aforementioned technical biases, taking also into account of “biological biases” that influence the contact frequency (TSSs and CTCF-bound sites), to not confound technical artifacts with meaningful biological features while calculating correction parameters. Before normalization, PCR duplicates and non-informative reads, likely produced due to incomplete restriction enzyme digestion and fragment circularization, were removed. Moreover, HiFive allows to estimate the distance-dependence signal from the data before normalization, thereby avoiding biases caused by the restriction site distribution. Restriction sites are unevenly distributed in the genome, resulting in different distances between fragments and their neighbors. Since the interaction frequency is strongly inversely-related to the inter-fragment distance, fragments surrounded by shorter ones would show higher nearby interaction values than those with longer adjacent fragments <xref rid="b0120" ref-type="bibr">[24]</xref>. To learn the contact correction parameters associated with fragment features, we use the explicit-factor correction method reported by Yaffe and Tanay <xref rid="b0095" ref-type="bibr">[19]</xref>, and performed by the HiFive binning algorithm, which shows a consistent performance across all binning resolutions <xref rid="b0120" ref-type="bibr">[24]</xref>. Given that the features in the input FEND file are length, GC content, and mappability, the correction values for contact counts calculated from the model are explicitly related to the cross-correlation of these three factors. “Biological biases” associated with TSSs and CTCF binding sites are considered at this step by excluding fragments interacting within a distance of 500 kb from the model.</p>
      <p id="p0045">After learning the correction parameters, we computed two matrices for each chromosome at a specific bin size. The first is an observed intra-chromosomal contact matrix <italic>O</italic>[<italic>i,j</italic>], where each entry represents the observed read count between the regions identified by the bins <italic>i</italic> and <italic>j</italic>. The second is a correction matrix <italic>E</italic>[<italic>i,j</italic>], where each entry contains the sum of corrections for the read pairs between bins <italic>i</italic> and <italic>j</italic>. Then, the normalized contact matrix <italic>N</italic>[<italic>i,j</italic>] is calculated using the formula:<disp-formula id="e0005"><mml:math id="M1" altimg="si1.gif" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mfenced open="[" close="]"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where each entry contains the corrected contact count according to Yaffe and Tanay’s correction model <xref rid="b0095" ref-type="bibr">[19]</xref>. We computed also the “observed over expected” contact matrix, where the expected counts are calculated considering both the learned correction parameters and the linear distance between read pairs. Specifically, the average intrachromosomal contact probability for loci pairs decreases monotonically with the increase in their linear genomic distance <xref rid="b0030" ref-type="bibr">[6]</xref>.</p>
      <p id="p0050">Finally, the pipeline allows to plot the heatmaps, with additional histogram of the data distribution (<xref rid="f0010" ref-type="fig">Figure 2</xref>). The intensity of each pixel in the normalized heatmap is the contact count between the corresponding loci (<xref rid="f0010" ref-type="fig">Figure 2</xref>A). Normalized data can be plotted either using the full range of contact counts or a cut-off, expressed as a percentile or a maximum number of contacts, to highlight local chromatin structures (such as TADs and sub-TADs) over the background. Complete customizability about the appearance of the maps is provided, by allowing to choose among the default colormaps from Matplotlib or generating a colormap from a custom list of colors. Values above the cut-off are plotted with a different color, which is chosen by the user as well. In addition, the resolution of the heatmap in DPI can be set as well. Increasing the resolution of the figures is critical especially for high resolution contact maps (with low bin sizes), allowing to zoom in while maintaining an optimum visual feedback. For the “observed over expected” (O/E) heatmap, the intensity of each pixel represents the log<sub>2</sub> of the O/E contact count, to allow easier interpretation of contact enrichment or depletion (<xref rid="f0010" ref-type="fig">Figure 2</xref>B). For the visualization functionality, only the Python library Matplotlib was used, without integrating any other external software. Heatmaps and histograms are saved in pdf format.<fig id="f0010"><label>Figure 2</label><caption><p><bold>Contact heatmaps for chromosome 6: [50–54] Mb at the 40-kb resolution</bold></p><p><bold>A.</bold> Normalized contact matrix, where each entry contains the corrected contact count. The upper limit of the colormap is the 95th percentile of the contact counts and values above this limit are represented in brown in the heatmap. Using an upper cut-off for the contact counts allows to emphasize local chromatin structures (TADs and sub-TADs) over the background. The histogram displays the normalized contact count distribution. Values on the X axis indicate the number of contacts, while values on the Y axis indicate the frequency of the bins in the contact matrix with the corresponding contact count on the X axis. The number of contacts ranges from 0 to 137. <bold>B.</bold> O/E contact matrix, where each entry contains the log<sub>2</sub> of the O/E contact counts, considering the linear distance between loci and the learned correction parameters. Loci without expected contacts and loci without observed contacts are indicated with black and gray pixels, respectively. The histogram displays the O/E contact count distribution in log<sub>2</sub>-transformed form, ranging from −3.153 to 3.530. O/E, observed over expected.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0055">The TAD analysis section provides the code to calculate the directionality index (DI) and the TAD coordinates <xref rid="b0040" ref-type="bibr">[8]</xref> from the normalized contact data. In order to do so, the observed DI is used to calculate the “true” DI using a hidden Markov model (HMM), implemented with the Python package hmmlearn. Both the observed DI and the “true” DI values can be plotted in the same figure (<xref rid="f0015" ref-type="fig">Figure 3</xref>), making it possible to directly infer the presence of TADs and boundaries over the genomic region examined. TAD coordinates are then calculated using the shifts of the HMM-biased states <xref rid="b0040" ref-type="bibr">[8]</xref>. The entire TAD analysis pipeline is programmed in Python.<fig id="f0015"><label>Figure 3</label><caption><p><bold>TADs for chromosome 6: [50–54] Mb at the 40-kb resolution</bold></p><p><bold>A.</bold> Triangular part of the normalized contact matrix. TADs calculated with GITAR are plotted in blue along the diagonal. <bold>B.</bold> Observed DI values and “true” DI values (HMM-biased states). Positive “true” DI and negative “true” DI refer to downstream and upstream HMM-biased states, respectively. HMM-biased states are plotted to show the correspondence with TAD boundaries (Y axis is not informative in this case). According to the HMM state shifts, six TADs and seven TAD boundaries are present. DI, directionality index.</p></caption><graphic xlink:href="gr3"/></fig></p>
    </sec>
    <sec id="s0020">
      <title>Processed data library</title>
      <p id="p0060">The processed data library is a collection of standardized processed datasets using HiCtool, which is available for the public at <ext-link ext-link-type="uri" xlink:href="http://data.genomegitar.org" id="ir035">http://data.genomegitar.org</ext-link>. So far, we have run 20 datasets of humans (hg38), taken from the library on the 4D Nucleome (4DN) Web Portal (<ext-link ext-link-type="uri" xlink:href="https://4dnucleome.org" id="ir040">https://4dnucleome.org</ext-link>) <xref rid="b0170" ref-type="bibr">[34]</xref>, and 2 datasets of mice (mm10), to build a large collection that allows consistent comparison among datasets and saving time to process data for visualization or additional analyses. The 4DN library is a collection of genome interaction papers related to the 3C-based assays (3C, 4C, 5C, and Hi-C). Specifically, for GITAR we referred only to Hi-C derived datasets.</p>
      <p id="p0065">Four different outputs for each chromosome of a processed dataset are computed and saved to file: contact matrices, DI values, HMM-biased states (“true” DI values), and TAD coordinates. All the outputs are in txt format, and the functions to load each type of data are provided. Here, we processed the data at 40-kb resolution to perform TAD analysis according to Dixon et al. <xref rid="b0040" ref-type="bibr">[8]</xref>. In addition, we uploaded to the library the HDF5 files generated by HiFive to allow the user to quickly obtain results at a different resolution, without going through the entire pipeline from the beginning.</p>
      <p id="p0070">Even at the 40-kb resolution, contact matrices contain several million of elements per each chromosome, which requires big storage space, relatively high data saving, and long loading time. To reduce storage usage and computing time, we used an optimized compressed format to store the contact matrices, exploiting their properties of symmetry and sparsity (<xref rid="s0055" ref-type="sec">Figure S1</xref>). For instance, if we consider normalized contact matrices for the dataset from Rao et al. <xref rid="b0045" ref-type="bibr">[9]</xref> (GEO accession No.: <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1551550" id="ir045">GSM1551550</ext-link>) at the 40-kb resolution, our optimized format requires only 13% of space compared to the full contact data (208.6 MB and 1566.7 MB (1.53 GB), respectively). Even if data are compressed into a zip file, our format uses 44% of space for the full data (93.1 MB <italic>vs.</italic> 213 MB). As for the computing time, it takes more than 6 min and 3 min, respectively, to save and load full contact matrices of the aforementioned dataset, whereas saving and loading our parsed data requires less than 2 min for both (hardware: 2.9 GHz Intel Core i5, 16 GB of RAM). At higher resolutions (smaller bin sizes), contact matrices become more sparse; therefore the advantage given by this data format is more remarkable in terms of storage usage and computation time (<xref rid="t0010" ref-type="table">Table 2</xref>).<table-wrap id="t0010" position="float"><label>Table 2</label><caption><p><bold>Comparison between full and optimized normalized contact data for the entire human genome</bold></p></caption><table frame="hsides" rules="groups"><thead><tr><th valign="middle"><bold>Data type</bold></th><th><bold>Bin size</bold><break/><bold>(kb)</bold></th><th><bold>Storage usage</bold><break/><bold>txt format (MB)</bold></th><th><bold>Storage usage</bold><break/><bold>zip format (MB)</bold></th><th><bold>Saving time</bold><break/><bold>(min:sec)</bold></th><th valign="middle"><bold>Loading time</bold></th></tr></thead><tbody><tr><td>Full</td><td>1000</td><td>6.1</td><td>2.7</td><td>00:01</td><td>00:01</td></tr><tr><td>Optimized</td><td>1000</td><td>2.9 (48%)</td><td>1.4 (52%)</td><td>00:01 (100%)</td><td>00:01 (100%)</td></tr><tr><td>Full</td><td>100</td><td>341.4</td><td>105.9</td><td>01:07</td><td>00:30</td></tr><tr><td>Optimized</td><td>100</td><td>110.4 (32%)</td><td>49.9 (47%)</td><td>00:25 (37%)</td><td>00:17 (57%)</td></tr><tr><td>Full</td><td>40</td><td>1566.7</td><td>213</td><td>06:18</td><td>03:24</td></tr><tr><td>Optimized</td><td>40</td><td>208.6 (13%)</td><td>93.1 (44%)</td><td>01:50 (29%)</td><td>01:14 (36%)</td></tr><tr><td>Full</td><td>10</td><td>19,957.8</td><td>451.3</td><td>90:16</td><td>85:41</td></tr><tr><td>Optimized</td><td>10</td><td>393.6 (2%)</td><td>177.1 (39%)</td><td>26:31 (29%)</td><td>18:49 (22%)</td></tr></tbody></table><table-wrap-foot><fn><p><italic>Note</italic>: The dataset was obtained from <xref rid="b0045" ref-type="bibr">[9]</xref> (GEO accession number: <ext-link ext-link-type="uri" xlink:href="ncbi-geo:GSM1551550" id="ir020">GSM1551550</ext-link>). Hardware: 2.9 GHz Intel Core i5, 16 GB of RAM. The percentage of optimization (optimized/full) at each resolution is indicated in the parentheses. kb, kilobase; MB, megabyte.</p></fn></table-wrap-foot></table-wrap></p>
      <p id="p0075">Differently from contact matrices, domain coordinates are saved in a format to be read directly. Each line of the txt file refers to a TAD, with tab separated start and end coordinates, allowing quick access and readability.</p>
    </sec>
    <sec id="s0025">
      <title>Software requirements</title>
      <p id="p0080">The software that are required to run GITAR include Python (&gt;2.7), Bowtie 2, BEDTools, SAMtools, and SRA Toolkit. The Python libraries needed include Numpy, Scipy, Math, Matplotlib, Matplotlib.pyplot, Csv, Pybedtools, Pandas, Multiprocessing (if used), and Biopython. Additionally, Python packages HiFive and Hmmlearn are also needed, with the former used to normalize contact data and the latter serving the HMM to calculate the biased states used to extract TAD coordinates.</p>
    </sec>
  </sec>
  <sec id="s0030">
    <title>Results</title>
    <p id="p0085">Here, we demonstrate the capability of GITAR to handle high-resolution Hi-C data by processing and visualizing the <italic>in situ</italic> Hi-C dataset GSM1551550. For more details about data processing, refer to <xref rid="s0055" ref-type="sec">File S1</xref>.</p>
    <p id="p0090">After raw data are downloaded and converted to fastq format (SRA Toolkit), each of the two fastq files containing paired-end reads is used as input of a Python function, which performs the pre-truncation step. Among the total 202,095,066 read pairs, 29,851,195 (14.78 %) and 28,681,691 (14.20 %) reads, from the first and the second fastq files, respectively, contained a potential ligation junction and were thus truncated. Then, the two pre-truncated fastq files are mapped independently (Bowtie 2) and only reads aligned with MAPQ <inline-formula><mml:math id="M2" altimg="si2.gif" overflow="scroll"><mml:mo>≥</mml:mo></mml:math></inline-formula>30 are kept, that is, 172,973,813 (85.59%) and 161,438,783 (79.88%) reads, for the first and the second fastq files, respectively. Finally, only paired reads are selected, thus resulting in a total of 143,415,284 read pairs that go to the normalization pipeline as two separate BAM files, together with the FEND BED file. FEND files for humans (<italic>hg38</italic>) and mice (<italic>mm10</italic>) for the most commonly-used restriction enzymes (<italic>Hin</italic>dIII, <italic>Nco</italic>I, <italic>Dpn</italic>II, and <italic>Mbo</italic>I) are available for direct download; otherwise, any FEND file for a custom species or restriction enzyme can be computed by following our pipeline.</p>
    <p id="p0095">In the normalization pipeline (Python package HiFive <xref rid="b0120" ref-type="bibr">[24]</xref>), the two BAM files and the FEND file are first used together to generate an HiCData object in HDF5 format, while PCR duplicates, non-informative reads, and spurious ligation products are removed. Then, the HiCData object is loaded into an HiCProject object (HDF5 format), which is used to estimate the distance-dependence signal and run the binning algorithm to perform the correction model for contact counts of Yaffe and Tanay <xref rid="b0095" ref-type="bibr">[19]</xref>. All these separate steps from HiFive are performed together in our pipeline, by simply using one line of Python code. At this point, normalized contact matrices per each chromosome at a definite bin size can be computed using a single Python function call. To expedite the process of normalization for multiple chromosomes at once, parallelized processing is available through a single Python function as well. Contact maps can be plotted now (<xref rid="f0010" ref-type="fig">Figure 2</xref>). The plotting functionality is enclosed in two separate functions: the first can be used to plot observed, expected, and normalized contact matrices (<xref rid="f0010" ref-type="fig">Figure 2</xref>A), and the second to plot O/E contact matrices (<xref rid="f0010" ref-type="fig">Figure 2</xref>B). Histograms can be produced by setting a boolean parameter in the plotting functions.</p>
    <p id="p0100">Normalized contact matrices at the 40-kb resolution are used to calculate DI values, “true” DI values with HMM and TAD coordinates. DI and “true” DI values are saved to txt file and can also be plotted to infer the presence of TADs in the genomic region under analysis (<xref rid="f0015" ref-type="fig">Figure 3</xref>B). TAD coordinates are saved to txt file as well in a tab-separated format. Each of these mentioned tasks is performed in Python using a single function call.</p>
  </sec>
  <sec id="s0035">
    <title>Conclusion</title>
    <p id="p0105">GITAR is a framework that incorporates all the fundamental steps to process, normalize, visualize, and store Hi-C data in an efficient way. It is freely available as an open-source software at <ext-link ext-link-type="uri" xlink:href="https://genomegitar.org" id="ir050">https://genomegitar.org</ext-link>. GITAR consists of two modules: HiCtool and a processed data library. HiCtool is a complete pipeline to work with Hi-C data. It allows to preprocess the raw data, normalize intrachromosomal contact matrices, visualize heatmaps, and also includes TAD analysis. It is built with the aim of making every type of users able to carry out Hi-C data analysis, simply by following a step-by-step documentation available at <ext-link ext-link-type="uri" xlink:href="https://doc.genomegitar.org" id="ir055">https://doc.genomegitar.org</ext-link>. Contact matrices are stored in an efficient way to reduce storage occupation and time of I/O operations. The processed data library (<ext-link ext-link-type="uri" xlink:href="https://data.genomegitar.org" id="ir060">https://data.genomegitar.org</ext-link>) is a large collection of processed datasets for different cell lines and conditions of humans and mice, allowing consistent comparison among datasets or further analyses. Future developments of GITAR may include the incorporation of annotation features, additional normalization methods (for example, the scalable matrix balancing method adopted in Hi-Corrector <xref rid="b0090" ref-type="bibr">[18]</xref>), and expansion of the processed data library with additional datasets.</p>
  </sec>
  <sec id="s0040">
    <title>Authors’ contributions</title>
    <p id="p0110">RC and SZ conceived the project. RC and QW developed the software and performed the analysis. RC wrote the paper with the contribution of QW and JG. All authors read and approved the final manuscript.</p>
  </sec>
  <sec id="s0045">
    <title>Competing interests</title>
    <p id="p0115">SZ is a cofounder and a board member of Genemo Inc., which however does not do business related to the work described in this paper.</p>
  </sec>
</body>
<back>
  <ref-list id="bi005">
    <title>References</title>
    <ref id="b0005">
      <label>1</label>
      <element-citation publication-type="journal" id="h0005">
        <person-group person-group-type="author">
          <name>
            <surname>Misteli</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Beyond the sequence: cellular organization of genome function</article-title>
        <source>Cell</source>
        <volume>128</volume>
        <year>2007</year>
        <fpage>787</fpage>
        <lpage>800</lpage>
        <pub-id pub-id-type="pmid">17320514</pub-id>
      </element-citation>
    </ref>
    <ref id="b0010">
      <label>2</label>
      <element-citation publication-type="journal" id="h0010">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Gene regulation in the third dimension</article-title>
        <source>Science</source>
        <volume>319</volume>
        <year>2008</year>
        <fpage>1793</fpage>
        <lpage>1794</lpage>
        <pub-id pub-id-type="pmid">18369139</pub-id>
      </element-citation>
    </ref>
    <ref id="b0015">
      <label>3</label>
      <element-citation publication-type="journal" id="h0015">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Rippe</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kleckner</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Capturing chromosome conformation</article-title>
        <source>Science</source>
        <volume>295</volume>
        <year>2002</year>
        <fpage>1306</fpage>
        <lpage>1311</lpage>
        <pub-id pub-id-type="pmid">11847345</pub-id>
      </element-citation>
    </ref>
    <ref id="b0020">
      <label>4</label>
      <element-citation publication-type="journal" id="h0020">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Tavoosidana</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Sjolinder</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Gondor</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Mariano</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Circular chromosome conformation capture (4C) uncovers extensive networks of epigenetically regulated intra- and interchromosomal interactions</article-title>
        <source>Nat Genet</source>
        <volume>38</volume>
        <year>2006</year>
        <fpage>1341</fpage>
        <lpage>1347</lpage>
        <pub-id pub-id-type="pmid">17033624</pub-id>
      </element-citation>
    </ref>
    <ref id="b0025">
      <label>5</label>
      <element-citation publication-type="journal" id="h0025">
        <person-group person-group-type="author">
          <name>
            <surname>Dostie</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Richmond</surname>
            <given-names>T.A.</given-names>
          </name>
          <name>
            <surname>Arnaout</surname>
            <given-names>R.A.</given-names>
          </name>
          <name>
            <surname>Selzer</surname>
            <given-names>R.R.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>W.L.</given-names>
          </name>
          <name>
            <surname>Honan</surname>
            <given-names>T.A.</given-names>
          </name>
        </person-group>
        <article-title>Chromosome Conformation Capture Carbon Copy (5C): a massively parallel solution for mapping interactions between genomic elements</article-title>
        <source>Genome Res</source>
        <volume>16</volume>
        <year>2006</year>
        <fpage>1299</fpage>
        <lpage>1309</lpage>
        <pub-id pub-id-type="pmid">16954542</pub-id>
      </element-citation>
    </ref>
    <ref id="b0030">
      <label>6</label>
      <element-citation publication-type="journal" id="h0030">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>N.L.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Telling</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <volume>326</volume>
        <year>2009</year>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="b0035">
      <label>7</label>
      <element-citation publication-type="journal" id="h0035">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Poh</surname>
            <given-names>H.M.</given-names>
          </name>
          <name>
            <surname>Peh</surname>
            <given-names>S.Q.</given-names>
          </name>
          <name>
            <surname>Sia</surname>
            <given-names>Y.Y.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Mulawadi</surname>
            <given-names>F.H.</given-names>
          </name>
        </person-group>
        <article-title>ChIA-PET analysis of transcriptional chromatin interactions</article-title>
        <source>Methods</source>
        <volume>58</volume>
        <year>2012</year>
        <fpage>289</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="pmid">22926262</pub-id>
      </element-citation>
    </ref>
    <ref id="b0040">
      <label>8</label>
      <element-citation publication-type="journal" id="h0040">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <volume>485</volume>
        <year>2012</year>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="b0045">
      <label>9</label>
      <element-citation publication-type="journal" id="h0045">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>S.S.</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>M.H.</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>N.C.</given-names>
          </name>
          <name>
            <surname>Stamenova</surname>
            <given-names>E.K.</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>I.D.</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>J.T.</given-names>
          </name>
        </person-group>
        <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <volume>159</volume>
        <year>2014</year>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="b0050">
      <label>10</label>
      <element-citation publication-type="journal" id="h0050">
        <person-group person-group-type="author">
          <name>
            <surname>Ay</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>W.S.</given-names>
          </name>
        </person-group>
        <article-title>Analysis methods for studying the 3D architecture of the genome</article-title>
        <source>Genome Biol</source>
        <volume>16</volume>
        <year>2015</year>
        <fpage>183</fpage>
        <pub-id pub-id-type="pmid">26328929</pub-id>
      </element-citation>
    </ref>
    <ref id="b0055">
      <label>11</label>
      <element-citation publication-type="journal" id="h0055">
        <person-group person-group-type="author">
          <name>
            <surname>Shavit</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Lio</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Combining a wavelet change point and the Bayes factor for analysing chromosomal interaction data</article-title>
        <source>Mol Biosyst</source>
        <volume>10</volume>
        <year>2014</year>
        <fpage>1576</fpage>
        <lpage>1585</lpage>
        <pub-id pub-id-type="pmid">24710657</pub-id>
      </element-citation>
    </ref>
    <ref id="b0060">
      <label>12</label>
      <element-citation publication-type="journal" id="h0060">
        <person-group person-group-type="author">
          <name>
            <surname>Lun</surname>
            <given-names>A.T.</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G.K.</given-names>
          </name>
        </person-group>
        <article-title>diffHic: a Bioconductor package to detect differential genomic interactions in Hi-C data</article-title>
        <source>BMC Bioinformatics</source>
        <volume>16</volume>
        <year>2015</year>
        <fpage>258</fpage>
        <pub-id pub-id-type="pmid">26283514</pub-id>
      </element-citation>
    </ref>
    <ref id="b0065">
      <label>13</label>
      <element-citation publication-type="journal" id="h0065">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>H.J.</given-names>
          </name>
          <name>
            <surname>Michor</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>A computational strategy to adjust for copy number in tumor Hi-C data</article-title>
        <source>Bioinformatics</source>
        <volume>32</volume>
        <year>2016</year>
        <fpage>3695</fpage>
        <lpage>3701</lpage>
        <pub-id pub-id-type="pmid">27531101</pub-id>
      </element-citation>
    </ref>
    <ref id="b0070">
      <label>14</label>
      <element-citation publication-type="journal" id="h0070">
        <person-group person-group-type="author">
          <name>
            <surname>Lazaris</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Kelly</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ntziachristos</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Aifantis</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Tsirigos</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>HiC-bench: comprehensive and reproducible Hi-C data analysis designed for parameter exploration and benchmarking</article-title>
        <source>BMC Genomics</source>
        <volume>18</volume>
        <year>2017</year>
        <fpage>22</fpage>
        <pub-id pub-id-type="pmid">28056762</pub-id>
      </element-citation>
    </ref>
    <ref id="b0075">
      <label>15</label>
      <element-citation publication-type="journal" id="h0075">
        <person-group person-group-type="author">
          <name>
            <surname>Schmid</surname>
            <given-names>M.W.</given-names>
          </name>
          <name>
            <surname>Grob</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Grossniklaus</surname>
            <given-names>U.</given-names>
          </name>
        </person-group>
        <article-title>HiCdat: a fast and easy-to-use Hi-C data analysis tool</article-title>
        <source>BMC Bioinformatics</source>
        <volume>16</volume>
        <year>2015</year>
        <fpage>277</fpage>
        <pub-id pub-id-type="pmid">26334796</pub-id>
      </element-citation>
    </ref>
    <ref id="b0080">
      <label>16</label>
      <element-citation publication-type="journal" id="h0080">
        <person-group person-group-type="author">
          <name>
            <surname>Imakaev</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Fudenberg</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>McCord</surname>
            <given-names>R.P.</given-names>
          </name>
          <name>
            <surname>Naumova</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Goloborodko</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>B.R.</given-names>
          </name>
        </person-group>
        <article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title>
        <source>Nat Methods</source>
        <volume>9</volume>
        <year>2012</year>
        <fpage>999</fpage>
        <lpage>1003</lpage>
        <pub-id pub-id-type="pmid">22941365</pub-id>
      </element-citation>
    </ref>
    <ref id="b0085">
      <label>17</label>
      <element-citation publication-type="journal" id="h0085">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J.S.</given-names>
          </name>
        </person-group>
        <article-title>HiCNorm: removing biases in Hi-C data via Poisson regression</article-title>
        <source>Bioinformatics</source>
        <volume>28</volume>
        <year>2012</year>
        <fpage>3131</fpage>
        <lpage>3133</lpage>
        <pub-id pub-id-type="pmid">23023982</pub-id>
      </element-citation>
    </ref>
    <ref id="b0090">
      <label>18</label>
      <element-citation publication-type="journal" id="h0090">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Alber</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X.J.</given-names>
          </name>
        </person-group>
        <article-title>Hi-Corrector: a fast, scalable and memory-efficient package for normalizing large-scale Hi-C data</article-title>
        <source>Bioinformatics</source>
        <volume>31</volume>
        <year>2015</year>
        <fpage>960</fpage>
        <lpage>962</lpage>
        <pub-id pub-id-type="pmid">25391400</pub-id>
      </element-citation>
    </ref>
    <ref id="b0095">
      <label>19</label>
      <element-citation publication-type="journal" id="h0095">
        <person-group person-group-type="author">
          <name>
            <surname>Yaffe</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic modeling of Hi-C contact maps eliminates systematic biases to characterize global chromosomal architecture</article-title>
        <source>Nat Genet</source>
        <volume>43</volume>
        <year>2011</year>
        <fpage>1059</fpage>
        <lpage>1065</lpage>
        <pub-id pub-id-type="pmid">22001755</pub-id>
      </element-citation>
    </ref>
    <ref id="b0100">
      <label>20</label>
      <element-citation publication-type="journal" id="h0100">
        <person-group person-group-type="author">
          <name>
            <surname>Akdemir</surname>
            <given-names>K.C.</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>HiCPlotter integrates genomic data with interaction matrices</article-title>
        <source>Genome Biol</source>
        <volume>16</volume>
        <year>2015</year>
        <fpage>198</fpage>
        <pub-id pub-id-type="pmid">26392354</pub-id>
      </element-citation>
    </ref>
    <ref id="b0105">
      <label>21</label>
      <element-citation publication-type="journal" id="h0105">
        <person-group person-group-type="author">
          <name>
            <surname>Servant</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>B.R.</given-names>
          </name>
          <name>
            <surname>Viara</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C.J.</given-names>
          </name>
          <name>
            <surname>Vert</surname>
            <given-names>J.P.</given-names>
          </name>
        </person-group>
        <article-title>HiC-Pro: an optimized and flexible pipeline for Hi-C data processing</article-title>
        <source>Genome Biol</source>
        <volume>16</volume>
        <year>2015</year>
        <fpage>259</fpage>
        <pub-id pub-id-type="pmid">26619908</pub-id>
      </element-citation>
    </ref>
    <ref id="b0110">
      <label>22</label>
      <element-citation publication-type="journal" id="h0110">
        <person-group person-group-type="author">
          <name>
            <surname>Levy-Leduc</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Delattre</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Mary-Huard</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Robin</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Two-dimensional segmentation for analyzing Hi-C data</article-title>
        <source>Bioinformatics</source>
        <volume>30</volume>
        <year>2014</year>
        <fpage>i386</fpage>
        <lpage>i392</lpage>
        <pub-id pub-id-type="pmid">25161224</pub-id>
      </element-citation>
    </ref>
    <ref id="b0115">
      <label>23</label>
      <element-citation publication-type="journal" id="h0115">
        <person-group person-group-type="author">
          <name>
            <surname>Wingett</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ewels</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Furlan-Magaril</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Nagano</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Schoenfelder</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>HiCUP: pipeline for mapping and processing Hi-C data</article-title>
        <source>F1000Res</source>
        <volume>4</volume>
        <year>2015</year>
        <fpage>1310</fpage>
        <pub-id pub-id-type="pmid">26835000</pub-id>
      </element-citation>
    </ref>
    <ref id="b0120">
      <label>24</label>
      <element-citation publication-type="journal" id="h0120">
        <person-group person-group-type="author">
          <name>
            <surname>Sauria</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>V.G.</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>HiFive: a tool suite for easy and efficient HiC and 5C data analysis</article-title>
        <source>Genome Biol</source>
        <volume>16</volume>
        <year>2015</year>
        <fpage>237</fpage>
        <pub-id pub-id-type="pmid">26498826</pub-id>
      </element-citation>
    </ref>
    <ref id="b0125">
      <label>25</label>
      <element-citation publication-type="journal" id="h0125">
        <person-group person-group-type="author">
          <name>
            <surname>Kerpedjiev</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Abdennur</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Lekschas</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>McCallum</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Dinkla</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Strobelt</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>HiGlass: web-based visual exploration and analysis of genome interaction maps</article-title>
        <source>Genome Biol</source>
        <volume>19</volume>
        <year>2018</year>
        <fpage>125</fpage>
        <pub-id pub-id-type="pmid">30143029</pub-id>
      </element-citation>
    </ref>
    <ref id="b0130">
      <label>26</label>
      <element-citation publication-type="journal" id="h0130">
        <person-group person-group-type="author">
          <name>
            <surname>Hwang</surname>
            <given-names>Y.C.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C.F.</given-names>
          </name>
          <name>
            <surname>Valladares</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Malamon</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kuksa</surname>
            <given-names>P.P.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Q.</given-names>
          </name>
        </person-group>
        <article-title>HIPPIE: a high-throughput identification pipeline for promoter interacting enhancer elements</article-title>
        <source>Bioinformatics</source>
        <volume>31</volume>
        <year>2015</year>
        <fpage>1290</fpage>
        <lpage>1292</lpage>
        <pub-id pub-id-type="pmid">25480377</pub-id>
      </element-citation>
    </ref>
    <ref id="b0135">
      <label>27</label>
      <element-citation publication-type="journal" id="h0135">
        <person-group person-group-type="author">
          <name>
            <surname>Servant</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>B.R.</given-names>
          </name>
          <name>
            <surname>Nora</surname>
            <given-names>E.P.</given-names>
          </name>
          <name>
            <surname>Giorgetti</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C.J.</given-names>
          </name>
          <name>
            <surname>Heard</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>HiTC: exploration of high-throughput ‘C’ experiments</article-title>
        <source>Bioinformatics</source>
        <volume>28</volume>
        <year>2012</year>
        <fpage>2843</fpage>
        <lpage>2844</lpage>
        <pub-id pub-id-type="pmid">22923296</pub-id>
      </element-citation>
    </ref>
    <ref id="b0140">
      <label>28</label>
      <element-citation publication-type="journal" id="h0140">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Marco</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Pinello</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>G.C.</given-names>
          </name>
        </person-group>
        <article-title>Predicting chromatin organization using histone marks</article-title>
        <source>Genome Biol</source>
        <volume>16</volume>
        <year>2015</year>
        <fpage>162</fpage>
        <pub-id pub-id-type="pmid">26272203</pub-id>
      </element-citation>
    </ref>
    <ref id="b0145">
      <label>29</label>
      <element-citation publication-type="journal" id="h0145">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>N.C.</given-names>
          </name>
          <name>
            <surname>Shamim</surname>
            <given-names>M.S.</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>S.S.</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>M.H.</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>E.S.</given-names>
          </name>
        </person-group>
        <article-title>Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments</article-title>
        <source>Cell Syst</source>
        <volume>3</volume>
        <year>2016</year>
        <fpage>95</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="pmid">27467249</pub-id>
      </element-citation>
    </ref>
    <ref id="b0150">
      <label>30</label>
      <element-citation publication-type="journal" id="h0150">
        <person-group person-group-type="author">
          <name>
            <surname>Serra</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Bau</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Goodstadt</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Castillo</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Filion</surname>
            <given-names>G.J.</given-names>
          </name>
          <name>
            <surname>Marti-Renom</surname>
            <given-names>M.A.</given-names>
          </name>
        </person-group>
        <article-title>Automatic analysis and 3D-modelling of Hi-C data using TADbit reveals structural features of the fly chromatin colors</article-title>
        <source>PLoS Comput Biol</source>
        <volume>13</volume>
        <year>2017</year>
        <object-id pub-id-type="publisher-id">e1005665</object-id>
      </element-citation>
    </ref>
    <ref id="b0155">
      <label>31</label>
      <element-citation publication-type="journal" id="h0155">
        <person-group person-group-type="author">
          <name>
            <surname>Weinreb</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>B.J.</given-names>
          </name>
        </person-group>
        <article-title>Identification of hierarchical chromatin domains</article-title>
        <source>Bioinformatics</source>
        <volume>32</volume>
        <year>2016</year>
        <fpage>1601</fpage>
        <lpage>1609</lpage>
        <pub-id pub-id-type="pmid">26315910</pub-id>
      </element-citation>
    </ref>
    <ref id="b0160">
      <label>32</label>
      <element-citation publication-type="journal" id="h0160">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>N.C.</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Shamim</surname>
            <given-names>M.S.</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>J.P.</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>E.S.</given-names>
          </name>
        </person-group>
        <article-title>Juicebox provides a visualization system for Hi-C contact maps with unlimited zoom</article-title>
        <source>Cell Syst</source>
        <volume>3</volume>
        <year>2016</year>
        <fpage>99</fpage>
        <lpage>101</lpage>
        <pub-id pub-id-type="pmid">27467250</pub-id>
      </element-citation>
    </ref>
    <ref id="b0165">
      <label>33</label>
      <element-citation publication-type="journal" id="h0165">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>N.C.</given-names>
          </name>
          <name>
            <surname>Thorvaldsdottir</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>J.P.</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>E.L.</given-names>
          </name>
        </person-group>
        <article-title>Juicebox.js provides a cloud-based visualization system for Hi-C</article-title>
        <source>Data. Cell Syst</source>
        <volume>6</volume>
        <year>2018</year>
        <fpage>256</fpage>
        <lpage>258.e1</lpage>
        <pub-id pub-id-type="pmid">29428417</pub-id>
      </element-citation>
    </ref>
    <ref id="b0170">
      <label>34</label>
      <element-citation publication-type="journal" id="h0170">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Belmont</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Leshyk</surname>
            <given-names>V.O.</given-names>
          </name>
          <name>
            <surname>Lis</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Lomvardas</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>The 4D nucleome project</article-title>
        <source>Nature</source>
        <volume>549</volume>
        <year>2017</year>
        <fpage>219</fpage>
        <lpage>226</lpage>
        <pub-id pub-id-type="pmid">28905911</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="s0055" sec-type="supplementary-material">
    <title>Supplementary material</title>
    <p id="p0130">The following are the Supplementary data to this article:<supplementary-material content-type="local-data" id="m0010"><caption><title>Supplementary File S1</title><p>GITAR analysis methods</p></caption><media xlink:href="mmc1.docx"/></supplementary-material></p>
    <p id="p0135">
      <supplementary-material content-type="local-data" id="m0005">
        <caption>
          <title>Supplementary Figure S1</title>
          <p><bold>Contact map storage workflow</bold> A simplified example of the compression workflow, where the intra-chromosomal contact matrix is represented by a 4 × 4 symmetric and sparse matrix. (1) The upper-triangular part of the matrix is selected (including the diagonal); (2) data are reshaped to form a vector; (3) all the consecutive zeros are replaced with a “0” followed by the number of zeros that are repeated consecutively; and (4) data are saved into a txt file.</p>
        </caption>
        <media xlink:href="mmc2.pdf"/>
      </supplementary-material>
    </p>
  </sec>
  <ack id="ak005">
    <title>Acknowledgments</title>
    <p>This work was supported by the <funding-source id="gp005">National Institutes of Health</funding-source>, United States (Grant Nos. U01CA200147 and DP1HD087990) awarded to SZ.</p>
  </ack>
  <fn-group>
    <fn id="d31e603">
      <p id="np005">Peer review under responsibility of Beijing Institute of Genomics, Chinese Academy of Sciences and Genetics Society of China.</p>
    </fn>
    <fn id="s0050" fn-type="supplementary-material">
      <p id="p0125">Supplementary data to this article can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.gpb.2018.06.006" id="ir065">https://doi.org/10.1016/j.gpb.2018.06.006</ext-link>.</p>
    </fn>
  </fn-group>
</back>
