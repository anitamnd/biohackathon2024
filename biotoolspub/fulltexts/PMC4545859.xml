<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4545859</article-id>
    <article-id pub-id-type="pmid">26250558</article-id>
    <article-id pub-id-type="publisher-id">686</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-015-0686-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>InteMAP: Integrated metagenomic assembly pipeline for NGS short reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lai</surname>
          <given-names>Binbin</given-names>
        </name>
        <address>
          <email>binbinlai2012@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Fumeng</given-names>
        </name>
        <address>
          <email>wang_fumeng@126.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xiaoqi</given-names>
        </name>
        <address>
          <email>xiaoqiwang@pku.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duan</surname>
          <given-names>Liping</given-names>
        </name>
        <address>
          <email>duanlp@bjmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhu</surname>
          <given-names>Huaiqiu</given-names>
        </name>
        <address>
          <email>hqzhu@pku.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2256 9319</institution-id><institution-id institution-id-type="GRID">grid.11135.37</institution-id><institution>State Key Lab for Turbulence and Complex Systems and Department of Biomedical Engineering, </institution><institution>College of Engineering, Peking University, </institution></institution-wrap>Beijing, 100871 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2256 9319</institution-id><institution-id institution-id-type="GRID">grid.11135.37</institution-id><institution>Center for Quantitative Biology, </institution><institution>Peking University, </institution></institution-wrap>Beijing, 100871 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0605 3760</institution-id><institution-id institution-id-type="GRID">grid.411642.4</institution-id><institution>Department of Gastroenterology, </institution><institution>Peking University Third Hospital, </institution></institution-wrap>Beijing, 100191 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>8</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>16</volume>
    <elocation-id>244</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>10</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>7</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Lai et al. 2015</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Next-generation sequencing (NGS) has greatly facilitated metagenomic analysis but also raised new challenges for metagenomic DNA sequence assembly, owing to its high-throughput nature and extremely short reads generated by sequencers such as Illumina. To date, how to generate a high-quality draft assembly for metagenomic sequencing projects has not been fully addressed.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We conducted a comprehensive assessment on state-of-the-art de novo assemblers and revealed that the performance of each assembler depends critically on the sequencing depth. To address this problem, we developed a pipeline named InteMAP to integrate three assemblers, ABySS, IDBA-UD and CABOG, which were found to complement each other in assembling metagenomic sequences. Making a decision of which assembling approaches to use according to the sequencing coverage estimation algorithm for each short read, the pipeline presents an automatic platform suitable to assemble real metagenomic NGS data with uneven coverage distribution of sequencing depth. By comparing the performance of InteMAP with current assemblers on both synthetic and real NGS metagenomic data, we demonstrated that InteMAP achieves better performance with a longer total contig length and higher contiguity, and contains more genes than others.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We developed a <italic>de novo</italic> pipeline, named InteMAP, that integrates existing tools for metagenomics assembly. The pipeline outperforms previous assembly methods on metagenomic assembly by providing a longer total contig length, a higher contiguity and covering more genes. InteMAP, therefore, could potentially be a useful tool for the research community of metagenomics.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-015-0686-x) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2015</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Background</title>
    <p>Without the need for prior laboratory cultivation, metagenomics, as the study of sequence data directly from microbial communities in their natural habitats, has shown great power in investigating ubiquitous microorganisms that have intimate relationships with human beings as well as all other living organisms [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Recently, the next-generation sequencing (NGS) technology has greatly facilitated metagenomics, such as the launch of the Human Microbiome Project [<xref ref-type="bibr" rid="CR4">4</xref>] and the MetaHIT project [<xref ref-type="bibr" rid="CR2">2</xref>], providing numerous metagenomic data that can be mined for information on the compositional and functional properties of human microbial communities. Moreover, the drastic reduction in the cost of sequencing has allowed more and more laboratories to initiate metagenomic sequencing projects to decode complex microbiomes.</p>
    <p>In order to carry out the analysis of the metagenomes, such as gene-finding and binning [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR8">8</xref>], short reads (<italic>e.g.</italic> 100 bp for Illumina reads) are usually expected to be assembled first into longer contiguous sequences called contigs (with sizes ranging from several hundreds of bps to the whole chromosome) to provide more valuable genomic content. Despite of early endeavours to assemble reads from Sanger and 454 sequencers, such as Genovo [<xref ref-type="bibr" rid="CR9">9</xref>], Xgeovo [<xref ref-type="bibr" rid="CR10">10</xref>] and MAP [<xref ref-type="bibr" rid="CR11">11</xref>], high-throughput NGS short reads raise new challenges for this problem. The challenges come from the situation of high-throughput and extremely short reads generated by such as Illumina sequencers, as well as from intrinsic complications of metagenomic data caused by the microbial communities. Except for a few studies, most metagenomes using NGS remain unassembled and have been deposited directly into public databases. As part of the MetaHIT project, Qin et al. [<xref ref-type="bibr" rid="CR2">2</xref>] assembled metagenomic short reads from 127 human microbial samples and reported a catalogue of microbial genes from the intestinal tract. However, the assembler they employed, SOAPdenovo [<xref ref-type="bibr" rid="CR12">12</xref>], is not designed specifically for metagenome assembly but only for isolated genomes. Another single-genome assembler, Velvet [<xref ref-type="bibr" rid="CR13">13</xref>], has also been used to assemble permafrost metagenomes [<xref ref-type="bibr" rid="CR14">14</xref>]. Recently, several assemblers for metagenomic short reads, such as IDBA-UD [<xref ref-type="bibr" rid="CR15">15</xref>], MetaVelvet [<xref ref-type="bibr" rid="CR16">16</xref>], Ray [<xref ref-type="bibr" rid="CR17">17</xref>], and SPAdes [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>], are reported to be superior to other methods. In addition, CABOG, previously named Celera Assembler and employed in both single genome and metagenome assembly tasks, has been rebuilt to support Illumina reads in its latest version [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Recently, a metagenomic assembler, Omega, has been reported to outperform others mainly on long reads data (MiSeq 300 bp datasets) [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
    <p>Despite the aforementioned progress, metagenomic sequence assembly is still regarded as a challenge, both with respect to the data and the assembly process. It is known that metagenomic data contain sequences from so many species within a community, with many differences in abundances, levels of polymorphisms, and relationships with each other [<xref ref-type="bibr" rid="CR23">23</xref>]; In addition, other technical factors also affect the assembly quality, such as the depth of sequencing coverage, the sequencing errors, or the choice of <italic>k</italic>-mer size for assembling algorithm [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. Consequently, using these tools may be placed many more limitations than we might think. That is, they may not suit all the species in the metagenome data, or not be able to deal with all of the assembly issues. To this end, it is useful for the scientific community to realize the properties of existing assemblers with their performance on real metagenomic NGS data. Furthermore, it is also important if we can improve assembly quality by combining the strengths of these tools to deal with the complex task of metagenomic assembly. It has been reported that assembly reconciliation which merges different draft genome assemblies improved the assembly quality [<xref ref-type="bibr" rid="CR25">25</xref>–<xref ref-type="bibr" rid="CR27">27</xref>], especially in the task of metagenomic assembly [<xref ref-type="bibr" rid="CR28">28</xref>]. However, these studies on assembly reconciliation only provided general merging algorithm, leaving the problem of deciding which assemblers to choose unresolved.</p>
    <p>In this work, we first conducted a comprehensive assessment on state-of-the-art <italic>de novo</italic> assemblers including both <italic>de Bruijn</italic> graph based and overlap graph-based assemblers, with simulated metagenomic NGS data. In contrast to previous metagenomic assembly evaluation efforts that deemed the community as a whole [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>], we evaluated the assemblers by investigating how they perform on individual species in terms of factors such as sequencing depth of coverage and/or genomic similarity within the microbial community. Such a strategy has enabled us to reveal that different computational strategies not only complement each other by having different advantages in assembling sequences with different levels of sequencing depth, but also complement each other on assembling the sequences from the same genomes. Based on these findings, we further developed a <italic>de novo</italic> pipeline, named InteMAP, which integrates three tools, ABySS [<xref ref-type="bibr" rid="CR31">31</xref>], IDBA-UD [<xref ref-type="bibr" rid="CR15">15</xref>], and CABOG [<xref ref-type="bibr" rid="CR21">21</xref>], for metagenomic assembly. Taking advantage of the strength of each assembler and the complementary nature among them, the InteMAP pipeline shows remarkable improvement in metagenomic assembly. Unlike other metagenomic assembly pipeline, such as MetAMOS [<xref ref-type="bibr" rid="CR32">32</xref>] and MOCAT [<xref ref-type="bibr" rid="CR33">33</xref>], which directly provide a collection of available assemblers to users without a smart solution according to input short reads data, the InteMAP pipeline generates improved assembly based on integrating selected assemblers. The tests upon both simulated and real metagenomic NGS data show InteMAP has the potential for the assembly of metagenomics.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Evaluation of assemblers revealing their respective advantages</title>
      <p>In order to understand how state-of-the-art <italic>de novo</italic> assemblers perform on metagenomic datasets with short DNA reads, here we conducted the evaluation of several leading assemblers currently in wide use. Five latest assemblers, ABySS [<xref ref-type="bibr" rid="CR31">31</xref>], CABOG [<xref ref-type="bibr" rid="CR21">21</xref>], IDBA-UD [<xref ref-type="bibr" rid="CR15">15</xref>], MetaVelvet [<xref ref-type="bibr" rid="CR16">16</xref>], and SOAPdenovo [<xref ref-type="bibr" rid="CR12">12</xref>], were selected in the current study. Among them, ABySS, CABOG, and SOAPdenovo are general-purpose genome assemblers while the other two are specifically designed for assembling metagenomic reads. For the benchmark data, we constructed a simulated dataset consisting of 113 microbial species with different abundances, called <italic>sim-113sp</italic>, to model a real complex metagenome. For each assembler, we ran the program by multiple options and selected the best results (see Methods and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplemental Methods for details).</p>
      <p>It should be pointed out that our evaluation of these assemblers aims to examine their performance directly based on the details of reads, including the sequencing depth of coverage. Fortunately via simulated metagenome data, we may trace the details by mapping each read or contig into the corresponding source genome. Thereby, each assembly is applied to each individual genome within the simulated community. Herein, we evaluated three common-use measurements as contiguity, completeness, and correctness of each assembly for individual genome by calculating correct <italic>N</italic>50 size, assembly cover rate, and structural assembly errors in contigs (see Methods for how to calculate correct <italic>N</italic>50). Furthermore, assembly cover rate is defined as the proportion of the reference genome covered by contigs. Structural assembly errors are defined as in previous studies, including “mis-joins” of two unrelated sequences and segmental indels in the contigs [<xref ref-type="bibr" rid="CR34">34</xref>].</p>
      <p>We have noticed that each assembler provides similar performance for genomes of similar sequencing coverage. Therefore, 113 species within the <italic>sim-113sp</italic> dataset are classified into three groups by their sequencing depth levels: high (≥30× depth), medium (15-30×) and low coverage (≤15×). From the results of CABOG and IDBA-UD, we selected those that have the best trade-off between contiguity and correctness on most species. For the assemblers using the <italic>k</italic>-mer graph-based approach (ABySS, MetaVelvet, and SOAPdenovo), we found that assemblies configured with lower <italic>k</italic>-mer sizes have the better performance at lower coverage levels, while those with higher <italic>k</italic>-mer sizes present better performance at higher coverage levels. Thus, at different levels of sequencing coverage, we chose different <italic>k</italic>-mer sizes for the assemblies. Specifically, we selected the assembly with <italic>k</italic>-mer size 23 for lower coverage levels (low and medium clusters) while 51 for higher levels (medium and high clusters). It should be noted here that selecting a close <italic>k</italic>-mer size does not significantly change the assembly outcome.</p>
      <p>As shown in Figure <xref rid="Fig1" ref-type="fig">1</xref>, at both high and medium coverage levels, assembly cover rate of most assemblies reaches or closely approaches saturation, so the correct <italic>N</italic>50 size of contigs is selected to evaluate the capability of each assembler. At low coverage level, we used assembly cover rate and average contig size for evaluation, because most assemblies have an extremely low correct <italic>N</italic>50 size, which even drop to 0 since the assembly cover rate is less than 50 %. We then sum the performance of each assembler at different sequencing coverage levels on both capability and accuracy from the results shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1. The results show that ABySS has the best performance with a trade-off between correct <italic>N</italic>50 size and errors at high coverage level, but the performance degenerates from ~20× as the coverage decreases with more errors and shorter contigs. IDBA-UD has the best performance at medium coverage level with the best trade-off between contig size and error rate, and a good performance (though not as good as ABySS) at high coverage level. At low coverage level, IDBA-UD achieves both high assembly cover rate and average length, but also generates many more errors. CABOG performs well at medium and low coverage levels but does poorly at high coverage level. Both MetaVelvet and SOAPdenovo generate fewer errors than the other assemblers, but also have shorter contigs and a lower assembly cover rate at all three coverage levels. These results demonstrate the respective advantages as well as disadvantages of the assemblers, which lead to them being suitable for different data depth of sequencing coverage. For example, ABySS has the best performance on high depth, while IDBA-UD has the best performance on medium and low depth.<fig id="Fig1"><label>Fig. 1</label><caption><p>Assembly performances on the simulated metagenome dataset for the five assemblers. Assembly performances on the simulated metagenome dataset for the five assemblers (ABySS (<italic>k</italic>-mer size 51), CABOG, IDBA-UD, MetaVelvet (<italic>k</italic>-mer size 51), and SOAPdenovo (<italic>k</italic>-mer size 51)) are shown. The left column draws the ratio of correct <italic>N</italic>50 size to genome length, the medium column draws the assembly cover rate and the right column draws the assembly error counts of the assemblies. The top panel reports the performances for data at the high-coverage level (≥30×), while the medium panel does at the medium-coverage level (15-30×), and the bottom panel does at the low-coverage level (&lt;15×)</p></caption><graphic xlink:href="12859_2015_686_Fig1_HTML" id="MO1"/></fig>
</p>
      <p>We further analyzed the assemblies for the same species and investigated to what extent different approaches may complement each other. To address this, for each assembly on the <italic>sim-113sp</italic> dataset, we counted the genes that were completely contained in contigs. At lower coverage level (&lt;20×), except for a large part shared by at least two assemblies, the genes covered by IDBA-UD exclusively occupies the largest proportion of all the covered genes, followed by CABOG (see Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). However, as shown in Fig. <xref rid="Fig2" ref-type="fig">2b</xref>, IDBA-UD and CABOG share 53.4 % of the genes covered by them, while the percentage of the genes covered exclusively by IDBA-UD is 39.2 % and by CABOG is 7.4 %. This means that IDBA-UD and CABOG both miss a considerable number of the genes covered by the other assembly. In contrast, assemblies from ABySS, MetaVelvet, and SOAPdenovo have just a few genes missed by IDBA-UD assembly (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). The most likely reason is that ABySS, MetaVelvet, and SOAPdenovo use the same approach as IDBA-UD (<italic>k</italic>-mer graph), while CABOG uses a different one (overlap graph). At a higher coverage level (≥20×), almost all the genes are covered by at least two assemblers, except for a small proportion of genes in a few species that are exclusively covered by ABySS and IDBA-UD assembly (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). This result indicates that most assemblies are able to cover the vast majority of genes at high coverage level.<fig id="Fig2"><label>Fig. 2</label><caption><p>Genes covered by different assemblies. <bold>a</bold> The number of genes uncovered by any assemblies, covered by more than one assemblies and covered exclusively by only one assembly of the five assemblers (ABySS (<italic>k</italic>-mer size 23), CABOG, IDBA-UD, MetaVelvet (<italic>k</italic>-mer size 23), SOAPdenovo (<italic>k</italic>-mer size 23)), for the species with low coverage (&lt;18×) are stacked. The lateral axis shows the coverage of each species. Only partial species with coverage lower than 18× are drawn. <bold>b</bold> The stacked bar plot draws the distribution of the total genes on species with low coverage (&lt;18×) covered by IDBA-UD assembly and CABOG assembly. The <italic>blue</italic> part and the <italic>cyan</italic> part represent genes covered exclusively by CABOG and IDBA-UD, and the <italic>magenta</italic> part represents the genes shared by CABOG and IDBA-UD</p></caption><graphic xlink:href="12859_2015_686_Fig2_HTML" id="MO2"/></fig>
</p>
      <p>We finally investigated whether the mixture of species impacts the metagenomic assembly for each assembler (details shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplemental Methods). As shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4 and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5, the test on four small synthetic datasets with mixed genomes demonstrates that the mixture of uneven coverage sequences did not significantly change the result of each individual genome in metagenomic assembly process, for most assemblers except ABySS (ABySS is found to greatly increase the errors). In contrast, the mixture of the closely related species had a significant impact on both correct <italic>N</italic>50 size and error count for most assemblers, with shorter <italic>N</italic>50 and more errors. Nonetheless, the impacts from the mixture of different species seem to be insensitive or quite similar for all the assemblers in this test. Therefore, the variation at specific coverage level in the metagenomic assembly of different assemblers are, to a large extent, determined by the assembly capabilities of assemblers at that level, rather than the abilities to resolve the impacts of the mixture of reads.</p>
      <p>To sum up, our analysis revealed that any given individual assembler has bare means of providing the equal performance of assembly on short reads with different sequencing depth. Therefore, a user may rather be caught in trouble when using these tools for reads sequenced with heterogeneous depth as in a real metagenomic sample. However, on the basis of thoroughly understanding the assembling approaches, we expected that a fine-tune combinatorial application of these tools instead of running single tool would improve the assembly outcome.</p>
    </sec>
    <sec id="Sec4">
      <title>The InteMAP pipeline and its performance on simulated metagenomic dataset</title>
      <p>As mentioned above, upon test of the <italic>sim-113sp</italic> dataset, we found that existing <italic>de novo</italic> assemblers achieve their best performances on reads with different sequencing depth levels, moreover they are expected as being complementary to each other. Based on these findings, we devised a pipeline for metagenomic <italic>de novo</italic> assembly, named InteMAP, to integrate three <italic>de novo</italic> assemblers, IDBA-UD [<xref ref-type="bibr" rid="CR15">15</xref>], ABySS [<xref ref-type="bibr" rid="CR31">31</xref>] and CABOG [<xref ref-type="bibr" rid="CR21">21</xref>], which are shown to have their best performances at different depth levels and to be actually complementary to each other in our test. The InteMAP pipeline aims to generate a high-quality assembly on both high and low depth of coverage. In general, the pipeline begins with an algorithm to estimate the coverage of each read, and then integrates assemblies via two strategies: for different sequencing coverage reads, different optimal assemblers are used; while for reads of the same coverage, two optimal assemblers are used and then integrated. Iteratively, the pipeline integrates two assemblies at each step. For low coverage reads, the assemblies by IDBA-UD and CABOG are integrated. If high coverage reads are detected in the data, InteMAP combines the assemblies by ABySS and IDBA-UD for these sequences. Finally, the assemblies integrated from low and high coverage are further merged into the final assembly. Herein, the integration algorithm is specially designed for contigs produced by different assemblers. For non-overlapped contigs from two assemblies, the pipeline directly includes all the non-overlapped contigs, while for overlapped contigs from two assemblies, the pipeline merges the overlapped segments and makes a decision on the contradictory point, whether to extend from one contig or to cut at the point (see section Methods for detailed description of the algorithm).</p>
      <p>We then report the merits of the integrated assembling pipeline upon tests described below. Unlike the evaluation of the five assemblers mentioned above, herein we are confronted with another situation. To apply an assembler, including our InteMAP pipeline, to practical assembling metagenomic data, a read cannot be indicated its source genome as well as sequencing coverage. Therefore, as in previous studies [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR35">35</xref>], the statistics of the assembly on the whole community other than the assemblies calculated by individual genomes are used to evaluate the performance of the assembler on simulated metagenomic data. The first measure of assembly we assessed is the total length of the reference sequences covered by contigs, named “total cover length”, from which we evaluated the capability of the assembler to generate contigs. We also evaluated contiguity of the assembly using the statistic “<italic>N</italic>-len size” of contigs assembled, which has been used in previous studies [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. The <italic>N</italic>-len, as a function of a designated length <italic>L</italic>, is computed as follows: the contigs are sorted in decreasing order of length, therefore the <italic>N</italic>-len(<italic>L</italic>) statistic means the shortest length of the contigs, such that the total length of the contigs with a size no shorter than <italic>N</italic>-len exceeds the length <italic>L</italic>. Since contigs with assembly errors may lead to misleadingly large <italic>N</italic>-len sizes, we used the correct <italic>N</italic>-len size to evaluate the contiguity.</p>
      <p>Herein, we compared the assembly generated by InteMAP with the assemblies generated from five assemblers (ABySS, CABOG, IDBA-UD, SOAPdenovo, and MetaVelvet). In addition, we included Bambus 2 [<xref ref-type="bibr" rid="CR35">35</xref>] and three recently developed assembler methods Ray [<xref ref-type="bibr" rid="CR17">17</xref>], SPAdes [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>], and Omega [<xref ref-type="bibr" rid="CR22">22</xref>] for comparison. Ray and Omega are metagenome-specific assembly methods. Bambus 2 is not a complete assembly tool, but a scaffolder to scaffold unitigs generated by other assemblers, such as CABOG or SOAPdenovo. In this comparison, we used CABOG to generate unitigs for Bambus 2. For Bambus 2, CABOG, IDBA-UD, Omega, Ray, and SPAdes, we selected their best assembly by examining both total cover length and <italic>N</italic>-len size of the contigs from multiple runs with different parameters. For each of ABySS, MetaVelvet and SOAPdenovo (<italic>k</italic>-mer graph-based), we selected two assemblies, one of which was set a small <italic>k</italic>-mer size and reached the best cover length, while the other was set a large <italic>k</italic>-mer size and reached the best contiguity.</p>
      <p>The test on dataset <italic>sim-113sp</italic> shows that InteMAP assembly provides both the longest cover length and the best contiguity among all the compared assemblies (see Table <xref rid="Tab1" ref-type="table">1</xref>). As demonstrated in the first column of Table <xref rid="Tab1" ref-type="table">1</xref>, the total covered length assembled by InteMAP reaches 266.8 Mbp, while the second best is 244.8 Mbp by CABOG. We further plotted correct <italic>N</italic>-len size of different lengths <italic>L</italic> ranging from 5 Mbp to 50 Mbp. The second column of Table <xref rid="Tab1" ref-type="table">1</xref> shows that when <italic>L</italic> is 10 Mbp InteMAP presents the best contiguity with the longest <italic>N</italic>-len size of 244,190 bp than any other assembler does. More importantly, as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, InteMAP assembly always has the longest correct <italic>N</italic>-len size when <italic>L</italic> ranges from 5 Mbp to 50 Mbp. Further analysis demonstrates that InteMAP assembly has the overall best level of contiguity both in high and low coverage species (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6 for more results of cover length and contiguity of assemblies generated from ABySS, MetaVelvet and SOAPdenovo with different <italic>k</italic>-mer sizes). Generally, the <italic>N</italic>-len at the lower length point represents contiguity of the sequences from higher coverage species because these are apt to generate longer contigs, while the <italic>N</italic>-len at the longer length point reflects contiguity of the sequences from lower coverage species. Omega assembly shows quite a lot of structure errors and has a short total contig length and <italic>N</italic>-len. This may be because Omega has superiority mainly in assembling a long-read dataset, but not on a short-read dataset [<xref ref-type="bibr" rid="CR22">22</xref>].<table-wrap id="Tab1"><label>Table 1</label><caption><p>The summaries of assemblies on simulated metagenomic <italic>sim-113sp</italic> dataset</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Total cover length (Mbp)</th><th>Corr. <italic>N</italic>-len at 10 Mbp (bp)</th><th><italic>E</italic>-size (bp)</th><th>Num. of covered genes</th><th>Total errors</th><th>Kbp/errors</th><th>Identity (%)</th></tr></thead><tbody><tr><td>ABySS,<italic>k</italic> = 31</td><td char="." align="char">163.8</td><td>185,122</td><td>11,466</td><td>42,376</td><td>11,654</td><td char="." align="char">14.1</td><td char="." align="char">99.8</td></tr><tr><td>ABySS,<italic>k</italic> = 61</td><td char="." align="char">85.5</td><td>222,581</td><td>15,395</td><td>33,997</td><td>6,719</td><td char="." align="char">12.7</td><td char="." align="char"><bold>99.9</bold></td></tr><tr><td>Bambus2</td><td char="." align="char">232.5</td><td>90,788</td><td>6,531</td><td>40,139</td><td>259,320</td><td char="." align="char">0.9</td><td char="." align="char">99.5</td></tr><tr><td>CABOG</td><td char="." align="char">244.8</td><td>139,195</td><td>10,142</td><td>47,968</td><td>2,482</td><td char="." align="char">98.6</td><td char="." align="char">99.8</td></tr><tr><td>IDBA-UD</td><td char="." align="char">227.9</td><td>222,631</td><td>14,651</td><td>67,713</td><td>5,416</td><td char="." align="char">42.1</td><td char="." align="char">99.7</td></tr><tr><td>MetaVelvet,<italic>k</italic> = 23</td><td char="." align="char">182.8</td><td>5,437</td><td>689</td><td>23,971</td><td>3,271</td><td char="." align="char">55.9</td><td char="." align="char">99.8</td></tr><tr><td>MetaVelvet,<italic>k</italic> = 61</td><td char="." align="char">76.3</td><td>121,245</td><td>8,628</td><td>26,747</td><td>251</td><td char="." align="char">304.1</td><td char="." align="char"><bold>99.9</bold></td></tr><tr><td>Omega</td><td char="." align="char">75.8</td><td>90,383</td><td>7,751</td><td>25,837</td><td>78,078</td><td char="." align="char">0.9</td><td char="." align="char">99.8</td></tr><tr><td>Ray</td><td char="." align="char">90.2</td><td>35,059</td><td>2,365</td><td>22,958</td><td><bold>45</bold></td><td char="." align="char"><bold>2005.5</bold></td><td char="." align="char">99.8</td></tr><tr><td>SOAPdenovo,<italic>k</italic> = 23</td><td char="." align="char">203.0</td><td>2,116</td><td>345</td><td>14,253</td><td>1,717</td><td char="." align="char">118.3</td><td char="." align="char">99.8</td></tr><tr><td>SOAPdenovo,<italic>k</italic> = 61</td><td char="." align="char">75.2</td><td>89,811</td><td>6,078</td><td>24,081</td><td>1,921</td><td char="." align="char">39.1</td><td char="." align="char"><bold>99.9</bold></td></tr><tr><td>SPAdes</td><td char="." align="char">175.3</td><td>46,658</td><td>4,470</td><td>34,954</td><td>30,942</td><td char="." align="char">5.66</td><td char="." align="char">99.8</td></tr><tr><td>InteMAP</td><td char="." align="char"><bold>266.8</bold></td><td><bold>244,190</bold></td><td><bold>17,652</bold></td><td><bold>70,859</bold></td><td>5,072</td><td char="." align="char">52.6</td><td char="." align="char">99.8</td></tr></tbody></table><table-wrap-foot><p>Only contigs with length ≥200 bp are considered. “<italic>k</italic> = 23”, “<italic>k</italic> = 31” and “<italic>k</italic> = 61” in the first column denote the assembler use the option of <italic>k</italic>-mer size at 23 bp, 31 bp and 61 bp. Bambus 2 uses unitigs from CABOG. Total cover length denotes the total length of reference sequences that are covered by contigs. Corr. <italic>N</italic>-len denotes the correct <italic>N</italic>-len size. <italic>E</italic>-size is also computed using correct contigs. Only complete covered genes are counted. Errors denote the structural errors in contigs. The error rate is measured as the average distance between errors. Identity denotes the average identity of the alignments between contigs and references, where unmapped segments of contigs are not considered. Values in bold indicate the best in the column</p></table-wrap-foot></table-wrap>
<fig id="Fig3"><label>Fig. 3</label><caption><p><italic>N</italic>-len size plot for assemblies on the <italic>sim-113sp</italic> dataset</p></caption><graphic xlink:href="12859_2015_686_Fig3_HTML" id="MO3"/></fig>
</p>
      <p>Furthermore, we calculate <italic>E</italic>-size statistic which was proposed in a previous study [<xref ref-type="bibr" rid="CR34">34</xref>]. <italic>E</italic>-size is defined as the expectation of the length of the contigs that contains a position (base) randomly designated in reference genomes. This statistic addresses the question of how many genes are completely contained in the contigs. Also, it reflects both the assembly cover rate and the contiguity of the assembly. As we can see from the third column in Table <xref rid="Tab1" ref-type="table">1</xref>, InteMAP has an <italic>E</italic>-size of 17,652 bp, the largest among all the assemblers.</p>
      <p>Besides, we calculated the number of genes that were completely contained in the contigs of each assembly (see section Methods). The fourth column of Table <xref rid="Tab1" ref-type="table">1</xref> shows that the InteMAP assembly contains the most complete genes in contigs with the number 70,859. As one of the main goals of metagenomic assembly is to recover as many genes as possible from the sequencing reads, it is clear that the most genes covered by InteMAP demonstrate the superiority of our pipeline on metagenomic assembly.</p>
      <p>To evaluate the accuracy of assembly, we then counted structural assembly errors and computed single-base accuracy for each assembly. For a fair comparison, we computed the error rate by calculating the ratio of total contig length to total error number, which indicates the average length of sequence containing one error. For single-base accuracy, we computed the average identity between correct contigs and the references. The total number of structural assembly errors, the length per error, and the average identity of contigs for each assembly are listed in the fifth, the sixth, and the seventh column of Table <xref rid="Tab1" ref-type="table">1</xref>. The error rate of the assembly by InteMAP is lower than that by ABySS, Bambus 2, IDBA-UD, Omega, and SPAdes, while is slightly higher than that by CABOG, MetaVelvet, Ray, and SOAPdenovo. We further examined the distribution of contig errors in the InteMAP assembly. In fact, as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, most of the structural assembly errors occur in the contigs with low coverage or short length. The contigs are sorted by descending order of length. Within the top 5 % of total contig lengths, errors occur on average once every 5,821 Kbp, and this average error rate is much less frequently than that in total contigs lengths with once every 52.6 Kbp. Within the contigs mapping to the species with depth &gt;30×, there are only 28 errors, with an average error rate of one error in every 1,014 Kbp. These results mean that the long contigs generated by InteMAP are highly reliable. This is due to InteMAP's strategy in merging contigs, which leads to effective validating contigs and correcting mis-assemblies, especially on contigs with high coverage. In low coverage sequenced species, InteMAP employs IDBA-UD to assemble the reads, which is more inclusive than other assemblers, with longer contig and more genes predicted at the cost of a higher error rate. Nonetheless, InteMAP corrects part of the errors from IDBA-UD assembly by merging assembly from CABOG in low coverage sequences. In addition, the identity between correct contigs of InteMAP and reference genomes reaches 99.8 %, which is at the same level of performance among all other assemblers with different parameters.<fig id="Fig4"><label>Fig. 4</label><caption><p>The error profile of InteMAP assembly on the sim-113sp dataset. <bold>a</bold> The Error counts for each species from the InteMAP assembly on the <italic>sim-113sp</italic> dataset are shown. The lateral axis shows the coverage of the species. <bold>b</bold> The square dot with solid line reflects the average error rate within the subsets of contigs with different intervals of length which were generated as follows. We sorted the contigs by the descending order of length and partitioned the set of ordered contigs into subsets so that the aggregated length of contigs in each subset equaled to or approximated to 5 % of the total length. The error rate is measured as the average distance between errors on each subset of the contigs. The error rate (left vertical axis) is plotted versus the quantile of the total length (lateral axis) at which the set of contigs are partitioned. The circle dot with dash line draws <italic>N</italic>-len size (right vertical axis) at the aggregate length points (percentage of the total length is shown on lateral axis)</p></caption><graphic xlink:href="12859_2015_686_Fig4_HTML" id="MO4"/></fig>
</p>
      <p>In conclusion, the InteMAP pipeline has an overall better performance than ABySS, Bambus 2, IDBA-UD, SPAdes, and Omega in terms of assembly cover rate, contiguity, and accuracy. Compared to CABOG, MetaVelvet, Ray, and SOAPdenovo, the InteMAP pipeline is superior on assembly cover rate and contiguity at the cost of a slightly higher error rate in short contigs or contigs from species with low sequencing coverage. It should be noted that long contigs provide more valuable genomic contents and the dominant species are often the key object to be studied in the microbial community. In this regard, compared to CABOG, MetaVelvet, Ray, and SOAPdenovo, the total superiority of the InteMAP pipeline in terms of high cover rate, high contiguity and low error in long contigs or contigs from species with high coverage indicates that InteMAP performs better than the tools CABOG, MetaVelvet, Ray, and SOAPdenovo.</p>
    </sec>
    <sec id="Sec5">
      <title>Evaluating the merging method in InteMAP</title>
      <p>InteMAP is not a specially-designed merging algorithm, but a pipeline which detects high coverage and low coverage sequences, employs optimal assemblers to assemble different coverage sequences, and finally uses a novel merging algorithm to merge assemblies together. Nonetheless, we compared the merging algorithm in InteMAP with two specially-designed merging algorithms MeGAMerge [<xref ref-type="bibr" rid="CR28">28</xref>] and Minimus2 [<xref ref-type="bibr" rid="CR36">36</xref>]. Minimus2 is a part of AMOS package [<xref ref-type="bibr" rid="CR36">36</xref>] which has been used to merge assemblies, and MeGAMerge is a method developed to merging assemblies from metagenomic data. To compare InteMAP's merging algorithm with these two tools, we used Minimus2 and MeGAMerge to replace the InteMAP merging step in the pipeline for this study only and assembled the <italic>sim-113sp</italic> dataset. Table <xref rid="Tab2" ref-type="table">2</xref> shows the results from three merging methods in each step of the InteMAP pipeline. In general, the results from MeGAMerge and InteMAP merging algorithm have a similar level. MeGAMerge generates longer contigs and covers more genes, while InteMAP merging generates fewer structural errors, possibly because that the InteMAP merging algorithm uses a relative conservative strategy which detects inconsistent contigs from two assemblies as potential errors and then either corrects errors or splits the contigs (see section Methods for detailed description). Minimus2 generates much smaller contigs and covers fewer genes than other two methods.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of InteMAP merging algorithm with MeGAMerge and Minimus2</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Total cover length (Mbp)</th><th>Corr. <italic>N</italic>-len at 10 Mbp (bp)</th><th><italic>E</italic>-size (bp)</th><th>Num. of covered genes</th><th>Total errors</th><th>Kbp/errors</th><th>Identity (%)</th></tr></thead><tbody><tr><td colspan="8">Merging high-coverage-sequence assemblies (from IDBA-UD and ABySS)</td></tr><tr><td>InteMAP</td><td>202.3</td><td>145,649</td><td>9,960</td><td>12,491</td><td>50</td><td>405.6</td><td>99.9</td></tr><tr><td>MeGAMerge</td><td>205.9</td><td>154,674</td><td>10,290</td><td>12,649</td><td>94</td><td>219.1</td><td>99.9</td></tr><tr><td>Minimus2</td><td>11.9</td><td>40,393</td><td>6,630</td><td>7,237</td><td>63</td><td>188.7</td><td>99.9</td></tr><tr><td colspan="8">Merging low-coverage-sequence assemblies (from IDBA-UD and CABOG)</td></tr><tr><td>InteMAP</td><td>262.7</td><td>118,056</td><td>10,317</td><td>65,809</td><td>5,059</td><td>51.8</td><td>99.8</td></tr><tr><td>MeGAMerge</td><td>269.3</td><td>145,022</td><td>11,534</td><td>69,324</td><td>5,287</td><td>50.9</td><td>99.7</td></tr><tr><td>Minimus2</td><td>108.4</td><td>39,454</td><td>7,233</td><td>30,918</td><td>3,029</td><td>35.7</td><td>99.8</td></tr><tr><td colspan="8">Final merged assembly</td></tr><tr><td>InteMAP</td><td>266.8</td><td>244,190</td><td>17,652</td><td>70,859</td><td>5,072</td><td>52.6</td><td>99.8</td></tr><tr><td>MeGAMerge</td><td>273.8</td><td>253,783</td><td>18,148</td><td>72,014</td><td>5,399</td><td>50.5</td><td>99.8</td></tr><tr><td>Minimus2</td><td>111.3</td><td>55,893</td><td>10,285</td><td>34,892</td><td>3,045</td><td>36.4</td><td>98.8</td></tr></tbody></table></table-wrap>
</p>
      <p>It should be noted that the merging algorithm in InteMAP was not designed for improving any two assemblies. Indeed, merging all the assemblies from Table <xref rid="Tab1" ref-type="table">1</xref> does not results in a better assembly than the result from InteMAP pipeline (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). In contrast, the assembly generated by merging all the assemblies has much more errors than the assembly generated by InteMAP pipeline, mainly because the InteMAP merging algorithm could not detect or correct all the errors contained in all of the merged assemblies. In addition, what deserves special mention is that InteMAP is more than a merging algorithm. The purpose of InteMAP is not to improve the merging algorithm, but rather provide a pipeline for a complete metagenome assembly task, which gives an optimal resolution for how to choose optimal assemblers and how to integrate assemblies step by step.</p>
    </sec>
    <sec id="Sec6">
      <title>Testing InteMAP on real NGS data</title>
      <p>It is interesting to verify the capability of InteMAP on real metagenomic data by NGS. To this end, we selected a dataset from the 124 human gut microbial metagenomes, sequenced as a part of the MetaHIT project (sample ID: MH0012) [<xref ref-type="bibr" rid="CR2">2</xref>]. This sample was deeply sequenced by Illumina GA machine. The high-quality paired-end reads were downloaded from NCBI Sequence Read Archive (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sra">http://www.ncbi.nlm.nih.gov/sra</ext-link>; ERR011117, ERR011118, ERR011119, ERR011120, ERR011121, ERR011122, ERR011123), consisting of 186 million short reads with length of 75 bp and two paired-end insert size of 134 bp and 378 bp.</p>
      <p>We applied the InteMAP pipeline on this dataset and compared the assembly generated by InteMAP with those by other assembling tools including six metagenome-specific assemblers (Bambus 2, IDBA-UD, MetaVelvet, Omega, Ray, and SPAdes), and three general-purpose assemblers (ABySS, CABOG and SOAPdenovo). In fact, both Bambus 2 and MetaVelvet have been assessed using this benchmarking dataset in previous studies [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR35">35</xref>]. However, we reran Bambus 2 and MetaVelvet on the data since we did not find the assembled data from their publications. For MetaVelvet, we selected the optimal assembly with <italic>k</italic>-mer size 31 from multiple runs. We reran Bambus 2 based on the unitigs generated by CABOG. As Qin et al. [<xref ref-type="bibr" rid="CR2">2</xref>], who sequenced MH0012 sample, assembled the data using SOAPdenovo, we directly downloaded the assembly data from <ext-link ext-link-type="uri" xlink:href="http://www.bork.embl.de/~arumugam/Qin_et_al_2010/">http://www.bork.embl.de/~arumugam/Qin_et_al_2010/</ext-link> (see section Methods and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplemental Methods for detailed receipts describing how to run each assembler).</p>
      <p>We then assess each assembly by computing the statistics of total contig lengths, <italic>N</italic>-len, <italic>E</italic>-size, and the number of ORFs predicted by MetaGeneMark [<xref ref-type="bibr" rid="CR6">6</xref>] (see Table <xref rid="Tab3" ref-type="table">3</xref>). As we may see from the test, the InteMAP assembly has the longest total contig lengths of 278.6 Mbp among all the assemblies. Moreover, the <italic>N</italic>-len size of the InteMAP assembly is much higher than those of other individual assemblies, demonstrating a significant improvement in contig contiguity (see Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The <italic>E</italic>-size of the assembly generated by the InteMAP pipeline is also the largest among all the assemblies. In addition, the InteMAP assembly contains the most non-redundant ORFs and complete ORFs. Lacking reliable references, we are not able to evaluate the accuracy of the assemblies. Nevertheless, the results of the real NGS data is consistent with those from the simulated dataset, demonstrating that the InteMAP pipeline generates better assembly that has a longer total contig length, higher contiguity and contains more genes than all other individual assemblers.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Assembly statistics and predicted gene number on human gut microbial metagenome dataset (Sample MH0012)</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Sum of contig length (Mbp)</th><th><italic>N</italic>-len at 5 Mbp (bp)</th><th><italic>N</italic>-len at 50 Mbp (bp)</th><th><italic>E</italic>-size (bp)</th><th>Non-redundant ORFs predicted</th><th>Num. of predicted complete ORFs</th></tr></thead><tbody><tr><td>ABySS, <italic>k</italic> = 61<sup>a</sup>
</td><td char="." align="char">158.7</td><td>215,125</td><td>20,469</td><td>18,366</td><td>184,441</td><td>112,237</td></tr><tr><td>Bambus2</td><td char="." align="char">226.6</td><td>50,905</td><td>8,903</td><td>6,427</td><td>336,604</td><td>184,683</td></tr><tr><td>CABOG</td><td char="." align="char">185.6</td><td>46,459</td><td>12,738</td><td>6,964</td><td>222,638</td><td>119,907</td></tr><tr><td>IDBA-UD</td><td char="." align="char">277.2</td><td>177,468</td><td>41,831</td><td>23,970</td><td>339,336</td><td>186,427</td></tr><tr><td>MetaVelvet, <italic>k</italic> = 31</td><td char="." align="char">233.9</td><td>25,531</td><td>6,930</td><td>4,198</td><td>337,677</td><td>140,312</td></tr><tr><td>Omega</td><td char="." align="char">75.6</td><td>20,874</td><td>1,255</td><td>1,624</td><td>99,648</td><td>39,218</td></tr><tr><td>Ray</td><td char="." align="char">108.2</td><td>22,999</td><td>2,356</td><td>2,001</td><td>152,339</td><td>138,225</td></tr><tr><td>SOAPdenovo (Qin et al. 2010)<sup>b</sup>
</td><td char="." align="char">237.4</td><td>34,518</td><td>8,679</td><td>5,166</td><td>306,657</td><td>135,644</td></tr><tr><td>SPAdes</td><td char="." align="char">181.3</td><td>126,295</td><td>28,707</td><td>16,261</td><td>190,744</td><td>149,665</td></tr><tr><td>InteMAP</td><td char="." align="char"><bold>278.6</bold></td><td><bold>242,608</bold></td><td><bold>48,303</bold></td><td><bold>39,156</bold></td><td><bold>339,598</bold></td><td><bold>186,997</bold></td></tr></tbody></table><table-wrap-foot><p>Only contigs ≥500 bp are considered. Bambus 2 uses unitigs from CABOG. “<italic>k</italic> = 31” denotes that MetaVelvet uses option of <italic>k</italic>-mer size 31. The assembly generated by Qin et al. (2010) is included, which is assembled by SOAPdenovo. In the column of non-redundant ORFs predicted, only ORFs ≥100 bp are counted. Last column lists the number of complete ORFs. The ORFs are predicted by MetaGeneMark [<xref ref-type="bibr" rid="CR6">6</xref>]. Values in bold indicate the best in the column</p><p><sup><bold>a</bold></sup>Assembly by ABySS was generated from the correct reads from which many low coverage reads may be excluded because we failed ran ABySS on the mixed reads</p><p><sup><bold>b</bold></sup>Assembly by SOAPdenovo was directly downloaded from the publication of [<xref ref-type="bibr" rid="CR2">2</xref>]</p></table-wrap-foot></table-wrap>
<fig id="Fig5"><label>Fig. 5</label><caption><p><italic>N</italic>-len size plot for assemblies on real NGS dataset (sample MH0012)</p></caption><graphic xlink:href="12859_2015_686_Fig5_HTML" id="MO5"/></fig>
</p>
      <p>We further tested the performance of InteMAP on two more real metagenomic data downloaded from NCBI Sequence Read Archive (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sra">http://www.ncbi.nlm.nih.gov/sra</ext-link>; SRR512043 and SRR413680). SRR512043 is from one of samples from the permafrost metagenome project [<xref ref-type="bibr" rid="CR14">14</xref>], and has a totally low coverage depth, while SRR413680 is from another gut microbiota metagenome project [<xref ref-type="bibr" rid="CR37">37</xref>] and has a similar depth with the MH0012 sample. We applied InteMAP on these two data sets and compared the results to the assemblies generated by IDBA-UD. Here we compared the InteMAP with IDBA-UD only because IDBA-UD has the totally best performance among all the individual assemblers in our previous tests. Table <xref rid="Tab4" ref-type="table">4</xref> shows that on the data SRR512043, InteMAP has totally better performance than IDBA-UD with much longer total contig lengths, longer <italic>N</italic>-len at 100 Kbp, and more predicted non-redundant ORFs. Notably, InteMAP only employed IDBA-UD and CABOG assemblers working on this data and merged their assemblies because there are few high coverage sequences in this data. This suggests CABOG assembled many contigs that were missed by IDBA-UD, and InteMAP merged them together and made a large improvement over IDBA-UD. On the dataset SRR413680, the InteMAP assembly has slightly longer total contigs and more predicted ORFs. The evident longer <italic>N</italic>-len at 10 Mbp of InteMAP assembly than IDBA-UD assembly indicates InteMAP improves largely in the contiguity of the assembly over IDBA-UD.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Comparison of IDBA-UD and InteMAP on two real metagenomic data samples</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>IDBA-UD</th><th>InteMAP</th></tr></thead><tbody><tr><td><italic>SRR512043</italic></td><td/><td/></tr><tr><td>Sum of contig length (bp)</td><td>6,545,817</td><td>17,134,336</td></tr><tr><td><italic>N</italic>-len at 100 Kbp (bp)</td><td>607</td><td>1,355</td></tr><tr><td>Non-redundant ORFs predicted</td><td>16,767</td><td>53,542</td></tr><tr><td><italic>SRR413680</italic></td><td/><td/></tr><tr><td>Sum of contig length (bp)</td><td>147,576,380</td><td>149,997,510</td></tr><tr><td><italic>N</italic>-len at 10 Mbp (bp)</td><td>112,393</td><td>205,465</td></tr><tr><td>Non-redundant ORFs predicted</td><td>163,430</td><td>167,133</td></tr></tbody></table></table-wrap>
</p>
      <p>The InteMAP pipeline is designed for convenient use with automatic one-step operation; meanwhile users can also run the pipeline step by step, so that they can get an optimized outcome from multiple runs of different parameters for each individual assembler in the middle process. As consisted of several assembly processes by individual assemblers and mapping processes by Bowtie2, it takes longer to run InteMAP than other individual assemblers. For instance, in our test on the dataset MH0012, it took us for about 3 days to finish running InteMAP on the machine with the memory of 192G and thread number of 22, while it took for within one day to run individual assemblers on the same machine.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="conclusion">
    <title>Discussion and conclusions</title>
    <p>It has been believed that the assembly for metagenomic NGS reads has not reached a point to recover one or more complete genomes with the exception of finishable dominant species [<xref ref-type="bibr" rid="CR23">23</xref>]. However, it is never a trivial matter to make efforts to develop strong and efficient assembly tools to provide more valuable genomic content beyond raw data with a large number of NGS reads, even researchers can directly obtain a little information based on these raw data or 16S sequences [<xref ref-type="bibr" rid="CR1">1</xref>]. In this work, we have performed a comprehensive assessment on state-of-the-art <italic>de novo</italic> assemblers to understand their advantages and disadvantages in assembling metagenomic reads. The analysis revealed that the assembly performance of individual tool critically depends on sequence coverage and a combinatorial application of different tools is desired to achieve an overall better performance to assemble short reads sequenced with uneven coverage as in a real metagenomic sample. The InteMAP pipeline addressed this question by integrating three leading assemblers, IDBA-UD, ABySS, and CABOG, to assemble metagenomic NGS reads. The essential manipulation of InteMAP is to decide the assembling approaches according to sequencing coverage estimated for each short read. Thus, the pipeline actually presents a smart platform suitable to assembling real metagenomic NGS data with uneven coverage distribution of sequencing depth. Our analysis showed that the estimated coverage for each read does not exactly mean its real coverage of sequencing, which is no more than calculated based on the draft assemblies by IDBA-UD and ABySS. However, the estimation plays an important role in the pipeline, moreover it leads to the fact that InteMAP achieves a high performance in assembling metagenomic NGS reads.</p>
    <p>Surprisingly, several newly developed methods for metagenomic assembly such as Omega [<xref ref-type="bibr" rid="CR22">22</xref>], and Ray [<xref ref-type="bibr" rid="CR17">17</xref>] do not work well for our datasets. Ray has surprising low performance in terms of contig size and covered genes on the tested datasets, but has an extremely low error rate, suggesting Ray is a quite conservative assembler which tends to avoid errors while generating fewer contigs. Omega employs a minimal cost flow analysis on an overlap graph to generate unitigs. However, unlike CABOG which allows mismatch in the overlap detection, Omega uses exact-match overlaps to construct overlap graph, making it highly sensitivity to the sequencing errors or SNPs. Thus, Omega does not deal well with a highly complex metagenome dataset which might contain a large amount of low-sequencing-depth species on which sequencing errors could not get corrected easily.</p>
    <p>The assembler space is constantly moving and more assemblers are developed. It will be interesting to exam new assemblers to find their particular strength in the metagenomic assembly and further plug them in the InteMAP pipeline. However, as we have shown, merging all the assemblies did not result in a better assembly than what InteMAP did, arbitrary merge will not improve the assembly, unless we know the respective strength of an assembler and integrate it in an appropriate way.</p>
    <p>Metagenomes are complex mixtures usually containing diverse species with different abundances. An ideal metagenomic assembler is expected to perform well on both high and low depth sequences within the metagenomes. On the condition of a certain sequencing capacity, high depth sequences usually represent dominant or high-abundance species within the community. Conversely, low-coverage sequences usually represent low-abundance species which often occupy a large proportion of the community, especially in high-complexity metagenomes, such as the ocean and the soil metagenomes [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. In metagenomes which have dominant species, to construct the high-quality draft assemblies or even complete genomes of dominant species has a great significance in metagenomic studies [<xref ref-type="bibr" rid="CR39">39</xref>]. On the other hand, to assemble as many low abundant sequences as possible is also very important for the completeness of metagenomic studies. By integrating different assemblers which are good at assembling sequences at different coverage levels, the InteMAP pipeline demonstrates strong capability in assembling both high and low depth sequences, based on the improvements in terms of contiguity and total cover length, in comparison with current leading assemblers on both simulated and real NGS data.</p>
  </sec>
  <sec id="Sec8" sec-type="materials|methods">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Simulated dataset</title>
      <p>To construct the simulated metagenome dataset, we used the MetaSim simulator [<xref ref-type="bibr" rid="CR40">40</xref>] to generate a collection of synthetic metagenomic reads which reflect the specified abundance distribution of the species. In the current study, we mainly target the Illumina reads although our pipeline is also able to be applied on other short reads. To imitate Illumina sequencing, the read length was set 100 bp, with the average and the standard deviation of paired-end insert size as 300 bp and 20 bp. To model the specific pattern of sequencing error of Illumina technology, we used NGSfy [<xref ref-type="bibr" rid="CR41">41</xref>] to generate sequencing errors in reads, which uses a fourth-degree polynomial model to describe the frequency of errors in Illumina reads. We used the default settings for NGSfy, and the average error rate was 1.5 %, as in previous studies [<xref ref-type="bibr" rid="CR41">41</xref>, <xref ref-type="bibr" rid="CR42">42</xref>].</p>
      <p>We constructed the <italic>sim-113sp</italic> dataset by mixing the synthetic reads from 113 complete microbial genomes downloaded from NCBI RefSeq database. The collection of the 113 species is exactly the same as used by Mavromatis et al. [<xref ref-type="bibr" rid="CR43">43</xref>] to generate simulated metagenomic datasets, except for a few unfinished genomes, which we chose close relatives (usually a different strain) instead (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: File S1). For the abundance setting, we used the logarithmic distribution, which has been used in Mende et al. [<xref ref-type="bibr" rid="CR30">30</xref>] to model the microbial abundance distribution. The highest sequencing coverage of species in this dataset is 177.5×, followed by 97.6×, and the coverage drops to below 10× after the top 20 species (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7). We totally generated 4 million reads of totally 400 Mbp, which are able to be downloaded from <ext-link ext-link-type="uri" xlink:href="http://cqb.pku.edu.cn/ZhuLab/InteMAP/index.html">http://cqb.pku.edu.cn/ZhuLab/InteMAP/index.html</ext-link>.</p>
      <p>In order to calculate the number of genes contained by the assembly in the evaluation on simulated metagenomic dataset <italic>sim-113sp</italic>, we downloaded the gene annotation files for each reference genome, which record the start and ending positions for each gene on the genome sequence, from the NCBI database. According to the mappings between the contigs and the reference genomes, if one gene was completely contained in an aligned region of the references, this gene was deemed completely contained by the contigs.</p>
    </sec>
    <sec id="Sec10">
      <title>Running the assemblers</title>
      <p>The pre-processing of correcting the sequencing errors in raw reads has been reported to substantially enlarge the contig size for some assemblers in the single genome assembly [<xref ref-type="bibr" rid="CR34">34</xref>]. In the current study, error correction also improved the metagenome-assembly quality, especially on the high-depth species. The InteMAP pipeline employs a module of error correction to pre-process the reads before assembling. For a fair comparison, in our experiments, reads were pre-processed by the error correction process before being assembled by all assemblers (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplemental Methods for the detailed process of error correction).</p>
      <p>For each assembler, we ran multiple times with different parameter settings and selected the ones that appeared optimal or near optimal results (the parameters selected and details describing how to run each of the assembler are in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplemental Methods). The contigs by ABySS, IDBA-UD, MetaVelvet and SOAPdenovo were extracted from their scaffold sequences after splitting the scaffold sequences at gaps. SOAPdenovo has an additional module named GapCloser as a post-processor. Our test demonstrated that the GapCloser's post-processing actually increases the assembling errors dramatically. Therefore, we selected the assemblies without the post-processing of GapCloser for SOAPdenovo.</p>
    </sec>
    <sec id="Sec11">
      <title>Evaluating the assemblies</title>
      <p>Because extremely short contigs, in many cases as small as the <italic>k</italic>-mer size used to build the <italic>k</italic>-mer graph, can hardly support information for further analysis, for all the assemblies, contigs with length &lt;200 bp were excluded before evaluation, as did in previous study [<xref ref-type="bibr" rid="CR34">34</xref>]. Following the way used in the previous study [<xref ref-type="bibr" rid="CR34">34</xref>], we used MUMmer package v3.23 [<xref ref-type="bibr" rid="CR44">44</xref>] to evaluate the contigs, in which <italic>nucmer</italic> [<xref ref-type="bibr" rid="CR44">44</xref>] was used to align the contigs against the references with the options “-maxmatch -l 30 -banded -D 5.” Then <italic>delta-filter</italic> with the option “-i 95 -o 95” and <italic>dnadiff</italic> [<xref ref-type="bibr" rid="CR45">45</xref>] were used to obtain a globally optimal mappings between contigs and references, from which we could directly get the structural assembly errors (segmental indels (&gt;5 bp) and misjoins of two non-adjacent segments). From the output of <italic>dnadiff</italic>, we also got the identity of the aligned contigs. In the evaluation of the assemblies on simulated dataset, we used corrected contigs to evaluate the contiguity of the contigs by computing the correct <italic>N</italic>50 size, correct <italic>N</italic>-len size, and correct <italic>E</italic>-size. We extracted the aligned contig fragments as the corrected contigs from the mappings between contigs and references generated by <italic>dnadiff</italic> (aligned fragments end at the ends of contigs or assembly errors).</p>
      <p>The <italic>N</italic>-len size is computed as defined in the RESULTS section. Herein it is should be noted that <italic>N</italic>50 size corresponds to the <italic>N</italic> -len(<italic>x</italic>) for <italic>x</italic> = <italic>L/</italic>2, where <italic>L</italic> denotes the reference genome length. The computation of the <italic>E</italic>-value follows the formula<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ E={\displaystyle \sum_C\frac{{L_C}^2}{G},} $$\end{document}</tex-math><mml:math id="M2"><mml:mi>E</mml:mi><mml:mtext/><mml:mo>=</mml:mo><mml:mtext/><mml:mstyle displaystyle="true"><mml:munder><mml:mo stretchy="true">∑</mml:mo><mml:mi>C</mml:mi></mml:munder><mml:mrow><mml:mfrac><mml:msup><mml:msub><mml:mi>L</mml:mi><mml:mi>C</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:msup><mml:mi>G</mml:mi></mml:mfrac><mml:mtext/><mml:mo>,</mml:mo></mml:mrow></mml:mstyle><mml:mtext/></mml:math><graphic xlink:href="12859_2015_686_Equa.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>where <italic>L</italic>
<sub><italic>C</italic></sub> is the length of contig <italic>C</italic>, and <italic>G</italic> is the total reference genome length. On real NGS dataset MH0012, as the total length of reference genomes is not available, the <italic>G</italic> in the <italic>E</italic>-size formula was assigned the maximal total contigs length among all the assemblies run on this dataset (we used 280,000,000 here).</p>
    </sec>
    <sec id="Sec12">
      <title>Algorithm of the InteMAP pipeline</title>
      <p>We then describe the procedures of the InteMAP pipeline step by step as follows (see Fig. <xref rid="Fig6" ref-type="fig">6</xref>):<fig id="Fig6"><label>Fig. 6</label><caption><p>The flowchart of the main procedures of the InteMAP pipeline</p></caption><graphic xlink:href="12859_2015_686_Fig6_HTML" id="MO6"/></fig>
<list list-type="bullet"><list-item><p><italic>Step 1. Correcting errors of the input reads.</italic> By default, input reads are first pre-processed by the Quake tool [<xref ref-type="bibr" rid="CR46">46</xref>], which aims to correct the sequencing errors in high-coverage sequences (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplemental Methods for details). Two sets of reads are then generated: one named “correct read set” consisting of reads corrected or validated by Quake, and the other consisting of the remaining ones (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8 for the ratio of the correct reads to total reads for each coverage of species). Two sets are mixed together and the mixed read set is termed “total read set”.</p></list-item><list-item><p><italic>Step 2. Running IDBA-UD and estimating reads coverage.</italic> After the assembly by IDBA-UD, reads are mapped into the contigs using the read alignment tool, Bowtie 2 [<xref ref-type="bibr" rid="CR47">47</xref>]. According to the mappings between reads and contigs, the coverage of each read is then estimated by the times of the total length of reads to the length of the assembled contig. Furthermore, the contigs are separated along with the mapped reads by different coverage. The pipeline then picks up both the reads mapping to contigs with the coverage &lt; <italic>L</italic> (this can be designated by users, 50× by default) and the unmapped reads, and assembles them using CABOG.</p></list-item><list-item><p><italic>Step 3. Checking the total length of high coverage contigs.</italic> The pipeline first checks the total length of the contigs with the coverage &gt;30×. If the length is shorter than a designated value (<italic>e.g.</italic> 1 Mbp by default), the pipeline goes to Step 6 for the condition of the low-coverage reads assembly. Otherwise, goes to the next step.</p></list-item><list-item><p><italic>Step 4. Assembling reads of the “correct read set” using ABySS and IDBA-UD respectively.</italic> The “correct read set” has been generated in Step 1, and using this set can largely increase the quality of assembly for the high-depth species by both ABySS and IDBA-UD. After assemblies are generated by ABySS and IDBA-UD, the pipeline maps the reads into the contigs and picks up the high-depth contigs for both assemblies. The minimal coverage of high-depth contigs for ABySS and IDBA-UD is set 20× by default.</p></list-item><list-item><p><italic>Step 5. Merging the assemblies at high and low coverage levels iteratively.</italic> First, the pipeline merges the high-depth contigs from the IDBA-UD and ABySS assemblies generated in Step 4, using the algorithm described below. Then filter out the high-coverage contigs (≥50×) by IDBA-UD in Step 2 and merge the remaining contigs by CABOG in Step 2. Since the pipeline has merged contigs both on the high and low coverage sequences, finally, the pipeline merges them together as the final contigs. Note that the ranges of the high and low coverage overlap each other to ensure that the pipeline covers all the sequences, so the default cut-off for high-depth and low-depth are set to make the range broader than those used for the assembly evaluation. The pipeline ends at this step.</p></list-item><list-item><p><italic>Step 6. Merging the assemblies by IDBA-UD and CABOG.</italic> If Step 4 and 5 are skipped, which means that there are no high coverage species within the metagenomes, merge the contigs generated by both IDBA-UD and CABOG in Step 2 as the final contigs. The pipeline ends at this step.</p></list-item></list>
</p>
    </sec>
    <sec id="Sec13">
      <title>The algorithm for merging two sets of contigs</title>
      <p>The steps of merging contigs in the InteMAP pipeline are described as follows.<list list-type="bullet"><list-item><p><italic>Step 1. Comparing the two sets of contigs.</italic> It begins with comparing the two sets of contigs using <italic>nucmer</italic>, <italic>delta-filter</italic>, and <italic>dnadiff</italic> in MUMmer package to get the mappings between the two sets of contigs. From the mappings, the same segments shared by two sets of contigs are marked. Then, the breakpoints are marked inside the contigs where the bifurcations appear (Type 1 breakpoint) or the segments end in the contigs of the different assembly (Type 2 breakpoint), as illustrated in Fig. <xref rid="Fig7" ref-type="fig">7a</xref>. The breakpoints may indicate assembly errors.<fig id="Fig7"><label>Fig. 7</label><caption><p>Illustration of merging two assemblies. <bold>a</bold> Two types of breakpoints caused by differences between two assemblies are illustrated. Suppose two assemblies <italic>asm</italic>1 and <italic>asm</italic>2 have the same assembled sequence segment <italic>seg</italic>1. The first type of difference is that in <italic>asm</italic>1, <italic>seg</italic>1 is extended with <italic>seg</italic>2 on the right, while in <italic>asm</italic>1, <italic>seg</italic>1 ends on the right. The second type of difference is that in <italic>ass</italic>1, <italic>seg</italic>1 is extended with <italic>seg</italic>2 on the right, while in <italic>asm</italic>2, <italic>seg</italic>1 is extended with <italic>seg</italic>3 on the right. <bold>b</bold> Split the contigs at the breakpoint within the suspicious region. <bold>c</bold> An example of merging the segments at the breakpoints which are not broken</p></caption><graphic xlink:href="12859_2015_686_Fig7_HTML" id="MO7"/></fig>
</p></list-item><list-item><p><italic>Step 2. Validating the contigs.</italic> The contigs are validated by mapping the paired-end reads against the contigs, which has been used in previous work [<xref ref-type="bibr" rid="CR45">45</xref>]. The basic idea is that if one contig is correctly assembled, each pair of paired-end reads is located and mated correctly. If a region has ≥5 mis-mated reads located, this region will be marked as suspicious which indicates potential mis-assembly within the region. Thus, if one breakpoint is located within the suspicious region, it is more likely to be an assembly error. Therefore, the algorithm breaks all the breakpoints which are located within the suspicious regions (Fig. <xref rid="Fig7" ref-type="fig">7b</xref>).</p></list-item><list-item><p><italic>Step 3. Breaking the contradictory breakpoints.</italic> The remaining breakpoints are treated differently according to their types. As Type 1 breakpoints are mated and in different assemblies respectively, if both mated breakpoints are not broken in Step 2, both of them will be broken at this step. In contrast, if only one Type 1 breakpoint is broken in Step 2, the other breakpoint will automatically transform to the Type 2 breakpoint. The survived Type 2 breakpoints are reserved.</p></list-item><list-item><p><italic>Step 4. Connecting the segments at reserved breakpoints</italic> (Fig. <xref rid="Fig7" ref-type="fig">7c</xref>). Because there are no conflicting breakpoints remained after Step 2 and 3, each segment has at most one segment linked by the reserved breakpoint in either the left or the right direction. Then, beginning from any segment which ends at one side, the pipeline extends the segment by connecting the adjacent one until the extending segment ends at the extending direction. The final contigs are generated by reading the bases from the merged segments. If the segment is shared by two assemblies, randomly select one strand of sequences to read the bases.</p></list-item></list>
</p>
    </sec>
  </sec>
  <sec id="Sec14">
    <title>Availability of supporting data</title>
    <p>The package of the InteMAP software and all the benchmarking data are freely available from <ext-link ext-link-type="uri" xlink:href="http://cqb.pku.edu.cn/ZhuLab/InteMAP/index.html">http://cqb.pku.edu.cn/ZhuLab/InteMAP/index.html</ext-link>.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec15">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="12859_2015_686_MOESM1_ESM.docx" id="MOESM1">
            <label>Additional file 1:</label>
            <caption>
              <p><bold>Supplemental Materials.</bold> This file is in docx format and includes the Supplemental Methods and Supplemental Figures. (DOCX 784 kb)</p>
            </caption>
          </media>
          <media position="anchor" xlink:href="12859_2015_686_MOESM2_ESM.xls" id="MOESM2">
            <label>Additional file 2:</label>
            <caption>
              <p><bold>Supplemental file 1.</bold> This file is in xls format and records the information of the 113 species selected to generate the dataset <italic>sim-113sp. (XLS 26 kb)</italic>
</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>BL, FW, XW, LD and HZ equally contributed to the idea and to the design of the algorithm and experiment. BL developed the tool. BL and FW performed the experiment. BL, FW, XW and HZ wrote the paper. All authors read and approved the final manuscript.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ information</bold>
      </p>
      <p>BL’s current address: Adipocyte Biology and Gene Regulation Section, Laboratory of Endocrinology and Receptor Biology, National Institute of Diabetes and Digestive and Kidney Diseases, National Institutes of Health, Bethesda, MD 20892.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We wish to thank Prof. Xuegong Zhang of Tsinghua University and Prof. Zuhong Lu of Peking University for interest to the project and useful discussions. We also thank Prof. Antony Chen of Peking University for his refinement to the manuscript writing. We thank Dr. Yongchu Liu, Jiantao Guo, Luying Liu, Qi Wang, Xiao Guo and Peng Zhai for their helpful discussions.</p>
    <p>Funding</p>
    <p>This work was supported by the National Key Technology Research and Design Program of China (2012BAI06B02), the National Natural Science Foundation of China (30970667, 11021463, 61131003 and 91231119), National Basic Research Program of China (2011CB707500), and Excellent Doctoral Dissertation Supervisor Funding of Beijing (YB 20101000102).</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Venter</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Remington</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Heidelberg</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Halpern</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Rusch</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Eisen</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Environmental genome shotgun sequencing of Sargasso sea</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>304</volume>
        <fpage>66</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1093857</pub-id>
        <pub-id pub-id-type="pmid">15001713</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Arumugam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Burgdorf</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Manichanh</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A human gut microbial gene catalogue established by metagenomic sequencing</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>464</volume>
        <fpage>59</fpage>
        <lpage>64</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08821</pub-id>
        <pub-id pub-id-type="pmid">20203603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emmanuelle</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Trine</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Junjin</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Edi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Falk</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gwen</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Richness of human gut microbiome correlates with metabolic markers</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>500</volume>
        <fpage>541</fpage>
        <lpage>546</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12506</pub-id>
        <pub-id pub-id-type="pmid">23985870</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nelson</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Weinstock</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Highlander</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Worley</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Creasy</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Wortman</surname>
            <given-names>JR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A catalog of reference genomes from the human microbiome</article-title>
        <source>Science</source>
        <year>2010</year>
        <volume>328</volume>
        <fpage>994</fpage>
        <lpage>999</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1183605</pub-id>
        <pub-id pub-id-type="pmid">20489017</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>GQ</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>HQ</given-names>
          </name>
        </person-group>
        <article-title>MetaTISA: Metagenomic translation initiation site annotator for improving gene start prediction</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1843</fpage>
        <lpage>1845</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp272</pub-id>
        <pub-id pub-id-type="pmid">19389734</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lomsadze</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Borodovsky</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Ab initio gene identification in metagenomic sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <pub-id pub-id-type="doi">10.1093/nar/gkq275</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patil</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Haider</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pope</surname>
            <given-names>PB</given-names>
          </name>
          <name>
            <surname>Turnbaugh</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scheffer</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Taxonomic metagenome sequence assignment with structured output models</article-title>
        <source>Nat Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <issue>3</issue>
        <fpage>191</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth0311-191</pub-id>
        <pub-id pub-id-type="pmid">21358620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>GQ</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>HQ</given-names>
          </name>
        </person-group>
        <article-title>Gene prediction in metagenomic fragments based on the SVM algorithm</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>S12</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-S5-S12</pub-id>
        <pub-id pub-id-type="pmid">23735199</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laserson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jojic</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Koller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Genovo: de novo assembly for metagenomes</article-title>
        <source>J Comput Biol</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>429</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2010.0244</pub-id>
        <pub-id pub-id-type="pmid">21385045</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Afiahayati, Sato K, Sakakibara Y: An extended genovo metagenomic assembler by incorportating paired-end information. <italic>Peer J</italic> 2013, 1:e196.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lai</surname>
            <given-names>BB</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>HQ</given-names>
          </name>
        </person-group>
        <article-title>A de novo metagenomic assembly program for shotgun DNA reads</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1455</fpage>
        <lpage>1462</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts162</pub-id>
        <pub-id pub-id-type="pmid">22495746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Qian</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo assembly of human genomes with massively parallel short read sequencing</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>265</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.097261.109</pub-id>
        <pub-id pub-id-type="pmid">20019144</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Velvet: Algorithms for de novo short read assembly using de Bruijn graphs</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>821</fpage>
        <lpage>829</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.074492.107</pub-id>
        <pub-id pub-id-type="pmid">18349386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Machelprang R, Waldrop MP, DeAngelis KM, David MM, Chavarria K, Blazewicz SJ, Rubin EM, Jansson JK: Metagenomic analysis of a permafrost microbial community reveals a rapid response to thaw. <italic>Nature</italic> 2011, 480:doi:10.1038/nature10576.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>FY</given-names>
          </name>
        </person-group>
        <article-title>IDBA-UD: A de novo sssembler for single-cell and metagenomic sequencing data with highly uneven depth</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>11</issue>
        <fpage>1420</fpage>
        <lpage>1428</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts174</pub-id>
        <pub-id pub-id-type="pmid">22495754</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Namiki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hachiya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tanaka</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sakakibara</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>MetaVelvet: an extension of Velvet assembler to de novo metagenome assembly from short sequence reads</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <pub-id pub-id-type="doi">10.1093/nar/gks678</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boisvert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Raymond</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Godzaridis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Laviolette</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Corbeil</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Ray Meta: scalable de novo metagenome assembly and profiling</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>12</issue>
        <fpage>R122</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-12-r122</pub-id>
        <pub-id pub-id-type="pmid">23259615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bankevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Antipov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gurevich</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Dvorkin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kulikov</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing</article-title>
        <source>J Comput Biol</source>
        <year>2012</year>
        <volume>19</volume>
        <fpage>455</fpage>
        <lpage>477</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2012.0021</pub-id>
        <pub-id pub-id-type="pmid">22506599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nurk</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bankevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Antipov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gurevich</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Korobeynikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lapidus</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembling single-cell genomes and mini-metagenomes from chimeric MDA products</article-title>
        <source>J Comput Biol</source>
        <year>2013</year>
        <volume>20</volume>
        <fpage>714</fpage>
        <lpage>737</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2013.0084</pub-id>
        <pub-id pub-id-type="pmid">24093227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>GG</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Dew</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Fasulo</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Flanigan</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A whole-genome assembly of <italic>Drosophila</italic></article-title>
        <source>Science</source>
        <year>2000</year>
        <volume>287</volume>
        <fpage>2896</fpage>
        <lpage>2204</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Venter</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Walenz</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Brownley</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Aggressive assembly of pyrosequencing reads with mates</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>2818</fpage>
        <lpage>2824</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn548</pub-id>
        <pub-id pub-id-type="pmid">18952627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haider</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ahn</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Bushnell</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Copeland</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Omega: an Overlap-graph de novo Assembler for Metagenomics</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>19</issue>
        <fpage>2717</fpage>
        <lpage>2722</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu395</pub-id>
        <pub-id pub-id-type="pmid">24947750</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kunin</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Copeland</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lapidus</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mavromatis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A bioinformatician's guide to metagenomics</article-title>
        <source>Microbiol Mol Biol Rev</source>
        <year>2008</year>
        <volume>72</volume>
        <fpage>557</fpage>
        <lpage>178</lpage>
        <pub-id pub-id-type="doi">10.1128/MMBR.00009-08</pub-id>
        <pub-id pub-id-type="pmid">19052320</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Assembly algorithms for next-generation sequencing data</article-title>
        <source>Genomics</source>
        <year>2010</year>
        <volume>95</volume>
        <fpage>315</fpage>
        <lpage>327</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ygeno.2010.03.001</pub-id>
        <pub-id pub-id-type="pmid">20211242</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zimin</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yorke</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Assembly reconciliation</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>42</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm542</pub-id>
        <pub-id pub-id-type="pmid">18057021</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Minx</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Weinstock</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Graph accordance of next-generation sequence assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>13</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr588</pub-id>
        <pub-id pub-id-type="pmid">22025481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vicedomini</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vezzi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Scalabrin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Arvestad</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Policriti</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>GAM-NGS: genomic assemblies merger for next generation sequencing</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>Suppl 7</issue>
        <fpage>S6</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-S7-S6</pub-id>
        <pub-id pub-id-type="pmid">23815503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scholz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Chain</surname>
            <given-names>PS</given-names>
          </name>
        </person-group>
        <article-title>Improved assemblies using a source-agnostic pipeline for MetaGenomic Assembly by Merging (MeGAMerge) of contigs</article-title>
        <source>Sci Rep</source>
        <year>2014</year>
        <volume>4</volume>
        <fpage>6480</fpage>
        <pub-id pub-id-type="doi">10.1038/srep06480</pub-id>
        <pub-id pub-id-type="pmid">25270300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charuvaka</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rangwala</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of short read metagenomic assembly</article-title>
        <source>BMC Genomics</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>Suppl 2</issue>
        <fpage>S8</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-12-S2-S8</pub-id>
        <pub-id pub-id-type="pmid">21989307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mende</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Waller</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jarvelin</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Arumugam</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assessment of metagenomic assembly using simulated next generation sequencing data</article-title>
        <source>PLoS One</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>2</issue>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0031386</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simpson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Efficient de novo assembly of large genomes using compressed data structures</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>549</fpage>
        <lpage>556</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.126953.111</pub-id>
        <pub-id pub-id-type="pmid">22156294</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sommer</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Astrovskaya</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ondov</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MetAMOS: a modular and open source metagenomic assembly and analysis pipeline</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>R2</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-1-r2</pub-id>
        <pub-id pub-id-type="pmid">23320958</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kultima</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Sunagawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mende</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MOCAT: a metagenomics assembly and gene prediction toolkit</article-title>
        <source>PLoS One</source>
        <year>2012</year>
        <volume>7</volume>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0047656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Zimin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Puiu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Magoc</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GAGE: A critical evaluation of genome assemblies and assembly algorithms</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>557</fpage>
        <lpage>567</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.131383.111</pub-id>
        <pub-id pub-id-type="pmid">22147368</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Bambus 2: Scaffolding metagenomes</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2964</fpage>
        <lpage>2971</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr520</pub-id>
        <pub-id pub-id-type="pmid">21926123</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Comparative genome assembly</article-title>
        <source>Brief Bioinform</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>237</fpage>
        <lpage>248</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/5.3.237</pub-id>
        <pub-id pub-id-type="pmid">15383210</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A metagenome-wide association study of gut microbiota in type 2 diabetes</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>490</volume>
        <fpage>55</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11450</pub-id>
        <pub-id pub-id-type="pmid">23023125</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tringe</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Mering</surname>
            <given-names>CV</given-names>
          </name>
          <name>
            <surname>Kobayashi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salamov</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative metagenomics of microbial mommunities</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>308</volume>
        <fpage>554</fpage>
        <lpage>557</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1107851</pub-id>
        <pub-id pub-id-type="pmid">15845853</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Ram</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>PM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Community structure and metabolism through reconstruction of microbial genomes from the environment</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>428</volume>
        <fpage>37</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1038/nature02340</pub-id>
        <pub-id pub-id-type="pmid">14961025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richter</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Ott</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Auch</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huson</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>MetaSim—a sequencing simulator for genomics and metagenomics</article-title>
        <source>PLoS One</source>
        <year>2008</year>
        <volume>3</volume>
        <issue>10</issue>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0003373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pignatelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moya</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Evaluating the fidelity of de novo short read metagenomic assembly using simulated data</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>5</issue>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0019984</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korbel</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Abyzov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mu</surname>
            <given-names>XJ</given-names>
          </name>
          <name>
            <surname>Carriero</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Cayting</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PEMer: a computational framework with simulation-based error models for inferring genomic structural variants from massive paired-end sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R23</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-2-r23</pub-id>
        <pub-id pub-id-type="pmid">19236709</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mavromatis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ivanova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Goltsman</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Use of simulated data sets to evaluate the fidelity of metagenomic processing methods</article-title>
        <source>Nat Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <fpage>495</fpage>
        <lpage>500</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth1043</pub-id>
        <pub-id pub-id-type="pmid">17468765</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Smoot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shumway</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Antonescu</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Versatile and open software for comparing large genomes</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R12</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2004-5-2-r12</pub-id>
        <pub-id pub-id-type="pmid">14759262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Genome assembly forensics: Finding the elusive mis-assembly</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R55</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-3-r55</pub-id>
        <pub-id pub-id-type="pmid">18341692</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kelley</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Quake: Quality-aware detection and correctetion of sequencing errors</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R116</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-11-r116</pub-id>
        <pub-id pub-id-type="pmid">21114842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>357</fpage>
        <lpage>359</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
