<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8344557</article-id>
    <article-id pub-id-type="pmid">34320202</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkab632</article-id>
    <article-id pub-id-type="publisher-id">gkab632</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00010</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>Narese/7</subject>
        <subject>Narese/24</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RCA2: a scalable supervised clustering algorithm that reduces batch effects in scRNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9222-6207</contrib-id>
        <name>
          <surname>Schmidt</surname>
          <given-names>Florian</given-names>
        </name>
        <aff><institution>Laboratory of Systems Biology and Data Analytics, Genome Institute of Singapore</institution>, A*STAR, 60 Biopolis St, 138672, <country country="SG">Singapore</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ranjan</surname>
          <given-names>Bobby</given-names>
        </name>
        <aff><institution>Laboratory of Systems Biology and Data Analytics, Genome Institute of Singapore</institution>, A*STAR, 60 Biopolis St, 138672, <country country="SG">Singapore</country></aff>
        <xref rid="FN1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7167-2627</contrib-id>
        <name>
          <surname>Lin</surname>
          <given-names>Quy Xiao Xuan</given-names>
        </name>
        <aff><institution>Laboratory of Systems Biology and Data Analytics, Genome Institute of Singapore</institution>, A*STAR, 60 Biopolis St, 138672, <country country="SG">Singapore</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krishnan</surname>
          <given-names>Vaidehi</given-names>
        </name>
        <aff><institution>DUKE-NUS Medical School</institution>, 8 College Rd, 169857, <country country="SG">Singapore</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Joanito</surname>
          <given-names>Ignasius</given-names>
        </name>
        <aff><institution>Laboratory of Systems Biology and Data Analytics, Genome Institute of Singapore</institution>, A*STAR, 60 Biopolis St, 138672, <country country="SG">Singapore</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Honardoost</surname>
          <given-names>Mohammad Amin</given-names>
        </name>
        <aff><institution>Laboratory of Systems Biology and Data Analytics, Genome Institute of Singapore</institution>, A*STAR, 60 Biopolis St, 138672, <country country="SG">Singapore</country></aff>
        <aff><institution>Department of Medicine, School of Medicine, National University of Singapore</institution>, 1 Kent Ridge Road, level 10, NUHS Tower Block, 119228, <country country="SG">Singapore</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nawaz</surname>
          <given-names>Zahid</given-names>
        </name>
        <aff><institution>Laboratory of Systems Biology and Data Analytics, Genome Institute of Singapore</institution>, A*STAR, 60 Biopolis St, 138672, <country country="SG">Singapore</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Venkatesh</surname>
          <given-names>Prasanna Nori</given-names>
        </name>
        <aff><institution>Laboratory of Systems Biology and Data Analytics, Genome Institute of Singapore</institution>, A*STAR, 60 Biopolis St, 138672, <country country="SG">Singapore</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tan</surname>
          <given-names>Joanna</given-names>
        </name>
        <aff><institution>Laboratory of Systems Biology and Data Analytics, Genome Institute of Singapore</institution>, A*STAR, 60 Biopolis St, 138672, <country country="SG">Singapore</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rayan</surname>
          <given-names>Nirmala Arul</given-names>
        </name>
        <aff><institution>Laboratory of Systems Biology and Data Analytics, Genome Institute of Singapore</institution>, A*STAR, 60 Biopolis St, 138672, <country country="SG">Singapore</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-9460-3483</contrib-id>
        <name>
          <surname>Ong</surname>
          <given-names>Sin Tiong</given-names>
        </name>
        <aff><institution>DUKE-NUS Medical School</institution>, 8 College Rd, 169857, <country country="SG">Singapore</country></aff>
        <aff><institution>Department of Medicine, Duke University Medical Center</institution>, Durham, NC 27710, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Prabhakar</surname>
          <given-names>Shyam</given-names>
        </name>
        <!--prabhakars@gis.a-star.edu.sg-->
        <aff><institution>Laboratory of Systems Biology and Data Analytics, Genome Institute of Singapore</institution>, A*STAR, 60 Biopolis St, 138672, <country country="SG">Singapore</country></aff>
        <xref rid="COR1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +65 6808 8046; Fax: +65 6808 8292; Email: <email>prabhakars@gis.a-star.edu.sg</email></corresp>
      <fn id="FN1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <day>07</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-28">
      <day>28</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>49</volume>
    <issue>15</issue>
    <fpage>8505</fpage>
    <lpage>8519</lpage>
    <history>
      <date date-type="accepted">
        <day>13</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>06</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="received">
        <day>18</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab632.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>The transcriptomic diversity of cell types in the human body can be analysed in unprecedented detail using single cell (SC) technologies. Unsupervised clustering of SC transcriptomes, which is the default technique for defining cell types, is prone to group cells by technical, rather than biological, variation. Compared to <italic toggle="yes">de-novo</italic> (unsupervised) clustering, we demonstrate using multiple benchmarks that supervised clustering, which uses reference transcriptomes as a guide, is robust to batch effects and data quality artifacts. Here, we present <sc>RCA2</sc>, the first algorithm to combine reference projection (batch effect robustness) with graph-based clustering (scalability). In addition, <sc>RCA2</sc> provides a user-friendly framework incorporating multiple commonly used downstream analysis modules. <sc>RCA2</sc> also provides new reference panels for human and mouse and supports generation of custom panels. Furthermore, <sc>RCA2</sc> facilitates cell type-specific QC, which is essential for accurate clustering of data from heterogeneous tissues. We demonstrate the advantages of <sc>RCA2</sc> on SC data from human bone marrow, healthy PBMCs and PBMCs from COVID-19 patients. Scalable supervised clustering methods such as RCA2 will facilitate unified analysis of cohort-scale SC datasets.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Agency for Science, Technology and Research</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001348</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>CDAP201703-172-76-00056</award-id>
        <award-id>IAF-PP-H18/01/a0/020</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Medical Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001349</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>MOH-CSASI18may-0002</award-id>
        <award-id>NMRC/CIRG/1468/2017</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="15"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Since its first usage in 2009 (<xref rid="B1" ref-type="bibr">1</xref>), single cell (SC) RNA sequencing (scRNA-seq) has quickly become the method of choice for profiling gene expression in complex samples (<xref rid="B2" ref-type="bibr">2</xref>). Due to the unprecedented resolution of scRNA-seq data, cell type-specific analysis of gene expression can now be performed easily and at low cost. SC transcriptomes are well-suited to characterizing heterogeneous biological specimens, e.g. tumors (<xref rid="B3" ref-type="bibr">3</xref>).</p>
    <p>Clustering is an essential step in SC data analysis, since each cell cluster in transcriptome space represents a distinct cell type or state. There are two established paradigms to address the SC clustering problem: (i) unsupervised (<italic toggle="yes">de-novo</italic>) clustering (<xref rid="B4" ref-type="bibr">4</xref>), which is the most prevalent, and (ii) supervised clustering, which exploits a panel of reference transcriptomes (<xref rid="B5" ref-type="bibr">5</xref>). In addition, reference transcriptomes are used to classify single cells, which is by definition a supervised approach (<xref rid="B6" ref-type="bibr">6–10</xref>). Among the unsupervised methods, the Louvain graph-based clustering algorithm is the most prevalent, since it offers better scalability than hierarchical clustering (<xref rid="B11" ref-type="bibr">11–13</xref>).</p>
    <p>Despite the existence of multiple algorithms, SC clustering is still challenging: (i) cells may cluster by technical variation and batch effects rather than biological properties (<xref rid="B4" ref-type="bibr">4</xref>), (ii) scRNA-seq data tend to be noisy, primarily due to sampling noise and (iii) the gene expression matrix can be very large, since modern datasets commonly include &gt; 100,000 cells. Consequently, different algorithms can return highly divergent clusterings, i.e. partitions of cells into clusters, of the same input dataset (<xref rid="B14" ref-type="bibr">14</xref>). Moreover, <italic toggle="yes">de-novo</italic> clustering requires an error-prone, time-consuming manual step of assigning cell clusters to cell types (annotation) based on subjective evaluation of the expression of marker genes. Supervised clustering and supervised cell type annotation algorithms have been developed to address these limitations.</p>
    <p>Previously, we proposed <italic toggle="yes">Reference Component Analysis (RCA)</italic> for supervised clustering of scRNA-seq data guided by a panel of reference transcriptomes (<xref rid="B5" ref-type="bibr">5</xref>).</p>
    <p>Unlike the above-mentioned methods, RCA was not primarily designed for cell type annotation. Rather, the objective of RCA is to cluster single cells in the space of reference transcriptome projections. This is fundamentally different from unsupervised clustering approaches, which cluster cells in the space defined by over a thousand feature genes (<xref rid="B15" ref-type="bibr">15</xref>,<xref rid="B16" ref-type="bibr">16</xref>).</p>
    <p>To the best of our knowledge, RCA is the only supervised clustering algorithm for scRNA-seq data. However, the original version of RCA could not scale to datasets larger than 20,000 cells on a high-end laptop, used only a single reference panel, did not implement methods to identify differential gene expression, did not offer KEGG and Gene Ontology (GO) enrichment analysis, was benchmarked on only a single Smart-seq dataset and could not be easily integrated into existing data analysis workflows.</p>
    <p>To fully leverage the merits of supervised clustering, we present <sc>RCA2</sc>, the first algorithm that combines reference projection with graph-based clustering. The former provides accuracy and robustness, whereas the latter provides scalability and speed. We show the unique advantages of <sc>RCA2</sc> by analyzing diverse scRNA-seq data sets: a publicly available 10× PBMC data set, a novel human bone marrow data set and a recently published data set of PBMCs from COVID-19 positive patients (<xref rid="B17" ref-type="bibr">17</xref>). In addition, by providing multiple new human and mouse reference panels, as well as the option to generate custom panels from user-supplied bulk transcriptomes, we significantly broadened the applicability of <sc>RCA2</sc> compared to the previous version.</p>
    <p>Furthermore, we demonstrate using diverse sample types that supervised clustering can be accurate even when the dataset contains cell types not contained in the reference panel. In summary, <sc>RCA2</sc> is well suited to the task of robustly clustering large scRNA-seq datasets, which are typically generated in multiple batches or across multiple sites.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Projection to a reference</title>
      <p>Given a reference data set <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {R}$\end{document}</tex-math></inline-formula> containing <italic toggle="yes">n</italic> cell types and <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula> marker genes as well as a query data set <inline-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {Q}$\end{document}</tex-math></inline-formula> containing <italic toggle="yes">k</italic> single cells and <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {C}$\end{document}</tex-math></inline-formula> genes, we determine a marker gene set <inline-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {M}$\end{document}</tex-math></inline-formula> by intersecting <inline-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {G}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {C}$\end{document}</tex-math></inline-formula>:<disp-formula id="M1"><label>(1)</label><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \mathcal {M}=\mathcal {G}\cap \mathcal {C}. \end{equation*}$$\end{document}</tex-math></disp-formula>The reference matrix <inline-formula><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {R}^{\prime }$\end{document}</tex-math></inline-formula> and set <inline-formula><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {Q}^{\prime }$\end{document}</tex-math></inline-formula> are generated by extracting the gene set <inline-formula><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {M}$\end{document}</tex-math></inline-formula> from <inline-formula><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {R}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {Q}$\end{document}</tex-math></inline-formula>, respectively. Next, RCA2 computes the reference projection matrix <inline-formula><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {P}$\end{document}</tex-math></inline-formula> with an entry <inline-formula><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {P}_{i,j}$\end{document}</tex-math></inline-formula> denoting the correlation (default: Pearson (<italic toggle="yes">r</italic>)) between <inline-formula><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {R}^{\prime }$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {Q}^{\prime }$\end{document}</tex-math></inline-formula> for a single cell <italic toggle="yes">i</italic> (column <inline-formula><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {Q}^{\prime }_i$\end{document}</tex-math></inline-formula>) and cell type <italic toggle="yes">j</italic> (column <inline-formula><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {R}^{\prime }_j$\end{document}</tex-math></inline-formula>):<disp-formula id="M2"><label>(2)</label><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \mathcal {P}_{i,j}=r(\mathcal {Q}_i^{\prime },\mathcal {R}_j^{\prime }). \end{equation*}$$\end{document}</tex-math></disp-formula>The projection matrix <inline-formula><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {P}$\end{document}</tex-math></inline-formula> is modified according to<disp-formula id="M3"><label>(3)</label><tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \mathcal {P}=|\mathcal {P}|^4\cdot sign(\mathcal {P}). \end{equation*}$$\end{document}</tex-math></disp-formula><inline-formula><tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {P}$\end{document}</tex-math></inline-formula> is scaled to zero mean and unit variance. All matrices are represented as <italic toggle="yes">sparse matrix</italic> R objects. The projection is computed using the <italic toggle="yes">fastcor</italic> package (<xref rid="B18" ref-type="bibr">18</xref>). <inline-formula><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {P}$\end{document}</tex-math></inline-formula> can be visualized as a 2D and 3D UMAP.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Clustering and interpreting the projection</title>
      <p>RCA2 offers three clustering algorithms: (i) hierarchical clustering using the memory efficient <italic toggle="yes">fastcluster</italic> (<xref rid="B19" ref-type="bibr">19</xref>) package, (ii) shared-nearest neighbour (SNN) clustering using <italic toggle="yes">dbscan</italic> (<xref rid="B20" ref-type="bibr">20</xref>) and (iii) graph-based clustering using the Louvain algorithm (<xref rid="B11" ref-type="bibr">11</xref>). The depth to cut the dendrogram in hierarchical clustering is a parameter (default 1). The SNN algorithm used in <italic toggle="yes">dbscan</italic> has three parameters: <italic toggle="yes">k</italic> (neighborhood size of the SNN graph), <italic toggle="yes">eps</italic> (two cells are only reachable from each other if they share at least <italic toggle="yes">eps</italic> nearest cells) and <italic toggle="yes">min</italic> − <italic toggle="yes">pts</italic> (minimum number of nearest neighbours for a cell to be considered a core cell). To guide the users choice on parameters for graph-based clustering, a 3D figure illustrating how the final number of clusters depends to the used parameters can be generated. The Louvain algorithm requires only the <italic toggle="yes">resolution</italic> parameter. A line-plot illustrating how the resolution influences the number of identified clusters can be generated. As input, all clustering methods use either a distance matrix <inline-formula><tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {D}$\end{document}</tex-math></inline-formula> computed from <inline-formula><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {P}$\end{document}</tex-math></inline-formula> according to<disp-formula id="M4"><label>(4)</label><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \mathcal {D}=1-r(\mathcal {P}), \end{equation*}$$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$r(\mathcal {P})$\end{document}</tex-math></inline-formula> is the cell-to-cell similarity using correlation (Pearson (default in this manuscript), Spearman or Kendal) as a metric in the cell type space or an embedding of cells in PC space computed on the reference projection (not available with hierarchical clustering). The clustering result is visualized in a heatmap, including quality control (QC) metrics: number of detected genes (NODG), the percentage of mitochondrial genes (pMito) and the number of unique molecular identifiers (NUMI). Reference cell types with a low variance across all query cells are not shown. Figures are returned as <italic toggle="yes">ggplot2</italic> (<xref rid="B21" ref-type="bibr">21</xref>) objects, allowing further modifications by the user.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Reference panels</title>
      <p>RCA2 includes ten human reference panels as well as two mouse reference panels (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section 1</xref>). Multiple panels can be used for reference projections simultaneously. Furthermore, RCA2 provides users with the option to generate their own reference panel: the <italic toggle="yes">buildReferencePanel</italic> function considers a bulk gene expression matrix (genes as rows and replicates as columns) of raw counts and returns a reference panel that can be used with RCA2. Details are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 2.1</xref>.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Annotation of cell types</title>
      <p>RCA2 implements cell type assignment at the SC level following a strategy inspired by <sc>SingleR</sc> (<xref rid="B6" ref-type="bibr">6</xref>). From the projection matrix <inline-formula><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {P}$\end{document}</tex-math></inline-formula>, we identify, for each cell <italic toggle="yes">i</italic>, the cell type <italic toggle="yes">t</italic> associated to the highest score <italic toggle="yes">P</italic><sub><italic toggle="yes">i</italic></sub> according to<disp-formula id="M5"><label>(5)</label><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} t = argmax_i(\mathcal {P}_{i}), \end{equation*}$$\end{document}</tex-math></disp-formula>where <italic toggle="yes">argmax</italic><sub><italic toggle="yes">i</italic></sub> returns the column index corresponding to the cell type of the projection matrix <inline-formula><tex-math id="M38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {P}$\end{document}</tex-math></inline-formula> holding the highest correlation for cell <italic toggle="yes">i</italic>. Cluster composition plots elucidating the cell identity per cluster both in terms of absolute numbers and relative proportions can be generated as well.</p>
      <p>To annotate cell types on the cluster level, we consider the cell type composition for each cluster based on the SC cell type assignment described above. If the cell type distribution within a cluster is heterogeneous and the proportion of the major cell type is below a user defined threshold (default <inline-formula><tex-math id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$50\%$\end{document}</tex-math></inline-formula>), the cluster is labelled as <italic toggle="yes">Unknown</italic>. Further details are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 2.2</xref>.</p>
    </sec>
    <sec id="SEC2-5">
      <title>Cluster specific quality control</title>
      <p>Quality of scRNA-seq data is usually assessed using NODG, nUMI and pMito metrics. In applying uniform QC cutoffs across all cells, scRNA-seq datasets can suffer from cell type depletion. To alleviate this issue, RCA2 provides cluster-specific QC, allowing to impose upper/lower bounds on QC metrics for each cluster independently.</p>
    </sec>
    <sec id="SEC2-6">
      <title>Differentially expressed gene computation and enrichment analysis</title>
      <p>Differentially expressed genes (DEGs) are calculated between clusters, either in a <italic toggle="yes">1 versus all</italic> (default) or a <italic toggle="yes">pairwise</italic> fashion using a modified version of <sc>Seurat</sc>’s DEG calling module. We incorporated a mean expression threshold, which is either a user defined value or automatically determined as a trimmed mean excluding the top <italic toggle="yes">n</italic> (default: 5) genes with the highest expression. Gene’s with a cluster specific expression below the threshold are not considered for the DE test. In RCA2 the user can use one of the following tests for DEG calling: Wilcoxon rank sum test (default), likelihood-ratio test, ROC analysis and <italic toggle="yes">t</italic>-test. DEGs are used to perform enrichment analysis of GeneOntology (GO) terms or KEGG Pathways, for which <sc>RCA2</sc> incorporates the <sc>ClusterProfiler</sc> R-package (<xref rid="B22" ref-type="bibr">22</xref>). We retrieve the version number of the latest GO annotation from the <sc>org.Hs.eg.db</sc> R package. For KEGG, we send a <italic toggle="yes">GET</italic> request to the KEGG API at the time of analysis to retrieve the version number of the KEGG database used if the user decides to not use the version available in <sc>ClusterProfiler</sc>. By changing the version of <italic toggle="yes">org.Hs.eg.db</italic> or <sc>ClusterProfiler</sc>, the user can change the GO and KEGG database versions, respectively. By default, we consider cluster-specific background sets composed of genes expressed within each cluster. Alternatively, all genes expressed across all clusters or simply all genes available in the used annotation can be considered. Several options are available to distinguish expressed from not expressed genes: a numeric threshold, the 1st quartile, the mean, the median or the 3rd quartile of the distribution of mean gene-expression values within one or across all clusters. For each tested cluster, <sc>RCA2</sc> generates barplots, dotplots and GoPlots (if applicable). Further details are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 2.3</xref>.</p>
    </sec>
    <sec id="SEC2-7">
      <title>Considered scRNA-seq data sets and data processing</title>
      <sec id="SEC2-7-1">
        <title>10X PBMC data sets</title>
        <p>We downloaded scRNA-seq data of 5025 PBMCs generated using Chromium SC 3′ Reagent Kits v3 from 10× (single-cell-gene-expression/datasets/ 3.0.2/5k_pbmc_protein_v3). We applied the following QC thresholds (min, max): NODG (300, 4500), nUMI (100, ∞), pMito (0.025, 0.1). In total, 4,249 cells passed QC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The data set was projected against the <italic toggle="yes">Novershtern</italic> reference panel comprised of 15 hematopoietic cell types (<xref rid="B23" ref-type="bibr">23</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section 1</xref>).</p>
        <p>The resolution parameter used for Louvain clustering was determined using a grid-search with a step-size of 0.05. DEGs between clusters are computed in a pairwise-manner using the parameters:<italic toggle="yes">min.pct = 0.5, logfc.threshold = 0.5 and p_val_adj ≤ 0.05</italic>. GO terms were computed using <sc>ClusterProfiler</sc> utilising the <italic toggle="yes">org.Hs.eg.db</italic> database, and a q-value threshold of 0.05.</p>
      </sec>
      <sec id="SEC2-7-2">
        <title>CITE-seq PBMC data sets</title>
        <p>A Drop-Seq data set with 29,929 genes profiled in 7,985 cells and 10 antibodies was obtained from Stoeckius <italic toggle="yes">et al.</italic> (<xref rid="B25" ref-type="bibr">25</xref>). A CITE-seq data set with 7,865 cells profiled on 33,538 genes and 17 antibodies was obtained from 10× (single-cell-gene-expression/datasets/3.0.0/pbmc_10k_protein_v3). Both data sets were processed using <sc>Seurat</sc>. To obtain a ground truth, we clustered cells in antibody-derived tags (ADT) space. ADT data was normalized using the centered log ratio transformation (satijalab.org/seurat/v3.2/multimodal_vignette.html). All PCs were selected for clustering using Louvain clustering. Since the Drop-Seq data did not include a control for antibody detection, clusters exhibiting noisy antibody detection or those clusters not representing known immune cell type signature (<xref rid="B23" ref-type="bibr">23</xref>,<xref rid="B24" ref-type="bibr">24</xref>) were removed. In the 10x data, clusters showing <italic toggle="yes">IgG1</italic>, <italic toggle="yes">IgG2a</italic> or <italic toggle="yes">IgG2b</italic> and clusters showing promiscuous antibody expression were discarded. After QC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>), the Drop-Seq and 10× datasets contained 5,925 and 6,744 cells, respectively. The Drop-Seq and 10× data sets were next merged with respect to their common genes (13,267). The merged data set was provided as input to all clustering methods for benchmarking. Using <sc>Seurat</sc>’s FindMarker function, we computed batch specific marker genes for each ADT cluster in the merged data set using the parameters: <italic toggle="yes">min.pct = 0.5, logfc.threshold = 1.5 and p_val_adj ≤ 0.05</italic>. GO terms for batch specific clusters are computed using <sc>ClusterProfiler</sc> utilising the <italic toggle="yes">org.Hs.eg.db</italic> database, and a q-value threshold of 0.05.</p>
      </sec>
      <sec id="SEC2-7-3">
        <title>Rheumatoid arthritis scRNA-seq data set</title>
        <p>The scRNA-seq data set of 10,001 cells from Rheumatoid Arthritis (RA) samples, obtained from Zhang <italic toggle="yes">et al.</italic> (<xref rid="B26" ref-type="bibr">26</xref>), was processed using <sc>Seurat</sc>. Cells were filtered based on the QC criteria provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. This data was generated using CEL-Seq2 (<xref rid="B27" ref-type="bibr">27</xref>) after sorting for B cells (CD45+CD3-CD19+), T cells (CD45+CD3+), monocytes (CD45+CD14+), and stromal fibroblasts (CD45–CD31–PDPN+) from synovial tissues of ultrasound-guided biopsies or joint replacements of RA patients. Cell type annotation based on the authors cell sorting strategy is used as a ground truth. The resulting data set was used as input to all clustering methods for benchmarking.</p>
      </sec>
      <sec id="SEC2-7-4">
        <title>Bone-marrow scRNA-seq data set</title>
        <p>We obtained eight human bone marrow (BM) specimens from <italic toggle="yes">STEMCELL technologies</italic> and generated ten scRNA-seq data sets using the 10× 5’scRNA-seq protocol (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 2.4</xref>) by separating the cells into CD34+ and CD34– cell fractions followed by sequencing on a HiSeq4000. Preprocessing was done using the 10× CellRanger pipeline (3.0.1) using the <italic toggle="yes">hg38</italic> reference genome resulting in a data set comprised of 45,363 cells, capturing 24,206 genes. Considering only an initial requirement of at least 1000 nUMI, and a pMito rate between <inline-formula><tex-math id="M40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$2.5\%$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$10\%$\end{document}</tex-math></inline-formula>, we projected the data against RCA’s global panel obtaining a classification into major groups (resolution 0.1) to perform cluster specific QC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). Cluster specific QC values are chosen based on the outer most layer of the computed densities in the scatter plots. Final cell types were identified upon QC using a resolution of 0.5.</p>
        <p>Doublets were removed using <sc>DoubletFinder</sc> (<xref rid="B28" ref-type="bibr">28</xref>). <sc>DoubletFinder</sc> was run separately on the CD34+ and CD34- populations using 20 PCs and a pNN value of 0.25 as well as pk values of 0.005 and 0.01, respectively. The obtained <italic toggle="yes">pANN</italic> values were merged to rank cells based on their doublet neighbourhood. A <italic toggle="yes">pANN</italic> threshold was derived considering both the expected number of doublets (∼1,560) and by examining the proportion of possible doublets in each cluster.</p>
      </sec>
      <sec id="SEC2-7-5">
        <title>COVID-19 PBMCs</title>
        <p>A Seurat object with scRNA-seq data studied by Wilk <italic toggle="yes">et al.</italic> (<xref rid="B17" ref-type="bibr">17</xref>) was obtained from the COVID-19 Cell Atlas (covid19cellatlas.org). All 44,721 cells were projected against the global, Monaco, Novershtern and CITE-seq panel and clustered using the Louvain algorithm (resolution 1.3). Clusters were annotated according to reference projection profiles and marker gene expression. Marker genes for each subset of developing neutrophils are computed using the following DEG parameters: <italic toggle="yes">min.pct = 0.25, logfc.threshold = 1, and p_val_adj ≤ 0.05</italic>. Sub-clustering and cell embedding of CD14 monocytes, intermediate monocytes, CD16 monocytes, myeloid dendritic cells (mDC), myelocytes, neutrophils and plasmablasts was conducted using <sc>Seurat</sc>. The union set of pair-wise DEGs between these cell types was used as feature genes for PCA. DEGs were determined using the parameters: <italic toggle="yes">min.pct = 0.25, logfc.threshold = 1.5, and p_val_adj ≤ 0.05</italic>. For downstream clustering we used 18 PCs and annotated clusters using marker genes.</p>
      </sec>
      <sec id="SEC2-7-6">
        <title>AML dataset</title>
        <p>The AML data scRNA-seq data set <italic toggle="yes">809653</italic> was obtained from the zenodo archive of Petti <italic toggle="yes">et al.</italic> (<xref rid="B29" ref-type="bibr">29</xref>) at 10.5281/zenodo.3345981. No additional QC was performed. The data was projected using RCA2s Multi Panel Projection function with default parameters. The data was clustered using hierarchical clustering at deep split 1.</p>
      </sec>
    </sec>
    <sec id="SEC2-8">
      <title>Methods used for batch effect benchmarking</title>
      <p>To benchmark the batch effect robustness of <sc>RCA2</sc>, we considered <sc>Seurat</sc>, <sc>Seurat Integration</sc>, <sc>SCTransform</sc>, <sc>SCTransform Integration</sc>, <sc>Scran</sc> (<xref rid="B30" ref-type="bibr">30</xref>), <sc>Scanpy</sc>, <sc>MNNCorrect</sc> (<xref rid="B31" ref-type="bibr">31</xref>) and <sc>Scanorama</sc> (<xref rid="B32" ref-type="bibr">32</xref>). Below, we briefly describe how we utilized each method in the benchmarking experiments. Code is available in our Zenodo archive (10.5281/zenodo.4686335). We refer the reader to the respective publications for further method details.</p>
      <sec id="SEC2-8-1">
        <title>Seurat</title>
        <p>Seurat (version 3.2) was used as recommended in its documentation (satijalab.org/seurat/vignettes.html). We used the <italic toggle="yes">CreateSeuratObject</italic> function to create the Seurat object at default parameter settings. Then, we log-normalized the raw counts using <italic toggle="yes">NormalizeData</italic>, identified highly variable genes using <italic toggle="yes">FindVariableFeatures</italic>, scaled all genes using <italic toggle="yes">ScaleData</italic>, and ran principal component analysis using <italic toggle="yes">RunPCA</italic>, all at default settings. We then plotted an <italic toggle="yes">ElbowPlot</italic> of the variance explained versus number of principal components (PCs) to select the number of PCs to cluster cells and to be used in UMAP reductions.</p>
      </sec>
      <sec id="SEC2-8-2">
        <title>Seurat Integrated</title>
        <p>We split the Seurat object created above into its various batches using the <italic toggle="yes">SplitObject</italic> at default parameter settings. Then, we log-normalized the raw counts using <italic toggle="yes">NormalizeData</italic> and identified highly variable genes using <italic toggle="yes">FindVariableFeatures</italic> for each batch at default settings. We then ran <italic toggle="yes">FindIntegrationAnchors</italic> using <italic toggle="yes">dims</italic> = 1:30. The resulting anchors were used for <italic toggle="yes">IntegrateData</italic> with the aforementioned 30 dimensions. Then, we scaled all genes using <italic toggle="yes">ScaleData</italic>, and ran principal component analysis using <italic toggle="yes">RunPCA</italic>, all at default settings.</p>
      </sec>
      <sec id="SEC2-8-3">
        <title>SCTransform</title>
        <p>We used SCTransform (<xref rid="B33" ref-type="bibr">33</xref>) as part of our benchmarking approach. After creating the Seurat object, we used the <italic toggle="yes">SCTransform</italic> function at default settings, and ran PCA on the result. We used the <italic toggle="yes">ElbowPlot</italic> function to determine the optimal number of PCs, which we deemed to be 20.</p>
      </sec>
      <sec id="SEC2-8-4">
        <title>SCTransform Integrated</title>
        <p>We followed a similar approach as mentioned in the ‘Seurat Integrated’ subsection to split the object, and ran the <italic toggle="yes">SCTransform</italic> function on each batch separately. We then selected the top 3000 features for integration using the <italic toggle="yes">SelectIntegrationFeatures</italic> function, and ran the <italic toggle="yes">PrepSCTIntegration</italic> function to ensure that all necessary Pearson residuals have been calculated. We then ran <italic toggle="yes">FindIntegrationAnchors</italic>, specifying the normalization method used as ‘<italic toggle="yes">SCT</italic>’. The resulting anchors were used for <italic toggle="yes">IntegrateData</italic>.Then, we scaled all genes using <italic toggle="yes">ScaleData</italic>, and ran principal component analysis using <italic toggle="yes">RunPCA</italic>, all at default settings. We selected the top 30 PCs, as recommended in SCT Integration Workflow Vignette (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://satijalab.org/seurat/archive/v3.0/integration.html" ext-link-type="uri">https://satijalab.org/seurat/archive/v3.0/integration.html</ext-link>).</p>
      </sec>
      <sec id="SEC2-8-5">
        <title>Scran</title>
        <p>For Scran (version 1.18.1), we followed the tutorial from bioconductor (bioconductor.org/packages/ release/bioc/html/scran.html). We used the <italic toggle="yes">SingleCellExperiment</italic> function to create a SingleCellExperiment object. We computed sum factors using <italic toggle="yes">computeSumFactors</italic>, log-normalized the counts using <italic toggle="yes">logNormCounts</italic> and modeled the variance of each gene using <italic toggle="yes">modelGeneVar</italic>. We then identified highly variable genes using <italic toggle="yes">getTopHVGs</italic> (<italic toggle="yes">FDR</italic> ≤ 0.05) and ran PCA using these features. PCs corresponding to technical noise were removed using the <italic toggle="yes">denoisePCA</italic> function at default settings.</p>
      </sec>
      <sec id="SEC2-8-6">
        <title>MNNCorrect</title>
        <p>We used MNNCorrect (batchelor R package (version 1.6)) according to bioconductor.org/packages/release/bioc/html/batchelor.html. We create a separate SingleCellExperiment object for each batch, and for each object, computed sum factors, normalized, modeled gene variance using trendVar and decomposeVar - all at default settings. We then used <italic toggle="yes">combineVar</italic> to merge the decomposed variance objects, and identified chosen HVGs as those with a biological component &gt;0. Using these chosen HVGs, we ran <italic toggle="yes">fastMNN</italic> to obtain a reduced dimensional representation of the integrated dataset.</p>
      </sec>
      <sec id="SEC2-8-7">
        <title>Scanpy</title>
        <p>Furthermore, we used Scanpy (version 1.5.1) (scanpy.readthedocs.io/en/stable/). To transfer the raw counts from R to Python, we saved them into a CSV file, and loaded the CSV file into an <italic toggle="yes">AnnData</italic> object using the <italic toggle="yes">read_csv()</italic> function. We normalized the counts using <italic toggle="yes">normalize_total</italic>, with <inline-formula><tex-math id="M42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$target\_sum = 1e4$\end{document}</tex-math></inline-formula>, and log-transformed these normalized counts using the <italic toggle="yes">log1p</italic> function. We then identified HVGs using the <italic toggle="yes">highly_variable_genes</italic> function, and scaled these genes with <inline-formula><tex-math id="M43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$max\_value = 10$\end{document}</tex-math></inline-formula>. Then, PCA was performed using Scanpy’s <italic toggle="yes">pca</italic> function at default settings, and used the <italic toggle="yes">pca_variance_ratio</italic> function to determine the elbow point of 20 PCs for both the CITE-Seq and RA datasets.</p>
      </sec>
      <sec id="SEC2-8-8">
        <title>Scanorama</title>
        <p>Scanorama (version 1.6) was used for this analysis, using the tutorial provided at nbisweden.github.io/workshop-scRNAseq. We split the <italic toggle="yes">AnnData</italic> object generated above into batches, and used the list of batches as input to the <italic toggle="yes">integrate_scanpy</italic> function. We used the resulting integrated dataset as the reduced dimensional representation for both the CITE-Seq and RA datasets.</p>
      </sec>
    </sec>
    <sec id="SEC2-9">
      <title>Silhouette Index for quantifying batch effect</title>
      <p>The Silhouette Index (SI) of a cell measures how similar a cell is to other cells within its own cluster, relative to cells in other clusters (<xref rid="B34" ref-type="bibr">34</xref>). We compute SI <italic toggle="yes">S</italic>(<italic toggle="yes">x</italic>) for each cell <italic toggle="yes">x</italic> in the DE gene-space defined by CITE-Seq antibody tags:<disp-formula id="M6"><label>(6)</label><tex-math id="M44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} S(x)=\frac{o(x)-w(x)}{max(o(x),w(x))}, \end{equation*}$$\end{document}</tex-math></disp-formula>where <italic toggle="yes">o</italic>(<italic toggle="yes">x</italic>) is the smallest mean between-cluster distance and <inline-formula><tex-math id="M45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$w$\end{document}</tex-math></inline-formula>(<italic toggle="yes">x</italic>) is the mean within-cluster distance for cell <italic toggle="yes">x</italic> defined as<disp-formula id="M7"><label>(7)</label><tex-math id="M46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{eqnarray*} o(x) &amp;=&amp; \min _{c_z\ne c_x}\frac{1}{|c_z|}\sum \limits _{y \in c_z} d(x,y), w(x) \nonumber \\ &amp;=&amp; \frac{1}{|c_x|-1}\sum \limits _{y \in c_x, x\ne y}d(x,y), \end{eqnarray*}$$\end{document}</tex-math></disp-formula>where we use Euclidean distance to compute the distance <italic toggle="yes">d</italic>(<italic toggle="yes">x</italic>, <italic toggle="yes">y</italic>) between cell <italic toggle="yes">x</italic> and cell <italic toggle="yes">y</italic>, <inline-formula><tex-math id="M47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$c_x \in \mathcal {C}$\end{document}</tex-math></inline-formula> is the cluster assigned to cell <italic toggle="yes">x</italic> and |<italic toggle="yes">c</italic><sub><italic toggle="yes">x</italic></sub>| is the size of that cluster. We obtain the average SI for each cluster by averaging the SI values over all cells in that cluster. Thereby, each cell type is given equal weight in the final SI score.</p>
      <p>For <sc>Seurat</sc>, <sc>Seurat Integration</sc>, <sc>scran</sc>, <sc>MNNCorrect</sc> and <sc>Scanpy</sc>, cell-cell distances are calculated in principal component (PC) space considering the top 20 PCs. For <sc>Scanorama</sc>, the dimensionality was fixed to 100, as recommended by the authors. For <sc>Rca</sc>, cell-cell distances were calculated in the reference projection space.</p>
    </sec>
    <sec id="SEC2-10">
      <title>Implementation</title>
      <p>RCA2 is freely available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.github.com/prabhakarlab/RCAv2" ext-link-type="uri">www.github.com/prabhakarlab/RCAv2</ext-link>. The github contains detailed tutorials in the README as well as in the vignettes. <sc>RCA2</sc> is extensively tested with <monospace>R</monospace> versions ≥3.6 on Windows, Linux and Mac devices. To ensure robustness and correctness, we have incorporated unit tests and have also ensured that all CRAN and devtools checks are passed.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>Novel and improved features of RCA2</title>
      <p>The <sc>RCA2</sc> workflow is shown in Figure <xref rid="F1" ref-type="fig">1</xref>. As input, <sc>RCA2</sc> takes either raw or pre-processed scRNA-seq data and facilitates QC either as a single operation on all cells or in a cluster-specific manner (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S1 and S2</xref>). Unlike the original <sc>Rca</sc>, <sc>RCA2</sc> provides a function to directly load the raw output of the 10× <sc>CellRanger</sc> software, which is a commonly used preprocessing pipeline for prevalent single cell 10× data.</p>
      <fig position="float" id="F1">
        <label>Figure 1.</label>
        <caption>
          <p>RCA2 takes two types of scRNA-seq data as input: (i) CellRanger output files and (ii) data preprocessed elsewhere, which can be loaded as a gene × cell count matrix. Reference datasets in RCA2 for human and mouse are based on bulk RNA-seq, microarray and scRNA-seq assays. RCA2 can also generate custom reference panels from user-supplied raw count matrices. RCA2 computes a correlation matrix representing the similarity of each SC transcriptome to each reference transcriptome. Correlations are calculated using marker (DE) genes from the reference panel. Cells are clustered and visualized in the space of reference projections. After DE gene analysis, enriched GO terms and KEGG pathways can be identified.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab632fig1" position="float"/>
      </fig>
      <p>While the first release of <sc>Rca</sc> provided one human reference panel only, <sc>RCA2</sc> includes eleven panels, for instance a microarray-based human cord blood cell panel with 15 immune cell types (<xref rid="B23" ref-type="bibr">23</xref>), one related RNA-seq panel with 28 human immune cell types (<xref rid="B24" ref-type="bibr">24</xref>), a panel based on CITE-seq data containing 34 primary human cell types (<xref rid="B35" ref-type="bibr">35</xref>), one human primary cell type panel based on ENCODE (<xref rid="B36" ref-type="bibr">36</xref>) RNA-seq data containing 97 cell types and a mouse ENCODE panel with 15 cell types. A list of all panels as well as guidelines on how to choose panels are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 1</xref>. In contrast to the previous version, <sc>RCA2</sc> offers means for <italic toggle="yes">de-novo</italic> panel generation from user-provided transcriptomes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Section 2.4</xref>). Another novel feature of <sc>RCA2</sc> is that it allows SC data to be projected against several reference panels at the same time. Furthermore, <sc>RCA2</sc> offers a significant speed up of several folds in computing the reference projection compared to the previous release. (Figure <xref rid="F2" ref-type="fig">2A</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 2.5</xref>).</p>
      <fig position="float" id="F2">
        <label>Figure 2.</label>
        <caption>
          <p>(<bold>A</bold>) Speedup of the reference projection step. (<bold>B</bold>) Memory consumption of graph-based clustering compared to hierarchical clustering. Benchmarking was performed with a notebook using an Intel i9-9980 CPU(2.40 GHz) and 64GB RAM. Projecting using RCAv1 and hierarchical clustering ran out of memory using 100k cells and 50k cells, respectively.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab632fig2" position="float"/>
      </fig>
      <p>RCA is based on hierarchical clustering, which is challenging on large datasets since the memory complexity scales as the square of the number of cells. One fundamental change is that RCA2 uses Louvain graph-based clustering as the default, instead of hierarchical clustering. The graph-based clustering approach requires orders of magnitude less memory (<inline-formula><tex-math id="M48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}(nk)$\end{document}</tex-math></inline-formula> versus <inline-formula><tex-math id="M49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {O}(n^2)$\end{document}</tex-math></inline-formula>, where <italic toggle="yes">n</italic> is the number of cells and <italic toggle="yes">k</italic> is the number of nearest neighbours (Figure <xref rid="F2" ref-type="fig">2</xref> B; <xref rid="sup1" ref-type="supplementary-material">Supplementary Section 2.5</xref>)). As an additional option, <sc>RCA2</sc> provides a memory-efficient implementation of hierarchical clustering (<xref rid="B37" ref-type="bibr">37</xref>). To aid in parameter selection for graph-based clustering <sc>RCA2</sc> provides visualizations on how parameter settings influence the number of clusters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S3 and S4</xref>). Further improvements for scalability include parallelization and use of sparse data structures. Together, these modifications allow <sc>RCA2</sc> to scale in principle to datasets comprising millions of cells.</p>
      <p>Note that, unlike other SC clustering frameworks, <sc>Rca</sc> utilizes the reference projection to cluster cells in a cell type space instead of a high-dimensional feature gene-space. Clustering results can be visualised using newly implemented 2D and 3D UMAP (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S5 and S6</xref>) representations of the reference projection (cell type) space. Compared to the previous heatmap visualization of the reference projection matrix, <sc>RCA2</sc> shows additional QC information (NODG, nUMI, pMito) and removes cell types not showing significant variation in the correlation score to facilitate data interpretation and outlier detection.</p>
      <p>To further enrich the functionality of <sc>RCA2</sc> compared to its predecessor, we incorporated <sc>singleR</sc>/<sc>scMatch</sc>-like assignment of cell types to individual cells (<xref rid="B6" ref-type="bibr">6</xref>,<xref rid="B7" ref-type="bibr">7</xref>). Exploiting <sc>RCA2’s</sc> clustering algorithms, we also allow cell type annotation on the cluster level (see Materials and Methods).</p>
      <p>For further biological interpretation, which was not in the scope of the previous version of RCA, <sc>RCA2</sc> offers various statistical tests to identify DEGs in either a <italic toggle="yes">1 versus all</italic> or a <italic toggle="yes">pairwise</italic> scheme. DEGs are visualized in heatmaps following the established <sc>Seurat</sc> color scheme (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7</xref>) and can be used as input for a GO-term (<xref rid="B38" ref-type="bibr">38</xref>) enrichment and KEGG pathway (<xref rid="B39" ref-type="bibr">39</xref>) analysis, providing biological insights on clusters beyond lists of marker genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S8</xref>).</p>
      <p>A summary of new features and methodological advances in <sc>RCA2</sc> compared to the initial release is provided in Table <xref rid="tbl1" ref-type="table">1</xref>.</p>
      <table-wrap position="float" id="tbl1">
        <label>Table 1.</label>
        <caption>
          <p>Methodological improvements and new features in RCA2 compared to the prototype release</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">
                <sc>Rca</sc>
              </th>
              <th rowspan="1" colspan="1">
                <sc>RCA2</sc>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Reference panels</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">11</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Species supported</td>
              <td rowspan="1" colspan="1">Human</td>
              <td rowspan="1" colspan="1">Human, mouse</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Data import</td>
              <td rowspan="1" colspan="1">Count matrix</td>
              <td rowspan="1" colspan="1">10x file import, Count matrix</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Custom panel usage</td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Custom panel generation</td>
              <td rowspan="1" colspan="1">Not supported</td>
              <td rowspan="1" colspan="1">Automated</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Clustering</td>
              <td rowspan="1" colspan="1">Hierarchical (basic)</td>
              <td rowspan="1" colspan="1">Hierarchical (divide-and-conquer), graph-based</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Data structures</td>
              <td rowspan="1" colspan="1">Standard</td>
              <td rowspan="1" colspan="1">Sparse data structures</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Clustering in</td>
              <td rowspan="1" colspan="1">full projection space</td>
              <td rowspan="1" colspan="1">full or PCA reduced projection space</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Cell type/cluster specific QC</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Parallelized correlation computation</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">Yes, if applicable</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">UMAP visualizations</td>
              <td rowspan="1" colspan="1">2D</td>
              <td rowspan="1" colspan="1">2D,3D</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Cell type annotation</td>
              <td rowspan="1" colspan="1">Not supported</td>
              <td rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Easy integration in existing workflows</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">DEG calling</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">1 vs all and pairwise</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Enrichment analysis</td>
              <td rowspan="1" colspan="1">None</td>
              <td rowspan="1" colspan="1">KEGG and GO</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Number of UNIT tests</td>
              <td rowspan="1" colspan="1">0 unit tests</td>
              <td rowspan="1" colspan="1">90 unit tests</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Tutorials and documentation</td>
              <td rowspan="1" colspan="1">Limited documentation</td>
              <td rowspan="1" colspan="1">Extensive manual and R-vignette</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Applicable to datasets &gt;20 000 cells</td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">Yes</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="SEC3-2">
      <title>Supervised clustering is robust to batch effects</title>
      <p>One of the major advantages of supervised clustering is its ability to reduce the contribution of unwanted variation, which manifests in the form of noise or technical variation. This is crucial in the prevention of batch effects. By projecting SC data onto a reference panel of purified transcriptomes, supervised clustering is able to preserve the cell type-specific variation and ignore variation from other sources. This is based on the concept shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S9</xref>, i.e. the batch effect expression signature is likely to be orthogonal to the signature of cell type marker genes, because two randomly selected vectors are likely to be orthogonal in a high dimensional space.</p>
      <p>We benchmarked <sc>RCA2’s</sc> robustness to batch effects by comparing its performance against several other commonly used scRNA-seq clustering algorithms (see Methods): <sc>Seurat</sc>, <sc>Seurat</sc> with <sc>SCTransform</sc> normalization, <sc>Seurat Integration</sc>, <sc>SCTransform Integration</sc>, <sc>Scran</sc>, <sc>Scanpy</sc>, <sc>MNN Correct</sc> and <sc>Scanorama</sc>, significantly exceeding the benchmarking of the initial RCA version.</p>
      <p>We benchmarked <sc>RCA2</sc> on two data sets that provide a ground truth for cell type identity that is independent from scRNA-seq data: (i) a dataset of joint synovial tissues from Rheumatoid Arthritis (RA) patients with plate- and donor-specific batch effects (<xref rid="B26" ref-type="bibr">26</xref>) and a (ii) PBMC CITE-seq data sequenced using (a) Drop-Seq and (b) 10× Chromium platforms (<xref rid="B25" ref-type="bibr">25</xref>). Further details are provided below. We used the Silhouette Index (SI) to quantify grouping of cells by batch or by cell type (<xref rid="B34" ref-type="bibr">34</xref>). Note that a robust method should have low batch SI and high cell type SI, indicating that cells are separated by cell type rather than by batch.</p>
      <sec id="SEC3-2-1">
        <title>Rheumatoid arthritis (RA) data set benchmarking</title>
        <p>We use a data set by Zhang <italic toggle="yes">et al.</italic> (<xref rid="B26" ref-type="bibr">26</xref>) comprised of 5,829 cells from 51 RA samples sequenced on 24 384-well plates. Cells have been FACS sorted into T cells, B cells, monocytes, and fibroblasts, which we use as ground-truth cell type labels. Zhang <italic toggle="yes">et al.</italic> detected plate-specific batch effects while clustering cells using the <sc>Seurat</sc> package. These plate-specific batch effects were more pronounced in some plates as compared to others. Here, <sc>RCA2</sc> considerably outperforms the other tested algorithms in terms of cell type separation (Figure <xref rid="F3" ref-type="fig">3A</xref>) but also in terms of batch robustness. While data from different plates is readily merged together (Figure <xref rid="F3" ref-type="fig">3B</xref>) cells cluster well according to their FACS determined cell type (Figure <xref rid="F3" ref-type="fig">3C</xref>). We observed that using <sc>SCTransform</sc> in the <sc>Seurat Integration</sc> workflow worsened both separation by batch and separation by cell type.</p>
        <fig position="float" id="F3">
          <label>Figure 3.</label>
          <caption>
            <p>(<bold>A</bold>) Silhouette Index (SI) measuring separation of cells in RA data by plate and cell type. (B, C) UMAP visualization of RCA2 clustering of RA data colored by (<bold>B</bold>) plate and (<bold>C</bold>) cell type. (<bold>D</bold>) SI measuring separation of cells in CITE-Seq data by protocol and cell type. (E, F) UMAP visualization of RCA2 clustering of CITE-Seq data colored by (<bold>E</bold>) protocol and (<bold>F</bold>) cell type.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab632fig3" position="float"/>
        </fig>
      </sec>
      <sec id="SEC3-2-2">
        <title>Cite-seq data set benchmarking</title>
        <p>Next, we considered PBMC CITE-seq data sequenced using (a) Drop-Seq and (b) 10× Chromium that were analysed together as a single dataset. CITE-Seq data contains both the protein abundance of cells and their transcriptomic profile. The protein quantification can be used to define ground-truth cell type labels independently of the transcriptome data. Specifically, we used <sc>Seurat</sc> to cluster SCs in protein abundance space and defined each resulting cluster as a ground-truth cell type (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S10</xref>) (Materials and Methods).</p>
        <p>Benchmarking on the CITE-Seq data showed that <sc>Seurat Integrated</sc>, <sc>MNN Correct</sc> and <sc>Scanorama</sc> successfully reduced batch effects, similar to <sc>RCA2</sc>. However, that was achieved at the cost of worsening cell type separation (Figure <xref rid="F3" ref-type="fig">3D</xref>). <sc>Seurat</sc> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S11</xref>), <sc>Scran</sc> and <sc>Scanpy</sc> produced clustering results significantly affected by protocol, with <sc>Scanpy</sc> performing as the best among all unsupervised approaches without explicit batch correction in terms of cell type separation. We note that the usage of <sc>SCTransform</sc> worsened the batch susceptibility in this use-case if the data integration feature was not used. <sc>RCA2</sc> was among the top methods in terms of batch robustness (Figure <xref rid="F3" ref-type="fig">3E</xref>) and provided the best separation of cell types (Figure <xref rid="F3" ref-type="fig">3F</xref>).</p>
        <p>Using ADT-tags of the CITE-seq data, we are able to characterize the batch not only from a technical perspective using the SI, but also from a biological point of view: we computed the set of DEGs (see Methods) that characterizes the SC capture protocol batch within each ADT cluster (Figure <xref rid="F4" ref-type="fig">4A</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). While the majority of DEGs are ribosomal genes, we also find several genes that are both cell type and batch specific markers, such as <italic toggle="yes">H3F3A</italic>, <italic toggle="yes">IGKC</italic>, <italic toggle="yes">IFI30</italic> or <italic toggle="yes">IGLC2</italic>. The latter three are related to immune reaction and gamma-interferon signaling. Another interesting gene that is associated to the batch is <italic toggle="yes">FOS</italic>, which has been associated to several molecular processes and has been linked to cancer progression (<xref rid="B40" ref-type="bibr">40</xref>). As it is known that the expression of <italic toggle="yes">FOS</italic> can be easily changed by external stimuli (<xref rid="B41" ref-type="bibr">41</xref>), it might be more likely that, in our data set, the observed differences in <italic toggle="yes">FOS</italic> expression are of technical instead of biological nature. Indeed, the <sc>RCA2</sc> projection, shown in Figure <xref rid="F4" ref-type="fig">4</xref> B, is not affected by any of the DEGs linked to the batch effects and is supporting the antibody based clustering well. The latter is also backed up by the expression of the genes targeted by the antibodies (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref>).</p>
        <fig position="float" id="F4">
          <label>Figure 4.</label>
          <caption>
            <p>(<bold>A</bold>) Expression of DEG computed for sequencing protocol batch within ADT clusters. (<bold>B</bold>) Reference projection of the CITE-seq data against <sc>RCA2’s</sc> global panel.</p>
          </caption>
          <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab632fig4" position="float"/>
        </fig>
        <p>To characterize the genes defining the observed batch further, we investigated their GO term enrichment separately for genes expressed in the 10X batch (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S13</xref>) and the Drop-seq batch (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S14</xref>). All of the observed GO terms can be exclusively explained by the difference in sequencing protocol and therefore potentially misguide down-stream analysis, if less robust clustering methods are used.</p>
        <p>We investigated this hypothesis by computing cluster specific marker genes for clusters identified with various scRNA-seq pipelines, using the same parameters and settings for the DEG tests in all methods (Wilcox test, <inline-formula><tex-math id="M50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$p\_val\_adj\le 0.05$\end{document}</tex-math></inline-formula>). We compared those method specific DEGs to the set of batch specific DEGs, shown in Figure <xref rid="F4" ref-type="fig">4A</xref>, using an Upset plot (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S15</xref>). Indeed, <sc>RCA2</sc> shows the lowest overlap between cluster specific marker genes and the set of batch DEGs compared to the other methods, underlining the robustness of supervised clustering as implemented in <sc>RCA2</sc> towards batch effects even further.</p>
      </sec>
    </sec>
    <sec id="SEC3-3">
      <title>Use-case on 10X PBMC data set comprising 5,000 cells</title>
      <p>We obtained a 10X Genomics dataset containing 5,025 peripheral blood mono nuclear cells (PBMCs) from a healthy donor. We imported the CellRanger output directly into RCA, considering cells with a UMI count ≥ 100.</p>
      <p>Upon QC using <sc>RCA2’s</sc> QC functionality (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S15, Table S1</xref>), the scRNA-seq data is projected against a new, manually curated reference panel of immune cell types, based on purified populations of human hematopoietic cells (<xref rid="B23" ref-type="bibr">23</xref>). We utilized the novel integration of the Louvain graph-based clustering algorithm into <sc>RCA2</sc> to cluster the data using a resolution of 0.1, which leads to a sensible separation of cells in terms of the projection heatmap (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S16</xref>) as well as in the resulting number of clusters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>). We obtained nine clusters forming four disconnected islands in a UMAP based on the cell to cell type correlation space obtained by the reference projection (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S17a</xref>).</p>
      <p><sc>RCA2’s</sc> new, <sc>SingleR</sc>-inspired automated cluster annotation function determines cell types, shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S17b</xref>. While the B-cell cluster (red) is very distinct from all remaining clusters, T and natural killer cells form a continuum (blue, brown, yellow, green). Monocytes (turquiose) and non-classical monocytes (black) appear to be well separated within a major myeloid cluster. In close proximity in UMAP space, small populations of myeloid (pink) and plasmacytoid (magenta) dendritic cells were identified. While the automatically determined labels agree with the projection heatmap shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S17a</xref>, this can be expected by the design of RCA2 and the projection step. Therefore, we use canonical marker genes, which are considered for instance also in the <sc>Seurat</sc> tutorial, to verify cell types. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S17c–j</xref>, the abundance of the various marker genes corresponds well to the identified clusters. Note that for some cell types more than one marker gene should be considered, e.g. CD14 and CD16 for non-classical monocytes or CD8A and NKG7 for natural killer cells, respectively.</p>
      <p>To further characterize the clusters, we compute DEGs using <sc>RCA2’s</sc> default settings in a pair-wise manner (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7b</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref> lists all identified DEGs. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S18</xref>, we obtain several significant terms in GO term analysis using these DE genes for the natural killer cell cluster including <italic toggle="yes">cytolysis</italic>, <italic toggle="yes">cell killing</italic> and <italic toggle="yes">cellular defense response</italic>. These are well matching to the expected biological function of natural killer cells. Also, for the naive CD4+ T-cell cluster we obtain sensible terms such as <italic toggle="yes">adaptive immune response</italic>, <italic toggle="yes">immune response-activating cell surface receptor signaling pathways</italic>, and <italic toggle="yes">activation of immune response</italic> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S19</xref>).</p>
      <p>This example illustrates that RCA2 allows a hassle-free analysis to characterize clusters with minimal manual efforts. The example can be reproduced by following the tutorial provided both in the github READMe as well as in the packages vignette.</p>
    </sec>
    <sec id="SEC3-4">
      <title>Cluster specific quality control is essential to retain high-quality cells in complex data sets</title>
      <p>Here, we consider four novel human bone marrow specimens separated into CD34+ and CD34– fractions (Materials and Methods). By clustering the <sc>RCA2</sc> reference projection using Louvain clustering with a resolution of 0.1, we find ten clusters representing major cell types (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S20</xref>). With <sc>RCA2’s</sc> new cluster specific QC function, we observed that the various cell types included in the dataset do require different QC thresholds (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S21</xref>). For instance, the average NODG for the lymphoid population, e.g. B or T cells, is around 1,000, while the NODG of progenitor cells can be up to three fold higher. Similarly, the percentage of mitochondrial reads shows different distributions. While it has low standard deviation for Pro-B cells, its values spread out widely e.g. for Classical Monocytes. As indicated by the color code in Figure <xref rid="F5" ref-type="fig">5A</xref>, cluster agnostic thresholds (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S22</xref>) would result in a substantial loss of cells, which is quantified for the final clusters in Figure <xref rid="F5" ref-type="fig">5B</xref> and clearly illustrates the importance of a (major) cell type specific QC. Final cell type specific QC thresholds are listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>. They were chosen based on the outer most layer of the computed densities in the cluster specific scatter plots (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S21</xref>).</p>
      <fig position="float" id="F5">
        <label>Figure 5.</label>
        <caption>
          <p>(<bold>A</bold>) Cluster-specific QC based on NODG and pMito. Colors indicates whether cells are discarded (red, blue) or retained (black) if general, cluster-unspecific QC would be used. (<bold>B</bold>) Proportions of cells discarded per cell type using cluster unspecific QC. (<bold>C</bold>) UMAP reduction of a multi panel RCA2 projection coloured by cell type using a resolution of 0.5.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab632fig5" position="float"/>
      </fig>
      <p>Upon QC on the level of major cell types, we used <sc>RCA2</sc> to define cell types on a more detailed level. Using Louvain clustering, we found the most convincing clustering in terms of the projection heatmap using a resolution of 0.5. Doublets have been removed at this stage with <sc>DoubletFinder</sc> (<xref rid="B28" ref-type="bibr">28</xref>) using the 0.97 quantile of all <italic toggle="yes">pANN</italic> values as a threshold, resulting in the identification and removal of 906 doublets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S23</xref>) retaining 31,081 cells. Final cell type annotations, based on projection scores (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S24</xref>) and backed up with DEGs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S25, Table S5</xref>) as well as canonical markers (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S26</xref>), are indicated in the UMAP representation of the <sc>RCA2</sc> projection shown in Figure <xref rid="F5" ref-type="fig">5C</xref>.</p>
      <p>We separated the bone marrow data into two populations using magnetic bead selection as cells that are either positive or negative for the progenitor marker CD34 (<xref rid="B42" ref-type="bibr">42</xref>). As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S27</xref>, the <sc>RCA2</sc> reference projection based UMAP of the scRNA-seq data shows distinct levels of CD34 MACS labels. These match well to the identified cell types shown in Figure <xref rid="F5" ref-type="fig">5</xref> C.</p>
      <p>For example, hematopoietic stem/progenitor clusters (HSPC), i.e. HSC/MPP, LyP-1, ERP, MEP, MyP-1 and MyP-2, representing progenitor populations are almost completely composed of cells with a CD34+ MACS label, while clusters such as B cells or Classical Monocytes, that are composed of differentiated cells are enriched for cells with a CD34- label (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S28a</xref>). However, we note that some clusters like naive T cells and non-classical monocytes also had a small contribution of <inline-formula><tex-math id="M51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\sim 10\%-15\%$\end{document}</tex-math></inline-formula> from cells labelled as CD34+ cells by our MACS sorting strategy. This is not unexpected because our workflow for purifying HSPCs lacks a prior conventional lineage-depletion (lin-) step in which cells are immuno-depleted for differentiated cells such as T, B, NK and monocytes by incubating them with antibody-cocktails recognising these cell types. CD34+ populations within the bone marrow are known to be heterogeneous and lin- CD34+ populations were shown to mainly harbour stem cell activity (<xref rid="B43" ref-type="bibr">43</xref>). Hence, our MACS sorting strategy is expected to deliver false positives in the form of cells that are retained in the CD34+ magnetic columns but are in reality differentiated cells. However, <sc>RCA2</sc> is able to identify such lineage+CD34+ cells and clusters them correctly based on their transcriptome. Thus, <sc>RCA2</sc> offers a more precise in-silico alternative to the conventional lineage-depletion step for HSPC studies. Compared to an analysis with Seurat using default parameters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S28b</xref>), <sc>RCA2</sc> achieves a better purity: In only <inline-formula><tex-math id="M52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$10.05\%$\end{document}</tex-math></inline-formula> of <sc>RCA2</sc> clusters, the impurity is <inline-formula><tex-math id="M53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$&gt;20\%$\end{document}</tex-math></inline-formula>, compared to <inline-formula><tex-math id="M54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$19.05\%$\end{document}</tex-math></inline-formula> using Seurat. The validity of our approach is also supported by the fact that cell type proportions are in agreement with earlier studies (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S29</xref>).</p>
      <p>This example illustrates the ability of <sc>RCA2</sc> to seamlessly derive meaningful annotations and dimensionality reductions even in large, highly complex datasets where cells are placed in a continuum and the reference set might not contain exactly matching cell types.</p>
    </sec>
    <sec id="SEC3-5">
      <title>RCA2 clusters PBMCs from COVID-19 patients more robustly than <italic toggle="yes">de-novo</italic> clustering</title>
      <p>Using PBMC scRNA-seq data obtained from seven COVID-19 patients and six healthy donors, Wilk <italic toggle="yes">et al.</italic> reported a (myeloid) <italic toggle="yes">developing neutrophil</italic> (DN) population apparently derived from (lymphoid) plasmablasts (<xref rid="B17" ref-type="bibr">17</xref>). This interpretation, which was based on a UMAP plot, deviated from the prior expectation that terminally differentiated lymphoid cells would not trans-differentiate to a myeloid lineage (<xref rid="B44" ref-type="bibr">44</xref>). We therefore re-clustered the 44,721 cells analyzed by Wilk <italic toggle="yes">et al.</italic> using <sc>RCA2</sc> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S30 and S31a</xref>). Notably, the UMAP plot based on <sc>RCA2’s</sc> reference projection did not support trans-differentiation of plasmablasts into DN cells (Figure <xref rid="F6" ref-type="fig">6A</xref>). Rather, the cells annotated as DN cells were grouped with other myeloid cells. Specifically, <sc>RCA2</sc> placed some DNs within the CD14+ monocyte cluster (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S32b</xref>), a majority in a cluster resembling myelocytes (immature granulocytes) and some within a debris-like cluster that bridged the two (Figure <xref rid="F6" ref-type="fig">6</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S31b–d and S32</xref>). Thus, supervised clustering using <sc>RCA2</sc> yielded cluster assignments for DN cells that were more consistent with known markers and also more consistent with the known developmental separation between myeloid and lymphoid lineages.</p>
      <fig position="float" id="F6">
        <label>Figure 6.</label>
        <caption>
          <p>(<bold>A</bold>) UMAP shows the RCA2 clustering of cells from the COVID-19 study by Wilk <italic toggle="yes">et al.</italic> (<bold>B</bold>) The location of developing neutrophils annotated by Wilk <italic toggle="yes">et al.</italic> are marked as red dots in the RCA2 UMAP. (<bold>C</bold>) Bubble plot shows the marker gene expression levels across the cell types shown in a. Bubble size indicates expression percentage within each cell type, while color intensity represents scaled expression levels. (<bold>D</bold>) UMAP plot showing the cell clustering using the <italic toggle="yes">de-novo</italic> analysis pipeline and cell-type annotation by Wilk <italic toggle="yes">et al.</italic> (<bold>E</bold>) UMAPs showing marker gene expression and data quality. Markers are shown for developing neutrophils (CEACAM8, LTF, ELANE), plasmablasts (CD38), red blood cells (HBB), T cells (CD4, CD3D), B cells (CD20), NK and cytotoxic T cells (GZMA, NKG7). Number of detected genes (NODG, orange) is shown as a measure of cell quality and debris-like cells that co-express markers of diverse cell types are indicated in red.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab632fig6" position="float"/>
      </fig>
      <p>We then attempted to ascertain the cause of the unexpected clustering result reported by Wilk <italic toggle="yes">et al.</italic>, which had connected myeloid DN cells to lymphoid plasmablasts. To this end, we used <italic toggle="yes">de-novo</italic> clustering and reproduced their UMAP plot, which showed a population of bridging cells between DNs and IgM plasmablasts (Figure <xref rid="F6" ref-type="fig">6D</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S33</xref>). As shown in Figure <xref rid="F6" ref-type="fig">6E</xref>, DN cells expressed the general neutrophil marker CEACAM8 (<xref rid="B45" ref-type="bibr">45</xref>) as well as neutrophil subtype markers LTF (<xref rid="B46" ref-type="bibr">46</xref>) and ELANE (<xref rid="B47" ref-type="bibr">47</xref>), indicating that they did indeed belong to the neutrophil lineage. However, they did not express the key plasmablast marker CD38 (<xref rid="B48" ref-type="bibr">48</xref>). CD38 was also absent in the bridging cells. Most surprisingly, CD38 was missing even in the adjacent IgM plasmablast population. Since the bridging cells and IgM plasmablasts expressed neither neutrophil nor plasmablast markers, we hypothesized that these two populations may in fact have been mis-annotated. Indeed, we found that the debris-like cells described above accounted for most of the bridging cells and IgM plasmablasts (Figure <xref rid="F6" ref-type="fig">6C</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S31b-d</xref>). Consistently with their classification as debris-like, these cells had lower data quality (NODG) than other plasmablasts and expressed markers of multiple distinct cell types, such as T, B, NK and red blood cells (HBB, CD3D, CD20 and NKG7; Figure <xref rid="F6" ref-type="fig">6E</xref>).</p>
      <p>Thus, our results suggest that the previously reported association of myeloid DN cells with lymphoid plasmablasts could potentially have represented a clustering artifact arising from the presence of mixed-lineage debris in the dataset. Overall, the above results suggest that, in addition to reducing batch effects, supervised clustering using <sc>RCA2</sc> is also robust to data artifacts resulting from debris.</p>
    </sec>
    <sec id="SEC3-6">
      <title>Reference based clustering is able to capture disease states of cells</title>
      <p>To address a prevalent misconception that supervised clustering algorithms are unable to identify novel cell types and cell states, we used RCA2 to project and to cluster two publicly available data sets: one Acute Myeloid Leukemia (AML) data set (<xref rid="B29" ref-type="bibr">29</xref>) as well as the already introduced COVID-19 dataset (<xref rid="B17" ref-type="bibr">17</xref>). Note that no additional QC was performed and data is used as provided by the authors. We refer to the Methods section for further processing details.</p>
      <p>As shown in Figure <xref rid="F7" ref-type="fig">7A</xref>, we observe that PBMCs from the COVID-19 data occur both in condition specific and in shared neighbourhoods. This is an expected behaviour and corresponds well to the original findings of Wilk <italic toggle="yes">et al.</italic> (<xref rid="B17" ref-type="bibr">17</xref>). Upon clustering the data in RCA2, we obtained 28 clusters. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S34a</xref>, several clusters are depleted for cells from COVID-19 patients, whereas five clusters are composed of more than <inline-formula><tex-math id="M55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$75\%$\end{document}</tex-math></inline-formula> of cells from COVID-19 patients, despite no disease specific reference cell types are included in our panels.</p>
      <fig position="float" id="F7">
        <label>Figure 7.</label>
        <caption>
          <p>(<bold>A</bold>) UMAP embedding of a reference projection for the COVID-19 PBMC data set from (<xref rid="B17" ref-type="bibr">17</xref>). (<bold>B</bold>) UMAP embedding of a reference projection for the AML dataset <italic toggle="yes">809653</italic> from (<xref rid="B29" ref-type="bibr">29</xref>). AML and control cells are well separated in reference space.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab632fig7" position="float"/>
      </fig>
      <p>For the AML data set we obtain a clearer picture. According to the authors classification of cells, AML and healthy cells separate almost perfectly in the RCA2 projection although no AML samples are included in the reference panels (Figure <xref rid="F7" ref-type="fig">7B</xref>.). This separation is also reflected in the cluster composition plot (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S34b</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="SEC4">
    <title>DISCUSSION AND CONCLUSIONS</title>
    <p>Although <italic toggle="yes">de-novo</italic> clustering is currently the predominant strategy to cluster scRNA-seq data, it does have some disadvantages, the most important of which is vulnerability to batch effects and other data quality artifacts. Consequently, <italic toggle="yes">de-novo</italic> clustering necessitates use of supporting algorithms for explicit batch-effect correction (<xref rid="B4" ref-type="bibr">4</xref>). However, one fundamental problem with batch correction algorithms is that they cannot easily distinguish between technical variation and genuine biological differences. Hence, when batch and biology are confounded, there is a risk of erroneously suppressing biological variation (<xref rid="B49" ref-type="bibr">49</xref>). Since reference-based methods can mitigate this problem, mapping of SCs to a reference atlas has recently been identified as one of the grand challenges in the SC field (<xref rid="B50" ref-type="bibr">50</xref>). <sc>RCA2</sc> directly addresses this challenge.</p>
    <p>Indeed, our benchmarking of batch effect robustness supports the above expectation. In two independent benchmarks that rely on a robust, independent ground truth, <sc>RCA2</sc> was the best performer in clustering cells by cell type rather than batch, even without explicit batch correction (Figures <xref rid="F3" ref-type="fig">3</xref> and <xref rid="F4" ref-type="fig">4</xref>). Consistently with this finding, DEGs between clusters reflected cell type identity in the case of <sc>RCA2</sc>, but batch effects in the case of <italic toggle="yes">de-novo</italic> clustering. Importantly, in addition to being robust to batch effects, <sc>RCA2</sc> is able to detect cell types and states not present in the reference panel (Figures <xref rid="F5" ref-type="fig">5</xref> and <xref rid="F7" ref-type="fig">7</xref>). This capability of <sc>RCA2</sc> implies that novel cell types can potentially be discriminated even when data are projected onto the transcriptomes of related known cell types.</p>
    <p>One inter-operability advantage of <sc>RCA2</sc> is that count matrices from Seurat can be imported. In return, <sc>RCA2</sc> results can be incorporated into a Seurat object. In terms of scalability, one key improvement is that <sc>RCA2</sc> memory usage grows linearly with the number of cells, unlike the quadratic scaling of the original RCA version (Figure <xref rid="F2" ref-type="fig">2</xref>). Also, reference projection is now over ten-fold faster on large datasets. Consequently, <sc>RCA2</sc> scales easily to &gt; 100,000 cells on a conventional laptop.</p>
    <p>In addition, <sc>RCA2</sc> incorporates multiple new reference panels for human and mouse and also supports generation of new panels from user-supplied transcriptome data. <sc>RCA2</sc> also provides multiple features for data visualization and interpretation, such as generation of editable (ggplot2) figures, KEGG and GO enrichment analysis (Figure <xref rid="F1" ref-type="fig">1</xref>). Lastly, <sc>RCA2</sc> simplifies cluster-specific data QC, which is essential for discarding low-quality cells and doublets in SC data from heterogeneous samples (Figure <xref rid="F5" ref-type="fig">5</xref>).</p>
    <p>Technical variation can have a severe effect on <italic toggle="yes">de-novo</italic> clustering. For example, a recent single cell study of PBMCs used <italic toggle="yes">de-novo</italic> clustering to conclude that plasmablasts could trans-differentiate into developing neutrophils in COVID patients. However, when we reproduced their clustering pipeline, we noticed that the putative trans-differentiating cells showed multiple hallmarks of mixed-lineage cell debris. Thus, it is likely that the surprising finding of lymphoid-to-myeloid trans-differentiation in COVID PBMCs arose from the vulnerability of <italic toggle="yes">de-novo</italic> clustering to data quality artifacts. In contrast, reference-based clustering using <sc>RCA2</sc> was robust to the presence of debris-like artifacts in the data and yielded a result more consistent with the prevailing view that circulating myeloid cells remain myeloid (Figure <xref rid="F6" ref-type="fig">6a</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S30 and S31</xref>).</p>
    <p>In summary, <sc>RCA2</sc> is the first algorithm to combine the batch effect robustness of reference projection with the scalability of graph-based clustering. Our detailed benchmarking of <sc>RCA2</sc> demonstrates that reference-based clustering of scRNA-seq data has unique advantages and provides a complementary strategy to widely-used unsupervised approaches. With <sc>RCA2</sc>, which is freely available on github (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/prabhakarlab/RCAv2" ext-link-type="uri">https://github.com/prabhakarlab/RCAv2</ext-link>), we provide the single-cell community with the first robust, scalable and easy-to-use R-package that can be easily integrated into existing workflows to leverage the advantages of supervised clustering. We will continue to maintain and enhance <sc>RCA2</sc>, for example by expanding the set of reference panels and by adding more clustering strategies downstream of reference projection. Given the potential of reference-based methods for SC data analysis, we believe that such methods may in future also prove useful in analyzing multi-modal SC data.</p>
  </sec>
  <sec sec-type="data-availability" id="SEC5">
    <title>DATA AVAILABILITY</title>
    <p>Data analysis scripts, code to create the main figures and RDS files with R objects for the batch effect benchmarking, the 10X PBMC data, the novel BM data and the COVID-19 data are available at Zenodo (10.5281/zenodo.4686335). Fastq files for the BM data are part of a large scale single cell project which requires controlled access. Access requests should be directed to Shyam Prabhakar (prabhakars@gis.a-star.edu.sg) and Sin Tiong Ong (sintiong.ong@duke-nus.edu.sg). We note that processed BM data is available on Zenodo.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>gkab632_Supplemental_File</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="gkab632_supplemental_file.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors thank all members of the Prabhakar lab for testing and providing feedback on the functionality and user-friendliness of <sc>RCA2</sc>. This publication is part of the Human Cell Atlas – <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.humancellatlas.org/publications" ext-link-type="uri">www.humancellatlas.org/publications</ext-link>.</p>
  </ack>
  <sec id="SEC6">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkab632#supplementary-data" ext-link-type="uri">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC7">
    <title>FUNDING</title>
    <p>Agency for Science, Technology and Research, Singapore [CDAP201703-172-76-00056, IAF-PP-H18/01/a0/020]; National Medical Research Council, Singapore [MOH-CSASI18may-0002, NMRC/CIRG/1468/2017]. Funding for open access charge: Core funding of GIS.</p>
    <p><italic toggle="yes">Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>F.</given-names></string-name>, <string-name><surname>Barbacioru</surname><given-names>C.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Nordman</surname><given-names>E.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>C.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>N.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X.</given-names></string-name>, <string-name><surname>Bodeau</surname><given-names>J.</given-names></string-name>, <string-name><surname>Tuch</surname><given-names>B.B.</given-names></string-name>, <string-name><surname>Siddiqui</surname><given-names>A.</given-names></string-name><etal>et al</etal>.</person-group><article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>. <source>Nat. Methods</source>. <year>2009</year>; <volume>6</volume>:<fpage>377</fpage>–<lpage>382</lpage>.<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><collab>Editorial</collab><article-title>Method of the year 2013</article-title>. <source>Nat. Methods</source>. <year>2014</year>; <volume>11</volume>:<fpage>1</fpage>.<pub-id pub-id-type="pmid">24524124</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lawson</surname><given-names>D.A.</given-names></string-name>, <string-name><surname>Kessenbrock</surname><given-names>K.</given-names></string-name>, <string-name><surname>Davis</surname><given-names>R.T.</given-names></string-name>, <string-name><surname>Pervolarakis</surname><given-names>N.</given-names></string-name>, <string-name><surname>Werb</surname><given-names>Z.</given-names></string-name></person-group><article-title>Tumour heterogeneity and metastasis at single-cell resolution</article-title>. <source>Nat. Cell Biol.</source><year>2018</year>; <volume>20</volume>:<fpage>1349</fpage>–<lpage>1360</lpage>.<pub-id pub-id-type="pmid">30482943</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>V.Y.</given-names></string-name>, <string-name><surname>Andrews</surname><given-names>T.S.</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M.</given-names></string-name></person-group><article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>. <source>Nat. Rev. Genet.</source><year>2019</year>; <volume>20</volume>:<fpage>273</fpage>–<lpage>282</lpage>.<pub-id pub-id-type="pmid">30617341</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name>, <string-name><surname>Courtois</surname><given-names>E.T.</given-names></string-name>, <string-name><surname>Sengupta</surname><given-names>D.</given-names></string-name>, <string-name><surname>Tan</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>K.H.</given-names></string-name>, <string-name><surname>Goh</surname><given-names>J. J.L.</given-names></string-name>, <string-name><surname>Kong</surname><given-names>S.L.</given-names></string-name>, <string-name><surname>Chua</surname><given-names>C.</given-names></string-name>, <string-name><surname>Hon</surname><given-names>L.K.</given-names></string-name>, <string-name><surname>Tan</surname><given-names>W.S.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Nat GenetReference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors</article-title>. <source>Nat. Genet.</source><year>2017</year>; <volume>49</volume>:<fpage>708</fpage>–<lpage>718</lpage>.<pub-id pub-id-type="pmid">28319088</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D.</given-names></string-name>, <string-name><surname>Looney</surname><given-names>A.P.</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L.</given-names></string-name>, <string-name><surname>Wu</surname><given-names>E.</given-names></string-name>, <string-name><surname>Fong</surname><given-names>V.</given-names></string-name>, <string-name><surname>Hsu</surname><given-names>A.</given-names></string-name>, <string-name><surname>Chak</surname><given-names>S.</given-names></string-name>, <string-name><surname>Naikawadi</surname><given-names>R.P.</given-names></string-name>, <string-name><surname>Wolters</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Abate</surname><given-names>A.R.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat. Immunol.</source><year>2019</year>; <volume>20</volume>:<fpage>163</fpage>–<lpage>172</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hou</surname><given-names>R.</given-names></string-name>, <string-name><surname>Denisenko</surname><given-names>E.</given-names></string-name>, <string-name><surname>Forrest</surname><given-names>A. R.R.</given-names></string-name></person-group><article-title>scMatch: a single-cell gene expression profile annotation tool using reference datasets</article-title>. <source>Bioinformatics</source>. <year>2019</year>; <volume>35</volume>:<fpage>4688</fpage>–<lpage>4695</lpage>.<pub-id pub-id-type="pmid">31028376</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J.</given-names></string-name>, <string-name><surname>Sathe</surname><given-names>A.</given-names></string-name>, <string-name><surname>Ji</surname><given-names>H.P.</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>Q.</given-names></string-name>, <string-name><surname>Powell</surname><given-names>J.E.</given-names></string-name></person-group><article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol.</source><year>2019</year>; <volume>20</volume>:<fpage>264</fpage>.<pub-id pub-id-type="pmid">31829268</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>V.Y.</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A.</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M.</given-names></string-name></person-group><article-title>scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat. Methods</source>. <year>2018</year>; <volume>15</volume>:<fpage>359</fpage>–<lpage>362</lpage>.<pub-id pub-id-type="pmid">29608555</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>A.W.</given-names></string-name>, <string-name><surname>O’Flanagan</surname><given-names>C.</given-names></string-name>, <string-name><surname>Chavez</surname><given-names>E.A.</given-names></string-name>, <string-name><surname>Lim</surname><given-names>J. L.P.</given-names></string-name>, <string-name><surname>Ceglia</surname><given-names>N.</given-names></string-name>, <string-name><surname>McPherson</surname><given-names>A.</given-names></string-name>, <string-name><surname>Wiens</surname><given-names>M.</given-names></string-name>, <string-name><surname>Walters</surname><given-names>P.</given-names></string-name>, <string-name><surname>Chan</surname><given-names>T.</given-names></string-name>, <string-name><surname>Hewitson</surname><given-names>B.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Probabilistic cell-type assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>. <source>Nat. Methods</source>. <year>2019</year>; <volume>16</volume>:<fpage>1007</fpage>–<lpage>1015</lpage>.<pub-id pub-id-type="pmid">31501550</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blondel</surname><given-names>V.D.</given-names></string-name>, <string-name><surname>Guillaume</surname><given-names>J.-L.</given-names></string-name>, <string-name><surname>Lambiotte</surname><given-names>R.</given-names></string-name>, <string-name><surname>Lefebvre</surname><given-names>E.</given-names></string-name></person-group><article-title>Fast unfolding of communities in large networks</article-title>. <source>J. Stat. Mech.: Theory Exp.</source><year>2008</year>; <volume>2008</volume>:<fpage>P10008</fpage>.</mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A.</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P.</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P.</given-names></string-name>, <string-name><surname>Papalexi</surname><given-names>E.</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol</source>. <year>2018</year>; <volume>36</volume>:<fpage>411</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>F.A.</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P.</given-names></string-name>, <string-name><surname>Theis</surname><given-names>F.J.</given-names></string-name></person-group><article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol.</source><year>2018</year>; <volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Freytag</surname><given-names>S.</given-names></string-name>, <string-name><surname>Tian</surname><given-names>L.</given-names></string-name>, <string-name><surname>Lönnstedt</surname><given-names>I.</given-names></string-name>, <string-name><surname>Ng</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bahlo</surname><given-names>M.</given-names></string-name></person-group><article-title>Comparison of clustering tools in R for medium-sized 10x Genomics single-cell RNA-sequencing data</article-title>. <source>F1000Res</source>. <year>2018</year>; <volume>7</volume>:<fpage>1297</fpage>.<pub-id pub-id-type="pmid">30228881</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satija</surname><given-names>R.</given-names></string-name>, <string-name><surname>Farrell</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Gennert</surname><given-names>D.</given-names></string-name>, <string-name><surname>Schier</surname><given-names>A.F.</given-names></string-name>, <string-name><surname>Regev</surname><given-names>A.</given-names></string-name></person-group><article-title>Spatial reconstruction of single-cell gene expression data</article-title>. <source>Nat. Biotechnol.</source><year>2015</year>; <volume>33</volume>:<fpage>495</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">25867923</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ranjan</surname><given-names>B.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>W.</given-names></string-name>, <string-name><surname>Park</surname><given-names>J.</given-names></string-name>, <string-name><surname>Mishra</surname><given-names>K.</given-names></string-name>, <string-name><surname>Xie</surname><given-names>R.</given-names></string-name>, <string-name><surname>Fatemeh</surname><given-names>A.</given-names></string-name>, <string-name><surname>Singhal</surname><given-names>V.</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>F.</given-names></string-name>, <string-name><surname>Joanito</surname><given-names>I.</given-names></string-name>, <string-name><surname>Arul Rayan</surname><given-names>N.</given-names></string-name><etal>et al</etal>.</person-group><article-title>DUBStepR: correlation-based feature selection for clustering single-cell RNA sequencing data</article-title>. <year>2021</year>; <comment>bioRxiv doi:</comment><comment>18 November 2020, preprint: not peer reviewed</comment><pub-id pub-id-type="doi">10.1101/2020.10.07.330563</pub-id>.</mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilk</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Rustagi</surname><given-names>A.</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>N.Q.</given-names></string-name>, <string-name><surname>Roque</surname><given-names>J.</given-names></string-name>, <string-name><surname>Martínez-Colón</surname><given-names>G.J.</given-names></string-name>, <string-name><surname>McKechnie</surname><given-names>J.L.</given-names></string-name>, <string-name><surname>Ivison</surname><given-names>G.T.</given-names></string-name>, <string-name><surname>Ranganath</surname><given-names>T.</given-names></string-name>, <string-name><surname>Vergara</surname><given-names>R.</given-names></string-name>, <string-name><surname>Hollis</surname><given-names>T.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A single-cell atlas of the peripheral immune response in patients with severe COVID-19</article-title>. <source>Nat. Med</source>. <year>2020</year>; <volume>26</volume>:<fpage>1070</fpage>–<lpage>1076</lpage>.<pub-id pub-id-type="pmid">32514174</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Badr</surname><given-names>H.S.</given-names></string-name>, <string-name><surname>Zaitchik</surname><given-names>B.F.</given-names></string-name>, <string-name><surname>Dezfuli</surname><given-names>A.K.</given-names></string-name></person-group><article-title>A tool for hierarchical climate regionalization</article-title>. <source>EARTH Sci. Inform.</source><year>2015</year>; <volume>8</volume>:<fpage>949</fpage>–<lpage>958</lpage>.</mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Müllner</surname><given-names>D.</given-names></string-name></person-group><article-title>fastcluster: fast hierarchical, agglomerative clustering routines for R and Python</article-title>. <source>J. Stat. Softw.</source><year>2013</year>; <volume>53</volume>:<fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hahsler</surname><given-names>M.</given-names></string-name>, <string-name><surname>Piekenbrock</surname><given-names>M.</given-names></string-name>, <string-name><surname>Doran</surname><given-names>D.</given-names></string-name></person-group><article-title>dbscan: fast density-based clustering with R</article-title>. <source>J. Stat. Softw.</source><year>2019</year>; <volume>91</volume>:<fpage>1</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Wickham</surname><given-names>H.</given-names></string-name></person-group><source>ggplot2: Elegant Graphics for Data Analysis</source>. <year>2016</year>; <publisher-name>Springer-Verlag</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>G.</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L.G.</given-names></string-name>, <string-name><surname>Han</surname><given-names>Y.</given-names></string-name>, <string-name><surname>He</surname><given-names>Q.Y.</given-names></string-name></person-group><article-title>clusterProfiler: an R package for comparing biological themes among gene clusters</article-title>. <source>OMICS</source>. <year>2012</year>; <volume>16</volume>:<fpage>284</fpage>–<lpage>287</lpage>.<pub-id pub-id-type="pmid">22455463</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Novershtern</surname><given-names>N.</given-names></string-name>, <string-name><surname>Subramanian</surname><given-names>A.</given-names></string-name>, <string-name><surname>Lawton</surname><given-names>L.N.</given-names></string-name>, <string-name><surname>Mak</surname><given-names>R.H.</given-names></string-name>, <string-name><surname>Haining</surname><given-names>W.N.</given-names></string-name>, <string-name><surname>McConkey</surname><given-names>M.E.</given-names></string-name>, <string-name><surname>Habib</surname><given-names>N.</given-names></string-name>, <string-name><surname>Yosef</surname><given-names>N.</given-names></string-name>, <string-name><surname>Chang</surname><given-names>C.Y.</given-names></string-name>, <string-name><surname>Shay</surname><given-names>T.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Densely interconnected transcriptional circuits control cell states in human hematopoiesis</article-title>. <source>Cell</source>. <year>2011</year>; <volume>144</volume>:<fpage>296</fpage>–<lpage>309</lpage>.<pub-id pub-id-type="pmid">21241896</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Monaco</surname><given-names>G.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>B.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>W.</given-names></string-name>, <string-name><surname>Mustafah</surname><given-names>S.</given-names></string-name>, <string-name><surname>Hwang</surname><given-names>Y.Y.</given-names></string-name>, <string-name><surname>Carré</surname><given-names>C.</given-names></string-name>, <string-name><surname>Burdin</surname><given-names>N.</given-names></string-name>, <string-name><surname>Visan</surname><given-names>L.</given-names></string-name>, <string-name><surname>Ceccarelli</surname><given-names>M.</given-names></string-name>, <string-name><surname>Poidinger</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>RNA-Seq signatures normalized by mRNA abundance allow absolute deconvolution of human immune cell types</article-title>. <source>Cell Rep.</source><year>2019</year>; <volume>26</volume>:<fpage>1627</fpage>–<lpage>1640</lpage>.<pub-id pub-id-type="pmid">30726743</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stoeckius</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>. <source>Nat. Methods</source>. <year>2017</year>; <volume>14</volume>:<fpage>865</fpage>.<pub-id pub-id-type="pmid">28759029</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>F.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Defining inflammatory cell states in rheumatoid arthritis joint synovial tissues by integrating single-cell transcriptomics and mass cytometry</article-title>. <source>Nat. immunol.</source><year>2019</year>; <volume>20</volume>:<fpage>928</fpage>–<lpage>942</lpage>.<pub-id pub-id-type="pmid">31061532</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hashimshony</surname><given-names>T.</given-names></string-name>, <string-name><surname>Senderovich</surname><given-names>N.</given-names></string-name>, <string-name><surname>Avital</surname><given-names>G.</given-names></string-name>, <string-name><surname>Klochendler</surname><given-names>A.</given-names></string-name>, <string-name><surname>de Leeuw</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Anavy</surname><given-names>L.</given-names></string-name>, <string-name><surname>Gennert</surname><given-names>D.</given-names></string-name>, <string-name><surname>Li</surname><given-names>S.</given-names></string-name>, <string-name><surname>Livak</surname><given-names>K.J.</given-names></string-name>, <string-name><surname>Rozenblatt-Rosen</surname><given-names>O.</given-names></string-name><etal>et al</etal>.</person-group><article-title>CEL-Seq2: sensitive highly-multiplexed single-cell RNA-Seq</article-title>. <source>Genome Biol.</source><year>2016</year>; <volume>17</volume>:<fpage>77</fpage>.<pub-id pub-id-type="pmid">27121950</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McGinnis</surname><given-names>C.S.</given-names></string-name>, <string-name><surname>Murrow</surname><given-names>L.M.</given-names></string-name>, <string-name><surname>Gartner</surname><given-names>Z.J.</given-names></string-name></person-group><article-title>DoubletFinder: doublet detection in single-cell RNA sequencing data using artificial nearest neighbors</article-title>. <source>Cell Syst.</source><year>2019</year>; <volume>8</volume>:<fpage>329</fpage>–<lpage>337</lpage>.<pub-id pub-id-type="pmid">30954475</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Petti</surname><given-names>A.A.</given-names></string-name>, <string-name><surname>Williams</surname><given-names>S.R.</given-names></string-name>, <string-name><surname>Miller</surname><given-names>C.A.</given-names></string-name>, <string-name><surname>Fiddes</surname><given-names>I.T.</given-names></string-name>, <string-name><surname>Srivatsan</surname><given-names>S.N.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>D.Y.</given-names></string-name>, <string-name><surname>Fronick</surname><given-names>C.C.</given-names></string-name>, <string-name><surname>Fulton</surname><given-names>R.S.</given-names></string-name>, <string-name><surname>Church</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Ley</surname><given-names>T.J.</given-names></string-name></person-group><article-title>A general approach for detecting expressed mutations in AML cells using single cell RNA-sequencing</article-title>. <source>Nat. Commun.</source><year>2019</year>; <volume>10</volume>:<fpage>3660</fpage>.<pub-id pub-id-type="pmid">31413257</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname><given-names>A.T.</given-names></string-name><etal>et al</etal>.</person-group><article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor</article-title>. <source>F1000Research</source>. <year>2016</year>; <volume>5</volume>:<fpage>2122</fpage>.<pub-id pub-id-type="pmid">27909575</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haghverdi</surname><given-names>L.</given-names></string-name>, <string-name><surname>Lun</surname><given-names>A. T.L.</given-names></string-name>, <string-name><surname>Morgan</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Marioni</surname><given-names>J.C.</given-names></string-name></person-group><article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>. <source>Nat. Biotechnol.</source><year>2018</year>; <volume>36</volume>:<fpage>421</fpage>–<lpage>427</lpage>.<pub-id pub-id-type="pmid">29608177</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hie</surname><given-names>B.</given-names></string-name>, <string-name><surname>Bryson</surname><given-names>B.</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B.</given-names></string-name></person-group><article-title>Efficient integration of heterogeneous single-cell transcriptomes using Scanorama</article-title>. <source>Nat. Biotechnol.</source><year>2019</year>; <volume>37</volume>:<fpage>685</fpage>–<lpage>691</lpage>.<pub-id pub-id-type="pmid">31061482</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hafemeister</surname><given-names>C.</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group><article-title>Normalization and variance stabilization of single-cell RNA-seq data using regularized negative binomial regression</article-title>. <source>Genome Biol.</source><year>2019</year>; <volume>20</volume>:<fpage>296</fpage>.<pub-id pub-id-type="pmid">31870423</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rousseeuw</surname><given-names>P.J.</given-names></string-name></person-group><article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>J. Comput. Appl. Math.</source><year>1987</year>; <volume>20</volume>:<fpage>53</fpage>–<lpage>65</lpage>.</mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hao</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Hao</surname><given-names>S.</given-names></string-name>, <string-name><surname>Andersen-Nissen</surname><given-names>E.</given-names></string-name>, <string-name><surname>Mauck</surname><given-names>W.M.</given-names><suffix>3rd</suffix></string-name>, <string-name><surname>Zheng</surname><given-names>S.</given-names></string-name>, <string-name><surname>Butler</surname><given-names>A.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Wilk</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Darby</surname><given-names>C.</given-names></string-name>, <string-name><surname>Zager</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source>. <year>2021</year>; <volume>184</volume>:<fpage>3753</fpage>–<lpage>3587</lpage>.</mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davis</surname><given-names>C.A.</given-names></string-name>, <string-name><surname>Hitz</surname><given-names>B.C.</given-names></string-name>, <string-name><surname>Sloan</surname><given-names>C.A.</given-names></string-name>, <string-name><surname>Chan</surname><given-names>E.T.</given-names></string-name>, <string-name><surname>Davidson</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Gabdank</surname><given-names>I.</given-names></string-name>, <string-name><surname>Hilton</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Jain</surname><given-names>K.</given-names></string-name>, <string-name><surname>Baymuradov</surname><given-names>U.K.</given-names></string-name>, <string-name><surname>Narayanan</surname><given-names>A.K.</given-names></string-name><etal>et al</etal>.</person-group><article-title>The Encyclopedia of DNA elements (ENCODE): data portal update</article-title>. <source>Nucleic Acids Res.</source><year>2018</year>; <volume>46</volume>:<fpage>D794</fpage>–<lpage>D801</lpage>.<pub-id pub-id-type="pmid">29126249</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Murtagh</surname><given-names>F.</given-names></string-name>, <string-name><surname>Legendre</surname><given-names>P.</given-names></string-name></person-group><article-title>Ward’s hierarchical agglomerative clustering method: which algorithms implement Ward’s criterion?</article-title>. <source>J. Classif.</source><year>2014</year>; <volume>31</volume>:<fpage>274</fpage>–<lpage>295</lpage>.</mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashburner</surname><given-names>M.</given-names></string-name>, <string-name><surname>Ball</surname><given-names>C.A.</given-names></string-name>, <string-name><surname>Blake</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Botstein</surname><given-names>D.</given-names></string-name>, <string-name><surname>Butler</surname><given-names>H.</given-names></string-name>, <string-name><surname>Cherry</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Davis</surname><given-names>A.P.</given-names></string-name>, <string-name><surname>Dolinski</surname><given-names>K.</given-names></string-name>, <string-name><surname>Dwight</surname><given-names>S.S.</given-names></string-name>, <string-name><surname>Eppig</surname><given-names>J.T.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium</article-title>. <source>Nat. Genet.</source><year>2000</year>; <volume>25</volume>:<fpage>25</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M.</given-names></string-name>, <string-name><surname>Goto</surname><given-names>S.</given-names></string-name></person-group><article-title>KEGG: kyoto encyclopedia of genes and genomes</article-title>. <source>Nucleic Acids Res.</source><year>2000</year>; <volume>28</volume>:<fpage>27</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">10592173</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tulchinsky</surname><given-names>E.</given-names></string-name></person-group><article-title>Fos family members: regulation, structure and role in oncogenic transformation</article-title>. <source>Histol. Histopathol.</source><year>2000</year>; <volume>15</volume>:<fpage>921</fpage>–<lpage>928</lpage>.<pub-id pub-id-type="pmid">10963134</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patronas</surname><given-names>P.</given-names></string-name>, <string-name><surname>Horowitz</surname><given-names>M.</given-names></string-name>, <string-name><surname>Simon</surname><given-names>E.</given-names></string-name>, <string-name><surname>Gerstberger</surname><given-names>R.</given-names></string-name></person-group><article-title>Brain ResDifferential stimulation of c-fos expression in hypothalamic nuclei of the rat brain during short-term heat acclimation and mild dehydration</article-title>. <source>Brain Res.</source><year>1998</year>; <volume>798</volume>:<fpage>127</fpage>–<lpage>139</lpage>.<pub-id pub-id-type="pmid">9666101</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Civin</surname><given-names>C.I.</given-names></string-name>, <string-name><surname>Strauss</surname><given-names>L.C.</given-names></string-name>, <string-name><surname>Brovall</surname><given-names>C.</given-names></string-name>, <string-name><surname>Fackler</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Schwartz</surname><given-names>J.F.</given-names></string-name>, <string-name><surname>Shaper</surname><given-names>J.H.</given-names></string-name></person-group><article-title>Antigenic analysis of hematopoiesis. III. A hematopoietic progenitor cell surface antigen defined by a monoclonal antibody raised against KG-1a cells</article-title>. <source>J. Immunol.</source><year>1984</year>; <volume>133</volume>:<fpage>157</fpage>–<lpage>165</lpage>.<pub-id pub-id-type="pmid">6586833</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pellin</surname><given-names>D.</given-names></string-name>, <string-name><surname>Loperfido</surname><given-names>M.</given-names></string-name>, <string-name><surname>Baricordi</surname><given-names>C.</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>S.L.</given-names></string-name>, <string-name><surname>Montepeloso</surname><given-names>A.</given-names></string-name>, <string-name><surname>Weinberg</surname><given-names>O.K.</given-names></string-name>, <string-name><surname>Biffi</surname><given-names>A.</given-names></string-name>, <string-name><surname>Klein</surname><given-names>A.M.</given-names></string-name>, <string-name><surname>Biasco</surname><given-names>L.</given-names></string-name></person-group><article-title>A comprehensive single cell transcriptional landscape of human hematopoietic progenitors</article-title>. <source>Nat. Commun.</source><year>2019</year>; <volume>10</volume>:<fpage>2395</fpage>.<pub-id pub-id-type="pmid">31160568</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J.</given-names></string-name>, <string-name><surname>Powell</surname><given-names>J.E.</given-names></string-name>, <string-name><surname>Phan</surname><given-names>T.G.J.</given-names></string-name></person-group><article-title>No evidence that plasmablasts transdifferentiate into developing neutrophils in severe COVID-19 disease</article-title>. <source>Clin. Transl. Immunology</source>. <year>2021</year>; <volume>10</volume>:<fpage>e1308</fpage>.<pub-id pub-id-type="pmid">34221402</pub-id></mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Opasawatchai</surname><given-names>A.</given-names></string-name>, <string-name><surname>Amornsupawat</surname><given-names>P.</given-names></string-name>, <string-name><surname>Jiravejchakul</surname><given-names>N.</given-names></string-name>, <string-name><surname>Chan-In</surname><given-names>W.</given-names></string-name>, <string-name><surname>Spoerk</surname><given-names>N.J.</given-names></string-name>, <string-name><surname>Manopwisedjaroen</surname><given-names>K.</given-names></string-name>, <string-name><surname>Singhasivanon</surname><given-names>P.</given-names></string-name>, <string-name><surname>Yingtaweesak</surname><given-names>T.</given-names></string-name>, <string-name><surname>Suraamornkul</surname><given-names>S.</given-names></string-name>, <string-name><surname>Mongkolsapaya</surname><given-names>J.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Neutrophil Activation and Early Features of NET Formation Are Associated With Dengue Virus Infection in Human</article-title>. <source>Front. Immunol.</source><year>2018</year>; <volume>9</volume>:<fpage>3007</fpage>.<pub-id pub-id-type="pmid">30687301</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>X.</given-names></string-name>, <string-name><surname>Ting</surname><given-names>S.M.</given-names></string-name>, <string-name><surname>Sun</surname><given-names>G.</given-names></string-name>, <string-name><surname>Roy-O’Reilly</surname><given-names>M.</given-names></string-name>, <string-name><surname>Mobley</surname><given-names>A.S.</given-names></string-name>, <string-name><surname>Bautista Garrido</surname><given-names>J.</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>X.</given-names></string-name>, <string-name><surname>Obertas</surname><given-names>L.</given-names></string-name>, <string-name><surname>Jung</surname><given-names>J.E.</given-names></string-name>, <string-name><surname>Kruzel</surname><given-names>M.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Beneficial role of neutrophils Through function of lactoferrin after intracerebral hemorrhage</article-title>. <source>Stroke</source>. <year>2018</year>; <volume>49</volume>:<fpage>1241</fpage>–<lpage>1247</lpage>.<pub-id pub-id-type="pmid">29636422</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <label>47.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>James</surname><given-names>M.N.</given-names></string-name></person-group><person-group person-group-type="editor"><string-name><surname>Barrett</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Rawlings</surname><given-names>N.D.</given-names></string-name>, <string-name><surname>Woessner</surname><given-names>J.F.</given-names></string-name></person-group><article-title>Handbook of proteolytic enzymes</article-title>. <source>Protein Science</source>. <year>1999</year>; <volume>8</volume>:<publisher-loc>London</publisher-loc><publisher-name>Academic Press</publisher-name><fpage>693</fpage>–<lpage>694</lpage>.</mixed-citation>
    </ref>
    <ref id="B48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fink</surname><given-names>K.</given-names></string-name></person-group><article-title>Origin and function of circulating plasmablasts during acute viral infections</article-title>. <source>Front. Immunol.</source><year>2012</year>; <volume>3</volume>:<fpage>78</fpage>.<pub-id pub-id-type="pmid">22566959</pub-id></mixed-citation>
    </ref>
    <ref id="B49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname><given-names>H. T.N.</given-names></string-name>, <string-name><surname>Ang</surname><given-names>K.S.</given-names></string-name>, <string-name><surname>Chevrier</surname><given-names>M.</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>X.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>N. Y.S.</given-names></string-name>, <string-name><surname>Goh</surname><given-names>M.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>J.</given-names></string-name></person-group><article-title>A benchmark of batch-effect correction methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol.</source><year>2020</year>; <volume>21</volume>:<fpage>12</fpage>.<pub-id pub-id-type="pmid">31948481</pub-id></mixed-citation>
    </ref>
    <ref id="B50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lähnemann</surname><given-names>D.</given-names></string-name>, <string-name><surname>Köster</surname><given-names>J.</given-names></string-name>, <string-name><surname>Szczurek</surname><given-names>E.</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Hicks</surname><given-names>S.C.</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Vallejos</surname><given-names>C.A.</given-names></string-name>, <string-name><surname>Campbell</surname><given-names>K.R.</given-names></string-name>, <string-name><surname>Beerenwinkel</surname><given-names>N.</given-names></string-name>, <string-name><surname>Mahfouz</surname><given-names>A.</given-names></string-name><etal>et al</etal>.</person-group><article-title>Eleven grand challenges in single-cell data science</article-title>. <source>Genome Biol.</source><year>2020</year>; <volume>21</volume>:<fpage>31</fpage>.<pub-id pub-id-type="pmid">32033589</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
