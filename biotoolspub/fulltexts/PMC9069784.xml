<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9069784</article-id>
    <article-id pub-id-type="publisher-id">4703</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04703-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scSemiAE: a deep model with semi-supervised learning for single-cell transcriptomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dong</surname>
          <given-names>Jiayi</given-names>
        </name>
        <address>
          <email>jiayidong21@m.fudan.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Yin</given-names>
        </name>
        <address>
          <email>18210240251@fudan.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Fei</given-names>
        </name>
        <address>
          <email>wangfei@fudan.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution>Shanghai Key Lab of Intelligent Information Processing, </institution><institution>Fudan University, </institution></institution-wrap>Shanghai, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution>School of Computer Science and Technology, </institution><institution>Fudan University, </institution></institution-wrap>Shanghai, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>5</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>161</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>11</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>4</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">With the development of modern sequencing technology, hundreds of thousands of single-cell RNA-sequencing (scRNA-seq) profiles allow to explore the heterogeneity in the cell level, but it faces the challenges of high dimensions and high sparsity. Dimensionality reduction is essential for downstream analysis, such as clustering to identify cell subpopulations. Usually, dimensionality reduction follows unsupervised approach.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this paper, we introduce a semi-supervised dimensionality reduction method named scSemiAE, which is based on an autoencoder model. It transfers the information contained in available datasets with cell subpopulation labels to guide the search of better low-dimensional representations, which can ease further analysis.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">Experiments on five public datasets show that, scSemiAE outperforms both unsupervised and semi-supervised baselines whether the transferred information embodied in the number of labeled cells and labeled cell subpopulations is much or less.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04703-0.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Semi-supervised</kwd>
      <kwd>Dimensionality reduction</kwd>
      <kwd>Autoencoder</kwd>
      <kwd>Fine-tuning</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par13">In order to grasp the heterogeneous information of cells and cut costs of material and time, Tang et al. [<xref ref-type="bibr" rid="CR1">1</xref>] first proposed the single-cell RNA sequencing (scRNA-seq) technology in 2009 which can describe the transcriptional profiles from the perspective of a single cell rather than the average of all cells. With the rapid development in recent years, modern single-cell sequencing platforms such as SmartSeq [<xref ref-type="bibr" rid="CR2">2</xref>] and Chromium 10X [<xref ref-type="bibr" rid="CR3">3</xref>] have emerged and the number of gene expression profiles has surged to hundreds of thousands [<xref ref-type="bibr" rid="CR4">4</xref>], which has aroused much interest of researchers. Through analyzing these data, not only can we find cell types [<xref ref-type="bibr" rid="CR5">5</xref>] and detect rare cell populations [<xref ref-type="bibr" rid="CR6">6</xref>], but also identify differentially expressed genes and construct differentiation trajectory [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par14">However, opportunities and challenges coexist. Due to plenty of genes assayed and major of them not being portrayed in scRNA-seq data, distances between data points (i.e., cells) become similar, which leads to small differences in the distances between cells and unreliable consequences in downstream analysis, such as the identification of cell subpopulations [<xref ref-type="bibr" rid="CR8">8</xref>]. Thus, it is essential to apply dimensionality reduction methods which can learn the representations of data in a low-dimensional space. Principal component analysis (PCA) [<xref ref-type="bibr" rid="CR9">9</xref>] is one of typical methods, which can find a set of principal components to explain the most variance of the data, and many tools such as Seurat [<xref ref-type="bibr" rid="CR10">10</xref>] use variants of it. In addition, non-negative matrix factorization (NMF) [<xref ref-type="bibr" rid="CR11">11</xref>] has shown its ability to identify interpretable factors from high-dimensional and sparse datasets under the constraint of no negative element. These two belong to linear methods that are insufficient in scRNA-seq data with high noise and complex structures. Deep learning could alleviate these difficulties since it derives from non-linear mapping functions. Recently many deep learning methods have been developed such as single-cell Variational Inference (scVI) [<xref ref-type="bibr" rid="CR12">12</xref>], which design a generative model aiming at the distribution characteristics of scRNA-seq data.</p>
    <p id="Par15">After dimensionality reduction, the next step is to identify and annotate cell populations, which is also a pre-step of differential expression analysis. In most cases, clustering algorithms are employed to identify distinct groups of cells, such as K-means, hierarchical clustering, community-detection-based algorithms [<xref ref-type="bibr" rid="CR13">13</xref>]. This strategy could detect new cell subpopulations. Alternatively, some supervised methods are developed to annotate cell subpopulations. Since these models are trained based on scRNA-seq data with cell type labels, biological information implied in these training data could be transferred to target datasets to improve the accuracy of cell type annotation. Though this strategy cannot identify new cell type, with the emergence of single cell atlas [<xref ref-type="bibr" rid="CR14">14</xref>], tsunamic data with cell type labels could definitely provide much prior information which is valuable for the identification of cell subpopulations.</p>
    <p id="Par16">In this paper, we present a semi-supervised dimensionality reduction approach named scSemiAE aiming at the identification of cell subpopulations for scRNA-seq data analysis, which leverage partial cells with labels to guide the learning of an autoencoder for the target datasets (The framework of scSemiAE is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>). It first employs a classifier trained from scRNA-seq data with known cell type labels to annotate cell types for target datasets and selects predictions being true with high probability, and then learns low-dimensional representations of target datasets guided by partial cells with predicted cell types. The partially labeled cells could transfer the information from other available datasets, guide to learn efficient coding of target datasets, and consequently improve the accuracy of downstream analysis. To our knowledge, netAE [<xref ref-type="bibr" rid="CR15">15</xref>] is a semi-supervised method which uses a softmax layer to calculate classification loss. Moreover, scANVI [<xref ref-type="bibr" rid="CR16">16</xref>] is an extension of scVI which adjusts model distribution to amplify label signals after training a basic model. We choose them as two of the baseline models.<fig id="Fig1"><label>Fig. 1</label><caption><p>Framework of scSemiAE. (1) Annotation: predicting cell type via a classifier and labeling partial cells with high confidence; (2) Pretraining: training an autoencoder with all cells; (3) Fine-tuning: adjusting the weights of encoder using labeled cells</p></caption><graphic xlink:href="12859_2022_4703_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par17">In our experiments, we compare the latent space learned by scSemiAE with the spaces learned by netAE, scANVI, autoencoder (AE), scVI as well as principal components got from PCA in both classification and clustering tasks. When the proportion of labeled cells or the number of labeled cell subpopulations varies, the latent space learned by scSemiAE performs outstandingly in most cases, which implies that it can simplify further analysis. In addition, we show its ability to remove batch effects, which makes it more applicable in scRNA-seq data analysis.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <p id="Par18">To evaluate scSemiAE comprehensively, we implement several experiments on real datasets and compare it with both semi-supervised methods and unsupervised methods. We test the performance of scSemiAE under three scenarios, the different proportions of labeled cells, the different numbers of labeled cell subpopulations and batch effects existing. Since the datasets in these experiments must be labeled with true cell subpopulations in advance to give a standard evaluation criterion, we omit the step of cell annotation, but in real applications, cell annotation may be necessary to get partial labels with high confidence.</p>
    <p id="Par19">The methods in comparison include PCA, semi-supervised methods netAE and scANVI as well as unsupervised methods AE and scVI. Among them, AE refers to the pretraining model of scSemiAE. For fairness, we use similar network structure for all deep models in comparison. Encoder and decoder are both with two fully connected layers and the dimension of latent space is 50. The training epoch of all deep models is set to 50. Besides, to reduce the effect on performance caused by parameter regulation, these methods in comparison are tested under their default parameters and algorithm procedures. Consequently, we do not tune the hyperparameters of scSemiAE separately for each dataset but use the default settings.</p>
    <p id="Par20">Since scSemiAE can be treated as a dimensionality reduction algorithm, to show the performance, we select two representative metrics from classification field and clustering field respectively. (1) Accuracy (ACC): This one is mainly to evaluate the performance of classification. We select the k-nearest neighbor (kNN) classifier with k = 10, which is one of the simplest models for classification. For deep models, scSemiAE, AE, scVI, scANVI and netAE, embedding vectors mapping from labeled cells are used to train a kNN classifier and prediction accuracy is calculated on the unlabeled set. For PCA method, kNN is trained on principal components [<xref ref-type="bibr" rid="CR15">15</xref>]. (2) Adjusted Rand Index (ARI) [<xref ref-type="bibr" rid="CR17">17</xref>]: This one is mainly to evaluate the performance of clustering. We select Louvain and K-means that are two most popular clustering algorithms. They are used to group only unlabeled cells on a low-dimensional space directly and ARI is also calculated on the unlabeled cells. Louvain will stop at the best split. The size of groups, k in K-means algorithm will be set to the exact number of cell subpopulations. Besides, Uniform Manifold Approximation and Projection (UMAP) [<xref ref-type="bibr" rid="CR18">18</xref>] are employed to give visualizations by projecting embedding into two dimensions.</p>
    <sec id="Sec3">
      <title>scSemiAE performs best for tests with different proportions of labeled cells</title>
      <p id="Par21">The first experiment is to test the performance of scSemiAE when the proportion of labeled cells is various. We set the proportion of labeled cells to 0.05, 0.1, 0.2, 0.4 respectively. In Fig. <xref rid="Fig2" ref-type="fig">2</xref>, we present the results for the first four datasets of all methods in comparison, where all the mean and standard deviation of ARI and ACC values are counted from 20 randomly sampling of labeled cells (its corresponding numerical values being shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Change of ARI (Louvain &amp; K-means) and ACC (kNN) values with the increasing labeled proportion for six methods. <bold>a</bold> On Cortex dataset; <bold>b</bold> on Heart dataset; <bold>c</bold> on Limb Muscle dataset; <bold>d</bold> on Embryos dataset</p></caption><graphic xlink:href="12859_2022_4703_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par22">As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, it is very clear that scSemiAE performs best. In most tests, scSemiAE achieves the best score and especially the ARI values calculated from Louvain, scSemiAE exceeds other algorithms by 10–30%. For K-means, scSemiAE is the most stable method on multiple datasets. Though it is the second best on Cortex and Limbs Muscle datasets, scSemiAE performs much better than others in Heart and Embryos datasets. PCA fluctuates a lot and all the other models are worse than scSemiAE on ARI values. Naturally, scSemiAE should be a better choice for clustering of scRNA-seq data. Besides, the performance of scSemiAE is far beyond it of AE which is the pretraining part of scSemiAE and it demonstrates that the fine-tuning part of scSemiAE does help great. By the way, though K-means seemly performs better than Louvain, we cannot come to the conclusion quickly. Usually, the true size of cell subpopulations cannot be known beforehand and it is an important parameter for K-means. In fact, in above experiments, Louvain likely pops out more clusters than K-means, in which k is exactly set to the true size of cell subpopulations. It can explain why the ARI of Louvain looks not as good as it of K-means.</p>
      <p id="Par23">As for ACC indicator, scSemiAE achieves the best score on two datasets, Limb Muscle and Heart, and on the other two datasets, scSemiAE is competitive. What’s more, when the proportion of labeled cells is very low, such as 0.05, scSemiAE is the best one.</p>
      <p id="Par24">A series of experiments illustrate that scSemiAE should be the first choice among the semi-supervised methods and unsupervised methods in comparison since it performs best or secondly best in tests with different proportions of labeled cells.</p>
      <sec id="Sec4">
        <title>scSemiAE performs best for tests with the different number of labeled cell subpopulations</title>
        <p id="Par25">In reality, there must be some cell types, especially rare cell types, which cannot be annotated by a cell type predictor since these cell types may not be detected before. Therefore, we explore the performance of scSemiAE when the number of annotated cell types is limited. In this section, due to the size of cell subpopulations in the dataset, the number of labeled cell subpopulations ranges from 2 to 5, 6 or 7. Up to <inline-formula id="IEq2"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10\%$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq2.gif"/></alternatives></inline-formula> cells of a cell subpopulation with more than 50 cells may be labeled. Three semi-supervised methods, scSemiAE, netAE and scANVI are compared.</p>
        <p id="Par26">The experimental results are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> (its corresponding numerical values being shown in Additional file <xref rid="MOESM2" ref-type="media">2</xref>). Obviously in most cases scSemiAE performs best regardless of the number of annotated cell subpopulations. From the results of Louvain algorithm, when the number of annotated cell populations is more than 2, ARI of scSemiAE achieves about 20–30% better than it of the other two methods. When the number of annotated cell populations is 2, scSemiAE outperforms much in Cortex, Heart, and Limb muscle datasets, and performs comparably in Embryos datasets. The observation from K-means almost agrees it from Louvain, scSemiAE performs best in whole, except on Cortex dataset, when the number of cell types is less than 4, netAE and scANVI outperformed scSemiAE a little.<fig id="Fig3"><label>Fig. 3</label><caption><p>Change of ARI (Louvain &amp; K-means) values when increasing the number of labeled cell subpopulations for three semi-supervised methods. <bold>a</bold> on Cortex dataset; <bold>b</bold> on Heart dataset; <bold>c</bold> on Limb Muscle dataset; <bold>d</bold> on Embryos dataset</p></caption><graphic xlink:href="12859_2022_4703_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par27">What’s more, among three methods, scSemiAE is the only one that with the increasing of annotated cell subpopulations, the performance of clustering unlabeled cells become better. While, netAE and scANVI cannot take full advantage of annotated cells since their performances keep very stable with the increasing of annotated cell subpopulations.</p>
        <p id="Par28">As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, some datasets are seriously unbalanced, such as Heart datasets and among cell subpopulations of it, the most and least cells differ by two orders of magnitude. In this case, it is truly hard for clustering algorithms to simultaneously identify both common cell type and rare cell type. scSemiAE alleviates the problem because it gives better low-dimensional representations in which common cell subpopulations and rare cell subpopulations are easy to be grouped respectively. ARIs from scSemiAE for Heart datasets are much better than its from netAE and scANVI, the other two semi-supervised methods, as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>.</p>
      </sec>
    </sec>
    <sec id="Sec5">
      <title>scSemiAE could remove batch effects</title>
      <p id="Par29">Though scSemiAE takes no extra step to remove batch effects, it does have this function since one goal of it is to make cells of the same cell type close.</p>
      <p id="Par30">The Pancreas dataset is from four different batches. We also implement the experiments mentioned above on this dataset. Among the methods, scANVI inherits from scVI the special treatment for removing batch effects, while scSemiAE and other methods do not take specific solution for it. As shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref> (its corresponding numerical values being shown in Additional file <xref rid="MOESM3" ref-type="media">3</xref>), the special treatment for removing batch effects do help scANVI and scVI outperform other methods. While, scSemiAE presents similar performance as scVI in clustering, a litter worse than the semi-supervised version scANVI, and much better than netAE and other unsupervised methods. It demonstrates that even when batch effects exist, scSemiAE could give better low-dimensional representations which make the work of clustering algorithms easier.<fig id="Fig4"><label>Fig. 4</label><caption><p><bold>a</bold> Change of ARI (Louvain) and ACC (kNN) values with the increasing labeled proportion for six methods on Pancreas dataset; <bold>b</bold> Change of ARI (Louvain) values when increasing the number of labeled cell subpopulations for three semi-supervised methods on Pancreas dataset</p></caption><graphic xlink:href="12859_2022_4703_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par31">For the Pancreas dataset, we further give visualizations of the raw data, the embedded data from scSemiAE and netAE by UMAP, shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref> and here the labeled proportion is set to 0.1. It is obviously shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>a which is from raw data that when batch effects exist, cells such as alpha cells from CelSeq2 and Fluidigm C1 are rather far away, and even worse, alpha cells of Fluidigm C1 and beta cells of Fluidigm C1 are mixed together. It illustrates that here technical variations are bigger than biological variations, while most methods for batch effects removal, such as Seurat [<xref ref-type="bibr" rid="CR10">10</xref>], Harmony [<xref ref-type="bibr" rid="CR19">19</xref>], LIGER [<xref ref-type="bibr" rid="CR20">20</xref>], work under the contrary assumption. In Fig. <xref rid="Fig5" ref-type="fig">5</xref>b, it is very clear that scSemiAE mixes cells of the same cell subpopulation from different batches very well, and each cell subpopulation is rather separate to ease clustering. In Fig. <xref rid="Fig5" ref-type="fig">5</xref>c, netAE looks unable to remove batch effects, such as alpha cells of Fluidigm C1, CelSeq2 and SMART-Seq2 are very far away, so is beta cells of Fluidigm C1, CelSeq2 and SMART-Seq2. What’s worse, alpha cells and beta cells of Fluidigm C1 are much closer, just like the Fig. <xref rid="Fig5" ref-type="fig">5</xref>a.<fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison on the Pancreas dataset. <bold>a</bold> Visualization for the raw data; <bold>b</bold> Visualization for the embedding of scSemiAE; <bold>c</bold> Visualization for the embedding of netAE</p></caption><graphic xlink:href="12859_2022_4703_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par32">The fine-tuning step of scSemiAE is to make cells of the same subpopulation close and cells among different subpopulations far away, which in some extent helps to remove batch effects even the step is guided by a few labeled cells. While netAE cannot deal with batch effects since one important part of its optimization goals is to make classification work, a classifier may find a cutline to classify different cell subpopulations while it is hard for unsupervised methods to group cells.</p>
    </sec>
    <sec id="Sec6">
      <title>scSemiAE could preserve the cell differentiation structure</title>
      <p id="Par33">Embryos dataset includes 5 states of embryo development from the third day to the 7th day. UMAP visualizations for this dataset of the original space as well as the embedded spaces by scSemiAE, netAE and scANVI are shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. The labeled proportion is also set to 0.1. From Fig. <xref rid="Fig6" ref-type="fig">6</xref>, we can figure out scSemiAE preserves the structure of the differential process of cells. It suggests that scSemiAE could provide better low-dimensional representations which could ease clustering and downstream trajectory inference.<fig id="Fig6"><label>Fig. 6</label><caption><p>Comparison on the Embryos dataset. <bold>a</bold> Visualization for the raw data; <bold>b</bold> Visualization for the embedding of scSemiAE; <bold>c</bold> Visualization for the embedding of netAE; <bold>d</bold> Visualization for the embedding of scANVI</p></caption><graphic xlink:href="12859_2022_4703_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Discussion</title>
    <p id="Par34">Clustering is the basis of differentially expressed genes detecting and trajectory analysis. scSemiAE could help clustering algorithms find groups with more homogeny, and could preserve the cell differentiation structure, therefore it could give better support for differentially expressed genes detecting and trajectory analysis. In the future, we will consider how to emphasize the representing and detecting of rare cell types. scSemiAE could separate rare cell types from common cell types in latent space by now. However, if multiple rare cell types exist, though they could be separated, it is still hard for clustering since the too small cell subpopulations are tended to be grouped with other cell types. Our experiments show cell types with tens of cell could be separated by scSemiAE and Louvain, while if cells of a cell type is about 10, sometimes it is merged with other cell types.</p>
  </sec>
  <sec id="Sec8">
    <title>Conclusion</title>
    <p id="Par35">Due to high dimensions and high sparsity of scRNA-seq data, dimensionality reduction is an indispensable step before identifying cell subpopulations. In scRNA-seq data analysis, they are often treated as two isolated steps and the new algorithms have been introduced constantly and separately. If the dimensionality reduction algorithm can take a long view, the features we gain will benefit the identification of cell subpopulations.</p>
    <p id="Par36">By now, with the scRNA-seq data tsunami emerging, biological prior knowledge such as some common cell profiles could easily be gained and help the analysis of new datasets. In this paper, we propose scSemiAE, a semi-supervised deep learning framework combined with the thought of classification and clustering. On the one hand, we directly leverage a classifier to predict target datasets, which can provide prior knowledge; on the other hand, we encourage the low-dimensional representations of cells from the same cell subpopulation to be similar, while the representations of cells among different cell subpopulations are dissimilar. scSemiAE adopts a three-step strategy including annotation, pretraining, and fine-tuning. A series of experiments for the different proportions of labeled cells or the different numbers of labeled cell subpopulations show that the performances of scSemiAE are rather excellent. It could leverage the prior information such as some, even few labeled cells to guide the gathering of the same cell subpopulation, which could ease clustering. A byproduct of scSemiAE is that it could remove batch effects to some extent since it encourages the same cell type from different batches to gather together, which breaks the constraint that biological variations of different cell types should be greater than technical variations from different batches. In addition, it is also helpful to preserve the cell differentiation structure.</p>
    <p id="Par37">Active learning [<xref ref-type="bibr" rid="CR21">21</xref>] is a form of semi-supervised learning, which is important techniques when labeled data are scarce. It is worth trying to integrate active learning strategy into scSemiAE to make improvement on learning efficiency and accuracy.</p>
  </sec>
  <sec id="Sec9">
    <title>Methods</title>
    <p id="Par38">The core of scSemiAE is a semi-supervised version of the traditional autoencoder. Its primary objective is to learn a nonlinear mapping function by using the prior information contained in some labeled cells so as to project high-dimensional expression of all cells to vectors in a low-dimensional space where similar cells are close and dissimilar cells are far away. In this section, we present the method of data preprocessing and the framework of scSemiAE.</p>
    <sec id="Sec10">
      <title>Data preprocessing</title>
      <p id="Par39">As for data preprocessing, we first filter out genes that are not expressed in any sample and cells in which any reads are not captured. Then, we normalize the raw count matrix by using Scanpy package and making the target sum as the median of total counts for cells before normalization and take the log of it. Moreover, we select the top 5000 genes with high variance, which can save training costs to some extent.</p>
    </sec>
    <sec id="Sec11">
      <title>Framework</title>
      <p id="Par40">To be more specific, the framework of scSemiAE consists of three stages: first, annotating labels for all cells using a classifier tool and picking out some of them whose labels are more likely to be right as the provider of prior information; second, pretraining with all cells on an autoencoder so that the latent characters can acquire as much effective information as possible; and third, adjusting the embedding function using labeled cells to accomplish the goal of grouping the cells with the same label and separating the cells with different labels.</p>
      <p id="Par41">In the first step, totally unannotated datasets will be annotated by existing tools, for example, SciBet [<xref ref-type="bibr" rid="CR22">22</xref>], ScMap [<xref ref-type="bibr" rid="CR23">23</xref>], Garnett [<xref ref-type="bibr" rid="CR24">24</xref>], CellAssign [<xref ref-type="bibr" rid="CR25">25</xref>], et al., which are classifiers trained from datasets with cell labels. Most classifiers output the probability that a cell belongs to a certain cell type. The label with the maximum probability is regarded as the cell annotation result. For the prediction results are not completely correct, we set a threshold to filter out cells whose predictions are without high probability to ensure the selected labels as accurate as possible. Otherwise, the cell type is labeled as unknown. As for partially unannotated datasets, we can directly start with the second step.</p>
      <p id="Par42">In the second step of pretraining, an autoencoder is trained on all preprocessed data and we can get an embedding function that output latent vectors that are compressed representations while keeping the most important information of input data.</p>
      <p id="Par43">An autoencoder is a kind of artificial neural network used to learn efficient coding of unlabeled data by training to refine nonlinear features and ignore insignificant information. We take preprocessed gene expression profiles <inline-formula id="IEq4"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X=\{x_j \in R^G \}_{j=1}^{N}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>G</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq4.gif"/></alternatives></inline-formula> as autoencoder’s inputs, where <italic>N</italic> denotes the number of cells and <italic>G</italic> denotes the number of genes. Autoencoder usually consists of two main parts to regenerate the inputs: an encoder part that maps the inputs to a lower-dimensional embedding <inline-formula id="IEq5"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Z=\{z_j \in R^D \}_{j=1}^{N}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>D</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq5.gif"/></alternatives></inline-formula>, where <italic>D</italic> denotes the dimension of the latent space; a decoder part that can reconstruct the inputs as outputs <inline-formula id="IEq6"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{X}}=\{{\hat{x}}_j \in R^G \}_{j=1}^{N}$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>G</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq6.gif"/></alternatives></inline-formula> in the original space from the lower-dimensional embedding. The main idea of an autoencoder is to minimize the difference between the inputs and the outputs through optimizing the weights of the network. The loss function of the pretraining model is as follows and we choose mean squared error as data reconstruction error.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_p = \min L(X, {\hat{X}}) = \min \left\| X - {\hat{X}} \right\| ^2 \end{aligned}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo movablelimits="true">min</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo movablelimits="true">min</mml:mo><mml:msup><mml:mfenced close="∥" open="∥"><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4703_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>The third step is fine-tuning, which is a process of updating the weights of the encoder network based on partially labeled cells and finding a mapping function that can make the learned low-dimensional representations easily distinguish cells being the same cell subpopulation or not.</p>
      <p id="Par44">Let <italic>S</italic> be a scRNA-seq dataset. We assume that through the annotating process, <italic>S</italic> get some labels. <italic>S</italic> consists of two parts: one is gene expression matrix of labeled cells <inline-formula id="IEq7"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_L=\{x_j \in R^G \}_{j=1}^{N_L}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>G</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq7.gif"/></alternatives></inline-formula> and a label vector of these cells <inline-formula id="IEq8"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_L=\{y_j \in \{1,\ldots ,K\}\}_{j=1}^{N_L}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq8.gif"/></alternatives></inline-formula>, in which <inline-formula id="IEq9"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_L$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>N</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq9.gif"/></alternatives></inline-formula> denotes the number of labeled cells and <italic>K</italic> represents the number of cell subpopulations in the labeled set; the other is gene expression matrix of unlabeled cells <inline-formula id="IEq10"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_U=\{x_j \in R^G \}_{j=1}^{N_U}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>G</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>U</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_U$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>N</mml:mi><mml:mi>U</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq11.gif"/></alternatives></inline-formula> denotes the number of unlabeled cells. Of note, we assume that cell subpopulation <italic>i</italic> has <inline-formula id="IEq12"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_i$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq12.gif"/></alternatives></inline-formula> cells in labeled set.</p>
      <p id="Par45">Intuitively, in the data space, cells of the same subpopulation should be close, and cells among different subpopulations should be separated. Therefore, we design the optimization goal of fine-tuning process is to learn a nonlinear mapping function <inline-formula id="IEq13"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_\theta :R^G \rightarrow R^D$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>G</mml:mi></mml:msup><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq13.gif"/></alternatives></inline-formula> in which <inline-formula id="IEq14"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M26"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq14.gif"/></alternatives></inline-formula> is the whole parameters of the encoder network and through the mapping of <inline-formula id="IEq15"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_\theta$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq15.gif"/></alternatives></inline-formula>, labeled cells within the same cell subpopulation will be closer and vice versa.</p>
      <p id="Par46">On the one side, average distance within each cell subpopulation <inline-formula id="IEq16"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_1$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq16.gif"/></alternatives></inline-formula> is defined in formula (<xref rid="Equ2" ref-type="">2</xref>), in which, <inline-formula id="IEq17"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_i$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq17.gif"/></alternatives></inline-formula> means center of cell subpopulation <italic>i</italic> shown in formula (<xref rid="Equ3" ref-type="">3</xref>) and <inline-formula id="IEq18"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_L=\{c_i\in R^D \}_{i=1}^{K}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>D</mml:mi></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq18.gif"/></alternatives></inline-formula> represents all centers in embedding space [<xref ref-type="bibr" rid="CR26">26</xref>]. <italic>d</italic> is distance function and we choose squared Euclidean distance. By minimizing the <inline-formula id="IEq19"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_1$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq19.gif"/></alternatives></inline-formula> we can get similar representations of cells within a cell subpopulation in the latent space.<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_1 = \frac{1}{K} \sum _{i=1}^{K} \frac{1}{N_i} \sum _{j=1}^{N_i} d(f_\theta (x_j), c_i) \end{aligned}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munderover><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4703_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} c_i = \frac{1}{N_i} \sum _{j=1}^{N_i} f_\theta (x_j) \end{aligned}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4703_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>On the other side, for cells among different cell subpopulations, they deserve representations as distinct as possible. We define the distance among several cell subpopulations, <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_2$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq20.gif"/></alternatives></inline-formula>, as the minimum distance of any two centers, shown in formula (<xref rid="Equ4" ref-type="">4</xref>).<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_2 = \min _{0&lt; i_1 &lt; i_2 \le K} d(c_{i_1}, c_{i_2}) \end{aligned}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:munder><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:msub><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4703_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>The final objective function in formula (<xref rid="Equ5" ref-type="">5</xref>) optimizes for the <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_1$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_2$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq22.gif"/></alternatives></inline-formula> distance jointly:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} L_m = \min _{\theta } (L_1 - \lambda \times L_2) \end{aligned}$$\end{document}</tex-math><mml:math id="M50" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mi>θ</mml:mi></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mi>λ</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4703_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M52"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq23.gif"/></alternatives></inline-formula> is a regularization constant which can balance between <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_1$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq24.gif"/></alternatives></inline-formula> minimization and <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_2$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq25.gif"/></alternatives></inline-formula> maximization. Through optimizing for <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_\theta$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>f</mml:mi><mml:mi>θ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq26.gif"/></alternatives></inline-formula>, we can obtain the latent space where we can distinguish or cluster cells easily even for unlabeled cells.</p>
    </sec>
    <sec id="Sec12">
      <title>Training strategy</title>
      <p id="Par47">In this subsection, we give our whole training strategy and default parameters settings of scSemiAE.</p>
      <p id="Par48">In the phase of pretraining, we first train <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_p$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>L</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq27.gif"/></alternatives></inline-formula> 50 epochs on all preprocessed data with a deep autoencoder as mentioned above. Then, scSemiAE removes the decoder of the pretraining model and uses learned weights of the encoder to initialize the neural network, which can provide a prior parameter space. In the process of fine-tuning, the new loss function <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_m$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>L</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq28.gif"/></alternatives></inline-formula> is used to re-train the encoder network for 60 epochs, in order to further obtain biological characters and preserve biological structural relationships in the latent space.</p>
      <p id="Par49">As for the details of the implementation of scSemiAE, we use two fully connected layers in the encoder and decoder respectively and the encoder has the structure, <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dim_{5000} \rightarrow dim_{500} \rightarrow dim_{50}$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mn>5000</mml:mn></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mn>500</mml:mn></mml:msub><mml:mo stretchy="false">→</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mn>50</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq29.gif"/></alternatives></inline-formula>, while the decoder has a mirror-image. For both pretraining and the beginning of fine-tuning, we use the Adam [<xref ref-type="bibr" rid="CR27">27</xref>] optimizer with learning rate 0.001 and for fine-tuning, we adjusted the learning rate to half of the original value after every 5 epochs. What’s more, we choose layer normalization for the hidden layer and ELU function, <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ELU(x) = \max (0,x) + \min (0, \alpha (exp(x) - 1)) (\alpha = 1)$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo movablelimits="true">min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq30.gif"/></alternatives></inline-formula>, as a nonlinear activation function. For the hyperparameter, we set <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda = 1$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq31.gif"/></alternatives></inline-formula>, which is the regularizer between <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_1$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq32.gif"/></alternatives></inline-formula> and <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_2$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4703_Article_IEq33.gif"/></alternatives></inline-formula>, distance within a cell subpopulation and distance among different subpopulations.</p>
    </sec>
    <sec id="Sec13" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par50">To test scSemiAE and other existing methods, we select five publicly annotated scRNA-Seq datasets listed as follows. More details are in Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
      <p id="Par51">The Cortex dataset (GSE60361) [<xref ref-type="bibr" rid="CR28">28</xref>] concentrates on mouse brain cortex cells and contains 3005 cells with 7 cell types, and it is relatively balanced from the aspect of quantity.</p>
      <p id="Par52">Tabula Muris Senis dataset [<xref ref-type="bibr" rid="CR29">29</xref>] is a comprehensive compendium of single-cell transcriptomic data and is available at: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/projects/Tabula_Muris_Se-nis/64982/">https://figshare.com/projects/Tabula_Muris_Se-nis/64982/</ext-link>, from which, we choose cells in heart and limb muscle from 18-month-old mice. The Heart and Limb Muscle datasets has 11 and 6 cell types respectively and the number of cells whithin each cell types is unbalanced, as shown in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>The details for all used datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Dataset</th><th align="left"># Cells</th><th align="left">#Cell subpopulations</th><th align="left"># Genes</th><th align="left"># Cells of each subpopulation</th></tr></thead><tbody><tr><td align="left">Cortex</td><td align="left">3005</td><td align="left">7</td><td align="left">19972</td><td align="left">939, 820, 399, 290, 235, 224, 98</td></tr><tr><td align="left">Heart</td><td align="left">4433</td><td align="left">11</td><td align="left">23341</td><td align="left">775, 458, 344, 127, 100, 93, 58, 47, 41, 8</td></tr><tr><td align="left">Limb Muscle</td><td align="left">1521</td><td align="left">6</td><td align="left">23341</td><td align="left">683, 354, 205, 172, 70, 37</td></tr><tr><td align="left">Embryos</td><td align="left">1529</td><td align="left">5</td><td align="left">24557</td><td align="left">466, 415, 377, 190, 81</td></tr><tr><td align="left">Pancreas</td><td align="left">6321</td><td align="left">13</td><td align="left">34363</td><td align="left">2281, 1172, 1065, 711, 405, 359, 180, 61, 24, 20, 17, 14, 12</td></tr></tbody></table></table-wrap></p>
      <p id="Par53">The Embryo dataset (E-MTAB-3929) [<xref ref-type="bibr" rid="CR30">30</xref>] contains 1529 cells from human embryos with 5 cell states, corresponding to day 3 to day 7 of embryo development.</p>
      <p id="Par54">The Pancreatic dataset [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>] consists of 6321 human pancreatic islet cells with 34363 genes in 13 cell types sequenced by four distinct sequencing technologies, CelSeq (GSE81076), CelSeq2 (GSE85241), Fluidigm C1 (GSE86469) and SMART-Seq2 (E-MTAB-5061).
</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec14">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4703_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1</bold>. Results for the first experiment Change of ARI (Louvain &amp; K-means) and ACC (kNN) values with the increasing labeled proportion for six　methods　(AE, netAE, PCA, scSemiAE, scANVI and scVI) and four datasets(Cortex, Heart, Limb Muscle and　Embryos). In addition, mean and std is the mean and standard deviation.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2022_4703_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2</bold>. Results for the second experiment Change of ARI (Louvain &amp; K-means) values when increasing the number of labeled cell subpopulations for three　semi-supervised methods　(netAE, scSemiAE and scANVI) and four datasets(Cortex, Heart, Limb Muscle and　Embryos).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2022_4703_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3</bold>. Results for the third experiment Change of ARI (Louvain) and ACC (kNN) values with the increasing labeled proportion and change of ARI　(Louvain) values when increasing the number of labeled cell subpopulations for the Pancreas dataset.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par4">Single-cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p id="Par5">Principal component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>NMF</term>
        <def>
          <p id="Par6">Non-negative matrix factorization</p>
        </def>
      </def-item>
      <def-item>
        <term>scVI</term>
        <def>
          <p id="Par7">Single-cell Variational Inference</p>
        </def>
      </def-item>
      <def-item>
        <term>AE</term>
        <def>
          <p id="Par8">Autoencoder</p>
        </def>
      </def-item>
      <def-item>
        <term>ACC</term>
        <def>
          <p id="Par9">Accuracy</p>
        </def>
      </def-item>
      <def-item>
        <term>kNN</term>
        <def>
          <p id="Par10">k-Nearest neighbor</p>
        </def>
      </def-item>
      <def-item>
        <term>ARI</term>
        <def>
          <p id="Par11">Adjusted rand index</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par12">Uniform Manifold Approximation and Projection</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>FW conceived the study, wrote and revised the manuscript. YZ and JD designed the algorithm. In addition, JD performed the computational experiments and wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by grants from the National Natural Science Foundation of China (61472086).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>scSemiAE is available and open source at <ext-link ext-link-type="uri" xlink:href="https://github.com/PlusoneD/scSemiAE">https://github.com/PlusoneD/scSemiAE</ext-link>, the datasets we used are listed in above and are available.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par55">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <issue>5</issue>
        <fpage>377</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id>
        <pub-id pub-id-type="pmid">19349980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daniel</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Full-length mRNA-Seq from single-cell levels of RNA and individual circulating tumor cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <issue>8</issue>
        <fpage>777</fpage>
        <lpage>782</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2282</pub-id>
        <pub-id pub-id-type="pmid">22820318</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diether</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phenotype molding of stromal cells in the lung tumor microenvironment</article-title>
        <source>Nat Med</source>
        <year>2018</year>
        <volume>24</volume>
        <issue>8</issue>
        <fpage>1277</fpage>
        <lpage>1289</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-018-0096-5</pub-id>
        <pub-id pub-id-type="pmid">29988129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>AlJanahi</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Danielsen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dunbar</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>An introduction to the analysis of single-cell RNA-sequencing data</article-title>
        <source>Mol Ther Methods Clin Dev</source>
        <year>2018</year>
        <volume>10</volume>
        <fpage>189</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="doi">10.1016/j.omtm.2018.07.003</pub-id>
        <pub-id pub-id-type="pmid">30094294</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Villani A-C, et al. Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors. Science 2017;356(6335).</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eduardo</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rare cell detection by single-cell RNA sequencing as guided by single-molecule RNA FISH</article-title>
        <source>Cell Syst</source>
        <year>2018</year>
        <volume>6</volume>
        <issue>2</issue>
        <fpage>171</fpage>
        <lpage>179</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2018.01.014</pub-id>
        <pub-id pub-id-type="pmid">29454938</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Farrell JA, et al. Single-cell reconstruction of developmental trajectories during zebrafish embryogenesis. Science 2018; 360(6392).</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dimension reduction and clustering models for single-cell RNA sequencing data: a comparative study</article-title>
        <source>Int J Mol Sci</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>6</issue>
        <fpage>2181</fpage>
        <pub-id pub-id-type="doi">10.3390/ijms21062181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">LIII, LIII, and LIII. On lines and planes of closest fit to systems of points in space. London, Edinburgh &amp; Dublin Philosophical Magazine &amp; Journal of Science 1901.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <issue>7</issue>
        <fpage>1888</fpage>
        <lpage>1902</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>DD</given-names>
          </name>
          <name>
            <surname>Sebastian</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>
        <source>Nature</source>
        <year>1999</year>
        <volume>401</volume>
        <issue>6755</issue>
        <fpage>788</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1038/44565</pub-id>
        <pub-id pub-id-type="pmid">10548103</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep generative modeling for single-cell transcriptomics</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0229-2</pub-id>
        <pub-id pub-id-type="pmid">30504886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Kiselev VYu, Andrews TS, Hemberg M. Challenges in unsupervised clustering of single-cell RNA-seq data. Nat Rev Genet 2019;20(5):273–282.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping the mouse cell atlas by microwell-seq</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>172</volume>
        <issue>5</issue>
        <fpage>1091</fpage>
        <lpage>1107</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.02.001</pub-id>
        <pub-id pub-id-type="pmid">29474909</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Alterovitz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>netAE: semi-supervised dimensionality reduction of single-cell RNA sequencing to facilitate cell labeling</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>1</issue>
        <fpage>43</fpage>
        <lpage>49</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa669</pub-id>
        <pub-id pub-id-type="pmid">32726427</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probabilistic harmonization and annotation of single-cell transcriptomics data with deep generative models</article-title>
        <source>Mol Syst Biol</source>
        <year>2021</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>e9620</fpage>
        <pub-id pub-id-type="doi">10.15252/msb.20209620</pub-id>
        <pub-id pub-id-type="pmid">33491336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gates</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Ahn</surname>
            <given-names>Y-Y</given-names>
          </name>
        </person-group>
        <article-title>The impact of random models on clustering similarity</article-title>
        <source>J Mach Learn Res</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>28</lpage>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">McInnes L, Healy J, Melville J. Umap: Uniform manifold approximation and projection for dimension reduction. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1802.03426">arXiv:1802.03426</ext-link> (2018).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korsunsky</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>12</issue>
        <fpage>1289</fpage>
        <lpage>1296</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id>
        <pub-id pub-id-type="pmid">31740819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Welch, J., et al. Integrative inference of brain cell similarities and differences from single-cell genomics. BioRxiv 2018; 459891.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ren</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A survey of deep active learning</article-title>
        <source>ACM Comput Surv (CSUR)</source>
        <year>2021</year>
        <volume>54</volume>
        <issue>9</issue>
        <fpage>1</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1145/3472291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SciBet as a portable and fast single cell type identifier</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-13993-7</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Kiselev VYu, Yiu A, Hemberg M. scmap: projection of single-cell RNA-seq data across data sets. Nat Methods 2018; 15(5), 359-362.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Supervised classification enables rapid annotation of cell atlases</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>983</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0535-3</pub-id>
        <pub-id pub-id-type="pmid">31501545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>AW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probabilistic cell-type assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>
        <source>Nat Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>1007</fpage>
        <lpage>1015</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0529-1</pub-id>
        <pub-id pub-id-type="pmid">31501550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brbić</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MARS: discovering novel cell types across heterogeneous single-cell experiments</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>12</issue>
        <fpage>1200</fpage>
        <lpage>1206</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-00979-3</pub-id>
        <pub-id pub-id-type="pmid">33077966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Kingma, D.P., Ba, J. Adam: A method for stochastic optimization. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1412.6980">arXiv:1412.6980</ext-link> (2014).</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>347</volume>
        <issue>6226</issue>
        <fpage>138</fpage>
        <lpage>1142</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaa1934</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Tabula Muris Consortium. A single cell transcriptomic atlas characterizes aging tissues in the mouse. Nature. 2020;583(7817):590.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petropoulos</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals lineage and X chromosome dynamics in human preimplantation embryos</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <issue>4</issue>
        <fpage>1012</fpage>
        <lpage>1026</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.03.023</pub-id>
        <pub-id pub-id-type="pmid">27062923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawlor</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomes identify human islet cell signatures and reveal cell-type-specific expression changes in type 2 diabetes</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>208</fpage>
        <lpage>222</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.212720.116</pub-id>
        <pub-id pub-id-type="pmid">27864352</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>4</issue>
        <fpage>385</fpage>
        <lpage>394</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.09.002</pub-id>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
