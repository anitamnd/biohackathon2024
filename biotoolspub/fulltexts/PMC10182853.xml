<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10182853</article-id>
    <article-id pub-id-type="pmid">37084251</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad277</article-id>
    <article-id pub-id-type="publisher-id">btad277</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Effective design and inference for cell sorting and sequencing based massively parallel reporter assays</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gilliot</surname>
          <given-names>Pierre-Aurélien</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Bristol</institution>, Bristol BS8 1TQ, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1702-786X</contrib-id>
        <name>
          <surname>Gorochowski</surname>
          <given-names>Thomas E</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Bristol</institution>, Bristol BS8 1TQ, <country country="GB">United Kingdom</country></aff>
        <aff><institution>BrisEngBio, School of Chemistry, University of Bristol</institution>, Bristol BS8 1TS, <country country="GB">United Kingdom</country></aff>
        <xref rid="btad277-cor1" ref-type="corresp"/>
        <!--thomas.gorochowski@bristol.ac.uk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Martelli</surname>
          <given-names>Pier Luigi</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad277-cor1">Corresponding author. School of Biological Sciences, University of Bristol, Bristol BS8 1TQ, United Kingdom. E-mail: <email>thomas.gorochowski@bristol.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-04-21">
      <day>21</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>5</issue>
    <elocation-id>btad277</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>14</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>13</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad277.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The ability to measure the phenotype of millions of different genetic designs using Massively Parallel Reporter Assays (MPRAs) has revolutionized our understanding of genotype-to-phenotype relationships and opened avenues for data-centric approaches to biological design. However, our knowledge of how best to design these costly experiments and the effect that our choices have on the quality of the data produced is lacking.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>In this article, we tackle the issues of data quality and experimental design by developing FORECAST, a Python package that supports the accurate simulation of cell-sorting and sequencing-based MPRAs and robust maximum likelihood-based inference of genetic design function from MPRA data. We use FORECAST’s capabilities to reveal rules for MPRA experimental design that help ensure accurate genotype-to-phenotype links and show how the simulation of MPRA experiments can help us better understand the limits of prediction accuracy when this data are used for training deep learning-based classifiers. As the scale and scope of MPRAs grows, tools like FORECAST will help ensure we make informed decisions during their development and the most of the data produced.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The FORECAST package is available at: <ext-link xlink:href="https://gitlab.com/Pierre-Aurelien/forecast" ext-link-type="uri">https://gitlab.com/Pierre-Aurelien/forecast</ext-link>. Code for the deep learning analysis performed in this study is available at: <ext-link xlink:href="https://gitlab.com/Pierre-Aurelien/rebeca" ext-link-type="uri">https://gitlab.com/Pierre-Aurelien/rebeca</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>EPSRC/BBSRC Centre</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Royal Society University Research Fellowship</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="14"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The falling costs of DNA synthesis and sequencing are enabling new approaches to understand how biological function is genetically encoded (<xref rid="btad277-B22" ref-type="bibr">Kosuri and Church 2014</xref>; <xref rid="btad277-B16" ref-type="bibr">Gilliot and Gorochowski 2020</xref>; <xref rid="btad277-B2" ref-type="bibr">Almogy et al. 2022</xref>). Many of these emerging techniques exploit our newly found ability to create large libraries of precisely designed DNA sequences (i.e. a diverse set of genotypes) and efficiently assess how each of these sequences is linked to a cellular behaviour (i.e. their individual phenotypes) (<xref rid="btad277-B29" ref-type="bibr">Melnikov et al. 2012</xref>; <xref rid="btad277-B36" ref-type="bibr">Peterman et al. 2014</xref>; <xref rid="btad277-B41" ref-type="bibr">Sarkisyan et al. 2016</xref>; <xref rid="btad277-B17" ref-type="bibr">Gorochowski and Ellis 2018</xref>). Unravelling such genotype-to-phenotype maps (GP maps) via data-centric approaches has led to the creation of statistical models that are able to effectively design <italic toggle="yes">de novo</italic> genetic regulatory elements (<xref rid="btad277-B30" ref-type="bibr">Mutalik et al. 2013</xref>; <xref rid="btad277-B7" ref-type="bibr">Cambray et al. 2018</xref>; <xref rid="btad277-B24" ref-type="bibr">Kotopka and Smolke 2020</xref>; <xref rid="btad277-B26" ref-type="bibr">LaFleur et al. 2022</xref>; <xref rid="btad277-B49" ref-type="bibr">Tarnowski and Gorochowski 2022</xref>) and better understand the principles of evolution (<xref rid="btad277-B25" ref-type="bibr">Kuo et al. 2020</xref>; <xref rid="btad277-B8" ref-type="bibr">Castle et al. 2021</xref>; <xref rid="btad277-B54" ref-type="bibr">Vaishnav et al. 2022</xref>).</p>
    <p>Massively Parallel Reporter Assays (MPRAs) are a key development that has made this approach possible. This method involves generating a library of diverse genotypes whose phenotypes are linked to the expression of a fluorescence-based reporter. Using highly parallel measurement techniques, millions of genotype-to-phenotype relationships can then be established during a single experiment. Crucially, the scale of these assays ensures sufficient sampling of key areas in sequence space such that statistical models can capture or learn important features of the GP map.</p>
    <p>One of the most popular MPRAs is based on Fluorescence Activated Cell Sorting (FACS) followed by deep sequencing and is commonly referred to as Flow-seq or Sort-seq (<xref rid="btad277-F1" ref-type="fig">Fig. 1a</xref>) (<xref rid="btad277-B46" ref-type="bibr">Sharon et al. 2012</xref>; <xref rid="btad277-B12" ref-type="bibr">Dvir et al. 2013</xref>; <xref rid="btad277-B23" ref-type="bibr">Kosuri et al. 2013</xref>; <xref rid="btad277-B36" ref-type="bibr">Peterman et al. 2014</xref>; <xref rid="btad277-B6" ref-type="bibr">Bonde et al. 2016</xref>; <xref rid="btad277-B13" ref-type="bibr">Evfratov et al. 2017</xref>; <xref rid="btad277-B7" ref-type="bibr">Cambray et al. 2018</xref>; <xref rid="btad277-B3" ref-type="bibr">Angenent-Mari et al. 2020</xref>; <xref rid="btad277-B11" ref-type="bibr">de Boer et al. 2020</xref>; <xref rid="btad277-B25" ref-type="bibr">Kuo et al. 2020</xref>; <xref rid="btad277-B21" ref-type="bibr">Komarova et al. 2020</xref>; <xref rid="btad277-B24" ref-type="bibr">Kotopka and Smolke 2020</xref>; <xref rid="btad277-B31" ref-type="bibr">Osterman et al. 2020</xref>; <xref rid="btad277-B43" ref-type="bibr">Schmitz and Zhang 2021</xref>). In a Flow-seq experiment, cells are engineered to link the phenotype of interest with the expression level of a fluorescent reporter protein. This pool of cells is then sorted into bins covering different levels of fluorescence, and the contents of each bin separately sequenced to determine the genotypes associated with that observed phenotype (i.e. fluorescence intensity). The ability to generate diverse genetic libraries with approaches like highly parallel chip-based oligo synthesis, and then sort and sequence hundreds of millions of cells has enabled GP maps to be produced in unprecedented detail for many genetic parts and systems (<xref rid="btad277-B11" ref-type="bibr">de Boer et al. 2020</xref>).</p>
    <fig position="float" id="btad277-F1">
      <label>Figure 1.</label>
      <caption>
        <p>Overview of the FORECAST Python package and core functionality. (a) Main steps of a Flow-seq experiment. Experimental factors included in FORECAST’s probabilistic model are shown below each step. (b) Schematic of the FORECAST package. FORECAST allows for the definition of experimental designs that can then be simulated to generate synthetic Flow-seq data. Inference of phenotype (i.e. fluorescence distribution) from real and synthetic Flow-seq data can be performed using either a MOM or ML approach. (c) Negative log-likelihood surface computed from synthetic Flow-seq data of an example genetic variant. The ML inference method starts from the MOM estimate (blue point) and minimize the negative log-likelihood to find more accurate estimate (grey point) of the true parameter value (yellow point).</p>
      </caption>
      <graphic xlink:href="btad277f1" position="float"/>
    </fig>
    <p>While Flow-seq based MPRAs have revolutionized our ability to map out genotype-to-phenotype landscapes, the discrete binning by cell fluorescence that is necessary during the sorting phase raises issues when trying to recover a continuous fluorescence distribution for a genetic variant and accurately quantify the uncertainty in such measurements. This is problematic, as datasets exhibiting large levels of noise are ill-suited to data-driven model identification (<xref rid="btad277-B14" ref-type="bibr">Fajardo-Fontiveros et al. 2022</xref>). Some experimental studies have attempted to vary key experimental factors to assess and improve measurement accuracy (e.g. varying the number of sorting bins) (<xref rid="btad277-B46" ref-type="bibr">Sharon et al. 2012</xref>; <xref rid="btad277-B3" ref-type="bibr">Angenent-Mari et al. 2020</xref>; <xref rid="btad277-B43" ref-type="bibr">Schmitz and Zhang 2021</xref>). However, these have not generally been systematic in their approach. Therefore, the numerous options available when developing a new Flow-seq-based MPRA are typically chosen arbitrarily or to mimic previous studies. Furthermore, the methods used to infer fluorescence distributions from discretely binned Flow-seq data are often basic and can lead to biased results. More accurate estimators have been derived, but their complexity has hindered broad uptake (<xref rid="btad277-B35" ref-type="bibr">Peterman and Levine 2016</xref>; <xref rid="btad277-B24" ref-type="bibr">Kotopka and Smolke 2020</xref>).</p>
    <p>Tools from the field of design of experiments (DoE) could help guide these arbitrary choices in order to optimize information content. Through systematically designed studies that vary the factors of an experiment, DoE has proven valuable for understanding the influence of parameters in a system and enables the efficient discovery of optimal experimental designs (OEDs; <xref rid="btad277-B19" ref-type="bibr">Khoshdel and Akbarzadeh 2016</xref>; <xref rid="btad277-B27" ref-type="bibr">Lujan-Moreno et al. 2018</xref>; <xref rid="btad277-B57" ref-type="bibr">Zhang et al. 2020</xref>; <xref rid="btad277-B56" ref-type="bibr">Xiong et al. 2021</xref>). In the context of parameter estimation, efficient OED techniques have also been developed by leveraging Bayesian methods (<xref rid="btad277-B9" ref-type="bibr">Chaloner and Verdinelli 1995</xref>; <xref rid="btad277-B33" ref-type="bibr">Pauwels et al. 2014</xref>) and reinforcement learning (<xref rid="btad277-B51" ref-type="bibr">Treloar et al. 2022</xref>) to optimize relevant loss functions such as the mean square error or other criteria based on flavours of the Fischer information (<xref rid="btad277-B45" ref-type="bibr">Shahmohammadi and McAuley 2019</xref>). However, the use of these methods in MPRA studies has been limited to date.</p>
    <p>In this work, we aim to address these challenges by developing a Python package called FORECAST that implements an efficient Maximum Likelihood (ML)-based inference method and a probabilistic model of Flow-seq experiments to allow for the systematic computational exploration of parameters associated with both the experimental and analysis procedures. We demonstrate the ability of FORECAST to uncover the most critical choices when designing a Flow-seq experiment to ensure accurate inference of fluorescence distributions, and show how we can more rigorously explain the performance and sources of errors for deep learning-based models trained using real Flow-seq datasets. The ability of FORECAST to both aid in the design of new Flow-seq experiments and accurately analyse existing datasets makes it a valuable tool for supporting the creation of accurate models to both engineer and understand the genetic encoding of biological functions.</p>
  </sec>
  <sec>
    <title>2 Results</title>
    <sec>
      <title>2.1 Overview of FORECAST</title>
      <p>The FORECAST package implements two core functionalities (<xref rid="btad277-F1" ref-type="fig">Fig. 1b</xref>). The first is a probabilistic simulator of Flow-seq experiments, where all major parameters for an experimental design can be varied. Each step in a Flow-seq experiment is considered covering: the diversity of the genetic library that acts as input (i.e. the number of unique genetic variants), the sampling and sorting of a mixed pool of cells harbouring this library, the amplification of sorted designs by cell growth or PCR, and the final sequencing step that captures for each genetic variant the number of reads recovered from each bin (Section 4).</p>
      <p>In addition to the simulation of experiments, FORECAST also implements several inference methods for estimating precise fluorescence distributions from discretely binned Flow-seq data. We provide two options for inference that use either a Method of Moments (MOM) or ML-based approach (<xref rid="btad277-F1" ref-type="fig">Fig. 1c</xref>). The MOM approach is mostly agnostic to the data-generating process, while the ML approach explicitly models the Flow-seq sorting and sequencing steps in its likelihood function. Practically, the MOM approach finds estimates by a weighted average of the binned data, whereas the ML approach minimizes the likelihood function of an inhomogeneous Poisson process. Both estimators allow for fluorescence of a particular genetic variant to take the form of either a Gamma or Log-normal distribution to capture the inherent variation that is present in gene expression across a population of cells (<xref rid="btad277-B15" ref-type="bibr">Friedman et al. 2006</xref>; <xref rid="btad277-B48" ref-type="bibr">Taniguchi et al. 2010</xref>; <xref rid="btad277-B4" ref-type="bibr">Beal et al. 2022</xref>) (Section 4). These inference methods can be easily applied to existing Flow-seq datasets or FORECAST-generated computational simulations.</p>
    </sec>
    <sec>
      <title>2.2 Improved inference for Flow-seq data</title>
      <p>A critical step in a Flow-seq experiment is the inference of a continuous fluorescence distribution from the discretely binned sequencing data. It is common for this step to make use of a simple MOM estimator where a mid-point fluorescence value for each sorting bin is weighted according to the relative read frequencies across them. Although this approach is known to be unreliable and susceptible to noise in fluorescence measurements, it is still a common method due to the ease of implementation (<xref rid="btad277-B35" ref-type="bibr">Peterman and Levine 2016</xref>; <xref rid="btad277-B11" ref-type="bibr">de Boer et al. 2020</xref>; <xref rid="btad277-B52" ref-type="bibr">Trippe et al. 2022</xref>). An alternative and more robust method is to use an ML-based approach (<xref rid="btad277-B35" ref-type="bibr">Peterman and Levine 2016</xref>; <xref rid="btad277-B24" ref-type="bibr">Kotopka and Smolke 2020</xref>), but efficient implementation of this method can be difficult and the benefits compared to MOM in this context are not well understood.</p>
      <p>To better understand the impact of the inference method on the quality of the recovered distributions from Flow-seq experiments, we made use of the simulation capabilities of FORECAST to generate a large and biologically realistic Flow-seq dataset with a known ground truth for every genetic variant in the library. We specifically simulated a Flow-seq experiment with a library containing 1018 genetic variants that had Gamma distributed fluorescence, mimicking biologically realistic protein expression characteristics (<xref rid="btad277-B48" ref-type="bibr">Taniguchi et al. 2010</xref>) (Section 4). In this experiment, we sorted <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> cells into 8 bins, amplified the sorted cells by a factor of 1000, and performed sequencing using <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>7</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> reads. We then conducted inference on this synthetic Flow-seq data using both the MOM and ML estimators implemented in FORECAST.</p>
      <p>The accuracy of both inference methods was assessed by comparing the mean and standard deviation (SD) of the estimated fluorescence distribution for each genetic variant with the known ground truth (<xref rid="btad277-F2" ref-type="fig">Fig. 2a and b</xref>). We found that the ML estimates closely matched the ground truth with a Mean Absolute Percentage Error (MAPE) of 3% and 5% for the mean and SD, respectively. In contrast, the MOM estimates were continually higher than the ground truth with MAPE values of 42% and 81% for the mean and SD, respectively. Furthermore, the MOM estimates displayed a ‘staircase’ pattern that was highly pronounced for the SD estimates (<xref rid="btad277-F2" ref-type="fig">Fig. 2b</xref>). More detailed analysis of this pattern revealed that MOM estimates of fluorescence SD are similar for genetic variants sorted in the same bins (<xref rid="btad277-F2" ref-type="fig">Fig. 2b, f, and g</xref>), but vary strongly when cells fall across multiple bins (<xref rid="btad277-F2" ref-type="fig">Fig. 2b and h</xref>). This artefact results from the fact that the MOM method assumes a fixed (centre point) value of fluorescence for every design in a bin, which makes it highly sensitive to cells for a design falling near bin boundaries. We confirmed that binning was the cause of this feature by running additional simulations with an increasing number of bins. As expected, this resulted in a larger number of ‘stairs’ in the inferred mean and SD values across the library of designs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
      <fig position="float" id="btad277-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Characterizing the performance of the inference methods. (a) Scatter plot of estimated versus true mean fluorescence values from a simulated Flow-seq experiment of 1018 genetic variants. Each filled point corresponds to a genetic variant, blue for MOM estimates and grey for ML estimates. Black dashed lines denote <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> (i.e. perfect accuracy). (b) Scatter plot of estimated versus true SD in fluorescence for the same Flow-seq simulation. Each filled point corresponds to a genetic variant, blue for MOM estimates and grey for ML estimates. Black dashed lines denote <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula> (i.e. perfect accuracy). Pairs of annotated points highlighted by an unfilled black circle and connected by a line correspond to the MOM (top) and ML (bottom) estimates for the same genetic variant. Annotation corresponds to panel displaying the underlying distributions (f–h). (c) Sampled distribution of the fluorescence mean inferred using the MOM (blue) and ML (grey) approach for 500 separate Flow-seq experiments with the true value shown as a black dashed line for the ‘mob’ genetic variant. (d) Sampled distribution of the fluorescence SD inferred using the MOM (blue) and ML (grey) approach for the same replicate Flow-seq experiments with the true value shown as a black dashed line for the ‘mob’ genetic variant. (e) Sampled distribution of the 1-WD inferred using the MOM (blue) and ML (grey) approach for the same replicate Flow-seq experiments for the ‘mob’ genetic variant. (f–h) Inferred (blue line for MOM and grey line for ML) and true (black dashed line) density distributions plotted on top of the discrete histogram of cells sorted (light orange) for the highlighted genetic variants in (b).</p>
        </caption>
        <graphic xlink:href="btad277f2" position="float"/>
      </fig>
      <p>To further characterize the statistical properties of the estimators, we measured the bias (i.e. the closeness between the estimates and the true value) and variance (i.e. the dispersion from the mean prediction) of each estimator by simulating a further 500 Flow-seq experiments for the same library and identical experimental parameters (Section 4). The sampled distributions for the fluorescence mean and SD estimators across these replicates consistently showed smaller bias when using the ML inference method. The mean ratio (ML/MOM) for the bias was found to be 0.005 for the mean and 0.016 for the SD. An example of the sampled distribution for a specific genetic variant is shown in <xref rid="btad277-F2" ref-type="fig">Fig. 2c, d</xref> and for the entire genetic library in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2a and b</xref>. The variance of both estimators was comparable between the methods, with a mean ratio (ML/MOM) of 0.86 and 1.17 for the fluorescence mean and SD, respectively (<xref rid="btad277-F2" ref-type="fig">Fig. 2c and d</xref>; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p>
      <p>We further investigated the ability of each inference method to globally recover the underlying fluorescence distributions by measuring the 1-Wasserstein distance (WD) between the inferred and ground truth distributions. Intuitively, the WD measures the minimum cost of transforming one distribution into another and indicates the closeness between them. Using this distance metric, ML-inferred fluorescence distributions were found to always be closer to the ground truth than MOM-inferred versions, with a maximum ratio (WD<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>ML</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>/WD<inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>MOM</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) of 0.34 between the two methods. An example of the WD sampled distribution for one genetic construct is shown in <xref rid="btad277-F2" ref-type="fig">Fig. 2e</xref> and for the entire genetic library in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>.</p>
      <p>An additional benefit of using the ML approach is that it provides uncertainty information in the form of confidence intervals (Section 4). We validated the theoretical derivation of the confidence intervals by using the replicate Flow-seq simulations (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>) and measured the coverage rate (i.e. the number of times the confidence interval contains the true value) (Methods; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). We found that the simulation results reliably matched the confidence intervals produced from the limited number of cells and sequencing reads used.</p>
      <p>While these results demonstrated that ML inference provides a more accurate estimation of a genetic construct’s fluorescence distribution, it comes at a computational cost. Comparing the run-time for MOM and ML estimators revealed that our ML estimator was approximately 4000 times slower to compute. On average for a typical desktop computer, MOM inference took <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>77</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> ms to compute for a simple construct compared to <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>340</mml:mn></mml:mrow></mml:math></inline-formula> ms when using the ML method (Section 4). To overcome potential run-time difficulties when millions of ML estimates are required, we implemented multiprocessing in FORECAST to allow for the ML computations to be performed in parallel. We tested the scaling characteristics of our code from 1 to 28 processor cores and found a linear scaling (factor = 0.6) with no decrease in the ability to utilize newly available cores (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>).</p>
    </sec>
    <sec>
      <title>2.3 Optimal design of Flow-seq experiments</title>
      <p>Flow-seq experiments are costly and time-consuming to perform. Yet, their design is often arbitrarily based on other studies, which provides no guarantee as to the quality or accuracy of the data that will be produced. This stems from difficulties in testing the effect that experimental parameters will have on the ability to infer accurate phenotypes from data. To address this, we again employed FORECAST’s ability to simulate Flow-seq experiments and systematically explored the experimental design space to better understand the influence of each experimental factor (Section 4). We varied the number of cells sorted and sequencing reads per genetic variant, as well as the number of logarithmically spaced bins used for cell sorting, as these are the key factors that map to common choices when carrying out a Flow-seq experiment (e.g. the types of sequencer used or setting of a FACS machine). We also used a biologically realistic Log-normal distribution when generating the ground truth data for 1000 genetic variants and used both the MOM and ML estimators to infer the fluorescence distribution for each experimental design and characterized the error between the inferred and ground truth for every genetic variant as a measure of accuracy. A Bayesian OED framework (<xref rid="btad277-B38" ref-type="bibr">Robert 2007</xref>; <xref rid="btad277-B33" ref-type="bibr">Pauwels et al. 2014</xref>) was used to evaluate and compare the information content of different Flow-seq experimental design choices (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S1</xref>).</p>
      <p>We first explored the impact of varying each experimental parameter on the global accuracy of the two inference methods by computing the mean of the WD (MWD) across the entire genetic variant library. Increasing the number of cells sorted, sequencing reads, and sorting bins all improved the accuracy of the inferred values (i.e. lower MWD values), but with diminishing returns (<xref rid="btad277-F3" ref-type="fig">Fig. 3a–d</xref>). Furthermore, inference using ML consistently outperformed the MOM approach, with the gap in performance becoming reduced as the number of sorting bins increased. We also see a reduction in MWD for the ML estimates as the number of reads and cells per genetic variant increases. This is coherent with the asymptotic consistency of ML estimates, supporting the fact that this method can recover an underlying distribution with arbitrary precision (<xref rid="btad277-B34" ref-type="bibr">Pawitan 2013</xref>).</p>
      <fig position="float" id="btad277-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Effect of experimental design parameters on the accuracy of phenotype inference for Flow-seq experiments. (a) Global accuracy given by the MWD of simulated Flow-seq experiments with eight bins used for cell sorting and varying numbers of sequencing reads per genetic variant and numbers of cells sorted per variant. MWD shown for inference using MOM (blue lines) and ML (grey lines) and SD in these measurements shown by the shaded regions around each line. (b) Global accuracy in terms of MWD shown for same experiments as in (a), but using 32 bins for cell sorting. (c) MAPE when estimating the fluorescence mean using either MOM (blue) or ML (grey) inference methods. Averages were taken over the full library of genetic variants and Flow-seq simulation replicates. Black dashed line denotes the general optimal operating point. (d) MAPE when estimating the fluorescence SD using either MOM (blue) or ML (grey) inference methods. Averages were taken over the full library of genetic variants and Flow-seq simulation replicates. (e) Coefficients of the MLR used to fit the MWD as a function of the number of sorting bins (‘Bins’), the log-number of reads (‘Reads’) and log-number of cells per genetic variant (‘Cells’). (f) Distribution of the optimal operating point in terms of the number of sequencing reads per genetic variant in a Flow-seq experiment for MOM (blue, bottom) and ML (grey, top) inference methods. (g) Distribution of the optimal operating point in terms of the number of cells sorted per genetic variant in a Flow-seq experiment for MOM (blue, bottom) and ML (grey, top) inference methods. (h) Distribution of the optimal operating point in terms of the number of cells sorted per genetic variant in a Flow-seq experiment for MOM (blue, bottom) and ML (grey, top) inference methods.</p>
        </caption>
        <graphic xlink:href="btad277f3" position="float"/>
      </fig>
      <p>Similar observations are seen for the local behaviour of each inference method, which was assessed using the MAPE of the fluorescence mean or SD (<xref rid="btad277-F3" ref-type="fig">Fig. 3c and d</xref>). We found that the relative error made using the ML approach is always smaller compared to the MOM approach (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). Furthermore, we observed that estimating the fluorescence SD is more challenging than estimating the mean with the MAPE of the SD being 5 times larger than the MAPE of the mean for both inference methods (MAPE ratios across all numbers of sequencing reads and inference methods are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>).</p>
      <p>To quantify the relative importance of each experimental factor, we used a multiple linear regression (MLR) model to capture the relationship between the MWD and the number of bins, sequencing reads, and cells sorted per genetic variant (Section 4). By extracting the coefficient for each predictor variable, we could compare the importance of every experimental factor for each inference method. We found that the number of bins was twice as important for accurate MOM inference compared to when ML was used.</p>
      <p>Our ability to observe how various experimental factors affect the accuracy of inference, offers the chance to provide rules that could help ensure a good accuracy of measurements when designing an MPRA experiment. To determine these ideal parameters, we analysed the diminishing returns phenomena observed when varying each experimental parameter (<xref rid="btad277-F3" ref-type="fig">Fig. 3a and b</xref>). We found that a constant decrease in MWD required increasing resources. Therefore, we would expect a point where the relative cost in terms of the scale of an experiment is no longer worth the corresponding benefit in improved measurement accuracy. By assuming constant relative costs, we determined the optimal operating points for each experimental factor using the kneedle algorithm (<xref rid="btad277-B42" ref-type="bibr">Satopaa et al. 2011</xref>) (<xref rid="btad277-F3" ref-type="fig">Fig. 3a</xref>; Section 4). It should be noted that this approach could be extended to account for varying costs of factors in the experimental design by weighting each of these accordingly.</p>
      <p>To extract the ideal value for the number of sequencing reads per genetic variant, we ran the kneedle algorithm on all possible combinations of the number of bins and number of cells sorted per genetic variant for each inference method (Section 4; <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S8 and S9</xref>). This led to a collection of <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mn>9</mml:mn><mml:mo>×</mml:mo><mml:mn>9</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>162</mml:mn></mml:mrow></mml:math></inline-formula> optimal operating points, with ˃80% of them corresponding to the value 100 sequencing reads per genetic variant for each inference method (<xref rid="btad277-F3" ref-type="fig">Fig. 3f</xref>). The same approach was used to examine the optimal level for the number of cells sorted (<xref rid="btad277-F3" ref-type="fig">Fig. 3g</xref>) and for the number of bins (<xref rid="btad277-F3" ref-type="fig">Fig. 3h</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>), which also returned the same level of 100 cells sorted into 10 bins ˃75% of the time. This combination of parameters corresponds to sequencing on average all cells in the library before amplification.</p>
      <p>While these general rules are useful for guiding future experiments, the response curves we have generated can also be used to select experimental parameters where specific costs and trade-offs exist for a particular experimental setup and a known level of accuracy is required.</p>
    </sec>
    <sec>
      <title>2.4 Unravelling sources of errors when using Flow-seq data</title>
      <p>The large amounts of data produced by Flow-seq experiments are ideal for training deep learning-based models (<xref rid="btad277-B40" ref-type="bibr">Sample et al. 2019</xref>; <xref rid="btad277-B3" ref-type="bibr">Angenent-Mari et al. 2020</xref>; <xref rid="btad277-B24" ref-type="bibr">Kotopka and Smolke 2020</xref>). A challenge in this context is knowing what sort of accuracy can be achieved by a model given the inherent variability in the underlying biology and experimental procedures.</p>
      <p>To show how FORECAST can help to answer this, we considered a recent study by Evfratov et al. that investigated how a messenger RNA’s 5′ untranslated region (5′UTR) regulates the translation initiation rate of an associated reporter gene (<xref rid="btad277-B13" ref-type="bibr">Evfratov et al. 2017</xref>). This study involved a Flow-seq experiment in which a library of ∼28 000 different genetic variants was tested. Using data from this experiment as our ground truth, we defined a classification task where the bin (1–8) in which the majority of cells were sorted (i.e. the ‘mode bin’) needed to be predicted for each genetic variant. This task and the amount of available data are well suited to a deep learning-based classifier and provided an opportunity to systematically assess how experimental design choices might limit the predictive accuracy that could be achieved and pinpoint the sources of errors.</p>
      <p>Due to the stochastic nature of the sorting and sequencing steps in a Flow-seq experiment, we would expect some mode bin measurements to potentially vary between experiments (especially for genetic variants whose mode fluorescence falls near bin boundaries). To estimate the experimental-level accuracy that can be achieved due to this effect, we simulated many Flow-seq experiments with a varying number of sequencing reads and sorted cells for each genetic variant (Section 4). For each genetic variant and combination of experimental factors, we measured the mode bin and compared it to the ground truth. We then obtained a frequency of correct mode bin measurements for each experimental factor by averaging over the genetic library and simulation replicates. We found that measuring the mode bin from Flow-seq data can be difficult, especially in regimes of low-experimental resources where the frequency of correct mode bin measurements can be as low as 50% (<xref rid="btad277-F4" ref-type="fig">Fig. 4a</xref>; Section 4). Increasing the number of sequencing reads and cells sorted was found to improve the accuracy of mode bin measurements, although with diminishing returns.</p>
      <fig position="float" id="btad277-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Understanding the limits to prediction accuracy from Flow-seq experiments. (a) Accuracy upper limit when predicting the mode bin as a function of the number of sequencing reads and cells sorted per genetic variant. Cells sorted per variant took the values 1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 72, 80, 100, 120, 140, 160, 180, and 200 (light to dark blue lines). Each value was estimated by running FORECAST simulations with different experimental factors. (b) Neural network architectures used to predict the mode bin from 5′UTR sequence. (c) Scatter plot of the validation set accuracy against the number of trainable parameters in the model. Each point corresponds to a particular combination of hyperparameters for a class of neural network (MLP = blue; CNN = orange; RNN = purple, Hybrid = green). (d) Confusion matrix of the hybrid CNN+RNN architecture with the best performance and fewest trained parameters evaluated on a previous Flow-seq study (<xref rid="btad277-B13" ref-type="bibr">Evfratov et al. 2017</xref>). Global accuracy is 51.8%.</p>
        </caption>
        <graphic xlink:href="btad277f4" position="float"/>
      </fig>
      <p>These estimates for the frequency of correct mode bin assignments allow us to quantify the maximum accuracy that can be reached for any model trained or fitted to the data from this Flow-seq study. To empirically assess this, we split the data into a training set (80%), validation set (10%), test set (10%), and then computed the maximum achievable accuracy of a model on each data split by pulling the corresponding frequency of correct mode bin measurements given the experimental resources it was calculated from. To ensure some differences in the achievable accuracies, the test set was selected to have a higher maximum accuracy (75% compared with 70% for both the training and validation sets) by selecting genetic variants with the most sequencing reads (Section 4).</p>
      <p>Having selected appropriate datasets, we next needed a model to learn how 5′UTR sequence mapped to protein expression level. While mechanistic models of translation initiation do exist (<xref rid="btad277-B39" ref-type="bibr">Salis et al. 2009</xref>; <xref rid="btad277-B44" ref-type="bibr">Seo et al. 2014</xref>), they typically are not highly predictive when applied to datasets not used for fitting. In contrast, ML-based models using deep neural networks have made large strides in this domain, allowing for automatic feature extraction and the best predictive accuracies seen to date (<xref rid="btad277-B37" ref-type="bibr">Quang and Xie 2016</xref>; <xref rid="btad277-B58" ref-type="bibr">Zou et al. 2019</xref>; <xref rid="btad277-B59" ref-type="bibr">Zrimec et al. 2021</xref>).</p>
      <p>Here, we selected four common deep neural network architectures to learn the mapping between 5′UTR sequence and the translation efficiency (i.e. fluorescence) from data. In particular, we considered a multi-layer perceptron (MLP), convolutional neural network (CNN) using an MLP for feature extraction as a final step, recurrent neural network (RNN) (<xref rid="btad277-F4" ref-type="fig">Fig. 4b</xref>) and hybrid CNN+RNN. All of these neural network architectures were trained to predict the mode bin from the 5′UTR sequence on the training set, and a medium-sized hyperparameter optimization on the validation set was used to compare the performance of each architecture (Section 4). We found that the best-performing architecture was the hybrid CNN+RNN, with a validation accuracy of 48%, compared with a possible maximum accuracy of 70% (<xref rid="btad277-F4" ref-type="fig">Fig. 4c</xref>).</p>
      <p>At least two reasons could explain the 22% gap between the validation accuracy and the maximum achievable accuracy. First, the approximations used to model Flow-seq experiments might be too simplistic, meaning the estimates for the maximum achievable accuracy are overly optimistic. Second, the neural network model might need further refinement and additional training data to better approximate the mapping between sequence and function.</p>
      <p>To explore the first hypothesis, we evaluated the performance of the hybrid CNN+RNN model that had minimal model complexity (i.e. number of trainable parameters) while maximizing validation accuracy on the test dataset (<xref rid="btad277-F4" ref-type="fig">Fig. 4c</xref>). We found that this architecture achieves a <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mo>∼</mml:mo></mml:math></inline-formula>4% improvement in accuracy on the test set (51.8% accuracy on the test set compared with 48.3% on the validation set; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>), which closely matches the 5% increase in accuracy predicted by the simulations (maximum accuracy limit of 75% on the test set compared with 70% on the validations set). This suggests that the magnitude of the experimental-level accuracy estimates is likely correct and that further data are required for the model to better capture the complex relationship between sequence and function. In addition, the confusion matrix showed that the distribution of errors was not random, with most errors corresponding to predictions <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mo>±</mml:mo></mml:math></inline-formula>1 bin away from the true value (<xref rid="btad277-F4" ref-type="fig">Fig. 4d</xref>). This type of error matches our simulations, with inaccurate measurements typically falling in a neighbouring bin of the true mode bin.</p>
      <p>We can also determine the lower bound for the prediction error by using FORECAST when the target output is a continuous variable instead of the discrete mode bin. To demonstrate this we made use of a Flow-seq dataset from <xref rid="btad277-B7" ref-type="bibr">Cambray et al. (2018)</xref>, which investigates the link between coding sequence composition and translation efficiency for a library of 244  000 variants. After fitting Log-normal distributions to each variant using FORECAST, we trained and optimized a hybrid CNN+RNN model to predict the mean of the log-fluorescence distribution from sequence alone (Methods). Most model predictions of the log-fluorescence mean were close to the ground truth on the test set with a median absolute percentage error of 18% (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>). However, a few sequences with weak expression were incorrectly predicted as having strong expression. To assess the part of the error due to Flow-seq variability and not due to the deep learning model, known as irreducible error, we computed using FORECAST the width of the confidence interval associated when estimating the log-fluorescence mean. For the test set, the median 99% confidence interval width was 0.13, corresponding to the irreducible error of the best regression model (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>). Our deep learning model produced a larger error of 0.47, suggesting that the model could be improved further.</p>
      <p>In summary, the ability to estimate limits on achievable accuracies by simulating Flow-seq experiments using FORECAST provides valuable insight into what we can expect to achieve with state-of-the-art models and how model performance is best assessed.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Discussion</title>
    <p>As data-centric approaches to biological design and understanding rise in popularity, it is vital to make the best use of the costly and time-consuming experiments that fuel them. Here, we have shown how our computational tool called FORECAST can support both effective experimental design and improved inference when using large-scale datasets from Flow-seq-based MPRAs. Through extensive simulation, we demonstrated how increases in the scale of a Flow-seq experiment resulted in diminishing returns for the accuracy of inferred phenotypes. This allowed us to derive some simple advice to ensure good quality data are produced from a Flow-seq-based MPRA: a library with <italic toggle="yes">n</italic> different genetic variants should at least be sorted in 10 bins, with 100 cells and sequencing reads per variant. We see this recommendation as an easy-to-apply rule to help design effective Flow-seq experiments that typically sets a limit on the size of the library that can be considered given the available sorting and sequencing resources. For example, a lab using a MiSeq sequencer offering <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mo>∼</mml:mo></mml:math></inline-formula>20 million reads per run can characterize a library containing a maximum of <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mo>∼</mml:mo></mml:math></inline-formula>200  000 different genetic variants (assuming there is no bias in the initial library composition).</p>
    <p>Ensuring the most is made of this data is also crucial and we have shown how the ML-based inference method implemented by FORECAST provides a 16.2-fold improvement in MAPE compared to widely used MOM-based approaches. Such improvements are supported by other studies that have applied ML to inference to MPRAs, but which did not account for the stochasticity introduced by the sequencing step (<xref rid="btad277-B35" ref-type="bibr">Peterman and Levine 2016</xref>). The use of our ML estimator is not only compelling due to its ability to reach high inference accuracy from smaller scale experiments, but it is also able to provide valuable information on the uncertainty of the estimates in the form of confidence intervals. Furthermore, existing Flow-seq datasets can benefit from this easy to use ML inference functionality, offering the potential to refine our understanding of core biological processes like transcription (<xref rid="btad277-B20" ref-type="bibr">Kinney et al. 2010</xref>; <xref rid="btad277-B46" ref-type="bibr">Sharon et al. 2012</xref>; <xref rid="btad277-B23" ref-type="bibr">Kosuri et al. 2013</xref>; <xref rid="btad277-B5" ref-type="bibr">Belliveau et al. 2018</xref>; <xref rid="btad277-B53" ref-type="bibr">Urtecho et al. 2019</xref>; <xref rid="btad277-B11" ref-type="bibr">de Boer et al. 2020</xref>; <xref rid="btad277-B24" ref-type="bibr">Kotopka and Smolke 2020</xref>) and translation (<xref rid="btad277-B23" ref-type="bibr">Kosuri et al. 2013</xref>; <xref rid="btad277-B50" ref-type="bibr">Townshend et al. 2015</xref>; <xref rid="btad277-B6" ref-type="bibr">Bonde et al. 2016</xref>; <xref rid="btad277-B7" ref-type="bibr">Cambray et al. 2018</xref>; <xref rid="btad277-B40" ref-type="bibr">Sample et al. 2019</xref>; <xref rid="btad277-B25" ref-type="bibr">Kuo et al. 2020</xref>; <xref rid="btad277-B43" ref-type="bibr">Schmitz and Zhang 2021</xref>) via reanalysis.</p>
    <p>Although FORECAST offers many benefits, there are some limitations to its use. The most prominent of these is the limited number of distributions available for describing the inherent variability in reporter expression for simulation and inference. The Log-normal and Gamma distributions included will cover most use cases. However, some biological processes can lead to complex expression profiles with bimodal features that are difficult to capture in a parametric form (<xref rid="btad277-B7" ref-type="bibr">Cambray et al. 2018</xref>). The open source nature of FORECAST’s code allows for other distributions to be implemented for specific use cases (Data Availability), and an interesting future direction would be to include goodness of fit functionality (e.g. using a chi-squared test) to fit the distribution most appropriate for the data at hand. It would also be interesting to investigate the impact of post-sorting DNA amplification, which is typically considered homogeneous within each sorting bin. This may not, however, hold experimentally and lead to biases being introduced.</p>
    <p>In addition to MPRAs that rely on FACS, there has been increasing interest in using changes in cell growth rate as a way to characterize large mixed pools of genetic constructs (<xref rid="btad277-B10" ref-type="bibr">Cuperus et al. 2017</xref>; <xref rid="btad277-B47" ref-type="bibr">Tack et al. 2021</xref>). Similar to a fluorescent protein acting as output in a Flow-seq experiment, these alternative MPRAs typically express either an antibiotic resistance gene or anti-toxin to counteract some form of environmental selection (e.g. the presence of an antibiotic). This enables expression of the output gene to affect the cell’s growth rate, and by using sequencing to quantify the change in genotype composition of the population, the strength of output expression can be inferred. At present, FORECAST is not designed to support these types of MPRA. However, this could offer an valuable direction for future development, broadening the application of computational simulation platforms when designing high-throughput genotype-to-phenotype mapping experiments.</p>
    <p>In summary, this work demonstrates how computational methods can support many aspects of experimental and model design, allowing for the exploration of design spaces that would otherwise be impractical or too expensive to investigate physically. As the scale of MPRAs increases, making the best use of the resources available and the data generated will be critical for unravelling accurate GP maps and offering new approaches to rationally engineer biology.</p>
  </sec>
  <sec>
    <title>4 Methods</title>
    <sec>
      <title>4.1 Data-generating process</title>
      <p>We considered the following generating process for each Flow-seq simulation. Let <italic toggle="yes">D</italic> be the diversity of the library (the number of different genetic variants), <italic toggle="yes">N</italic> the number of FACS events (i.e. the total number of sorted cells), <italic toggle="yes">B</italic> the number of bins used to sort the cells, <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> the fluorescence bounds of sorting bin <italic toggle="yes">j</italic> and <italic toggle="yes">R</italic> the total number of sequencing reads. We use the lower-case versions of each parameter to refer to any value in between. The cell sorting step is modelled by the first loop, while the second loop models the sequencing step.</p>
      <p>
        <boxed-text id="btad277-BOX1" position="float">
          <caption>
            <p>Algorithm 1. Flow-Seq data generation</p>
          </caption>
          <p>1: Draw <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mo>[</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>D</mml:mi></mml:mfrac><mml:mo>]</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> to get the number of cells sorted for each genetic variant <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
          <p>2: <bold>for</bold> each genetic variant <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><bold>do</bold></p>
          <p>3:   Draw <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> samples from the fluorescence distribution <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mo>θ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></p>
          <p>4:    Sort samples in the appropriate fluorescence bin</p>
          <p>5:   Count number of samples in each bin: <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></p>
          <p>6:    Multiply each <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> by the PCR amplification factor</p>
          <p>7: <bold>end for</bold></p>
          <p>8: <bold>for</bold> each bin <italic toggle="yes">b</italic>: <bold>do</bold></p>
          <p>9:   Compute the total number of cells: <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>d</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula></p>
          <p>10:  Compute the event probabilities <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="true">[</mml:mo><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></p>
          <p>11:  Draw <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Multinomial</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mi>R</mml:mi><mml:mi>B</mml:mi></mml:mfrac><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula></p>
          <p>12: <bold>end for</bold></p>
          <p>13: return <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula></p>
        </boxed-text>
      </p>
    </sec>
    <sec>
      <title>4.2 Verifying assumptions during simulation and inference</title>
      <p>A multinomial sampling scheme (drawing with replacement) was used to model the sequencing step in the Flow-seq simulations. Although an hypergeometric sampling scheme (drawing without replacement) would be more appropriate, it would create a significant computational bottleneck during our simulations. Using a multinomial sampling scheme allows us to generate faster simulations, but we need to verify this approximation.</p>
      <p>The validity of the multinomial approximation is controlled by the ratio <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">N</italic> is the total number of cells sorted and <italic toggle="yes">R</italic> the total number of sequencing reads. Hence, conclusions should become particularly accurate as <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>10</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>. We used a second approximation to derive the log-likelihood, which is to use a Poisson distribution instead of a bimonial distribution. This approximation requires large <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mi>R</mml:mi><mml:mi>B</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> and small <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mi>N</mml:mi></mml:mfrac><mml:mo>∼</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">B</italic> is the number of sorting bins, <italic toggle="yes">C</italic> the diversity of the library and <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> the number of cells sorted corresponding to the <italic toggle="yes">j</italic>-th genetic variant. This approximation holds because we typically have for Flow-seq experiments <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mi>R</mml:mi><mml:mi>B</mml:mi></mml:mfrac><mml:mo>≥</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>C</mml:mi></mml:mfrac><mml:mo>≤</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>4.3 Fluorescence data and parameterization</title>
      <p>Here, we specify the origin of the fluorescence data we use for our simulations and the families of distributions used to model the fluorescence. To ensure resemblance with reality, we used experimental Flow-seq data and <italic toggle="yes">Escherichia coli</italic> fluorescence distribution parameters to generate our simulations. Gamma and Log-normal distributions were used separately to model the fluorescence data of each genetic variant. We chose the shape/scale parameterization when using the gamma distribution to model the fluorescence. This gives the mean <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mo>μ</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:math></inline-formula>, SD <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mo>σ</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> and density function,
</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>g</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>a</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo> </mml:mo>
                <mml:mtext>exp</mml:mtext>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mo>−</mml:mo>
                <mml:mi>x</mml:mi>
                <mml:mo>/</mml:mo>
                <mml:mi>b</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>Γ</mml:mo>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>a</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>b</mml:mi>
                  </mml:mrow>
                  <mml:mi>a</mml:mi>
                </mml:msup>
              </mml:mrow>
            </mml:mfrac>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>Gamma distribution parameters (<italic toggle="yes">a</italic>, <italic toggle="yes">b</italic>) for each genetic variant were taken from existing data (<xref rid="btad277-B48" ref-type="bibr">Taniguchi et al. 2010</xref>). We simplified the analysis when using the Log-normal distribution modelling choice by first log-transforming the fluorescence data. As we operate on the log-fluorescence domain, the Log-normal distribution has the same parameterization as a Gaussian distribution. The density function <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is then given by,
where <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mo>μ</mml:mo></mml:math></inline-formula> is the mean log fluorescence and <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mo>σ</mml:mo></mml:math></inline-formula> is the SD of the log fluorescence. Parameters were inferred from a previous Flow-Seq experiment (<xref rid="btad277-B7" ref-type="bibr">Cambray et al. 2018</xref>).</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mi>g</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>x</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mn>1</mml:mn>
              <mml:mrow>
                <mml:mo>σ</mml:mo>
                <mml:msqrt>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:mo>π</mml:mo>
                  </mml:mrow>
                </mml:msqrt>
              </mml:mrow>
            </mml:mfrac>
            <mml:msup>
              <mml:mrow>
                <mml:mi>e</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>−</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mo>μ</mml:mo>
                            </mml:mrow>
                            <mml:mo>σ</mml:mo>
                          </mml:mfrac>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:msup>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
    <sec>
      <title>4.4 Inference using the MOM</title>
      <p>During the sorting step, the precise fluorescence information for each cell is lost. In the MOM inference procedure, each cell is assigned a fluorescence value depending on the bin it was sorted in; here we used the fluorescence midpoint of each bin. This enables us to compute the experimental mean <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and SD <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. The MOM estimates <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>MOM</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are then obtained by equating the experimental and theoretical moments to give <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>MOM</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>MOM</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>MOM</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>MOM</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for the shape and scale of the Gamma distribution [<xref rid="E1" ref-type="disp-formula">Equation (1)</xref>] and Gaussian distribution [<xref rid="E2" ref-type="disp-formula">Equation (2)</xref>], respectively.</p>
    </sec>
    <sec>
      <title>4.5 Deriving the model likelihood</title>
      <p>We extended a previous formulation of the likelihood used to account for the stochasticity observed during the sequencing step (<xref rid="btad277-B35" ref-type="bibr">Peterman and Levine 2016</xref>; <xref rid="btad277-B24" ref-type="bibr">Kotopka and Smolke 2020</xref>). A typical model to represent the sequencing count data is to use a Poisson distribution (<xref rid="btad277-B28" ref-type="bibr">Marioni et al. 2008</xref>; <xref rid="btad277-B18" ref-type="bibr">Jiang and Wong 2009</xref>; <xref rid="btad277-B55" ref-type="bibr">Wang et al. 2010</xref>). We denote the read count for genetic variant <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> observed when sequencing bin <italic toggle="yes">b</italic> by <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. Noting that <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, the data-generating procedure can then be written as,
</p>
      <disp-formula id="E3">
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>latent</mml:mi>
                <mml:mo> </mml:mo>
                <mml:mi>layer</mml:mi>
                <mml:mo> </mml:mo>
                <mml:msup>
                  <mml:mi>n</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>∼</mml:mo>
                <mml:mi>G</mml:mi>
                <mml:mo>(</mml:mo>
                <mml:mi>a</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>b</mml:mi>
                <mml:mo>)</mml:mo>
                <mml:mo> </mml:mo>
                <mml:mtext>or</mml:mtext>
                <mml:mo> </mml:mo>
                <mml:mo> </mml:mo>
                <mml:mtext>log</mml:mtext>
                <mml:mo> </mml:mo>
                <mml:mi mathvariant="script" class="calligraphy">N</mml:mi>
                <mml:mo>(</mml:mo>
                <mml:mo>μ</mml:mo>
                <mml:mo>,</mml:mo>
                <mml:msup>
                  <mml:mo>σ</mml:mo>
                  <mml:mn>2</mml:mn>
                </mml:msup>
                <mml:mo>)</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>observation</mml:mi>
                <mml:mo> </mml:mo>
                <mml:mi>layer</mml:mi>
                <mml:mo> </mml:mo>
                <mml:msubsup>
                  <mml:mi>s</mml:mi>
                  <mml:mi>b</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>∣</mml:mo>
                <mml:msubsup>
                  <mml:mi>n</mml:mi>
                  <mml:mi>b</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>∼</mml:mo>
                <mml:mi mathvariant="script" class="calligraphy">P</mml:mi>
                <mml:mo>(</mml:mo>
                <mml:msubsup>
                  <mml:mo>λ</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>)</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Let <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> be the rate of the Poisson distribution: <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This rate is given by,
where <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mo>θ</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>) is either a Gamma or Log-normal density function, <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> are the fluorescence boundaries for sorting bin <italic toggle="yes">b</italic>, <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> the total number of cells sorted for the genetic variant <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> the number of cells sorted in bin <italic toggle="yes">b</italic>, and <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> the total number of sequencing reads in bin <italic toggle="yes">b</italic>. A common estimate for <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is (<xref rid="btad277-B24" ref-type="bibr">Kotopka and Smolke 2020</xref>),
</p>
      <disp-formula id="E4">
        <label>(3)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:msubsup>
                  <mml:mo>λ</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mtext>Pr</mml:mtext>
                <mml:mo>(</mml:mo>
                <mml:mtext>sequencing construct</mml:mtext>
                <mml:mo> </mml:mo>
                <mml:mi>d</mml:mi>
                <mml:mo> </mml:mo>
                <mml:mtext>in bin</mml:mtext>
                <mml:mo> </mml:mo>
                <mml:mi>d</mml:mi>
                <mml:mo>)</mml:mo>
                <mml:mo>×</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:mo> </mml:mo>
                <mml:mtext>reads allocated</mml:mtext>
                <mml:mo>)</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>=</mml:mo>
                <mml:mo stretchy="true">(</mml:mo>
                <mml:mfrac>
                  <mml:msubsup>
                    <mml:mi>n</mml:mi>
                    <mml:mi>b</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mi>d</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>b</mml:mi>
                  </mml:msub>
                </mml:mfrac>
                <mml:mo stretchy="true">)</mml:mo>
                <mml:mo>×</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mi>s</mml:mi>
                  <mml:mi>b</mml:mi>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfenced>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:msup>
                        <mml:mi>n</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mi>d</mml:mi>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:msup>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mi>b</mml:mi>
                      </mml:msub>
                    </mml:mfrac>
                    <mml:msubsup>
                      <mml:mo>∫</mml:mo>
                      <mml:msub>
                        <mml:mi>F</mml:mi>
                        <mml:mi>b</mml:mi>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>F</mml:mi>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:msubsup>
                    <mml:msubsup>
                      <mml:mi>g</mml:mi>
                      <mml:mo>θ</mml:mo>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>d</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>(</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mi>d</mml:mi>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo>×</mml:mo>
                <mml:mo>(</mml:mo>
                <mml:msub>
                  <mml:mi>s</mml:mi>
                  <mml:mi>b</mml:mi>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <disp-formula id="E5">
        <label>(4)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mi>n</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>d</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mo>∑</mml:mo>
              <mml:mi>b</mml:mi>
            </mml:munder>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mover accent="true">
                      <mml:mi>n</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                </mml:mrow>
                <mml:mi>b</mml:mi>
                <mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>d</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mo>∑</mml:mo>
              <mml:mi>b</mml:mi>
            </mml:munder>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mi>b</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>d</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mi>b</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mi>b</mml:mi>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The output of a Flow-seq experiment is the sequencing data, which can be represented by a <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo>×</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> matrix of discrete values. The likelihood of observing one row of this matrix is the product of the probabilities that we sequenced <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> times the genetic variant <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in bin <italic toggle="yes">b</italic>, thus,
</p>
      <disp-formula id="E6">
        <label>(5)</label>
        <mml:math id="M6" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi>l</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>d</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:munderover>
              <mml:mo>∏</mml:mo>
              <mml:mrow>
                <mml:mi>b</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mi>b</mml:mi>
            </mml:munderover>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo>λ</mml:mo>
                          </mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>d</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                        <mml:mi>b</mml:mi>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>d</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mi>b</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>d</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>!</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo> </mml:mo>
            <mml:mtext>exp</mml:mtext>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mo>−</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mo>λ</mml:mo>
              </mml:mrow>
              <mml:mi>b</mml:mi>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>d</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>For numerical stability, we worked with the negative log-likelihood giving,
</p>
      <disp-formula id="E7">
        <label>(6)</label>
        <mml:math id="M7" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtable>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi mathvariant="script" class="calligraphy">L</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>d</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mtd>
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mtext>log</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>d</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mtext>log</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∏</mml:mo>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>B</mml:mi>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:msubsup>
                                <mml:mrow>
                                  <mml:mo>λ</mml:mo>
                                </mml:mrow>
                                <mml:mi>b</mml:mi>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>d</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:msubsup>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                              <mml:mi>b</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>d</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>d</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>!</mml:mo>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mtext>exp</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo>λ</mml:mo>
                      </mml:mrow>
                      <mml:mi>d</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>b</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>,</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr columnalign="left">
                <mml:mtd columnalign="left">
                  <mml:mrow/>
                </mml:mtd>
                <mml:mtd columnalign="left">
                  <mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>B</mml:mi>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mo stretchy="false">[</mml:mo>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo>λ</mml:mo>
                      </mml:mrow>
                      <mml:mi>b</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>d</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>−</mml:mo>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                      <mml:mi>b</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>d</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo> </mml:mo>
                    <mml:mtext>log</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo>λ</mml:mo>
                      </mml:mrow>
                      <mml:mi>b</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>d</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>+</mml:mo>
                    <mml:mtext>log</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                      <mml:mi>b</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>d</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>!</mml:mo>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo stretchy="false">]</mml:mo>
                    <mml:mo>.</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
    <sec>
      <title>4.6 Finding the likelihood maximum</title>
      <p>The point <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>ML</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in parameter space maximizing the likelihood function [<xref rid="E6" ref-type="disp-formula">Equation (5)</xref>] corresponds to the ML estimates <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>ML</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. However, the first-order conditions of the likelihood function cannot be solved analytically. Therefore, we obtained the ML estimates for the fluorescence distribution parameters by numerically minimizing the negative log-likelihood function <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script" class="calligraphy">L</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> using the Nelder–Mead simplex algorithm. The starting point for the minimization procedure was initialized with the MOM estimates <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>MOM</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. To make sure the estimates were positive after the final minimization step, we worked with the log-transformed variables <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> when using the normal distribution and <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> when using the gamma distribution. The invariance property of ML (<xref rid="btad277-B34" ref-type="bibr">Pawitan 2013</xref>) ensures the log-likelihood maximum is the same in log space. We then applied the exponential function to get the ML estimates <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>ML</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>4.7 Computing confidence intervals</title>
      <p>The ML framework provides additional information on the estimates in the form of confidence intervals (<xref rid="btad277-B34" ref-type="bibr">Pawitan 2013</xref>). To obtain the confidence intervals, we computed the observed Fischer information matrix <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>ML</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by evaluating the Hessian of the negative log-likelihood <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:msup><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">L</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mtext>ML</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at the point maximizing the likelihood. We then computed the inverse of the observed Fischer information <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and extracted its diagonals elements to get the <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mn>100</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>% confidence intervals for each estimate <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>ML</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>ML</mml:mtext><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>ML</mml:mtext><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Specifically,
where <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>α</mml:mo><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the corresponding <italic toggle="yes">z</italic>-score for the <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:mn>100</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>% confidence interval. To compute the confidence intervals for the mean <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mo>μ</mml:mo></mml:math></inline-formula> and the variance <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> when using the gamma distribution, we use the delta theorem and the transformation <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>↦</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This leads to the following <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:mn>100</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>% confidence interval,
with <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">J</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> the Jacobian of the transformation,
</p>
      <disp-formula id="E8">
        <label>(7)</label>
        <mml:math id="M8" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mi>θ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>ML</mml:mtext>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>±</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>z</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>α</mml:mo>
                <mml:mo>/</mml:mo>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mo> </mml:mo>
            <mml:mtext>se</mml:mtext>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mi>θ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mtext>ML</mml:mtext>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mi>θ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:msub>
            <mml:mo>±</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>z</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>α</mml:mo>
                <mml:mo>/</mml:mo>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:msqrt>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi mathvariant="normal">I</mml:mi>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mover accent="true">
                                    <mml:mi>θ</mml:mi>
                                    <mml:mo>^</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mtext>ML</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
            </mml:msqrt>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E9">
        <label>(8)</label>
        <mml:math id="M9" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:mo stretchy="true">[</mml:mo>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mi>μ</mml:mi>
                          <mml:mo>^</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mover accent="true">
                                <mml:mi>σ</mml:mi>
                                <mml:mo>^</mml:mo>
                              </mml:mover>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
              <mml:mo stretchy="true">]</mml:mo>
            </mml:mrow>
            <mml:mo>±</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>z</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mo>α</mml:mo>
                <mml:mo>/</mml:mo>
                <mml:mn>2</mml:mn>
              </mml:mrow>
            </mml:msub>
            <mml:mrow>
              <mml:mo stretchy="true">[</mml:mo>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold">J</mml:mi>
                                    </mml:mrow>
                                    <mml:mi>g</mml:mi>
                                  </mml:msub>
                                  <mml:mi mathvariant="normal">I</mml:mi>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>θ</mml:mi>
                                                <mml:mo>^</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mtext>ML</mml:mtext>
                                          </mml:mrow>
                                        </mml:msub>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msup>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold">J</mml:mi>
                                    </mml:mrow>
                                    <mml:mi>g</mml:mi>
                                    <mml:mo>⊤</mml:mo>
                                  </mml:msubsup>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>11</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msqrt>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold">J</mml:mi>
                                    </mml:mrow>
                                    <mml:mi>g</mml:mi>
                                  </mml:msub>
                                  <mml:mi mathvariant="normal">I</mml:mi>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mrow>
                                              <mml:mover accent="true">
                                                <mml:mi>θ</mml:mi>
                                                <mml:mo>^</mml:mo>
                                              </mml:mover>
                                            </mml:mrow>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mtext>ML</mml:mtext>
                                          </mml:mrow>
                                        </mml:msub>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msup>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi mathvariant="bold">J</mml:mi>
                                    </mml:mrow>
                                    <mml:mi>g</mml:mi>
                                    <mml:mo>⊤</mml:mo>
                                  </mml:msubsup>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>22</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msqrt>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
              <mml:mo stretchy="true">]</mml:mo>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E10">
        <label>(9)</label>
        <mml:math id="M10" display="block" overflow="scroll">
          <mml:mrow>
            <mml:msub>
              <mml:mrow>
                <mml:mi mathvariant="bold">J</mml:mi>
              </mml:mrow>
              <mml:mi>g</mml:mi>
            </mml:msub>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mo stretchy="true">[</mml:mo>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>b</mml:mi>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mi>a</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>b</mml:mi>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mi>a</mml:mi>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
              <mml:mo stretchy="true">]</mml:mo>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
    <sec>
      <title>4.8 Evaluation of estimates</title>
      <p>After performing simulations and calculating the estimates, we considered several criteria to evaluate the performance of the inference at the genetic variant level. Assessment of global accuracy was conducted using the WD between the known ground truth and inferred distributions. WD was computed empirically by sampling 100  000 points from the inferred and ground-truth distributions. Parameter-level accuracy was assessed by measuring the percentage error <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mtext>PE</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>−</mml:mo><mml:mo>θ</mml:mo></mml:mrow><mml:mo>θ</mml:mo></mml:mfrac></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is any estimate of interest (e.g. mean fluorescence or shape parameter) and <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mo>θ</mml:mo></mml:math></inline-formula> the corresponding ground truth. Library-level performance was assessed by averaging the metrics over all genetic variants giving,
where, <italic toggle="yes">i</italic> is the index or the genetic variant and <italic toggle="yes">n</italic> is the size of the library. Coverage of the 95% confidence interval was assessed by computing the proportion of times the confidence interval contained the correct parameter for 500 replicates. This coverage rate was deemed acceptable when it was within two Standard Errors (SE) of the nominal coverage probability. With 500 replicates, SE <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>0.95</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>0.95</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>500</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mo>∼</mml:mo><mml:mn>1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> and hence an acceptable coverage has to be within <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>95</mml:mn><mml:mo>%</mml:mo><mml:mo>−</mml:mo><mml:mn>1.96</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>%</mml:mo><mml:mo>,</mml:mo><mml:mn>95</mml:mn><mml:mo>%</mml:mo><mml:mo>+</mml:mo><mml:mn>1.96</mml:mn><mml:mo>×</mml:mo><mml:mn>1</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>∼</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>93</mml:mn><mml:mo>%</mml:mo><mml:mo>,</mml:mo><mml:mn>97</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <disp-formula id="E11">
        <label>(10)</label>
        <mml:math id="M11" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtext>MWD</mml:mtext>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mn>1</mml:mn>
              <mml:mi>n</mml:mi>
            </mml:mfrac>
            <mml:munderover>
              <mml:mo>∑</mml:mo>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mi>n</mml:mi>
            </mml:munderover>
            <mml:mrow>
              <mml:mtext>WD</mml:mtext>
            </mml:mrow>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mi>θ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mo>θ</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="E12">
        <label>(11)</label>
        <mml:math id="M12" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mtext>MAPE</mml:mtext>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mn>1</mml:mn>
              <mml:mi>n</mml:mi>
            </mml:mfrac>
            <mml:munderover>
              <mml:mo>∑</mml:mo>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mi>n</mml:mi>
            </mml:munderover>
            <mml:mo>∣</mml:mo>
            <mml:mtext>PE</mml:mtext>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mi>θ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:msub>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mo>θ</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:msub>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>∣</mml:mo>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
    </sec>
    <sec>
      <title>4.9 Pipeline to characterize inference methods</title>
      <p>To characterize the statistical behaviour of both MOM and ML estimator in a simple setting, we performed one round of simulation + inference protocol with the following values for the experimental factors: Library of 1018 genetic variants with gamma fluorescence distributions, <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>7</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> sequencing reads, <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> cells sorted, <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> PCR amplification factor, 8 bins and maximum fluorescence (<inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>). Bias and variance of each estimator was measured by generating 499 additional synthetic Flow-seq datasets with identical experimental factors using a different random seed. We reported the sampling variation associated with the mob protein from the <xref rid="btad277-B48" ref-type="bibr">Taniguchi et al. (2010)</xref> dataset.</p>
    </sec>
    <sec>
      <title>4.10 Experimental factors</title>
      <p>We evaluated three key experimental factors for their impact on the accuracy of the statistical inference: the number of sorted cells <italic toggle="yes">N</italic> in the library, the number of reads <italic toggle="yes">R</italic> allocated during the sequencing step, and the number of bins <italic toggle="yes">B</italic> used to sort cells. Normalized versions of the number of reads and the number of sorted cells were obtained by taking their ratios with the diversity of the assay. These normalized values are indicated with tildes (<inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:mi>D</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>R</mml:mi><mml:mi>D</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula>) and remove the dependence of the assay diversity <italic toggle="yes">D</italic> on the conclusions.</p>
    </sec>
    <sec>
      <title>4.11 Factorial experiment</title>
      <p>To study both individual and interaction effects between experimental factors (<xref rid="btad277-F3" ref-type="fig">Fig. 3</xref>), we conducted a factorial experiment over a comprehensive range of experimental factors using a subset of 1000 variants from the <xref rid="btad277-B7" ref-type="bibr">Cambray et al. (2018)</xref> dataset to generate a known ground truth. The values we explored for the number of cells sorted and the number of sequencing reads were <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mrow><mml:mn>8</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>7</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. For cell sorting, we considered 6, 8, 10, 12, 14, 16, 18, 20, and 32 bins and estimated the fluorescence distribution using both Log-normal and Gamma modelling choice. Each combination of experimental factors was replicated 15 times with a different random seed to account for sampling variation, which amounted to 21  870 simulated Flow-seq experiments assessing <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mo>∼</mml:mo></mml:math></inline-formula>22 million genetic variants.</p>
      <p>After the inference step, it was necessary to develop a systematic procedure to inspect the reliability of estimates. Border effects, where fluorescence values were near zero or near the maximum of the final sorting bin, were detected by computing the percentage of reads located in the first and last sorting bin. Only variants with percentage ˂70% were retained. Situations where only a few reads were recovered were addressed by removing constructs with sequencing reads falling exclusively in one sorting bin. Model specification/numerical issues were identified and removed by dropping genetic variants that had non-invertible Hessians or when the confidence intervals were bigger than the corresponding estimates.</p>
      <p>We fitted two MLR models on a subset of the factorial experiment dataset to quantify the relative importance of each experimental factor to the accuracy of the estimates. The response variable was the MWD, using either the ML or MOM inference method. The predictor variables are the number of bins, the log-transformed number of reads per genetic variant and the log-transformed number of cells per genetic variant. The data used to fit the model were restricted to values where this relationship is approximately linear to satisfy the assumptions from linear regression. Each predictor variable was min–max normalized.</p>
    </sec>
    <sec>
      <title>4.12 Finding optimal points</title>
      <p>For systems exhibit diminishing returns, there is often a point referred as the optimal operating point, where the relative cost in resources deployed is no longer worth the corresponding benefit. Here, the objective is to reduce the mean WD by using larger numbers of either sorting bins, sequencing reads, or number of cells per genetic variant. The mean WD was calculated by averaging over all genetic variants in the library and statistical replicates. The optimal point for all three factors was then located by running the kneedle algorithm on every combination. For example, to locate the optimal number of bins, all combinations of sequencing reads, number of cell, and inference procedure (MOM and ML) were considered which amounted to <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mrow><mml:mn>9</mml:mn><mml:mo>×</mml:mo><mml:mn>9</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>162</mml:mn></mml:mrow></mml:math></inline-formula> operating points. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S8–S10</xref> illustrate how the kneedle algorithm was then used to locate the optimal operating point for each factor.</p>
    </sec>
    <sec>
      <title>4.13 Experimental-level accuracy of the Evfratov dataset</title>
      <p>The target output for each genetic variant in the Evfratov dataset (<xref rid="btad277-B13" ref-type="bibr">Evfratov et al. 2017</xref>) is the sorting bin with the most cells (i.e. the ‘mode bin’). We extracted the mode bin from data for each genetic variant by computing an estimate for the number of cells sorted in each bin using <xref rid="E5" ref-type="disp-formula">Equation (4)</xref> and selecting the sorting bin corresponding to the biggest number of cells sorted. However, these estimates for the mode bin are unstable due to sampling variation occurring at the sorting and sequencing step.</p>
      <p>To assess the accuracy of each target output from the Evfratov dataset, we used as proxy the frequency of correct mode bin measurement in a Flow-seq with similar experimental parameters. For example, the attributed accuracy for the mode bin of a genetic variant from the Evfratov dataset characterized with 8 bins, 20 sequencing reads, and 30 cells corresponds to the frequency of correct mode bin measurement of a Flow-seq experiment having on average 20 sequencing reads, 30 cells per genetic variant and using 8 sorting bins. We then averaged the accuracy of each target output to get the maximum achievable accuracy on each dataset split.</p>
      <p>The frequency of correct mode bin measurement was measured by first simulating a Flow-seq experiment, and then counting the number of times each genetic variant was attributed the true mode bin. We used the fluorescence parameters from the Taniguchi library (<xref rid="btad277-B48" ref-type="bibr">Taniguchi et al. 2010</xref>) and matched the experimental factors from the Evfratov experiment: cells were sorted into 8 bins with sequencing reads = 1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53, 55, 57, 59, 60, 65, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 195, 200, 205, 500, and 1000, and numbers of cells sorted = 1, 6, 11, 16, 21, 26, 31, 36, 41, 46, 51, 56, 72, 80, 100, 120, 140, 160, 180, 200, 500, and 1000. For each of the 22 <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 62 = 1364 combinations of sequencing reads and cells sorted we generated 50 Flow-seq replicates to account for sampling variation.</p>
    </sec>
    <sec>
      <title>4.14 Deep learning data</title>
      <p>Flow-seq sequencing data was extracted from a previous study (<xref rid="btad277-B13" ref-type="bibr">Evfratov et al. 2017</xref>), where the translational initiation rate of messenger RNAs across a library of constructs with different 5′UTRs was measured. Data were aggregated from experiments ‘20N’, ‘30N’, and ‘RML_eno’ and ultimately comprise 28  402 different RNA sequences. The sequencing mode bin (between 1 and 8) was determined for each RNA sequence and served as the target output. Number of cells per sequence was estimated using flow cytometer population events data for each experiment (private correspondence with the authors) and <xref rid="E5" ref-type="disp-formula">Equation (4)</xref>. A 80/10/10% split was used to create Train/Validation/Test sets. Sequences with the most sequencing reads (cutoff at 40) were prioritized for the test set creation to ensure high-quality data is used for model evaluation. The input RNA sequences were one-encoded into a matrix of size 4 <inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mo>×</mml:mo></mml:math></inline-formula> 30. Data augmentation was performed on the training and validation set by zero-padding 20 nt long sequences. The 20 nt long sequences from the test set were zero-padded on the right-hand side.</p>
    </sec>
    <sec>
      <title>4.15 Deep learning pipeline</title>
      <p>Different neural networks architectures were implemented using PyTorch version 1.12 (<xref rid="btad277-B32" ref-type="bibr">Paszke et al. 2019</xref>) and were systematically compared through a medium hyper-parameter optimization (1000 examples using the Optuna default protocol (<xref rid="btad277-B1" ref-type="bibr">Akiba et al. 2019</xref>), full details available in rebeca/hpo.py). The following architectures were considered: an MLP, a CNN with an MLP used as a feature extractor in the final step, a Long Short Term Memory RNN and finally a hybrid CNN+RNN. The best performing model was a hybrid CNN+RNN with the following architecture: 2 layers of 1D CNN+maxpooling (256 channels, CNN kernel of size 4, max pooling kernel of size 2), followed by one biLSTM layer (hidden size 200). The output of the BiLSTM layer was flattened and followed by 2 fully-connected feed-forward layers with 512 units before the last layer comprising 8 units to predict the sequencing mode bin. Code for implementing architectures and model checkpoints are available in rebeca/model/sequence_model.py and rebeca/checkpoints/convbilstm (Data Availability). A mini batch of 32 examples was used during training to minimize the cross-entropy loss using the Adam optimizer with a learning rate of <inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Early stopping was used to identify over-fitting for each model. Training was conducted using two NVIDIA RTX 6000 GPUs. Evaluation was carried out by computing accuracy, precision, recall, F1 score, and the confusion matrix. For each sequence subjected to data augmentation, we selected during testing the most frequent target output.</p>
    </sec>
    <sec>
      <title>4.16 Experimental-level accuracy of the Cambray dataset</title>
      <p>Data from <xref rid="btad277-B7" ref-type="bibr">Cambray et al. (2018)</xref> was processed to first remove bimodal outputs by keeping only the five adjacent bins with the maximum number of reads. Then, Log-normal distributions were fitted to each genetic variant using <inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> as the maximum fluorescence to estimate the mean <inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mo>μ</mml:mo></mml:math></inline-formula> and SD <inline-formula id="IE106"><mml:math id="IM106" display="inline" overflow="scroll"><mml:mo>σ</mml:mo></mml:math></inline-formula> parameters. Genetic variants with non-invertible Hessians were removed to allow computation of the median <inline-formula id="IE107"><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:mn>99.7</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> confidence interval for the mean log-fluorescence parameter <inline-formula id="IE108"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mo>μ</mml:mo></mml:math></inline-formula>. To predict <inline-formula id="IE109"><mml:math id="IM109" display="inline" overflow="scroll"><mml:mo>μ</mml:mo></mml:math></inline-formula>, for each genetic variant, a 129 nt sequence comprising of the 5′UTR (33 nt) and a variable coding region (96 nt) was used as input to a hybrid CNN+RNN model. A 80/10/10% split was used to create the training/validation/test datasets, stratified with respect to <inline-formula id="IE110"><mml:math id="IM110" display="inline" overflow="scroll"><mml:mo>μ</mml:mo></mml:math></inline-formula>. The model was trained to minimize mean-squared loss using the approach described earlier.</p>
    </sec>
    <sec>
      <title>4.17 General computational tools</title>
      <p>All analysis scripts and the FORECAST package were written in Python version 3.9, using the numpy version 1.19.15 for matrix algebra, scipy version 1.4.1 for statistical functions, numdifftools version 0.9.40 for computing finite differences, joblib version 1.1.0 for multiprocessing, and Pytorch version 1.12 for deep learning. Statistical inference speed comparisons between MOM and ML approaches were conducted on an Apple iMac computer with a 3 GHz 6-core Intel Core i5 processor and 16 GB of RAM.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad277_Supplementary_Data</label>
      <media xlink:href="btad277_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Author contributions</title>
    <p>Both authors conceived of the study and wrote the manuscript. P.-A.G. developed the methodology, carried out all computational experiments, and performed the analysis. T.E.G. supervised the work and secured funding.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>The authors declare no conflicts of interest.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the EPSRC/BBSRC Centre for Doctoral Training in Synthetic Biology grant [EP/L016494/1] (P.-A.G.), BrisEngBio, a UKRI-funded Engineering Biology Research Centre grant [BB/W013959/1] (T.E.G.), UKRI grant [BB/W012448/1] (T.E.G.), a Turing Fellowship from The Alan Turing Institute under EPSRC grant [EP/N510129/1] (T.E.G.), and a Royal Society University Research Fellowship grants [UF160357] and [URF\R\221008] (T.E.G.)</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available at the online repositories: <ext-link xlink:href="https://gitlab.com/Pierre-Aurelien/forecast" ext-link-type="uri">https://gitlab.com/Pierre-Aurelien/forecast</ext-link> and <ext-link xlink:href="https://gitlab.com/Pierre-Aurelien/rebeca" ext-link-type="uri">https://gitlab.com/Pierre-Aurelien/rebeca</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad277-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Akiba</surname><given-names>T</given-names></string-name>, <string-name><surname>Sano</surname><given-names>S</given-names></string-name>, <string-name><surname>Yanase</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal> Optuna: a next-generation hyperparameter optimization framework. In: <italic toggle="yes">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</italic>, KDD ’19, pp. <fpage>2623</fpage>–<lpage>31</lpage>. New York, NY: Association for Computing Machinery, <year>2019</year>. <pub-id pub-id-type="doi">10.1145/3292500.3330701</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Almogy</surname><given-names>G</given-names></string-name>, <string-name><surname>Pratt</surname><given-names>M</given-names></string-name>, <string-name><surname>Oberstrass</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal> Cost-efficient whole genome-sequencing using novel mostly natural sequencing-by-synthesis chemistry and open fluidics platform, bioRxiv June <year>2022</year>. <pub-id pub-id-type="doi">10.1101/2022.05.29.493900</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Angenent-Mari</surname><given-names>NM</given-names></string-name>, <string-name><surname>Garruss</surname><given-names>AS</given-names></string-name>, <string-name><surname>Soenksen</surname><given-names>LR</given-names></string-name></person-group><etal>et al</etal><article-title>A deep learning approach to programmable RNA switches</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>5057</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-020-18677-1</pub-id>.<pub-id pub-id-type="pmid">33028812</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beal</surname><given-names>J</given-names></string-name>, <string-name><surname>Teague</surname><given-names>B</given-names></string-name>, <string-name><surname>Sexton</surname><given-names>JT</given-names></string-name></person-group><etal>et al</etal>; <collab>Calibrated Flow Cytometry Study Consortium</collab>. <article-title>Meeting measurement precision requirements for effective engineering of genetic regulatory networks</article-title>. <source>ACS Synth Biol</source><year>2022</year>;<volume>11</volume>:<fpage>1196</fpage>–<lpage>207</lpage>. <pub-id pub-id-type="doi">10.1021/acssynbio.1c00488</pub-id>.<pub-id pub-id-type="pmid">35156365</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Belliveau</surname><given-names>NM</given-names></string-name>, <string-name><surname>Barnes</surname><given-names>SL</given-names></string-name>, <string-name><surname>Ireland</surname><given-names>WT</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic approach for dissecting the molecular mechanisms of transcriptional regulation in bacteria</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2018</year>;<volume>115</volume>:<fpage>E4796–805</fpage>. <pub-id pub-id-type="doi">10.1073/pnas.1722055115</pub-id>.<pub-id pub-id-type="pmid">29728462</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonde</surname><given-names>MT</given-names></string-name>, <string-name><surname>Pedersen</surname><given-names>M</given-names></string-name>, <string-name><surname>Klausen</surname><given-names>MS</given-names></string-name></person-group><etal>et al</etal><article-title>Predictable tuning of protein expression in bacteria</article-title>. <source>Nat Methods</source><year>2016</year>;<volume>13</volume>:<fpage>233</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3727</pub-id>.<pub-id pub-id-type="pmid">26752768</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cambray</surname><given-names>G</given-names></string-name>, <string-name><surname>Guimaraes</surname><given-names>JC</given-names></string-name>, <string-name><surname>Arkin</surname><given-names>AP.</given-names></string-name></person-group><article-title>Evaluation of 244,000 synthetic sequences reveals design principles to optimize translation in <italic toggle="yes">Escherichia coli</italic></article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>:<fpage>1005</fpage>–<lpage>15</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.4238</pub-id>.<pub-id pub-id-type="pmid">30247489</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Castle</surname><given-names>SD</given-names></string-name>, <string-name><surname>Grierson</surname><given-names>CS</given-names></string-name>, <string-name><surname>Gorochowski</surname><given-names>TE.</given-names></string-name></person-group><article-title>Towards an engineering theory of evolution</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>:<fpage>3326</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-021-23573-3</pub-id>.<pub-id pub-id-type="pmid">34099656</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaloner</surname><given-names>K</given-names></string-name>, <string-name><surname>Verdinelli</surname><given-names>I.</given-names></string-name></person-group><article-title>Bayesian experimental design: a review</article-title>. <source>Statist Sci</source><year>1995</year>;<volume>10</volume>:<fpage>273</fpage>–<lpage>304</lpage>. <pub-id pub-id-type="doi">10.1214/ss/1177009939</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cuperus</surname><given-names>JT</given-names></string-name>, <string-name><surname>Groves</surname><given-names>B</given-names></string-name>, <string-name><surname>Kuchina</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Deep learning of the regulatory grammar of yeast 5′ untranslated regions from 500,000 random sequences</article-title>. <source>Genome Res</source><year>2017</year>;<volume>27</volume>:<fpage>2015</fpage>–<lpage>24</lpage>. <pub-id pub-id-type="doi">10.1101/gr.224964.117</pub-id>.<pub-id pub-id-type="pmid">29097404</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Boer</surname><given-names>CG</given-names></string-name>, <string-name><surname>Vaishnav</surname><given-names>ED</given-names></string-name>, <string-name><surname>Sadeh</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Deciphering eukaryotic gene-regulatory logic with 100 million random promoters</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>:<fpage>56</fpage>–<lpage>65</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-019-0315-8</pub-id>.<pub-id pub-id-type="pmid">31792407</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dvir</surname><given-names>S</given-names></string-name>, <string-name><surname>Velten</surname><given-names>L</given-names></string-name>, <string-name><surname>Sharon</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Deciphering the rules by which 5′-UTR sequences affect protein expression in yeast</article-title>. <source>Proc Natl Acad Sci USA</source><year>2013</year>;<volume>110</volume>:<fpage>E2792</fpage>–<lpage>801</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1222534110</pub-id>.<pub-id pub-id-type="pmid">23832786</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Evfratov</surname><given-names>SA</given-names></string-name>, <string-name><surname>Osterman</surname><given-names>IA</given-names></string-name>, <string-name><surname>Komarova</surname><given-names>ES</given-names></string-name></person-group><etal>et al</etal><article-title>Application of sorting and next generation sequencing to study 5′-UTR influence on translation efficiency in Escherichia coli</article-title>. <source>Nucleic Acids Res</source><year>2017</year>;<volume>45</volume>:<fpage>3487</fpage>–<lpage>502</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw1141</pub-id>.<pub-id pub-id-type="pmid">27899632</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fajardo-Fontiveros</surname><given-names>O</given-names></string-name>, <string-name><surname>Reichardt</surname><given-names>I</given-names></string-name>, <string-name><surname>Rios</surname><given-names>HRDL</given-names></string-name></person-group><etal>et al</etal><article-title>Fundamental limits to learning closed-form mathematical models from data</article-title>. <source>arXiv</source>, <year>2022</year>. <pub-id pub-id-type="doi">10.48550/arXiv.2204.02704</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Friedman</surname><given-names>N</given-names></string-name>, <string-name><surname>Cai</surname><given-names>L</given-names></string-name>, <string-name><surname>Xie</surname><given-names>XS.</given-names></string-name></person-group><article-title>Linking stochastic dynamics to population distribution: an analytical framework of gene expression</article-title>. <source>Phys Rev Lett</source><year>2006</year>;<volume>97</volume>:<fpage>168302</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevLett.97.168302</pub-id>.<pub-id pub-id-type="pmid">17155441</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gilliot</surname><given-names>P-A</given-names></string-name>, <string-name><surname>Gorochowski</surname><given-names>TE.</given-names></string-name></person-group><article-title>Sequencing enabling design and learning in synthetic biology</article-title>. <source>Curr Opin Chem Biol</source><year>2020</year>;<volume>58</volume>:<fpage>54</fpage>–<lpage>62</lpage>. <pub-id pub-id-type="doi">10.1016/j.cbpa.2020.06.002</pub-id>.<pub-id pub-id-type="pmid">32771905</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gorochowski</surname><given-names>TE</given-names></string-name>, <string-name><surname>Ellis</surname><given-names>T.</given-names></string-name></person-group><article-title>Designing efficient translation</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>:<fpage>934</fpage>–<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.4257</pub-id>.<pub-id pub-id-type="pmid">30307923</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>H</given-names></string-name>, <string-name><surname>Wong</surname><given-names>WH.</given-names></string-name></person-group><article-title>Statistical inferences for isoform expression in RNA-Seq</article-title>. <source>Bioinformatics</source><year>2009</year>;<volume>25</volume>:<fpage>1026</fpage>–<lpage>32</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp113</pub-id>.<pub-id pub-id-type="pmid">19244387</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khoshdel</surname><given-names>V</given-names></string-name>, <string-name><surname>Akbarzadeh</surname><given-names>AR.</given-names></string-name></person-group><article-title>Application of statistical techniques and artificial neural network to estimate force from sEMG signals</article-title>. <source>J AI Data Mining</source><year>2016</year>;<volume>4</volume>:<fpage>135</fpage>–<lpage>41</lpage>. <pub-id pub-id-type="doi">10.5829/idosi.JAIDM.2016.04.02.02</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kinney</surname><given-names>JB</given-names></string-name>, <string-name><surname>Murugan</surname><given-names>A</given-names></string-name>, <string-name><surname>Callan</surname><given-names>CG</given-names></string-name></person-group><etal>et al</etal><article-title>Using deep sequencing to characterize the biophysical mechanism of a transcriptional regulatory sequence</article-title>. <source>Proc Natl Acad Sci USA</source><year>2010</year>;<volume>107</volume>:<fpage>9158</fpage>–<lpage>63</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1004290107</pub-id>.<pub-id pub-id-type="pmid">20439748</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Komarova</surname><given-names>ES</given-names></string-name>, <string-name><surname>Chervontseva</surname><given-names>ZS</given-names></string-name>, <string-name><surname>Osterman</surname><given-names>IA</given-names></string-name></person-group><etal>et al</etal><article-title>Influence of the spacer region between the Shine–Dalgarno box and the start codon for fine-tuning of the translation efficiency in <italic toggle="yes">Escherichia coli</italic></article-title>. <source>Microb Biotechnol</source><year>2020</year>;<volume>13</volume>:<fpage>1254</fpage>–<lpage>61</lpage>. <pub-id pub-id-type="doi">10.1111/1751-7915.13561</pub-id>.<pub-id pub-id-type="pmid">32202698</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kosuri</surname><given-names>S</given-names></string-name>, <string-name><surname>Church</surname><given-names>GM.</given-names></string-name></person-group><article-title>Large-scale de novo DNA synthesis: technologies and applications</article-title>. <source>Nat Methods</source><year>2014</year>;<volume>11</volume>:<fpage>499</fpage>–<lpage>507</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2918</pub-id>.<pub-id pub-id-type="pmid">24781323</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kosuri</surname><given-names>S</given-names></string-name>, <string-name><surname>Goodman</surname><given-names>DB</given-names></string-name>, <string-name><surname>Cambray</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Composability of regulatory sequences controlling transcription and translation in <italic toggle="yes">Escherichia coli</italic></article-title>. <source>Proc Natl Acad Sci USA</source><year>2013</year>;<volume>110</volume>:<fpage>14024</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1301301110</pub-id>.<pub-id pub-id-type="pmid">23924614</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kotopka</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Smolke</surname><given-names>CD.</given-names></string-name></person-group><article-title>Model-driven generation of artificial yeast promoters</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>2113</fpage>–<lpage>041</lpage>. <pub-id pub-id-type="doi">10.1038/s41467-020-15977-4</pub-id>.<pub-id pub-id-type="pmid">32355169</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuo</surname><given-names>ST</given-names></string-name>, <string-name><surname>Jahn</surname><given-names>RL</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>YJ</given-names></string-name></person-group><etal>et al</etal><article-title>Global fitness landscapes of the Shine-Dalgarno sequence</article-title>. <source>Genome Res</source><year>2020</year>;<volume>30</volume>:<fpage>711</fpage>–<lpage>23</lpage>. <pub-id pub-id-type="doi">10.1101/gr.260182.119</pub-id>.<pub-id pub-id-type="pmid">32424071</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>LaFleur</surname><given-names>TL</given-names></string-name>, <string-name><surname>Hossain</surname><given-names>A</given-names></string-name>, <string-name><surname>Salis</surname><given-names>HM.</given-names></string-name></person-group><article-title>Automated model-predictive design of synthetic promoters to control transcriptional profiles in bacteria</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>5159</fpage>–<lpage>2041</lpage>. <pub-id pub-id-type="doi">10.1038/s41467-022-32829-5</pub-id>.<pub-id pub-id-type="pmid">36056029</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lujan-Moreno</surname><given-names>GA</given-names></string-name>, <string-name><surname>Howard</surname><given-names>PR</given-names></string-name>, <string-name><surname>Rojas</surname><given-names>OG</given-names></string-name></person-group><etal>et al</etal><article-title>Design of experiments and response surface methodology to tune machine learning hyperparameters, with a random Forest case-study</article-title>. <source>Expert Syst Appl</source><year>2018</year>;<volume>109</volume>:<fpage>195</fpage>–<lpage>205</lpage>. <pub-id pub-id-type="doi">10.1016/j.eswa.2018.05.024</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marioni</surname><given-names>JC</given-names></string-name>, <string-name><surname>Mason</surname><given-names>CE</given-names></string-name>, <string-name><surname>Mane</surname><given-names>SM</given-names></string-name></person-group><etal>et al</etal><article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>. <source>Genome Res</source><year>2008</year>;<volume>18</volume>:<fpage>1509</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.1101/gr.079558.108</pub-id>.<pub-id pub-id-type="pmid">18550803</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Melnikov</surname><given-names>A</given-names></string-name>, <string-name><surname>Murugan</surname><given-names>A</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic dissection and optimization of inducible enhancers in human cells using a massively parallel reporter assay</article-title>. <source>Nat Biotechnol</source><year>2012</year>;<volume>30</volume>:<fpage>271</fpage>–<lpage>7</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2137</pub-id>.<pub-id pub-id-type="pmid">22371084</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mutalik</surname><given-names>VK</given-names></string-name>, <string-name><surname>Guimaraes</surname><given-names>JC</given-names></string-name>, <string-name><surname>Cambray</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Precise and reliable gene expression via standard transcription and translation initiation elements</article-title>. <source>Nat Methods</source><year>2013</year>;<volume>10</volume>:<fpage>354</fpage>–<lpage>60</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2404</pub-id>.<pub-id pub-id-type="pmid">23474465</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Osterman</surname><given-names>IA</given-names></string-name>, <string-name><surname>Chervontseva</surname><given-names>ZS</given-names></string-name>, <string-name><surname>Evfratov</surname><given-names>SA</given-names></string-name></person-group><etal>et al</etal><article-title>Translation at first sight: the influence of leading codons</article-title>. <source>Nucleic Acids Res</source><year>2020</year>;<volume>48</volume>:<fpage>6931</fpage>–<lpage>42</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkaa430</pub-id>.<pub-id pub-id-type="pmid">32427319</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B32">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Paszke</surname><given-names>A</given-names></string-name>, <string-name><surname>Gross</surname><given-names>S</given-names></string-name>, <string-name><surname>Massa</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><source>PyTorch: An Imperative Style</source>, <publisher-name>High-Performance Deep Learning Library</publisher-name>, In: <italic toggle="yes">Proceedings of the 33rd International Conference on Neural Information Processing Systems.</italic> Red Hook, NY, USA: Curran Associates Inc. <year>2019</year>. <pub-id pub-id-type="doi">10.48550/arXiv.1912.01703</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pauwels</surname><given-names>E</given-names></string-name>, <string-name><surname>Lajaunie</surname><given-names>C</given-names></string-name>, <string-name><surname>Vert</surname><given-names>JP.</given-names></string-name></person-group><article-title>A bayesian active learning strategy for sequential experimental design in systems biology</article-title>. <source>BMC Syst Biol</source><year>2014</year>;<volume>8</volume>:<fpage>102</fpage>. <pub-id pub-id-type="doi">10.1186/s12918-014-0102-6</pub-id>.<pub-id pub-id-type="pmid">25256134</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B34">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Pawitan</surname><given-names>Y.</given-names></string-name></person-group><source>In all Likelihood: Statistical Modelling and Inference Using Likelihood</source>. <publisher-loc>Oxford</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>, <year>2013</year>.</mixed-citation>
    </ref>
    <ref id="btad277-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peterman</surname><given-names>N</given-names></string-name>, <string-name><surname>Levine</surname><given-names>E.</given-names></string-name></person-group><article-title>Sort-seq under the hood: implications of design choices on large-scale characterization of sequence–function relations</article-title>. <source>BMC Genomics</source><year>2016</year>;<volume>17</volume>:<fpage>206</fpage>–<lpage>1471</lpage>. <pub-id pub-id-type="doi">10.1186/s12864-016-2533-5</pub-id>.<pub-id pub-id-type="pmid">26956374</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peterman</surname><given-names>N</given-names></string-name>, <string-name><surname>Lavi-Itzkovitz</surname><given-names>A</given-names></string-name>, <string-name><surname>Levine</surname><given-names>E.</given-names></string-name></person-group><article-title>Large-scale mapping of sequence-function relations in small regulatory RNAs reveals plasticity and modularity</article-title>. <source>Nucleic Acids Res</source><year>2014</year>;<volume>42</volume>:<fpage>12177</fpage>–<lpage>88</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gku863</pub-id>.<pub-id pub-id-type="pmid">25262352</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quang</surname><given-names>D</given-names></string-name>, <string-name><surname>Xie</surname><given-names>X.</given-names></string-name></person-group><article-title>DanQ: a hybrid convolutional and recurrent deep neural network for quantifying the function of DNA sequences</article-title>. <source>Nucleic Acids Res</source><year>2016</year>;<volume>44</volume>:<fpage>e107</fpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw226</pub-id>.<pub-id pub-id-type="pmid">27084946</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B38">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Robert</surname><given-names>CP.</given-names></string-name></person-group><source>The Bayesian Choice: From Decision-Theoretic Foundations to Computational Implementation</source>. <edition>2nd ed.</edition> Springer Texts in Statistics. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer</publisher-name>, <year>2007</year>. ISBN 978-0-387-71598-8</mixed-citation>
    </ref>
    <ref id="btad277-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salis</surname><given-names>HM</given-names></string-name>, <string-name><surname>Mirsky</surname><given-names>EA</given-names></string-name>, <string-name><surname>Voigt</surname><given-names>CA.</given-names></string-name></person-group><article-title>Automated design of synthetic ribosome binding sites to control protein expression</article-title>. <source>Nat Biotechnol</source><year>2009</year>;<volume>27</volume>:<fpage>946</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.1568</pub-id>.<pub-id pub-id-type="pmid">19801975</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sample</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Wang</surname><given-names>B</given-names></string-name>, <string-name><surname>Reid</surname><given-names>DW</given-names></string-name></person-group><etal>et al</etal><article-title>Human 5<inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> UTR design and variant effect prediction from a massively parallel translation assay</article-title>. <source>Nat Biotechnol</source><year>2019</year>;<volume>37</volume>:<fpage>803</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1038/s41587-019-0164-5</pub-id>.<pub-id pub-id-type="pmid">31267113</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sarkisyan</surname><given-names>KS</given-names></string-name>, <string-name><surname>Bolotin</surname><given-names>DA</given-names></string-name>, <string-name><surname>Meer</surname><given-names>MV</given-names></string-name></person-group><etal>et al</etal><article-title>Local fitness landscape of the green fluorescent protein</article-title>. <source>Nature</source><year>2016</year>;<volume>533</volume>:<fpage>397</fpage>–<lpage>401</lpage>. <pub-id pub-id-type="doi">10.1038/nature17995</pub-id>.<pub-id pub-id-type="pmid">27193686</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B42">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Satopaa</surname><given-names>V</given-names></string-name>, <string-name><surname>Albrecht</surname><given-names>J</given-names></string-name>, <string-name><surname>Irwin</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal> Finding a “kneedle” in a haystack: detecting knee points in system behavior. In: <italic toggle="yes">2011 31st International Conference on Distributed Computing Systems Workshops</italic>, pp. <fpage>166</fpage>–<lpage>171</lpage>, Minneapolis, MN: IEEE, <year>2011</year>. ISBN 978-1-4577-0384-3. <pub-id pub-id-type="doi">10.1109/ICDCSW.2011.20</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schmitz</surname><given-names>A</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>F.</given-names></string-name></person-group><article-title>Massively parallel gene expression variation measurement of a synonymous codon library</article-title>. <source>BMC Genom</source><year>2021</year>;<volume>22</volume>:<fpage>149</fpage>. <pub-id pub-id-type="doi">10.1186/s12864-021-07462-z</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seo</surname><given-names>SW</given-names></string-name>, <string-name><surname>Yang</surname><given-names>JS</given-names></string-name>, <string-name><surname>Cho</surname><given-names>HS</given-names></string-name></person-group><etal>et al</etal><article-title>Predictive combinatorial design of mRNA translation initiation regions for systematic optimization of gene expression levels</article-title>. <source>Sci Rep</source><year>2014</year>;<volume>4</volume>:<fpage>4515</fpage>. <pub-id pub-id-type="doi">10.1038/srep04515</pub-id>.<pub-id pub-id-type="pmid">24682040</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shahmohammadi</surname><given-names>A</given-names></string-name>, <string-name><surname>McAuley</surname><given-names>KB.</given-names></string-name></person-group><article-title>Sequential model-based a-optimal design of experiments when the fisher information matrix is noninvertible</article-title>. <source>Ind Eng Chem Res</source><year>2019</year>;<volume>58</volume>:<fpage>1244</fpage>–<lpage>61</lpage>. <pub-id pub-id-type="doi">10.1021/acs.iecr.8b03047</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sharon</surname><given-names>E</given-names></string-name>, <string-name><surname>Kalma</surname><given-names>Y</given-names></string-name>, <string-name><surname>Sharp</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Inferring gene regulatory logic from high-throughput measurements of thousands of systematically designed promoters</article-title>. <source>Nat Biotechnol</source><year>2012</year>;<volume>30</volume>:<fpage>521</fpage>–<lpage>30</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2205</pub-id>.<pub-id pub-id-type="pmid">22609971</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tack</surname><given-names>DS</given-names></string-name>, <string-name><surname>Tonner</surname><given-names>PD</given-names></string-name>, <string-name><surname>Pressman</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>The genotype-phenotype landscape of an allosteric protein</article-title>. <source>Mol Syst Biol</source><year>2021</year>;<volume>17</volume>:<fpage>e10179</fpage>. <pub-id pub-id-type="doi">10.15252/msb.202010179</pub-id>.<pub-id pub-id-type="pmid">33784029</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taniguchi</surname><given-names>Y</given-names></string-name>, <string-name><surname>Choi</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Li</surname><given-names>GW</given-names></string-name></person-group><etal>et al</etal><article-title>Quantifying <italic toggle="yes">E. coli</italic> proteome and transcriptome with Single-Molecule sensitivity in single cells</article-title>. <source>Science</source><year>2010</year>;<volume>329</volume>:<fpage>533</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1126/science.1188308</pub-id>.<pub-id pub-id-type="pmid">20671182</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarnowski</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Gorochowski</surname><given-names>TE.</given-names></string-name></person-group><article-title>Massively parallel characterization of engineered transcript isoforms using direct RNA sequencing</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>434</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-022-28074-5</pub-id>.<pub-id pub-id-type="pmid">35064117</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Townshend</surname><given-names>B</given-names></string-name>, <string-name><surname>Kennedy</surname><given-names>AB</given-names></string-name>, <string-name><surname>Xiang</surname><given-names>JS</given-names></string-name></person-group><etal>et al</etal><article-title>High-throughput cellular RNA device engineering</article-title>. <source>Nat Methods</source><year>2015</year>;<volume>12</volume>:<fpage>989</fpage>–<lpage>94</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3486</pub-id>.<pub-id pub-id-type="pmid">26258292</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Treloar</surname><given-names>NJ</given-names></string-name>, <string-name><surname>Braniff</surname><given-names>N</given-names></string-name>, <string-name><surname>Ingalls</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Deep reinforcement learning for optimal experimental design in biology</article-title>. <source>PLoS Comput Biol</source><year>2022</year>;<volume>18</volume>:<fpage>e1010695</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1010695</pub-id>.<pub-id pub-id-type="pmid">36409776</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trippe</surname><given-names>BL</given-names></string-name>, <string-name><surname>Huang</surname><given-names>B</given-names></string-name>, <string-name><surname>DeBenedictis</surname><given-names>EA</given-names></string-name></person-group><etal>et al</etal><article-title>Randomized gates eliminate bias in sort-seq assays</article-title>. <source>Protein Sci</source><year>2022</year>;<volume>31</volume>:<fpage>e4401</fpage>. <pub-id pub-id-type="doi">10.1002/pro.4401</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Urtecho</surname><given-names>G</given-names></string-name>, <string-name><surname>Tripp</surname><given-names>AD</given-names></string-name>, <string-name><surname>Insigne</surname><given-names>KD</given-names></string-name></person-group><etal>et al</etal><article-title>Systematic dissection of sequence elements controlling <inline-formula id="IE112"><mml:math id="IM112" display="inline" overflow="scroll"><mml:mo>Σ</mml:mo></mml:math></inline-formula>70 promoters using a genomically encoded multiplexed reporter assay in Escherichia coli</article-title>. <source>Biochemistry</source><year>2019</year>;<volume>58</volume>:<fpage>1539</fpage>–<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1021/acs.biochem.7b01069</pub-id>.<pub-id pub-id-type="pmid">29388765</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vaishnav</surname><given-names>ED</given-names></string-name>, <string-name><surname>de Boer</surname><given-names>CG</given-names></string-name>, <string-name><surname>Molinet</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>The evolution, evolvability and engineering of gene regulatory DNA</article-title>. <source>Nature</source><year>2022</year>;<volume>603</volume>:<fpage>455</fpage>–<lpage>63</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-022-04506-6</pub-id>.<pub-id pub-id-type="pmid">35264797</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Feng</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>DEGseq: an R package for identifying differentially expressed genes from RNA-seq data</article-title>. <source>Bioinformatics</source><year>2010</year>;<volume>26</volume>:<fpage>136</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp612</pub-id>.<pub-id pub-id-type="pmid">19855105</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B56">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Xiong</surname><given-names>B</given-names></string-name>, <string-name><surname>Huang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Ye</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal> MOFA: modular factorial design for hyperparameter optimization, <italic toggle="yes">arXiv</italic>, <year>2021</year>. <pub-id pub-id-type="doi">10.48550/arXiv.2011.09545</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B57">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Yao</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Deep neural network hyperparameter optimization with orthogonal array tuning</article-title>, <italic toggle="yes">arXiv</italic>, <year>2020</year>. <pub-id pub-id-type="doi">10.48550/arXiv.1907.13359</pub-id>.</mixed-citation>
    </ref>
    <ref id="btad277-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zou</surname><given-names>J</given-names></string-name>, <string-name><surname>Huss</surname><given-names>M</given-names></string-name>, <string-name><surname>Abid</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>A primer on deep learning in genomics</article-title>. <source>Nat Genet</source><year>2019</year>;<volume>51</volume>:<fpage>12</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1038/s41588-018-0295-5</pub-id>.<pub-id pub-id-type="pmid">30478442</pub-id></mixed-citation>
    </ref>
    <ref id="btad277-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zrimec</surname><given-names>J</given-names></string-name>, <string-name><surname>Buric</surname><given-names>F</given-names></string-name>, <string-name><surname>Kokina</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Learning the regulatory code of gene expression</article-title>. <source>Front Mol Biosci</source><year>2021</year>;<volume>8</volume>:<fpage>673363</fpage>.<pub-id pub-id-type="pmid">34179082</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
