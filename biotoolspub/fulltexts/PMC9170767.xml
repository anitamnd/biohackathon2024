<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_GPB516 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEmmc1 docx ?>
<?FILEmmc2 pdf ?>
<?FILEmmc3 pdf ?>
<?FILEmmc4 docx ?>
<?FILEmmc5 docx ?>
<?FILEsi1 svg ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genomics Proteomics Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genomics Proteomics Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Genomics, Proteomics &amp; Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1672-0229</issn>
    <issn pub-type="epub">2210-3244</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9170767</article-id>
    <article-id pub-id-type="pii">S1672-0229(21)00061-9</article-id>
    <article-id pub-id-type="doi">10.1016/j.gpb.2021.03.003</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FunHoP: Enhanced Visualization and Analysis of Functionally Homologous Proteins in Complex Metabolic Networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au005">
        <name>
          <surname>Rise</surname>
          <given-names>Kjersti</given-names>
        </name>
        <email>kjersti.rise@ntnu.no</email>
        <xref rid="af005" ref-type="aff">1</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <contrib contrib-type="author" id="au010">
        <name>
          <surname>Tessem</surname>
          <given-names>May-Britt</given-names>
        </name>
        <xref rid="af010" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author" id="au015">
        <name>
          <surname>Drabløs</surname>
          <given-names>Finn</given-names>
        </name>
        <xref rid="af005" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au020">
        <name>
          <surname>Rye</surname>
          <given-names>Morten B.</given-names>
        </name>
        <email>morten.rye@ntnu.no</email>
        <xref rid="af005" ref-type="aff">1</xref>
        <xref rid="af015" ref-type="aff">3</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <aff id="af005"><label>1</label>Department of Clinical and Molecular Medicine, NTNU – Norwegian University of Science and Technology, Trondheim NO-7491, Norway</aff>
      <aff id="af010"><label>2</label>Department of Circulation and Medical Imaging, NTNU – Norwegian University of Science and Technology, Trondheim NO-7491, Norway</aff>
      <aff id="af015"><label>3</label>Clinic of Surgery, St. Olavs Hospital, Trondheim University Hospital, Trondheim NO-7491, Norway</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding authors. <email>kjersti.rise@ntnu.no</email><email>morten.rye@ntnu.no</email></corresp>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="ppub">
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <volume>19</volume>
    <issue>5</issue>
    <fpage>848</fpage>
    <lpage>859</lpage>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>8</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>8</day>
        <month>5</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 The Authors</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="ab005">
      <p><bold>Cytoscape</bold> is often used for visualization and analysis of metabolic pathways. For example, based on <bold>KEGG</bold> data, a reader for KEGG Markup Language (KGML) is used to load files into Cytoscape. However, although multiple genes can be responsible for the same reaction, the KGML-reader KEGGScape only presents the first listed gene in a network node for a given reaction. This can lead to incorrect interpretations of the pathways. Our new method, FunHoP, shows all possible genes in each node, making the pathways more complete. FunHoP collapses all genes in a node into one measurement using read counts from <bold>RNA-seq</bold>. Assuming that activity for an enzymatic reaction mainly depends upon the gene with the highest number of reads, and weighting the reads on gene length and ratio, a new expression value is calculated for the node as a whole. Differential expression at node level is then applied to the networks. Using prostate cancer as model, we integrate RNA-seq data from two patient cohorts with metabolism data from literature. Here we show that FunHoP gives more consistent pathways that are easier to interpret biologically. Code and documentation for running FunHoP can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/kjerstirise/FunHoP" id="ir005">https://github.com/kjerstirise/FunHoP</ext-link>.</p>
    </abstract>
    <kwd-group id="kg005">
      <title>Keywords</title>
      <kwd>Homologous proteins</kwd>
      <kwd>Metabolic network</kwd>
      <kwd>Pathway visualization and analysis</kwd>
      <kwd>RNA-seq</kwd>
      <kwd>KEGG</kwd>
      <kwd>Cytoscape</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="ms005">Handled by Henning Hermjakob</p>
  </notes>
</front>
<body>
  <sec id="s0005">
    <title>Introduction</title>
    <p id="p0005">Metabolic pathway analysis is a common framework for interpreting large-scale omics data and revealing functional trends and patterns in known biological multi-gene pathways. Important curated resources of metabolic pathways are the Kyoto Encyclopedia of Genes and Genomes (KEGG) <xref rid="b0005" ref-type="bibr">[1]</xref>, <xref rid="b0010" ref-type="bibr">[2]</xref>, Reactome <xref rid="b0015" ref-type="bibr">[3]</xref>, Panther <xref rid="b0020" ref-type="bibr">[4]</xref>, and similar knowledge bases <xref rid="b0025" ref-type="bibr">[5]</xref>. Such resources are increasingly integrated with other knowledge bases, as can be seen for example for KEGG <xref rid="b0030" ref-type="bibr">[6]</xref>. Several approaches can be used for analyzing metabolic pathways in the context of general network representations <xref rid="b0035" ref-type="bibr">[7]</xref>, and recent tools like eXamine <xref rid="b0040" ref-type="bibr">[8]</xref> and Orthoscape <xref rid="b0045" ref-type="bibr">[9]</xref> are relevant examples. For transcriptomics, an often-used approach is to map differentially expressed genes (DEGs) to known biological pathways, for example from KEGG. Such pathway representations can then be analyzed and visualized with commercial tools like Pathway Studio (www.pathwaystudio.com/) or iPathwayGuide (www.advaitabio.com/ipathwayguide.html), or free tools like CellDesigner <xref rid="b0050" ref-type="bibr">[10]</xref> or Cytoscape <xref rid="b0055" ref-type="bibr">[11]</xref>.</p>
    <p id="p0010">In these tools, metabolic pathways are generally displayed as a network of metabolic transitions, where each transition is associated with a node representing the enzyme responsible for the transition. Each node typically represents a separate child from a structured pathway file, such as XML format. However, a challenge occurs when a transition from one metabolite to another can be catalyzed by more than one possible enzyme, <italic>i.e</italic>., by functionally homologous protein families, or functional homologs <xref rid="b0060" ref-type="bibr">[12]</xref>. This is best illustrated by a typical example from KEGG. In the histidine metabolic pathway (KEGG: hsa00340), the four paralogs of NAD(P)<sup>+</sup> dependent aldehyde dehydrogenase (<italic>ALDH3A1</italic>, <italic>ALDH1A3</italic>, <italic>ALDH3B1</italic>, and <italic>ALDH3B2</italic>, KEGG node index 1.2.1.5, <xref rid="f0005" ref-type="fig">Figure 1</xref>A) can all catalyze the transition from methylimidazole acetaldehyde to methylimidazole acetate. However, KEGG displays only the first gene, <italic>ALDH3A1</italic>, both in the website and in the XML file. In the website, the user can hover the mouse pointer over the gene in question to see any functional homologs, and the XML file does contain the KEGG IDs to all of them, although the corresponding gene names are not available in the file. In most conditions and cell types, one of these paralogs might be the preferred for the enzymatic transition, but in certain conditions one or several of the other three paralogs may become important, which should be taken into account. Though the selected example contains only four paralogs, the number of alternative enzymes can exceed 30 for some transitions, which complicates both visualization and interpretation of such nodes in the current framework. An example of a large node is the <italic>PLA2G4B</italic> node with 21 genes shown <xref rid="f0005" ref-type="fig">Figure 1</xref>B. In particular, the conclusion as to whether a node is overall up- or down-regulated will depend on the degree of differential expression of each gene (fold change and/or <italic>P</italic> value), the relative expression level of each gene in the node, and the enzymatic efficacy of the protein. The challenges regarding nodes with multiple genes are thus twofold. First, there is a need for data that can help us identify the most important enzyme(s) in conditions where multiple genes are able to perform the same reaction. Second, there is a need for improved visualization strategies to convey the relative importance of different enzymes with overlapping function when viewing biological networks from databases such as KEGG.<fig id="f0005"><label>Figure 1</label><caption><p><bold>Comparison of pathway XML files in Cytoscape to the same pathways in KEGG</bold></p><p><bold>A.</bold> A schematic of histidine metabolism pathway. All nodes in the original Cytoscape display show one single gene, including the <italic>ALDH3A1</italic> node. The <italic>ALDH3A1</italic> node from KEGG actually contains four genes: <italic>ALDH3A1, ALDH1A3, ALDH3B1</italic>, and <italic>ALDH3B2</italic>. <bold>B.</bold> A schematic of glycerophosphocholine metabolism pathway (part). The <italic>PLA2G4B</italic> node contains 21 genes, despite only showing one in KEGG.</p></caption><graphic xlink:href="gr1"/></fig></p>
    <p id="p0015">Cytoscape is a common tool for pathway visualization and analysis, often with data from KEGG. Pathways of choice can be downloaded from KEGG as KGML XML files (KEGG Markup Language, in XML format) and imported into Cytoscape using one of the many apps, such as KEGGscape <xref rid="b0065" ref-type="bibr">[13]</xref>. In Cytoscape, the user can define styles, highlight nodes and/or edges, or change properties (<italic>e.g.</italic>, color, thickness, or shape of both nodes and edges based on uploaded data, such as gene expression or protein data). Layouts, statistical analyses, or specific apps with certain abilities can be applied to analyze the network in question. Importing the pathway is a crucial part of the analysis. The limitation in the KEGG XML files and/or KEGGScape of only showing the first of potentially multiple genes in each node has consequences for both analysis and interpretation (<xref rid="f0005" ref-type="fig">Figure 1</xref>), since the missing expression data of the remaining genes in the node makes it impossible to conclude on the overall gene expression associated with each node. It would be a huge advantage if one could expand the analysis to include differential expression of all genes in a node, and visualize the expression levels and associated differences for nodes consisting of multiple genes. This can be used to conclude on the overall up- or down-regulation at the node level, and suggest which gene(s) in the node that may have the largest influence on the overall activity.</p>
    <p id="p0020">Other options for importing KEGG XML files are CyKEGGParser <xref rid="b0070" ref-type="bibr">[14]</xref> and CytoKEGG (<ext-link ext-link-type="uri" xlink:href="http://apps.cytoscape.org/apps/cytokegg" id="ir010">http://apps.cytoscape.org/apps/cytokegg</ext-link>). CyKEGGParser discusses the topic of paralogs being grouped into single nodes, and their solution is to create new separate nodes for each of the genes within a multi-gene node. CytoKEGG is used to search and import KEGG pathways into Cytoscape. Dealing with multiple genes in the same node has also been discussed by others in a non-Cytoscape related context. The Bioconductor package Graphite <xref rid="b0075" ref-type="bibr">[15]</xref> converts pathway topology to gene networks, and uses a combination of data from three curated databases (KEGG, Reactome, and BioCarta/NCI/NPID <xref rid="b0080" ref-type="bibr">[16]</xref>) to create more complete networks. For the pathways from KEGG, Sales et al. <xref rid="b0075" ref-type="bibr">[15]</xref> discuss how nodes with multiple genes may represent two different types of groups: protein complexes (“AND groups”, all genes should be considered together) or alternative proteins for the same function (functional homologs; “OR groups”, considering one gene at the time). This second group (OR) can be expanded into pathways without any connections between the alternative genes/proteins. In another publication, Wang et al. <xref rid="b0085" ref-type="bibr">[17]</xref> acknowledge nodes with multiple genes by coloring the same node with multiple colors representing the different gene expression values. In addition, the number of genes in each node is displayed next to it. Although this approach can work for nodes with a limited number of genes, it will become harder to interpret when the number of genes increases. Additionally, neither of these approaches show the expression level for each gene, which can help to identify the genes that are most likely to be responsible for the reaction in a given node.</p>
    <p id="p0025">In nodes with multiple functional homologs, the relative expression levels of the genes in a node can be an accessible and useful measure to assess the relative importance of the individual enzymes for a given condition. For microarrays, the previous golden standard for gene expression analysis, differences in probe-affinities made it difficult to assess the relative expression levels between genes in an experiment <xref rid="b0090" ref-type="bibr">[18]</xref>. However, the replacement of microarrays by RNA sequencing (RNA-seq) has now made comparison of expression levels feasible <xref rid="b0090" ref-type="bibr">[18]</xref>, <xref rid="b0095" ref-type="bibr">[19]</xref>, <xref rid="b0100" ref-type="bibr">[20]</xref>, <xref rid="b0105" ref-type="bibr">[21]</xref>. Data from RNA-seq could therefore be utilized to improve the analysis of the overall node activity, as well as the individual contribution of each gene in the node for a given metabolic pathway.</p>
    <p id="p0030">Here we present Functionally Homologous Proteins (FunHoP): a method to improve gene expression pathway analysis and visualization. FunHoP improves the network visualization and analysis with respect to differential expression of nodes with multiple genes, and the relative contribution of each gene in a node. In particular, FunHoP aggregates gene information for each KEGG node consisting of multiple genes by using RNA-seq gene expression data for each gene, assuming that genes in the same node represent overlapping enzymatic potential (<italic>i.e</italic>., functional homologs). We show that prioritizing genes based on read counts from RNA-seq will improve the interpretation of differential expression results when analyzed with KEGG metabolic pathways. By gaining information from multiple genes for each node as input for differential expression analysis, we receive more biologically relevant and reliable pathways. Using prostate cancer (PCa) as a model system, we present two case studies showing how gene expression data are able to explain previously observed metabolic changes when FunHoP is applied.</p>
  </sec>
  <sec id="s0010">
    <title>Method</title>
    <p id="p0035">RNA-seq data for PCa (read counts and gene identifiers) were downloaded from The Cancer Genome Atlas (TCGA) <xref rid="b0110" ref-type="bibr">[22]</xref> at <ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/repository" id="ir015">https://portal.gdc.cancer.gov/repository</ext-link>. For the Prensner cohort <xref rid="b0115" ref-type="bibr">[23]</xref>, RNA-seq raw reads in <italic>fastq</italic>-format were downloaded with approval from The database of Genotypes and Phenotypes (dbGap: phs000443.v1.p1, project No. 5870) at <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi%3fstudy_id%3dphs000443.v1.p1" id="ir020">https://www.ncbi.nlm.nih.gov/projects/gap/cgi-bin/study.cgi?study_id=phs000443.v1.p1</ext-link>.</p>
    <p id="p0040">Raw RNA-seq reads were mapped to the hg19 transcriptome using TopHat2 <xref rid="b0120" ref-type="bibr">[24]</xref>, and featureCounts <xref rid="b0125" ref-type="bibr">[25]</xref> was used to assign the reads to each gene. Voom <xref rid="b0130" ref-type="bibr">[26]</xref> was further used for differential expression analysis. DEGs with a <italic>P</italic> value below 0.05 were extracted, and <italic>P</italic> values were log<sub>2</sub> transformed by:<disp-formula id="e0005"><label>(1)</label><mml:math id="M1" altimg="si1.svg"><mml:mrow><mml:mtext>Value</mml:mtext><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mtext>log</mml:mtext><mml:mn>2</mml:mn></mml:msub><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:mi>P</mml:mi><mml:mspace width="0.166667em"/><mml:mspace width="0.35em"/><mml:mtext>value</mml:mtext><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:mtext>regulation</mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>where regulation was defined as 1 for up-regulated genes (positive fold-change) and −1 for down-regulated genes (negative fold-change). Average RNA-seq read count for each gene was calculated using the mean of the two average values calculated over cancer and normal samples, respectively. All read counts were adjusted for gene lengths by a factor estimated by taking the gene length of the respective gene (sum of exons) divided by the average gene length over all genes.</p>
    <p id="p0045">In this study, 85 pathways of relevance to human metabolism, from subcategories 1.1 up to and including 1.11, were downloaded with human genes from the KEGG pathway database <xref rid="b0135" ref-type="bibr">[27]</xref>. 71 of these did not contain any “line” nodes, and were used further (see <xref rid="s0075" ref-type="sec">Tables S1 and S2</xref>). The initial pathway analysis was performed by loading original KEGG XML files into Cytoscape (v. 3.4.) via the KEGGScape app and using a color gradient based on differential expression. All displays of differential expression used the same gradient: values were found on a scale from −1200 (black) to 600 (dark green), via −600 (purple), −300 (bright red), 0 (light yellow), and 300 (bright green). All values below zero showed down-regulated gene expression, and all values above zero showed up-regulated gene expression.</p>
    <p id="p0050">To expand the XML files to show all the genes in all the nodes, the list of human IDs and corresponding gene names was downloaded <xref rid="b0140" ref-type="bibr">[28]</xref>. Using the ElementTree XML API, name strings in nodes with more than one gene were extended to include only the human names for all these genes (File S1). KEGG's solution to protein complexes was used as a base, and nodes with more than one gene were expanded. The expanded nodes were made by creating a new child for each of the genes that were not included in the initial child, and combining the new children along with the old child in a common node. The gene nodes use the same coordinates as the original gene, making it appear in the same place. To distinguish gene nodes from protein complexes, the gene nodes were made bigger than the default size, giving them a white field on each side. Differential gene expression was first used in combination with the expanded networks, showing how all the genes in the pathway were expressed.</p>
    <p id="p0055">To make more interpretable networks yet containing all the information, all genes within a node were aggregated into one. Name strings were extracted from all the network files, and the lists of unique names were defined as unique nodes. These included both single-gene and multiple-gene nodes. All gene nodes were named on the form “gene1-Bx”, where “gene1” is the name of the first gene in the gene-name string for a given node, and “x” is the number of genes within the node. For single-gene nodes x is 1. The total read count for a node was found by adding the read counts for all genes in the node, and this value was used for differential expression analysis at the node level. The contribution of each gene to expression level within a node was calculated as the fraction of the read count for that gene to the total read count of the node. The read count for each gene was used to style for expanded networks according to the relative expression levels of the genes. Nodes were colored on a scale from 0 to ≥ 50,000 read counts, changing from white to dark blue via shades of pink and blue.</p>
    <p id="p0060">The aggregated network files were adapted to work with the aggregated network gene node names. Changing the name strings to reflect the first gene name and the number of genes made the string similar to the gene node name format, and the network files could again be used together with the output from differential expression. The previously used style for differential expression was again used for the aggregated networks.</p>
    <p id="p0065">To show that the method works, two case studies were performed: the histidine metabolism pathway and a minor part of the metabolic pathway for glycerophosphocholine (GPC). The original files from KEGG were run through FunHoP’s steps of creating expanded and aggregated networks, as explained above, analyzed with differential expression, and visualized as expanded networks at the gene level and aggregated networks at the node level.</p>
  </sec>
  <sec id="s0015">
    <title>Results</title>
    <sec id="s0020">
      <title>Expanding nodes and using RNA-seq counts to improve pathway analysis</title>
      <p id="p0070">To visualize KEGG pathways using information from all the individual genes involved, each node containing multiple functional homologs was expanded to show all genes in the node. Nodes were expanded by adding a new child for each gene belonging to the node, in addition to the existing child representing the default gene displayed in the pathway from KEGG in Cytoscape by KEGGScape. Old and new children of a node were then connected in a type “group” child, using the same strategy as for protein complexes (AND groups). To visually distinguish nodes with functional homologs (OR) from protein complexes (AND), the nodes were made bigger than the default size, giving them a white border on each side (<xref rid="f0010" ref-type="fig">Figure 2</xref>A).<fig id="f0010"><label>Figure 2</label><caption><p><bold>Validation of the FunHoP approach</bold></p><p><bold>A.</bold> The <italic>ALDH3A1</italic> node expanded to show individual genes styled by differential gene expression. <bold>B.</bold> The expanded <italic>PLA2G4B</italic> node with its 21 genes. The <italic>PLA2G4B</italic> gene itself is not found in the dataset, leading to the whole node to be seen as not significant when only <italic>PLA2G4B</italic> is shown, although the other hidden genes are significantly differentially expressed. <bold>C.</bold> Plots of log<sub>2</sub> read count from TCGA and Prensner (top) and gene abundance ratio in TCGA <italic>vs</italic>. in Prensner (bottom). <bold>D.</bold> Gene abundance ratios within the <italic>PLA2G4B</italic> node from (B) are comparable between the TCGA and Prensner cohorts.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0075">We then used the average RNA-seq read count for each gene (normalized against gene length), generated from patient samples in two available PCa cohorts <xref rid="b0110" ref-type="bibr">[22]</xref>, <xref rid="b0115" ref-type="bibr">[23]</xref>. Aggregated average read counts for all genes in each node were used to define the total expression level of each node in the network. Moreover, the relative read count for each gene in a node divided by the total read count for the node was used to define the relative expression contribution from each gene in a node.</p>
      <p id="p0080">To show the effect of FunHoP, original pathways were color-coded according to log-transformed <italic>P</italic> values from differential gene expression analysis, here comparing PCa tissue with normal prostate tissue. For showing individual genes within an expanded node, each gene was color-coded by both <italic>P</italic> values and the average read count for the gene to indicate expression level, giving two expanded networks that were comparable. The final representation shows the network with aggregated nodes, color-coded by differential expression based on overall read counts within a node.</p>
    </sec>
    <sec id="s0025">
      <title>Assumptions regarding gene families and expression levels</title>
      <p id="p0085">We introduce two important assumptions for the biological interpretations in FunHoP. First, we observe that genes assigned to the same node usually belong to the same functional gene family or are closely related, as in the case of the nodes for the aldehyde dehydrogenases (<xref rid="f0010" ref-type="fig">Figure 2</xref>A) and phospholipases (<xref rid="f0010" ref-type="fig">Figure 2</xref>B). Thus, we make the assumption that the gene products also have similar function, in particular that they are able to catalyze the same main reaction, and describe them as enzymes with homologous function, or functional homologs. Therefore, we assume that each homolog can catalyze the reaction at a comparable rate. This is obviously an oversimplification, but also a necessary simplification given the general lack of rate data for most cellular processes.</p>
      <p id="p0090">Second, we assume that read counts from RNA-seq are indicative of the relative expression level of genes within a sample cohort. To check this assumption, we used RNA-seq read counts from two independent datasets. We see that the gene expression levels based on RNA-seq read counts are highly correlated (<xref rid="f0010" ref-type="fig">Figure 2</xref>C). We also find that expression ratios for individual genes in a node are correlated (<xref rid="f0010" ref-type="fig">Figure 2</xref>D). In particular, there is a very good correspondence for genes having particularly high (&gt; 0.9) or low (&lt; 0.1) ratios, which shows that RNA-seq data can robustly identify genes with a very high or very low relative abundance. This pattern is also evident when looking at individual genes within a node with high complexity, as the ratio for each gene within the node follows the same trend independent of which dataset we used (<xref rid="f0010" ref-type="fig">Figure 2</xref>D). The highly expressed <italic>PLA2G2A</italic> is clearly dominant in both datasets, the genes with very low number of read counts are the same, and the genes identified with few and intermediate number of read counts are also the same, though the relative ratios vary somewhat among the intermediate genes in the two datasets.</p>
      <p id="p0095">Under these assumptions, a gene’s contribution to the overall node activity is proportional to its expression level. This information becomes particularly useful in situations where one specific gene is dominating within a node. An example of this is the <italic>PLA2G4B</italic> node in the glycerophospholipid metabolism pathway (KEGG: hsa00564). The current Cytoscape/KEGGScape/KEGG framework only shows <italic>PLA2G4B</italic>, which is not found in the TCGA dataset, and hence the node seems to be not significant in the pathway. When the node is expanded, we see all 21 genes or functional homologs. By comparing the read counts for each gene, we see how <italic>PLA2G2A</italic> is expressed at a level that is ten times higher than the second one on the list (<xref rid="f0010" ref-type="fig">Figure 2</xref>B). Here, the darkest blue corresponds to ≥ 50,000 read counts, whereas the white/pink/light blue corresponds to &lt; 5000 read counts. The genes indicated in light pink have &lt; 10 read counts, and the ones in white are not expressed. These genes will most likely not contribute significantly to the pathway in this case. The KEGG default gene <italic>PLA2G4B</italic> is not found in the TCGA dataset, and has a low expression in the Prensner dataset. In this case, it is reasonable to assume that <italic>PLA2G2A</italic> is the main driving force for the transition represented by the node.</p>
    </sec>
    <sec id="s0030">
      <title>Case studies</title>
      <p id="p0100">To investigate the impact of FunHoP on real biological interpretation of networks, we used PCa as a model system for two case studies. Metabolic studies have identified significant changes in metabolites in both histidine and glycerophospholipid metabolism pathways, but gene expression changes in the original network models were unable to explain the observed metabolic differences. Our aim was to investigate if FunHoP could identify the possible changes in expression levels leading to the observed changes in metabolites. The dataset from TCGA was further used in the following case studies due to its high number of samples and thereby statistical power.</p>
      <sec id="s0035">
        <title>Case study 1: histidine metabolism</title>
        <p id="p0105">The first case study looks at the histidine metabolism pathway. It has been shown that histidine is elevated in PCa compared to normal prostate tissue <xref rid="b0145" ref-type="bibr">[29]</xref>. This elevation cannot be explained by differential changes in gene expression using the original pathway (<xref rid="f0015" ref-type="fig">Figure 3</xref>A). In the original pathway, histidine is produced from carnosine in two paths, by <italic>CNDP2</italic> or <italic>CNDP1</italic>. Histidine can then be converted back to carnosine through a loop by <italic>CARNS1</italic> (<xref rid="f0015" ref-type="fig">Figure 3</xref>A). Looking at the <italic>P</italic> values for the respective genes shows that <italic>CNDP1</italic> is downregulated, and <italic>CNDP2</italic> and <italic>CARNS1</italic> are up-regulated with <italic>P</italic> values within the same order of magnitude. Moreover, of the genes in the other paths leading away from histidine, <italic>HAL</italic> is up-regulated while <italic>HDC</italic> and <italic>DDC</italic> are unchanged (<xref rid="f0015" ref-type="fig">Figure 3</xref>A). Overall, this pathway is not compatible with the observed increase in histidine levels in PCa.<fig id="f0015"><label>Figure 3</label><caption><p><bold>Pathway of histidine metabolism</bold></p><p><bold>A.</bold> Original pathway colored by differential gene expression on a log-scale. <bold>B.</bold> Expanded pathway colored by differential gene expression. <bold>C.</bold> Expanded pathway colored by RNA-seq read counts. <bold>D.</bold> Aggregated pathway colored by differential gene expression at the node level.</p></caption><graphic xlink:href="gr3"/></fig></p>
        <p id="p0110">However, when using the FunHoP-expanded pathway to visualize all genes and nodes, we can see how the original pathway is an oversimplification of a more complex pathway including three nodes with multiple genes (<xref rid="f0015" ref-type="fig">Figure 3</xref>B). Many of these nodes have genes that are up- or down-regulated. As there are no functional homologs in the nodes most directly linked to histidine, expanding nodes alone does not lead to any improved interpretation in this case. However, when RNA-seq read counts are shown together with differential expression in the extended pathway, we are able to provide a possible explanation as to how histidine level may be elevated (<xref rid="f0015" ref-type="fig">Figure 3</xref>C).</p>
        <p id="p0115">For the paths leading to histidine synthesis, the most dominant gene in read counts is <italic>CNDP2,</italic> which is up-regulated and has about 11,000 reads. Up-regulation of <italic>CNDP2</italic> pushes carnosine conversion to histidine. The down-regulated <italic>CNDP1</italic> has close to zero read counts and can be ignored. <italic>CARNS1</italic>, responsible for the loop back towards carnosine, has less than 100 reads, and is probably less influential than <italic>CNDP2</italic>. We can therefore assume that up-regulation of the highly expressed <italic>CNDP2</italic> most likely leads to increased production of histidine. For the paths leading away from histidine, all genes in the path leading towards glutamate (including the up-regulated <italic>HAL</italic>) have close to zero read counts, and can be ignored. With <italic>HDC</italic> and <italic>DDC</italic> remaining unchanged, there is no net change in histidine consumption. Increased histidine production through the highly expressed <italic>CNDP2</italic> combined with ignorable changes in histidine consumption, leads to a possible explanation for how histidine accumulates. Moreover, the genes further downstream of histamine (<italic>i.e.</italic>, <italic>HNMT</italic> and <italic>AOC1</italic>) are down-regulated with higher read counts (2519 and 3636 read counts, respectively), creating a bottleneck in the influx/efflux balance, which can lead to further increase in histidine levels. The overall read counts in the pathway seems to push towards accumulation of histidine, which is not used further downstream in any direction, allowing a build-up of histidine to happen. The histidine pathway also shows examples of nodes with high difference in read counts between genes in the node. One example is the <italic>ALDH3A1</italic> node, where <italic>ALDH1A3</italic> dominates with 46,595 read counts, while the three remaining genes have less than 1000 reads each. This further strengthens the idea that the differential expression of the dominant gene will determine the overall expression of the node.</p>
        <p id="p0120">The conclusions from the expanded network are also evident in the aggregated network at the node level (<xref rid="f0015" ref-type="fig">Figure 3</xref>D), where <italic>CNDP2</italic> is clearly highlighted, especially when looking at the pathway styled with read counts. The aggregated network shows how nodes that appear to be up-regulated in the original network are shown to be down-regulated, and vice versa. Overall, FunHoP provides a more complete pathway analysis, and is able to give a more precise explanation on how histidine can be elevated in PCa.</p>
      </sec>
      <sec id="s0040">
        <title>Case study 2: glycerophospholipid metabolism</title>
        <p id="p0125">The second case study looks at part of the glycerophospholipid metabolism. The complete pathway is extensive and contains several complex nodes with up to 21 genes, which makes visualization and analysis challenging. Previous studies have shown elevated levels of GPC in PCa <xref rid="b0150" ref-type="bibr">[30]</xref>, <xref rid="b0155" ref-type="bibr">[31]</xref>, <xref rid="b0160" ref-type="bibr">[32]</xref>, and the original Cytoscape network from KEGG colored by differential expression is shown in <xref rid="f0020" ref-type="fig">Figure 4</xref>A.<fig id="f0020"><label>Figure 4</label><caption><p><bold>Pathway of glycerophospholipid metabolism (part)</bold></p><p><bold>A.</bold> Original pathway colored by differential gene expression on a log-scale. <bold>B.</bold> Expanded pathway colored by differential gene expression. <bold>C.</bold> Expanded pathway colored by RNA-seq read counts <bold>D.</bold> Aggregated pathway colored by differential gene expression at the node level.</p></caption><graphic xlink:href="gr4"/></fig></p>
        <p id="p0130">The initial pathway does not provide an explanation to how GPC can be elevated based on differential gene expression values. In the reaction paths leading from lecithin towards GPC, three displayed genes are not significantly differentially expressed (<italic>PLA2G16</italic> and <italic>PNPLA6</italic> via 1-lysolecithin, and <italic>PLA2G4B</italic> towards 2-lysolecithin), and one is down-regulated (<italic>LCAT</italic> towards 2-lysolecithin), along with one up-regulated gene functioning in the opposite direction (up-regulated <italic>LPCAT3</italic> from 2-lysolecithin back to lecithin). This indicates that even if the conversion from 2-lysolecithin to GPC is up-regulated by <italic>LYPLA1</italic>, the reaction is just as much pushed away from 2-lysolecithin and back towards lecithin by <italic>LPCAT3</italic>, instead of towards GPC. Overall, this does not explain how GPC can be accumulated. However, when expanding the network, a more complex picture emerges, with more genes involved in several nodes and huge differences in RNA-seq read counts among genes and nodes (<xref rid="f0020" ref-type="fig">Figure 4</xref>B and C). The expanded networks provide a different interpretation of several nodes in the pathway.</p>
        <p id="p0135">A particularly complex node of 21 genes appears in the original <italic>PLA2G4B</italic> node. This node contains both non-significant genes and up-/down-regulated genes, with average RNA-seq read counts varying over many orders of magnitude. The clearly dominant gene is <italic>PLA2G2A</italic> with 71,482 read counts (<xref rid="f0020" ref-type="fig">Figure 4</xref>C), which is also up-regulated (<xref rid="f0020" ref-type="fig">Figure 4</xref>B). Since none of the other genes have read counts of comparable magnitude (the second highest is <italic>PLA2G12A</italic> with 4502 read counts), we see how this node changes from non-significant in the original network to up-regulated in the aggregated network (<xref rid="f0020" ref-type="fig">Figure 4</xref>D). The other nodes in the paths leading to production of GPC also show both up- and down-regulated genes. The most dominant gene in the <italic>PNPLA6</italic> node is <italic>LYPLA2</italic> (<xref rid="f0020" ref-type="fig">Figure 4</xref>C), which is up-regulated (<xref rid="f0020" ref-type="fig">Figure 4</xref>B). For the <italic>LYPLA1</italic> node, the dominant gene is <italic>LYPLA1</italic> (<xref rid="f0020" ref-type="fig">Figure 4</xref>C), which is up-regulated as in the original network (<xref rid="f0020" ref-type="fig">Figure 4</xref>A and B). Both dominant genes lead to their respective nodes being up-regulated in the aggregated network (<xref rid="f0020" ref-type="fig">Figure 4</xref>D), enabling two possible paths towards production of GPC. Both paths via 1-lysolecithin and 2-lysolecithin, respectively, are now up-regulated. Even though <italic>PLA2G16</italic> in the 1-lysolecithin path is not significant, <italic>PLA2G16</italic> still has 3246 reads, which indicates a flux through this path. For the path via 2-lysolecithin, the up-regulation of both the <italic>PLA2G4B</italic> and <italic>LYPLA1</italic> nodes reveals an unambiguous up-regulated path from lecithin to GPC. Though the <italic>LPCAT3</italic> node looping backwards upstream of GPC is also up-regulated, the pathway as a whole shows a net unambiguous flux towards GPC through several possible paths, explaining why GPC would accumulate in PCa. The expanded network also shows that <italic>LCAT</italic> (the sole gene of the LCAT node) has fewer reads than the <italic>PLA2G4B</italic> and <italic>LPCAT3</italic> nodes, making its down-regulation less important (<xref rid="f0020" ref-type="fig">Figure 4</xref>C).</p>
        <p id="p0140">Alongside providing more biological information, the GPC example also illustrates the possible complexity of nodes. With the full pathway having four highly complex multi-gene nodes of 21 genes, as well as several nodes with 4–6 genes, we see how difficult pathways can be to interpret. Using FunHoP, we show how we can gain important additional information by expanding the networks to show all genes, and by looking at differential expression and gene expression level simultaneously for network interpretation.</p>
        <p id="p0145">In order to validate our conclusions on the two case studies using data from TCGA, we performed the same analysis with the data from the Prensner cohort. Due to the generally smaller number of samples in the Prensner data, in addition to lower sequencing depth, many of the significant changes observed in TCGA were not statistically significant in Prensner. However, the overall patterns are also evident in both case studies, both in terms of the dominant genes within the pathway and the differential expression (<xref rid="s0075" ref-type="sec">Figures S1 and S2</xref>), which supports the conclusions on which genes can contribute to the elevated levels of histidine and GPC in PCa.</p>
      </sec>
    </sec>
  </sec>
  <sec id="s0045">
    <title>Discussion</title>
    <p id="p0150">Metabolic pathway analysis is an important approach for analyzing gene expression. With the constantly growing amount of available data, we can improve our understanding of the complexity in biological systems, and continuously develop models to capture and utilize new data and information. However, the most commonly used pathway representations from databases and associated tools often give a simplified picture of metabolic pathways, focusing on only one gene in each network node, despite the fact that more genes may be able to perform the same enzymatic reaction. One example, which we have focused on in this study, is the current integration of KEGG and Cytoscape using KEGGScape.</p>
    <p id="p0155">We have therefore implemented a strategy for including all functional homologs of a gene in the analysis, based on the following assumptions:</p>
    <p id="p0160">First, we have to assume that the relevant genes in an expanded node indeed are functional homologs, <italic>i.e</italic>., with similar function. KEGG networks are manually curated, and documentation can be found within KEGG for genes, compounds, and reactions. When KEGGScape places a gene within a certain node, we assume that this gene is able to produce an enzyme that can catalyze the transition represented by the node. In FunHoP, we have implicitly made an assumption that the different genes within a node representing an enzymatic reaction also catalyze the reaction at a similar rate. This is a simplification, and to model the enzyme activity one should ideally also include enzyme efficiency and kinetics for the given situation. However, data on enzyme kinetics are usually not available, or very hard to obtain. We believe that our assumption on the enzyme activity correlating with expression level is at least reasonable for differences spanning several orders of magnitude, and represents a model improvement compared to networks where expression levels are not considered at all. Supporting this assumption is the observation that genes in a node usually belong to the same gene family. For example, for the node in the histidine metabolism pathway with <italic>ALDH3A1</italic> on top, all the other genes are aldehyde dehydrogenase paralogs that are able to catalyze the same reaction (<xref rid="f0010" ref-type="fig">Figure 2</xref>A).</p>
    <p id="p0165">Secondly, we have to assume that we actually can estimate relative expression levels of relevant genes. With microarrays being the previous gold standard to measure changes in gene expression, differential expression analysis and subsequent network mapping were limited to fold changes and <italic>P</italic> values. Variations in probe affinities made it difficult to assume anything about the real expression level differences between genes. However, with RNA-seq, one should be able to provide relative expression level measurements with much improved correlation to the real relative mRNA levels compared to microarrays.</p>
    <p id="p0170">Using the two assumptions on relative expression levels and similarity in enzyme efficiency described above, we can predict which of the genes is/are most likely to be responsible for a given reaction in a node. Especially for cases where the read-count difference for two genes in the same node spans several orders of magnitude, we find it likely that difference in expression level will take precedence over reaction efficiency. We have shown that read counts are highly reproducible for two independent patient cohorts for PCa. We observe that many pathway nodes typically consist of one or a few dominant genes in terms of expression level, supporting our claim that this is a highly relevant measure to include when evaluating the contribution from different enzymes in a node. For the single-gene nodes, the approach of looking at absolute gene expression can also reveal patterns in the pathways that are not evident from comparing <italic>P</italic> values alone. By using read counts, we are also capable of determining whether some paths are turned completely off, as in the case for the path leading from histidine to glutamine (<xref rid="f0015" ref-type="fig">Figure 3</xref>C).</p>
    <p id="p0175">A possible limitation of our approach is to which degree tissue-specific isoforms affect enzymatic activity and estimated expression levels of the genes represented in the nodes. Not all isoforms of a gene are necessarily enzymatically active. However, KEGG does not currently provide curated information on enzyme activity of isoforms. We have thus limited analysis to the gene level. However, an expansion to isoforms is conceptually possible within the FunHoP framework if such data become available. Another isoform related limitation is that genes with particularly short or long dominant isoforms compared to the canonical isoform model may lead to aberrant expression level estimation for the genes affected. In addition, tissue-specific isoform switches can potentially affect results from differential expression analysis. In this study, we have assumed that genes are presented by their canonical isoform.</p>
    <p id="p0180">The starting point for network analysis is usually an expression table with samples and genes, which for RNA-seq is presented as a table of read counts. It is thus preferable that the network analysis is reproducible with respect to RNA-seq RNA selection protocols, sequence length, library size, choice of alignment, and mapping tools. It was not possible to systematically investigate many settings (mostly due to lack of available data on prostate), but we demonstrate that the results are reproducible in two independent PCa cohorts with different properties. Both cohorts use poly-A selection of transcripts, but differ in sequence length, library size, and alignment/mapping tools.</p>
    <p id="p0185">We also assume that changes in transcript level are informative about changes in protein level. It is well known that a direct association between mRNA expression level, protein level, and subsequent protein activity is inaccurate, for example because of the effects of post-transcriptional and post-translational regulation of proteins on enzyme kinetics; however, the reasons in most cases are unknown. We cannot say with absolute certainty that an up-regulated pathway with multiple read counts will result in a similar increased number of metabolites. A study by Schwanhäusser et al. <xref rid="b0165" ref-type="bibr">[33]</xref> shows a correlation between mRNA and protein copy numbers in NIH3T3 mouse fibroblasts, which was found to be 0.41. When considering translation rate constants, the correlation went up to 0.95.</p>
    <p id="p0190">Other studies in different organisms have also shown correlations, although this is organism dependent <xref rid="b0160" ref-type="bibr">[32]</xref>, <xref rid="b0170" ref-type="bibr">[34]</xref>. FunHoP does not pretend to describe the complete picture, but still represents a significant improvement compared to analyses where all genes are assumed to have the same expression level, or where multiple genes in the same node are not taken into account at all.</p>
    <p id="p0195">In the KEGG database, histidine is also involved in two other pathways that can affect the overall levels of this metabolite. In aminoacyl-tRNA biosynthesis (KEGG: hsa00970), histidine is converted to L-histidyl-tRNA(his), catalyzed by <italic>HARS</italic> and <italic>HARS2.</italic> Neither of these genes show significant changes, which indicates that this does not affect the level of histidine between the samples. In beta-alanine metabolism (KEGG: hsa00910), histidine is involved in the same step as the one in our case study, although we here see a more complete picture of carnosine being converted into histidine and beta-alanine. This is performed by the same enzymes as in the case study (<italic>CNDP1/CNDP2</italic>). As we know, <italic>CNDP1</italic> is down-regulated and has close to zero read counts, and <italic>CNDP2</italic> is up-regulated with 11,217 read counts. This should indicate that beta-alanine is also elevated in PCa, which was confirmed by the same study <xref rid="b0145" ref-type="bibr">[29]</xref>. Overall, we see how the case study provides a possible explanation on how histidine can be elevated in PCa, and our solution also fits with other available measurements of related metabolites <xref rid="b0145" ref-type="bibr">[29]</xref>.</p>
    <p id="p0200">GPC is also involved in another pathway: ether lipid metabolism (KEGG: hsa00565), where GPC can also be produced by conversion of 1-(1-alkenyl)-sn-glycero-3-phosphocholine by <italic>TMEM86B</italic>. However, this gene does not show a significant change between PCa tissue and normal tissue, and hence we can explain the elevated levels of GPC by the extracted part of glycerophospholipid metabolism shown in the case study. Another possibility for GPC to be elevated using the original network would be if the level of 2-lysolecithin was high, the up-regulated <italic>LYPLA1</italic> converted 2-lysolecithin to GPC. To our knowledge, 2-lysolecithin has not been documented as high in PCa.</p>
    <p id="p0205">Choline metabolism in PCa is a well-studied topic, especially in regard to relevant metabolites and identification of potential biomarkers <xref rid="b0150" ref-type="bibr">[30]</xref>, <xref rid="b0155" ref-type="bibr">[31]</xref>, <xref rid="b0160" ref-type="bibr">[32]</xref>, <xref rid="b0175" ref-type="bibr">[35]</xref>, <xref rid="b0180" ref-type="bibr">[36]</xref>. The pathways involved in the metabolism are still not fully covered, and our findings from case study 2 are therefore of special interest. These results will be focused on in later studies.</p>
    <p id="p0210">The current version of FunHoP supports the human metabolic pathways found in KEGG, with exception of the glycan-related pathways (mostly found in “Glycan biosynthesis and metabolism”, category 1.7), which uses a different type of visualization (“lines” instead of the traditional “rectangles”). These lines cannot be colored and expanded similarly to gene nodes, and are hence not suitable for pathway analysis in Cytoscape. Another challenge with the glycan-related pathways is that many of the children lack reactions in the downloaded XML files, even if the genes are presented as rectangles, and hence parts of the networks seem to consist of random genes with no connection to the path. It is possible to extend and style these gene nodes like in other pathways, but the missing reactions will still be lost. These problems are due to the way KEGG builds the XML file and how the file is read by KEGGScape.</p>
    <p id="p0215">As seen in the <xref rid="s0075" ref-type="sec">Tables S1 and S2</xref>, a total of 64 out of the 71 pathways contain at least one multi-gene node. The 71 pathways contain a total of 1974 nodes, of which 768 has multiple genes. Even though this only accounts for 39% of all nodes, it still means that for 90% of the pathways there is a possibility that not all relevant data will be included in the analysis. As we have shown, a single multi-gene node can change the entire interpretation of the pathway when all genes are included. Having at least one multi-gene node for 90% of the metabolism-related pathways used in this study demonstrates the importance of developing tools like FunHoP.</p>
    <p id="p0220">The first part of FunHoP, which deals with expanding the nodes with multiple genes, could possibly be solved also with other KGML-readers. CyKEGGParser has similar functions where all the “hidden” genes get a new node, with its own edges. This displays all the genes within a node as separate nodes, and these nodes can be colored and analyzed similarly as the original ones. However, as this study has shown, there are some nodes that contain a very large number of genes, which makes the analysis and interpretation challenging without further filtering by read counts from RNA-seq. CyKEGGParser is a KGML-reader/tweaker and does not have any of the features of FunHoP with regard to using reads from RNA-seq to determine an overall expression value for all genes in a multi-gene node. KEGGScape is a pure KGML-reader, which allows for running the pathway XML files through FunHoP locally and using KEGGScape to import the improved files. KEGGScape does not bend the edges the way CyKEGGParser does, and does not separate the functional homologs when reading the KEGG XML files. However, CyKEGGParser has many useful features such as corrections of inconsistencies in pathways and tissue-specific tuning, and these features could be interesting to consider in future studies.</p>
    <p id="p0225">For the cases where a KEGG protein complex contains nodes with multiple genes, it is dealt with by adding an expanded node on top of the protein complex. All genes can hence be seen and colored by expression, although the user may have to do a bit of manual editing of the network. This is a challenge in visualization of the networks, as an expanded node will be placed in the same position as the original node, but in most cases, it takes up more space than what was originally allocated.</p>
    <p id="p0230">To improve FunHoP and make it easier for others to use it, solutions for the problems above are under development. Converting FunHoP into a Cytoscape app is also in development, which will make it easier for all users to apply this method to their own analyses.</p>
  </sec>
  <sec id="s0050">
    <title>Conclusion</title>
    <p id="p0235">In this study, we have shown how FunHoP can be used to expand nodes from KEGG in Cytoscape to include all alternative genes present in a node. We have shown how <italic>P</italic> values from differential expression are not sufficient to determine regulation in a pathway, and how using the read counts from RNA-seq can facilitate metabolic network interpretation. Finally, we have shown that information in the extended networks can be aggregated to create more simplified networks at the node level, taking data from all genes into account.</p>
    <p id="p0240">By comparison of measured values of histidine and GPC in PCa and healthy prostate tissue from literature, we have shown how our analysis can explain why these metabolites are elevated, whereas the original pathway representations could not. We have also managed to show how differential expression based on <italic>P</italic> values does not differentiate between highly expressed genes and lowly expressed genes. By incorporating RNA-seq read counts into the analysis, we have highlighted genes that are highly expressed and more likely to dominate within a pathway. Overall, we show that FunHoP, by incorporating more biological information on network nodes and genes from KEGG, is able to provide improved pathway analysis.</p>
  </sec>
  <sec id="s0055">
    <title>Code availability</title>
    <p id="p0245">Code and documentation for running FunHoP can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/kjerstirise/FunHoP" id="ir025">https://github.com/kjerstirise/FunHoP</ext-link>.</p>
  </sec>
  <sec id="s0065">
    <title>CRediT author statement</title>
    <p id="p0255"><bold>Kjersti Rise:</bold> Conceptualization, Software, Validation, Formal analysis, Data curation, Writing - original draft, Writing - review &amp; editing, Visualization. <bold>May-Britt Tessem:</bold> Writing - review &amp; editing, Funding acquisition. <bold>Finn Drabløs:</bold> Conceptualization, Writing - review &amp; editing, Supervision, Funding acquisition. <bold>Morten B. Rye:</bold> Conceptualization, Software, Formal analysis, Writing - review &amp; editing, Visualization, Supervision, Funding acquisition. All authors have read and approved the final manuscript.</p>
  </sec>
  <sec id="s9002">
    <title>Competing interests</title>
    <p id="p0250">The authors have declared no competing interests.</p>
  </sec>
</body>
<back>
  <ref-list id="bi005">
    <title>References</title>
    <ref id="b0005">
      <label>1</label>
      <element-citation publication-type="journal" id="h0005">
        <person-group person-group-type="author">
          <name>
            <surname>Ogata</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Fujibuchi</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Bono</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Kanehisa</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>
        <source>Nucleic Acids Res</source>
        <volume>27</volume>
        <year>1999</year>
        <fpage>29</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="pmid">9847135</pub-id>
      </element-citation>
    </ref>
    <ref id="b0010">
      <label>2</label>
      <element-citation publication-type="journal" id="h0010">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Furumichi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Tanabe</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Morishima</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>KEGG: new perspectives on genomes, pathways, diseases and drugs</article-title>
        <source>Nucleic Acids Res</source>
        <volume>45</volume>
        <year>2017</year>
        <fpage>D353</fpage>
        <lpage>D361</lpage>
        <pub-id pub-id-type="pmid">27899662</pub-id>
      </element-citation>
    </ref>
    <ref id="b0015">
      <label>3</label>
      <element-citation publication-type="journal" id="h0015">
        <person-group person-group-type="author">
          <name>
            <surname>Fabregat</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Jupe</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Matthews</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Sidiropoulos</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Gillespie</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Garapati</surname>
            <given-names>P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The reactome pathway knowledgebase</article-title>
        <source>Nucleic Acids Res</source>
        <volume>46</volume>
        <year>2018</year>
        <fpage>D649</fpage>
        <lpage>D655</lpage>
        <pub-id pub-id-type="pmid">29145629</pub-id>
      </element-citation>
    </ref>
    <ref id="b0020">
      <label>4</label>
      <element-citation publication-type="journal" id="h0020">
        <person-group person-group-type="author">
          <name>
            <surname>Mi</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Muruganujan</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>P.D.</given-names>
          </name>
        </person-group>
        <article-title>PANTHER version 14: more genomes, a new PANTHER GO-slim and improvements in enrichment analysis tools</article-title>
        <source>Nucleic Acids Res</source>
        <volume>47</volume>
        <year>2019</year>
        <fpage>D419</fpage>
        <lpage>D426</lpage>
        <pub-id pub-id-type="pmid">30407594</pub-id>
      </element-citation>
    </ref>
    <ref id="b0025">
      <label>5</label>
      <mixed-citation publication-type="other" id="h0025">Chowdhury S, Sarkar RR. Comparison of human cell signaling pathway databases–evolution, drawbacks and challenges. Database (Oxford) 2015;2015:bau126.</mixed-citation>
    </ref>
    <ref id="b0030">
      <label>6</label>
      <element-citation publication-type="journal" id="h0030">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Furumichi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Morishima</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Tanabe</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>New approach for understanding genome variations in KEGG</article-title>
        <source>Nucleic Acids Res</source>
        <volume>47</volume>
        <year>2019</year>
        <fpage>D590</fpage>
        <lpage>D595</lpage>
        <pub-id pub-id-type="pmid">30321428</pub-id>
      </element-citation>
    </ref>
    <ref id="b0035">
      <label>7</label>
      <element-citation publication-type="journal" id="h0035">
        <person-group person-group-type="author">
          <name>
            <surname>Villaveces</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Koti</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Habermann</surname>
            <given-names>B.H.</given-names>
          </name>
        </person-group>
        <article-title>Tools for visualization and analysis of molecular networks, pathways, and -omics data</article-title>
        <source>Adv Appl Bioinform Chem</source>
        <volume>8</volume>
        <year>2015</year>
        <fpage>11</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="pmid">26082651</pub-id>
      </element-citation>
    </ref>
    <ref id="b0040">
      <label>8</label>
      <mixed-citation publication-type="other" id="h0040">Spohr P, Dinkla K, Klau GW, El-Kebir M. eXamine: Visualizing annotated networks in Cytoscape. F1000Res 2018;7:519.</mixed-citation>
    </ref>
    <ref id="b0045">
      <label>9</label>
      <element-citation publication-type="journal" id="h0045">
        <person-group person-group-type="author">
          <name>
            <surname>Mustafin</surname>
            <given-names>Z.S.</given-names>
          </name>
          <name>
            <surname>Lashin</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Matushkin</surname>
            <given-names>Y.G.</given-names>
          </name>
          <name>
            <surname>Gunbin</surname>
            <given-names>K.V.</given-names>
          </name>
          <name>
            <surname>Afonnikov</surname>
            <given-names>D.A.</given-names>
          </name>
        </person-group>
        <article-title>Orthoscape: a cytoscape application for grouping and visualization KEGG based gene networks by taxonomy and homology principles</article-title>
        <source>BMC Bioinformatics</source>
        <volume>18</volume>
        <year>2017</year>
        <fpage>1427</fpage>
        <pub-id pub-id-type="pmid">28466792</pub-id>
      </element-citation>
    </ref>
    <ref id="b0050">
      <label>10</label>
      <element-citation publication-type="journal" id="h0050">
        <person-group person-group-type="author">
          <name>
            <surname>Funahashi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Matsuoka</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Jouraku</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Morohashi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kikuchi</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Kitano</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Cell Designer 3.5: A versatile modeling tool for biochemical networks</article-title>
        <source>Proc IEEE</source>
        <volume>96</volume>
        <year>2008</year>
        <fpage>1254</fpage>
        <lpage>1265</lpage>
      </element-citation>
    </ref>
    <ref id="b0055">
      <label>11</label>
      <element-citation publication-type="journal" id="h0055">
        <person-group person-group-type="author">
          <name>
            <surname>Shannon</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Markiel</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ozier</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Baliga</surname>
            <given-names>N.S.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Ramage</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cytoscape: a software environment for integrated models of biomolecular interaction networks</article-title>
        <source>Genome Res</source>
        <volume>13</volume>
        <year>2003</year>
        <fpage>2498</fpage>
        <lpage>2504</lpage>
        <pub-id pub-id-type="pmid">14597658</pub-id>
      </element-citation>
    </ref>
    <ref id="b0060">
      <label>12</label>
      <element-citation publication-type="journal" id="h0060">
        <person-group person-group-type="author">
          <name>
            <surname>Bryant</surname>
            <given-names>D.H.</given-names>
          </name>
          <name>
            <surname>Moll</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>B.Y.</given-names>
          </name>
          <name>
            <surname>Fofanov</surname>
            <given-names>V.Y.</given-names>
          </name>
          <name>
            <surname>Kavraki</surname>
            <given-names>L.E.</given-names>
          </name>
        </person-group>
        <article-title>Analysis of substructural variation in families of enzymatic proteins with applications to protein function prediction</article-title>
        <source>BMC Bioinformatics</source>
        <volume>11</volume>
        <year>2010</year>
        <fpage>242</fpage>
        <pub-id pub-id-type="pmid">20459833</pub-id>
      </element-citation>
    </ref>
    <ref id="b0065">
      <label>13</label>
      <element-citation publication-type="journal" id="h0065">
        <person-group person-group-type="author">
          <name>
            <surname>Nishida</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Ono</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Kanaya</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Takahashi</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>KEGGscape: a Cytoscape app for pathway data integration</article-title>
        <source>F1000Res</source>
        <volume>3</volume>
        <year>2014</year>
        <fpage>144</fpage>
        <pub-id pub-id-type="pmid">25177485</pub-id>
      </element-citation>
    </ref>
    <ref id="b0070">
      <label>14</label>
      <element-citation publication-type="journal" id="h0070">
        <person-group person-group-type="author">
          <name>
            <surname>Nersisyan</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Samsonyan</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Arakelyan</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>CyKEGGParser: tailoring KEGG pathways to fit into systems biology analysis workflows</article-title>
        <source>F1000Res</source>
        <volume>3</volume>
        <year>2014</year>
        <fpage>145</fpage>
        <pub-id pub-id-type="pmid">25383185</pub-id>
      </element-citation>
    </ref>
    <ref id="b0075">
      <label>15</label>
      <element-citation publication-type="journal" id="h0075">
        <person-group person-group-type="author">
          <name>
            <surname>Sales</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Calura</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Cavalieri</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Romualdi</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>graphite - a Bioconductor package to convert pathway topology to gene network</article-title>
        <source>BMC Bioinformatics</source>
        <volume>13</volume>
        <year>2012</year>
        <fpage>20</fpage>
        <pub-id pub-id-type="pmid">22292714</pub-id>
      </element-citation>
    </ref>
    <ref id="b0080">
      <label>16</label>
      <element-citation publication-type="journal" id="h0080">
        <person-group person-group-type="author">
          <name>
            <surname>Schaefer</surname>
            <given-names>C.F.</given-names>
          </name>
          <name>
            <surname>Anthony</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Krupa</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Buchoff</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Day</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hannay</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PID: the pathway interaction database</article-title>
        <source>Nucleic Acids Res</source>
        <volume>37</volume>
        <year>2009</year>
        <fpage>D674</fpage>
        <lpage>D679</lpage>
        <pub-id pub-id-type="pmid">18832364</pub-id>
      </element-citation>
    </ref>
    <ref id="b0085">
      <label>17</label>
      <element-citation publication-type="journal" id="h0085">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Suzuki</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Dohra</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Takigami</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kako</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Soga</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of ethanol fermentation mechanism of ethanol producing white-rot fungus Phlebia sp. MG-60 by RNA-seq</article-title>
        <source>BMC Genomics</source>
        <volume>17</volume>
        <year>2016</year>
        <fpage>616</fpage>
        <pub-id pub-id-type="pmid">27515927</pub-id>
      </element-citation>
    </ref>
    <ref id="b0090">
      <label>18</label>
      <element-citation publication-type="journal" id="h0090">
        <person-group person-group-type="author">
          <name>
            <surname>Allison</surname>
            <given-names>D.B.</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Page</surname>
            <given-names>G.P.</given-names>
          </name>
          <name>
            <surname>Sabripour</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Microarray data analysis: from disarray to consolidation and consensus</article-title>
        <source>Nat Rev Genet</source>
        <volume>7</volume>
        <year>2006</year>
        <fpage>55</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="pmid">16369572</pub-id>
      </element-citation>
    </ref>
    <ref id="b0095">
      <label>19</label>
      <element-citation publication-type="journal" id="h0095">
        <person-group person-group-type="author">
          <name>
            <surname>Shendure</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>The beginning of the end for microarrays?</article-title>
        <source>Nat Methods</source>
        <volume>5</volume>
        <year>2008</year>
        <fpage>585</fpage>
        <lpage>587</lpage>
        <pub-id pub-id-type="pmid">18587314</pub-id>
      </element-citation>
    </ref>
    <ref id="b0100">
      <label>20</label>
      <element-citation publication-type="journal" id="h0100">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
        <source>Nat Rev Genet</source>
        <volume>10</volume>
        <year>2009</year>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="pmid">19015660</pub-id>
      </element-citation>
    </ref>
    <ref id="b0105">
      <label>21</label>
      <element-citation publication-type="journal" id="h0105">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Fung-Leung</surname>
            <given-names>W.P.</given-names>
          </name>
          <name>
            <surname>Bittner</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ngo</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X.</given-names>
          </name>
        </person-group>
        <article-title>Comparison of RNA-Seq and microarray in transcriptome profiling of activated T cells</article-title>
        <source>PLoS One</source>
        <volume>9</volume>
        <year>2014</year>
        <fpage>e78644</fpage>
        <pub-id pub-id-type="pmid">24454679</pub-id>
      </element-citation>
    </ref>
    <ref id="b0110">
      <label>22</label>
      <element-citation publication-type="journal" id="h0110">
        <person-group person-group-type="author">
          <name>
            <surname>Cancer Genome Atlas Research Network</surname>
          </name>
        </person-group>
        <article-title>The molecular taxonomy of primary prostate cancer</article-title>
        <source>Cell</source>
        <volume>163</volume>
        <year>2015</year>
        <fpage>1011</fpage>
        <lpage>1025</lpage>
        <pub-id pub-id-type="pmid">26544944</pub-id>
      </element-citation>
    </ref>
    <ref id="b0115">
      <label>23</label>
      <element-citation publication-type="journal" id="h0115">
        <person-group person-group-type="author">
          <name>
            <surname>Prensner</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>M.K.</given-names>
          </name>
          <name>
            <surname>Balbin</surname>
            <given-names>O.A.</given-names>
          </name>
          <name>
            <surname>Dhanasekaran</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>J.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome sequencing across a prostate cancer cohort identifies PCAT-1, an unannotated lincRNA implicated in disease progression</article-title>
        <source>Nat Biotechnol</source>
        <volume>29</volume>
        <year>2011</year>
        <fpage>742</fpage>
        <lpage>749</lpage>
        <pub-id pub-id-type="pmid">21804560</pub-id>
      </element-citation>
    </ref>
    <ref id="b0120">
      <label>24</label>
      <element-citation publication-type="journal" id="h0120">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Pertea</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Pimentel</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S.L.</given-names>
          </name>
        </person-group>
        <article-title>TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions</article-title>
        <source>Genome Biol</source>
        <volume>14</volume>
        <year>2013</year>
        <fpage>R36</fpage>
        <pub-id pub-id-type="pmid">23618408</pub-id>
      </element-citation>
    </ref>
    <ref id="b0125">
      <label>25</label>
      <element-citation publication-type="journal" id="h0125">
        <person-group person-group-type="author">
          <name>
            <surname>Liao</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G.K.</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W.</given-names>
          </name>
        </person-group>
        <article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>
        <source>Bioinformatics</source>
        <volume>30</volume>
        <year>2014</year>
        <fpage>923</fpage>
        <lpage>930</lpage>
        <pub-id pub-id-type="pmid">24227677</pub-id>
      </element-citation>
    </ref>
    <ref id="b0130">
      <label>26</label>
      <element-citation publication-type="journal" id="h0130">
        <person-group person-group-type="author">
          <name>
            <surname>Law</surname>
            <given-names>C.W.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>G.K.</given-names>
          </name>
        </person-group>
        <article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>
        <source>Genome Biol</source>
        <volume>15</volume>
        <year>2014</year>
        <fpage>R29</fpage>
        <pub-id pub-id-type="pmid">24485249</pub-id>
      </element-citation>
    </ref>
    <ref id="b0135">
      <label>27</label>
      <mixed-citation publication-type="other" id="h0135">Kanehisa Laboratories. KEGG Pathway Database. <ext-link ext-link-type="uri" xlink:href="http://www.genome.jp/kegg/pathway.html" id="ir258">http://www.genome.jp/kegg/pathway.html</ext-link> (2016-01-28, date last accessed).</mixed-citation>
    </ref>
    <ref id="b0140">
      <label>28</label>
      <mixed-citation publication-type="other" id="h0140">Kanehisa Laboratories. Hsa ID to gene name. http://rest.kegg.jp/list/hsa (2016-01-28 last accessed).</mixed-citation>
    </ref>
    <ref id="b0145">
      <label>29</label>
      <element-citation publication-type="journal" id="h0145">
        <person-group person-group-type="author">
          <name>
            <surname>Sreekumar</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Poisson</surname>
            <given-names>L.M.</given-names>
          </name>
          <name>
            <surname>Rajendiran</surname>
            <given-names>T.M.</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>A.P.</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metabolomic profiles delineate potential role for sarcosine in prostate cancer progression</article-title>
        <source>Nature</source>
        <volume>457</volume>
        <year>2009</year>
        <fpage>910</fpage>
        <lpage>914</lpage>
        <pub-id pub-id-type="pmid">19212411</pub-id>
      </element-citation>
    </ref>
    <ref id="b0150">
      <label>30</label>
      <element-citation publication-type="journal" id="h0150">
        <person-group person-group-type="author">
          <name>
            <surname>Bertilsson</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Tessem</surname>
            <given-names>M.B.</given-names>
          </name>
          <name>
            <surname>Flatberg</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Viset</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Gribbestad</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Angelsen</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Changes in gene transcription underlying the aberrant citrate and choline metabolism in human prostate cancer samples</article-title>
        <source>Clin Cancer Res</source>
        <volume>18</volume>
        <year>2012</year>
        <fpage>3261</fpage>
        <lpage>3269</lpage>
        <pub-id pub-id-type="pmid">22510345</pub-id>
      </element-citation>
    </ref>
    <ref id="b0155">
      <label>31</label>
      <element-citation publication-type="journal" id="h0155">
        <person-group person-group-type="author">
          <name>
            <surname>Giskeødegård</surname>
            <given-names>G.F.</given-names>
          </name>
          <name>
            <surname>Bertilsson</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Selnæs</surname>
            <given-names>K.M.</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Bathen</surname>
            <given-names>T.F.</given-names>
          </name>
          <name>
            <surname>Viset</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spermine and citrate as metabolic biomarkers for assessing prostate cancer aggressiveness</article-title>
        <source>PLoS One</source>
        <volume>8</volume>
        <year>2013</year>
        <fpage>e62375</fpage>
        <pub-id pub-id-type="pmid">23626811</pub-id>
      </element-citation>
    </ref>
    <ref id="b0160">
      <label>32</label>
      <element-citation publication-type="journal" id="h0160">
        <person-group person-group-type="author">
          <name>
            <surname>Swanson</surname>
            <given-names>M.G.</given-names>
          </name>
          <name>
            <surname>Keshari</surname>
            <given-names>K.R.</given-names>
          </name>
          <name>
            <surname>Tabatabai</surname>
            <given-names>Z.L.</given-names>
          </name>
          <name>
            <surname>Simko</surname>
            <given-names>J.P.</given-names>
          </name>
          <name>
            <surname>Shinohara</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>P.R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantification of choline- and ethanolamine-containing metabolites in human prostate tissues using 1H HR-MAS total correlation spectroscopy</article-title>
        <source>Magn Reson Med</source>
        <volume>60</volume>
        <year>2008</year>
        <fpage>33</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="pmid">18581409</pub-id>
      </element-citation>
    </ref>
    <ref id="b0165">
      <label>33</label>
      <element-citation publication-type="journal" id="h0165">
        <person-group person-group-type="author">
          <name>
            <surname>Schwanhausser</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Busse</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Dittmar</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Schuchhardt</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global quantification of mammalian gene expression control</article-title>
        <source>Nature</source>
        <volume>473</volume>
        <year>2011</year>
        <fpage>337</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="pmid">21593866</pub-id>
      </element-citation>
    </ref>
    <ref id="b0170">
      <label>34</label>
      <element-citation publication-type="journal" id="h0170">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>M.V.</given-names>
          </name>
          <name>
            <surname>Topper</surname>
            <given-names>S.E.</given-names>
          </name>
          <name>
            <surname>Hubler</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Hose</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wenger</surname>
            <given-names>C.D.</given-names>
          </name>
          <name>
            <surname>Coon</surname>
            <given-names>J.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A dynamic model of proteome changes reveals new roles for transcript alteration in yeast</article-title>
        <source>Mol Syst Biol</source>
        <volume>7</volume>
        <year>2011</year>
        <fpage>514</fpage>
        <pub-id pub-id-type="pmid">21772262</pub-id>
      </element-citation>
    </ref>
    <ref id="b0175">
      <label>35</label>
      <element-citation publication-type="journal" id="h0175">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bhujwalla</surname>
            <given-names>Z.M.</given-names>
          </name>
          <name>
            <surname>Glunde</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>Targeting phospholipid metabolism in cancer</article-title>
        <source>Front Oncol</source>
        <volume>6</volume>
        <year>2016</year>
        <fpage>266</fpage>
        <pub-id pub-id-type="pmid">28083512</pub-id>
      </element-citation>
    </ref>
    <ref id="b0180">
      <label>36</label>
      <element-citation publication-type="journal" id="h0180">
        <person-group person-group-type="author">
          <name>
            <surname>Glunde</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Penet</surname>
            <given-names>M.F.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Jacobs</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Bhujwalla</surname>
            <given-names>Z.M.</given-names>
          </name>
        </person-group>
        <article-title>Choline metabolism-based molecular diagnosis of cancer: an update</article-title>
        <source>Expert Rev Mol Diagn</source>
        <volume>15</volume>
        <year>2015</year>
        <fpage>735</fpage>
        <lpage>747</lpage>
        <pub-id pub-id-type="pmid">25921026</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="s0075" sec-type="supplementary-material">
    <title>Supplementary material</title>
    <p id="p0270">The following are the Supplementary data to this article:<supplementary-material content-type="local-data" id="m0025"><caption><title>Supplementary File S1</title><p><bold>How FunHoP changes the XML files - node example</bold>.</p></caption><media xlink:href="mmc1.docx"/></supplementary-material></p>
    <p id="p0275">
      <supplementary-material content-type="local-data" id="m0020">
        <caption>
          <title>Supplementary Figure S1</title>
          <p><bold>Pathway of histidine metabolism – Prensner. A</bold>. Original pathway colored by differential gene expression from the Prensner cohort on a log-scale, ranging from –1200 (black) to 600 (dark green) via zero (yellow). The first impression shows close to none significant nodes. <bold>B</bold>. Expanding the nodes reveals multiple genes that show significant differential expression, which was not possible to see using the original network. <bold>C</bold>. Coloring the expanded network based on read counts, we see the same trends as in the network colored by the TCGA cohort. <italic>CNDP2</italic> is highly expressed, in a much higher degree than <italic>CARNS1</italic>, which changes histidine back to carnosine, and <italic>HDC</italic> and <italic>DDC</italic>, which converts histidine towards histamine. The path from histidine to glutamate contains close to zero read counts, which means histidine can be converted from carnosine, but has little conversion from histidine and onwards. We can also see how the counts are distributed within the multiple gene nodes, and predict how this will change the outcome of doing differential expression based on nodes as a total instead of single genes. <bold>D</bold>. The predictions from B can for instance be seen in the <italic>ALDH3A1</italic> node, where the upregulated <italic>ALDH1A3</italic> dominates the other genes when it comes to read counts, and hence the node becomes upregulated instead of downregulated. Despite the fact that <italic>CNDP2</italic> is still not significant, we can still see that there are multiple reads leading towards histidine, and very few leading away from it.</p>
        </caption>
        <media xlink:href="mmc2.pdf"/>
      </supplementary-material>
    </p>
    <p id="p0280">
      <supplementary-material content-type="local-data" id="m0015">
        <caption>
          <title>Supplementary Figure S2</title>
          <p><bold>Pathway of glycerophosphocholine metabolism (part) – Prensner. A</bold>. Original pathway colored by differential gene expression from the Prensner cohort on a log-scale, ranging from –1200 (black) to 600 (dark green) via zero (yellow). As for the histidine pathway, the number of significantly differentially expressed genes is lower than in TCGA. We can however see the same tendencies, with no particular path leading towards the formation and accumulation of glycerophosphocholine. <bold>B</bold>. Expanding the nodes reveals a few more genes that are differentially expressed. <bold>C</bold>. Coloring based on read counts reveals similar tendencies as with the TCGA cohort, for instance with <italic>PLA2G2A</italic> being the dominant gene within the <italic>PLA2G4B</italic> node. We can also see that the genes towards glycerophosphocholine contains many read counts. <bold>D</bold>. Despite there not being many significant genes after collapsing the nodes, the knowledge from the read counts still makes is plausible to assume how glycerophosphocholine is accumulated.</p>
        </caption>
        <media xlink:href="mmc3.pdf"/>
      </supplementary-material>
    </p>
    <p id="p0285">
      <supplementary-material content-type="local-data" id="m0010">
        <caption>
          <title>Supplementary Table S1</title>
        </caption>
        <media xlink:href="mmc4.docx"/>
      </supplementary-material>
    </p>
    <p id="p0290">
      <supplementary-material content-type="local-data" id="m0005">
        <caption>
          <title>Supplementary Table S2</title>
        </caption>
        <media xlink:href="mmc5.docx"/>
      </supplementary-material>
    </p>
  </sec>
  <ack id="ak005">
    <title>Acknowledgments</title>
    <p id="p0260">This work was supported by a PhD position from Enabling Technologies, Norwegian University of Science and Technology (NTNU), and by the Department of Clinical and Molecular Medicine (IKOM), NTNU to KR. Funding was given from the <funding-source id="gp005">Liaison Committee</funding-source> between the Central Norway Regional Health Authority (RHA) and the NTNU to MBR. <funding-source id="gp010">European Research Council</funding-source> (ERC) under the European Union’s Horizon 2020 research and innovation programme (Grant No. 758306) gave funding to MBT. Funding support for MPC_Transcriptome sequencing to identify non-coding RNAs in prostate cancer was provided through the <funding-source id="gp015">NIH Prostate SPORE</funding-source> (Grant Nos. P50CA69568 and R01 R01CA132874), the <funding-source id="gp020">Early Detection Research Network</funding-source> (Grant No. U01 CA111275), the <funding-source id="gp025"><institution-wrap><institution-id institution-id-type="doi">10.13039/100000005</institution-id><institution>Department of Defense</institution></institution-wrap></funding-source> Grant (Grant No. W81XWH-11-1-0331), and the <funding-source id="gp030">National Center for Functional Genomics</funding-source> (Grant No. W81XWH-11-1-0520). The results shown here are in part based upon data generated by the TCGA Research Network: <ext-link ext-link-type="uri" xlink:href="http://cancergenome.nih.gov/" id="ir555541">http://cancergenome.nih.gov/</ext-link>. The authors would also like to thank Cato Lauvli for his contributions to the figures, and Einar Johan Sømåen, Torje Digernes, and Endre Stovner for their valuable thoughts and inputs.</p>
  </ack>
  <fn-group>
    <fn id="d35e131">
      <p id="np005">Peer review under responsibility of Beijing Institute of Genomics, Chinese Academy of Sciences / China National Center for Bioinformation and Genetics Society of China.</p>
    </fn>
    <fn id="s0070" fn-type="supplementary-material">
      <p id="p0265">Supplementary data to this article can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.gpb.2021.03.003" id="ir030">https://doi.org/10.1016/j.gpb.2021.03.003</ext-link>.</p>
    </fn>
  </fn-group>
</back>
