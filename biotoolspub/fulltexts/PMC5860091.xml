<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860091</article-id>
    <article-id pub-id-type="pmid">28968748</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx526</article-id>
    <article-id pub-id-type="publisher-id">btx526</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RUCS: rapid identification of PCR primers for unique core sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-7666-4693</contrib-id>
        <name>
          <surname>Thomsen</surname>
          <given-names>Martin Christen Frølund</given-names>
        </name>
        <xref ref-type="aff" rid="btx526-aff1">1</xref>
        <xref ref-type="corresp" rid="btx526-cor1"/>
        <!--<email>mcft@cbs.dtu.dk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hasman</surname>
          <given-names>Henrik</given-names>
        </name>
        <xref ref-type="aff" rid="btx526-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Westh</surname>
          <given-names>Henrik</given-names>
        </name>
        <xref ref-type="aff" rid="btx526-aff3">3</xref>
        <xref ref-type="aff" rid="btx526-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaya</surname>
          <given-names>Hülya</given-names>
        </name>
        <xref ref-type="aff" rid="btx526-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lund</surname>
          <given-names>Ole</given-names>
        </name>
        <xref ref-type="aff" rid="btx526-aff1">1</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx526-aff1"><label>1</label>Department of Bio and Health Informatics, Technical University of Denmark, Lyngby, Denmark</aff>
    <aff id="btx526-aff2"><label>2</label>Department of Microbiology and Infection Control, Statens Serum Institut, Copenhagen, Denmark</aff>
    <aff id="btx526-aff3"><label>3</label>Department of Clinical Microbiology, Hvidovre Hospital, Copenhagen, Denmark</aff>
    <aff id="btx526-aff4"><label>4</label>Institute of Clinical Medicine, University of Copenhagen, Copenhagen, Denmark</aff>
    <author-notes>
      <corresp id="btx526-cor1">To whom correspondence should be addressed. Email: <email>mcft@cbs.dtu.dk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>12</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-08-30">
      <day>30</day>
      <month>8</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>8</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>24</issue>
    <fpage>3917</fpage>
    <lpage>3921</lpage>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>5</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>9</day>
        <month>8</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>8</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx526.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Designing PCR primers to target a specific selection of whole genome sequenced strains can be a long, arduous and sometimes impractical task. Such tasks would benefit greatly from an automated tool to both identify unique targets, and to validate the vast number of potential primer pairs for the targets <italic>in silico</italic>.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here we present RUCS, a program that will find PCR primer pairs and probes for the unique core sequences of a positive genome dataset complement to a negative genome dataset. The resulting primer pairs and probes are in addition to simple selection also validated through a complex <italic>in silico</italic> PCR simulation. We compared our method, which identifies the unique core sequences, against an existing tool called ssGeneFinder, and found that our method was 6.5–20 times more sensitive. We used RUCS to design primer pairs that would target a set of genomes known to contain the <italic>mcr-1</italic> colistin resistance gene. Three of the predicted pairs were chosen for experimental validation using PCR and gel electrophoresis. All three pairs successfully produced an amplicon with the target length for the samples containing <italic>mcr-1</italic> and no amplification products were produced for the negative samples. The novel methods presented in this manuscript can reduce the time needed to identify target sequences, and provide a quick virtual PCR validation to eliminate time wasted on ambiguously binding primers.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Source code is freely available on <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/genomicepidemiology/rucs">https://bitbucket.org/genomicepidemiology/rucs</ext-link>. Web service is freely available on <ext-link ext-link-type="uri" xlink:href="https://cge.cbs.dtu.dk/services/RUCS">https://cge.cbs.dtu.dk/services/RUCS</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Danish Council for Strategic Research</named-content>
          <named-content content-type="funder-identifier">10.13039/100007398</named-content>
        </funding-source>
        <award-id>09-067103</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Center for Genomic Epidemiology</named-content>
          <named-content content-type="funder-identifier">10.13039/501100005191</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Polymerase chain reaction (PCR) is one of the most important scientific advances in molecular biology. It is an inexpensive technology for copying a specific sequence of DNA. PCR is an indispensable tool for medical, forensic and research applications. PCR is used for detection and identification of infectious disease agents and for typing and characterization of virulence and resistance genes.</p>
    <p>It can be a laborious and often iterative process to design and find primers that only produce the expected amplicons in a PCR reaction. The genome the primers are to bind to can be huge, and the primers may bind to DNA even if the match is not perfect. This unspecific priming can lead to problems with false positive results when PCR is used for detection purposes, or create wrong products for DNA amplification.</p>
    <p>Several bioinformatics tools able to help identifying good primer candidates and reduce the amount of false positive results already exist.</p>
    <p>Among these tools, the most prominent are ssGeneFinder, Primer3 and PrimerBLAST (<xref rid="btx526-B4" ref-type="bibr">Ho <italic>et al.</italic>, 2012</xref>; <xref rid="btx526-B8" ref-type="bibr">Untergasser <italic>et al.</italic>, 2012</xref>; <xref rid="btx526-B10" ref-type="bibr">Ye <italic>et al.</italic>, 2012</xref>). ssGeneFinder utilizes the BLAST method to find DNA sequences which are unique to a given dataset (<xref rid="btx526-B2" ref-type="bibr">Camacho <italic>et al.</italic>, 2009</xref>). Primer3 provides a tool for predicting suitable PCR primers for a given DNA sequence. PrimerBLAST expands the usefulness of Primer3 by also allowing for exclusion of primers matching a given database.</p>
    <p>Combining these tools provides a possibility to find PCR primer candidates, but the process is not optimal and requires several manual steps to achieve relevant primer candidates. In addition, the ssGeneFinder tool is very specific and will thus miss small unique sequences, like single nucleotide polymorphisms (SNPs) or small insert/deletion.</p>
    <p>We have not been able to find any tools that predict if a PCR reaction will lead to problems with unspecific priming, and which work directly on draft genomes. This means that it is often necessary to employ an iterative process with different primer pairs in the lab before a suitable pair is found. The closest tool we could find was FastPCR, but we were not able to make this tool work with draft genomes (<xref rid="btx526-B5" ref-type="bibr">Kalendar <italic>et al.</italic>, 2017</xref>).</p>
    <p>Here we present two novel methods to ease the burden of PCR primer design. The first method (Method 1) is a fast and sensitive method for identifying unique core sequences for a given dataset of positive and negative genomes. The second method (Method 2) combines the primer pair prediction of Primer3, with a novel <italic>in silico</italic> PCR product validation method, which predicts amplicons for PCR primer pairs against a positive and a negative set of references. The results of Primer3 and the PCR validation are then used to sort the pairs according to their PCR performance.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Datasets and samples</title>
      <p>Two separate studies were undertaken to test the methods described in this manuscript and compare them to existing methods.</p>
      <p>The dataset described by Ho <italic>et al.</italic> in relation to validating the ssGeneFinder software (<xref rid="btx526-B4" ref-type="bibr">Ho <italic>et al.</italic>, 2012</xref>) was used for comparing Method 1 to ssGeneFinder. This dataset contained 9 <italic>Escherichia coli</italic> draft genomes in the positive dataset, and 94 <italic>Escherichia coli</italic>, one <italic>Escherichia albertii</italic>, one <italic>Escherichia fergusonii</italic>, ten <italic>Shigella</italic> and 39 <italic>Salmonella enterica</italic> draft genomes in the negative dataset.</p>
      <p>The second study was an <italic>in vitro</italic> laboratory PCR validation of three primer pairs predicted by combining Method 1 and Method 2 on a separate dataset.</p>
      <p>The dataset used for study two consisted of 25 <italic>Escherichia coli</italic> (<italic>EC</italic>) samples, which had also previously been subjected to whole genome sequencing: six previously published <italic>EC</italic> samples containing the <italic>mcr-1</italic> gene conferring transferable colistin resistance (<xref rid="btx526-B3" ref-type="bibr">Hasman <italic>et al.</italic>, 2015</xref>) and 19 previously published <italic>EC</italic> samples lacking <italic>mcr-1</italic> gene (<xref rid="btx526-B7" ref-type="bibr">Roer <italic>et al.</italic>, 2017</xref>). In addition, three <italic>EC</italic> samples, which were not included in the dataset, were included in the PCR evaluation. One sample with the <italic>mcr-1</italic> gene was added as a positive control, one sample without the <italic>mcr-1</italic> gene was added as a negative control (<xref rid="btx526-B7" ref-type="bibr">Roer <italic>et al.</italic>, 2017</xref>), and one sample with the <italic>mcr-2</italic> gene, which has 76.7% nucleotide identity to <italic>mcr-1</italic> (<xref rid="btx526-B9" ref-type="bibr">Xavier <italic>et al.</italic>, 2016</xref>), was added as a negative control for the specificity of the method.</p>
    </sec>
    <sec>
      <title>2.2 Method 1: Identification of unique core sequences</title>
      <p>The first method performs the task of identifying sequences unique to the given dataset. <xref ref-type="fig" rid="btx526-F1">Figure 1</xref> illustrates the workflow of the first part.
</p>
      <fig id="btx526-F1" orientation="portrait" position="float">
        <label>Fig. 1</label>
        <caption>
          <p>Flowchart depicting the process of Method 1. The three blue parallelogram boxes in the top indicate user input, the two green parallelogram boxes in the bottom indicate output, and the red dashed arrow indicates that the reference can be automatically chosen among the positive genomes. The method is based on a k-mer approach (converting DNA sequences to overlapping oligo nucleotide of length k). This approach is very fast and very accurate, but it leaves one with a result in the unfriendly k-mer space which is not that useful. To solve that, the k-mers are combined to form longer sequences. First, the k-mers are aligned to the reference. Second, the aligned k-mer sequences are used to build a scaffold matrix. Last, a consensus sequence is inferred from the scaffold matrix (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p>
        </caption>
        <graphic xlink:href="btx526f1"/>
      </fig>
      <p>The method takes two inputs, a set of genomes containing some common genetic feature (referred to as the positive dataset), and a set of genomes that does not contain this genetic feature (referred to as the negative dataset). The genomes provided can be either draft genomes or closed genomes, and the format must be FASTA. To convert the raw sequencing reads to draft genomes, we recommend using a good assembler. The better the quality of the assemblies, the better the results from this method.</p>
      <p>The method also has the option of selecting a reference genome, this genome is used solely to map the k-mer, and as such it should be part of the positive set of genomes. The default reference is the first of the positive genomes, but for the best results, we recommend using the best assembled positive genome as the reference.</p>
      <sec>
        <title><italic>2.2.1</italic> Extraction of k-mers</title>
        <p>A k-mer is an oligonucleotide consisting of k bases. A k-mer extraction refers to the extraction of all overlapping and non-overlapping k-mers for a given sequence. The default k-mer size is 20, which was found to give a good balance between specificity and sensitivity. If the k-mer size is too short, too many k-mers will be present in the negative dataset, and if the k-mer size is too long, then the positive dataset will have too few k-mers in common. Both the k-mers on the forward and the reverse strand are used.</p>
      </sec>
      <sec>
        <title><italic>2.2.2</italic> Finding intersecting k-mers</title>
        <p>The k-mers across all the positive samples are compared, and only those common to all will be kept as the positive core k-mers.</p>
      </sec>
      <sec>
        <title><italic>2.2.3</italic> Aligning k-mers to the reference</title>
        <p>The k-mers are mapped to the reference genome through BWA alignment (<xref rid="btx526-B6" ref-type="bibr">Li and Durbin, 2009</xref>). Only the forward strand of the reference and only perfect matches are considered, and since all k-mers are present in the reference, either the k-mer or its reverse complement is bound to be present.</p>
      </sec>
      <sec>
        <title><italic>2.2.4</italic> Finding complementing k-mers</title>
        <p>All positive core k-mers that are found in any of the negative samples are removed from the resulting unique core k-mers.</p>
      </sec>
      <sec>
        <title><italic>2.2.5</italic> Building scaffold matrices</title>
        <p>The pre-aligned k-mers are piled up and a position-wise stack count is computed. Basically, this means that a count is logged for each position in the scaffolds, based on the number of overlapping k-mers. This count is an integer between 0 and the k-mer size, and it can later be used to estimate how likely a given position is to be unique.</p>
      </sec>
      <sec>
        <title><italic>2.2.6</italic> Extracting consensus sequences</title>
        <p>The consensus sequence for each segment of overlapping k-mers is extracted and stored as a FASTA file (referred to as contigs). Using the contigs, the method generates a scaffold FASTA file mimicking the reference, but where all bases not found in the contigs are stored as n's. In addition to the normal scaffolds, the method creates another FASTA file (referred to as dissected scaffolds), where all n-stretches longer than x bases are cut out, and the resulting fragments stored as separate dissected scaffolds. The default value of <italic>x</italic> is 1000, which fits well with the maximum length one would want in classic PCR (x is modified according to the user set max amplicon length). This dissected scaffold format is important for the utilization of the methods sensitivity, as just a single SNP in the positive core sequences causes the sequence to be split in two contigs. By providing the dissected scaffold to the Primer3 software, in the next method, the software is able to make suggestions across the contigs (<xref rid="btx526-B8" ref-type="bibr">Untergasser <italic>et al.</italic>, 2012</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Method 2: PCR <italic>in silico</italic> simulation</title>
      <p>The second method finds potential PCR primer pair candidates in the provided template sequences and simulates an <italic>in silico</italic> PCR reaction for all primer pair candidates against all samples, both positive and negative, in the dataset. When using Method 1 in combination with Method 2, the template sequences are the dissected scaffold sequences. <xref ref-type="fig" rid="btx526-F2">Figure 2</xref> illustrates the workflow of this method. Just as for Method 1, Method 2 also needs a positive and negative set of genomes in FASTA format as input.
</p>
      <fig id="btx526-F2" orientation="portrait" position="float">
        <label>Fig. 2</label>
        <caption>
          <p>Flowchart depicting the process of Method 2. As with figure 1, the three blue parallelogram boxes in the top are input and the green parallelogram box in the bottom is output. To find potential primer pairs, the well-used Primer3 software package is utilized on the template sequences. The identified primers are then aligned to all the provided genomes, and potential alignments to the genomes are stored with the primers. The primers are then ranked and sorted according to their suitability. In the end, each pair is tested for PCR products against all references, and afterwards sorted according to their PCR performance (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p>
        </caption>
        <graphic xlink:href="btx526f2"/>
      </fig>
      <sec>
        <title><italic>2.3.1</italic> Finding potential primer pairs (Primer3 software)</title>
        <p>The method starts by running the provided template sequences through the Primer3 software (via the Python package). The Primer3 software locates around 10 000 primer pair candidates for a sequence at a time. From these results, the primer sequences (and probes) are extracted to a file. The Primer3 software supports identification of hybridization probes, this option is also integrated in Method 2, so all mentions of primer pairs also imply a probe, when this option is selected.</p>
      </sec>
      <sec>
        <title><italic>2.3.2</italic> Aligning primers to the genomes</title>
        <p>All the primer and probe sequences are BLASTed against all of the positive and negative genomes with loose BLAST settings to find potential binding location (<xref rid="btx526-B2" ref-type="bibr">Camacho <italic>et al.</italic>, 2009</xref>).</p>
      </sec>
      <sec>
        <title><italic>2.3.3</italic> Filtering unlikely binding locations</title>
        <p>By leaving the BLAST settings unconstrained, improbable alignments are inevitable. To get rid of these unlikely binding location, the alignments are analyzed, graded and filtered according to the default grading scheme shown in <xref rid="btx526-T1" ref-type="table">Table 1</xref>. The filtering process happens in two steps. First filtering step compares the sequence similarity of the alignment, and all matches with less than 60% similarity get the grade 0 and are excluded from filtering step 2. After this first filtering step, all the alignments undergo a hetero dimer thermodynamic analysis using the Primer3 software. A melting temperature (<italic>T</italic><sub>m</sub>) prediction above 0 °C gets grade 1, a <italic>T</italic><sub>m</sub> prediction above 47 °C gets grade 2, a <italic>T</italic><sub>m</sub> prediction within 5 °C of the target temperature gets grade 3 and a <italic>T</italic><sub>m</sub> prediction within 1 °C of the target temperature gets grade 4. All alignments below the default threshold grade (2) are considered unlikely binding locations, and are removed from the alignments.
<table-wrap id="btx526-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Hetero dimer melting temperature (<italic>T</italic><sub>m</sub>) grading scheme</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Grade</th><th rowspan="1" colspan="1">Description</th><th align="left" rowspan="1" colspan="1">Rule</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">No priming</td><td rowspan="1" colspan="1">Alignment similarity &lt; 0.6 or <italic>T</italic><sub>m</sub> &lt; = 0 °C</td></tr><tr><td rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">Unlikely priming</td><td rowspan="1" colspan="1">Alignment similarity &gt; 0.6 and <italic>T</italic><sub>m</sub> &lt; 47 °C</td></tr><tr><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">Potential priming</td><td rowspan="1" colspan="1"><italic>T</italic><sub>m</sub> &gt; 47 °C</td></tr><tr><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">Probable priming</td><td rowspan="1" colspan="1"><italic>T</italic><sub>m</sub> = 60 °C ± 5 °C</td></tr><tr><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">Definite priming</td><td rowspan="1" colspan="1"><italic>T</italic><sub>m</sub> = 60 °C ± 1 °C</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p><italic>Note</italic>: The 60 °C is the default annealing temperature. These threshold values can be modified in the settings file.</p></fn></table-wrap-foot></table-wrap></p>
      </sec>
      <sec>
        <title><italic>2.3.4</italic> Identification of probable PCR products</title>
        <p>With the primers' priming potential computed, each pair is analyzed with regards to the PCR products produced for each genome in the datasets.</p>
      </sec>
      <sec>
        <title><italic>2.3.5</italic> Identification of best primer pairs</title>
        <p>The primer pairs are ranked according to their suitability. A perfect pair will only produce the target product size (or produce an amplicon with a binding probe sequence for qPCR) for all the positive samples, and no product can be present in any of the negative samples. The further away from perfect, the worse the ranking. The top picks are presented first.</p>
        <p>To help the user select the best pair(s), the second method will perform a BLASTx search against the RefSeq protein database to annotate the resulting amplicons of the pairs with useful information (<xref rid="btx526-B1" ref-type="bibr">Agarwala <italic>et al.</italic>, 2016</xref>; <xref rid="btx526-B2" ref-type="bibr">Camacho <italic>et al.</italic>, 2009</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 The tool</title>
      <p>The tool containing the two methods presented in this manuscript has been dubbed <bold>R</bold>apid identification of PCR primers for <bold>U</bold>nique <bold>C</bold>ore <bold>S</bold>equences (RUCS). The source code for RUCS is freely available. The tool was implemented in Python, and has several dependencies such as BLAST and BWA. To make the tool easy to install, the tool has been installed in a Docker container, and the image can be found at Docker Hub.</p>
      <p>To make the use of the tool even more convenient, an online webserver has been set up to run the service. However, due to server constraints, the webserver is limited as to how many genomes and template sequences that can be processed per submission.</p>
      <p>The RUCS API provides six different entry points, which are all available from the web service:
<list list-type="order"><list-item><p>Combine the two methods described in this manuscript for a full run to design PCR primer pairs for the unique cores sequences of a positive dataset versus a negative dataset (Method 1 + Method 2).</p></list-item><list-item><p>Find sequences which are unique to a dataset of positive samples compared to a dataset of negative samples (Method 1).</p></list-item><list-item><p>Identify PCR primer pairs for a given set of sequences (Method 2).</p></list-item><list-item><p>Run PCR <italic>in silico</italic>, for a given set of primer pairs against a given set of references (Method 2 without primer design and sorting).</p></list-item><list-item><p>Annotate a given set of sequences for protein annotations from the NCBI RefSeq database (BLAST).</p></list-item><list-item><p>Show PCR statistics for a given primer set to a given template (Primer3).</p></list-item></list>The parentheses next to each entry point describe which method or third party software is responsible for the results.</p>
      <p>For each run, a statistics log is generated containing information such as: processing time for each part of the program, sequence analysis details, Primer3 scanning details, primer binding prediction analysis details and PCR product analysis details.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>To test and validate the two methods presented in this manuscript, two separate studies were conducted.</p>
    <sec>
      <title>3.1 Summary of Study 1: comparison to ssGeneFinder</title>
      <p>This first study, which compared Method 1 to ssGeneFinder, showed that Method 1 was able to identify 6.5–20 times more unique sequence data and 2.4 times more eligible primer binding sites compared to ssGeneFinder, with only a marginal increase in compute time (∼38%). For the full study, see <xref ref-type="supplementary-material" rid="sup1">Supplementary File S1</xref>.</p>
    </sec>
    <sec>
      <title>3.2 Summary of Study 2: PCR validation</title>
      <p>The second study was an <italic>in vitro</italic> laboratory PCR validation of three primer pairs predicted by combining Method 1 and Method 2 on an <italic>EC</italic> dataset where the positive genomes were known to contain the <italic>mcr-1</italic> gene.</p>
      <p>Running the dataset of 6 <italic>EC</italic> samples containing the <italic>mcr-1</italic> gene and 19 <italic>EC</italic> samples known not to have the mcr-1 gene through Method 1 produced a single dissected scaffold above the threshold of 300 bp and containing the <italic>mcr-1</italic> gene. Running this dissected scaffold through Method 2 produced 9986 eligible PCR primer pair candidates of which we randomly chose three pairs for further <italic>in vitro</italic> PCR validation (<xref rid="btx526-T2" ref-type="table">Table 2</xref>).
<table-wrap id="btx526-T2" orientation="portrait" position="float"><label>Table 2.</label><caption><p>List of the three PCR Primer Pairs chosen for <italic>in vitro</italic> PCR validation</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Name</th><th rowspan="1" colspan="1">Amplicon size</th><th rowspan="1" colspan="1">Forward primer</th><th rowspan="1" colspan="1">Reverse primer</th></tr></thead><tbody><tr><td rowspan="1" colspan="1"> 1-mcr1</td><td rowspan="1" colspan="1">408</td><td rowspan="1" colspan="1">5′- ATTATCCGACTTGGGGCAAGG -3′</td><td rowspan="1" colspan="1">5′- CGCACGATGTGACATTGCTAA -3′</td></tr><tr><td rowspan="1" colspan="1"> 2-mcr-1</td><td rowspan="1" colspan="1">382</td><td rowspan="1" colspan="1">5′- ACGCCAGTGTGTGAAGGTAAT -3′</td><td rowspan="1" colspan="1">5′- CGGTGCGGTCTTTGACTTTG -3′</td></tr><tr><td rowspan="1" colspan="1"> 3-mcr-1</td><td rowspan="1" colspan="1">306</td><td rowspan="1" colspan="1">5′- CTGACACTTATGGCACGGTCT -3′</td><td rowspan="1" colspan="1">5′- TCGGATTGACATAGCTACGCA -3′</td></tr></tbody></table><table-wrap-foot><fn id="tblfn2"><p><italic>Note</italic>: Size is provided in bases.</p></fn></table-wrap-foot></table-wrap></p>
      <p>For the <italic>in vitro</italic> PCR validation experiment, we added three additional <italic>EC</italic> samples, one extra <italic>mcr-1</italic> positive strain, one extra <italic>mcr-1</italic> negative strain and one strain carrying the <italic>mcr-2</italic> gene. The 28 <italic>EC</italic> samples were then combined with all combinations of the PCR primer pairs, giving a total of 84 PCR reactions.</p>
      <p>The results of the 84 PCR reactions showed that the output from running a combination of Method 1 and Method 2 on dataset 2 is able to predict useful PCR primer pairs. In this case, all three primer pairs were able to identify all strains containing the <italic>mcr-1</italic> gene, while they did not produce any visible PCR amplification from the <italic>mcr-1</italic> negative strains or from the strain carrying <italic>mcr-2</italic> gene. See <xref ref-type="supplementary-material" rid="sup1">Supplementary File S2</xref> for more details.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussions</title>
    <p>Here we present a sensitive and specific method for finding primers that target regions uniquely shared among all samples in a positive genome dataset but not found in any samples from a negative set. It is validated both by an <italic>in silico</italic> benchmarking set and by experimental analysis. A wise selection of negative samples is imperative for avoiding primer pairs that target undesired regions. The combination of Method 1 and 2 selectively finds primer pairs, which do not produce an amplicon for any of the negative samples included in the training data. This, however, does not ensure that the identified pairs will not bind to negative samples excluded from the training data.</p>
    <p>As the ssGeneFinder tool utilizes BLAST to identify similar DNA targets, it is better suited for finding targets with some degree of sequence variation among the positive samples, whereas Method 1 is more stringent and only reports exact sequence matches. Also for Method 1, those sequence matches need to be present in all the positive samples, whereas ssGeneFinder allows for a fraction of the samples not to have the target. Even though we showed that Method 1 is more sensitive than ssGeneFinder, the opposite might also be true in some cases. Thus, it is important to know what one is looking for, before choosing any single method.</p>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>Here we presented two novel methods which can be combined to create a tool for identifying highly specific PCR primer pairs that bind uniquely to a positive dataset, and the tool does not make any PCR product for the negative dataset. We have compared Method 1 to a similar tool called ssGeneFinder and found that Method 1 is more sensitive and finds more potential binding sites for uniquely binding PCR primer pairs. We have also validated three of the predicted primer pairs <italic>in vitro</italic> using classic PCR. The PCR validation showed that all three primer pairs were able to identify the presence of the <italic>mcr-1</italic> colistin resistance gene.</p>
    <p>The software source code is publicly available online at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/genomicepidemiology/rucs">https://bitbucket.org/genomicepidemiology/rucs</ext-link>. In addition, a pre-installed Docker image, for easy installation across all platforms, can be found at <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/genomicepidemiology/rucs/">https://hub.docker.com/r/genomicepidemiology/rucs/</ext-link>, and a web service implementing a limited version of the software can be found at <ext-link ext-link-type="uri" xlink:href="https://cge.cbs.dtu.dk/services/RUCS">https://cge.cbs.dtu.dk/services/RUCS</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx526_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgement</title>
    <p>The authors wish to acknowledge Frank Hansen for excellent technical help in relation to the laboratory work.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Danish Ministry of Health and Prevention as part of The Integrated Surveillance of ESBL/AmpC producing <italic>E.coli</italic> and Carbapenemase Producing Bacteria; by the Danish Council for Strategic Research (grant 09-067103) to the Center for Genomic Epidemiology (<ext-link ext-link-type="uri" xlink:href="http://www.genomicepidemiology.org">www.genomicepidemiology.org</ext-link>); by the European Union’s Horizon 2020 research and innovation programme under grant agreement no 643476 to the COMPARE project (<ext-link ext-link-type="uri" xlink:href="http://www.compare-europe.eu">www.compare-europe.eu</ext-link>); and by the EU FP7 programme (grant number 613754, Effort against antimicrobial resistance, <ext-link ext-link-type="uri" xlink:href="http://www.effort-against-amr.eu/">http://www.effort-against-amr.eu/</ext-link>).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btx526-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Agarwala</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Database resources of the National Center for Biotechnology Information</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>D7</fpage>–<lpage>D19</lpage>.<pub-id pub-id-type="pmid">26615191</pub-id></mixed-citation>
    </ref>
    <ref id="btx526-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Camacho</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>BLAST plus: architecture and applications</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>, <fpage>421.</fpage><pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="btx526-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hasman</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Detection of mcr-1 encoding plasmid-mediated colistin-resistant escherichia coli isolates from human bloodstream infection and imported chicken meat, denmark 2015</article-title>. <source>Eurosurveillance</source>, <volume>20</volume>, <fpage>1</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">26132766</pub-id></mixed-citation>
    </ref>
    <ref id="btx526-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ho</surname><given-names>C.C.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Automated pangenomic analysis in target selection for PCR detection and identification of bacteria by use of ssGenefinder Webserver and its application to Salmonella enterica serovar typhi</article-title>. <source>J. Clin. Microbiol</source>., <volume>50</volume>, <fpage>1905</fpage>–<lpage>1911</lpage>.<pub-id pub-id-type="pmid">22442318</pub-id></mixed-citation>
    </ref>
    <ref id="btx526-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kalendar</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>FastPCR: An in silico tool for fast primer and probe design and advanced sequence analysis</article-title>. <source>Genomics</source>, <volume>109</volume>, <fpage>312</fpage>–<lpage>319</lpage>.<pub-id pub-id-type="pmid">28502701</pub-id></mixed-citation>
    </ref>
    <ref id="btx526-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R.</given-names></name></person-group> (<year>2009</year>) 
<article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="btx526-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roer</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>WGS-based surveillance of third-generation cephalosporin-resistant Escherichia coli from bloodstream infections in Denmark</article-title>. <source>J. Antimicrob. Chemother</source>., <fpage>1</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">27659735</pub-id></mixed-citation>
    </ref>
    <ref id="btx526-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Untergasser</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Primer3-new capabilities and interfaces</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">21908400</pub-id></mixed-citation>
    </ref>
    <ref id="btx526-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xavier</surname><given-names>B.B.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Identification of a novel plasmid-mediated colistinresistance gene, mcr-2, in Escherichia coli, Belgium, june 2016</article-title>. <source>Eurosurveillance</source>, <volume>21</volume>, <fpage>6</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">26876980</pub-id></mixed-citation>
    </ref>
    <ref id="btx526-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ye</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Primer-BLAST: A tool to design target-specific primers for polymerase chain reaction</article-title>. <source>BMC Bioinformatics</source>, <volume>13</volume>, <fpage>134.</fpage><pub-id pub-id-type="pmid">22708584</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
