<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput. Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7310859</article-id>
    <article-id pub-id-type="pmid">32469863</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-01493</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007843</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Heredity</subject>
            <subj-group>
              <subject>Genetic Mapping</subject>
              <subj-group>
                <subject>Haplotypes</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Departures from Diploidy</subject>
            <subj-group>
              <subject>Polyploidy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genomic Libraries</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genomic Libraries</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Heredity</subject>
            <subj-group>
              <subject>Heterozygosity</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Population Genetics</subject>
            <subj-group>
              <subject>Ploidy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Population Genetics</subject>
            <subj-group>
              <subject>Ploidy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Population Biology</subject>
          <subj-group>
            <subject>Population Genetics</subject>
            <subj-group>
              <subject>Ploidy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Sequence Assembly Tools</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Sequence Assembly Tools</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Ranbow: A fast and accurate method for polyploid haplotype reconstruction</article-title>
      <alt-title alt-title-type="running-head">Polyploid haplotype reconstruction</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6787-3047</contrib-id>
        <name>
          <surname>Moeinzadeh</surname>
          <given-names>M-Hossein</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0371-8814</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Jun</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Muzychenko</surname>
          <given-names>Evgeny</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6806-7226</contrib-id>
        <name>
          <surname>Gallone</surname>
          <given-names>Giuseppe</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-8346-9565</contrib-id>
        <name>
          <surname>Heller</surname>
          <given-names>David</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3078-8129</contrib-id>
        <name>
          <surname>Reinert</surname>
          <given-names>Knut</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Haas</surname>
          <given-names>Stefan</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1765-4241</contrib-id>
        <name>
          <surname>Vingron</surname>
          <given-names>Martin</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Max Planck Institute for Molecular Genetics, Berlin, Germany</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Department of Mathematics and Computer Science, Freie Universitat Berlin, Berlin, Germany</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Shanghai Chenshan Plant Science Research Center, Chinese Academy of Sciences, Shanghai Chenshan Botanical Garden, Shanghai, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schönhuth</surname>
          <given-names>Alexander</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Centrum Wiskunde &amp; Informatica, NETHERLANDS</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>moeinzad@molgen.mpg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>5</issue>
    <elocation-id>e1007843</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>4</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Moeinzadeh et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Moeinzadeh et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007843.pdf"/>
    <abstract>
      <p>Reconstructing haplotypes from sequencing data is one of the major challenges in genetics. Haplotypes play a crucial role in many analyses, including genome-wide association studies and population genetics. Haplotype reconstruction becomes more difficult for higher numbers of homologous chromosomes, as it is often the case for polyploid plants. This complexity is compounded further by higher heterozygosity, which denotes the frequent presence of variants between haplotypes. We have designed <bold><italic>Ranbow</italic></bold>, a new tool for haplotype reconstruction of polyploid genome from short read sequencing data. <bold><italic>Ranbow</italic></bold> integrates all types of small variants in bi- and multi-allelic sites to reconstruct haplotypes. To evaluate <bold><italic>Ranbow</italic></bold> and currently available competing methods on real data, we have created and released a real gold standard dataset from sweet potato sequencing data. Our evaluations on real and simulated data clearly show <bold><italic>Ranbow</italic></bold>’s superior performance in terms of accuracy, haplotype length, memory usage, and running time. Specifically, <bold><italic>Ranbow</italic></bold> is one order of magnitude faster than the next best method. The efficiency and accuracy of <bold><italic>Ranbow</italic></bold> makes whole genome haplotype reconstruction of complex genome with higher ploidy feasible.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>We focus on the problem of reconstructing haplotypes for polyploid genomes. Our approach explored using short read sequence data from a highly heterozygous hexaploid genome. We observed that short read data from strongly heterozygous organisms open up a way for haplotype reconstruction by supplying overlap information between reads. We therefore investigated the role of heterozygosity and ploidy number. Though higher heterozygosity provides more useful reads for reconstructing haplotypes, polyploidy increases the challenge in assembling reads into longer sequences. We called this the problem of “Ambiguity of Merging” fragments. We addressed this problem by designing a new algorithm called <bold><italic>Ranbow</italic></bold>. <bold><italic>Ranbow</italic></bold> was evaluated on real and simulated data from the genomes of tetraploid <italic>Capsella bursa-pastoris</italic> (Shepherd’s Purse) and hexaploid <italic>Ipomoea batatas</italic> (sweet potato). We were able to show that our method achieved high accuracy and long assembled haplotypes in a feasible amount of time, performing at a level consistently superior to other algorithms.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>National Key R&amp;D Program of China</institution>
        </funding-source>
        <award-id>2018YFD1000700-2018YFD1000701-4</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0371-8814</contrib-id>
          <name>
            <surname>Yang</surname>
            <given-names>Jun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution>Shanghai Municipal Afforestation &amp; City Appearance and Environmental Sanitation Administration</institution>
        </funding-source>
        <award-id>G182402, G192413 and G192414</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0371-8814</contrib-id>
          <name>
            <surname>Yang</surname>
            <given-names>Jun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100004739</institution-id>
            <institution>Youth Innovation Promotion Association of the Chinese Academy of Sciences</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0371-8814</contrib-id>
          <name>
            <surname>Yang</surname>
            <given-names>Jun</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution> IMPRS-CBSC</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6787-3047</contrib-id>
          <name>
            <surname>Moeinzadeh</surname>
            <given-names>M-Hossein</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>M-HM acknowledges support from IMPRS-CBSC doctoral programme. JY acknowledges funding support by National Key R&amp;D Program of China (2018YFD1000700-2018YFD1000701-4), Shanghai Municipal Afforestation &amp; City Appearance and Environmental Sanitation Administration (G182402, G192413, and G192414), and Youth Innovation Promotion Association CAS. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="3"/>
      <page-count count="23"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2020-06-23</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The authors confirm that all data underlying the findings are fully available without restriction. Ranbow is made freely available under a GNU licence. It can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.molgen.mpg.de/ranbow">http://www.molgen.mpg.de/ranbow</ext-link> or <ext-link ext-link-type="uri" xlink:href="https://github.com/moeinzadeh/Ranbow.git">https://github.com/moeinzadeh/Ranbow.git</ext-link>. The tool we developed for evaluation of competing methods can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/moeinzadeh/PolyHapSim.git">https://github.com/moeinzadeh/PolyHapSim.git</ext-link>. Full dataset can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://owww.molgen.mpg.de/~ranbow/454_all_scfs.frags.bz2">https://owww.molgen.mpg.de/~ranbow/454_all_scfs.frags.bz2</ext-link> or <ext-link ext-link-type="uri" xlink:href="https://owww.molgen.mpg.de/~ranbow/all_scfs.frags.bz2">https://owww.molgen.mpg.de/~ranbow/all_scfs.frags.bz2</ext-link>. Selected dataset can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://owww.molgen.mpg.de/~ranbow/454_selected_scfs.frags.bz2">https://owww.molgen.mpg.de/~ranbow/454_selected_scfs.frags.bz2</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://owww.molgen.mpg.de/~ranbow/selected_scfs.frags.bz2">https://owww.molgen.mpg.de/~ranbow/selected_scfs.frags.bz2</ext-link>, or <ext-link ext-link-type="uri" xlink:href="https://owww.molgen.mpg.de/~ranbow/selected_scfs.genotypes.bz2">https://owww.molgen.mpg.de/~ranbow/selected_scfs.genotypes.bz2</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The authors confirm that all data underlying the findings are fully available without restriction. Ranbow is made freely available under a GNU licence. It can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.molgen.mpg.de/ranbow">http://www.molgen.mpg.de/ranbow</ext-link> or <ext-link ext-link-type="uri" xlink:href="https://github.com/moeinzadeh/Ranbow.git">https://github.com/moeinzadeh/Ranbow.git</ext-link>. The tool we developed for evaluation of competing methods can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/moeinzadeh/PolyHapSim.git">https://github.com/moeinzadeh/PolyHapSim.git</ext-link>. Full dataset can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://owww.molgen.mpg.de/~ranbow/454_all_scfs.frags.bz2">https://owww.molgen.mpg.de/~ranbow/454_all_scfs.frags.bz2</ext-link> or <ext-link ext-link-type="uri" xlink:href="https://owww.molgen.mpg.de/~ranbow/all_scfs.frags.bz2">https://owww.molgen.mpg.de/~ranbow/all_scfs.frags.bz2</ext-link>. Selected dataset can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://owww.molgen.mpg.de/~ranbow/454_selected_scfs.frags.bz2">https://owww.molgen.mpg.de/~ranbow/454_selected_scfs.frags.bz2</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://owww.molgen.mpg.de/~ranbow/selected_scfs.frags.bz2">https://owww.molgen.mpg.de/~ranbow/selected_scfs.frags.bz2</ext-link>, or <ext-link ext-link-type="uri" xlink:href="https://owww.molgen.mpg.de/~ranbow/selected_scfs.genotypes.bz2">https://owww.molgen.mpg.de/~ranbow/selected_scfs.genotypes.bz2</ext-link>.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The rapid advances in sequencing technologies and assembly tools have enabled the assembly of reference genomes from multiple organims [<xref rid="pcbi.1007843.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1007843.ref003" ref-type="bibr">3</xref>]. Though useful, such reference sequences do not reflect the complex wealth of information in each chromosome entity. Homologous chromosomes are similar, but not identical, and differ in sets of variants. It is therefore clear that these reference sequences are a consensus of homologous chromosomes and are only estimates of them. Single chromosomes are the main components of inheritance. The majority of chromosomal regulatory interactions are derived within chromosomes [<xref rid="pcbi.1007843.ref004" ref-type="bibr">4</xref>]. Knowing the sequence of single chromosomes provides us with a better view of the genome. The sequence of variants on a single copy of a chromosome is called a <italic>haplotype</italic> [<xref rid="pcbi.1007843.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1007843.ref006" ref-type="bibr">6</xref>]. Haplotyping plays an important role in a multitude of biological analysis, such as genome-wide association studies and imputation [<xref rid="pcbi.1007843.ref007" ref-type="bibr">7</xref>–<xref rid="pcbi.1007843.ref009" ref-type="bibr">9</xref>], population genetics studies [<xref rid="pcbi.1007843.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1007843.ref011" ref-type="bibr">11</xref>], genome regulation [<xref rid="pcbi.1007843.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1007843.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1007843.ref013" ref-type="bibr">13</xref>], and genotype error detection [<xref rid="pcbi.1007843.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1007843.ref015" ref-type="bibr">15</xref>].</p>
    <p>Current computational methods of haplotype detection for diploid and polyploid genomes use a wide range of data produced by different technologies. ‘Polyploidy’ is a characteristic of genomes with more than two sets of homologous chromosomes. Human, potato, bread wheat, and strawberry have two, four [<xref rid="pcbi.1007843.ref016" ref-type="bibr">16</xref>], six [<xref rid="pcbi.1007843.ref017" ref-type="bibr">17</xref>], and eight [<xref rid="pcbi.1007843.ref018" ref-type="bibr">18</xref>] sets of homologous chromosomes, respectively. One further distinguishes allopolyploidy, where two species hybridize and contribute chromosome sets, and autopolyploidy, where the chromosomes are derived from a single species. In this work we do not make any assumption on the origin of the chromosomes.</p>
    <p>Approaches to haplotype detection include haplotype inference from SNP array technologies and population data [<xref rid="pcbi.1007843.ref019" ref-type="bibr">19</xref>, <xref rid="pcbi.1007843.ref020" ref-type="bibr">20</xref>], trio-based haplotyping [<xref rid="pcbi.1007843.ref021" ref-type="bibr">21</xref>], <italic>de novo</italic> assembly based haplotype reconstruction [<xref rid="pcbi.1007843.ref022" ref-type="bibr">22</xref>–<xref rid="pcbi.1007843.ref024" ref-type="bibr">24</xref>], and reference based haplotype reconstruction from sequencing data [<xref rid="pcbi.1007843.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1007843.ref025" ref-type="bibr">25</xref>–<xref rid="pcbi.1007843.ref029" ref-type="bibr">29</xref>]. The latter assumes that reference sequence, aligned reads, and called variants are available as input to construct haplotypes. This is the problem formulation we adopt in our work, focusing on read-based single individual haplotype reconstruction of polyploid genomes.</p>
    <p>Multiple combinatorial optimization models aim to address the haplotype reconstruction problem [<xref rid="pcbi.1007843.ref006" ref-type="bibr">6</xref>]. This includes minimum error correction (MEC) [<xref rid="pcbi.1007843.ref030" ref-type="bibr">30</xref>], minimum fragment removal (MFR) [<xref rid="pcbi.1007843.ref031" ref-type="bibr">31</xref>], minimum SNP removal (MSR) [<xref rid="pcbi.1007843.ref031" ref-type="bibr">31</xref>], minimum fragment cut (MFC) [<xref rid="pcbi.1007843.ref032" ref-type="bibr">32</xref>], and balanced optimal partition (BOP) [<xref rid="pcbi.1007843.ref033" ref-type="bibr">33</xref>]. The tools within these models search for a solution, <italic>i.e</italic>. a set of haplotypes, with the highest fitness score of the model. The MEC model, for example, minimizes the disagreement between reconstructed haplotypes and their constitutive reads. Because most of these models are proven NP-Hard [<xref rid="pcbi.1007843.ref032" ref-type="bibr">32</xref>, <xref rid="pcbi.1007843.ref034" ref-type="bibr">34</xref>], heuristic algorithms have been proposed [<xref rid="pcbi.1007843.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1007843.ref025" ref-type="bibr">25</xref>, <xref rid="pcbi.1007843.ref026" ref-type="bibr">26</xref>]. Though existing models target diploid haplotyping, a few of them can be generalized for polyploid contexts [<xref rid="pcbi.1007843.ref028" ref-type="bibr">28</xref>, <xref rid="pcbi.1007843.ref029" ref-type="bibr">29</xref>].</p>
    <p>Diploid and polyploid haplotyping differ in problem complexity. Because the haplotypes in a diploid haplotype are complementary, obtaining one haplotype is sufficient [<xref rid="pcbi.1007843.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1007843.ref025" ref-type="bibr">25</xref>]. In contrast, all haplotypes in polyploid genomes must be computed in order to obtain the complete picture of all homologous chromosomes [<xref rid="pcbi.1007843.ref026" ref-type="bibr">26</xref>, <xref rid="pcbi.1007843.ref027" ref-type="bibr">27</xref>]. The step from diploid to polyploid inflates the search space dramatically [<xref rid="pcbi.1007843.ref028" ref-type="bibr">28</xref>]. The presence of a larger number of homologous chromosomes also leads to the quantitative observation of individual variants. This is called dosage information, which describes the frequencies of variants in a polymorphic site [<xref rid="pcbi.1007843.ref035" ref-type="bibr">35</xref>]. Errors in dosage information provided as input may also influence the haplotype reconstruction step. Existing programs either expect this information as input or need to determine it.</p>
    <p>Moreover, cross-fertilizing or clonally propagated polyploid genomes have been shown to have high heterozygosity [<xref rid="pcbi.1007843.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1007843.ref035" ref-type="bibr">35</xref>], meaning that a higher number of variants has to be haplotyped. This is complicated further as the increasing ploidy of an organism causes more information to be pushed into the reference sequence, resulting in lower identity between the reference sequence and either of the chromosomes [<xref rid="pcbi.1007843.ref014" ref-type="bibr">14</xref>]. This introduces higher error rates in the pre-haplotype reconstruction steps of variant calling and mapping.</p>
    <p>Despite these challenges, higher heterozygosity helps to connect more variants from sequence fragments of a certain read size in polyploid genomes. The intervals between variant positions will be shorter, in turn leading to a higher chance of observing two or more variants covered by a read. Only reads covering two or more variants are useful for haplotyping. For instance, the sweet potato genome has an average variant interval length of 58bp [<xref rid="pcbi.1007843.ref014" ref-type="bibr">14</xref>]; for this genome we have observed that paired-end Illumina whole genome sequencing (2 × 100bp) provides ∼49% useful reads with two or more variants. The same sequencing platform captures about 1% useful reads for an average interval length of ∼1000bp in human (NA12878), meaning that the proportion of useful reads is dramatically higher for the polyploid sweet potato. These characteristics motivate the design of computational tools that use short read sequences for haplotype reconstruction of polyploid genomes with high heterozygosity.</p>
    <p>A handful of methods address polyploid haplotype reconstruction. <bold><italic>HapCompass</italic></bold> [<xref rid="pcbi.1007843.ref027" ref-type="bibr">27</xref>] constructs a compass graph, which is a specific type of variant graph, from variants and reads and minimizes the conflicts between reads by finding a spanning tree of the graph. <bold><italic>HapTree</italic></bold> [<xref rid="pcbi.1007843.ref026" ref-type="bibr">26</xref>] works under a probabilistic model, searching for a collection of partial solutions according to a relative likelihood function of reads and a set of candidate haplotypes. <bold><italic>SDhaP</italic></bold> [<xref rid="pcbi.1007843.ref029" ref-type="bibr">29</xref>] constructs a read-based graph where the nodes are the reads and the edges are defined by the overlaps between reads. It uses a semi-definite programming approach that aims to find an approximate solution by a greedy search in the space of all possible haplotype combinations. <bold><italic>H-PoP</italic></bold> [<xref rid="pcbi.1007843.ref028" ref-type="bibr">28</xref>] is a read-clustering based method that models haplotype reconstruction as an optimal read partitioning problem, called the Polyploid Balanced Optimal Partition(PBOP) model. Given a <italic>P</italic>-ploid genome, PBOP clusters the reads into <italic>P</italic> groups with maximized fitness. These methods fall short of capturing all characteristics of polyploid genomes and can be improved in terms of accuracy, memory usage, and running time.</p>
    <p>This paper introduces <bold><italic>Ranbow</italic></bold>, our tool for reconstructing polyploid haplotypes from short reads. We have focused on sites that vary by single-base substitution, multi-base substitutions, and small (&lt;50bp) insertions and deletions. We designed <bold><italic>Ranbow</italic></bold> to account for the following domain-specific insights: 1) an identical overlap between two aligned reads does not yield that they stem from one haplotype and may therefore not always be assembled into one haplotype segment, 2) the observed high number of multi-allelic variants must be accounted for, 3) different types of errors need to be accounted for, including errors stemming from base-calling, variant-calling, dosage information, and read-mapping. <bold><italic>Ranbow</italic></bold> exploits the dense variants within paired-end reads in highly heterozygous regions to reconstruct haplotypes for all homologous chromosomes in order to account for these domain-specific insights. It clusters the reads and assembles them into short haplotypes on the variant level while considering several error correction schemes to detect, correct, or exclude erroneous variants. <bold><italic>Ranbow</italic></bold> continues by haplotype extension of the regions via a multi-partite graph representation, followed by detection of overlaps between haplotypes and paired-end connections. Within this framework, we show that <bold><italic>Ranbow</italic></bold> efficiently and accurately constructs long haplotypes using real and simulated data.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Materials and methods</title>
    <p>This section explains the <bold><italic>Ranbow</italic></bold> design considerations, defines the haplotype reconstruction problem, presents the algorithm, and describes the generated and simulated data we used in our evaluation.</p>
    <sec id="sec003">
      <title>Method design considerations</title>
      <p>We identified the <italic>Ambiguity of Merging</italic> (<italic>AoM</italic>) fragments problem as one of the major technical challenges specific to polyploid haplotype reconstruction. In diploid genomes, haplotypes complement each other, in the sense that a variant position will allow for one of two possible variants. This ensures that any two overlapping reads with identical variants stem from the same haplotype and therefore the reads can be merged or assembled into one larger haplotype segment. In polyploid genomes the knowledge of the sequence of one haplotype does not suffice to infer the sequence of the other haplotypes. Consequently, any matching overlap between two aligned reads does not yield complete haplotype information (<xref ref-type="fig" rid="pcbi.1007843.g001">Fig 1</xref>) and the two reads cannot automatically be assembled into one haplotype segment. Therefore additional information is needed to determine if two reads stem from the same haplotype.</p>
      <fig id="pcbi.1007843.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007843.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Ambiguity of merging fragments.</title>
          <p>In a polyploid genome, merging two fragments purely through sequence comparison may result in erroneously reconstructed haplotypes. <bold>(A)</bold> A region of a hexaploid genome with four variant sites. Each color indicates one true haplotype. <bold>(B)</bold> Seq.A and Seq.B are two reads sampled from the selected pieces of the blue and purple haplotypes, respectively. These sequences each carry three variants with an overlap of two variants (<italic>C</italic>…<italic>A</italic>). Merging Seq.A and Seq.B would lead to Seq.C, which, however, is not one of the true haplotypes from <bold>(A)</bold>.</p>
        </caption>
        <graphic xlink:href="pcbi.1007843.g001"/>
      </fig>
      <p>Our tool deals with multi-allelic variants considering different types of errors. The abundance of multi-allelic variants necessitates integrating these variants in haplotype reconstruction analysis (see <italic>Data</italic> for details). Some available studies exclude multi-allelic variants for the sake of simplicity or reducing the search space. The higher heterozygosity characteristic of a polyploid genome leads to relatively low reference accuracy [<xref rid="pcbi.1007843.ref014" ref-type="bibr">14</xref>], a challenge for read mapping, variant calling, and dosage estimation [<xref rid="pcbi.1007843.ref035" ref-type="bibr">35</xref>, <xref rid="pcbi.1007843.ref036" ref-type="bibr">36</xref>]. Any error introduced in these steps will transfer to the haplotype reconstruction step. Different types of errors, e.g. base calling and mapping, require separate consideration. Conventional error models consider solely one type of error. For example, the MEC and MFR models consider only variant calling and mapping errors, respectively. It is therefore essential that our new algorithm be able to deal with several types of errors. Some of the available methods, such as <bold><italic>HapCompass</italic></bold>, require dosage information as input, which is in itself a challenging estimation problem [<xref rid="pcbi.1007843.ref037" ref-type="bibr">37</xref>].</p>
      <sec id="sec004">
        <title>Definitions and problem formulation</title>
        <p>Given a <italic>P</italic>-ploid organism, a haplotype defines the sequence of variants in one of the <italic>P</italic> homologous chromosomes. This paper focuses on sites that vary by single-base substitution, multi-base substitutions, and small (&lt;50bp) insertions and deletions; collectively referred to as <italic>Small Polymorphism</italic> (<italic>SmP</italic>). The variants are coded into numbers ranging from zero to <italic>P</italic> − 1, where 0 refers to the reference allele, 1 refers to the first alternative allele, 2 to the second one, and so on. We refer to this as haplotypes in <bold>coded allele space</bold> which is written as: <inline-formula id="pcbi.1007843.e001"><alternatives><graphic xlink:href="pcbi.1007843.e001.jpg" id="pcbi.1007843.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mtext>Coded</mml:mtext><mml:mspace width="4pt"/><mml:mtext>allele</mml:mtext><mml:mspace width="4pt"/><mml:mtext>space</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false">]</mml:mo><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo form="postfix" stretchy="false">]</mml:mo><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mn>3</mml:mn><mml:mo form="postfix" stretchy="false">]</mml:mo><mml:mo>…</mml:mo><mml:mi>a</mml:mi><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mi>N</mml:mi><mml:mo form="postfix" stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where, <italic>h</italic><sub><italic>i</italic></sub>, <italic>a</italic>[<italic>n</italic>], <italic>N</italic>, and “.” represent the haplotype in coded allele space, the coded variants, the number of polymorphic sites, and the concatenation of the sequences, respectively. Let <italic>F</italic> be the set {<italic>f</italic><sub>1</sub>, …, <italic>f</italic><sub><italic>M</italic></sub>} of all fragments. A <bold>fragment</bold>
<italic>f</italic> is the sequence of variants which are covered by an aligned read. When a read contains a variant not reported in the variant list, the position is considered as a <bold>missing allele</bold> or gap (“−”).</p>
        <p>As before [<xref rid="pcbi.1007843.ref014" ref-type="bibr">14</xref>], we defined the similarity and dissimilarity functions between fragments as:
<disp-formula id="pcbi.1007843.e002"><alternatives><graphic xlink:href="pcbi.1007843.e002.jpg" id="pcbi.1007843.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mrow/><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:mi>s</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mrow/><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mspace width="4pt"/><mml:mtext>where</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="0.277778em"/><mml:mo>&amp;</mml:mo><mml:mspace width="0.277778em"/><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mo>“</mml:mo><mml:mo>-</mml:mo><mml:mo>”</mml:mo><mml:mspace width="0.277778em"/><mml:mo>&amp;</mml:mo><mml:mspace width="0.277778em"/><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mo>“</mml:mo><mml:mo>-</mml:mo><mml:mo>”</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>O</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>d</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mspace width="0.277778em"/><mml:mo>&amp;</mml:mo><mml:mspace width="0.277778em"/><mml:msub><mml:mi>f</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mo>“</mml:mo><mml:mo>-</mml:mo><mml:mo>”</mml:mo><mml:mspace width="0.277778em"/><mml:mo>&amp;</mml:mo><mml:mspace width="0.277778em"/><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>n</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mo>“</mml:mo><mml:mo>-</mml:mo><mml:mo>”</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>O</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
<italic>s</italic>(<italic>f</italic><sub>1</sub>[<italic>n</italic>], <italic>f</italic><sub>2</sub>[<italic>n</italic>]) (<italic>d</italic>(<italic>f</italic><sub>1</sub>[<italic>n</italic>], <italic>f</italic><sub>2</sub>[<italic>n</italic>])) returns “1” if the two variants <italic>f</italic><sub>1</sub>[<italic>n</italic>] and <italic>f</italic><sub>2</sub>[<italic>n</italic>] are available and identical (different). The similarity (dissimilarity) function computes the number of polymorphic sites in which both fragments carry the same (different) variants.</p>
        <p>We defined a <bold>haplotype segment</bold>
<italic>s</italic> as a consensus obtained from a set of fragments <italic>F</italic>′ computed by the <italic>merge</italic> function as follows:
<disp-formula id="pcbi.1007843.e003"><alternatives><graphic xlink:href="pcbi.1007843.e003.jpg" id="pcbi.1007843.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>where</mml:mtext><mml:mspace width="0.277778em"/><mml:msup><mml:mi>F</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>⊂</mml:mo><mml:mi>F</mml:mi><mml:mspace width="4pt"/><mml:mtext>and</mml:mtext><mml:mspace width="4pt"/><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mspace width="4pt"/><mml:mtext>varies</mml:mtext><mml:mspace width="4pt"/><mml:mtext>over</mml:mtext><mml:mspace width="4pt"/><mml:mtext>the</mml:mtext><mml:mspace width="4pt"/><mml:mtext>possible</mml:mtext><mml:mspace width="4pt"/><mml:mtext>sequences</mml:mtext><mml:mspace width="4pt"/><mml:mtext>of</mml:mtext><mml:mspace width="4pt"/><mml:mtext>alleles.</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
We call the elements of the set <italic>F</italic>′ the <bold>supporting fragments</bold> of <italic>s</italic>.</p>
        <p>The aim of haplotype reconstruction is to assemble <italic>F</italic> or a subset of <italic>F</italic> into <italic>P</italic> haplotypes <italic>H</italic> = {<italic>h</italic><sub>1</sub>, <italic>h</italic><sub>2</sub>, <italic>h</italic><sub>3</sub>, …, <italic>h</italic><sub><italic>P</italic></sub>}. Note that haplotype reconstruction and haplotype assembly are used interchangeably. In an ideal scenario with availability of sufficient coverage and long error-free fragments, the aim of haplotype reconstruction is to merge fragments into exactly <italic>P</italic> haplotypes. In reality, sequencing errors, mapping errors, and lack of connectivity between alleles mean that haplotypes may only be partially assembled. We define the aim of haplotype reconstruction as reconstructing long haplotypes with high accuracy.</p>
      </sec>
      <sec id="sec005">
        <title>Short region haplotype reconstruction</title>
        <p>A set of aligned fragments differs in their SmP sites. We utilize these differences, or haplotype patterns, to cluster the aligned fragments. In order to cluster the fragments, we have introduced a mask to denote the positions on which to base this clustering. A <bold>mask</bold> (<italic>msk</italic>) is defined as an ordered set of indices of SmP sites, the <bold>seed sequence</bold> of a mask (<italic>t</italic><sup><italic>msk</italic></sup>) is a sequence pattern observed in an aligned fragment at the mask indices. The <bold>supporting fragments of a seed sequence</bold> (<inline-formula id="pcbi.1007843.e004"><alternatives><graphic xlink:href="pcbi.1007843.e004.jpg" id="pcbi.1007843.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msub><mml:mi>F</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:msub></mml:math></alternatives></inline-formula>) is a set of fragments which carry identical variants at the mask indices. <xref ref-type="fig" rid="pcbi.1007843.g002">Fig 2A</xref> depicts a schematic view of how we use one mask and its seed sequences to collect haplotype segments of a region. <bold><italic>Ranbow</italic></bold> searches for masks which identify a sufficiently large number of unique seed sequences. Each seed sequence clusters together a group of reads which can be merged into one haplotype segment. For instance in <xref ref-type="fig" rid="pcbi.1007843.g002">Fig 2A</xref>, seed sequence “10” groups the green fragments and merges them into the haplotype segment “1120”. <italic>p</italic> unique seed sequences of a mask (e.g, “11”, “00”, “10”) represent <italic>p</italic> unique haplotype segments (“1101”, “0010”, “1120”). This results in a <bold>haplotype block</bold>, or a <bold>block</bold>, of <italic>p</italic> haplotype segments.</p>
        <fig id="pcbi.1007843.g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007843.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>Ranbow’s main processing steps.</title>
            <p><bold>(A)</bold> depicts a schematic view of how one mask results in its haplotype segments. The seed sequences cluster the fragments according to the variants they carry. In this figure, there are three clusters; each constructs one haplotype segment. The haplotype segments are supported with four, four, and three fragments, respectively (blue, red, and green fragments). The purple fragment gets discarded because it is detected as an erroneous fragment (see text). <bold>(B)</bold> A unique matching overlap of Fragment 2 and a haplotype block in a triploid genome. Fragment 1 has two matching and one mismatching overlap. This violates the unique match overlap rule. Fragment 2 has one matching and two mismatching overlaps meaning that Fragment 2 can be merged with the first haplotype unambiguously. <bold>(C)</bold> One fragment covering four polymorphic sites contributes eleven seed sequences. The seed sequences of length two, three, and four are shown in the panel in different colors. <bold>(D)</bold> A schematic view of the multi-partite graph and desired and conflicting cycles and paths. <bold>(E)</bold> Schematic view of the steps for constructing haplotypes from desired cycles of length three. A sliding window of length four is depicted in red. Solid gray lines represent the edges starting from the leftmost block of a sliding window. The blue edges are the newly formed haplotypes. The candidate edges at each step are checked to find if they construct a triangle or not. The most supported triangle at each step is converted to one haplotype segment.</p>
          </caption>
          <graphic xlink:href="pcbi.1007843.g002"/>
        </fig>
      </sec>
      <sec id="sec006">
        <title>Haplotype reconstruction on a mask</title>
        <p>There are three possibilities for the number of seed sequences (<italic>p</italic>) observed by a mask (<italic>msk</italic><sub><italic>j</italic></sub>) in comparison with the ploidy of the organism (<italic>P</italic>):</p>
        <p><italic><bold>i</bold>) p</italic> = <italic>P</italic>: Because each seed sequence represents one haplotype segment, the fragments containing similar seed sequence stem from one haplotype. We cluster these fragments together. In other words, each cluster can be seen as the supporting fragment of one seed sequence. <bold><italic>Ranbow</italic></bold> constructs haplotype segments by merging the supporting fragments of seed sequences.
<disp-formula id="pcbi.1007843.e005"><alternatives><graphic xlink:href="pcbi.1007843.e005.jpg" id="pcbi.1007843.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
where <inline-formula id="pcbi.1007843.e006"><alternatives><graphic xlink:href="pcbi.1007843.e006.jpg" id="pcbi.1007843.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is a seed sequence, <inline-formula id="pcbi.1007843.e007"><alternatives><graphic xlink:href="pcbi.1007843.e007.jpg" id="pcbi.1007843.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msub><mml:mi>F</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:msub></mml:math></alternatives></inline-formula> is the supporting fragments set, <inline-formula id="pcbi.1007843.e008"><alternatives><graphic xlink:href="pcbi.1007843.e008.jpg" id="pcbi.1007843.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is one of the assembled haplotype segment, <inline-formula id="pcbi.1007843.e009"><alternatives><graphic xlink:href="pcbi.1007843.e009.jpg" id="pcbi.1007843.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:math></alternatives></inline-formula> is the obtained haplotype block, and the <italic>merge</italic> function is defined in <xref ref-type="disp-formula" rid="pcbi.1007843.e003">Eq 2</xref>.</p>
        <p>The fragments in the supporting fragment set of a seed sequence agree on the variants at the mask sites. Disagreement on the other indices are suggestive of errors that are corrected during the haplotype segment assembly (<xref ref-type="fig" rid="pcbi.1007843.g002">Fig 2A</xref>
<italic>red cross</italic>). At the end of this step, a mask with <italic>P</italic> unique seed sequences results in a haplotype block with <italic>P</italic> unique haplotype segments.</p>
        <p><italic><bold>ii</bold>) p</italic> &gt; <italic>P</italic> indicates one or more errors in the supporting fragment of a mask. <italic>P</italic> seed sequences are kept after an error correction step. The erroneous seed sequences are detected according to their fragment support. The smaller the number of supporting fragments, the higher the probability of this being an erroneous seed sequence (<xref ref-type="fig" rid="pcbi.1007843.g002">Fig 2A</xref>
<italic>red box</italic>). We deleted the seed sequences deemed erroneous and kept only <italic>P</italic> seed sequences.</p>
        <p><italic><bold>iii</bold>) p</italic> &lt; <italic>P</italic> indicates insufficient information for reconstructing <italic>P</italic> haplotypes of the region. This can result from the similarity of alleles in different homologous chromosomes or from errors from base calling, genome assembly, mapping, and variant calling steps. The algorithm for dealing with these regions is explained in the <italic>Phasing the regions with fewer than P haplotypes</italic> section.</p>
      </sec>
      <sec id="sec007">
        <title>Elongating haplotype segments with flanking fragments</title>
        <p>To elongate haplotypes that take into account AoM properties, we designed an iterative algorithm utilizing the <bold>unique matching overlaps</bold> of a haplotype in a block, <inline-formula id="pcbi.1007843.e010"><alternatives><graphic xlink:href="pcbi.1007843.e010.jpg" id="pcbi.1007843.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, and a neighboring overlapping fragment, <italic>f</italic><sub><italic>k</italic></sub>. <xref ref-type="fig" rid="pcbi.1007843.g002">Fig 2B</xref> illustrates a unique matching overlap for a block in a triploid genome. A unique matching overlap has the following properties: <bold><italic>i</italic></bold>) <italic>f</italic><sub><italic>k</italic></sub> shares matching overlaps with <inline-formula id="pcbi.1007843.e011"><alternatives><graphic xlink:href="pcbi.1007843.e011.jpg" id="pcbi.1007843.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> meaning <italic>sim</italic>(<italic>h</italic><sub><italic>i</italic>=<italic>I</italic></sub>, <italic>f</italic><sub><italic>k</italic></sub>) &gt; 0 and <italic>dsm</italic>(<italic>h</italic><sub><italic>i</italic>=<italic>I</italic></sub>, <italic>f</italic><sub><italic>k</italic></sub>) = 0, ii) <italic>f</italic><sub><italic>k</italic></sub> shares mismatching overlaps with <inline-formula id="pcbi.1007843.e012"><alternatives><graphic xlink:href="pcbi.1007843.e012.jpg" id="pcbi.1007843.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> meaning <italic>dsm</italic>(<italic>h</italic><sub><italic>i</italic>≠<italic>I</italic></sub>, <italic>f</italic><sub><italic>k</italic></sub>) &gt; 0. In other words <italic>f</italic><sub><italic>k</italic></sub> shares one matching and <italic>P</italic> − 1 mismatching overlaps with <inline-formula id="pcbi.1007843.e013"><alternatives><graphic xlink:href="pcbi.1007843.e013.jpg" id="pcbi.1007843.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi>b</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. This assures that <italic>f</italic><sub><italic>k</italic></sub> belongs to <italic>h</italic><sub><italic>i</italic>=<italic>I</italic></sub>. At each iteration, <bold><italic>Ranbow</italic></bold> selects a fragment and a haplotype with a unique overlap and merges them. The overlapping fragment set is updated by updating the haplotypes. After each iteration, <bold><italic>Ranbow</italic></bold> applies the same procedure over the new haplotype list and overlapping fragments set, ultimately resulting in an extended haplotype block.</p>
      </sec>
      <sec id="sec008">
        <title>Detecting and evaluating all possible masks</title>
        <p>Given <italic>n</italic> polymorphic sites, 2<sup><italic>n</italic></sup> − <italic>n</italic> − 1 possible masks can be computed. It is computationally expensive to find all masks, but not all of the masks are supported by fragments. To obtain all masks with available seed sequences and sufficient fragment support, we designed a two-nested-hash-tables data structure. This data structure helps <bold><italic>Ranbow</italic></bold> to pinpoint the masks with fragments supports independent of the size of the scaffolds, distribution of fragments, and the fragment lengths. At the end of this step, <bold><italic>Ranbow</italic></bold> provides all masks with available seed sequences and ignores those masks with no supporting fragment.</p>
        <p>In the mentioned nested hash tables, the keys in the outer hash table (<italic>OHT</italic>) are mask indices and the values are hash tables. The inner hash table (<italic>IHT</italic>) keeps seed sequences as the key and a list of supporting fragments as the values. <xref ref-type="supplementary-material" rid="pcbi.1007843.s001">S1 Fig</xref> Illustrates <italic>IHT</italic> and <italic>OHT</italic> hash tables with an example. To fill this data structure, <bold><italic>Ranbow</italic></bold> goes through the fragment list. A fragment with <italic>k</italic> non-missing alleles contributes 2<sup><italic>k</italic></sup> − <italic>k</italic> − 1 seed sequences to different masks. <xref ref-type="fig" rid="pcbi.1007843.g002">Fig 2C</xref> illustrates eleven seed sequences which are contributed with a fragment (<italic>f</italic><sub><italic>k</italic></sub>) consisting of four non-missing alleles. Only masks of length smaller than five are considered in order to decrease the running time. This can be tuned as a parameter.</p>
        <p>In order to rank all masks, <bold><italic>Ranbow</italic></bold> defines a fitness function which computes the fragment support for the seed sequences of each mask and reports the <italic>P</italic><sup><italic>th</italic></sup> highest supported seed sequence. In <xref ref-type="fig" rid="pcbi.1007843.g002">Fig 2A</xref>, the seed sequences “11”, “00”, “10”, and “20” are supported by four, three, three, and one fragment, respectively. Three, the number of supporting fragments of “10”, the third highest value (the example genome is triploid, <italic>P</italic> = 3), is reported as the fitness value. <bold><italic>Ranbow</italic></bold> ranks the masks according to this fitness function (<italic>MSK</italic><sup><italic>ranked</italic></sup>) and iterates over this ranked list to reconstruct haplotype blocks for these masks. We flag the variants used in reconstructed haplotype blocks as “used”. This includes mask variants and the variants integrated in the elongation step (see <italic>Elongating haplotype segments with flanking fragments</italic>). In the following iteration, we select a mask for which its variants are not flagged “used”.</p>
      </sec>
      <sec id="sec009">
        <title>Haplotype elongation via long range connections</title>
        <p>Haplotype segments of different haplotype blocks are connected by recruiting fragments that link distant SmPs. These distant connections can be obtained via paired-end, Hi-C, or long read information. We have modeled the problem as a weighted k-partite graph <italic>G</italic>(<italic>V</italic>, <italic>E</italic>, <italic>w</italic>), in which haplotype segments are the nodes and the fragments contributing to two haplotype segments are considered as the edges. In the k-partite graph <italic>G</italic>, <italic>k</italic> refers to the number of constructed haplotype blocks. <xref ref-type="supplementary-material" rid="pcbi.1007843.s002">S2 Fig</xref> illustrates haplotype blocks and their corresponding k-partite graph. We define <inline-formula id="pcbi.1007843.e014"><alternatives><graphic xlink:href="pcbi.1007843.e014.jpg" id="pcbi.1007843.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msup><mml:mi>F</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007843.e015"><alternatives><graphic xlink:href="pcbi.1007843.e015.jpg" id="pcbi.1007843.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:msup><mml:mi>F</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:msup></mml:math></alternatives></inline-formula> as the supporting fragments of <italic>s</italic><sub><italic>x</italic></sub> and <italic>s</italic><sub><italic>y</italic></sub> haplotype segments and choose <inline-formula id="pcbi.1007843.e016"><alternatives><graphic xlink:href="pcbi.1007843.e016.jpg" id="pcbi.1007843.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">|</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:msup><mml:mo>∩</mml:mo><mml:msup><mml:mi>F</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:msup><mml:mo form="prefix" stretchy="false">|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> as the weights of the edges in the graph <italic>G</italic> computed by the number of fragments which contribute to both haplotype segments.</p>
        <p>In an ideal scenario of error-free input data, an elongated haplotype segment will correspond to a <bold>desired path</bold>, <italic>i.e</italic>. a path with no conflict among its edges in this graph. A <bold>conflicting path</bold> is one linking two nodes of the same partition. Such a path may be due, e.g., to a mapping error. A conflicting path indicates that two haplotype segments of one block are actually one haplotype, violating the definition of haplotype segments in a block and the definition of partitions in a k-partite graph. We extend the definition of desired path to <bold>desired cycle</bold> when two paths connect two nodes from different haplotype blocks. <xref ref-type="fig" rid="pcbi.1007843.g002">Fig 2D</xref> depicts a schematic view of graph <italic>G</italic>. Every two nodes in a desired cycle are supported by two paths. For instance, for a cycle with length three of <italic>a</italic> → <italic>b</italic> → <italic>c</italic> → <italic>a</italic> (<xref ref-type="fig" rid="pcbi.1007843.g002">Fig 2D</xref>
<italic>(Blue)</italic>) every path between a number of nodes, <italic>e.g. a</italic> → <italic>b</italic> → <italic>c</italic>, is supported by another path, <italic>e.g</italic>., <italic>a</italic> → <italic>c</italic>. The elongation step is therefore based on these cycles.</p>
        <p>Constructing the whole graph is computationally expensive. First, one needs to find all non-conflicting cycles in the graph. Second, all pairs of segments need to be checked to see if they share fragments in order to add edges. Moreover, the probability of having an edge between distant haplotype segments is low because the read insert size is limited. We have therefore designed a greedy algorithm which avoids constructing the whole graph. <bold><italic>Ranbow</italic></bold> sorts haplotype blocks based on their starting positions(<italic>B</italic><sup><italic>sorted</italic></sup>). The starting position of a block is the smallest starting position of its segments. It then defines a sliding window with a user-defined length (ten as default) covering a number of neighboring blocks in <italic>B</italic><sup><italic>sorted</italic></sup>. <xref ref-type="fig" rid="pcbi.1007843.g002">Fig 2E</xref> depicts a sliding window of length four (red rectangles). All edges in this sliding window are constructed and their weights calculated.</p>
        <p>For constructing the partial graph in one sliding window, <bold><italic>Ranbow</italic></bold> searches for the cycles with length of three, called <bold>triangles</bold>, starting from the first block of the selected sliding window. <bold><italic>Ranbow</italic></bold> checks for a pair of edges such that they start from one node, <italic>a</italic>, and end in two nodes, <italic>b</italic> and <italic>c</italic> where <italic>b</italic> and <italic>c</italic> are not in the same block as <italic>a</italic>. <bold><italic>Ranbow</italic></bold> then checks whether there is an edge between <italic>b</italic> and <italic>c</italic>. If this edge exists, <italic>a</italic>, <italic>b</italic>, and <italic>c</italic> form a triangle. <bold><italic>Ranbow</italic></bold> finds a triangle with <bold>maximum fragment support</bold>, meaning <italic>w</italic>(<italic>a</italic>, <italic>b</italic>) + <italic>w</italic>(<italic>a</italic>, <italic>c</italic>) + <italic>w</italic>(<italic>b</italic>, <italic>c</italic>) is maximum. Having found a triangle with maximum support, <bold><italic>Ranbow</italic></bold> merges <italic>a</italic>, <italic>b</italic>, and <italic>c</italic> (<xref ref-type="fig" rid="pcbi.1007843.g002">Fig 2E</xref>
<italic>(blue lines)</italic>) and constructs a new haplotype segment by updating <italic>a</italic> and deleting <italic>b</italic> and <italic>c</italic>.</p>
        <p>The next step is elongation through direct connections. <bold><italic>Ranbow</italic></bold> sorts all edges based on their decreasing weight and iterates over the sorted list. At each iteration, it selects one edge and checks whether merging the two nodes of the edge results in a conflict. In case of no conflict, the nodes are merged into one node and the graph gets updated. The algorithm stops when there are no more edges in the graph, or <italic>E</italic> = ∅. One can assign a predefined threshold on the weights in order to use only highly confident edges, enabling all edges supported by lower than the user-defined threshold to be filtered out. <bold><italic>Ranbow</italic></bold>’s default threshold is set to three.</p>
      </sec>
      <sec id="sec010">
        <title>Phasing the regions with fewer than <italic>P</italic> unique haplotypes</title>
        <p>In a <italic>P</italic>-ploid genome, there is the possibility of having regions with <italic>p</italic> &lt; <italic>P</italic> unique haplotype segments. In this situation, <italic>P</italic> − <italic>p</italic> of the haplotypes are identical to one of the other haplotypes. For instance, there are two possible scenarios for a hexaploid genome where <italic>p</italic> = 4 and the unique haplotype segments are {<italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, <italic>A</italic><sub>3</sub>, <italic>A</italic><sub>4</sub>}: either there are two copies of two haplotypes ({<italic>A</italic><sub>1</sub>, <italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, <italic>A</italic><sub>2</sub>, <italic>A</italic><sub>3</sub>, <italic>A</italic><sub>4</sub>}) or there are three copies of one haplotype ({<italic>A</italic><sub>1</sub>, <italic>A</italic><sub>1</sub>, <italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, <italic>A</italic><sub>3</sub>, <italic>A</italic><sub>4</sub>}). It is essential to be able to distinguish which haplotype has more than one copy. It is also important to note that the unique matching overlap operation (see <italic>Elongating haplotype segments with flanking fragments</italic>) is not applicable to haplotypes with more than one copy. <bold><italic>Ranbow</italic></bold> is able to assemble the <italic>p</italic> haplotype segments obtained from one mask into a haplotype block of <italic>p</italic> haplotypes by skipping the elongation with flanking fragments step. <bold><italic>Ranbow</italic></bold> sorts the masks based on the number of their seed sequences in descending order, iterating over them to assemble new blocks of haplotypes. This results from <bold><italic>Ranbow</italic></bold> finding the largest number that the haplotypes of the region can be reconstructed to. It starts from <italic>p</italic> = <italic>P</italic> − 1 and counts down to <italic>p</italic> = 2. For each <italic>p</italic>, it iterates over sorted masks and checks whether the region is already reconstructed, or partly reconstructed, into its haplotypes. If the haplotypes of a mask region are not yet reconstructed, <bold><italic>Ranbow</italic></bold> collects <italic>p</italic> haplotypes to a new haplotype block.</p>
      </sec>
    </sec>
    <sec id="sec011">
      <title>Data</title>
      <p>We used simulated and real datasets to evaluate the competing methods. First we introduce how test datasets are generated.</p>
      <p><bold>SIM data</bold>: To construct a <bold>SIM</bold> dataset we use a genomic scaffold to simulate different ploidy levels with various heterozygosity rates. We employ Haplogenerator [<xref rid="pcbi.1007843.ref038" ref-type="bibr">38</xref>] to construct different haplotypes with given heterozygosity rate from the scaffold. Haplogenerator [<xref rid="pcbi.1007843.ref039" ref-type="bibr">39</xref>] uses a Poisson process to randomly generate variant positions. We use ART [<xref rid="pcbi.1007843.ref040" ref-type="bibr">40</xref>] to simulate short reads with various insert sizes from simulated haplotypes. ART imitates the sequencing process using an empirical error model or quality profiles summarized from large recalibrated sequencing data. We align the simulated reads to the 100kb scaffold followed by variant calling using BWA-MEM [<xref rid="pcbi.1007843.ref041" ref-type="bibr">41</xref>] and FREEBAYES [<xref rid="pcbi.1007843.ref042" ref-type="bibr">42</xref>], respectively. The scaffold, aligned reads (BAM format), and called variants (VCF format) serve as input for haplotype reconstruction, while the haplotypes serve as ground truth.</p>
      <p><bold>CBU data</bold>: For tetraploid example we chose Shepherd’s purse, <italic>Capsella bursa-pastoris</italic> (“CBU”). We downloaded the CBU genome and its Illumina reads [<xref rid="pcbi.1007843.ref043" ref-type="bibr">43</xref>]. We generate BAM and VCF files with BWA-MEM [<xref rid="pcbi.1007843.ref041" ref-type="bibr">41</xref>] and FREEBAYES [<xref rid="pcbi.1007843.ref042" ref-type="bibr">42</xref>], respectively, to produce genotype information from the aligned reads. Within a genotype, alleles get randomly assigned to simulate four haplotypes. The subsequent steps are the same as described above (see also <xref ref-type="supplementary-material" rid="pcbi.1007843.s012">S1 Text</xref> for more details).</p>
      <p><bold>SP data</bold>: We use the hexaploid sweet potato, <italic>Ipomoea batatas</italic>, genome to produce both simulated and real datasets. The simulated dataset is produced following the same procedure explained for CBU. The real datasets include Illumina short reads of various insert sizes and Roche 454 GS FLX+ pyrosequencer. These raw data were previously published by us [<xref rid="pcbi.1007843.ref014" ref-type="bibr">14</xref>], and were polished and transformed into standard form, i.e. coded allele space, for haplotype reconstruction analysis. The Illumina data consists of paired-end and mate-pair reads with selected and non-selected insert sizes. We used aligned Illumina reads (mapped via BWA-MEM [<xref rid="pcbi.1007843.ref041" ref-type="bibr">41</xref>]) for variant calling with FREEBAYES [<xref rid="pcbi.1007843.ref042" ref-type="bibr">42</xref>], followed by haplotype reconstruction. Roche 454 GS FLX+ pyrosequencer reads are longer than Illumina reads and we employ them to evaluate the reconstructed haplotypes (<xref ref-type="supplementary-material" rid="pcbi.1007843.s003">S3 Fig</xref>). All Roche 454 reads were sampled from the same SP individual. We did not utilize these sequencing data in the <italic>de novo</italic> assembly of the SP genome reference to avoid biases in the assembled reference towards these reads. The characteristics of these sequencing libraries are shown in <xref rid="pcbi.1007843.t001" ref-type="table">Table 1</xref>. Because sequencing errors are more concentrated at homopolymers and at read ends, we were able to polish the Roche 454 reads to produce higher quality ground truth haplotype sequences by trimming low quality base calls(<xref ref-type="supplementary-material" rid="pcbi.1007843.s003">S3 Fig</xref>). The thresholds of 99.7% (Phred = 25) for base quality and 99% for mapping quality (Phred = 20) guarantee that the reads will be aligned correctly and that the variants in the reads represent the true haplotypes.</p>
      <table-wrap id="pcbi.1007843.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007843.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Sequence library characteristics.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007843.t001g" xlink:href="pcbi.1007843.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Platform</th>
                <th align="center" rowspan="1" colspan="1">Sequencing type</th>
                <th align="center" rowspan="1" colspan="1">Insert size</th>
                <th align="center" rowspan="1" colspan="1">QC-passed reads</th>
                <th align="center" rowspan="1" colspan="1">Mapped rate</th>
                <th align="center" rowspan="1" colspan="1">Monoploid coverage</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Hiseq 2500</td>
                <td align="center" rowspan="1" colspan="1">PE100</td>
                <td align="center" rowspan="1" colspan="1">350 bp</td>
                <td align="center" rowspan="1" colspan="1">345M</td>
                <td align="center" rowspan="1" colspan="1">94.66%</td>
                <td align="center" rowspan="1" colspan="1">8x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Hiseq 2500</td>
                <td align="center" rowspan="1" colspan="1">PE100</td>
                <td align="center" rowspan="1" colspan="1">950 bp</td>
                <td align="center" rowspan="1" colspan="1">190M</td>
                <td align="center" rowspan="1" colspan="1">95.07%</td>
                <td align="center" rowspan="1" colspan="1">4x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Nextseq 500</td>
                <td align="center" rowspan="1" colspan="1">PE150</td>
                <td align="center" rowspan="1" colspan="1">550 bp</td>
                <td align="center" rowspan="1" colspan="1">837M</td>
                <td align="center" rowspan="1" colspan="1">94.70%</td>
                <td align="center" rowspan="1" colspan="1">26x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Nextseq 500</td>
                <td align="center" rowspan="1" colspan="1">PE150</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">694M</td>
                <td align="center" rowspan="1" colspan="1">91.65%</td>
                <td align="center" rowspan="1" colspan="1">21x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Hiseq 4000</td>
                <td align="center" rowspan="1" colspan="1">PE100</td>
                <td align="center" rowspan="1" colspan="1">20kb</td>
                <td align="center" rowspan="1" colspan="1">316M</td>
                <td align="center" rowspan="1" colspan="1">95.67%</td>
                <td align="center" rowspan="1" colspan="1">6x</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">GS FLX+</td>
                <td align="center" rowspan="1" colspan="1">SE</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">3M</td>
                <td align="center" rowspan="1" colspan="1">98.91%</td>
                <td align="center" rowspan="1" colspan="1">0.56x</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>We chose SP and CBU genomes due to the availability of sequence reads sampled from single individuals, allowing for haplotyping of individual genomes. The characteristics of these genomes, i.e. SmP interval length distribution and the rate of variant types, are depicted in <xref ref-type="fig" rid="pcbi.1007843.g003">Fig 3</xref>. We observed very high frequencies of short intervals with exponential drop for larger intervals (<xref ref-type="fig" rid="pcbi.1007843.g003">Fig 3A</xref>). This suggests that the majority of neighboring SmPs can be connected via short read sequencing technologies, such as Illumina. <xref ref-type="fig" rid="pcbi.1007843.g003">Fig 3B</xref> shows the distribution of different types of variants. Though SNP variants are the most frequent type of variants, the number of indels and same-length multinucleotide variants are non-negligible. We therefore allow for all types of variants in our haplotype reconstruction.</p>
      <fig id="pcbi.1007843.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007843.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Properties of the sweet potato and CBU genome datasets.</title>
          <p><bold>(A)</bold> The interval length distribution of polymorphic sites. Both axes are in log scale. <bold>(B)</bold> The frequencies of different types of variants. The y-axis is in logarithmic scale.</p>
        </caption>
        <graphic xlink:href="pcbi.1007843.g003"/>
      </fig>
      <p><bold>Different size test data</bold>: Some of the available algorithms do not run on large datasets. We therefore defined three datasets distinguished by size for the purpose of testing different aspects of our and competing tools using the procedures explained above (see <xref rid="pcbi.1007843.t002" ref-type="table">Table 2</xref>).</p>
      <table-wrap id="pcbi.1007843.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007843.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Simulated and real datasets for evaluation.</title>
        </caption>
        <alternatives>
          <graphic id="pcbi.1007843.t002g" xlink:href="pcbi.1007843.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">SIM</th>
                <th align="center" rowspan="1" colspan="1">CBU</th>
                <th align="center" colspan="2" rowspan="1">SP</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Small</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>All</italic>
                  <sub>
                    <italic>a</italic>
                  </sub>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>All</italic>
                  <sub>350<italic>bp</italic></sub>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>All</italic>
                  <sub>350<italic>bp</italic></sub>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <inline-formula id="pcbi.1007843.e017">
                    <alternatives>
                      <graphic id="pcbi.1007843.e017g" xlink:href="pcbi.1007843.e017"/>
                      <mml:math id="M17">
                        <mml:mrow>
                          <mml:mi>A</mml:mi>
                          <mml:mi>l</mml:mi>
                          <mml:msubsup>
                            <mml:mi>l</mml:mi>
                            <mml:mi>b</mml:mi>
                            <mml:mi>R</mml:mi>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:math>
                    </alternatives>
                  </inline-formula>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Medium</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">−</td>
                <td align="left" rowspan="1" colspan="1"><bold><italic>H-PoP</italic></bold>/<bold><italic>Ranbow</italic></bold><sub><italic>c</italic></sub></td>
                <td align="left" rowspan="1" colspan="1"><bold><italic>H-PoP</italic></bold>/<bold><italic>Ranbow</italic></bold><sub><italic>c</italic></sub></td>
                <td align="left" rowspan="1" colspan="1">−</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>Large</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">−</td>
                <td align="left" rowspan="1" colspan="1">−</td>
                <td align="left" rowspan="1" colspan="1">−</td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>
                    <italic>Ranbow</italic>
                  </bold>
                  <sup>
                    <italic>R</italic>
                  </sup>
                </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t002fn001">
            <p><bold>All</bold>: Datasets for evaluation of all competing tools</p>
          </fn>
          <fn id="t002fn002">
            <p><bold>R</bold>: Evaluated with Roche 454 reads</p>
          </fn>
          <fn id="t002fn003">
            <p><bold>a</bold>: Simulated short reads of 350bp, 500bp, 1kb, and 5kb insert sizes</p>
          </fn>
          <fn id="t002fn004">
            <p><bold>b</bold>: Illumina short reads of 350bp, 550bp, 950bp, Non-selected size and 20kb insert sizes</p>
          </fn>
          <fn id="t002fn005">
            <p><bold>c</bold>: Simulated short reads of 350bp, 1kb, 2kb, and 5kb insert sizes</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p><italic>Small datasets</italic>: Those comprise two simulated (<italic>All</italic><sub><italic>a</italic></sub> and <italic>All</italic><sub>350<italic>bp</italic></sub>) and one real (<inline-formula id="pcbi.1007843.e018"><alternatives><graphic xlink:href="pcbi.1007843.e018.jpg" id="pcbi.1007843.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:mi>A</mml:mi><mml:mi>l</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>b</mml:mi><mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>) dataset. 1) The <italic>All</italic><sub><italic>a</italic></sub> dataset is generated according to SIM data scheme, with fixed genome size and insert sizes of 350bp, 500bp, 1kb, and 5kb. We use a 100kb scaffold to simulate datasets with four, six, eight, and ten haplotypes and with 0.001, 0.005, 0.01, 0.05, and 0.1 heterozygosity rates. We produce ten replicates for each ploidy level and heterozygosity rate. For each replicate, we then generate 30x monoploid read coverage of each insert size. 2) <italic>All</italic><sub>350<italic>bp</italic></sub> datasets are generated according to the SP and CPU data generation schemes. This time we fix the library insert size to 350bps and vary the genome length. We selected five scaffold groups of 10kb, 50kb, 100kb, 500kb, and 1000kb lengths, each of which contains ten scaffolds of the corresponding genomes. We selected these scaffolds based on length and coverage such that they represent the majority of scaffolds in the assembly (see <xref ref-type="supplementary-material" rid="pcbi.1007843.s004">S4 Fig</xref>). 3) <inline-formula id="pcbi.1007843.e019"><alternatives><graphic xlink:href="pcbi.1007843.e019.jpg" id="pcbi.1007843.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:mi>A</mml:mi><mml:mi>l</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>b</mml:mi><mml:mi>R</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> serves as the real dataset which comprises Illumina short reads of 350bp, 550bp, 950bp, 20kbp, and non-selected size insert sizes as input. <xref ref-type="supplementary-material" rid="pcbi.1007843.s005">S5 Fig</xref> illustrates the insert size distribution of Illumina libraries. The reconstructed haplotypes were evaluated with Roche 454 reads (see <xref rid="pcbi.1007843.t001" ref-type="table">Table 1</xref>).</p>
      <p><italic>Medium datasets</italic>: These consist of five paired-end read insert sizes, namely 350bp, 1kbp, 2kbp, 5kbp, and “All” for the SP and CBU genomes, where the “All” library is made by merging the first four datasets. <xref ref-type="supplementary-material" rid="pcbi.1007843.s006">S6 Fig</xref> shows the insert length distributions of simulated datasets. Small and medium datasets agree on underlying scaffolds, their variants, and in the procedure used to simulate reads. They differ in terms of monoploid coverage and insert size. The coverage for the 350bp, 1kbp, 2kbp, and 5kbp insert sizes is 40x. The coverage for the “All” dataset is 160x (4×40x).</p>
      <p><italic>Large datasets</italic>: This dataset consists of whole genome Illumina reads of the SP genome as input. For ground truth we use Roche 454 reads (see <xref rid="pcbi.1007843.t001" ref-type="table">Table 1</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec012">
    <title>Results</title>
    <p>We implemented <bold><italic>Ranbow</italic></bold> using Python 2.7. <bold><italic>Ranbow</italic></bold> is freely available under a GNU licence. Accepted <bold><italic>Ranbow</italic></bold> inputs are a reference sequence in FASTA format, a collection of aligned reads in BAM format, and called sequence variants in the VCF format. Dosage information is not required. <bold><italic>Ranbow</italic></bold> returns the list of aligned haplotypes in the BAM format. The haplotypes are represented in coded allele space, depicting only the connection between alleles and ignoring the inter-allelic regions (details in <italic>Definition and problem formulation</italic>). We have introduced the “hap” format file for the haplotypes in coded allele space and their specifics. It contains the haplotypes and their read support information. <bold><italic>Ranbow</italic></bold> extracts a list of fragments from input sequence reads and variants. The coded allele space format allows the volume of the read-file to be significantly reduced. For example, we obtained 1.6Gb of aligned fragments from 657Gb of mapped reads in sweet potato genome data (see <italic>Data</italic>). Data distribution was automated to multiple cores. <bold><italic>Ranbow</italic></bold> accepts the number of available cores as an input parameter, grouping scaffolds to minimize the estimate of maximum running time for the busiest core. This feature is invaluable when dealing with high depth sequence reads and whole genome sequence data applications.</p>
    <p>We evaluated <bold><italic>Ranbow</italic></bold> (V2.0) against <bold><italic>HapCompass</italic></bold>, <bold><italic>SDhaP</italic></bold>, and <bold><italic>H-PoP</italic></bold>. <bold><italic>HapTree</italic></bold> could not be included due to runtime error on some of the datasets. <bold><italic>Ranbow</italic></bold> and <bold><italic>HapCompass</italic></bold> accept BAM and VCF format as input and produce aligned haplotypes in the BAM format. Pre- or postprocessing the data in order to apply the algorithm is unnecessary. <bold><italic>H-PoP</italic></bold> and <bold><italic>SDhaP</italic></bold> accept a file format which contains allele connectivity via fragments, and produce a similar format output file. The application of these methods on real data requires pre- and postprocessing steps for the tools to accept the data as input (see <xref ref-type="supplementary-material" rid="pcbi.1007843.s013">S2 Text</xref>). <bold><italic>HapCompass</italic></bold> and <bold><italic>Ranbow</italic></bold> are the only methods that can handle non-SNP sites. <bold><italic>SDhaP</italic></bold> cannot handle non-SNP polymorphic sites if the number of alleles is higher than four, a restriction that needs to be considered in the pre-processing step for this method. <bold><italic>H-PoP</italic></bold> only integrates one reference and one alternative allele. It converts the rest of alternative alleles to either the reference or the first alternative alleles (see <xref ref-type="supplementary-material" rid="pcbi.1007843.s013">S2 Text</xref>).</p>
    <p>Some of the available algorithms did not finish in reasonable time on large datasets. We therefore constructed three groups of datasets with different sizes as described in <italic>Data</italic> above. We started by comparing all methods on <bold>Small</bold> datasets. Since <bold><italic>H-PoP</italic></bold> delivered haplotyping results in most cases, we compared it with <bold><italic>Ranbow</italic></bold> using <bold>Medium</bold> datasets. Only <bold><italic>Ranbow</italic></bold> obtained results on <bold>Large</bold> datasets. As evaluation metrics we use accuracy, haplotype length, running time, and memory usage. The accuracy is the generalized form of reconstruction rate [<xref rid="pcbi.1007843.ref044" ref-type="bibr">44</xref>] defined for diploid genome. Each reconstructed haplotype is assigned to one and only one ground truth haplotype based on sequence similarity. For these assignments, the accuracy reports the ratio of the number of correctly reconstructed variants over the length of the reconstructed haplotype in coded allele space, where the length does not count missing alleles. <xref ref-type="fig" rid="pcbi.1007843.g004">Fig 4</xref> shows the evaluation on <italic>All</italic><sub><italic>a</italic></sub> datasets. <italic>All</italic><sub><italic>a</italic></sub> contains 20 configurations (four ploidy levels times five heterozygosity rates) and 200 datasets (ten replicates for each configuration). We set the high time limit of 10000 second for this small genomic region. <bold><italic>SDhaP</italic></bold>, <bold><italic>H-PoP</italic></bold> and <bold><italic>HapCompass</italic></bold> failed for some configurations mainly when heterozygosity and/or ploidy was high. <bold><italic>Ranbow</italic></bold>’s accuracy is mostly between 0.9 and 1.0 and it performs best in terms of accuracy. For low heterozygosity (0.001, 0.005, and, 0.01) and ploidy levels, <bold><italic>H-PoP</italic></bold> performs better than <bold><italic>Ranbow</italic></bold> in terms of haplotype length, although at the cost of lower accuracy. <bold><italic>Ranbow</italic></bold> and <bold><italic>H-PoP</italic></bold> will allow for missing alleles in the result (see fourth row). The gap length is calculated as the number of missing alleles between first and last defined variant. For example in ‘0 − 1 − − 00’, haplotype and gap lengths are four and three, respectively. <bold><italic>Ranbow</italic></bold> can handle every heterozygosity rate and ploidy in a reasonable running time. Maximum running time for <bold><italic>Ranbow</italic></bold> is 1114 second for ploidy level 10 and heterozygosity of 0.1. <bold><italic>Ranbow</italic></bold> performs best in terms of peak memory usage as well. <xref rid="pcbi.1007843.t003" ref-type="table">Table 3</xref> shows the memory usages of competing methods in GB for 0.01 and 0.05 heterozygosity rates.</p>
    <fig id="pcbi.1007843.g004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1007843.g004</object-id>
      <label>Fig 4</label>
      <caption>
        <title>Comparison of methods on <italic>All</italic><sub><italic>a</italic></sub> datasets.</title>
        <p>Evaluation of competing methods in terms of accuracy, average haplotype length, maximum haplotype length, gap length (these lengths are in coded allele space), running time, and memory usage on <italic>All</italic><sub><italic>a</italic></sub> datasets. <italic>All</italic><sub><italic>a</italic></sub> contains 200 datasets, each with a heterozygosity rate of 0.001, 0.005, 0.01, 0.05, or 0.1 and a ploidy level of four, six, eight, or ten. Columns and rows represent the ploidy level and evaluation metrics, respectively. Each point is the average of up to ten datapoints, each the result of one method on one dataset. For better distinguishability of the methods, lines connect the points for each method. An accuracy (or a length) datapoint represents the average accuracy (length) of all assembled haplotypes in a dataset. A time datapoint (memory or max length) represents the running time (peak memory usage or maximum haplotype length) of a method on a dataset. Bar plots in the last row show the number of replicate data sets for which a method accomplished computation of a result.</p>
      </caption>
      <graphic xlink:href="pcbi.1007843.g004"/>
    </fig>
    <table-wrap id="pcbi.1007843.t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1007843.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Average peak memory usage on <italic>All</italic><sub><italic>a</italic></sub> dataset with 0.01 and 0.05 heterozygosity.</title>
        <p>“-” represent the methods failed to accomplish.</p>
      </caption>
      <alternatives>
        <graphic id="pcbi.1007843.t003g" xlink:href="pcbi.1007843.t003"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="center" colspan="9" rowspan="1">Peak memory usage(GB)</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1">Heterozygosity rate</th>
              <th align="center" colspan="4" rowspan="1">0.01</th>
              <th align="center" colspan="4" rowspan="1">0.05</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1">Ploidy</th>
              <th align="left" rowspan="1" colspan="1">4</th>
              <th align="left" rowspan="1" colspan="1">6</th>
              <th align="left" rowspan="1" colspan="1">8</th>
              <th align="left" rowspan="1" colspan="1">10</th>
              <th align="left" rowspan="1" colspan="1">4</th>
              <th align="left" rowspan="1" colspan="1">6</th>
              <th align="left" rowspan="1" colspan="1">8</th>
              <th align="left" rowspan="1" colspan="1">10</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Ranbow</bold>
              </td>
              <td align="char" char="." rowspan="1" colspan="1">0.21</td>
              <td align="char" char="." rowspan="1" colspan="1">0.32</td>
              <td align="char" char="." rowspan="1" colspan="1">0.41</td>
              <td align="char" char="." rowspan="1" colspan="1">0.49</td>
              <td align="char" char="." rowspan="1" colspan="1">1.01</td>
              <td align="char" char="." rowspan="1" colspan="1">1.35</td>
              <td align="char" char="." rowspan="1" colspan="1">1.73</td>
              <td align="left" rowspan="1" colspan="1">2.15</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>SDhaP</bold>
              </td>
              <td align="char" char="." rowspan="1" colspan="1">6.88</td>
              <td align="char" char="." rowspan="1" colspan="1">7.84</td>
              <td align="char" char="." rowspan="1" colspan="1">8.70</td>
              <td align="center" rowspan="1" colspan="1">-</td>
              <td align="center" rowspan="1" colspan="1">-</td>
              <td align="center" rowspan="1" colspan="1">-</td>
              <td align="center" rowspan="1" colspan="1">-</td>
              <td align="left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>H-PoP</bold>
              </td>
              <td align="char" char="." rowspan="1" colspan="1">11.33</td>
              <td align="char" char="." rowspan="1" colspan="1">19.86</td>
              <td align="char" char="." rowspan="1" colspan="1">19.00</td>
              <td align="char" char="." rowspan="1" colspan="1">20.40</td>
              <td align="char" char="." rowspan="1" colspan="1">21.05</td>
              <td align="char" char="." rowspan="1" colspan="1">21.01</td>
              <td align="char" char="." rowspan="1" colspan="1">21.13</td>
              <td align="left" rowspan="1" colspan="1">-</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>HapCompass</bold>
              </td>
              <td align="char" char="." rowspan="1" colspan="1">8.56</td>
              <td align="char" char="." rowspan="1" colspan="1">9.73</td>
              <td align="char" char="." rowspan="1" colspan="1">12.18</td>
              <td align="center" rowspan="1" colspan="1">-</td>
              <td align="center" rowspan="1" colspan="1">-</td>
              <td align="center" rowspan="1" colspan="1">-</td>
              <td align="center" rowspan="1" colspan="1">-</td>
              <td align="left" rowspan="1" colspan="1">-</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>In the absence of a ground truth, models such as MEC or MFR (see <xref ref-type="sec" rid="sec001">Introduction</xref>) serve as evaluation metrics. For example, the MEC metric computes the MEC scores between the reconstructed haplotypes and their corresponding fragments. <bold><italic>HapCompass</italic></bold>, <bold><italic>SDhaP</italic></bold>, and <bold><italic>H-PoP</italic></bold> use the MEC metric. The downside of assessing tools with these metrics is that they fail to evenly capture the benefits these tools offer. The MEC metric only considers sequencing errors and the MFR model only the mapping errors.</p>
    <p>For this paper we use Roche 454 reads for evaluating the assembled haplotypes in the real datasets. We did not use these reads for haplotype reconstruction. Roche 454 reads are on the order of 800 bp long <xref ref-type="supplementary-material" rid="pcbi.1007843.s003">S3 Fig</xref>. For designing an evaluation metric we proceed as follows. A 454 read gets aligned to the reference sequence. Then the haplotype to compare the 454 read to is chosen based on maximal number of matches and minimal number of mismatches between the 454 read and overlapping haplotypes. In particular, a 454 read with a switch error will have many mismatches with respect to the haplotype.</p>
    <p>We further integrate haplotype accuracy and length through a “match-mismatch plot”, our new approach that evaluates and visualizes the performance of various methods (shown in <xref ref-type="fig" rid="pcbi.1007843.g005">Fig 5A and 5B</xref>). Each dot in a match-mismatch plot corresponds to one assembled haplotype that is compared to a ground truth. The reconstructed haplotype gets assigned to the ground truth and the number of matches and mismatches are calculated. The x-coordinate (y-coordinate) of a dot indicates how many alleles are assembled correctly (incorrectly). Missing alleles are not considered at this point. The observation frequency for each individual haplotype is encoded in the shading at the respective (<italic>x</italic>, <italic>y</italic>) position. Because the aim of haplotyping lies in obtaining longer and more accurate sequences, a larger x-value and smaller y-value are desired. The lines in the plot depict linear fits to the dots generated by each method. The flatter the slope of the line, the higher the overall accuracy of the method. The match-mismatch plot simultaneously evaluates and visualizes accuracy and length of a haplotype.</p>
    <fig id="pcbi.1007843.g005" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1007843.g005</object-id>
      <label>Fig 5</label>
      <caption>
        <title>Comparison of all methods on sweet potato real and simulated datasets.</title>
        <p>A, B) Match-mismatch plots for sweet potato real and simulated datasets, respectively. These scatter plots illustrate the accuracy of the methods. C, D) The execution time s for different scaffold size groups (10 scaffolds per five scaffold length groups, totally 10×5 scaffolds). The y-axis is in logarithmic scale.</p>
      </caption>
      <graphic xlink:href="pcbi.1007843.g005"/>
    </fig>
    <p>The results of <inline-formula id="pcbi.1007843.e020"><alternatives><graphic xlink:href="pcbi.1007843.e020.jpg" id="pcbi.1007843.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mrow><mml:mi>A</mml:mi><mml:mi>l</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <italic>All</italic><sub>350<italic>bp</italic></sub> evaluation are shown in <xref ref-type="fig" rid="pcbi.1007843.g005">Fig 5</xref>. The match-mismatch plot for real data is presented in <xref ref-type="fig" rid="pcbi.1007843.g005">Fig 5A</xref>. x-axis values correspond to the number of variants covered by Roche 454 reads (see <xref ref-type="supplementary-material" rid="pcbi.1007843.s007">S7 Fig</xref>). <xref ref-type="fig" rid="pcbi.1007843.g005">Fig 5B</xref> shows the match-mismatch plot for <italic>All</italic><sub>350<italic>bp</italic></sub>. We evaluated the accuracy in addition to match-mismatch plot in <xref ref-type="supplementary-material" rid="pcbi.1007843.s008">S8 Fig</xref>. Judging by the slope of the regression lines in the match-mismatch plots (<xref ref-type="fig" rid="pcbi.1007843.g005">Fig 5A and 5B</xref>) and the reported accuracy (<xref ref-type="supplementary-material" rid="pcbi.1007843.s008">S8 Fig</xref>), <bold><italic>Ranbow</italic></bold>’s performance is consistently superior with respect to accuracy for real and simulated datasets. <xref ref-type="supplementary-material" rid="pcbi.1007843.s009">S9 Fig</xref> evaluates <bold><italic>Ranbow</italic></bold> and <bold><italic>H-PoP</italic></bold> in terms of haplotype length, this time measured in base pairs. This plot shows the overall equivalent performance of these two methods in terms of haplotype lengths on CBU dataset. <xref ref-type="fig" rid="pcbi.1007843.g005">Fig 5C and 5D</xref> show the execution times for different scaffold size groups. <bold><italic>Ranbow</italic></bold> is two (scaffold group 10kb) to 30 (scaffold group 1000kb) times faster than the next best method for real data and also several times faster than the next best method for simulated data. <xref ref-type="supplementary-material" rid="pcbi.1007843.s014">S1 Table</xref> shows the running time of competing methods in detail.</p>
    <p>Because some of the datasets did not achieve a reasonable running time on <bold><italic>SDhap</italic></bold> and <bold><italic>HapCompasss</italic></bold>, we focused our medium datasets comparison on <bold><italic>Ranbow</italic></bold> and <bold><italic>H-PoP</italic></bold>. <xref ref-type="fig" rid="pcbi.1007843.g006">Fig 6</xref> shows the match-mismatch plots for <bold><italic>H-PoP</italic></bold> and <bold><italic>Ranbow</italic></bold> for different insert sizes on the CBU genome. <bold><italic>Ranbow</italic></bold> is more accurate and assembles longer haplotypes. The length and frequency distributions of the variants correctly reconstructed into haplotypes are shown in <xref ref-type="supplementary-material" rid="pcbi.1007843.s010">S10 Fig</xref>. Integrating libraries of different insert size is a common scenario when sequencing new organisms. We therefore designed the “All” datasets to test <bold><italic>Ranbow</italic></bold>’s performance in this situation. Performance increases markedly when different insert sizes are integrated (see <xref ref-type="fig" rid="pcbi.1007843.g006">Fig 6</xref>
<italic>bottom row</italic>). <bold><italic>Ranbow</italic></bold> uses the short insert sizes for local haplotype assembly and longer insert sizes for elongation of the haplotypes. Due to the exceedingly long running time on the Large dataset (SP whole genome datasets) by <bold><italic>H-PoP</italic></bold> and the other competing methods, we limited our evaluation to <bold><italic>Ranbow</italic></bold>. <xref ref-type="supplementary-material" rid="pcbi.1007843.s011">S11 Fig</xref> evaluates the haplotypes computed from Roche 454 reads. The slope of the fitted line is 0.07 showing <bold><italic>Ranbow</italic></bold>’s superior performance.</p>
    <fig id="pcbi.1007843.g006" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1007843.g006</object-id>
      <label>Fig 6</label>
      <caption>
        <title>The comparison of <italic>H-PoP</italic> and <italic>Ranbow</italic> on different insert sizes for simulated dataset of CBU genome.</title>
      </caption>
      <graphic xlink:href="pcbi.1007843.g006"/>
    </fig>
  </sec>
  <sec sec-type="conclusions" id="sec013">
    <title>Discussion</title>
    <p><bold><italic>Ranbow</italic></bold> outperforms the competing methods for the following three reasons:</p>
    <list list-type="order">
      <list-item>
        <p>Integrating multi-allelic variants: <bold><italic>Ranbow</italic></bold> has an advantage over methods that search the solution space. Multi-allelic variants substantially inflate the solution space of possible haplotypes. <bold><italic>Ranbow</italic></bold> avoids searching the solutions space, instead using the multi-allelic variants to cluster the reads efficiently. For example, two bi-allelic polymorphic sites cannot cluster the reads into six classes in a hexaploid genome (2 × 2 possible sequence pattern). By integrating multi-allelic variants, one bi-allelic and one tri-allelic variant can provide six sequence patterns and can cluster the reads into six groups (2 × 3 possible sequence patterns). Multi-allelic variants enable <bold><italic>Ranbow</italic></bold> to cluster the reads and reconstruct local haplotypes. This approach is central to <bold><italic>Ranbow</italic></bold>’s improved performance when compared to methods that search the solution space.</p>
      </list-item>
      <list-item>
        <p>Integrating different types of errors: <bold><italic>Ranbow</italic></bold> integrates different types of errors simultaneously. It detects, corrects, or excludes erroneous reads. Excluding an erroneously mapped read, which is not a feature of methods using the MEC model, increases the speed and accuracy of our method. Methods using the MEC model have to integrate the erroneously mapped reads to one of the assembled haplotypes. Only <bold><italic>Ranbow</italic></bold> excludes these reads.</p>
      </list-item>
      <list-item>
        <p>Data structure: <bold><italic>Ranbow</italic></bold> consists of local haplotype reconstruction steps followed by global haplotype elongation. In contrast to read-clustering and read-graph based methods, <bold><italic>Ranbow</italic></bold> compares only a local selection of reads in its first step. <bold><italic>Ranbow</italic></bold>’s data structure facilitates random access to local regions with higher signal for partitioning reads. This is a distinct advantage over sliding window approaches and directly enables <bold><italic>Ranbow</italic></bold> to escape from local optimum solutions. In addition, <bold><italic>Ranbow</italic></bold> constructs a multipartite graph where the nodes are haplotype segments reconstructed from read clusters. The number of haplotype segments is limited by the ploidy of the organism. In contrast, read clustering or read-graph based methods use reads as the graph nodes. Increasing the sequencing depth is computationally expensive and negatively affects the performance of these methods. <bold><italic>Ranbow</italic></bold> uses the reads as an entity stemming from one haplotype. Variant-based graph methods shear the reads into variant connections. One read covering three variants becomes three bi-variant connections in these approaches. These methods rely on computational steps to connect these variants again.</p>
      </list-item>
    </list>
    <sec id="sec014">
      <title>Conclusion</title>
      <p>We have addressed the challenge of haplotype reconstruction for polyploid organisms from short read data. We investigated the characteristics of polyploid genomes and the technical challenges for reconstructing haplotypes. We introduced the AoM problem, and discussed how this, combined with the higher search space and the high error rate, are the main technical challenges when reconstructing haplotypes from sequence data. We designed <bold><italic>Ranbow</italic></bold>, a method that embeds multiple error correction steps to detect different types of errors, i.e. base-calling, variant-calling, and mapping errors. Our method successfully integrates bi-allelic and multi-allelic variants. Although multi-allelic variants inflate the search space, the <bold><italic>Ranbow</italic></bold> algorithm is independent of this parameter, enabling it to reconstruct haplotypes quickly. <bold><italic>Ranbow</italic></bold> does not use dosage information as input, yet can be used for calling dosage information when haplotypes are computed. This is advantageous because in addition to read frequency, the information on which flanking variants are connected to each other through sequence reads is also taken into account.</p>
      <p>Our work shows that <bold><italic>Ranbow</italic></bold> generally outperforms other haplotypers in terms of reconstructed haplotype length, accuracy, and computational and memory efficiency on real and simulated datasets. Only in a few datasets, the increase in accuracy and efficiency came at the cost of shorter haplotypes and increased gap sizes. <bold><italic>Ranbow</italic></bold>’s general superior performance stems from the specific features and data structure we considered during the design process. It considers the AoM feature in every step and deal with different types of errors simultaneously. The erroneous reads are corrected or excluded within two layers of data structure, namely a local haplotype reconstruction followed by a global procedure. This data structure allows <bold><italic>Ranbow</italic></bold> to search for regions with better signals and prioritize them for the local haplotype reconstruction step. The local haplotype reconstruction step constructs haplotype segments in haplotype blocks. The global procedure combines these haplotype by building a multipartite graph.</p>
      <p>We have shown that <bold><italic>Ranbow</italic></bold> is more than one order of magnitude faster than the competing approaches on real datasets, making whole genome haplotype reconstruction of complex genomes, such as the hexaploid sweet potato, possible. On a large computer cluster our method completed haplotype reconstruction of the sweet potato genome in approximately two days. This is a vast improvement on the estimated more than twenty days needed by the next best competing method. This feature allows the user to apply our method multiple times under different parameter settings or iteratively, e.g., for iterative assembly refinement [<xref rid="pcbi.1007843.ref014" ref-type="bibr">14</xref>]. We showed that our tool is able to efficiently utilize a combination of different insert sizes. This aligns with the established sequencing strategy of combining different insert lengths for <italic>de novo</italic> assembly of a new organism’s genome.</p>
      <p>As long-read sequencing technologies become more wide-spread, there will be a need for programs that can assemble haplotypes efficiently and accurately. <bold><italic>Ranbow</italic></bold> fits the bill perfectly as it can also be applied to less heterozygous genomes. We hope to be able to improve <bold><italic>Ranbow</italic></bold> further by integrating base quality for long read sequencing, such as PacBio and Nanopore, and mapping quality and barcoded errors for linked reads, as well as the read count values. Our long term goal is that <bold><italic>Ranbow</italic></bold> will be the superior haplotyping method for a broad range of sequencing technologies.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec015">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s001">
      <label>S1 Fig</label>
      <caption>
        <title>An illustration of <italic>IHT</italic> and <italic>OHT</italic> hash tables.</title>
        <p>This figure shows a mask (<italic>mask</italic> = (1, 4)), its seed sequence (‘11’,‘00’, and ‘10’) and the fragments containing these seed sequences (<italic>f</italic><sub>1</sub>, <italic>f</italic><sub>2</sub>, …, <italic>f</italic><sub>11</sub>). For example, the <italic>IHT</italic> for the seed sequence ‘11’ contains its supporting fragments <italic>IHT</italic>(‘11’) = <italic>f</italic><sub>1</sub>, <italic>f</italic><sub>2</sub>, <italic>f</italic><sub>3</sub>, <italic>f</italic><sub>4</sub>. The <italic>OHT</italic> of a mask contains the <italic>IHT</italic>s of the mask seed sequences <italic>OHT</italic>(1, 4) = {<italic>IHT</italic>(‘11’),<italic>IHT</italic>(‘00’),<italic>IHT</italic>(‘10’)}.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s002">
      <label>S2 Fig</label>
      <caption>
        <title>Schematic view of graph <italic>G</italic>.</title>
        <p>This figure illustrates haplotype blocks and segments, and shows fragments and their corresponding edges in the graph. <italic>G</italic> is <italic>k</italic>-partite graph with haplotype blocks defining the partitions and the haplotype segments defining the nodes within the partitions. If two reads of a fragment are mapped to two haplotype segments of different blocks, an edge is assigned between the nodes of these segments.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s003">
      <label>S3 Fig</label>
      <caption>
        <title>Base quality and length distribution of Roche 454 reads.</title>
        <p><bold>Left</bold>: Each 454 read is divided into 20 equal size segments. The box plot shows the base quality distribution and the red line indicates the high threshold we set for filtering the bases on quality. <bold>Right</bold>: The Roche 454 length distribution. Maximum length is 1771bp.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s004">
      <label>S4 Fig</label>
      <caption>
        <title>Selected scaffolds’ properties.</title>
        <p>In this heat map, each dot depicts one scaffold of the sweet potato genome. These scaffolds were obtained after the scaffolding step of <italic>de novo</italic> assembly. The x-axis shows the log scale of coverage and the y-axis shows the log scale of scaffold lengths. We randomly selected 50 scaffolds (red circles) of different sizes, namely 10kb, 50kb, 100kb, 500kb, and 1000kb, ten scaffolds each. These scaffolds are used for evaluations with real data and producing the simulated dataset.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s005">
      <label>S5 Fig</label>
      <caption>
        <title>Dataset properties of sweet potato genome.</title>
        <p><bold>Left</bold>: Insert size distribution. The real data contains five different libraries with different insert sizes, namely 350bp, 550bp, 950bp, 20k, and no size selection. For simulated data, we generated inserts of 350bp from the selected scaffolds with 30x coverage for each haplotype. <bold>Right</bold>: Coverage of selected scaffolds for real and simulated data. The x-axis shows base coverage, and the y-axis depicts frequency. In the real dataset, the base coverage varies in a wide range up to 10k while the simulated data has the peak at 180x. This discrepancy is caused by the presence of repeats in the genome.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s006">
      <label>S6 Fig</label>
      <caption>
        <title>Insertion length distribution for simulated dataset of CBU genome.</title>
        <p>Four 100bp paired-end read libraries with insert sizes of 350bp, 1kbp, 2kbp and 5kb are generated by EAGLE (Enhanced Artificial Genome Engine) [<xref rid="pcbi.1007843.ref045" ref-type="bibr">45</xref>]. EAGLE generates reads and converts them to alignments. It is designed to simulate the behavior of Illumina’s Next Generation Sequencing instruments. For each library, the coverage for every haplotype is 40x.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s007">
      <label>S7 Fig</label>
      <caption>
        <title>Distribution of the number of variants covered by Roche 454 reads.</title>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s008">
      <label>S8 Fig</label>
      <caption>
        <title>Comparing the accuracy of the methods on real and simulated sweet potato data.</title>
        <p>The data are categorized into the five different categories: very short, short, medium-size, long, and very long. The real data does not contain the very long category because it is done by Roche 454 reads, which are limited in size.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s009">
      <label>S9 Fig</label>
      <caption>
        <title><italic>Ranbow</italic> and <italic>H-PoP</italic> compared in terms of reconstructed haplotype length measured in base pairs.</title>
        <p>Data is based on <italic>All</italic><sub>350<italic>bp</italic></sub> generated for CBU genome. Five violin plots represent measurements for five genome lengths and y-axis reports haplotype length in base pairs.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s010">
      <label>S10 Fig</label>
      <caption>
        <title>Length and frequency distribution of assembled haplotypes by different insert size on simulated sweet potato data.</title>
        <p>The x-axis shows different insert sizes. The y-axis depicts the number of matches in the assembled haplotype. The width of the violin plots shows the distribution of the number of assembled haplotypes within the groups. Except for the <italic>350bp</italic> group, in which <bold><italic>H-PoP</italic></bold> performs better, <bold><italic>Ranbow</italic></bold> outperforms in all groups including the collection of all insert sizes, which is depicted in the <italic>All</italic> group.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s010.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s011">
      <label>S11 Fig</label>
      <caption>
        <title>Match-mismatch plot for assembled haplotypes using Roche 454 reads.</title>
        <p>The color of each dot represents how many pairs of 454 reads with its corresponding assembled haplotype have a certain number of matches (<italic>x</italic>-axis) and mismatches (<italic>y</italic>-axis).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s011.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s012">
      <label>S1 Text</label>
      <caption>
        <title>Simulated data.</title>
        <p>This section explains the procedure for generating simulated data.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s013">
      <label>S2 Text</label>
      <caption>
        <title>Usability of different tools.</title>
        <p>This section compares the usability of competing methods.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007843.s014">
      <label>S1 Table</label>
      <caption>
        <title>Running time in second for <inline-formula id="pcbi.1007843.e021"><alternatives><graphic xlink:href="pcbi.1007843.e021.jpg" id="pcbi.1007843.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mrow><mml:mi>A</mml:mi><mml:mi>l</mml:mi><mml:msubsup><mml:mi>l</mml:mi><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <italic>All</italic><sub>350<italic>bp</italic></sub> datasets.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007843.s014.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007843.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Venter</surname><given-names>JC</given-names></name>, <name><surname>Adams</surname><given-names>MD</given-names></name>, <name><surname>Myers</surname><given-names>EW</given-names></name>, <name><surname>Li</surname><given-names>PW</given-names></name>, <name><surname>Mural</surname><given-names>RJ</given-names></name>, <name><surname>Sutton</surname><given-names>GG</given-names></name>, <etal>et al</etal><article-title>The sequence of the human genome</article-title>. <source>science</source>. <year>2001</year>;<volume>291</volume>(<issue>5507</issue>):<fpage>1304</fpage>–<lpage>1351</lpage>. <pub-id pub-id-type="doi">10.1126/science.1058040</pub-id><?supplied-pmid 11181995?><pub-id pub-id-type="pmid">11181995</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Adams</surname><given-names>MD</given-names></name>, <name><surname>Celniker</surname><given-names>SE</given-names></name>, <name><surname>Holt</surname><given-names>RA</given-names></name>, <name><surname>Evans</surname><given-names>CA</given-names></name>, <name><surname>Gocayne</surname><given-names>JD</given-names></name>, <name><surname>Amanatides</surname><given-names>PG</given-names></name>, <etal>et al</etal><article-title>The genome sequence of Drosophila melanogaster</article-title>. <source>Science</source>. <year>2000</year>;<volume>287</volume>(<issue>5461</issue>):<fpage>2185</fpage>–<lpage>2195</lpage>. <pub-id pub-id-type="doi">10.1126/science.287.5461.2185</pub-id><?supplied-pmid 10731132?><pub-id pub-id-type="pmid">10731132</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><collab>of Scientists GKC</collab>. <article-title>Genome 10K: a proposal to obtain whole-genome sequence for 10 000 vertebrate species</article-title>. <source>Journal of Heredity</source>. <year>2009</year>;<volume>100</volume>(<issue>6</issue>):<fpage>659</fpage>–<lpage>674</lpage>. <pub-id pub-id-type="doi">10.1093/jhered/esp086</pub-id><?supplied-pmid 19892720?><pub-id pub-id-type="pmid">19892720</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Tewhey</surname><given-names>R</given-names></name>, <name><surname>Bansal</surname><given-names>V</given-names></name>, <name><surname>Torkamani</surname><given-names>A</given-names></name>, <name><surname>Topol</surname><given-names>EJ</given-names></name>, <name><surname>Schork</surname><given-names>NJ</given-names></name>. <article-title>The importance of phase information for human genomics</article-title>. <source>Nature Reviews Genetics</source>. <year>2011</year>;<volume>12</volume>(<issue>3</issue>):<fpage>215</fpage><pub-id pub-id-type="doi">10.1038/nrg2950</pub-id><?supplied-pmid 21301473?><pub-id pub-id-type="pmid">21301473</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Levy</surname><given-names>S</given-names></name>, <name><surname>Sutton</surname><given-names>G</given-names></name>, <name><surname>Ng</surname><given-names>PC</given-names></name>, <name><surname>Feuk</surname><given-names>L</given-names></name>, <name><surname>Halpern</surname><given-names>AL</given-names></name>, <name><surname>Walenz</surname><given-names>BP</given-names></name>, <etal>et al</etal><article-title>The diploid genome sequence of an individual human</article-title>. <source>PLoS Biology</source>. <year>2007</year>;<volume>5</volume>(<issue>10</issue>):<fpage>e254</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.0050254</pub-id><?supplied-pmid 17803354?><pub-id pub-id-type="pmid">17803354</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Browning</surname><given-names>SR</given-names></name>, <name><surname>Browning</surname><given-names>BL</given-names></name>. <article-title>Haplotype phasing: existing methods and new developments</article-title>. <source>Nature Reviews Genetics</source>. <year>2011</year>;<volume>12</volume>(<issue>10</issue>):<fpage>703</fpage><pub-id pub-id-type="doi">10.1038/nrg3054</pub-id><?supplied-pmid 21921926?><pub-id pub-id-type="pmid">21921926</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Krawitz</surname><given-names>PM</given-names></name>, <name><surname>Schweiger</surname><given-names>MR</given-names></name>, <name><surname>Rödelsperger</surname><given-names>C</given-names></name>, <name><surname>Marcelis</surname><given-names>C</given-names></name>, <name><surname>Kölsch</surname><given-names>U</given-names></name>, <name><surname>Meisel</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Identity-by-descent filtering of exome sequence data identifies PIGV mutations in hyperphosphatasia mental retardation syndrome</article-title>. <source>Nature genetics</source>. <year>2010</year>;<volume>42</volume>(<issue>10</issue>):<fpage>827</fpage>–<lpage>829</lpage>. <pub-id pub-id-type="doi">10.1038/ng.653</pub-id><?supplied-pmid 20802478?><pub-id pub-id-type="pmid">20802478</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Scott</surname><given-names>LJ</given-names></name>, <name><surname>Mohlke</surname><given-names>KL</given-names></name>, <name><surname>Bonnycastle</surname><given-names>LL</given-names></name>, <name><surname>Willer</surname><given-names>CJ</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Duren</surname><given-names>WL</given-names></name>, <etal>et al</etal><article-title>A genome-wide association study of type 2 diabetes in Finns detects multiple susceptibility variants</article-title>. <source>science</source>. <year>2007</year>;<volume>316</volume>(<issue>5829</issue>):<fpage>1341</fpage>–<lpage>1345</lpage>. <pub-id pub-id-type="doi">10.1126/science.1142382</pub-id><?supplied-pmid 17463248?><pub-id pub-id-type="pmid">17463248</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Consortium</surname><given-names>WTCC</given-names></name>, <etal>et al</etal><article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3,000 shared controls</article-title>. <source>Nature</source>. <year>2007</year>;<volume>447</volume>(<issue>7145</issue>):<fpage>661</fpage><pub-id pub-id-type="doi">10.1038/nature05911</pub-id><pub-id pub-id-type="pmid">17554300</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Marchini</surname><given-names>J</given-names></name>, <name><surname>Howie</surname><given-names>B</given-names></name>. <article-title>Genotype imputation for genome-wide association studies</article-title>. <source>Nature Reviews Genetics</source>. <year>2010</year>;<volume>11</volume>(<issue>7</issue>):<fpage>499</fpage>–<lpage>511</lpage>. <pub-id pub-id-type="doi">10.1038/nrg2796</pub-id><?supplied-pmid 20517342?><pub-id pub-id-type="pmid">20517342</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Tarpine</surname><given-names>R</given-names></name>, <name><surname>Lam</surname><given-names>F</given-names></name>, <name><surname>Istrail</surname><given-names>S</given-names></name>. <article-title>Conservative Extensions of Linkage Disequilibrium Measures from Pairwise to Multi-loci and Algorithms for Optimal Tagging SNP Selection</article-title>. <source>Lecture Notes in Computer Science</source>. <year>2011</year>;<volume>6577</volume>:<fpage>468</fpage>–<lpage>482</lpage>. <pub-id pub-id-type="doi">10.1007/978-3-642-20036-6_42</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Roach</surname><given-names>JC</given-names></name>, <name><surname>Glusman</surname><given-names>G</given-names></name>, <name><surname>Smit</surname><given-names>AF</given-names></name>, <name><surname>Huff</surname><given-names>CD</given-names></name>, <name><surname>Hubley</surname><given-names>R</given-names></name>, <name><surname>Shannon</surname><given-names>PT</given-names></name>, <etal>et al</etal><article-title>Analysis of genetic inheritance in a family quartet by whole-genome sequencing</article-title>. <source>Science</source>. <year>2010</year>;<volume>328</volume>(<issue>5978</issue>):<fpage>636</fpage>–<lpage>639</lpage>. <pub-id pub-id-type="doi">10.1126/science.1186802</pub-id><?supplied-pmid 20220176?><pub-id pub-id-type="pmid">20220176</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Kasowski</surname><given-names>M</given-names></name>, <name><surname>Grubert</surname><given-names>F</given-names></name>, <name><surname>Heffelfinger</surname><given-names>C</given-names></name>, <name><surname>Hariharan</surname><given-names>M</given-names></name>, <name><surname>Asabere</surname><given-names>A</given-names></name>, <name><surname>Waszak</surname><given-names>SM</given-names></name>, <etal>et al</etal><article-title>Variation in transcription factor binding among humans</article-title>. <source>Science</source>. <year>2010</year>;<volume>328</volume>(<issue>5975</issue>):<fpage>232</fpage>–<lpage>235</lpage>. <pub-id pub-id-type="doi">10.1126/science.1183621</pub-id><?supplied-pmid 20299548?><pub-id pub-id-type="pmid">20299548</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Moeinzadeh</surname><given-names>MH</given-names></name>, <name><surname>Kuhl</surname><given-names>H</given-names></name>, <name><surname>Helmuth</surname><given-names>J</given-names></name>, <name><surname>Xiao</surname><given-names>P</given-names></name>, <name><surname>Haas</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>Haplotype-resolved sweet potato genome traces back its hexaploidization history</article-title>. <source>Nature Plants</source>. <year>2017</year>;<volume>3</volume>(<issue>9</issue>):<fpage>696</fpage><pub-id pub-id-type="doi">10.1038/s41477-017-0002-z</pub-id><?supplied-pmid 28827752?><pub-id pub-id-type="pmid">28827752</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Scheet</surname><given-names>P</given-names></name>, <name><surname>Stephens</surname><given-names>M</given-names></name>. <article-title>Linkage disequilibrium-based quality control for large-scale genetic studies</article-title>. <source>PLoS genetics</source>. <year>2008</year>;<volume>4</volume>(<issue>8</issue>):<fpage>e1000147</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1000147</pub-id><?supplied-pmid 18670630?><pub-id pub-id-type="pmid">18670630</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Consortium</surname><given-names>PGS</given-names></name>, <etal>et al</etal><article-title>Genome sequence and analysis of the tuber crop potato</article-title>. <source>Nature</source>. <year>2011</year>;<volume>475</volume>(<issue>7355</issue>):<fpage>189</fpage><pub-id pub-id-type="doi">10.1038/nature10158</pub-id><pub-id pub-id-type="pmid">21743474</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Brenchley</surname><given-names>R</given-names></name>, <name><surname>Spannagl</surname><given-names>M</given-names></name>, <name><surname>Pfeifer</surname><given-names>M</given-names></name>, <name><surname>Barker</surname><given-names>GL</given-names></name>, <name><surname>D’Amore</surname><given-names>R</given-names></name>, <name><surname>Allen</surname><given-names>AM</given-names></name>, <etal>et al</etal><article-title>Analysis of the bread wheat genome using whole-genome shotgun sequencing</article-title>. <source>Nature</source>. <year>2012</year>;<volume>491</volume>(<issue>7426</issue>):<fpage>705</fpage><pub-id pub-id-type="doi">10.1038/nature11650</pub-id><?supplied-pmid 23192148?><pub-id pub-id-type="pmid">23192148</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Claros</surname><given-names>MG</given-names></name>, <name><surname>Bautista</surname><given-names>R</given-names></name>, <name><surname>Guerrero-Fernández</surname><given-names>D</given-names></name>, <name><surname>Benzerki</surname><given-names>H</given-names></name>, <name><surname>Seoane</surname><given-names>P</given-names></name>, <name><surname>Fernández-Pozo</surname><given-names>N</given-names></name>. <article-title>Why assembling plant genome sequences is so challenging</article-title>. <source>Biology</source>. <year>2012</year>;<volume>1</volume>(<issue>2</issue>):<fpage>439</fpage>–<lpage>459</lpage>. <pub-id pub-id-type="doi">10.3390/biology1020439</pub-id><?supplied-pmid 24832233?><pub-id pub-id-type="pmid">24832233</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Gusfield</surname><given-names>D</given-names></name>. <article-title>Inference of haplotypes from samples of diploid populations: complexity and algorithms</article-title>. <source>Journal of computational biology</source>. <year>2001</year>;<volume>8</volume>(<issue>3</issue>):<fpage>305</fpage>–<lpage>323</lpage>. <pub-id pub-id-type="doi">10.1089/10665270152530863</pub-id><?supplied-pmid 11535178?><pub-id pub-id-type="pmid">11535178</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Clark</surname><given-names>AG</given-names></name>. <article-title>Inference of haplotypes from PCR-amplified samples of diploid populations</article-title>. <source>Molecular biology and evolution</source>. <year>1990</year>;<volume>7</volume>(<issue>2</issue>):<fpage>111</fpage>–<lpage>122</lpage>. <?supplied-pmid 2108305?><pub-id pub-id-type="pmid">2108305</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Browning</surname><given-names>BL</given-names></name>, <name><surname>Browning</surname><given-names>SR</given-names></name>. <article-title>A unified approach to genotype imputation and haplotype-phase inference for large data sets of trios and unrelated individuals</article-title>. <source>The American Journal of Human Genetics</source>. <year>2009</year>;<volume>84</volume>(<issue>2</issue>):<fpage>210</fpage>–<lpage>223</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2009.01.005</pub-id><?supplied-pmid 19200528?><pub-id pub-id-type="pmid">19200528</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Ribeiro</surname><given-names>FJ</given-names></name>, <name><surname>Przybylski</surname><given-names>D</given-names></name>, <name><surname>Yin</surname><given-names>S</given-names></name>, <name><surname>Sharpe</surname><given-names>T</given-names></name>, <name><surname>Gnerre</surname><given-names>S</given-names></name>, <name><surname>Abouelleil</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Finished bacterial genomes from shotgun sequence data</article-title>. <source>Genome research</source>. <year>2012</year>;<volume>22</volume>(<issue>11</issue>):<fpage>2270</fpage>–<lpage>2277</lpage>. <pub-id pub-id-type="doi">10.1101/gr.141515.112</pub-id><?supplied-pmid 22829535?><pub-id pub-id-type="pmid">22829535</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Kajitani</surname><given-names>R</given-names></name>, <name><surname>Toshimoto</surname><given-names>K</given-names></name>, <name><surname>Noguchi</surname><given-names>H</given-names></name>, <name><surname>Toyoda</surname><given-names>A</given-names></name>, <name><surname>Ogura</surname><given-names>Y</given-names></name>, <name><surname>Okuno</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Efficient de novo assembly of highly heterozygous genomes from whole-genome shotgun short reads</article-title>. <source>Genome research</source>. <year>2014</year>;<volume>24</volume>(<issue>8</issue>):<fpage>1384</fpage>–<lpage>1395</lpage>. <pub-id pub-id-type="doi">10.1101/gr.170720.113</pub-id><?supplied-pmid 24755901?><pub-id pub-id-type="pmid">24755901</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Baaijens</surname><given-names>JA</given-names></name>, <name><surname>Schönhuth</surname><given-names>A</given-names></name>. <article-title>Overlap graph-based generation of haplotigs for diploids and polyploids</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>(<issue>21</issue>):<fpage>4281</fpage>–<lpage>4289</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btz255</pub-id><?supplied-pmid 30994902?><pub-id pub-id-type="pmid">30994902</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Bansal</surname><given-names>V</given-names></name>, <name><surname>Bafna</surname><given-names>V</given-names></name>. <article-title>HapCUT: an efficient and accurate algorithm for the haplotype assembly problem</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>16</issue>):<fpage>i153</fpage>–<lpage>i159</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btn298</pub-id><?supplied-pmid 18689818?><pub-id pub-id-type="pmid">18689818</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Berger</surname><given-names>E</given-names></name>, <name><surname>Yorukoglu</surname><given-names>D</given-names></name>, <name><surname>Peng</surname><given-names>J</given-names></name>, <name><surname>Berger</surname><given-names>B</given-names></name>. <article-title>Haptree: A novel bayesian framework for single individual polyplotyping using NGS data</article-title>. <source>PLoS Computational Biology</source>. <year>2014</year>;<volume>10</volume>(<issue>3</issue>):<fpage>e1003502</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003502</pub-id><?supplied-pmid 24675685?><pub-id pub-id-type="pmid">24675685</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Aguiar</surname><given-names>D</given-names></name>, <name><surname>Istrail</surname><given-names>S</given-names></name>. <article-title>Haplotype assembly in polyploid genomes and identical by descent shared tracts</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>13</issue>):<fpage>i352</fpage>–<lpage>i360</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt213</pub-id><?supplied-pmid 23813004?><pub-id pub-id-type="pmid">23813004</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Xie</surname><given-names>M</given-names></name>, <name><surname>Wu</surname><given-names>Q</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Jiang</surname><given-names>T</given-names></name>. <article-title>H-PoP and H-PoPG: heuristic partitioning algorithms for single individual haplotyping of polyploids</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>24</issue>):<fpage>3735</fpage>–<lpage>3744</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw537</pub-id><?supplied-pmid 27531103?><pub-id pub-id-type="pmid">27531103</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Das</surname><given-names>S</given-names></name>, <name><surname>Vikalo</surname><given-names>H</given-names></name>. <article-title>SDhaP: haplotype assembly for diploids and polyploids via semi-definite programming</article-title>. <source>BMC genomics</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>260</fpage><pub-id pub-id-type="doi">10.1186/s12864-015-1408-5</pub-id><?supplied-pmid 25885901?><pub-id pub-id-type="pmid">25885901</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Lippert</surname><given-names>R</given-names></name>, <name><surname>Schwartz</surname><given-names>R</given-names></name>, <name><surname>Lancia</surname><given-names>G</given-names></name>, <name><surname>Istrail</surname><given-names>S</given-names></name>. <article-title>Algorithmic strategies for the single nucleotide polymorphism haplotype assembly problem</article-title>. <source>Briefings in bioinformatics</source>. <year>2002</year>;<volume>3</volume>(<issue>1</issue>):<fpage>23</fpage>–<lpage>31</lpage>. <pub-id pub-id-type="doi">10.1093/bib/3.1.23</pub-id><?supplied-pmid 12002221?><pub-id pub-id-type="pmid">12002221</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref031">
      <label>31</label>
      <mixed-citation publication-type="other">Lancia G, Bafna V, Istrail S, Lippert R, Schwartz R. SNPs problems, complexity, and algorithms. In: European symposium on algorithms. Springer; 2001. p. 182–193.</mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Duitama</surname><given-names>J</given-names></name>, <name><surname>McEwen</surname><given-names>GK</given-names></name>, <name><surname>Huebsch</surname><given-names>T</given-names></name>, <name><surname>Palczewski</surname><given-names>S</given-names></name>, <name><surname>Schulz</surname><given-names>S</given-names></name>, <name><surname>Verstrepen</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Fosmid-based whole genome haplotyping of a HapMap trio child: evaluation of Single Individual Haplotyping techniques</article-title>. <source>Nucleic Acids Research</source>. <year>2012</year>;<volume>40</volume>(<issue>5</issue>):<fpage>2041</fpage>–<lpage>2053</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkr1042</pub-id><?supplied-pmid 22102577?><pub-id pub-id-type="pmid">22102577</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Xie</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Jiang</surname><given-names>T</given-names></name>. <article-title>A fast and accurate algorithm for single individual haplotyping</article-title>. In: <source>BMC systems biology</source>. <volume>vol. 6</volume> BioMed Central; <year>2012</year> p. <fpage>S8</fpage>
<pub-id pub-id-type="doi">10.1186/1752-0509-6-S2-S8</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Bafna</surname><given-names>V</given-names></name>, <name><surname>Istrail</surname><given-names>S</given-names></name>, <name><surname>Lancia</surname><given-names>G</given-names></name>, <name><surname>Rizzi</surname><given-names>R</given-names></name>. <article-title>Polynomial and APX-hard cases of the individual haplotyping problem</article-title>. <source>Theoretical Computer Science</source>. <year>2005</year>;<volume>335</volume>(<issue>1</issue>):<fpage>109</fpage>–<lpage>125</lpage>. <pub-id pub-id-type="doi">10.1016/j.tcs.2004.12.017</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Bourke</surname><given-names>PM</given-names></name>, <name><surname>Voorrips</surname><given-names>RE</given-names></name>, <name><surname>Visser</surname><given-names>RG</given-names></name>, <name><surname>Maliepaard</surname><given-names>C</given-names></name>. <article-title>Tools for genetic studies in experimental populations of polyploids</article-title>. <source>Frontiers in plant science</source>. <year>2018</year>;<volume>9</volume>:<fpage>513</fpage><pub-id pub-id-type="doi">10.3389/fpls.2018.00513</pub-id><?supplied-pmid 29720992?><pub-id pub-id-type="pmid">29720992</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Claros</surname><given-names>MG</given-names></name>, <name><surname>Bautista</surname><given-names>R</given-names></name>, <name><surname>Guerrero-Fernández</surname><given-names>D</given-names></name>, <name><surname>Benzerki</surname><given-names>H</given-names></name>, <name><surname>Seoane</surname><given-names>P</given-names></name>, <name><surname>Fernández-Pozo</surname><given-names>N</given-names></name>. <article-title>Why assembling plant genome sequences is so challenging</article-title>. <source>Biology</source>. <year>2012</year>;<volume>1</volume>(<issue>2</issue>):<fpage>439</fpage>–<lpage>459</lpage>. <pub-id pub-id-type="doi">10.3390/biology1020439</pub-id><?supplied-pmid 24832233?><pub-id pub-id-type="pmid">24832233</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Gerard</surname><given-names>D</given-names></name>, <name><surname>Ferrão</surname><given-names>LFV</given-names></name>, <name><surname>Garcia</surname><given-names>AAF</given-names></name>, <name><surname>Stephens</surname><given-names>M</given-names></name>. <article-title>Genotyping polyploids from messy sequencing data</article-title>. <source>Genetics</source>. <year>2018</year>;<volume>210</volume>(<issue>3</issue>):<fpage>789</fpage>–<lpage>807</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.118.301468</pub-id><?supplied-pmid 30185430?><pub-id pub-id-type="pmid">30185430</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Motazedi</surname><given-names>E</given-names></name>, <name><surname>Finkers</surname><given-names>R</given-names></name>, <name><surname>Maliepaard</surname><given-names>C</given-names></name>, <name><surname>de Ridder</surname><given-names>D</given-names></name>. <article-title>Exploiting next-generation sequencing to solve the haplotyping puzzle in polyploids: a simulation study</article-title>. <source>Briefings in bioinformatics</source>. <year>2018</year>;<volume>19</volume>(<issue>3</issue>):<fpage>387</fpage>–<lpage>403</lpage>. <?supplied-pmid 28065918?><pub-id pub-id-type="pmid">28065918</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref039">
      <label>39</label>
      <mixed-citation publication-type="other">Motazedi E. haplogenerator; 2018. <ext-link ext-link-type="uri" xlink:href="https://github.com/EhsanMotazedi/Haplosim/blob/master/haplogenerator.py">https://github.com/EhsanMotazedi/Haplosim/blob/master/haplogenerator.py</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Myers</surname><given-names>JR</given-names></name>, <name><surname>Marth</surname><given-names>GT</given-names></name>. <article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>28</volume>(<issue>4</issue>):<fpage>593</fpage>–<lpage>594</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id><?supplied-pmid 22199392?><pub-id pub-id-type="pmid">22199392</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref041">
      <label>41</label>
      <mixed-citation publication-type="other">Li H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM. arXiv preprint arXiv:13033997. 2013.</mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref042">
      <label>42</label>
      <mixed-citation publication-type="other">Garrison E, Marth G. Haplotype-based variant detection from short-read sequencing. Preprint at <ext-link ext-link-type="uri" xlink:href="http://arxivorg/abs/12073907v2">http://arxivorg/abs/12073907v2</ext-link>. 2012.</mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Kasianov</surname><given-names>AS</given-names></name>, <name><surname>Klepikova</surname><given-names>AV</given-names></name>, <name><surname>Kulakovskiy</surname><given-names>IV</given-names></name>, <name><surname>Gerasimov</surname><given-names>ES</given-names></name>, <name><surname>Fedotova</surname><given-names>AV</given-names></name>, <name><surname>Besedina</surname><given-names>EG</given-names></name>, <etal>et al</etal><article-title>High quality genome assembly of <italic>Capsella bursa-pastoris</italic> reveals asymmetry of regulatory elements at early stages of polyploid genome evolution</article-title>. <source>The Plant Journal</source>. <year>2017</year><pub-id pub-id-type="doi">10.1111/tpj.13563</pub-id><?supplied-pmid 28387959?><pub-id pub-id-type="pmid">28387959</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Geraci</surname><given-names>F</given-names></name>. <article-title>A comparison of several algorithms for the single individual SNP haplotyping reconstruction problem</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>18</issue>):<fpage>2217</fpage>–<lpage>2225</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq411</pub-id><?supplied-pmid 20624781?><pub-id pub-id-type="pmid">20624781</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007843.ref045">
      <label>45</label>
      <mixed-citation publication-type="other">Janin L. Enhanced Artificial Genome Engine: next generation sequencing reads simulator. GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://githubcom/sequencing/EAGLE">https://githubcom/sequencing/EAGLE</ext-link>. 2014;commit:a3215138846ca3bd969093214163ede015835a10.</mixed-citation>
    </ref>
  </ref-list>
</back>
