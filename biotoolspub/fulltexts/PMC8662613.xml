<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Mol Biol Evol</journal-id>
    <journal-id journal-id-type="publisher-id">molbev</journal-id>
    <journal-title-group>
      <journal-title>Molecular Biology and Evolution</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0737-4038</issn>
    <issn pub-type="epub">1537-1719</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8662613</article-id>
    <article-id pub-id-type="doi">10.1093/molbev/msab293</article-id>
    <article-id pub-id-type="publisher-id">msab293</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Resources</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01130</subject>
        <subject>AcademicSubjects/SCI01180</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>eggNOG-mapper v2: Functional Annotation, Orthology Assignments, and Domain Prediction at the Metagenomic Scale</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5263-533X</contrib-id>
        <name>
          <surname>Cantalapiedra</surname>
          <given-names>Carlos P</given-names>
        </name>
        <xref rid="msab293-aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hernández-Plaza</surname>
          <given-names>Ana</given-names>
        </name>
        <xref rid="msab293-aff1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Letunic</surname>
          <given-names>Ivica</given-names>
        </name>
        <xref rid="msab293-aff2" ref-type="aff">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bork</surname>
          <given-names>Peer</given-names>
        </name>
        <xref rid="msab293-cor1" ref-type="corresp"/>
        <xref rid="msab293-aff3" ref-type="aff">3</xref>
        <xref rid="msab293-aff4" ref-type="aff">4</xref>
        <xref rid="msab293-aff5" ref-type="aff">5</xref>
        <!--bork@embl.de-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huerta-Cepas</surname>
          <given-names>Jaime</given-names>
        </name>
        <xref rid="msab293-cor1" ref-type="corresp"/>
        <xref rid="msab293-aff1" ref-type="aff">1</xref>
        <!--huerta.jaime@inia.es-->
      </contrib>
    </contrib-group>
    <aff id="msab293-aff1"><label>1</label><institution>Centro de Biotecnologia y Genomica de Plantas, Universidad Politécnica de Madrid (UPM) – Instituto Nacional de Investigación y Tecnología Agraria y Alimentaria (INIA), Campus de Montegancedo-UPM</institution>, Madrid, <country country="ES">Spain</country></aff>
    <aff id="msab293-aff2"><label>2</label><institution>Biobyte Solutions GmbH</institution>, Heidelberg, <country country="DE">Germany</country></aff>
    <aff id="msab293-aff3"><label>3</label><institution>European Molecular Biology Laboratory, Structural and Computational Biology Unit</institution>, Heidelberg, <country country="DE">Germany</country></aff>
    <aff id="msab293-aff4"><label>4</label><institution>Department of Bioinformatics, Biocenter, University of Würzburg</institution>, Würzburg, <country country="DE">Germany</country></aff>
    <aff id="msab293-aff5"><label>5</label><institution>Yonsei Frontier Lab (YFL), Yonsei University</institution>, Seoul, South <country country="KR">Korea</country></aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Tamura</surname>
          <given-names>Koichiro</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="msab293-cor1"><bold>Corresponding authors:</bold> E-mails: <email>huerta.jaime@inia.es</email>; <email>bork@embl.de</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-10-01">
      <day>01</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <volume>38</volume>
    <issue>12</issue>
    <fpage>5825</fpage>
    <lpage>5829</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press on behalf of the Society for Molecular Biology and Evolution.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="msab293.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Even though automated functional annotation of genes represents a fundamental step in most genomic and metagenomic workflows, it remains challenging at large scales. Here, we describe a major upgrade to eggNOG-mapper, a tool for functional annotation based on precomputed orthology assignments, now optimized for vast (meta)genomic data sets. Improvements in version 2 include a full update of both the genomes and functional databases to those from eggNOG v5, as well as several efficiency enhancements and new features. Most notably, eggNOG-mapper v2 now allows for: 1) de novo gene prediction from raw contigs, 2) built-in pairwise orthology prediction, 3) fast protein domain discovery, and 4) automated GFF decoration. eggNOG-mapper v2 is available as a standalone tool or as an online service at <ext-link xlink:href="http://eggnog-mapper.embl.de" ext-link-type="uri">http://eggnog-mapper.embl.de</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>metagenomics</kwd>
      <kwd>functional annotation</kwd>
      <kwd>computational genomics</kwd>
      <kwd>bioinformatics</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Programme for Fostering Excellence in Scientific and Technical Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PGC2018-098073-A-I00</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Severo Ochoa Centres of Excellence Programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>SEV-2016-0672</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>State Research Agency</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Research Technical Support Staff Aid</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PTA2019-017593-I/AEI/10.13039/501100011033</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/100010663</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>ERC-2014-AdG)—GA669830</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>BMBF</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002347</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>#031A537B</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>Introduction</title>
    <p>Inference of gene function via orthology, rather than by homology detection, is generally considered the most reliable approach for transferring functional information between molecular sequences, as orthologs are expected to retain function more often than paralogs (<xref rid="msab293-B3" ref-type="bibr">Gabaldón and Koonin 2013</xref>; <xref rid="msab293-B5" ref-type="bibr">Glover et al. 2019</xref>). However, since delineating orthology is highly demanding (both computationally and algorithmically), most automated methods rely on homology-based annotations (<xref rid="msab293-B6" ref-type="bibr">Götz et al. 2008</xref>; <xref rid="msab293-B19" ref-type="bibr">Seemann 2014</xref>; <xref rid="msab293-B2" ref-type="bibr">Blum et al. 2021</xref>). EggNOG-mapper relies on the eggNOG database (<xref rid="msab293-B15350958" ref-type="bibr">Huerta-Cepas et al. 2019</xref>) of orthologs groups (OGs), covering thousands of bacterial, archaeal, and eukaryotic organisms. For this, it takes advantage of the precomputed phylogenies inferred for each OG to efficiently refine orthology assignments and therefore minimize the transferring of annotations from putative in-paralogs. The method was originally proven to provide more accurate predictions than homology-based approaches (<xref rid="msab293-B7" ref-type="bibr">Huerta-Cepas et al. 2017</xref>), while preserving computational performance at the genomic and metagenomic scale. Here, we present eggNOG-mapper v2, a major upgrade featuring improvements in annotation coverage, overall performance, and program capabilities (<xref rid="msab293-F1" ref-type="fig">fig. 1</xref>).</p>
    <fig position="float" id="msab293-F1">
      <label>Fig. 1</label>
      <caption>
        <p>Workflow and new features of eggNOG-mapper v2. (<italic toggle="yes">A</italic>) The gene prediction stage uses Prodigal to perform protein prediction from assembled contigs. (<italic toggle="yes">B</italic>) During the search stage, HMMER3, Diamond, or MMseqs2 can be used to align the input proteins to eggNOG v5. (<italic toggle="yes">C</italic>) During the orthology inference stage, a report of orthologs is generated based on the desired taxonomic scope. (<italic toggle="yes">D</italic>) Finally, protein annotations and domains are transferred from orthologs to the queries and reported as tabular and GFF files.</p>
      </caption>
      <graphic xlink:href="msab293f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>Coverage and Performance Improvements</title>
    <p>The underlying genome database has been updated to be in sync with eggNOG v5, spanning 4.4 million OGs and more than twice the number of organisms than in the previous version. This improvement increases annotation coverage and phylogenetic resolution, particularly noticeable when analyzing large metagenomic data sets. For instance, the reannotation of 1.75 million proteins randomly subsampled from a human-gut metagenomic gene catalog (<xref rid="msab293-B1" ref-type="bibr">Almeida et al. 2021</xref>) yielded a 3.23% increase in annotation coverage (56,569 newly annotated proteins), compared with eggNOG-mapper version 1. The phylogenetic resolution was also improved, obtaining significantly better alignment scores for the query sequences than previous versions (Wilcoxon test W = 1.2E + 12, <italic toggle="yes">P</italic>-value &lt; 2.2E − 16). Moreover, although the underlying databases have doubled in size, eggNOG-mapper v2 improves the annotation rate (annotated queries per second) by 16% on average, compared with previous versions. The most important changes regarding computational enhancements relate to database optimizations, allowing for faster queries and parallelization, and a new memory-based mode that significantly reduces the impact of slow I/O disk operations. Taken together, these changes improve annotation rates by 608% on average, with respect to eggNOG-mapper v1 (<xref rid="msab293-F2" ref-type="fig">fig. 2<italic toggle="yes">A</italic></xref>). Compared with Prokka (<xref rid="msab293-B19" ref-type="bibr">Seemann 2014</xref>), one of the fastest annotation tools available for prokaryotic genomes according to recent benchmarks (<xref rid="msab293-B20" ref-type="bibr">Shaffer et al. 2020</xref>), eggNOG-mapper runs faster, especially on large metagenomic data sets (<xref rid="msab293-F2" ref-type="fig">fig. 2<italic toggle="yes">B</italic></xref>).</p>
    <fig position="float" id="msab293-F2">
      <label>Fig. 2</label>
      <caption>
        <p>Performance of eggNOG-mapper v2. (<italic toggle="yes">A</italic>) average minutes to annotate input proteomes. EggNOG-mapper v2 (blue) against eggNOG-mapper v1 (red). (<italic toggle="yes">B</italic>) average minutes to annotate input genomes. EggNOG-mapper v2 (blue) against Prokka (green). (<italic toggle="yes">C</italic>) average minutes (in log scale) to annotate input proteins. MMseqs2 (-s 2,4,6; black) against Diamond (iterate/sensitive mode; orange). (<italic toggle="yes">D</italic>) Specificity (Sp), recall (Re), and F<sub>1</sub> score, of PFAM domain annotation either from direct transference from orthologs, or after realignment. Full de novo realignment results were used as reference. (<italic toggle="yes">E</italic>) average minutes for PFAM domain annotation, using either PFAM full de novo (brown) or realign to orthologs domains (blue) modes. Benchmark setup: tests in (<italic toggle="yes">A</italic>) and (<italic toggle="yes">B</italic>) were done on 20 sets of 1–100 random proteomes (<italic toggle="yes">A</italic>) or genomes (<italic toggle="yes">B</italic>) from (<xref rid="msab293-B1" ref-type="bibr">Almeida et al. 2021</xref>), and executed using 10 CPUs and 80 GB of RAM. Tests in (<italic toggle="yes">C</italic>) were done on 35 random sets of 10–10,000,000 proteins from Progenomes v2 (<xref rid="msab293-B12" ref-type="bibr">Mende et al. 2020</xref>), using 30 CPUs and 240 GB of RAM. Tests in (<italic toggle="yes">Dm</italic>) and (<italic toggle="yes">E</italic>) as in (<italic toggle="yes">C</italic>), only for sets of 10–100,000 proteins.</p>
      </caption>
      <graphic xlink:href="msab293f2" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>ORF Prediction</title>
    <p>Another major capability added to the new eggNOG-mapper workflow is predicting ORFs directly from assembled contigs (<xref rid="msab293-F1" ref-type="fig">fig. 1<italic toggle="yes">A</italic></xref>). ORF detection, only available for prokaryotic assemblies, is performed using Prodigal (<xref rid="msab293-B8" ref-type="bibr">Hyatt et al. 2010</xref>), which provides the protein sequences to be used by eggNOG-mapper for functional annotation. Prodigal modes (“normal,” “anonymous,” and “training”) as well as custom translation tables can be further chosen by the user.</p>
  </sec>
  <sec>
    <title>Sequence Mapping Modes</title>
    <p>Additionally, we have broadened the options for the initial sequence-mapping step carried out by eggNOG-mapper (<xref rid="msab293-F1" ref-type="fig">fig. 1<italic toggle="yes">B</italic></xref>). Now, Diamond, MMseqs2, and HMMER3 (<xref rid="msab293-B15" ref-type="bibr">Mistry et al. 2013</xref>) modes are available, each recommended for different use cases. The default Diamond mode provides the best balance between speed and memory consumption. EggNOG-mapper v2 also implements the new Diamond mode ‘–iterate’, which iteratively applies different levels of sensitivity. Using the new –iterate mode, Diamond is twice as fast as MMseqs2 for query sets of 1,000,000, and three times faster for 10,000,000 sequences. The MMseqs2 mode provides faster results than Diamond (<xref rid="msab293-F2" ref-type="fig">fig. 2<italic toggle="yes">C</italic></xref>) for query sets up to 100,000 sequences for comparable sensitivity. When input data are nucleotide sequences, a direct translation is done assuming they represent coding sequences starting in an open reading frame. Alternatively, both Diamond and MMseqs2 can be executed in blastx-like mode, particularly useful when using sequencing reads as input data. For the annotation of long, error-prone sequencing reads, the frameshift option of Diamond can also be enabled. The HMMER3 mode is significantly slower than the other two and requires heavy databases to be downloaded. However, HMM-based searches might aid in the annotation of sequences for which distant homology relationships against the eggNOG v5 OGs cannot be detected by Diamond and MMseqs modes.</p>
  </sec>
  <sec>
    <title>Adjusting Taxonomic Scopes</title>
    <p>Another new feature now available with eggNOG-mapper v2 is the possibility of creating custom annotation databases constrained to specific taxonomic groups. For instance, users could easily create databases spanning only their domain or phylum of interest, therefore reducing computational times of subsequent annotation jobs. Moreover, the new version provides enhanced options to control the taxonomic scope (<xref rid="msab293-F1" ref-type="fig">fig. 1<italic toggle="yes">C</italic></xref>) used for transferring functional annotations, which can be adjusted from automatic mode (recommended for mixed metagenomic data sets) to lineage-specific scopes (preventing transferring functional terms from orthologs of unwanted lineages).</p>
  </sec>
  <sec>
    <title>Orthology Reports</title>
    <p>Taking advantage of the rapid orthology assignments performed by eggNOG-mapper, it is now possible to report pairwise orthology relationships for each query against any of the genomes covered by eggNOG v5 (<xref rid="msab293-F1" ref-type="fig">fig. 1<italic toggle="yes">C</italic></xref>). Although this feature is not intended to substitute more precise orthology prediction methods, it provides a very quick and simple “first-pass” approach to obtain pairwise relationships between query sequences and all eggNOG v5 organisms. Orthology reports can be further adjusted by specifying the target taxa and the type of orthologs to be reported (i.e., one-to-one, many-to-many).</p>
  </sec>
  <sec>
    <title>Annotation Sources</title>
    <p>In order to provide an integrated report of functional annotations per query, eggNOG-mapper v2 offers new annotation sources and improved reports (<xref rid="msab293-F1" ref-type="fig">fig. 1<italic toggle="yes">D</italic></xref>). The functional annotation sources, which provide different levels of coverage (<xref rid="sup1" ref-type="supplementary-material">supplementary fig. S1</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> online), are: predicted protein name; KEGG pathways, modules, and orthologs (<xref rid="msab293-B9" ref-type="bibr">Kanehisa et al. 2017</xref>); Gene Ontology labels (<xref rid="msab293-B4" ref-type="bibr">Gene Ontology Consortium 2018</xref>); EC numbers, BiGG reactions (<xref rid="msab293-B16" ref-type="bibr">Norsigian et al. 2020</xref>); CAZy terms (<xref rid="msab293-B11" ref-type="bibr">Lombard et al. 2014</xref>); COG functional categories (<xref rid="msab293-B21" ref-type="bibr">Tatusov et al. 2000</xref>); eggNOG OGs; and free text descriptions at all taxonomic levels. Reports are generated in tab-delimited and/or XLSX file formats. Moreover, when ORF prediction mode is enabled, proteins used to annotate are reported in FASTA format, together with a functionally decorated GFF file. Alternatively, eggNOG-mapper annotation reports can be used to decorate any custom GFF file.</p>
  </sec>
  <sec>
    <title>Protein Domain Annotations</title>
    <p>Along with the functional terms annotated per query, this new version of eggNOG-mapper provides PFAM (<xref rid="msab293-B14" ref-type="bibr">Mistry et al. 2021</xref>) and SMART (<xref rid="msab293-B10" ref-type="bibr">Letunic et al. 2021</xref>) protein domain predictions. PFAM domain annotations are by default transferred from the inferred orthologs with very little impact on computational cost, but also with a small proportion of false-positive and negative predictions (F1 score 89.7%, <xref rid="msab293-F2" ref-type="fig">fig. 2<italic toggle="yes">D</italic></xref>). Optionally, de novo PFAM domain annotation is also available at large scales, both as a refinement phase for the orthology-based predictions (thus keeping the computational cost very low, while eliminating the risk of false positives; <italic toggle="yes">F</italic><sub>1</sub> score 98.9%, <xref rid="msab293-F2" ref-type="fig">fig. 2<italic toggle="yes">D</italic></xref>) or by full computation (obtaining native results independent from orthology predictions). When using the de novo approach, HMMER3 searches are executed using in-memory mode for higher efficiency. Moreover, GA-based thresholds and PFAM clan disambiguation are automatically applied. Performance comparisons between the different modes are shown in <xref rid="msab293-F2" ref-type="fig">figure 2<italic toggle="yes">E.</italic></xref></p>
  </sec>
  <sec>
    <title>Features Comparison with Other Functional Annotation Tools</title>
    <p>Although accuracy and performance are the main goal of eggNOG-mapper v2, other practical differences might motivate its use, or not, compared with alternative software. Those practical issues include the type of input and output data, the functional sources used to annotate query sequences, and the target taxonomic scope of each program.</p>
    <p>EggNOG-mapper is tightly bound to the eggNOG database, which covers a wide range of prokaryotic and eukaryotic organisms, and provides normalized functional annotations from multiple sources (see previous sections). As eggNOG is based on a curated selection of representative species spanning the whole tree of life, it provides a broad annotation coverage while keeping redundancy low. Other tools use smaller reference databases (e.g., SwissProt [<xref rid="msab293-B22" ref-type="bibr">UniProt Consortium 2021</xref>]) for general functional annotations but incorporate niche-specific functional databases for specific purposes. For instance, Prokka is suited for the annotation for prokaryotic-only genomes and includes the detection of tRNAs, transposases and signal peptides (which are not specifically targeted by eggNOG-mapper). DRAM (<xref rid="msab293-B20" ref-type="bibr">Shaffer et al. 2020</xref>) and MicrobiomeAnnotator (<xref rid="msab293-B18" ref-type="bibr">Ruiz-Perez et al. 2021</xref>) use broad annotation sources for microbial data sets such as KOFam/KEGG classification. Both provide optional mappings to large protein reference databases comparable to eggNOG (e.g., trEMBL or Uniref90), but at the cost of more computational resources and time (<xref rid="msab293-B18" ref-type="bibr">Ruiz-Perez et al. 2021</xref>). In the case of DRAM, additional genomic features can be annotated, including rRNAs, tRNAs, peptidases, and carbohydrate-active enzymes. Mantis (<xref rid="msab293-B17" ref-type="bibr">Queirós et al. 2021</xref>) and InterProScan allow users to annotate sequences based on multiple HMM-based database sources, including eggNOG, PFAM, or PANTHER (<xref rid="msab293-B13" ref-type="bibr">Mi et al. 2010</xref>).</p>
    <p>On the other hand, this new version of eggNOG-mapper is particularly focused on improving the annotation process at the metagenomic scale. For instance, it incorporates the possibility of using Prodigal for the automatic prediction of open reading frames (ORFs) out of raw contigs. Those options are not commonly available in other annotation tools, with only Prokka and DRAM providing similar capabilities. Moreover, eggNOG-mapper v2 allows for the direct annotation of reads via blastx-like searches, which is not a recommended mode in terms of accuracy, but it offers the possibility of obtaining functional profiles of metagenomic samples before assembling.</p>
    <p>Regarding outputs, eggNOG-mapper is optimized for large-scale annotation jobs, producing GFF files decorated with functional annotations, tab-delimited files with the predicted functional terms per query, orthology assignment tables and taxonomic placements. Other tools provide similar output files (except for the orthology and taxonomic predictions), with only DRAM and MicrobiomeAnnotator providing further statistics and graphical outputs summarizing the results. Notably, Prokka can be set to produce Genbank and Sequin files compliant with the Genbank/ENA/DDJB format, thus facilitating the uploading of annotated genomes to public databases.</p>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>Overall, eggNOG-mapper v2 provides a more efficient, versatile, and scalable automated functional annotation workflow than its predecessor. Standalone versions are available at GitHub (<ext-link xlink:href="https://github.com/eggnogdb/eggnog-mapper" ext-link-type="uri">https://github.com/eggnogdb/eggnog-mapper</ext-link>), together with extensive documentation and usage examples (<ext-link xlink:href="https://github.com/eggnogdb/eggnog-mapper/wiki" ext-link-type="uri">https://github.com/eggnogdb/eggnog-mapper/wiki</ext-link>). For convenience, an online service for the annotation of large genomic and metagenomic data sets is also available at <ext-link xlink:href="http://eggnog-mapper.embl.de" ext-link-type="uri">http://eggnog-mapper.embl.de</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Molecular Biology and Evolution</italic> online.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>msab293_Supplementary_Data</label>
      <media xlink:href="msab293_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>This research was supported by the National Programme for Fostering Excellence in Scientific and Technical Research (Grant No. PGC2018-098073-A-I00 MCIU/AEI/FEDER, UE, to J.H.C.) and the Severo Ochoa Centres of Excellence Programme (Grant No. SEV-2016-0672 (2017–2021) to C.P.C.) from the State Research Agency (AEI) of Spain, as well as a Research Technical Support Staff Aid (PTA2019-017593-I/AEI/10.13039/501100011033 to A.H.P.); European Research Council grant MicroBioS (ERC-2014-AdG)—GA669830 (to P.B.). Cloud computing is supported by BMBF (de.NBI network #031A537B).</p>
    <sec sec-type="data-availability">
      <title>Data Availability</title>
      <p>No new data were generated or analyzed in support of this research.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="msab293-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Almeida</surname><given-names>A</given-names></string-name>, <string-name><surname>Nayfach</surname><given-names>S</given-names></string-name>, <string-name><surname>Boland</surname><given-names>M</given-names></string-name>, <string-name><surname>Strozzi</surname><given-names>F</given-names></string-name>, <string-name><surname>Beracochea</surname><given-names>M</given-names></string-name>, <string-name><surname>Shi</surname><given-names>ZJ</given-names></string-name>, <string-name><surname>Pollard</surname><given-names>KS</given-names></string-name>, <string-name><surname>Sakharova</surname><given-names>E</given-names></string-name>, <string-name><surname>Parks</surname><given-names>DH</given-names></string-name>, <string-name><surname>Hugenholtz</surname><given-names>P</given-names></string-name></person-group>, <etal>et al</etal><year>2021</year>. <article-title>A unified catalog of 204,938 reference genomes from the human gut microbiome</article-title>. <source>Nat Biotechnol</source>. <volume>39</volume>(<issue>1</issue>):<fpage>105</fpage>–<lpage>114</lpage>.<pub-id pub-id-type="pmid">32690973</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blum</surname><given-names>M</given-names></string-name>, <string-name><surname>Chang</surname><given-names>H-Y</given-names></string-name>, <string-name><surname>Chuguransky</surname><given-names>S</given-names></string-name>, <string-name><surname>Grego</surname><given-names>T</given-names></string-name>, <string-name><surname>Kandasaamy</surname><given-names>S</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>A</given-names></string-name>, <string-name><surname>Nuka</surname><given-names>G</given-names></string-name>, <string-name><surname>Paysan-Lafosse</surname><given-names>T</given-names></string-name>, <string-name><surname>Qureshi</surname><given-names>M</given-names></string-name>, <string-name><surname>Raj</surname><given-names>S</given-names></string-name></person-group>, <etal>et al</etal><year>2021</year>. <article-title>The InterPro protein families and domains database: 20 years on</article-title>. <source>Nucleic Acids Res</source>. <volume>49</volume>(<issue>D1</issue>):<fpage>D344</fpage>–<lpage>D354</lpage>.<pub-id pub-id-type="pmid">33156333</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gabaldón</surname><given-names>T</given-names></string-name>, <string-name><surname>Koonin</surname><given-names>EV.</given-names></string-name></person-group><year>2013</year>. <article-title>Functional and evolutionary implications of gene orthology</article-title>. <source>Nat Rev Genet</source>. <volume>14</volume>(<issue>5</issue>):<fpage>360</fpage>–<lpage>366</lpage>.<pub-id pub-id-type="pmid">23552219</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B4">
      <mixed-citation publication-type="journal">Gene Ontology Consortium. <year>2018</year>. <article-title>The Gene Ontology Resource: 20 years and still GOing Strong</article-title>. <source>Nucleic Acids Res</source>. <volume>47</volume>(<issue>D1</issue>):<fpage>D330</fpage>–<lpage>D338</lpage>.</mixed-citation>
    </ref>
    <ref id="msab293-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Glover</surname><given-names>N</given-names></string-name>, <string-name><surname>Dessimoz</surname><given-names>C</given-names></string-name>, <string-name><surname>Ebersberger</surname><given-names>I</given-names></string-name>, <string-name><surname>Forslund</surname><given-names>SK</given-names></string-name>, <string-name><surname>Gabaldón</surname><given-names>T</given-names></string-name>, <string-name><surname>Huerta-Cepas</surname><given-names>J</given-names></string-name>, <string-name><surname>Martin</surname><given-names>M-J</given-names></string-name>, <string-name><surname>Muffato</surname><given-names>M</given-names></string-name>, <string-name><surname>Patricio</surname><given-names>M</given-names></string-name>, <string-name><surname>Pereira</surname><given-names>C</given-names></string-name></person-group>, <etal>et al</etal><year>2019</year>. <article-title>Advances and applications in the quest for orthologs</article-title>. <source>Mol Biol Evol</source>. <volume>36</volume>(<issue>10</issue>):<fpage>2157</fpage>–<lpage>2164</lpage>.<pub-id pub-id-type="pmid">31241141</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Götz</surname><given-names>S</given-names></string-name>, <string-name><surname>García-Gómez</surname><given-names>JM</given-names></string-name>, <string-name><surname>Terol</surname><given-names>J</given-names></string-name>, <string-name><surname>Williams</surname><given-names>TD</given-names></string-name>, <string-name><surname>Nagaraj</surname><given-names>SH</given-names></string-name>, <string-name><surname>Nueda</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Robles</surname><given-names>M</given-names></string-name>, <string-name><surname>Talón</surname><given-names>M</given-names></string-name>, <string-name><surname>Dopazo</surname><given-names>J</given-names></string-name>, <string-name><surname>Conesa</surname><given-names>A.</given-names></string-name></person-group><year>2008</year>. <article-title>High-throughput functional annotation and data mining with the Blast2GO suite</article-title>. <source>Nucleic Acids Res</source>. <volume>36</volume>(<issue>10</issue>):<fpage>3420</fpage>–<lpage>3435</lpage>.<pub-id pub-id-type="pmid">18445632</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huerta-Cepas</surname><given-names>J</given-names></string-name>, <string-name><surname>Forslund</surname><given-names>K</given-names></string-name>, <string-name><surname>Coelho</surname><given-names>LP</given-names></string-name>, <string-name><surname>Szklarczyk</surname><given-names>D</given-names></string-name>, <string-name><surname>Jensen</surname><given-names>LJ</given-names></string-name>, <string-name><surname>von Mering</surname><given-names>C</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name></person-group><year>2017</year>. <article-title>Fast genome-wide functional annotation through orthology assignment by eggNOG-Mapper</article-title>. <source>Mol Biol Evol</source>. <volume>34</volume>(<issue>8</issue>):<fpage>2115</fpage>–<lpage>2122</lpage>.<pub-id pub-id-type="pmid">28460117</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B15350958">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huerta-Cepas</surname><given-names>J</given-names>, </string-name>, <string-name><surname>Szklarczyk</surname><given-names>D</given-names>, </string-name>, <string-name><surname>Heller</surname><given-names>D</given-names>, </string-name>, <string-name><surname>Hernández-Plaza</surname><given-names>A</given-names>, </string-name>, <string-name><surname>Forslund</surname><given-names>SK</given-names>, </string-name>, <string-name><surname>Cook</surname><given-names>H</given-names>, </string-name>, <string-name><surname>Mende</surname><given-names>DR</given-names>, </string-name>, <string-name><surname>Letunic</surname><given-names>I</given-names>, </string-name>, <string-name><surname>Rattei</surname><given-names>T</given-names>, </string-name>, <string-name><surname>Jensen</surname><given-names>LJ</given-names></string-name>, </person-group><etal>et al</etal><year>2019</year>. <article-title>eggNOG 5.0: a hierarchical, functionally and phylogenetically annotated orthology resource based on 5090 organisms and 2502 viruses</article-title>. <source>Nucleic Acids Res</source>. <volume>47</volume>(<issue>D1</issue>):<fpage>D309</fpage>–<lpage>D314</lpage>.<pub-id pub-id-type="pmid">30418610</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hyatt</surname><given-names>D</given-names></string-name>, <string-name><surname>Chen</surname><given-names>G-L</given-names></string-name>, <string-name><surname>Locascio</surname><given-names>PF</given-names></string-name>, <string-name><surname>Land</surname><given-names>ML</given-names></string-name>, <string-name><surname>Larimer</surname><given-names>FW</given-names></string-name>, <string-name><surname>Hauser</surname><given-names>LJ.</given-names></string-name></person-group><year>2010</year>. <article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>. <source>BMC Bioinformatics</source><volume>11</volume>:<fpage>119</fpage>.<pub-id pub-id-type="pmid">20211023</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M</given-names></string-name>, <string-name><surname>Furumichi</surname><given-names>M</given-names></string-name>, <string-name><surname>Tanabe</surname><given-names>M</given-names></string-name>, <string-name><surname>Sato</surname><given-names>Y</given-names></string-name>, <string-name><surname>Morishima</surname><given-names>K.</given-names></string-name></person-group><year>2017</year>. <article-title>KEGG: new perspectives on genomes, pathways, diseases and drugs</article-title>. <source>Nucleic Acids Res</source>. <volume>45</volume>(<issue>D1</issue>):<fpage>D353</fpage>–<lpage>D361</lpage>.<pub-id pub-id-type="pmid">27899662</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Letunic</surname><given-names>I</given-names></string-name>, <string-name><surname>Khedkar</surname><given-names>S</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name></person-group><year>2021</year>. <article-title>SMART: recent updates, new developments and status in 2020</article-title>. <source>Nucleic Acids Res</source>. <volume>49</volume>(<issue>D1</issue>):<fpage>D458</fpage>–<lpage>D460</lpage>.<pub-id pub-id-type="pmid">33104802</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lombard</surname><given-names>V</given-names></string-name>, <string-name><surname>Golaconda Ramulu</surname><given-names>H</given-names></string-name>, <string-name><surname>Drula</surname><given-names>E</given-names></string-name>, <string-name><surname>Coutinho</surname><given-names>PM</given-names></string-name>, <string-name><surname>Henrissat</surname><given-names>B.</given-names></string-name></person-group><year>2014</year>. <article-title>The Carbohydrate-Active Enzymes Database (CAZy) in 2013</article-title>. <source>Nucleic Acids Res</source>. <volume>42</volume>(<issue>Database issue</issue>):<fpage>D490</fpage>–<lpage>D495</lpage>. (Database issue):<pub-id pub-id-type="pmid">24270786</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mende</surname><given-names>DR</given-names></string-name>, <string-name><surname>Letunic</surname><given-names>I</given-names></string-name>, <string-name><surname>Maistrenko</surname><given-names>OM</given-names></string-name>, <string-name><surname>Schmidt</surname><given-names>TSB</given-names></string-name>, <string-name><surname>Milanese</surname><given-names>A</given-names></string-name>, <string-name><surname>Paoli</surname><given-names>L</given-names></string-name>, <string-name><surname>Hernández-Plaza</surname><given-names>A</given-names></string-name>, <string-name><surname>Orakov</surname><given-names>AN</given-names></string-name>, <string-name><surname>Forslund</surname><given-names>SK</given-names></string-name>, <string-name><surname>Sunagawa</surname><given-names>S</given-names></string-name></person-group>, <etal>et al</etal><year>2020</year>. <article-title>proGenomes2: an improved database for accurate and consistent habitat, taxonomic and functional annotations of prokaryotic genomes</article-title>. <source>Nucleic Acids Res</source>. <volume>48</volume> (<issue>D1</issue>):<fpage>D621</fpage>–<lpage>D625</lpage>.<pub-id pub-id-type="pmid">31647096</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mi</surname><given-names>H</given-names></string-name>, <string-name><surname>Dong</surname><given-names>Q</given-names></string-name>, <string-name><surname>Muruganujan</surname><given-names>A</given-names></string-name>, <string-name><surname>Gaudet</surname><given-names>P</given-names></string-name>, <string-name><surname>Lewis</surname><given-names>S</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>PD.</given-names></string-name></person-group><year>2010</year>. <article-title>PANTHER Version 7: improved phylogenetic trees, orthologs and collaboration with the gene ontology consortium</article-title>. <source>Nucleic Acids Res</source>. <volume>38</volume>(<issue>Database issue</issue>):<fpage>D204</fpage>– <lpage>D210</lpage>. (Database issue):<pub-id pub-id-type="pmid">20015972</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mistry</surname><given-names>J</given-names></string-name>, <string-name><surname>Chuguransky</surname><given-names>S</given-names></string-name>, <string-name><surname>Williams</surname><given-names>L</given-names></string-name>, <string-name><surname>Qureshi</surname><given-names>M</given-names></string-name>, <string-name><surname>Salazar</surname><given-names>GA</given-names></string-name>, <string-name><surname>Sonnhammer</surname><given-names>ELL</given-names></string-name>, <string-name><surname>Tosatto</surname><given-names>SCE</given-names></string-name>, <string-name><surname>Paladin</surname><given-names>L</given-names></string-name>, <string-name><surname>Raj</surname><given-names>S</given-names></string-name>, <string-name><surname>Richardson</surname><given-names>LJ</given-names></string-name></person-group>, <etal>et al</etal><year>2021</year>. <article-title>Pfam: the Protein Families Database in 2021</article-title>. <source>Nucleic Acids Res</source>. <volume>49</volume>(<issue>D1</issue>):<fpage>D412</fpage>–<lpage>D419</lpage>.<pub-id pub-id-type="pmid">33125078</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mistry</surname><given-names>J</given-names></string-name>, <string-name><surname>Finn</surname><given-names>RD</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR</given-names></string-name>, <string-name><surname>Bateman</surname><given-names>A</given-names></string-name>, <string-name><surname>Punta</surname><given-names>M.</given-names></string-name></person-group><year>2013</year>. <article-title>Challenges in homology search: HMMER3 and convergent evolution of coiled-coil regions</article-title>. <source>Nucleic Acids Res</source>. <volume>41</volume>(<issue>12</issue>):<fpage>e121</fpage>.<pub-id pub-id-type="pmid">23598997</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Norsigian</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Pusarla</surname><given-names>N</given-names></string-name>, <string-name><surname>McConn</surname><given-names>JL</given-names></string-name>, <string-name><surname>Yurkovich</surname><given-names>JT</given-names></string-name>, <string-name><surname>Dräger</surname><given-names>A</given-names></string-name>, <string-name><surname>Palsson</surname><given-names>BO</given-names></string-name>, <string-name><surname>King</surname><given-names>Z.</given-names></string-name></person-group><year>2020</year>. <article-title>BiGG Models 2020: multi-strain genome-scale models and expansion across the phylogenetic tree</article-title>. <source>Nucleic Acids Res</source>. <volume>48</volume>(<issue>D1</issue>):<fpage>D402</fpage>–<lpage>D406</lpage>.<pub-id pub-id-type="pmid">31696234</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Queirós</surname><given-names>P</given-names></string-name>, <string-name><surname>Delogu</surname><given-names>F</given-names></string-name>, <string-name><surname>Hickl</surname><given-names>O</given-names></string-name>, <string-name><surname>May</surname><given-names>P</given-names></string-name>, <string-name><surname>Wilmes</surname><given-names>P.</given-names></string-name></person-group><year>2021</year>. <article-title>Mantis: flexible and consensus-driven genome annotation</article-title>. <source>GigaScience</source>. <volume>10</volume>(<issue>6</issue>):giab042.</mixed-citation>
    </ref>
    <ref id="msab293-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruiz-Perez</surname><given-names>CA</given-names></string-name>, <string-name><surname>Conrad</surname><given-names>RE</given-names></string-name>, <string-name><surname>Konstantinidis</surname><given-names>KT.</given-names></string-name></person-group><year>2021</year>. <article-title>MicrobeAnnotator: a user-friendly, comprehensive functional annotation pipeline for microbial genomes</article-title>. <source>BMC Bioinformatics</source><volume>22</volume>(<issue>1</issue>):<fpage>11</fpage>.<pub-id pub-id-type="pmid">33407081</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seemann</surname><given-names>T.</given-names></string-name></person-group><year>2014</year>. <article-title>Prokka: rapid prokaryotic genome annotation</article-title>. <source>Bioinformatics</source><volume>30</volume>(<issue>14</issue>):<fpage>2068</fpage>–<lpage>2069</lpage>.<pub-id pub-id-type="pmid">24642063</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shaffer</surname><given-names>M</given-names></string-name>, <string-name><surname>Borton</surname><given-names>MA</given-names></string-name>, <string-name><surname>McGivern</surname><given-names>BB</given-names></string-name>, <string-name><surname>Zayed</surname><given-names>AA</given-names></string-name>, <string-name><surname>La Rosa</surname><given-names>SL</given-names></string-name>, <string-name><surname>Solden</surname><given-names>LM</given-names></string-name>, <string-name><surname>Liu</surname><given-names>P</given-names></string-name>, <string-name><surname>Narrowe</surname><given-names>AB</given-names></string-name>, <string-name><surname>Rodríguez-Ramos</surname><given-names>J</given-names></string-name>, <string-name><surname>Bolduc</surname><given-names>B</given-names></string-name></person-group>, <etal>et al</etal><year>2020</year>. <article-title>DRAM for distilling microbial metabolism to automate the curation of microbiome function</article-title>. <source>Nucleic Acids Res</source>. <volume>48</volume>(<issue>16</issue>):<fpage>8883</fpage>–<lpage>8900</lpage>.<pub-id pub-id-type="pmid">32766782</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tatusov</surname><given-names>RL</given-names></string-name>, <string-name><surname>Galperin</surname><given-names>MY</given-names></string-name>, <string-name><surname>Natale</surname><given-names>DA</given-names></string-name>, <string-name><surname>Koonin</surname><given-names>EV.</given-names></string-name></person-group><year>2000</year>. <article-title>The COG database: a tool for genome-scale analysis of protein functions and evolution</article-title>. <source>Nucleic Acids Res</source>. <volume>28</volume>(<issue>1</issue>):<fpage>33</fpage>–<lpage>36</lpage>.<pub-id pub-id-type="pmid">10592175</pub-id></mixed-citation>
    </ref>
    <ref id="msab293-B22">
      <mixed-citation publication-type="journal">UniProt Consortium. <year>2021</year>. <article-title>UniProt: the universal protein knowledgebase in 2021</article-title>. <source>Nucleic Acids Res</source>. <volume>49</volume>(<issue>D1</issue>):<fpage>D480</fpage>–<lpage>D489</lpage>.<pub-id pub-id-type="pmid">33237286</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
