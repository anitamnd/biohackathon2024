<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-title-group>
      <journal-title>PLOS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9621593</article-id>
    <article-id pub-id-type="pmid">36260616</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-22-00229</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1010610</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Domains</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Comparison</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Comparison</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and analysis methods</subject>
        <subj-group>
          <subject>Database and informatics methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence analysis</subject>
              <subj-group>
                <subject>BLAST algorithm</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Protein Structure Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Evolutionary Biology</subject>
          <subj-group>
            <subject>Molecular Evolution</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Prediction</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
              <subj-group>
                <subject>Protein Structure Prediction</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Protein Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DPCfam: Unsupervised protein family classification by Density Peak Clustering of large sequence datasets</article-title>
      <alt-title alt-title-type="running-head">DPCfam: Unsupervised protein family classification by Density Peak Clustering</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0061-2328</contrib-id>
        <name>
          <surname>Russo</surname>
          <given-names>Elena Tea</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-5696-670X</contrib-id>
        <name>
          <surname>Barone</surname>
          <given-names>Federico</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/software/">Software</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="aff003" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6982-4660</contrib-id>
        <name>
          <surname>Bateman</surname>
          <given-names>Alex</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff004" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cozzini</surname>
          <given-names>Stefano</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/resources/">Resources</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing – review &amp; editing</role>
        <xref rid="aff002" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Punta</surname>
          <given-names>Marco</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff005" ref-type="aff">
          <sup>5</sup>
        </xref>
        <xref rid="aff006" ref-type="aff">
          <sup>6</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0001-9164-7907</contrib-id>
        <name>
          <surname>Laio</surname>
          <given-names>Alessandro</given-names>
        </name>
        <role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role>
        <role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role>
        <role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role>
        <role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing – original draft</role>
        <xref rid="aff001" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff007" ref-type="aff">
          <sup>7</sup>
        </xref>
        <xref rid="econtrib001" ref-type="author-notes">
          <sup>‡</sup>
        </xref>
        <xref rid="cor001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>SISSA, Trieste, Italy</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>AREA SCIENCE PARK, Trieste, Italy</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Department of Mathematics and Geosciences, University of Trieste, Trieste, Italy</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome Genome Campus, Hinxton, United Kingdom</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Center for Omics Sciences, IRCCS San Raffaele Institute, Milan, Italy</addr-line>
    </aff>
    <aff id="aff006">
      <label>6</label>
      <addr-line>Unit of Immunogenetics, Leukemia Genomics and Immunobiology, Division of Immunology, Transplantation and Infectious Disease, IRCCS San Raffaele Scientific Institute, Milan, Italy</addr-line>
    </aff>
    <aff id="aff007">
      <label>7</label>
      <addr-line>ICTP, Trieste, Italy</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Dunbrack</surname>
          <given-names>Roland L.</given-names>
          <suffix>Jr.</suffix>
        </name>
        <role>Editor</role>
        <xref rid="edit1" ref-type="aff"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Fox Chase Cancer Center, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="other" id="econtrib001">
        <p>‡ MP and AL also contributed equally to this work.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>punta.marco@hsr.it</email> (MP); <email>alessandro.laio@sissa.it</email> (AL)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <volume>18</volume>
    <issue>10</issue>
    <elocation-id>e1010610</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>2</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>9</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Russo et al</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Russo et al</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1010610.pdf"/>
    <abstract>
      <p>Proteins that are known only at a sequence level outnumber those with an experimental characterization by orders of magnitude. Classifying protein regions (domains) into homologous families can generate testable functional hypotheses for yet unannotated sequences. Existing domain family resources typically use at least some degree of manual curation: they grow slowly over time and leave a large fraction of the protein sequence space unclassified. We here describe automatic clustering by Density Peak Clustering of UniRef50 v. 2017_07, a protein sequence database including approximately 23M sequences. We performed a radical re-implementation of a pipeline we previously developed in order to allow handling millions of sequences and data volumes of the order of 3 TeraBytes. The modified pipeline, which we call DPCfam, finds ∼ 45,000 protein clusters in UniRef50. Our automatic classification is in close correspondence to the ones of the Pfam and ECOD resources: in particular, about 81% of medium-large Pfam families and 72% of ECOD families can be mapped to clusters generated by DPCfam. In addition, our protocol finds more than 14,000 clusters constituted of protein regions with no Pfam annotation, which are therefore candidates for representing novel protein families. These results are made available to the scientific community through a dedicated repository.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Only a small fraction of proteins for which the sequence is known can be linked to some functional annotation. Identifying evolutionary relationships (homology) between protein regions and grouping them into families can greatly increase the number of proteins for which testable functional hypotheses are available. Indeed, homologous proteins may still share functional features that were originally found in their long-lost common ancestor. While many dedicated protein family databases exist, a large portion of the sequence space remains unclassified. Here, we show that our DPCfam protocol can automatically cluster protein regions from more than 20 million protein sequences in the UniRef50 database and that many of the so-obtained clusters display family-like features. Importantly, our protocol finds more than 14,000 clusters constituted of protein regions with no annotation in the Pfam database, which are therefore candidates for representing novel protein families. These clusters are made available to the scientific community through a dedicated repository and could serve as a go-to list to speed up manual family classification of sequences in the UniProtKB repository. In the future, the DPCfam protocol could be of particular interest for the identification of homologous relationships in large, poorly annotated datasets such as those produced by metagenomics projects.</p>
    </abstract>
    <funding-group>
      <funding-statement>The author(s) received no specific funding for this work.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="0"/>
      <page-count count="29"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2022-10-31</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>We uploaded to Zenodo Metaclusters seeds, MSAs and profile-hmm, together with the UniRef50 v. 2017_07 protein database with Pfam and DPCfam annotation: <ext-link xlink:href="https://doi.org/10.5281/zenodo.6900559" ext-link-type="uri">https://doi.org/10.5281/zenodo.6900559</ext-link> Metaclusters can also be inspected through the dedicated website: <ext-link xlink:href="https://dpcfam.areasciencepark.it/" ext-link-type="uri">https://dpcfam.areasciencepark.it/</ext-link> The DPCfam source code is available at <ext-link xlink:href="https://gitlab.com/area7/DPCfam/dpcfam" ext-link-type="uri">https://gitlab.com/area7/DPCfam/dpcfam</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>We uploaded to Zenodo Metaclusters seeds, MSAs and profile-hmm, together with the UniRef50 v. 2017_07 protein database with Pfam and DPCfam annotation: <ext-link xlink:href="https://doi.org/10.5281/zenodo.6900559" ext-link-type="uri">https://doi.org/10.5281/zenodo.6900559</ext-link> Metaclusters can also be inspected through the dedicated website: <ext-link xlink:href="https://dpcfam.areasciencepark.it/" ext-link-type="uri">https://dpcfam.areasciencepark.it/</ext-link> The DPCfam source code is available at <ext-link xlink:href="https://gitlab.com/area7/DPCfam/dpcfam" ext-link-type="uri">https://gitlab.com/area7/DPCfam/dpcfam</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>1 Introduction</title>
    <p>The number of proteins for which a sequence is known is growing rapidly. The UniProtKB database, for example, contains more than 225M sequences mostly from large-scale sequencing projects but increasingly including high-quality sequences from metagenomic assembled genomes [<xref rid="pcbi.1010610.ref001" ref-type="bibr">1</xref>]. For their part, dedicated metagenomic databases such as the EBI MGnify [<xref rid="pcbi.1010610.ref002" ref-type="bibr">2</xref>] contain hundreds of millions of additional sequences although only a fraction of them annotated as full-length.</p>
    <p>Knowing the sequence of such a large number of proteins can be of great help in phylogeny reconstruction; however, for most other applications what is of real interest are the functions of the proteins that they represent. Unfortunately, experimental characterization of proteins’ functions remains a painstakingly slow process and, therefore, the gap between protein sequence and functional knowledge is widening.</p>
    <p>Thankfully, proteins can be grouped into families according to their evolutionary relationships whereby proteins in the same family have a certain chance of performing similar functions, presumed to descend from their long-lost common ancestor [<xref rid="pcbi.1010610.ref003" ref-type="bibr">3</xref>]. While it is certainly not always the case that homologous proteins have similar functions, when handled with care, homology is a powerful tool and often represents the first step in the generation of functional hypotheses for yet uncharacterized proteins [<xref rid="pcbi.1010610.ref004" ref-type="bibr">4</xref>]. For this reason, databases that compile lists of protein families have flourished over the past 25 years. Most of these resources infer homology from sequence similarity although structural knowledge is often utilized to annotate more remote relationships. An important distinction is the one between databases that build families based on full-length sequence similarity and those that instead focus on local similarities. Observing significant similarity between two proteins along their full (or close to full) sequence length allows building a stronger case for their overall functional similarity; however, it also limits considerably the breadth of annotation transfer, typically to more closely related proteins. Targeting local sequence similarities, instead, allows identification of shared evolutionary modules that may represent the only homologous regions between otherwise unrelated proteins, as well as potentially constituting their only functional link. Such evolutionary modules generally map to globular or transmembrane structural domains; however, evolutionarily-conserved long disordered protein modules are also known to exist (in the literature sometimes referred to as unstructured domains) [<xref rid="pcbi.1010610.ref005" ref-type="bibr">5</xref>].</p>
    <p>Existing domain family databases often target specific regions of the protein sequence space focusing, for example, on extracellular or signalling proteins (SMART [<xref rid="pcbi.1010610.ref006" ref-type="bibr">6</xref>]), enzymes (SFLD [<xref rid="pcbi.1010610.ref007" ref-type="bibr">7</xref>]), proteins of known structure (several databases including ECOD [<xref rid="pcbi.1010610.ref008" ref-type="bibr">8</xref>]). Pfam [<xref rid="pcbi.1010610.ref009" ref-type="bibr">9</xref>] is a database that instead aims to classify all protein types with no strong bias for a given area of the protein universe. Finally, ‘meta-databases’ such as InterPro [<xref rid="pcbi.1010610.ref010" ref-type="bibr">10</xref>] and CDD [<xref rid="pcbi.1010610.ref011" ref-type="bibr">11</xref>] integrate information from many other databases with their own annotations. Despite all these remarkable efforts, a large portion of the sequence space is still untouched by family classifications. For example, the Pfam release 35 contained 19,632 families which altogether covered 52.65% of all amino acids in UniProtKB proteins, and left 24% of proteins without annotation on their entire length. Also, annotation levels of metagenomic protein sequence datasets are usually much lower than the ones obtained for UniprotKB and reference proteome sequences. This is due to the fact that metagenomics projects typically target areas of the protein universe that have so far been under-sampled. Indeed, sequences that have been used for family building thus far have been biased toward the culturable set of organisms. There are several other reasons why family classifications are incomplete including the difficulty for sequence profiles built from multiple sequence alignments to capture highly diverse families.</p>
    <p>One important obstacle toward a more pervasive family annotation is the fact that all existing resources rely, at least to some degree, on manual supervision. While the latter increases annotation quality, it also inevitably slows down the pace at which novel families are created. A solution to the problem could be represented by an unsupervised, fully automated approach to protein domain family classification. Depending on context, such an approach could be used to rapidly identify the most interesting novel families in large, poorly annotated datasets such as those produced by metagenomics projects or, alternatively, as a go-to list to speed up manual classification of more established datasets such as UniProtKB. Although efforts in this direction have been produced in the past, they have often focused on full-length protein classification (e.g. MCL [<xref rid="pcbi.1010610.ref012" ref-type="bibr">12</xref>]). Exceptions were ADDA [<xref rid="pcbi.1010610.ref013" ref-type="bibr">13</xref>] and EVEREST [<xref rid="pcbi.1010610.ref014" ref-type="bibr">14</xref>]. ADDA was used by Pfam to automatically generate the Pfam-B database until 2015 but subsequently dismissed because of its high computational costs. EVEREST is no longer maintained. We note that recently the Pfam-B database has been reintroduced by Pfam; Pfam-B is now automatically built running the MMseqs2 clustering algorithm [<xref rid="pcbi.1010610.ref015" ref-type="bibr">15</xref>] on sequences or fragments of sequences lacking Pfam-A annotation [<xref rid="pcbi.1010610.ref009" ref-type="bibr">9</xref>]. The current Pfam-B building methodology produces only relatively low quality families which require a significant amount of manual curation to be brought up to the level of high quality Pfam-A families.</p>
    <p>In what follows, we discuss the application of our new method DPCfam to the automatic classification of protein families in the UniRef50 sequence database. DPCfam is based on local sequence similarity searches followed by clustering using Density Peak Clustering. While we previously published a small-scale experiment that focused on family classification of proteins contained in only two Pfam clans/superfamilies [<xref rid="pcbi.1010610.ref016" ref-type="bibr">16</xref>], this is the first time that we discuss the use of DPCfam for wholesale classification of a large (about 23 million sequences) sequence dataset. Performing this clustering required developing a dedicated pipeline designed from scratch to ensure memory scaling.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>2 Materials and methods</title>
    <sec id="sec003">
      <title>2.1 Overview of the DPCfam algorithm</title>
      <p>DPCfam is a Density Peak Clustering [<xref rid="pcbi.1010610.ref017" ref-type="bibr">17</xref>] (DPC)-based algorithm that automatically generates protein families starting from all versus all local, pairwise protein sequence alignments. Clustering of local alignments means that DPCfam can, in principle, identify families representing individual evolutionary modules or domains. The same algorithm was already described in [<xref rid="pcbi.1010610.ref016" ref-type="bibr">16</xref>], where it was applied to two relatively small Pfam clans (4,083 and 2,022 sequences, respectively). In this work, we utilize DPCfam to cluster the entire UniRef50 database (v. 2017_07), containing about 23 million sequences that share no more than 50% sequence identity between each other. Clustering such a large number of sequences required modifying the original DPCfam pipeline in order to increase efficiency of CPU and memory usage.</p>
      <p>Starting from local pairwise sequence alignments obtained by BLAST [<xref rid="pcbi.1010610.ref018" ref-type="bibr">18</xref>], DPCfam performs a two-step DPC clustering followed by a merging procedure aimed at reducing redundancies. The output of the method is a set of <italic toggle="yes">metaclusters</italic>. In [<xref rid="pcbi.1010610.ref016" ref-type="bibr">16</xref>] and in Results, we provide evidence that sequences belonging to the same metacluster are likely to share a core evolutionary module and thus metaclusters can often be assimilated to protein families. DPCfam output can be used ‘as is’ or, alternatively, metaclusters can be the basis from which to build profile-HMMs for more sensitive searches of the sequence space [<xref rid="pcbi.1010610.ref019" ref-type="bibr">19</xref>].</p>
      <p>In the following, we recapitulate the DPCfam algorithm (see <xref rid="pcbi.1010610.g001" ref-type="fig">Fig 1</xref> for a graphical sketch of the method’s workflow) pointing out, when present, differences with respect to our previous implementation.</p>
      <fig position="float" id="pcbi.1010610.g001">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010610.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Graphical sketch of the DPCfam workflow.</title>
          <p>(A) for each query sequence in the reference dataset (UniRef50), we collect all search sequence regions (SSRs) that align to it (BLAST with E-value &lt; 0.1); (B) we use Density Peak Clustering (DPC) to group together SSRs that align to similar portions of the query; (C) primary clusters obtained in (B) for all queries are “metaclustered” (using, again, DPC) according to the number of SSRs they share; (D) finally, metaclusters that still share a significant number of SSRs undergo a further merging step. Material from: ‘Russo et al., Density Peak clustering of protein sequences associated to a Pfam clan reveals clear similarities and interesting differences with respect to manual family annotation, BMC Bioinformatics, published 2021, BioMed Central Ltd.’ [<xref rid="pcbi.1010610.ref016" ref-type="bibr">16</xref>].</p>
        </caption>
        <graphic xlink:href="pcbi.1010610.g001" position="float"/>
      </fig>
    </sec>
    <sec id="sec004">
      <title>2.2 Generating BLAST alignments</title>
      <p>In [<xref rid="pcbi.1010610.ref016" ref-type="bibr">16</xref>] the first step of the algorithm entailed running BLAST alignments of a relatively small query set (representing a Pfam clan) against a large database of sequences, the “search set”. In this implementation, query set and search set are the same large database, namely UniRef50 v.2017_07. We generate local pairwise alignments using the <italic toggle="yes">blastp</italic> program of BLAST+ (v. 2.2.30) suite. We set the E-value threshold for significance at 0.1 and the max_target_seqs option to 200,000 (that is, we retain no more than 200K significant alignments for each query). We obtain about 55 billion significant local pairwise alignments. Note that the rather liberal threshold on the E-value is meant to favour sensitivity over specificity in the recovery of ‘true’ homologous relationships. In other words, we are willing to accept a small fraction of false positives (out of our 55 billion hits) in order to collect as many true positives as possible. BLAST was run on our local cluster featuring Xeon E5–2680 v2 nodes (2 sockets, 10 cores, 2 threads, 40GB of RAM). We performed about 100,000 blastp batch searches, with each batch containing 200 query sequences. The sequence batches that we use as input to BLAST are obtained from a randomly shuffled version of the UniRef50 database, which allows to balance the sequence composition of the batches and thus the per-batch running time. Also useful for speeding up BLAST is assigning to each sequence an integer ID. These steps are particularly important when having to run millions of searches. We set the blastp multithreading system to 4 threads (-num_threads 4). This step required 750,000 CPU hours.</p>
    </sec>
    <sec id="sec005">
      <title>2.3 Primary clustering</title>
      <p>Alignments found with BLAST can be represented as query sequence region—search sequence region pairs. In primary clustering, we group together search sequence regions (SSRs) that align to similar portions of the same query. Given a query sequence <italic toggle="yes">q</italic> and the associated set of BLAST-derived SSRs, we define the distance between any two such SSRs <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> as:
<disp-formula id="pcbi.1010610.e001"><alternatives><graphic xlink:href="pcbi.1010610.e001.jpg" id="pcbi.1010610.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">Q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi mathvariant="script">Q</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">Q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi mathvariant="script">Q</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
where <inline-formula id="pcbi.1010610.e002"><alternatives><graphic xlink:href="pcbi.1010610.e002.jpg" id="pcbi.1010610.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">Q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the portion of the query covered by SSR <italic toggle="yes">i</italic>. This distance is 0 if <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> cover the same portion of the query, namely if <inline-formula id="pcbi.1010610.e003"><alternatives><graphic xlink:href="pcbi.1010610.e003.jpg" id="pcbi.1010610.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">Q</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">Q</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>; while it is 1 if <inline-formula id="pcbi.1010610.e004"><alternatives><graphic xlink:href="pcbi.1010610.e004.jpg" id="pcbi.1010610.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">Q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010610.e005"><alternatives><graphic xlink:href="pcbi.1010610.e005.jpg" id="pcbi.1010610.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">Q</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula> do not overlap at all.</p>
      <p>Then, for each SSR <italic toggle="yes">i</italic> we estimate the local density <italic toggle="yes">ρ</italic><sub><italic toggle="yes">i</italic></sub> as
<disp-formula id="pcbi.1010610.e006"><alternatives><graphic xlink:href="pcbi.1010610.e006.jpg" id="pcbi.1010610.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mi>χ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic toggle="yes">χ</italic>(<italic toggle="yes">x</italic>) = 1 if <italic toggle="yes">x</italic> &lt; 0 and zero otherwise. Namely, the density of a SSR <italic toggle="yes">i</italic> is given by the number of SSRs that are found at a distance from <italic toggle="yes">i</italic> smaller than <italic toggle="yes">μ</italic><sub>1</sub>. We add to the distance a small ( ∼ 10<sup>−5</sup>) pseudo-random noise harvested from a uniform distribution to avoid degeneracy, namely cases in which <italic toggle="yes">ρ</italic><sub><italic toggle="yes">i</italic></sub> = <italic toggle="yes">ρ</italic><sub><italic toggle="yes">j</italic></sub>. We choose <italic toggle="yes">μ</italic><sub>1</sub> = 0.2, according to the rule of thumb in [<xref rid="pcbi.1010610.ref017" ref-type="bibr">17</xref>]. The sensitivity of the results to the value of <italic toggle="yes">μ</italic><sub>1</sub> and of the other parameters was benchmarked and discussed in [<xref rid="pcbi.1010610.ref016" ref-type="bibr">16</xref>].</p>
      <p>We then compute the <italic toggle="yes">δ</italic><sub><italic toggle="yes">i</italic></sub> of the SSRs,
<disp-formula id="pcbi.1010610.e007"><alternatives><graphic xlink:href="pcbi.1010610.e007.jpg" id="pcbi.1010610.e007g" position="anchor"/><mml:math id="M7" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mtext>min</mml:mtext><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mspace width="2pt"/><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
namely the distance to the closest SSR that has a higher density.</p>
      <p>Once <italic toggle="yes">ρ</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">δ</italic><sub><italic toggle="yes">i</italic></sub> have been determined, we sort all SSRs by decreasing values of the quantity <italic toggle="yes">γ</italic><sub><italic toggle="yes">i</italic></sub> = <italic toggle="yes">ρ</italic><sub><italic toggle="yes">i</italic></sub><italic toggle="yes">δ</italic><sub><italic toggle="yes">i</italic></sub> and select the top 20. Then, we calculate the difference in gamma values between consecutively ranked SSRs Δ<sub><italic toggle="yes">i</italic></sub> = log(<italic toggle="yes">γ</italic><sub><italic toggle="yes">i</italic></sub>/<italic toggle="yes">γ</italic><sub><italic toggle="yes">i</italic>+1</sub>). If no such difference is &gt; 0.5, we keep all 20 SSRs as cluster centers (density peaks). If instead there exist one or more SSRs such that Δ<sub><italic toggle="yes">i</italic></sub> &gt; 0.5 we take as cluster centers the lowest ranked SSR <italic toggle="yes">i</italic> that has a Δ<sub><italic toggle="yes">i</italic></sub> &gt; 0.5 and all those ranked above it. The decision of selecting a maximum of 20 density peaks is based on the assumption that the vast majority of proteins do not feature more than 20 families or combinations of families. While this is not always the case (for example for proteins that contain a large number of repeats), we believe that it is adequate for most cases.</p>
      <p>SSRs that are not selected as cluster centers are assigned to the closest cluster center, provided that it is closer than <italic toggle="yes">μ</italic><sub>1</sub>, otherwise they are not assigned to any cluster and not considered anymore in the analysis.</p>
      <p>We performed primary clustering using parallel computing with MPI [<xref rid="pcbi.1010610.ref020" ref-type="bibr">20</xref>]. MPI usage was limited to passing to each process a number of query sequences (and relative alignments) to cluster, sequentially. This step took around 50,000 CPU hours, resulting in about 33 billion alignments clustered into 27 million primary clusters. We used an optimized binary representation for output files, which allowed representing each SSR using only 16 bytes that encode the start and end position of the SSR, the protein it is derived from, and the primary cluster it is found in. The size of the output of primary clustering was about 500GB.</p>
    </sec>
    <sec id="sec006">
      <title>2.4 Metaclustering</title>
      <p>The second step of our method consists in a further round of DPC performed this time on primary clusters and producing what we call <italic toggle="yes">metaclusters</italic>, or MCs. This operation constitutes both a computational and a memory bottleneck: one has to process 500GB of input data containing alignments grouped into 27 million primary clusters, leading to a distance matrix of (27 ⋅ 10<sup>6</sup>)<sup>2</sup> elements (sparse). Performing this operation required developing an <italic toggle="yes">ad hoc</italic> strategy, which we describe below.</p>
      <sec id="sec007">
        <title>2.4.1 Generating the distance matrix between primary clusters</title>
        <p>We first define the distance between two primary clusters <italic toggle="yes">c</italic> and <italic toggle="yes">c</italic><sub>0</sub>, associated to two queries <italic toggle="yes">q</italic> and <italic toggle="yes">q</italic><sub>0</sub> as:
<disp-formula id="pcbi.1010610.e008"><alternatives><graphic xlink:href="pcbi.1010610.e008.jpg" id="pcbi.1010610.e008g" position="anchor"/><mml:math id="M8" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where <italic toggle="yes">N</italic><sub><italic toggle="yes">c</italic></sub> and <inline-formula id="pcbi.1010610.e009"><alternatives><graphic xlink:href="pcbi.1010610.e009.jpg" id="pcbi.1010610.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:msub><mml:mi>N</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula> are the number of SSRs in primary clusters <italic toggle="yes">c</italic> and <italic toggle="yes">c</italic><sub>0</sub>, respectively; <inline-formula id="pcbi.1010610.e010"><alternatives><graphic xlink:href="pcbi.1010610.e010.jpg" id="pcbi.1010610.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010610.e011"><alternatives><graphic xlink:href="pcbi.1010610.e011.jpg" id="pcbi.1010610.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:msub></mml:math></alternatives></inline-formula> represent the sets of SSRs clustered in <italic toggle="yes">c</italic> and <italic toggle="yes">c</italic><sub>0</sub> respectively, <italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic></sub> represents a search sequence id and <inline-formula id="pcbi.1010610.e012"><alternatives><graphic xlink:href="pcbi.1010610.e012.jpg" id="pcbi.1010610.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> for <italic toggle="yes">s</italic><sub><italic toggle="yes">m</italic></sub> = <italic toggle="yes">s</italic><sub><italic toggle="yes">n</italic></sub>, 0 otherwise. <inline-formula id="pcbi.1010610.e013"><alternatives><graphic xlink:href="pcbi.1010610.e013.jpg" id="pcbi.1010610.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is defined as in <xref rid="pcbi.1010610.e001" ref-type="disp-formula">Eq 1</xref> replacing <inline-formula id="pcbi.1010610.e014"><alternatives><graphic xlink:href="pcbi.1010610.e014.jpg" id="pcbi.1010610.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">Q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010610.e015"><alternatives><graphic xlink:href="pcbi.1010610.e015.jpg" id="pcbi.1010610.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">Q</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula> with segments <inline-formula id="pcbi.1010610.e016"><alternatives><graphic xlink:href="pcbi.1010610.e016.jpg" id="pcbi.1010610.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010610.e017"><alternatives><graphic xlink:href="pcbi.1010610.e017.jpg" id="pcbi.1010610.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (with <inline-formula id="pcbi.1010610.e018"><alternatives><graphic xlink:href="pcbi.1010610.e018.jpg" id="pcbi.1010610.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> a “search” sequence region and <inline-formula id="pcbi.1010610.e019"><alternatives><graphic xlink:href="pcbi.1010610.e019.jpg" id="pcbi.1010610.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mi mathvariant="script">Q</mml:mi></mml:math></alternatives></inline-formula> a “query” sequence region), and <italic toggle="yes">μ</italic><sub><italic toggle="yes">d</italic></sub> = 0.2, that is, equal to <italic toggle="yes">μ</italic><sub>1</sub> in <xref rid="pcbi.1010610.e001" ref-type="disp-formula">Eq 1</xref>.</p>
        <p>The distance between two primary clusters is thus defined based on the overlap between the sets of SSRs that constitute each cluster. In particular, <inline-formula id="pcbi.1010610.e020"><alternatives><graphic xlink:href="pcbi.1010610.e020.jpg" id="pcbi.1010610.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> if the two primary clusters have no overlapping SSR and <inline-formula id="pcbi.1010610.e021"><alternatives><graphic xlink:href="pcbi.1010610.e021.jpg" id="pcbi.1010610.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> if each SSR in the cluster with fewer members has substantial boundary overlap with at least one SSR of the bigger cluster. More specifically, the numerator in <xref rid="pcbi.1010610.e008" ref-type="disp-formula">Eq 4</xref> is the number of SSRs in primary clusters <italic toggle="yes">c</italic> and <italic toggle="yes">c</italic><sub>0</sub> that share the same search sequence ID (<italic toggle="yes">δs</italic><sub><italic toggle="yes">m</italic></sub><italic toggle="yes">s</italic><sub><italic toggle="yes">n</italic></sub>) and are such that <inline-formula id="pcbi.1010610.e022"><alternatives><graphic xlink:href="pcbi.1010610.e022.jpg" id="pcbi.1010610.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>; the denominator is the total number of SSRs found in the smaller primary cluster (namely, the one with fewer SSRs).</p>
        <p>To compute primary cluster distances, we split the full distance matrix <italic toggle="yes">D</italic> into blocks by dividing primary clusters into <italic toggle="yes">N</italic> groups and obtaining <italic toggle="yes">N</italic><sup>2</sup> blocks of distances between clusters in each pair of groups (see <xref rid="pcbi.1010610.g002" ref-type="fig">Fig 2</xref>). The content of each block can then be evaluated independently and, the block matrix being symmetric, we have a total of <inline-formula id="pcbi.1010610.e023"><alternatives><graphic xlink:href="pcbi.1010610.e023.jpg" id="pcbi.1010610.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:math></alternatives></inline-formula> blocks to work with. Within each group, we sort the SSRs with respect to the search ID (we use a highly optimized C++ program based on the radix sort algorithm [<xref rid="pcbi.1010610.ref021" ref-type="bibr">21</xref>]). Such sorting allows placing SSRs with the same search ID, i.e. derived from the same search protein, in contiguous memory sets. Since only pairs of SSRs derived from the same protein can contribute to the distance between primary clusters (see <xref rid="pcbi.1010610.e008" ref-type="disp-formula">Eq 4</xref>), this arrangement allows for a faster computation of all contributions to the distance matrix’s elements. To compute the matrix block <italic toggle="yes">B</italic><sub><italic toggle="yes">i</italic>,<italic toggle="yes">j</italic></sub>, we read simultaneously two files containing the sorted SSRs, one for group <italic toggle="yes">i</italic> and a second for group <italic toggle="yes">j</italic>. As we start reading both files, the first SSRs found in each will have search ID <italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic>,1</sub> and <italic toggle="yes">s</italic><sub><italic toggle="yes">j</italic>,1</sub>, respectively. Three cases are then possible:</p>
        <list list-type="bullet">
          <list-item>
            <p><italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic>,1</sub> = <italic toggle="yes">s</italic><sub><italic toggle="yes">j</italic>,1</sub>. These two SSRs can contribute to the computation of the distance between the primary clusters they belong to. Since the files are sorted, if there are other SSRs with the same search ID, they will all appear in the following lines. Therefore, we continue reading the files collecting SSRs with this search ID in two separate vectors, <italic toggle="yes">v</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">v</italic><sub><italic toggle="yes">j</italic></sub> (note: the two vectors may contain a different number of elements). Then, for each SSR in vector <italic toggle="yes">v</italic><sub><italic toggle="yes">i</italic></sub> we compute the distance <inline-formula id="pcbi.1010610.e024"><alternatives><graphic xlink:href="pcbi.1010610.e024.jpg" id="pcbi.1010610.e024g" position="anchor"/><mml:math id="M24" display="inline" overflow="scroll"><mml:msup><mml:mi>d</mml:mi><mml:mi mathvariant="script">S</mml:mi></mml:msup></mml:math></alternatives></inline-formula> to any other SSR we collected in <italic toggle="yes">v</italic><sub><italic toggle="yes">j</italic></sub>: if the distance between two SSRs is smaller than 0.2, we add one to the summation in <xref rid="pcbi.1010610.e008" ref-type="disp-formula">4</xref>.</p>
          </list-item>
          <list-item>
            <p><italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic>,1</sub> &gt; <italic toggle="yes">s</italic><sub><italic toggle="yes">j</italic>,1</sub>: since SSRs are sorted in both files, in group <italic toggle="yes">i</italic> there is no alignment with a search ID smaller or equal to <italic toggle="yes">s</italic><sub><italic toggle="yes">j</italic>,1</sub>. Therefore, we can scroll the lines of group <italic toggle="yes">j</italic> file until we find <italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic>,1</sub> ≤ <italic toggle="yes">s</italic><sub><italic toggle="yes">j</italic>,<italic toggle="yes">n</italic></sub>.</p>
            <p>If <italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic>,<italic toggle="yes">n</italic></sub> = <italic toggle="yes">s</italic><sub><italic toggle="yes">j</italic>,1</sub>, we can compute distances (see previous point).</p>
          </list-item>
          <list-item>
            <p><italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic>,1</sub> &lt; <italic toggle="yes">s</italic><sub><italic toggle="yes">j</italic>,1</sub>: the same as the previous case, but mirrored.</p>
          </list-item>
        </list>
        <fig position="float" id="pcbi.1010610.g002">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1010610.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>Schematic representation of the primary clusters’ distance matrix organised into blocks.</title>
            <p>The cluster list is first split into N groups of equal size and then the distance matrix is divided into <italic toggle="yes">N</italic><sup>2</sup> blocks with each block containing distances between clusters in two groups. Since the matrix is symmetric, we can consider a single block for each pair of groups. Blue blocks represent off-diagonal blocks, green blocks represent diagonal blocks.</p>
          </caption>
          <graphic xlink:href="pcbi.1010610.g002" position="float"/>
        </fig>
        <p>We continue reading the two files and computing distances between primary clusters following these rules. We can distinguish between off-diagonal blocks and diagonal blocks (see <xref rid="pcbi.1010610.g002" ref-type="fig">Fig 2</xref>). When computing diagonal blocks, we check that we are not working on pairs of SSRs from the same primary cluster, which would be a pointless computation. This allows reducing the number of comparisons to be done within diagonal blocks.</p>
        <p>We note that it is very important to reach a balance between the number of groups <italic toggle="yes">N</italic> and their size. Indeed, if <italic toggle="yes">N</italic> is small (<italic toggle="yes">N</italic> = 2 as extreme case), we need to store into memory half of the entire distance matrix; however, on the positive side, we need to compute only three blocks: <italic toggle="yes">B</italic><sub>1,2</sub>, <italic toggle="yes">B</italic><sub>1,1</sub> and <italic toggle="yes">B</italic><sub>2,2</sub>. With a large <italic toggle="yes">N</italic> we need less RAM for each computation, but we need to compute <italic toggle="yes">N</italic>(<italic toggle="yes">N</italic> + 1)/2 blocks. While having a large number of independent blocks is useful to compute them in parallel, we must consider also that with more blocks we are increasing the I/O burden.</p>
        <p>The above described block strategy allows for efficient, parallel computing of the primary clusters’ distance matrix. To further speed up the calculations within each single block, we used a multi-threading strategy. In particular, we used a consumer-producer scheme [<xref rid="pcbi.1010610.ref022" ref-type="bibr">22</xref>], with <italic toggle="yes">C</italic> consumer threads and <italic toggle="yes">P</italic> producer threads. “Producer” threads scrolled through the input files, computing partial values for distance entries as they found sets of SSRs with same search IDs; “consumer” threads stored these values in a dedicated data structure, representing the block matrix, which is sparse. Reasonable values of <italic toggle="yes">N</italic>, <italic toggle="yes">C</italic> and <italic toggle="yes">P</italic> strongly depend on the features of the supercomputer used for the calculation. We used 10 nodes with 2 Intel(R) Xeon(R) Gold 6126 CPU @ 2.60GHz (24 cores) and 768GB of RAM. We divided the input data into <italic toggle="yes">N</italic> = 50 groups, computing 1,275 blocks, each using <italic toggle="yes">P</italic> = 3 producer threads and <italic toggle="yes">C</italic> = 20 consumer threads. Each block computation occupied about 500 GB in RAM. The complete computation took about 30,000 CPU hours.</p>
      </sec>
      <sec id="sec008">
        <title>2.4.2 DPC applied to primary clusters</title>
        <p>Once the distance matrix is computed, we generate metaclusters by DPC. To do that, we calculate for each primary cluster <italic toggle="yes">i</italic> the local density, <italic toggle="yes">ρ</italic><sub><italic toggle="yes">i</italic></sub>, and its minimum distance to primary clusters of higher density, <italic toggle="yes">δ</italic><sub><italic toggle="yes">i</italic></sub> (see <xref rid="pcbi.1010610.e007" ref-type="disp-formula">Eq 3</xref>). We estimate the local density similarly to what done previously for clustering individual SSRs:
<disp-formula id="pcbi.1010610.e025"><alternatives><graphic xlink:href="pcbi.1010610.e025.jpg" id="pcbi.1010610.e025g" position="anchor"/><mml:math id="M25" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:munder><mml:mi>χ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
where <italic toggle="yes">μ</italic><sub>2</sub> = 0.9 was again chosen following the rule of thumb in [<xref rid="pcbi.1010610.ref017" ref-type="bibr">17</xref>].</p>
        <p>To compute <italic toggle="yes">ρ</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">δ</italic><sub><italic toggle="yes">i</italic></sub> we need to use the distance matrix, which is stored in 1,275 files, of 2 GB each. First, we pre-allocate vectors for each quantity, <italic toggle="yes">ρ</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">δ</italic><sub><italic toggle="yes">i</italic></sub>. Both vectors have a size equal to the number of primary clusters, and the indexes correspond to the cluster ids, <italic toggle="yes">c</italic><sub><italic toggle="yes">id</italic></sub>. Such vectors are sparsely populated, making this approach not particularly efficient in terms of memory usage. On the other hand, this strategy allows for a fast access to the vectors’ elements.</p>
        <p>We then loop through each file, saving the relevant information in the vectors as we go. Note that, since <italic toggle="yes">δ</italic><sub><italic toggle="yes">i</italic></sub> is a function of <italic toggle="yes">ρ</italic><sub><italic toggle="yes">i</italic></sub>, we need to calculate these quantities sequentially: thus, we need to loop twice through all distance matrix files.</p>
        <p>Once <italic toggle="yes">δ</italic><sub><italic toggle="yes">i</italic></sub> and <italic toggle="yes">ρ</italic><sub><italic toggle="yes">i</italic></sub> are calculated, we select density peaks by choosing as peaks all primary clusters that have <italic toggle="yes">δ</italic> = 1 and <italic toggle="yes">ρ</italic> = 1. We found 504,507 peaks, which have been then used to label the rest of the primary clusters based on the metacluster peak closer to them. If the minimum distance to a peak is bigger than <italic toggle="yes">μ</italic><sub>2</sub> = 0.9 we leave that primary cluster without classification (singleton). Note that this step requires a third read of the distance matrix files.</p>
      </sec>
    </sec>
    <sec id="sec009">
      <title>2.5 Merging and filtering</title>
      <p>The clusters found by DPC typically reflect the hierarchical organization of the probability density from which the data are harvested. If a density peak is split in, say, two sub-peaks separated by a high-density saddle point, the approach will detect this structure and return two separate small clusters. Since this level of description is too fine-grained for the large-scale analysis that we want to perform in this work, we merge closely-related peaks by the procedure described below.</p>
      <p>We start by computing, for each pair of metaclusters MC’ and MC”, the following quantity:
<disp-formula id="pcbi.1010610.e026"><alternatives><graphic xlink:href="pcbi.1010610.e026.jpg" id="pcbi.1010610.e026g" position="anchor"/><mml:math id="M26" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo>″</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo>″</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mi>M</mml:mi><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>″</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi>M</mml:mi><mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo>″</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>″</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
where <italic toggle="yes">N</italic><sub><italic toggle="yes">MC</italic>′</sub> and <italic toggle="yes">N</italic><sub><italic toggle="yes">MC</italic>″</sub> is the number of primary clusters in MC’ and MC”, respectively. <italic toggle="yes">D</italic><sub><italic toggle="yes">MC</italic>′,<italic toggle="yes">MC</italic>″</sub> is the average of the distances between primary clusters contained in the two MCs, where <italic toggle="yes">D</italic><sub><italic toggle="yes">c</italic>′,<italic toggle="yes">c</italic>″</sub> is computed according to <xref rid="pcbi.1010610.e008" ref-type="disp-formula">Eq 4</xref>. We merge all MC pairs for which <italic toggle="yes">D</italic><sub><italic toggle="yes">MC</italic>′, <italic toggle="yes">MC</italic>″</sub> &lt; 0.9.</p>
      <p>This final step requires handling a matrix of size 504,507 × 504,507 (all possible MC pairs), where each element of the matrix occupies 8 bytes of memory (this corresponds to roughly 1TB, exploiting the fact that the matrix is symmetric). After merging, we were left with 210,802 metaclusters. Each of these metaclusters is composed of one or more primary clusters, and each primary cluster is associated to a number of SSRs. As a final step, we perform a post-filtering procedure on the SSRs within each MC in order to remove outliers that are likely to represent noise and, separately, to remove duplicate MC members. In particular, given an MC and a search sequence ID, we remove from the MC all SSRs with that search sequence ID that have little or no overlap with the other SSRs. We remove SSR <italic toggle="yes">i</italic> if no other region <italic toggle="yes">j</italic> exists such that <inline-formula id="pcbi.1010610.e027"><alternatives><graphic xlink:href="pcbi.1010610.e027.jpg" id="pcbi.1010610.e027g" position="anchor"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mi>χ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:msubsup><mml:mo>-</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (cfr. <xref rid="pcbi.1010610.e025" ref-type="disp-formula">Eq 5</xref>). Further, given an MC and a set of overlapping SSRs belonging to the same search sequence, we calculate the average boundaries of the overlapping regions (average start and average end, respectively) and keep as a sole representative of this set the one that best overlaps with such boundaries. The so-obtained set of SSRs is what we call the MC seed. We note that the post-filtering procedures have very little impact on the total computing time of DPCfam.</p>
    </sec>
    <sec id="sec010">
      <title>2.6 Expanding MC membership using profile-HMMs</title>
      <p>For each MC, we take all SSRs and reduce redundancy at 60 percent sequence identity (Cd-Hit [<xref rid="pcbi.1010610.ref023" ref-type="bibr">23</xref>]). If more than 5,000 sequences are left after redundancy reduction, we pick 5,000 representative sequences at random. We use the redundancy-reduced set of sequences to build a multiple sequence alignment (MUSCLE V.3 [<xref rid="pcbi.1010610.ref024" ref-type="bibr">24</xref>], with maxhours parameter set to 1.0 to accelerate the procedure), from which we subsequently derive a profile-HMM (hmmbuild of the HMMER package v. 3.1b2 [<xref rid="pcbi.1010610.ref019" ref-type="bibr">19</xref>]). Finally, we run the profile-HMM against the UniRef50 database (HMMER-hmmsearch) using standard E-value thresholds (domain E-value = 0.03, protein E-value = 0.01). We take all significant profile-HMM hits as our new MC member regions. On average, we see a 4-fold increase in the number of MC members with respect to the original MC definition, although gains vary considerably from MC to MC. We note that, for 26 MCs, HMMER is not able to build a profile-HMM most probably due to the low quality of their alignments.</p>
    </sec>
    <sec id="sec011">
      <title>2.7 Parent-child relationships between MCs</title>
      <p>Some MCs are such that several of their members have large overlaps to the members of a second MC. This can happen, for example, if one MC includes two domains and the other only one. For these cases, we introduce the notion of ‘parent-child’ relationship. In particular, given two MCs, we consider all member pairs that are found on the same protein (we use the profile-HMM-based definition of MC members, see <xref rid="sec002" ref-type="sec">Methods</xref>’ section <italic toggle="yes">Expanding MC membership using profile-HMMs</italic>). We say that the shorter member of the pair is covered by the longer member if the length of their intersection divided by the length of the shorter member is larger than 0.8. We then calculate the fraction of members, <italic toggle="yes">f</italic><sub><italic toggle="yes">mem</italic></sub>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>), of one MC (i) that cover the members of the other (j) and consider the two MCs in a parent-child relationship if <italic toggle="yes">f</italic><sub><italic toggle="yes">mem</italic></sub>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) &gt; 0.1 (where i is the child and j is the parent).</p>
    </sec>
    <sec id="sec012">
      <title>2.8 Assessing properties of MCs’ search sequence regions (SSRs)</title>
      <p>We predict amino acids that are found in Low Complexity [<xref rid="pcbi.1010610.ref025" ref-type="bibr">25</xref>], Coiled-Coil [<xref rid="pcbi.1010610.ref026" ref-type="bibr">26</xref>], Disordered [<xref rid="pcbi.1010610.ref027" ref-type="bibr">27</xref>] or Transmembrane [<xref rid="pcbi.1010610.ref028" ref-type="bibr">28</xref>] regions using the programs segmasker [<xref rid="pcbi.1010610.ref029" ref-type="bibr">29</xref>], DeepCoil [<xref rid="pcbi.1010610.ref030" ref-type="bibr">30</xref>], IUPred2A [<xref rid="pcbi.1010610.ref031" ref-type="bibr">31</xref>] and Phobius [<xref rid="pcbi.1010610.ref032" ref-type="bibr">32</xref>], respectively. All programs are run with default parameters. When running IUPred2A, amino acids are considered as disordered if their score is &gt; 0.5. We label MCs that have more than 10% of amino acids from all of their SSRs in a low complexity, coiled-coil or disordered region as Low Complexity MCs, Coiled-Coil MCs and Disordered MCs, respectively. MCs that have more than two predicted transmembrane regions (calculated as an average over all SSRs) are labeled Transmembrane MCs.</p>
    </sec>
    <sec id="sec013">
      <title>2.9 Annotation of DPCfam MCs using the Pfam family database</title>
      <p>Given a MC, we assign a Pfam ground truth architecture (GTA) to each of its seed SSRs.</p>
      <p>In order to do that, we use Pfam-A v.33 [<xref rid="pcbi.1010610.ref009" ref-type="bibr">9</xref>] annotations of all proteins in UniRef50 v.2017_07 that are also found in UniProtKB v.2019_08 (18,891,393 sequences total, constituting ∼80% of UniRef50 v.2017_07). UniRef50 proteins not in UniProtKB are not considered for this comparison.</p>
      <p>The GTA of a sequence <inline-formula id="pcbi.1010610.e028"><alternatives><graphic xlink:href="pcbi.1010610.e028.jpg" id="pcbi.1010610.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the ordered set of Pfam families, if any, that map to <inline-formula id="pcbi.1010610.e029"><alternatives><graphic xlink:href="pcbi.1010610.e029.jpg" id="pcbi.1010610.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (note that a one-amino acid overlap is enough to include a Pfam family into the GTA). After GTA assignments, we define the dominant architecture of an MC as the GTA that is most abundant among its seed sequences. The dominant architecture can be calculated using Pfam annotations either at the family (DA, hereafter) or at the clan level (DAC), depending on what the ultimate scope of the mapping is.</p>
      <p>DA and DAC can, for example, be used for calculating measures (first defined in Russo et al. [<xref rid="pcbi.1010610.ref016" ref-type="bibr">16</xref>]) that provide useful insights into homologous relationships between MC seed sequences. %DA (%DAC) is the percentage of seed sequences with a GTA that matches exactly the DA (DAC). In the following, we refer seed sequences matching the DA as “DA seed sequences”. Based on %DA, we separate the MCs into three categories: ‘unknown’ MCs are those with %DA = 0 (that is, none of their seed sequences has a Pfam family annotation); ‘partly-known’ MCs are such that 0 &lt;%DA&lt; 50 and, finally, ‘well-known’ are those MCs that have %DA≥50. Further, we define %DACF (DAC Fewer) of an MC as the percentage of seed sequences that have a GTA featuring no Pfam annotation outside of the clans represented by the DA families (as limit cases, these include sequences that have Pfam annotation matching exactly the DAC and, at the other end of the spectrum, sequences lacking any Pfam annotation). Finally, we add to the seed sequences that fall into %DACF those that have GTAs with one or more families not in the DA clans but that feature at least one family belonging to one of the DA clans and obtain %DACFA (DAC fewer and additional). Note that DAC ⊆ DACF ⊆ DACFA. For each MC, these measures represent the fraction of seed sequences featuring Pfam annotations that either match the DA (%DA and %DAC) or are at least not incompatible with it (%DACF and %DACFA). As such, they can provide important insights into homology relationships within MC members. For example, MCs with %DA or %DAC close to 100 have the vast majority of their seed sequences carrying the same Pfam annotation (at the family or clan level) and thus according to Pfam share to the very least a core homologous region. Even when %DA/DAC values are low and provided that %DACF or %DACFA are high, most members of an MC are still likely to share a core homologous region although this may not match the full DA annotation. Finally, by definition, MCs with low %DACFA values feature a sizable fraction of members that have Pfam annotations completely unrelated to their DA and are thus the ones most likely to contain a mixture of non-homologous regions. In some instances, however, these apparent inconsistencies may instead point to incomplete Pfam annotations, whereby families thus far considered unrelated may have a common evolutionary origin and thus belong to the same Pfam clan. Examples of MCs falling in each of the above categories can be found in Russo et al. [<xref rid="pcbi.1010610.ref016" ref-type="bibr">16</xref>].</p>
      <p>Further, given an MC and its DA, we look at how the MC seed sequence boundaries compare to those of the Pfam DA annotation. For this analysis, we restrict ourselves to MCs with %DA≥ 50 and, within those, to DA seed sequences (see definitions above). For all DA seed sequences <inline-formula id="pcbi.1010610.e030"><alternatives><graphic xlink:href="pcbi.1010610.e030.jpg" id="pcbi.1010610.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, we call <inline-formula id="pcbi.1010610.e031"><alternatives><graphic xlink:href="pcbi.1010610.e031.jpg" id="pcbi.1010610.e031g" position="anchor"/><mml:math id="M31" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> the region of the full-length protein they belong to that is covered by their GTA (which, in this case, is the same as the MC’s DA). <inline-formula id="pcbi.1010610.e032"><alternatives><graphic xlink:href="pcbi.1010610.e032.jpg" id="pcbi.1010610.e032g" position="anchor"/><mml:math id="M32" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> stretches from the first amino acid of the most N-terminal Pfam family in the GTA to the last amino acid of the most C-terminal Pfam family in the GTA. We estimate the overlap between an MC DA seed sequence <inline-formula id="pcbi.1010610.e033"><alternatives><graphic xlink:href="pcbi.1010610.e033.jpg" id="pcbi.1010610.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and the GTA/DA <inline-formula id="pcbi.1010610.e034"><alternatives><graphic xlink:href="pcbi.1010610.e034.jpg" id="pcbi.1010610.e034g" position="anchor"/><mml:math id="M34" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> as follows:
<disp-formula id="pcbi.1010610.e035"><alternatives><graphic xlink:href="pcbi.1010610.e035.jpg" id="pcbi.1010610.e035g" position="anchor"/><mml:math id="M35" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
where |.| represents the length (expressed in number of amino acids) of the indicated region. <inline-formula id="pcbi.1010610.e036"><alternatives><graphic xlink:href="pcbi.1010610.e036.jpg" id="pcbi.1010610.e036g" position="anchor"/><mml:math id="M36" display="inline" overflow="scroll"><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> ranges between 0 (no overlap) and <inline-formula id="pcbi.1010610.e037"><alternatives><graphic xlink:href="pcbi.1010610.e037.jpg" id="pcbi.1010610.e037g" position="anchor"/><mml:math id="M37" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (1 if <inline-formula id="pcbi.1010610.e038"><alternatives><graphic xlink:href="pcbi.1010610.e038.jpg" id="pcbi.1010610.e038g" position="anchor"/><mml:math id="M38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>). Next, we calculate the average of <inline-formula id="pcbi.1010610.e039"><alternatives><graphic xlink:href="pcbi.1010610.e039.jpg" id="pcbi.1010610.e039g" position="anchor"/><mml:math id="M39" display="inline" overflow="scroll"><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> over all the DA seed sequences (<italic toggle="yes">O</italic><sub><italic toggle="yes">MC</italic></sub>). This is our measure for the ‘overlap’, or boundary agreement, between an MC and its DA. Since <italic toggle="yes">O</italic><sub><italic toggle="yes">MC</italic></sub> is symmetric with respect to MCs and DAs, in order to further investigate the nature of the overlap, for each protein sequence featuring an MC seed sequence-DA pair we introduce two additional quantities:
<disp-formula id="pcbi.1010610.e040"><alternatives><graphic xlink:href="pcbi.1010610.e040.jpg" id="pcbi.1010610.e040g" position="anchor"/><mml:math id="M40" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
<disp-formula id="pcbi.1010610.e041"><alternatives><graphic xlink:href="pcbi.1010610.e041.jpg" id="pcbi.1010610.e041g" position="anchor"/><mml:math id="M41" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>-</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">I</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula></p>
      <p><italic toggle="yes">F</italic><sub><italic toggle="yes">red</italic>,<italic toggle="yes">i</italic></sub> represents the fraction of the GTA/DA <inline-formula id="pcbi.1010610.e042"><alternatives><graphic xlink:href="pcbi.1010610.e042.jpg" id="pcbi.1010610.e042g" position="anchor"/><mml:math id="M42" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> that is not covered by the MC seed sequence <inline-formula id="pcbi.1010610.e043"><alternatives><graphic xlink:href="pcbi.1010610.e043.jpg" id="pcbi.1010610.e043g" position="anchor"/><mml:math id="M43" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>; <italic toggle="yes">F</italic><sub><italic toggle="yes">ext</italic>,<italic toggle="yes">i</italic></sub> is the fraction of <inline-formula id="pcbi.1010610.e044"><alternatives><graphic xlink:href="pcbi.1010610.e044.jpg" id="pcbi.1010610.e044g" position="anchor"/><mml:math id="M44" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> not covered by the GTA/DA.</p>
      <p>We then average both quantities over all seed sequence-DA pairs obtaining <inline-formula id="pcbi.1010610.e045"><alternatives><graphic xlink:href="pcbi.1010610.e045.jpg" id="pcbi.1010610.e045g" position="anchor"/><mml:math id="M45" display="inline" overflow="scroll"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010610.e046"><alternatives><graphic xlink:href="pcbi.1010610.e046.jpg" id="pcbi.1010610.e046g" position="anchor"/><mml:math id="M46" display="inline" overflow="scroll"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. Following this, we classify MCs into the following 4 categories (see <xref rid="pcbi.1010610.s004" ref-type="supplementary-material">S1(B) Fig</xref>):</p>
      <list list-type="bullet">
        <list-item>
          <p><italic toggle="yes">equivalent</italic> : both <inline-formula id="pcbi.1010610.e047"><alternatives><graphic xlink:href="pcbi.1010610.e047.jpg" id="pcbi.1010610.e047g" position="anchor"/><mml:math id="M47" display="inline" overflow="scroll"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010610.e048"><alternatives><graphic xlink:href="pcbi.1010610.e048.jpg" id="pcbi.1010610.e048g" position="anchor"/><mml:math id="M48" display="inline" overflow="scroll"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2</mml:mn></mml:math></alternatives></inline-formula>, yellow;</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">reduced</italic> : <inline-formula id="pcbi.1010610.e049"><alternatives><graphic xlink:href="pcbi.1010610.e049.jpg" id="pcbi.1010610.e049g" position="anchor"/><mml:math id="M49" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010610.e050"><alternatives><graphic xlink:href="pcbi.1010610.e050.jpg" id="pcbi.1010610.e050g" position="anchor"/><mml:math id="M50" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, blue;</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">extended</italic> : <inline-formula id="pcbi.1010610.e051"><alternatives><graphic xlink:href="pcbi.1010610.e051.jpg" id="pcbi.1010610.e051g" position="anchor"/><mml:math id="M51" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010610.e052"><alternatives><graphic xlink:href="pcbi.1010610.e052.jpg" id="pcbi.1010610.e052g" position="anchor"/><mml:math id="M52" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, pink;</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">shifted</italic> : both <inline-formula id="pcbi.1010610.e053"><alternatives><graphic xlink:href="pcbi.1010610.e053.jpg" id="pcbi.1010610.e053g" position="anchor"/><mml:math id="M53" display="inline" overflow="scroll"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010610.e054"><alternatives><graphic xlink:href="pcbi.1010610.e054.jpg" id="pcbi.1010610.e054g" position="anchor"/><mml:math id="M54" display="inline" overflow="scroll"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> are ≥ 0.2, green.</p>
        </list-item>
      </list>
    </sec>
    <sec id="sec014">
      <title>2.10 Definition of representative MCs for Pfam and ECOD families</title>
      <p>In this section, we describe how we assign to each Pfam or ECOD family a best matching (representative) MC. For finding representative MCs for Pfam families, we first run the MCs’ profile-HMMs against the UniRef50 database (HMMER-hmmsearch) using standard E-value thresholds (domain E-value = 0.03, sequence E-value = 0.01). Then, given a Pfam family, we define its representative MC as the one for which the set of its profile-HMM matches cover at least half of the Pfam family sequence IDs that are found in UniRef50 and, if more than one MC satisfies this condition, the one that produces the highest average overlap (see <xref rid="pcbi.1010610.e035" ref-type="disp-formula">Eq 7</xref>) with the Pfam family. We classify each representative MC as equivalent, reduced, extended or shifted (see above and <xref rid="pcbi.1010610.s004" ref-type="supplementary-material">S1 Fig</xref>).</p>
      <p>Next, we download ECOD [<xref rid="pcbi.1010610.ref008" ref-type="bibr">8</xref>] F-group (families with close evolutionary relationship) annotations of PDB proteins from version 20210511 and remove annotations of non-contiguous domains (that is, domains that are split in multiple segments along the protein sequence). We further restrict our analysis to PDB proteins that feature in UniProtKB (referred to as ‘PDB-UniProtKB sequences’, hereafter). We obtain a dataset of 67,786 distinct annotations on 45,518 proteins from a total of 11,733 ECOD families. We then run DPCfam profile-HMMs against the ECOD-annotated PDB-UniProtKB sequences (hmmsearch with domain E-value = 0.03, sequence E-value = 0.01). We finally define the representative MC of each ECOD family (if any) exactly as we did previously for Pfam families.</p>
    </sec>
    <sec id="sec015">
      <title>2.11 Assigning AlphaFold DB representative structures to MCs</title>
      <p>AlphaFold DB [<xref rid="pcbi.1010610.ref033" ref-type="bibr">33</xref>, <xref rid="pcbi.1010610.ref034" ref-type="bibr">34</xref>] provides protein structure predictions for the human proteome and a host of other proteins. This data represent an opportunity to further characterize MCs at a structural level when no experimental PDB structure for its member regions is available. We map AlphaFold structures to MCs by running the MCs’ profile-HMMs with hmmsearch against the dataset of 992,316 proteins that constitute version 2 of AlphaFold DB. The representative of an MC is chosen as the protein in AlphaFold DB with a significant match to the MC’s profile-HMM (domain E-value = 0.03, sequence E-value = 0.01) and (if more than one match is present) as the one with the highest coverage of the profile-HMM model. If there is no AlphaFold protein satisfying these criteria, no representative is assigned.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="sec016">
    <title>3 Results</title>
    <sec id="sec017">
      <title>3.1 Automatic clustering of protein regions from the UniRef50 database</title>
      <p>Running DPCfam on the Uniref50 database produced 210,802 Metaclusters (MCs). In <xref rid="pcbi.1010610.g003" ref-type="fig">Fig 3A</xref> (purple), we show that their size is approximately distributed as a power-law with exponent ∼ −2.15 for almost 4 orders of magnitude (black line). The power-law functional form of the distribution of protein family sizes has been ascribed to the biological processes at the basis of protein evolution [<xref rid="pcbi.1010610.ref035" ref-type="bibr">35</xref>] such as gene duplication or gene generation. A qualitatively similar trend is observed for the size of Pfam families (green) as it has previously been reported [<xref rid="pcbi.1010610.ref035" ref-type="bibr">35</xref>]. In the case of Pfam families, however, a power-law behaviour is observed for only about 2 orders of magnitude, suggesting potential under-representation of smaller size families in Pfam. Indeed, we note that about 75% of MCs and about 30% of Pfam families have less than 50 seed sequences, respectively. For the rest of our analysis, we will focus on MCs of size ≥50 since they are more interesting in terms of their taxonomic range and because, for this group, comparison with the Pfam classification appears to be more meaningful. We additionally exclude from downstream analysis MCs such that their average seed sequence length is smaller than 50 amino acids. This leaves us with 46,828 MCs, or 22.2% of the total. We note that most of these MCs feature a rather uniform distribution of seed sequence lengths. Indeed, the ratio between standard deviation and average of the length of their seed sequences is typically around 0.1 and only in 5.9% of the cases it is larger than 0.2. Also, the median of the MCs’ average seed sequence length is 99.9, with only about 4% of MCs having average length &gt;500.</p>
      <fig position="float" id="pcbi.1010610.g003">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010610.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>General properties of Metaclusters.</title>
          <p><bold>A</bold> Cumulative Distribution Function (1-CDF) of MC (purple) and Pfam family (green) sizes. All 210,802 MCs have been considered, with the size of a MC equal the number of its seed sequences. Pfam families (v. 33) are all those in Uniref50 ∩ UniprotKB (18,189 total) and family size is the ‘full’ size, that is, not only considering Pfam seed sequences. Black line: best fit of MC’s CDF with a power-law (CDF exponent <italic toggle="yes">γ</italic> = −1.15, corresponding to an exponent of −2.15 of the Probability Distribution Function). In <xref rid="pcbi.1010610.s006" ref-type="supplementary-material">S3 Fig</xref>, we additionally plot the size of MCs/Pfam families as a function of their size rank. <bold>B</bold>: Venn diagram showing the percentage of Low Complexity MCs (green), Disordered MCs (red) and Coiled-Coil MCs (purple), respectively (see <xref rid="sec002" ref-type="sec">Methods</xref> for definitions). Note that, in this case, only MCs containing at least 50 seed sequences and with average length ≥ 50 are considered (46,828 total).</p>
        </caption>
        <graphic xlink:href="pcbi.1010610.g003" position="float"/>
      </fig>
      <p>Out of a total of 46,828 MCs, 16.5% are characterized by high content of one or more among low-complexity, disordered and coiled-coil regions (<xref rid="pcbi.1010610.g003" ref-type="fig">Fig 3B</xref>). All of these regions present biases in their amino acid composition that make it harder, at least in principle, to infer homology from sequence similarity; additionally, disordered regions typically present a higher than average number of insertions and deletions, which further complicate the task of aligning them properly. Still, high disorder levels do not necessarily affect the quality of a MC. The existence of conserved protein families rich in disordered regions is well known from the literature [<xref rid="pcbi.1010610.ref005" ref-type="bibr">5</xref>] and, indeed, some disordered MCs show high levels of sequence conservation (see <xref rid="pcbi.1010610.s005" ref-type="supplementary-material">S2 Fig</xref> for an interesting example of a disordered MC). At any rate, 83.5% of MCs have low contents of compositionally-biased regions, suggesting that they may correspond to the structured portion of the protein universe and thus represent prime targets for family building. 3.5% of MCs are predicted to contain at least two transmembrane helices and have low contents of compositional bias thus likely spanning transmembrane helical bundle domains.</p>
    </sec>
    <sec id="sec018">
      <title>3.2 Homologous relationships between member regions of DPCfam MCs</title>
      <p>In order to investigate homology relationships between MC members, we look at their Pfam family annotation. To each MC, when possible, we assign a Pfam dominant architecture (DA; note that it may correspond either to a single family or to a multi-family architecture). For 14,190 MCs we find no Pfam annotation in any of their seed sequence regions and as a consequence we cannot assign a DA to them. We label these MCs as ‘unknown’. We will discuss in one of the following sections how unknown MCs may represent a potential pool of novel families. For all the others, we calculate the proportion of seed sequences with Pfam annotations matching the DA exactly (%DA) or partially (%DAC, %DACF and %DACFA) (<xref rid="sec002" ref-type="sec">Methods</xref>). Overall, 11,429 MCs have %DA&gt; 95 (this is 35.1% of those with a DA). These are MCs that can be considered as almost completely covered by existing Pfam families. An additional 62.6% of our MCs with a DA are such that %DAC&lt; 95 and %DACFA&gt; 95. As explained in Methods, member regions of these MCs are very likely to share a core homologous region. In conclusion, only about 2.3% of MCs to which a DA can be assigned have %DACFA&lt; 95 and are thus, according to Pfam, a potential mixture of non-homologous regions.</p>
    </sec>
    <sec id="sec019">
      <title>3.3 Assessing the quality of MC boundaries</title>
      <p>Next, we ask to what extent boundaries of MCs and their associated Pfam families differ when evaluated on the same protein sequences. For this purpose, we consider only MCs such that %DA≥ 50 (22,668 total, or 69.5% of those with a DA annotation), that is, those for which we can perform boundary comparison on the majority of their seed sequence regions. Most of these MCs (92.5%) display a single-family DA. In <xref rid="pcbi.1010610.g004" ref-type="fig">Fig 4</xref>, we show the distribution of the average overlap between those seed sequences that have an exact match to the DA (DA seed sequences) and the corresponding DA annotations (see <xref rid="sec002" ref-type="sec">Methods</xref> for definitions). 25.7% of these MCs are classified as “equivalent”, thus having a generally good agreement with the Pfam DA’s boundaries; 36.6% are classified as “reduced” (cover only a fraction of the DA) and 16.0% as “extended” (extend significantly beyond the DA), with an accordingly smaller average overlap. Finally, 21.8% of MCs with %DA≥ 50 are classified as “shifted”. Note that while shifted MCs have poor boundary agreement with their DA annotation, the ones with very small overlaps may actually represent novel families located N-terminal or C-terminal to the DA.</p>
      <fig position="float" id="pcbi.1010610.g004">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010610.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Histogram showing average overlap (<italic toggle="yes">O</italic><sub><italic toggle="yes">MC</italic></sub>) between MCs (only those with %DA≥50) and their associated Pfam DAs.</title>
          <p>Colors reflect the contribution of each MC category to each bin (equivalent, reduced, extended and shifted, see <xref rid="pcbi.1010610.s004" ref-type="supplementary-material">S1(B) Fig</xref> and <xref rid="sec002" ref-type="sec">Methods</xref> for definitions). The legend on the right side of the histogram reports total counts of MCs in each category and, additionally, total count of MCs with %DA&lt;50 and total count of unknown MCs.</p>
        </caption>
        <graphic xlink:href="pcbi.1010610.g004" position="float"/>
      </fig>
      <p>We will see that the rather large number of reduced and extended MCs can, to a good extent, be explained by MC “redundancy” or the fact that oftentimes multiple MCs map to the same Pfam families while covering different parts of it. This will be discussed in detail in the next section.</p>
      <p>To inspect the relationship between Pfam and DPCfam profile-HMMs’ hits, we first assign an equivalent label to all possible MCs irrespective of their %DA. We count 5,519 equivalent MCs with a single family-DA (see <xref rid="pcbi.1010610.s007" ref-type="supplementary-material">S4 Fig</xref>). Within this set, we see a strong agreement in terms of the protein hits generated by the respective profile-HMM models in Pfam family-equivalent MC pairs, suggesting that equivalent MCs reproduce to a good degree their corresponding Pfam families both in terms of their boundaries and of the area of the sequence space that they cover.</p>
    </sec>
    <sec id="sec020">
      <title>3.4 MC redundancy with respect to the Pfam annotation</title>
      <p>When looking at <xref rid="pcbi.1010610.g004" ref-type="fig">Fig 4</xref>, we need to keep in mind that many MCs map to Pfam families that are already covered by other MCs. We call this property ‘redundancy’ and distinguish between MC pairs that are fully redundant (same DA) and those that are partially redundant (their DAs have at least one family in common) with respect to their Pfam annotation. We consider the 22,668 MCs for which %DA≥50. Among these, 73.6% have at least one fully redundant companion and 30.3% at least one partially redundant companion, with a total of 81.6% falling in at least one of the two categories. In the following, we focus on the larger set of fully redundant MCs.</p>
      <p>In <xref rid="pcbi.1010610.s008" ref-type="supplementary-material">S5 Fig</xref>, we show the number of MCs as a function of their degree of redundancy (RDegree; degree 1 = no other MC carries the same DA, 2 = one other MC carries the same DA and so on). Of all pairs composed of fully redundant MCs, 30.9% are found in a parent-child relationship (see <xref rid="sec002" ref-type="sec">Methods</xref>), and only about 3% of these pairs are such that both MCs are simultaneously parent and child with respect to each other, reflecting a clan-like relationship. We note that in parent-child pairs at least one of the two MCs is likely to be reduced or extended with respect to the Pfam DA they share.</p>
      <p>In <xref rid="pcbi.1010610.g005" ref-type="fig">Fig 5</xref>, we further explore the relationship between fully redundant MC pairs that are not in a parent-child correspondence. We report the fraction of proteins that are covered by both MCs (using all hits from their associated profile-HMMs) and show that 49.3% of them have less than 10% of proteins in common and 31.8% have no protein in common at all. This means that in a sizable fraction of cases, MCs in a fully redundant pair cover different portions of the protein-sequence space with the same Pfam annotation. They thus appear to represent sub-families of the associated Pfam annotation.</p>
      <fig position="float" id="pcbi.1010610.g005">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010610.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Comparison between areas of sequence space covered by MCs in fully redundant pairs.</title>
          <p>Note that we exclude MC pairs in parent-child relationships and are left with 25,980 pairs overall. For each MC, we generate the list of IDs of all proteins that map to at least one MC member (using the profile-HMM-based definition of MC membership, see <xref rid="sec002" ref-type="sec">Methods</xref>). Then, for each pair, we calculate the fraction of protein IDs that are shared between the two MCs (where the fraction is calculated with respect to the MC with the shorter protein ID list).</p>
        </caption>
        <graphic xlink:href="pcbi.1010610.g005" position="float"/>
      </fig>
    </sec>
    <sec id="sec021">
      <title>3.5 Coverage of Pfam families by DPCfam MCs</title>
      <p>We now ask how many Pfam families out of a total of 18,198 (Pfam version 33.0) have a DPCfam’s MC counterpart. First, we investigate coverage of Pfam families by MCs regardless of how good is their boundary agreement.</p>
      <p>For the sake of this comparison, we consider only Pfam families with at least 100 sequence members in UniRef50 ∩ UniprotKB (10,631 families or 58.4% of the total). For 81.3% of these families (8,647 total), we can define a representative MC (see <xref rid="sec002" ref-type="sec">Methods</xref>). For each representative MC, we determine whether it is equivalent, reduced, extended or shifted with respect to its corresponding Pfam family (note: the latter may not coincide with the MC’s DA). In <xref rid="pcbi.1010610.g006" ref-type="fig">Fig 6A</xref>, we plot the average overlap between Pfam families and their corresponding representative MCs (that is, average overlap between their member regions) and color the Pfam families according to their representative MC overlap category. In particular, 50.6% (4,372) of these families have an equivalent representative (good agreement between Pfam and representative MC boundaries), 13.8% (1,197) a reduced representative (MC covers a sub-region of the family), 29.3% (2,531) an extended representative (MC extends beyond the boundaries of the family) and, finally, 6,2% (537) a shifted representative. We further investigate the possibility that extended representatives may in fact correspond to MCs that cover a multi-family Pfam architecture (that is, with a multi-family DA). For each Pfam family in <xref rid="pcbi.1010610.g006" ref-type="fig">Fig 6A</xref>, we find the family architecture that has the best overlap to the representative MC (this architecture can contain either only the original family or the original family plus up to two additional ones). It can be seen, <xref rid="pcbi.1010610.g006" ref-type="fig">Fig 6B</xref>, that the average overlap with several representative MCs that were previously classified as extended (pink bars) increases, thus confirming that a significant fraction of these representative MCs match multi-family Pfam architectures.</p>
      <fig position="float" id="pcbi.1010610.g006">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010610.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Histograms showing average overlap between Pfam families and their representative MCs.</title>
          <p>Colors reflect the contribution of each MC category to each bin (equivalent, reduced, extended and shifted, see <xref rid="pcbi.1010610.s004" ref-type="supplementary-material">S1(B) Fig</xref> and <xref rid="sec002" ref-type="sec">Methods</xref> for definitions). <bold>A</bold>: Overlap between individual Pfam families and their representative MCs <bold>B</bold>: Overlap between individual Pfam families or architectures and representative MCs. Given a Pfam family and its representative MC (same pairs as in A), we search for a better overlap of the representative MC with any multi-family architecture featuring the original Pfam family and up to two additional families. The reported average overlap value is thus the best between the overlap with the original family and any other such Pfam architecture. Note that the Pfam architecture labels (equivalent/reduced/extended/shifted) are still assigned according to the representative MC overlap to the original Pfam family so as to show to which extent the overlap in each MC category increases with respect to A).</p>
        </caption>
        <graphic xlink:href="pcbi.1010610.g006" position="float"/>
      </fig>
      <p>Next, we compare the overall UniRef50 (v. 2017_07) protein coverage of Pfam families with that one of DPCfam MCs. For this purpose, we use hits from the profile-HMMs associated to all Pfam families (18,189 families in total) and to all MCs with average length ≥ 50 and seed size ≥ 50 (46,828 MCs total) (<xref rid="sec002" ref-type="sec">Methods</xref>). Pfam families and MCs cover 50.0% and 52.5% of proteins in UniRef50, respectively, with 41.1% of UniRef50 proteins being covered both by Pfam and DPCfam models. UniRef50 coverage at the residue level is 33.6% for Pfam and 46.9% for MCs. Note that Pfam coverage is much lower than the one reported for the whole of UniProtKB (77.0% of proteins, 53.2% of residues [<xref rid="pcbi.1010610.ref009" ref-type="bibr">9</xref>]). This, however, should be expected given that, compared to UniRef50, UniProtKB should contain a larger fraction of redundant proteins belonging to the largest families represented in Pfam. We note that although MC profile-HMMs outnumber Pfam families profile-HMMs about 2.6 to 1, the difference in UniRef50 protein coverage between the two classifications is only about 2.5%. This can have several explanations. First, as seen in the previous section many MCs are redundant (that is, they map to the same Pfam families). Second, the portion of UniRef50 that is still not covered by Pfam is likely to be constituted by a large number of families with a small taxonomic range [<xref rid="pcbi.1010610.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1010610.ref036" ref-type="bibr">36</xref>]. As a consequence, even a significant increase in the number of families may not translate into much larger coverage levels. This may also help explain why about 40% of all sequences in UniRef50 remain uncovered by either classification. In this context, it should be remembered that our analysis has been limited to DPCfam’s MCs that had length and seed size higher than 50. It is thus conceivable that the about 165K MCs that we have not taken into consideration contain a large number of small-size families that could make up at least some of the missing coverage. We briefly discuss smaller MCs in the section entitled “Small Metaclusters and DPCfam-B database” below. The rest of the unannotated sequence space may be represented by families of extremely limited taxonomic range or by compositionally-biased regions that are notoriously difficult to classify into homologous families.</p>
    </sec>
    <sec id="sec022">
      <title>3.6 Coverage of structure-based ECOD families by DPCfam MCs</title>
      <p>We now compare DPCfam’s MCs to the structure-based family annotation provided by the ECOD database (<xref rid="sec002" ref-type="sec">Methods</xref>). ECOD splits proteins of known structure into structural domains and then clusters the domains at different levels of sequence and/or structural similarity. The specific value of comparing DPCfam with ECOD is that, although the ECOD classification is limited to families that have at least one representative of known structure, in general structure-based ECOD family boundaries should be of higher quality when evaluated against corresponding Pfam family boundaries. This is unless the Pfam family has also been built (or re-built) taking advantage of available structural information, which may well be the case. Overall, for 72.0% of ECOD families (8,473 of all 11,773) we can define a representative MC. In <xref rid="pcbi.1010610.g007" ref-type="fig">Fig 7A</xref>, similar to what done for Pfam, we report the overlap between ECOD families and their representative MCs. 27.1% (2,300), 31.5% (2,671), 23.2% (1,965), 18.2% (1,537) of families have an equivalent, reduced, extended, shifted representative, respectively. We can see that the percentage of ECOD-equivalent MCs is about half the percentage of Pfam-equivalent MCs. This clearly reflects the different nature of ECOD and Pfam whereby Pfam, similar to DPCfam, mainly relies on sequence conservation signals to establish family boundaries, while ECOD uses structural information.</p>
      <fig position="float" id="pcbi.1010610.g007">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1010610.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>Histograms showing average overlap between ECOD families and their representative MCs.</title>
          <p>Colors reflect the contribution of each MC category to each bin (equivalent, reduced, extended and shifted, see <xref rid="pcbi.1010610.s004" ref-type="supplementary-material">S1(B) Fig</xref> and <xref rid="sec002" ref-type="sec">Methods</xref> for definitions). <bold>A</bold>: Overlap between individual ECOD families and their representative MCs (cfr. with <xref rid="pcbi.1010610.g006" ref-type="fig">Fig 6</xref>) <bold>B</bold>: Overlap between individual ECOD families or architectures and representative MCs. Given an ECOD family and its representative MC (same pairs as in A), we search for a better overlap of the representative MC with any multi-family architecture featuring the original ECOD family and up to two additional families. The reported average overlap value is thus the best between the overlap with the original family and any other such ECOD architecture. Note that the ECOD architecture labels (equivalent/reduced/extended/shifted) are still assigned according to the representative MC overlap to the original ECOD family so as to show to which extent the overlap in each MC category increases with respect to A).</p>
        </caption>
        <graphic xlink:href="pcbi.1010610.g007" position="float"/>
      </fig>
      <p>Next, similar to what done when analysing Pfam coverage, we search for a better overlap of the representative MCs with any multi-family architecture featuring the original ECOD family and up to two additional families. Again, it can be clearly seen that many ECOD families with an extended representative are part of a larger multi-family architecture with a better overlap to the MC. Indeed, about 41% of ECOD multi-family architectures feature a representative MC with overlap &gt; 0.75.</p>
      <p>Finally, for comparison, we calculate the overlap between ECOD and Pfam families (with Pfam in the role played by DPCfam in the previous analysis) (<xref rid="pcbi.1010610.s010" ref-type="supplementary-material">S7 Fig</xref>). For the sake of this comparison, we exclude Pfam families of small size (less than 100 members in UniRef50). About 65.0% of all ECOD families have a representative among medium to large size Pfam family (or a representative PF, analogous to the previously defined representative MC). Of these, 36.2%, 33.1%, 18.3%, 12.4% are equivalent, reduced, extended, shifted, respectively. When considering ECOD multi-family architectures, 48.8% of them have a Pfam representative with overlap&gt; 0.75.</p>
    </sec>
    <sec id="sec023">
      <title>3.7 MCs ‘unknown’ to Pfam</title>
      <p>In the previous sections, we used Pfam to evaluate the overall quality of DPCfam metaclusters. For 14,190 unknown MCs (almost 30% of the total) such comparison is not possible given that none of their member regions feature a Pfam annotation. A further 9,971 MCs are partly-known MCs or MCs with a Pfam dominant architecture present in less than 50% of their seed sequences. While the latter may provide scope for Pfam family or clan extension, in this section we focus on the 14,190 unknown MCs. We first compare the percentages of low complexity, coiled-coil and disordered MCs in the unknown set versus the equivalent set (see <xref rid="pcbi.1010610.g004" ref-type="fig">Fig 4</xref>, yellow bars), which is used here as high-quality MC reference. We observe that the vast majority of unknown MCs (78.6%) are likely to represent structured regions of the sequence space, which constitute the traditional targets for family building, while the corresponding percentage for “equivalent” MCs is 86.4% (it was 83.5% across all MCs) (<xref rid="pcbi.1010610.s011" ref-type="supplementary-material">S8 Fig</xref>). This analysis supports the idea that most unknown MCs have the potential to be used as seeds for defining novel protein families. To further test this hypothesis, we teamed up with the Pfam database.</p>
      <p>Pfam has now started using the list of unknown MCs to seed novel families and its release 35.0 already includes 63 such entries (see <xref rid="pcbi.1010610.s002" ref-type="supplementary-material">S2 Table</xref>). Pfam has expended a huge amount of effort to cover proteins which have known function. Thus, it is not surprising that the majority of new families added to Pfam from DPCfam so far are Domains of Unknown Function. Of the 63 added to date 42 are DUF families. However, there is a lot of value in creating these families, because they provide a target for molecular biologists to investigate and enable high throughput computational studies of complete genomes. Among the non-DUF families, a nice example is the Crinkler domain (PF20147 based on DPCfam:MC202620). This entry represents the N-terminal ubiquitin-like domain of a large family of fungal effectors. It currently matches over 3,000 proteins in the UniProt Reference Proteomes. Important plant pathogens such as Phytophthora contains more than a hundred copies of these proteins. As well as being found in plant pathogens Crinkler family proteins can be found in Arbuscular mycorrhizal fungus <italic toggle="yes">Rhizophagus irregularis</italic> [<xref rid="pcbi.1010610.ref037" ref-type="bibr">37</xref>]. The crinkler protein appears to be important for the mediation of the plant fungal symbiosis. Thus, these proteins may have important roles in agriculture. The addition of this family to Pfam enables the identification of a large class of fungal effectors that were previously not identified in the sequence databases such as UniProt, and will enable computational analysis into the function and evolution of this large class of important proteins. A second example is the N-terminal domain found in the nematode NRF6 protein (PF20146 based on DPCfam:MC15137). This domain is predicted to be extracellularly posed over a transmembrane embedded Acyltransferase domain [<xref rid="pcbi.1010610.ref038" ref-type="bibr">38</xref>]. <italic toggle="yes">Caenorhabditis elegans</italic> and <italic toggle="yes">Drosophila melanogaster</italic> both have 18 proteins containing this domain. Surprisingly, there is no protein in PDB which shows structural similarity to this domain according to Foldseek [<xref rid="pcbi.1010610.ref039" ref-type="bibr">39</xref>]. Thus, it may represent a novel protein fold. Given the role of NRF6 in binding to Fluoxetine (Prozac) it seems likely that this domain is involved in binding to a range of xenobiotics in animals and may be involved in chemosensation of toxic chemicals. Although mouse, rat and even macaque have these proteins there appears to be no human homologue, suggesting whatever the function of NRF6 and its homologues is, this function has been lost in the human lineage. We expect many more unknown MCs to be turned into Pfam families in the future.</p>
      <p>Further, the publication of the AlphaFold database of predicted protein structures [<xref rid="pcbi.1010610.ref033" ref-type="bibr">33</xref>, <xref rid="pcbi.1010610.ref034" ref-type="bibr">34</xref>] allows to add an extra dimension to the annotation of our UNK MCs. In particular, if a representative structure for an MC can be found in AlphaFold DB, it may provide valuable insight for determining if the MC represents a structural domain or a conserved unstructured region, whether or not the MC boundaries need to be extended or trimmed and, possibly, its functional annotation. With these goals in mind, we have thus run DPCfam MCs’ profile-HMMs against AlphaFold DB. This allowed us identifying a representative predicted structure (see <xref rid="sec002" ref-type="sec">Methods</xref>) for 64.6% of UNK MCs and we observe that for 56.3% of UNK MCs the AlphaFold DB representative covers at least half of the profile-HMM (the corresponding percentages for all MCs are 82.5% and 75.3%, respectively). We show a few examples of the mapping between UNK MCs and their representative AlphaFold structures in <xref rid="pcbi.1010610.s013" ref-type="supplementary-material">S10</xref>–<xref rid="pcbi.1010610.s017" ref-type="supplementary-material">S14</xref> Figs. In particular, we select the top 25 unknown MCs in terms of the number of their seed sequences along with a few more that are not in the top list but were among those used to seed novel Pfam families. The list of the top 25 MCs with information about their inclusion in Pfam and their alignment to their representative AlphaFold structure (if present) is shown in <xref rid="pcbi.1010610.s003" ref-type="supplementary-material">S3 Table</xref>. For <xref rid="pcbi.1010610.s013" ref-type="supplementary-material">S10</xref>–<xref rid="pcbi.1010610.s016" ref-type="supplementary-material">S13</xref> Figs, we select the TOP MCs that are almost completely covered by their representative structure (coverage ≥0.9 see <xref rid="pcbi.1010610.s003" ref-type="supplementary-material">S3 Table</xref>). In several instances, MCs appear to map rather well to what can intuitively be recognised as individual structural domains within the context of the larger structure. These include, but are not limited to, the Crinkler and NRF domains (<xref rid="pcbi.1010610.s014" ref-type="supplementary-material">S11(B) and S11(C) Fig</xref>). In one case (MC186369, <xref rid="pcbi.1010610.s013" ref-type="supplementary-material">S10(A) Fig</xref>), the MC extends over what has been predicted by AlphaFold mostly as an unstructured region. Sequences part of the Pfam family that has been built from this MC (PF20150 or 2EXR) include two conserved ExR motifs that might be functionally important. Finally, in a few cases, the MCs appear to represent small portions of larger domains (for example, <xref rid="pcbi.1010610.s015" ref-type="supplementary-material">S12(A) and S12(B) Fig</xref>) or to cover full length proteins, irrespective of the presence of multiple domains (<xref rid="pcbi.1010610.s016" ref-type="supplementary-material">S13(D) Fig</xref> and, possibly, <xref rid="pcbi.1010610.s016" ref-type="supplementary-material">S13(C) Fig</xref>). While these examples are unlikely to be representative of the majority of UNK MCs, they do seem to suggest that this set is rich in material for building new families and that UNK MCs can map reasonably well to structured (or, occasionally, unstructured) domains.</p>
    </sec>
    <sec id="sec024">
      <title>3.8 Small Metaclusters and DPCfam-B database</title>
      <p>As stated at the beginning of the Results section, we focused our analysis on MCs with 50 or more seed sequences. However, also smaller MCs may provide useful information. In this section, we consider MCs with 25≤N&lt;50 seed sequences and average length ≥50 aa. In total, this accounts for 34,556 additional MCs. As a first analysis step, we compute the percentage of MCs that can be assigned a Low Complexity, Disorder, Coiled Coil or Transmembrane label (according to the criteria specified in our <xref rid="sec002" ref-type="sec">Methods</xref> section). Overall, 41.6% of MCs can be assigned one or more of these labels. None could instead be labeled as Transmembrane. This can be compared to the case of MCs of larger size (≥50 seed sequences), where labels of Low Complexity, Disorder or Coiled Coil could be assigned to 16.5% of MCs (<xref rid="pcbi.1010610.g003" ref-type="fig">Fig 3B</xref>) and a Transmembrane label to 3.5% of MCs. Next, we compare small MCs to Pfam annotations. Of 34,556 small MCs, 20.5% (9,878) display a %DA≥50, of which 1,153 are “equivalent” MCs, 3,619 are “reduced”, 1,664 are “extended” and 3,442 are “shifted”. In <xref rid="pcbi.1010610.s012" ref-type="supplementary-material">S9 Fig</xref> we show the average overlap histogram with their DA for these MCs (cfr. <xref rid="pcbi.1010610.g004" ref-type="fig">Fig 4</xref> for larger MCs). Finally, 18,989 MCs have no Pfam annotation (unknown MCs). Overall these results suggest that, while this set of MCs should be on average of lower quality than the one constituted of MCs of larger size, as a whole it is likely to contain quite valuable information. We therefore decided to publish also these smaller MCs, albeit as a separate database that we name DPCfam-B.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec025">
    <title>4 Discussion and conclusions</title>
    <p>Most leading protein family databases take advantage of some level of manual curation in the definition of their families. However, curated annotation is becoming a considerable burden as the number of proteins for which a sequence is available skyrockets. In this context, automatic protein family classification could represent a tool for rapid, high-level analysis of big, largely unannotated databases such as those produced by metagenomics projects. At the same time, it could assist in the extension of the more accurate, manually supervised classification schemes.</p>
    <p>The idea of combining large protein databases, sequence alignments and clustering to produce family classification schemes is of course not new (e.g. MMseqs2 [<xref rid="pcbi.1010610.ref015" ref-type="bibr">15</xref>], COG, [<xref rid="pcbi.1010610.ref040" ref-type="bibr">40</xref>] etc.). However, most automatic methods have focused on clustering of full-length protein sequences. The few methods that, to the best of our knowledge, have attempted to automatically classify evolutionary modules in proteins (most typically representing structural domains) (ADDA [<xref rid="pcbi.1010610.ref013" ref-type="bibr">13</xref>], EVEREST [<xref rid="pcbi.1010610.ref014" ref-type="bibr">14</xref>]), have faced scalability and/or maintenance problems.</p>
    <p>In this work, we describe the application of our method DPCfam to the automatic family annotation of UniRef50, a database including ∼ 23,000,000 sequences. DPCfam uses local sequence alignments (BLAST) and takes advantage of the power and efficiency of Density Peak Clustering [<xref rid="pcbi.1010610.ref017" ref-type="bibr">17</xref>] to split proteins into separate evolutionary modules. The method itself was introduced previously in [<xref rid="pcbi.1010610.ref016" ref-type="bibr">16</xref>] on a much smaller dataset. The most important technical contribution of this work is an efficient and scalable implementation of the algorithm. The size of the clustering problem which we solve here is enormous: it involves estimating the distances between <inline-formula id="pcbi.1010610.e055"><alternatives><graphic xlink:href="pcbi.1010610.e055.jpg" id="pcbi.1010610.e055g" position="anchor"/><mml:math id="M55" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">O</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>16</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> pairs of sequence fragments. For this reason, our pipeline is implemented to run on HPC facilities; in particular, it requires at least one node with a RAM memory of ∼ 0.5 Tb, better if 1 Tb. In <xref rid="pcbi.1010610.s001" ref-type="supplementary-material">S1 Table</xref> we report the computational costs for each step of the method. DPCfam is structured in a way that allows for small incremental updates of the metaclusters at relatively low computational cost. When adding new sequences to the database it is not necessary to compute from scratch the distance matrix, namely the most demanding step of the pipeline (without taking the generation of sequence alignments into account), which can instead be updated thus dramatically reducing running times. This can be achieved using an approximation whereby new primary clusters are generated from alignments of the novel protein sequences to the full, updated protein database, while previous primary clusters are left untouched. An increment of 10% in the underlying protein sequence database will cost approximately 14% of the computational time required by the original run. If the underlying sequence database becomes significantly larger than the original one, however, this approximation becomes too rough and updating the database would require a complete rerun of the protocol.</p>
    <p>The analysis of UniRef50 (v. 2017_07) that we present here produces &gt; 45, 000 well-populated metaclusters (MCs). The majority of these MCs exhibit at least some overlap with families in the Pfam classification, which we use here as our main manually-curated reference. We have shown that the DPCfam-generated classification of the protein sequence space produces MCs that for the vast majority appear to be sound in terms of the homologous relationships that can be inferred to exist between their seed sequences. About half of MCs are in clear correspondence to one or more Pfam families (%DA≥ 50). Among these, boundary agreement with the corresponding families vary, with roughly 25% being classified as “equivalent” or very close to Pfam boundaries’ definition. We note that while the thousands of equivalent MCs are proof that DPCfam can produce good-quality families in an unsupervised manner, “extended” and “reduced” MCs are arguably of higher interest for follow-up work. Indeed, as shown by a number of examples discussed in our previous work [<xref rid="pcbi.1010610.ref016" ref-type="bibr">16</xref>], MCs in these two categories may represent opportunities for improving existing classifications. Likely the most important contribution of our work to protein family classification lies, however, in the subset of about 14,000 unknown MCs, for which no seed sequence could be found to have a Pfam annotation. Indeed, preliminary analysis performed in collaboration with the Pfam database suggests that a significant fraction of these MCs might be turned into novel families with minimal manual intervention. This highlights the value of DPCfam both for further expansion of existing family classifications and, potentially, for large-scale annotation of newly-sequenced, sparsely-characterised protein datasets such as those generated by metagenomics projects.</p>
    <p>There are some aspects of the DPCfam pipeline that we plan to revisit and improve in the future.</p>
    <p>By far the most important computational bottleneck of the whole procedure is constituted by the all-versus-all sequence alignment searches. In this work we have used the alignment program BLAST, however, faster alternatives may be available (e.g., lastal [<xref rid="pcbi.1010610.ref041" ref-type="bibr">41</xref>], DIAMOND [<xref rid="pcbi.1010610.ref042" ref-type="bibr">42</xref>], MMseqs2 [<xref rid="pcbi.1010610.ref015" ref-type="bibr">15</xref>]).</p>
    <p>Further, as discussed in the Results section, we observe a rather high degree of redundancy among the DPCfam-generated MCs. Some of these redundancies might be resolved by applying more aggressive metaclustering and/or merging approaches. At the same time, redundancy can carry important information about family and domain boundaries, which could be of great value especially when analysing MCs that lack annotation. We show one interesting example of two redundant MCs and their relationship to structural domains of the Calmodulin binding protein-like Pfam family in <xref rid="pcbi.1010610.s009" ref-type="supplementary-material">S6 Fig</xref>. Also, we have shown that many redundant MC pairs map to largely separate sets of proteins. As such they can be considered part of MC clan-like structures. In the future, we plan to further investigate the evolutionary signal behind these structures, for example whether the splits occur along different phylogenetic clade boundaries or, potentially, sub-functional groups.</p>
    <p>Finally, since it is clear that a detailed analysis of the entire set of more than 45,000 MCs generated by DPCfam will require a lot of additional work, we make all relevant data publicly available, so that also other researchers have the possibility to take advantage of them. We do this in two different ways. First, we deposit the DPCfam classification in a public data repository (<ext-link xlink:href="https://doi.org/10.5281/zenodo.6900559" ext-link-type="uri">https://doi.org/10.5281/zenodo.6900559</ext-link>) where for each MC we provide the list of its seed sequences and their associated profile-HMM; also, we provide xml tables with summary information about MCs such as size, average length, Pfam annotation, etc. We also provide xml tables of UniRef50 proteins (v. 2017_07) with Pfam and DPCfam annotation. Second, we built an ad-hoc DPCfam website (<ext-link xlink:href="https://dpcfam.areasciencepark.it/" ext-link-type="uri">https://dpcfam.areasciencepark.it/</ext-link>). The website accepts queries in the form of MC, Pfam family or protein IDs. Similar to the Zenodo xml files, MC webpages report information about size, average length and relationships with Pfam families, together with the complete list of MC seed sequences and, when present, links to representative AlphaFold DB v2 structures. Also, MC seed sequences can be visualised in the context of the full-length proteins they are part of together with other MCs and Pfam families that may additionally map to it. Multiple sequence alignments and profile-HMMs of all MCs are readily available for download. In the near future, we aim to broaden the scope of the website by including a wider range of annotations (such as phylogenetic information) both at the MC and at the protein level and, potentially, by adding protein-search features.</p>
  </sec>
  <sec id="sec026" sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material id="pcbi.1010610.s001" position="float" content-type="local-data">
      <label>S1 Table</label>
      <caption>
        <title>Approximate computational times, minimum RAM requirements and I/O charge of the DPCfam method steps.</title>
        <p>We report only minimum RAM requirements that cannot be met on a common workstation.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s002" position="float" content-type="local-data">
      <label>S2 Table</label>
      <caption>
        <title>List of new families in Pfam version 35.0 derived from DPCfam unknown MCs.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s003" position="float" content-type="local-data">
      <label>S3 Table</label>
      <caption>
        <title>List of TOP 25 largest UNK MCs with information about their inclusion in Pfam and their alignment to their representative AlphaFold structure, when present.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s004" position="float" content-type="local-data">
      <label>S1 Fig</label>
      <caption>
        <title>Graphical representation of A) the overlapping regions between an MC seed sequence <inline-formula id="pcbi.1010610.e056"><alternatives><graphic xlink:href="pcbi.1010610.e056.jpg" id="pcbi.1010610.e056g" position="anchor"/><mml:math id="M56" display="inline" overflow="scroll"><mml:mi mathvariant="script">S</mml:mi></mml:math></alternatives></inline-formula> (blue) and the part of the same protein sequence covered by its DA <inline-formula id="pcbi.1010610.e057"><alternatives><graphic xlink:href="pcbi.1010610.e057.jpg" id="pcbi.1010610.e057g" position="anchor"/><mml:math id="M57" display="inline" overflow="scroll"><mml:mi mathvariant="script">P</mml:mi></mml:math></alternatives></inline-formula> (orange), which are then used to compute the quantities <italic toggle="yes">F</italic><sub><italic toggle="yes">red</italic></sub> and <italic toggle="yes">F</italic><sub><italic toggle="yes">ext</italic></sub> and B) the four categories of metaclusters the definition of which is based on <italic toggle="yes">F</italic><sub><italic toggle="yes">red</italic></sub> and <italic toggle="yes">F</italic><sub><italic toggle="yes">ext</italic></sub> averaged over all seed sequence-DA pairs in a cluster (<inline-formula id="pcbi.1010610.e058"><alternatives><graphic xlink:href="pcbi.1010610.e058.jpg" id="pcbi.1010610.e058g" position="anchor"/><mml:math id="M58" display="inline" overflow="scroll"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1010610.e059"><alternatives><graphic xlink:href="pcbi.1010610.e059.jpg" id="pcbi.1010610.e059g" position="anchor"/><mml:math id="M59" display="inline" overflow="scroll"><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>C</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, respectively).</title>
        <p>See <xref rid="sec002" ref-type="sec">Methods</xref> in main text.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s005" position="float" content-type="local-data">
      <label>S2 Fig</label>
      <caption>
        <title>Example of a disordered MC (MC122787) with a well-conserved multiple sequence alignment.</title>
        <p>MC122787 has 41% of amino-acids in a disordered region and it is classified as an unknown MC, that is, none of its seed sequences carries a Pfam annotation. A) MC and Pfam family architecture of DNA-binding protein F1LX23, a representative of seed sequence of MC12287. The thin black like represents the full length protein sequence. Boxes above the sequence represent DPCfam MC annotations: MC434132 from aa 22 to aa 55 (pink), MC122787 from aa 74 to 246 (blue), MC181414 from aa 479 to 678 (green); boxes below the sequence represent instead Pfam family annotations: PF01352 (KRAB) from aa 3 to 43 (green), 13 repeats of PF00096 (zf-C2H2) from aa 395 to 753 (purple) (the image is generated by the DPCfam website, <ext-link xlink:href="https://dpcfam.areasciencepark.it/" ext-link-type="uri">https://dpcfam.areasciencepark.it/</ext-link>). B) Three-dimensional structure of protein F1LX23 as predicted by AlphaFold2 (Cramer, Patrick. “AlphaFold2 and the future of structural biology.” Nature Structural &amp; Molecular Biology 28(9) (2021): 704–705.). Colors indicate where DPCfam annotations map onto the protein structure (color scheme is the same as the one used in A) for MCs). It can be seen that MC12287 (blue) is predicted to be in an unstructured region. C) MC122787’s multiple sequence alignment with conservation, quality, consensus and occupancy histograms. Note that while only a few representative sequences are shown, conservation and consensus are calculated on the full set of aligned sequences. Figure drawn with Jalview (Waterhouse AM, Procter JB, Martin DMA, Clamp M, Barton GJ “Jalview Version 2-a multiple sequence alignment editor and analysis workbench”. Bioinformatics 25 (2009): 1189–1191.).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s005.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s006" position="float" content-type="local-data">
      <label>S3 Fig</label>
      <caption>
        <title>Size of MCs (purple) and Pfam families (green), ranked from the largest (left) to the smallest (right).</title>
        <p>MC size is calculated as the number of seed sequences. Pfam families (v. 32) are all those in Uniref50 ∩ UniprotKB (18,189 total) and family size is the ‘full’ size, that is, not only considering Pfam seed sequences. The blue horizontal line corresponds to a size of 50; MCs smaller than 50 have not been considered in the analysis presented in this work.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s006.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s007" position="float" content-type="local-data">
      <label>S4 Fig</label>
      <caption>
        <title>Comparison between profile-HMMs from equivalent DPCfam MC-Pfam family pairs; note that in this case, equivalent MCs with a single family-DA are considered irrespective of their %DA (5,519 MCs in total).</title>
        <p>The red curve shows the fraction of common protein hits between the profile-HMM models in each pair (running average, window of size 50), note that in this case we compare protein IDs with no specific requirement for overlap between hits to the same ID; the other curves represent the fraction of protein hits that are found only by the DPCfam (green) or the Pfam (blue) models, respectively (running averages as above). For each MC-Pfam family pair, fractions are computed with respect to the union of all protein hits found by the MC and the Pfam model. Pairs along the x-axis are sorted by decreasing fraction of common hits. About 60% of profile-HMMs from equivalent MC-family pairs share more than 80% of their UniRef50 hits and about 80% of them share more than half of their hits. For around 9.7% of equivalent profile-HMMs, the fraction of shared hits is instead less than 25%. On average, these latter profile-HMMs appear to represent large, diverse families, for which DPCfam and Pfam tend to capture different member regions. In fact, the average size of Pfam families sharing less than 25% of hits with their associated equivalent MC is 2,562, this is to be compared to an overall average size of 800.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s007.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s008" position="float" content-type="local-data">
      <label>S5 Fig</label>
      <caption>
        <title>We calculate the number of Dominant Architectures (DA in the main text) that map to a single MC (degree = 1) and of those that instead map to multiple MCs (degree = 2, 3, etc.) (y axis in logarithmic scale, base 10).</title>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s008.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s009" position="float" content-type="local-data">
      <label>S6 Fig</label>
      <caption>
        <title>Example of a redundant MCs (MC408780) providing information about the structural features of a Pfam family.</title>
        <p><bold>A</bold>: location of a SSR from MC220539 (pink), a SSRs from MC408780 (blue) and Pfam family PF07887 (pale-blue), on protein T1MG69. MC220539 and MC408780 both feature PF07887 (Calmodulin binding protein-like) as DA, the former with “equivalent” boundaries, the latter with “reduced” boundaries. <bold>B</bold>: structural prediction of PF07887 by trRosetta (from the Pfam website), with highlighted in blue the position of the “reduced” MC (MC408780), as found by running the MC profile-HMM with HHpred (standard parameters) against the T1MG69 sequence. As noted in the Pfam blog-post “Folding the protein universe” (31 march 2021, see <ext-link xlink:href="https://xfam.wordpress.com/2021/03/03/folding-the-protein-universe/" ext-link-type="uri">https://xfam.wordpress.com/2021/03/03/folding-the-protein-universe/</ext-link>), structural prediction of the Calmodulin binding protein-like family shows three separate structural domains (I, II and III approximately). Indeed, in Pfam version 35 this family has been split in three different families. It can be seen that two of these domains have close correspondence to the “reduced” MC (MC408780).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s009.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s010" position="float" content-type="local-data">
      <label>S7 Fig</label>
      <caption>
        <title>Histogram of ECOD families average overlap with their representative Pfam Families (RPFs, see <xref rid="sec002" ref-type="sec">Methods</xref> for definition).</title>
        <p>Columns are colored according to the RPF boundary classification (equivalent, reduced, extended and shifted). <bold>A</bold>: Overlap between individual ECOD families and their RPF. <bold>B</bold>: Overlap between individual ECOD families or architectures and RPFs. Given an ECOD family and its RPF (same pairs as in A), we search for a better overlap of the RPF with any multi-family architecture featuring the original ECOD family and up to two additional ECOD families. The reported average overlap value is thus the best between the overlap with the original family and any other such ECOD architecture. Note that the ECOD architecture labels (equivalent/reduced/extended/shifted) are still assigned according to the RPF overlap to the original ECOD family so as to show to which extent the overlap in each ECOD family category increases with respect to A).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s010.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s011" position="float" content-type="local-data">
      <label>S8 Fig</label>
      <caption>
        <p>Venn diagrams showing the percentage of Low Complexity MCs (green), Disordered MCs (red) and Coiled-Coil MCs (purple), respectively (see <xref rid="sec002" ref-type="sec">Methods</xref> for definitions) in A) Equivalent MCs (equivalent to a Pfam family, <xref rid="sec002" ref-type="sec">Methods</xref>). Panel B: MCs unknown to Pfam. 86.4% and 78.6% is the number of MCs featuring none of the above regions among equivalent and unknown MCs, respectively.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s011.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s012" position="float" content-type="local-data">
      <label>S9 Fig</label>
      <caption>
        <title>Histogram showing average overlap (<italic toggle="yes">O</italic><sub><italic toggle="yes">MC</italic></sub>) between “small” MCs (25 ≤ <italic toggle="yes">N</italic> &lt; 50 SSRs, %DAF≥50) and their associated Pfam DAs.</title>
        <p>Colors reflect the contribution of each MC category to each bin (equivalent, reduced, extended and shifted, see also <xref rid="pcbi.1010610.s004" ref-type="supplementary-material">S1B Fig</xref>). The legend on the right side of the histogram reports total counts of MCs in each category, total count of MCs with %DA&lt; 50 and total count of unknown MCs.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s012.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s013" position="float" content-type="local-data">
      <label>S10 Fig</label>
      <caption>
        <title>Examples of mapping of MC to their representative AlphaFold structure.</title>
        <p>The part of the sequence of the AlphaFold protein that aligns to the MC profile-HMM is shown in orange. Above each example we report the ID of the AlphaFold structure, the MC number, the Pfam family that was build from the MC (if any) and the position of the MC in the list of largest unknown MCs (<xref rid="pcbi.1010610.s003" ref-type="supplementary-material">S3 Table</xref>). Molecular graphics and analyses performed with UCSF Chimera (Pettersen EF, Goddard TD, Huang CC, Couch GS, Greenblatt DM, Meng EC, Ferrin TE. “UCSF Chimera–a visualization system for exploratory research and analysis.” J Comput Chem. 25 (2004):1605–12).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s013.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s014" position="float" content-type="local-data">
      <label>S11 Fig</label>
      <caption>
        <title>Examples of mapping of MC to their representative AlphaFold structure.</title>
        <p>The part of the sequence of the AlphaFold protein that aligns to the MC profile-HMM is shown in orange. Above each example we report the ID of the AlphaFold structure, the MC number, the Pfam family that was build from the MC (if any) and the position of the MC in the list of largest unknown MCs (<xref rid="pcbi.1010610.s003" ref-type="supplementary-material">S3 Table</xref>). Molecular graphics and analyses performed with UCSF Chimera (Pettersen EF, Goddard TD, Huang CC, Couch GS, Greenblatt DM, Meng EC, Ferrin TE. “UCSF Chimera–a visualization system for exploratory research and analysis.” J Comput Chem. 25 (2004):1605–12).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s014.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s015" position="float" content-type="local-data">
      <label>S12 Fig</label>
      <caption>
        <title>Examples of mapping of MC to their representative AlphaFold structure.</title>
        <p>The part of the sequence of the AlphaFold protein that aligns to the MC profile-HMM is shown in orange. Above each example we report the ID of the AlphaFold structure, the MC number, the Pfam family that was build from the MC (if any) and the position of the MC in the list of largest unknown MCs (<xref rid="pcbi.1010610.s003" ref-type="supplementary-material">S3 Table</xref>). Molecular graphics and analyses performed with UCSF Chimera (Pettersen EF, Goddard TD, Huang CC, Couch GS, Greenblatt DM, Meng EC, Ferrin TE. “UCSF Chimera–a visualization system for exploratory research and analysis.” J Comput Chem. 25 (2004):1605–12).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s015.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s016" position="float" content-type="local-data">
      <label>S13 Fig</label>
      <caption>
        <title>Examples of mapping of MC to their representative AlphaFold structure.</title>
        <p>The part of the sequence of the AlphaFold protein that aligns to the MC profile-HMM is shown in orange. Above each example we report the ID of the AlphaFold structure, the MC number, the Pfam family that was build from the MC (if any) and the position of the MC in the list of largest unknown MCs (<xref rid="pcbi.1010610.s003" ref-type="supplementary-material">S3 Table</xref>). Molecular graphics and analyses performed with UCSF Chimera (Pettersen EF, Goddard TD, Huang CC, Couch GS, Greenblatt DM, Meng EC, Ferrin TE. “UCSF Chimera–a visualization system for exploratory research and analysis.” J Comput Chem. 25 (2004):1605–12).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s016.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="pcbi.1010610.s017" position="float" content-type="local-data">
      <label>S14 Fig</label>
      <caption>
        <title>Examples of mapping of MC to their representative AlphaFold structure.</title>
        <p>The part of the sequence of the AlphaFold protein that aligns to the MC profile-HMM is shown in orange. Above each example we report the ID of the AlphaFold structure, the MC number, the Pfam family that was build from the MC (if any). Molecular graphics and analyses performed with UCSF Chimera (Pettersen EF, Goddard TD, Huang CC, Couch GS, Greenblatt DM, Meng EC, Ferrin TE. “UCSF Chimera–a visualization system for exploratory research and analysis.” J Comput Chem. 25 (2004):1605–12).</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pcbi.1010610.s017.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We want to thank Alex Rodriguez and Francesca Rizzato for their precious help and suggestions; we also want to thank Edith Natalia Villegas Garcia for DPCfam’s data curation.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1010610.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><article-title>UniProt: the universal protein knowledgebase in 2021</article-title>. <source>Nucleic Acids Research</source>. <year>2021</year>;<volume>49</volume>(<issue>D1</issue>):<fpage>D480</fpage>–<lpage>D489</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa1100</pub-id><?supplied-pmid 33237286?><pub-id pub-id-type="pmid">33237286</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Mitchell</surname><given-names>AL</given-names></name>, <name><surname>Almeida</surname><given-names>A</given-names></name>, <name><surname>Beracochea</surname><given-names>M</given-names></name>, <name><surname>Boland</surname><given-names>M</given-names></name>, <name><surname>Burgin</surname><given-names>J</given-names></name>, <name><surname>Cochrane</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>MGnify: the microbiome analysis resource in 2020</article-title>. <source>Nucleic acids research</source>. <year>2020</year>;<volume>48</volume>(<issue>D1</issue>):<fpage>D570</fpage>–<lpage>D578</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkz1035</pub-id><?supplied-pmid 31696235?><pub-id pub-id-type="pmid">31696235</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Ponting</surname><given-names>CP</given-names></name>, <name><surname>Russell</surname><given-names>RR</given-names></name>. <article-title>The natural history of protein domains</article-title>. <source>Annual review of biophysics and biomolecular structure</source>. <year>2002</year>;<volume>31</volume>(<issue>1</issue>):<fpage>45</fpage>–<lpage>71</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1146/annurev.biophys.31.082901.134314</pub-id><?supplied-pmid 11988462?><pub-id pub-id-type="pmid">11988462</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Punta</surname><given-names>M</given-names></name>, <name><surname>Ofran</surname><given-names>Y</given-names></name>. <article-title>The Rough Guide to In Silico Function Prediction, or How To Use Sequence and Structure Information To Predict Protein Function</article-title>. <source>PLOS Computational Biology</source>. <year>2008</year>;<volume>4</volume>(<issue>10</issue>):<fpage>1</fpage>–<lpage>7</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000160</pub-id><?supplied-pmid 18974821?><pub-id pub-id-type="pmid">18974821</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Tompa</surname><given-names>P</given-names></name>, <name><surname>Fuxreiter</surname><given-names>M</given-names></name>, <name><surname>Oldfield</surname><given-names>CJ</given-names></name>, <name><surname>Simon</surname><given-names>I</given-names></name>, <name><surname>Dunker</surname><given-names>AK</given-names></name>, <name><surname>Uversky</surname><given-names>VN</given-names></name>. <article-title>Close encounters of the third kind: disordered domains and the interactions of proteins</article-title>. <source>Bioessays</source>. <year>2009</year>;<volume>31</volume>(<issue>3</issue>):<fpage>328</fpage>–<lpage>335</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/bies.200800151</pub-id><?supplied-pmid 19260013?><pub-id pub-id-type="pmid">19260013</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Letunic</surname><given-names>I</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>. <article-title>20 years of the SMART protein domain annotation resource</article-title>. <source>NAR</source>. <year>2017</year>;<volume>46</volume>(<issue>D1</issue>):<fpage>D493</fpage>–<lpage>D496</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkx922</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Akiva</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>The Structure–Function Linkage Database</article-title>. <source>NAR</source>. <year>2013</year>;<volume>42</volume>(<issue>D1</issue>):<fpage>D521</fpage>–<lpage>D530</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkt1130</pub-id><?supplied-pmid 24271399?><pub-id pub-id-type="pmid">24271399</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Cheng</surname><given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Manual classification strategies in the ECOD database</article-title>. <source>Proteins</source>. <year>2015</year>;<volume>83</volume>(<issue>7</issue>):<fpage>1238</fpage>–<lpage>1251</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/prot.24818</pub-id><?supplied-pmid 25917548?><pub-id pub-id-type="pmid">25917548</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Mistry</surname><given-names>J</given-names></name>, <name><surname>Chuguransky</surname><given-names>S</given-names></name>, <name><surname>Williams</surname><given-names>L</given-names></name>, <name><surname>Qureshi</surname><given-names>M</given-names></name>, <name><surname>Salazar</surname><given-names>G</given-names></name>, <name><surname>Sonnhammer</surname><given-names>ELL</given-names></name>, <etal>et al</etal>. <article-title>Pfam: The protein families database in 2021</article-title>. <source>Nucleic Acids Research</source>. <year>2020</year>;<volume>49</volume>(<issue>D1</issue>):<fpage>D412</fpage>–<lpage>D419</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkaa913</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Mitchell</surname><given-names>AL</given-names></name>, <etal>et al</etal>. <article-title>InterPro in 2019: improving coverage, classification and access to protein sequence annotations</article-title>. <source>NAR</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D351</fpage>–<lpage>D360</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gky1100</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Lu</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>CDD/SPARCLE: the conserved domain database in 2020</article-title>. <source>NAR</source>. <year>2020</year>;<volume>48</volume>(<issue>D1</issue>):<fpage>D265</fpage>–<lpage>D268</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkz991</pub-id><?supplied-pmid 31777944?><pub-id pub-id-type="pmid">31777944</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Enright</surname><given-names>AJ</given-names></name>, <etal>et al</etal>. <article-title>An efficient algorithm for large-scale detection of protein families</article-title>. <source>NAR</source>. <year>2002</year>;<volume>30</volume><issue>7</issue>:<fpage>1575</fpage>–<lpage>84</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/30.7.1575</pub-id><?supplied-pmid 11917018?><pub-id pub-id-type="pmid">11917018</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Heger</surname><given-names>A</given-names></name>, <name><surname>Holm</surname><given-names>L</given-names></name>. <article-title>Exhaustive Enumeration of Protein Domain Families</article-title>. <source>JMB</source>. <year>2003</year>;<volume>328</volume>(<issue>3</issue>):<fpage>749</fpage>–<lpage>767</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0022-2836(03)00269-9</pub-id><?supplied-pmid 12706730?><pub-id pub-id-type="pmid">12706730</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Portugaly</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>EVEREST: automatic identification and classification of protein domains in all protein sequences</article-title>. <source>BMC bioinformatics</source>. <year>2006</year>;<volume>7</volume>(<issue>1</issue>):<fpage>277</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-7-277</pub-id><?supplied-pmid 16749920?><pub-id pub-id-type="pmid">16749920</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Steinegger</surname><given-names>M</given-names></name>, <name><surname>Söding</surname><given-names>J</given-names></name>. <article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>. <source>Nature biotechnology</source>. <year>2017</year>;<volume>35</volume>(<issue>11</issue>):<fpage>1026</fpage>–<lpage>1028</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nbt.3988</pub-id><?supplied-pmid 29035372?><pub-id pub-id-type="pmid">29035372</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Russo</surname><given-names>ET</given-names></name>, <name><surname>Laio</surname><given-names>A</given-names></name>, <name><surname>Punta</surname><given-names>M</given-names></name>. <article-title>Density Peak clustering of protein sequences associated to a Pfam clan reveals clear similarities and interesting differences with respect to manual family annotation</article-title>. <source>BMC Bioinformatics</source>. <year>2021</year>;<volume>22</volume>(<issue>1</issue>):<fpage>121</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/s12859-021-04013-x</pub-id><?supplied-pmid 33711918?><pub-id pub-id-type="pmid">33711918</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Rodriguez</surname><given-names>A</given-names></name>, <name><surname>Laio</surname><given-names>A</given-names></name>. <article-title>Clustering by fast search and find of density peaks</article-title>. <source>Science</source>. <year>2014</year>;<volume>344</volume>(<issue>6191</issue>):<fpage>1492</fpage>–<lpage>1496</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1126/science.1242072</pub-id><?supplied-pmid 24970081?><pub-id pub-id-type="pmid">24970081</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Gish</surname><given-names>W</given-names></name>, <name><surname>Miller</surname><given-names>W</given-names></name>, <name><surname>Myers</surname><given-names>EW</given-names></name>, <name><surname>Lipman</surname><given-names>DJ</given-names></name>. <article-title>Basic local alignment search tool</article-title>. <source>Journal of molecular biology</source>. <year>1990</year>;<volume>215</volume>(<issue>3</issue>):<fpage>403</fpage>–<lpage>410</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id><?supplied-pmid 2231712?><pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Mistry</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Challenges in homology search: HMMER3 and convergent evolution of coiled-coil regions</article-title>. <source>NAR</source>. <year>2013</year>;<volume>41</volume>(<issue>12</issue>):<fpage>e121</fpage>–<lpage>e121</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkt263</pub-id><?supplied-pmid 23598997?><pub-id pub-id-type="pmid">23598997</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Forum</surname><given-names>MP</given-names></name>. <source>MPI: A message-passing interface standard</source>; <year>1994</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Davis</surname><given-names>IJ</given-names></name>. <article-title>A fast radix sort</article-title>. <source>The computer journal</source>. <year>1992</year>;<volume>35</volume>(<issue>6</issue>):<fpage>636</fpage>–<lpage>642</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/comjnl/35.6.636</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref022">
      <label>22</label>
      <mixed-citation publication-type="book"><name><surname>Arpaci-Dusseau</surname><given-names>RH</given-names></name>, <name><surname>Arpaci-Dusseau</surname><given-names>AC</given-names></name>. <source>Operating Systems: Three Easy Pieces</source>. <edition designator="1">1st ed</edition>. <publisher-name>Arpaci-Dusseau Books</publisher-name>; <year>2018</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Godzik</surname><given-names>A</given-names></name>. <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1658</fpage>–<lpage>1659</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btl158</pub-id><?supplied-pmid 16731699?><pub-id pub-id-type="pmid">16731699</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name>. <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>NAR</source>. <year>2004</year>;<volume>32</volume>(<issue>5</issue>):<fpage>1792</fpage>–<lpage>1797</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id><?supplied-pmid 15034147?><pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Mier</surname><given-names>P</given-names></name>, <name><surname>Paladin</surname><given-names>L</given-names></name>, <name><surname>Tamana</surname><given-names>S</given-names></name>, <name><surname>Petrosian</surname><given-names>S</given-names></name>, <name><surname>Hajdu-Soltész</surname><given-names>B</given-names></name>, <name><surname>Urbanek</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Disentangling the complexity of low complexity proteins</article-title>. <source>Briefings in Bioinformatics</source>. <year>2019</year>;<volume>21</volume>(<issue>2</issue>):<fpage>458</fpage>–<lpage>472</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bib/bbz007</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Crick</surname><given-names>F</given-names></name>. <article-title>The packing of <italic toggle="yes">α</italic>-helices: simple coiled-coils</article-title>. <source>Acta crystallographica</source>. <year>1953</year>;<volume>6</volume>(<issue>8-9</issue>):<fpage>689</fpage>–<lpage>697</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1107/S0365110X53001964</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Dyson</surname><given-names>HJ</given-names></name>, <name><surname>Wright</surname><given-names>PE</given-names></name>. <article-title>Intrinsically unstructured proteins and their functions</article-title>. <source>Nature reviews Molecular cell biology</source>. <year>2005</year>;<volume>6</volume>(<issue>3</issue>):<fpage>197</fpage>–<lpage>208</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/nrm1589</pub-id><?supplied-pmid 15738986?><pub-id pub-id-type="pmid">15738986</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Tusnady</surname><given-names>GE</given-names></name>, <name><surname>Simon</surname><given-names>I</given-names></name>. <article-title>Principles governing amino acid composition of integral membrane proteins: application to topology prediction</article-title>. <source>Journal of molecular biology</source>. <year>1998</year>;<volume>283</volume>(<issue>2</issue>):<fpage>489</fpage>–<lpage>506</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1006/jmbi.1998.2107</pub-id><?supplied-pmid 9769220?><pub-id pub-id-type="pmid">9769220</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Camacho</surname><given-names>C</given-names></name>, <name><surname>Coulouris</surname><given-names>G</given-names></name>, <name><surname>Avagyan</surname><given-names>V</given-names></name>, <name><surname>Ma</surname><given-names>N</given-names></name>, <name><surname>Papadopoulos</surname><given-names>J</given-names></name>, <name><surname>Bealer</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>BLAST+: architecture and applications</article-title>. <source>BMC bioinformatics</source>. <year>2009</year>;<volume>10</volume>(<issue>1</issue>):<fpage>421</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1186/1471-2105-10-421</pub-id><?supplied-pmid 20003500?><pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Ludwiczak</surname><given-names>J</given-names></name>, <name><surname>Winski</surname><given-names>A</given-names></name>, <name><surname>Szczepaniak</surname><given-names>K</given-names></name>, <name><surname>Alva</surname><given-names>V</given-names></name>, <name><surname>Dunin-Horkawicz</surname><given-names>S</given-names></name>. <article-title>DeepCoil—a fast and accurate prediction of coiled-coil domains in protein sequences</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>(<issue>16</issue>):<fpage>2790</fpage>–<lpage>2795</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/bty1062</pub-id><?supplied-pmid 30601942?><pub-id pub-id-type="pmid">30601942</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Mészáros</surname><given-names>B</given-names></name>, <name><surname>Erdős</surname><given-names>G</given-names></name>, <name><surname>Dosztányi</surname><given-names>Z</given-names></name>. <article-title>IUPred2A: context-dependent prediction of protein disorder as a function of redox state and protein binding</article-title>. <source>Nucleic acids research</source>. <year>2018</year>;<volume>46</volume>(<issue>W1</issue>):<fpage>W329</fpage>–<lpage>W337</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gky384</pub-id><pub-id pub-id-type="pmid">29860432</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Käll</surname><given-names>L</given-names></name>, <name><surname>Krogh</surname><given-names>A</given-names></name>, <name><surname>Sonnhammer</surname><given-names>EL</given-names></name>. <article-title>A combined transmembrane topology and signal peptide prediction method</article-title>. <source>Journal of molecular biology</source>. <year>2004</year>;<volume>338</volume>(<issue>5</issue>):<fpage>1027</fpage>–<lpage>1036</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jmb.2004.03.016</pub-id><pub-id pub-id-type="pmid">15111065</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Jumper</surname><given-names>J</given-names></name>, <name><surname>Evans</surname><given-names>R</given-names></name>, <name><surname>Pritzel</surname><given-names>A</given-names></name>, <name><surname>Green</surname><given-names>T</given-names></name>, <name><surname>Figurnov</surname><given-names>M</given-names></name>, <name><surname>Ronneberger</surname><given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source>. <year>2021</year>;<volume>596</volume>(<issue>7873</issue>):<fpage>583</fpage>–<lpage>589</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id><?supplied-pmid 34265844?><pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Varadi</surname><given-names>M</given-names></name>, <name><surname>Anyango</surname><given-names>S</given-names></name>, <name><surname>Deshpande</surname><given-names>M</given-names></name>, <name><surname>Nair</surname><given-names>S</given-names></name>, <name><surname>Natassia</surname><given-names>C</given-names></name>, <name><surname>Yordanova</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>AlphaFold Protein Structure Database: massively expanding the structural coverage of protein-sequence space with high-accuracy models</article-title>. <source>Nucleic acids research</source>. <year>2022</year>;<volume>50</volume>(<issue>D1</issue>):<fpage>D439</fpage>–<lpage>D444</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/gkab1061</pub-id><?supplied-pmid 34791371?><pub-id pub-id-type="pmid">34791371</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Qian</surname><given-names>J</given-names></name>, <name><surname>Luscombe</surname><given-names>NM</given-names></name>, <name><surname>Gerstein</surname><given-names>M</given-names></name>. <article-title>Protein family and fold occurrence in genomes: power-law behaviour and evolutionary model</article-title>. <source>Journal of molecular biology</source>. <year>2001</year>;<volume>313</volume>(<issue>4</issue>):<fpage>673</fpage>–<lpage>681</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1006/jmbi.2001.5079</pub-id><?supplied-pmid 11697896?><pub-id pub-id-type="pmid">11697896</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Mistry</surname><given-names>J</given-names></name>, <name><surname>Coggill</surname><given-names>P</given-names></name>, <name><surname>Eberhardt</surname><given-names>RY</given-names></name>, <name><surname>Deiana</surname><given-names>A</given-names></name>, <name><surname>Giansanti</surname><given-names>A</given-names></name>, <name><surname>Finn</surname><given-names>RD</given-names></name>, <etal>et al</etal>. <article-title>The challenge of increasing Pfam coverage of the human proteome</article-title>. <source>Database</source>. <year>2013</year>;<volume>2013</volume>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/database/bat023</pub-id><?supplied-pmid 23603847?><pub-id pub-id-type="pmid">23603847</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Voß</surname><given-names>S</given-names></name>, <name><surname>Betz</surname><given-names>R</given-names></name>, <name><surname>Heidt</surname><given-names>S</given-names></name>, <name><surname>Corradi</surname><given-names>N</given-names></name>, <name><surname>Requena</surname><given-names>N</given-names></name>. <article-title>RiCRN1, a crinkler effector from the arbuscular mycorrhizal fungus Rhizophagus irregularis, functions in arbuscule development</article-title>. <source>Frontiers in microbiology</source>. <year>2018</year>;<volume>9</volume>:<fpage>2068</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3389/fmicb.2018.02068</pub-id><pub-id pub-id-type="pmid">30233541</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Choy</surname><given-names>RK</given-names></name>, <name><surname>Thomas</surname><given-names>JH</given-names></name>. <article-title>Fluoxetine-resistant mutants in C. elegans define a novel family of transmembrane proteins</article-title>. <source>Molecular cell</source>. <year>1999</year>;<volume>4</volume>(<issue>2</issue>):<fpage>143</fpage>–<lpage>152</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/S1097-2765(00)80362-7</pub-id><?supplied-pmid 10488330?><pub-id pub-id-type="pmid">10488330</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>van Kempen</surname><given-names>M</given-names></name>, <name><surname>Kim</surname><given-names>S</given-names></name>, <name><surname>Tumescheit</surname><given-names>C</given-names></name>, <name><surname>Mirdita</surname><given-names>M</given-names></name>, <name><surname>Söding</surname><given-names>J</given-names></name>, <name><surname>Steinegger</surname><given-names>M</given-names></name>. <article-title>Foldseek: fast and accurate protein structure search</article-title>. <source>bioRxiv</source>. <year>2022</year>;.</mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Tatusov</surname><given-names>RL</given-names></name>, <etal>et al</etal>. <article-title>The COG database: a tool for genome-scale analysis of protein functions and evolution</article-title>. <source>NAR</source>. <year>2000</year>;<volume>28</volume>(<issue>1</issue>):<fpage>33</fpage>–<lpage>36</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/nar/28.1.33</pub-id><?supplied-pmid 10592175?><pub-id pub-id-type="pmid">10592175</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Kiełbasa</surname><given-names>SM</given-names></name>, <name><surname>Wan</surname><given-names>R</given-names></name>, <name><surname>Sato</surname><given-names>K</given-names></name>, <name><surname>Horton</surname><given-names>P</given-names></name>, <name><surname>Frith</surname><given-names>MC</given-names></name>. <article-title>Adaptive seeds tame genomic sequence comparison</article-title>. <source>Genome research</source>. <year>2011</year>;<volume>21</volume>(<issue>3</issue>):<fpage>487</fpage>–<lpage>493</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1101/gr.113985.110</pub-id><?supplied-pmid 21209072?><pub-id pub-id-type="pmid">21209072</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1010610.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Buchfink</surname><given-names>B</given-names></name>, <name><surname>Reuter</surname><given-names>K</given-names></name>, <name><surname>Drost</surname><given-names>HG</given-names></name>. <article-title>Sensitive protein alignments at tree-of-life scale using DIAMOND</article-title>. <source>Nature methods</source>. <year>2021</year>;<volume>18</volume>(<issue>4</issue>):<fpage>366</fpage>–<lpage>368</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41592-021-01101-x</pub-id><?supplied-pmid 33828273?><pub-id pub-id-type="pmid">33828273</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
