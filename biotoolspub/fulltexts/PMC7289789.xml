<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7289789</article-id>
    <article-id pub-id-type="publisher-id">66454</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-020-66454-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Multi-branch Convolutional Neural Network for Identification of Small Non-coding RNA genomic loci</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Georgakilas</surname>
          <given-names>Georgios K.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grioni</surname>
          <given-names>Andrea</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liakos</surname>
          <given-names>Konstantinos G.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chalupova</surname>
          <given-names>Eliska</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Plessas</surname>
          <given-names>Fotis C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Alexiou</surname>
          <given-names>Panagiotis</given-names>
        </name>
        <address>
          <email>panagiotis.alexiou@ceitec.muni.cz</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0494 4180</institution-id><institution-id institution-id-type="GRID">grid.454751.6</institution-id><institution>Central European Institute of Technology, </institution></institution-wrap>Brno, Czech Republic </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2194 0956</institution-id><institution-id institution-id-type="GRID">grid.10267.32</institution-id><institution>Faculty of Science, National Centre for Biomolecular Research, Masaryk University, </institution></institution-wrap>Brno, Czech Republic </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0035 6670</institution-id><institution-id institution-id-type="GRID">grid.410558.d</institution-id><institution>Department of Electrical and Computer Engineering, School of Engineering, University of Thessaly, </institution></institution-wrap>Volos, Greece </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>9486</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>12</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>5</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Genomic regions that encode small RNA genes exhibit characteristic patterns in their sequence, secondary structure, and evolutionary conservation. Convolutional Neural Networks are a family of algorithms that can classify data based on learned patterns. Here we present MuStARD an application of Convolutional Neural Networks that can learn patterns associated with user-defined sets of genomic regions, and scan large genomic areas for novel regions exhibiting similar characteristics. We demonstrate that MuStARD is a generic method that can be trained on different classes of human small RNA genomic loci, without need for domain specific knowledge, due to the automated feature and background selection processes built into the model. We also demonstrate the ability of MuStARD for inter-species identification of functional elements by predicting mouse small RNAs (pre-miRNAs and snoRNAs) using models trained on the human genome. MuStARD can be used to filter small RNA-Seq datasets for identification of novel small RNA loci, intra- and inter- species, as demonstrated in three use cases of human, mouse, and fly pre-miRNA prediction. MuStARD is easy to deploy and extend to a variety of genomic classification questions. Code and trained models are freely available at <underline>gitlab.com/RBP_Bioinformatics/mustard</underline>.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational biology and bioinformatics</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Transcriptomics</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par2">Since the human genome was first sequenced about two decades ago<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, our understanding of regulatory and non-coding elements in humans, and other organisms, has been steadily increasing with the identification and cataloguing of a variety of encoded molecule and regulatory region classes<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>. Several small non-coding RNA molecule families such as microRNA (miRNA), small nucleolar RNA (snoRNA), small nuclear RNA (snRNA), piwi-interacting RNA (piRNA), short hairpin RNA (shRNA), small interfering RNA (siRNA), promoter-associated short RNAs (PASRs), termini-associated short RNAs (TASRs)<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref></sup>, transcription initiation RNAs (tiRNAs)<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>, and others, now populate the functional expression map of known genomes. The plethora of functional small non-coding RNA classes supports the idea of a highly interconnected transcriptomic landscape and highlights the necessity of computational approaches that can effectively identify them against the enormous background variability of eukaryotic genomes. Along with our deeper understanding of well-established organisms, the total number of sequenced genomes has been increasing hand in hand with fast pace. NCBI currently lists just over 7,000 eukaryotic sequenced genomes, of which almost 50 have fully assembled genomes, and approximately 1,000 have some assembled chromosomes. The experimental annotation of newly sequenced genomes is a much slower and piecemeal process that benefits greatly from the availability of computational techniques that can guide and assist the annotation.</p>
    <p id="Par3">Computational methods for genomic annotation have a history at least as long as full genome sequencing, with computational identification of exons and protein coding genes<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> starting in parallel with the sequencing of the first human genome. Small non-coding RNAs, with their shorter length, lack of coding three nucleotide periodicity pattern, and often small number of known examples per class, offer a tougher challenge for computational methods. A common approach for in silico identification of putative small non-coding RNA genomic loci has been the use of sequence homology between molecules from well annotated species, such as humans, and the new species in question. These methods, while efficient when homology is high, are bound to preferentially annotate a subset of loci, biased towards extra-conserved molecules. However, a large number of small non-coding RNAs are more evolutionary constrained. For example, an estimated 40% of human miRNAs have developed recently in evolutionary history and can only be found in other primates<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>.</p>
    <p id="Par4">To avoid the constraints and biases of homology based identification of small non-coding RNA loci, there has been a steady development of algorithms that aim at modelling characteristics of a specific class or subclass, and then evaluating proposed regions of a genome for their potential to encode a small non-coding RNA of this class. For example, over thirty computational methods aiming at pre-microRNA identification have been developed to date, with no tool significantly outperforming all others on benchmarked datasets<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. A large drawback of such methods is their dependence on expert-defined features and background sets, which tend to produce methods that perform well in evaluations closely matching their training biases, but fail to produce robust classification in more realistic conditions, such as when ‘scanning’ a large genomic region. The second large drawback of these methods is that they are, by design, focused on one specific class or subclass of small non-coding RNA molecules. For example, a method tailored for pre-miRNA prediction is not suitable for snoRNA prediction and vice versa. This issue leads to an unbalanced development of methods towards specific families and ignores others that may not be populous or well-researched enough to warrant the attention of in silico method developers. For example, as mentioned above, pre-microRNA prediction is a well-researched field with over thirty computational methods published in the past decade or so, while in contrast snoRNA prediction displays a distinct paucity of options, with methods becoming obsolete and unusable after more than a decade<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup> and the rate of identification severely slowing down in new species<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>.</p>
    <p id="Par5">Taking into account the limitations and drawbacks of in silico methods to date, we have decided to approach the problem of small non-coding RNA identification from a different angle. Here we introduce MuStARD (<underline>M</underline>achine-learning <underline>S</underline>ystem for <underline>A</underline>utomated <underline>R</underline>NA <underline>D</underline>iscovery), a flexible Deep Learning framework that utilizes raw sequence, conservation, and folding data to identify genomic loci with similar characteristics of a given set of regions (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). Instead of hundreds of expertly curated features, we employ a Convolutional Neural Network (CNN) Deep Learning (DL) architecture that can identify important characteristics from raw data directly<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Rather than biased background training sets, we opted for a novel iterative background selection process that allows the method itself to identify the background ‘hard cases’ for a specific classification task, and preferentially learn how to avoid them. While other tools focus on one class of small non-coding RNAs, we have developed a framework that can be applied, directly out of the box, on any class of genomic loci. We show the power of this methodology by training models that outperform the state of the art for pre-miRNAs and snoRNAs by scanning large genomic regions. We demonstrate the practical use of our method by performing a cross-species prediction using models trained on human data to accurately identify mouse pre-miRNAs and snoRNAs in numbers well above homology searches. Additionally, we applied MuStARD on small RNA-Seq enriched regions and pre-miRNAs that have been removed from miRBase since version 14, to further highlight the usability spectrum of our algorithm. The source code is available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/RBP_Bioinformatics/mustard">https://gitlab.com/RBP_Bioinformatics/mustard</ext-link> and trained models at <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/RBP_Bioinformatics/mustard_paper">https://gitlab.com/RBP_Bioinformatics/mustard_paper</ext-link>.<fig id="Fig1"><label>Figure 1</label><caption><p>Overview of MuStARD modular architecture and iterative training pipeline. (<bold>a</bold>) MuStARD is able to handle any combination of either raw DNA sequences, RNAfold derived secondary structure and basewise evolutionary conservation from PhyloP. DNA sequences and RNAfold output are one-hot encoded while PhyloP score is not pre-processed. Each feature category is forwarded to a separate ‘branch’ that consists of three convolutional layers. The computations from all branches are concatenated prior to being forwarded to the fully connected part of the network. (<bold>b</bold>) The training pipeline of MuStARD consists of two steps. Initially, pre-miRNA sequences are randomly shuffled to exonic and intronic (protein-coding and lincRNA genes) regions of the genome to extract equal sized negative sequences with 1:4 positive to negative ratio. This process is repeated 50 times to facilitate the training of equal number of models. The performance of each model is assessed based on the test set and all false positives that are supported by at least 25 models are extracted. This set of false positives is added to the negative pool of the best performing model to create an enhanced training set. The enhanced set is used to train the final MuStARD model.</p></caption><graphic xlink:href="41598_2020_66454_Fig1_HTML" id="d30e354"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Network architecture and training scheme</title>
      <p id="Par6">MuStARD is able to handle any combination of either raw DNA sequences, basewise evolutionary conservation and folding data (Fig. <xref rid="Fig1" ref-type="fig">1a</xref>). Each feature category is forwarded to a separate ‘branch’ that consists of three convolutional layers and the computations from all branches are concatenated prior to being forwarded to the fully connected part of the network. The training scheme consists of two steps (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). First 50 models are trained in parallel with random background selection. The 50 trained models are used to scan a large region of the genome. From these 50 scans, the ‘hard cases’ where the majority of models detect a false positive are isolated and a new negative set created. The best performing of the 50 models is then used as the starting point to train the final model on the ‘hard cases’ while keeping the same positive set. This final trained model is then evaluated on targets located in chromosomes completely left out of the whole previous process, thus ensuring no cross-contamination.</p>
      <p id="Par7">This process was repeated 6 times to train pre-miRNA detection models composed of different input combinations; raw sequence with secondary structure and conservation (MuStARD-mirSFC model), raw sequence and conservation (MuStARD-mirSC), raw sequence and secondary structure (MuStARD-mirSF), secondary structure and conservation (MuStARD-mirFC), secondary structure only (MuStARD-mirF) and sequence only (MuStARD-mirS). For the combination of raw sequence, secondary structure and conservation, we have trained an additional model after disabling the class weights option in Keras (MuStARD-mirSFC-U model).</p>
      <p id="Par8">The same pipeline was used to create three snoRNA detection models, one for detecting the C/D box snoRNA subspecies (MuStARD-snoSFC-U-CDbox), one for H/ACA box (MuStARD-snoSFC-U-HACAbox) and one for detecting all types of snoRNAs (MuStARD-snoSFC-U).</p>
      <p id="Par9">Detailed information related to the network architecture and training scheme can be found in <xref rid="MOESM1" ref-type="media">Supplementary Methods</xref>.</p>
    </sec>
    <sec id="Sec4">
      <title>Training sets</title>
      <p id="Par10">Human (GRCh38) and mouse (GRCm38) genomes and corresponding gene and snoRNA annotations were downloaded from Ensembl v93 repository<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Fly genome (version 5.32) was downloaded from FlyBase<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. Pre-miRNA sequences were downloaded from miRBase v22.1<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>. Basewise conservation scores, based on phyloP algorithm, of 99 and 59 vertebrate genomes with human and mouse respectively were downloaded from the UCSC genome repository<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. For genome scanning tests, targets were extended by + /− 5,000 bp and the resulting regions were merged in the case of strand specific overlaps. The regions were assessed by a moving window of width 100 and step 5. Any prediction overlapping the target by at least 50% was considered a positive. A full explanation of the production of Training Sets, and the Methodology of comparisons can be found in <xref rid="MOESM1" ref-type="media">Supplementary Methods</xref>. Results of the comparison between MuStARD models using distinct combinations of raw sequence, secondary structure and evolutionary conservation as input, are presented in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>. The evaluation of the final MuStARD models and comparisons to other state of the art programs can be found in Supplementary Tables <xref rid="MOESM1" ref-type="media">2</xref>–<xref rid="MOESM1" ref-type="media">7</xref>. The performance of MuStARD-mir models in the first training iteration can be found in Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>.</p>
    </sec>
    <sec id="Sec5">
      <title>Software and hardware requirements</title>
      <p id="Par11">MuStARD is developed in python utilizing tensorflow and Keras for the Deep Learning aspect, R for visualizing the performance and Perl for file processing, reformatting and module connectivity. Full list of dependencies can be found on MuStARD’s gitlab page.</p>
      <p id="Par12">MuStARD is able to execute either on CPU or GPU depending on the underlying hardware configuration by taking into advantage tensorflow’s flexibility. The framework has been designed to maintain a minimal memory footprint thus allowing the execution even on personal computers. Running time heavily depends on input dimensionality, number of instances in the training set, learning rate and GPU availability. On a GPU (NVIDIA GeForce GTX 1050Ti) it took approximately 5 minutes to train a model on 30,000 positive and negative sequences.</p>
      <p id="Par13">MuStARD operates directly on genomic intervals in BED format, in the cases of both the training and prediction modules. For example, regarding small RNA-Seq datasets, MuStARD does not directly process aligned reads. Instead, users need to provide a bed file with small RNA-Seq enriched regions to be scanned with MuStARD. Essentially, sequencing depth is not crucial as our algorithm works after a ‘peak calling’ step that can be as simple as a bedtools merge command followed by a bedtools coverage filtering.</p>
      <p id="Par14">For the mouse liver small RNA-Seq dataset, we scanned 14,552 intervals (both strands derived from 7,276 peaks) with a total size of 3.9mbp, mean interval size of 268 bp and standard deviation of 50.3 bp. The MuStARD-mirSFC-U model was used with a sliding window step of 10 bp and the total running time was 36 minutes (CPU usage only).</p>
      <p id="Par15">In the case of the fly embryo dataset, we scanned 1,638 intervals (819 peaks) with 526 kb total size, 321 bp mean size with standard deviation of 172 bp. We used MuStARD-mirSF model with a sliding window step of 10 bp and total running time of 3.8 minutes.</p>
      <p id="Par16">The average running time of MuStARD per peak, based on the mir-SFC-U model, was 0.17 seconds, while based on the mir-SF model was 0.13 seconds. Running times were normalized on 321 bp average interval size.</p>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="results">
    <title>Results</title>
    <sec id="Sec7">
      <title>Training of convolutional neural network model</title>
      <p id="Par17">We compared the performance of MuStARD on all combinations of input data for the pre-miRNA prediction dataset (Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). As expected, scanning test sequences with various models shows that models including a higher number of meaningful input data branches perform better in retrieval of pre-miRNAs. The model trained on secondary structure and conservation was the best performing two-input model. This result aligns with the identification of pre-miRNA hairpins by the Microprocessor complex during miRNA biogenesis primarily by characteristics of their secondary structure rather than sequence<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> and the fact that pre-miRNAs have highly conserved regions corresponding to the mature miRNA sequences. Surprisingly, the non-balanced model (MuStARD-mirSFC-U) performs best out of all model combinations including the balanced three input model. Since MuStARD-mirSFC-U outperforms all other models, we will only report results for this model in the following evaluations. For snoRNAs, the equivalent best performing model is MuStARD-snoSFC-U. Detailed explanation of the training scheme can be found in <xref rid="MOESM1" ref-type="media">Supplementary Methods</xref>.</p>
    </sec>
    <sec id="Sec8">
      <title>Identification of <italic>homo sapiens</italic> pre-miRNA genomic loci</title>
      <p id="Par18">While training MuStARD models, we left-out the entirety of randomly selected chromosome 14 as a final evaluation set that could be fairly used to benchmark MuStARD’s performance against the current state of the art in pre-miRNA prediction. The question of accurate pre-miRNA prediction has been thoroughly researched since there are currently over 30 published pre-miRNA prediction algorithms indexed in the OMICtools<sup><xref ref-type="bibr" rid="CR18">18</xref></sup> repository. The majority of these studies could not be coerced to run on our benchmarking dataset (see <xref rid="MOESM1" ref-type="media">Supplementary Methods</xref> for details). We managed to run and evaluate five state of the art programs: HuntMi<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, microPred<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, MiPred<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>, miRBoost<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> and triplet-SVM<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>. A list of algorithms we attempted, but failed, to evaluate can be found along with our code repository. Of these five, only triplet-SVM, MiPred and miRBoost provide probabilities as output scores allowing assessment of their performance on multiple score thresholds. HuntMi and microPred provide fixed output score/labels limiting their performance comparison on a fixed threshold (Supplementary Figure <xref rid="MOESM1" ref-type="media">1</xref>, Supplementary Tables <xref rid="MOESM1" ref-type="media">2</xref> and <xref rid="MOESM1" ref-type="media">3</xref>). After evaluating all five algorithms on the chromosome 14 evaluation set, we identified MiPred as the overall optimally performing state-of-the-art algorithm, thus for the sake of brevity we will only report direct in depth comparison to MiPred. Table <xref rid="Tab1" ref-type="table">1</xref> summarizes the performance results from the pre-labelled and scanning chromosome 14 benchmarks.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Performance results based on the human chromosome 14 pre-labelled and scanning datasets.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Algorithms</th><th colspan="3">Homo Sapiens - chr14 pre-labelled dataset</th><th colspan="3">Homo Sapiens - chr14 scanning dataset</th></tr><tr><th>Precision</th><th>Sensitivity</th><th>F1</th><th>Precision</th><th>Sensitivity</th><th>F1</th></tr></thead><tbody><tr><td>MuStARD-mirSFC-U</td><td>0.958</td><td>0.522</td><td>0.675</td><td>0.953</td><td>0.424</td><td>0.587</td></tr><tr><td>MiPred</td><td>0.128</td><td>0.977</td><td>0.226</td><td>0.069</td><td>1</td><td>0.130</td></tr><tr><td>miRBoost</td><td>0.063</td><td>0.840</td><td>0.118</td><td>0.080</td><td>0.898</td><td>0.146</td></tr><tr><td>HuntMi</td><td>0.147</td><td>1</td><td>0.256</td><td>0.070</td><td>0.979</td><td>0.131</td></tr><tr><td>microPred</td><td>0.114</td><td>0.977</td><td>0.205</td><td>0.197</td><td>1</td><td>0.330</td></tr><tr><td>triplet-SVM</td><td>0.194</td><td>0.931</td><td>0.321</td><td>0.061</td><td>0.898</td><td>0.115</td></tr><tr><td>Random</td><td>0.051</td><td>0.545</td><td>0.094</td><td>N/A</td><td>N/A</td><td>N/A</td></tr></tbody></table></table-wrap></p>
      <p id="Par19">Both MuStARD and MiPred report predictions with probability scores, and both programs would as default be used at a score threshold of 0.5. However, at that threshold, MiPred produces an inordinate amount of false positives (Supplementary Tables <xref rid="MOESM1" ref-type="media">2</xref> and <xref rid="MOESM1" ref-type="media">3</xref>). For fairness of comparison of program precision, we have set a threshold on prediction sensitivity at the point where each program predicts 50% of real pre-miRNAs (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). MuStARD exhibits consistently higher precision for any level of sensitivity (Fig. <xref rid="Fig2" ref-type="fig">2b,c</xref>) and at a strict threshold where 33% of real pre-miRNAs can be annotated it produces on average one false positive prediction per 800,000 scanned nucleotides (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>) outperforming MiPred by an order of magnitude. Detailed information related to the scanning and static types of evaluation can be found in <xref rid="MOESM1" ref-type="media">Supplementary Information</xref>.<fig id="Fig2"><label>Figure 2</label><caption><p>Evaluation of MuStARD human predictions against MiPred, the best performing of state-of-the-art pre-miRNA prediction algorithms. (<bold>a</bold>) Genome browser visualization of each algorithm’s performance on the scanning windows in a 15 kb locus hosting three pre-miRNAs on the left-out chromosome 14. Both evaluated programs have been benchmarked at scores that give sensitivity of 0.5 over the left-out chromosome. MuStARD correctly predicts 2/3 of the annotated pre-miRNAs (in this particular locus), same as MiPred. MuStARD produces no false positive predictions, compared to 11 for MiPred (marked with red x). (<bold>b</bold>) precision-sensitivity curve of MuStARD and MiPred over scanned areas of the left-out chromosome 14. (<bold>c</bold>) Precision of MuStARD and MiPred at loose (sensitivity 0.5) and strict (sensitivity 0.33) thresholds. (<bold>d</bold>) Average length in thousands of base pairs for finding each false positive prediction on the left-out chromosome. Showing MuStARD at strict and loose thresholds, and MiPred at strict, loose, and full (score 0.5 - sensitivity ~1) thresholds, and random prediction (threshold sensitivity 0.5) denoting the worst performing levels an algorithm could achieve.</p></caption><graphic xlink:href="41598_2020_66454_Fig2_HTML" id="d30e738"/></fig></p>
    </sec>
    <sec id="Sec9">
      <title>Identification of pre-miRNAs from small RNA-Seq data</title>
      <p id="Par20">Our method can scan large genomic regions with unprecedented precision, but would still produce a large number of false positives in a full genome scan of several billion bases. A more realistic experimental and computational approach would be the identification of molecules from small RNA-Seq data. In this type of commonly performed experiment, RNA is isolated and filtered for sizes below a certain threshold, thus removing most mRNAs and long non-coding RNAs. However, there still remain fragments and other artifacts, and the bona fide small RNAs still need to be classified into different classes.</p>
      <p id="Par21">We used the human pre-miRNA trained model of our method to retrieve pre-miRNA predictions from three small RNA-Seq datasets in varying degrees of evolutionary distance from humans. The first dataset consists of human H1 cells, in which we only evaluated 502 small RNA-Seq enriched regions from the left-out chromosome 14. The second dataset comes from mouse liver and we evaluated on 7,276 enriched regions genome-wide. The last datasets is of higher difficulty as it was derived from drosophila melanogaster, an evolutionary distant organism for which conservation information was not readily available. We evaluated our method without the conservation branch (MuStARD-mirSF) on drosophila using the top 819 small RNA-Seq enriched regions (Table <xref rid="Tab2" ref-type="table">2</xref>).<table-wrap id="Tab2"><label>Table 2</label><caption><p>Performance summary based on the small RNA-Seq datasets from Homo Sapiens, Mus Musculus and Drosophila Melanogaster, at 0.84 score threshold.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th>MuStARD-mirSFC-U</th><th>MiPred</th><th>Expression</th></tr></thead><tbody><tr><td rowspan="3">Homo Sapiens - small RNA-Seq in H1 cells</td><td>Precision</td><td>0.750</td><td>0.857</td><td>1</td></tr><tr><td>Sensitivity</td><td>0.500</td><td>0.157</td><td>0.027</td></tr><tr><td>F1</td><td>0.600</td><td>0.266</td><td>0.054</td></tr><tr><td rowspan="3">Mus Musculus - small RNA-Seq in Liver</td><td>Precision</td><td>0.747</td><td>0.512</td><td>0.964</td></tr><tr><td>Sensitivity</td><td>0.581</td><td>0.097</td><td>0.065</td></tr><tr><td>F1</td><td>0.653</td><td>0.163</td><td>0.122</td></tr><tr><td rowspan="3">Drosophila Melanogaster - small RNA-Seq in Embryo</td><td>Precision</td><td>0.526</td><td>1</td><td>0.500</td></tr><tr><td>Sensitivity</td><td>0.500</td><td>0.023</td><td>0.052</td></tr><tr><td>F1</td><td>0.512</td><td>0.046</td><td>0.095</td></tr></tbody></table></table-wrap></p>
      <p id="Par22">We have evaluated MuStARD and MiPred using precision/recall curves (Supplementary Figure <xref rid="MOESM1" ref-type="media">2</xref>) as well as the F1 measure at multiple score thresholds to gain a spherical view of the algorithms’ performance (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). For the precision/recall curves specifically, we have added the ‘naive’ strategy of picking multiple top percentiles of small RNA-Seq enriched loci ranked by decreasing expression level. The ‘naive’ strategy serves as the baseline performance that any Machine Learning algorithm should outperform.<fig id="Fig3"><label>Figure 3</label><caption><p>Evaluation of filtering for small RNA-Seq datasets for pre-miRNAs. F1 score per score threshold of the prediction method. MiPred default score threshold is 0.5. We evaluated three datasets: (<bold>a</bold>) human H1 cells, left out chromosome 14. (<bold>b</bold>) mouse liver, whole genome. (<bold>c</bold>) drosophila melanogaster embryo, whole genome. For the drosophila evaluation, vertebrate evolutionary conservation track was not available so the MuStARD-mirSF (sequence, folding) model was used instead.</p></caption><graphic xlink:href="41598_2020_66454_Fig3_HTML" id="d30e927"/></fig></p>
      <p id="Par23">MuStARD outperforms MiPred at every benchmark dataset while keeping a relatively balanced ratio between precision and sensitivity across multiple score thresholds. For example, in order for MiPred to reach high levels of precision (85.7%) in human, it needs to increase the score threshold at a level that reduces the sensitivity below 16% (Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>). MuStARD, on the other hand, is able to maintain sensitivity above 40%, even with a score threshold as high as 0.89 that translates to 82% of precision.</p>
      <p id="Par24">As expected, we notice a decreasing level of MuStARD’s prediction performance with increasing evolutionary distance from our training organism with human (F1 = 0.66, Fig. <xref rid="Fig3" ref-type="fig">3a</xref>), mouse (F1 = 0.57, Fig. <xref rid="Fig3" ref-type="fig">3b</xref>) and drosophila (F1 = 0.39, Fig. <xref rid="Fig3" ref-type="fig">3c</xref>) at 0.5 score threshold (Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>). Our method can narrow down the peaks identified from small RNA-Seq and better prioritize ones that could harbor small RNAs of a specific class. Detailed information related to the small RNA-Seq based strategy can be found in <xref rid="MOESM1" ref-type="media">Supplementary Methods</xref>.</p>
    </sec>
    <sec id="Sec10">
      <title>Cross-species identification of pre-miRNA genomic loci</title>
      <p id="Par25">Having established a substantial increase in precision for intra-species pre-miRNA prediction we evaluated our model on an inter-species prediction. Briefly, we used the best performing pre-miRNA identification model trained on human data, to scan swathes of the mouse genome (in total ~9.8Mbps) containing 1,227 annotated mouse pre-miRNAs. The inter-species prediction correctly identified pre-miRNAs with a small number of false positives, at a rate of 1/260kbp. Figure <xref rid="Fig4" ref-type="fig">4a</xref> shows a browser snapshot of a mouse pre-miRNA cluster locus. As expected, the precision of the inter-species prediction was lower than the intra-species evaluation set (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>), and even lower for pre-miRNAs that do not have a human homologue as they have lower levels of conservation which is one of our model’s input branches (Fig. <xref rid="Fig4" ref-type="fig">4c</xref>). MuStARD exhibits exceptional levels of generalisation capacity (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>) identifying correctly a large majority (94/129) of homologous pre-miRNAs and more than double (212) non-homologous pre-miRNAs. Detailed information can be found in <xref rid="MOESM1" ref-type="media">Supplementary Methods</xref>.<fig id="Fig4"><label>Figure 4</label><caption><p>Prediction of mouse pre-miRNAs by the model trained on human. (<bold>a</bold>) Genome browser visualization of MuStARD performance on the scanning of a 35 kb locus hosting 36 pre-miRNAs. MuStARD correctly identifies 20/36 pre-miRNAs with 2 false positives, out of which one falls on the first “exon” of a long non coding RNA Mirg annotated as “miRNA containing lincRNA”. (<bold>b</bold>) Precision-Sensitivity curve of human trained MuStARD predictions on mouse pre-miRNAs. Orange line shows the model prediction on human for reference. Solid blue line shows the prediction on all mouse pre-miRNAs, and dashed blue line shows the prediction on mouse pre-miRNAs without a direct human homologue. (<bold>c</bold>) A visualization of the mouse pre-miRNA evaluation set denoting the number of predicted and non-predicted, orthologous and non-orthologous pre-miRNAs.</p></caption><graphic xlink:href="41598_2020_66454_Fig4_HTML" id="d30e988"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>Evaluation of miRBase retracted pre-miRNAs</title>
      <p id="Par26">In order to evaluate our method on another difficult and realistic task, we mined all pre-miRNAs that were annotated in previous versions of miRBase (version 14 to 22.1) but have since been retracted from it. Extensive details can be found in <xref rid="MOESM1" ref-type="media">Supplementary Methods</xref>. These are loci that show a close similarity to bona fide microRNAs, enough to be suggested by some experimental method. We evaluated 57 human and 64 mouse pre-miRNAs with our pre-miRNA prediction model trained on the latest human miRBase. Since these retracted pre-miRNAs do not exist in this latest version, our training model has never seen them before. At the 0.5 score threshold (loose) used for the evaluation, MuStARD correctly identified as negative 54/57 (95%) which increased to 56/57 (98%) at 0.85 threshold (strict) for human pre-miRNAs. For mouse pre-miRNAs, still using the human trained model, we correctly retrieved as negative 64/64 (100%) of the targets even at the most loose threshold (Supplementary Table <xref rid="MOESM1" ref-type="media">6</xref>).</p>
    </sec>
    <sec id="Sec12">
      <title>Identification of <italic>homo sapiens</italic> sno-RNA loci</title>
      <p id="Par27">Despite its high accuracy on pre-miRNA classification, MuStARD was not specifically developed for pre-miRNA detection. To demonstrate its flexibility we trained models on a completely different class of small non-coding RNAs, small nucleolar RNAs (snoRNAs). SnoRNAs are a class of small RNAs with widely varying structure, sequence, and conservation patterns. We experimentally trained a model on all snoRNAs as well as two additional models for the most populous snoRNAs sub-families, the H/ACA and C/D box. H/ACA box snoRNAs have a secondary structure consisting of hairpins and single stranded regions. In contrast, C/D box snoRNAs have a stem-box structure that is much more variable than H/ACA box. In addition, our ‘all snoRNA’ dataset includes snoRNAs beyond these two sub-families. For the two sub-families we were also able to benchmark against snoReport<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> a state-of-the-art snoRNA prediction software developed specifically to identify each of these two categories against background (Table <xref rid="Tab3" ref-type="table">3</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref>). We observe that MuStARD matches snoReport on the Homo Sapiens C/D box training set (Score 0.8, F1: 0.759 vs 0.769), but completely outperforms snoReport in Mus Musculus prediction for both C/D box (Score 0.8, F1: 0.704 vs 0.570) and H/ACA box (Score 0.8, F1: 0.810 vs 0.033). MuStARD also outperforms snoReport at the Homo Sapiens H/ACA box model (Score 0.8, F1: 0.755 vs 0.094). Furthermore, we tested the inter-species capabilities of the MuStARD model, by applying the human-trained snoRNA model to the mouse genome (Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref>). These results demonstrate that the MuStARD method is capable of producing well trained models beyond the state of the art without domain knowledge, and even with relatively heterogeneous positive samples (“all snoRNAs”).<table-wrap id="Tab3"><label>Table 3</label><caption><p>Evaluation of prediction for all snoRNA, and CD-box orH/ACA-box subfamilies separately.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2"/><th rowspan="2"/><th rowspan="2"/><th>All snoRNAs</th><th colspan="2">C/D box</th><th colspan="2">H/ACA box</th></tr><tr><th>MuStARD</th><th>MuStARD</th><th>snoReport</th><th>MuStARD</th><th>snoReport</th></tr></thead><tbody><tr><td rowspan="6">Score Threshold 0.5</td><td rowspan="3">Homo Sapiens</td><td>Precision</td><td>0.545</td><td>0.476</td><td>0.512</td><td>0.705</td><td>0.100</td></tr><tr><td>Sensitivity</td><td>0.791</td><td>0.954</td><td>0.954</td><td>0.764</td><td>0.058</td></tr><tr><td>F1</td><td>0.645</td><td>0.635</td><td>0.666</td><td>0.733</td><td>0.073</td></tr><tr><td rowspan="3">Mus Musculus</td><td>Precision</td><td>0.549</td><td>0.494</td><td>0.332</td><td>0.730</td><td>0.103</td></tr><tr><td>Sensitivity</td><td>0.928</td><td>0.969</td><td>0.897</td><td>0.951</td><td>0.146</td></tr><tr><td>F1</td><td>0.689</td><td>0.654</td><td>0.484</td><td>0.825</td><td>0.120</td></tr><tr><td rowspan="6">Score Threshold 0.8</td><td rowspan="3">Homo Sapiens</td><td>Precision</td><td>0.820</td><td>0.645</td><td>0.666</td><td>0.909</td><td>0.250</td></tr><tr><td>Sensitivity</td><td>0.708</td><td>0.954</td><td>0.954</td><td>0.647</td><td>0.058</td></tr><tr><td>F1</td><td>0.759</td><td>0.769</td><td>0.784</td><td>0.755</td><td>0.094</td></tr><tr><td rowspan="3">Mus Musculus</td><td>Precision</td><td>0.656</td><td>0.580</td><td>0.420</td><td>0.772</td><td>0.055</td></tr><tr><td>Sensitivity</td><td>0.769</td><td>0.897</td><td>0.887</td><td>0.853</td><td>0.024</td></tr><tr><td>F1</td><td>0.708</td><td>0.704</td><td>0.570</td><td>0.810</td><td>0.033</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec13" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par28">We present here a flexible Deep Learning framework that can be used to identify small RNA genomic loci based on the sequence, conservation, and secondary structure characteristics of the class. A model can be easily trained, without any changes on the code, to identify any class of small RNA loci provided enough examples of the class exist. Training of the model does not require expertly curated features specific to the RNA class. In contrast to highly specific methods that rely on extraction of hundreds of features, our method operates directly on raw sequence, conservation scores, and a simple linear folding representation. Despite the simplicity of the inputs, and the generality of the method, it manages to convincingly outperform all state of the art methods that have been each developed and trained on one single class of RNAs specifically.</p>
    <p id="Par29">An important aspect of our method is the ability, for the first time, to scan large genomic regions, or even several thousand sequencing peaks, at an acceptably low false discovery rate. Machine learning methods can only learn variation that is presented to them. When looking for extremely rare events, such as small RNA genomic loci, it becomes evident that large genomic regions will need to be scanned, and the background variation will be enormous. However, most negative loci have extremely low potential of being confused for small RNA loci. A static classification between real loci and randomly selected background is prone to overestimate the predictive power of evaluated methods. Some methods have attempted to create ‘harder’ negative sets by including sequences that have characteristics similar to the predicted class. This approach implies that the researcher already knows the major characteristics of the predicted class, and that these characteristics will remain stable for each training model. In our case neither of these prerequisites were true.</p>
    <p id="Par30">We initially prototyped our method with a small set of negatives, four for each real training example, randomly selected from regions within the coding and intronic regions of mRNAs, and long non-coding RNAs. We quickly realized that while our method could separate between these categories easily, it still produced a large amount of false positives in the more realistic large region scanning evaluation. Training several models using different, but equal, background sets showed us variability in the number and range of identified false positives. However, we noticed that a number of false positives appeared consistently in several of the trained models. These ‘hard cases’ of background variation are the ones that have sequence, conservation, and folding characteristics closest to the real training examples and are thus harder to differentiate. We decided to attempt an iterative enrichment technique for the training background in which ‘hard cases’ that confuse our models consistently are added into the training set for a second round of training. This method achieved a great leap in performance when evaluated in completely independent data. Importantly, this automatic iterative method does not rely on an expert user to select the characteristics of importance. The ‘hard cases’ are identified by the training model itself and will fit to whatever positive set it is training on. The enriched background for pre-miRNA and sno-RNA models is radically different, representing the differences of these classes between them, and allowing the models to be easily and accurately trained on any positive set of small RNA loci.</p>
    <p id="Par31">Using a number of pre-miRNA prediction algorithms for region scanning was time consuming and arduous labor. To calculate hundreds of features on regions spanning less than one percent of the human genome, all other algorithms (with miRBoost being the sole exception) required to group the scanning region into smaller batches of 2000 sequences in order to parallelize the analysis into a computer cluster (MetaCentrum-CERIT). Even so, the computing time for each single batch was approximately 4 days. In contrast, our algorithm was able to scan the mouse benchmark dataset that includes several million base pairs in a few hours on a single CPU.</p>
    <p id="Par32">We have demonstrated that our method can be used for cross-species prediction of small RNAs. As a proof of concept we trained models on human pre-miRNAs and snoRNAs and then identified their counterparts in mouse, a pair of well annotated species that have considerable evolutionary distance. The pre-miRNAs we correctly identified on the mouse genome were enriched in evolutionary conserved pre-miRNAs in human (approximately 30% of our true positive predictions vs 10% of all mouse miRNAs). That said, the majority (70%) of our predicted pre-miRNAs are not homologous to human pre-miRNAs and would not be easily identified by a simple homology search.</p>
    <p id="Par33">The method presented here can be generalized for any class of small RNAs on any species. We chose to highlight two examples (pre-miRNAs and sno-RNAs) that differ radically. Where pre-miRNAs have high levels of conservation and fold into characteristic hairpin structures, sno-RNAs show a much wider size distribution (118.8 mean / 59.1 sd vs 81.9 mean / 16.9 sd) and have a variety of subclasses with variable secondary structure and evolutionary patterns, making their identification harder. Thousands of known pre-miRNA sequences against a few hundred sno-RNAs reduce the size of the training set, adding a level of difficulty to the task. It follows that several methods for pre-miRNA identification have been developed to date, while sno-RNA identification methods have not been developed in the past decade. The need for modern, easy to use, easy to train, methods becomes self-evident, especially for RNA classes with fewer members, for which no new development is performed. It is beyond the scope of this paper to develop models for each class of small RNAs, but using our openly available method researchers can easily produce such models for their own RNAs of interest. MuStARD has been specifically designed to automate this process and facilitate ease-of-use by simplifying the input requirements. Regions of the targeted small RNA class can be loaded as a bed file, and MuStARD handles all pre-processing steps such as sequence and evolutionary conservation extraction as well as secondary structure calculation. Additionally, the iterative training module provides an interface for the automatic selection of background genomic loci that optimally represent the negative set, specifically tailored for the specific small RNA class. MuStARD can be easily applied on any small RNA identification problem that would not be easily identifiable by using older methods. Extensive documentation and tutorials on using MuStARD for novel RNA class predictions are available along with the MuStARD code repository at <underline>gitlab.com/RBP_Bioinformatics/mustard</underline>.</p>
  </sec>
  <sec id="Sec14" sec-type="conclusion">
    <title>Conclusion</title>
    <p id="Par34">To conclude, we have developed a method that is easy to train and deploy for any class of small RNA genomic loci. Using the novel iterative background selection our method can choose the background ‘hard cases’ specific for each training, boosting performance. We show that our method outperforms class specific methods, both in accuracy, and computational performance. We achieved cross species identification of small RNAs beyond homology, and also highlighted a realistic use case in the identification of pre-miRNAs out of small RNA-Seq peaks.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec15">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2020_66454_MOESM1_ESM.xlsx">
            <caption>
              <p>Supplementary Table S1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41598_2020_66454_MOESM2_ESM.xlsx">
            <caption>
              <p>Supplementary Table S2</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41598_2020_66454_MOESM3_ESM.xlsx">
            <caption>
              <p>Supplementary Table S3</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41598_2020_66454_MOESM4_ESM.xlsx">
            <caption>
              <p>Supplementary Table S4</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41598_2020_66454_MOESM5_ESM.xlsx">
            <caption>
              <p>Supplementary Table S5</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="41598_2020_66454_MOESM6_ESM.xlsx">
            <caption>
              <p>Supplementary Table S6</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="41598_2020_66454_MOESM7_ESM.xlsx">
            <caption>
              <p>Supplementary Table S7</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="41598_2020_66454_MOESM8_ESM.xlsx">
            <caption>
              <p>Supplementary Table S8</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="41598_2020_66454_MOESM9_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>is available for this paper at 10.1038/s41598-020-66454-3.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This research was funded by Postdoc@MUNI with project registration number CZ.02.2.69/0.0/0.0/16_027/0008360 grant to G.K.G.; the fellowship program Brno Ph.D. talent 2017 and the Associazione Italiana Ricerca Cancro’s fellowship 2018 no. 22620 to A.G. Grantová Agentura České Republiky, 19-10976Y Grant to P.A. Funding for open access charge: Postdoc@MUNI with project registration number CZ.02.2.69/0.0/0.0/16_027/0008360.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>P.A. and G.K.G. conceived the study. P.A. oversaw the whole study. G.K.G. developed the code, implemented all analyses and comparisons. A.G. applied HuntMi and microPred on the benchmark datasets and performed the mouse/human pre-miRNA homology analysis. G.K.G. and E.C. applied miPred on the benchmark datasets. K.G.L. and F.C.P. applied miRBoost and triplet-SVM on the benchmark datasets. P.A. and G.K.G. wrote the manuscript and prepared the figures.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par35">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Initial sequencing and analysis of the human genome</article-title>
        <source>Nature</source>
        <year>2001</year>
        <volume>409</volume>
        <fpage>860</fpage>
        <lpage>921</lpage>
        <pub-id pub-id-type="doi">10.1038/35057062</pub-id>
        <pub-id pub-id-type="pmid">11237011</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>ENCODE Project Consortium</collab>
        </person-group>
        <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kapranov</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA maps reveal new RNA classes and a possible function for pervasive transcription</article-title>
        <source>Science</source>
        <year>2007</year>
        <volume>316</volume>
        <fpage>1484</fpage>
        <lpage>1488</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1138341</pub-id>
        <pub-id pub-id-type="pmid">17510325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Djebali</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Landscape of transcription in human cells</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>101</fpage>
        <lpage>108</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11233</pub-id>
        <pub-id pub-id-type="pmid">22955620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taft</surname>
            <given-names>RJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tiny RNAs associated with transcription start sites in animals</article-title>
        <source>Nat. Genet.</source>
        <year>2009</year>
        <volume>41</volume>
        <fpage>572</fpage>
        <lpage>578</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.312</pub-id>
        <pub-id pub-id-type="pmid">19377478</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burge</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Karlin</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Prediction of complete gene structures in human genomic DNA</article-title>
        <source>J. Mol. Biol.</source>
        <year>1997</year>
        <volume>268</volume>
        <fpage>78</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1997.0951</pub-id>
        <pub-id pub-id-type="pmid">9149143</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Q-H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic analysis of human microRNA divergence based on evolutionary emergence</article-title>
        <source>FEBS Letters</source>
        <year>2011</year>
        <volume>585</volume>
        <fpage>240</fpage>
        <lpage>248</lpage>
        <pub-id pub-id-type="doi">10.1016/j.febslet.2010.11.053</pub-id>
        <pub-id pub-id-type="pmid">21130764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saçar Demirci</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Baumbach</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Allmer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>On the performance of pre-microRNA detection algorithms</article-title>
        <source>Nat. Commun.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>330</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-00403-z</pub-id>
        <pub-id pub-id-type="pmid">28839141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lestrade</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>snoRNA-LBME-db, a comprehensive database of human H/ACA and C/D box snoRNAs</article-title>
        <source>Nucleic Acids Research</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>D158</fpage>
        <lpage>D162</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkj002</pub-id>
        <pub-id pub-id-type="pmid">16381836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sno/scaRNAbase: a curated database for small nucleolar RNAs and cajal body-specific RNAs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D183</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkl873</pub-id>
        <pub-id pub-id-type="pmid">17099227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Makarova, J. A. &amp; Kramerov, D. A. SNOntology: Myriads of novel snornas or just a mirage? <italic>BMC Genomics</italic> vol. 12 (2011).</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alipanahi</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Delong</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weirauch</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Frey</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Predicting the sequence specificities of DNA- and RNA-binding proteins by deep learning</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>831</fpage>
        <lpage>838</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3300</pub-id>
        <pub-id pub-id-type="pmid">26213851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2018</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D754</fpage>
        <lpage>D761</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1098</pub-id>
        <pub-id pub-id-type="pmid">29155950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thurmond</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>FlyBase 2.0: the next generation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D759</fpage>
        <lpage>D765</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1003</pub-id>
        <pub-id pub-id-type="pmid">30364959</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Kozomara, A., Birgaoanu, M. &amp; Griffiths-Jones, S. miRBase: from microRNA sequences to function. <italic>Nucleic Acids Res</italic>. 10.1093/nar/gky1141 (2018).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karolchik</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UCSC Table Browser data retrieval tool</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>D493</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh103</pub-id>
        <pub-id pub-id-type="pmid">14681465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roden</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Novel determinants of mammalian primary microRNA processing revealed by systematic evaluation of hairpin-containing transcripts and human genetic variation</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>374</fpage>
        <lpage>384</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.208900.116</pub-id>
        <pub-id pub-id-type="pmid">28087842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Henry, V. J., Bandrowski, A. E., Pepin, A.-S., Gonzalez, B. J. &amp; Desfeux, A. OMICtools: an informative directory for multi-omic data analysis. <italic>Database</italic><bold>2014</bold> (2014).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gudyś</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Szcześniak</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Sikora</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Makałowska</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>HuntMi: an efficient and taxon-specific approach in pre-miRNA identification</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>83</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-83</pub-id>
        <pub-id pub-id-type="pmid">23497112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Batuwita</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Palade</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>microPred: effective classification of pre-miRNAs for human miRNA gene prediction</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>989</fpage>
        <lpage>995</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp107</pub-id>
        <pub-id pub-id-type="pmid">19233894</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MiPred: classification of real and pseudo microRNA precursors using random forest prediction model with combined features</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>W339</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkm368</pub-id>
        <pub-id pub-id-type="pmid">17553836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tran</surname>
            <given-names>VDT</given-names>
          </name>
          <name>
            <surname>Tempel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zerath</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zehraoui</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tahi</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>miRBoost: boosting support vector machines for microRNA precursor classification</article-title>
        <source>RNA</source>
        <year>2015</year>
        <volume>21</volume>
        <fpage>775</fpage>
        <lpage>785</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.043612.113</pub-id>
        <pub-id pub-id-type="pmid">25795417</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xue</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Classification of real and pseudo microRNA precursors using local structure-sequence features and support vector machine</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>310</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-310</pub-id>
        <pub-id pub-id-type="pmid">16381612</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hertel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>SnoReport: computational identification of snoRNAs with unknown targets</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>158</fpage>
        <lpage>164</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm464</pub-id>
        <pub-id pub-id-type="pmid">17895272</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
