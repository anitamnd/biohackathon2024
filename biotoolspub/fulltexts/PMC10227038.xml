<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Commun Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Commun Biol</journal-id>
    <journal-title-group>
      <journal-title>Communications Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2399-3642</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10227038</article-id>
    <article-id pub-id-type="pmid">37248282</article-id>
    <article-id pub-id-type="publisher-id">4927</article-id>
    <article-id pub-id-type="doi">10.1038/s42003-023-04927-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ImmuneBuilder: Deep-Learning models for predicting the structures of immune proteins</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8712-533X</contrib-id>
        <name>
          <surname>Abanades</surname>
          <given-names>Brennan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4029-6902</contrib-id>
        <name>
          <surname>Wong</surname>
          <given-names>Wing Ki</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boyles</surname>
          <given-names>Fergus</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Georges</surname>
          <given-names>Guy</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5052-0221</contrib-id>
        <name>
          <surname>Bujotzek</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1388-2252</contrib-id>
        <name>
          <surname>Deane</surname>
          <given-names>Charlotte M.</given-names>
        </name>
        <address>
          <email>deane@stats.ox.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4991.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8948</institution-id><institution>Department of Statistics, </institution><institution>University of Oxford, </institution></institution-wrap>Oxford, UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.424277.0</institution-id><institution>Large Molecule Research, Roche Pharma Research and Early Development, </institution><institution>Roche Innovation Center Munich, </institution></institution-wrap>Penzberg, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>6</volume>
    <elocation-id>575</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Immune receptor proteins play a key role in the immune system and have shown great promise as biotherapeutics. The structure of these proteins is critical for understanding their antigen binding properties. Here, we present ImmuneBuilder, a set of deep learning models trained to accurately predict the structure of antibodies (ABodyBuilder2), nanobodies (NanoBodyBuilder2) and T-Cell receptors (TCRBuilder2). We show that ImmuneBuilder generates structures with state of the art accuracy while being far faster than AlphaFold2. For example, on a benchmark of 34 recently solved antibodies, ABodyBuilder2 predicts CDR-H3 loops with an RMSD of 2.81Å, a 0.09Å improvement over AlphaFold-Multimer, while being over a hundred times faster. Similar results are also achieved for nanobodies, (NanoBodyBuilder2 predicts CDR-H3 loops with an average RMSD of 2.89Å, a 0.55Å improvement over AlphaFold2) and TCRs. By predicting an ensemble of structures, ImmuneBuilder also gives an error estimate for every residue in its final prediction. ImmuneBuilder is made freely available, both to download (<ext-link ext-link-type="uri" xlink:href="https://github.com/oxpig/ImmuneBuilder">https://github.com/oxpig/ImmuneBuilder</ext-link>) and to use via our webserver (<ext-link ext-link-type="uri" xlink:href="http://opig.stats.ox.ac.uk/webapps/newsabdab/sabpred">http://opig.stats.ox.ac.uk/webapps/newsabdab/sabpred</ext-link>). We also make available structural models for ~150 thousand non-redundant paired antibody sequences (10.5281/zenodo.7258553).</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">ImmuneBuilder is a set of deep learning models trained to predict the structure of antibodies, nanobodies, and T-Cell receptors with state-of-the-art accuracy while being much faster than AlphaFold2 and AlphaFoldMultimer.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational biophysics</kwd>
      <kwd>Adaptive immunity</kwd>
      <kwd>Protein structure predictions</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/501100000266</institution-id>
            <institution>RCUK | Engineering and Physical Sciences Research Council (EPSRC)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>EP/S024093/1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Deane</surname>
            <given-names>Charlotte M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100004337</institution-id>
            <institution>Roche (F. Hoffmann-La Roche Ltd)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">The adaptive immune system in humans is effective at identifying and neutralising a wide range of pathogens. To achieve this, immune cells have developed antigen-specific proteins such as T-cell receptors (TCRs) or, in the case of B-cells, antibodies. While antibodies are capable of binding with great affinity and specificity to the surface of almost any antigen, TCRs target digested pieces of intracellular proteins that are presented on the cell surface by the major histocompatibility complex. Due to their key role in identifying a wide range of antigens, antibodies and TCRs have become proteins of particular interest for therapeutic development, with several TCR drugs in clinical trials<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> and over a hundred approved antibody drugs<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup>. Nanobodies, single-domain antibodies naturally found in organisms such as camelids and sharks, have also received significant interest as therapeutics, with a recently accepted nanobody drug and a number undergoing clinical trials<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>.</p>
    <p id="Par4">All three of these immune proteins are built up from immunoglobulin (Ig) domains with the binding site either sitting across two Ig domains in the case of antibodies (VH and VL) and TCRs (V<italic>α</italic> and V<italic>β</italic>), or being found at the tip of one Ig domain, in the case of nanobodies.</p>
    <p id="Par5">The binding site of antibodies and TCRs is concentrated in six loops, three on each of the two Ig domains known collectively as the complementarity-determining regions (CDRs). In nanobodies, the binding site is concentrated in only three CDR loops on its single Ig domain. These CDR loops show variable length, composition and structure with the most variable being CDR-H3 in the case of antibodies and nanobodies<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>. This loop also tends to be the largest contributor to the binding site<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. An example of the structure of an antibody variable domain, a TCR variable domain and a nanobody are shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><title>Structural representation of an antibody variable domain (PDB code 1GIG), a TCR variable domain (PDB code 7SU9) and a nanobody (PDB code 4LAJ) with labelled regions.</title><p>The heavy and beta chains are shown in green while the light and alpha chains are blue. As these structures show, antibodies and TCRs are structurally similar and the nanobody is also similar to an individual chain of an antibody or TCR. However, their CDR loops occupy distinct areas of structural space.</p></caption><graphic xlink:href="42003_2023_4927_Fig1_HTML" id="d32e317"/></fig></p>
    <p id="Par6">Despite the similarities in the global structure of antibodies, TCRs and nanobodies, their binding sites are known to have distinct properties and their CDRs have different length distributions as well as occupying distinct areas of structural space<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup>.</p>
    <p id="Par7">As with many proteins, the availability of sequence data far outstrips structural information<sup><xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR13">13</xref></sup>, but structural information allows for a more in-depth understanding than studies focused on sequence alone<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. For example, knowledge of CDR loop conformations has been used to help identify antibodies that bind to similar targets<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, while accurate knowledge of side chain atom placement can aid in identifying key interactions in antibody-antigen binding<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>.</p>
    <p id="Par8">Experimental structure determination is time-consuming and expensive<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. Computationally predicted structural models can be used to circumvent this problem. This is particularly the case for immune proteins, as next-generation sequencing of immune receptor repertories is now routinely used in the study of the adaptive immune system<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>. These methods enable researchers to obtain millions of sequences per study, making structural analysis of this data a challenge. For example, Observed Antibody Space (OAS) contains over two billion antibody heavy chain sequences and is growing rapidly<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>. If this huge amount of sequence data is to even partially be analysed in terms of structure, rapid accurate methods for the prediction of antibody structures are required.</p>
    <p id="Par9">AlphaFold2 is a deep learning method that has revolutionised the field of computational protein structure prediction, achieving near experimental accuracy for a large number of single-chain proteins<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. This was then extended to AlphaFold-Multimer to accurately predict protein complexes<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Many methods have followed from AlphaFold2 and AlphaFold-Multimer but these remain the de facto gold standard for single domains and complexes<sup><xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref></sup>.</p>
    <p id="Par10">The AlphaFold2 model can be divided into two main steps: In the first step, the Evoformer module is used to extract evolutionary couplings from alignments of many protein sequences into information-rich embeddings. It then uses these embeddings in the structure module to predict the 3D structure of a given protein sequence.</p>
    <p id="Par11">Structure prediction methods specific to a certain class of protein tend to outperform more general methods<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>. By using knowledge specific to a type of protein, they can easily predict the conserved regions in that protein allowing greater focus on harder details. For example, DeepH3 was shown to outperform TrRosetta on antibodies<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>, while Nanonet obtains results of similar accuracy to AlphaFold2 on nanobodies with a far simpler architecture<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>. More recent examples of this are IgFold<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> and EquiFold<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, where the authors trained antibody-specific models that predict structures of comparable accuracy to AlphaFold-Multimer.</p>
    <p id="Par12">In this paper, we present ImmuneBuilder, a set of deep learning models developed to predict the structure of proteins of the immune system. By training on specific protein types, we are able to create rapid accurate models, enabling ImmuneBuilder to be routinely used on large sequence data sets. We have built three models, ABodyBuilder2, an antibody-specific model, NanoBodyBuilder2, a nanobody-specific model and TCRBuilder2 a TCR-specific model. We show that these methods perform at least as well as state-of-the-art methods for their respective protein types while predicting structures in a fraction of the time. We also demonstrate that these methods both accurately predict details of the structure and create physically and biologically sensible structures.</p>
    <p id="Par13">The three ImmuneBuilder models are made freely available for download and as web servers.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <p id="Par14">Throughout the results section we will focus on the results for ABodyBuilder2 (AB2) on antibodies with the results for NanoBodyBuilder2 (nanobodies) and TCRBuilder2 (TCRs) discussed in Supplementary Notes <xref rid="MOESM2" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref>. All three methods show qualitatively similar results.</p>
    <p id="Par15">We compare ABodyBuilder2 to several other methods. These methods are a homology modelling method (the original version of ABodyBuilder<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> (ABB)), one general protein structure prediction method (AlphaFold-Multimer<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> (AFM)), and three antibody-specific methods (ABlooper<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> (ABL), IgFold<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> (IgF) and EquiFold<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> (EqF)). As a benchmark, we selected a non-redundant set of 34 antibody structures recently added to SAbDAb<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup> (see methods). This was done so none of the antibody structures in the benchmark would have been seen during training for any of the benchmarked methods. To give a complete picture of how these methods perform, we carryout a comprehensive benchmark using five different measures. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows an example of a prediction by ABodyBuilder2, highlighting important aspects of structural modelling.<fig id="Fig2"><label>Fig. 2</label><caption><title>Example of an antibody structure predicted with ABodyBuilder2.</title><p>The heavy chain is shown in green, the light chain in blue and the crystal structure in white. The figure on the left shows the overall Fv structure, demonstrating how ABodyBuilder2 accurately predicts the relative orientation between the heavy and light chain. The figures on the right focus on the structure of CDR loops. The top image showcases the accuracy of ABodyBuilder2 at modelling side chain atoms and the bottom image shows its accuracy at predicting the backbone of CDR loops.</p></caption><graphic xlink:href="42003_2023_4927_Fig2_HTML" id="d32e477"/></fig></p>
    <sec id="Sec3">
      <title>Accuracy of prediction</title>
      <p id="Par16">To measure how accurately the backbone atoms are predicted, the RMSD between predicted and true structures for each antibody region was compared. The RMSD for each CDR and framework is computed by aligning each protein chain to the crystal structure and then calculating the RMSD between the C<sub><italic>α</italic></sub>, N, C and C<sub><italic>β</italic></sub> atoms. Regions are defined using the IMGT numbering scheme<sup><xref ref-type="bibr" rid="CR34">34</xref></sup>. The results of this analysis are shown in Table <xref rid="Tab1" ref-type="table">1</xref>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison between ABodyBuilder, ABlooper, IgFold, EquiFold, AlphaFold-Multimer and ABodyBuilder2 at predicting the backbone atoms for each antibody chain.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Method</th><th>CDR-H1</th><th>CDR-H2</th><th>CDR-H3</th><th>Fw-H</th><th>CDR-L1</th><th>CDR-L2</th><th>CDR-L3</th><th>Fw-L</th></tr></thead><tbody><tr><td>ABodyBuilder (ABB)</td><td>1.53</td><td>1.09</td><td>3.46</td><td>0.65</td><td>0.71</td><td>0.55</td><td>1.18</td><td>0.59</td></tr><tr><td>ABlooper (ABL)</td><td>1.18</td><td>0.96</td><td>3.34</td><td>0.63</td><td>0.78</td><td>0.63</td><td>1.08</td><td>0.61</td></tr><tr><td>IgFold (IgF)</td><td>0.86</td><td>0.77</td><td>3.28</td><td>0.58</td><td>0.55</td><td>0.43</td><td>1.12</td><td>0.60</td></tr><tr><td>EquiFold (EqF)</td><td>0.86</td><td>0.80</td><td>3.29</td><td>0.56</td><td>0.47</td><td>0.41</td><td>0.93</td><td><bold>0.54</bold></td></tr><tr><td>AlphaFold-M (AFM)</td><td>0.86</td><td><bold>0.68</bold></td><td>2.90</td><td>0.55</td><td>0.47</td><td><bold>0.40</bold></td><td><bold>0.83</bold></td><td><bold>0.54</bold></td></tr><tr><td>ABodyBuilder2 (AB2)</td><td><bold>0.85</bold></td><td>0.78</td><td><bold>2.81</bold></td><td><bold>0.54</bold></td><td><bold>0.46</bold></td><td>0.44</td><td>0.87</td><td>0.57</td></tr></tbody></table><table-wrap-foot><p>The mean RMSD to the crystal structure across the test set for each of the six CDRs and framework (Fw) is shown. RMSDs are given in Angstroms (Å). The best-performing method for each metric is highlighted in bold. The individual RMSDs for each method for each CDR are given in Supplementary Data <xref rid="MOESM4" ref-type="media">1</xref>.</p></table-wrap-foot></table-wrap></p>
      <p id="Par17">The experimental error in protein structures generated via X-ray crystallography has been estimated to be around 0.6Å for regions with organised secondary structures (such as the antibody frameworks) and around 1Å for protein loops<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>. On average, the predicted structures for most of the antibody regions using any method have errors within the range of what would be expected from experimentally resolved crystal structures. The exception to this is CDR-H3, where all methods make the worst predictions.</p>
      <p id="Par18">ABodyBuilder2 and AlphaFold-Multimer are the most accurate methods at predicting the structure of CDR-H3 (RMSD of 2.81 Å and 2.90 Å, respectively). EquiFold, IgFold and ABlooper generate structures with CDR-H3 loops around 10% less accurate than ABodyBuilder2 and AlphaFold-Multimer. The worst method for predicting CDR-H3 loops is the original version of ABodyBuilder, showcasing how deep learning has improved our ability to model. Supplementary Note <xref rid="MOESM2" ref-type="media">4</xref> explores how the accuracy of ABodyBuilder2 for CDR-H3 prediction correlates to the maximum sequence identity in the training set. A comparison of the CDR-H3 RMSD for each individual structure in the test set between each pair of methods is shown in Supplementary Fig. <xref rid="MOESM2" ref-type="media">4</xref>.</p>
      <p id="Par19">Tables <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref> show how accurate TCRBuilder2 and NanoBodyBuilder2 are at predicting the position of atoms in the backbone. We compare them to homology modelling methods (RepertoireBuilder<sup><xref ref-type="bibr" rid="CR36">36</xref></sup> and TCRBuilder<sup><xref ref-type="bibr" rid="CR26">26</xref></sup> for TCR modelling, and MOE<sup><xref ref-type="bibr" rid="CR37">37</xref></sup> and ABodyBuilder<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> for nanobody modelling) and machine learning methods AlphaFold-Multimer<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> for TCRs and AlphaFold2<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> for nanobodies. Supplementary Fig. <xref rid="MOESM2" ref-type="media">1</xref> provides a visual representation of the potential differences in the predicted conformation of the CDR-H3 region using NanoBodyBuilder2 and ABodyBuilder2, even when they correspond to the same sequence. Full results for TCRBuilder2 and NanoBodyBuilder2 and details on their respective test sets are given in Supplementary Notes <xref rid="MOESM2" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison between TCRBuilder, RepertoireBuilder, AlphaFold-Multimer, ABodyBuilder2 and TCRBuilder2 at predicting the backbone atoms for each TCR chain.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Method</th><th>CDR-α1</th><th>CDR-α2</th><th>CDR-α3</th><th>Fw-α</th><th>CDR-β1</th><th>CDR-β2</th><th>CDR-β3</th><th>Fw-β</th></tr></thead><tbody><tr><td>TCRBuilder</td><td>1.60</td><td>1.31</td><td>2.89</td><td>0.87</td><td>0.99</td><td>0.90</td><td>3.12</td><td>0.81</td></tr><tr><td>RepertoireBuilder</td><td>1.35</td><td>1.00</td><td>2.64</td><td>0.75</td><td>0.86</td><td>1.59</td><td>2.77</td><td>1.05</td></tr><tr><td>AlphaFold-M</td><td><bold>1.25</bold></td><td>0.96</td><td><bold>1.84</bold></td><td><bold>0.69</bold></td><td>0.75</td><td>0.65</td><td>1.94</td><td>0.82</td></tr><tr><td>ABodyBuilder2</td><td>3.49</td><td>6.57</td><td>3.14</td><td>2.89</td><td>3.27</td><td>3.77</td><td>3.48</td><td>3.65</td></tr><tr><td>TCRBuilder2</td><td>1.34</td><td><bold>0.93</bold></td><td>1.85</td><td>0.90</td><td><bold>0.74</bold></td><td><bold>0.63</bold></td><td><bold>1.93</bold></td><td><bold>0.67</bold></td></tr></tbody></table><table-wrap-foot><p>The mean RMSD to the crystal structure across the TCR test set for each of the six CDRs and framework (Fw) is shown. RMSDs are given in Angstroms (Å). The best-performing method for each metric is highlighted in bold. The individual RMSDs for each method for each CDR are given in Supplementary Data <xref rid="MOESM5" ref-type="media">2</xref>.</p></table-wrap-foot></table-wrap><table-wrap id="Tab3"><label>Table 3</label><caption><p>Comparison between ABodyBuilder, MOE, AlphaFold2 and NanoBodyBuilder2 at predicting the backbone atoms of nanobodies.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Method</th><th>CDR1</th><th>CDR2</th><th>CDR3</th><th>Fw</th></tr></thead><tbody><tr><td>ABodyBuilder</td><td>2.96</td><td>2.08</td><td>5.08</td><td>1.09</td></tr><tr><td>MOE</td><td>2.67</td><td>1.99</td><td>4.90</td><td>1.19</td></tr><tr><td>AlphaFold2</td><td>2.08</td><td><bold>1.35</bold></td><td>3.44</td><td>0.82</td></tr><tr><td>NanoBodyBuilder2</td><td><bold>1.98</bold></td><td>1.37</td><td><bold>2.89</bold></td><td><bold>0.79</bold></td></tr></tbody></table><table-wrap-foot><p>The mean RMSD to the crystal structure across the nanobody test set for each of the three CDRs and framework (Fw) is shown. RMSDs are given in Angstroms (Å). The best-performing method for each metric is highlighted in bold. The individual RMSDs for each method for each CDR are given in Supplementary Data <xref rid="MOESM6" ref-type="media">3</xref>.</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec4">
      <title>Heavy and light chain packing</title>
      <p id="Par20">As described in the introduction, in antibodies the binding site sits across the heavy and light chain variable regions (VH and VL). With half of the CDRs on each chain, the relative VH-VL orientation can have an impact on the structure of the binding site.</p>
      <p id="Par21">To quantify how accurate each method is at predicting the relative orientation between chains, in Table <xref rid="Tab4" ref-type="table">4</xref> we show the average absolute error in the five angles (Hl, HC1, HC2, LC1, LC2) and distance (dc) that fully characterise VH-VL orientation<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. A brief description of how these values are defined is given in Supplementary Note <xref rid="MOESM2" ref-type="media">3</xref>, for a more complete description see ref. <sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. The results for TCR domains are given in Supplementary Table <xref rid="MOESM2" ref-type="media">2</xref>.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Comparison of VH-VL orientation between ABodyBuilder (ABB), ABlooper (ABL), IgFold (IgF), EquiFold (EqF), AlphaFold-Multimer (AFM) and ABodyBuilder2 (AB2).</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Method</th><th>HL</th><th>HC1</th><th>LC1</th><th>HC2</th><th>LC2</th><th>dc</th></tr></thead><tbody><tr><td>Xtal</td><td>1.18</td><td>0.48</td><td>0.75</td><td>0.62</td><td>0.80</td><td>0.11</td></tr><tr><td>ABB</td><td>0.83</td><td>1.09</td><td>0.82</td><td>1.81</td><td>0.90</td><td><bold>0.10</bold></td></tr><tr><td>ABL</td><td>0.80</td><td>0.97</td><td>0.83</td><td>1.70</td><td>0.90</td><td>0.12</td></tr><tr><td>IgF</td><td><bold>0.63</bold></td><td>0.91</td><td>0.71</td><td>1.40</td><td>0.74</td><td>0.14</td></tr><tr><td>EqF</td><td>0.64</td><td>0.98</td><td><bold>0.64</bold></td><td>1.68</td><td>0.72</td><td>0.11</td></tr><tr><td>AFM</td><td>0.67</td><td><bold>0.74</bold></td><td>0.69</td><td>1.45</td><td>0.63</td><td>0.11</td></tr><tr><td>AB2</td><td>0.64</td><td>0.90</td><td>0.66</td><td><bold>1.37</bold></td><td><bold>0.61</bold></td><td>0.12</td></tr></tbody></table><table-wrap-foot><p>Values shown were calculated using ABangle<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. HL, HC1, LC1, HC2, LC2 and dc are defined in Supplementary Fig. <xref rid="MOESM2" ref-type="media">2</xref> and ref. <sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. The error in the angles HL, HC1, LC1, HC2 and LC2 is shown in degrees with the error in the distance dc given in Angstroms (Å). The average standard deviation observed in antibodies experimentally resolved over five times is shown for comparison (Xtal). The best-performing method for each metric is highlighted in bold.</p></table-wrap-foot></table-wrap></p>
      <p id="Par22">As an upper bound for the accuracy of predicted structures, the average standard deviation of the VH-VL orientation measurements in 55 antibodies with structures resolved over five times is shown in Table <xref rid="Tab4" ref-type="table">4</xref>. In the original study<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, the vector dc was chosen as an axis as it was found to be the most conserved amongst antibody structures. All of the benchmarked methods predict this distance with very high accuracy. All methods are also accurate at predicting the angles, with small errors with respect to what is observed in experiments. However, small deviations in these angles will still have an impact on the structure of the binding site. ABodyBuilder2 is on average the most accurate method at heavy and light chain packing by a small margin.</p>
    </sec>
    <sec id="Sec5">
      <title>Side chain and chemical surface accuracy</title>
      <p id="Par23">During binding, an antigen will mostly form interactions via side chain atoms on the surface. Therefore to be able to study antigen binding, predicted antibody structures must accurately model the position of side chain atoms and whether they are exposed on the surface or buried. To benchmark the accuracy of side-chain modelling we use a method similar to ref. <sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, where a side-chain torsion angle is considered correct if it is within 40 degrees of the true conformation. The original implementation of ABodyBuilder will occasionally fail to predict a side chain, this is treated as an incorrect prediction. A residue is labelled as buried if its relative solvent accessibility (calculated as described in ref. <sup><xref ref-type="bibr" rid="CR40">40</xref></sup>) is below 7.5%. The results of this analysis are given in Table <xref rid="Tab5" ref-type="table">5</xref> for ABodyBuilder2 and in Supplementary Tables <xref rid="MOESM2" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref> for Nanobodies and TCRs respectively.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Comparison of surface accuracy for ABodyBuilder (ABB), ABlooper (ABL), IgFold (IgF), EquiFold (EqF), AlphaFold-Multimer (AFM) and ABodyBuilder2 (AB2).</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Method</th><th><italic>χ</italic>1</th><th><italic>χ</italic>2</th><th><italic>χ</italic>3</th><th><italic>χ</italic> 4</th><th>E/B</th></tr></thead><tbody><tr><td>ABB</td><td>0.81</td><td>0.77</td><td><bold>0.63</bold></td><td>0.56</td><td>0.92</td></tr><tr><td>ABL</td><td>0.75</td><td>0.70</td><td>0.60</td><td>0.53</td><td>0.90</td></tr><tr><td>IgF</td><td>0.77</td><td>0.66</td><td>0.54</td><td>0.52</td><td>0.91</td></tr><tr><td>EqF</td><td>0.84</td><td>0.71</td><td>0.61</td><td>0.55</td><td><bold>0.94</bold></td></tr><tr><td>AFM</td><td><bold>0.85</bold></td><td>0.77</td><td>0.59</td><td><bold>0.58</bold></td><td>0.91</td></tr><tr><td>AB2</td><td><bold>0.85</bold></td><td><bold>0.78</bold></td><td><bold>0.63</bold></td><td>0.52</td><td>0.91</td></tr></tbody></table><table-wrap-foot><p>Values shown are percentages representing the accuracy when modelling each of the first four torsion angles of the side chain (<italic>χ</italic>) if they exist. E/B gives the accuracy at predicting whether a residue is exposed or buried. The best-performing method for each metric is highlighted in bold.</p></table-wrap-foot></table-wrap></p>
      <p id="Par24">As ABlooper and IgFold are deep learning methods that only predict the backbone (leaving side chain prediction to OpenMM<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> and Rosetta<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, respectively), it is perhaps not surprising that they are the least accurate at modelling the chemical surface. EquiFold, AlphaFold-Multimer and ABodyBuilder2, all of which output all-atom structures, predict the <italic>χ</italic>1 and <italic>χ</italic>2 side chain atoms with high accuracy while struggling to model longer side chains. The original implementation of ABodyBuilder predicts side chains with comparable accuracy to AlphaFold-Multimer and ABodyBuilder2. All methods are highly accurate at predicting whether a residue is exposed or buried, EquiFold is the most accurate.</p>
    </sec>
    <sec id="Sec6">
      <title>Physical plausibility and accurate stereochemistry</title>
      <p id="Par25">Although deep learning models are trained on crystal structures, they will occasionally predict conformations that are very rare or do not occur in nature. We next check for the presence of steric clashes, cis-peptide bonds, D-amino acids, or bonds with nonphysical lengths in the models generated by each method. For bond lengths, only the peptide bond is checked as all other bond lengths are fixed to their literature value in all benchmarked methods but ABlooper and EquiFold.</p>
      <p id="Par26">ABodyBuilder2 and AlphaFold-Multimer both generate structures of comparable quality to experimentally resolved ones, whereas IgFold appears to generate a number of cis-peptide bonds and clashes even after being refined with Rosetta<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. EquiFold does not use an energy-based method to refine its predicted structures and hence all of the structures it generates are unphysical. This shows that a refinement step is still necessary to ensure structures generated by deep learning-based methods are realistic (Table <xref rid="Tab6" ref-type="table">6</xref>).<table-wrap id="Tab6"><label>Table 6</label><caption><p>Quality check for models generated using ABodyBuilder (ABB), ABlooper (ABL), IgFold (IgF), EquiFold (EqF), AlphaFold-Multimer (AFM) and ABodyBuilder2 (AB2).</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Method</th><th>Peptide bond</th><th>D-amino acid</th><th>Cis-bond</th><th>Clash</th></tr></thead><tbody><tr><td>Xtal</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>ABB</td><td>19</td><td>0</td><td>3</td><td>9</td></tr><tr><td>ABL*</td><td>1</td><td>0</td><td>1</td><td>1</td></tr><tr><td>IgF</td><td>0</td><td>0</td><td>51</td><td>10</td></tr><tr><td>EqF</td><td>271</td><td>4</td><td>2</td><td>765</td></tr><tr><td>AFM</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>AB2</td><td>0</td><td>0</td><td>0</td><td>0</td></tr></tbody></table><table-wrap-foot><p>The errors observed in experimentally resolved crystal structures (Xtal) are also shown for comparison. A peptide bond length is considered to be incorrect if it is more than 0.1 Å away from its literature value. Peptide bonds including a proline were not included in the calculation of cis-isomers. Two non-bonded heavy atoms are considered to be clashing when they are closer than 0.63 times their Van-der-Waals radius<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. (*) Calculated using the latest version of ABlooper, updated since publication to reduce the number of D-amino acids and cis-isomers.</p></table-wrap-foot></table-wrap></p>
      <p id="Par27">The results for TCRs and nanobodies are shown in Supplementary Tables <xref rid="MOESM2" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref>, respectively.</p>
    </sec>
    <sec id="Sec7">
      <title>Computational cost</title>
      <p id="Par28">The original version of AlphaFold-Multimer is by far the most computationally expensive of the benchmarked methods. It requires over one terabyte of sequence data and takes around three hours to generate one structure when run on five CPUs. Large speed-ups can be obtained by reducing the size of the sequence database, using faster sequence alignment algorithms, or using GPUs<sup><xref ref-type="bibr" rid="CR43">43</xref>,<xref ref-type="bibr" rid="CR44">44</xref></sup>. Even with these modifications, it takes around thirty minutes on a GPU to generate a single structure. All other methods benchmarked can be run on five CPUs in under a minute, with the fastest being EquiFold due to its lack of a refinement step. This makes them all well suited for high throughput structural modelling of next-generation sequencing data. ABodyBuilder2 can also be sped up significantly by using a GPU taking around five seconds to generate an antibody structure on a Tesla P100.</p>
    </sec>
    <sec id="Sec8">
      <title>Error estimation</title>
      <p id="Par29">ABodyBuilder2 predicts four structures for each antibody. We found that the diversity between predictions, as in ABlooper, can be used to estimate the uncertainty in the final prediction. If the structures predicted by all four models disagree in a region then the final prediction for this region is likely to be incorrect. This allows ABodyBuilder2 to give a confidence score for each residue that can be used to filter for incorrectly modelled structures. In Fig. <xref rid="Fig3" ref-type="fig">3</xref> we show how the root mean squared predicted error for CDR-H3 residues correlates with CDR-H3 RMSD.<fig id="Fig3"><label>Fig. 3</label><caption><title>Scatter plot showing the CDR-H3 RMSD against the root mean squared predicted error for all structures in the benchmark.</title><p>The line shown is the best fit with the 95% confidence interval shown as the shaded area around it. The data used to generate this plot is given in Supplementary Data <xref rid="MOESM7" ref-type="media">4</xref>.</p></caption><graphic xlink:href="42003_2023_4927_Fig3_HTML" id="d32e1752"/></fig></p>
      <p id="Par30">A low predicted error does not necessarily indicate an accurate structure. However, a high predicted error works as a good filter for removing inaccurate models. For example, if a predicted error cut-off of around 1 Å is set for the current benchmark, it would remove five structures with an average RMSD of 4.46 Å. The average CDR-H3 RMSD for the remaining set would then be 2.53 Å.</p>
    </sec>
  </sec>
  <sec id="Sec9" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par31">We present ImmuneBuilder, a set of three open-source and freely available tools for modelling immune proteins capable of rapidly generating accurate antibody, TCR, and nanobody structures. ImmuneBuilder can produce structures of antibodies and TCRs with accuracy comparable to AlphaFold-Multimer while being over a hundred times faster and without the need for large sequence databases or multiple sequence alignments. ABodyBuilder2 is shown to be the most accurate of the antibody-specific tools and the only one to consistently predict structures with correct stereochemistry.</p>
    <p id="Par32">The comparison with homology modelling methods, such as ABodyBuilder, shows the benefits that deep learning has brought to the field of antibody structure prediction. However, all methods still struggle to accurately predict the conformation of CDR-H3, suggesting that models capable of predicting multiple conformations may be required to accurately capture this loop. Deep learning methods also still struggle to consistently predict physically plausible structures. This challenge can be addressed by using physics-based methods, such as restrained energy minimisation, but for fast methods like ABodyBuilder2 this greatly increases computational cost.</p>
    <p id="Par33">By measuring the variability between predictions, ImmuneBuilder is able to provide an error estimate for each residue. In combination with its prediction speed and accuracy, the ability to filter for incorrect models makes it a useful tool for incorporating structural information into data from next-generation sequencing experiments.</p>
    <p id="Par34">To further demonstrate the usefulness of ImmuneBuilder, we predicted the structure of around 148 thousand non-redundant paired antibody sequences from OAS<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> and make these freely available at (10.5281/zenodo.7258553).</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <p id="Par35">In the methods section we describe in detail the data and models for creating ABodyBuilder2. An overview of the steps used to predict an antibody structure with ABodyBuilder2 is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Details for NanoBodyBuilder2 and TCRBuilder2 are given in Supplementary Notes <xref rid="MOESM2" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><title>Pipeline used to predict structures by ABodyBuilder2.</title><p>First, the heavy and light chain sequences are fed into four separate deep-learning models to predict an ensemble of structures. The closest structure to the average is then selected and refined using OpenMM<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> to remove clashes and other stereo-chemical errors. The same pipeline is used for NanoBodyBuilder2 and TCRBuilder2.</p></caption><graphic xlink:href="42003_2023_4927_Fig4_HTML" id="d32e1803"/></fig></p>
    <sec id="Sec11">
      <title>Data</title>
      <p id="Par36">The data used to train, test, and validate ABodyBuilder2 was extracted from SAbDab<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, a database containing all antibody structures in the PDB<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>. The training data was extracted on the 31st of July 2021 resulting in a total of 7084 structures. Filters were used to ensure structures in the training data had both the VH and VL chains, were not missing residues other than at the start and end of the chain, and had a resolution of 3.5 Å or better. Structures with the same amino acid sequence were kept in the training data to expose the model to antibodies with multiple conformations. As a validation set, we used the set of 49 antibodies in the Rosetta Antibody Benchmark. Structures with the same sequence as antibodies in the validation set were removed from the training set.</p>
      <p id="Par37">For the test data, we extracted all PDB files containing antibody Fv structures in SAbDab added between the 1st of August 2021 and the 1st of June 2022. Only crystal structures resolved by X-ray diffraction and with a resolution better than 2.3 Å were kept. A set of non-redundant Fvs were then selected from these and further filtered to remove antibodies with CDR-H3s longer than 22 amino acids and structures with missing residues. Finally, it was ensured that there were no structures with the same sequence in the test, training, and validation sets. This resulted in the set of 34 Fvs that was used to benchmark ABodyBuilder2 against other methods. A comparison of the maximum sequence identity to the training set against CDR-H3 RMSD for each Fv in the test set is shown in Supplementary Fig. <xref rid="MOESM2" ref-type="media">3</xref>. A full list of PDB codes for structures used in the training, validation and test set is given at <ext-link ext-link-type="uri" xlink:href="https://github.com/oxpig/ImmuneBuilder">https://github.com/oxpig/ImmuneBuilder</ext-link>.</p>
    </sec>
    <sec id="Sec12">
      <title>Deep learning architecture</title>
      <p id="Par38">The architecture of the deep learning model behind ABodyBuilder2 is an antibody-specific version of the structure module in AlphaFold-Multimer with several modifications. Residues are treated as rigid bodies, each one defined by a 3D point in space and a matrix representing its orientation. The input node features are a one-hot encoded representation of the sequence and the input edge features are relative positional encodings. At the start, all residues are set at the origin with the same orientation.</p>
      <p id="Par39">The model is composed of eight update blocks that run sequentially. At every iteration, the node features are first updated in a structurally aware way using the Invariant Point Attention layer, and then residue coordinates and orientations are updated using the Backbone Update layer. For further details on how these layers work, see the original AlphaFold2 paper<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. Finally, torsion angles for each residue are predicted from node features and are then used to reconstruct an all-atom structure using hard-coded rules. Unlike AlphaFold-Multimer, all blocks have their own weights.</p>
      <p id="Par40">The main term in the loss function is the Frame Aligned Point Error (FAPE) loss, which quantifies how structurally similar the true and predicted structures are in the local reference frame of each residue. For details see ref. <sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. In AlphaFold2, the FAPE loss is clamped at 10 Å focusing on correctly placing residues relative to those closest to it. Similar to AlphaFold-Multimer, a modified version of FAPE loss is used for ABodyBuilder2 in which more focus is given to correctly placing CDR residues relative to the framework. This is achieved by clamping the FAPE loss at 30 Å when it is calculated between framework and CDR residues and at 10 Å otherwise. The final loss term is a sum of the average backbone FAPE loss after every backbone update and the full atom FAPE loss from the final structure.</p>
      <p id="Par41">As is done in AlphaFold2, a structural violation term is added to the loss function. This penalises nonphysical conformations with a term for bond angles, bond distances, and clashing heavy atoms. In our models, this term was reduced by an order of magnitude with respect to AlphaFold2 as this was found to slightly improve prediction accuracy without significantly harming the physicality of the final prediction. Finally, the side-chain and backbone torsion angle loss from AlphaFold2 is also used.</p>
      <p id="Par42">Each model was trained in two stages. In the first stage, the structural violations term of the loss function was set to zero and a dropout of 10% was used. The RAdam optimiser<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> was used with a cosine annealing scheduler with warm restarts every 50 epochs, learning rates between 1e-3 and 1e-4, and a weight decay of 1e-3. For the second stage, the structural violations loss is added and dropout is set to zero. RAdam is also used for this stage with a fixed learning rate of 1e-4 and weight decay of 1e-3. To aid with stability, the norm of gradients is clipped to a value of 0.1 in the second stage of training. For both stages, a batch size of 64 is used and training is stopped if there was no improvement in the validation set after 100 epochs. On average, training took around four weeks for each model on a single GPU.</p>
    </sec>
    <sec id="Sec13">
      <title>Model selection</title>
      <p id="Par43">ABodyBuilder2 is composed of four deep-learning models trained independently to predict antibody structures. To select the best prediction, we align all predicted structures and choose as the final prediction the closest one to the average. This reduces the method’s sensitivity to small fluctuations in the training set. It also results in a small improvement in prediction accuracy.</p>
    </sec>
    <sec id="Sec14">
      <title>Structural refinement</title>
      <p id="Par44">Although the models are encouraged to predict physically plausible structures during training, they will occasionally produce structures with steric clashes, incorrect peptide bond lengths, or cis-peptide bonds. A restrained energy minimisation procedure with OpenMM is used to resolve these issues. The AMBER14 protein force field<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> with an added harmonic force term to keep the heavy atoms of the backbone close to their original positions is used. In the rare case when two side chain atoms are predicted by the model to be within 0.2 Å of each other, the clashing side chains are deleted and remodelled using pdbfixer<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. AMBER14 does not explicitly consider chirality, so when the predicted structure contains peptide bonds in the cis configuration, an additional force is added to flip their torsion angles into the trans configuration.</p>
      <p id="Par45">By design, the ABodyBuilder2 deep learning model will always generate amino acids in their L-stereoisomeric form. However, it was found that during energy minimisation residues are occasionally flipped into their D-stereoisomer. To fix this, a method similar to that in ref. <sup><xref ref-type="bibr" rid="CR48">48</xref></sup> is used. First, the chirality at the carbon alpha centre of each D-stereoisomeric residue is fixed by flipping the hydrogen atom. The structure is then relaxed keeping the flipped hydrogen atoms in place before a final minimisation.</p>
    </sec>
    <sec id="Sec15">
      <title>Benchmarked methods</title>
      <p id="Par46">We compared ABodyBuilder2 to five other methods: AlphaFold-Multimer, EquiFold, IgFold, the original version of ABodyBuilder and ABlooper. AlphaFold-Multimer was run using the freely available version of code<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. It was run using the weights from version 2.2 and without the use of templates. The effect of templates on antibody structure prediction is shown in Supplementary Table <xref rid="MOESM2" ref-type="media">3</xref>. This generated 25 structures per antibody out of which the top-ranked was selected for the benchmark. The public version of their respective code bases (as of December 15th) was used to generate EquiFold<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> and IgFold<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> models. As in their paper, Rosetta<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> is used to minimise IgFold models. The original version of ABodyBuilder<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> was run by using the SAbBox Singularity container (<ext-link ext-link-type="uri" xlink:href="https://process.innovation.ox.ac.uk/software/p/20120-a/sabbox-singularity-platform—academic-use/1">https://process.innovation.ox.ac.uk/software/p/20120-a/sabbox-singularity-platform—academic-use/1</ext-link>) from July 2022 excluding all templates with a sequence identity of 99% or higher. ABlooper<sup><xref ref-type="bibr" rid="CR33">33</xref></sup> (version 1.1.2) was run to remodel the CDR loops from the ABodyBuilder predictions. Structures generated by all methods were numbered using ANARCI<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>.</p>
    </sec>
    <sec id="Sec16">
      <title>Reporting summary</title>
      <p id="Par47">Further information on research design is available in the <xref rid="MOESM8" ref-type="media">Nature Portfolio Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="42003_2023_4927_MOESM1_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="42003_2023_4927_MOESM2_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="42003_2023_4927_MOESM3_ESM.pdf">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="42003_2023_4927_MOESM4_ESM.xlsx">
            <caption>
              <p>Supplementary Data 1</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="42003_2023_4927_MOESM5_ESM.xlsx">
            <caption>
              <p>Supplementary Data 2</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="42003_2023_4927_MOESM6_ESM.xlsx">
            <caption>
              <p>Supplementary Data 3</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="42003_2023_4927_MOESM7_ESM.xlsx">
            <caption>
              <p>Supplementary Data 4</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="42003_2023_4927_MOESM8_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s42003-023-04927-7.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work was funded by the Engineering and Physical Sciences Research Council (EPSRC) with grant number EP/S024093/1 and Roche.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>B.A. and C.M.D. conceived the project and designed the study with input from all authors. B.A. designed and implemented the deep learning model. B.A. and W.K.W. ran ablation studies to optimise the model architecture and training procedure. B.A. trained the final models and implemented the final version of the code. B.A. compared ImmuneBuilder against other methods and compiled the results. F.B. made a web-server to run the model and visualise predictions. B.A. and C.M.D. wrote the manuscript with input from all authors. C.M.D., W.K.W., G.G., and A.B. supervised the project.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par48"><italic>Communications Biology</italic> thanks the anonymous reviewers for their contribution to the peer review of this work. Primary Handling Editors: Zhijuan Qiu and Gene Chong. A <xref rid="MOESM1" ref-type="media">peer review file</xref> is available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The data used to generate the ImmuneBuilder models was extracted from public repositories such as SAbDab<sup><xref ref-type="bibr" rid="CR11">11</xref></sup> and STCRDab<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. All data generated from this study is available in the public repository located at 10.5281/zenodo.7258553.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>Source code for the ImmuneBuilder models, trained weights and inference script are available under an open-source license at <ext-link ext-link-type="uri" xlink:href="https://github.com/oxpig/ImmuneBuilder">https://github.com/oxpig/ImmuneBuilder</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par49">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Kingwell, K. T cell receptor therapeutics hit the immuno-oncology stage. <italic>Nat. reviews. Drug Discov.</italic><ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/d41573-022-00073-7">https://www.nature.com/articles/d41573-022-00073-7</ext-link> (2022).</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaplon</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chenoweth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Crescioli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reichert</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Antibodies to watch in 2022</article-title>
        <source>mAbs</source>
        <year>2022</year>
        <volume>14</volume>
        <fpage>2014296</fpage>
        <pub-id pub-id-type="doi">10.1080/19420862.2021.2014296</pub-id>
        <?supplied-pmid 35030985?>
        <pub-id pub-id-type="pmid">35030985</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>R-M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Development of therapeutic antibodies for the treatment of diseases</article-title>
        <source>J. Biomed. Sci.</source>
        <year>2020</year>
        <volume>27</volume>
        <fpage>1</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1186/s12929-019-0592-z</pub-id>
        <?supplied-pmid 31894001?>
        <pub-id pub-id-type="pmid">31894001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>EY</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Nanobodies: next generation of cancer diagnostics and therapeutics</article-title>
        <source>Front. Oncol.</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>1182</fpage>
        <pub-id pub-id-type="doi">10.3389/fonc.2020.01182</pub-id>
        <?supplied-pmid 32793488?>
        <pub-id pub-id-type="pmid">32793488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Regep</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Georges</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Popovic</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>The H3 loop of antibodies shows unique structural characteristics</article-title>
        <source>Proteins Struct. Funct., Bioinform.</source>
        <year>2017</year>
        <volume>85</volume>
        <fpage>1311</fpage>
        <lpage>1318</lpage>
        <pub-id pub-id-type="doi">10.1002/prot.25291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsuchiya</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Mizuguchi</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>The diversity of H3 loops determines the antigen-binding tendencies of antibody CDR loops</article-title>
        <source>Protein Sci.</source>
        <year>2016</year>
        <volume>25</volume>
        <fpage>815</fpage>
        <lpage>825</lpage>
        <pub-id pub-id-type="doi">10.1002/pro.2874</pub-id>
        <?supplied-pmid 26749247?>
        <pub-id pub-id-type="pmid">26749247</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>WK</given-names>
          </name>
          <name>
            <surname>Leem</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of the CDR loops of antigen receptors</article-title>
        <source>Front. Immunol.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>2454</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2019.02454</pub-id>
        <?supplied-pmid 31681328?>
        <pub-id pub-id-type="pmid">31681328</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mitchell</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Colwell</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of nanobody sequence and structure data</article-title>
        <source>Proteins: Struct. Funct. Bioinform.</source>
        <year>2018</year>
        <volume>86</volume>
        <fpage>697</fpage>
        <lpage>706</lpage>
        <pub-id pub-id-type="doi">10.1002/prot.25497</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kovaltsuk</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Observed antibody space: a resource for data mining next-generation sequencing of antibody repertoires</article-title>
        <source>J. Immunol.</source>
        <year>2018</year>
        <volume>201</volume>
        <fpage>2502</fpage>
        <lpage>2509</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.1800708</pub-id>
        <?supplied-pmid 30217829?>
        <pub-id pub-id-type="pmid">30217829</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olsen</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Boyles</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>Observed antibody space: a diverse database of cleaned, annotated, and translated unpaired and paired antibody sequences</article-title>
        <source>Protein Sci.</source>
        <year>2022</year>
        <volume>31</volume>
        <fpage>141</fpage>
        <lpage>146</lpage>
        <pub-id pub-id-type="doi">10.1002/pro.4205</pub-id>
        <?supplied-pmid 34655133?>
        <pub-id pub-id-type="pmid">34655133</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunbar</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SAbDab: the structural antibody database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>D1140</fpage>
        <lpage>D1146</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1043</pub-id>
        <?supplied-pmid 24214988?>
        <pub-id pub-id-type="pmid">24214988</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leem</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>de Oliveira</surname>
            <given-names>SHP</given-names>
          </name>
          <name>
            <surname>Krawczyk</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>STCRDab: the structural T-cell receptor database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D406</fpage>
        <lpage>D412</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx971</pub-id>
        <?supplied-pmid 29087479?>
        <pub-id pub-id-type="pmid">29087479</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raybould</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>SAbDab in the age of biotherapeutics: updates including SAbDab-nano, the nanobody structure tracker</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2022</year>
        <volume>50</volume>
        <fpage>D1368</fpage>
        <lpage>D1372</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkab1050</pub-id>
        <?supplied-pmid 34986602?>
        <pub-id pub-id-type="pmid">34986602</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiu</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Goulet</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Teplyakov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gilliland</surname>
            <given-names>GL</given-names>
          </name>
        </person-group>
        <article-title>Antibody structure and function: the basis for engineering therapeutics</article-title>
        <source>Antibodies</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>55</fpage>
        <pub-id pub-id-type="doi">10.3390/antib8040055</pub-id>
        <?supplied-pmid 31816964?>
        <pub-id pub-id-type="pmid">31816964</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Epitope profiling using computational structural modelling demonstrated on coronavirus-binding antibodies</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2021</year>
        <volume>17</volume>
        <fpage>e1009675</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009675</pub-id>
        <?supplied-pmid 34898603?>
        <pub-id pub-id-type="pmid">34898603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ambrosetti</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jiménez-García</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Roel-Touris</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bonvin</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Modeling antibody-antigen complexes by information-driven docking</article-title>
        <source>Structure</source>
        <year>2020</year>
        <volume>28</volume>
        <fpage>119</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="doi">10.1016/j.str.2019.10.011</pub-id>
        <?supplied-pmid 31727476?>
        <pub-id pub-id-type="pmid">31727476</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Buchanan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Taddese</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>DLAB: deep learning methods for structure-based virtual screening of antibodies</article-title>
        <source>Bioinformatics</source>
        <year>2021</year>
        <volume>38</volume>
        <fpage>377</fpage>
        <lpage>383</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Slabinski</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The challenge of protein structure determination-lessons from structural genomics</article-title>
        <source>Protein Sci.</source>
        <year>2007</year>
        <volume>16</volume>
        <fpage>2472</fpage>
        <lpage>2482</lpage>
        <pub-id pub-id-type="doi">10.1110/ps.073037907</pub-id>
        <?supplied-pmid 17962404?>
        <pub-id pub-id-type="pmid">17962404</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>AJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Augmenting adaptive immunity: progress and challenges in the quantitative engineering and analysis of adaptive immune receptor repertoires</article-title>
        <source>Mol. Syst. Des. Eng.</source>
        <year>2019</year>
        <volume>4</volume>
        <fpage>701</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1039/C9ME00071B</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Boyd</surname>
            <given-names>SD</given-names>
          </name>
        </person-group>
        <article-title>Human adaptive immune receptor repertoire analysis-past, present, and future</article-title>
        <source>Immunol. Rev.</source>
        <year>2018</year>
        <volume>284</volume>
        <fpage>9</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1111/imr.12667</pub-id>
        <?supplied-pmid 29944765?>
        <pub-id pub-id-type="pmid">29944765</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jumper</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>596</volume>
        <fpage>583</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id>
        <?supplied-pmid 34265844?>
        <pub-id pub-id-type="pmid">34265844</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Evans, R. et al. Protein complex prediction with AlphaFold-Multimer. <italic>bioRxiv</italic> (2021).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Lin, Z. et al. Language models of protein sequences at the scale of evolution enable accurate structure prediction. <italic>bioRxiv</italic> (2022).</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baek</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title>
        <source>Science</source>
        <year>2021</year>
        <volume>373</volume>
        <fpage>871</fpage>
        <lpage>876</lpage>
        <pub-id pub-id-type="doi">10.1126/science.abj8754</pub-id>
        <?supplied-pmid 34282049?>
        <pub-id pub-id-type="pmid">34282049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruffolo</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>L-S</given-names>
          </name>
          <name>
            <surname>Mahajan</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Fast, accurate antibody structure prediction from deep learning on massive set of natural antibodies</article-title>
        <source>Nat. Commun.</source>
        <year>2023</year>
        <volume>14</volume>
        <fpage>2389</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-023-38063-x</pub-id>
        <?supplied-pmid 37185622?>
        <pub-id pub-id-type="pmid">37185622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wong</surname>
            <given-names>WK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TCRBuilder: multi-state T-cell receptor structure prediction</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>3580</fpage>
        <lpage>3581</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa194</pub-id>
        <?supplied-pmid 32181809?>
        <pub-id pub-id-type="pmid">32181809</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruffolo</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sulam</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Antibody structure prediction using interpretable deep learning</article-title>
        <source>Patterns</source>
        <year>2022</year>
        <volume>3</volume>
        <fpage>100406</fpage>
        <pub-id pub-id-type="doi">10.1016/j.patter.2021.100406</pub-id>
        <?supplied-pmid 35199061?>
        <pub-id pub-id-type="pmid">35199061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ruffolo</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Guerra</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mahajan</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Sulam</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Geometric potentials from deep learning improve prediction of CDR H3 loop structures</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>i268</fpage>
        <lpage>i275</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa457</pub-id>
        <?supplied-pmid 32657412?>
        <pub-id pub-id-type="pmid">32657412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved protein structure prediction using predicted interresidue orientations</article-title>
        <source>Proc. Natl Acad. Sci.</source>
        <year>2020</year>
        <volume>117</volume>
        <fpage>1496</fpage>
        <lpage>1503</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1914677117</pub-id>
        <?supplied-pmid 31896580?>
        <pub-id pub-id-type="pmid">31896580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cohen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Halfon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schneidman-Duhovny</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Nanonet: rapid and accurate end-to-end nanobody modeling by deep learning</article-title>
        <source>Front. Immunol.</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>958584</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2022.958584</pub-id>
        <?supplied-pmid 36032123?>
        <pub-id pub-id-type="pmid">36032123</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Lee, J. H. et al. Equifold: Protein structure prediction with a novel coarse-grained structure representation. <italic>bioRxiv</italic> (2022).</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leem</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dunbar</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Georges</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>ABodyBuilder: automated antibody structure prediction with data-driven accuracy estimation</article-title>
        <source>MAbs</source>
        <year>2016</year>
        <volume>8</volume>
        <fpage>1259</fpage>
        <lpage>1268</lpage>
        <pub-id pub-id-type="doi">10.1080/19420862.2016.1205773</pub-id>
        <?supplied-pmid 27392298?>
        <pub-id pub-id-type="pmid">27392298</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abanades</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Georges</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bujotzek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>ABlooper: fast accurate antibody CDR loop structure prediction with accuracy estimation</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <fpage>1877</fpage>
        <lpage>1880</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac016</pub-id>
        <?supplied-pmid 35099535?>
        <pub-id pub-id-type="pmid">35099535</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lefranc</surname>
            <given-names>M-P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IMGT unique numbering for immunoglobulin and T cell receptor variable domains and Ig superfamily V-like domains</article-title>
        <source>Deve. Comp. Immunol.</source>
        <year>2003</year>
        <volume>27</volume>
        <fpage>55</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1016/S0145-305X(02)00039-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eyal</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gerzon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Potapov</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Edelman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sobolev</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>The limit of accuracy of protein modeling: influence of crystal packing on protein structure</article-title>
        <source>J. Mol. Biol.</source>
        <year>2005</year>
        <volume>351</volume>
        <fpage>431</fpage>
        <lpage>442</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jmb.2005.05.066</pub-id>
        <?supplied-pmid 16005885?>
        <pub-id pub-id-type="pmid">16005885</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schritt</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Repertoire builder: high-throughput structural modeling of b and t cell receptors</article-title>
        <source>Mol. Syst. Des. Eng.</source>
        <year>2019</year>
        <volume>4</volume>
        <fpage>761</fpage>
        <lpage>768</lpage>
        <pub-id pub-id-type="doi">10.1039/C9ME00020H</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maier</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Labute</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Assessment of fully automated antibody homology modeling protocols in molecular operating environment</article-title>
        <source>Proteins: Struct., Funct. Bioinforma</source>
        <year>2014</year>
        <volume>82</volume>
        <fpage>1599</fpage>
        <lpage>1610</lpage>
        <pub-id pub-id-type="doi">10.1002/prot.24576</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunbar</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fuchs</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>ABangle: characterising the VH-VL orientation in antibodies</article-title>
        <source>Protein Eng., Des. Select.</source>
        <year>2013</year>
        <volume>26</volume>
        <fpage>611</fpage>
        <lpage>620</lpage>
        <pub-id pub-id-type="doi">10.1093/protein/gzt020</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leem</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Georges</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>Antibody side-chain conformations are position-dependent</article-title>
        <source>Proteins: Struct., Funct., Bioinforma.</source>
        <year>2018</year>
        <volume>86</volume>
        <fpage>383</fpage>
        <lpage>392</lpage>
        <pub-id pub-id-type="doi">10.1002/prot.25453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tien</surname>
            <given-names>MZ</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Sydykova</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Spielman</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Wilke</surname>
            <given-names>CO</given-names>
          </name>
        </person-group>
        <article-title>Maximum allowed solvent accessibilites of residues in proteins</article-title>
        <source>PloS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e80635</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0080635</pub-id>
        <?supplied-pmid 24278298?>
        <pub-id pub-id-type="pmid">24278298</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eastman</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>OpenMM 7: rapid development of high-performance algorithms for molecular dynamics</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>e1005659</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005659</pub-id>
        <?supplied-pmid 28746339?>
        <pub-id pub-id-type="pmid">28746339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alford</surname>
            <given-names>RF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Rosetta all-atom energy function for macromolecular modeling and design</article-title>
        <source>J. Chem. Theory Comput.</source>
        <year>2017</year>
        <volume>13</volume>
        <fpage>3031</fpage>
        <lpage>3048</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.7b00125</pub-id>
        <?supplied-pmid 28430426?>
        <pub-id pub-id-type="pmid">28430426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Steinegger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Söding</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>1026</fpage>
        <lpage>1028</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3988</pub-id>
        <?supplied-pmid 29035372?>
        <pub-id pub-id-type="pmid">29035372</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mirdita</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ColabFold: making protein folding accessible to all</article-title>
        <source>Nat. Methods</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>679</fpage>
        <lpage>682</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-022-01488-1</pub-id>
        <?supplied-pmid 35637307?>
        <pub-id pub-id-type="pmid">35637307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berman</surname>
            <given-names>HM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The protein data bank</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>235</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.235</pub-id>
        <?supplied-pmid 10592235?>
        <pub-id pub-id-type="pmid">10592235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Liu, L. et al. On the variance of the adaptive learning rate and beyond. <italic>arXiv preprint arXiv:1908.03265</italic> (2019).</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maier</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ff14SB: improving the accuracy of protein side chain and backbone parameters from ff99SB</article-title>
        <source>J. Chem. Theory Comput.</source>
        <year>2015</year>
        <volume>11</volume>
        <fpage>3696</fpage>
        <lpage>3713</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jctc.5b00255</pub-id>
        <?supplied-pmid 26574453?>
        <pub-id pub-id-type="pmid">26574453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schreiner</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Trabuco</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Freddolino</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Schulten</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Stereochemical errors and their implications for molecular dynamics simulations</article-title>
        <source>BMC Bioinform.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-190</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dunbar</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Deane</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>ANARCI: antigen receptor numbering and receptor classification</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>298</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv552</pub-id>
        <?supplied-pmid 26424857?>
        <pub-id pub-id-type="pmid">26424857</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
