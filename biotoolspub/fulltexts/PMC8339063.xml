<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8339063</article-id>
    <article-id pub-id-type="pmid">34349111</article-id>
    <article-id pub-id-type="publisher-id">25006</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-021-25006-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GIANA allows computationally-efficient TCR clustering and multi-disease repertoire classification by isometric transformation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Hongyi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhan</surname>
          <given-names>Xiaowei</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8617-900X</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Bo</given-names>
        </name>
        <address>
          <email>bo.li@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.267313.2</institution-id><institution-id institution-id-type="ISNI">0000 0000 9482 7121</institution-id><institution>Lyda Hill Department of Bioinformatics, </institution><institution>UT Southwestern Medical Center, </institution></institution-wrap>Dallas, TX USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.267313.2</institution-id><institution-id institution-id-type="ISNI">0000 0000 9482 7121</institution-id><institution>Department of Population and Data Science, </institution><institution>UT Southwestern Medical Center, </institution></institution-wrap>Dallas, TX USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.267313.2</institution-id><institution-id institution-id-type="ISNI">0000 0000 9482 7121</institution-id><institution>Department of Immunology, </institution><institution>UT Southwestern Medical Center, </institution></institution-wrap>Dallas, TX USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>4699</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021, corrected publication 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Similarity in T-cell receptor (TCR) sequences implies shared antigen specificity between receptors, and could be used to discover novel therapeutic targets. However, existing methods that cluster T-cell receptor sequences by similarity are computationally inefficient, making them impractical to use on the ever-expanding datasets of the immune repertoire. Here, we developed GIANA (Geometric Isometry-based TCR AligNment Algorithm) a computationally efficient tool for this task that provides the same level of clustering specificity as TCRdist at 600 times its speed, and without sacrificing accuracy. GIANA also allows the rapid query of large reference cohorts within minutes. Using GIANA to cluster large-scale TCR datasets provides candidate disease-specific receptors, and provides a new solution to repertoire classification. Querying unseen TCR-seq samples against an existing reference differentiates samples from patients across various cohorts associated with cancer, infectious and autoimmune disease. Our results demonstrate how GIANA could be used as the basis for a TCR-based non-invasive multi-disease diagnostic platform.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">Grouping T-cell receptors (TCRs) by sequence similarity could lead to new immunological insights. Here, the authors propose a tool that allows the rapid clustering of millions of TCR sequences, identifying TCRs potentially associated with the response to cancer, infectious and autoimmune diseases.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Genome informatics</kwd>
      <kwd>Adaptive immunity</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000054</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Cancer Institute (NCI)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1R01CA245318</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Bo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100004917</institution-id>
            <institution>Cancer Prevention and Research Institute of Texas (Cancer Prevention Research Institute of Texas)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RR170079</award-id>
        <award-id>RP190107</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhan</surname>
            <given-names>Xiaowei</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Bo</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">https://doi.org/10.13039/100000057</institution-id>
            <institution>U.S. Department of Health &amp; Human Services | NIH | National Institute of General Medical Sciences (NIGMS)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>5R01GM126479</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhan</surname>
            <given-names>Xiaowei</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">Adaptive immune repertoire is an important regulator of diverse human diseases, and over 10,000 TCR repertoire sequencing (TCR-seq) samples have been generated in recent years. However, interpretation of TCR data has been hindered by the scarcity of known antigen-specificities. Recent studies demonstrated that similarity in the TCR hypervariable complementarity-determining region 3 (CDR3) implicates structural resemblance<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup> for antigen recognition. Therefore, clustering of similar CDR3s has become an important way to identify antigen-specific receptors.</p>
    <p id="Par4">In the past, a number of TCR clustering methods have been developed to investigate antigen-specific T-cell responses during disease progression or immunotherapy treatments<sup><xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>, such as TCRdist<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>, iSMART<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> and GLIPH<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR6">6</xref></sup>. It is speculated that integrating large number of TCR-seq samples from multiple studies will result in more insights into immune-disease interactions, and create novel opportunities for prognosis and diagnosis<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. However, methods achieving high-clustering specificity requires pairwise Smith–Waterman (SW) alignment (TCRdist and iSMART) on both the CDR3 sequences and the TCR variable gene (TRBV) alleles, which has quadratic computational complexity that usually cannot scale up to the size of TCR repertoire samples (≥100 K sequences). Motif-based clustering (GLIPH2) achieves higher speed<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, but has much lower specificity<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. A recent method, clusTCR, applied physiochemical features to numerically encode CDR3 sequences and achieved faster computational speed. This method, however, has omitted the TCR variable gene information, and used the less stringent Hamming distance to replace the SW alignment, which resulted in lower clustering purity<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Therefore, none of the existing TCR clustering methods are suitable to analyze large cohorts of TCR-seq samples.</p>
    <p id="Par5">To address this challenge, we introduced Geometric Isometry-based TCR AligNment Algorithm (GIANA), a mathematical framework to transform the CDR3 sequences, which converted the sequence alignment and clustering problem into a classic nearest neighbor search in the high-dimensional Euclidean space. This transformation significantly improved the computational efficiency for TCR pairwise comparison and scaled up to 10<sup>6</sup> to 10<sup>7</sup> sequences. In this work, we demonstrated that by pooling thousands of TCR repertoire samples, GIANA can identify novel disease-associated TCRs and assign unseen samples into the correct disease categories. Thus, our approach might open an alternative avenue for an immune-based multi-disease diagnostic platform.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>An isometric embedding framework for ultra-fast TCR alignment</title>
      <p id="Par6">GIANA began with an approximated solution to the isometric embedding of BLOSUM62 matrix using multi-dimensional scaling (MDS) (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>), which generated a numeric vector for each of the 20 amino acids. Subsequently, CDR3 strings were modeled as serial non-commuting linear transformations on the MDS vectors and were represented as coordinates in the high-dimensional space. The unitary transformation matrix was an element of the 6-order cyclic group (G<sub>6</sub>), which produced near-perfect linear correlations between the Euclidean distances of a pair of strings and their Smith–Waterman alignment scores (Fig. <xref rid="MOESM1" ref-type="media">S2</xref>). At default, isometric distance cutoff (-t) of 10, all TCR pairs with high Smith–Waterman alignment scores were included in the downstream clusters. Fast, index-based nearest neighbor search and recursive centroid grouping were then performed on the coordinates to identify CDR3 pre-clusters, which were subsequently filtered for matched TRBV alleles and high alignment scores using a k-mer guided search table, to produce the final TCR clusters as output (Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><title>Schematic illustration of GIANA.</title><p>GIANA workflow. GIANA began with encoding of short CDR3 peptide sequences into numeric vectors through a sequence of unitary transformations. The transformation involves an element of 6<sup>th</sup> order cyclic group. After encoding, each CDR3 sequence was projected to high-dimensional Euclidean space, allowing fast nearest neighbor search for clustering. Follow-up filtering steps were performed to match the TRBV gene alleles and remove pairs with low alignment scores.</p></caption><graphic xlink:href="41467_2021_25006_Fig1_HTML" id="d32e390"/></fig></p>
      <p id="Par7">In parallel to G<sub>6</sub> transformation, we also implemented a naïve method with stacked MDS vectors as the coordinates of the input CDR3 strings (GIANAsv), similar to a recent work<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> (Fig. <xref rid="MOESM1" ref-type="media">S3</xref>). We developed a benchmark with 10 K, 20 K, …, 100 K TCRs from a healthy donor’s TCR-seq sample<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> and applied five competing methods, GIANA, GIANAsv, iSMART<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, TCRdist<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> and GLIPH2<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> for speed and memory tests (Fig. <xref rid="Fig2" ref-type="fig">2a</xref> and Fig. <xref rid="MOESM1" ref-type="media">S4</xref>). We excluded a similar method, ALICE<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>, as it was optimized to find the most variable clones in longitudinal data only. GIANA has the lowest time cost throughout the benchmark, taking 23.9 s to process 100 K sequences, whereas TCRdist took 14,338 s. GIANAsv is slower than GIANA by a factor of 2.2 (Table <xref rid="MOESM1" ref-type="media">S1</xref>). This is expected because stacked vector encoding resulted in higher dimensionality of the isometric embedding space, and increased the time cost during nearest neighbor search. Notably, GLIPH2 is the fastest algorithm besides GIANA/GIANAsv, because it avoided pairwise alignment through motif-guided search.<fig id="Fig2"><label>Fig. 2</label><caption><title>Performance evaluation and comparison of different methods.</title><p><bold>a</bold> Comparison of time complexity for five competing TCR clustering algorithms. Speedup was calculated based on the time cost for the 100 K TCR sample. <bold>b</bold> Comparison of purity cluster fraction and retention of four methods. <italic>y</italic>-axis shows the precision or sensitivity in percentage. <bold>c</bold> Normalized mutual information comparison of the four methods. <bold>d</bold> Sensitivity and Specificity of GIANA when applied to large and noisy TCR-seq samples. <italic>x</italic>-axis is the cutoff for Smith–Waterman alignment score, a key parameter in GIANA, with maximum 4.0. Higher cutoff results in higher specificity at the cost of reduced sensitivity.</p></caption><graphic xlink:href="41467_2021_25006_Fig2_HTML" id="d32e461"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>GIANA achieves higher accuracy in predicting antigen-specific TCRs</title>
      <p id="Par8">As antigen-specificity is the most desirable feature of TCR clustering, we next evaluated the clustering accuracy of all the methods. GIANAsv was excluded from this analysis because it has theoretically identical performance as GIANA except for computational efficiency. We collected 61,366 non-redundant known TCR/antigen pairs from the public domain<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref></sup>, covering over 900 different epitopes from diverse pathogens. We first defined cluster purity as previously described:<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> the percentage of TCRs specific to the most common epitope in a given cluster. A “pure cluster” is defined to have a purity equal to 1. We defined “Pure cluster fraction” as the percentage of pure clusters in the output (Fig. <xref rid="Fig2" ref-type="fig">2b</xref> and Table <xref rid="MOESM1" ref-type="media">S2</xref>). The fractions for GIANA (96%), iSMART (97%), and TCRdist (97%) are similar, yet substantially lower for GLIPH2 (35%). Pure cluster retention was defined as the total number of TCRs in all the pure clusters divided by the number of all the testing TCRs, and we confirmed that GIANA also has similar level of retention (27%) as other methods, except for GLIPH2 (19%). For the three methods that rely on Smith–Waterman alignment (GIANA, iSMART and TCRdist), we further explored the impact of a range of alignment score cutoffs (-S option in GIANA). We observed similar performances for the three methods at stringent cutoffs (Fig. <xref rid="MOESM1" ref-type="media">S5</xref>).</p>
      <p id="Par9">Pure cluster fraction and retention emphasized the clusters with 100% purity, which are more frequently seen in smaller clusters. Methods that produced larger clusters may have worse performance due to impure clustering. Therefore, we also measured normalized mutual information (NMI) between TCR clusters and epitope specificity, using the same training dataset. We observed similar levels of NMI across all the methods using Smith–Waterman alignment, and GLIPH2 remained to be the lowest (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>).</p>
      <p id="Par10">Next, we investigated if GIANA is able to retrieve antigen-specific TCRs from real, large, and noisy TCR-seq samples, using TCRs with known antigen-specificity. From the above benchmark antigen-specific TCRs, we selected those specific to three epitopes expected to be missing in healthy individuals: the YAW and YLQ epitopes<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> from the recent outbreak of SARS-CoV-2 virus and the FRD epitope<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> from HIV-1 virus. 20% of these TCRs were mixed with 100,000 TCRs from a healthy donor as testing data, and we used the remaining non-overlapping 80% antigen-specific TCRs as training data to recover the test sequences. Any sequence clustered with the training data will be called as “positive.” True positives are the 20% spiked-in antigen-specific TCRs, whereas false positives are those from the healthy donor. For all three epitopes, GIANA achieved over 99.99% specificity at 20–50% sensitivity (Fig. <xref rid="Fig2" ref-type="fig">2d</xref>). Although GLIPH2 reached higher sensitivity, its specificity is lower than GIANA (Fig. <xref rid="MOESM1" ref-type="media">S6a</xref>). More importantly, the positive prediction values (PPV) of GIANA reached over 60% for all epitopes, while the PPVs of GLIPH2 for 2 out of the 3 epitopes were lower than 20% (Fig. <xref rid="MOESM1" ref-type="media">S6b</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>Ultra-fast sample query and TCR repertoire classification</title>
      <p id="Par11">The high speed and specificity of GIANA motivated us to further develop a query module to cluster new TCR samples with an existing reference dataset, a function that is missing in all current tools. We transformed reference and query TCRs into Euclidean space with linear complexity and searched for the nearest neighbors of each query sequence, which were processed into TCR clusters and merged with the reference data (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). We evaluated the speed of this approach using query and reference datasets with different numbers of TCRs (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). As expected, GIANA is computationally efficient as demonstrated by the fact that it took 176 s to query 10<sup>4</sup> TCRs against 10<sup>7</sup> reference sequences (Table <xref rid="MOESM1" ref-type="media">S3</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><title>Fast query of previously generated reference TCR clustering data for accurate repertoire classification.</title><p><bold>a</bold> Illustration of fast GIANA query based on isometric transformation. GIANA performs nearest neighbor search of each query TCR against the reference coordinates, selects closely located neighbors in the Euclidean space, and merges with reference TCR clusters. Dashed arrows implicate search directions. <bold>b</bold> Time complexity evaluation of GIANA query module using reference/query data with different number of TCRs. <bold>c</bold> Degree of separation of query COVID-19 patients from healthy controls by clustering against the reference datasets. The number of TCRs of the reference data was shown as <italic>x</italic>-axis labels. Two sample <italic>t</italic>-test was performed using the COVID-19 fractions estimated from the query data to obtain the t-statistics. All <italic>p</italic>-values were significant at the level of 2.2 × 10<sup>−16</sup>. <bold>d</bold> ROC curves using COVID-19 fraction as the single predictor. The numbers of COVID-19 and HC samples were labeled in figure title, with each sample containing 10 K TCR sequences. Shaded area labeled the 95% confidence interval of the ROC curves, which were estimated from 2,000 stratified bootstraps.</p></caption><graphic xlink:href="41467_2021_25006_Fig3_HTML" id="d32e569"/></fig></p>
      <p id="Par12">Repertoire classification is an important task with immediate applications to disease diagnosis and prognosis<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. In the past, this task has been approached by multiple instance learning<sup><xref ref-type="bibr" rid="CR17">17</xref></sup> or deep learning<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. We next explored if GIANA query can also be used to classify TCR repertoires. First, we generated 3 reference datasets with 20, 100 or 200 TCR-seq samples, evenly split into COVID-19 patients and healthy controls (HC). An additional 154 COVID-19 and 120 HC samples were queried to each of the references. For each query sample, we calculated the fraction of TCRs co-clustered with COVID-19 reference patients. Interestingly, this fraction is significantly higher for the COVID-19 patients in the query samples, with increasing separation from query HCs as the size of reference data increases (Fig. <xref rid="Fig3" ref-type="fig">3c</xref> and Fig. <xref rid="MOESM1" ref-type="media">S7a</xref>). Using this fraction as a predictor, we observed increasing Area Under the receiver operation Curve (AUC) for reference with larger sample size (Fig. <xref rid="Fig3" ref-type="fig">3d</xref>). Notably, with 2 million reference TCRs, the sensitivity (79%) and specificity (100%) surpassed some existing test for COVID-19<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, suggesting the potential utilities of this approach in disease diagnosis. The fact that the accuracy of repertoire classification improved with more reference samples is likely due to that disease-specific TCRs are usually shared at low frequencies<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Consequently, a larger reference data will have higher clustering probability, smaller dispersion and better precision. Indeed, we observed decreasing coefficient of variance of COVID-19 fractions with more reference samples (Fig. <xref rid="MOESM1" ref-type="media">S7b</xref>).</p>
      <p id="Par13">We extended the above efforts by building a large reference dataset containing 10 million TCRs, which consisted of 1,213 samples from cancer, COVID-19 and multiple-sclerosis (MS) patients and HCs<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR34">34</xref></sup> (Table <xref rid="MOESM1" ref-type="media">S4</xref>). First, we applied GIANA to perform antigen-specific clustering of all 10M TCRs and investigated the similarity of different repertoire samples measured by the level of shared TCR clusters. We observed clear separations of most cancer patients from healthy donors and MS patients. Interestingly, lung cancer and COVID-19 patients together formed a separate cluster (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). It is known that local inflammatory conditions, such as viral infection or cancer, could release tissue-resident T cells into the circulation<sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, a likely cause for TCR repertoire sharing. Our findings further suggested that in the lung tissue, the magnitude of T cell egress might be high enough to transcend disease types. However, currently it is not feasible to experimentally validate this observation due to the lack of paired α chain information.<fig id="Fig4"><label>Fig. 4</label><caption><title>Disease-specific grouping of TCR repertoire samples via ultra-large-scale clustering.</title><p><bold>a</bold> Graphic representation for the similarities of the TCR-seq samples based on TCR co-clustering. Sample-wise count-sharing matrix was computed from the original TCR clustering results of the 1,213 reference samples. Spearman correlation matrix was calculated based on counts of co-clustered TCRs, with pairs having a correlation value ≤0.4 set to be zero. The resulting sparse matrix was used to generate the graph. Nodes with fewer than two connections were removed to visualize the sample groups. <bold>b</bold> ROC curves using disease fractions calculated from co-clustered TCRs. AUC values were labeled at the bottom right of each panel. 95% confidence intervals were calculated using 2,000 stratified bootstraps. Disease abbreviations: GBM for glioblastoma multiforme; RCC for renal clear cell carcinoma; MS for multiple sclerosis.</p></caption><graphic xlink:href="41467_2021_25006_Fig4_HTML" id="d32e642"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>A multi-disease detection platform through ultra-large-scale TCR clustering and query</title>
      <p id="Par14">The ultra-large-scale clustering by GIANA also allowed us to inspect disease-specific vs. tissue-specific TCRs. We divided the TCR clusters in the lung cancer and COVID-19 patients into three categories: (i) COVID-19 specific; (ii) lung cancer specific; (iii) shared between the two diseases. We observed significantly higher clonal frequency of category (i) vs. (iii) for COVID-19 patients, whereas there is no difference between category (ii) and (iii) for the lung cancer patients (Fig. <xref rid="MOESM1" ref-type="media">S8a</xref>). TCR frequencies were matched within same cohort to avoid batch effect, and thus, the higher abundance of COVID-19-specific TCRs is likely caused by an immune response to SARS-CoV-2. Indeed, only COVID-19-specific TCRs underwent dynamic regulation after viral infection, which peaked within the first 2 weeks post-exposure and decreased afterwards. In contrast, clonal abundance of shared TCRs were unaffected by the timeline after SARS-CoV-2 infection (Fig. <xref rid="MOESM1" ref-type="media">S8b</xref>). In conclusion, clustering on large TCR repertoire samples might reveal shared disease-specific TCRs, which may provide a finer solution to repertoire classification.</p>
      <p id="Par15">Therefore, we tested if clustered TCRs can be used as markers to assign repertoire samples into multiple diseases, by implementing a leave-one-out validation approach. Specifically, for a given sample, we calculated the fractions of TCRs co-clustered with cancer, COVID-19, MS patients or healthy controls in the reference cohort, excluding the sample itself. This method yielded four class fractions for each sample, which added up to 1. We used the HC fraction to separate patients from healthy donors and observed near perfect accuracies for all three diseases (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>). To differentiate a pair of diseases, we used the differences between the two corresponding fractions as the predictor, which also led to high (≥93%) AUC values. The ability to distinguish lung cancer from COVID-19 was not contradictory to the apparent grouping of the two diseases (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>) because within-disease similarity was still higher (Fig. <xref rid="MOESM1" ref-type="media">S9</xref>). However, as most of the diseases were derived from only one study, it raised the concern that the predictability might be contributed by unknown cohort-specific batch effects.</p>
      <p id="Par16">To test out this possibility, we investigated if GIANA can predict the disease labels of unseen samples from independent cohorts. We applied GIANA to query 267 new TCR-seq samples of the three disease categories and 153 HC samples<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR36">36</xref>–<xref ref-type="bibr" rid="CR39">39</xref></sup> (Table <xref rid="MOESM1" ref-type="media">S5</xref>) against the reference dataset. All samples were derived from peripheral blood. We used the same approach to calculate the fractions of TCRs co-clustered with reference cancer, COVID-19, MS, or HC sequences. Without any model fitting, this simple approach can already distinguish each sample category from the others (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>). HC fractions distinguish all 3 diseases at over 91% accuracy, whereas pairwise separation between diseases all reached above 87% AUCs (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>). Since the query samples were derived from studies not included in the reference data, the high AUCs were unlikely caused by unknown batch or cohort-specific effects and thus could reflect the real predictability for the three types of diseases.<fig id="Fig5"><label>Fig. 5</label><caption><title>Reference-based multiple disease classification of unseen TCR repertoire samples.</title><p><bold>a</bold> Violin plot showing the distribution of class fractions of cancer, COVID-19, multiple sclerosis (MS) patients and healthy controls (HC). Cancer fraction was calculated as the proportion of query TCRs clustered with reference TCRs from the cancer patients. Other class fractions were defined in the same way. Sample size: HC: <italic>n</italic> = 153, COVID-19: <italic>n</italic> = 193, Cancer: <italic>n</italic> = 62, MS: <italic>n</italic> = 6. <bold>b</bold> ROC curves using disease class fractions as single predictor for pairwise separation of the four disease classes. The fraction was the percentage of TCRs co-clustered with a given class of samples in the reference dataset. AUC values were labeled at the bottom right of each panel. 95% confidence intervals were calculated using 2,000 stratified bootstraps.</p></caption><graphic xlink:href="41467_2021_25006_Fig5_HTML" id="d32e719"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par17">In summary, GIANA is a fast TCR clustering algorithm that efficiently handles tens of millions of sequences. It achieved the same level of accuracy as the best existing methods and was able to retrieve TCRs specific to known antigens with high accuracy. The ultra-large-scale TCR clustering and fast query of novel samples also enabled reference-based repertoire classification. To date, GIANA can also analyze single cell RNA-seq data with TCR regions solved, and it is possible to query TCRs from the scRNA-seq data against the large database of TCR repertoire samples in the public domain to gain new insights over shared antigen-specificity. With minimum modifications, GIANA is applicable to cluster or query B-cell receptor sequencing data as well. Furthermore, the mathematical framework to perform isometric embedding may provide an alternative solution to the classic short DNA or protein sequence alignment problems in the future.</p>
    <p id="Par18">Unsupervised TCR clustering is a fundamental analysis of immune repertoire data. In the ideal scenario, all TCRs specific to the same epitope should be included in the same cluster. However, this is not feasible for sequence similarity or motif-based clustering approach, due to the putative diversity in TCR sequences of shared specificity<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Such diversity is caused by the distinct docking strategies of T-cell receptors. For example, TCRs specific to the influenza GIL epitope usually contain the classic RSS/RSA motif in the CDR3 region, yet a related study<sup><xref ref-type="bibr" rid="CR40">40</xref></sup> reported that LGGW motif also elicits strong binding to GIL from a different direction. Such structural variation cannot be captured by simple Smith–Waterman alignment or motif grouping. Consequently, CDR3s with dissimilar motifs will be fragmented into smaller clusters despite their shared specificity, which is a common limitation to the current methods.</p>
    <p id="Par19">There are several limitations in our study: first, unlike GLIPH2, HLA alleles were not considered in GIANA, as such data is unavailable in most current studies. With HLA typing included, the accuracy of TCR clustering and query methods is expected to improve. Second, GIANA does not support gap alignment, as the current isometric encoding framework only applies to sequences with the same length. However, it has similar level of clustering accuracy as the methods that consider gaps, such as TCRdist. This is because allowing gaps will reduce clustering specificity and compromise the prediction accuracy<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. Third, in this work, we simply used the TCR fractions to assign disease classes. With more data, this effort can be improved by machine learning models to optimize the prediction accuracy. Fourth, we compared all cancer patients with other diseases together but were not able to differentiate cancer localizations. We anticipate the power to separate cancer types with enough relevant TCR-seq samples as the reference. Finally, although the current method already achieved high accuracy of repertoire classification, the diagnostic value of this platform requires further validation with prospectively collected patient samples.</p>
    <p id="Par20">As demonstrated in autoimmune and infectious diseases, antigen-specific public TCRs shared at low frequencies are potentially important biomarkers<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR41">41</xref>,<xref ref-type="bibr" rid="CR42">42</xref></sup>, which can be detected by comparing large amount of TCRs from thousands of individuals. Methods have been developed to individually detect cancer<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>, COVID-19<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, or multiple sclerosis<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> using immune repertoire, but none has been able to simultaneously diagnose and separate different diseases. In contrast, our effort could be developed into a unified platform to diagnose infectious disease, autoimmune disorders and cancer. Such a platform has been proposed in the literature<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>, and in this work, we provided a prototype to achieve this goal.</p>
    <p id="Par21">We believe this is potentially a significant advance because: first, disease diagnosis is mainly symptom-driven for decades, with each disease requiring a distinct set of signatures obtained from diverse clinical assays, such as radioactive imaging, liquid biopsy, invasive endoscopy, surgery, etc. The feasibility of using the immune system as a single biomarker to indicate multiple diseases could shift the paradigm from symptom-driven to immune-response-driven, which provides a universal solution to many immune-related disorders. Additionally, differential diagnosis is usually a clinical challenge, and adding more diseases to the platform will further reduce the diagnostic specificity. We provided a solution to this problem by showing that the platform can increase its prediction accuracy by the inclusion of more TCR-seq samples. Further, as immune responses are usually ahead of any measurable symptoms, this platform has the potential to detect diseases at its early stages, where most diseases are curable or easy to manage. We have already demonstrated this fact for cancer diagnosis<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, and the principle of immune regulation also applies to autoimmune disorders, such as multiple sclerosis. Finally, since this platform only requires a small amount of blood to perform targeted V(D)J capture, it can serve as a non-invasive test at low cost. Together, we anticipate GIANA to be widely used to find antigen-specific TCR clusters, to retrieve sequences specific to known pathogens, such as SARS-CoV-2, and to facilitate disease diagnosis with the fast-growing body of TCR data in cancer, immunology and clinical studies.</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>TCR-seq data collection</title>
      <p id="Par22">All TCR repertoire sequencing samples were accessed via immuneACCESS of Adaptive Biotechnology, which currently hosts the largest database of TCR-seq samples, all profiled using the immunoSEQ platform. Antigen-specific TCR and the matching antigens were pooled from the VDJdb<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, the Immune Epitope Database and Analysis Resource (IEDB), and previous literature<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR2">2</xref></sup>. TCRs specific to more than one epitope were removed to avoid conflicts.</p>
    </sec>
    <sec id="Sec10">
      <title>GIANA method description</title>
      <sec id="Sec11">
        <title>Mathematical framework for isometric embedding of CDR3 sequences</title>
        <p id="Par23">The goal is to find a numeric representation (also the coordinates in high-dimensional space) <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x$$\end{document}</tex-math><mml:math id="M2"><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq1.gif"/></alternatives></inline-formula> of any short peptide sequence <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M4"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq2.gif"/></alternatives></inline-formula>, such that, for <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{j}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq4.gif"/></alternatives></inline-formula>, the Euclidean distance between the two coordinates <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq5.gif"/></alternatives></inline-formula> and <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq6.gif"/></alternatives></inline-formula>: <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Vert {x}_{{{{{{\rm{i}}}}}}}-{x}_{{{{{{\rm{j}}}}}}}\Vert$$\end{document}</tex-math><mml:math id="M14"><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">j</mml:mi></mml:mrow></mml:msub><mml:mo>∥</mml:mo></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq7.gif"/></alternatives></inline-formula>, is perfectly correlated to the sequence similarity score measured by putative evolutionary substitution matrix. We refer this problem as “isometric embedding of short sequences”. This concept is introduced to solve the numeric encoding problem of the CDR3 sequences, typically with lengths ranging from 12 to 17 amino acids. In this section, we presented the process of finding the mathematical transformation of a given CDR3 sequence that approximately satisfied isometry. First, we found an approximately isometric embedding for the BLOSUM62 matrix. The problem is defined as below:</p>
        <p id="Par24">Let amino acid <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{i}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq8.gif"/></alternatives></inline-formula> be represented by <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq9.gif"/></alternatives></inline-formula>, a numeric vector in real space <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb{R}}}^{r}$$\end{document}</tex-math><mml:math id="M20"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq10.gif"/></alternatives></inline-formula>. The dimension of the real space <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M22"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq11.gif"/></alternatives></inline-formula> is determined by the rank of the Euclidean Distance Matrix, or EDM. In this scenario, let <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M24"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq12.gif"/></alternatives></inline-formula> denote the dissimilarity matrix derived by BLOSUM62: <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M=4-{{{{{\mathrm{BLOSUM}}}}}}62$$\end{document}</tex-math><mml:math id="M26"><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo>−</mml:mo><mml:mi mathvariant="normal">BLOSUM</mml:mi><mml:mn>62</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq13.gif"/></alternatives></inline-formula>, and the diagonal values of <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M28"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq14.gif"/></alternatives></inline-formula> are set <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0$$\end{document}</tex-math><mml:math id="M30"><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq15.gif"/></alternatives></inline-formula>. Isometry indicates that<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Vert {\beta }_{i}-{\beta }_{j}\Vert ={M}_{ij}$$\end{document}</tex-math><mml:math id="M32"><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∥</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par25">In 1974, C. L. Morgan, in his work “<italic>Embedding Metric Spaces in Euclidean Space</italic>”<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> proved that the solution to this problem exists if, and only if the EDM is flat, and the embedding space has dimension no greater than <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M34"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq16.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M36"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq17.gif"/></alternatives></inline-formula> is the dimension of EDM. Unfortunately, BLOSUM62 matrix is not even an EDM, since it does not satisfy the triangular rule:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${M}_{ik}+{M}_{kj}\ge {M}_{ij},for\forall i,j,k$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par26">Therefore, there does not exist an exact isometric embedding of BLOSUM62. However, Multidimensional Scaling (MDS) provides an approximate solution, which applies to the cases where <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M40"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq18.gif"/></alternatives></inline-formula> is not an EDM. We used MDS to derive the embedding vectors <inline-formula id="IEq19"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq19.gif"/></alternatives></inline-formula>. The transformed distance matrix <inline-formula id="IEq20"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M44"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq20.gif"/></alternatives></inline-formula> has rank <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=13$$\end{document}</tex-math><mml:math id="M46"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>13</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq21.gif"/></alternatives></inline-formula>. With classic MDS, the maximum dimension for the embedding space is 13. We applied the non-metric MDS<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> calculation using the sklearn package in Python and could explore dimensionality higher than 13. To maximize the embedding isometry, we first selected 2,300 training TCRs of length 14 from a previously described TCGA dataset<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> and calculated the pairwise SW alignment scores. We applied the MDS to obtain isometric embedding vectors of different dimensions, ranging from 13 to 19. For each length, we calculated the Euclidean coordinates of the CDR3 sequences as described in the GIANA method and compared the pairwise distance with SW scores. The maximum score was observed with dimension 16 (Spearman’s <italic>ρ</italic> = −0.973, Figure <xref rid="MOESM1" ref-type="media">S1</xref>). This representation achieves <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$87 \%$$\end{document}</tex-math><mml:math id="M48"><mml:mn>87</mml:mn><mml:mi>%</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq22.gif"/></alternatives></inline-formula> similarity to the BLOSUM matrix:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Vert {\beta }_{i}-{\beta }_{j}\Vert \approx {M}_{ij}$$\end{document}</tex-math><mml:math id="M50"><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∥</mml:mo><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par27">Next, we introduce a numeric encoding scheme, such that each amino acid is considered as an “operator”, parable to the concept in quantum physics. In general, operator <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\bf{A}}}}}}$$\end{document}</tex-math><mml:math id="M52"><mml:mi mathvariant="bold">A</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq23.gif"/></alternatives></inline-formula> is a mathematical transformation to an existing wave function <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi$$\end{document}</tex-math><mml:math id="M54"><mml:mi>ϕ</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq24.gif"/></alternatives></inline-formula>. The operation can be applied to wave functions denoted by the Dirac bracket: <bold>A|</bold><italic>ϕ</italic>&gt;. One example is the angular moment operators <bold>L</bold><sub>X</sub>, <bold>L</bold><sub>y</sub>, <bold>L</bold><sub>z</sub>. Here, we define the operator for amino acid <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M56"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq25.gif"/></alternatives></inline-formula> to be <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{A}}}}}}}_{i}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq26.gif"/></alternatives></inline-formula>, which applies to a numeric vector <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\rm{x}}}}}}$$\end{document}</tex-math><mml:math id="M60"><mml:mi mathvariant="normal">x</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq27.gif"/></alternatives></inline-formula> in the following way:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\bf{A}}}}}}}_{i}x:={{{{{\boldsymbol{\Omega }}}}}}\times (x+{\beta }_{i})$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mi mathvariant="bold">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par28">Here <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Omega }}}}}}$$\end{document}</tex-math><mml:math id="M64"><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq28.gif"/></alternatives></inline-formula> is a matrix that needs to be determined. This definition emphasizes the ordering of letters in a sequence as operators are non-commuting: <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{A}}}}}}}_{i}{{{{{{\boldsymbol{A}}}}}}}_{j}\ne {{{{{{\boldsymbol{A}}}}}}}_{j}{{{{{{\boldsymbol{A}}}}}}}_{i}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq29.gif"/></alternatives></inline-formula> if <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\ne j$$\end{document}</tex-math><mml:math id="M68"><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq30.gif"/></alternatives></inline-formula>. A CDR3 sequence is then serial linear operations on some initial vector, <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{0}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq31.gif"/></alternatives></inline-formula>. To simply calculation, we always let <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{0}=0$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq32.gif"/></alternatives></inline-formula>. Therefore, after the operation on the rightmost amino acid, the coordinates become:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{A}}}}}}}_{i}{\beta }_{0}:={{{{{\boldsymbol{\Omega }}}}}}\times ({\beta }_{i}+0)={{{{{\boldsymbol{\Omega }}}}}}\times {\beta }_{i}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par29">Below we use several cases to illustrate the desirable qualities of <inline-formula id="IEq33"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Omega }}}}}}$$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq33.gif"/></alternatives></inline-formula>.</p>
        <p id="Par30"><italic>Case 1</italic>: Single Mismatch</p>
        <p id="Par31">We begin with the simple case where two amino acid sequences are off by one amino acid. For example, sequence <inline-formula id="IEq34"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{1}={{{{{{\boldsymbol{A}}}}}}}_{k}{{{{{{\boldsymbol{A}}}}}}}_{i}$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq34.gif"/></alternatives></inline-formula>, and sequence <inline-formula id="IEq35"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{2}={{{{{{\boldsymbol{A}}}}}}}_{k}{{{{{{\boldsymbol{A}}}}}}}_{j}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq35.gif"/></alternatives></inline-formula>. Their numeric encoding vectors can be calculated as below:<disp-formula id="Equa"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{1}={{{{{{\boldsymbol{A}}}}}}}_{k}{{{{{{\boldsymbol{A}}}}}}}_{i}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2021_25006_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equb"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{2}={{{{{{\boldsymbol{A}}}}}}}_{k}{{{{{{\boldsymbol{A}}}}}}}_{j}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2021_25006_Article_Equb.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equc"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{1}={{{{{\boldsymbol{\Omega }}}}}}\times ({{{{{\boldsymbol{\Omega }}}}}}\times {\beta }_{i}+{\beta }_{k})$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_25006_Article_Equc.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equd"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{2}={{{{{\boldsymbol{\Omega }}}}}}\times ({{{{{\boldsymbol{\Omega }}}}}}\times {\beta }_{j}+{\beta }_{k})$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_25006_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par32"><inline-formula id="IEq36"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{1}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq37"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{2}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq37.gif"/></alternatives></inline-formula> are the encoding vectors of <inline-formula id="IEq38"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{1}$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq38.gif"/></alternatives></inline-formula>and <inline-formula id="IEq39"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{2}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq39.gif"/></alternatives></inline-formula>. The Euclidean distance between <inline-formula id="IEq40"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{1}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{2}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq41.gif"/></alternatives></inline-formula> can be calculated by:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{ccc}\Vert {x}_{1}-{x}_{2}\Vert &amp; = &amp; {\delta }^{T}\delta ,where\delta ={x}_{1}-{x}_{2}\\ &amp; = &amp; {({{{{{{\boldsymbol{\Omega }}}}}}}^{2}({\beta }_{i}-{\beta }_{j}))}^{T}({{{{{{\boldsymbol{\Omega }}}}}}}^{2}({\beta }_{i}-{\beta }_{j}))\\ &amp; = &amp; {({\beta }_{i}-{\beta }_{j})}^{T}{{{{{{\boldsymbol{\Omega }}}}}}}^{T}{{{{{{\boldsymbol{\Omega }}}}}}}^{T}{{{{{\boldsymbol{\Omega }}}}}}{{{{{\boldsymbol{\Omega }}}}}}({\beta }_{i}-{\beta }_{j})\end{array}$$\end{document}</tex-math><mml:math id="M102"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∥</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>δ</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"/><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"/><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par33">We hope the above value is equal to the distance between amino acid <inline-formula id="IEq42"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{i}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq42.gif"/></alternatives></inline-formula> and amino acid <inline-formula id="IEq43"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${A}_{j}$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq43.gif"/></alternatives></inline-formula>, as this is the only mismatch. Thus:<disp-formula id="Eque"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${({\beta }_{i}-{\beta }_{j})}^{T}{{{{{{\boldsymbol{\Omega }}}}}}}^{T}{{{{{{\boldsymbol{\Omega }}}}}}}^{T}{{{{{\boldsymbol{\Omega }}}}}}{{{{{\boldsymbol{\Omega }}}}}}({\beta }_{i}-{\beta }_{j})={({\beta }_{i}-{\beta }_{j})}^{T}({\beta }_{i}-{\beta }_{j})\approx {M}_{ij}$$\end{document}</tex-math><mml:math id="M108"><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2021_25006_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par34">Without losing generality, we let <inline-formula id="IEq44"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\Omega }}}}}}}^{T}{{{{{\boldsymbol{\Omega }}}}}}={{{{{\boldsymbol{I}}}}}}$$\end{document}</tex-math><mml:math id="M110"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq44.gif"/></alternatives></inline-formula>, i.e. <inline-formula id="IEq45"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Omega }}}}}}$$\end{document}</tex-math><mml:math id="M112"><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq45.gif"/></alternatives></inline-formula> is a unitary matrix. It can be easily shown that longer sequences with one mismatch follow the same argument above.</p>
        <p id="Par35"><italic>Case 2</italic>: Two Consecutive Mismatches</p>
        <p id="Par36">Now we define <inline-formula id="IEq46"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{1}={{{{{{\boldsymbol{A}}}}}}}_{i}{{{{{{\boldsymbol{A}}}}}}}_{j}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq46.gif"/></alternatives></inline-formula> and <inline-formula id="IEq47"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{2}={{{{{{\boldsymbol{A}}}}}}}_{t}{{{{{{\boldsymbol{A}}}}}}}_{k}$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq47.gif"/></alternatives></inline-formula>. It can be shown that the distance between the embedding vectors <inline-formula id="IEq48"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{1}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{2}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq49.gif"/></alternatives></inline-formula> is:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\,\Vert {x}_{1}-{x}_{2}\Vert ={({{{{{{\boldsymbol{\Omega }}}}}}}^{2}({\beta }_{j}-{\beta }_{k})+{{{{{\boldsymbol{\Omega }}}}}}({\beta }_{i}-{\beta }_{t}))}^{T}({{{{{{\boldsymbol{\Omega }}}}}}}^{2}({\beta }_{j}-{\beta }_{k})+{{{{{\boldsymbol{\Omega }}}}}}({\beta }_{i}-{\beta }_{t}))\\ \, ={({\beta }_{j}-{\beta }_{k})}^{T}({\beta }_{j}-{\beta }_{k})+{({\beta }_{i}-{\beta }_{t})}^{T}({\beta }_{i}-{\beta }_{t})-2{({\beta }_{i}-{\beta }_{t})}^{T}{{{{{\boldsymbol{\Omega }}}}}}({\beta }_{j}-{\beta }_{k})\\ \,\approx {M}_{jk}+{M}_{it}-2{({\beta }_{i}-{\beta }_{t})}^{T}{{{{{\boldsymbol{\Omega }}}}}}({\beta }_{j}-{\beta }_{k})$$\end{document}</tex-math><mml:math id="M122"><mml:mspace width="0.25em"/><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∥</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.25em"/><mml:mo>≈</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par37">Ideally, we want the third term to be zero for <inline-formula id="IEq50"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall i,j,t,k$$\end{document}</tex-math><mml:math id="M124"><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq50.gif"/></alternatives></inline-formula>. One solution is to let <inline-formula id="IEq51"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Omega }}}}}}$$\end{document}</tex-math><mml:math id="M126"><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq51.gif"/></alternatives></inline-formula> be a rotation in <inline-formula id="IEq52"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb{R}}}^{2r}$$\end{document}</tex-math><mml:math id="M128"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq52.gif"/></alternatives></inline-formula>, by imposing a perpendicular rotation from the first <inline-formula id="IEq53"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M130"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq53.gif"/></alternatives></inline-formula> dimensional space to the complement space. A simple realization is:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Omega}}}}}}_{2}=\left(\begin{array}{l}\begin{array}{ll}{{\underline{{{\mathbf{0}}}}}} &amp; {{{{{\boldsymbol{I}}}}}}\\ {{{{{\boldsymbol{I}}}}}} &amp; {{\underline{{{\mathbf{0}}}}}}\end{array}\end{array}\right)$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd><mml:mtd columnalign="left"><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq54"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{I}}}}}}$$\end{document}</tex-math><mml:math id="M134"><mml:mi mathvariant="bold-italic">I</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq54.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq55"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M136"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq55.gif"/></alternatives></inline-formula>-dimensional identity matrix, and <inline-formula id="IEq56"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\underline{0}$$\end{document}</tex-math><mml:math id="M138"><mml:munder accentunder="true"><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq56.gif"/></alternatives></inline-formula> is an <italic>r</italic>-dimension zero matrix. In fact, the <inline-formula id="IEq57"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Omega }}}}}}$$\end{document}</tex-math><mml:math id="M140"><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq57.gif"/></alternatives></inline-formula> defined this way is a representation of order <inline-formula id="IEq58"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2$$\end{document}</tex-math><mml:math id="M142"><mml:mn>2</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq58.gif"/></alternatives></inline-formula> cyclic group <inline-formula id="IEq59"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{G}}}}}}}_{2}$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq59.gif"/></alternatives></inline-formula>. <inline-formula id="IEq60"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{G}}}}}}}_{2}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq60.gif"/></alternatives></inline-formula> has only two elements: <inline-formula id="IEq61"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e$$\end{document}</tex-math><mml:math id="M148"><mml:mi>e</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq61.gif"/></alternatives></inline-formula> and <inline-formula id="IEq62"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}</tex-math><mml:math id="M150"><mml:mi>g</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq62.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq63"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${g}^{2}=e$$\end{document}</tex-math><mml:math id="M152"><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>e</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq63.gif"/></alternatives></inline-formula>. This notation is useful when we make extension to the scenario with multiple consecutive mismatches. The <inline-formula id="IEq64"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq64.gif"/></alternatives></inline-formula> will be extended to <inline-formula id="IEq65"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb{R}}}^{2r}$$\end{document}</tex-math><mml:math id="M156"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq65.gif"/></alternatives></inline-formula> accordingly, with the first <inline-formula id="IEq66"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><mml:math id="M158"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq66.gif"/></alternatives></inline-formula> dimensions filled with the values derived from the MDS embedding and the remaining dimensions filled with a vector of zeros:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}^{2r}=\left(\begin{array}{l}\begin{array}{l}{\beta }_{i}\\ 0\end{array}\end{array}\right)$$\end{document}</tex-math><mml:math id="M160"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par38">Here, 0 is a vector of zeros with dimension <italic>r</italic>. The new vector satisfies:<disp-formula id="Equf"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}^{2{r}^{T}}{{{{{\boldsymbol{\Omega}}}}}}_{2}{\beta }_{j}^{2r}=\left({\beta }_{i}^{T},{{{{{\bf{0}}}}}}^{T}\right)\left(\begin{array}{l}\begin{array}{ll}{{{\underline{{{\bf{0}}}}}}} &amp; {{{{{\boldsymbol{I}}}}}}\\ {{{{{\boldsymbol{I}}}}}} &amp; {{{\underline{{{\bf{0}}}}}}}\end{array}\end{array}\right)\left(\begin{array}{l}\begin{array}{l}{\beta }_{j}\\ {{{{\bf{0}}}}}\end{array}\end{array}\right)=\left({\beta }_{i}^{T},\; {{{{{\bf{0}}}}}}^{T}\right)\left(\begin{array}{l}\begin{array}{l}{{{{{\bf{0}}}}}}\\ {\beta }_{j}\end{array}\end{array}\right)=0$$\end{document}</tex-math><mml:math id="M162"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd><mml:mtd columnalign="left"><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="bold">0</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.16em"/><mml:msup><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="bold">0</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><graphic xlink:href="41467_2021_25006_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par39"><italic>Case 3</italic>: Multiple Consecutive Mismatches</p>
        <p id="Par40">It can be proven that for a sequence <inline-formula id="IEq67"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}={{{{{{\boldsymbol{A}}}}}}}_{{i}_{k}}{{{{{{\boldsymbol{A}}}}}}}_{{i}_{k-1}}\ldots {{{{{{\boldsymbol{A}}}}}}}_{{i}_{1}},k\ge 3$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq67.gif"/></alternatives></inline-formula>, its encoding vector can be written as:<disp-formula id="Equg"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i}=\mathop{\sum }\limits_{l=1}^{k}{{{{{\boldsymbol{\Omega}}}}}}^{l}{\beta }_{{i}_{l}},l=1,2,\ldots ,k$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:math><graphic xlink:href="41467_2021_25006_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par41">Let’s consider another sequence <inline-formula id="IEq68"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{j}={{{{{{\boldsymbol{A}}}}}}}_{{j}_{k}}{{{{{{\boldsymbol{A}}}}}}}_{{j}_{k-1}}\ldots {{{{{{\boldsymbol{A}}}}}}}_{{j}_{1}}$$\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq68.gif"/></alternatives></inline-formula>:<disp-formula id="Equh"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}=\mathop{\sum }\limits_{l=1}^{k}{{{{{\boldsymbol{\Omega}}}}}}^{l}{\beta }_{{j}_{l}}\,l=1,2,\ldots ,k$$\end{document}</tex-math><mml:math id="M170"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:math><graphic xlink:href="41467_2021_25006_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>The distance of <inline-formula id="IEq69"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i}$$\end{document}</tex-math><mml:math id="M172"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq69.gif"/></alternatives></inline-formula> and <inline-formula id="IEq70"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq70.gif"/></alternatives></inline-formula> is:<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Vert {x}_{i}-{x}_{j}\Vert =\mathop{\sum }\limits_{l=1}^{k}{({\beta }_{{i}_{l}}-{\beta }_{{j}_{l}})}^{T}({\beta }_{{i}_{l}}-{\beta }_{{j}_{l}})-2\mathop{\sum }\limits_{u=2}^{k}\mathop{\sum}\limits_{1\le v &lt; u}^{K}{({\beta }_{{i}_{u}}-{\beta }_{{j}_{u}})}^{T}{({\varOmega }^{u})}^{T}({{{{{{\boldsymbol{\Omega }}}}}}}^{v})({\beta }_{{i}_{v}}-{\beta }_{{j}_{v}})$$\end{document}</tex-math><mml:math id="M176"><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∥</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>v</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>In the ideal scenario, all the terms in the double <inline-formula id="IEq71"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum$$\end{document}</tex-math><mml:math id="M178"><mml:mo>∑</mml:mo></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq71.gif"/></alternatives></inline-formula> are <inline-formula id="IEq72"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0$$\end{document}</tex-math><mml:math id="M180"><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq72.gif"/></alternatives></inline-formula>, and the distance between <inline-formula id="IEq73"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq73.gif"/></alternatives></inline-formula> and <inline-formula id="IEq74"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{j}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq74.gif"/></alternatives></inline-formula> is simply <inline-formula id="IEq75"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sum }_{l=1}^{k}{M}_{{i}_{l}{j}_{l}}$$\end{document}</tex-math><mml:math id="M186"><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq75.gif"/></alternatives></inline-formula>. This requires:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${({\beta }_{{i}_{u}}-{\beta }_{{j}_{u}})}^{T}{{{{{\boldsymbol{\Omega}}}}}}^{u-v}({\beta }_{{i}_{v}}-{\beta }_{{j}_{v}})$$\end{document}</tex-math><mml:math id="M188"><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>v</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>is <inline-formula id="IEq76"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0$$\end{document}</tex-math><mml:math id="M190"><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq76.gif"/></alternatives></inline-formula> for <inline-formula id="IEq77"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall u,v,k$$\end{document}</tex-math><mml:math id="M192"><mml:mo>∀</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq77.gif"/></alternatives></inline-formula>. Or, generally: <inline-formula id="IEq78"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}^{T}{{{{{{\boldsymbol{\Omega }}}}}}}^{u-v}y=0$$\end{document}</tex-math><mml:math id="M194"><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq78.gif"/></alternatives></inline-formula> for <inline-formula id="IEq79"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall x,y\in {{\mathbb{R}}}^{r}$$\end{document}</tex-math><mml:math id="M196"><mml:mo>∀</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq79.gif"/></alternatives></inline-formula>. There is no solution for such an <inline-formula id="IEq80"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Omega }}}}}}$$\end{document}</tex-math><mml:math id="M198"><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq80.gif"/></alternatives></inline-formula> in <inline-formula id="IEq81"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb{R}}}^{r}$$\end{document}</tex-math><mml:math id="M200"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq81.gif"/></alternatives></inline-formula>, but similar to <italic>Case 2</italic>, we may increase the dimensionality of the embedding space to <inline-formula id="IEq82"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$kr$$\end{document}</tex-math><mml:math id="M202"><mml:mi>k</mml:mi><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq82.gif"/></alternatives></inline-formula>. In this way, one can always construct <inline-formula id="IEq83"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Omega }}}}}}$$\end{document}</tex-math><mml:math id="M204"><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq83.gif"/></alternatives></inline-formula> from <inline-formula id="IEq84"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M206"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq84.gif"/></alternatives></inline-formula> order cyclic group <inline-formula id="IEq85"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{G}}}}}}}_{{{{{{\rm{n}}}}}}}$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq85.gif"/></alternatives></inline-formula>, which is an Abel group. However, increased dimensionality will increase the computational complexity in the encoding step by a factor of <inline-formula id="IEq86"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(k)$$\end{document}</tex-math><mml:math id="M210"><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq86.gif"/></alternatives></inline-formula>. Also, even with the exact solution, the distance calculated by MDS embedding does not perfectly align with BLOSUM62 scores. Therefore, there is a trade-off to increase dimensionality. In practice, we set <inline-formula id="IEq87"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M212"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq87.gif"/></alternatives></inline-formula> to be 6. This is a reasonable number considering the median length of T cell CDR3 sequences is 14, with the first 4 and last 1 amino acids almost invariant. To construct the corresponding matrix, we first derive a representation of the element in <inline-formula id="IEq88"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{G}}}}}}}_{3}$$\end{document}</tex-math><mml:math id="M214"><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq88.gif"/></alternatives></inline-formula> by:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\Omega }}}}}}}_{3}=\left(\begin{array}{l}\begin{array}{lll}{{{\underline{{{\bf{0}}}}}}} &amp; {{{\underline{{{\bf{0}}}}}}} &amp; {{{{{\boldsymbol{I}}}}}}\\ {{{{{\boldsymbol{I}}}}}} &amp; {{{\underline{{{\bf{0}}}}}}} &amp; {{{\underline{{{\bf{0}}}}}}}\\ {{{\underline{{{\bf{0}}}}}}} &amp; {{{{{\boldsymbol{I}}}}}} &amp; {{{\underline{{{\bf{0}}}}}}}\end{array}\end{array}\right)$$\end{document}</tex-math><mml:math id="M216"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd><mml:mtd columnalign="left"><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd><mml:mtd columnalign="left"><mml:mi mathvariant="bold-italic">I</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par42">Both <inline-formula id="IEq89"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{G}}}}}}}_{2}$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq89.gif"/></alternatives></inline-formula> and <inline-formula id="IEq90"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{G}}}}}}}_{3}$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq90.gif"/></alternatives></inline-formula> are normal subgroups of <inline-formula id="IEq91"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{G}}}}}}}_{6}$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq91.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq92"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\rm{G}}}}}}}_{6}={{{{{{\rm{G}}}}}}}_{2}\otimes {{{{{{\rm{G}}}}}}}_{3}$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">G</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq92.gif"/></alternatives></inline-formula>. Therefore, from <inline-formula id="IEq93"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\Omega }}}}}}}_{2}$$\end{document}</tex-math><mml:math id="M226"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq93.gif"/></alternatives></inline-formula> and <inline-formula id="IEq94"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\Omega }}}}}}}_{3}$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq94.gif"/></alternatives></inline-formula> we can easily construct <inline-formula id="IEq95"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\Omega }}}}}}}_{6}$$\end{document}</tex-math><mml:math id="M230"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq95.gif"/></alternatives></inline-formula>:<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Omega }}}}}}_{6} = \left(\begin{array}{lll}{\underline{{{\underline{{{\bf{0}}}}}}}} \quad {\underline{{{\underline{{{\bf{0}}}}}}}} \quad {{{{{\boldsymbol{\Omega}}}}}}_{2}\\ {{{{{\boldsymbol{\Omega}}}}}}_{2} \quad {\underline{{{\underline{{{\bf{0}}}}}}}} \quad {\underline{{{\underline{{{\bf{0}}}}}}}}\\ {\underline{{{\underline{{{\bf{0}}}}}}}} \quad {{{{{\boldsymbol{\Omega}}}}}}_{2} \quad {\underline{{{\underline{{{\bf{0}}}}}}}}\end{array}\right)$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder><mml:mspace width="1.0em"/><mml:munder accentunder="true"><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder><mml:mspace width="1.0em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="1.0em"/><mml:munder accentunder="true"><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder><mml:mspace width="1.0em"/><mml:munder accentunder="true"><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:munder accentunder="true"><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder><mml:mspace width="1.0em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="1.0em"/><mml:munder accentunder="true"><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par43">Here <inline-formula id="IEq96"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\underline{\underline{0}}$$\end{document}</tex-math><mml:math id="M234"><mml:munder accentunder="true"><mml:mrow><mml:munder accentunder="true"><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mrow></mml:munder></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq96.gif"/></alternatives></inline-formula> is a zero matrix with dimension <inline-formula id="IEq97"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2r$$\end{document}</tex-math><mml:math id="M236"><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq97.gif"/></alternatives></inline-formula>. Accordingly, the MDS embedding vectors become:<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}^{6r}={({\beta }_{i}^{T},{{{{{\bf{0}}}}}}^{T},{{{{{\bf{0}}}}}}^{T},{{{{{\bf{0}}}}}}^{T},{{{{{\bf{0}}}}}}^{T},{{{{{\bf{0}}}}}}^{T})}^{T}$$\end{document}</tex-math><mml:math id="M238"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">0</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par44">With this representation, the terms in the double <inline-formula id="IEq98"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum$$\end{document}</tex-math><mml:math id="M240"><mml:mo>∑</mml:mo></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq98.gif"/></alternatives></inline-formula> in Eq.(<xref rid="Equ10" ref-type="">10</xref>) are 0 when <inline-formula id="IEq99"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u-v\, &lt; \, 6$$\end{document}</tex-math><mml:math id="M242"><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mspace width="0.25em"/><mml:mo>&lt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>6</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq99.gif"/></alternatives></inline-formula>. So what happens when <inline-formula id="IEq100"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-v\ge 6$$\end{document}</tex-math><mml:math id="M244"><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo>≥</mml:mo><mml:mn>6</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq100.gif"/></alternatives></inline-formula>, i.e. the two strings have more than 6 consecutive mismatches, if we apply <inline-formula id="IEq101"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\Omega }}}}}}}_{6}$$\end{document}</tex-math><mml:math id="M246"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq101.gif"/></alternatives></inline-formula> as the transformation matrix? It will introduce unwanted variance to the final distance only when <inline-formula id="IEq102"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u-v=6{{{{{\rm{n}}}}}}$$\end{document}</tex-math><mml:math id="M248"><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn><mml:mi mathvariant="normal">n</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq102.gif"/></alternatives></inline-formula>, where n is an integer. We name <inline-formula id="IEq103"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u-v\,\ne\, 6{{{{{\rm{n}}}}}}$$\end{document}</tex-math><mml:math id="M250"><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mspace width="0.25em"/><mml:mo>≠</mml:mo><mml:mspace width="0.25em"/><mml:mn>6</mml:mn><mml:mi mathvariant="normal">n</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq103.gif"/></alternatives></inline-formula> as the Non-Identity Condition (NIC). Depending on the vectors on each side of the matrix, the addition can be either positive or negative. However, when comparing CDR3 sequences with more than 6 mismatches, it is usually not important what the exact distance between them is. This is because only the sequences with highest similarities will be selected as antigen-specific TCR clusters, and at the desirable cutoff of the alignment score, the number of mismatches between two CDR3 sequences is usually smaller than 3.</p>
        <p id="Par45">Case 4: Non-consecutive Mismatches.</p>
        <p id="Par46">Without losing generality, we assume that the two sequences of interest, <inline-formula id="IEq104"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq104.gif"/></alternatives></inline-formula> and <inline-formula id="IEq105"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{j}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq105.gif"/></alternatives></inline-formula>, both with length <inline-formula id="IEq106"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M256"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq106.gif"/></alternatives></inline-formula>, differ at the first and last positions, such that: <inline-formula id="IEq107"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{i}={{{{{{\boldsymbol{A}}}}}}}_{{i}_{k}}{{{{{{\boldsymbol{A}}}}}}}_{{i}_{k-1}}\ldots {{{{{{\boldsymbol{A}}}}}}}_{{i}_{2}}{{{{{{\boldsymbol{A}}}}}}}_{{i}_{1}},k\ge 3$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq107.gif"/></alternatives></inline-formula> and <inline-formula id="IEq108"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{j}={{{{{{\boldsymbol{A}}}}}}}_{{j}_{k}}{{{{{{\boldsymbol{A}}}}}}}_{{i}_{k-1}}\ldots {{{{{{\boldsymbol{A}}}}}}}_{{i}_{2}}{{{{{{\boldsymbol{A}}}}}}}_{{j}_{1}},k\ge 3$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>3</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq108.gif"/></alternatives></inline-formula>. The isometric coordinates after transformation are:<disp-formula id="Equi"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i}=\mathop{\sum }\limits_{l=1}^{k}{{{{{{\boldsymbol{\Omega }}}}}}}^{l}{\beta }_{{i}_{l}},l=1,2,\ldots ,k$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:math><graphic xlink:href="41467_2021_25006_Article_Equi.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equj"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}=\mathop{\sum }\limits_{l=2}^{k-1}{{{{{{\boldsymbol{\Omega }}}}}}}^{l}{\beta }_{{j}_{l}}+{{{{{{\boldsymbol{\Omega }}}}}}}^{k}{\beta }_{{j}_{k}}+{{{{{\boldsymbol{\Omega }}}}}}{\beta }_{{j}_{1}}$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">Ω</mml:mi><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><graphic xlink:href="41467_2021_25006_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par47">Their distance can be calculated:<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Vert {x}_{i}-{x}_{j}\Vert ={({\beta }_{{i}_{1}}-{\beta }_{{j}_{1}})}^{T}({\beta }_{{i}_{1}}-{\beta }_{{j}_{1}})+{({\beta }_{{i}_{k}}-{\beta }_{{j}_{k}})}^{T}({\beta }_{{i}_{k}}-{\beta }_{{j}_{k}})-2{({\beta }_{{i}_{1}}-{\beta }_{{j}_{1}})}^{T}{({{{{{\boldsymbol{\Omega }}}}}})}^{T}({{{{{{\boldsymbol{\Omega }}}}}}}^{k})({\beta }_{{i}_{k}}-{\beta }_{{j}_{k}})$$\end{document}</tex-math><mml:math id="M266"><mml:mo>∥</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∥</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par48">This is similar to <italic>Case 3</italic>, where we handle multiple consecutive mismatches, except that the number of cross terms is smaller, which can be written as:<disp-formula id="Equk"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-2{({\beta }_{{i}_{1}}-{\beta }_{{j}_{1}})}^{T}({{{{{{\boldsymbol{\Omega }}}}}}}^{k-1})({\beta }_{{i}_{k}}-{\beta }_{{j}_{k}})$$\end{document}</tex-math><mml:math id="M268"><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2021_25006_Article_Equk.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par49">When <inline-formula id="IEq109"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\boldsymbol{\Omega }}}}}}$$\end{document}</tex-math><mml:math id="M270"><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq109.gif"/></alternatives></inline-formula> is selected as <inline-formula id="IEq110"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{\boldsymbol{\Omega }}}}}}}_{6}$$\end{document}</tex-math><mml:math id="M272"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq110.gif"/></alternatives></inline-formula>, similar to <italic>Case 3</italic>, the cross term is always <inline-formula id="IEq111"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0$$\end{document}</tex-math><mml:math id="M274"><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq111.gif"/></alternatives></inline-formula> as long as NIC is observed. However, if NIC is violated, i.e. the two mismatches are exactly six amino acids apart, the cross term becomes non-zero. We need to evaluate the impact of this term to the final outcome. First, if the cross term remains negative (with probability 1/2), the estimated isometric distance will be smaller than the exact value, which will not affect the outcome, as we will apply the stringent Smith–Waterman alignment to ensure high sequence similarity (section 3). It can be shown that, for CDR3s with length 16, with first 3 and last 2 clipped, the chance of having two mismatches exactly 6 amino acids apart is <inline-formula id="IEq112"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{5}{({{11}\atop {2}})}=0.091$$\end{document}</tex-math><mml:math id="M276"><mml:mfrac><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac linethickness="0"><mml:mrow><mml:mn>11</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0.091</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq112.gif"/></alternatives></inline-formula>, which is the maximum among all the lengths. Therefore, violation of NIC will affect at most 0.091/2 = 4.6% of the comparisons with two mismatches. When this happens, somewhat similar sequences will have larger distance and might be excluded from the downstream clustering. To mitigate this effect, we applied a relatively large default isometric distance cutoff (-t 10) to be inclusive. The current choice of parameterization is a balance between clustering accuracy and computation speed.</p>
      </sec>
      <sec id="Sec12">
        <title>Nearest neighbor centroid clustering</title>
        <p id="Par50">The approximate isometric embedding of CDR3 sequences allows efficient search of their nearest neighbors (NN) in the Euclidean space for fast clustering. We used a python package Facebook AI Similarity Search, or <italic>faiss</italic><sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, to perform fast indexed-NN search. To find the nearest neighbor of one of the N numeric vectors in <inline-formula id="IEq113"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\mathbb{R}}}^{r}$$\end{document}</tex-math><mml:math id="M278"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq113.gif"/></alternatives></inline-formula>, the time complexity of <italic>faiss</italic> is <italic>O</italic>(<italic>rlog</italic>(<italic>N</italic>)).</p>
        <p id="Par51">We used the following strategy to divide the coordinates of CDR3s (<italic>x</italic>) into neighboring clusters. Before clustering, identical CDR3s were grouped together. First, for each unique sequence <inline-formula id="IEq114"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i},i=1,2,\ldots ,N$$\end{document}</tex-math><mml:math id="M280"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq114.gif"/></alternatives></inline-formula>, we found its nearest neighbor <inline-formula id="IEq115"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j},j=1,2,\ldots ,N;j\ne i$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>;</mml:mo><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq115.gif"/></alternatives></inline-formula>. If the distance between <inline-formula id="IEq116"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i}$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq116.gif"/></alternatives></inline-formula> and <inline-formula id="IEq117"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}$$\end{document}</tex-math><mml:math id="M286"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq117.gif"/></alternatives></inline-formula> was within a user-defined cutoff (-t option, <italic>thr</italic>), the two points were merged as a new point, with the centroid <inline-formula id="IEq118"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{x}_{i}+{x}_{j}}{2}$$\end{document}</tex-math><mml:math id="M288"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq118.gif"/></alternatives></inline-formula> as the new coordinate. If the distance exceeded the cutoff, both points were removed from iteration. There would be two types of removed points: (1) point containing only one CDR3 sequence; (2) point as a centroid of multiple CDR3s. A CDR3 pre-cluster was recorded for each of the second type of points. The above steps were repeated until the number of points reached to zero or did not further decrease. CDR3s with different lengths were separately clustered. All pre-clusters were kept for further filtering.</p>
      </sec>
      <sec id="Sec13">
        <title>K-mer guided fast Smith–Waterman alignment with TCR variable gene matching</title>
        <p id="Par52">CDR3s from a pre-cluster are usually highly similar, but they may not qualify as antigen-specific groups because (1) sequences may not be similar enough due to imperfect isometric embedding; (2) TCR variable (TRBV) gene information was not taken into consideration. We therefore performed a filtering step to select antigen-specific CDR3 clusters based on Smith–Waterman alignment, and TRBV gene matching.</p>
        <p id="Par53">The size (<italic>m</italic>) of pre-clusters can be large, and direct pairwise comparison will result in quadratic complexity <italic>O</italic>(<italic>m</italic><sup>2</sup>). We first applied the TRBV information to reduce cluster size. Specifically, we used a pre-calculated matrix<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> of alignment scores between a pair of TRBV alleles. For each pair of CDR3 sequences in the pre-cluster, we compared their TRBV alleles. If the score was above a user-defined (-G option, <italic>thr_v</italic>), an edge was added between the two sequences. We ran depth-first search (dfs) on the final graph to generate isolated subgraphs, with each subgraph a new pre-cluster. This step will split the original pre-cluster into several smaller ones.</p>
        <p id="Par54">Next, we used a k-mer approach to perform Smith–Waterman alignment. For each CDR3 sequence, we divided it into consecutive 5-mers. A k-mer dictionary was built to store all the sequences, with keys being unique 5-mers, and the values being the CDR3s that contain the given 5-mer. We allowed one mismatch in the 5-mer when building the dictionary. For example, sequence CASSGVTEAFF is indexed under both SSGVT and SSVAT. In this way, CDR3 sequences were connected into a graph via shared k-mers. For each edge in this graph, we ran Smith–Waterman alignment with BLOSUM62 substitution matrix and calculated the alignment score. If the score is below a user-defined cutoff (-S option, <italic>thr_s</italic>), the edge will be removed. The actual complexity of this step can vary from <italic>O</italic>(<italic>m</italic>) to <italic>O</italic>(<italic>m</italic><sup>2</sup>). The worse scenario is reached when every pair of CDR3s in a pre-cluster share similar k-mer motifs. We then ran dfs on the final graph to generate the final CDR3 clusters and report them as the final output.</p>
      </sec>
    </sec>
    <sec id="Sec14">
      <title>Query of new TCR-seq samples against existing reference</title>
      <p id="Par55">After the generation of TCR clusters of an input dataset, GIANA can perform query of additional TCRs to this data (the reference). In the query mode, GIANA requires the input of the query file(s), the original reference data, and the clustered reference data. First, the original reference and query TCRs were converted into isometric coordinates. Fast nearest neighbor search by <italic>faiss</italic> was then implemented, but limited to the query TCRs. TCRs with distances smaller than a user-defined cutoff (-t option, <italic>thr</italic>) were exported into a separate file (tmp_query.txt). This file contains all the TCRs that could possibly cluster with the query sequences. GIANA clustering was subsequently performed on this file to generate the TCR clusters satisfying the stringent cutoffs for Smith–Waterman alignment. The query TCR clusters were then merged with the reference clusters in the following way: for each query cluster, if any of the sequence came from an existing cluster in the reference data, the two clusters will be merged. This step is to ensure the inclusion of all the neighboring TCRs in the reference data. Under two conditions when a query cluster did not contain any sequence in the reference cluster: (1) all TCRs in the query cluster were similar, but private to the query sample; (2) query TCR was similar to some very rare reference TCRs, which were not clustered with any other reference samples in the original clustering. Following either condition, the query cluster was included in the final output.</p>
      <p id="Par56">We evaluated the time cost of the query mode by generating reference data containing 200 K, 1 M, 2 M, 6 M, and 10 M TCRs. We scanned different sizes of the query data, including 10 K, 20 K, 30 K, 40 K, and 50 K TCRs. Each query file was clustered against each of the reference data using a MacBook Pro computer with 3.5 GHz Dual-Core Intel Core i7 processor, and 16GB 2133 MHz LPDDR3 memory. Elapsed time was estimated using the <italic>time</italic> module of python.</p>
    </sec>
    <sec id="Sec15">
      <title>GIANA with stacked-vector encoding (GIANAsv)</title>
      <p id="Par57">After MDS embedding of the 20 amino acids, the easiest way to obtain an isometric representation of a CDR3 string: <inline-formula id="IEq119"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\rm{s}}}}}}={A}_{1}{A}_{2}\ldots {A}_{{{{{{\rm{k}}}}}}},k\ge 5$$\end{document}</tex-math><mml:math id="M290"><mml:mi mathvariant="normal">s</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>5</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq119.gif"/></alternatives></inline-formula>, is to construct a “stacked vector”, i.e. to concatenate the embedding vectors <inline-formula id="IEq120"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i},i=1,2,\ldots ,k$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq120.gif"/></alternatives></inline-formula>, in the same order. This approach is referred as GIANAsv. The stacked vector representation is <inline-formula id="IEq121"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x={({\beta }_{1}^{T},{\beta }_{2}^{T},\ldots ,{\beta }_{k}^{T})}^{T}$$\end{document}</tex-math><mml:math id="M294"><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq121.gif"/></alternatives></inline-formula>. It is easy to prove that this representation satisfies all the desirable qualities of the three cases discussed in the above section. Theoretically, when focusing only on sequences with six or fewer mismatches, the two approaches are identical. When CDR3s have more than six mismatches, GIANAsv is more accurate, but this scenario is not relevant to this context. The disadvantage of GIANAsv is that the dimension <inline-formula id="IEq122"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{{{{{{\mathrm{GIANAsv}}}}}}}$$\end{document}</tex-math><mml:math id="M296"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">GIANAsv</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq122.gif"/></alternatives></inline-formula> of the embedding vector is larger than that of GIANA (<inline-formula id="IEq123"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{{{{{{\mathrm{GIANA}}}}}}}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">GIANA</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq123.gif"/></alternatives></inline-formula>). For GIANA, <inline-formula id="IEq124"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{{{{{{\mathrm{GIANA}}}}}}}\equiv 6\times 16=96$$\end{document}</tex-math><mml:math id="M300"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">GIANA</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mn>6</mml:mn><mml:mo>×</mml:mo><mml:mn>16</mml:mn><mml:mo>=</mml:mo><mml:mn>96</mml:mn></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq124.gif"/></alternatives></inline-formula>. For GIANAsv, <inline-formula id="IEq125"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{{{{{{\mathrm{GIANAsv}}}}}}}$$\end{document}</tex-math><mml:math id="M302"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">GIANAsv</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq125.gif"/></alternatives></inline-formula> varies with different CDR3 length (typically 12–17 amino acids), which can be 2–3 times larger than <inline-formula id="IEq126"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{{{{{{\mathrm{GIANA}}}}}}}$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">GIANA</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2021_25006_Article_IEq126.gif"/></alternatives></inline-formula>. Increased dimensionality results in higher memory burden and longer computational time for <italic>faiss</italic>.</p>
    </sec>
    <sec id="Sec16">
      <title>Computational complexity comparison of GIANA, GIANAsv, iSMART, GLIPH2, and TCRdist</title>
      <p id="Par58">Other published TCR clustering methods were downloaded to compare with GIANA, including iSMART, GLIPH2 and TCRdist. We excluded the original version of GLIPH<sup><xref ref-type="bibr" rid="CR2">2</xref></sup> from this comparison, as GLIPH2 is an improved version with higher computational efficacy and covering all the functionalities of GLIPH. We used the TCR repertoire sequencing data of a healthy donor of a previous study<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, HIP13900, to test the performances. TCR clones were ordered based on their abundance, and the top 10 K, 20 K, …, 100 K sequences were selected. All five methods were applied to each of the subsamples. GIANA, GIANAsv, iSMART, and GLIPH2 were implemented using the default parameters. TCRdist does not provide clustering, and only pairwise distances were calculated under the default setting. All methods were run on a MacBook Pro computer with 3.5 GHz Dual-Core Intel Core i7 processor, and 16GB 2133 MHz LPDDR3 memory. All methods were applied using a single thread on CPU. When clustering the reference data of 10 million sequences, we implemented GIANA on the dataset using a high-performance computing (HPC) super cluster, with 128 G memory allocation and 8 CPU nodes. Links to the software compared in this work are listed below:</p>
      <p id="Par59">iSMART: <ext-link ext-link-type="uri" xlink:href="https://github.com/s175573/DeepCAT/blob/master/iSMARTm.py">https://github.com/s175573/DeepCAT/blob/master/iSMARTm.py</ext-link></p>
      <p id="Par60">TCRdist: <ext-link ext-link-type="uri" xlink:href="https://github.com/phbradley/tcr-dist">https://github.com/phbradley/tcr-dist</ext-link></p>
      <p id="Par61">GLIPH2: <ext-link ext-link-type="uri" xlink:href="http://50.255.35.37:8080/tools">http://50.255.35.37:8080/tools</ext-link></p>
    </sec>
    <sec id="Sec17">
      <title>Estimation of clustering antigen-specificity of GIANA, iSMART, GLIPH2, and TCRdist</title>
      <p id="Par62">TCRs specific to known epitopes were collected from the Immune Epitope Database and Analysis Resource (IEDB)<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>, the VDJdb online browser<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>, and recent literature<sup><xref ref-type="bibr" rid="CR1">1</xref>,<xref ref-type="bibr" rid="CR13">13</xref></sup>. We kept only TCRβ CDR3 sequences, TRBV genes, and their associated antigens. After removal of redundant or incomplete sequences, we obtained a total of 61,366 CDR3s, covering ~900 epitopes from diverse pathogens. All four methods were applied to the dataset to perform antigen-specific clustering using their default parameters. For TCRdist, we wrote the R code to perform depth-first search on the sequence pairs with distances smaller than 11. To date, the time complexity calculation for TCRdist in the previous section did not include the depth-first search to find TCR clusters. This cutoff of 11 has balanced sensitivity and specificity, comparable to that of iSMART. Choosing a larger cutoff will increase the total number of clustered TCRs, at the cost of lower specificity of each cluster.</p>
      <p id="Par63">In this work, we first defined the clusters with all the TCRs specific to the same antigen as “pure clusters”. Pure cluster retention was defined as the total number of TCRs contained in all the pure clusters divided by the total number of sequences (60,700 after removal of epitopes with only 1 TCR):<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathrm{Retention}}}}}}=\frac{{{{{{\mathrm{\#TCRs}}}}}}\,{{{{{\mathrm{in}}}}}}\,{{{{{\mathrm{all}}}}}}\,{{{{{\mathrm{pure}}}}}}\,{{{{{\mathrm{clusters}}}}}}}{{{{{{\mathrm{\#Total}}}}}}\,{{{{{\mathrm{TCRs}}}}}}}$$\end{document}</tex-math><mml:math id="M306"><mml:mi mathvariant="normal">Retention</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">#TCRs</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">in</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">all</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">pure</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">clusters</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">#Total</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">TCRs</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par64">We also defined pure cluster fraction as the number of pure clusters divided by the number of total clusters:<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{\mathrm{Fraction}}}}}}=\frac{{\scriptstyle{\#}}{{{{{\mathrm{Pure}}}}}}\,{{{{{\mathrm{clusters}}}}}}}{{{{{{\mathrm{\#Total}}}}}}\,{{{{{\mathrm{clusters}}}}}}}$$\end{document}</tex-math><mml:math id="M308"><mml:mi mathvariant="normal">Fraction</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>#</mml:mi><mml:mi mathvariant="normal">Pure</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">clusters</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">#Total</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">clusters</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2021_25006_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par65">Normalized mutual information (NMI) is defined as twice the mutual information between a TCR cluster and antigen specificity divided by the sum of their entropies. Some CDR3s may occur in multiple clusters in GLIPH2 output. We calculated the NMI for each TCR cluster and took the averaged value. Although clusters were not independent due to recurrent TCRs, this approach is asymptotically unbiased with bounded variance under the weak law of large numbers. The same approach was used for NMI calculation for all the methods.</p>
    </sec>
    <sec id="Sec18">
      <title>Performance evaluation of antigen-specific TCR identification in TCR-seq data</title>
      <p id="Par66">We performed in silico mixing experiments to assess the performance of GIANA in finding TCRs specific to known antigens. We selected three antigens that are unlikely exposed to healthy donors: the YAW and YLQ epitopes from the Severe Acute Respiratory Syndrome Coronavirus-2 (SARS-CoV-2)<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> and the FRD epitope from the Human Immunodeficiency Virus-1 (HIV-1)<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. TCRs specific to each epitope were selected, with redundancy removed. For each antigen, we randomly sampled 20% of TCRs (testing data) and mixed them with the 100 K sequences from healthy donor HIP13900. There was no overlap between the remaining 80% of antigen-specific TCRs (training data) and the testing data. The mixed sample was considered to be a pseudo-patient carrying the corresponding pathogen. We combined the mixed sample with the training data and applied GIANA with Smith–Waterman alignment score cutoff (<italic>thr_s</italic>) ranging from 3.0 to 4.0 (0.1 increment). For each epitope and parameter setting, we ran 20 times of in silico mixing to capture the variations in the data.</p>
      <p id="Par67">From the resulting data, we evaluated the prediction performance. We selected the TCR clusters with at least one TCR from the training data. All the TCRs in these clusters, excluding training data, were positive calls. All TCRs that were not co-clustered with any training TCR were negative calls. True-positive calls were defined as sequences labeled as “testing data”, whereas true-negative calls were sequences from the original 100 K TCRs of the healthy donor. Specificity was defined as the number of true-negative calls divided by 100 K. Sensitivity was defined as the number of true-positive calls divided by the total number of testing TCRs.</p>
    </sec>
    <sec id="Sec19">
      <title>Reference-based TCR repertoire classification</title>
      <p id="Par68">To test the feasibility of repertoire classification using TCR clustering, we combined 10, 50, and 100 COVID-19 samples<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> (Table <xref rid="MOESM1" ref-type="media">S4</xref>) with 10, 50, and 100 healthy controls<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> to generate 3 reference data with 20, 100, and 200 sample. Each sample contained 10 K TCRs, selected by ranking the clonal abundance. Query samples contained 154 COVID-19 patients<sup><xref ref-type="bibr" rid="CR20">20</xref></sup> and 120 HCs<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>. There was no overlap between query and reference samples. We generated the TCR clusters for each query sample using GIANA. For each sample, we first removed TCR clusters with more than 100 samples, as these TCRs were likely generated from small-world connections and not informative to disease specificity<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. For the remaining clusters, we calculated the fraction of reference TCRs contributed by the COVID-19 patients and used this quantity as the predictor.</p>
      <p id="Par69">In the multiple disease classification task, we first combined 712 cancer, 311 COVID-19, 25 multiple sclerosis (MS) patients, and 100 HC samples and produced a reference data of 10 M TCRs. We collected another 62 cancer, 193 COVID-19, 12 MS, and 153 HC samples to make the query, assuming the disease labels were unknown. Same analysis was performed for each query cluster file to estimate the fractions of each disease category, including HC. We used these fractions to predict diseases and performed the ROC analysis. Specifically, we used HC fractions for all the comparisons with HC samples. As an exploratory approach, for pairwise separation of the 3 diseases, we always used the difference between the two disease fractions. For example, when predicting cancer from MS patients, we used <italic>Cancer Fraction-MS Fraction</italic> as the predictor.</p>
    </sec>
    <sec id="Sec20">
      <title>Statistical analysis</title>
      <p id="Par70">We used the <italic>pROC</italic><sup><xref ref-type="bibr" rid="CR47">47</xref></sup> package of the R programming language<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> to generate the ROC curves and estimate the AUC values, with 95% confidence intervals computed by 2,000 stratified bootstrap replicates, implemented using the <italic>ci.auc</italic> function in the <italic>pROC</italic> package. <italic>t</italic>-statistic of Fig. <xref rid="Fig3" ref-type="fig">3c</xref> was produced using the <italic>t.test</italic> function, to perform two sample <italic>t</italic>-test using the COVID-19 fractions to separate the COVID-19 and HC query samples. Normalized mutual information (NMI) of a method was calculated as the averaged NMI of all the clusters predicted by the method and the true antigen labels. NMI will be maximized if all TCRs in a cluster are specific to only one antigen. Figure <xref rid="Fig4" ref-type="fig">4a</xref> was generated using the <italic>igraph</italic><sup><xref ref-type="bibr" rid="CR49">49</xref></sup> package. Heatmap with annotated values was produced using <italic>heatmap.2</italic> function in the <italic>gplots</italic> package. For all the boxplots displayed in the figures, the middle line defines the median value, with borders of the boxes indicating the 25% (Q1) and 75% (Q3) quartiles of the data. Lower and upper whiskers corresponded to Q1 – 1.5IQR and Q3 + 1.5IQR, where IQR is short for inter-quartile range.</p>
    </sec>
    <sec id="Sec21">
      <title>Software and package version information</title>
      <p id="Par71">R and packages: R: 3.5.1, pROC: 1.13.0, igraph: 1.2.4.2, gplots: 3.0.1.1</p>
      <p id="Par72">Python and modules: Python: 3.7.3, numpy: 1.18.1, faiss: 1.5.1, pandas: 0.25.3, sklearn: 0.22.1, biopython: 1.76</p>
    </sec>
    <sec id="Sec22">
      <title>Reporting summary</title>
      <p id="Par73">Further information on research design is available in the <xref rid="MOESM3" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec23">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2021_25006_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2021_25006_MOESM2_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2021_25006_MOESM3_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature Communications</italic> thanks the anonymous reviewers for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>9/3/2021</p>
      <p>A Correction to this paper has been published: 10.1038/s41467-021-25693-2</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-021-25006-7.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>This work is supported by the following funding sources: Cancer Prevention and Research Institute of Texas (CPRIT) RR170079 (B.L.), NCI 1R01CA245318 (B.L.), NIGMS 5R01GM126479 (X.Z.), and CPRIT RP190107 (X.Z.).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>B.L. and X.Z. conceived of this project. B.L. wrote the GIANA codebase. H.Z. and B.L. performed the benchmark analysis. B.L. wrote the manuscript together with X.Z. and H.Z.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The associated TCR-seq datasets, as well as metadata of the related samples are available at Zenodo<sup><xref ref-type="bibr" rid="CR50">50</xref></sup>. Accession links of the original TCR-seq datasets are provided in Tables <xref rid="MOESM1" ref-type="media">S4</xref> and <xref rid="MOESM1" ref-type="media">5</xref>. Immune Epitope Database was accessed via: <ext-link ext-link-type="uri" xlink:href="http://www.iedb.org/home_v3.php">http://www.iedb.org/home_v3.php</ext-link>. VDJdb was accessed via: <ext-link ext-link-type="uri" xlink:href="https://vdjdb.cdr3.net">https://vdjdb.cdr3.net</ext-link>.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>GIANA and GIANAsv source codes, R code to run GIANA visualization tree, and training datasets are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/s175573/GIANA">https://github.com/s175573/GIANA</ext-link><sup><xref ref-type="bibr" rid="CR51">51</xref></sup></p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par74">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dash</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantifiable predictive features define epitope-specific T cell receptor repertoires</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>547</volume>
        <fpage>89</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1038/nature22383</pub-id>
        <pub-id pub-id-type="pmid">28636592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Glanville</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying specificity groups in the T cell receptor repertoire</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>547</volume>
        <fpage>94</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1038/nature22976</pub-id>
        <pub-id pub-id-type="pmid">28636589</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becher</surname>
            <given-names>LRE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Public and private human T-cell clones respond differentially to HCMV antigen when boosted by CD3 copotentiation</article-title>
        <source>Blood Adv.</source>
        <year>2020</year>
        <volume>4</volume>
        <fpage>5343</fpage>
        <lpage>5356</lpage>
        <pub-id pub-id-type="doi">10.1182/bloodadvances.2020002255</pub-id>
        <pub-id pub-id-type="pmid">33125463</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Investigation of antigen-specific T-cell receptor clusters in human cancers</article-title>
        <source>Clin. Cancer Res.: Off. J. Am. Assoc. Cancer Res.</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>1359</fpage>
        <lpage>1371</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-19-3249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Mapping the functional landscape of T cell receptor repertoires by single-T cell transcriptomics</article-title>
        <source>Nat. Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <fpage>92</fpage>
        <lpage>99</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01020-3</pub-id>
        <pub-id pub-id-type="pmid">33408405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Huang, H., Wang, C., Rubelt, F., Scriba, T. J. &amp; Davis, M. M. Analyzing the Mycobacterium tuberculosis immune response by T-cell receptor clustering with GLIPH2 and genome-wide antigen screening. <italic>Nat. Biotechnol.</italic><bold>38</bold>, 1194–1202 (2020).</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bradley</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>PG</given-names>
          </name>
        </person-group>
        <article-title>Using T cell receptor repertoires to understand the principles of adaptive immune recognition</article-title>
        <source>Annu. Rev. Immunol.</source>
        <year>2019</year>
        <volume>37</volume>
        <fpage>547</fpage>
        <lpage>570</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-immunol-042718-041757</pub-id>
        <pub-id pub-id-type="pmid">30699000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Valkiers, S., Van Houcke, M., Laukens, K. &amp; Meysman, P. ClusTCR: a Python interface for rapid clustering of large sets of CDR3 sequences with unknown antigen specificity. <italic>Bioinformatics</italic> (2021).</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emerson</surname>
            <given-names>RO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Immunosequencing identifies signatures of cytomegalovirus exposure history and HLA-mediated effects on the T cell repertoire</article-title>
        <source>Nat. Genet.</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>659</fpage>
        <lpage>665</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3822</pub-id>
        <pub-id pub-id-type="pmid">28369038</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pogorelyy</surname>
            <given-names>MV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detecting T cell receptors involved in immune responses from single repertoire snapshots</article-title>
        <source>PLoS Biol.</source>
        <year>2019</year>
        <volume>17</volume>
        <fpage>e3000314</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.3000314</pub-id>
        <pub-id pub-id-type="pmid">31194732</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fleri</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The immune epitope database and analysis resource in epitope discovery and synthetic vaccine design</article-title>
        <source>Front. Immunol.</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>278</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2017.00278</pub-id>
        <pub-id pub-id-type="pmid">28352270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shugay</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>VDJdb: a curated database of T-cell receptor sequences with known antigen specificity</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>D419</fpage>
        <lpage>D427</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx760</pub-id>
        <pub-id pub-id-type="pmid">28977646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Zhang, S. Q. et al. High-throughput determination of the antigen specificities of T cell receptors in single cells. <italic>Nat. Biotechnol.</italic><bold>36</bold>, 1156–1159, 10.1038/nbt.4282 (2018).</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meysman</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>On the viability of unsupervised T-cell receptor sequence clustering for epitope preference</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>1461</fpage>
        <lpage>1468</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty821</pub-id>
        <pub-id pub-id-type="pmid">30247624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Adaptive Biotechnologies. ImmuneCode Release: <ext-link ext-link-type="uri" xlink:href="https://immunerace.adaptivebiotech.com/data/">https://immunerace.adaptivebiotech.com/data/</ext-link>. (2020).</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mukhopadhyay</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DNA vaccination by electroporation amplifies broadly cross-restricted public TCR clonotypes shared with HIV controllers</article-title>
        <source>J. Immunol.</source>
        <year>2017</year>
        <volume>199</volume>
        <fpage>3437</fpage>
        <lpage>3452</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.1700953</pub-id>
        <pub-id pub-id-type="pmid">28993513</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ostmeyer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Christley</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Toby</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Cowell</surname>
            <given-names>LG</given-names>
          </name>
        </person-group>
        <article-title>Biophysicochemical motifs in T-cell receptor sequences distinguish repertoires from tumor-infiltrating lymphocyte and adjacent healthy tissue</article-title>
        <source>Cancer Res.</source>
        <year>2019</year>
        <volume>79</volume>
        <fpage>1671</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-18-2292</pub-id>
        <pub-id pub-id-type="pmid">30622114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Beshnova, D. et al. De novo prediction of cancer-associated T cell receptors for noninvasive cancer detection. <italic>Sci. Transl. Med.</italic><bold>12</bold>, eaaz3738 (2020).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Gremmels, H. et al. Real-life validation of the PanbioTM COVID-19 antigen rapid test (Abbott) in community-dwelling subjects with symptoms of potential SARS-CoV-2 infection. <italic>EClinicalMedicine</italic><bold>31</bold>, 100677 (2020).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Snyder, T. M. et al. Magnitude and dynamics of the T-cell response to SARS-CoV-2 infection at both individual and population levels. Preprint at <italic>medRxiv</italic>10.1101/2020.07.31.20165647 (2020).</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emerson</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Estimating the ratio of CD4+ to CD8+ T cells using high-throughput sequence data</article-title>
        <source>J. Immunol. Methods</source>
        <year>2013</year>
        <volume>391</volume>
        <fpage>14</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jim.2013.02.002</pub-id>
        <pub-id pub-id-type="pmid">23428915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emerson</surname>
            <given-names>RO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput sequencing of T-cell receptors reveals a homogeneous repertoire of tumour-infiltrating lymphocytes in ovarian cancer</article-title>
        <source>J. Pathol.</source>
        <year>2013</year>
        <volume>231</volume>
        <fpage>433</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="doi">10.1002/path.4260</pub-id>
        <pub-id pub-id-type="pmid">24027095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Le</surname>
            <given-names>DT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mismatch repair deficiency predicts response of solid tumors to PD-1 blockade</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>357</volume>
        <fpage>409</fpage>
        <lpage>413</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aan6733</pub-id>
        <pub-id pub-id-type="pmid">28596308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mansfield</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Contraction of T cell richness in lung cancer brain metastases</article-title>
        <source>Sci. Rep.</source>
        <year>2018</year>
        <volume>8</volume>
        <fpage>2171</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-20622-8</pub-id>
        <pub-id pub-id-type="pmid">29391594</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Nolan, S. et al. A large-scale database of T-cell receptor beta (TCRbeta) sequences and binding associations from natural and synthetic exposure to SARS-CoV-2. <italic>Res Sq</italic> Preprint at 10.21203/rs.3.rs-51964/v1 (2020).</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Page</surname>
            <given-names>DB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A phase Ib study of preoperative, locoregional IRX-2 cytokine immunotherapy to prime immune responses in patients with early-stage breast cancer</article-title>
        <source>Clin. Cancer Res.: Off. J. Am. Assoc. Cancer Res.</source>
        <year>2020</year>
        <volume>26</volume>
        <fpage>1595</fpage>
        <lpage>1605</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-19-1119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reuben</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive T cell repertoire characterization of non-small cell lung cancer</article-title>
        <source>Nat. Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>603</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-14273-0</pub-id>
        <pub-id pub-id-type="pmid">32001676</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sherwood</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tumor-infiltrating lymphocytes in colorectal tumors display a diversity of T cell receptor sequences that differ from the T cells in adjacent mucosal tissue</article-title>
        <source>Cancer Immunol. Immunother.</source>
        <year>2013</year>
        <volume>62</volume>
        <fpage>1453</fpage>
        <lpage>1461</lpage>
        <pub-id pub-id-type="doi">10.1007/s00262-013-1446-2</pub-id>
        <pub-id pub-id-type="pmid">23771160</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sims</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diversity and divergence of the glioma-infiltrating T-cell receptor repertoire</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2016</year>
        <volume>113</volume>
        <fpage>E3529</fpage>
        <lpage>E3537</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1601012113</pub-id>
        <pub-id pub-id-type="pmid">27261081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stromnes</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Hulbert</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Greenberg</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Hingorani</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>T-cell localization, activation, and clonal expansion in human pancreatic ductal adenocarcinoma</article-title>
        <source>Cancer Immunol. Res.</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>978</fpage>
        <lpage>991</lpage>
        <pub-id pub-id-type="doi">10.1158/2326-6066.CIR-16-0322</pub-id>
        <pub-id pub-id-type="pmid">29066497</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tumeh</surname>
            <given-names>PC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PD-1 blockade induces responses by inhibiting adaptive immune resistance</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>515</volume>
        <fpage>568</fpage>
        <lpage>571</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13954</pub-id>
        <pub-id pub-id-type="pmid">25428505</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chow</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Radiation induces dynamic changes to the T cell repertoire in renal cell carcinoma patients</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2020</year>
        <volume>117</volume>
        <fpage>23721</fpage>
        <lpage>23729</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.2001933117</pub-id>
        <pub-id pub-id-type="pmid">32900949</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Duhen</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Co-expression of CD39 and CD103 identifies tumor-reactive CD8 T cells in human solid tumors</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>2724</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-05072-0</pub-id>
        <pub-id pub-id-type="pmid">30006565</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riaz</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tumor and microenvironment evolution during immunotherapy with nivolumab</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>934</fpage>
        <lpage>949 e915</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.028</pub-id>
        <pub-id pub-id-type="pmid">29033130</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Klicznik, M. M. et al. Human CD4(+)CD103(+) cutaneous resident memory T cells are found in the circulation of healthy individuals. <italic>Science Immunol.</italic><bold>4</bold>, eaav8995 (2019).</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beausang</surname>
            <given-names>JF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>T cell receptor sequencing of early-stage breast cancer tumors identifies altered clonal structure of the T cell repertoire</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2017</year>
        <volume>114</volume>
        <fpage>E10409</fpage>
        <lpage>E10417</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1713863114</pub-id>
        <pub-id pub-id-type="pmid">29138313</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bertoli</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lack of specific T- and B-cell clonal expansions in multiple sclerosis patients with progressive multifocal leukoencephalopathy</article-title>
        <source>Sci. Rep.</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>16605</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-53010-x</pub-id>
        <pub-id pub-id-type="pmid">31719595</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeWitt</surname>
            <given-names>WS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A diverse lipid antigen-specific TCR repertoire is clonally expanded during active tuberculosis</article-title>
        <source>J. Immunol.</source>
        <year>2018</year>
        <volume>201</volume>
        <fpage>888</fpage>
        <lpage>896</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.1800186</pub-id>
        <pub-id pub-id-type="pmid">29914888</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robert</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CTLA4 blockade broadens the peripheral T-cell receptor repertoire</article-title>
        <source>Clin. Cancer Res.: Off. J. Am. Assoc. Cancer Res.</source>
        <year>2014</year>
        <volume>20</volume>
        <fpage>2424</fpage>
        <lpage>2432</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-13-2648</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Mariuzza</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Structural basis for clonal diversity of the human T-cell response to a dominant influenza virus epitope</article-title>
        <source>J. Biol. Chem.</source>
        <year>2017</year>
        <volume>292</volume>
        <fpage>18618</fpage>
        <lpage>18627</lpage>
        <pub-id pub-id-type="doi">10.1074/jbc.M117.810382</pub-id>
        <pub-id pub-id-type="pmid">28931605</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Galperin, M. et al. CD4(+) T cell-mediated HLA class II cross-restriction in HIV controllers. <italic>Sci. Immunol.</italic><bold>3</bold>, eaat0687 (2018).</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Preferential use of public TCR during autoimmune encephalomyelitis</article-title>
        <source>J. Immunol.</source>
        <year>2016</year>
        <volume>196</volume>
        <fpage>4905</fpage>
        <lpage>4914</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.1501029</pub-id>
        <pub-id pub-id-type="pmid">27183575</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ostmeyer</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical classifiers for diagnosing disease from immune repertoires: a case study using multiple sclerosis</article-title>
        <source>BMC Bioinforma.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>401</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1814-6</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgan</surname>
            <given-names>CL</given-names>
          </name>
        </person-group>
        <article-title>Embedding metric spaces in euclidean space</article-title>
        <source>J. Geom.</source>
        <year>1974</year>
        <volume>5</volume>
        <fpage>101</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01954540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Borg, I. &amp; Groenen, P. J. F. <italic>Modern Multidimensional Scaling: Theory and Applications</italic>, (Springer Series in Statistics, 1997).</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Johnson, J., Douze M. &amp; Jegou, H. Billion-scale similarity search with GPUs. <italic>Ieee T Big Data</italic><bold>7</bold>, 535–547 (2021).</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robin</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>pROC: an open-source package for R and S+ to analyze and compare ROC curves</article-title>
        <source>BMC Bioinforma.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>77</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-77</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">R Core Team. R: A Language and Environment for Statistical Computing. <italic>R Foundation for Statistical Computing</italic> (R Core Team, 2017).</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Csardi, G. N. T. The igraph software package for complex network research. <italic>InterJ.</italic><italic>Complex Syst</italic>. <bold>1695</bold>, 1–9 (2006).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Li, B. Associated datasets and metadata related to GIANA method. <italic>Zenodo</italic>10.5281/zenodo.4698929 (2021).</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Li, B. Source codes of GIANA and GIANAsv. <italic>Github</italic>10.5281/zenodo.5048187 (2021).</mixed-citation>
    </ref>
  </ref-list>
</back>
