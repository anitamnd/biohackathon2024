<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3305602</article-id>
    <article-id pub-id-type="publisher-id">1471-2164-13-74</article-id>
    <article-id pub-id-type="pmid">22336055</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2164-13-74</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GemSIM: general, error-model based simulator of next-generation sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>McElroy</surname>
          <given-names>Kerensa E</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>kerensa@unsw.edu.au</email>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes" id="A2">
        <name>
          <surname>Luciani</surname>
          <given-names>Fabio</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>luciani@unsw.edu.au</email>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes" id="A3">
        <name>
          <surname>Thomas</surname>
          <given-names>Torsten</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>t.thomas@unsw.edu.au</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Centre for Marine Bio-Innovation and School of Biotechnology and Biomolecular Sciences, UNSW. Sydney, NSW Australia, 2052</aff>
    <aff id="I2"><label>2</label>Inflammation and Infection Research Group, Evolutionary Dynamics of Infectious Diseases, School of Medical Sciences, University of New South Wales, Sydney, NSW Australia, 2052</aff>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>2</month>
      <year>2012</year>
    </pub-date>
    <volume>13</volume>
    <fpage>74</fpage>
    <lpage>74</lpage>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>9</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>2</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright Â©2012 McElroy et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>McElroy et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2164/13/74"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>GemSIM, or General Error-Model based SIMulator, is a next-generation sequencing simulator capable of generating single or paired-end reads for any sequencing technology compatible with the generic formats SAM and FASTQ (including Illumina and Roche/454). GemSIM creates and uses empirically derived, sequence-context based error models to realistically emulate individual sequencing runs and/or technologies. Empirical fragment length and quality score distributions are also used. Reads may be drawn from one or more genomes or haplotype sets, facilitating simulation of deep sequencing, metagenomic, and resequencing projects.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We demonstrate GemSIM's value by deriving error models from two different Illumina sequencing runs and one Roche/454 run, and comparing and contrasting the resulting error profiles of each run. Overall error rates varied dramatically, both between individual Illumina runs, between the first and second reads in each pair, and between datasets from Illumina and Roche/454 technologies. Indels were markedly more frequent in Roche/454 than Illumina and both technologies suffered from an increase in error rates near the end of each read.</p>
        <p>The effects of these different profiles on low-frequency SNP-calling accuracy were investigated by analysing simulated sequencing data for a mixture of bacterial haplotypes. In general, SNP-calling using VarScan was only accurate for SNPs with frequency &gt; 3%, independent of which error model was used to simulate the data. Variation between error profiles interacted strongly with VarScan's 'minumum average quality' parameter, resulting in different optimal settings for different sequencing runs.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Next-generation sequencing has unprecedented potential for assessing genetic diversity, however analysis is complicated as error profiles can vary noticeably even between different runs of the same technology. Simulation with GemSIM can help overcome this problem, by providing insights into the error profiles of individual sequencing runs and allowing researchers to assess the effects of these errors on downstream data analysis.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Next-generation sequencing (NGS) technologies, such as Illumina's Genome Analyzer [<xref ref-type="bibr" rid="B1">1</xref>] and Roche/454's GS FLX [<xref ref-type="bibr" rid="B2">2</xref>], produce massive volumes of data. For instance, Illumina's Genome Analyzer IIx can produce up to 640 million 150 bp paired-end reads in a single run [<xref ref-type="bibr" rid="B3">3</xref>]. Increasing availability of high volume data is opening new possibilities to researchers. These include assessment of rare variants in viral populations via deep sequencing, metagenomic sequencing of bacterial communities, and pooled resequencing of human chromosomes. Extracting meaningful information from these kinds of sequencing projects is often difficult, however, due to the error rates associated with NGS. Separating true variants from sequencing errors remains challenging. Furthermore, analysis is complicated by an ever-increasing variety of downstream software, and a lack of clear standards [<xref ref-type="bibr" rid="B4">4</xref>]. Both selecting the most appropriate sequencing technology, and choosing the appropriate software package and parameter values for data analysis are typically done via a 'hit and miss' approach - a costly exercise, even in the world of 'cheap' NGS.</p>
    <p>Simulation of NGS data, followed by software benchmarking, presents an alternative approach. Early published simulators include GenFrag [<xref ref-type="bibr" rid="B5">5</xref>]. Its usefulness for modern NGS projects is limited by a simplistic error model, a single input genome, and a lack of quality score information. SamTools [<xref ref-type="bibr" rid="B6">6</xref>] also supplies a simulator, however it uses a uniform error rate. A uniformly increasing error rate is used in a slight improvement released as 'dwgsim'[<xref ref-type="bibr" rid="B7">7</xref>]. NGS features highly heterogenous error profiles [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>], so the usefulness of this simulator must be questioned.</p>
    <p>There is growing evidence that sequence context (i.e., the nucleotide sequence surrounding a base and the base's position within the read) influences error rates in both Roche/454 and Illumina sequencing [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>]. This awareness has led to more advanced simulators such as MetaSim and Flowsim [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. While MetaSim generates reads from many input genomes and uses sequence-context error models, it cannot be trained on real data and does not assign quality values to reads, limiting its potential applications. The recent program Flowsim is the most realistic NGS simulator to date, with advanced error modelling and quality scores [<xref ref-type="bibr" rid="B11">11</xref>]. However it operates only in 'flowspace' and is therefore entirely limited to simulation of Roche/454 pyrosequencing data. Likewise, the unpublished simulator SimSeq [<xref ref-type="bibr" rid="B12">12</xref>] empirically captures some characteristic features of Illumina error models, however only allows a single input genome, does not empirically derive all parameters, and cannot simulate Roche/454 data. ART [<xref ref-type="bibr" rid="B13">13</xref>], an unpublished cross-platform simulator, also uses context-dependent error models and does assign quality scores. However it appears limited to a single genome and does not allow training on user's own data sets. Thus there is a need for a realistic, cross-platform NGS simulator, as multiple sequencing platforms are likely to persist, each with their own strengths and weaknesses [<xref ref-type="bibr" rid="B14">14</xref>].</p>
    <p>Here, we describe GemSIM - a General, Error Model based SIMulator of NGS sequencing data. It uses the generic and standardised formats SAM (aligned reads) [<xref ref-type="bibr" rid="B6">6</xref>] and FASTQ (raw reads) [<xref ref-type="bibr" rid="B15">15</xref>], thus ensuring GemSIM's applicability to both current and emerging NGS technologies. GemSIM creates empirical error models from real NGS data, facilitating technology-, machine-, and even run-specific simulation. GemSIM considers a sequence-context composed of a window of three bases before the current base, the current base, and one base after the current base (we call this the 'sequence-context word'). GemSIM also assigns realistic, empirically-derived quality scores to simulated single or paired-end reads. It can draw reads from either single or multiple genomes or haplotype sets, making it applicable to deep sequencing, metagenomic, and resequencing projects. We demonstrate GemSIM's usefulness for evaluating error models and benchmarking downstream analysis software by using GemSIM to capture the error profiles of two different paired-end Illumina runs and one Roche/454 Titanium run, and by simulating reads from a set of <italic>in silico </italic>generated <italic>Buchnera aphidicola </italic>haplotypes. We then attempt to identify SNPs using the popular program VarScan [<xref ref-type="bibr" rid="B16">16</xref>] and assess the effects of different error profiles and technologies on SNP-calling accuracy.</p>
    <sec>
      <title>Implementation</title>
      <p>GemSIM is implemented in Python as a command line package, consisting of the four programs GemErr, GemHaps, GemReads, and GemStats. The GemSIM workflow is as follows:</p>
    </sec>
    <sec>
      <title>GemErr</title>
      <p>GemErr generates empirical error models from real data. A SAM format alignment of control data is used as input. A list of polymorphic sites or sites which are known to differ from the reference genome may also be supplied; these sites are then considered to be true SNPs and are ignored during error model calculation.</p>
      <p>Reads are sequentially parsed, tracking the total number of reads and read length distributions. For paired-end reads, insert size, whether the read is the first or second read in the pair, and the proportion of properly aligned pairs are also recorded. For each base of each read the following information is then stored: a) nucleotide type and base position in read; b) mismatch or true base for the position; c) indels following the current position; d) preceding three bases in the read; e) following base in the read, and f) quality scores for true and mismatch bases and insert bases. Although it is mainly the sequence preceding the current position that is known to affect error rates [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>], the following base in the read is tracked to allow accurate simulation of indels within homopolymers. Sequence aligners record these errors either at the start or end of a homopolymer. By taking the following base into consideration, indels are only inserted once within long homopolymers, at the end, rather than potentially multiple times within the homopolymer. Empirical distributions for tracked information are stored to a file and used as error models for input into GemReads.</p>
      <p>If a particular sequence-context word is not contained at least some minimum Ã number of times (default Ã = 4) within the reference genome, then the model is updated using information based on the longest nucleotide sequence that occurs at least Ã times in the reference. For instance, if AACTG is missing from the reference, however ACTG can be found five times, then the matrix entry where T is the current position, G is the following position, and AAC are the three bases before the current position is updated by considering all other matrix entries where the two bases before the current position are AC, the current position is T, and G is the following position.</p>
    </sec>
    <sec>
      <title>GemStats (optional)</title>
      <p>GemStats takes an error model generated by GemErr, and calculates a set of statistics based on this model - for paired-end reads, models for the first and second read in a pair are considered separately. Statistics reported include the overall mismatch, insertion, and deletion error rates; the error rate for each nucleotide; and the error rate by base position within the read. Additionally, any sequence-context words with an error rate more than two standard deviations greater than the average error rate are also reported.</p>
    </sec>
    <sec>
      <title>GemHaps (optional)</title>
      <p>GemHaps takes a genome sequence, and an input command specifying haplotype frequencies and the number of SNPs in each haplotype (here, haplotypes are defined as a group of related nucleotide sequences, each differing by at least one SNP). The positions of mutations are randomly determined, and haplotypes are written to a file for input into GemReads. Alternatively, users may create their own tab-delimited haplotype file (for instance, describing SNPs generated according to an evolutionary model).</p>
    </sec>
    <sec>
      <title>GemReads</title>
      <p>GemReads requires as input an error model file (generated by users with GemErr or supplied in GemSIM), a FASTA genome file or directory of FASTA genomes (metagenomics mode), an optional haplotype file (user defined or from GemHaps), and a tab-delimited species-abundance text file (metagenomics mode only). Additionally, the user specifies whether the reference genome(s) are circular or linear, and which quality score offset to use (33 or 64, depending on the required FASTQ output version). The requested number of single or paired-end reads are generated as follows, and output as FASTQ files:</p>
      <p>(1) Read length and insert length (paired-end only) are randomly chosen from the empirical distributions defined by the error model (read length may also be set to a static value).</p>
      <p>(2) In metagenomics mode, an input reference genome is chosen with probability proportional to the species abundance and genome size.</p>
      <p>(3) Read location and direction are chosen at random, and the read is copied from the input genome.</p>
      <p>(4) Read is assigned to a haplotype (if supplied) and updated with SNPs, where appropriate.</p>
      <p>(5) Errors are introduced according to the error models, accounting for read position, sequence-context word, and 1st or 2nd read in pair (for paired-end reads).</p>
      <p>(6) Quality scores are assigned using recorded empirical distributions contained in the error model file.</p>
      <p>For paired-end reads, steps 1-6 are repeated, however the insert size is used in conjunction with the previous read position and direction to determine the read location. Our error model also tracks how many read pairs have one read that does not align. We simulate this by generating a read that consists entirely of Ns with low quality scores, forcing it not to map. For instance, for 100 bp paired-end Illumina sequencing data, one read would contain 100 Ns, each with a quality score of 'B' or 2.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <sec>
      <title>Data processing and performance</title>
      <p>We used GemSIM to calculate error models for and simulate reads from three different sequencing runs: Illumina Genome Analyzer IIx with Illumina Sequencing Kit v4 chemistry (Illumina v4); Illumina Genome Analyzer IIx with TrueSeq SBS Kit v5-GA (Illumina v5); and Roche/454 FLX Titanium (Roche/454). For the Illumina simulations, error models were calculated from PhiX control lane data aligned with Novocraft V2.07.06 [<xref ref-type="bibr" rid="B17">17</xref>]. Soft-clipping was disabled, reads aligning equally well to two genomic positions were randomly aligned to one of them, and the insert size was set with a standard deviation of 200. All other parameters were given their default values. 94.7% (v4) and 97.5% (v5) of reads aligned. For the Roche/454 simulation, we used aligned plasmid control data from a Hepatitis C Virus study [<xref ref-type="bibr" rid="B18">18</xref>]. This alignment was performed using Mosaik V1.1.0021 [<xref ref-type="bibr" rid="B19">19</xref>]. The maximum percentage mismatch allowed was increased to 1%, while all other parameters were set as recommended for Roche/454 Titanium. 85.4% of these reads aligned. Simulated reads were drawn from a set of <italic>B. aphidicola </italic>haplotypes, created by GemHaps using the <italic>B. aphidicola </italic>Cc reference genome [GenBank ID: <ext-link ext-link-type="gen" xlink:href="PC000263.1">PC000263.1</ext-link>]. The number of simulated reads was five million and one million for Illumina GAII and Roche/454 FLX Titanium respectively. This gave a reference coverage of around 1000Ã. For consistency, alignment of simulated reads was done using Novocraft for the Illumina data and Mosaik for the Roche/454 data [<xref ref-type="bibr" rid="B18">18</xref>]. Memory and runtime data are summarised in Table <xref ref-type="table" rid="T1">1</xref> and show that GemSIM can be run with modest memory requirements (&lt; 1 Gb) on a single CPU/desktop computer within a reasonable time frame. As memory requirements are dictated mainly by the size of the sequence-context word and read length, they are largely independent of the number of reads processed or simulated. Runtime scales linearly with the total number of bases processed or simulated.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Memory and runtime for Illumina and Roche/454 simulations</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Program, data</th>
              <th align="left">Memory (Gb)</th>
              <th align="left">Runtime (h:min)</th>
              <th align="left">Data processed (bases)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">GemErr, Illumina v4</td>
              <td align="left">0.34</td>
              <td align="left">3:15</td>
              <td align="left">0.9 Ã 10<sup>8</sup></td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">GemErr, Illumina v5</td>
              <td align="left">0.34</td>
              <td align="left">4:23</td>
              <td align="left">1.1 Ã 10<sup>8</sup></td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">GemErr, Roche/454</td>
              <td align="left">0.39</td>
              <td align="left">0:20</td>
              <td align="left">1.3 Ã 10<sup>7</sup></td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">GemReads, Illumina v4</td>
              <td align="left">0.44</td>
              <td align="left">3:08</td>
              <td align="left">5.0 Ã 10<sup>8</sup></td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">GemReads, Illumina v5</td>
              <td align="left">0.46</td>
              <td align="left">3:10</td>
              <td align="left">5.0 Ã 10<sup>8</sup></td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">GemReads, Roche/454</td>
              <td align="left">0.46</td>
              <td align="left">2:45</td>
              <td align="left">4.0 Ã 10<sup>8</sup></td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Memory requirements and runtime are given separately for the two main programs within the GemSIM workflow, GemErr and GemReads. Both programs were run on a single Intel Xeon E5530 2.4 GHz CPU. To facilitate comparison, the number of bases processed to create the error models is given for GemErr, while the number of simulated bases is given for GemReads. For the simulations, all reads were generated from the same set of <italic>B. aphidicola </italic>haplotypes (created with GemHaps) using the appropriate error model.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>5-mer presence and frequency</title>
      <p>Our approach to error modelling is dependent on k-mer choice, which needs to be long enough to capture sequence-context information, but also short enough to be represented in the reference genome to be simulated and the control genomes used for error modelling. All possible 5-mers were represented more than four times in the <italic>B. aphidicola </italic>reference genome, while 83 (or 2%) of all 6-mers were found less than four times. Furthermore, more than 90% of all possible 5-mers were found four or more times in both the PhiX and the plasmid genomes, used for modelling Illumina and Roche/454 errors, respectively. Less than 30% of all possible 6-mers were present four or more times in these two genomes, while all possible 4-mers were found more than four times in the plasmid genome, and all but one in the PhiX genome (Table <xref ref-type="table" rid="T2">2</xref>). This suggests that a k-mer length of 5 provides an appropriate balance between capturing relevant sequence-context information and the possibility of overfitting the data (with associated wasted run time and memory requirements).</p>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Number of low-frequency (&lt; 4) k-mers in reference and control genomes</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">Genome</th>
              <th align="left">3-mer</th>
              <th align="left">4-mer</th>
              <th align="left">5-mer</th>
              <th align="left">6-mer</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">
                <bold>
                  <italic>B. aphidicola</italic>
                </bold>
              </td>
              <td align="left">0</td>
              <td align="left">0</td>
              <td align="left">0</td>
              <td align="left">83</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">phiX</td>
              <td align="left">0</td>
              <td align="left">1</td>
              <td align="left">98</td>
              <td align="left">2918</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">pGEM-T/HCV plasmid</td>
              <td align="left">0</td>
              <td align="left">0</td>
              <td align="left">28</td>
              <td align="left">2979</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The fact that most 5-mers are contained within the control genomes used also supports the notion that the derived error models can be used to accurately simulate reads from any unrelated reference genomes. For the 10% of 5-mers not well represented within the control genomes, GemSIM derives an error rate based on the relevant 4-mer (or 3-mer, for the one PhiX 4-mer mentioned above).</p>
    </sec>
    <sec>
      <title>Error analysis</title>
      <p>Error models for Illumina v4, Illumina v5, and Roche/454 were analysed with GemStats. Error rates are summarised in Table <xref ref-type="table" rid="T3">3</xref>. Striking differences between the error profiles of Illumina v4 and Illumina v5 are apparent, justifying the need for empirical chemistry- or run-specific error models when simulating NGS data. Combining results for the first and second reads in a pair, Illumina v5 had an error rate of 0.31%, five times lower than the error rate of Illumina v4 (1.66%). Illumina v4 also showed large differences between the first and second reads in a pair with second reads having considerably greater error rates. Roche/454 gave the least errors and its mismatch error rate of 0.12% is in line with recently published estimates [<xref ref-type="bibr" rid="B8">8</xref>]. Consideration of the top five mismatches within their sequence-context suggests that all runs had some trouble with homopolymers, particularly in G or C homopolymers for the Illumina runs. This problem has been well document for Roche/454 data [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B20">20</xref>], and there is some evidence that homopolymers are also problematic for Illumina data [<xref ref-type="bibr" rid="B21">21</xref>]. Our data also supports the known problem with the CGG motif in Illumina sequencing [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B21">21</xref>].</p>
      <table-wrap id="T3" position="float">
        <label>Table 3</label>
        <caption>
          <p>Error model statistics for Illumina v4, Illumina v5, and Roche/454</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th align="left">Ill. v4 1<sup>st </sup>read</th>
              <th align="left">Ill. v4 2<sup>nd </sup>read</th>
              <th align="left">Ill. v5 1<sup>st </sup>read</th>
              <th align="left">Ill. v5 2<sup>nd </sup>read</th>
              <th align="left">Roche/454</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Overall (%)</td>
              <td align="left">0.99</td>
              <td align="left">2.40</td>
              <td align="left">0.28</td>
              <td align="left">0.34</td>
              <td align="left">0.12</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">A (%)</td>
              <td align="left">1.23</td>
              <td align="left">2.86</td>
              <td align="left">0.25</td>
              <td align="left">0.33</td>
              <td align="left">0.14</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">T (%)</td>
              <td align="left">0.91</td>
              <td align="left">2.19</td>
              <td align="left">0.34</td>
              <td align="left">0.39</td>
              <td align="left">0.10</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">G (%)</td>
              <td align="left">0.78</td>
              <td align="left">2.00</td>
              <td align="left">0.23</td>
              <td align="left">0.23</td>
              <td align="left">0.12</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">C (%)</td>
              <td align="left">1.12</td>
              <td align="left">2.78</td>
              <td align="left">0.29</td>
              <td align="left">0.41</td>
              <td align="left">0.12</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">1<sup>st </sup>most freq. (%)</td>
              <td align="left">GGG<bold>T</bold>A - &gt; GGG<bold>G</bold>A (4.47)</td>
              <td align="left">ACA<bold>A</bold>G - &gt; ACA<bold>C</bold>G (3.94)</td>
              <td align="left">GGG<bold>T</bold>C - &gt; GGG<bold>G</bold>C (5.85)</td>
              <td align="left">AGG<bold>T</bold>G- &gt; AGG<bold>G</bold>G (3.69)</td>
              <td align="left">AAA<bold>C</bold>A - &gt; AAA<bold>A</bold>A (1.07)</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">2<sup>nd </sup>most freq. (%)</td>
              <td align="left">AGG<bold>T</bold>G - &gt; AGG<bold>G</bold>G (3.71)</td>
              <td align="left">AGG<bold>T</bold>G - &gt; AGG<bold>G</bold>G (3.29)</td>
              <td align="left">CTC<bold>G</bold>G - &gt; CTC<bold>C</bold>G (5.83)</td>
              <td align="left">CGG<bold>T</bold>G - &gt; CGG<bold>G</bold>G (2.7)</td>
              <td align="left">CCC<bold>A</bold>C - &gt; CCC<bold>C</bold>C (1.02)</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">3<sup>rd </sup>most freq. (%)</td>
              <td align="left">CCC<bold>A</bold>A - &gt; CCC<bold>C</bold>A (3.15)</td>
              <td align="left">CCC<bold>A</bold>A - &gt; CCC<bold>C</bold>A (3.24)</td>
              <td align="left">GGG<bold>C</bold>G - &gt; GGG<bold>G</bold>G (4.06)</td>
              <td align="left">GGG<bold>T</bold>G - &gt; GGG<bold>G</bold>G (2.45)</td>
              <td align="left">CCC<bold>C</bold>G - &gt; CCC<bold>A</bold>G (0.75)</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">4<sup>th </sup>most freq. (%)</td>
              <td align="left">CGG<bold>T</bold>G - &gt; CGG<bold>G</bold>G (3.06)</td>
              <td align="left">GGG<bold>T</bold>A - &gt; GGG<bold>G</bold>A (3.14)</td>
              <td align="left">CGG<bold>T</bold>G - &gt; CGG<bold>G</bold>G (3.65)</td>
              <td align="left">GGG<bold>T</bold>C - &gt; GGG<bold>G</bold>G (2.03)</td>
              <td align="left">AAA<bold>G</bold>G - &gt; AAA<bold>A</bold>G (0.70)</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">5<sup>th </sup>most freq. (%)</td>
              <td align="left">GGG<bold>T</bold>G - &gt; GGG<bold>G</bold>G (2.71)</td>
              <td align="left">ACA<bold>A</bold>A - &gt; ACA<bold>C</bold>A (2.97)</td>
              <td align="left">GGG<bold>T</bold>A - &gt; GGG<bold>G</bold>A (3.20)</td>
              <td align="left">CGG<bold>T</bold>C - &gt; CGG<bold>G</bold>C (1.98)</td>
              <td align="left">AGG<bold>A</bold>A - &gt; AGG<bold>G</bold>A (0.52)</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">Insertions (%)</td>
              <td align="left">0.000723</td>
              <td align="left">0.000935</td>
              <td align="left">0.000622</td>
              <td align="left">0.001300</td>
              <td align="left">0.290000</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">Deletions (%)</td>
              <td align="left">0.000434</td>
              <td align="left">0.000482</td>
              <td align="left">0.000353</td>
              <td align="left">0.000484</td>
              <td align="left">0.270000</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Values give the error rates for each technology. Several measures of error rate are given, including: overall error rates; average error rate for each nucleotide; error rates for the five sequence-context words most likely to result in mismatches (1<sup>st </sup>most freq. to 5<sup>th </sup>most freq); and average insertion and deletion rates. For the top five mismatches, the sequence-context word is given with the actual mismatch base in bold (true sequence - &gt; error sequence).</p>
        </table-wrap-foot>
      </table-wrap>
      <p>For all three simulations, error rates increased (to varying extents) towards the tail end of the read (Figure <xref ref-type="fig" rid="F1">1</xref>). While this is a recognised issue for Illumina sequencing, the literature is ambiguous with respect to Roche/454 sequencing data [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>]. While a positional effect for Roche/454 can be seen in Figure <xref ref-type="fig" rid="F1">1</xref>, the magnitude of this effect is extremely small when compared to Illumina sequencing data and would probably not be observed if only reads with length &lt; 400 bp are considered. The positional increase in error rate for Illumina v5 is also rather modest, and is only slightly more elevated for the second read in the pair. In contrast, Illumina v4 exhibits a strong influence of base position within the read on error rate, characterised by sudden peaks and a marked increase in error rates near the end of the read.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>Error rate by position within read</bold>.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-74-1"/>
      </fig>
      <p>While insertions were roughly twice as common as deletions in the Illumina runs, in general, indel error rates in both Illumina runs were two to three orders of magnitude lower than in the Roche/454 run. This is consistent with previous findings that mismatches are the predominant forms of error in Illumina, while indels are the most frequent errors in Roche/454 sequencing [<xref ref-type="bibr" rid="B20">20</xref>,<xref ref-type="bibr" rid="B22">22</xref>], showing that the GemSIM error-modeling approach captures these key characteristics of the different sequencing platforms.</p>
    </sec>
    <sec>
      <title>SNP-calling</title>
      <p>For each error model, simulated reads were drawn from a set of five haplotypes derived from the <italic>B. aphidicola </italic>reference genome, with frequencies of 1%, 3%, 5%, 7% and 84%. The four low-frequency haplotypes each contained 100 randomly placed SNPs and the same haplotypes (with their associated SNPs) were used for all simulations and downstream analysis.</p>
      <p>SNP-calling was performed using VarScan v2.2.3 [<xref ref-type="bibr" rid="B16">16</xref>] on pileup files generated with SamTools v0.1.12a [<xref ref-type="bibr" rid="B6">6</xref>]. As we were interested in identifying low-frequency true SNPs and associated false positives (errors), the minimum variant frequency parameter was set to zero. Minimum coverage was set to 100 and the minimum number of reads supporting each SNP was set to five. As VarScan largely depends on individual base quality scores to distinguish between true SNPs and sequencing errors, we varied the minimum average quality (M.A.Q.) parameter from 10 to 40 and investigated its interaction with specific error profiles and SNP-calling accuracy.</p>
      <p>SNP-calling was highly accurate for SNPs with a frequency &gt; 3% for all sequencing platforms simulated. Roche/454 showed a slightly lower true positive rate (i.e. an increased false negative rate) than the Illumina simulations. When using VarScan with a M.A.Q. of 20, 379 out of 400 SNPs were identified (86, 97, 97, and 97 for frequencies 1, 3, 4 and 7%, respectively). In contrast, all 400 SNPs were identified from both Illumina simulations. Upon closer inspection, 11 of the false negatives with true frequency of 1% failed to be supported by five reads. All the remaining false negatives were associated with homopolymer indel errors. Inspection of the pileup file showed these SNPs were contained in the data; however VarScan reported them as indels instead.</p>
      <p>Any inaccurate SNP calls within +/- 1% of a known haplotype frequency were classed as false positives. For Illumina v5 and Roche/454, all false positives had a frequency under 1% (+/- 1%). Illumina v4 showed a drastically increased false positive rate, as can be expected from the higher average error rate of this run. Despite this, false positives were still restricted to under 3% (+/- 1%) population frequency. As M.A.Q. was increased, however, some false positives with a true frequency of 1% (+/-1%) were now given a frequency by VarScan of 3% (+/-1%). This can be seen as spikes in the frequency = 3% graph, between M.A.Q. 30 and M.A.Q. 40. This can be understood by considering how the M.A.Q. parameter works. The VarScan manual states that M.A.Q. is the 'minimum base quality at a position to count a read' [<xref ref-type="bibr" rid="B23">23</xref>]. This means VarScan uses M.A.Q. to select a subset of reads from which to make a call. Thus increasing M.A.Q. reduces the sampling of reads, which in turn reduces the accuracy of the SNP frequency calculation when frequencies are small. This highlights the need for a detailed understanding of any chosen data and analysis pipeline and the value of performing benchmarking with simulated data.</p>
      <p>VarScan also has a minimum coverage parameter and its strong interaction with the M.A.Q. parameter is shown by Table <xref ref-type="table" rid="T4">4</xref>. When calculating coverage, VarScan only 'counts' bases that have a quality above a given M.A.Q and thus coverage effectively decreases as M.A.Q. increases. This interaction explains why a M.A.Q. value of 39 gives the most accurate overall results for Illumina v5, however results in no SNPs being called for Illumina v4. As we set the minimum coverage to 100, any genomic position where VarScan counts less than 100 reads will be ignored. Using a M.A.Q. of 39, for the Illumina v5 simulation less than 0.003% of the genome is ignored, whereas for Illumina v4 100% of the genome is ignored. Although increasing M.A.Q. decreases false positives, there is a clear trade-off between decreasing false positives by eliminating low-quality bases and increasing false negatives by disregarding good data. This again reinforces the need to understand individual sequencing runs, even if they originate from the same technology (in our case, the sequencing runs used to create error models for the two Illumina simulations were performed by the same technician on the same machine). Without simulation, it would be difficult to choose an optimal M.A.Q. value and almost impossible to interpret any findings. Following this simulation, for a <italic>B. aphidicola </italic>sequencing experiment resembling our Illumina v5 simulation a M.A.Q. of 39 will give confident and accurate results. Furthermore, we expect to identify 100% of SNPs with frequency &gt; = 3% and 71% of SNPs with frequency of 1% (see Figure <xref ref-type="fig" rid="F2">2</xref>). We also expect that across the length of the genome, 101 false positives with frequency of 1% (+/-1%) will also occur.</p>
      <table-wrap id="T4" position="float">
        <label>Table 4</label>
        <caption>
          <p>Number of genomic sites considered by VarScan for increasing values of M.A.Q</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left"><bold>M.A.Q</bold>.</th>
              <th align="left">Illumina v4</th>
              <th align="left">Illumina v5</th>
              <th align="left">Roche/454</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">10</td>
              <td align="left">416376</td>
              <td align="left">416380</td>
              <td align="left">416374</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">11</td>
              <td align="left">416376</td>
              <td align="left">416380</td>
              <td align="left">416374</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">12</td>
              <td align="left">416376</td>
              <td align="left">416380</td>
              <td align="left">416372</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">13</td>
              <td align="left">416376</td>
              <td align="left">416380</td>
              <td align="left">416370</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">14</td>
              <td align="left">416376</td>
              <td align="left">416380</td>
              <td align="left">416369</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">15</td>
              <td align="left">416376</td>
              <td align="left">416380</td>
              <td align="left">416368</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">16</td>
              <td align="left">416376</td>
              <td align="left">416380</td>
              <td align="left">416365</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">17</td>
              <td align="left">416376</td>
              <td align="left">416380</td>
              <td align="left">416361</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">18</td>
              <td align="left">416376</td>
              <td align="left">416380</td>
              <td align="left">416357</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">19</td>
              <td align="left">416376</td>
              <td align="left">416378</td>
              <td align="left">416357</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">20</td>
              <td align="left">416376</td>
              <td align="left">416378</td>
              <td align="left">416353</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">21</td>
              <td align="left">416376</td>
              <td align="left">416378</td>
              <td align="left">416353</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">22</td>
              <td align="left">416376</td>
              <td align="left">416378</td>
              <td align="left">416349</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">23</td>
              <td align="left">416375</td>
              <td align="left">416378</td>
              <td align="left">416345</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">24</td>
              <td align="left">416375</td>
              <td align="left">416378</td>
              <td align="left">416340</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">25</td>
              <td align="left">416375</td>
              <td align="left">416378</td>
              <td align="left">416336</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">26</td>
              <td align="left">416375</td>
              <td align="left">416378</td>
              <td align="left">416328</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">27</td>
              <td align="left">416375</td>
              <td align="left">416378</td>
              <td align="left">416323</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">28</td>
              <td align="left">416375</td>
              <td align="left">416377</td>
              <td align="left">416317</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">29</td>
              <td align="left">416375</td>
              <td align="left">416377</td>
              <td align="left">416312</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">30</td>
              <td align="left">416375</td>
              <td align="left">416377</td>
              <td align="left">416303</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">31</td>
              <td align="left">416374</td>
              <td align="left">416377</td>
              <td align="left">416292</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">32</td>
              <td align="left">416372</td>
              <td align="left">416376</td>
              <td align="left">416284</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">33</td>
              <td align="left">416371</td>
              <td align="left">416376</td>
              <td align="left">416271</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">34</td>
              <td align="left">416368</td>
              <td align="left">416376</td>
              <td align="left">416260</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">35</td>
              <td align="left">14370</td>
              <td align="left">416376</td>
              <td align="left">416251</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">36</td>
              <td align="left">0</td>
              <td align="left">416375</td>
              <td align="left">416233</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">37</td>
              <td align="left">0</td>
              <td align="left">416375</td>
              <td align="left">416226</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">38</td>
              <td align="left">0</td>
              <td align="left">416374</td>
              <td align="left">416110</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">39</td>
              <td align="left">0</td>
              <td align="left">416368</td>
              <td align="left">416076</td>
            </tr>
            <tr>
              <td colspan="4">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">40</td>
              <td align="left">0</td>
              <td align="left">416358</td>
              <td align="left">415943</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>M.A.Q gives the minimum quality a base within a read must have for VarScan to 'count' it. At each position with the genome, there must be at least 100 bases (from 100 reads) with a quality above the value of M.A.Q, for the genomic position to be considered by VarScan when scanning for SNPs. For example, a value of zero means there were no sites within the reference genome where there were more than 100 aligned bases with a quality score greater than the specified M.A.Q.</p>
        </table-wrap-foot>
      </table-wrap>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>True positives, false positives, and accuracy for increasing values of M.A.Q</bold>. Graphs for true positives and false positives are in absolute numbers, while accuracy is on a scale from zero to one. (Accuracy is defined as (true positives)/((total SNP no.) + (false positives)). One equals perfect accuracy.) False positive graphs for 'SNP frequency = 1%' and 'all SNP freq. together' are on a logarithmic scale. For false positive graphs, any false positives within +/-1% of the specified frequency are included in the graph.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-74-2"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>By considering errors within their sequence-context in real data, GemSIM captured known features of Illumina and Roche/454 error profiles, thus validating our approach. GemSIM therefore facilitates independent, objective, and comparable simulation of both Roche/454 and Illumina sequencing data. Analysis of the error models created by GemSIM also provided new insights into error profiles, specifically that there were substantial differences between the error profiles of the Illumina v4 and Illumina v5 sequencing runs. While it is not clear whether this difference is due to the change in chemistry or to some other factors, it does show that sequencing runs can vary substantially, even when performed by the same sequencing provider using the same machine. Furthermore, differences between these error profiles have a substantial impact on downstream analysis, as shown by our study of SNP-calling accuracy in simulated data.</p>
    <p>Our findings call for empirically derived, run-specific error models in sequencing simulation. GemSIM meets this need with a set of python scripts that can be run on a standard desktop computer. By allowing analysis of run-specific error models created from the user's own data, GemSIM helps researchers to identify unique features of their data - understanding of which may be invaluable for downstream data analysis. Error-model analysis also facilitates quality control and identification of 'bad quality' sequencing runs, such as the Illumina v4 run described here. Finally, simulation of sequencing data based on empirically-derived error models allows researchers to choose the most appropriate sequencing platform for their project, assess the impacts of errors on downstream data analysis, and objectively interpret any findings.</p>
    <p>GemSIM is most suited to simulating resequencing or metagenomic projects where known reference sequences exist, as it relies on the presence of a reference sequence to initially generate reads (error models are then superimposed on top of the read). For example, GemSIM can be used in a deep resequencing project to establish at which coverage any further sequencing may not provide any increase in SNP detection accuracy. GemSIM may also prove itself valuable in developing and benchmarking de-novo assemblers, by assessing how well a known genome can be reconstructed from simulated reads. By providing a manually modified reference genome to GemSIM, users could also simulate reads to assess the detection of large genomic rearrangements via de-novo assembly.</p>
    <p>Future improvements to GemSIM may include increasing the number of bases tracked before the current position during error model construction, as it is possible that error profiles are even more heterogenous than reported here. For Roche/454 sequencing, indel errors are known to increase with increasing homopolymer length, while there is evidence to show that Illumina sequencing accuracy can be influenced by the sequence up to 10 bases before the current position [<xref ref-type="bibr" rid="B9">9</xref>]. Currently, the number of bases before the current position is limited by both memory requirements and the need for the sequence-context word to be present in the control dataset. With future improvements in computing power and memory handling, it will be feasible to allow users to optionally increase the sequence-context word length, when appropriate.</p>
    <p>As new sequencing technologies emerge, we will also continue testing and developing GemSIM for compatibility. Recently released platforms, such as the Illumina's MiSeq and Pacific Biosciences RS system, can be readily assessed as they are compatible with the two generic formats required by GemSIM, FASTQ and SAM.</p>
    <p>The error models described in this paper are provided with the GemSIM package as generic technology-specific error models, for users who do not have access to control data. New error models for different platforms and chemistries will be supplied, as they become available.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p><bold>Project name: </bold>GemSIM.</p>
    <p>
      <bold>Project home page: </bold>
      <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/gemsim/">http://sourceforge.net/projects/gemsim/</ext-link>
    </p>
    <p><bold>Operating system(s): </bold>platform independent.</p>
    <p><bold>Programming language: </bold>Python 2.6</p>
    <p><bold>Other requirements: </bold>Numpy, Python 2.6</p>
    <p><bold>License: </bold>GNU GPL v3.</p>
    <p><bold>Any restrictions to use by non-academics: </bold>none.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>KM wrote the GemSIM code, KM, FL and TT participated in data analysis, KM drafted the manuscript and FL and TT revised it, and KM, FL and TT contributed to study design and conception. No funding bodies contributed to study design or data analysis. All authors read and approved the final version of the manuscript.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>KM was supported by an Australian Postgraduate Award. FL was supported by an NHMRC Fellowship (Nos. 510428). Illumina sequencing was funded by the Australian Cystic Fibrosis Research Trust. This project was also supported by the National Health and Medical Research Council of Australia (NHMRC) Program Grant No. 510448. We would like to thank Rowena Bull and Andrew Lloyd for provision of the plasmid control data.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bentley</surname>
          <given-names>DR</given-names>
        </name>
        <name>
          <surname>Balasubramanian</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Swerdlow</surname>
          <given-names>HP</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>GP</given-names>
        </name>
        <name>
          <surname>Milton</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Brown</surname>
          <given-names>CG</given-names>
        </name>
        <name>
          <surname>Hall</surname>
          <given-names>KP</given-names>
        </name>
        <name>
          <surname>Evers</surname>
          <given-names>DJ</given-names>
        </name>
        <name>
          <surname>Barnes</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Bignell</surname>
          <given-names>HR</given-names>
        </name>
        <etal/>
        <article-title>Accurate whole human genome sequencing using reversible terminator chemistry</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>456</volume>
        <fpage>53</fpage>
        <lpage>59</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07517</pub-id>
        <pub-id pub-id-type="pmid">18987734</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Margulies</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Egholm</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Altman</surname>
          <given-names>WE</given-names>
        </name>
        <name>
          <surname>Attiya</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Bader</surname>
          <given-names>JS</given-names>
        </name>
        <name>
          <surname>Bemben</surname>
          <given-names>LA</given-names>
        </name>
        <name>
          <surname>Berka</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Braverman</surname>
          <given-names>MS</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>YJ</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>Z</given-names>
        </name>
        <etal/>
        <article-title>Genome sequencing in microfabricated high-density picolitre reactors</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>437</volume>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="pmid">16056220</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="other">
        <article-title>Genome Analyzer IIx</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.illumina.com/systems/genome_analyzer_iix.ilmn">http://www.illumina.com/systems/genome_analyzer_iix.ilmn</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nielsen</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Paul</surname>
          <given-names>JS</given-names>
        </name>
        <name>
          <surname>Albrechtsen</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Song</surname>
          <given-names>YS</given-names>
        </name>
        <article-title>Genotype and SNP calling from next-generation sequencing data</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>443</fpage>
        <lpage>451</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2986</pub-id>
        <pub-id pub-id-type="pmid">21587300</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Engle</surname>
          <given-names>ML</given-names>
        </name>
        <name>
          <surname>Burks</surname>
          <given-names>C</given-names>
        </name>
        <article-title>GenFrag 2.1: new features for more robust fragment assembly benchmarks</article-title>
        <source>Comput Appl Biosci</source>
        <year>1994</year>
        <volume>10</volume>
        <fpage>567</fpage>
        <lpage>568</lpage>
        <pub-id pub-id-type="pmid">7828076</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Handsaker</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Wysoker</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fennell</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ruan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Homer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Abecasis</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>The Sequence Alignment/Map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="other">
        <article-title>Whole Genome Simulation</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/apps/mediawiki/dnaa/index.php?title=Whole_Genome_Simulation">http://sourceforge.net/apps/mediawiki/dnaa/index.php?title=Whole_Genome_Simulation</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gilles</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Meglecz</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Pech</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Ferreira</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Malausa</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Martin</surname>
          <given-names>JF</given-names>
        </name>
        <article-title>Accuracy and quality assessment of 454 GS-FLX Titanium pyrosequencing</article-title>
        <source>Bmc Genomics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>245</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-12-245</pub-id>
        <pub-id pub-id-type="pmid">21592414</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Nakamura</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Oshima</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Morimoto</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ikeda</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Yoshikawa</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Shiwa</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Ishikawa</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Linak</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Hirai</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Takahashi</surname>
          <given-names>H</given-names>
        </name>
        <etal/>
        <article-title>Sequence-specific error profile of Illumina sequencers</article-title>
        <source>Nucleic Acids Res</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>e90</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr344</pub-id>
        <pub-id pub-id-type="pmid">21576222</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Richter</surname>
          <given-names>DC</given-names>
        </name>
        <name>
          <surname>Ott</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Auch</surname>
          <given-names>AF</given-names>
        </name>
        <name>
          <surname>Schmid</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Huson</surname>
          <given-names>DH</given-names>
        </name>
        <article-title>MetaSim: a sequencing simulator for genomics and metagenomics</article-title>
        <source>PLoS One</source>
        <year>2008</year>
        <volume>3</volume>
        <fpage>e3373</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0003373</pub-id>
        <pub-id pub-id-type="pmid">18841204</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Balzer</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Malde</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Lanzen</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Sharma</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Jonassen</surname>
          <given-names>I</given-names>
        </name>
        <article-title>Characteristics of 454 pyrosequencing data--enabling realistic simulation with flowsim</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>i420</fpage>
        <lpage>425</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq365</pub-id>
        <pub-id pub-id-type="pmid">20823302</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="other">
        <article-title>SimSeq</article-title>
        <ext-link ext-link-type="uri" xlink:href="https://github.com/jstjohn/SimSeq">https://github.com/jstjohn/SimSeq</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="other">
        <article-title>ART</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.joyhz.com/ART/">http://bioinformatics.joyhz.com/ART/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Metzker</surname>
          <given-names>ML</given-names>
        </name>
        <article-title>Sequencing technologies - the next generation</article-title>
        <source>Nat Rev Genet</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>31</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2626</pub-id>
        <pub-id pub-id-type="pmid">19997069</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cock</surname>
          <given-names>PJ</given-names>
        </name>
        <name>
          <surname>Fields</surname>
          <given-names>CJ</given-names>
        </name>
        <name>
          <surname>Goto</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Heuer</surname>
          <given-names>ML</given-names>
        </name>
        <name>
          <surname>Rice</surname>
          <given-names>PM</given-names>
        </name>
        <article-title>The Sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>1767</fpage>
        <lpage>1771</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp1137</pub-id>
        <pub-id pub-id-type="pmid">20015970</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Koboldt</surname>
          <given-names>DC</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Wylie</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Larson</surname>
          <given-names>DE</given-names>
        </name>
        <name>
          <surname>McLellan</surname>
          <given-names>MD</given-names>
        </name>
        <name>
          <surname>Mardis</surname>
          <given-names>ER</given-names>
        </name>
        <name>
          <surname>Weinstock</surname>
          <given-names>GM</given-names>
        </name>
        <name>
          <surname>Wilson</surname>
          <given-names>RK</given-names>
        </name>
        <name>
          <surname>Ding</surname>
          <given-names>L</given-names>
        </name>
        <article-title>VarScan: variant detection in massively parallel sequencing of individual and pooled samples</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2283</fpage>
        <lpage>2285</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp373</pub-id>
        <pub-id pub-id-type="pmid">19542151</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="other">
        <article-title>Novocraft</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.novocraft.com">http://www.novocraft.com</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bull</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Luciani</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>McElroy</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Gaudieri</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Pham</surname>
          <given-names>ST</given-names>
        </name>
        <name>
          <surname>Chopra</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Cameron</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Maher</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Dore</surname>
          <given-names>GJ</given-names>
        </name>
        <name>
          <surname>White</surname>
          <given-names>PA</given-names>
        </name>
        <name>
          <surname>Lloyd</surname>
          <given-names>AR</given-names>
        </name>
        <article-title>Sequential Bottlenecks Drive Viral Evolution in Early Acute Hepatitis C Virus Infection</article-title>
        <source>PLoS Pathog</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>e1002243</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.ppat.1002243</pub-id>
        <pub-id pub-id-type="pmid">21912520</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="other">
        <article-title>mosaik-aligner</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/mosaik-aligner/">http://code.google.com/p/mosaik-aligner/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Huse</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Huber</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Morrison</surname>
          <given-names>HG</given-names>
        </name>
        <name>
          <surname>Sogin</surname>
          <given-names>ML</given-names>
        </name>
        <name>
          <surname>Welch</surname>
          <given-names>DM</given-names>
        </name>
        <article-title>Accuracy and quality of massively parallel DNA pyrosequencing</article-title>
        <source>Genome Biol</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R143</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2007-8-7-r143</pub-id>
        <pub-id pub-id-type="pmid">17659080</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="other">
        <article-title>Sequence assembly with MIRA3</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/apps/mediawiki/mira-assembler/">http://sourceforge.net/apps/mediawiki/mira-assembler/</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dohm</surname>
          <given-names>JC</given-names>
        </name>
        <name>
          <surname>Lottaz</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Borodina</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Himmelbauer</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Substantial biases in ultra-short read data sets from high-throughput DNA sequencing</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e105</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn425</pub-id>
        <pub-id pub-id-type="pmid">18660515</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="other">
        <article-title>VarScan User's Manual</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://varscan.sourceforge.net/using-varscan.html">http://varscan.sourceforge.net/using-varscan.html</ext-link>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
