<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4201578</article-id>
    <article-id pub-id-type="pmid">25330359</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-14-31682</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0110726</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome Annotation</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Comparative Genomics</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Microbiology</subject>
        </subj-group>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Machines</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Applications</subject>
          <subj-group>
            <subject>Web-Based Applications</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computer Software</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Software-Aided Sequence Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MacSyFinder: A Program to Mine Genomes for Molecular Systems with an Application to CRISPR-Cas Systems</article-title>
      <alt-title alt-title-type="running-head">MacSyFinder: Macromolecular Systems Detection</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Abby</surname>
          <given-names>Sophie S.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Néron</surname>
          <given-names>Bertrand</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ménager</surname>
          <given-names>Hervé</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Touchon</surname>
          <given-names>Marie</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rocha</surname>
          <given-names>Eduardo P. C.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Microbial Evolutionary Genomics, Institut Pasteur, Paris, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>UMR3525, CNRS, Paris, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Centre d’Informatique pour la Biologie, Institut Pasteur, Paris, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Torres</surname>
          <given-names>Néstor V.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Universidad de La Laguna, Spain</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>sophie.abby@pasteur.fr</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: SSA EPCR MT. Performed the experiments: SSA MT. Analyzed the data: MT. Contributed to the writing of the manuscript: SSA EPCR MT. Designed the MacSyFinder software: SSA BN. Designed the MacSyView application: SSA BN HM.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>10</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>10</issue>
    <elocation-id>e110726</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>7</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>9</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Abby et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Abby et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Motivation</title>
        <p>Biologists often wish to use their knowledge on a few experimental models of a given molecular system to identify homologs in genomic data. We developed a generic tool for this purpose.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p><bold>Mac</bold>romolecular <bold>Sy</bold>stem <bold>Finder</bold> (MacSyFinder) provides a flexible framework to model the properties of molecular systems (cellular machinery or pathway) including their components, evolutionary associations with other systems and genetic architecture. Modelled features also include functional analogs, and the multiple uses of a same component by different systems. Models are used to search for molecular systems in complete genomes or in unstructured data like metagenomes. The components of the systems are searched by sequence similarity using Hidden Markov model (HMM) protein profiles. The assignment of hits to a given system is decided based on compliance with the content and organization of the system model. A graphical interface, MacSyView, facilitates the analysis of the results by showing overviews of component content and genomic context. To exemplify the use of MacSyFinder we built models to detect and class CRISPR-Cas systems following a previously established classification. We show that MacSyFinder allows to easily define an accurate “Cas-finder” using publicly available protein profiles.</p>
      </sec>
      <sec>
        <title>Availability and Implementation</title>
        <p>MacSyFinder is a standalone application implemented in Python. It requires Python 2.7, Hmmer and makeblastdb (version 2.2.28 or higher). It is freely available with its source code under a GPLv3 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/gem-pasteur/macsyfinder">https://github.com/gem-pasteur/macsyfinder</ext-link>. It is compatible with all platforms supporting Python and Hmmer/makeblastdb. The “Cas-finder” (models and HMM profiles) is distributed as a compressed tarball archive as Supporting Information.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>This project was funded by the Institut Pasteur (<ext-link ext-link-type="uri" xlink:href="http://www.pasteur.fr/en">http://www.pasteur.fr/en</ext-link>), the French “Centre National de la Recherche Scientifique” (<ext-link ext-link-type="uri" xlink:href="http://www.cnrs.fr/index.php">http://www.cnrs.fr/index.php</ext-link>) and the European Research Council (<ext-link ext-link-type="uri" xlink:href="http://erc.europa.eu/">http://erc.europa.eu/</ext-link>) (grant EVOMOBILOME, number 281605). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Macromolecular systems are involved in key aspects of cell biology <xref rid="pone.0110726-Alberts1" ref-type="bibr">[1]</xref>, <xref rid="pone.0110726-PereiraLeal1" ref-type="bibr">[2]</xref>. They can be constituted of nanomachines, like the ribosome or the flagellum, or molecular pathways, like the ones allowing the degradation of foreign genetic elements by CRISPR-Cas systems. The identification and classification of macromolecular systems is important to characterize biological traits, and is routinely done in many laboratories. However, it is difficult to do on a systematic basis by a number of reasons. Firstly, systems are made of many different components with different levels of dispensability, some being essential and others accessory. For example, homologous recombination in bacteria involves some key essential components (like RecA), and several associated alternative pathways (like RecBCD and RecFOR) <xref rid="pone.0110726-Michel1" ref-type="bibr">[3]</xref>. Secondly, key components may have homologs in other systems, complicating their unambiguous assignment to a given system. This is for instance the case of the non-flagellar type III secretion system for which eight of the nine core genes have homologs in the bacterial flagellum <xref rid="pone.0110726-Abby1" ref-type="bibr">[4]</xref>. Thirdly, the components of the systems evolve at very diverse rates, complicating the identification of homology by sequence similarity. For example, many proteins involved in reproduction are highly conserved, whereas others endure selection for fast evolution <xref rid="pone.0110726-Galagan1" ref-type="bibr">[5]</xref>. These difficulties can be partly circumvented by searching for the whole set of components of the system because the integration of all the information leads to more accurate inference. This is especially relevant if the genes encoding these components are organized in highly conserved ways. In Prokaryotes, organelles and viruses, macromolecular systems are often encoded in one or a few conserved neighbouring operons ensuring tight regulation and correct assembly/functioning. This facilitates the assignment of certain components to a system <xref rid="pone.0110726-Huynen1" ref-type="bibr">[6]</xref>–<xref rid="pone.0110726-Zaslaver1" ref-type="bibr">[9]</xref>.</p>
    <p>We have developed a program named <bold>Mac</bold>romolecular <bold>Sy</bold>stem <bold>Finder</bold> (MacSyFinder) to detect molecular systems in genome data from user-defined biological models. The components of the systems are searched using protein profiles encoded as hidden Markov models (HMM), such as those available in databases like PFAM, TIGRFAM or PRODOM <xref rid="pone.0110726-Finn1" ref-type="bibr">[10]</xref>–<xref rid="pone.0110726-Servant1" ref-type="bibr">[12]</xref>. Protein profiles provide a compressed way to represent a database of homologous sequences, giving increased sensitivity and specificity <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. MacSyFinder identifies the presence of a given system according to the specifications of the input model, which includes customizable information on the type and number of components, on their genetic organization, and other relevant discriminating traits. We implemented MacSyFinder as a generic portable tool that can be installed in-house for large genomic or metagenomic projects. The companion program, MacSyView, allows the visualization of the results of MacSyFinder. To show a typical situation where MacSyFinder can be useful, we built a set of models to identify Cas proteins. Clustered regularly interspaced short palindromic repeats (CRISPR) arrays and their associated Cas (CRISPR-associated) proteins form the CRISPR-Cas system. CRISPR-Cas are sophisticated adaptive immune systems that rely on small RNAs for sequence-specific targeting of foreign nucleic acids such as viruses and plasmids <xref rid="pone.0110726-Barrangou1" ref-type="bibr">[14]</xref>. Cas proteins have been intensively studied in the recent years for their role in the interaction between Prokaryotes and their mobile genetic elements and for their biotechnological interest <xref rid="pone.0110726-Hsu1" ref-type="bibr">[15]</xref>, <xref rid="pone.0110726-Barrangou2" ref-type="bibr">[16]</xref>. Tools are available to detect and analyse CRISPR arrays <xref rid="pone.0110726-Bland1" ref-type="bibr">[17]</xref>–<xref rid="pone.0110726-Edgar1" ref-type="bibr">[19]</xref>, however, no program is available to detect and class <italic>cas</italic> operons themselves. This example shows that using information from the literature and available protein profiles, one can easily build an accurate and efficient “Cas-finder” with MacSyFinder.</p>
  </sec>
  <sec id="s2">
    <title>MacSyFinder's Rationale</title>
    <sec id="s2a">
      <title>Definition of the models</title>
      <p>MacSyFinder models, written using an XML grammar, describe the components and genetic organization of a given macromolecular system (see the documentation in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref> for a full description of the grammar). Each model is defined in a dedicated file named after the type of system (<italic>e.g.,</italic> CAS-TypeI.xml'), which contains system-wise and component-wise features (<xref ref-type="fig" rid="pone-0110726-g001">Figure 1</xref>). MacSyFinder considers three classes of components: <italic>mandatory</italic>, <italic>accessory</italic>, and <italic>forbidden</italic>. Components that are ubiquitous and identifiable in all systems are defined as <italic>mandatory</italic>. Other components of the system are defined as <italic>accessory</italic>. These <italic>accessory</italic> components can be essential for the assembly/functioning of the system, while not being identifiable by sequence similarity because of rapid evolution or because they are non-homologous among variants of the system. Discrimination between partly homologous systems is easier when some specific components are defined as <italic>forbidden</italic> in the models of the systems lacking them (<xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>).</p>
      <fig id="pone-0110726-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Modelling systems with MacSyFinder.</title>
          <p>The components of a system assemble into macromolecular systems or correspond to a biological pathway. They are typically encoded in genomes in one or a few different loci (“Genomic context”). We illustrate how systems can be modelled and distinguished with two imaginary systems “A” and “B” that have four homologous components (C1–C4, similar colours for the two systems). The system “B” has one component that is not found in “A”(C5). The parameter <italic>inter_gene_max_space</italic> (D) defines the maximal number of genes between two consecutive components (d<sub>i,j</sub>). The two systems are defined by a set of <italic>mandatory</italic> (green), <italic>accessory</italic> (black) and <italic>forbidden</italic> (red) components. The quorum rules allow relaxing the definition of the system without altering the list of its components (<italic>min_genes_required</italic> and <italic>min_mandatory_genes_required</italic> parameters in XML files). If they are not specified, a default value is computed from the number of components described in the XML files. The bottom part of the figure shows the description of the systems in the XML grammar (see the documentation in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>). Components listed here refer to protein profiles (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3</xref>). When a component is found in several systems, it is defined only once, and can be reused in another system with the <italic>system_ref</italic> keyword. Much more complex features can be defined, including exchangeable genes, distant genes and component-specific parameters (<xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>).</p>
        </caption>
        <graphic xlink:href="pone.0110726.g001"/>
      </fig>
      <p>Systems that respect a pre-defined minimal quorum of components are identified as complete. The quorum is either the number of <italic>mandatory</italic> components and/or the sum of <italic>mandatory</italic> and <italic>accessory</italic> components (see the documentation on attributes <italic>min_mandatory_genes_required</italic> and <italic>min_genes_required</italic> in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>). Components defined as functionally <italic>exchangeable</italic> are only counted once in the quorum. These components can be part of systems defined in other models using the <italic>system_ref</italic> keyword. Genes encoding components that participate in multiple systems of the same type, such as proteins interacting with different instances of a system, are labelled <italic>multi_system</italic>.</p>
      <p>The genetic architecture of the components is defined using several attributes. Two components are co-localized when their genes are closer than a given number of genes (system-wise parameter <italic>inter_gene_max_space</italic>, <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>). A component defined with the <italic>loner</italic> attribute does not need to be co-localized with other components to be part of a system. One can also specify component-specific values of <italic>inter_gene_max_space</italic>. The system-wise parameter <italic>multi_loci</italic> allows MacSyFinder to detect systems encoded by several distant clusters of genes.</p>
    </sec>
    <sec id="s2b">
      <title>Implementation, system requirements and availability</title>
      <p>MacSyFinder was coded in Python, and details on its object-oriented implementation are available in <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref> and in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>. MacSyFinder requires Python version 2.7, the formatdb or makeblastdb tools (version 2.2.28 or better for the latter) <xref rid="pone.0110726-NCBI1" ref-type="bibr">[20]</xref>, <xref rid="pone.0110726-Camacho1" ref-type="bibr">[21]</xref> and the program Hmmer <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>, <xref rid="pone.0110726-Eddy2" ref-type="bibr">[22]</xref>. MacSyFinder is freely available. Its source code is distributed under a GPLv3 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/gem-pasteur/macsyfinder">https://github.com/gem-pasteur/macsyfinder</ext-link> and updated versions will be accessible there. MacSyFinder is compatible with all platforms supporting Python, Hmmer, and makeblastdb. The MacSyFinder release used in this paper is provided in <xref ref-type="supplementary-material" rid="pone.0110726.s010">Data S1</xref>. MacSyView's source code is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gem-pasteur/macsyview">https://github.com/gem-pasteur/macsyview</ext-link> but it is also distributed in the MacSyFinder's package. MacSyView was coded in Javascript and uses third-party libraries that are included in the package, and accredited in the COPYRIGHT file (See <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>). It was tested on Chromium and Firefox for Linux, and on Chrome, Firefox and Safari for Mac OS X. A documentation file including installation and users' instructions, details on modelling procedures and examples for MacSyView and MacSyFinder is available in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>.</p>
    </sec>
    <sec id="s2c">
      <title>Input and output</title>
      <p>The MacSyFinder program (<xref ref-type="supplementary-material" rid="pone.0110726.s010">Data S1</xref>) receives as input a list of systems defined in XML files (see above), protein profiles, command-line parameters and a file with protein sequences in fasta format (see the documentation in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>). The parameters can be specified in the command-line or in a configuration file. System and component parameters specified in the command-line override model specifications in the XML files.</p>
      <p>MacSyFinder manages three different types of protein datasets. The <bold>unordered</bold> dataset lacks information on gene order and genome origin. This mode is useful to study large sequence databanks or metagenomic data. Naturally, in these datasets the notions of co-localization and quorum are not relevant. The <bold>unordered replicon</bold> dataset includes protein sequences from one single genome. This is useful to analyse unassembled genomes with large numbers of contigs. In this case the notion of quorum is relevant (albeit with certain limitations), but co-localization is not. The <bold>ordered replicon</bold> dataset includes proteins from one single replicon that are ordered according to the position of the corresponding genes in the genome. This is the most powerful mode and can be used to analyse complete or nearly complete genomes. Another related mode (<italic>gembase</italic>) requires a specific input file format and allows the analysis of multiple ordered replicons in a single step (see <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>).</p>
      <p>The output of MacSyFinder includes log files, intermediate results, the number of detected systems, and the information on each detected component from each instance of the system. This information is made available in the form of text tables and JSON files. We have built MacSyView, a standalone web-browser application that uses output JSON files to visualise the systems and their genomic context. MacSyView generates exportable SVG files containing views of the detected systems (<xref ref-type="fig" rid="pone-0110726-g002">Fig. 2</xref>).</p>
      <fig id="pone-0110726-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Snapshot of MacSyFinder's results as viewed with MacSyView.</title>
          <p>A. The MacSyView web-browser based application allows the visualization of MacSyFinder's output file “results.macsyfinder.json”. B. MacSyView displays the list of systems available in the results file. The user picks a system to visualize by clicking on it in the list. C. The page displaying the system is made of a header, and three panels. The header allows to select another input file, or to go back to the list of systems. It displays information on the system that is being visualized. The first panel shows how the detected system fits the model compliance in terms of its components. Boxes represent the number of each <italic>mandatory</italic>, <italic>accessory</italic>, and <italic>forbidden</italic> components. A tooltip gives the name of the component when the mouse hovers a box. Component boxes can be sorted by decreasing number of components. The second panel shows the genetic context of the system (as transcribed from the input fasta file), with components drawn to scale. When the mouse hovers a box, a tooltip displays information on the corresponding component, including scores of the Hmmer hit. This view can be exported as a SVG file for drawing purposes (tools circled in red). The third panel gives detailed information on the components of the system.</p>
        </caption>
        <graphic xlink:href="pone.0110726.g002"/>
      </fig>
    </sec>
    <sec id="s2d">
      <title>Functioning</title>
      <p>The user runs MacSyFinder from the command-line on a protein sequence dataset for a number of systems of interest. The non-redundant list of components to search is extracted from the XML files. The presence of a given component is determined by similarity search with HMM protein profiles using the program Hmmer <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. The hits are filtered according to user-defined i-evalue (for statistical significance) and to the minimal coverage of the profile in the alignment (to control for the minimal size of the profile that must be matched to obtain biologically relevant hits). The components defined in the models are searched in parallel for rapidity (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3A</xref>). If multiple profiles match the same protein, MacSyFinder selects the hit with the highest score. The subsequent steps depend on whether the input dataset is an ordered replicon, an unordered genome or an unordered genomic dataset (<italic>e.g</italic>., a metagenome).</p>
      <fig id="pone-0110726-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Functioning of MacSyFinder.</title>
          <p>A. The user launches MacSyFinder to detect macromolecular systems A and B (example of <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>). System-specific parameters are read from the corresponding XML definition files. This includes the list of the components of the systems and the corresponding HMM profiles. Other detection parameters are picked by order of priority: on the command-line, in the configuration file, and in the XML files. Sequences are indexed with the “formatdb” or “makeblastdb” tools for similarity search with the Hmmer program. MacSyFinder runs (optionally in parallel) the Hmmer searches on a non-redundant list of components' profiles. If the sequence dataset is “unordered” MacSyFinder only outputs the hits and the components detected for each type of system. B. Step #1: the co-localization criterion can be used in the ordered datasets. It involves clustering the hits separated by less than D protein-coding genes. The components described as “loner” in the XML definition files can be at any distance from other components. Step #2: the components of each cluster are used to fill the occurrences of the systems. Depending on the quorum, a cluster can describe a “full” system, or a “scattered” system. Step #3: clusters with components belonging to more than one system are split in unique systems and then re-directed separately to step #2.</p>
        </caption>
        <graphic xlink:href="pone.0110726.g003"/>
      </fig>
      <p>If the dataset is an <bold>ordered replicon</bold>, the hits are clustered according to the genetic organization specified in the model. Clusters including the components of a single type of system are used to fill inventories of “compatible” systems (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3B</xref>). If multiple systems are compatible with the set of components in the clusters, then the different candidate systems are examined. The order of exam is given by decreasing number of components shared between the cluster and the compatible systems. The cluster will be assigned to the first system in the list that fits its content. A system is regarded as complete if the quorum is respected. When a complete instance of the system has components from a single locus, further new occurrences of the same components in the cluster are used to produce a novel instance. When a single cluster is not enough to make a complete instance and the <italic>multi_loci</italic> parameter is turned on, the hits are stored to fill up an instance of the system encoded by multiple distant loci. Clusters with components from multiple systems are split in sub-clusters containing components from a single system. These sub-clusters are then re-analysed in terms of their components (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3B</xref>). MacSyFinder can only resolve these complex cases if the components of each system are contiguous, instead of scattered on the cluster.</p>
      <p><bold>Unordered</bold> sequence datasets cannot be analysed with the co-localization criteria. Therefore, hits from the similarity searches are directly used to fill inventories of each system. Systems are complete if the required quorum is respected. The presence of <italic>forbidden</italic> components is ignored in this mode, even if such occurrences are stored to inform the user. A single system instance will be filled per system and dataset, independently of the number of component occurrences found. This is because components cannot be individually assigned to particular instances in the absence of the genomic context. Nevertheless, the analysis of the number of identified components can be used to estimate the number of instances in the dataset.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Application</title>
    <sec id="s3a">
      <title>Data</title>
      <p>The complete genomes of bacteria (2484) and archaea (159) were downloaded from NCBI RefSeq (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/">ftp://ftp.ncbi.nih.gov/genomes/</ext-link>, November 2013). Profiles for the Cas protein families were obtained from the TIGRFAM database, version 13.0 (<ext-link ext-link-type="uri" xlink:href="http://www.jcvi.org/cgi-bin/tigrfams/index.cgi">http://www.jcvi.org/cgi-bin/tigrfams/index.cgi</ext-link>, August 15 2012) <xref rid="pone.0110726-Haft1" ref-type="bibr">[11]</xref>, <xref rid="pone.0110726-Haft2" ref-type="bibr">[23]</xref>. Among the 89 profiles available, 53 were constructed by Haft and colleagues <xref rid="pone.0110726-Haft3" ref-type="bibr">[24]</xref> and correspond to 45 Cas protein families that were used to propose a CRISPR-Cas systems classification <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. Subsequently, these authors constructed 36 additional protein profiles more specific to given subtypes that are available in TIGRFAM <xref rid="pone.0110726-Haft2" ref-type="bibr">[23]</xref>. We renamed these profiles to make them more informative for the user (see <xref ref-type="supplementary-material" rid="pone.0110726.s004">Table S1</xref> for correspondence with established classification).</p>
    </sec>
    <sec id="s3b">
      <title>Developing a new system's model</title>
      <p>The goal of MacSyFinder is to query genomic data using biologically meaningful models of a system. The first step of the model building procedure is therefore to use the available knowledge to identify the system components, their frequency and their genetic architecture. The second step is to obtain protein profiles for the components either by building them specifically for this purpose or by retrieving them from public databases. Protein profiles can be built easily from multiple sequence alignments of homologous proteins using Hmmer <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. The third step is to write the model in the simple MacSyFinder's XML grammar (see above and <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref> for an example). The final step is to include information about homologous systems in the model. The use of system-specific profiles and <italic>forbidden</italic> attributes facilitates the discrimination between systems (<xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>). Our experience is that complex models should be built by iterating several times on these steps from simpler models. Indeed, the fine-tuning of the quorum definitions and genetic architectures can vastly increase the quality of identification of a system. Often, one is confronted with systems for which very few instances have been experimentally studied. In this case, iteration of the modelling steps provides both more reliable models and a better knowledge of the systems diversity. To exemplify the use of MacSyFinder we built models to identify Cas proteins and classify CRISPR-Cas systems. This is a very typical example of systems that are intensively studied, for which there are many protein profiles in the databases, but no software dedicated to their detection.</p>
    </sec>
    <sec id="s3c">
      <title>Detection and classification of CRISPR-Cas systems</title>
      <p>The known <italic>cas</italic> operons have from 3 to 13 genes encoding very diverse proteins, among which several nucleases and helicases with DNA and/or RNA binding domains <xref rid="pone.0110726-Haft3" ref-type="bibr">[24]</xref>, <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. A unified classification of CRISPR-Cas systems has been recently established based on the presence or absence of peculiar Cas protein families, and on the genetic architecture of the <italic>cas</italic> operon <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. Three major types and several subtypes of CRISPR-Cas systems have been described. <italic>cas1</italic> and <italic>cas2</italic> universally occur across types and subtypes, whereas <italic>cas3</italic>/<italic>cas7</italic>, <italic>cas9</italic>, and <italic>cas10</italic> have been defined as the signature genes for type I, type II, and type III, respectively (<xref ref-type="fig" rid="pone-0110726-g004">Fig. 4</xref>). Protein profiles matching most of these Cas protein families are publicly available in the TIGRFAM database <xref rid="pone.0110726-Haft1" ref-type="bibr">[11]</xref>, <xref rid="pone.0110726-Haft3" ref-type="bibr">[24]</xref>. We used this information to exemplify how MacSyFinder can be used to identify and classify these systems.</p>
      <fig id="pone-0110726-g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Simplified operon organization of the three major types and ten subtypes of CRISPR-Cas systems.</title>
          <p>Each <italic>cas</italic> gene family is indicated with a distinct colour, those specific to a subtype are in white. Only the main <italic>cas</italic> gene families are represented.</p>
        </caption>
        <graphic xlink:href="pone.0110726.g004"/>
      </fig>
      <sec id="s3c1">
        <title>General model and choice of parameters</title>
        <p>In a first round of analysis, we defined a <bold>general simple model</bold> to identify all possible clusters of Cas proteins in 2643 prokaryotic genomes. In this general definition, all the CRISPR-Cas-HMM profiles available in TIGRFAM database were used whatever their type or subtype specificity (<xref ref-type="supplementary-material" rid="pone.0110726.s004">Table S1</xref>). At this stage, we used relatively relaxed criteria: all the components were defined as <italic>accessory</italic> and all clusters with at least 3 different components (<italic>min_genes_required</italic> = 3) distant from at most 5 genes (<italic>inter_gene_max_space</italic> “D” = 5) were retained. With this procedure, we identified 1628 clusters of Cas proteins and could annotate 10663 Cas proteins (<italic>i.e.</italic>, with significant matches to protein profiles). The total number of genes in the detected clusters ranged from 3 to 36 with an average of 7.7±3.5 genes (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1A</xref>). In these clusters, most of the genes (86%) encode known Cas proteins (<italic>i.e.</italic>, described in the general definition) and 56% of clusters have components strictly contiguous (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1B</xref>). While these preliminary results suggest that most clusters are Cas systems, a small fraction of them (7%) is larger than the larger described systems (&gt;13 genes, <xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1A</xref>), suggesting that the above-mentioned parameters might be too permissive (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1C</xref>). These large clusters might correspond to contiguous or intertwined systems (<italic>i.e.</italic>, chimeric variants). To test this hypothesis, we explored the effect of changing D on the identification of clusters (<italic>i.e.</italic>, D = 4, 5, and 6, see <xref ref-type="supplementary-material" rid="pone.0110726.s005">Table S2</xref>). A more stringent co-localization criterion (D = 4), resulted in a decrease of the overall number of Cas proteins assigned to systems, the subdivision of several previously detected clusters, and the persistence of large clusters (<xref ref-type="supplementary-material" rid="pone.0110726.s005">Table S2</xref>). A less stringent criterion (D = 6) led to the fusion of several clusters with a small gain of Cas proteins assigned to systems (<xref ref-type="supplementary-material" rid="pone.0110726.s005">Table S2</xref>). We therefore set the final co-localization criterion to 5, and the minimal number of genes to 3. Doubts about multiple closely co-occurring systems can often be removed using more specific “typing” and “subtyping” models, because in this case contiguous systems of different types will be set apart (see below). While the general definition of the system is very simple, it fetches systems with Cas1 or a Cas2 protein in respectively 88% and 73% of the clusters, even if weak constraints were imposed on their presence (<italic>accessory</italic> proteins in the general definition of the system). We identified Cas clusters in 78% of archaeal genomes and 39% of bacterial genomes. This is very similar to previous observations and therefore suggests that even the general model accurately identifies Cas systems <xref rid="pone.0110726-Staals1" ref-type="bibr">[26]</xref> (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1D</xref>, and see the paragraph on the validation of our models).</p>
      </sec>
      <sec id="s3c2">
        <title>Typing and Subtyping CRISPR-Cas systems</title>
        <p>To exemplify the ability of MacSyFinder to characterise sub-systems we built models for each type and subtype of Cas systems from the pre-existing classification <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref> (<xref ref-type="fig" rid="pone-0110726-g004">Fig. 4</xref>). We first tested the specificity of the 89 available protein profiles for a given type and subtype by analysing the co-occurrence of pairs of Cas proteins in clusters detected with the general model (<xref ref-type="fig" rid="pone-0110726-g005">Fig. 5</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>). Then we designed the corresponding models accordingly. In the final models (<xref ref-type="supplementary-material" rid="pone.0110726.s002">Fig. S2</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>), all profiles specific to a system were defined as <italic>mandatory</italic> (signature gene) while all the others were defined as <italic>accessory</italic>. Because some systems have very similar content and organization (<italic>e.g.</italic>, Type II-A and II-B), profiles distinguishing them are <italic>accessory</italic> or <italic>mandatory</italic> in a system, and <italic>forbidden</italic> in the other (see <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s002">Fig. S2</xref> for examples). Although the types and subtypes have different numbers of genes, we set the <italic>min_genes_required</italic> parameter to 3, and the <italic>inter_gene_max_space</italic> parameter to 5 for all models to make the detection as large as possible and comparable with that resulting from the general model. We defined 5”typing” models and 15”subtyping” models for <italic>cas</italic> loci detection and classification (see <xref ref-type="supplementary-material" rid="pone.0110726.s002">Fig. S2</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>).</p>
        <fig id="pone-0110726-g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Frequency of co-occurrence between Cas proteins present in clusters detected with the general model (left) and the subtyping models (right).</title>
            <p>Each matrix was normalized by the maximum of each column. The higher the frequency is, the warmer the colour is: the red diagonal corresponds to a 100% co-occurrence. Only frequencies above 1% were represented, others are in grey.</p>
          </caption>
          <graphic xlink:href="pone.0110726.g005"/>
        </fig>
        <p>Using the <bold>subtyping models</bold> we classed the previously detected Cas clusters, but were also able to split different contiguous systems (<xref ref-type="fig" rid="pone-0110726-g005">Fig. 5</xref>). Thus, among the 1628 Cas clusters, 95% correspond to a single system, 3% to contiguous distinct systems (including the type III-B well known to be associated with other systems-type <xref rid="pone.0110726-Staals1" ref-type="bibr">[26]</xref>), the remaining 2% correspond to chimeric variants. Most of the Cas clusters could readily be assigned to proposed types (97%) and subtypes (94%) with our models. The remaining corresponded to <italic>cas</italic> locus with no gene signature, or to chimeric variants (<xref ref-type="supplementary-material" rid="pone.0110726.s006">Table S3</xref>).</p>
      </sec>
      <sec id="s3c3">
        <title>Validation of detected systems</title>
        <p>We made two analyses to obtain a more precise assessment of the accuracy of the method. Firstly, we quantified how often Cas systems detected with the General definition (command-lines available in <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>) co-occurred with CRISPR arrays as is the case in all fully functional described systems. We searched for CRISPR-arrays with <xref rid="pone.0110726-Bland1" ref-type="bibr">[17]</xref> as described in <xref rid="pone.0110726-Touchon1" ref-type="bibr">[27]</xref> and found that 88% of the detected Cas systems are close (&lt;1kb, same result for &lt;5kb) to a CRISPR-array and that 98% are present in a replicon containing at least one CRISPR-array. The absence of CRISPR in so few Cas-containing genomes suggests the method has a low rate of false positives. Secondly, we took from the literature the list of CRISPR-Cas with experimentally characterized <italic>in vivo</italic> effects <xref rid="pone.0110726-BondyDenomy1" ref-type="bibr">[28]</xref>. In this list we could detect 100% of the 25 known Cas systems of genomes included in our dataset (<xref ref-type="supplementary-material" rid="pone.0110726.s007">Table S4</xref>) with our “general”, “typing” and “subtyping” models (see command-lines in <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>). Furthermore, we could assign the correct subtype to 23 of them, and we propose a subtype for the system of <italic>Mycoplasma gallisepticum</italic>. This suggests a low rate of false negatives. Altogether these results suggest the method is very accurate and that most clusters correspond to CRISPR-Cas systems. Type I systems are more abundant in both bacteria (in ∼31% of the bacterial genomes) and archaea (∼71%), Type II are only found in bacteria, while Type III are more prevalent in archaea (∼38%) (<xref ref-type="table" rid="pone-0110726-t001">Table 1</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s003">Fig. S3</xref>). These results are consistent with previous analyses <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. Subtypes I-C, I-E and I-F are more commonly found in bacteria, while subtypes I-A, I-B and I-D are frequent in archaea, as previously noted <xref rid="pone.0110726-Staals1" ref-type="bibr">[26]</xref>. Overall, these results suggest that our models are able to accurately identify and type Cas systems. Profiles and models for the “Cas-Finder” are provided in <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>. Users can easily add or remove components and change the genetic organization specifications.</p>
        <table-wrap id="pone-0110726-t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0110726.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Taxonomic distribution of CRISPR-Cas types and sub-types in prokaryotes expressed in number and percentage of the genomes harboring the systems.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0110726-t001-1" xlink:href="pone.0110726.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Typing</td>
                  <td colspan="7" align="left" rowspan="1">Type I</td>
                  <td colspan="3" align="left" rowspan="1">Type II</td>
                  <td colspan="3" align="left" rowspan="1">Type III</td>
                  <td align="left" rowspan="1" colspan="1">Type U</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Bacteria</td>
                  <td colspan="7" align="left" rowspan="1">769 (31%)</td>
                  <td colspan="3" align="left" rowspan="1">177 (7%)</td>
                  <td colspan="3" align="left" rowspan="1">222 (9%)</td>
                  <td align="left" rowspan="1" colspan="1">7</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Archaea</td>
                  <td colspan="7" align="left" rowspan="1">113 (71%)</td>
                  <td colspan="3" align="left" rowspan="1">0</td>
                  <td colspan="3" align="left" rowspan="1">60 (38%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>Subtyping</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-A</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-B</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-C</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-D</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-E</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-F</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-U</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>II-A</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>II-B</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>II-U</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>III-A</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>III-B</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>III-U</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>U</bold>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Bacteria</td>
                  <td align="left" rowspan="1" colspan="1">16 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">173 (7%)</td>
                  <td align="left" rowspan="1" colspan="1">196 (8%)</td>
                  <td align="left" rowspan="1" colspan="1">31 (1%)</td>
                  <td align="left" rowspan="1" colspan="1">282 (11%)</td>
                  <td align="left" rowspan="1" colspan="1">111 (5%)</td>
                  <td align="left" rowspan="1" colspan="1">47 (2%)</td>
                  <td align="left" rowspan="1" colspan="1">81 (3%)</td>
                  <td align="left" rowspan="1" colspan="1">5 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">93 (4%)</td>
                  <td align="left" rowspan="1" colspan="1">123 (5%)</td>
                  <td align="left" rowspan="1" colspan="1">112 (5%)</td>
                  <td align="left" rowspan="1" colspan="1">3 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">7 (&lt;1%)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Archaea</td>
                  <td align="left" rowspan="1" colspan="1">55 (35%)</td>
                  <td align="left" rowspan="1" colspan="1">48 (30%)</td>
                  <td align="left" rowspan="1" colspan="1">2 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">16 (10%)</td>
                  <td align="left" rowspan="1" colspan="1">5 (3%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">2 (1%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">28 (18%)</td>
                  <td align="left" rowspan="1" colspan="1">40 (25%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
      </sec>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>The use of MacSyFinder will often involve preliminary steps to model the biological systems of interest. This allows the researcher to produce structured knowledge and is particularly useful when these systems have distinguishable traits, such as a specific genetic architecture. Often there are few studies suggesting the parameters to use in the models. Under these circumstances, one should start with very simple models, <italic>e.g.</italic>, noting all components as <italic>accessory</italic> and using low quorums. The analysis of the results of these preliminary models often provides important clues on how to produce more complex and accurate models. For example, by relaxing the criteria of the requirements to identify type III secretion systems (T3SS) we were recently able to identify a new homologous system in <italic>Myxobacteria</italic>
<xref rid="pone.0110726-Abby1" ref-type="bibr">[4]</xref>. Modelling itself can thus lead to new biological findings.</p>
    <p>MacSyFinder ignores phylogenetic information when putting together components of systems scattered in a replicon or in unordered datasets. In contrast, the preliminary distinction between homologous proteins can often be done using MacSyFinder without the need for lengthy phylogenetic analyses. This works in two steps. First, one must produce a multiple alignment gathering the different families of homologous proteins. This alignment must be divided into sub-alignments according to the different systems, leading to the production of different profiles for the different sub-families of homologs. Finally, and as a rule, for a given protein, the best-scoring profile corresponds to the relevant homologous family (see <xref ref-type="fig" rid="pone-0110726-g005">Fig. 5</xref>, and Fig. 2 in <xref rid="pone.0110726-Abby1" ref-type="bibr">[4]</xref>).</p>
    <p>It is difficult to estimate <italic>a priori</italic> how accurate MacSyFinder will be for any given biological system because this will depend on several system-specific variables. First, it will depend on the number of components of the system, their frequency in the system and their degree of sequence conservation. Systems with many highly conserved and frequent components will be much easier to identify than systems with many infrequent and fast-evolving components. Second, it will depend on the existence of other systems sharing homologous components. Systems including many components with homologs in other systems will be harder to identify. We have shown MacSyFinder can type CRISPR-Cas systems, even if they share homologs. Hence, even in these difficult situations MacSyFinder provides accurate models. The situation is necessarily more complicated when identifying systems with many homologs encoded by genes scattered in the genomes. In this case, phylogenetic methods may help in the reconstruction of the different systems.</p>
    <p>Considering MacSyFinder's running time, the limiting step is usually the identification of hits by Hmmer, which is currently very efficient <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. To speed up this step, MacSyFinder is able to compute and analyse Hmmer hits in parallel. MacSyFinder and its companion MacSyView are easy to install standalone tools. This is an advantage when it is necessary to keep the data private or when projects are so large that network transfer time is prohibitive. MacSyFinder was built to be simple to use. It is thus ideal for biologists without extensive knowledge of programming or scripting wishing to unravel the diversity of certain systems or to annotate genetic data. Often, bioinformaticians produce methods to identify machineries and would like to easily package them for reproducibility and distribution among biologists. This can be easily done with MacSyFinder <italic>via</italic> the distribution of XML files and the relevant protein profiles. The “Cas-finder” we present here is a particularly relevant case. At the time we started the project, there was public information available on the protein profiles and on the genetic organization of the systems. We only had to define the models and use them in such a way that we could identify the systems and class them. The result is a highly accurate application to identify <italic>cas</italic> operons that can be easily distributed (<xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0110726.s001">
      <label>Figure S1</label>
      <caption>
        <p><bold>Genomic architecture and taxonomic distribution of detected </bold><bold><italic>cas</italic></bold><bold> genes clusters (general model).</bold> A. Distribution of the number of different genes in detected clusters. B. Distribution of the maximal distance between two components observed in each detected cluster. C. Boxplot of the number of different genes in each cluster vs. the maximal distance between two components observed in each cluster. D. Proportion of bacterial and archaeal genomes without (cluster−) and with at least one cluster of <italic>cas</italic> genes (cluster+).</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0110726.s001.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s002">
      <label>Figure S2</label>
      <caption>
        <p><bold>Schematic and simplified representation of the subtype models.</bold> Each box corresponds to a <italic>cas</italic> gene family and the name of the corresponding HMM protein profiles are listed below. Some <italic>cas</italic> gene families have multiple HMM profiles available in the TIGRFAM database. Each <italic>cas</italic> gene family has its boxes filled (subtype non-specific) or surrounded (subtype-specific) by a distinct colour. Only the main <italic>cas</italic> gene families are represented. For full subtype models, see the XML files in <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0110726.s002.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s003">
      <label>Figure S3</label>
      <caption>
        <p><bold>Taxonomic distribution of the three CRISPR-Cas systems types.</bold> For each clade, the number of representative genomes is given, along with bar plots showing the percentage of these genomes containing the three types of CRISPR-Cas systems.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0110726.s003.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s004">
      <label>Table S1</label>
      <caption>
        <p>
          <bold>List of HMM profiles used for the “Cas-Finder”.</bold>
        </p>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0110726.s004.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s005">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Impact of the co-localization parameter on the detection.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s006">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Detection results.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s007">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Validation of the CRISPR-Cas systems detection on systems with </bold>
          <bold>
            <italic>in vivo</italic>
          </bold>
          <bold> effects listed in the review by Bondy-Denomy et. al 2014</bold>
          <xref rid="pone.0110726-BondyDenomy1" ref-type="bibr">[28]</xref>
          <bold>.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s008">
      <label>Text S1</label>
      <caption>
        <p>
          <bold>Supporting text (PDF file).</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s009">
      <label>File S1</label>
      <caption>
        <p>
          <bold>MacSyFinder's documentation file (PDF file).</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s010">
      <label>Data S1</label>
      <caption>
        <p>
          <bold>The MacSyFinder/MacSyView package (compressed tarball archive).</bold>
        </p>
        <p>(GZ)</p>
      </caption>
      <media xlink:href="pone.0110726.s010.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s011">
      <label>Data S2</label>
      <caption>
        <p>
          <bold>The Cas-Finder: models and profiles (compressed tarball archive).</bold>
        </p>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0110726.s011.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>Julien Guglielmini and Jean Cury for fruitful discussions.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0110726-Alberts1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Alberts</surname><given-names>B</given-names></name> (<year>1998</year>) <article-title>The cell as a collection of protein machines: preparing the next generation of molecular biologists</article-title>. <source>Cell</source>
<volume>92</volume>: <fpage>291</fpage>–<lpage>294</lpage>.<pub-id pub-id-type="pmid">9476889</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-PereiraLeal1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Pereira-Leal</surname><given-names>JB</given-names></name>, <name><surname>Levy</surname><given-names>ED</given-names></name>, <name><surname>Teichmann</surname><given-names>SA</given-names></name> (<year>2006</year>) <article-title>The origins and evolution of functional modules: lessons from protein complexes</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>
<volume>361</volume>: <fpage>507</fpage>–<lpage>517</lpage>.<pub-id pub-id-type="pmid">16524839</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Michel1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Michel</surname><given-names>B</given-names></name>, <name><surname>Grompone</surname><given-names>G</given-names></name>, <name><surname>Florès</surname><given-names>MJ</given-names></name>, <name><surname>Bidnenko</surname><given-names>V</given-names></name> (<year>2004</year>) <article-title>Multiple pathways process stalled replication forks</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>101</volume>: <fpage>12783</fpage>–<lpage>12788</lpage>.<pub-id pub-id-type="pmid">15328417</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Abby1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Abby</surname><given-names>SS</given-names></name>, <name><surname>Rocha</surname><given-names>EP</given-names></name> (<year>2012</year>) <article-title>The non-flagellar type III secretion system evolved from the bacterial flagellum and diversified into host-cell adapted systems</article-title>. <source>PLoS Genet</source>
<volume>8</volume>: <fpage>e1002983</fpage>.<pub-id pub-id-type="pmid">23028376</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Galagan1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Galagan</surname><given-names>JE</given-names></name>, <name><surname>Nusbaum</surname><given-names>C</given-names></name>, <name><surname>Roy</surname><given-names>A</given-names></name>, <name><surname>Endrizzi</surname><given-names>MG</given-names></name>, <name><surname>Macdonald</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2002</year>) <article-title>The genome of M. acetivorans reveals extensive metabolic and physiological diversity</article-title>. <source>Genome Res</source>
<volume>12</volume>: <fpage>532</fpage>–<lpage>542</lpage>.<pub-id pub-id-type="pmid">11932238</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Huynen1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Huynen</surname><given-names>M</given-names></name>, <name><surname>Snel</surname><given-names>B</given-names></name>, <name><surname>Lathe</surname><given-names>W</given-names><suffix>3rd</suffix></name>, <name><surname>Bork</surname><given-names>P</given-names></name> (<year>2000</year>) <article-title>Predicting protein function by genomic context: quantitative evaluation and qualitative inferences</article-title>. <source>Genome Res</source>
<volume>10</volume>: <fpage>1204</fpage>–<lpage>1210</lpage>.<pub-id pub-id-type="pmid">10958638</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Overbeek1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Overbeek</surname><given-names>R</given-names></name>, <name><surname>Fonstein</surname><given-names>M</given-names></name>, <name><surname>D'Souza</surname><given-names>M</given-names></name>, <name><surname>Pusch</surname><given-names>GD</given-names></name>, <name><surname>Maltsev</surname><given-names>N</given-names></name> (<year>1999</year>) <article-title>The use of gene clusters to infer functional coupling</article-title>. <source>Proc Natl Acad Sci USA</source>
<volume>96</volume>: <fpage>2896</fpage>–<lpage>2901</lpage>.<pub-id pub-id-type="pmid">10077608</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Lathe1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Lathe</surname><given-names>WC</given-names></name>, <name><surname>Snel</surname><given-names>B</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name> (<year>2000</year>) <article-title>Gene context conservation of a higher order than operons</article-title>. <source>Trends Biochem Sci</source>
<volume>25</volume>: <fpage>474</fpage>–<lpage>479</lpage>.<pub-id pub-id-type="pmid">11050428</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Zaslaver1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Zaslaver</surname><given-names>A</given-names></name>, <name><surname>Mayo</surname><given-names>A</given-names></name>, <name><surname>Ronen</surname><given-names>M</given-names></name>, <name><surname>Alon</surname><given-names>U</given-names></name> (<year>2006</year>) <article-title>Optimal gene partition into operons correlates with gene functional order</article-title>. <source>Phys Biol</source>
<volume>3</volume>: <fpage>183</fpage>–<lpage>189</lpage>.<pub-id pub-id-type="pmid">17021382</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Finn1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Finn</surname><given-names>RD</given-names></name>, <name><surname>Tate</surname><given-names>J</given-names></name>, <name><surname>Mistry</surname><given-names>J</given-names></name>, <name><surname>Coggill</surname><given-names>PC</given-names></name>, <name><surname>Sammut</surname><given-names>SJ</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>D281</fpage>–<lpage>288</lpage>.<pub-id pub-id-type="pmid">18039703</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Haft1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Loftus</surname><given-names>BJ</given-names></name>, <name><surname>Richardson</surname><given-names>DL</given-names></name>, <name><surname>Yang</surname><given-names>F</given-names></name>, <name><surname>Eisen</surname><given-names>JA</given-names></name>, <etal>et al</etal> (<year>2001</year>) <article-title>TIGRFAMs: a protein family resource for the functional identification of proteins</article-title>. <source>Nucleic Acids Res</source>
<volume>29</volume>: <fpage>41</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">11125044</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Servant1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Servant</surname><given-names>F</given-names></name>, <name><surname>Bru</surname><given-names>C</given-names></name>, <name><surname>Carrere</surname><given-names>S</given-names></name>, <name><surname>Courcelle</surname><given-names>E</given-names></name>, <name><surname>Gouzy</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2002</year>) <article-title>ProDom: automated clustering of homologous domains</article-title>. <source>Brief Bioinform</source>
<volume>3</volume>: <fpage>246</fpage>–<lpage>251</lpage>.<pub-id pub-id-type="pmid">12230033</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Eddy1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Eddy</surname><given-names>SR</given-names></name> (<year>2011</year>) <article-title>Accelerated Profile HMM Searches</article-title>. <source>PLoS Comput Biol</source>
<volume>7</volume>: <fpage>e1002195</fpage>.<pub-id pub-id-type="pmid">22039361</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Barrangou1">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Barrangou</surname><given-names>R</given-names></name>, <name><surname>Marraffini</surname><given-names>LA</given-names></name> (<year>2014</year>) <article-title>CRISPR-Cas systems: Prokaryotes upgrade to adaptive immunity</article-title>. <source>Mol Cell</source>
<volume>54</volume>: <fpage>234</fpage>–<lpage>244</lpage>.<pub-id pub-id-type="pmid">24766887</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Hsu1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Hsu</surname><given-names>PD</given-names></name>, <name><surname>Lander</surname><given-names>ES</given-names></name>, <name><surname>Zhang</surname><given-names>F</given-names></name> (<year>2014</year>) <article-title>Development and Applications of CRISPR-Cas9 for Genome Engineering</article-title>. <source>Cell</source>
<volume>157</volume>: <fpage>1262</fpage>–<lpage>1278</lpage>.<pub-id pub-id-type="pmid">24906146</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Barrangou2">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Barrangou</surname><given-names>R</given-names></name> (<year>2014</year>) <article-title>RNA events. Cas9 targeting and the CRISPR revolution</article-title>. <source>Science</source>
<volume>344</volume>: <fpage>707</fpage>–<lpage>708</lpage>.<pub-id pub-id-type="pmid">24833384</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Bland1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Bland</surname><given-names>C</given-names></name>, <name><surname>Ramsey</surname><given-names>TL</given-names></name>, <name><surname>Sabree</surname><given-names>F</given-names></name>, <name><surname>Lowe</surname><given-names>M</given-names></name>, <name><surname>Brown</surname><given-names>K</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>CRISPR recognition tool (CRT): a tool for automatic detection of clustered regularly interspaced palindromic repeats</article-title>. <source>BMC Bioinformatics</source>
<volume>8</volume>: <fpage>209</fpage>.<pub-id pub-id-type="pmid">17577412</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Grissa1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Grissa</surname><given-names>I</given-names></name>, <name><surname>Vergnaud</surname><given-names>G</given-names></name>, <name><surname>Pourcel</surname><given-names>C</given-names></name> (<year>2007</year>) <article-title>CRISPRFinder: a web tool to identify clustered regularly interspaced short palindromic repeats</article-title>. <source>Nucleic Acids Res</source>
<volume>35</volume>: <fpage>W52</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">17537822</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Edgar1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name> (<year>2007</year>) PILER-CR: fast and accurate identification of CRISPR repeats. <article-title>BMC Bioinformatics</article-title>. <volume>8</volume>: <fpage>18</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0110726-NCBI1">
      <label>20</label>
      <mixed-citation publication-type="other">NCBI {BLAST} executables download website (includes makeblastdb). Available: <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/blast/executables/LATEST/">ftp://ftp.ncbi.nih.gov/blast/executables/LATEST/</ext-link>. Accessed 2014 Sep 28.</mixed-citation>
    </ref>
    <ref id="pone.0110726-Camacho1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Camacho</surname><given-names>C</given-names></name>, <name><surname>Coulouris</surname><given-names>G</given-names></name>, <name><surname>Avagyan</surname><given-names>V</given-names></name>, <name><surname>Ma</surname><given-names>N</given-names></name>, <name><surname>Papadopoulos</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>
<volume>10</volume>: <fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Eddy2">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Eddy</surname><given-names>SR</given-names></name> (<year>1998</year>) <article-title>Profile hidden Markov models</article-title>. <source>Bioinformatics</source>
<volume>14</volume>: <fpage>755</fpage>–<lpage>763</lpage>.<pub-id pub-id-type="pmid">9918945</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Haft2">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Selengut</surname><given-names>JD</given-names></name>, <name><surname>Richter</surname><given-names>RA</given-names></name>, <name><surname>Harkins</surname><given-names>D</given-names></name>, <name><surname>Basu</surname><given-names>MK</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>TIGRFAMs and Genome Properties in 2013</article-title>. <source>Nucleic Acids Res</source>
<volume>41</volume>: <fpage>D387</fpage>–<lpage>395</lpage>.<pub-id pub-id-type="pmid">23197656</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Haft3">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Selengut</surname><given-names>J</given-names></name>, <name><surname>Mongodin</surname><given-names>EF</given-names></name>, <name><surname>Nelson</surname><given-names>KE</given-names></name> (<year>2005</year>) <article-title>A guild of 45 CRISPR-associated (Cas) protein families and multiple CRISPR/Cas subtypes exist in prokaryotic genomes</article-title>. <source>PLoS Comput Biol</source>
<volume>1</volume>: <fpage>e60</fpage>.<pub-id pub-id-type="pmid">16292354</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Makarova1">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Makarova</surname><given-names>KS</given-names></name>, <name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Barrangou</surname><given-names>R</given-names></name>, <name><surname>Brouns</surname><given-names>SJ</given-names></name>, <name><surname>Charpentier</surname><given-names>E</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Evolution and classification of the CRISPR-Cas systems</article-title>. <source>Nat Rev Microbiol</source>
<volume>9</volume>: <fpage>467</fpage>–<lpage>477</lpage>.<pub-id pub-id-type="pmid">21552286</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Staals1">
      <label>26</label>
      <mixed-citation publication-type="other">Staals RHJ, Brouns SJJ (2013) Distribution and Mechanism of the Type I CRISPR-Cas Systems. In: Barrangou R, Oost Jvd, editors. CRISPR-Cas Systems - RNA-mediated Adaptive Immunity in Bacteria and Archaea. Berlin Heidelberg: Springer Berlin Heidelberg.</mixed-citation>
    </ref>
    <ref id="pone.0110726-Touchon1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Touchon</surname><given-names>M</given-names></name>, <name><surname>Rocha</surname><given-names>EP</given-names></name> (<year>2010</year>) <article-title>The small, slow and specialized CRISPR and anti-CRISPR of Escherichia and Salmonella</article-title>. <source>PLoS ONE</source>
<volume>5</volume>: <fpage>e11126</fpage>.<pub-id pub-id-type="pmid">20559554</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-BondyDenomy1">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Bondy-Denomy</surname><given-names>J</given-names></name>, <name><surname>Davidson</surname><given-names>AR</given-names></name> (<year>2014</year>) <article-title>To acquire or resist: the complex biological effects of CRISPR-Cas systems</article-title>. <source>Trends Microbiol</source>
<volume>22</volume>: <fpage>218</fpage>–<lpage>225</lpage>.<pub-id pub-id-type="pmid">24582529</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4201578</article-id>
    <article-id pub-id-type="pmid">25330359</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-14-31682</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0110726</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome Annotation</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Comparative Genomics</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Microbiology</subject>
        </subj-group>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Machines</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Applications</subject>
          <subj-group>
            <subject>Web-Based Applications</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computer Software</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Software-Aided Sequence Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MacSyFinder: A Program to Mine Genomes for Molecular Systems with an Application to CRISPR-Cas Systems</article-title>
      <alt-title alt-title-type="running-head">MacSyFinder: Macromolecular Systems Detection</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Abby</surname>
          <given-names>Sophie S.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Néron</surname>
          <given-names>Bertrand</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ménager</surname>
          <given-names>Hervé</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Touchon</surname>
          <given-names>Marie</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rocha</surname>
          <given-names>Eduardo P. C.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Microbial Evolutionary Genomics, Institut Pasteur, Paris, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>UMR3525, CNRS, Paris, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Centre d’Informatique pour la Biologie, Institut Pasteur, Paris, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Torres</surname>
          <given-names>Néstor V.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Universidad de La Laguna, Spain</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>sophie.abby@pasteur.fr</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: SSA EPCR MT. Performed the experiments: SSA MT. Analyzed the data: MT. Contributed to the writing of the manuscript: SSA EPCR MT. Designed the MacSyFinder software: SSA BN. Designed the MacSyView application: SSA BN HM.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>10</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>10</issue>
    <elocation-id>e110726</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>7</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>9</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Abby et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Abby et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Motivation</title>
        <p>Biologists often wish to use their knowledge on a few experimental models of a given molecular system to identify homologs in genomic data. We developed a generic tool for this purpose.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p><bold>Mac</bold>romolecular <bold>Sy</bold>stem <bold>Finder</bold> (MacSyFinder) provides a flexible framework to model the properties of molecular systems (cellular machinery or pathway) including their components, evolutionary associations with other systems and genetic architecture. Modelled features also include functional analogs, and the multiple uses of a same component by different systems. Models are used to search for molecular systems in complete genomes or in unstructured data like metagenomes. The components of the systems are searched by sequence similarity using Hidden Markov model (HMM) protein profiles. The assignment of hits to a given system is decided based on compliance with the content and organization of the system model. A graphical interface, MacSyView, facilitates the analysis of the results by showing overviews of component content and genomic context. To exemplify the use of MacSyFinder we built models to detect and class CRISPR-Cas systems following a previously established classification. We show that MacSyFinder allows to easily define an accurate “Cas-finder” using publicly available protein profiles.</p>
      </sec>
      <sec>
        <title>Availability and Implementation</title>
        <p>MacSyFinder is a standalone application implemented in Python. It requires Python 2.7, Hmmer and makeblastdb (version 2.2.28 or higher). It is freely available with its source code under a GPLv3 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/gem-pasteur/macsyfinder">https://github.com/gem-pasteur/macsyfinder</ext-link>. It is compatible with all platforms supporting Python and Hmmer/makeblastdb. The “Cas-finder” (models and HMM profiles) is distributed as a compressed tarball archive as Supporting Information.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>This project was funded by the Institut Pasteur (<ext-link ext-link-type="uri" xlink:href="http://www.pasteur.fr/en">http://www.pasteur.fr/en</ext-link>), the French “Centre National de la Recherche Scientifique” (<ext-link ext-link-type="uri" xlink:href="http://www.cnrs.fr/index.php">http://www.cnrs.fr/index.php</ext-link>) and the European Research Council (<ext-link ext-link-type="uri" xlink:href="http://erc.europa.eu/">http://erc.europa.eu/</ext-link>) (grant EVOMOBILOME, number 281605). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Macromolecular systems are involved in key aspects of cell biology <xref rid="pone.0110726-Alberts1" ref-type="bibr">[1]</xref>, <xref rid="pone.0110726-PereiraLeal1" ref-type="bibr">[2]</xref>. They can be constituted of nanomachines, like the ribosome or the flagellum, or molecular pathways, like the ones allowing the degradation of foreign genetic elements by CRISPR-Cas systems. The identification and classification of macromolecular systems is important to characterize biological traits, and is routinely done in many laboratories. However, it is difficult to do on a systematic basis by a number of reasons. Firstly, systems are made of many different components with different levels of dispensability, some being essential and others accessory. For example, homologous recombination in bacteria involves some key essential components (like RecA), and several associated alternative pathways (like RecBCD and RecFOR) <xref rid="pone.0110726-Michel1" ref-type="bibr">[3]</xref>. Secondly, key components may have homologs in other systems, complicating their unambiguous assignment to a given system. This is for instance the case of the non-flagellar type III secretion system for which eight of the nine core genes have homologs in the bacterial flagellum <xref rid="pone.0110726-Abby1" ref-type="bibr">[4]</xref>. Thirdly, the components of the systems evolve at very diverse rates, complicating the identification of homology by sequence similarity. For example, many proteins involved in reproduction are highly conserved, whereas others endure selection for fast evolution <xref rid="pone.0110726-Galagan1" ref-type="bibr">[5]</xref>. These difficulties can be partly circumvented by searching for the whole set of components of the system because the integration of all the information leads to more accurate inference. This is especially relevant if the genes encoding these components are organized in highly conserved ways. In Prokaryotes, organelles and viruses, macromolecular systems are often encoded in one or a few conserved neighbouring operons ensuring tight regulation and correct assembly/functioning. This facilitates the assignment of certain components to a system <xref rid="pone.0110726-Huynen1" ref-type="bibr">[6]</xref>–<xref rid="pone.0110726-Zaslaver1" ref-type="bibr">[9]</xref>.</p>
    <p>We have developed a program named <bold>Mac</bold>romolecular <bold>Sy</bold>stem <bold>Finder</bold> (MacSyFinder) to detect molecular systems in genome data from user-defined biological models. The components of the systems are searched using protein profiles encoded as hidden Markov models (HMM), such as those available in databases like PFAM, TIGRFAM or PRODOM <xref rid="pone.0110726-Finn1" ref-type="bibr">[10]</xref>–<xref rid="pone.0110726-Servant1" ref-type="bibr">[12]</xref>. Protein profiles provide a compressed way to represent a database of homologous sequences, giving increased sensitivity and specificity <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. MacSyFinder identifies the presence of a given system according to the specifications of the input model, which includes customizable information on the type and number of components, on their genetic organization, and other relevant discriminating traits. We implemented MacSyFinder as a generic portable tool that can be installed in-house for large genomic or metagenomic projects. The companion program, MacSyView, allows the visualization of the results of MacSyFinder. To show a typical situation where MacSyFinder can be useful, we built a set of models to identify Cas proteins. Clustered regularly interspaced short palindromic repeats (CRISPR) arrays and their associated Cas (CRISPR-associated) proteins form the CRISPR-Cas system. CRISPR-Cas are sophisticated adaptive immune systems that rely on small RNAs for sequence-specific targeting of foreign nucleic acids such as viruses and plasmids <xref rid="pone.0110726-Barrangou1" ref-type="bibr">[14]</xref>. Cas proteins have been intensively studied in the recent years for their role in the interaction between Prokaryotes and their mobile genetic elements and for their biotechnological interest <xref rid="pone.0110726-Hsu1" ref-type="bibr">[15]</xref>, <xref rid="pone.0110726-Barrangou2" ref-type="bibr">[16]</xref>. Tools are available to detect and analyse CRISPR arrays <xref rid="pone.0110726-Bland1" ref-type="bibr">[17]</xref>–<xref rid="pone.0110726-Edgar1" ref-type="bibr">[19]</xref>, however, no program is available to detect and class <italic>cas</italic> operons themselves. This example shows that using information from the literature and available protein profiles, one can easily build an accurate and efficient “Cas-finder” with MacSyFinder.</p>
  </sec>
  <sec id="s2">
    <title>MacSyFinder's Rationale</title>
    <sec id="s2a">
      <title>Definition of the models</title>
      <p>MacSyFinder models, written using an XML grammar, describe the components and genetic organization of a given macromolecular system (see the documentation in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref> for a full description of the grammar). Each model is defined in a dedicated file named after the type of system (<italic>e.g.,</italic> CAS-TypeI.xml'), which contains system-wise and component-wise features (<xref ref-type="fig" rid="pone-0110726-g001">Figure 1</xref>). MacSyFinder considers three classes of components: <italic>mandatory</italic>, <italic>accessory</italic>, and <italic>forbidden</italic>. Components that are ubiquitous and identifiable in all systems are defined as <italic>mandatory</italic>. Other components of the system are defined as <italic>accessory</italic>. These <italic>accessory</italic> components can be essential for the assembly/functioning of the system, while not being identifiable by sequence similarity because of rapid evolution or because they are non-homologous among variants of the system. Discrimination between partly homologous systems is easier when some specific components are defined as <italic>forbidden</italic> in the models of the systems lacking them (<xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>).</p>
      <fig id="pone-0110726-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Modelling systems with MacSyFinder.</title>
          <p>The components of a system assemble into macromolecular systems or correspond to a biological pathway. They are typically encoded in genomes in one or a few different loci (“Genomic context”). We illustrate how systems can be modelled and distinguished with two imaginary systems “A” and “B” that have four homologous components (C1–C4, similar colours for the two systems). The system “B” has one component that is not found in “A”(C5). The parameter <italic>inter_gene_max_space</italic> (D) defines the maximal number of genes between two consecutive components (d<sub>i,j</sub>). The two systems are defined by a set of <italic>mandatory</italic> (green), <italic>accessory</italic> (black) and <italic>forbidden</italic> (red) components. The quorum rules allow relaxing the definition of the system without altering the list of its components (<italic>min_genes_required</italic> and <italic>min_mandatory_genes_required</italic> parameters in XML files). If they are not specified, a default value is computed from the number of components described in the XML files. The bottom part of the figure shows the description of the systems in the XML grammar (see the documentation in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>). Components listed here refer to protein profiles (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3</xref>). When a component is found in several systems, it is defined only once, and can be reused in another system with the <italic>system_ref</italic> keyword. Much more complex features can be defined, including exchangeable genes, distant genes and component-specific parameters (<xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>).</p>
        </caption>
        <graphic xlink:href="pone.0110726.g001"/>
      </fig>
      <p>Systems that respect a pre-defined minimal quorum of components are identified as complete. The quorum is either the number of <italic>mandatory</italic> components and/or the sum of <italic>mandatory</italic> and <italic>accessory</italic> components (see the documentation on attributes <italic>min_mandatory_genes_required</italic> and <italic>min_genes_required</italic> in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>). Components defined as functionally <italic>exchangeable</italic> are only counted once in the quorum. These components can be part of systems defined in other models using the <italic>system_ref</italic> keyword. Genes encoding components that participate in multiple systems of the same type, such as proteins interacting with different instances of a system, are labelled <italic>multi_system</italic>.</p>
      <p>The genetic architecture of the components is defined using several attributes. Two components are co-localized when their genes are closer than a given number of genes (system-wise parameter <italic>inter_gene_max_space</italic>, <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>). A component defined with the <italic>loner</italic> attribute does not need to be co-localized with other components to be part of a system. One can also specify component-specific values of <italic>inter_gene_max_space</italic>. The system-wise parameter <italic>multi_loci</italic> allows MacSyFinder to detect systems encoded by several distant clusters of genes.</p>
    </sec>
    <sec id="s2b">
      <title>Implementation, system requirements and availability</title>
      <p>MacSyFinder was coded in Python, and details on its object-oriented implementation are available in <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref> and in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>. MacSyFinder requires Python version 2.7, the formatdb or makeblastdb tools (version 2.2.28 or better for the latter) <xref rid="pone.0110726-NCBI1" ref-type="bibr">[20]</xref>, <xref rid="pone.0110726-Camacho1" ref-type="bibr">[21]</xref> and the program Hmmer <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>, <xref rid="pone.0110726-Eddy2" ref-type="bibr">[22]</xref>. MacSyFinder is freely available. Its source code is distributed under a GPLv3 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/gem-pasteur/macsyfinder">https://github.com/gem-pasteur/macsyfinder</ext-link> and updated versions will be accessible there. MacSyFinder is compatible with all platforms supporting Python, Hmmer, and makeblastdb. The MacSyFinder release used in this paper is provided in <xref ref-type="supplementary-material" rid="pone.0110726.s010">Data S1</xref>. MacSyView's source code is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gem-pasteur/macsyview">https://github.com/gem-pasteur/macsyview</ext-link> but it is also distributed in the MacSyFinder's package. MacSyView was coded in Javascript and uses third-party libraries that are included in the package, and accredited in the COPYRIGHT file (See <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>). It was tested on Chromium and Firefox for Linux, and on Chrome, Firefox and Safari for Mac OS X. A documentation file including installation and users' instructions, details on modelling procedures and examples for MacSyView and MacSyFinder is available in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>.</p>
    </sec>
    <sec id="s2c">
      <title>Input and output</title>
      <p>The MacSyFinder program (<xref ref-type="supplementary-material" rid="pone.0110726.s010">Data S1</xref>) receives as input a list of systems defined in XML files (see above), protein profiles, command-line parameters and a file with protein sequences in fasta format (see the documentation in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>). The parameters can be specified in the command-line or in a configuration file. System and component parameters specified in the command-line override model specifications in the XML files.</p>
      <p>MacSyFinder manages three different types of protein datasets. The <bold>unordered</bold> dataset lacks information on gene order and genome origin. This mode is useful to study large sequence databanks or metagenomic data. Naturally, in these datasets the notions of co-localization and quorum are not relevant. The <bold>unordered replicon</bold> dataset includes protein sequences from one single genome. This is useful to analyse unassembled genomes with large numbers of contigs. In this case the notion of quorum is relevant (albeit with certain limitations), but co-localization is not. The <bold>ordered replicon</bold> dataset includes proteins from one single replicon that are ordered according to the position of the corresponding genes in the genome. This is the most powerful mode and can be used to analyse complete or nearly complete genomes. Another related mode (<italic>gembase</italic>) requires a specific input file format and allows the analysis of multiple ordered replicons in a single step (see <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>).</p>
      <p>The output of MacSyFinder includes log files, intermediate results, the number of detected systems, and the information on each detected component from each instance of the system. This information is made available in the form of text tables and JSON files. We have built MacSyView, a standalone web-browser application that uses output JSON files to visualise the systems and their genomic context. MacSyView generates exportable SVG files containing views of the detected systems (<xref ref-type="fig" rid="pone-0110726-g002">Fig. 2</xref>).</p>
      <fig id="pone-0110726-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Snapshot of MacSyFinder's results as viewed with MacSyView.</title>
          <p>A. The MacSyView web-browser based application allows the visualization of MacSyFinder's output file “results.macsyfinder.json”. B. MacSyView displays the list of systems available in the results file. The user picks a system to visualize by clicking on it in the list. C. The page displaying the system is made of a header, and three panels. The header allows to select another input file, or to go back to the list of systems. It displays information on the system that is being visualized. The first panel shows how the detected system fits the model compliance in terms of its components. Boxes represent the number of each <italic>mandatory</italic>, <italic>accessory</italic>, and <italic>forbidden</italic> components. A tooltip gives the name of the component when the mouse hovers a box. Component boxes can be sorted by decreasing number of components. The second panel shows the genetic context of the system (as transcribed from the input fasta file), with components drawn to scale. When the mouse hovers a box, a tooltip displays information on the corresponding component, including scores of the Hmmer hit. This view can be exported as a SVG file for drawing purposes (tools circled in red). The third panel gives detailed information on the components of the system.</p>
        </caption>
        <graphic xlink:href="pone.0110726.g002"/>
      </fig>
    </sec>
    <sec id="s2d">
      <title>Functioning</title>
      <p>The user runs MacSyFinder from the command-line on a protein sequence dataset for a number of systems of interest. The non-redundant list of components to search is extracted from the XML files. The presence of a given component is determined by similarity search with HMM protein profiles using the program Hmmer <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. The hits are filtered according to user-defined i-evalue (for statistical significance) and to the minimal coverage of the profile in the alignment (to control for the minimal size of the profile that must be matched to obtain biologically relevant hits). The components defined in the models are searched in parallel for rapidity (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3A</xref>). If multiple profiles match the same protein, MacSyFinder selects the hit with the highest score. The subsequent steps depend on whether the input dataset is an ordered replicon, an unordered genome or an unordered genomic dataset (<italic>e.g</italic>., a metagenome).</p>
      <fig id="pone-0110726-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Functioning of MacSyFinder.</title>
          <p>A. The user launches MacSyFinder to detect macromolecular systems A and B (example of <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>). System-specific parameters are read from the corresponding XML definition files. This includes the list of the components of the systems and the corresponding HMM profiles. Other detection parameters are picked by order of priority: on the command-line, in the configuration file, and in the XML files. Sequences are indexed with the “formatdb” or “makeblastdb” tools for similarity search with the Hmmer program. MacSyFinder runs (optionally in parallel) the Hmmer searches on a non-redundant list of components' profiles. If the sequence dataset is “unordered” MacSyFinder only outputs the hits and the components detected for each type of system. B. Step #1: the co-localization criterion can be used in the ordered datasets. It involves clustering the hits separated by less than D protein-coding genes. The components described as “loner” in the XML definition files can be at any distance from other components. Step #2: the components of each cluster are used to fill the occurrences of the systems. Depending on the quorum, a cluster can describe a “full” system, or a “scattered” system. Step #3: clusters with components belonging to more than one system are split in unique systems and then re-directed separately to step #2.</p>
        </caption>
        <graphic xlink:href="pone.0110726.g003"/>
      </fig>
      <p>If the dataset is an <bold>ordered replicon</bold>, the hits are clustered according to the genetic organization specified in the model. Clusters including the components of a single type of system are used to fill inventories of “compatible” systems (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3B</xref>). If multiple systems are compatible with the set of components in the clusters, then the different candidate systems are examined. The order of exam is given by decreasing number of components shared between the cluster and the compatible systems. The cluster will be assigned to the first system in the list that fits its content. A system is regarded as complete if the quorum is respected. When a complete instance of the system has components from a single locus, further new occurrences of the same components in the cluster are used to produce a novel instance. When a single cluster is not enough to make a complete instance and the <italic>multi_loci</italic> parameter is turned on, the hits are stored to fill up an instance of the system encoded by multiple distant loci. Clusters with components from multiple systems are split in sub-clusters containing components from a single system. These sub-clusters are then re-analysed in terms of their components (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3B</xref>). MacSyFinder can only resolve these complex cases if the components of each system are contiguous, instead of scattered on the cluster.</p>
      <p><bold>Unordered</bold> sequence datasets cannot be analysed with the co-localization criteria. Therefore, hits from the similarity searches are directly used to fill inventories of each system. Systems are complete if the required quorum is respected. The presence of <italic>forbidden</italic> components is ignored in this mode, even if such occurrences are stored to inform the user. A single system instance will be filled per system and dataset, independently of the number of component occurrences found. This is because components cannot be individually assigned to particular instances in the absence of the genomic context. Nevertheless, the analysis of the number of identified components can be used to estimate the number of instances in the dataset.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Application</title>
    <sec id="s3a">
      <title>Data</title>
      <p>The complete genomes of bacteria (2484) and archaea (159) were downloaded from NCBI RefSeq (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/">ftp://ftp.ncbi.nih.gov/genomes/</ext-link>, November 2013). Profiles for the Cas protein families were obtained from the TIGRFAM database, version 13.0 (<ext-link ext-link-type="uri" xlink:href="http://www.jcvi.org/cgi-bin/tigrfams/index.cgi">http://www.jcvi.org/cgi-bin/tigrfams/index.cgi</ext-link>, August 15 2012) <xref rid="pone.0110726-Haft1" ref-type="bibr">[11]</xref>, <xref rid="pone.0110726-Haft2" ref-type="bibr">[23]</xref>. Among the 89 profiles available, 53 were constructed by Haft and colleagues <xref rid="pone.0110726-Haft3" ref-type="bibr">[24]</xref> and correspond to 45 Cas protein families that were used to propose a CRISPR-Cas systems classification <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. Subsequently, these authors constructed 36 additional protein profiles more specific to given subtypes that are available in TIGRFAM <xref rid="pone.0110726-Haft2" ref-type="bibr">[23]</xref>. We renamed these profiles to make them more informative for the user (see <xref ref-type="supplementary-material" rid="pone.0110726.s004">Table S1</xref> for correspondence with established classification).</p>
    </sec>
    <sec id="s3b">
      <title>Developing a new system's model</title>
      <p>The goal of MacSyFinder is to query genomic data using biologically meaningful models of a system. The first step of the model building procedure is therefore to use the available knowledge to identify the system components, their frequency and their genetic architecture. The second step is to obtain protein profiles for the components either by building them specifically for this purpose or by retrieving them from public databases. Protein profiles can be built easily from multiple sequence alignments of homologous proteins using Hmmer <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. The third step is to write the model in the simple MacSyFinder's XML grammar (see above and <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref> for an example). The final step is to include information about homologous systems in the model. The use of system-specific profiles and <italic>forbidden</italic> attributes facilitates the discrimination between systems (<xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>). Our experience is that complex models should be built by iterating several times on these steps from simpler models. Indeed, the fine-tuning of the quorum definitions and genetic architectures can vastly increase the quality of identification of a system. Often, one is confronted with systems for which very few instances have been experimentally studied. In this case, iteration of the modelling steps provides both more reliable models and a better knowledge of the systems diversity. To exemplify the use of MacSyFinder we built models to identify Cas proteins and classify CRISPR-Cas systems. This is a very typical example of systems that are intensively studied, for which there are many protein profiles in the databases, but no software dedicated to their detection.</p>
    </sec>
    <sec id="s3c">
      <title>Detection and classification of CRISPR-Cas systems</title>
      <p>The known <italic>cas</italic> operons have from 3 to 13 genes encoding very diverse proteins, among which several nucleases and helicases with DNA and/or RNA binding domains <xref rid="pone.0110726-Haft3" ref-type="bibr">[24]</xref>, <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. A unified classification of CRISPR-Cas systems has been recently established based on the presence or absence of peculiar Cas protein families, and on the genetic architecture of the <italic>cas</italic> operon <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. Three major types and several subtypes of CRISPR-Cas systems have been described. <italic>cas1</italic> and <italic>cas2</italic> universally occur across types and subtypes, whereas <italic>cas3</italic>/<italic>cas7</italic>, <italic>cas9</italic>, and <italic>cas10</italic> have been defined as the signature genes for type I, type II, and type III, respectively (<xref ref-type="fig" rid="pone-0110726-g004">Fig. 4</xref>). Protein profiles matching most of these Cas protein families are publicly available in the TIGRFAM database <xref rid="pone.0110726-Haft1" ref-type="bibr">[11]</xref>, <xref rid="pone.0110726-Haft3" ref-type="bibr">[24]</xref>. We used this information to exemplify how MacSyFinder can be used to identify and classify these systems.</p>
      <fig id="pone-0110726-g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Simplified operon organization of the three major types and ten subtypes of CRISPR-Cas systems.</title>
          <p>Each <italic>cas</italic> gene family is indicated with a distinct colour, those specific to a subtype are in white. Only the main <italic>cas</italic> gene families are represented.</p>
        </caption>
        <graphic xlink:href="pone.0110726.g004"/>
      </fig>
      <sec id="s3c1">
        <title>General model and choice of parameters</title>
        <p>In a first round of analysis, we defined a <bold>general simple model</bold> to identify all possible clusters of Cas proteins in 2643 prokaryotic genomes. In this general definition, all the CRISPR-Cas-HMM profiles available in TIGRFAM database were used whatever their type or subtype specificity (<xref ref-type="supplementary-material" rid="pone.0110726.s004">Table S1</xref>). At this stage, we used relatively relaxed criteria: all the components were defined as <italic>accessory</italic> and all clusters with at least 3 different components (<italic>min_genes_required</italic> = 3) distant from at most 5 genes (<italic>inter_gene_max_space</italic> “D” = 5) were retained. With this procedure, we identified 1628 clusters of Cas proteins and could annotate 10663 Cas proteins (<italic>i.e.</italic>, with significant matches to protein profiles). The total number of genes in the detected clusters ranged from 3 to 36 with an average of 7.7±3.5 genes (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1A</xref>). In these clusters, most of the genes (86%) encode known Cas proteins (<italic>i.e.</italic>, described in the general definition) and 56% of clusters have components strictly contiguous (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1B</xref>). While these preliminary results suggest that most clusters are Cas systems, a small fraction of them (7%) is larger than the larger described systems (&gt;13 genes, <xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1A</xref>), suggesting that the above-mentioned parameters might be too permissive (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1C</xref>). These large clusters might correspond to contiguous or intertwined systems (<italic>i.e.</italic>, chimeric variants). To test this hypothesis, we explored the effect of changing D on the identification of clusters (<italic>i.e.</italic>, D = 4, 5, and 6, see <xref ref-type="supplementary-material" rid="pone.0110726.s005">Table S2</xref>). A more stringent co-localization criterion (D = 4), resulted in a decrease of the overall number of Cas proteins assigned to systems, the subdivision of several previously detected clusters, and the persistence of large clusters (<xref ref-type="supplementary-material" rid="pone.0110726.s005">Table S2</xref>). A less stringent criterion (D = 6) led to the fusion of several clusters with a small gain of Cas proteins assigned to systems (<xref ref-type="supplementary-material" rid="pone.0110726.s005">Table S2</xref>). We therefore set the final co-localization criterion to 5, and the minimal number of genes to 3. Doubts about multiple closely co-occurring systems can often be removed using more specific “typing” and “subtyping” models, because in this case contiguous systems of different types will be set apart (see below). While the general definition of the system is very simple, it fetches systems with Cas1 or a Cas2 protein in respectively 88% and 73% of the clusters, even if weak constraints were imposed on their presence (<italic>accessory</italic> proteins in the general definition of the system). We identified Cas clusters in 78% of archaeal genomes and 39% of bacterial genomes. This is very similar to previous observations and therefore suggests that even the general model accurately identifies Cas systems <xref rid="pone.0110726-Staals1" ref-type="bibr">[26]</xref> (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1D</xref>, and see the paragraph on the validation of our models).</p>
      </sec>
      <sec id="s3c2">
        <title>Typing and Subtyping CRISPR-Cas systems</title>
        <p>To exemplify the ability of MacSyFinder to characterise sub-systems we built models for each type and subtype of Cas systems from the pre-existing classification <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref> (<xref ref-type="fig" rid="pone-0110726-g004">Fig. 4</xref>). We first tested the specificity of the 89 available protein profiles for a given type and subtype by analysing the co-occurrence of pairs of Cas proteins in clusters detected with the general model (<xref ref-type="fig" rid="pone-0110726-g005">Fig. 5</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>). Then we designed the corresponding models accordingly. In the final models (<xref ref-type="supplementary-material" rid="pone.0110726.s002">Fig. S2</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>), all profiles specific to a system were defined as <italic>mandatory</italic> (signature gene) while all the others were defined as <italic>accessory</italic>. Because some systems have very similar content and organization (<italic>e.g.</italic>, Type II-A and II-B), profiles distinguishing them are <italic>accessory</italic> or <italic>mandatory</italic> in a system, and <italic>forbidden</italic> in the other (see <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s002">Fig. S2</xref> for examples). Although the types and subtypes have different numbers of genes, we set the <italic>min_genes_required</italic> parameter to 3, and the <italic>inter_gene_max_space</italic> parameter to 5 for all models to make the detection as large as possible and comparable with that resulting from the general model. We defined 5”typing” models and 15”subtyping” models for <italic>cas</italic> loci detection and classification (see <xref ref-type="supplementary-material" rid="pone.0110726.s002">Fig. S2</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>).</p>
        <fig id="pone-0110726-g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Frequency of co-occurrence between Cas proteins present in clusters detected with the general model (left) and the subtyping models (right).</title>
            <p>Each matrix was normalized by the maximum of each column. The higher the frequency is, the warmer the colour is: the red diagonal corresponds to a 100% co-occurrence. Only frequencies above 1% were represented, others are in grey.</p>
          </caption>
          <graphic xlink:href="pone.0110726.g005"/>
        </fig>
        <p>Using the <bold>subtyping models</bold> we classed the previously detected Cas clusters, but were also able to split different contiguous systems (<xref ref-type="fig" rid="pone-0110726-g005">Fig. 5</xref>). Thus, among the 1628 Cas clusters, 95% correspond to a single system, 3% to contiguous distinct systems (including the type III-B well known to be associated with other systems-type <xref rid="pone.0110726-Staals1" ref-type="bibr">[26]</xref>), the remaining 2% correspond to chimeric variants. Most of the Cas clusters could readily be assigned to proposed types (97%) and subtypes (94%) with our models. The remaining corresponded to <italic>cas</italic> locus with no gene signature, or to chimeric variants (<xref ref-type="supplementary-material" rid="pone.0110726.s006">Table S3</xref>).</p>
      </sec>
      <sec id="s3c3">
        <title>Validation of detected systems</title>
        <p>We made two analyses to obtain a more precise assessment of the accuracy of the method. Firstly, we quantified how often Cas systems detected with the General definition (command-lines available in <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>) co-occurred with CRISPR arrays as is the case in all fully functional described systems. We searched for CRISPR-arrays with <xref rid="pone.0110726-Bland1" ref-type="bibr">[17]</xref> as described in <xref rid="pone.0110726-Touchon1" ref-type="bibr">[27]</xref> and found that 88% of the detected Cas systems are close (&lt;1kb, same result for &lt;5kb) to a CRISPR-array and that 98% are present in a replicon containing at least one CRISPR-array. The absence of CRISPR in so few Cas-containing genomes suggests the method has a low rate of false positives. Secondly, we took from the literature the list of CRISPR-Cas with experimentally characterized <italic>in vivo</italic> effects <xref rid="pone.0110726-BondyDenomy1" ref-type="bibr">[28]</xref>. In this list we could detect 100% of the 25 known Cas systems of genomes included in our dataset (<xref ref-type="supplementary-material" rid="pone.0110726.s007">Table S4</xref>) with our “general”, “typing” and “subtyping” models (see command-lines in <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>). Furthermore, we could assign the correct subtype to 23 of them, and we propose a subtype for the system of <italic>Mycoplasma gallisepticum</italic>. This suggests a low rate of false negatives. Altogether these results suggest the method is very accurate and that most clusters correspond to CRISPR-Cas systems. Type I systems are more abundant in both bacteria (in ∼31% of the bacterial genomes) and archaea (∼71%), Type II are only found in bacteria, while Type III are more prevalent in archaea (∼38%) (<xref ref-type="table" rid="pone-0110726-t001">Table 1</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s003">Fig. S3</xref>). These results are consistent with previous analyses <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. Subtypes I-C, I-E and I-F are more commonly found in bacteria, while subtypes I-A, I-B and I-D are frequent in archaea, as previously noted <xref rid="pone.0110726-Staals1" ref-type="bibr">[26]</xref>. Overall, these results suggest that our models are able to accurately identify and type Cas systems. Profiles and models for the “Cas-Finder” are provided in <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>. Users can easily add or remove components and change the genetic organization specifications.</p>
        <table-wrap id="pone-0110726-t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0110726.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Taxonomic distribution of CRISPR-Cas types and sub-types in prokaryotes expressed in number and percentage of the genomes harboring the systems.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0110726-t001-1" xlink:href="pone.0110726.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Typing</td>
                  <td colspan="7" align="left" rowspan="1">Type I</td>
                  <td colspan="3" align="left" rowspan="1">Type II</td>
                  <td colspan="3" align="left" rowspan="1">Type III</td>
                  <td align="left" rowspan="1" colspan="1">Type U</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Bacteria</td>
                  <td colspan="7" align="left" rowspan="1">769 (31%)</td>
                  <td colspan="3" align="left" rowspan="1">177 (7%)</td>
                  <td colspan="3" align="left" rowspan="1">222 (9%)</td>
                  <td align="left" rowspan="1" colspan="1">7</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Archaea</td>
                  <td colspan="7" align="left" rowspan="1">113 (71%)</td>
                  <td colspan="3" align="left" rowspan="1">0</td>
                  <td colspan="3" align="left" rowspan="1">60 (38%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>Subtyping</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-A</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-B</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-C</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-D</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-E</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-F</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-U</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>II-A</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>II-B</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>II-U</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>III-A</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>III-B</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>III-U</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>U</bold>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Bacteria</td>
                  <td align="left" rowspan="1" colspan="1">16 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">173 (7%)</td>
                  <td align="left" rowspan="1" colspan="1">196 (8%)</td>
                  <td align="left" rowspan="1" colspan="1">31 (1%)</td>
                  <td align="left" rowspan="1" colspan="1">282 (11%)</td>
                  <td align="left" rowspan="1" colspan="1">111 (5%)</td>
                  <td align="left" rowspan="1" colspan="1">47 (2%)</td>
                  <td align="left" rowspan="1" colspan="1">81 (3%)</td>
                  <td align="left" rowspan="1" colspan="1">5 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">93 (4%)</td>
                  <td align="left" rowspan="1" colspan="1">123 (5%)</td>
                  <td align="left" rowspan="1" colspan="1">112 (5%)</td>
                  <td align="left" rowspan="1" colspan="1">3 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">7 (&lt;1%)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Archaea</td>
                  <td align="left" rowspan="1" colspan="1">55 (35%)</td>
                  <td align="left" rowspan="1" colspan="1">48 (30%)</td>
                  <td align="left" rowspan="1" colspan="1">2 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">16 (10%)</td>
                  <td align="left" rowspan="1" colspan="1">5 (3%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">2 (1%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">28 (18%)</td>
                  <td align="left" rowspan="1" colspan="1">40 (25%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
      </sec>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>The use of MacSyFinder will often involve preliminary steps to model the biological systems of interest. This allows the researcher to produce structured knowledge and is particularly useful when these systems have distinguishable traits, such as a specific genetic architecture. Often there are few studies suggesting the parameters to use in the models. Under these circumstances, one should start with very simple models, <italic>e.g.</italic>, noting all components as <italic>accessory</italic> and using low quorums. The analysis of the results of these preliminary models often provides important clues on how to produce more complex and accurate models. For example, by relaxing the criteria of the requirements to identify type III secretion systems (T3SS) we were recently able to identify a new homologous system in <italic>Myxobacteria</italic>
<xref rid="pone.0110726-Abby1" ref-type="bibr">[4]</xref>. Modelling itself can thus lead to new biological findings.</p>
    <p>MacSyFinder ignores phylogenetic information when putting together components of systems scattered in a replicon or in unordered datasets. In contrast, the preliminary distinction between homologous proteins can often be done using MacSyFinder without the need for lengthy phylogenetic analyses. This works in two steps. First, one must produce a multiple alignment gathering the different families of homologous proteins. This alignment must be divided into sub-alignments according to the different systems, leading to the production of different profiles for the different sub-families of homologs. Finally, and as a rule, for a given protein, the best-scoring profile corresponds to the relevant homologous family (see <xref ref-type="fig" rid="pone-0110726-g005">Fig. 5</xref>, and Fig. 2 in <xref rid="pone.0110726-Abby1" ref-type="bibr">[4]</xref>).</p>
    <p>It is difficult to estimate <italic>a priori</italic> how accurate MacSyFinder will be for any given biological system because this will depend on several system-specific variables. First, it will depend on the number of components of the system, their frequency in the system and their degree of sequence conservation. Systems with many highly conserved and frequent components will be much easier to identify than systems with many infrequent and fast-evolving components. Second, it will depend on the existence of other systems sharing homologous components. Systems including many components with homologs in other systems will be harder to identify. We have shown MacSyFinder can type CRISPR-Cas systems, even if they share homologs. Hence, even in these difficult situations MacSyFinder provides accurate models. The situation is necessarily more complicated when identifying systems with many homologs encoded by genes scattered in the genomes. In this case, phylogenetic methods may help in the reconstruction of the different systems.</p>
    <p>Considering MacSyFinder's running time, the limiting step is usually the identification of hits by Hmmer, which is currently very efficient <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. To speed up this step, MacSyFinder is able to compute and analyse Hmmer hits in parallel. MacSyFinder and its companion MacSyView are easy to install standalone tools. This is an advantage when it is necessary to keep the data private or when projects are so large that network transfer time is prohibitive. MacSyFinder was built to be simple to use. It is thus ideal for biologists without extensive knowledge of programming or scripting wishing to unravel the diversity of certain systems or to annotate genetic data. Often, bioinformaticians produce methods to identify machineries and would like to easily package them for reproducibility and distribution among biologists. This can be easily done with MacSyFinder <italic>via</italic> the distribution of XML files and the relevant protein profiles. The “Cas-finder” we present here is a particularly relevant case. At the time we started the project, there was public information available on the protein profiles and on the genetic organization of the systems. We only had to define the models and use them in such a way that we could identify the systems and class them. The result is a highly accurate application to identify <italic>cas</italic> operons that can be easily distributed (<xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0110726.s001">
      <label>Figure S1</label>
      <caption>
        <p><bold>Genomic architecture and taxonomic distribution of detected </bold><bold><italic>cas</italic></bold><bold> genes clusters (general model).</bold> A. Distribution of the number of different genes in detected clusters. B. Distribution of the maximal distance between two components observed in each detected cluster. C. Boxplot of the number of different genes in each cluster vs. the maximal distance between two components observed in each cluster. D. Proportion of bacterial and archaeal genomes without (cluster−) and with at least one cluster of <italic>cas</italic> genes (cluster+).</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0110726.s001.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s002">
      <label>Figure S2</label>
      <caption>
        <p><bold>Schematic and simplified representation of the subtype models.</bold> Each box corresponds to a <italic>cas</italic> gene family and the name of the corresponding HMM protein profiles are listed below. Some <italic>cas</italic> gene families have multiple HMM profiles available in the TIGRFAM database. Each <italic>cas</italic> gene family has its boxes filled (subtype non-specific) or surrounded (subtype-specific) by a distinct colour. Only the main <italic>cas</italic> gene families are represented. For full subtype models, see the XML files in <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0110726.s002.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s003">
      <label>Figure S3</label>
      <caption>
        <p><bold>Taxonomic distribution of the three CRISPR-Cas systems types.</bold> For each clade, the number of representative genomes is given, along with bar plots showing the percentage of these genomes containing the three types of CRISPR-Cas systems.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0110726.s003.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s004">
      <label>Table S1</label>
      <caption>
        <p>
          <bold>List of HMM profiles used for the “Cas-Finder”.</bold>
        </p>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0110726.s004.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s005">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Impact of the co-localization parameter on the detection.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s006">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Detection results.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s007">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Validation of the CRISPR-Cas systems detection on systems with </bold>
          <bold>
            <italic>in vivo</italic>
          </bold>
          <bold> effects listed in the review by Bondy-Denomy et. al 2014</bold>
          <xref rid="pone.0110726-BondyDenomy1" ref-type="bibr">[28]</xref>
          <bold>.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s008">
      <label>Text S1</label>
      <caption>
        <p>
          <bold>Supporting text (PDF file).</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s009">
      <label>File S1</label>
      <caption>
        <p>
          <bold>MacSyFinder's documentation file (PDF file).</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s010">
      <label>Data S1</label>
      <caption>
        <p>
          <bold>The MacSyFinder/MacSyView package (compressed tarball archive).</bold>
        </p>
        <p>(GZ)</p>
      </caption>
      <media xlink:href="pone.0110726.s010.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s011">
      <label>Data S2</label>
      <caption>
        <p>
          <bold>The Cas-Finder: models and profiles (compressed tarball archive).</bold>
        </p>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0110726.s011.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>Julien Guglielmini and Jean Cury for fruitful discussions.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0110726-Alberts1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Alberts</surname><given-names>B</given-names></name> (<year>1998</year>) <article-title>The cell as a collection of protein machines: preparing the next generation of molecular biologists</article-title>. <source>Cell</source>
<volume>92</volume>: <fpage>291</fpage>–<lpage>294</lpage>.<pub-id pub-id-type="pmid">9476889</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-PereiraLeal1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Pereira-Leal</surname><given-names>JB</given-names></name>, <name><surname>Levy</surname><given-names>ED</given-names></name>, <name><surname>Teichmann</surname><given-names>SA</given-names></name> (<year>2006</year>) <article-title>The origins and evolution of functional modules: lessons from protein complexes</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>
<volume>361</volume>: <fpage>507</fpage>–<lpage>517</lpage>.<pub-id pub-id-type="pmid">16524839</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Michel1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Michel</surname><given-names>B</given-names></name>, <name><surname>Grompone</surname><given-names>G</given-names></name>, <name><surname>Florès</surname><given-names>MJ</given-names></name>, <name><surname>Bidnenko</surname><given-names>V</given-names></name> (<year>2004</year>) <article-title>Multiple pathways process stalled replication forks</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>101</volume>: <fpage>12783</fpage>–<lpage>12788</lpage>.<pub-id pub-id-type="pmid">15328417</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Abby1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Abby</surname><given-names>SS</given-names></name>, <name><surname>Rocha</surname><given-names>EP</given-names></name> (<year>2012</year>) <article-title>The non-flagellar type III secretion system evolved from the bacterial flagellum and diversified into host-cell adapted systems</article-title>. <source>PLoS Genet</source>
<volume>8</volume>: <fpage>e1002983</fpage>.<pub-id pub-id-type="pmid">23028376</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Galagan1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Galagan</surname><given-names>JE</given-names></name>, <name><surname>Nusbaum</surname><given-names>C</given-names></name>, <name><surname>Roy</surname><given-names>A</given-names></name>, <name><surname>Endrizzi</surname><given-names>MG</given-names></name>, <name><surname>Macdonald</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2002</year>) <article-title>The genome of M. acetivorans reveals extensive metabolic and physiological diversity</article-title>. <source>Genome Res</source>
<volume>12</volume>: <fpage>532</fpage>–<lpage>542</lpage>.<pub-id pub-id-type="pmid">11932238</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Huynen1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Huynen</surname><given-names>M</given-names></name>, <name><surname>Snel</surname><given-names>B</given-names></name>, <name><surname>Lathe</surname><given-names>W</given-names><suffix>3rd</suffix></name>, <name><surname>Bork</surname><given-names>P</given-names></name> (<year>2000</year>) <article-title>Predicting protein function by genomic context: quantitative evaluation and qualitative inferences</article-title>. <source>Genome Res</source>
<volume>10</volume>: <fpage>1204</fpage>–<lpage>1210</lpage>.<pub-id pub-id-type="pmid">10958638</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Overbeek1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Overbeek</surname><given-names>R</given-names></name>, <name><surname>Fonstein</surname><given-names>M</given-names></name>, <name><surname>D'Souza</surname><given-names>M</given-names></name>, <name><surname>Pusch</surname><given-names>GD</given-names></name>, <name><surname>Maltsev</surname><given-names>N</given-names></name> (<year>1999</year>) <article-title>The use of gene clusters to infer functional coupling</article-title>. <source>Proc Natl Acad Sci USA</source>
<volume>96</volume>: <fpage>2896</fpage>–<lpage>2901</lpage>.<pub-id pub-id-type="pmid">10077608</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Lathe1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Lathe</surname><given-names>WC</given-names></name>, <name><surname>Snel</surname><given-names>B</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name> (<year>2000</year>) <article-title>Gene context conservation of a higher order than operons</article-title>. <source>Trends Biochem Sci</source>
<volume>25</volume>: <fpage>474</fpage>–<lpage>479</lpage>.<pub-id pub-id-type="pmid">11050428</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Zaslaver1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Zaslaver</surname><given-names>A</given-names></name>, <name><surname>Mayo</surname><given-names>A</given-names></name>, <name><surname>Ronen</surname><given-names>M</given-names></name>, <name><surname>Alon</surname><given-names>U</given-names></name> (<year>2006</year>) <article-title>Optimal gene partition into operons correlates with gene functional order</article-title>. <source>Phys Biol</source>
<volume>3</volume>: <fpage>183</fpage>–<lpage>189</lpage>.<pub-id pub-id-type="pmid">17021382</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Finn1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Finn</surname><given-names>RD</given-names></name>, <name><surname>Tate</surname><given-names>J</given-names></name>, <name><surname>Mistry</surname><given-names>J</given-names></name>, <name><surname>Coggill</surname><given-names>PC</given-names></name>, <name><surname>Sammut</surname><given-names>SJ</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>D281</fpage>–<lpage>288</lpage>.<pub-id pub-id-type="pmid">18039703</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Haft1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Loftus</surname><given-names>BJ</given-names></name>, <name><surname>Richardson</surname><given-names>DL</given-names></name>, <name><surname>Yang</surname><given-names>F</given-names></name>, <name><surname>Eisen</surname><given-names>JA</given-names></name>, <etal>et al</etal> (<year>2001</year>) <article-title>TIGRFAMs: a protein family resource for the functional identification of proteins</article-title>. <source>Nucleic Acids Res</source>
<volume>29</volume>: <fpage>41</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">11125044</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Servant1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Servant</surname><given-names>F</given-names></name>, <name><surname>Bru</surname><given-names>C</given-names></name>, <name><surname>Carrere</surname><given-names>S</given-names></name>, <name><surname>Courcelle</surname><given-names>E</given-names></name>, <name><surname>Gouzy</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2002</year>) <article-title>ProDom: automated clustering of homologous domains</article-title>. <source>Brief Bioinform</source>
<volume>3</volume>: <fpage>246</fpage>–<lpage>251</lpage>.<pub-id pub-id-type="pmid">12230033</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Eddy1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Eddy</surname><given-names>SR</given-names></name> (<year>2011</year>) <article-title>Accelerated Profile HMM Searches</article-title>. <source>PLoS Comput Biol</source>
<volume>7</volume>: <fpage>e1002195</fpage>.<pub-id pub-id-type="pmid">22039361</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Barrangou1">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Barrangou</surname><given-names>R</given-names></name>, <name><surname>Marraffini</surname><given-names>LA</given-names></name> (<year>2014</year>) <article-title>CRISPR-Cas systems: Prokaryotes upgrade to adaptive immunity</article-title>. <source>Mol Cell</source>
<volume>54</volume>: <fpage>234</fpage>–<lpage>244</lpage>.<pub-id pub-id-type="pmid">24766887</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Hsu1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Hsu</surname><given-names>PD</given-names></name>, <name><surname>Lander</surname><given-names>ES</given-names></name>, <name><surname>Zhang</surname><given-names>F</given-names></name> (<year>2014</year>) <article-title>Development and Applications of CRISPR-Cas9 for Genome Engineering</article-title>. <source>Cell</source>
<volume>157</volume>: <fpage>1262</fpage>–<lpage>1278</lpage>.<pub-id pub-id-type="pmid">24906146</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Barrangou2">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Barrangou</surname><given-names>R</given-names></name> (<year>2014</year>) <article-title>RNA events. Cas9 targeting and the CRISPR revolution</article-title>. <source>Science</source>
<volume>344</volume>: <fpage>707</fpage>–<lpage>708</lpage>.<pub-id pub-id-type="pmid">24833384</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Bland1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Bland</surname><given-names>C</given-names></name>, <name><surname>Ramsey</surname><given-names>TL</given-names></name>, <name><surname>Sabree</surname><given-names>F</given-names></name>, <name><surname>Lowe</surname><given-names>M</given-names></name>, <name><surname>Brown</surname><given-names>K</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>CRISPR recognition tool (CRT): a tool for automatic detection of clustered regularly interspaced palindromic repeats</article-title>. <source>BMC Bioinformatics</source>
<volume>8</volume>: <fpage>209</fpage>.<pub-id pub-id-type="pmid">17577412</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Grissa1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Grissa</surname><given-names>I</given-names></name>, <name><surname>Vergnaud</surname><given-names>G</given-names></name>, <name><surname>Pourcel</surname><given-names>C</given-names></name> (<year>2007</year>) <article-title>CRISPRFinder: a web tool to identify clustered regularly interspaced short palindromic repeats</article-title>. <source>Nucleic Acids Res</source>
<volume>35</volume>: <fpage>W52</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">17537822</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Edgar1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name> (<year>2007</year>) PILER-CR: fast and accurate identification of CRISPR repeats. <article-title>BMC Bioinformatics</article-title>. <volume>8</volume>: <fpage>18</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0110726-NCBI1">
      <label>20</label>
      <mixed-citation publication-type="other">NCBI {BLAST} executables download website (includes makeblastdb). Available: <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/blast/executables/LATEST/">ftp://ftp.ncbi.nih.gov/blast/executables/LATEST/</ext-link>. Accessed 2014 Sep 28.</mixed-citation>
    </ref>
    <ref id="pone.0110726-Camacho1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Camacho</surname><given-names>C</given-names></name>, <name><surname>Coulouris</surname><given-names>G</given-names></name>, <name><surname>Avagyan</surname><given-names>V</given-names></name>, <name><surname>Ma</surname><given-names>N</given-names></name>, <name><surname>Papadopoulos</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>
<volume>10</volume>: <fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Eddy2">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Eddy</surname><given-names>SR</given-names></name> (<year>1998</year>) <article-title>Profile hidden Markov models</article-title>. <source>Bioinformatics</source>
<volume>14</volume>: <fpage>755</fpage>–<lpage>763</lpage>.<pub-id pub-id-type="pmid">9918945</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Haft2">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Selengut</surname><given-names>JD</given-names></name>, <name><surname>Richter</surname><given-names>RA</given-names></name>, <name><surname>Harkins</surname><given-names>D</given-names></name>, <name><surname>Basu</surname><given-names>MK</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>TIGRFAMs and Genome Properties in 2013</article-title>. <source>Nucleic Acids Res</source>
<volume>41</volume>: <fpage>D387</fpage>–<lpage>395</lpage>.<pub-id pub-id-type="pmid">23197656</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Haft3">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Selengut</surname><given-names>J</given-names></name>, <name><surname>Mongodin</surname><given-names>EF</given-names></name>, <name><surname>Nelson</surname><given-names>KE</given-names></name> (<year>2005</year>) <article-title>A guild of 45 CRISPR-associated (Cas) protein families and multiple CRISPR/Cas subtypes exist in prokaryotic genomes</article-title>. <source>PLoS Comput Biol</source>
<volume>1</volume>: <fpage>e60</fpage>.<pub-id pub-id-type="pmid">16292354</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Makarova1">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Makarova</surname><given-names>KS</given-names></name>, <name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Barrangou</surname><given-names>R</given-names></name>, <name><surname>Brouns</surname><given-names>SJ</given-names></name>, <name><surname>Charpentier</surname><given-names>E</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Evolution and classification of the CRISPR-Cas systems</article-title>. <source>Nat Rev Microbiol</source>
<volume>9</volume>: <fpage>467</fpage>–<lpage>477</lpage>.<pub-id pub-id-type="pmid">21552286</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Staals1">
      <label>26</label>
      <mixed-citation publication-type="other">Staals RHJ, Brouns SJJ (2013) Distribution and Mechanism of the Type I CRISPR-Cas Systems. In: Barrangou R, Oost Jvd, editors. CRISPR-Cas Systems - RNA-mediated Adaptive Immunity in Bacteria and Archaea. Berlin Heidelberg: Springer Berlin Heidelberg.</mixed-citation>
    </ref>
    <ref id="pone.0110726-Touchon1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Touchon</surname><given-names>M</given-names></name>, <name><surname>Rocha</surname><given-names>EP</given-names></name> (<year>2010</year>) <article-title>The small, slow and specialized CRISPR and anti-CRISPR of Escherichia and Salmonella</article-title>. <source>PLoS ONE</source>
<volume>5</volume>: <fpage>e11126</fpage>.<pub-id pub-id-type="pmid">20559554</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-BondyDenomy1">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Bondy-Denomy</surname><given-names>J</given-names></name>, <name><surname>Davidson</surname><given-names>AR</given-names></name> (<year>2014</year>) <article-title>To acquire or resist: the complex biological effects of CRISPR-Cas systems</article-title>. <source>Trends Microbiol</source>
<volume>22</volume>: <fpage>218</fpage>–<lpage>225</lpage>.<pub-id pub-id-type="pmid">24582529</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4201578</article-id>
    <article-id pub-id-type="pmid">25330359</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-14-31682</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0110726</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome Annotation</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Comparative Genomics</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Microbial Genomics</subject>
              <subj-group>
                <subject>Bacterial Genomics</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Microbiology</subject>
        </subj-group>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Machines</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Applications</subject>
          <subj-group>
            <subject>Web-Based Applications</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computer Software</subject>
          <subj-group>
            <subject>Open Source Software</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Software-Aided Sequence Analysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MacSyFinder: A Program to Mine Genomes for Molecular Systems with an Application to CRISPR-Cas Systems</article-title>
      <alt-title alt-title-type="running-head">MacSyFinder: Macromolecular Systems Detection</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Abby</surname>
          <given-names>Sophie S.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Néron</surname>
          <given-names>Bertrand</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ménager</surname>
          <given-names>Hervé</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Touchon</surname>
          <given-names>Marie</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rocha</surname>
          <given-names>Eduardo P. C.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Microbial Evolutionary Genomics, Institut Pasteur, Paris, France</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>UMR3525, CNRS, Paris, France</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Centre d’Informatique pour la Biologie, Institut Pasteur, Paris, France</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Torres</surname>
          <given-names>Néstor V.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Universidad de La Laguna, Spain</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>sophie.abby@pasteur.fr</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: SSA EPCR MT. Performed the experiments: SSA MT. Analyzed the data: MT. Contributed to the writing of the manuscript: SSA EPCR MT. Designed the MacSyFinder software: SSA BN. Designed the MacSyView application: SSA BN HM.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>10</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>10</issue>
    <elocation-id>e110726</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>7</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>9</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Abby et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Abby et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Motivation</title>
        <p>Biologists often wish to use their knowledge on a few experimental models of a given molecular system to identify homologs in genomic data. We developed a generic tool for this purpose.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p><bold>Mac</bold>romolecular <bold>Sy</bold>stem <bold>Finder</bold> (MacSyFinder) provides a flexible framework to model the properties of molecular systems (cellular machinery or pathway) including their components, evolutionary associations with other systems and genetic architecture. Modelled features also include functional analogs, and the multiple uses of a same component by different systems. Models are used to search for molecular systems in complete genomes or in unstructured data like metagenomes. The components of the systems are searched by sequence similarity using Hidden Markov model (HMM) protein profiles. The assignment of hits to a given system is decided based on compliance with the content and organization of the system model. A graphical interface, MacSyView, facilitates the analysis of the results by showing overviews of component content and genomic context. To exemplify the use of MacSyFinder we built models to detect and class CRISPR-Cas systems following a previously established classification. We show that MacSyFinder allows to easily define an accurate “Cas-finder” using publicly available protein profiles.</p>
      </sec>
      <sec>
        <title>Availability and Implementation</title>
        <p>MacSyFinder is a standalone application implemented in Python. It requires Python 2.7, Hmmer and makeblastdb (version 2.2.28 or higher). It is freely available with its source code under a GPLv3 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/gem-pasteur/macsyfinder">https://github.com/gem-pasteur/macsyfinder</ext-link>. It is compatible with all platforms supporting Python and Hmmer/makeblastdb. The “Cas-finder” (models and HMM profiles) is distributed as a compressed tarball archive as Supporting Information.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>This project was funded by the Institut Pasteur (<ext-link ext-link-type="uri" xlink:href="http://www.pasteur.fr/en">http://www.pasteur.fr/en</ext-link>), the French “Centre National de la Recherche Scientifique” (<ext-link ext-link-type="uri" xlink:href="http://www.cnrs.fr/index.php">http://www.cnrs.fr/index.php</ext-link>) and the European Research Council (<ext-link ext-link-type="uri" xlink:href="http://erc.europa.eu/">http://erc.europa.eu/</ext-link>) (grant EVOMOBILOME, number 281605). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The authors confirm that all data underlying the findings are fully available without restriction. All relevant data are within the paper and its Supporting Information files.</p>
  </notes>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Macromolecular systems are involved in key aspects of cell biology <xref rid="pone.0110726-Alberts1" ref-type="bibr">[1]</xref>, <xref rid="pone.0110726-PereiraLeal1" ref-type="bibr">[2]</xref>. They can be constituted of nanomachines, like the ribosome or the flagellum, or molecular pathways, like the ones allowing the degradation of foreign genetic elements by CRISPR-Cas systems. The identification and classification of macromolecular systems is important to characterize biological traits, and is routinely done in many laboratories. However, it is difficult to do on a systematic basis by a number of reasons. Firstly, systems are made of many different components with different levels of dispensability, some being essential and others accessory. For example, homologous recombination in bacteria involves some key essential components (like RecA), and several associated alternative pathways (like RecBCD and RecFOR) <xref rid="pone.0110726-Michel1" ref-type="bibr">[3]</xref>. Secondly, key components may have homologs in other systems, complicating their unambiguous assignment to a given system. This is for instance the case of the non-flagellar type III secretion system for which eight of the nine core genes have homologs in the bacterial flagellum <xref rid="pone.0110726-Abby1" ref-type="bibr">[4]</xref>. Thirdly, the components of the systems evolve at very diverse rates, complicating the identification of homology by sequence similarity. For example, many proteins involved in reproduction are highly conserved, whereas others endure selection for fast evolution <xref rid="pone.0110726-Galagan1" ref-type="bibr">[5]</xref>. These difficulties can be partly circumvented by searching for the whole set of components of the system because the integration of all the information leads to more accurate inference. This is especially relevant if the genes encoding these components are organized in highly conserved ways. In Prokaryotes, organelles and viruses, macromolecular systems are often encoded in one or a few conserved neighbouring operons ensuring tight regulation and correct assembly/functioning. This facilitates the assignment of certain components to a system <xref rid="pone.0110726-Huynen1" ref-type="bibr">[6]</xref>–<xref rid="pone.0110726-Zaslaver1" ref-type="bibr">[9]</xref>.</p>
    <p>We have developed a program named <bold>Mac</bold>romolecular <bold>Sy</bold>stem <bold>Finder</bold> (MacSyFinder) to detect molecular systems in genome data from user-defined biological models. The components of the systems are searched using protein profiles encoded as hidden Markov models (HMM), such as those available in databases like PFAM, TIGRFAM or PRODOM <xref rid="pone.0110726-Finn1" ref-type="bibr">[10]</xref>–<xref rid="pone.0110726-Servant1" ref-type="bibr">[12]</xref>. Protein profiles provide a compressed way to represent a database of homologous sequences, giving increased sensitivity and specificity <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. MacSyFinder identifies the presence of a given system according to the specifications of the input model, which includes customizable information on the type and number of components, on their genetic organization, and other relevant discriminating traits. We implemented MacSyFinder as a generic portable tool that can be installed in-house for large genomic or metagenomic projects. The companion program, MacSyView, allows the visualization of the results of MacSyFinder. To show a typical situation where MacSyFinder can be useful, we built a set of models to identify Cas proteins. Clustered regularly interspaced short palindromic repeats (CRISPR) arrays and their associated Cas (CRISPR-associated) proteins form the CRISPR-Cas system. CRISPR-Cas are sophisticated adaptive immune systems that rely on small RNAs for sequence-specific targeting of foreign nucleic acids such as viruses and plasmids <xref rid="pone.0110726-Barrangou1" ref-type="bibr">[14]</xref>. Cas proteins have been intensively studied in the recent years for their role in the interaction between Prokaryotes and their mobile genetic elements and for their biotechnological interest <xref rid="pone.0110726-Hsu1" ref-type="bibr">[15]</xref>, <xref rid="pone.0110726-Barrangou2" ref-type="bibr">[16]</xref>. Tools are available to detect and analyse CRISPR arrays <xref rid="pone.0110726-Bland1" ref-type="bibr">[17]</xref>–<xref rid="pone.0110726-Edgar1" ref-type="bibr">[19]</xref>, however, no program is available to detect and class <italic>cas</italic> operons themselves. This example shows that using information from the literature and available protein profiles, one can easily build an accurate and efficient “Cas-finder” with MacSyFinder.</p>
  </sec>
  <sec id="s2">
    <title>MacSyFinder's Rationale</title>
    <sec id="s2a">
      <title>Definition of the models</title>
      <p>MacSyFinder models, written using an XML grammar, describe the components and genetic organization of a given macromolecular system (see the documentation in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref> for a full description of the grammar). Each model is defined in a dedicated file named after the type of system (<italic>e.g.,</italic> CAS-TypeI.xml'), which contains system-wise and component-wise features (<xref ref-type="fig" rid="pone-0110726-g001">Figure 1</xref>). MacSyFinder considers three classes of components: <italic>mandatory</italic>, <italic>accessory</italic>, and <italic>forbidden</italic>. Components that are ubiquitous and identifiable in all systems are defined as <italic>mandatory</italic>. Other components of the system are defined as <italic>accessory</italic>. These <italic>accessory</italic> components can be essential for the assembly/functioning of the system, while not being identifiable by sequence similarity because of rapid evolution or because they are non-homologous among variants of the system. Discrimination between partly homologous systems is easier when some specific components are defined as <italic>forbidden</italic> in the models of the systems lacking them (<xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>).</p>
      <fig id="pone-0110726-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Modelling systems with MacSyFinder.</title>
          <p>The components of a system assemble into macromolecular systems or correspond to a biological pathway. They are typically encoded in genomes in one or a few different loci (“Genomic context”). We illustrate how systems can be modelled and distinguished with two imaginary systems “A” and “B” that have four homologous components (C1–C4, similar colours for the two systems). The system “B” has one component that is not found in “A”(C5). The parameter <italic>inter_gene_max_space</italic> (D) defines the maximal number of genes between two consecutive components (d<sub>i,j</sub>). The two systems are defined by a set of <italic>mandatory</italic> (green), <italic>accessory</italic> (black) and <italic>forbidden</italic> (red) components. The quorum rules allow relaxing the definition of the system without altering the list of its components (<italic>min_genes_required</italic> and <italic>min_mandatory_genes_required</italic> parameters in XML files). If they are not specified, a default value is computed from the number of components described in the XML files. The bottom part of the figure shows the description of the systems in the XML grammar (see the documentation in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>). Components listed here refer to protein profiles (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3</xref>). When a component is found in several systems, it is defined only once, and can be reused in another system with the <italic>system_ref</italic> keyword. Much more complex features can be defined, including exchangeable genes, distant genes and component-specific parameters (<xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>).</p>
        </caption>
        <graphic xlink:href="pone.0110726.g001"/>
      </fig>
      <p>Systems that respect a pre-defined minimal quorum of components are identified as complete. The quorum is either the number of <italic>mandatory</italic> components and/or the sum of <italic>mandatory</italic> and <italic>accessory</italic> components (see the documentation on attributes <italic>min_mandatory_genes_required</italic> and <italic>min_genes_required</italic> in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>). Components defined as functionally <italic>exchangeable</italic> are only counted once in the quorum. These components can be part of systems defined in other models using the <italic>system_ref</italic> keyword. Genes encoding components that participate in multiple systems of the same type, such as proteins interacting with different instances of a system, are labelled <italic>multi_system</italic>.</p>
      <p>The genetic architecture of the components is defined using several attributes. Two components are co-localized when their genes are closer than a given number of genes (system-wise parameter <italic>inter_gene_max_space</italic>, <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>). A component defined with the <italic>loner</italic> attribute does not need to be co-localized with other components to be part of a system. One can also specify component-specific values of <italic>inter_gene_max_space</italic>. The system-wise parameter <italic>multi_loci</italic> allows MacSyFinder to detect systems encoded by several distant clusters of genes.</p>
    </sec>
    <sec id="s2b">
      <title>Implementation, system requirements and availability</title>
      <p>MacSyFinder was coded in Python, and details on its object-oriented implementation are available in <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref> and in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>. MacSyFinder requires Python version 2.7, the formatdb or makeblastdb tools (version 2.2.28 or better for the latter) <xref rid="pone.0110726-NCBI1" ref-type="bibr">[20]</xref>, <xref rid="pone.0110726-Camacho1" ref-type="bibr">[21]</xref> and the program Hmmer <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>, <xref rid="pone.0110726-Eddy2" ref-type="bibr">[22]</xref>. MacSyFinder is freely available. Its source code is distributed under a GPLv3 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/gem-pasteur/macsyfinder">https://github.com/gem-pasteur/macsyfinder</ext-link> and updated versions will be accessible there. MacSyFinder is compatible with all platforms supporting Python, Hmmer, and makeblastdb. The MacSyFinder release used in this paper is provided in <xref ref-type="supplementary-material" rid="pone.0110726.s010">Data S1</xref>. MacSyView's source code is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gem-pasteur/macsyview">https://github.com/gem-pasteur/macsyview</ext-link> but it is also distributed in the MacSyFinder's package. MacSyView was coded in Javascript and uses third-party libraries that are included in the package, and accredited in the COPYRIGHT file (See <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>). It was tested on Chromium and Firefox for Linux, and on Chrome, Firefox and Safari for Mac OS X. A documentation file including installation and users' instructions, details on modelling procedures and examples for MacSyView and MacSyFinder is available in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>.</p>
    </sec>
    <sec id="s2c">
      <title>Input and output</title>
      <p>The MacSyFinder program (<xref ref-type="supplementary-material" rid="pone.0110726.s010">Data S1</xref>) receives as input a list of systems defined in XML files (see above), protein profiles, command-line parameters and a file with protein sequences in fasta format (see the documentation in <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>). The parameters can be specified in the command-line or in a configuration file. System and component parameters specified in the command-line override model specifications in the XML files.</p>
      <p>MacSyFinder manages three different types of protein datasets. The <bold>unordered</bold> dataset lacks information on gene order and genome origin. This mode is useful to study large sequence databanks or metagenomic data. Naturally, in these datasets the notions of co-localization and quorum are not relevant. The <bold>unordered replicon</bold> dataset includes protein sequences from one single genome. This is useful to analyse unassembled genomes with large numbers of contigs. In this case the notion of quorum is relevant (albeit with certain limitations), but co-localization is not. The <bold>ordered replicon</bold> dataset includes proteins from one single replicon that are ordered according to the position of the corresponding genes in the genome. This is the most powerful mode and can be used to analyse complete or nearly complete genomes. Another related mode (<italic>gembase</italic>) requires a specific input file format and allows the analysis of multiple ordered replicons in a single step (see <xref ref-type="supplementary-material" rid="pone.0110726.s009">File S1</xref>).</p>
      <p>The output of MacSyFinder includes log files, intermediate results, the number of detected systems, and the information on each detected component from each instance of the system. This information is made available in the form of text tables and JSON files. We have built MacSyView, a standalone web-browser application that uses output JSON files to visualise the systems and their genomic context. MacSyView generates exportable SVG files containing views of the detected systems (<xref ref-type="fig" rid="pone-0110726-g002">Fig. 2</xref>).</p>
      <fig id="pone-0110726-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Snapshot of MacSyFinder's results as viewed with MacSyView.</title>
          <p>A. The MacSyView web-browser based application allows the visualization of MacSyFinder's output file “results.macsyfinder.json”. B. MacSyView displays the list of systems available in the results file. The user picks a system to visualize by clicking on it in the list. C. The page displaying the system is made of a header, and three panels. The header allows to select another input file, or to go back to the list of systems. It displays information on the system that is being visualized. The first panel shows how the detected system fits the model compliance in terms of its components. Boxes represent the number of each <italic>mandatory</italic>, <italic>accessory</italic>, and <italic>forbidden</italic> components. A tooltip gives the name of the component when the mouse hovers a box. Component boxes can be sorted by decreasing number of components. The second panel shows the genetic context of the system (as transcribed from the input fasta file), with components drawn to scale. When the mouse hovers a box, a tooltip displays information on the corresponding component, including scores of the Hmmer hit. This view can be exported as a SVG file for drawing purposes (tools circled in red). The third panel gives detailed information on the components of the system.</p>
        </caption>
        <graphic xlink:href="pone.0110726.g002"/>
      </fig>
    </sec>
    <sec id="s2d">
      <title>Functioning</title>
      <p>The user runs MacSyFinder from the command-line on a protein sequence dataset for a number of systems of interest. The non-redundant list of components to search is extracted from the XML files. The presence of a given component is determined by similarity search with HMM protein profiles using the program Hmmer <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. The hits are filtered according to user-defined i-evalue (for statistical significance) and to the minimal coverage of the profile in the alignment (to control for the minimal size of the profile that must be matched to obtain biologically relevant hits). The components defined in the models are searched in parallel for rapidity (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3A</xref>). If multiple profiles match the same protein, MacSyFinder selects the hit with the highest score. The subsequent steps depend on whether the input dataset is an ordered replicon, an unordered genome or an unordered genomic dataset (<italic>e.g</italic>., a metagenome).</p>
      <fig id="pone-0110726-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Functioning of MacSyFinder.</title>
          <p>A. The user launches MacSyFinder to detect macromolecular systems A and B (example of <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>). System-specific parameters are read from the corresponding XML definition files. This includes the list of the components of the systems and the corresponding HMM profiles. Other detection parameters are picked by order of priority: on the command-line, in the configuration file, and in the XML files. Sequences are indexed with the “formatdb” or “makeblastdb” tools for similarity search with the Hmmer program. MacSyFinder runs (optionally in parallel) the Hmmer searches on a non-redundant list of components' profiles. If the sequence dataset is “unordered” MacSyFinder only outputs the hits and the components detected for each type of system. B. Step #1: the co-localization criterion can be used in the ordered datasets. It involves clustering the hits separated by less than D protein-coding genes. The components described as “loner” in the XML definition files can be at any distance from other components. Step #2: the components of each cluster are used to fill the occurrences of the systems. Depending on the quorum, a cluster can describe a “full” system, or a “scattered” system. Step #3: clusters with components belonging to more than one system are split in unique systems and then re-directed separately to step #2.</p>
        </caption>
        <graphic xlink:href="pone.0110726.g003"/>
      </fig>
      <p>If the dataset is an <bold>ordered replicon</bold>, the hits are clustered according to the genetic organization specified in the model. Clusters including the components of a single type of system are used to fill inventories of “compatible” systems (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3B</xref>). If multiple systems are compatible with the set of components in the clusters, then the different candidate systems are examined. The order of exam is given by decreasing number of components shared between the cluster and the compatible systems. The cluster will be assigned to the first system in the list that fits its content. A system is regarded as complete if the quorum is respected. When a complete instance of the system has components from a single locus, further new occurrences of the same components in the cluster are used to produce a novel instance. When a single cluster is not enough to make a complete instance and the <italic>multi_loci</italic> parameter is turned on, the hits are stored to fill up an instance of the system encoded by multiple distant loci. Clusters with components from multiple systems are split in sub-clusters containing components from a single system. These sub-clusters are then re-analysed in terms of their components (<xref ref-type="fig" rid="pone-0110726-g003">Fig. 3B</xref>). MacSyFinder can only resolve these complex cases if the components of each system are contiguous, instead of scattered on the cluster.</p>
      <p><bold>Unordered</bold> sequence datasets cannot be analysed with the co-localization criteria. Therefore, hits from the similarity searches are directly used to fill inventories of each system. Systems are complete if the required quorum is respected. The presence of <italic>forbidden</italic> components is ignored in this mode, even if such occurrences are stored to inform the user. A single system instance will be filled per system and dataset, independently of the number of component occurrences found. This is because components cannot be individually assigned to particular instances in the absence of the genomic context. Nevertheless, the analysis of the number of identified components can be used to estimate the number of instances in the dataset.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Application</title>
    <sec id="s3a">
      <title>Data</title>
      <p>The complete genomes of bacteria (2484) and archaea (159) were downloaded from NCBI RefSeq (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/genomes/">ftp://ftp.ncbi.nih.gov/genomes/</ext-link>, November 2013). Profiles for the Cas protein families were obtained from the TIGRFAM database, version 13.0 (<ext-link ext-link-type="uri" xlink:href="http://www.jcvi.org/cgi-bin/tigrfams/index.cgi">http://www.jcvi.org/cgi-bin/tigrfams/index.cgi</ext-link>, August 15 2012) <xref rid="pone.0110726-Haft1" ref-type="bibr">[11]</xref>, <xref rid="pone.0110726-Haft2" ref-type="bibr">[23]</xref>. Among the 89 profiles available, 53 were constructed by Haft and colleagues <xref rid="pone.0110726-Haft3" ref-type="bibr">[24]</xref> and correspond to 45 Cas protein families that were used to propose a CRISPR-Cas systems classification <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. Subsequently, these authors constructed 36 additional protein profiles more specific to given subtypes that are available in TIGRFAM <xref rid="pone.0110726-Haft2" ref-type="bibr">[23]</xref>. We renamed these profiles to make them more informative for the user (see <xref ref-type="supplementary-material" rid="pone.0110726.s004">Table S1</xref> for correspondence with established classification).</p>
    </sec>
    <sec id="s3b">
      <title>Developing a new system's model</title>
      <p>The goal of MacSyFinder is to query genomic data using biologically meaningful models of a system. The first step of the model building procedure is therefore to use the available knowledge to identify the system components, their frequency and their genetic architecture. The second step is to obtain protein profiles for the components either by building them specifically for this purpose or by retrieving them from public databases. Protein profiles can be built easily from multiple sequence alignments of homologous proteins using Hmmer <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. The third step is to write the model in the simple MacSyFinder's XML grammar (see above and <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref> for an example). The final step is to include information about homologous systems in the model. The use of system-specific profiles and <italic>forbidden</italic> attributes facilitates the discrimination between systems (<xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref>). Our experience is that complex models should be built by iterating several times on these steps from simpler models. Indeed, the fine-tuning of the quorum definitions and genetic architectures can vastly increase the quality of identification of a system. Often, one is confronted with systems for which very few instances have been experimentally studied. In this case, iteration of the modelling steps provides both more reliable models and a better knowledge of the systems diversity. To exemplify the use of MacSyFinder we built models to identify Cas proteins and classify CRISPR-Cas systems. This is a very typical example of systems that are intensively studied, for which there are many protein profiles in the databases, but no software dedicated to their detection.</p>
    </sec>
    <sec id="s3c">
      <title>Detection and classification of CRISPR-Cas systems</title>
      <p>The known <italic>cas</italic> operons have from 3 to 13 genes encoding very diverse proteins, among which several nucleases and helicases with DNA and/or RNA binding domains <xref rid="pone.0110726-Haft3" ref-type="bibr">[24]</xref>, <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. A unified classification of CRISPR-Cas systems has been recently established based on the presence or absence of peculiar Cas protein families, and on the genetic architecture of the <italic>cas</italic> operon <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. Three major types and several subtypes of CRISPR-Cas systems have been described. <italic>cas1</italic> and <italic>cas2</italic> universally occur across types and subtypes, whereas <italic>cas3</italic>/<italic>cas7</italic>, <italic>cas9</italic>, and <italic>cas10</italic> have been defined as the signature genes for type I, type II, and type III, respectively (<xref ref-type="fig" rid="pone-0110726-g004">Fig. 4</xref>). Protein profiles matching most of these Cas protein families are publicly available in the TIGRFAM database <xref rid="pone.0110726-Haft1" ref-type="bibr">[11]</xref>, <xref rid="pone.0110726-Haft3" ref-type="bibr">[24]</xref>. We used this information to exemplify how MacSyFinder can be used to identify and classify these systems.</p>
      <fig id="pone-0110726-g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Simplified operon organization of the three major types and ten subtypes of CRISPR-Cas systems.</title>
          <p>Each <italic>cas</italic> gene family is indicated with a distinct colour, those specific to a subtype are in white. Only the main <italic>cas</italic> gene families are represented.</p>
        </caption>
        <graphic xlink:href="pone.0110726.g004"/>
      </fig>
      <sec id="s3c1">
        <title>General model and choice of parameters</title>
        <p>In a first round of analysis, we defined a <bold>general simple model</bold> to identify all possible clusters of Cas proteins in 2643 prokaryotic genomes. In this general definition, all the CRISPR-Cas-HMM profiles available in TIGRFAM database were used whatever their type or subtype specificity (<xref ref-type="supplementary-material" rid="pone.0110726.s004">Table S1</xref>). At this stage, we used relatively relaxed criteria: all the components were defined as <italic>accessory</italic> and all clusters with at least 3 different components (<italic>min_genes_required</italic> = 3) distant from at most 5 genes (<italic>inter_gene_max_space</italic> “D” = 5) were retained. With this procedure, we identified 1628 clusters of Cas proteins and could annotate 10663 Cas proteins (<italic>i.e.</italic>, with significant matches to protein profiles). The total number of genes in the detected clusters ranged from 3 to 36 with an average of 7.7±3.5 genes (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1A</xref>). In these clusters, most of the genes (86%) encode known Cas proteins (<italic>i.e.</italic>, described in the general definition) and 56% of clusters have components strictly contiguous (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1B</xref>). While these preliminary results suggest that most clusters are Cas systems, a small fraction of them (7%) is larger than the larger described systems (&gt;13 genes, <xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1A</xref>), suggesting that the above-mentioned parameters might be too permissive (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1C</xref>). These large clusters might correspond to contiguous or intertwined systems (<italic>i.e.</italic>, chimeric variants). To test this hypothesis, we explored the effect of changing D on the identification of clusters (<italic>i.e.</italic>, D = 4, 5, and 6, see <xref ref-type="supplementary-material" rid="pone.0110726.s005">Table S2</xref>). A more stringent co-localization criterion (D = 4), resulted in a decrease of the overall number of Cas proteins assigned to systems, the subdivision of several previously detected clusters, and the persistence of large clusters (<xref ref-type="supplementary-material" rid="pone.0110726.s005">Table S2</xref>). A less stringent criterion (D = 6) led to the fusion of several clusters with a small gain of Cas proteins assigned to systems (<xref ref-type="supplementary-material" rid="pone.0110726.s005">Table S2</xref>). We therefore set the final co-localization criterion to 5, and the minimal number of genes to 3. Doubts about multiple closely co-occurring systems can often be removed using more specific “typing” and “subtyping” models, because in this case contiguous systems of different types will be set apart (see below). While the general definition of the system is very simple, it fetches systems with Cas1 or a Cas2 protein in respectively 88% and 73% of the clusters, even if weak constraints were imposed on their presence (<italic>accessory</italic> proteins in the general definition of the system). We identified Cas clusters in 78% of archaeal genomes and 39% of bacterial genomes. This is very similar to previous observations and therefore suggests that even the general model accurately identifies Cas systems <xref rid="pone.0110726-Staals1" ref-type="bibr">[26]</xref> (<xref ref-type="supplementary-material" rid="pone.0110726.s001">Fig. S1D</xref>, and see the paragraph on the validation of our models).</p>
      </sec>
      <sec id="s3c2">
        <title>Typing and Subtyping CRISPR-Cas systems</title>
        <p>To exemplify the ability of MacSyFinder to characterise sub-systems we built models for each type and subtype of Cas systems from the pre-existing classification <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref> (<xref ref-type="fig" rid="pone-0110726-g004">Fig. 4</xref>). We first tested the specificity of the 89 available protein profiles for a given type and subtype by analysing the co-occurrence of pairs of Cas proteins in clusters detected with the general model (<xref ref-type="fig" rid="pone-0110726-g005">Fig. 5</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>). Then we designed the corresponding models accordingly. In the final models (<xref ref-type="supplementary-material" rid="pone.0110726.s002">Fig. S2</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>), all profiles specific to a system were defined as <italic>mandatory</italic> (signature gene) while all the others were defined as <italic>accessory</italic>. Because some systems have very similar content and organization (<italic>e.g.</italic>, Type II-A and II-B), profiles distinguishing them are <italic>accessory</italic> or <italic>mandatory</italic> in a system, and <italic>forbidden</italic> in the other (see <xref ref-type="fig" rid="pone-0110726-g001">Fig. 1</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s002">Fig. S2</xref> for examples). Although the types and subtypes have different numbers of genes, we set the <italic>min_genes_required</italic> parameter to 3, and the <italic>inter_gene_max_space</italic> parameter to 5 for all models to make the detection as large as possible and comparable with that resulting from the general model. We defined 5”typing” models and 15”subtyping” models for <italic>cas</italic> loci detection and classification (see <xref ref-type="supplementary-material" rid="pone.0110726.s002">Fig. S2</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>).</p>
        <fig id="pone-0110726-g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0110726.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Frequency of co-occurrence between Cas proteins present in clusters detected with the general model (left) and the subtyping models (right).</title>
            <p>Each matrix was normalized by the maximum of each column. The higher the frequency is, the warmer the colour is: the red diagonal corresponds to a 100% co-occurrence. Only frequencies above 1% were represented, others are in grey.</p>
          </caption>
          <graphic xlink:href="pone.0110726.g005"/>
        </fig>
        <p>Using the <bold>subtyping models</bold> we classed the previously detected Cas clusters, but were also able to split different contiguous systems (<xref ref-type="fig" rid="pone-0110726-g005">Fig. 5</xref>). Thus, among the 1628 Cas clusters, 95% correspond to a single system, 3% to contiguous distinct systems (including the type III-B well known to be associated with other systems-type <xref rid="pone.0110726-Staals1" ref-type="bibr">[26]</xref>), the remaining 2% correspond to chimeric variants. Most of the Cas clusters could readily be assigned to proposed types (97%) and subtypes (94%) with our models. The remaining corresponded to <italic>cas</italic> locus with no gene signature, or to chimeric variants (<xref ref-type="supplementary-material" rid="pone.0110726.s006">Table S3</xref>).</p>
      </sec>
      <sec id="s3c3">
        <title>Validation of detected systems</title>
        <p>We made two analyses to obtain a more precise assessment of the accuracy of the method. Firstly, we quantified how often Cas systems detected with the General definition (command-lines available in <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>) co-occurred with CRISPR arrays as is the case in all fully functional described systems. We searched for CRISPR-arrays with <xref rid="pone.0110726-Bland1" ref-type="bibr">[17]</xref> as described in <xref rid="pone.0110726-Touchon1" ref-type="bibr">[27]</xref> and found that 88% of the detected Cas systems are close (&lt;1kb, same result for &lt;5kb) to a CRISPR-array and that 98% are present in a replicon containing at least one CRISPR-array. The absence of CRISPR in so few Cas-containing genomes suggests the method has a low rate of false positives. Secondly, we took from the literature the list of CRISPR-Cas with experimentally characterized <italic>in vivo</italic> effects <xref rid="pone.0110726-BondyDenomy1" ref-type="bibr">[28]</xref>. In this list we could detect 100% of the 25 known Cas systems of genomes included in our dataset (<xref ref-type="supplementary-material" rid="pone.0110726.s007">Table S4</xref>) with our “general”, “typing” and “subtyping” models (see command-lines in <xref ref-type="supplementary-material" rid="pone.0110726.s008">Text S1</xref>). Furthermore, we could assign the correct subtype to 23 of them, and we propose a subtype for the system of <italic>Mycoplasma gallisepticum</italic>. This suggests a low rate of false negatives. Altogether these results suggest the method is very accurate and that most clusters correspond to CRISPR-Cas systems. Type I systems are more abundant in both bacteria (in ∼31% of the bacterial genomes) and archaea (∼71%), Type II are only found in bacteria, while Type III are more prevalent in archaea (∼38%) (<xref ref-type="table" rid="pone-0110726-t001">Table 1</xref> and <xref ref-type="supplementary-material" rid="pone.0110726.s003">Fig. S3</xref>). These results are consistent with previous analyses <xref rid="pone.0110726-Makarova1" ref-type="bibr">[25]</xref>. Subtypes I-C, I-E and I-F are more commonly found in bacteria, while subtypes I-A, I-B and I-D are frequent in archaea, as previously noted <xref rid="pone.0110726-Staals1" ref-type="bibr">[26]</xref>. Overall, these results suggest that our models are able to accurately identify and type Cas systems. Profiles and models for the “Cas-Finder” are provided in <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>. Users can easily add or remove components and change the genetic organization specifications.</p>
        <table-wrap id="pone-0110726-t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0110726.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Taxonomic distribution of CRISPR-Cas types and sub-types in prokaryotes expressed in number and percentage of the genomes harboring the systems.</title>
          </caption>
          <alternatives>
            <graphic id="pone-0110726-t001-1" xlink:href="pone.0110726.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Typing</td>
                  <td colspan="7" align="left" rowspan="1">Type I</td>
                  <td colspan="3" align="left" rowspan="1">Type II</td>
                  <td colspan="3" align="left" rowspan="1">Type III</td>
                  <td align="left" rowspan="1" colspan="1">Type U</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Bacteria</td>
                  <td colspan="7" align="left" rowspan="1">769 (31%)</td>
                  <td colspan="3" align="left" rowspan="1">177 (7%)</td>
                  <td colspan="3" align="left" rowspan="1">222 (9%)</td>
                  <td align="left" rowspan="1" colspan="1">7</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Archaea</td>
                  <td colspan="7" align="left" rowspan="1">113 (71%)</td>
                  <td colspan="3" align="left" rowspan="1">0</td>
                  <td colspan="3" align="left" rowspan="1">60 (38%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>Subtyping</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-A</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-B</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-C</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-D</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-E</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-F</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>I-U</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>II-A</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>II-B</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>II-U</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>III-A</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>III-B</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>III-U</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>U</bold>
                  </td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Bacteria</td>
                  <td align="left" rowspan="1" colspan="1">16 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">173 (7%)</td>
                  <td align="left" rowspan="1" colspan="1">196 (8%)</td>
                  <td align="left" rowspan="1" colspan="1">31 (1%)</td>
                  <td align="left" rowspan="1" colspan="1">282 (11%)</td>
                  <td align="left" rowspan="1" colspan="1">111 (5%)</td>
                  <td align="left" rowspan="1" colspan="1">47 (2%)</td>
                  <td align="left" rowspan="1" colspan="1">81 (3%)</td>
                  <td align="left" rowspan="1" colspan="1">5 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">93 (4%)</td>
                  <td align="left" rowspan="1" colspan="1">123 (5%)</td>
                  <td align="left" rowspan="1" colspan="1">112 (5%)</td>
                  <td align="left" rowspan="1" colspan="1">3 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">7 (&lt;1%)</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Archaea</td>
                  <td align="left" rowspan="1" colspan="1">55 (35%)</td>
                  <td align="left" rowspan="1" colspan="1">48 (30%)</td>
                  <td align="left" rowspan="1" colspan="1">2 (&lt;1%)</td>
                  <td align="left" rowspan="1" colspan="1">16 (10%)</td>
                  <td align="left" rowspan="1" colspan="1">5 (3%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">2 (1%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">28 (18%)</td>
                  <td align="left" rowspan="1" colspan="1">40 (25%)</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
      </sec>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>The use of MacSyFinder will often involve preliminary steps to model the biological systems of interest. This allows the researcher to produce structured knowledge and is particularly useful when these systems have distinguishable traits, such as a specific genetic architecture. Often there are few studies suggesting the parameters to use in the models. Under these circumstances, one should start with very simple models, <italic>e.g.</italic>, noting all components as <italic>accessory</italic> and using low quorums. The analysis of the results of these preliminary models often provides important clues on how to produce more complex and accurate models. For example, by relaxing the criteria of the requirements to identify type III secretion systems (T3SS) we were recently able to identify a new homologous system in <italic>Myxobacteria</italic>
<xref rid="pone.0110726-Abby1" ref-type="bibr">[4]</xref>. Modelling itself can thus lead to new biological findings.</p>
    <p>MacSyFinder ignores phylogenetic information when putting together components of systems scattered in a replicon or in unordered datasets. In contrast, the preliminary distinction between homologous proteins can often be done using MacSyFinder without the need for lengthy phylogenetic analyses. This works in two steps. First, one must produce a multiple alignment gathering the different families of homologous proteins. This alignment must be divided into sub-alignments according to the different systems, leading to the production of different profiles for the different sub-families of homologs. Finally, and as a rule, for a given protein, the best-scoring profile corresponds to the relevant homologous family (see <xref ref-type="fig" rid="pone-0110726-g005">Fig. 5</xref>, and Fig. 2 in <xref rid="pone.0110726-Abby1" ref-type="bibr">[4]</xref>).</p>
    <p>It is difficult to estimate <italic>a priori</italic> how accurate MacSyFinder will be for any given biological system because this will depend on several system-specific variables. First, it will depend on the number of components of the system, their frequency in the system and their degree of sequence conservation. Systems with many highly conserved and frequent components will be much easier to identify than systems with many infrequent and fast-evolving components. Second, it will depend on the existence of other systems sharing homologous components. Systems including many components with homologs in other systems will be harder to identify. We have shown MacSyFinder can type CRISPR-Cas systems, even if they share homologs. Hence, even in these difficult situations MacSyFinder provides accurate models. The situation is necessarily more complicated when identifying systems with many homologs encoded by genes scattered in the genomes. In this case, phylogenetic methods may help in the reconstruction of the different systems.</p>
    <p>Considering MacSyFinder's running time, the limiting step is usually the identification of hits by Hmmer, which is currently very efficient <xref rid="pone.0110726-Eddy1" ref-type="bibr">[13]</xref>. To speed up this step, MacSyFinder is able to compute and analyse Hmmer hits in parallel. MacSyFinder and its companion MacSyView are easy to install standalone tools. This is an advantage when it is necessary to keep the data private or when projects are so large that network transfer time is prohibitive. MacSyFinder was built to be simple to use. It is thus ideal for biologists without extensive knowledge of programming or scripting wishing to unravel the diversity of certain systems or to annotate genetic data. Often, bioinformaticians produce methods to identify machineries and would like to easily package them for reproducibility and distribution among biologists. This can be easily done with MacSyFinder <italic>via</italic> the distribution of XML files and the relevant protein profiles. The “Cas-finder” we present here is a particularly relevant case. At the time we started the project, there was public information available on the protein profiles and on the genetic organization of the systems. We only had to define the models and use them in such a way that we could identify the systems and class them. The result is a highly accurate application to identify <italic>cas</italic> operons that can be easily distributed (<xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0110726.s001">
      <label>Figure S1</label>
      <caption>
        <p><bold>Genomic architecture and taxonomic distribution of detected </bold><bold><italic>cas</italic></bold><bold> genes clusters (general model).</bold> A. Distribution of the number of different genes in detected clusters. B. Distribution of the maximal distance between two components observed in each detected cluster. C. Boxplot of the number of different genes in each cluster vs. the maximal distance between two components observed in each cluster. D. Proportion of bacterial and archaeal genomes without (cluster−) and with at least one cluster of <italic>cas</italic> genes (cluster+).</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0110726.s001.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s002">
      <label>Figure S2</label>
      <caption>
        <p><bold>Schematic and simplified representation of the subtype models.</bold> Each box corresponds to a <italic>cas</italic> gene family and the name of the corresponding HMM protein profiles are listed below. Some <italic>cas</italic> gene families have multiple HMM profiles available in the TIGRFAM database. Each <italic>cas</italic> gene family has its boxes filled (subtype non-specific) or surrounded (subtype-specific) by a distinct colour. Only the main <italic>cas</italic> gene families are represented. For full subtype models, see the XML files in <xref ref-type="supplementary-material" rid="pone.0110726.s011">Data S2</xref>.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0110726.s002.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s003">
      <label>Figure S3</label>
      <caption>
        <p><bold>Taxonomic distribution of the three CRISPR-Cas systems types.</bold> For each clade, the number of representative genomes is given, along with bar plots showing the percentage of these genomes containing the three types of CRISPR-Cas systems.</p>
        <p>(EPS)</p>
      </caption>
      <media xlink:href="pone.0110726.s003.eps">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s004">
      <label>Table S1</label>
      <caption>
        <p>
          <bold>List of HMM profiles used for the “Cas-Finder”.</bold>
        </p>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0110726.s004.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s005">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Impact of the co-localization parameter on the detection.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s006">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>Detection results.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s007">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>Validation of the CRISPR-Cas systems detection on systems with </bold>
          <bold>
            <italic>in vivo</italic>
          </bold>
          <bold> effects listed in the review by Bondy-Denomy et. al 2014</bold>
          <xref rid="pone.0110726-BondyDenomy1" ref-type="bibr">[28]</xref>
          <bold>.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s008">
      <label>Text S1</label>
      <caption>
        <p>
          <bold>Supporting text (PDF file).</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s009">
      <label>File S1</label>
      <caption>
        <p>
          <bold>MacSyFinder's documentation file (PDF file).</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0110726.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s010">
      <label>Data S1</label>
      <caption>
        <p>
          <bold>The MacSyFinder/MacSyView package (compressed tarball archive).</bold>
        </p>
        <p>(GZ)</p>
      </caption>
      <media xlink:href="pone.0110726.s010.gz">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0110726.s011">
      <label>Data S2</label>
      <caption>
        <p>
          <bold>The Cas-Finder: models and profiles (compressed tarball archive).</bold>
        </p>
        <p>(ZIP)</p>
      </caption>
      <media xlink:href="pone.0110726.s011.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>Julien Guglielmini and Jean Cury for fruitful discussions.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0110726-Alberts1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Alberts</surname><given-names>B</given-names></name> (<year>1998</year>) <article-title>The cell as a collection of protein machines: preparing the next generation of molecular biologists</article-title>. <source>Cell</source>
<volume>92</volume>: <fpage>291</fpage>–<lpage>294</lpage>.<pub-id pub-id-type="pmid">9476889</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-PereiraLeal1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Pereira-Leal</surname><given-names>JB</given-names></name>, <name><surname>Levy</surname><given-names>ED</given-names></name>, <name><surname>Teichmann</surname><given-names>SA</given-names></name> (<year>2006</year>) <article-title>The origins and evolution of functional modules: lessons from protein complexes</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>
<volume>361</volume>: <fpage>507</fpage>–<lpage>517</lpage>.<pub-id pub-id-type="pmid">16524839</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Michel1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Michel</surname><given-names>B</given-names></name>, <name><surname>Grompone</surname><given-names>G</given-names></name>, <name><surname>Florès</surname><given-names>MJ</given-names></name>, <name><surname>Bidnenko</surname><given-names>V</given-names></name> (<year>2004</year>) <article-title>Multiple pathways process stalled replication forks</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>101</volume>: <fpage>12783</fpage>–<lpage>12788</lpage>.<pub-id pub-id-type="pmid">15328417</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Abby1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Abby</surname><given-names>SS</given-names></name>, <name><surname>Rocha</surname><given-names>EP</given-names></name> (<year>2012</year>) <article-title>The non-flagellar type III secretion system evolved from the bacterial flagellum and diversified into host-cell adapted systems</article-title>. <source>PLoS Genet</source>
<volume>8</volume>: <fpage>e1002983</fpage>.<pub-id pub-id-type="pmid">23028376</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Galagan1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Galagan</surname><given-names>JE</given-names></name>, <name><surname>Nusbaum</surname><given-names>C</given-names></name>, <name><surname>Roy</surname><given-names>A</given-names></name>, <name><surname>Endrizzi</surname><given-names>MG</given-names></name>, <name><surname>Macdonald</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2002</year>) <article-title>The genome of M. acetivorans reveals extensive metabolic and physiological diversity</article-title>. <source>Genome Res</source>
<volume>12</volume>: <fpage>532</fpage>–<lpage>542</lpage>.<pub-id pub-id-type="pmid">11932238</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Huynen1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Huynen</surname><given-names>M</given-names></name>, <name><surname>Snel</surname><given-names>B</given-names></name>, <name><surname>Lathe</surname><given-names>W</given-names><suffix>3rd</suffix></name>, <name><surname>Bork</surname><given-names>P</given-names></name> (<year>2000</year>) <article-title>Predicting protein function by genomic context: quantitative evaluation and qualitative inferences</article-title>. <source>Genome Res</source>
<volume>10</volume>: <fpage>1204</fpage>–<lpage>1210</lpage>.<pub-id pub-id-type="pmid">10958638</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Overbeek1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Overbeek</surname><given-names>R</given-names></name>, <name><surname>Fonstein</surname><given-names>M</given-names></name>, <name><surname>D'Souza</surname><given-names>M</given-names></name>, <name><surname>Pusch</surname><given-names>GD</given-names></name>, <name><surname>Maltsev</surname><given-names>N</given-names></name> (<year>1999</year>) <article-title>The use of gene clusters to infer functional coupling</article-title>. <source>Proc Natl Acad Sci USA</source>
<volume>96</volume>: <fpage>2896</fpage>–<lpage>2901</lpage>.<pub-id pub-id-type="pmid">10077608</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Lathe1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Lathe</surname><given-names>WC</given-names></name>, <name><surname>Snel</surname><given-names>B</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name> (<year>2000</year>) <article-title>Gene context conservation of a higher order than operons</article-title>. <source>Trends Biochem Sci</source>
<volume>25</volume>: <fpage>474</fpage>–<lpage>479</lpage>.<pub-id pub-id-type="pmid">11050428</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Zaslaver1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Zaslaver</surname><given-names>A</given-names></name>, <name><surname>Mayo</surname><given-names>A</given-names></name>, <name><surname>Ronen</surname><given-names>M</given-names></name>, <name><surname>Alon</surname><given-names>U</given-names></name> (<year>2006</year>) <article-title>Optimal gene partition into operons correlates with gene functional order</article-title>. <source>Phys Biol</source>
<volume>3</volume>: <fpage>183</fpage>–<lpage>189</lpage>.<pub-id pub-id-type="pmid">17021382</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Finn1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Finn</surname><given-names>RD</given-names></name>, <name><surname>Tate</surname><given-names>J</given-names></name>, <name><surname>Mistry</surname><given-names>J</given-names></name>, <name><surname>Coggill</surname><given-names>PC</given-names></name>, <name><surname>Sammut</surname><given-names>SJ</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>The Pfam protein families database</article-title>. <source>Nucleic Acids Res</source>
<volume>36</volume>: <fpage>D281</fpage>–<lpage>288</lpage>.<pub-id pub-id-type="pmid">18039703</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Haft1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Loftus</surname><given-names>BJ</given-names></name>, <name><surname>Richardson</surname><given-names>DL</given-names></name>, <name><surname>Yang</surname><given-names>F</given-names></name>, <name><surname>Eisen</surname><given-names>JA</given-names></name>, <etal>et al</etal> (<year>2001</year>) <article-title>TIGRFAMs: a protein family resource for the functional identification of proteins</article-title>. <source>Nucleic Acids Res</source>
<volume>29</volume>: <fpage>41</fpage>–<lpage>43</lpage>.<pub-id pub-id-type="pmid">11125044</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Servant1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Servant</surname><given-names>F</given-names></name>, <name><surname>Bru</surname><given-names>C</given-names></name>, <name><surname>Carrere</surname><given-names>S</given-names></name>, <name><surname>Courcelle</surname><given-names>E</given-names></name>, <name><surname>Gouzy</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2002</year>) <article-title>ProDom: automated clustering of homologous domains</article-title>. <source>Brief Bioinform</source>
<volume>3</volume>: <fpage>246</fpage>–<lpage>251</lpage>.<pub-id pub-id-type="pmid">12230033</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Eddy1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Eddy</surname><given-names>SR</given-names></name> (<year>2011</year>) <article-title>Accelerated Profile HMM Searches</article-title>. <source>PLoS Comput Biol</source>
<volume>7</volume>: <fpage>e1002195</fpage>.<pub-id pub-id-type="pmid">22039361</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Barrangou1">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Barrangou</surname><given-names>R</given-names></name>, <name><surname>Marraffini</surname><given-names>LA</given-names></name> (<year>2014</year>) <article-title>CRISPR-Cas systems: Prokaryotes upgrade to adaptive immunity</article-title>. <source>Mol Cell</source>
<volume>54</volume>: <fpage>234</fpage>–<lpage>244</lpage>.<pub-id pub-id-type="pmid">24766887</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Hsu1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Hsu</surname><given-names>PD</given-names></name>, <name><surname>Lander</surname><given-names>ES</given-names></name>, <name><surname>Zhang</surname><given-names>F</given-names></name> (<year>2014</year>) <article-title>Development and Applications of CRISPR-Cas9 for Genome Engineering</article-title>. <source>Cell</source>
<volume>157</volume>: <fpage>1262</fpage>–<lpage>1278</lpage>.<pub-id pub-id-type="pmid">24906146</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Barrangou2">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Barrangou</surname><given-names>R</given-names></name> (<year>2014</year>) <article-title>RNA events. Cas9 targeting and the CRISPR revolution</article-title>. <source>Science</source>
<volume>344</volume>: <fpage>707</fpage>–<lpage>708</lpage>.<pub-id pub-id-type="pmid">24833384</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Bland1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Bland</surname><given-names>C</given-names></name>, <name><surname>Ramsey</surname><given-names>TL</given-names></name>, <name><surname>Sabree</surname><given-names>F</given-names></name>, <name><surname>Lowe</surname><given-names>M</given-names></name>, <name><surname>Brown</surname><given-names>K</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>CRISPR recognition tool (CRT): a tool for automatic detection of clustered regularly interspaced palindromic repeats</article-title>. <source>BMC Bioinformatics</source>
<volume>8</volume>: <fpage>209</fpage>.<pub-id pub-id-type="pmid">17577412</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Grissa1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Grissa</surname><given-names>I</given-names></name>, <name><surname>Vergnaud</surname><given-names>G</given-names></name>, <name><surname>Pourcel</surname><given-names>C</given-names></name> (<year>2007</year>) <article-title>CRISPRFinder: a web tool to identify clustered regularly interspaced short palindromic repeats</article-title>. <source>Nucleic Acids Res</source>
<volume>35</volume>: <fpage>W52</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">17537822</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Edgar1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>RC</given-names></name> (<year>2007</year>) PILER-CR: fast and accurate identification of CRISPR repeats. <article-title>BMC Bioinformatics</article-title>. <volume>8</volume>: <fpage>18</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0110726-NCBI1">
      <label>20</label>
      <mixed-citation publication-type="other">NCBI {BLAST} executables download website (includes makeblastdb). Available: <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.ncbi.nih.gov/blast/executables/LATEST/">ftp://ftp.ncbi.nih.gov/blast/executables/LATEST/</ext-link>. Accessed 2014 Sep 28.</mixed-citation>
    </ref>
    <ref id="pone.0110726-Camacho1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Camacho</surname><given-names>C</given-names></name>, <name><surname>Coulouris</surname><given-names>G</given-names></name>, <name><surname>Avagyan</surname><given-names>V</given-names></name>, <name><surname>Ma</surname><given-names>N</given-names></name>, <name><surname>Papadopoulos</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>BLAST+: architecture and applications</article-title>. <source>BMC Bioinformatics</source>
<volume>10</volume>: <fpage>421</fpage>.<pub-id pub-id-type="pmid">20003500</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Eddy2">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Eddy</surname><given-names>SR</given-names></name> (<year>1998</year>) <article-title>Profile hidden Markov models</article-title>. <source>Bioinformatics</source>
<volume>14</volume>: <fpage>755</fpage>–<lpage>763</lpage>.<pub-id pub-id-type="pmid">9918945</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Haft2">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Selengut</surname><given-names>JD</given-names></name>, <name><surname>Richter</surname><given-names>RA</given-names></name>, <name><surname>Harkins</surname><given-names>D</given-names></name>, <name><surname>Basu</surname><given-names>MK</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>TIGRFAMs and Genome Properties in 2013</article-title>. <source>Nucleic Acids Res</source>
<volume>41</volume>: <fpage>D387</fpage>–<lpage>395</lpage>.<pub-id pub-id-type="pmid">23197656</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Haft3">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Selengut</surname><given-names>J</given-names></name>, <name><surname>Mongodin</surname><given-names>EF</given-names></name>, <name><surname>Nelson</surname><given-names>KE</given-names></name> (<year>2005</year>) <article-title>A guild of 45 CRISPR-associated (Cas) protein families and multiple CRISPR/Cas subtypes exist in prokaryotic genomes</article-title>. <source>PLoS Comput Biol</source>
<volume>1</volume>: <fpage>e60</fpage>.<pub-id pub-id-type="pmid">16292354</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Makarova1">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Makarova</surname><given-names>KS</given-names></name>, <name><surname>Haft</surname><given-names>DH</given-names></name>, <name><surname>Barrangou</surname><given-names>R</given-names></name>, <name><surname>Brouns</surname><given-names>SJ</given-names></name>, <name><surname>Charpentier</surname><given-names>E</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Evolution and classification of the CRISPR-Cas systems</article-title>. <source>Nat Rev Microbiol</source>
<volume>9</volume>: <fpage>467</fpage>–<lpage>477</lpage>.<pub-id pub-id-type="pmid">21552286</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-Staals1">
      <label>26</label>
      <mixed-citation publication-type="other">Staals RHJ, Brouns SJJ (2013) Distribution and Mechanism of the Type I CRISPR-Cas Systems. In: Barrangou R, Oost Jvd, editors. CRISPR-Cas Systems - RNA-mediated Adaptive Immunity in Bacteria and Archaea. Berlin Heidelberg: Springer Berlin Heidelberg.</mixed-citation>
    </ref>
    <ref id="pone.0110726-Touchon1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Touchon</surname><given-names>M</given-names></name>, <name><surname>Rocha</surname><given-names>EP</given-names></name> (<year>2010</year>) <article-title>The small, slow and specialized CRISPR and anti-CRISPR of Escherichia and Salmonella</article-title>. <source>PLoS ONE</source>
<volume>5</volume>: <fpage>e11126</fpage>.<pub-id pub-id-type="pmid">20559554</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0110726-BondyDenomy1">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Bondy-Denomy</surname><given-names>J</given-names></name>, <name><surname>Davidson</surname><given-names>AR</given-names></name> (<year>2014</year>) <article-title>To acquire or resist: the complex biological effects of CRISPR-Cas systems</article-title>. <source>Trends Microbiol</source>
<volume>22</volume>: <fpage>218</fpage>–<lpage>225</lpage>.<pub-id pub-id-type="pmid">24582529</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
