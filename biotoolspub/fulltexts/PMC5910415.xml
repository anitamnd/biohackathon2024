<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5910415</article-id>
    <article-id pub-id-type="pmid">29679054</article-id>
    <article-id pub-id-type="publisher-id">3975</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-018-03975-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Quantitative diffusion measurements using the open-source software PyFRAP</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bläßle</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Soh</surname>
          <given-names>Gary</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Braun</surname>
          <given-names>Theresa</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mörsdorf</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Preiß</surname>
          <given-names>Hannes</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jordan</surname>
          <given-names>Ben M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Müller</surname>
          <given-names>Patrick</given-names>
        </name>
        <address>
          <email>patrick.mueller@tuebingen.mpg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0492 0357</institution-id><institution-id institution-id-type="GRID">grid.418026.9</institution-id><institution>Friedrich Miescher Laboratory of the Max Planck Society, </institution></institution-wrap>Max-Planck-Ring 9, 72076 Tübingen, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution>Department of Organismic and Evolutionary Biology, </institution><institution>Harvard University, </institution></institution-wrap>26 Oxford Street, Cambridge, MA 02138 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0658 7699</institution-id><institution-id institution-id-type="GRID">grid.9811.1</institution-id><institution>Present Address: University of Konstanz, </institution></institution-wrap>Universitätsstraße 10, 78457 Konstanz, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>4</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>1582</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>9</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>3</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Fluorescence Recovery After Photobleaching (FRAP) and inverse FRAP (iFRAP) assays can be used to assess the mobility of fluorescent molecules. These assays measure diffusion by monitoring the return of fluorescence in bleached regions (FRAP), or the dissipation of fluorescence from photoconverted regions (iFRAP). However, current FRAP/iFRAP analysis methods suffer from simplified assumptions about sample geometry, bleaching/photoconversion inhomogeneities, and the underlying reaction-diffusion kinetics. To address these shortcomings, we developed the software PyFRAP, which fits numerical simulations of three-dimensional models to FRAP/iFRAP data and accounts for bleaching/photoconversion inhomogeneities. Using PyFRAP we determined the diffusivities of fluorescent molecules spanning two orders of magnitude in molecular weight. We measured the tortuous effects that cell-like obstacles exert on effective diffusivity and show that reaction kinetics can be accounted for by model selection. These applications demonstrate the utility of PyFRAP, which can be widely adapted as a new extensible standard for FRAP analysis.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">FRAP analysis often relies on simplified assumptions that can affect measurement accuracy. Here the authors present a Python-based FRAP analysis software using simulations instead of simplified theoretical models to fit the data, which accounts for complex sample geometries and bleach conditions.</p>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">The diffusion of molecules is important for almost any process across all scales of biological organisation, from transcription factors finding their targets on DNA to signalling molecules spreading through tissues during development and homoeostasis<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. The biological function of a molecule is affected by its action range and therefore its mobility; however, effective diffusion of molecules moving through complex tissues is difficult to measure quantitatively. More than 40 years ago, Poo &amp; Cone<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> and Liebman &amp; Entine<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> developed a method to assess the diffusivities of fluorescent molecules. In these fluorescence recovery after photobleaching (FRAP) experiments, the fluorescence of molecules in a small region of the sample is bleached by exposure to a strong laser pulse<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. The dynamics of fluorescence recovery in the bleached region can then be used to infer the mobility of the fluorescent molecules (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Inverted FRAP (iFRAP) assays have recently been developed as an extension of FRAP experiments<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR10">10</xref></sup>, which eliminate the often harsh bleaching conditions used in FRAP experiments. iFRAP assays utilise photoconvertible molecules that can be induced to alter their fluorescence excitation/emission properties after exposure to ‘photoconverting’ light. In iFRAP experiments, the spread of signal from a small photoconverted domain into the neighbouring regions of the sample is monitored over time and thus represents an experimental mirror image of FRAP (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b).<fig id="Fig1"><label>Fig. 1</label><caption><p>Fluorescence perturbation techniques used for effective diffusion measurements, and drawbacks of current analysis methods. <bold>a</bold> In fluorecence recovery after photobleaching (FRAP) experiments, a small region in the sample is bleached. After bleaching, the diffusion-driven recovery in the bleached region is monitored. <bold>b</bold> Inverse FRAP (iFRAP) is an experimental mirror image of FRAP: Molecules in a given region are photoconverted and then spread throughout the sample, resulting in the loss of fluorescent signal in the region of photoconversion. <bold>c</bold> Drawbacks of current analysis methods exemplified with zebrafish development at late blastula stages. Current analysis methods simplify sample geometry, idealise bleaching profiles, or ignore underlying reaction kinetics. <bold>d</bold>–<bold>f</bold> Possible relative error in diffusion coefficient estimates that can occur if false assumptions are made about sample geometry (<bold>d</bold>), bleaching conditions (<bold>e</bold>), or reaction kinetics (<bold>f</bold>), respectively. The maximum displayed error was capped to a value of 200%, but can be up to 1000%</p></caption><graphic xlink:href="41467_2018_3975_Fig1_HTML" id="d29e334"/></fig></p>
    <p id="Par4">Diffusion coefficients are commonly extracted from FRAP experiments by fitting analytical solutions computed from theoretical models to the measured recovery curves<sup><xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR18">18</xref></sup>, and a few simulation-based analysis methods have been developed<sup><xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR21">21</xref></sup>. Although this allows for a rapid assessment of qualitative mobility differences in identical experimental settings, current approaches rely on several assumptions that can affect the accuracy of the analysis. First, most current methods reduce the FRAP analysis to one-dimensional or two-dimensional simplifications<sup><xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR21">21</xref></sup>, often assuming that the fluorescent pool is infinitely large<sup><xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup>, or ignoring more complex geometries of biological samples that could play important roles in molecule movement (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Recent studies have argued that geometry is crucial for dynamic biological processes<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup>, and must be taken into account for accurate analysis of FRAP data. Indeed, false assumptions about the FRAP sample geometry can drastically affect diffusion coefficient estimates (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>).</p>
    <p id="Par5">Second, the bleaching process in FRAP experiments is often inaccurately modelled. Bleaching is posited to be homogeneous or to follow a Gaussian distribution throughout bleached circular or rectangular regions, while the molecules outside of the bleached region are assumed to remain unbleached<sup><xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref></sup>. However, molecules diffusing during the bleaching process can create inhomogeneities both inside and outside of the bleached region; moreover, a delay between bleaching and the start of the recovery measurement can lead to further inhomogeneities (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Incorrect assumptions about the bleaching process can thus lead to a severe misestimation of diffusion coefficients<sup><xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR27">27</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1e</xref>).</p>
    <p id="Par6">Third, in vivo FRAP experiments can be strongly influenced by reaction kinetics such as production or degradation of fluorescent molecules, which can contribute to the observed recovery curve (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). However, this is mostly neglected in classical FRAP analysis models and can lead to erroneous diffusion estimates (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>)<sup><xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR17">17</xref></sup>.</p>
    <p id="Par7">To address these shortcomings, we developed the versatile Python-based FRAP analysis software PyFRAP (available at <ext-link ext-link-type="uri" xlink:href="https://mueller-lab.github.io/PyFRAP">https://mueller-lab.github.io/PyFRAP</ext-link>). To facilitate data analysis, PyFRAP is equipped with an intuitive graphical user interface (GUI, Fig. <xref rid="Fig2" ref-type="fig">2a</xref>), which gives users without a computational background access to a sophisticated FRAP data analysis work flow from image analysis to statistical model comparison methods (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>). PyFRAP applies the first post-bleach image as initial condition (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>), and numerically simulates the FRAP experiment in realistic two-dimensional or three-dimensional experiment geometries (Fig. <xref rid="Fig2" ref-type="fig">2d, e</xref>); the solution from this simulation is then fitted to the experimental data. Furthermore, PyFRAP can accurately account for both uniform production and degradation during FRAP experiments. PyFRAP saves all analysed data and settings in a logical data structure that can be shared with collaborators or re-used for later analyses (Fig. <xref rid="Fig2" ref-type="fig">2f</xref>). The software is freely available, and the open-source environment allows for rapid expansion through collaborative work<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> to adjust analysis methods to the users’ needs.<fig id="Fig2"><label>Fig. 2</label><caption><p>The PyFRAP software package. <bold>a</bold> Annotated snapshot of the PyFRAP main GUI with project navigation tree (red), plot tabs (green), object property display (orange), and integrated Python terminal (blue). <bold>b</bold> PyFRAP work flow. <bold>c</bold> PyFRAP’s interpolation of the first post-bleach image as initial condition for FRAP simulations. The length of the white scale bar represents 100 μm. <bold>d</bold>,<bold> e</bold> Spatial discretisation of geometries resembling <bold>d</bold> a frustum and <bold>e</bold> a zebrafish embryo at late blastula stages (dome stage). <bold>f</bold> PyFRAP’s data structure</p></caption><graphic xlink:href="41467_2018_3975_Fig2_HTML" id="d29e491"/></fig></p>
    <p id="Par8">To demonstrate the utility of PyFRAP, we conducted several typical in vitro and in vivo FRAP experiments (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). PyFRAP accurately determines the diffusion coefficients of fluorescent molecules ranging from 3 to 500 kDa in both artificial and biological contexts. In contrast to currently available software, PyFRAP’s flexible initial conditions also allow analysis of iFRAP experiments, producing results comparable to FRAP. We used PyFRAP to measure the influence that obstacles such as cells exert on the movement of diffusing molecules, and found that such geometric hindrance decreases diffusivity by about one-third. Moreover, PyFRAP provides accurate modelling of reaction kinetics, including production and degradation. Finally, to test the impact of extracellular binding on protein diffusivity, we measured the diffusion of signalling molecules in living zebrafish embryos. We found that the effective diffusivity of a signalling molecule in developing zebrafish was reduced to about one-tenth of its predicted value, in agreement with hindered diffusion models postulating interactions of embryonic signals with diffusion regulators<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>. Altogether, our analyses highlight how detailed examination of FRAP data can be used to determine the contribution of individual factors to the movement of molecules in controlled artificial and biological contexts<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>PyFRAP is a versatile FRAP/iFRAP analysis package</title>
      <p id="Par9">Current FRAP analysis methods often make simplified assumptions about FRAP experimental conditions to aid in the derivation of analytical solutions<sup><xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR18">18</xref></sup>, and to facilitate numerical simulations<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>. Such assumptions include reducing complex sample geometries to lower dimensions, idealising the initial bleaching profile, or ignoring additional reaction kinetics potentially underlying fluorescence recovery (Fig. <xref rid="Fig1" ref-type="fig">1c</xref>). Unless the experiment is well approximated by these assumptions (e.g., simple geometry, small bleach spot compared to a large sample volume, sharp bleach profile, no reactions), this can lead to erroneous diffusion estimates (Fig. <xref rid="Fig1" ref-type="fig">1d–f</xref>). To address these shortcomings, we developed PyFRAP. PyFRAP numerically simulates FRAP experiments in realistic three-dimensional geometries using an interpolation of the first post-bleach image as initial condition. This simulation is then fitted to the experimental data, incorporating reaction kinetics such as uniform production and degradation.</p>
      <p id="Par10">PyFRAP is an open-source Python-based FRAP analysis software that runs on the major operating systems Microsoft Windows, Mac OSX and Linux. Over the past 20 years, Python has become the standard programming language for scientific research because of the availability of versatile add-on packages and its intuitive and simple syntax<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. Building on the resourcefulness of Python, PyFRAP is based on commonly used packages such as PyQT, SciPy and FiPy<sup><xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR36">36</xref></sup>. PyFRAP comes with an intuitive graphical user interface (GUI, Fig. <xref rid="Fig2" ref-type="fig">2a</xref>) and a fully documented application programming interface (API) allowing quick development of scripts or modifications of the PyFRAP code. PyFRAP’s functionalities include sophisticated image processing functions useful for FRAP analysis, customisable geometry and analysis region definitions, a finite element partial differential equation (PDE) solver that simulates FRAP/iFRAP experiments with adjustable options, statistical tools for averaging and model comparison, and multiple plotting and input/output functions (see Methods section and Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref> for details). To make the software easily accessible, dialogue boxes (software wizards) guide the user step-by-step through data import, image analysis, simulation and fitting.</p>
      <p id="Par11">We programmed PyFRAP to import image data from most common microscope formats, such as .tif, .lsm and .czi. Users can define arbitrary regions of interests (ROIs) that are then used for image analysis, simulation and fitting (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2a</xref>). For some experimental setups, the imaged sample might be larger than the field of view. In these cases, the concentration of molecules in regions outside of the image can be estimated from selected areas in the first image of the recovery image series (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2b</xref>). Uneven illumination is a common artefact in FRAP experiments. PyFRAP can correct this artefact by normalisation using pre-bleach images or using a correction matrix computed from a secondary data set generated with a homogeneously distributed fluorophore<sup><xref ref-type="bibr" rid="CR37">37</xref>–<xref ref-type="bibr" rid="CR39">39</xref></sup> (see Methods section and Supplementary Fig. <xref rid="MOESM1" ref-type="media">2c</xref> for details). To avoid numerical instabilities, PyFRAP allows the user to smooth or denoise the image data using a Gaussian or median filter (see Methods section, Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>, and Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref> for details).</p>
      <p id="Par12">FRAP and iFRAP experiments have been performed in a variety of contexts, from the cigar-shaped <italic>Drosophila</italic> embryo and the relatively flat <italic>Drosophila</italic> wing disc to the dome-shaped pre-gastrula stage zebrafish embryo<sup><xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR42">42</xref></sup>. These structures have distinct geometries that could impact fluorescence recovery. In fact, we found that simplifying the three-dimensional zebrafish embryo to a two-dimensional disc can frequently lead up to a &gt;200% error in estimated diffusion coefficients (Fig. <xref rid="Fig1" ref-type="fig">1d</xref>). In PyFRAP, users can define arbitrary two-dimensional and three-dimensional geometries using Gmsh<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> or CAD STereoLithography (.stl) files that are then spatially discretised into tetrahedral meshes by Gmsh in combination with TetGen<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. PyFRAP provides various meshing options, such as local mesh refinements, boundary layer meshes and attractor meshes, allowing users to adapt the mesh to experimental details (see Fig. <xref rid="Fig2" ref-type="fig">2d, e</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">4c</xref> for example geometries and meshes).</p>
      <p id="Par13">In current FRAP analysis methods, the initial condition of the FRAP experiment is often simplified to a simple rectangular function or a Gaussian profile to approximate sharp or blurred bleach boundaries, respectively<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR45">45</xref>–<xref ref-type="bibr" rid="CR47">47</xref></sup>. However, light scattering, imperfect bleaching and diffusion during the bleaching process can lead to more complex bleaching profiles and thus need to be considered during FRAP analysis to avoid misestimation of diffusion coefficients<sup><xref ref-type="bibr" rid="CR24">24</xref>,<xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR30">30</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup>. To overcome this issue, PyFRAP uses a bilinear interpolation between pixels of the first post-bleach image to estimate the initial condition for mesh cells. This initial condition closely resembles initial experimental bleaching profiles and concentration distributions (Fig. <xref rid="Fig2" ref-type="fig">2c</xref>). Moreover, in contrast to most current FRAP analysis methods<sup><xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR46">46</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup>, PyFRAP does not fit a mathematical expression based on simplified assumptions to the data; instead, PyFRAP uses FiPy<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> to simulate the experiment numerically, resulting in a solution that incorporates the realistic three-dimensional geometry and initial conditions. The numerical simulation is then fitted to the FRAP data by minimising the sum of squared differences using classical optimisation algorithms<sup><xref ref-type="bibr" rid="CR49">49</xref>–<xref ref-type="bibr" rid="CR51">51</xref></sup> (see Methods section for details).</p>
      <p id="Par14">In typical FRAP and iFRAP experiments, a protein of interest is tagged with a fluorescent protein and expressed within a tissue. In such an experiment, the fusion protein is often actively produced at the same time that FRAP is carried out; additionally, fusion proteins undergo degradation over time. Depending on how the fusion protein is expressed (promoter-driven expression, mRNA injection, etc.), its degradation kinetics, and the timescale of the FRAP/iFRAP experiment, production and degradation can dramatically influence recovery curves. Ignoring reaction kinetics in FRAP experiments could therefore lead to erroneous diffusion coefficient estimates. Indeed, recovery curves with pure diffusion fitted to a simulated reaction-dominant data set often resulted in a &gt;200% error in the estimated diffusion coefficients (Fig. <xref rid="Fig1" ref-type="fig">1f</xref>). To ensure that the appropriate reaction kinetics are considered when analysing FRAP data, PyFRAP is equipped with four models: (1) Pure diffusion, (2) diffusion with production, (3) diffusion with degradation and (4) diffusion with production and degradation (see Methods section for details). The model can be constrained with previous reaction rate measurements from assays such as fluorescence decay after photoconversion (FDAP)<sup><xref ref-type="bibr" rid="CR52">52</xref>,<xref ref-type="bibr" rid="CR53">53</xref></sup>; alternatively, production and degradation rates can be directly obtained from fitting the FRAP data. Below, we discuss methods to determine which approaches are most appropriate for a given data set.</p>
      <p id="Par15">An advantage of PyFRAP is its ability to assess FRAP data using multiple models of varying complexity, from pure diffusion to combined reaction-diffusion kinetics. However, determining which model is appropriate for a given data set can be challenging. Choosing the incorrect model can lead to overfitting and potentially false diffusion coefficients<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. The Akaike information criterion (AIC) is a statistical tool that can aid in model selection<sup><xref ref-type="bibr" rid="CR55">55</xref></sup>. PyFRAP’s implementation of the AIC allows users to compare the models mentioned above and determines the most likely model based on a relative weighted measure that includes both the model’s log-likelihood and its degrees of freedom, i.e., the number of model parameters. Moreover, PyFRAP provides several statistical tests (Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>) to assess differences between measurements and obtained fits, such as Student’s <italic>t</italic>-test<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> for normally distributed data or the Mann–Whitney-U-test<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>, which does not require normally distributed data. The Shapiro–Wilk-test can be used to assess whether the measured diffusivities follow a normal distribution<sup><xref ref-type="bibr" rid="CR58">58</xref></sup> and whether application of Student’s <italic>t</italic>-test or the Mann–Whitney-U-test is justified.</p>
      <p id="Par16">PyFRAP’s object-oriented data structure (Fig. <xref rid="Fig2" ref-type="fig">2f</xref>) can be saved into serialised objects and easily loaded for further analysis or shared with collaborators. In addition, PyFRAP lets users visualise every aspect of PyFRAP’s analysis work flow and save plots and images into publication-ready figures.</p>
    </sec>
    <sec id="Sec4">
      <title>Benchmarking PyFRAP</title>
      <p id="Par17">To validate PyFRAP, we first determined whether it can recover true diffusion coefficients and reaction kinetics from simulated data. We used our previous in-house solution<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR42">42</xref></sup> based on the commercial programs MATLAB and COMSOL multiphysics to simulate 24 FRAP experiments with different reaction kinetics and diffusion coefficients. Using PyFRAP, the simulated data sets were fitted with all four possible reaction-diffusion models (see above). We determined a maximal error of 10% (average error: 2%, Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>) between simulated and estimated diffusion coefficients, demonstrating that PyFRAP recovers correct diffusion coefficients within the error tolerance of the numerical simulations.</p>
      <p id="Par18">Next, we tested whether PyFRAP’s implementation of the AIC allows identification of the models used to create the simulated data. When the data were simulated with models describing either pure diffusion, diffusion and degradation, or diffusion and production, the AIC predicted the correct underlying model (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>). However, the model selection based on the AIC did not favour the correct model for data sets that included diffusion combined with both production and degradation, since models with fewer degrees of freedom provided smaller Akaike weight values. Simulations involving diffusion, production and degradation can generate data effectively indistinguishable from data simulated with only diffusion and production or diffusion and degradation, explaining why the AIC cannot predict the correct model in this case.</p>
      <p id="Par19">To assess PyFRAP’s performance in comparison with other available software packages based on analytical<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR46">46</xref>,<xref ref-type="bibr" rid="CR47">47</xref>,<xref ref-type="bibr" rid="CR59">59</xref></sup> or numerical<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref>,<xref ref-type="bibr" rid="CR60">60</xref></sup> approaches (Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>), we used easyFRAP<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, Virtual FRAP<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, FrapCalc<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, simFRAP<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and PyFRAP itself to analyse simulated FRAP experiments (Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref>, Fig. <xref rid="Fig3" ref-type="fig">3</xref>). We simulated 18 experiments in which geometry, relative bleach window size, and diffusion coefficients differed. Simulations were conducted either in a simple circular two-dimensional domain or a complex three-dimensional zebrafish embryo-like geometry (Fig. <xref rid="Fig2" ref-type="fig">2e</xref>). FrapCalc and easyFRAP assume circular bleach windows<sup><xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR46">46</xref>,<xref ref-type="bibr" rid="CR47">47</xref></sup>; to facilitate comparison, we therefore simulated FRAP experiments with circular bleach windows. Bleach window sizes comprised 5, 10 or 50% of the slice diameter, representing different proportions between fluorescent and bleached pools (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). Simulations were performed with three biologically relevant diffusion coefficients: 10, 50 and 200 μm<sup>2</sup>/s.<fig id="Fig3"><label>Fig. 3</label><caption><p>PyFRAP benchmarking simulation experiment. <bold>a</bold> Workflow of PyFRAP benchmarking. <bold>b</bold> Examples of simulated data sets for different bleach spot sizes and geometries. <bold>c</bold> Benchmarking results of PyFRAP against currently available software packages using simulated FRAP experiments. Simulation experiments varied in bleached region size, diffusion coefficient and experiment geometry. All diffusion coefficients and estimates are given in units of μm<sup>2</sup>/s. n.a. indicates that the software was not able to fit the simulated data. Colours indicate relative estimation error in %. Diffusion coefficients determined by easyFRAP (asterisk) were computed in combination with an equation providing a relationship between recovery rate, bleached domain size and diffusivity<sup><xref ref-type="bibr" rid="CR45">45</xref></sup></p></caption><graphic xlink:href="41467_2018_3975_Fig3_HTML" id="d29e856"/></fig></p>
      <p id="Par20">Simulation-based programs (PyFRAP, virtualFRAP and simFRAP) generally provided better results than analytical solutions (easyFRAP and FrapCalc): FrapCalc and easyFRAP were either unable to determine diffusion coefficients, or provided diffusivities that were off by at least 20% for most experiments (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>). Fast recovery dynamics were challenging for all tested software. One reason for this is that fewer data points were recorded during the actual recovery process of highly diffusive molecules due to a fixed frame rate of 1 frame/s in the simulated test data sets, leading to larger errors; moreover, for fast recovery dynamics errors from interpolating simulations onto images are more severe. The analytical software packages provided better results for the two-dimensional compared to three-dimensional geometries, while simulation-based approaches showed no clear trend regarding geometry. In terms of bleach window radius, the analytical solutions performed worst if the window diameter was 50% of the slice diameter. This effect might be due to the assumption of an infinite pool of fluorescent molecules outside of the bleached region<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>—when the bleach window is very large, the pool of unbleached fluorescent molecules is small, which conflicts with the assumption of an infinite pool. In contrast, PyFRAP outperformed all current software packages and exhibited the smallest error between predicted and simulated diffusion coefficients (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>Applications of PyFRAP to measure diffusion hindrance</title>
      <p id="Par21">In vivo, it is thought that the overall movement of molecules is affected by binding interactions and by the presence of obstacles such as cells, resulting in a reduced effective diffusion coefficient of secreted proteins that move through tissues<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. However, the effects of these interactions have not been rigorously tested experimentally. We therefore employed PyFRAP to examine the effects of obstacles and binding partners on the effective diffusivity of dextrans and proteins in experimentally controlled in vitro geometries and in living zebrafish embryos.</p>
      <p id="Par22">First, we measured diffusion coefficients of a wide range of differently sized molecules (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>) in a simple in vitro context in the absence of binding partners or obstacles. We performed FRAP experiments with different bleach geometries using fluorophore-coupled dextrans ranging from 3 to 500 kDa in molecular weight (Fig. <xref rid="Fig4" ref-type="fig">4a–d</xref>, Supplementary Figs. <xref rid="MOESM1" ref-type="media">5</xref> and <xref rid="MOESM1" ref-type="media">6</xref>), and compared the results with theoretical predictions and literature values. Fluorescence recovery in these in vitro experiments should be purely defined by diffusion, and the theoretical diffusivities <italic>D</italic> of spherical molecules can be calculated from their radii <italic>r</italic> based on the relationship <italic>D</italic> ~ 1/<italic>r</italic> as postulated by the Einstein–Stokes equation (Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>). The diffusion coefficients determined by PyFRAP were in good agreement with literature values and theoretical predictions (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>, Supplementary Tables <xref rid="MOESM1" ref-type="media">6</xref> and <xref rid="MOESM1" ref-type="media">7</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><p>Examples of in vitro FRAP and iFRAP experiments and the resulting fits to measure free diffusion. <bold>a</bold>, <bold>c</bold>, <bold>e</bold>, <bold>g</bold>, <bold>i</bold> In vitro FRAP and iFRAP experiment images and <bold>b</bold>,<bold> d</bold>,<bold> f</bold>,<bold> h</bold>, <bold>j</bold> fits with PyFRAP. Black and grey dots represent data points of bleached and slice ROI, respectively. Red solid and dashed lines show the respective fits. <bold>a</bold>–<bold>d</bold> FRAP experiments with 3 and 70 kDa fluorescent dextrans (see Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref> for the full data set with fluorescent dextrans between 3 and 500 kDa). <bold>e</bold>–<bold>h</bold> iFRAP experiment with photoconverted Dendra2 protein showing data for the green (<bold>e</bold>,<bold> f</bold>) and the red (<bold>g</bold>,<bold> h</bold>) channel. <bold>i</bold>, <bold>j</bold> FRAP experiment with 70 kDa fluorescent dextran in the presence of polyacrylamide beads. Recovery curves were normalised between 0 (intensity in the bleached ROI at the first post-bleach time point) and 1 (intensity in the bleached ROI at the last post-bleach time point) to allow comparison across data sets. The length of the white scale bar in <bold>a</bold> represents 100 μm, and all images were acquired with the same magnification</p></caption><graphic xlink:href="41467_2018_3975_Fig4_HTML" id="d29e995"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Effective diffusion coefficients determined by PyFRAP. <bold>a</bold> Results of in vitro experiments and PyFRAP analysis for freely diffusing fluorescent dextrans of different molecular weights. Black markers indicate literature values for fluorescent dextrans, red markers the mean effective diffusion estimates obtained by in vitro experiments and PyFRAP analysis, and grey markers the theoretical estimates derived from the Einstein-Stokes equation (see Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>). Red error bars show the standard deviation of PyFRAP’s effective diffusion estimates, and black error bars show the standard deviation of the literature values listed in Supplementary Table <xref rid="MOESM1" ref-type="media">7</xref>. The grey line represents a linear regression fit to the theoretical values. <bold>b</bold> Results of FRAP/iFRAP experiments for the photoconvertible protein Dendra2. <bold>c</bold> Results of simulations investigating the influence of tortuosity on effective diffusion for differently packed bead experiments. Grey and black markers indicate 2D and 3D simulation results, respectively. <bold>d</bold> Results of fluorescent dextran experiments demonstrating the impact of tortuosity on effective diffusivities. <bold>e</bold> Results of GFP experiments to analyse the impact of tortuosity, embryonic extracelluar environment, protein production, and extracellular binding on effective diffusion estimates. Box plots in <bold>b</bold>,<bold> d</bold>,<bold> e</bold> show median (orange line), mean (black horizontal line inside box), 25% quantiles (box), and all included data points (red markers). Whiskers extend to the smallest data point within the 1.5 interquartile range of the lower quartile, and to the largest data point within the 1.5 interquartile range of the upper quartile</p></caption><graphic xlink:href="41467_2018_3975_Fig5_HTML" id="d29e1035"/></fig></p>
      <p id="Par23">A variant of FRAP that allows exclusion of reaction kinetics, such as production, and thus decrease the number of unknown experimental parameters is iFRAP (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). To perform in vitro iFRAP experiments, we used the green-to-red photoconvertible protein Dendra2<sup><xref ref-type="bibr" rid="CR61">61</xref></sup>. Since photoconverting Dendra2 from green to red can also be interpreted as bleaching the original green fluorescence, measuring unconverted and converted protein distributions produces both FRAP and iFRAP experiments at the same time. To test whether PyFRAP correctly analyses iFRAP data, we used the experimental FRAP and iFRAP sets independently and assessed whether the obtained diffusion values are equal (Fig. <xref rid="Fig4" ref-type="fig">4e–h</xref>). Using FRAP we measured a Dendra2 diffusivity of 52.9 ± 5.2 (standard deviation) μm<sup>2</sup>/s, and using iFRAP we obtained a similar value of 53.3 ± 3.1 μm<sup>2</sup>/s (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>, average difference between the two diffusivities per data set: 2.6 ± 1.5 μm<sup>2</sup>/s).</p>
      <p id="Par24">Next, we examined the effect of tortuosity on diffusion. In biological samples, the path length that molecules take increases as they move around obstacles such as cells. The effect of this tortuous movement can be described by the diffusion hindrance factor (also known as diffusion permeability<sup><xref ref-type="bibr" rid="CR62">62</xref></sup>) <italic>θ</italic> = 1/<italic>λ</italic><sup>2</sup> = <italic>D</italic><sup>*</sup>/<italic>D</italic>, where <italic>λ</italic> is the tortuosity, <italic>D</italic><sup>*</sup> is the effective diffusion coefficient (with obstacles), and <italic>D</italic> is the free diffusion coefficient (without obstacles). To assess the expected magnitude of tortuosity on altering effective diffusivity, we first performed numerical simulations of FRAP experiments with and without radial obstacles in two- and three-dimensional geometries. Radial obstacles were either placed regularly, randomly, or following a nearly-ideal packing scheme, resulting in an extracellular volume fraction (EVF, i.e., the space available for molecules to diffuse) ranging from 78% down to 25% (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>). These simulations demonstrated that recovery rates are slowed down as the EVF decreases (Fig. <xref rid="Fig5" ref-type="fig">5c</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">8</xref>). If the geometry is two-dimensional, an EVF of 25% results in an expected reduction in effective diffusivity of approximately 66%. In three-dimensional simulation experiments, we obtained a reduction of effective diffusion coefficients by 40% when the EVF was decreased to 38% (Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>).</p>
      <p id="Par25">To determine whether the presence of obstacles decreases effective diffusivity as predicted by our simulations, we performed FRAP assays in vitro with a fluorescein-coupled 70 kDa dextran (Fig. <xref rid="Fig4" ref-type="fig">4i, j</xref>) or recombinant GFP (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>) in the presence of polyacrylamide beads. Consistent with our predictions, recovery was slower in the presence of beads, and the effective diffusivity of fluorescein-coupled 70 kDa dextran dropped from 24.1 ± 0.4 (standard error) μm<sup>2</sup>/s to 14.9 ± 0.5 μm<sup>2</sup>/s, suggesting an EVF of 39% (<italic>θ</italic> = 0.61) (Fig. <xref rid="Fig5" ref-type="fig">5c, d</xref>, Supplementary Tables <xref rid="MOESM1" ref-type="media">8</xref> and <xref rid="MOESM1" ref-type="media">9</xref>). Similarly, for recombinant GFP effective diffusivity dropped by 18% (Fig. <xref rid="Fig5" ref-type="fig">5e</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">8a–d</xref>).</p>
      <p id="Par26">To assess diffusion hindrance in vivo, we injected recombinant GFP protein into the extracellular space of living zebrafish embryos. We found that the effective diffusivity in vivo was 60% lower than for freely diffusing GFP, and 53% lower than in in vitro experiments with beads (Fig. <xref rid="Fig5" ref-type="fig">5e</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">8e, f</xref>). This suggests that tortuosity in zebrafish embryos is higher than in the in vitro bead assay. Importantly, we found similar diffusion coefficients of 36 μm<sup>2</sup>/s in vivo for extracellularly injected recombinant GFP and secreted GFP constantly produced from injected mRNA, showing that PyFRAP can properly account for both diffusion and production (Fig. <xref rid="Fig5" ref-type="fig">5e</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">8g, h</xref>).</p>
      <p id="Par27">Finally, we examined the effects of binding interactions on effective diffusivity. GFP presumably does not experience significant binding interactions with extracellular molecules in zebrafish embryos, although its movement is affected by obstructions like cells and cellular extensions. In contrast, secreted signalling molecules are expected to interact with extracellular molecules such as receptors and extracellular matrix components<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. To assess the effect that interactions with extracellular molecules might have on secreted signalling molecules, we injected mRNA encoding the TGF<italic>β</italic>-superfamily member Squint fused to GFP into zebrafish embryos<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. Squint-GFP is approximately 1.5 times larger than GFP and according to the Einstein-Stokes equation (Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>) would be predicted to have an approximately 1.14 times smaller diffusion coefficient than GFP (effective diffusivity <italic>D</italic>(GFP) = 36 μm<sup>2</sup>/s, expected effective diffusivity <italic>D</italic>(Squint-GFP) = 31 μm<sup>2</sup>/s). However, we measured an effective diffusion coefficient of approximately 2 μm<sup>2</sup>/s for Squint-GFP in living zebrafish embryos, ~90% lower than the predicted diffusion coefficient (Fig. <xref rid="Fig5" ref-type="fig">5e</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>, Supplementary Figs. <xref rid="MOESM1" ref-type="media">8i</xref>, j and <xref rid="MOESM1" ref-type="media">9</xref>). These findings are consistent with previous measurements<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> and with the idea that interactions with so far unidentified binding partners slow down the effective diffusion of embryonic signalling molecules like Squint-GFP<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>.</p>
    </sec>
  </sec>
  <sec id="Sec6" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par28">Although FRAP analyses have long been used to measure relative differences in mobilities between macromolecules, analysis tools to accurately and quantitatively determine effective diffusion coefficients from FRAP data are lacking. Current analysis tools impose several simplifications including one-dimensional or two-dimensional reductions of complex three-dimensional geometries, idealised bleaching conditions, and the absence of important reaction kinetics. When the experimental conditions closely resemble the simplified assumptions, e.g., small bleach domains and negligible reaction kinetics, these tools can rapidly provide reasonable diffusion estimates (Fig. <xref rid="Fig3" ref-type="fig">3c</xref>). However, experimental conditions are often more complex, and the use of simplified assumptions may yield drastically divergent diffusion coefficients (Fig. <xref rid="Fig1" ref-type="fig">1d–f</xref>). PyFRAP addresses these shortcomings by providing a simulation-based analysis that incorporates realistic geometries, bleaching conditions and reaction kinetics.</p>
    <p id="Par29">We found that PyFRAP’s data analysis pipeline is numerically reliable, recovered the correct diffusion coefficients and reaction kinetics, and additionally predicted the correct underlying reaction-diffusion models for simulated test data sets with known diffusion, production, and degradation parameters. PyFRAP consistently outperformed all other tested software packages, demonstrating its strength as a novel FRAP analysis method. Furthermore, PyFRAP was able to determine diffusion coefficients comparable to both theoretical and previously experimentally measured estimates for macromolecules with molecular weights ranging over two orders of magnitude. Since PyFRAP can analyse data independently of any assumptions about the initial conditions, it is suitable to analyse both FRAP and iFRAP experiments. iFRAP has recently been developed as an alternative to FRAP due the increasing availability of photoconvertible proteins and allows ignoring reaction kinetics such as production. We performed tandem FRAP/iFRAP experiments to analyse the diffusion of the photoconvertible protein Dendra2 and found equal diffusion coefficients in vitro with both methods.</p>
    <p id="Par30">FRAP experiments are typically performed in tissues in which macromolecules need to move around cellular obstacles, resulting in slower fluorescence recovery. To determine how this tortuosity might affect diffusion coefficients estimated from FRAP experiments, we first simulated FRAP experiments in two- and three-dimensional geometries introducing radial beads at different densities to vary the extracellular volume fraction (EVF). Our simulations showed a strong correlation between tortuosity and effective diffusivity and agree with previous theoretical work including Monte-Carlo simulations and homogenisation theory<sup><xref ref-type="bibr" rid="CR62">62</xref>–<xref ref-type="bibr" rid="CR65">65</xref></sup>. We then tested the predictions from these simulations with in vitro experiments using polyacrylamide beads to mimic cells. Compared to experiments without beads, the effective diffusion coefficient decreased by 39% (diffusion hindrance factor <italic>θ</italic> = 0.61) for 70 kDa fluorescein-dextran and 18% (<italic>θ</italic> = 0.82) for recombinant GFP. In living zebrafish embryos, effective diffusivity is much further reduced (Fig. <xref rid="Fig5" ref-type="fig">5e</xref>). It is unlikely that this is due to different viscosity of the extracellular medium in vivo, since free GFP diffusion is only marginally reduced in zebrafish embryos<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Instead, it is plausible that the complex geometries of real extracelluar environments—which include filopodia, extracellular matrix, and cavities that might act as dead end pores—could further increase tortuosity<sup><xref ref-type="bibr" rid="CR62">62</xref></sup>. Finally, most in vivo FRAP experiments are affected by biochemical reactions such as production and degradation of proteins, which must be taken into account for accurate diffusion coefficient estimates (Fig. <xref rid="Fig1" ref-type="fig">1c, f</xref>). PyFRAP offers  various models for different reaction kinetics and can accurately estimate diffusion coefficients from data sets that include constant production and degradation.</p>
    <p id="Par31">PyFRAP measures effective diffusion, but due to its built-in PDE solver it could be extended in the future to consider spatially inhomogeneous kinetics and advective fluxes and to perhaps even determine the diffusivities of individual species in polydisperse mixtures of fluorescent molecules<sup><xref ref-type="bibr" rid="CR66">66</xref>,<xref ref-type="bibr" rid="CR67">67</xref></sup>. While PyFRAP can simulate three-dimensional FRAP experiments, FRAP data is currently almost exclusively obtained from two-dimensional confocal microscopy. In recent years, the development of light-sheet microscopy made fast three-dimensional imaging with low phototoxicity feasible<sup><xref ref-type="bibr" rid="CR68">68</xref></sup>. In the future, PyFRAP’s image analysis tools could be extended to fit light-sheet microscopy data, which might provide deeper insights into the three-dimensional dynamics of molecule movement including convective flows or spatially inhomogeneous diffusion.</p>
  </sec>
  <sec id="Sec7" sec-type="materials|methods">
    <title>Methods</title>
    <sec id="Sec8">
      <title>FRAP/iFRAP experiments in vitro</title>
      <p id="Par32">FRAP experiments to measure pure diffusion and tortuosity effects were conducted in a frustum-like plexiglass hole. Holes around 700 μm in diameter and about 100 μm in depth were drilled into a plexiglass block using a dental drill. Due to the small depth, the resulting shape was frustum-like with an upper base of 510 μm diameter.</p>
      <p id="Par33">Holes were filled with aqueous solutions of FITC-/fluorescein-labelled dextrans of different sizes, recombinant GFP, or Dendra2 protein (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>) using a micro-pipette. Dendra2 protein was centrifuged at 16,000 × <italic>g</italic> for 30 min at 4 °C to remove protein aggregates. Excess liquid was removed from the hole by pipetting under observation with a stereo microscope.</p>
      <p id="Par34">To model the effect of tortuosity in the in vitro FRAP experiments, polyacrylamide beads were added to the sample solution. The microbeads (Bio-Gel P-2 Gel, &lt;45 μm wet bead size) were first soaked in distilled water overnight for hydration. The beads were then centrifuged at 300 × <italic>g</italic>, the supernatant removed, and the required quantity of beads transferred to another tube for resuspension in fluorescein-dextran or GFP+BSA solution. This was repeated and followed by removal of the supernatant, leaving a concentrated slurry of beads and fluorescent solution for the experiments. The beads were transferred into the plexiglass template and settled within 1–2 min.</p>
      <p id="Par35">To prevent evaporation, mineral oil (Sigma) was placed around the solution before sealing the hole with a cover slip (No 1.5). Supplementary Fig. <xref rid="MOESM1" ref-type="media">1a</xref> outlines the sample preparation process for in vitro experiments. The sample was upended carefully and mounted on an inverted confocal microscope. Images were taken using an LSM 780 NLO microscope (ZEISS) with an LD LCI Plan-Apochromat 25×/0.8 Imm Korr DIC objective (ZEISS) and immersion oil (Immersol TM W, <italic>n</italic> = 1.334 at 23 °C, ZEISS). First, a plane approximately in the middle of the hole was chosen and the <italic>z</italic>-position set to zero. Then, the position of the highest and lowest point was determined. Cuboid volumes (141.42 μm × 141.42 μm × 100 μm) were bleached by imaging a <italic>z</italic>-stack at highest laser power (488 nm) or photoconverted at moderate laser power. Time series of 300 images (512 pixels × 512 pixels) were taken with a speed of 1 frame/s (pixel dwell time: 3.15 μs) over a duration of 5 min. The zoom was set to 0.7, and the resulting images had a size of 566.79 μm × 566.79 μm.</p>
      <p id="Par36">After the FRAP experiment, the template was cleaned using distilled water, soap, and an interdental toothbrush.</p>
    </sec>
    <sec id="Sec9">
      <title>FRAP experiments in vivo</title>
      <p id="Par37">Zebrafish embryos (<italic>Danio rerio</italic>) were collected 10 min after mating and proteolytically dechorionated<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR42">42</xref></sup>. For the experiments with recombinant GFP, 100 pg of recombinant GFP were injected into the extracelluar space when zebrafish embryos reached high stage<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR69">69</xref></sup> (Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>). For experiments with secreted GFP<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, 100 pg of the mRNA encoding the fluorescent protein were injected at the one-cell stage. For experiments with Squint-GFP<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, either 30 or 200 pg of mRNA were injected at the one-cell stage. At dome stage, embryos were mounted in drops of 1% low-melting-point agarose animal pole down onto a glass-bottom dish (MatTek Corp. P35G-1.5-20-C), and as soon as the drops solidified covered with Danieau’s medium<sup><xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR42">42</xref></sup> to prevent the embryos from drying out. Supplementary Fig. <xref rid="MOESM1" ref-type="media">1b</xref> outlines the in vivo sample preparation process.</p>
      <p id="Par38">Confocal images were taken roughly at a depth of 40 μm from the animal pole into the embryo. For data sets injected with 200 pg of Squint-GFP-encoding mRNA, images were acquired with the same settings as described for the in vitro experiments either with 1 frame/s for 300 s, or 1 frame/10 s for 3000 s. Images of embryos injected with 30 pg of Squint-GFP-encoding mRNA were taken with a spatial resolution of 340.08 μm × 340.08 μm and 1 frame/10 s for 3000 s. Data sets for recombinant GFP in vivo were acquired with the same microscope settings as the experiments conducted in vitro.</p>
    </sec>
    <sec id="Sec10">
      <title>ROI selection</title>
      <p id="Par39">PyFRAP’s image analysis depends on defining specific ROIs for the experimental data and simulations. Users can define multiple different geometrical shapes of ROIs in three-dimensional space such as cylinders, prisms, and any kind of addition or subtraction between ROIs. The specified ROIs are then used for image analysis, estimating concentrations outside the field of view, evaluating the simulation, and fitting to the analysed data. PyFRAP is equipped with an ROI manager and wizards for several standard sets of ROIs.</p>
    </sec>
    <sec id="Sec11">
      <title>Image analysis</title>
      <p id="Par40">Let Ω<sub><italic>i</italic></sub> (with <italic>i</italic> ∈ {1, 2, …, <italic>n</italic><sub>Ω</sub>} and <italic>n</italic><sub>Ω</sub> the number of ROIs) be the list of ROIs specified for PyFRAP’s analysis. The mean intensity over the ROI Ω<sub><italic>i</italic></sub> at time <italic>t</italic><sub><italic>j</italic></sub> (with <italic>j</italic> ∈ {1, 2, …, <italic>n</italic><sub><italic>t</italic></sub>} and <italic>n</italic><sub><italic>t</italic></sub> the number of images) is then calculated by<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar I_{{\mathrm{\Omega }}_i}\left( {t_j} \right) = \frac{1}{{A_i}}\mathop {\sum}\limits_{\left( {x_k,y_l} \right) \in {\mathrm{\Omega }}_i} I\left( {x_k,y_l,t_j} \right)$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mrow><mml:mi>Ī</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>A</italic><sub><italic>i</italic></sub> is the area of Ω<sub><italic>i</italic></sub>, and <italic>I</italic>(<italic>x</italic><sub><italic>k</italic></sub>, <italic>y</italic><sub><italic>l</italic></sub>, <italic>t</italic><sub><italic>j</italic></sub>) is the intensity at pixel (<italic>x</italic><sub><italic>k</italic></sub>, <italic>y</italic><sub><italic>l</italic></sub>) (with <italic>k</italic> ∈ {1, 2, …, <italic>n</italic><sub><italic>x</italic></sub>} and <italic>n</italic><sub><italic>x</italic></sub> the number of rows in the images, and with <italic>l</italic> ∈ {1, 2, …, <italic>n</italic><sub><italic>y</italic></sub>} and <italic>n</italic><sub><italic>y</italic></sub> the number of columns in the images).</p>
      <p id="Par41">FRAP image data were analysed within the ROIs Ω<sub>bleached</sub> and Ω<sub>slice</sub>. Ω<sub>slice</sub> was defined as a circular domain with centre <italic>C</italic><sub>slice</sub> and radius <italic>r</italic><sub>slice</sub>. Since the imaging depth varied between experiments, both <italic>C</italic><sub>slice</sub> and <italic>r</italic><sub>slice</sub> were cropped for each data set. The bleached ROI Ω<sub>bleached</sub> was defined as a square with sidelength <italic>s</italic><sub>bleached</sub> and left-lower corner at <italic>O</italic><sub>bleached</sub> = <italic>C</italic><sub>slice</sub> − <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{1}{2}$$\end{document}</tex-math><mml:math id="M4"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="41467_2018_3975_Article_IEq1.gif"/></alternatives></inline-formula>(<italic>s</italic><sub>bleached</sub>, <italic>s</italic><sub>bleached</sub>). The definition of both ROIs is shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">2a</xref>.</p>
    </sec>
    <sec id="Sec12">
      <title>Accounting for uneven illumination</title>
      <p id="Par42">Uneven imaging due to inhomogeneous sample illumination is a common problem in microscopy<sup><xref ref-type="bibr" rid="CR37">37</xref>–<xref ref-type="bibr" rid="CR39">39</xref></sup>. We implemented two solutions in PyFRAP to address this problem: (1) Normalisation by an image acquired before bleaching, and (2) applying a flattening mask derived from imaging a homogeneous fluorescent sample. The pixel-wise mean image over <italic>n</italic><sub>t</sub> images can be defined as<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M\left( {x_k,y_l,t_j} \right) = \frac{1}{{n_{\mathrm{t}}}}\mathop {\sum}\limits_{j = 1}^{n_{\mathrm{t}}} {\kern 1pt} I\left( {x_k,y_l,t_j} \right)$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mi>M</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>To avoid noise-induced singularities when normalising, PyFRAP computes a mean normalisation mask <italic>M</italic><sub>pre</sub> over multiple pre-bleach images, and then divides each image of the recovery time series pixel-wise by the computed mask<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde I\left( {x_k,y_l,t_j} \right) = \frac{{I\left( {x_k,y_l,t_j} \right) + O_{{\mathrm{norm}}}}}{{M_{{\mathrm{pre}}}\left( {x_k,y_l} \right) + O_{{\mathrm{norm}}}}}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mi>Ĩ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">norm</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">pre</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">norm</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>O</italic><sub>norm</sub> is the optimal data offset computed via<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O_{{\mathrm{norm}}} = {\mathrm{max}}\left\{ {\mathop {{{\mathrm{min}}}}\limits_{k,j} \left( {I\left( {x_k,y_l,t_j} \right)} \right),\mathop {{{\mathrm{min}}}}\limits_{k,j} \left( {M_{{\mathrm{pre}}}\left( {x_k,y_l,t_j} \right)} \right)} \right\} + 1$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">norm</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">pre</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>Similarly, the flattening mask <italic>F</italic> is computed using the mean over multiple images of a fluorophore spread homogeneously across a cover slip, <italic>M</italic><sub>flat</sub>:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F\left( {x_k,y_l} \right) = \frac{{{\mathrm{max}}_k\left( {M_{{\mathrm{flat}}}\left( {x_k,y_l} \right)} \right) + O_{{\mathrm{flat}}}}}{{M_{{\mathrm{flat}}}\left( {x_k,y_l} \right) + O_{{\mathrm{flat}}}}}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mi>F</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">flat</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">flat</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">flat</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">flat</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>Similar to the normalisation in Eq. (<xref rid="Equ4" ref-type="">4</xref>), the optimal data offset <italic>O</italic><sub>flat</sub> is obtained by taking the maximum over all minimum intensities of images in both recovery and flattening data sets. The recovery data set is obtained by pixel-wise multiplication of the recovery image with the flattening mask obtained in Eq. (<xref rid="Equ5" ref-type="">5</xref>):<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde I\left( {x_k,y_l,t_j} \right) = F\left( {x_k,y_l} \right) \cdot I\left( {x_k,y_l,t_j} \right)$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mi>Ĩ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>An outline of both correction methods is shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">2c</xref>.</p>
      <p id="Par43">In the present study, two pre-bleach images were acquired per sample for the normalisation mask, and two images of fluorescein conjugated to a 40 kDa dextran or recombinant GFP homogeneously spread on a cover slip were acquired for the flattening approach. The effects of flattening and normalisation on data analysis are described in Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec13">
      <title>Accounting for background fluorescence</title>
      <p id="Par44">Background subtraction is a standard procedure to extract the true signal of microscope images<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>. Similar to the flattening and normalisation masks, PyFRAP takes the average over multiple pixels to obtain a background mask and then subtracts it pixel-wise<sup><xref ref-type="bibr" rid="CR38">38</xref>,<xref ref-type="bibr" rid="CR39">39</xref></sup>:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde I\left( {x_k,y_l,t_j} \right) = I\left( {x_k,y_l,t_j} \right) - M_{{\mathrm{bkgd}}}\left( {x_k,y_l} \right)$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mi>Ĩ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">bkgd</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>The mean of two images without a sample was determined to compute a background mask. The effect of background subtraction is discussed in Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>.</p>
    </sec>
    <sec id="Sec14">
      <title>Application of filters for noise reduction</title>
      <p id="Par45">Microscope data sets are often noisy, causing problems for normalisation and simulation. PyFRAP smooths noisy pixels by either applying a Gaussian blur with standard deviation <italic>σ</italic><sub>gauss</sub>, or a median filter with filter window radius <italic>r</italic><sub>median</sub>. We found that <italic>σ</italic><sub>gauss</sub> = 2 and <italic>r</italic><sub>median</sub> = 5 provided good results for the data in the present study (see Supplementary Note <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
    <sec id="Sec15">
      <title>Accounting for fluorescence outside of the imaging view</title>
      <p id="Par46">In some cases it is not possible to capture the whole sample in one field of view under the microscope, and the concentration in the non-imaged regions needs to be estimated. PyFRAP solves this by letting users define an ROI Ω<sub>rim</sub> to select an approximation of the average unbleached intensity from the first image of the recovery image series:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{{\mathrm{rim}}} = \frac{1}{{A_{{\mathrm{rim}}}}}\mathop {\sum}\limits_{\left( {x_k,y_l} \right) \in {\mathrm{\Omega }}_{{\mathrm{rim}}}} I\left( {x_k,y_l,t_0} \right)$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">rim</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">rim</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">rim</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>Ω<sub>rim</sub> is defined by Ω<sub>rim</sub> = Ω<sub>slice</sub> − Ω<sub>centre</sub>, where<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{\Omega }}_{{\mathrm{center}}} = \left\{ {\left( {x_k,y_l} \right)|\sqrt {\left( {x_k - x_c} \right)^2 + \left( {y_l - yc} \right)^2} &lt; \rho _{{\mathrm{rim}}}r_{{\mathrm{slice}}}} \right\}$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">center</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∣</mml:mo><mml:msqrt><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>y</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:msqrt><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">rim</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">slice</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>with (<italic>x</italic><sub><italic>c</italic></sub>, <italic>y</italic><sub><italic>c</italic></sub>) the centre pixel coordinates of the image. Ω<sub>rim</sub> thus defines a small annulus comprising all pixels (<italic>x</italic><sub><italic>k</italic></sub>, <italic>y</italic><sub><italic>l</italic></sub>) inside Ω<sub>slice</sub> that have a distance of at least <italic>ρ</italic><sub>rim</sub><italic>r</italic><sub>slice</sub> from the centre of the image (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2b</xref>). <italic>ρ</italic><sub>rim</sub> = 0.66 and <italic>ρ</italic><sub>rim</sub> = 0.4585 were found to provide good values for the in vitro and in vivo experiments, respectively.</p>
    </sec>
    <sec id="Sec16">
      <title>Simulations</title>
      <p id="Par47">PyFRAP simulates FRAP experiments numerically. Ignoring reaction kinetics, a FRAP experiment can be described by the diffusion equation<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{\partial c({\bf{x}},t)}}{{\partial t}} = D\nabla ^2c({\bf{x}},t),{\bf{x}} \in {\mathrm{\Omega }}$$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:msup><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>where <italic>c</italic>(<bold>x</bold>, <italic>t</italic>) is the concentration of the measured molecule at position <bold>x</bold> = <inline-formula id="IEq2"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\langle {x,y,z} \right\rangle$$\end{document}</tex-math><mml:math id="M24"><mml:mfenced close="⟩" open="⟨" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="41467_2018_3975_Article_IEq2.gif"/></alternatives></inline-formula> and time <italic>t</italic> inside the domain Ω, and <italic>D</italic> is its scalar diffusion coefficient. The diffusion coefficient is assumed to be constant and homogeneous.</p>
      <p id="Par48">Since the sample is assumed to be a closed system, no-flux Neumann boundary conditions were defined as<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{{\partial c({\bf{x}},t)}}{{\partial {\bf{n}}}} = {\mathrm{0}},{\bf{x}} \in \partial {\mathrm{\Omega }}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi mathvariant="normal">0</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:mi>∂</mml:mi><mml:mi mathvariant="normal">Ω</mml:mi></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>where <bold>n</bold> is the normal vector of the boundary ∂Ω at position <bold>x</bold>.</p>
    </sec>
    <sec id="Sec17">
      <title>Initial conditions for simulations</title>
      <p id="Par49">The initial conditions are given by the bilinear interpolation <italic>P</italic> between pixels of the initial post-bleaching image:<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(x,y) = \frac{{\left( {x_2 - x,x - x_1} \right)}}{{\left( {x_1 - x_2} \right)\left( {y_2 - y_1} \right)}} \cdot \left( {\begin{array}{*{20}{c}} {I\left( {x_1,y_1} \right)} &amp; {I\left( {x_1,y_2} \right)} \\ {I\left( {x_2,y_1} \right)} &amp; {I\left( {x_2,y_2} \right)} \end{array}} \right) \cdot \left( {\begin{array}{*{20}{c}} {y_2 - y} \\ {y - y_1} \end{array}} \right)$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd columnalign="center"><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd columnalign="center"><mml:mi>I</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>y</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>y</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><italic>I</italic>(<italic>x</italic><sub><italic>k</italic>′</sub>, <italic>y</italic><sub><italic>l</italic>′</sub>) with <italic>k</italic>′, <italic>l</italic>′ ∈ {1, 2} represents the intensities in the initial image of the four pixels surrounding (<italic>x</italic>, <italic>y</italic>). If (<italic>x</italic>, <italic>y</italic>) is outside of the visible ROI in the initial image (Ω<sub>1</sub>), the rim concentration <italic>c</italic><sub>rim</sub> given in Eq. (<xref rid="Equ8" ref-type="">8</xref>) is combined piece-wise with Eq. (<xref rid="Equ12" ref-type="">12</xref>) to give the initial condition<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c({\bf{x}},0) = \left\{ {\begin{array}{*{20}{l}} {P(x,y)} \hfill &amp; {{\mathrm{if}}\left( {x,y} \right) \in {\mathrm{\Omega }}_1\forall z} \hfill \\ {c_{{\mathrm{rim}}}} \hfill &amp; {{\mathrm{otherwise}}} \hfill \end{array}} \right.$$\end{document}</tex-math><mml:math id="M30" display="block"><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mi mathvariant="normal">if</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∀</mml:mo><mml:mi>z</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">rim</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mi mathvariant="normal">otherwise</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec18">
      <title>Simulation geometry</title>
      <p id="Par50">PyFRAP comes with its own geometry definition tool. Geometry definitions can then be converted into the Gmsh format<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> for meshing. PyFRAP can read Gmsh’s geometry definition files, use Gmsh’s mesh files, or import STereoLithography (.stl) files, allowing users to define arbitrary two- and three-dimensional geometries. This gives users the ability to describe a realistic FRAP experiment geometry with the necessary precision.</p>
      <p id="Par51">The simulation geometry Ω for the in vitro experiments was a conical frustum with upper radius <italic>r</italic><sub>upper</sub> = 317.65 pixels, lower radius <italic>r</italic><sub>lower</sub> = 224.25 pixels, and height <italic>h</italic> ≈ 90.33 pixels (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4b</xref>). For the in vivo experiments, the simulation geometry resembled a zebrafish embryo at dome stage, i.e., the intersection of two hemispheres intersecting each other at the equator of the outer hemisphere. Since the geometry depends on the radius of the embryo in the initial image, <italic>r</italic><sub>imaging</sub> was calculated separately for each experiment<sup><xref ref-type="bibr" rid="CR29">29</xref>,<xref ref-type="bibr" rid="CR70">70</xref></sup>. Assuming that the radius of the inner hemisphere <italic>r</italic><sub>inner</sub> is 10% larger than the one of the outer hemisphere, <italic>r</italic><sub>outer</sub>, the geometry can be computed by<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}r_{{\mathrm{outer}}} = \frac{{r_{{\mathrm{imaging}}}^2 + h_{{\mathrm{imaging}}}^2}}{{ - 2h_{{\mathrm{imaging}}}}}\\ r_{{\mathrm{inner}}} = 1.1 \cdot r_{{\mathrm{outer}}}\\ d_{{\mathrm{center}}} = \sqrt {r_{{\mathrm{inner}}}^2 - r_{{\mathrm{outer}}}^2} \end{array}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">outer</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">imaging</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">imaging</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">imaging</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">inner</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.1</mml:mn><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">outer</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">center</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">inner</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">outer</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:msqrt></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>where <italic>d</italic><sub>centre</sub> is the distance between the two centres of the hemispheres. Supplementary Fig. <xref rid="MOESM1" ref-type="media">4a</xref> shows a schematic of the zebrafish dome stage geometry.</p>
    </sec>
    <sec id="Sec19">
      <title>Meshing for simulations</title>
      <p id="Par52">PyFRAP discretises simulation geometries using Gmsh<sup><xref ref-type="bibr" rid="CR43">43</xref></sup> in combination with TetGen<sup><xref ref-type="bibr" rid="CR44">44</xref></sup> into tetrahedral meshes. PyFRAP utilises almost all functionalities of Gmsh—such as boundary layer meshes, attractor meshes, mesh merging and mesh refinement—allowing users to apply fine meshes where they are needed.</p>
      <p id="Par53">The overall default element size in the present study was <italic>v</italic> = 25 pixels<sup>3</sup>. To overcome numerical instabilities, such as Gibbs phenomena at the boundary of Ω<sub>bleached</sub>, the mesh around the bleached area boundary was refined using a boundary layer mesh of thickness <italic>w</italic><sub>BL</sub> = 30 pixels and element size <italic>v</italic><sub>BL</sub> = 15 pixels<sup>3</sup>. Since only the simulation inside Ω<sub>slice</sub> and Ω<sub>bleached</sub> is used to fit the FRAP experiments, the mesh inside Ω<sub>slice</sub> was also refined to an element size of <italic>v</italic><sub>slice</sub> = 15 pixels<sup>3</sup>. Supplementary Fig. <xref rid="MOESM1" ref-type="media">4c, e</xref> shows an example of a tetrahedral mesh with both slice refinement and boundary layer meshes for the zebrafish dome geometry described in the previous section.</p>
    </sec>
    <sec id="Sec20">
      <title>PDE solver</title>
      <p id="Par54">All partial differential equations (PDEs) were simulated using the FiPy toolbox<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>. The LU factorisation algorithm or the Preconditioned-Conjugated-Gradient algorithm implemented in PySparse were used to solve the linear system at each time step.</p>
    </sec>
    <sec id="Sec21">
      <title>Simulation parameters</title>
      <p id="Par55">All simulations were performed with a reference diffusion coefficient of <italic>D</italic> = 50 pixels<sup>2</sup>/s. To ensure that the simulations run long enough to capture the full recovery of the FRAP experiment, the end time point of the simulation was set to <italic>t</italic><sub>sim,end</sub> = 1680 s for experiments conducted with an acquisition interval of Δ<italic>t</italic> = 1 s. Since the recovery is steepest at the beginning of the simulations, a logarithmic time-stepping scheme was used, making early time steps shorter to achieve greater accuracy. A summary of all simulation parameters used to analyse the FRAP data in the present study is given in Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>.</p>
    </sec>
    <sec id="Sec22">
      <title>Fitting</title>
      <p id="Par56">To avoid the need to re-simulate the FRAP experiment for each choice of diffusion coefficient <italic>D</italic>, PyFRAP uses the self-similarity property of the solution to Eq. (<xref rid="Equ10" ref-type="">10</xref>). For example, a simulated FRAP experiment with the diffusion coefficient <italic>D</italic> = 50 pixels<sup>2</sup>/s results in the same recovery behaviour as an experiment with the diffusion coefficient <italic>D</italic> = 200 pixels<sup>2</sup>/s, just four times slower. This can be described as<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c({\bf{x}},t,D) = c\left( {{\bf{x}},\frac{{D_{{\mathrm{ref}}}}}{D}t,D_{{\mathrm{ref}}}} \right)$$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:mfrac><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <italic>D</italic><sub>ref</sub> is the reference diffusion coefficient, i.e., the diffusion coefficient used for the simulation of Eq. (<xref rid="Equ10" ref-type="">10</xref>). Supplementary Fig. <xref rid="MOESM1" ref-type="media">4d</xref> shows simulated recovery curves for various diffusion coefficients illustrating this self-similarity property.</p>
      <p id="Par57">PyFRAP allows users to fit four different models to FRAP data: (1) Pure diffusion, (2) diffusion and production, (3) diffusion and degradation, (4) diffusion with degradation and production, and each of these models with an additional set of equalisation parameters (see below). In case of pure diffusion, the solution for the diffusion coefficient <italic>D</italic> over a given ROI Ω<sub><italic>i</italic></sub> is simply given by the volume integral of the solution in Eq. (<xref rid="Equ15" ref-type="">15</xref>):<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde c\left( {{\mathrm{\Omega }}_i,t,D} \right) \equiv \mathop {\int}\limits_{{\bf{x}} \in {\mathrm{\Omega }}_i} {\kern 1pt} c({\bf{x}},t,D){\mathrm{d}}V$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfenced><mml:mo>≡</mml:mo><mml:munder><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>V</mml:mi></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>A summary of all parameters used to fit the FRAP data in the present study is given in Supplementary Table <xref rid="MOESM1" ref-type="media">12</xref>.</p>
    </sec>
    <sec id="Sec23">
      <title>Extending the diffusion model with reaction kinetics</title>
      <p id="Par58">Spatially uniform production was added to the scaled FRAP model defined in Eq. (<xref rid="Equ15" ref-type="">15</xref>) or in Eq. (<xref rid="Equ20" ref-type="">20</xref>) by<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar c({\mathrm{\Omega }}_i,t,D) = c(\Omega _i,t,D) + k_2t$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>where <italic>k</italic><sub>2</sub> is the production rate. To add spatially uniform degradation, the resulting solution is given by<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar c\left( {{\mathrm{\Omega }}_i,t,D} \right) = c\left( {\Omega _i,t,D} \right)e^{ - k_1t}$$\end{document}</tex-math><mml:math id="M40" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>The parameter <italic>k</italic><sub>1</sub> represents the degradation rate constant. Adding both degradation and production to the system results in the following superposition of solutions:<disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar c({\mathrm{\Omega }}_i,t,D) = c({\mathrm{\Omega }}_i,t,D)e^{ - k_1t} + \left( {1 + e^{ - k_1t}} \right)\frac{{k_2}}{{k_1}}$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec24">
      <title>Accounting for varying fluorophore fractions by equalisation</title>
      <p id="Par59">FRAP experiments can vary in intensity during the experiment due to, for example, an increase or decrease in extracellular volume fraction, due to molecules moving in and out of the imaging plane, or due to an immobile fraction of fluorescent molecules. These effects are accounted for by equalisation, which normalises both simulation and data recovery curves to an equivalent scale between 0 and 1. During the fitting process, the simulated recovery curves are slightly lifted or lowered to better resemble overall fluorescence levels. This can be written as<disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde c({\mathrm{\Omega }}_i,t,D) = \frac{1}{{\bar c_{{\mathrm{max}}}E_i}}\left( {\mathop {\int}\limits_{{\bf{x}} \in {\mathrm{\Omega }}_i} {\kern 1pt} \bar c({\bf{x}},t,D)\left. {{\mathrm{d}}V - \bar c_{{\mathrm{min}}}} \right)} \right)$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfenced close=")" open="" separators=""><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>V</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula>where <italic>E</italic><sub><italic>i</italic></sub> is the equalisation factor for ROI Ω<sub><italic>i</italic></sub>. The background <inline-formula id="IEq3"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar c_{{\mathrm{min}}}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2018_3975_Article_IEq3.gif"/></alternatives></inline-formula> was chosen to be the smallest concentration of the bleached ROI inside the imaging region (Ω<sub>bleached</sub>), over the whole time series<disp-formula id="Equ21"><label>21</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar c_{{\mathrm{min}}} = \mathop {{{\mathrm{min}}}}\limits_t \mathop {\int}\limits_{{\bf{x}} \in {\mathrm{\Omega }}_{{\mathrm{bleached}}}} {\kern 1pt} \bar c({\bf{x}},t){\mathrm{d}}V$$\end{document}</tex-math><mml:math id="M48" display="block"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo> ∫</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">bleached</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>V</mml:mi></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>and the normalisation value <inline-formula id="IEq4"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar c_{{\mathrm{max}}}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2018_3975_Article_IEq4.gif"/></alternatives></inline-formula> to be the maximum concentration inside the whole imaging ROI (Ω<sub>slice</sub>), over the whole time series<disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar c_{{\mathrm{max}}} = \mathop {{{\mathrm{max}}}}\limits_t \mathop {\int}\limits_{{\bf{x}} \in {\mathrm{\Omega }}_{{\mathrm{slice}}}} {\kern 1pt} \bar c({\bf{x}},t){\mathrm{d}}V$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo> ∫</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">slice</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>V</mml:mi></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
    <sec id="Sec25">
      <title>Minimisation and parameter estimation</title>
      <p id="Par60">Choosing one of the models defined in Eqs. (<xref rid="Equ15" ref-type="">15</xref>), (<xref rid="Equ16" ref-type="">16</xref>), (<xref rid="Equ17" ref-type="">17</xref>), (<xref rid="Equ18" ref-type="">18</xref>) and (<xref rid="Equ19" ref-type="">19</xref>), the sum of squared differences, SSD, was calculated by<disp-formula id="Equ23"><label>23</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{SSD} = \mathop {\sum}\limits_i {\kern 1pt} \mathop {\sum}\limits_{t_j} \left( {\tilde c\left( {{\mathrm{\Omega }}_i,t_j,D} \right) - I_{{\mathrm{\Omega }}_i}\left( {t_j} \right)} \right)^2$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mi mathvariant="normal">SSD</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula>where <italic>t</italic><sub><italic>j</italic></sub> ∈ 0, .., <italic>T</italic> are all time points of the FRAP data set, and Ω<sub><italic>i</italic></sub> ∈ Ω<sub>bleached</sub>, Ω<sub>slice</sub> are the two ROIs of interest yielding a mean optimal fit between all fitted ROIs. The minimisation of Eq. (<xref rid="Equ23" ref-type="">23</xref>) was carried out using a constrained Nelder–Mead algorithm<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. Since especially for a larger number of degrees of freedom the minimisation algorithm tended to stop in local minima, initial guesses for the diffusion coefficient <italic>D</italic> were tested over two orders of magnitude, and the fit yielding the minimum SSD was considered optimal.</p>
    </sec>
    <sec id="Sec26">
      <title>Analysis speed</title>
      <p id="Par61">Details of the method to determine PyFRAP’s performance in terms of analysis speed are described in Supplementary Note <xref rid="MOESM1" ref-type="media">4 and</xref> Supplementary Tables <xref rid="MOESM1" ref-type="media">13</xref> and <xref rid="MOESM1" ref-type="media">14</xref>.</p>
    </sec>
    <sec id="Sec27">
      <title>Statistics</title>
      <p id="Par62">PyFRAP offers four statistical tools (Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>) allowing users to test whether the estimated diffusion coefficient for one experimental group is significantly different from another one. The statistical tools include the two most prominent parametric significance tests, the Student’s <italic>t</italic>-test<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> and a modification of this test, Welch’s <italic>t</italic>-test<sup><xref ref-type="bibr" rid="CR71">71</xref></sup>, which both assume normally distributed test groups. PyFRAP also provides the Shapiro–Wilk test, allowing PyFRAP users to quickly assess whether the estimated diffusion coefficients follow a normal distribution. The Shapiro–Wilk test was recently found to have the best sensitivity compared to other common normality tests<sup><xref ref-type="bibr" rid="CR72">72</xref></sup>. If normality cannot be guaranteed, PyFRAP offers two non-parametric ranked hypothesis tests: The Wilcoxon signed-rank test<sup><xref ref-type="bibr" rid="CR73">73</xref></sup> and the Mann–Whitney U test<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>.</p>
      <p id="Par63">Often, the underlying reaction kinetics of FRAP experiments or the relevance of their contribution might be unknown<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. However, models with more parameters generally provide better fits than simpler models. The AIC<sup><xref ref-type="bibr" rid="CR55">55</xref></sup> allows users to evaluate which model fits the data the best while keeping model complexity low. For this, let<disp-formula id="Equ24"><label>24</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{\Theta }}: = \left( {k_1,k_2,D,E_1,E_2, \ldots } \right)$$\end{document}</tex-math><mml:math id="M56" display="block"><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula>be the vector of unknown diffusion coefficient <italic>D</italic>, reaction rates <italic>k</italic><sub>1</sub> and <italic>k</italic><sub>2</sub>, and <italic>E</italic><sub>1</sub>, <italic>E</italic><sub>2</sub>, … a list of equalisation factors. Moreover, let <italic>m</italic> = <italic>m</italic>(Θ) be the model prediction using Θ. Assuming that the data is distributed normally around the model<disp-formula id="Equ25"><label>25</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_i - m_i\sim {\cal N}(\mu ,\sigma)$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>,</mml:mo><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ25.gif" position="anchor"/></alternatives></disp-formula>the log-likelihood function at data point <italic>i</italic>, <italic>L</italic><sub><italic>i</italic></sub> becomes<disp-formula id="Equ26"><label>26</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_i\left( {{\mathrm{\Theta }}|d_i - m_i} \right) = \left( {d_i - m_i} \right)^2$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ26.gif" position="anchor"/></alternatives></disp-formula>and is thus identical with the sum of squared differences used for optimisation in Eq. (<xref rid="Equ23" ref-type="">23</xref>):<disp-formula id="Equ27"><label>27</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L({\mathrm{\Theta }}) = \mathop {\sum}\limits_i {\kern 1pt} L_i({\mathrm{\Theta }}) = \mathrm{SSD}$$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">SSD</mml:mi></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ27.gif" position="anchor"/></alternatives></disp-formula>The AIC is then given by<disp-formula id="Equ28"><label>28</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{AIC} = 2k - 2L\left( {{\hat{\mathrm\Theta }}} \right)$$\end{document}</tex-math><mml:math id="M64" display="block"><mml:mi mathvariant="normal">AIC</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>L</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ28.gif" position="anchor"/></alternatives></disp-formula>where <italic>k</italic> is the number of parameters of model <italic>m</italic> and<disp-formula id="Equ29"><label>29</label><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat \Theta = {\mathrm{argmin}}(L(\Theta |d_i - m_i,i = 1...n))$$\end{document}</tex-math><mml:math id="M66" display="block"><mml:mover accent="true"><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="normal">argmin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Θ</mml:mi><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ29.gif" position="anchor"/></alternatives></disp-formula>is the parameter configuration Θ minimising the log-likelihood function (Eq. (<xref rid="Equ27" ref-type="">27</xref>)), i.e., the parameter configuration returned from fitting the model to data. The best model according to the AIC is then <italic>m</italic>(argmin(AIC<sub><italic>i</italic></sub> − AIC<sub>min</sub>)). If the number of sample points is small, the corrected AIC (AICc) provides a more accurate model selection technique:<disp-formula id="Equ30"><label>30</label><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{AICc} = \mathrm{AIC} + \frac{{2k(k + 1)}}{{n - k - 1}}$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mi mathvariant="normal">AICc</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">AIC</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ30.gif" position="anchor"/></alternatives></disp-formula>where <italic>n</italic> is the number of data points. A rule of thumb for when the AIC (Eq. (<xref rid="Equ28" ref-type="">28</xref>)) or its corrected version (Eq. (<xref rid="Equ30" ref-type="">30</xref>)) should be used is<disp-formula id="Equ31"><label>31</label><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{n}{k} &gt; 40$$\end{document}</tex-math><mml:math id="M70" display="block"><mml:mfrac><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mn>40</mml:mn></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ31.gif" position="anchor"/></alternatives></disp-formula>PyFRAP automatically selects which statistical model is more appropriate if not specified differently.</p>
      <p id="Par64">PyFRAP also provides <italic>R</italic><sup>2</sup>-values for each fit: An <italic>R</italic><sup>2</sup>-value for each fitted ROI and the product and mean of these values. In general, PyFRAP computes an <italic>R</italic><sup>2</sup>-value of an ROI by<disp-formula id="Equ32"><label>32</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R^2 = 1 - \frac{{\mathop {\sum}\limits_i {\kern 1pt} m_i - d_i}}{{\mathop {\sum}\limits_i {\kern 1pt} d_i - \bar d}}$$\end{document}</tex-math><mml:math id="M72" display="block"><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2018_3975_Article_Equ32.gif" position="anchor"/></alternatives></disp-formula>where <italic>m</italic><sub><italic>i</italic></sub> and <italic>d</italic><sub><italic>i</italic></sub> are model and data at time <italic>i</italic>, and <inline-formula id="IEq5"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\bar d$$\end{document}</tex-math><mml:math id="M74"><mml:mover accent="true"><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2018_3975_Article_IEq5.gif"/></alternatives></inline-formula> is the mean over all data points.</p>
    </sec>
    <sec id="Sec28">
      <title>Data exclusion</title>
      <p id="Par65">We performed a rigorous screen of all data sets, and we excluded data sets that showed strong radial inhomogeneities in the first post-bleach image due to inhomogeneous distribution of fluorescent molecules. Moreover, we excluded in vitro data sets that showed unstable distributions in the overall fluorescence intensity levels, indicating incomplete bleaching through the depth of the sample.</p>
    </sec>
    <sec id="Sec30">
      <title>Code availability</title>
      <p id="Par67">PyFRAP is freely available from <ext-link ext-link-type="uri" xlink:href="https://mueller-lab.github.io/PyFRAP">https://mueller-lab.github.io/PyFRAP</ext-link>.</p>
    </sec>
    <sec id="Sec29">
      <title>Data availability</title>
      <p id="Par66">All data is available from the corresponding author upon request.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Electronic supplementary material</title>
    <sec id="Sec31">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2018_3975_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p><bold>Supplementary Information</bold> accompanies this paper at 10.1038/s41467-018-03975-6.</p>
    </fn>
    <fn>
      <p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Ekkehard Kröwerath (University Hospital Tübingen, Centre for Dentistry, Oral Medicine, and Maxillofacial Surgery) for the preparation of plexiglass holes, Katherine Rogers and Fabian Fröhlich for discussions and suggestions, and Sarah Keim and Katherine Rogers for testing PyFRAP. This work was supported by the Emmy Noether Programme of the Deutsche Forschungsgemeinschaft, the Max Planck Society, and an ERC Starting Grant to P.M.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>A.B., B.M.J. and P.M. conceived the study. A.B. and P.M. designed the software and performed data analysis and simulations. A.B. implemented the software. G.S., T.B., D.M. and H.P. conducted experiments. A.B. and P.M. wrote the manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar1">
      <title>Competing interests</title>
      <p id="Par68">The authors declare no competing interests.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crick</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Diffusion in embryogenesis</article-title>
        <source>Nature</source>
        <year>1970</year>
        <volume>255</volume>
        <fpage>420</fpage>
        <lpage>422</lpage>
        <pub-id pub-id-type="doi">10.1038/225420a0</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lander</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Nie</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>FYM</given-names>
          </name>
        </person-group>
        <article-title>Do morphogen gradients arise by diffusion?</article-title>
        <source>Dev. Cell.</source>
        <year>2002</year>
        <volume>2</volume>
        <fpage>785</fpage>
        <lpage>796</lpage>
        <pub-id pub-id-type="doi">10.1016/S1534-5807(02)00179-X</pub-id>
        <?supplied-pmid 12062090?>
        <pub-id pub-id-type="pmid">12062090</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Müller, P. &amp; Schier, A. F. Extracellular movement of signaling molecules. <italic>Dev. Cell.</italic><bold>21,</bold>145-158 (2011).</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poo</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Cone</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Lateral diffusion of rhodopsin in Necturus rods</article-title>
        <source>Exp. Eye Res.</source>
        <year>1973</year>
        <volume>17</volume>
        <fpage>503</fpage>
        <lpage>507</lpage>
        <pub-id pub-id-type="doi">10.1016/0014-4835(73)90079-1</pub-id>
        <?supplied-pmid 4782837?>
        <pub-id pub-id-type="pmid">4782837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liebman</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Entine</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Lateral diffusion of visual pigment in photorecptor disk membranes</article-title>
        <source>Science</source>
        <year>1974</year>
        <volume>185</volume>
        <fpage>457</fpage>
        <lpage>459</lpage>
        <pub-id pub-id-type="doi">10.1126/science.185.4149.457</pub-id>
        <?supplied-pmid 4546260?>
        <pub-id pub-id-type="pmid">4546260</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loren</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fluorescence recovery after photobleaching in material and life sciences: putting theory into practice</article-title>
        <source>Q. Rev. Biophys.</source>
        <year>2015</year>
        <volume>48</volume>
        <fpage>323</fpage>
        <lpage>387</lpage>
        <pub-id pub-id-type="doi">10.1017/S0033583515000013</pub-id>
        <?supplied-pmid 26314367?>
        <pub-id pub-id-type="pmid">26314367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lippincott-Schwartz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Altan-Bonnet</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>GH</given-names>
          </name>
        </person-group>
        <article-title>Photobleaching and photoactivation: following protein dynamics in living cells</article-title>
        <source>Nat. Cell Biol.</source>
        <year>2003</year>
        <volume>5</volume>
        <fpage>S7</fpage>
        <lpage>S14</lpage>
        <pub-id pub-id-type="doi">10.1038/ncb0103-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bancaud</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Huet</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rabut</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ellenberg</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Fluorescence perturbation techniques to study mobility and molecular dynamics of proteins in live cells: FRAP, photoactivation, photoconversion, and FLIP</article-title>
        <source>Cold Spring Harb. Protoc.</source>
        <year>2010</year>
        <volume>12</volume>
        <fpage>1303</fpage>
        <lpage>1325</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffin</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Odde</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Seydoux</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Regulation of the MEX-5 gradient by a spatially segregated kinase/phosphatase cycle</article-title>
        <source>Cell</source>
        <year>2011</year>
        <volume>146</volume>
        <fpage>955</fpage>
        <lpage>958</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2011.08.012</pub-id>
        <?supplied-pmid 21925318?>
        <pub-id pub-id-type="pmid">21925318</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Free extracellular diffusion creates the Dpp morphogen gradient of the <italic>Drosophila</italic> wing disc</article-title>
        <source>Curr. Biol.</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>668</fpage>
        <lpage>675</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cub.2012.02.065</pub-id>
        <?supplied-pmid 22445299?>
        <pub-id pub-id-type="pmid">22445299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Axelrod</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Koppel</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Schlessinger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Elson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Webb</surname>
            <given-names>WW</given-names>
          </name>
        </person-group>
        <article-title>Mobility measurement by analysis of fluorescence photobleaching recovery kinetics</article-title>
        <source>Biophys. J.</source>
        <year>1976</year>
        <volume>16</volume>
        <fpage>1055</fpage>
        <lpage>1069</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3495(76)85755-4</pub-id>
        <?supplied-pmid 786399?>
        <pub-id pub-id-type="pmid">786399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soumpasis</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Theoretical analysis of fluorescence photobleaching recovery experiments</article-title>
        <source>Biophys. J.</source>
        <year>1983</year>
        <volume>41</volume>
        <fpage>95</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3495(83)84410-5</pub-id>
        <?supplied-pmid 6824758?>
        <pub-id pub-id-type="pmid">6824758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sprague</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>McNally</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>FRAP analysis of binding: proper and fitting</article-title>
        <source>Trends Cell Biol.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>84</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tcb.2004.12.001</pub-id>
        <?supplied-pmid 15695095?>
        <pub-id pub-id-type="pmid">15695095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Day</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Drake</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kenworthy</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>DiBenedetto</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>A generalization of theory for two-dimensional Fluorescence Recovery After Photobleaching applicable to confocal laser scanning microscopes</article-title>
        <source>Biophys. J.</source>
        <year>2009</year>
        <volume>97</volume>
        <fpage>1501</fpage>
        <lpage>1511</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2009.06.017</pub-id>
        <?supplied-pmid 19720039?>
        <pub-id pub-id-type="pmid">19720039</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deschout</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Straightforward FRAP for quantitative diffusion measurements with a laser scanning microscope</article-title>
        <source>Opt. Express</source>
        <year>2010</year>
        <volume>18</volume>
        <fpage>22886</fpage>
        <lpage>22905</lpage>
        <pub-id pub-id-type="doi">10.1364/OE.18.022886</pub-id>
        <?supplied-pmid 21164628?>
        <pub-id pub-id-type="pmid">21164628</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Day</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Kenworthy</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>DiBenedetto</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Simplified equation to extract diffusion coefficients from confocal FRAP data</article-title>
        <source>Traffic</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>1589</fpage>
        <lpage>1600</lpage>
        <pub-id pub-id-type="doi">10.1111/tra.12008</pub-id>
        <?supplied-pmid 22984916?>
        <pub-id pub-id-type="pmid">22984916</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Kraft, L. J., Dowler, J. &amp; Kenworthy, A. K. <italic>Frap-toolbox: Software for the Analysis of Fluorescence Recovery after Photobleaching</italic>. <ext-link ext-link-type="uri" xlink:href="http://www.fraptoolbox.com">http://www.fraptoolbox.com</ext-link> Accessed 12 Dec 2016 (2014).</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Othmer</surname>
            <given-names>HG</given-names>
          </name>
        </person-group>
        <article-title>Improving parameter inference from FRAP data: an analysis motivated by pattern Formation in the drosophila wing disc</article-title>
        <source>Bull. Math. Biol.</source>
        <year>2017</year>
        <volume>79</volume>
        <fpage>448</fpage>
        <lpage>497</lpage>
        <pub-id pub-id-type="doi">10.1007/s11538-016-0241-6</pub-id>
        <?supplied-pmid 28101740?>
        <pub-id pub-id-type="pmid">28101740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beaudouin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mora-Bermúdez</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Klee</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Daigle</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ellenberg</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Dissecting the contribution of diffusion and interactions to the mobility of nuclear proteins</article-title>
        <source>Biophys. J.</source>
        <year>2006</year>
        <volume>90</volume>
        <fpage>1878</fpage>
        <lpage>1894</lpage>
        <pub-id pub-id-type="doi">10.1529/biophysj.105.071241</pub-id>
        <?supplied-pmid 16387760?>
        <pub-id pub-id-type="pmid">16387760</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schaff</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Cowan</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Loew</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Moraru</surname>
            <given-names>II</given-names>
          </name>
        </person-group>
        <article-title>Virtual FRAP - an experiment-oriented simulation tool</article-title>
        <source>Biophys. J.</source>
        <year>2009</year>
        <volume>96</volume>
        <fpage>30a</fpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2008.12.046</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blumenthal</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Goldstien</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Edidin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gheber</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Universal approach to FRAP analysis of arbitrary bleaching patterns</article-title>
        <source>Sci. Rep.</source>
        <year>2015</year>
        <volume>5</volume>
        <fpage>11655</fpage>
        <pub-id pub-id-type="doi">10.1038/srep11655</pub-id>
        <?supplied-pmid 26108191?>
        <pub-id pub-id-type="pmid">26108191</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Brand</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
        </person-group>
        <article-title>Morphogen transport</article-title>
        <source>Development</source>
        <year>2013</year>
        <volume>140</volume>
        <fpage>1621</fpage>
        <lpage>1638</lpage>
        <pub-id pub-id-type="doi">10.1242/dev.083519</pub-id>
        <?supplied-pmid 23533171?>
        <pub-id pub-id-type="pmid">23533171</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Umulis</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Othmer</surname>
            <given-names>HG</given-names>
          </name>
        </person-group>
        <article-title>The importance of geometry in mathematical models of developing systems</article-title>
        <source>Curr. Opin. Genet. Dev.</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>547</fpage>
        <lpage>552</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gde.2012.09.007</pub-id>
        <?supplied-pmid 23107453?>
        <pub-id pub-id-type="pmid">23107453</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiss</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Challenges and artifacts in quantitative photobleaching experiments</article-title>
        <source>Traffic</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>662</fpage>
        <lpage>671</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1600-0854.2004.00215.x</pub-id>
        <?supplied-pmid 15296491?>
        <pub-id pub-id-type="pmid">15296491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mazza</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cella</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vicidomini</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Krol</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Diaspro</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Role of three-dimensional bleach distribution in confocal and two-photon fluorescence recovery after photobleaching experiments</article-title>
        <source>Appl. Opt.</source>
        <year>2007</year>
        <volume>46</volume>
        <fpage>7401</fpage>
        <lpage>7411</lpage>
        <pub-id pub-id-type="doi">10.1364/AO.46.007401</pub-id>
        <?supplied-pmid 17952174?>
        <pub-id pub-id-type="pmid">17952174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Machán</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Foo</surname>
            <given-names>YH</given-names>
          </name>
          <name>
            <surname>Wohland</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>On the equivalence of FCS and FRAP: simultaneous lipid membrane measurements</article-title>
        <source>Biophys. J.</source>
        <year>2016</year>
        <volume>111</volume>
        <fpage>152</fpage>
        <lpage>161</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2016.06.001</pub-id>
        <?supplied-pmid 27410743?>
        <pub-id pub-id-type="pmid">27410743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Braga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Desterro</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Carmo-Fonseca</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Intracellular macromolecular mobility measured by Fluorescence Recovery After Photobleaching with confocal laser scanning microscopes</article-title>
        <source>Mol. Biol. Cell.</source>
        <year>2004</year>
        <volume>10</volume>
        <fpage>4749</fpage>
        <lpage>4760</lpage>
        <pub-id pub-id-type="doi">10.1091/mbc.E04-06-0496</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blischak</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Davenport</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>A quick introduction to version control with Git and GitHub</article-title>
        <source>PLoS. Comput. Biol.</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>e1004668</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004668</pub-id>
        <?supplied-pmid 26785377?>
        <pub-id pub-id-type="pmid">26785377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Müller</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential diffusivity of Nodal and Lefty underlies a reaction-diffusion patterning system</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>336</volume>
        <fpage>721</fpage>
        <lpage>724</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1221920</pub-id>
        <?supplied-pmid 22499809?>
        <pub-id pub-id-type="pmid">22499809</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sigaut</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ponce</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Colman-Lerner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Optical techniques provide information on various effective diffusion coefficients in the presence of traps</article-title>
        <source>Phys. Rev. E</source>
        <year>2010</year>
        <volume>82</volume>
        <fpage>051912</fpage>
        <pub-id pub-id-type="doi">10.1103/PhysRevE.82.051912</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Millman</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Aivazis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Python for scientists and engineers</article-title>
        <source>Comput. Sci. Eng.</source>
        <year>2011</year>
        <volume>13</volume>
        <fpage>9</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2011.36</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guyer</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>FiPy: partial differential equations with Python</article-title>
        <source>Comput. Sci. Eng.</source>
        <year>2009</year>
        <volume>11</volume>
        <fpage>6</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2009.52</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Walt</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>scikit-image: Image processing in python</article-title>
        <source>PeerJ</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>e453</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.453</pub-id>
        <?supplied-pmid 25024921?>
        <pub-id pub-id-type="pmid">25024921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Jones, E. et al. <italic>SciPy: Open source scientific tools for Python</italic> (2001). <ext-link ext-link-type="uri" xlink:href="http://www.scipy.org/">http://www.scipy.org/</ext-link></mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Walt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Colbert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>The numpy array: a structure for efficient numerical computation</article-title>
        <source>Comput. Sci. Eng.</source>
        <year>2011</year>
        <volume>13</volume>
        <fpage>22</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2011.37</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunter</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Matplotlib: a 2d graphics environment</article-title>
        <source>Comput. Sci. Eng.</source>
        <year>2007</year>
        <volume>9</volume>
        <fpage>90</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <mixed-citation publication-type="other">Lindblad, J. &amp; Bengtsson, E. in <italic>Proceedings of the 12th Scandinavian Conference on Image Analysis (SCIA)</italic>, 264–271 (2001).</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waters</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Accuracy and precision in quantitative fluorescence microscopy</article-title>
        <source>J. Cell. Biol.</source>
        <year>2009</year>
        <volume>185</volume>
        <fpage>1135</fpage>
        <lpage>1148</lpage>
        <pub-id pub-id-type="doi">10.1083/jcb.200903097</pub-id>
        <?supplied-pmid 19564400?>
        <pub-id pub-id-type="pmid">19564400</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Schwarzfischer, M. et al. in<italic> Proceedings of Microscopic Image Analysis with Applications in Biology</italic> (2011).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gregor</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bialek</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>de Ruyter van Steveninck</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Tank</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Wieschaus</surname>
            <given-names>EF</given-names>
          </name>
        </person-group>
        <article-title>Diffusion and scaling during early embryonic pattern formation</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>18403</fpage>
        <lpage>18407</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0509483102</pub-id>
        <?supplied-pmid 16352710?>
        <pub-id pub-id-type="pmid">16352710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kicheva</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Kinetics of Morphogen gradient formation</article-title>
        <source>Science</source>
        <year>2007</year>
        <volume>5811</volume>
        <fpage>521</fpage>
        <lpage>525</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1135774</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pomreinke</surname>
            <given-names>AP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamics of BMP signaling and distribution during zebrafish dorsal-ventral patterning</article-title>
        <source>eLife</source>
        <year>2017</year>
        <volume>6</volume>
        <fpage>e25861</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.25861</pub-id>
        <?supplied-pmid 28857744?>
        <pub-id pub-id-type="pmid">28857744</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Geuzaine</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Remacle</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Gmsh: a 3-D finite element mesh generator with built-in pre- and post-processing facilities</article-title>
        <source>Int. J. Numer. Methods Eng.</source>
        <year>2009</year>
        <volume>79</volume>
        <fpage>1309</fpage>
        <lpage>1331</lpage>
        <pub-id pub-id-type="doi">10.1002/nme.2579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Si</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Tetgen, a delaunay-based quality tetrahedral mesh generator</article-title>
        <source>ACM Trans. Math. Softw.</source>
        <year>2015</year>
        <volume>41</volume>
        <fpage>11:1</fpage>
        <lpage>11:36</lpage>
        <pub-id pub-id-type="doi">10.1145/2629697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sprague</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Pego</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Stavreva</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>McNally</surname>
            <given-names>JG</given-names>
          </name>
        </person-group>
        <article-title>Analysis of binding reactions by fluorescence recovery after photobleaching</article-title>
        <source>Biophys. J.</source>
        <year>2004</year>
        <volume>86</volume>
        <fpage>3473</fpage>
        <lpage>3495</lpage>
        <pub-id pub-id-type="doi">10.1529/biophysj.103.026765</pub-id>
        <?supplied-pmid 15189848?>
        <pub-id pub-id-type="pmid">15189848</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Miura, K. <italic>Frapcalc</italic>. <ext-link ext-link-type="uri" xlink:href="http://wiki.cmci.info/downloads/frap_analysis">http://wiki.cmci.info/downloads/frap_analysis</ext-link> Accessed 12 Dec 2016 (2016).</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rapsomaniki</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EasyFRAP: an interactive, easy-to-use tool for qualitative and quantitative analysis of FRAP data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>1800</fpage>
        <lpage>1801</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts241</pub-id>
        <?supplied-pmid 22543368?>
        <pub-id pub-id-type="pmid">22543368</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Castle</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Howard</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Odde</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Assessment of transport mechanisms underlying the Bicoid morphogen gradient</article-title>
        <source>Cell. Mol. Bioeng.</source>
        <year>2011</year>
        <volume>4</volume>
        <fpage>116</fpage>
        <lpage>121</lpage>
        <pub-id pub-id-type="doi">10.1007/s12195-010-0157-4</pub-id>
        <?supplied-pmid 21892361?>
        <pub-id pub-id-type="pmid">21892361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nelder</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Mead</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A simplex method for function minimization</article-title>
        <source>Comput. J.</source>
        <year>1965</year>
        <volume>7</volume>
        <fpage>308</fpage>
        <lpage>313</lpage>
        <pub-id pub-id-type="doi">10.1093/comjnl/7.4.308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nash</surname>
            <given-names>SG</given-names>
          </name>
        </person-group>
        <article-title>Newton-type minimization via the Lanczos method</article-title>
        <source>SIAM J. Numer. Anal.</source>
        <year>1984</year>
        <volume>21</volume>
        <fpage>770</fpage>
        <lpage>788</lpage>
        <pub-id pub-id-type="doi">10.1137/0721052</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Nocedal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <source>Numerical optimization</source>
        <year>2006</year>
        <edition>2nd edn</edition>
        <publisher-loc>NY</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bläßle</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>PyFDAP: automated analysis of fluorescence decay after photoconversion (FDAP) experiments</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>972</fpage>
        <lpage>974</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu735</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Rogers, K. W., Bläßle, A., Schier, A. F. &amp; Müller, P. Measuring protein stability in living zebrafish embryos using fluorescence decay after photoconversion (FDAP). <italic>J. Vis. Exp</italic>. <bold>95</bold>, e52266 (2015).</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mai</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Are assumptions about the model type necessary in reaction-diffusion modeling? A FRAP application</article-title>
        <source>Biophys. J.</source>
        <year>2011</year>
        <volume>100</volume>
        <fpage>1178</fpage>
        <lpage>1188</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2011.01.041</pub-id>
        <?supplied-pmid 21354390?>
        <pub-id pub-id-type="pmid">21354390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Akaike</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A new look at the statistical model identification</article-title>
        <source>IEEE Trans. Autom. Control</source>
        <year>1974</year>
        <volume>19</volume>
        <fpage>716</fpage>
        <lpage>723</lpage>
        <pub-id pub-id-type="doi">10.1109/TAC.1974.1100705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Student.</collab>
        </person-group>
        <article-title>The probable error of a mean</article-title>
        <source>Biometrika</source>
        <year>1908</year>
        <volume>6</volume>
        <fpage>1</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/6.1.1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mann</surname>
            <given-names>HB</given-names>
          </name>
          <name>
            <surname>Whitney</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>On a test of whether one of two random variables is stochastically larger than the other</article-title>
        <source>Ann. Math. Stat.</source>
        <year>1947</year>
        <volume>18</volume>
        <fpage>50</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177730491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shapiro</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Wilk</surname>
            <given-names>MB</given-names>
          </name>
        </person-group>
        <article-title>An analysis of variance test for normality (complete samples)</article-title>
        <source>Biometrika</source>
        <year>1965</year>
        <volume>52</volume>
        <fpage>591</fpage>
        <lpage>611</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/52.3-4.591</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <mixed-citation publication-type="other">Aaron, J. <italic>FRAP</italic><ext-link ext-link-type="uri" xlink:href="https://de.mathworks.com/matlabcentral/fileexchange/47327-frap-zip">https://de.mathworks.com/matlabcentral/fileexchange/47327-frap-zip</ext-link> Accessed 12 Dec 2016 (2016).</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ulrich</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tropical-parameter estimation and simulation of reaction-diffusion models based on spatio-temporal microscopy images</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>2709</fpage>
        <lpage>2710</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl456</pub-id>
        <?supplied-pmid 16940327?>
        <pub-id pub-id-type="pmid">16940327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurskaya</surname>
            <given-names>NG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Engineering of a monomeric green-to-red photoactivatable fluorescent protein induced by blue light</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2006</year>
        <volume>24</volume>
        <fpage>461</fpage>
        <lpage>465</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1191</pub-id>
        <?supplied-pmid 16550175?>
        <pub-id pub-id-type="pmid">16550175</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hrabe</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hrabetová</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Segeth</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A model of effective diffusion and tortuosity in the extracellular space of the brain</article-title>
        <source>Biophys. J.</source>
        <year>2004</year>
        <volume>87</volume>
        <fpage>1606</fpage>
        <lpage>1617</lpage>
        <pub-id pub-id-type="doi">10.1529/biophysj.103.039495</pub-id>
        <?supplied-pmid 15345540?>
        <pub-id pub-id-type="pmid">15345540</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Maximum geometrical hindrance to diffusion in brain extracellular space surrounding uniformly spaced convex cells</article-title>
        <source>J. Theor. Biol.</source>
        <year>2004</year>
        <volume>229</volume>
        <fpage>59</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2004.03.003</pub-id>
        <?supplied-pmid 15178185?>
        <pub-id pub-id-type="pmid">15178185</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Novak</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Kraikivski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Slepchenko</surname>
            <given-names>BM</given-names>
          </name>
        </person-group>
        <article-title>Diffusion in cytoplasm: effects of excluded volume due to internal membranes and cytoskeletal structures</article-title>
        <source>Biophys. J.</source>
        <year>2009</year>
        <volume>97</volume>
        <fpage>758</fpage>
        <lpage>767</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bpj.2009.05.036</pub-id>
        <?supplied-pmid 19651034?>
        <pub-id pub-id-type="pmid">19651034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Donovan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chehreghanianzabi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Rathinam</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zustiak</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Homogenization theory for the prediction of obstructed solute diffusivity in macromolecular solutions</article-title>
        <source>PLoS ONE</source>
        <year>2016</year>
        <volume>11</volume>
        <fpage>e0146093</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0146093</pub-id>
        <?supplied-pmid 26731550?>
        <pub-id pub-id-type="pmid">26731550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Periasamy</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Verkman</surname>
            <given-names>AS</given-names>
          </name>
        </person-group>
        <article-title>Analysis of fluorophore diffusion by continuous distributions of diffusion coefficients: application to photobleaching measurements of multicomponent and anomalous diffusion</article-title>
        <source>Biophys. J.</source>
        <year>1998</year>
        <volume>75</volume>
        <fpage>557</fpage>
        <lpage>567</lpage>
        <pub-id pub-id-type="doi">10.1016/S0006-3495(98)77545-9</pub-id>
        <?supplied-pmid 9649418?>
        <pub-id pub-id-type="pmid">9649418</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiong</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sizing nanomaterials in bio-fluids by cFRAP enables protein aggregation measurements and diagnosis of bio-barrier permeability</article-title>
        <source>Nat. Commun.</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>12982</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms12982</pub-id>
        <?supplied-pmid 27653841?>
        <pub-id pub-id-type="pmid">27653841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Höckendorf</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Thumberger</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wittbrodt</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Quantitative analysis of embryogenesis: a perspective for light sheet microscopy</article-title>
        <source>Dev. Cell.</source>
        <year>2012</year>
        <volume>23</volume>
        <fpage>1111</fpage>
        <lpage>1120</lpage>
        <pub-id pub-id-type="doi">10.1016/j.devcel.2012.10.008</pub-id>
        <?supplied-pmid 23237945?>
        <pub-id pub-id-type="pmid">23237945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>SR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fgf8 morphogen gradient forms by a source-sink mechanism with freely diffusing molecules</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>461</volume>
        <fpage>533</fpage>
        <lpage>536</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08391</pub-id>
        <?supplied-pmid 19741606?>
        <pub-id pub-id-type="pmid">19741606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimmel</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Ballard</surname>
            <given-names>WW</given-names>
          </name>
          <name>
            <surname>Kimmel</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Ullmann</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schilling</surname>
            <given-names>TF</given-names>
          </name>
        </person-group>
        <article-title>Stages of embryonic development of the zebrafish</article-title>
        <source>Dev. Dyn.</source>
        <year>1995</year>
        <volume>203</volume>
        <fpage>253</fpage>
        <lpage>310</lpage>
        <pub-id pub-id-type="doi">10.1002/aja.1002030302</pub-id>
        <?supplied-pmid 8589427?>
        <pub-id pub-id-type="pmid">8589427</pub-id>
      </element-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Welch</surname>
            <given-names>BL</given-names>
          </name>
        </person-group>
        <article-title>The generalisation of Student’s problems when several different population variances are involved</article-title>
        <source>Biometrika</source>
        <year>1947</year>
        <volume>34</volume>
        <fpage>28</fpage>
        <lpage>35</lpage>
        <?supplied-pmid 20287819?>
        <pub-id pub-id-type="pmid">20287819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Razali</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Wah</surname>
            <given-names>YB</given-names>
          </name>
        </person-group>
        <article-title>Power comparisons of Shapiro-Wilk, Kolmogorov-Smirnov, Lilliefors and Anderson-Darling tests</article-title>
        <source>J. Stat. Model. Anal.</source>
        <year>2011</year>
        <volume>2</volume>
        <fpage>21</fpage>
        <lpage>33</lpage>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilcoxon</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Individual comparisons by ranking methods</article-title>
        <source>Biom. Bull.</source>
        <year>1945</year>
        <volume>1</volume>
        <fpage>80</fpage>
        <lpage>83</lpage>
        <pub-id pub-id-type="doi">10.2307/3001968</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
