<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8023491</article-id>
    <article-id pub-id-type="pmid">33764977</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-20-00576</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1008814</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune System Proteins</subject>
            <subj-group>
              <subject>Immune Receptors</subject>
              <subj-group>
                <subject>T Cell Receptors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune System Proteins</subject>
            <subj-group>
              <subject>Immune Receptors</subject>
              <subj-group>
                <subject>T Cell Receptors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>Immune System Proteins</subject>
              <subj-group>
                <subject>Immune Receptors</subject>
                <subj-group>
                  <subject>T Cell Receptors</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Signal Transduction</subject>
            <subj-group>
              <subject>Immune Receptors</subject>
              <subj-group>
                <subject>T Cell Receptors</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Biochemistry</subject>
          <subj-group>
            <subject>Proteins</subject>
            <subj-group>
              <subject>T Cell Receptors</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Blood Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                  <subj-group>
                    <subject>T Cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Cell Biology</subject>
          <subj-group>
            <subject>Cellular Types</subject>
            <subj-group>
              <subject>Animal Cells</subject>
              <subj-group>
                <subject>Immune Cells</subject>
                <subj-group>
                  <subject>White Blood Cells</subject>
                  <subj-group>
                    <subject>T Cells</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
              <subj-group>
                <subject>T Cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Immunology</subject>
          <subj-group>
            <subject>Immune Cells</subject>
            <subj-group>
              <subject>White Blood Cells</subject>
              <subj-group>
                <subject>T Cells</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>RNA viruses</subject>
              <subj-group>
                <subject>Orthomyxoviruses</subject>
                <subj-group>
                  <subject>Influenza viruses</subject>
                  <subj-group>
                    <subject>Influenza A virus</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical microbiology</subject>
            <subj-group>
              <subject>Microbial pathogens</subject>
              <subj-group>
                <subject>Viral pathogens</subject>
                <subj-group>
                  <subject>Orthomyxoviruses</subject>
                  <subj-group>
                    <subject>Influenza viruses</subject>
                    <subj-group>
                      <subject>Influenza A virus</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and health sciences</subject>
        <subj-group>
          <subject>Pathology and laboratory medicine</subject>
          <subj-group>
            <subject>Pathogens</subject>
            <subj-group>
              <subject>Microbial pathogens</subject>
              <subj-group>
                <subject>Viral pathogens</subject>
                <subj-group>
                  <subject>Orthomyxoviruses</subject>
                  <subj-group>
                    <subject>Influenza viruses</subject>
                    <subj-group>
                      <subject>Influenza A virus</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>Viral pathogens</subject>
              <subj-group>
                <subject>Orthomyxoviruses</subject>
                <subj-group>
                  <subject>Influenza viruses</subject>
                  <subj-group>
                    <subject>Influenza A virus</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Alignment</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical Microbiology</subject>
            <subj-group>
              <subject>Microbial Pathogens</subject>
              <subj-group>
                <subject>Viral Pathogens</subject>
                <subj-group>
                  <subject>Immunodeficiency Viruses</subject>
                  <subj-group>
                    <subject>HIV</subject>
                    <subj-group>
                      <subject>HIV-1</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Pathology and Laboratory Medicine</subject>
          <subj-group>
            <subject>Pathogens</subject>
            <subj-group>
              <subject>Microbial Pathogens</subject>
              <subj-group>
                <subject>Viral Pathogens</subject>
                <subj-group>
                  <subject>Immunodeficiency Viruses</subject>
                  <subj-group>
                    <subject>HIV</subject>
                    <subj-group>
                      <subject>HIV-1</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>Viral Pathogens</subject>
              <subj-group>
                <subject>Immunodeficiency Viruses</subject>
                <subj-group>
                  <subject>HIV</subject>
                  <subj-group>
                    <subject>HIV-1</subject>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>Immunodeficiency Viruses</subject>
              <subj-group>
                <subject>HIV</subject>
                <subj-group>
                  <subject>HIV-1</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and life sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>RNA viruses</subject>
              <subj-group>
                <subject>Retroviruses</subject>
                <subj-group>
                  <subject>Lentivirus</subject>
                  <subj-group>
                    <subject>HIV</subject>
                    <subj-group>
                      <subject>HIV-1</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Medical Microbiology</subject>
            <subj-group>
              <subject>Microbial Pathogens</subject>
              <subj-group>
                <subject>Viral Pathogens</subject>
                <subj-group>
                  <subject>Retroviruses</subject>
                  <subj-group>
                    <subject>Lentivirus</subject>
                    <subj-group>
                      <subject>HIV</subject>
                      <subj-group>
                        <subject>HIV-1</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Pathology and Laboratory Medicine</subject>
          <subj-group>
            <subject>Pathogens</subject>
            <subj-group>
              <subject>Microbial Pathogens</subject>
              <subj-group>
                <subject>Viral Pathogens</subject>
                <subj-group>
                  <subject>Retroviruses</subject>
                  <subj-group>
                    <subject>Lentivirus</subject>
                    <subj-group>
                      <subject>HIV</subject>
                      <subj-group>
                        <subject>HIV-1</subject>
                      </subj-group>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Organisms</subject>
          <subj-group>
            <subject>Viruses</subject>
            <subj-group>
              <subject>Viral Pathogens</subject>
              <subj-group>
                <subject>Retroviruses</subject>
                <subj-group>
                  <subject>Lentivirus</subject>
                  <subj-group>
                    <subject>HIV</subject>
                    <subj-group>
                      <subject>HIV-1</subject>
                    </subj-group>
                  </subj-group>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Cognitive Science</subject>
            <subj-group>
              <subject>Cognitive Psychology</subject>
              <subj-group>
                <subject>Learning</subject>
                <subj-group>
                  <subject>Learning Curves</subject>
                </subj-group>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Psychology</subject>
          <subj-group>
            <subject>Cognitive Psychology</subject>
            <subj-group>
              <subject>Learning</subject>
              <subj-group>
                <subject>Learning Curves</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Social Sciences</subject>
        <subj-group>
          <subject>Psychology</subject>
          <subj-group>
            <subject>Cognitive Psychology</subject>
            <subj-group>
              <subject>Learning</subject>
              <subj-group>
                <subject>Learning Curves</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Learning and Memory</subject>
            <subj-group>
              <subject>Learning</subject>
              <subj-group>
                <subject>Learning Curves</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Molecular Biology</subject>
          <subj-group>
            <subject>Molecular Biology Techniques</subject>
            <subj-group>
              <subject>Sequencing Techniques</subject>
              <subj-group>
                <subject>Protein Sequencing</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Molecular Biology Techniques</subject>
          <subj-group>
            <subject>Sequencing Techniques</subject>
            <subj-group>
              <subject>Protein Sequencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Carcinoma</subject>
              <subj-group>
                <subject>Hepatocellular Carcinoma</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Oncology</subject>
          <subj-group>
            <subject>Cancers and Neoplasms</subject>
            <subj-group>
              <subject>Gastrointestinal Tumors</subject>
              <subj-group>
                <subject>Hepatocellular Carcinoma</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Gastroenterology and Hepatology</subject>
          <subj-group>
            <subject>Liver Diseases</subject>
            <subj-group>
              <subject>Hepatocellular Carcinoma</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Predicting recognition between T cell receptors and epitopes with TCRGP</article-title>
      <alt-title alt-title-type="running-head">Predicting recognition between T cell receptors and epitopes with TCRGP</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0060-6868</contrib-id>
        <name>
          <surname>Jokinen</surname>
          <given-names>Emmi</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2750-4033</contrib-id>
        <name>
          <surname>Huuhtanen</surname>
          <given-names>Jani</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Validation</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0816-8241</contrib-id>
        <name>
          <surname>Mustjoki</surname>
          <given-names>Satu</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7741-2279</contrib-id>
        <name>
          <surname>Heinonen</surname>
          <given-names>Markus</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff005">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lähdesmäki</surname>
          <given-names>Harri</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Computer Science, Aalto University, Espoo, Finland</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Translational Immunology Research program and Department of Clinical Chemistry and Hematology, University of Helsinki, Helsinki, Finland</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Hematology Research Unit Helsinki, Helsinki University Hospital Comprehensive Cancer Center, Helsinki, Finland</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>iCAN Digital Precision Cancer Medicine Flagship, Helsinki, Finland</addr-line>
    </aff>
    <aff id="aff005">
      <label>5</label>
      <addr-line>Helsinki Institute for Information Technology, Espoo, Finland</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Ofran</surname>
          <given-names>Yanay</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Bar Ilan University, ISRAEL</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>emmi.jokinen@aalto.fi</email> (EJ); <email>harri.lahdesmaki@aalto.fi</email> (HL)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <volume>17</volume>
    <issue>3</issue>
    <elocation-id>e1008814</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>2</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Jokinen et al</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Jokinen et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1008814.pdf"/>
    <abstract>
      <p>Adaptive immune system uses T cell receptors (TCRs) to recognize pathogens and to consequently initiate immune responses. TCRs can be sequenced from individuals and methods analyzing the specificity of the TCRs can help us better understand individuals’ immune status in different disorders. For this task, we have developed TCRGP, a novel Gaussian process method that predicts if TCRs recognize specified epitopes. TCRGP can utilize the amino acid sequences of the complementarity determining regions (CDRs) from TCR<italic>α</italic> and TCR<italic>β</italic> chains and learn which CDRs are important in recognizing different epitopes. Our comprehensive evaluation with epitope-specific TCR sequencing data shows that TCRGP achieves on average higher prediction accuracy in terms of AUROC score than existing state-of-the-art methods in epitope-specificity predictions. We also propose a novel analysis approach for combined single-cell RNA and TCR<italic>αβ</italic> (scRNA+TCR<italic>αβ</italic>) sequencing data by quantifying epitope-specific TCRs with TCRGP and identify HBV-epitope specific T cells and their transcriptomic states in hepatocellular carcinoma patients.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>Humans have dedicated cells called T cells that recognize potentially harmful invaders using T cell receptors (TCRs) and protect us from infections. Each person has billions of T cells and millions of different kinds of TCRs that enable us to recognize a large variety of invaders. When for example a virus enters the body, T cells with TCRs recognizing that virus multiply and fight it. After such attacks, T cells that recognized the virus, remain in the body, forming an immunological memory. T cells thus characterize a person’s infection history, but in order to reveal it, we need to determine which epitopes, molecular signatures of the invaders, different TCRs can recognize. We can characterize which TCRs recognize certain epitopes experimentally, but this is a time and sample consuming task and is not often possible with scarce patient samples such as biopsies. However, previously produced experimental data has enabled us to develop a computational method, TCRGP, that can predict which epitopes a TCR recognizes with a higher accuracy than previous methods. As a computational method, TCRGP spares resources from time and sample consuming experimental validations and offers an interesting way to analyze publicly available TCR data.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002341</institution-id>
            <institution>Academy of Finland</institution>
          </institution-wrap>
        </funding-source>
        <award-id>314442 (Terva Program: Heal-Art consortium)</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0816-8241</contrib-id>
          <name>
            <surname>Mustjoki</surname>
            <given-names>Satu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100010663</institution-id>
            <institution>H2020 European Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>647355 (M-IMM project)</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0816-8241</contrib-id>
          <name>
            <surname>Mustjoki</surname>
            <given-names>Satu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution>ERA PerMed</institution>
        </funding-source>
        <award-id>(JAKSTAT-TARGET consortium)</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0816-8241</contrib-id>
          <name>
            <surname>Mustjoki</surname>
            <given-names>Satu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution>Finnish special governmental subsidy for health sciences, research and training</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0816-8241</contrib-id>
          <name>
            <surname>Mustjoki</surname>
            <given-names>Satu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100006306</institution-id>
            <institution>Sigrid Juséliuksen Säätiö</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0816-8241</contrib-id>
          <name>
            <surname>Mustjoki</surname>
            <given-names>Satu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award006">
        <funding-source>
          <institution>Cancer Foundation of Finland</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-0816-8241</contrib-id>
          <name>
            <surname>Mustjoki</surname>
            <given-names>Satu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award007">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002341</institution-id>
            <institution>Academy of Finland</institution>
          </institution-wrap>
        </funding-source>
        <award-id>314445 (Terva program: Heal-Art consortium)</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>Harri</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award008">
        <funding-source>
          <institution>Academy of Finland</institution>
        </funding-source>
        <award-id>335436 (Terva program: Heal-Art consortium)</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>Harri</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award009">
        <funding-source>
          <institution>Academy of Finland</institution>
        </funding-source>
        <award-id>311584 (Quantifying molecular networks at single-cell level)</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>Harri</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award010">
        <funding-source>
          <institution>Academy of Finland</institution>
        </funding-source>
        <award-id>313271 (ICT 2023 programme: TensorMed consortium)</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>Harri</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award011">
        <funding-source>
          <institution>Cancer Foundation of Finland</institution>
        </funding-source>
        <principal-award-recipient>
          <name>
            <surname>Lähdesmäki</surname>
            <given-names>Harri</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This study was supported by Academy of Finland <ext-link ext-link-type="uri" xlink:href="https://www.aka.fi/en)">https://www.aka.fi/en)</ext-link> under grant number 314442 to SM, by 647355 (M-IMM project); H2020 European Research Council (ERC), <ext-link ext-link-type="uri" xlink:href="https://erc.europa.eu">https://erc.europa.eu</ext-link> to SM, by ERA PerMed (JAKSTAT-TARGET consortium) <ext-link ext-link-type="uri" xlink:href="http://www.erapermed.eu">http://www.erapermed.eu</ext-link> to SM, by Finnish special governmental subsidy for health sciences, research and training, <ext-link ext-link-type="uri" xlink:href="https://minedu.fi/en/subsidies">https://minedu.fi/en/subsidies</ext-link> to SM, by The Sigrid Juselius Foundation, <ext-link ext-link-type="uri" xlink:href="https://sigridjuselius.fi/en">https://sigridjuselius.fi/en</ext-link> to SM and by the Cancer Foundation of Finland, <ext-link ext-link-type="uri" xlink:href="https://syopasaatio.fi/en">https://syopasaatio.fi/en</ext-link> to SM. HL received support under grant numbers 314445, 335436 (Terva program: Heal-Art consortium); from Academy of Finland, <ext-link ext-link-type="uri" xlink:href="https://www.aka.fi/en">https://www.aka.fi/en</ext-link>, 311584 (Quantifying molecular networks at single-cell level), from Academy of Finland, <ext-link ext-link-type="uri" xlink:href="https://www.aka.fi/en">https://www.aka.fi/en</ext-link>, 313271 (ICT 2023 programme: TensorMed consortium); from Academy of Finland, <ext-link ext-link-type="uri" xlink:href="https://www.aka.fi/en">https://www.aka.fi/en</ext-link>, and from Cancer Foundation of Finland, <ext-link ext-link-type="uri" xlink:href="https://syopasaatio.fi/en">https://syopasaatio.fi/en</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="5"/>
      <table-count count="4"/>
      <page-count count="27"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>PLOS Publication Stage</meta-name>
        <meta-value>vor-update-to-uncorrected-proof</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>Publication Update</meta-name>
        <meta-value>2021-04-06</meta-value>
      </custom-meta>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>We have only utilized previously published data. For convenience, all files are available at our Github-pages together with the software implementations (<ext-link ext-link-type="uri" xlink:href="https://github.com/emmijokinen/TCRGP">https://github.com/emmijokinen/TCRGP</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/janihuuh/tcrgp_manu_hcc">https://github.com/janihuuh/tcrgp_manu_hcc</ext-link>). We have obtained the Dash data and the control TCR sequences from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature22383">https://doi.org/10.1038/nature22383</ext-link>, and the raw data is available at Sequence Read Archive (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/">https://www.ncbi.nlm.nih.gov/sra/</ext-link>) under accession number SRP101659. The VDJdb data has been obtained from VDJdb: a curated database of T-cell receptor sequences with known antigen specificity (<ext-link ext-link-type="uri" xlink:href="https://vdjdb.cdr3.net/">https://vdjdb.cdr3.net/</ext-link>). The HBV and SARS-CoV-2 specific TCR sequences are available in the immunoSEQ Analyzer database (<ext-link ext-link-type="uri" xlink:href="https://clients.adaptivebiotech.com">https://clients.adaptivebiotech.com</ext-link>) at <ext-link ext-link-type="uri" xlink:href="https://clients.adaptivebiotech.com/pub/cheng-2018-sciimmunol">https://clients.adaptivebiotech.com/pub/cheng-2018-sciimmunol</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://clients.adaptivebiotech.com/pub/covid-2020">https://clients.adaptivebiotech.com/pub/covid-2020</ext-link>, respectively. Finally, the single-cell data for T cells from liver cancer patients is available at Gene Expression Omnibus (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo">https://www.ncbi.nlm.nih.gov/geo</ext-link>) under accession number GSE98638.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>We have only utilized previously published data. For convenience, all files are available at our Github-pages together with the software implementations (<ext-link ext-link-type="uri" xlink:href="https://github.com/emmijokinen/TCRGP">https://github.com/emmijokinen/TCRGP</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/janihuuh/tcrgp_manu_hcc">https://github.com/janihuuh/tcrgp_manu_hcc</ext-link>). We have obtained the Dash data and the control TCR sequences from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature22383">https://doi.org/10.1038/nature22383</ext-link>, and the raw data is available at Sequence Read Archive (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/sra/">https://www.ncbi.nlm.nih.gov/sra/</ext-link>) under accession number SRP101659. The VDJdb data has been obtained from VDJdb: a curated database of T-cell receptor sequences with known antigen specificity (<ext-link ext-link-type="uri" xlink:href="https://vdjdb.cdr3.net/">https://vdjdb.cdr3.net/</ext-link>). The HBV and SARS-CoV-2 specific TCR sequences are available in the immunoSEQ Analyzer database (<ext-link ext-link-type="uri" xlink:href="https://clients.adaptivebiotech.com">https://clients.adaptivebiotech.com</ext-link>) at <ext-link ext-link-type="uri" xlink:href="https://clients.adaptivebiotech.com/pub/cheng-2018-sciimmunol">https://clients.adaptivebiotech.com/pub/cheng-2018-sciimmunol</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://clients.adaptivebiotech.com/pub/covid-2020">https://clients.adaptivebiotech.com/pub/covid-2020</ext-link>, respectively. Finally, the single-cell data for T cells from liver cancer patients is available at Gene Expression Omnibus (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo">https://www.ncbi.nlm.nih.gov/geo</ext-link>) under accession number GSE98638.</p>
  </notes>
</front>
<body>
  <disp-quote>
    <p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
  </disp-quote>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>The adaptive immune system implements various complex mechanisms for surveillance against both pathogens and pathological cells arising in our body. To initiate an adequate adaptive immune response, a peptide, called epitope, must first be bound by the major histocompatibility complex (MHC) class I or II molecule expressed on the surface of a nucleated cell or a professional antigen-presenting cell, respectively. The peptide-MHC (pMHC) complex is then presented to T cells which can recognize the complex via T cell receptor (TCR) proteins, consequently leading to T cell activation and proliferation by clonal expansion [<xref rid="pcbi.1008814.ref001" ref-type="bibr">1</xref>]. During clonal expansion, a fraction of T cells gain a long-living memory phenotype and therefore a clonal population of T cells with identical TCR rearrangements remain for years against the recognized antigen [<xref rid="pcbi.1008814.ref002" ref-type="bibr">2</xref>], thus forming a potentially decodable immunological signature. Learning these signatures could have implications in broad range of clinical applications including infectious diseases, autoimmunity and tumor immunology.</p>
    <p>T cells undergo non-homologous recombination during T cell development, which involves rearrangement of the germline TCR loci from a large collection of variable (V), diversity (D) and joining (J) gene segments as well as template-independent insertions and deletions at the V-D and D-J junctions [<xref rid="pcbi.1008814.ref003" ref-type="bibr">3</xref>, <xref rid="pcbi.1008814.ref004" ref-type="bibr">4</xref>]. TCRs are formed by a pair of <italic>α</italic>- and <italic>β</italic>-chains (90-95% of T cells) or <italic>γ</italic> and <italic>δ</italic>-chains (5-10%) and V(D)J recombination happens in each locus independently. It is estimated that this rearrangement can result in the range of 10<sup>18</sup> different TCR genes [<xref rid="pcbi.1008814.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1008814.ref006" ref-type="bibr">6</xref>] which provides enormous diversity for epitope-specific T cell repertoires.</p>
    <p>The complementarity determining regions (CDRs) of a TCR determine whether the TCR recognizes and binds to an antigen or not [<xref rid="pcbi.1008814.ref007" ref-type="bibr">7</xref>]. Of these regions, CDR3 is the most variable and primarily interacts with the peptide, while CDR1 and CDR2 primarily interact with the peptide binding groove of the MHC protein presenting the peptide but they can also be directly in contact with the peptide [<xref rid="pcbi.1008814.ref008" ref-type="bibr">8</xref>, <xref rid="pcbi.1008814.ref009" ref-type="bibr">9</xref>]. Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] noted that also a loop between CDR2 and CDR3 (IMGT positions 81-86 [<xref rid="pcbi.1008814.ref011" ref-type="bibr">11</xref>]), which they called CDR2.5, has sometimes been observed to make contact with pMHC in solved structures.</p>
    <p>It is well known that the CDR3<italic>β</italic> of a TCR is important in recognizing peptides presented to the T cell, but it still remains unclear which specific physicochemical or structural features of the CDR3<italic>β</italic> or of other parts of the TCR determine the antigen recognition specificity of the T cell. High-throughput sequencing of V- and J-segment enriched DNA has enabled large-scale characterization of TCR sequences, initially only for the CDR3<italic>β</italic> with bulk methods [<xref rid="pcbi.1008814.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1008814.ref012" ref-type="bibr">12</xref>] but recently for the whole paired TCR<italic>αβ</italic> at single-cell resolution using plate or droplet-based methods [<xref rid="pcbi.1008814.ref013" ref-type="bibr">13</xref>, <xref rid="pcbi.1008814.ref014" ref-type="bibr">14</xref>]. Nevertheless, profiling of epitope-specific TCRs remains exhaustive as they require sample-consuming experiments with distinct pMHC-multimers for each epitope of interest. Therefore, there is a great need for models that examine which epitopes a TCR can recognize or to which TCRs an epitope can bind to [<xref rid="pcbi.1008814.ref015" ref-type="bibr">15</xref>]. Curated databases of experimentally verified TCR-peptide interactions have recently been launched, such as VDJdb, IEDB, and McPAS [<xref rid="pcbi.1008814.ref016" ref-type="bibr">16</xref>–<xref rid="pcbi.1008814.ref018" ref-type="bibr">18</xref>]. Such data sources enable more comprehensive, data-driven analysis of TCR-peptide interactions, and allow the use of statistical machine learning techniques for the aforementioned tasks. Yet only a few computational methods for predicting recognition between TCRs and epitopes [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1008814.ref019" ref-type="bibr">19</xref>–<xref rid="pcbi.1008814.ref022" ref-type="bibr">22</xref>] and for clustering similar TCRs [<xref rid="pcbi.1008814.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1008814.ref023" ref-type="bibr">23</xref>, <xref rid="pcbi.1008814.ref024" ref-type="bibr">24</xref>] have been published. In addition to supervised and unsupervised methods for predicting TCR-epitope interactions, computational methods and web services such as [<xref rid="pcbi.1008814.ref025" ref-type="bibr">25</xref>] have also been proposed to predict the structure of TCRs based on their amino acid sequences.</p>
    <p>We propose a method called TCRGP which builds on non-parametric modelling using Gaussian process (GP) classification. The probabilistic formulation of GPs allows robust model inference already from small data sets, which is a great benefit as currently there exists very limited amounts of reported TCR-epitope interactions in curated databases. As the space of all TCRs that can recognize a certain epitope is potentially very large, it is important to avoid overfitting to the limited sample of TCRs that is available. Indeed, TCRGP clearly outperforms the current state-of-the art methods for predicting the epitope specificity of TCRs. At the same time TCRGP can scale to exploit extremely large data sets of epitope-specific TCRs, which we expect to become more common in the future. We also analyze the effects of utilizing different sections of the TCR amino acid sequence and learn which of them are most important and examine how the number of TCRs used for training affects the predictions. Finally, we demonstrate the potential of TCRGP by analyzing single-cell RNA+TCR<italic>αβ</italic>-sequencing data from hepatocellular carcinoma patients.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Gaussian process classifier</title>
      <p>Gaussian processes (GP) are a flexible class of models that have become popular in machine learning and statistics with various applications in molecular biology, bioinformatics and other fields [<xref rid="pcbi.1008814.ref026" ref-type="bibr">26</xref>–<xref rid="pcbi.1008814.ref030" ref-type="bibr">30</xref>]. We have developed TCRGP, a GP based probabilistic classifier which can be trained to predict TCRs’ specificity to any epitope given sufficient training data for the specified epitope. GPs implement a Bayesian nonparametric kernel method for learning from data. They differ from standard parametric models in that instead of learning the parameters of a predefined function, they define priors for the entire class of nonlinear functions and learn a suitable function for the prediction task. Properties of GPs are defined by the kernel function, which is a function of objects that we want to classify. TCRGP uses Gaussian process classification with variational inference [<xref rid="pcbi.1008814.ref031" ref-type="bibr">31</xref>, <xref rid="pcbi.1008814.ref032" ref-type="bibr">32</xref>]</p>
      <p>To train a GP classifier for predicting if TCRs recognize a certain epitope, a set of training data consisting of TCRs that are known to recognize and to not recognize that epitope are required. TCRGP can utilize CDR3 amino acid sequences from both TCR <italic>α</italic>- and <italic>β</italic>-chains as well as CDR1, CDR2, and CDR2.5 sequences which can be determined from V<italic>α</italic>- and V<italic>β</italic>-genes. The different CDRs are then aligned within each CDR type using the IMGT definitions and a numerical presentation of them is formed using principal components of a modified BLOSUM62 substitution matrix (see <xref ref-type="fig" rid="pcbi.1008814.g001">Fig 1A</xref>).</p>
      <fig id="pcbi.1008814.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008814.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>TCRGP pipeline for training a classifier to predict if new unseen TCRs recognize a certain epitope.</title>
          <p><bold>(A)</bold> Sequence preparation. For the training, TCRs specific to the epitope of interest and control sequences not recognizing the epitope are required. TCRGP can utilize CDR3, CDR1, CDR2, and CDR2.5 sequences from both TCR <italic>α</italic>- and <italic>β</italic>-chains. A separate alignment is created for each CDR type and the aligned sequences are given numerical presentations. We use principal components of a modified BLOSUM62 substitution matrix to encode each amino acid. We utilize all 21 components, but in this illustration we only show the first components. <bold>(B)</bold> Using the numerical presentation, we create separate covariance matrices for each CDR type. During the training of the Gaussian process classifier, an optimal combination of the base kernels and their parameters are learned. <bold>(C)</bold> When the classifier has been trained, we can make probabilistic predictions for new TCRs.</p>
        </caption>
        <graphic xlink:href="pcbi.1008814.g001"/>
      </fig>
      <p>Using the numerical presentations, a separate covariance matrix is created for each CDR type. The covariance matrices measure similarity between all pairs of TCRs (separately for each CDR type). The GP then learns optimal parameters for the kernel functions that define the covariance matrices for each CDR type and learns simultaneously an optimal combination of these kernel functions. As the model can determine itself the weights for each CDR type, it can learn which CDRs are important for the classification task. Due to the probabilistic nature of GPs, we can use marginal likelihood maximisation for the optimisation and do not require additional data for validating the learned parameters. This is a great benefit, when there exists limited amounts of epitope-specific TCRs, which is currently the case with many epitopes. Moreover, by using sparse variational inference, the GPs can also scale to extremely large data sets when more data is available (see <xref ref-type="fig" rid="pcbi.1008814.g001">Fig 1B</xref>).</p>
      <p>Once the TCRGP classifier has been trained, it can be used to provide predictions to new, previously unseen, TCRs. The certainty of the predictions is encoded in the predicted values: If the prediction for a TCR is close to one, it is very likely to recognize the epitope in question, if it is close to zero, the TCR very likely does not recognize the epitope. However, if the prediction is around 0.5, the model cannot give a prediction with much certainty to that TCR (see <xref ref-type="fig" rid="pcbi.1008814.g001">Fig 1C</xref>). A more detailed description of TCRGP can be found from the Materials and Methods section.</p>
      <p>We use two data sets to demonstrate TCRGP’s accuracy in predicting TCR epitope specificity: a recently published data set of tetramer sorted TCR sequences for 10 epitopes, introduced by Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] (Dash data), and a new dataset of medium and high quality epitope-specific TCR sequences extracted from VDJdb database [<xref rid="pcbi.1008814.ref016" ref-type="bibr">16</xref>] (VDJdb data). The Dash data provides a large set of epitope-specific paired TCR<italic>αβ</italic>-data and the VDJdb data provides a comprehensive selection of available epitope-specific TCR<italic>β</italic>-data currently available. We also considered using using TCRs from IEDB [<xref rid="pcbi.1008814.ref017" ref-type="bibr">17</xref>] and McPAS [<xref rid="pcbi.1008814.ref018" ref-type="bibr">18</xref>], but they had significant overlap with VDJdb and their collections of TCR<italic>β</italic>s were not as extensive. Both of the selected data sets are combined with a set of background TCRs, also presented by Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] that are not expected to recognize the epitopes in the two data sets. Our work is accompanied by an efficient software implementation that contains trained models for predicting TCRs’ specificity to epitopes involved in data sets used in this study as well as tools for building new epitope specificity models from new datasets. The implementation and used data sets are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/emmijokinen/TCRGP">github.com/emmijokinen/TCRGP</ext-link>.</p>
    </sec>
    <sec id="sec004">
      <title>Significance of utilizing different CDRs</title>
      <p>To evaluate the benefit of using different CDRs, we used the Dash data which includes 4635 pMHC-tetramer sorted single-cell sequenced TCR<italic>αβ</italic> clonotypes from 10 epitope-specific repertoires. We trained our TCRGP model using either only CDR3 or also with CDR1, CDR2, and CDR2.5 from TCR<italic>α</italic>, TCR<italic>β</italic>, or both. We applied leave-one-subject-out cross-validation as described in Materials and Methods Section. <xref ref-type="fig" rid="pcbi.1008814.g002">Fig 2A</xref> presents the cross-validation results for a single BMLF1<sub>280-288</sub>-epitope from EBV and demonstrates how the classification results vary between different subjects likely due to the variety of the TCRs.</p>
      <fig id="pcbi.1008814.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008814.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Epitope-specificity prediction with the Dash data.</title>
          <p><bold>(A)</bold> The left panel shows the cross-validated ROC curves for each subject in the Dash data for BMLF1<sub>280-288</sub>, when TCRGP has been trained using all CDRs from TCR<italic>α</italic> and TCR<italic>β</italic>. The mean AUROC score is 0.905. The right panel shows the cross-validated ROC curve for all subjects and also the corresponding threshold values. From this figure we can determine which threshold values correspond to different true positive rates (TPRS) and false positive rates (FPRS). <bold>(B)</bold> Violin plots present the distributions of AUROC scores for the different epitopes obtained with models utilizing varying CDRs. The blue parts of the violin plots illustrate the AUROC scores of predictions made by TCRGP for all the epitopes. The orange sides illustrate the AUROC scores obtained with TCRdist. Each point within a violin plot presents the mean AUROC score obtained for one epitope. The used chains (<italic>α</italic> and/or <italic>β</italic>) and CDRs (three or all) are indicated below each panel. <bold>(C)</bold> Comparison of AUROC scores obtained with TCRGP and TCRdist using only CDR3 from TCR<italic>αβ</italic>, TCR<italic>β</italic>, or TCR<italic>α</italic> for each epitope separately. The epitopes have been arranged in increasing order of AUROC scores obtained by TCRGP using CDR3 from <italic>α</italic>- and <italic>β</italic>-chains (blue line). <bold>(D)</bold> Comparison of AUROC scores obtained with TCRGP and TCRdist using all CDRs from TCR<italic>αβ</italic>, TCR<italic>β</italic>, or TCR<italic>α</italic> for each epitope separately. The epitopes have been arranged in increasing order of AUROC scores obtained by TCRGP using all CDRs from <italic>α</italic>- and <italic>β</italic>-chains (blue line). <bold>(E)</bold> Fractions of total weight given to kernels corresponding to different CDRs, when TCRGP has been trained to predict which TCRs are specific to the epitopes in the Dash data using all CDRs from both TCR chains.</p>
        </caption>
        <graphic xlink:href="pcbi.1008814.g002"/>
      </fig>
      <p>AUROC scores of the predictions for different combinations of CDRs and <italic>α</italic>/<italic>β</italic> chains are summarized in <xref ref-type="fig" rid="pcbi.1008814.g002">Fig 2B</xref>. For comparison, we also trained TCRdist [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] in the same manner. <xref ref-type="fig" rid="pcbi.1008814.g002">Fig 2B</xref> shows that both methods, TCRGP and TCRdist, perform on average better when using TCR<italic>β</italic> than when using TCR<italic>α</italic>, although using both <italic>α</italic>- and <italic>β</italic>-chains generally provides the best results. There are few exceptions, as shown in <xref ref-type="fig" rid="pcbi.1008814.g002">Fig 2B–2D</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008814.s001">S1 Fig</xref> and <xref rid="pcbi.1008814.t001" ref-type="table">Table 1</xref>. For example, with epitope pp65 both methods perform better when using CDR3<italic>α</italic> instead of CDR3<italic>β</italic>. Overall TCRGP is better than TCRdist in utilizing information from CDRs other than CDR3. TCRGP achieves higher AUROC scores on average when trained using all CDRs instead of only CDR3, whereas with TCRdist the AUROC scores seem to be similar or better when only CDR3 is utilized. Notably TCRGP outperforms TCRdist in prediction accuracy for 57 of the 60 comparisons (<xref rid="pcbi.1008814.t001" ref-type="table">Table 1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008814.s001">S1 Fig</xref>). To quantify the significance of accuracy differences between different methods, we applied Wilcoxon signed-rank test to paired AUROC scores across epitopes. We used the test to study three questions: do AUROC scores differ between TCRGP and previous methods, is it better to use all CDRs or only CDR3s, and which chains should be used to produce best results. The Benjamini-Hochberg corrected P-values for these tests can be found from <xref ref-type="supplementary-material" rid="pcbi.1008814.s011">S2 File</xref>. These results support the above observations: TCRGP outperforms TCRdist, with TCRGP it is beneficial to use all CDRs, and the use of <italic>β</italic> chain generally gives better AUROC scores than <italic>α</italic> chain, although it is best to use both chains. It is noteworthy, that although Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] use leave-one-subject-out control, the results shown here differ somewhat from their results. The differences are likely caused by differences in the background TCRs as we have selected them randomly from the larger set of background TCRs provided by Dash et <italic>al.</italic></p>
      <table-wrap id="pcbi.1008814.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008814.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Mean AUROC scores for the Dash data using leave-one-subject-out cross-validation.</title>
          <p>TCRGP models and TCRdist models were trained using either only CDR3s or all CDRs from TCR<italic>αβ</italic>, TCR<italic>β</italic>, or TCR<italic>α</italic>.</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008814.t001g" xlink:href="pcbi.1008814.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="3" colspan="1"/>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="center" colspan="6" rowspan="1">TCRGP</th>
                <th align="center" colspan="6" rowspan="1">TCRdist</th>
              </tr>
              <tr>
                <th align="left" rowspan="1" colspan="1">chains</th>
                <th align="center" colspan="2" rowspan="1">
                  <italic>αβ</italic>
                </th>
                <th align="center" colspan="2" rowspan="1">
                  <italic>β</italic>
                </th>
                <th align="center" colspan="2" rowspan="1">
                  <italic>α</italic>
                </th>
                <th align="center" colspan="2" rowspan="1">
                  <italic>αβ</italic>
                </th>
                <th align="center" colspan="2" rowspan="1">
                  <italic>β</italic>
                </th>
                <th align="center" colspan="2" rowspan="1">
                  <italic>α</italic>
                </th>
              </tr>
              <tr>
                <th align="left" rowspan="1" colspan="1">cdrs</th>
                <th align="right" rowspan="1" colspan="1">3</th>
                <th align="left" rowspan="1" colspan="1">all</th>
                <th align="right" rowspan="1" colspan="1">3</th>
                <th align="left" rowspan="1" colspan="1">all</th>
                <th align="right" rowspan="1" colspan="1">3</th>
                <th align="left" rowspan="1" colspan="1">all</th>
                <th align="right" rowspan="1" colspan="1">3</th>
                <th align="left" rowspan="1" colspan="1">all</th>
                <th align="right" rowspan="1" colspan="1">3</th>
                <th align="left" rowspan="1" colspan="1">all</th>
                <th align="right" rowspan="1" colspan="1">3</th>
                <th align="left" rowspan="1" colspan="1">all</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">mean</td>
                <td align="char" char="." rowspan="1" colspan="1">0.871</td>
                <td align="char" char="." rowspan="1" colspan="1">0.913</td>
                <td align="char" char="." rowspan="1" colspan="1">0.830</td>
                <td align="char" char="." rowspan="1" colspan="1">0.883</td>
                <td align="char" char="." rowspan="1" colspan="1">0.823</td>
                <td align="char" char="." rowspan="1" colspan="1">0.856</td>
                <td align="char" char="." rowspan="1" colspan="1">0.834</td>
                <td align="char" char="." rowspan="1" colspan="1">0.828</td>
                <td align="char" char="." rowspan="1" colspan="1">0.807</td>
                <td align="char" char="." rowspan="1" colspan="1">0.797</td>
                <td align="char" char="." rowspan="1" colspan="1">0.781</td>
                <td align="char" char="." rowspan="1" colspan="1">0.732</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">EBV</td>
                <td align="left" rowspan="1" colspan="1">BMLF1<sub>280-288</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.876</td>
                <td align="char" char="." rowspan="1" colspan="1">0.906</td>
                <td align="char" char="." rowspan="1" colspan="1">0.818</td>
                <td align="char" char="." rowspan="1" colspan="1">0.877</td>
                <td align="char" char="." rowspan="1" colspan="1">0.862</td>
                <td align="char" char="." rowspan="1" colspan="1">0.877</td>
                <td align="char" char="." rowspan="1" colspan="1">0.875</td>
                <td align="char" char="." rowspan="1" colspan="1">0.830</td>
                <td align="char" char="." rowspan="1" colspan="1">0.816</td>
                <td align="char" char="." rowspan="1" colspan="1">0.774</td>
                <td align="char" char="." rowspan="1" colspan="1">0.821</td>
                <td align="char" char="." rowspan="1" colspan="1">0.778</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CMV</td>
                <td align="left" rowspan="1" colspan="1">pp65<sub>495-503</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.702</td>
                <td align="char" char="." rowspan="1" colspan="1">0.821</td>
                <td align="char" char="." rowspan="1" colspan="1">0.587</td>
                <td align="char" char="." rowspan="1" colspan="1">0.871</td>
                <td align="char" char="." rowspan="1" colspan="1">0.759</td>
                <td align="char" char="." rowspan="1" colspan="1">0.787</td>
                <td align="char" char="." rowspan="1" colspan="1">0.645</td>
                <td align="char" char="." rowspan="1" colspan="1">0.691</td>
                <td align="char" char="." rowspan="1" colspan="1">0.636</td>
                <td align="char" char="." rowspan="1" colspan="1">0.670</td>
                <td align="char" char="." rowspan="1" colspan="1">0.672</td>
                <td align="char" char="." rowspan="1" colspan="1">0.822</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">IAV</td>
                <td align="left" rowspan="1" colspan="1">M1<sub>58-66</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.781</td>
                <td align="char" char="." rowspan="1" colspan="1">0.833</td>
                <td align="char" char="." rowspan="1" colspan="1">0.782</td>
                <td align="char" char="." rowspan="1" colspan="1">0.834</td>
                <td align="char" char="." rowspan="1" colspan="1">0.769</td>
                <td align="char" char="." rowspan="1" colspan="1">0.768</td>
                <td align="char" char="." rowspan="1" colspan="1">0.769</td>
                <td align="char" char="." rowspan="1" colspan="1">0.768</td>
                <td align="char" char="." rowspan="1" colspan="1">0.774</td>
                <td align="char" char="." rowspan="1" colspan="1">0.729</td>
                <td align="char" char="." rowspan="1" colspan="1">0.716</td>
                <td align="char" char="." rowspan="1" colspan="1">0.686</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">IAV</td>
                <td align="left" rowspan="1" colspan="1">PB1-F2<sub>62-70</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.847</td>
                <td align="char" char="." rowspan="1" colspan="1">0.937</td>
                <td align="char" char="." rowspan="1" colspan="1">0.822</td>
                <td align="char" char="." rowspan="1" colspan="1">0.803</td>
                <td align="char" char="." rowspan="1" colspan="1">0.753</td>
                <td align="char" char="." rowspan="1" colspan="1">0.801</td>
                <td align="char" char="." rowspan="1" colspan="1">0.820</td>
                <td align="char" char="." rowspan="1" colspan="1">0.862</td>
                <td align="char" char="." rowspan="1" colspan="1">0.802</td>
                <td align="char" char="." rowspan="1" colspan="1">0.753</td>
                <td align="char" char="." rowspan="1" colspan="1">0.729</td>
                <td align="char" char="." rowspan="1" colspan="1">0.636</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">IAV</td>
                <td align="left" rowspan="1" colspan="1">NP<sub>366-374</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.906</td>
                <td align="char" char="." rowspan="1" colspan="1">0.928</td>
                <td align="char" char="." rowspan="1" colspan="1">0.897</td>
                <td align="char" char="." rowspan="1" colspan="1">0.907</td>
                <td align="char" char="." rowspan="1" colspan="1">0.821</td>
                <td align="char" char="." rowspan="1" colspan="1">0.847</td>
                <td align="char" char="." rowspan="1" colspan="1">0.874</td>
                <td align="char" char="." rowspan="1" colspan="1">0.818</td>
                <td align="char" char="." rowspan="1" colspan="1">0.841</td>
                <td align="char" char="." rowspan="1" colspan="1">0.788</td>
                <td align="char" char="." rowspan="1" colspan="1">0.781</td>
                <td align="char" char="." rowspan="1" colspan="1">0.709</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">IAV</td>
                <td align="left" rowspan="1" colspan="1">PA<sub>224-233</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.952</td>
                <td align="char" char="." rowspan="1" colspan="1">0.975</td>
                <td align="char" char="." rowspan="1" colspan="1">0.939</td>
                <td align="char" char="." rowspan="1" colspan="1">0.961</td>
                <td align="char" char="." rowspan="1" colspan="1">0.882</td>
                <td align="char" char="." rowspan="1" colspan="1">0.930</td>
                <td align="char" char="." rowspan="1" colspan="1">0.914</td>
                <td align="char" char="." rowspan="1" colspan="1">0.914</td>
                <td align="char" char="." rowspan="1" colspan="1">0.887</td>
                <td align="char" char="." rowspan="1" colspan="1">0.862</td>
                <td align="char" char="." rowspan="1" colspan="1">0.869</td>
                <td align="char" char="." rowspan="1" colspan="1">0.777</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">IAV</td>
                <td align="left" rowspan="1" colspan="1">PB1<sub>703-711</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.929</td>
                <td align="char" char="." rowspan="1" colspan="1">0.953</td>
                <td align="char" char="." rowspan="1" colspan="1">0.913</td>
                <td align="char" char="." rowspan="1" colspan="1">0.919</td>
                <td align="char" char="." rowspan="1" colspan="1">0.862</td>
                <td align="char" char="." rowspan="1" colspan="1">0.929</td>
                <td align="char" char="." rowspan="1" colspan="1">0.913</td>
                <td align="char" char="." rowspan="1" colspan="1">0.819</td>
                <td align="char" char="." rowspan="1" colspan="1">0.901</td>
                <td align="char" char="." rowspan="1" colspan="1">0.844</td>
                <td align="char" char="." rowspan="1" colspan="1">0.849</td>
                <td align="char" char="." rowspan="1" colspan="1">0.711</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mCMV</td>
                <td align="left" rowspan="1" colspan="1">m139<sub>419-426</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.877</td>
                <td align="char" char="." rowspan="1" colspan="1">0.888</td>
                <td align="char" char="." rowspan="1" colspan="1">0.721</td>
                <td align="char" char="." rowspan="1" colspan="1">0.806</td>
                <td align="char" char="." rowspan="1" colspan="1">0.844</td>
                <td align="char" char="." rowspan="1" colspan="1">0.821</td>
                <td align="char" char="." rowspan="1" colspan="1">0.773</td>
                <td align="char" char="." rowspan="1" colspan="1">0.785</td>
                <td align="char" char="." rowspan="1" colspan="1">0.656</td>
                <td align="char" char="." rowspan="1" colspan="1">0.779</td>
                <td align="char" char="." rowspan="1" colspan="1">0.769</td>
                <td align="char" char="." rowspan="1" colspan="1">0.683</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mCMV</td>
                <td align="left" rowspan="1" colspan="1">M38<sub>316-323</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.926</td>
                <td align="char" char="." rowspan="1" colspan="1">0.922</td>
                <td align="char" char="." rowspan="1" colspan="1">0.917</td>
                <td align="char" char="." rowspan="1" colspan="1">0.924</td>
                <td align="char" char="." rowspan="1" colspan="1">0.868</td>
                <td align="char" char="." rowspan="1" colspan="1">0.902</td>
                <td align="char" char="." rowspan="1" colspan="1">0.921</td>
                <td align="char" char="." rowspan="1" colspan="1">0.918</td>
                <td align="char" char="." rowspan="1" colspan="1">0.920</td>
                <td align="char" char="." rowspan="1" colspan="1">0.914</td>
                <td align="char" char="." rowspan="1" colspan="1">0.844</td>
                <td align="char" char="." rowspan="1" colspan="1">0.789</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">mCMV</td>
                <td align="left" rowspan="1" colspan="1">M45<sub>985-993</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.920</td>
                <td align="char" char="." rowspan="1" colspan="1">0.962</td>
                <td align="char" char="." rowspan="1" colspan="1">0.891</td>
                <td align="char" char="." rowspan="1" colspan="1">0.923</td>
                <td align="char" char="." rowspan="1" colspan="1">0.851</td>
                <td align="char" char="." rowspan="1" colspan="1">0.916</td>
                <td align="char" char="." rowspan="1" colspan="1">0.876</td>
                <td align="char" char="." rowspan="1" colspan="1">0.879</td>
                <td align="char" char="." rowspan="1" colspan="1">0.846</td>
                <td align="char" char="." rowspan="1" colspan="1">0.838</td>
                <td align="char" char="." rowspan="1" colspan="1">0.796</td>
                <td align="char" char="." rowspan="1" colspan="1">0.772</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p><xref ref-type="fig" rid="pcbi.1008814.g002">Fig 2B–2D</xref>, <xref rid="pcbi.1008814.t001" ref-type="table">Table 1</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1008814.s001">S1 Fig</xref> also show that the AUROC scores can have notable differences between different epitopes even when the same combinations of CDRs and <italic>α</italic>/<italic>β</italic> chains have been utilized. Some of these differences may be explained by the differences in the number of available training samples, for example for CMV-epitope pp65<sub>495-503</sub> there were only 76 TCRs from 6 subjects in the Dash data, which may have contributed to a lower prediction accuracy. To address this, we evaluated the models also using leave-one-out cross-validation with only unique, private TCRs to see how the models perform when predictions are done only on new TCRs. With both TCRGP and TCRdist, the average AUROC scores improve slightly (<xref ref-type="supplementary-material" rid="pcbi.1008814.s003">S3 Fig</xref>), demonstrating that the models can predict if completely new TCR sequences are specific to these epitopes and that the larger number of TCRs used for training (due to the larger folds in leave-one-out cross validation) improve the model performances. A summary of all prediction results is shown in <xref ref-type="supplementary-material" rid="pcbi.1008814.s010">S1 File</xref>.</p>
      <p>To better understand the significance of the different CDRs for TCR-pMHC recognition, we also examined more closely how TCRGP weighted the kernels created for the different CDRs, when all CDRs from both chains were utilized. <xref ref-type="fig" rid="pcbi.1008814.g002">Fig 2C</xref> illustrates which CDRs were found important for the different epitopes. As one might expect, with most of the epitopes most weight was given to the CDR3<italic>β</italic>, but with all epitopes some weight was also given to other CDRs, suggesting that the classifier benefits from utilizing several CDRs. This is in agreement with an alignment of 52 TCR sequences from TCR-pMHC PDB structure complexes, which demonstrates that all CDRs can be within 5Å of a peptide [<xref rid="pcbi.1008814.ref009" ref-type="bibr">9</xref>]. For example with CMV-epitope pp65<sub>495-503</sub>, experimental characterization of the structure (PDBid 3GSN) showed CDR3<italic>β</italic>, CDR1<italic>β</italic>, CDR3<italic>α</italic> and CDR1<italic>α</italic> to be within 5Å of the peptide, and also CDR2<italic>β</italic> within 5.8Å of the peptide. Another TCR-pMHC-complex structure (PDBid 5D2L) for the same pp65<sub>495-503</sub>-epitope suggests that CDR2<italic>β</italic> was also within 5 Å of the peptide. Indeed, the optimized weights for the pp65<sub>495-503</sub>-epitope (<xref ref-type="fig" rid="pcbi.1008814.g002">Fig 2C</xref>) show some correspondence to the observed contacts. Although with many epitopes CDR3<italic>β</italic> was considered as the most important CDR, this was not the case with all epitopes. For example with mCMV-epitope m139<sub>419-426</sub> CDR3<italic>α</italic> is more important for the prediction, while with EBV-epitope BMLF1<sub>280-288</sub> most of the weight was given to CDR2<italic>α</italic> and CDR2<italic>β</italic>. Still, also with BMLF1<sub>280-288</sub> epitope the CDR3<italic>β</italic> alone provided discriminative information, as demonstrated by the high AUROC score (0.818) when TCRGP was trained only with CDR3<italic>β</italic>-sequences (see <xref rid="pcbi.1008814.t001" ref-type="table">Table 1</xref> or <xref ref-type="supplementary-material" rid="pcbi.1008814.s001">S1 Fig</xref>).</p>
    </sec>
    <sec id="sec005">
      <title>Comparisons to other methods</title>
      <p>Currently only a few methods for predicting the epitope-specificity of TCRs have been published, including TCRdist [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] and a random forest (RF) classifier by De Neuter et <italic>al.</italic> [<xref rid="pcbi.1008814.ref019" ref-type="bibr">19</xref>]. TCRdist uses a BLOSUM62 based distance measure between amino acids and defines the distance between two (aligned) TCRs as a weighted sum over the amino acid distances. Using this distance measure, they determine if a TCR is closer to an epitope-specific cluster of TCRs or to a cluster of background TCRs. De Neuter et <italic>al.</italic> use feature vectors formed by biophysical and other features extracted from TCR amino acid sequences to train a RF classifier. Gielis et <italic>al.</italic> [<xref rid="pcbi.1008814.ref033" ref-type="bibr">33</xref>] have later published a web server TCRex that is based on the RF classifier. However, we have utilized the implementation from the original article to be able to train models with the same training sets as with the other models in the comparisons. More recently also methods relying on neural networks have been proposed, such as DeepTCR, NetTCR, and Ergo [<xref rid="pcbi.1008814.ref020" ref-type="bibr">20</xref>–<xref rid="pcbi.1008814.ref022" ref-type="bibr">22</xref>]. DeepTCR relies on convolutional networks and uses one-hot encoding to present CDR3 and V/D/J-genes from <italic>α</italic>- and <italic>β</italic>-chains, or a subset of these, to learn embeddings for the sequences. NetTCR, which is intended for HLA-A*02:01 restricted epitopes, also uses convolutional neural networks, but utilizes BLOSUM50 encoding for presenting the CDR3<italic>β</italic> and the epitope sequence. Ergo uses LSTM (long-short term memory) network to encode the peptide sequence and either LSTM or an autoencoder to encode the CDR3 and utilize feed forward networks for predictions. Here we provide comparisons between TCRGP, TCRdist, RF, and DeepTCR.</p>
      <p>To compare TCRGP to these other methods, we experimented with the VDJdb data and we again used leave-one-subject-out cross-validation as described in Materials and Methods Section. We trained TCRGP and TCRdist using only CDR3<italic>β</italic> and then also with the other CDR<italic>β</italic>s. <xref ref-type="fig" rid="pcbi.1008814.g003">Fig 3A</xref> shows the ROC curves when TCRGP was trained with all CDR<italic>β</italic>s to predict which TCRs are specific to the HCV-epitope NS3<sub>1436-1444</sub>.</p>
      <fig id="pcbi.1008814.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008814.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Epitope specificity prediction with the VDJdb data.</title>
          <p><bold>(A)</bold> The left panel shows the cross-validated ROC curves for each subject in the VDJdb data for HCV NS3<sub>1436-1444</sub>-epitope, when TCRGP has been trained using TCR<italic>α</italic> and TCR<italic>β</italic> with all CDRs. The mean AUROC score is 0.944. The right panel shows the cross-validated ROC curve for all subjects and also the threshold values for classification are shown. From this figure we can determine which threshold values correspond to different true positive rates (TPRS) and false positive rates (FPRS). <bold>(B)</bold> One violin plot presents the distribution estimate of mean AUROC scores obtained with one method for all epitopes in our VDJdb data. Below each violin plot there is the name of the method used and in the brackets which CDR<italic>β</italic>s have been used (3 for CDR3, all for CDR1, CDR2, CDR2.5, and CDR3). Each point within a violin plot presents the mean AUROC score obtained for one epitope. RF refers to the Random Forest TCR-classifier of De Neuter et <italic>al.</italic> [<xref rid="pcbi.1008814.ref019" ref-type="bibr">19</xref>]. RF using only CDR3<italic>β</italic> has not been included in this figure as it could not provide predictions for all of the 22 epitopes. <bold>(C)</bold> Comparison of AUROC scores obtained with the different methods for each epitope separately. The epitopes have been arranged in increasing order of AUROC scores obtained by TCRGP using all CDR<italic>β</italic>s (orange line) <bold>(D)</bold> For each epitope from the VDJdb dataset, TCRGP models were trained using different numbers of unique epitope-specific TCR<italic>β</italic>s, always complemented with the same number of control TCR<italic>β</italic>s. For each point of the learning curve the model was trained with 100 random samples of the TCR<italic>β</italic>s, using either CDR1, CDR2, CDR2.5, and CDR3 (blue curves), or only CDR3 (orange curves). The darker lines show the mean of the predictions and the shaded areas ± the standard deviation for the 100 folds. The points indicate the tested sample sizes. Here learning curves for four peptides are shown. <bold>(E)</bold> Leave-one-out cross-validated AUROC scores correlate with the diversity and number of samples (Pearson correlation -0.66). The sizes of the circles indicate the number of unique TCRs used for training.</p>
        </caption>
        <graphic xlink:href="pcbi.1008814.g003"/>
      </fig>
      <p>RF and DeepTCR also utilize the CDR3<italic>β</italic> sequence, but use V<italic>β</italic>-gene instead of the other CDR<italic>β</italic>s. RF could also utilize the J-gene and DeepTCR J- and D-genes, but unfortunately, the background TCR data set from Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] did not contain information of these genes. However, according to De Neuter et <italic>al.</italic>, not much weight was given to the J-gene at least in their experiments. Moreover, when RF and DeepTCR utilize CDR3<italic>β</italic> and V<italic>β</italic>-gene and TCRGP and TCRdist use all CDRs, all four methods get the same sequence information, although in a slightly different form, as the other CDR<italic>β</italic>s are derived from the V<italic>β</italic>-gene.</p>
      <p><xref ref-type="fig" rid="pcbi.1008814.g003">Fig 3B</xref> shows the distribution estimates of mean AUROC scores for each model trained for the 22 different epitopes. With the VDJdb data, we can see that TCRGP and TCRdist both perform better, when all CDR<italic>β</italic>s have been utilized. Remarkably, TCRGP achieves higher mean AUROC scores than the other methods when using all CDRs, but also when only the CDR3<italic>β</italic> is utilized. AUROC scores for the different epitopes are presented in <xref rid="pcbi.1008814.t002" ref-type="table">Table 2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008814.s004">S4 Fig</xref> and <xref ref-type="fig" rid="pcbi.1008814.g003">Fig 3C</xref> illustrate how the AUROC scores vary between different methods separately for each epitope. The epitopes have been arranged in increasing order of AUROC scores obtained by TCRGP using all CDR<italic>β</italic>s. We can see that with most epitopes there are large differences in the accuracies of the different methods.</p>
      <table-wrap id="pcbi.1008814.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008814.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Mean AUROC scores for the VDJdb data using leave-one-subject-out cross-validation.</title>
          <p>TCRGP models and TCRdist models were trained using TCR<italic>β</italic> with either only CDR3<italic>β</italic> or all CDR<italic>β</italic>s. RF models and DeepTCR models were trained using only CDR3<italic>β</italic> or CDR3<italic>β</italic> with V<italic>β</italic>-gene, from which the other CDR<italic>β</italic>s can be derived from.</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008814.t002g" xlink:href="pcbi.1008814.t002"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="2" colspan="1"/>
                <th align="left" rowspan="1" colspan="1">Method</th>
                <th align="center" colspan="2" rowspan="1">TCRGP</th>
                <th align="center" colspan="2" rowspan="1">TCRdist</th>
                <th align="center" colspan="2" rowspan="1">RF</th>
                <th align="center" colspan="2" rowspan="1">DeepTCR</th>
              </tr>
              <tr>
                <th align="left" rowspan="1" colspan="1">CDRs</th>
                <th align="right" rowspan="1" colspan="1">3</th>
                <th align="left" rowspan="1" colspan="1">all</th>
                <th align="right" rowspan="1" colspan="1">3</th>
                <th align="left" rowspan="1" colspan="1">all</th>
                <th align="right" rowspan="1" colspan="1">3</th>
                <th align="left" rowspan="1" colspan="1">3, V-gene</th>
                <th align="right" rowspan="1" colspan="1">3</th>
                <th align="left" rowspan="1" colspan="1">3, V-gene</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">mean</td>
                <td align="char" char="." rowspan="1" colspan="1">0.806</td>
                <td align="char" char="." rowspan="1" colspan="1">0.863</td>
                <td align="char" char="." rowspan="1" colspan="1">0.743</td>
                <td align="char" char="." rowspan="1" colspan="1">0.783</td>
                <td align="right" rowspan="1" colspan="1">NaN</td>
                <td align="char" char="." rowspan="1" colspan="1">0.796</td>
                <td align="char" char="." rowspan="1" colspan="1">0.776</td>
                <td align="char" char="." rowspan="1" colspan="1">0.777</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CMV</td>
                <td align="left" rowspan="1" colspan="1">pp65<sub>123-131</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.852</td>
                <td align="char" char="." rowspan="1" colspan="1">0.792</td>
                <td align="char" char="." rowspan="1" colspan="1">0.804</td>
                <td align="char" char="." rowspan="1" colspan="1">0.761</td>
                <td align="right" rowspan="1" colspan="1">0.820</td>
                <td align="char" char="." rowspan="1" colspan="1">0.790</td>
                <td align="char" char="." rowspan="1" colspan="1">0.834</td>
                <td align="char" char="." rowspan="1" colspan="1">0.775</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CMV</td>
                <td align="left" rowspan="1" colspan="1">pp65<sub>417-426</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.912</td>
                <td align="char" char="." rowspan="1" colspan="1">0.968</td>
                <td align="char" char="." rowspan="1" colspan="1">0.829</td>
                <td align="char" char="." rowspan="1" colspan="1">0.874</td>
                <td align="right" rowspan="1" colspan="1">0.930</td>
                <td align="char" char="." rowspan="1" colspan="1">0.930</td>
                <td align="char" char="." rowspan="1" colspan="1">0.890</td>
                <td align="char" char="." rowspan="1" colspan="1">0.860</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CMV</td>
                <td align="left" rowspan="1" colspan="1">pp65<sub>495-503</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.892</td>
                <td align="char" char="." rowspan="1" colspan="1">0.904</td>
                <td align="char" char="." rowspan="1" colspan="1">0.793</td>
                <td align="char" char="." rowspan="1" colspan="1">0.786</td>
                <td align="right" rowspan="1" colspan="1">0.900</td>
                <td align="char" char="." rowspan="1" colspan="1">0.890</td>
                <td align="char" char="." rowspan="1" colspan="1">0.860</td>
                <td align="char" char="." rowspan="1" colspan="1">0.874</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">EBV</td>
                <td align="left" rowspan="1" colspan="1">BMLF1<sub>280-288</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.926</td>
                <td align="char" char="." rowspan="1" colspan="1">0.947</td>
                <td align="char" char="." rowspan="1" colspan="1">0.863</td>
                <td align="char" char="." rowspan="1" colspan="1">0.872</td>
                <td align="right" rowspan="1" colspan="1">0.930</td>
                <td align="char" char="." rowspan="1" colspan="1">0.910</td>
                <td align="char" char="." rowspan="1" colspan="1">0.897</td>
                <td align="char" char="." rowspan="1" colspan="1">0.907</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">EBV</td>
                <td align="left" rowspan="1" colspan="1">BZLF1<sub>190-197</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.887</td>
                <td align="char" char="." rowspan="1" colspan="1">0.899</td>
                <td align="char" char="." rowspan="1" colspan="1">0.764</td>
                <td align="char" char="." rowspan="1" colspan="1">0.857</td>
                <td align="right" rowspan="1" colspan="1">0.840</td>
                <td align="char" char="." rowspan="1" colspan="1">0.870</td>
                <td align="char" char="." rowspan="1" colspan="1">0.807</td>
                <td align="char" char="." rowspan="1" colspan="1">0.782</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">EBV</td>
                <td align="left" rowspan="1" colspan="1">BRLF1<sub>109-117</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.682</td>
                <td align="char" char="." rowspan="1" colspan="1">0.756</td>
                <td align="char" char="." rowspan="1" colspan="1">0.729</td>
                <td align="char" char="." rowspan="1" colspan="1">0.762</td>
                <td align="right" rowspan="1" colspan="1">0.770</td>
                <td align="char" char="." rowspan="1" colspan="1">0.780</td>
                <td align="char" char="." rowspan="1" colspan="1">0.670</td>
                <td align="char" char="." rowspan="1" colspan="1">0.564</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">IAV</td>
                <td align="left" rowspan="1" colspan="1">M1<sub>58-66</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.881</td>
                <td align="char" char="." rowspan="1" colspan="1">0.933</td>
                <td align="char" char="." rowspan="1" colspan="1">0.832</td>
                <td align="char" char="." rowspan="1" colspan="1">0.852</td>
                <td align="right" rowspan="1" colspan="1">0.910</td>
                <td align="char" char="." rowspan="1" colspan="1">0.890</td>
                <td align="char" char="." rowspan="1" colspan="1">0.868</td>
                <td align="char" char="." rowspan="1" colspan="1">0.893</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">IAV</td>
                <td align="left" rowspan="1" colspan="1">HA<sub>306-318</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.706</td>
                <td align="char" char="." rowspan="1" colspan="1">0.748</td>
                <td align="char" char="." rowspan="1" colspan="1">0.753</td>
                <td align="char" char="." rowspan="1" colspan="1">0.790</td>
                <td align="right" rowspan="1" colspan="1">NaN</td>
                <td align="char" char="." rowspan="1" colspan="1">0.550</td>
                <td align="char" char="." rowspan="1" colspan="1">0.685</td>
                <td align="char" char="." rowspan="1" colspan="1">0.602</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HCV</td>
                <td align="left" rowspan="1" colspan="1">NS3<sub>1073-1081</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.695</td>
                <td align="char" char="." rowspan="1" colspan="1">0.783</td>
                <td align="char" char="." rowspan="1" colspan="1">0.492</td>
                <td align="char" char="." rowspan="1" colspan="1">0.600</td>
                <td align="right" rowspan="1" colspan="1">0.660</td>
                <td align="char" char="." rowspan="1" colspan="1">0.730</td>
                <td align="char" char="." rowspan="1" colspan="1">0.625</td>
                <td align="char" char="." rowspan="1" colspan="1">0.626</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HCV</td>
                <td align="left" rowspan="1" colspan="1">NS3<sub>1406-1415</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.678</td>
                <td align="char" char="." rowspan="1" colspan="1">0.766</td>
                <td align="char" char="." rowspan="1" colspan="1">0.698</td>
                <td align="char" char="." rowspan="1" colspan="1">0.676</td>
                <td align="right" rowspan="1" colspan="1">0.560</td>
                <td align="char" char="." rowspan="1" colspan="1">0.560</td>
                <td align="char" char="." rowspan="1" colspan="1">0.631</td>
                <td align="char" char="." rowspan="1" colspan="1">0.704</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HCV</td>
                <td align="left" rowspan="1" colspan="1">NS3<sub>1436-1445</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.819</td>
                <td align="char" char="." rowspan="1" colspan="1">0.945</td>
                <td align="char" char="." rowspan="1" colspan="1">0.746</td>
                <td align="char" char="." rowspan="1" colspan="1">0.799</td>
                <td align="right" rowspan="1" colspan="1">0.850</td>
                <td align="char" char="." rowspan="1" colspan="1">0.850</td>
                <td align="char" char="." rowspan="1" colspan="1">0.824</td>
                <td align="char" char="." rowspan="1" colspan="1">0.849</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HSV-2</td>
                <td align="left" rowspan="1" colspan="1">VP22<sub>49-57</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.801</td>
                <td align="char" char="." rowspan="1" colspan="1">0.814</td>
                <td align="char" char="." rowspan="1" colspan="1">0.721</td>
                <td align="char" char="." rowspan="1" colspan="1">0.713</td>
                <td align="right" rowspan="1" colspan="1">0.850</td>
                <td align="char" char="." rowspan="1" colspan="1">0.860</td>
                <td align="char" char="." rowspan="1" colspan="1">0.858</td>
                <td align="char" char="." rowspan="1" colspan="1">0.823</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">YFV</td>
                <td align="left" rowspan="1" colspan="1">NS4B<sub>214-222</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.825</td>
                <td align="char" char="." rowspan="1" colspan="1">0.823</td>
                <td align="char" char="." rowspan="1" colspan="1">0.692</td>
                <td align="char" char="." rowspan="1" colspan="1">0.695</td>
                <td align="right" rowspan="1" colspan="1">0.890</td>
                <td align="char" char="." rowspan="1" colspan="1">0.870</td>
                <td align="char" char="." rowspan="1" colspan="1">0.649</td>
                <td align="char" char="." rowspan="1" colspan="1">0.664</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DENV1</td>
                <td align="left" rowspan="1" colspan="1">NS3<sub>133-142</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.864</td>
                <td align="char" char="." rowspan="1" colspan="1">0.914</td>
                <td align="char" char="." rowspan="1" colspan="1">0.878</td>
                <td align="char" char="." rowspan="1" colspan="1">0.920</td>
                <td align="right" rowspan="1" colspan="1">0.900</td>
                <td align="char" char="." rowspan="1" colspan="1">0.920</td>
                <td align="char" char="." rowspan="1" colspan="1">0.906</td>
                <td align="char" char="." rowspan="1" colspan="1">0.876</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DENV3-4</td>
                <td align="left" rowspan="1" colspan="1">NS3<sub>133-142</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.734</td>
                <td align="char" char="." rowspan="1" colspan="1">0.859</td>
                <td align="char" char="." rowspan="1" colspan="1">0.842</td>
                <td align="char" char="." rowspan="1" colspan="1">0.893</td>
                <td align="right" rowspan="1" colspan="1">0.530</td>
                <td align="char" char="." rowspan="1" colspan="1">0.710</td>
                <td align="char" char="." rowspan="1" colspan="1">0.850</td>
                <td align="char" char="." rowspan="1" colspan="1">0.843</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1</td>
                <td align="left" rowspan="1" colspan="1">p24<sub>30-40</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.894</td>
                <td align="char" char="." rowspan="1" colspan="1">0.886</td>
                <td align="char" char="." rowspan="1" colspan="1">0.836</td>
                <td align="char" char="." rowspan="1" colspan="1">0.808</td>
                <td align="right" rowspan="1" colspan="1">0.880</td>
                <td align="char" char="." rowspan="1" colspan="1">0.880</td>
                <td align="char" char="." rowspan="1" colspan="1">0.818</td>
                <td align="char" char="." rowspan="1" colspan="1">0.858</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1</td>
                <td align="left" rowspan="1" colspan="1">p24<sub>48-56</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.817</td>
                <td align="char" char="." rowspan="1" colspan="1">0.946</td>
                <td align="char" char="." rowspan="1" colspan="1">0.716</td>
                <td align="char" char="." rowspan="1" colspan="1">0.800</td>
                <td align="right" rowspan="1" colspan="1">0.720</td>
                <td align="char" char="." rowspan="1" colspan="1">0.810</td>
                <td align="char" char="." rowspan="1" colspan="1">0.624</td>
                <td align="char" char="." rowspan="1" colspan="1">0.794</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1</td>
                <td align="left" rowspan="1" colspan="1">p24<sub>128-135</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.770</td>
                <td align="char" char="." rowspan="1" colspan="1">0.740</td>
                <td align="char" char="." rowspan="1" colspan="1">0.541</td>
                <td align="char" char="." rowspan="1" colspan="1">0.594</td>
                <td align="right" rowspan="1" colspan="1">0.720</td>
                <td align="char" char="." rowspan="1" colspan="1">0.720</td>
                <td align="char" char="." rowspan="1" colspan="1">0.719</td>
                <td align="char" char="." rowspan="1" colspan="1">0.771</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1</td>
                <td align="left" rowspan="1" colspan="1">p24<sub>131-140</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.838</td>
                <td align="char" char="." rowspan="1" colspan="1">0.859</td>
                <td align="char" char="." rowspan="1" colspan="1">0.701</td>
                <td align="char" char="." rowspan="1" colspan="1">0.724</td>
                <td align="right" rowspan="1" colspan="1">0.760</td>
                <td align="char" char="." rowspan="1" colspan="1">0.790</td>
                <td align="char" char="." rowspan="1" colspan="1">0.740</td>
                <td align="char" char="." rowspan="1" colspan="1">0.656</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1</td>
                <td align="left" rowspan="1" colspan="1">p24<sub>161-180</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.750</td>
                <td align="char" char="." rowspan="1" colspan="1">0.992</td>
                <td align="char" char="." rowspan="1" colspan="1">0.769</td>
                <td align="char" char="." rowspan="1" colspan="1">0.975</td>
                <td align="right" rowspan="1" colspan="1">0.780</td>
                <td align="char" char="." rowspan="1" colspan="1">0.890</td>
                <td align="char" char="." rowspan="1" colspan="1">0.846</td>
                <td align="char" char="." rowspan="1" colspan="1">0.844</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1</td>
                <td align="left" rowspan="1" colspan="1">p24<sub>223-231</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.702</td>
                <td align="char" char="." rowspan="1" colspan="1">0.894</td>
                <td align="char" char="." rowspan="1" colspan="1">0.686</td>
                <td align="char" char="." rowspan="1" colspan="1">0.819</td>
                <td align="right" rowspan="1" colspan="1">NaN</td>
                <td align="char" char="." rowspan="1" colspan="1">0.520</td>
                <td align="char" char="." rowspan="1" colspan="1">0.651</td>
                <td align="char" char="." rowspan="1" colspan="1">0.703</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HIV-1</td>
                <td align="left" rowspan="1" colspan="1">Nef<sub>90-97</sub></td>
                <td align="char" char="." rowspan="1" colspan="1">0.798</td>
                <td align="char" char="." rowspan="1" colspan="1">0.818</td>
                <td align="char" char="." rowspan="1" colspan="1">0.667</td>
                <td align="char" char="." rowspan="1" colspan="1">0.657</td>
                <td align="right" rowspan="1" colspan="1">0.780</td>
                <td align="char" char="." rowspan="1" colspan="1">0.800</td>
                <td align="char" char="." rowspan="1" colspan="1">0.809</td>
                <td align="char" char="." rowspan="1" colspan="1">0.830</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>In the VDJdb data, there were also TCRs that appeared in samples collected from multiple subjects (see <xref rid="pcbi.1008814.t003" ref-type="table">Table 3</xref>). We therefore trained the models also using leave-one-out cross-validation with only unique TCRs. In this case we considered a TCR to be unique if it had a unique combination of CDR3<italic>β</italic> amino acid sequence and V<italic>β</italic>-gene, as we only utilized the TCR<italic>β</italic>. As with the Dash data above, our results (<xref ref-type="supplementary-material" rid="pcbi.1008814.s005">S5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008814.s006">S6</xref> Figs) show that the models can predict if completely new sequences are specific to these epitopes, thus demonstrating their use for epitope specificity prediction for previously unseen TCRs. A summary of all prediction results is shown in <xref ref-type="supplementary-material" rid="pcbi.1008814.s010">S1 File</xref>.</p>
      <table-wrap id="pcbi.1008814.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008814.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Datasets.</title>
          <p>Dash data: The data set constructed by Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] contains epitope-spcefic TCRs for Epstein-Barr virus (EBV), human Cytomegalovirus (CMV), Influenza A virus (IAV) and mouse Cytomegalovirus (mCMV). VDJdb data: Data set gathered from VDJdb contains epitope-specific TCRs for Cytomegalovirus (CMV), Epstein-Barr virus (EBV), Influenza A virus (IAV), Hepatitis C virus (HCV), Herpes Simplex virus type 2 (HSV-2), Yellow Fever virus (YFV), Dengue virus type 1 (DENV1), Dengue virus type 3 (DENV3-4), and Human immunodeficiency virus type 1 (HIV-1). For the MHC chains we show here only the allele group. For some epitopes there are TCRs for which there exists more detailed information and some variation, which are shown in <xref ref-type="supplementary-material" rid="pcbi.1008814.s012">S3 File</xref>.</p>
        </caption>
        <alternatives>
          <graphic id="pcbi.1008814.t003g" xlink:href="pcbi.1008814.t003"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="center" colspan="9" rowspan="1">Dash data</th>
              </tr>
              <tr>
                <th align="left" rowspan="2" colspan="1">Species</th>
                <th align="center" rowspan="1" colspan="1">Epitope species</th>
                <th align="center" rowspan="1" colspan="1">Epitope gene</th>
                <th align="center" rowspan="2" colspan="1">Epitope</th>
                <th align="center" rowspan="1" colspan="1">MHC chain 1</th>
                <th align="center" rowspan="1" colspan="1">MHC chain 2</th>
                <th align="center" rowspan="2" colspan="1">Subjects</th>
                <th align="center" rowspan="2" colspan="1">Samples</th>
                <th align="center" rowspan="1" colspan="1">Unique TCR<italic>αβ</italic>s</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="3" colspan="1">Human</td>
                <td align="center" rowspan="1" colspan="1">EBV</td>
                <td align="center" rowspan="1" colspan="1">BMLF1<sub>280-288</sub></td>
                <td align="center" rowspan="1" colspan="1">GLCTLVAML</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*02:01</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">76</td>
                <td align="center" rowspan="1" colspan="1">69</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">CMV</td>
                <td align="center" rowspan="1" colspan="1">pp65<sub>495-503</sub></td>
                <td align="center" rowspan="1" colspan="1">NLVPMVATV</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*02:01</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">10</td>
                <td align="center" rowspan="1" colspan="1">61</td>
                <td align="center" rowspan="1" colspan="1">60</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">IAV</td>
                <td align="center" rowspan="1" colspan="1">M1<sub>58-66</sub></td>
                <td align="center" rowspan="1" colspan="1">GILGFVFTL</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*02:01</td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">275</td>
                <td align="center" rowspan="1" colspan="1">237</td>
              </tr>
              <tr>
                <td align="left" rowspan="7" colspan="1">Mouse</td>
                <td align="center" rowspan="1" colspan="1">IAV</td>
                <td align="center" rowspan="1" colspan="1">PB1-F2<sub>62-70</sub></td>
                <td align="center" rowspan="1" colspan="1">LSLRNPILV</td>
                <td align="center" rowspan="1" colspan="1">D<sup>b</sup></td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">9</td>
                <td align="center" rowspan="1" colspan="1">117</td>
                <td align="center" rowspan="1" colspan="1">117</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">IAV</td>
                <td align="center" rowspan="1" colspan="1">NP<sub>366-374</sub></td>
                <td align="center" rowspan="1" colspan="1">ASNENMETM</td>
                <td align="center" rowspan="1" colspan="1">D<sup>b</sup></td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">24</td>
                <td align="center" rowspan="1" colspan="1">305</td>
                <td align="center" rowspan="1" colspan="1">263</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">IAV</td>
                <td align="center" rowspan="1" colspan="1">PA<sub>224-233</sub></td>
                <td align="center" rowspan="1" colspan="1">SSLENFRAYV</td>
                <td align="center" rowspan="1" colspan="1">D<sup>b</sup></td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">324</td>
                <td align="center" rowspan="1" colspan="1">293</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">IAV</td>
                <td align="center" rowspan="1" colspan="1">PB1<sub>703-711</sub></td>
                <td align="center" rowspan="1" colspan="1">SSYRRPVGI</td>
                <td align="center" rowspan="1" colspan="1">K<sup>b</sup></td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">34</td>
                <td align="center" rowspan="1" colspan="1">642</td>
                <td align="center" rowspan="1" colspan="1">584</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">mCMV</td>
                <td align="center" rowspan="1" colspan="1">m139<sub>419-426</sub></td>
                <td align="center" rowspan="1" colspan="1">TVYGFCLL</td>
                <td align="center" rowspan="1" colspan="1">K<sup>b</sup></td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" rowspan="1" colspan="1">87</td>
                <td align="center" rowspan="1" colspan="1">87</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">mCMV</td>
                <td align="center" rowspan="1" colspan="1">M38<sub>316-323</sub></td>
                <td align="center" rowspan="1" colspan="1">SSPPMFRV</td>
                <td align="center" rowspan="1" colspan="1">K<sup>b</sup></td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">158</td>
                <td align="center" rowspan="1" colspan="1">143</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">mCMV</td>
                <td align="center" rowspan="1" colspan="1">M45<sub>985-993</sub></td>
                <td align="center" rowspan="1" colspan="1">HGIRNASFI</td>
                <td align="center" rowspan="1" colspan="1">D<sup>b</sup></td>
                <td align="center" rowspan="1" colspan="1">-</td>
                <td align="center" rowspan="1" colspan="1">13</td>
                <td align="center" rowspan="1" colspan="1">291</td>
                <td align="center" rowspan="1" colspan="1">271</td>
              </tr>
              <tr>
                <td align="center" colspan="9" rowspan="1">VDJdb data</td>
              </tr>
              <tr>
                <td align="left" rowspan="22" colspan="1">Human</td>
                <td align="center" rowspan="1" colspan="1">CMV</td>
                <td align="center" rowspan="1" colspan="1">pp65<sub>123-131</sub></td>
                <td align="center" rowspan="1" colspan="1">IPSINVHHY</td>
                <td align="center" rowspan="1" colspan="1">HLA-B*35</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">17</td>
                <td align="center" rowspan="1" colspan="1">65</td>
                <td align="center" rowspan="1" colspan="1">58</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">CMV</td>
                <td align="center" rowspan="1" colspan="1">pp65<sub>417-426</sub></td>
                <td align="center" rowspan="1" colspan="1">TPRVTGGGAM</td>
                <td align="center" rowspan="1" colspan="1">HLA-B*07</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">29</td>
                <td align="center" rowspan="1" colspan="1">184</td>
                <td align="center" rowspan="1" colspan="1">122</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">CMV</td>
                <td align="center" rowspan="1" colspan="1">pp65<sub>495-503</sub></td>
                <td align="center" rowspan="1" colspan="1">NLVPMVATV</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*02</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">103</td>
                <td align="center" rowspan="1" colspan="1">413</td>
                <td align="center" rowspan="1" colspan="1">242</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">EBV</td>
                <td align="center" rowspan="1" colspan="1">BMLF1<sub>280-288</sub></td>
                <td align="center" rowspan="1" colspan="1">GLCTLVAML</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*02</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">54</td>
                <td align="center" rowspan="1" colspan="1">299</td>
                <td align="center" rowspan="1" colspan="1">152</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">EBV</td>
                <td align="center" rowspan="1" colspan="1">BZLF1<sub>190-197</sub></td>
                <td align="center" rowspan="1" colspan="1">RAKFKQLL</td>
                <td align="center" rowspan="1" colspan="1">HLA-B*08</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">17</td>
                <td align="center" rowspan="1" colspan="1">225</td>
                <td align="center" rowspan="1" colspan="1">149</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">EBV</td>
                <td align="center" rowspan="1" colspan="1">BRLF1<sub>109-117</sub></td>
                <td align="center" rowspan="1" colspan="1">YVLDHLIVV</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*02</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">6</td>
                <td align="center" rowspan="1" colspan="1">66</td>
                <td align="center" rowspan="1" colspan="1">51</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">IAV</td>
                <td align="center" rowspan="1" colspan="1">M1<sub>58-66</sub></td>
                <td align="center" rowspan="1" colspan="1">GILGFVFTL</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*02</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">50</td>
                <td align="center" rowspan="1" colspan="1">239</td>
                <td align="center" rowspan="1" colspan="1">138</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">IAV</td>
                <td align="center" rowspan="1" colspan="1">HA<sub>306-318</sub></td>
                <td align="center" rowspan="1" colspan="1">PKYVKQNTLKLAT</td>
                <td align="center" rowspan="1" colspan="1">HLA-DRA*01</td>
                <td align="center" rowspan="1" colspan="1">HLA-DRB1*01,04</td>
                <td align="center" rowspan="1" colspan="1">11</td>
                <td align="center" rowspan="1" colspan="1">56</td>
                <td align="center" rowspan="1" colspan="1">50</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HCV</td>
                <td align="center" rowspan="1" colspan="1">NS3<sub>1073-1081</sub></td>
                <td align="center" rowspan="1" colspan="1">CINGVCWTV</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*02</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">7</td>
                <td align="center" rowspan="1" colspan="1">76</td>
                <td align="center" rowspan="1" colspan="1">39</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HCV</td>
                <td align="center" rowspan="1" colspan="1">NS3<sub>1406-1415</sub></td>
                <td align="center" rowspan="1" colspan="1">KLVALGINAV</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*02</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="center" rowspan="1" colspan="1">65</td>
                <td align="center" rowspan="1" colspan="1">65</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HCV</td>
                <td align="center" rowspan="1" colspan="1">NS3<sub>1436-1445</sub></td>
                <td align="center" rowspan="1" colspan="1">ATDALMTGY</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*01</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">7</td>
                <td align="center" rowspan="1" colspan="1">152</td>
                <td align="center" rowspan="1" colspan="1">139</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HSV-2</td>
                <td align="center" rowspan="1" colspan="1">VP22<sub>49-57</sub></td>
                <td align="center" rowspan="1" colspan="1">RPRGEVRFL</td>
                <td align="center" rowspan="1" colspan="1">HLA-B*07</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="center" rowspan="1" colspan="1">68</td>
                <td align="center" rowspan="1" colspan="1">29</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">YFV</td>
                <td align="center" rowspan="1" colspan="1">NS4B<sub>214-222</sub></td>
                <td align="center" rowspan="1" colspan="1">LLWNGPMAV</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*02</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">5</td>
                <td align="center" rowspan="1" colspan="1">223</td>
                <td align="center" rowspan="1" colspan="1">198</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">DENV1</td>
                <td align="center" rowspan="1" colspan="1">NS3<sub>133-142</sub></td>
                <td align="center" rowspan="1" colspan="1">GTSGSPIVNR</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*11</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">11</td>
                <td align="center" rowspan="1" colspan="1">65</td>
                <td align="center" rowspan="1" colspan="1">59</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">DENV3-4</td>
                <td align="center" rowspan="1" colspan="1">NS3<sub>133-142</sub></td>
                <td align="center" rowspan="1" colspan="1">GTSGSPIINR</td>
                <td align="center" rowspan="1" colspan="1">HLA-A*11</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" rowspan="1" colspan="1">51</td>
                <td align="center" rowspan="1" colspan="1">46</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HIV-1</td>
                <td align="center" rowspan="1" colspan="1">p24<sub>30-40</sub></td>
                <td align="center" rowspan="1" colspan="1">KAFSPEVIPMF</td>
                <td align="center" rowspan="1" colspan="1">HLA-B*57</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">44</td>
                <td align="center" rowspan="1" colspan="1">134</td>
                <td align="center" rowspan="1" colspan="1">104</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HIV-1</td>
                <td align="center" rowspan="1" colspan="1">p24<sub>48-56</sub></td>
                <td align="center" rowspan="1" colspan="1">TPQDLNTML</td>
                <td align="center" rowspan="1" colspan="1">HLA-B*42,81</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">21</td>
                <td align="center" rowspan="1" colspan="1">52</td>
                <td align="center" rowspan="1" colspan="1">40</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HIV-1</td>
                <td align="center" rowspan="1" colspan="1">p24<sub>128-135</sub></td>
                <td align="center" rowspan="1" colspan="1">EIYKRWII</td>
                <td align="center" rowspan="1" colspan="1">HLA-B*08</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">81</td>
                <td align="center" rowspan="1" colspan="1">60</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HIV-1</td>
                <td align="center" rowspan="1" colspan="1">p24<sub>131-140</sub></td>
                <td align="center" rowspan="1" colspan="1">KRWIILGLNK</td>
                <td align="center" rowspan="1" colspan="1">HLA-B*27</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">27</td>
                <td align="center" rowspan="1" colspan="1">212</td>
                <td align="center" rowspan="1" colspan="1">141</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HIV-1</td>
                <td align="center" rowspan="1" colspan="1">p24<sub>161-180</sub></td>
                <td align="center" rowspan="1" colspan="1">FRDYVDRFYKTLRAEQASQE</td>
                <td align="center" rowspan="1" colspan="1">HLA-DRA*01</td>
                <td align="center" rowspan="1" colspan="1">HLA-DRB1*01,07,11,15, HLA-DRB5*01</td>
                <td align="center" rowspan="1" colspan="1">17</td>
                <td align="center" rowspan="1" colspan="1">141</td>
                <td align="center" rowspan="1" colspan="1">95</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HIV-1</td>
                <td align="center" rowspan="1" colspan="1">p24<sub>223-231</sub></td>
                <td align="center" rowspan="1" colspan="1">GPGHKARVL</td>
                <td align="center" rowspan="1" colspan="1">HLA-B*07</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" rowspan="1" colspan="1">62</td>
                <td align="center" rowspan="1" colspan="1">53</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">HIV-1</td>
                <td align="center" rowspan="1" colspan="1">Nef<sub>90-97</sub></td>
                <td align="center" rowspan="1" colspan="1">FLKEKGGL</td>
                <td align="center" rowspan="1" colspan="1">HLA-B*08</td>
                <td align="center" rowspan="1" colspan="1">B2M</td>
                <td align="center" rowspan="1" colspan="1">21</td>
                <td align="center" rowspan="1" colspan="1">104</td>
                <td align="center" rowspan="1" colspan="1">78</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>To affirm the above observations, we again applied Wilcoxon signed-rank test. We used the test to study two questions: do AUROC scores differ between TCRGP and previous methods, and is it better to use all CDR<italic>β</italic>s rather than only CDR3<italic>β</italic>s. The Benjamini-Hochberg corrected P-values for these tests (see <xref ref-type="supplementary-material" rid="pcbi.1008814.s011">S2 File</xref>) support the visual observations we made from <xref ref-type="fig" rid="pcbi.1008814.g003">Fig 3B</xref>.</p>
    </sec>
    <sec id="sec006">
      <title>Significance of the number of training samples</title>
      <p>To assess how the number of epitope-specific TCRs affects the performance of TCRGP classifier, we trained our model using different numbers of epitope-specific TCRs from the VDJdb data. We selected all unique TCRs for each epitope and took 100 random samples from them for each training set size and used the remaining TCRs for testing. The epitope-specific TCRs in the training and test sets were accompanied with equal numbers of randomly chosen control TCRs. Learning curves for four epitopes are shown in <xref ref-type="fig" rid="pcbi.1008814.g003">Fig 3D</xref> and learning curves for all 22 epitopes in <xref ref-type="supplementary-material" rid="pcbi.1008814.s007">S7 Fig</xref>. In general, the predictive performance of the TCRGP classifiers improve when more training samples are available. Indeed, we observed a negative correlation between TCRs’ diversity and sample size ratio and prediction accuracy (<xref ref-type="fig" rid="pcbi.1008814.g003">Fig 3E</xref>). We also examined if the diversities of epitope-specific TCRs within and between subjects differ. We found that although the diversities of TCRs specific to different epitopes vary, on average diversities within and between subjects are similar (panel B in <xref ref-type="supplementary-material" rid="pcbi.1008814.s008">S8 Fig</xref>). However, there is still variation in the diversities between pairs of subjects (panel C in <xref ref-type="supplementary-material" rid="pcbi.1008814.s008">S8 Fig</xref>).</p>
      <p>These learning curves also further demonstrate the benefit of using multiple CDR sequences: With most of the epitopes using all CDRs produces better or comparable AUROC scores with all sample sizes, although there are a few epitopes with which the AUROC scores are higher when utilizing only the CDR3<italic>β</italic> if the sample sizes are very small (≤40). These results also suggest that with many epitopes it may be more beneficial to sequence a moderate amount of TCRs in such precision that in addition to the CDR3 also the V-gene and allele (and thus the CDR1, CDR2, and CDR2.5) can be determined, than to sequence large amounts of only CDR3s. These findings are in line with the weights learned by TCRGP for each CDR3 for the individual epitopes, as we can see in the case of CMV-epitope pp65<sub>495-503</sub>, EBV-epitope BMLF1<sub>280-288</sub> and IAV-epitope M1<sub>58-66</sub> (see <xref ref-type="fig" rid="pcbi.1008814.g002">Fig 2</xref>). With pp65<sub>495-503</sub> most weight was given to CDR3<italic>β</italic> and thus information from other CDRs was not considered as beneficial; with BMLF1<sub>280-288</sub> almost no weight was given to CDR3<italic>β</italic> and in the learning curves there is a clear improvement when all CDR<italic>β</italic>s are used; with M1<sub>58-66</sub> some weight was given to CDR3<italic>β</italic>, but most weight fell to CDR2<italic>β</italic> and correspondingly there is a small improvement in the learning curves, when all CDR<italic>β</italic>s are utilized. Overall, the learning curves show that TCRGP can learn an accurate predictor even from a small data set, thus making it applicable to the currently existing TCR-peptide interaction data sets. On the other hand, our results also show that TCRGP’s prediction accuracy increases along with increasing number of training examples, enabling analysis of larger TCR-peptide interaction data sets in the future.</p>
    </sec>
    <sec id="sec007">
      <title>Discriminating between epitope-specific TCRs</title>
      <p>To further validate the performance of TCRGP, we also tested it in a setting were we use only TCRs from the VDJdb data so that TCRs specific to one epitope are considered as positive and TCRs specific to the other epitopes are considered as negative. We only utilized unique TCRs for each epitope and used stratified 200-fold cross validation. We observed some cross-reactivity between TCRs specific to some of the epitopes, for example DENV1 epitope NS3<sub>133-142</sub> and DENV3-4 epitope NS3<sub>133-142</sub> have many TCRs that are specific to both epitopes. When each of the models were trained, we therefore excluded TCRs from the control data that were known to recognize the epitope in question. <xref ref-type="fig" rid="pcbi.1008814.g004">Fig 4A</xref> shows that TCRGP performs well also with this kind of data, as the mean AUROC scores are very similar to those achieved when using leave-one-out cross-validation and the control data from Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] (see <xref ref-type="supplementary-material" rid="pcbi.1008814.s005">S5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008814.s009">S9</xref> Figs).</p>
      <fig id="pcbi.1008814.g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008814.g004</object-id>
        <label>Fig 4</label>
        <caption>
          <title>Mean AUROC scores obtained from TCRGP models with different kinds of data.</title>
          <p>Blue violin plots show results of models trained with only CDR3<italic>β</italic> and orange violin plots of models trained with all CDR<italic>β</italic>s. <bold>(A)</bold> Mean AUROC scores from TCRGP models for the 22 epitopes in VDJdb data, when TCRs specific to one epitope are considered as positive and TCRs specific to the other 21 epitopes are considered as control data. 200-fold stratified cross validation was used for the evaluation. <bold>(B)</bold> Same as (A), but only the 885 unique TCRs specific to the seven HLA-A*02 restricted epitopes are used.</p>
        </caption>
        <graphic xlink:href="pcbi.1008814.g004"/>
      </fig>
      <p>The VDJdb data we have used contains epitopes restricted by MHCs with different HLA types. Structural data from TCR-pMHC complexes indicate that CDR1 and CDR2 are likely to interact more with the MHC than with the epitope. To see if using other CDR<italic>β</italic>s than CDR3<italic>β</italic> is beneficial also when all epitope-specific and control TCRs can recognize epitopes restricted by MHCs of the same HLA-type, we performed the above test with only TCRs specific to HLA-A*02 restricted epitopes (see <xref rid="pcbi.1008814.t003" ref-type="table">Table 3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008814.s012">S3 File</xref> for information about the HLA types). With this criteria we obtained 885 TCRs specific to seven epitopes (pp65<sub>495-503</sub>, BMLF1<sub>280-288</sub>, BRLF1<sub>109-117</sub>, M1<sub>58-66</sub>, NS3<sub>1073-1081</sub>, NS3<sub>1406-1415</sub>, NS4B<sub>214-222</sub>). <xref ref-type="fig" rid="pcbi.1008814.g004">Fig 4B</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008814.s009">S9 Fig</xref> show that using all CDR<italic>β</italic>s instead of only CDR3<italic>β</italic> is beneficial also in this case and that the predictive performance remains good. In fact, the mean AUROC scores in this case (0.794 and 0.821 when only CDR3<italic>β</italic> and all CDR<italic>β</italic>s were used) are higher than the mean AUROC scores obtained for the same seven HLA-A*02 restricted epitopes, when TCRs for all 22 epitopes were utilized (0.746 and 0.786, respectively), see <xref ref-type="supplementary-material" rid="pcbi.1008814.s009">S9 Fig</xref>. This analysis supports our finding that CDRs other than CDR3 contain information that is useful for predicting TCR-epitope recognition. A summary of all prediction results is shown in <xref ref-type="supplementary-material" rid="pcbi.1008814.s010">S1 File</xref>.</p>
    </sec>
    <sec id="sec008">
      <title>Evaluation on TCR data from independent studies</title>
      <p>The above experiments have demonstrated TCRGP’s accuracy when the classifier has been tested with TCR sequences from new subjects. Next we tested TCRGP’s robustness to generalize between independent studies. Specifically, we tested how TCRGP performs when trained on the epitope-specific TCR sequences from one study and tested on sequences from another independent study. We performed this experiment for the nine epitopes from the VDJdb data that have a study with at least 50 TCRs for training the model and another independent study with at least 10 TCRs for testing. When there were multiple studies that fulfilled this criteria, we chose the two studies with most unique TCRs for training and testing, respectively. When only CDR3<italic>β</italic> was utilized, we obtained a mean AUROC score of 0.813, and with all CDR<italic>β</italic>s the AUROC score was 0.865, see <xref ref-type="supplementary-material" rid="pcbi.1008814.s010">S1 File</xref> for AUROC scores for all these epitopes and information of the number of TCRs for each study.</p>
      <p>We also performed a leave-one-study-out cross-validation for all 10 epitopes that have always at least 50 TCRs for training and 10 TCRs for testing when divided to folds based on the study they were obtained from. For this experiment we only used studies with at least five TCRs. We achieved AUROC scores of 0.838 and 0.861 when utilizing CDR3<italic>β</italic> and all CDR<italic>β</italic>s, respectively (see <xref ref-type="supplementary-material" rid="pcbi.1008814.s010">S1 File</xref>).</p>
      <p>Additionally, we trained a classifier for COVID-19 epitope S-protein<sub>269-277</sub> (YLQPRTFLL) with the 352 epitope-specific TCR<italic>β</italic>s from the recent study of Shomuradova et <italic>al.</italic> [<xref rid="pcbi.1008814.ref034" ref-type="bibr">34</xref>] and tested the classifier with the 415 in-frame S-protein<sub>269-277</sub>-specific TCRs from the ImmuneRACE study launched by Adaptive Biotechnologies and Microsoft (<ext-link ext-link-type="uri" xlink:href="https://immunerace.adaptivebiotech.com">https://immunerace.adaptivebiotech.com</ext-link>, June 10, 2020 dataset). The immuneRACE data did not have sufficient information of the V<italic>β</italic>-gene for us to utilize all CDR<italic>β</italic>s, so the classifier was trained and tested only with CDR3<italic>β</italic>. Nonetheless, we achieved an AUROC score of 0.895 on the independent test data.</p>
      <p>These experiments show that TCRGP is robust to overfitting and has high accuracy also when testing with TCRs from independent studies.</p>
    </sec>
    <sec id="sec009">
      <title>Leveraging TCRGP in single-cell RNA+TCR<italic>αβ</italic>-sequencing data analysis</title>
      <p>We next demonstrate how TCRGP can be utilized to implement a novel analysis of combined single-cell RNA and TCR<italic>αβ</italic> (scRNA+TCR<italic>αβ</italic>) sequencing data. Hepatocellular carcinoma (HCC) is one of the leading causes for cancer-related deaths worldwide [<xref rid="pcbi.1008814.ref035" ref-type="bibr">35</xref>]. Globally the predominant cause of HCC is considered to be Hepatitis B virus (HBV) as half of the HCC patients are estimated to be chronic HBV carriers [<xref rid="pcbi.1008814.ref036" ref-type="bibr">36</xref>]. During the course of natural infection, HBV integrates itself into the genome of the hepatocytes and thus a proportion of the HCC cells expresses HBV antigens [<xref rid="pcbi.1008814.ref037" ref-type="bibr">37</xref>]. Therefore, the malignant cells could be targeted by HBV-specific T-cell clonotypes and the high-dimensional characterization of these clonotypes could be crucial in understanding the viral control of HBV-infection and its association to HCC. To address this previously unanswered question we used TCRGP to analyze a dataset of single-cell RNA and TCR<italic>αβ</italic> of T cells from HBsAg-positive HCC-patients from blood, non-malignant liver tissue and tumour tissue published by Zheng et <italic>al.</italic> [<xref rid="pcbi.1008814.ref038" ref-type="bibr">38</xref>] (the Zheng data, see <xref ref-type="sec" rid="sec011">Materials and methods</xref> for details).</p>
      <p>We utilized HBV-reactive T cell populations mapped by Cheng et <italic>al.</italic> [<xref rid="pcbi.1008814.ref039" ref-type="bibr">39</xref>] (the Cheng data) to train TCRGP classifiers (see <xref ref-type="sec" rid="sec011">Materials and methods</xref> for details) to enable prediction for the unselected TCR repertoire in the Zheng data against the four epitopes (HBV<sub>core169</sub>, HBV<sub>core195</sub>, HBV<sub>pol282</sub>, HBV<sub>pol387</sub>) (<xref ref-type="fig" rid="pcbi.1008814.g005">Fig 5A</xref>).</p>
      <fig id="pcbi.1008814.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1008814.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Analysis of HBV-specific T cells in HCC patients.</title>
          <p><bold>(A)</bold> Schematics for the analysis of single-cell RNA and TCR<italic>αβ</italic> sequencing data using TCRGP and multimer-sorted data. <bold>(B)</bold> Numbers of cells predicted to recognize different epitopes by TCRGP with probability of at least 85%. HBV-reactivity was assessed by four different TCRGP classifiers trained against four different HBV-epitopes (HBV<sub>core169</sub>, HBV<sub>core195</sub>, HBV<sub>pol282</sub>, HBV<sub>pol387</sub>). Other predictions were made using the models trained with the VDJdb data. <bold>(C)</bold> Dimensionality reduced representation (UMAP) of the 1189 CD8+ T cells from HBV+ HCC-patients from peripheral blood, normal adjacent tissue and tumour tissue. Encircled dots represent the T cells predicted to be HBV-reactive by TCRGP. <bold>(D)</bold> The frequencies of T cells predicted to recognize different HBV-epitopes in each cluster. <bold>(E)</bold> Z-score normalized mean expressions of known canonical markers to assess CD8+ cell phenotypes (naïve, cytotoxic, costimulatory inhibitory, and effector memory markers) in the three different exhausted cell clusters. Exhausted 3 was predicted to be enriched for HBV-targeting T cells (p = 3e-06, p.adj = 0.001).</p>
        </caption>
        <graphic xlink:href="pcbi.1008814.g005"/>
      </fig>
      <p>Of the 789 CD8+ cells from Zheng data analyzed with TCRGP, 108 cells (13.688%), were predicted to be reactive against any of the four HBV epitopes with at least a TCRGP-based probability of 85%, most of which against HBV<sub>core195</sub>-epitope (59 cells) (<xref ref-type="fig" rid="pcbi.1008814.g005">Fig 5A–5C</xref>). On the contrary, 176 cells were predicted to be reactive against common viruses (CMV = 22 (three epitopes), EBV = 88 (three epitopes) and Influenza A = 66 cells (two epitopes)) (<xref ref-type="fig" rid="pcbi.1008814.g005">Fig 5B</xref>), suggesting that HBV was the most common target for antigen-specific T cells in HCC patients.</p>
      <p>After unsupervised clustering of the CD8+ cells’ scRNA-seq data, we received 6 different phenotypes that were similar to the phenotypes described by Zheng et <italic>al.</italic> [<xref rid="pcbi.1008814.ref038" ref-type="bibr">38</xref>], but had the exhausted cells divided into 3 different clusters instead of one (naïve, effector, memory, exhausted 1, exhausted 2 and exhausted 3) (<xref ref-type="fig" rid="pcbi.1008814.g005">Fig 5C</xref>). Interestingly, cells in exhausted 3 cluster showed the highest enrichment of the clonotypes targeting HBV<sub>core195</sub>-epitope (Fisher’s exact test p = 3e-06, Benjamini-Hochberg corrected for multiple testing p.adj = 0.001), but not to any other epitope-specific clonotypes (<xref ref-type="fig" rid="pcbi.1008814.g005">Fig 5D and 5E</xref>). Enrichment of HBV targeting clonotypes was not significant with more stringent TCRGP prediction probabilities possibly due to small number of cells. By calculating exhaustion score for each T cell, we found that exhausted 3 cluster was the most exhausted (Mann-Whitney U test against exhausted 2 p = 0.003, against exhausted 1 p = 0.002) and the least cytotoxic cluster (p = 0.02 and p = 1e-05). Further, gene-level analysis showed high expression of <italic>TIGIT</italic> and <italic>HAVCR2</italic> (encoding TIM-3), which have been associated with late-stage exhaustion after long antigen exposure. Upregulated pathways for exhaustion cluster 3 were IL2-STAT5 signaling pathway (exh3 vs exh1 q = 0.022 and exh3 vs exh2 q = 0.000) and myogenesis pathway (q = 0.016 and q = 0.001).</p>
      <p>In summary, TCRGP was able to identify a T cell cluster that was enriched with HBV-targeting clonotypes, which was the most exhausted and least functional. This could provide a mechanism for loss of immunological control against HBV after chronic antigen stimulation which could aid in pathogenesis towards HCC. The implementation for the analysis and the datasets used are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/janihuuh/tcrgp_manu_hcc">https://github.com/janihuuh/tcrgp_manu_hcc</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec010">
    <title>Discussion</title>
    <p>In this paper we have demonstrated that when we have sufficient amount of experimentally produced epitope-specific TCR-sequencing data available for training a classifier, TCRGP can predict with a relatively high accuracy if previously unseen TCRs recognize an epitope. However, the exact number of TCRs required to achieve a certain level of accuracy varies greatly between the different epitopes. This likely reflects the fact that different epitopes can be more selective in choosing their TCR interactions. In other words, TCRs that recognize one epitope can be more diverse than the TCRs that recognize another epitope [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>], and if the TCRs are very heterogeneous, it requires more sampling to get a representative sample of these TCRs for the model training. In addition, we have shown that also CDRs other than CDR3<italic>β</italic> can provide useful information for the classification task, although it depends on the epitope in question which of the CDRs are most important. Although computational methods cannot replace experimental measurements in determining exact epitope-specificities of TCRs, they may be used to complement them for example when analyzing existing unselected TCR repertoire data or to guide experimental designs for <italic>ex vivo</italic> measurements.</p>
    <p>In this work we have provided a comprehensive analysis of current epitope-specificity prediction algorithms on a large set of publicly available epitope-specific TCR sequences. With the currently available epitope-specific TCR sequence data we have been able to come this far, but as more data becomes available with modern high-throughput techniques presented recently [<xref rid="pcbi.1008814.ref040" ref-type="bibr">40</xref>, <xref rid="pcbi.1008814.ref041" ref-type="bibr">41</xref>], new possibilities will rise. With a larger variety of pMHC complexes and TCRs that recognize them, we hope to be able to better consider the cross-reactivity of TCRs, similarities between different epitopes, and the significance of the HLA-types of the MHC proteins presenting the epitopes and perhaps even predict if a TCR can recognize a previously unseen epitope. As the proposed GP formalism has been shown to scale to very large data sets with up to billion data points [<xref rid="pcbi.1008814.ref042" ref-type="bibr">42</xref>], it should be well suited for the arising challenge.</p>
    <p>The previous supervised algorithms developed are presented in the case of epitope-specific data, but we believe that to answer clinically relevant questions we need to address the unselected repertoire data which is far more numerous in size and more easily produced. Therefore we presented a novel workflow for analysis of scRNA+TCR<italic>αβ</italic> data in a clinically relevant question, showing the power of determining the epitope-specifity <italic>in silico</italic> to reveal underlying transcriptomic heterogeneity of the epitope-specific T cells, which has been previously difficult to perform. As the number of scRNA+TCR<italic>αβ</italic> and conventional TCR<italic>β</italic> sequencing data in clinical settings is increasing [<xref rid="pcbi.1008814.ref043" ref-type="bibr">43</xref>–<xref rid="pcbi.1008814.ref050" ref-type="bibr">50</xref>], we expect that models like ours can be applied to a variety of research questions where exhaustive <italic>ex vivo</italic> pMHC-multimer assays are not feasible. In conclusion, we propose that TCRGP could be useful in the diagnosis and follow-up of infectious diseases, in autoimmune disorders and cancer immunotherapy.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec011">
    <title>Materials and methods</title>
    <sec id="sec012">
      <title>Data</title>
      <sec id="sec013">
        <title>T cell receptor sequences</title>
        <p>Our experiments focus on TCRs formed by a pair of <italic>α</italic>- and <italic>β</italic>-chains, as those are the most common type of TCRs [<xref rid="pcbi.1008814.ref051" ref-type="bibr">51</xref>]. The CDR3 sequence is formed by V(D)J recombination, but CDR1, CDR2, and CDR2.5 sequences are determined completely by the V-gene and allele [<xref rid="pcbi.1008814.ref003" ref-type="bibr">3</xref>]. We align the CDR3 sequence by adding a gap at the top of the loop, following the IMGT numbering [<xref rid="pcbi.1008814.ref011" ref-type="bibr">11</xref>]. Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] provide a table of all V-gene and allele combinations and the corresponding CDR1, CDR2, and CDR2.5 amino acid sequences aligned according to IMGT definitions [<xref rid="pcbi.1008814.ref011" ref-type="bibr">11</xref>]. Our method can utilize the aligned amino acid sequences of all these CDRs from either one or both of the <italic>α</italic>- and <italic>β</italic>-chains of the TCR. <xref ref-type="fig" rid="pcbi.1008814.g001">Fig 1</xref> shows a few examples of TCR sequences and their alignment.</p>
      </sec>
      <sec id="sec014">
        <title>Datasets</title>
        <p>In our experiments, we use a data set collected by Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] (from hereon referred to as Dash data), which contains epitope-specific paired TCR<italic>α</italic> and TCR<italic>β</italic> chains for three epitopes from humans and for seven epitopes from mice, see <xref rid="pcbi.1008814.t003" ref-type="table">Table 3</xref> for details.</p>
        <p>We also gather a new data set (VDJdb data) from VDJdb (<ext-link ext-link-type="uri" xlink:href="http://https://vdjdb.cdr3.net">http://https://vdjdb.cdr3.net</ext-link>, downloaded 9th October 2018) [<xref rid="pcbi.1008814.ref016" ref-type="bibr">16</xref>], which is a database that contains TCR sequences with known antigen specificity. Every entry in VDJdb has been given a confidence score between 0 and 3 (0: critical information missing, 1: medium confidence, 2: high confidence, 3: very high confidence). We constructed our data set so that we selected all epitopes that have at least 50 TCR<italic>β</italic> sequences with a confidence score at least 1 and found 22 such epitopes. Twenty of these epitopes are MCH class I restricted and two are MHC class II restricted and have varying HLA-types, see <xref rid="pcbi.1008814.t003" ref-type="table">Table 3</xref> for details. VDJdb also contains TCR<italic>α</italic> sequences, but since these are not in general paired with the corresponding TCR<italic>β</italic> sequences, we chose to only experiment with the TCR<italic>β</italic> sequences. The VDJdb data and the Dash data have some overlap for TCRs specific to three epitopes: In the VDJdb data 34 (27 unique) of the 413 (242 unique) TCRs for pp65<sub>495-503</sub>, 30 (27) of 299 (152) for BMLF1<sub>280-288</sub>, and 74 (61) of 239 (138) for M1<sub>58-66</sub> can also be found from the Dash data.</p>
        <p>For the training and testing of the models, we also required some background TCRs that we do not expect to recognize the epitopes in our data sets. For this purpose, we randomly sampled the required amount of TCRs from sets of background TCRs constructed by Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>]. They report that the human <italic>α</italic>- and <italic>β</italic>-chains have been obtained from Howie et <italic>al.</italic> [<xref rid="pcbi.1008814.ref052" ref-type="bibr">52</xref>], who have collected blood from two healthy adults. The mouse <italic>α</italic>-chains they have gathered from short read archive (SRA) projects SRP010815 [<xref rid="pcbi.1008814.ref053" ref-type="bibr">53</xref>], and SRP059581 [<xref rid="pcbi.1008814.ref054" ref-type="bibr">54</xref>] and mouse <italic>β</italic>-chains from SRA projects SRP059581 [<xref rid="pcbi.1008814.ref054" ref-type="bibr">54</xref>], SRP015131 [<xref rid="pcbi.1008814.ref055" ref-type="bibr">55</xref>], and SRP004475. To create paired <italic>α</italic>- and <italic>β</italic>-chains they randomly paired the unpaired <italic>α</italic>- and <italic>β</italic>-chains from the repertoires for the corresponding organism.</p>
      </sec>
      <sec id="sec015">
        <title>Construction of training and test sets</title>
        <p>For the evaluation of the methods developed by us and others, we needed to divide our data sets for training and testing. Both of the data sets we use determine the subjects from whom the TCRs in the data have been obtained from. We therefore chose to use leave-one-subject-out (LOSO) cross-validation, where we leave out all TCRs from one subject, train the model with all the other TCRs, test it with the TCRs left out, and repeat this for all subjects. The epitope-specific TCRs are always complemented with an equal number of background TCRs in both training and test sets, except for the experiments presented in Section Discriminating between epitope-specific TCRs, were we use only the VDJdb data. We thought this would be the most realistic procedure for the evaluation, as this is likely how these kinds of models will be applied to new data: A model is trained with some set of TCRs and then predictions would be made for TCRs sequenced from an individual from who we have not seen any TCR sequences beforehand. We have chosen to create separate models for each epitope, as this approach automatically handles potential cross-reactivity between different epitopes—we only have to select such TCRs for training the model that we can assume to recognize that one epitope or to not recognize that epitope. If we then want to predict TCR’s specificity to one or several epitopes, we can apply one or several models and get separate predictions for each of the epitopes.</p>
        <p>In the Dash data the average number of TCRs per fold varied between 6 (for pp65<sub>123-131</sub>) and 22 (for M45<sub>985-993</sub>), and in the VDJdb data between 3 (for p24<sub>30-40</sub>) and 45 (for NS4B<sub>214-222</sub>). The number of subjects, TCRs and unique TCRs for each epitope can be found from <xref rid="pcbi.1008814.t003" ref-type="table">Table 3</xref>.</p>
        <p>The VDJdb data contains TCR sequences from multiple studies, many of which have used same conventions for naming their subjects. Therefore we used the combination of the PMID of the publication and the subject id as the subject identifier. For two epitopes, p24<sub>223-231</sub> and NS3<sub>1406-1415</sub> there were very few separate subjects, only one and four, respectively. With these epitopes we used 5-fold cross-validation instead of the LOSO cross-validation.</p>
        <p>We also evaluated the methods using leave-one-out (LOO) cross-validation with only unique TCR sequences. With LOO, the model is trained with all but one TCR and then tested with the left out TCR, and this procedure is repeated for each TCR. This way, we could utilize the maximal amount of training samples and also evaluate the model performance solely on new TCRs. We considered a TCR to be unique when it consists of a unique combination of CDR3 amino acid sequences and V-genes from both <italic>α</italic>- and <italic>β</italic>-chains, when both are available, and from the <italic>β</italic>-chains, when only TCR<italic>β</italic> is utilized.</p>
      </sec>
      <sec id="sec016">
        <title>TCR repertoire diversity</title>
        <p>To estimate the diversity of the epitope-specific TCRs for each epitope, we developed a diversity measure following the example of Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>]. The Simpson’s diversity index was then generalized to account for the similarity of TCRs by utilizing the Gaussian kernel function as follows:
<disp-formula id="pcbi.1008814.e001"><alternatives><graphic xlink:href="pcbi.1008814.e001.jpg" id="pcbi.1008814.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>diversity</mml:mtext><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mstyle><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
Here <italic>σ</italic><sup>2</sup> is the kernel variance and <italic>l</italic> is the lengthscale of the Gaussian kernel used by TCRGP, and <bold>x</bold><sub><italic>i</italic></sub> and <bold>x</bold><sub><italic>j</italic></sub> are feature vectors for the TCRs <italic>i</italic>, <italic>j</italic> ∈ [1, <italic>N</italic>]. The kernel variance and lengthscale were set to the average values used for the 22 epitopes in the VDJdb data (<italic>σ</italic><sup>2</sup> = 5.52, <italic>l</italic> = 2.50).</p>
      </sec>
    </sec>
    <sec id="sec017">
      <title>TCRGP classifier</title>
      <sec id="sec018">
        <title>Sequence representation</title>
        <p>Computational methods require the data to have some presentation, that they can utilize. Character sequences with variable lengths often provide some challenges as many methods rely on numerical inputs of fixed sizes. One solution is to compare subsequences of same length instead of the complete sequences, which is what for example Generic String kernel (GSkernel) does [<xref rid="pcbi.1008814.ref056" ref-type="bibr">56</xref>]. However, by aligning the sequences more approaches become applicable. According to the IMGT definitions [<xref rid="pcbi.1008814.ref011" ref-type="bibr">11</xref>] CDR3s can be aligned by introducing a gap in the middle of the sequence (i.e. top of the loop). Alignments for CDR1s, CDR2s, and CDR2.5s can be found from <ext-link ext-link-type="uri" xlink:href="http://www.imgt.org">http://www.imgt.org</ext-link>. When the sequences are aligned, all the sequences within a CDR class (1, 2, 2.5 or 3) have the same length (see <xref ref-type="fig" rid="pcbi.1008814.g001">Fig 1A</xref>).</p>
        <p>We observe sequences <italic>a</italic><sub>1</sub>
<italic>a</italic><sub>2</sub>⋯<italic>a</italic><sub><italic>L</italic></sub> of amino acids <inline-formula id="pcbi.1008814.e002"><alternatives><graphic xlink:href="pcbi.1008814.e002.jpg" id="pcbi.1008814.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mstyle mathvariant="script"><mml:mi>A</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo form="postfix" stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> at aligned positions <italic>j</italic> = 1, …, <italic>L</italic>. The alignment guarantees that all sequences have the same possibly padded length <italic>L</italic>. We encode the amino acids <italic>a</italic> with global feature vectors <inline-formula id="pcbi.1008814.e003"><alternatives><graphic xlink:href="pcbi.1008814.e003.jpg" id="pcbi.1008814.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:mi mathvariant="bold-italic">ϕ</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> that associate a <italic>D</italic>-length real-valued code with each of the 21 amino acids including the gap symbol. The sequences are then encoded as data vectors <bold>x</bold> by concatenating the <italic>L</italic> feature vectors into a <italic>D</italic> ⋅ <italic>L</italic> length column vectors <inline-formula id="pcbi.1008814.e004"><alternatives><graphic xlink:href="pcbi.1008814.e004.jpg" id="pcbi.1008814.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">ϕ</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">ϕ</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:mstyle mathvariant="script"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula>. We collect a dataset of <italic>N</italic> sequences into a matrix <inline-formula id="pcbi.1008814.e005"><alternatives><graphic xlink:href="pcbi.1008814.e005.jpg" id="pcbi.1008814.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> with rows as sequences and columns as individual amino acid features in aligned order. Each sequence is associated with a class label <italic>y</italic><sub><italic>i</italic></sub> ∈ {0, 1} that indicates whether the sequence was epitope-specific or not. We collect the class labels into an output vector <bold>y</bold> = (<italic>y</italic><sub>1</sub>, …, <italic>y</italic><sub><italic>N</italic></sub>)<sup><italic>T</italic></sup> ∈ {0, 1}<sup><italic>N</italic></sup>.</p>
        <p>We can observe amino acid sequences of the four complementarity determining regions (CDR) {1, 2, 2.5, 3} for both the <italic>α</italic>- and <italic>β</italic>-chains from a single TCR. Sequence data for each chain and CDR combination has an individual alignment and sequence length. We denote the data as (<bold>X</bold><sub><italic>α</italic>,1</sub>, <bold>X</bold><sub><italic>α</italic>,2</sub>, <bold>X</bold><sub><italic>α</italic>,2.5</sub>, <bold>X</bold><sub><italic>α</italic>,3</sub>, <bold>X</bold><sub><italic>β</italic>,1</sub>, <bold>X</bold><sub><italic>β</italic>,2</sub>, <bold>X</bold><sub><italic>β</italic>,2.5</sub>, <bold>X</bold><sub><italic>β</italic>,3</sub>, <bold>y</bold>).</p>
        <p>Substitution matrices such as BLOSUM62 [<xref rid="pcbi.1008814.ref057" ref-type="bibr">57</xref>] describe the similarity of each amino acid. We modified the BLOSUM62 to include also the gap used in alignments and scaled the matrix values between 0 and 1. The similarity of the gap and all amino acids were set to zero and the value on the diagonal was set to the smallest value on the diagonal. The resulting matrix <inline-formula id="pcbi.1008814.e006"><alternatives><graphic xlink:href="pcbi.1008814.e006.jpg" id="pcbi.1008814.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>B</mml:mi></mml:mstyle><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mrow><mml:mn>21</mml:mn><mml:mo>×</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is then positive semidefinite. We apply eigendecomposition <bold>B</bold> = <bold>VSV</bold><sup><italic>T</italic></sup>, where the column vectors of <bold>V</bold> encode orthogonal projections of the amino acids on the rows. We use the row vectors of <bold>V</bold>, indexed by the amino acids <italic>a</italic> from the modified BLOSUM62, as our descriptions <bold><italic>ϕ</italic></bold>(<italic>a</italic>) = <bold>V</bold><sub><italic>a</italic>,:</sub> with a feature representation <bold><italic>ϕ</italic></bold>(<italic>a</italic>)<sup><italic>T</italic></sup><bold>S<italic>ϕ</italic></bold>(<italic>b</italic>) = [<bold>B</bold>]<sub><italic>ab</italic></sub> for any two amino acids <inline-formula id="pcbi.1008814.e007"><alternatives><graphic xlink:href="pcbi.1008814.e007.jpg" id="pcbi.1008814.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mstyle mathvariant="script"><mml:mi>A</mml:mi></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula>. It is possible to use also different substitution models and feature vectors obtained from different sources, or to even use the so-called one-hot-encoding, but here we relied only on the eigenvectors of the (gap-extended) BLOSUM62.</p>
      </sec>
      <sec id="sec019">
        <title>Gaussian process classification</title>
        <p>We use Gaussian process (GP) classification [<xref rid="pcbi.1008814.ref058" ref-type="bibr">58</xref>] to predict if a TCR recognizes a certain epitope or not. Gaussian processes model Gaussian distributions of non-parametric and non-linear functions. We apply a link function to squash the function values to a range [0, 1] suitable for classification. GPs have a clear advantage of characterizing the prediction uncertainty with class probabilities instead of point predictions. GPs naturally model sequences through kernel functions focusing on sequence similarity as the explaining factor for class predictions.</p>
        <p>We use a GP function <italic>f</italic> to predict the latent epitope-specificity <italic>score</italic>
<inline-formula id="pcbi.1008814.e008"><alternatives><graphic xlink:href="pcbi.1008814.e008.jpg" id="pcbi.1008814.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:mi>f</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula> of a sequence <bold>x</bold>. A zero-mean GP prior
<disp-formula id="pcbi.1008814.e009"><alternatives><graphic xlink:href="pcbi.1008814.e009.jpg" id="pcbi.1008814.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mi mathvariant="script">P</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
defines a distribution over functions <italic>f</italic>(<bold>x</bold>) whose mean and covariance are
<disp-formula id="pcbi.1008814.e010"><alternatives><graphic xlink:href="pcbi.1008814.e010.jpg" id="pcbi.1008814.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo>[</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>cov</mml:mtext></mml:mstyle><mml:mo>[</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>k</italic>(⋅, ⋅) is the kernel function. We use the standard squared exponential kernel on the vectorized feature representation,
<disp-formula id="pcbi.1008814.e011"><alternatives><graphic xlink:href="pcbi.1008814.e011.jpg" id="pcbi.1008814.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>ℓ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
where <italic>ℓ</italic> is the length-scale parameter, <italic>σ</italic><sup>2</sup> is the magnitude parameter and <italic>θ</italic> = (<italic>ℓ</italic>, <italic>σ</italic><sup>2</sup>). For any collection of TCR sequences <bold>X</bold> = (<bold>x</bold><sub>1</sub>, …, <bold>x</bold><sub><italic>N</italic></sub>), the function values follow a multivariate normal distribution
<disp-formula id="pcbi.1008814.e012"><alternatives><graphic xlink:href="pcbi.1008814.e012.jpg" id="pcbi.1008814.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>|</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
where <inline-formula id="pcbi.1008814.e013"><alternatives><graphic xlink:href="pcbi.1008814.e013.jpg" id="pcbi.1008814.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>f</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> collects all function predictions of the sequences, and <inline-formula id="pcbi.1008814.e014"><alternatives><graphic xlink:href="pcbi.1008814.e014.jpg" id="pcbi.1008814.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>K</mml:mi></mml:mstyle><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the sequence similarity matrix with [<bold>K</bold><sub><bold>XX</bold></sub>]<sub><italic>ij</italic></sub> = <italic>k</italic>(<bold>x</bold><sub><italic>i</italic></sub>, <bold>x</bold><sub><italic>j</italic></sub>). The key property of Gaussian processes is that they couple all predictions to be dependent. The Gaussian process predicts similar epitope values <italic>f</italic>(<bold>x</bold>), <italic>f</italic>(<bold>x</bold>′) for sequences <bold>x</bold>, <bold>x</bold>′ if they are similar according to the kernel <italic>k</italic>(<bold>x</bold>, <bold>x</bold>′).</p>
        <p>The latent function <italic>f</italic>(<bold>x</bold>) represents an unbounded real-valued classification score, which we turn into a classification likelihood by the probit link function <inline-formula id="pcbi.1008814.e015"><alternatives><graphic xlink:href="pcbi.1008814.e015.jpg" id="pcbi.1008814.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mo>Φ</mml:mo><mml:mo>:</mml:mo><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mo accent="false">↦</mml:mo><mml:mo form="prefix" stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo form="postfix" stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>,
<disp-formula id="pcbi.1008814.e016"><alternatives><graphic xlink:href="pcbi.1008814.e016.jpg" id="pcbi.1008814.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Φ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msubsup><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>τ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:mi>τ</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula></p>
        <p>The joint model then decomposes into a factorized Bernoulli likelihood and Gaussian prior,
<disp-formula id="pcbi.1008814.e017"><alternatives><graphic xlink:href="pcbi.1008814.e017.jpg" id="pcbi.1008814.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>)</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
<disp-formula id="pcbi.1008814.e018"><alternatives><graphic xlink:href="pcbi.1008814.e018.jpg" id="pcbi.1008814.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mtext>Ber</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>Φ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>|</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
where <italic>f</italic><sub><italic>i</italic></sub> is a shorthand for <italic>f</italic>(<bold>x</bold><sub><italic>i</italic></sub>). The objective of Gaussian process modelling is to infer the posterior distribution <italic>p</italic>(<bold>f</bold>|<bold>y</bold>), which is intractable for many non-Gaussian likelihoods. Additionally inferring the kernel hyper-parameters <italic>θ</italic> entails computing the marginalized <italic>evidence</italic>
<disp-formula id="pcbi.1008814.e019"><alternatives><graphic xlink:href="pcbi.1008814.e019.jpg" id="pcbi.1008814.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
which is also intractable in general and has a limiting cubic complexity <inline-formula id="pcbi.1008814.e020"><alternatives><graphic xlink:href="pcbi.1008814.e020.jpg" id="pcbi.1008814.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:mrow><mml:mstyle mathvariant="script"><mml:mi>O</mml:mi></mml:mstyle><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo form="postfix" stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>[<xref rid="pcbi.1008814.ref058" ref-type="bibr">58</xref>]. We tackle the scalability with sparse Gaussian processes [<xref rid="pcbi.1008814.ref059" ref-type="bibr">59</xref>] and the intractability with stochastic variational inference [<xref rid="pcbi.1008814.ref032" ref-type="bibr">32</xref>].</p>
      </sec>
      <sec id="sec020">
        <title>Variational inference for low-rank GP approximation</title>
        <p>We consider low-rank sparse Gaussian processes by augmenting the system with <italic>M</italic> inducing <italic>landmark</italic> pseudo-sequences <inline-formula id="pcbi.1008814.e021"><alternatives><graphic xlink:href="pcbi.1008814.e021.jpg" id="pcbi.1008814.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mstyle mathvariant="script"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula> with associated (label) function values <inline-formula id="pcbi.1008814.e022"><alternatives><graphic xlink:href="pcbi.1008814.e022.jpg" id="pcbi.1008814.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo form="prefix" stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo form="postfix" stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula>. We collect all inducing points into structures <bold>Z</bold> = (<bold>z</bold><sub>1</sub>, …, <bold>z</bold><sub><italic>M</italic></sub>)<sup><italic>T</italic></sup> and <bold>u</bold> = (<italic>u</italic><sub>1</sub>, …, <italic>u</italic><sub><italic>M</italic></sub>)<sup><italic>T</italic></sup>. By conditioning the GP with these values we obtain the augmented Gaussian process joint model
<disp-formula id="pcbi.1008814.e023"><alternatives><graphic xlink:href="pcbi.1008814.e023.jpg" id="pcbi.1008814.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>)</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
<disp-formula id="pcbi.1008814.e024"><alternatives><graphic xlink:href="pcbi.1008814.e024.jpg" id="pcbi.1008814.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mi mathvariant="bold">u</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
<disp-formula id="pcbi.1008814.e025"><alternatives><graphic xlink:href="pcbi.1008814.e025.jpg" id="pcbi.1008814.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>|</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
<disp-formula id="pcbi.1008814.e026"><alternatives><graphic xlink:href="pcbi.1008814.e026.jpg" id="pcbi.1008814.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula>
where <inline-formula id="pcbi.1008814.e027"><alternatives><graphic xlink:href="pcbi.1008814.e027.jpg" id="pcbi.1008814.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>K</mml:mi></mml:mstyle><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the kernel between observed sequences, <bold>K</bold><sub><bold>XZ</bold></sub> is between observed and induced sequences and <bold>K</bold><sub><bold>ZZ</bold></sub> is between induced sequences. The matrix <bold>A</bold> projects the <italic>M</italic> inducing points to the full observation space of <italic>N</italic> sequences.</p>
        <p>Next, we define a variational approximation for the inducing points,
<disp-formula id="pcbi.1008814.e028"><alternatives><graphic xlink:href="pcbi.1008814.e028.jpg" id="pcbi.1008814.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">m</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula>
<disp-formula id="pcbi.1008814.e029"><alternatives><graphic xlink:href="pcbi.1008814.e029.jpg" id="pcbi.1008814.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(13)</label></disp-formula>
<disp-formula id="pcbi.1008814.e030"><alternatives><graphic xlink:href="pcbi.1008814.e030.jpg" id="pcbi.1008814.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mi mathvariant="bold">m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi mathvariant="bold">A</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(14)</label></disp-formula>
where <inline-formula id="pcbi.1008814.e031"><alternatives><graphic xlink:href="pcbi.1008814.e031.jpg" id="pcbi.1008814.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>m</mml:mi></mml:mstyle><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1008814.e032"><alternatives><graphic xlink:href="pcbi.1008814.e032.jpg" id="pcbi.1008814.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>S</mml:mi></mml:mstyle><mml:mo>⪰</mml:mo><mml:mstyle mathvariant="bold"><mml:mn>0</mml:mn></mml:mstyle><mml:mo>∈</mml:mo><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> are free variational parameters to be optimized. It can be shown that minimizing the Kullback-Leibler divergence KL[<italic>q</italic>(<bold>u</bold>)||<italic>p</italic>(<bold>u</bold>|<bold>y</bold>)] between the approximative posterior <italic>q</italic>(<bold>u</bold>) and the true low-rank posterior <italic>p</italic>(<bold>u</bold>|<bold>y</bold>) is equivalent to maximizing the evidence lower bound (ELBO) [<xref rid="pcbi.1008814.ref060" ref-type="bibr">60</xref>]
<disp-formula id="pcbi.1008814.e033"><alternatives><graphic xlink:href="pcbi.1008814.e033.jpg" id="pcbi.1008814.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mo form="prefix">log</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mtext>KL</mml:mtext><mml:mo>[</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(15)</label></disp-formula></p>
        <p>The log expectation is tractable for Probit likelihoods [<xref rid="pcbi.1008814.ref061" ref-type="bibr">61</xref>], while the KL term similarly has a closed form for two Gaussian densities.</p>
        <p>Due to the small data regime we choose the optimal assignment of selecting <bold>Z</bold> = <bold>X</bold> and <bold>u</bold> = <bold>y</bold>, which corresponds to the full Gaussian variational approximation of [<xref rid="pcbi.1008814.ref062" ref-type="bibr">62</xref>], while for larger datasets the inducing landmark points can also be optimised [<xref rid="pcbi.1008814.ref032" ref-type="bibr">32</xref>]. We then optimize the ELBO (<xref ref-type="disp-formula" rid="pcbi.1008814.e033">Eq 15</xref>) with respect to the variational parameters <bold>m</bold> and <bold>S</bold> as well as the kernel hyperparameters <italic>θ</italic>, that is, the lengthscales <italic>ℓ</italic><sub><italic>cr</italic></sub> and weights <italic>w</italic><sub><italic>cr</italic></sub>.</p>
        <p>Finally, predictions <bold>f</bold><sub>*</sub> of new test sequences <inline-formula id="pcbi.1008814.e034"><alternatives><graphic xlink:href="pcbi.1008814.e034.jpg" id="pcbi.1008814.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msub><mml:mo>⊂</mml:mo><mml:mstyle mathvariant="script"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula> follow a variational predictive posterior
<disp-formula id="pcbi.1008814.e035"><alternatives><graphic xlink:href="pcbi.1008814.e035.jpg" id="pcbi.1008814.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">f</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">f</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(16)</label></disp-formula>
<disp-formula id="pcbi.1008814.e036"><alternatives><graphic xlink:href="pcbi.1008814.e036.jpg" id="pcbi.1008814.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>≈</mml:mo><mml:mo>∫</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">f</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">u</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi mathvariant="bold">u</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(17)</label></disp-formula>
<disp-formula id="pcbi.1008814.e037"><alternatives><graphic xlink:href="pcbi.1008814.e037.jpg" id="pcbi.1008814.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">f</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mi mathvariant="bold">m</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="bold">K</mml:mi><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi><mml:mi mathvariant="bold">Z</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi mathvariant="bold">A</mml:mi><mml:mo>*</mml:mo><mml:mi>T</mml:mi></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(18)</label></disp-formula>
where <bold>A</bold><sub>*</sub> indicates projection from the landmark points <bold>Z</bold> to the new sequences <bold>X</bold><sub>*</sub>. The predictive distribution is a Gaussian distribution for the latent test values <bold>f</bold><sub>*</sub>, from which the distributions of the test labels can be retrieved through the link function. We have implemented our model using GPflow, a Python package for building GP models using TensorFlow [<xref rid="pcbi.1008814.ref063" ref-type="bibr">63</xref>, <xref rid="pcbi.1008814.ref064" ref-type="bibr">64</xref>]. We utilized GPflow’s variational GP model (VGP) and scalable variational GP model (SVGP)[<xref rid="pcbi.1008814.ref031" ref-type="bibr">31</xref>, <xref rid="pcbi.1008814.ref032" ref-type="bibr">32</xref>].</p>
      </sec>
      <sec id="sec021">
        <title>Multiple kernel learning</title>
        <p>When a TCR binds to a pMHC, its CDR3s and CDR1s from both <italic>α</italic>- and <italic>β</italic>-chains are in direct contact with the peptide most of the time. CDR2s and CDR2.5s can contact the peptide, but they usually only interact with the MHC, see Glanville et <italic>al.</italic> [<xref rid="pcbi.1008814.ref009" ref-type="bibr">9</xref>] for an overview of contacts between different CDRs and peptides. Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] took this into account by giving fixed weights for the distances between amino acids within different CDRs, giving more weight to the CDR3. As it varies which CDRs can be in contact with different peptides, we did not want to determine the importance of these different CDRs beforehand, but instead created separate kernels for each CDR and let our model decide which of them are important. We define the kernel as a convex combination of the base kernels for the four CDR regions <italic>r</italic> and the two chains <italic>c</italic>,
<disp-formula id="pcbi.1008814.e038"><alternatives><graphic xlink:href="pcbi.1008814.e038.jpg" id="pcbi.1008814.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>;</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(19)</label></disp-formula>
where the weights <italic>w</italic><sub><italic>cr</italic></sub> ≥ 0 are non-negative. While we can utilize all CDRs from both chains, it is also possible to use any subset of them.</p>
      </sec>
    </sec>
    <sec id="sec022">
      <title>Single-cell RNA+TCR<italic>αβ</italic>-sequencing data analysis</title>
      <sec id="sec023">
        <title>TCRGP classifiers for HBV-epitopes</title>
        <p>Recently, Cheng et <italic>al.</italic> [<xref rid="pcbi.1008814.ref039" ref-type="bibr">39</xref>] mapped HBV-reactive T cell populations by exhaustively screening the whole HBV genome with an HLA-class I restricted multiplexed pMHC-tetramer strategy and characterized T cells against four interesting HBV-epitopes from two antigens with TCR<italic>β</italic>-sequencing (the Cheng data). Utilizing the TCRs specific to HBV-epitopes HBV<sub>core169</sub>, HBV<sub>core195</sub>, HBV<sub>pol282</sub>, and HBV<sub>pol387</sub> (here core refers to core protein and pol to polymerase protein) from the Cheng data and control sequences from Dash et <italic>al.</italic> [<xref rid="pcbi.1008814.ref010" ref-type="bibr">10</xref>] we trained a TCRGP classifier for each epitope. We utilized all epitope-specific TCRs from which we could determine also CDR1<italic>β</italic>, CDR2<italic>β</italic>, and CDR2.5<italic>β</italic> in addition to CDR3<italic>β</italic> and complemented these epitope-specific TCRs with the same amount of control TCRs. We considered TCRs which were predicted to recognize the epitopes with at least 85% probability as epitope-specific. The amounts of epitope-specific TCRs and AUROC scores obtained from leave-one-subject-out cross-validations for each epitope are shown in <xref rid="pcbi.1008814.t004" ref-type="table">Table 4</xref>. We used TCRGP and VGP with all epitopes except for HBV<sub>pol387</sub>, with which we used SVGP with 700 inducing points due to the high number of samples.</p>
        <table-wrap id="pcbi.1008814.t004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1008814.t004</object-id>
          <label>Table 4</label>
          <caption>
            <title>HBV-epitopes for which TCRGP classifiers were trained.</title>
            <p>The numbers of epitope-specific TCRs and subjects, and mean AUROC scores from leave-one-subject-out cross-validations are shown.</p>
          </caption>
          <alternatives>
            <graphic id="pcbi.1008814.t004g" xlink:href="pcbi.1008814.t004"/>
            <table frame="box" rules="all" border="0">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="1" colspan="1">Epitope</th>
                  <th align="center" rowspan="1" colspan="1">Samples</th>
                  <th align="center" rowspan="1" colspan="1">Subjects</th>
                  <th align="center" rowspan="1" colspan="1">AUROC</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">HBV<sub>core169</sub></td>
                  <td align="center" rowspan="1" colspan="1">699</td>
                  <td align="center" rowspan="1" colspan="1">9</td>
                  <td align="center" rowspan="1" colspan="1">0.756</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">HBV<sub>core195</sub></td>
                  <td align="center" rowspan="1" colspan="1">588</td>
                  <td align="center" rowspan="1" colspan="1">12</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.847</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">HBV<sub>pol282</sub></td>
                  <td align="center" rowspan="1" colspan="1">459</td>
                  <td align="center" rowspan="1" colspan="1">12</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.880</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">HBV<sub>pol387</sub></td>
                  <td align="center" rowspan="1" colspan="1">1348</td>
                  <td align="center" rowspan="1" colspan="1">12</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.760</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
      </sec>
      <sec id="sec024">
        <title>Single-cell RNA+TCR<italic>αβ</italic> data</title>
        <p>Zheng et <italic>al.</italic> [<xref rid="pcbi.1008814.ref038" ref-type="bibr">38</xref>] published a dataset (the Zheng data) of single-cell RNA and TCR<italic>αβ</italic> of T cells from HBsAg-positive HCC-patients from blood, non-malignant liver tissue and tumour tissue. The unnormalized expression count data of T cells passing the quality control were fetched from GEO (GSE98638) along with the TCR<italic>αβ</italic>-sequences inferred from the full-transcript single-cell RNA-sequencing data and inferred phenotypic states as described by Zheng et <italic>al.</italic> As the TCR<italic>β</italic>-sequenced training data for HBV-specific epitopes was HLA-A restricted, we focused our analysis only on T cells capable of peptide recognition in HLA-A restricted manner, namely clusters CD8-LEF1, CD8-CX3CR1, CD8-LAYN and CD8-GZMK. The data was log-normalized to 10 000 counts per cell and scaled accordingly with the Seurat 3.0.2. [<xref rid="pcbi.1008814.ref065" ref-type="bibr">65</xref>] package for R 3.5.2.</p>
      </sec>
      <sec id="sec025">
        <title>Clustering</title>
        <p>The highly variable genes (HVGs) were chosen to be the genes showing the highest mean to variance ratio (min expression = 0.5, max expression 3, min variance 0.5) with the FindVariableFeatures-function. The linear dimensionality reduction was calculated with PCA for the scaled expression matrix containing only HVGs. Non-linear dimensionality reduction was performed with UMAP for principal components that had standard deviation &gt;2 using the standard parameters with the RunUMAP-function. To receive a better grouping for the selected cells, we used a graph-based clustering approach implemented in the Seurat tool. To find the shared nearest neighbor graph, the function FindNeighbors was used with the same amount of PCs as with UMAP. To determine optimal clustering, FindClusters-functions was used with several parameter values for the resolution parameter, ranging from [0.1, 3]. The optimal clustering was decided by agreement of grouping in the UMAP-embedding and the labels from clustering by visual interpretation.</p>
        <p>The cytotoxic and exhaustion signatures for the clusters were calculated as cell-wise mean expression of cytotoxic (<italic>NKG7</italic>, <italic>CCL4</italic>, <italic>CST7</italic>, <italic>PRF1</italic>, <italic>GZMA</italic>, <italic>GZMB</italic>, <italic>IFNG</italic>, <italic>CCL3</italic>) and exhaustion genes (<italic>CTLA4</italic>, <italic>PDCD1</italic>, <italic>HAVCR2</italic>, <italic>TIGIT</italic>, <italic>LAG3</italic>). The difference between the signatures was assessed with Mann-Whitney U test for individual cells in clusters. Gene Set Enrichment Analysis (GSEA) between the clusters was performed on genes that were detected at least in 0.1% of the cells and had at least log fold-change of 0.01 between the tested cells. The gene list was ordered based on the fold-change. Overlap with HALLMARK-category was assessed and the False Discovery Rate (FDR) calculated while the number of permutations was 1000.</p>
      </sec>
      <sec id="sec026">
        <title>Enrichment analysis</title>
        <p>The one-sided Fisher’s test for enrichment of epitope-specific T cells to different phenotypes was calculated independently for individual and pooled patients, epitopes and tissues. The obtained P-values were adjusted with Benjamini-Hochberg procedure for false-discovery.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec027">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s001">
      <label>S1 Fig</label>
      <caption>
        <title>Mean AUROC scores for the Dash data using leave-one-subject-out cross-validation.</title>
        <p>TCRGP models (left column) and TCRdist models (right column) were trained using either only CDR3 or all CDRs from TCR<italic>α</italic>, TCR<italic>β</italic>, or both.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s002">
      <label>S2 Fig</label>
      <caption>
        <title>Distribution estimates and epitope-by-epitope method comparisons of mean AUROC scores for the Dash data using leave-one-out cross-validation with unique TCRs.</title>
        <p><bold>(A)</bold> The blue parts of the violin plots illustrate the AUROC scores of predictions made by TCRGP for all the epitopes and the orange parts illustrate the AUROC scores obtained with TCRdist. Each point within a violin plot presents the mean AUROC score obtained for one epitope. The used chains (<italic>α</italic> and/or <italic>β</italic>) and CDRs (three or all) are indicated below each panel. <bold>(B)</bold> Comparison of AUROC scores obtained with TCRGP and TCRdist using only CDR3 from TCR<italic>αβ</italic>, TCR<italic>β</italic>, or TCR<italic>α</italic> for each epitope separately. The epitopes have been arranged in increasing order of AUROC scores obtained by TCRGP using CDR3 from <italic>α</italic>- and <italic>β</italic>-chains (blue line).<bold>(C)</bold> Comparison of AUROC scores obtained with TCRGP and TCRdist using all CDRs from TCR<italic>αβ</italic>, TCR<italic>β</italic>, or TCR<italic>α</italic> for each epitope separately. The epitopes have been arranged in increasing order of AUROC scores obtained by TCRGP using all CDRs from <italic>α</italic>- and <italic>β</italic>-chains (blue line).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s003">
      <label>S3 Fig</label>
      <caption>
        <title>Mean AUROC scores for the Dash data using leave-one-out cross-validation with unique TCRs.</title>
        <p>TCRGP models (left column) and TCRdist models (right column) we trained using either TCR<italic>α</italic>, TCR<italic>β</italic>, or both and either with only CDR3 or all CDRs.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s004">
      <label>S4 Fig</label>
      <caption>
        <title>Mean AUROC scores for the VDJdb data using leave-one-subject-out cross-validation.</title>
        <p>TCRGP models and TCRdist models (the first two columns) were trained using TCR<italic>β</italic> with either only CDR3 or all CDRs. RF models and DeepTCR models (the last two columns) were trained using the CDR3<italic>β</italic> and the V<italic>β</italic>-gene, from which the other CDRs can be derived from.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s005">
      <label>S5 Fig</label>
      <caption>
        <title>Distribution estimates and epitope-by-epitope method comparisons of mean AUROC scores for the VDJdb data using leave-one-out cross-validation with unique TCRs.</title>
        <p><bold>(A)</bold> One violin plot presents the mean AUROC scores obtained with one method for all epitopes in the VDJdb data. Below each violin plot there is the name of the method used and in the brackets which CDRs have been used (3 for CDR3, all for CDR1, CDR2, CDR2.5, and CDR3). Each point within a violin plot presents the mean AUROC score obtained for one epitope. * RF (Random Forest TCR-classifier of De Neuter et <italic>al.</italic> [<xref rid="pcbi.1008814.ref019" ref-type="bibr">19</xref>]) could not produce predictions for all epitopes. The AUROC scores for RF have been obtained without these epitopes (8 and 4 epitopes were left out when only CDR3<italic>β</italic> was used and when also V<italic>β</italic>-gene was used, respectively, see <xref ref-type="supplementary-material" rid="pcbi.1008814.s006">S6 Fig</xref>). <bold>(B)</bold> Comparison of AUROC scores obtained with the different methods for each epitope separately. The epitopes have been arranged in increasing order of AUROC scores obtained by TCRGP using all CDR<italic>β</italic>s (orange line).</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s006">
      <label>S6 Fig</label>
      <caption>
        <title>Mean AUROC scores for the VDJdb data using leave-one-out cross-validation.</title>
        <p>Only unique TCRs have been utilized. TCRGP models and TCRdist models (the first two columns) were trained using TCR<italic>β</italic> with either only CDR3 or all CDRs. RF models and DeepTCR models (the last two columns) were trained using the CDR3<italic>β</italic> and the V<italic>β</italic>-gene, from which the other CDRs can be derived from.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s007">
      <label>S7 Fig</label>
      <caption>
        <title>Learning curves.</title>
        <p>With each epitope from the VDJdb dataset, TCRGP models were trained using different numbers of unique epitope-specific TCRs, always complemented with the same number of control TCRs. For each point of the learning curve the model was trained with 100 random samples of the TCRs, using either CDR1, CDR2, CDR2.5, and CDR3 (blue curves), or only CDR3 (orange curves). The darker lines show the mean of the predictions and the shaded areas +/- the standard deviation for the 100 folds.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s008">
      <label>S8 Fig</label>
      <caption>
        <title>Diversity of TCRs within and between subjects.</title>
        <p><bold>(A)</bold> Equation for computing the diversity between two subjects <italic>s</italic> and <italic>t</italic>. The diversity between multiple subjects can be computed similarly. <bold>(B)</bold> Scatter plot of diversities. Vertical axis shows diversity of epitope-specific TCRs between subjects and horizontal axis shows average diversity of TCRs within each subject. Diversities are computed for 21 epitopes from the VDJdb data (this data contained TCRs from only one subject for HIV-1 epitope p<sub>223-231</sub>, which was therefore left out from this figure). Diversities between subjects seem to be slightly larger than within subjects (on average 4.3% larger, Pearson correlation 0.82). <bold>(C)</bold> Pairwise diversities between subjects, where diversities within subjects are shown on the diagonal. Subjects are sorted by increasing diversity and only subjects with at least two TCRs have been included in this figure.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s009">
      <label>S9 Fig</label>
      <caption>
        <title>Comparisons with different control data.</title>
        <p>Comparisons with TCRGP with different control data using either all CDR<italic>β</italic>s (left column) or only CDR3<italic>β</italic>s (right column). 1: mean AUROC scores from leave-one-out cross validation when equal number of epitope-specific and control TCRs are used in training and testing (same as in <xref ref-type="supplementary-material" rid="pcbi.1008814.s006">S6 Fig</xref>). 2: Mean AUROC scores from stratified 200-fold cross validation when TCRs specific to other epitopes in the VDJdb data have been used as control data. 3: Otherwise same as 2, but only TCRs specific to epitopes restricted by MHC of type HLA-A*02 have been used for training and testing.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s010">
      <label>S1 File</label>
      <caption>
        <title>Result tables summarizing the prediction accuracy results presented in Figs <xref ref-type="fig" rid="pcbi.1008814.g002">2B</xref>, <xref ref-type="fig" rid="pcbi.1008814.g003">3B</xref> and <xref ref-type="fig" rid="pcbi.1008814.g004">4A</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1008814.s001">S1</xref>–<xref ref-type="supplementary-material" rid="pcbi.1008814.s006">S6</xref> and <xref ref-type="supplementary-material" rid="pcbi.1008814.s009">S9</xref> Figs, and a list of studies from which the VDJdb data consists of.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s010.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s011">
      <label>S2 File</label>
      <caption>
        <title>Benjamini-Hochberg corrected P-values from Wilocoxon signed rank tests for method comparisons with the Dash data and the VDJdb data.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s011.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1008814.s012">
      <label>S3 File</label>
      <caption>
        <title>Detailed information of the MHCs for different epitopes in the VDJdb data.</title>
        <p>(XLSX)</p>
      </caption>
      <media xlink:href="pcbi.1008814.s012.xlsx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to acknowledge the computational resources provided by the Aalto Science-IT.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1008814.ref001">
      <label>1</label>
      <mixed-citation publication-type="book"><name><surname>Davis</surname><given-names>MM</given-names></name>, <name><surname>Bjorkman</surname><given-names>PJ</given-names></name>. <chapter-title>A model for T cell receptor and MHC/peptide interaction</chapter-title>. In: <source>Mechanisms of Lymphocyte Activation and Immune Regulation II</source>. <publisher-loc>New York City</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>1989</year>. p. <fpage>13</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Miles</surname><given-names>JJ</given-names></name>, <name><surname>Silins</surname><given-names>SL</given-names></name>, <name><surname>Brooks</surname><given-names>AG</given-names></name>, <name><surname>Davis</surname><given-names>JE</given-names></name>, <name><surname>Misko</surname><given-names>I</given-names></name>, <name><surname>Burrows</surname><given-names>SR</given-names></name>. <article-title>T-cell grit: large clonal expansions of virus-specific CD8+ T cells can dominate in the peripheral circulation for at least 18 years</article-title>. <source>Blood</source>. <year>2005</year>;<volume>106</volume>(<issue>13</issue>):<fpage>4412</fpage>–<lpage>4413</lpage>. <pub-id pub-id-type="doi">10.1182/blood-2005-06-2261</pub-id><pub-id pub-id-type="pmid">16326979</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Bassing</surname><given-names>CH</given-names></name>, <name><surname>Swat</surname><given-names>W</given-names></name>, <name><surname>Alt</surname><given-names>FW</given-names></name>. <article-title>The mechanism and regulation of chromosomal V(D)J recombination</article-title>. <source>Cell</source>. <year>2002</year>;<volume>109</volume>(<issue>2</issue>):<fpage>S45</fpage>–<lpage>S55</lpage>. <pub-id pub-id-type="doi">10.1016/S0092-8674(02)00675-X</pub-id><pub-id pub-id-type="pmid">11983152</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Cabaniols</surname><given-names>JP</given-names></name>, <name><surname>Fazilleau</surname><given-names>N</given-names></name>, <name><surname>Casrouge</surname><given-names>A</given-names></name>, <name><surname>Kourilsky</surname><given-names>P</given-names></name>, <name><surname>Kanellopoulos</surname><given-names>JM</given-names></name>. <article-title>Most <italic>α</italic>/<italic>β</italic> T cell receptor diversity is due to terminal deoxynucleotidyl transferase</article-title>. <source>Journal of Experimental Medicine</source>. <year>2001</year>;<volume>194</volume>(<issue>9</issue>):<fpage>1385</fpage>–<lpage>1390</lpage>. <pub-id pub-id-type="doi">10.1084/jem.194.9.1385</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Arstila</surname><given-names>TP</given-names></name>, <name><surname>Casrouge</surname><given-names>A</given-names></name>, <name><surname>Baron</surname><given-names>V</given-names></name>, <name><surname>Even</surname><given-names>J</given-names></name>, <name><surname>Kanellopoulos</surname><given-names>J</given-names></name>, <name><surname>Kourilsky</surname><given-names>P</given-names></name>. <article-title>A direct estimate of the human <italic>αβ</italic> T cell receptor diversity</article-title>. <source>Science</source>. <year>1999</year>;<volume>286</volume>(<issue>5441</issue>):<fpage>958</fpage>–<lpage>961</lpage>. <pub-id pub-id-type="doi">10.1126/science.286.5441.958</pub-id><pub-id pub-id-type="pmid">10542151</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Robins</surname><given-names>HS</given-names></name>, <name><surname>Campregher</surname><given-names>PV</given-names></name>, <name><surname>Srivastava</surname><given-names>SK</given-names></name>, <name><surname>Wacher</surname><given-names>A</given-names></name>, <name><surname>Turtle</surname><given-names>CJ</given-names></name>, <name><surname>Kahsai</surname><given-names>O</given-names></name>, <etal>et al</etal>. <article-title>Comprehensive assessment of T-cell receptor <italic>β</italic>-chain diversity in <italic>αβ</italic> T cells</article-title>. <source>Blood</source>. <year>2009</year>;<volume>114</volume>(<issue>19</issue>):<fpage>4099</fpage>–<lpage>4107</lpage>. <pub-id pub-id-type="doi">10.1182/blood-2009-04-217604</pub-id><?supplied-pmid 19706884?><pub-id pub-id-type="pmid">19706884</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref007">
      <label>7</label>
      <mixed-citation publication-type="book"><name><surname>Lefranc</surname><given-names>MP</given-names></name>, <name><surname>Lefranc</surname><given-names>G</given-names></name>. <source>The T cell receptor FactsBook</source>. <publisher-loc>Cambridge, Massachusetts</publisher-loc>: <publisher-name>Academic Press</publisher-name>; <year>2001</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Rudolph</surname><given-names>MG</given-names></name>, <name><surname>Stanfield</surname><given-names>RL</given-names></name>, <name><surname>Wilson</surname><given-names>IA</given-names></name>. <article-title>How TCRs bind MHCs, peptides, and coreceptors</article-title>. <source>Annu Rev Immunol</source>. <year>2006</year>;<volume>24</volume>:<fpage>419</fpage>–<lpage>466</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.immunol.23.021704.115658</pub-id><pub-id pub-id-type="pmid">16551255</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Glanville</surname><given-names>J</given-names></name>, <name><surname>Huang</surname><given-names>H</given-names></name>, <name><surname>Nau</surname><given-names>A</given-names></name>, <name><surname>Hatton</surname><given-names>O</given-names></name>, <name><surname>Wagar</surname><given-names>LE</given-names></name>, <name><surname>Rubelt</surname><given-names>F</given-names></name>, <etal>et al</etal>. <article-title>Identifying specificity groups in the T cell receptor repertoire</article-title>. <source>Nature</source>. <year>2017</year>;<volume>547</volume>(<issue>7661</issue>):<fpage>94</fpage>. <pub-id pub-id-type="doi">10.1038/nature22976</pub-id><?supplied-pmid 28636589?><pub-id pub-id-type="pmid">28636589</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Dash</surname><given-names>P</given-names></name>, <name><surname>Fiore-Gartland</surname><given-names>AJ</given-names></name>, <name><surname>Hertz</surname><given-names>T</given-names></name>, <name><surname>Wang</surname><given-names>GC</given-names></name>, <name><surname>Sharma</surname><given-names>S</given-names></name>, <name><surname>Souquette</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Quantifiable predictive features define epitope-specific T cell receptor repertoires</article-title>. <source>Nature</source>. <year>2017</year>;<volume>547</volume>(<issue>7661</issue>):<fpage>89</fpage>. <pub-id pub-id-type="doi">10.1038/nature22383</pub-id><?supplied-pmid 28636592?><pub-id pub-id-type="pmid">28636592</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Lefranc</surname><given-names>M</given-names></name>. <article-title>The IMGT unique numbering for immunoglobulins, T-cell receptors, and Ig-like domains</article-title>. <source>Immunologist</source>. <year>1999</year>;<volume>7</volume>(<issue>4</issue>):<fpage>132</fpage>–<lpage>136</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Freeman</surname><given-names>JD</given-names></name>, <name><surname>Warren</surname><given-names>RL</given-names></name>, <name><surname>Webb</surname><given-names>JR</given-names></name>, <name><surname>Nelson</surname><given-names>BH</given-names></name>, <name><surname>Holt</surname><given-names>RA</given-names></name>. <article-title>Profiling the T-cell receptor beta-chain repertoire by massively parallel sequencing</article-title>. <source>Genome research</source>. <year>2009</year>;<volume>19</volume>(<issue>10</issue>):<fpage>1817</fpage>–<lpage>1824</lpage>. <pub-id pub-id-type="doi">10.1101/gr.092924.109</pub-id><pub-id pub-id-type="pmid">19541912</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Dash</surname><given-names>P</given-names></name>, <name><surname>McClaren</surname><given-names>JL</given-names></name>, <name><surname>Oguin</surname><given-names>TH</given-names></name>, <name><surname>Rothwell</surname><given-names>W</given-names></name>, <name><surname>Todd</surname><given-names>B</given-names></name>, <name><surname>Morris</surname><given-names>MY</given-names></name>, <etal>et al</etal>. <article-title>Paired analysis of TCR<italic>α</italic> and TCR<italic>β</italic> chains at the single-cell level in mice</article-title>. <source>The Journal of clinical investigation</source>. <year>2011</year>;<volume>121</volume>(<issue>1</issue>):<fpage>288</fpage>–<lpage>295</lpage>. <pub-id pub-id-type="doi">10.1172/JCI44752</pub-id><?supplied-pmid 21135507?><pub-id pub-id-type="pmid">21135507</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Han</surname><given-names>A</given-names></name>, <name><surname>Glanville</surname><given-names>J</given-names></name>, <name><surname>Hansmann</surname><given-names>L</given-names></name>, <name><surname>Davis</surname><given-names>MM</given-names></name>. <article-title>Linking T-cell receptor sequence to functional phenotype at the single-cell level</article-title>. <source>Nature biotechnology</source>. <year>2014</year>;<volume>32</volume>(<issue>7</issue>):<fpage>684</fpage>–<lpage>692</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.2938</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Mösch</surname><given-names>A</given-names></name>, <name><surname>Raffegerst</surname><given-names>S</given-names></name>, <name><surname>Weis</surname><given-names>M</given-names></name>, <name><surname>Schendel</surname><given-names>DJ</given-names></name>, <name><surname>Frishman</surname><given-names>D</given-names></name>. <article-title>Machine learning for cancer immunotherapies based on epitope recognition by T cell receptors</article-title>. <source>Frontiers in Genetics</source>. <year>2019</year>;<volume>10</volume>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Shugay</surname><given-names>M</given-names></name>, <name><surname>Bagaev</surname><given-names>DV</given-names></name>, <name><surname>Zvyagin</surname><given-names>IV</given-names></name>, <name><surname>Vroomans</surname><given-names>RM</given-names></name>, <name><surname>Crawford</surname><given-names>JC</given-names></name>, <name><surname>Dolton</surname><given-names>G</given-names></name>, <etal>et al</etal>. <article-title>VDJdb: a curated database of T-cell receptor sequences with known antigen specificity</article-title>. <source>Nucleic acids research</source>. <year>2017</year>;<volume>46</volume>(<issue>D1</issue>):<fpage>D419</fpage>–<lpage>D427</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkx760</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Vita</surname><given-names>R</given-names></name>, <name><surname>Mahajan</surname><given-names>S</given-names></name>, <name><surname>Overton</surname><given-names>JA</given-names></name>, <name><surname>Dhanda</surname><given-names>SK</given-names></name>, <name><surname>Martini</surname><given-names>S</given-names></name>, <name><surname>Cantrell</surname><given-names>JR</given-names></name>, <etal>et al</etal>. <article-title>The immune epitope database (IEDB): 2018 update</article-title>. <source>Nucleic acids research</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D339</fpage>–<lpage>D343</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gky1006</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Tickotsky</surname><given-names>N</given-names></name>, <name><surname>Sagiv</surname><given-names>T</given-names></name>, <name><surname>Prilusky</surname><given-names>J</given-names></name>, <name><surname>Shifrut</surname><given-names>E</given-names></name>, <name><surname>Friedman</surname><given-names>N</given-names></name>. <article-title>McPAS-TCR: a manually curated catalogue of pathology-associated T cell receptor sequences</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>18</issue>):<fpage>2924</fpage>–<lpage>2929</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx286</pub-id><pub-id pub-id-type="pmid">28481982</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>De Neuter</surname><given-names>N</given-names></name>, <name><surname>Bittremieux</surname><given-names>W</given-names></name>, <name><surname>Beirnaert</surname><given-names>C</given-names></name>, <name><surname>Cuypers</surname><given-names>B</given-names></name>, <name><surname>Mrzic</surname><given-names>A</given-names></name>, <name><surname>Moris</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>On the feasibility of mining CD8+ T cell receptor patterns underlying immunogenic peptide recognition</article-title>. <source>Immunogenetics</source>. <year>2018</year>;<volume>70</volume>(<issue>3</issue>):<fpage>159</fpage>–<lpage>168</lpage>. <pub-id pub-id-type="doi">10.1007/s00251-017-1023-5</pub-id><?supplied-pmid 28779185?><pub-id pub-id-type="pmid">28779185</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Jurtz</surname><given-names>VI</given-names></name>, <name><surname>Jessen</surname><given-names>LE</given-names></name>, <name><surname>Bentzen</surname><given-names>AK</given-names></name>, <name><surname>Jespersen</surname><given-names>MC</given-names></name>, <name><surname>Mahajan</surname><given-names>S</given-names></name>, <name><surname>Vita</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>NetTCR: sequence-based prediction of TCR binding to peptide-MHC complexes using convolutional neural networks</article-title>. <source>bioRxiv</source>. <year>2018</year>; p. <fpage>433706</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Sidhom</surname><given-names>JW</given-names></name>, <name><surname>Larman</surname><given-names>HB</given-names></name>, <name><surname>Pardoll</surname><given-names>DM</given-names></name>, <name><surname>Baras</surname><given-names>AS</given-names></name>. <article-title>DeepTCR: a deep learning framework for revealing structural concepts within TCR Repertoire</article-title>. <source>bioRxiv</source>. <year>2018</year>; p. <fpage>464107</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Springer</surname><given-names>I</given-names></name>, <name><surname>Besser</surname><given-names>H</given-names></name>, <name><surname>Tickotsky-Moskovitz</surname><given-names>N</given-names></name>, <name><surname>Dvorkin</surname><given-names>S</given-names></name>, <name><surname>Louzoun</surname><given-names>Y</given-names></name>. <article-title>Prediction of specific TCR-peptide binding from large dictionaries of TCR-peptide pairs</article-title>. <source>bioRxiv</source>. <year>2019</year>; p. <fpage>650861</fpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>H</given-names></name>, <name><surname>Liu</surname><given-names>L</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Ye</surname><given-names>J</given-names></name>, <name><surname>Shukla</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Investigation of antigen-specific T-cell receptor clusters in human cancers</article-title>. <source>Clinical Cancer Research</source>. <year>2020</year>;<volume>26</volume>(<issue>6</issue>):<fpage>1359</fpage>–<lpage>1371</lpage>. <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-19-3249</pub-id><?supplied-pmid 31831563?><pub-id pub-id-type="pmid">31831563</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Thakkar</surname><given-names>N</given-names></name>, <name><surname>Bailey-Kellogg</surname><given-names>C</given-names></name>. <article-title>Balancing sensitivity and specificity in distinguishing TCR groups by CDR sequence similarity</article-title>. <source>BMC bioinformatics</source>. <year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>241</fpage>. <pub-id pub-id-type="doi">10.1186/s12859-019-2864-8</pub-id><pub-id pub-id-type="pmid">31092185</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Wong</surname><given-names>WK</given-names></name>, <name><surname>Marks</surname><given-names>C</given-names></name>, <name><surname>Leem</surname><given-names>J</given-names></name>, <name><surname>Lewis</surname><given-names>AP</given-names></name>, <name><surname>Shi</surname><given-names>J</given-names></name>, <name><surname>Deane</surname><given-names>CM</given-names></name>. <article-title>TCRBuilder: multi-state T-cell receptor structure prediction</article-title>. <source>Bioinformatics</source>. <year>2020</year>;<volume>36</volume>(<issue>11</issue>):<fpage>3580</fpage>–<lpage>3581</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa194</pub-id><pub-id pub-id-type="pmid">32181809</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Cheng</surname><given-names>L</given-names></name>, <name><surname>Ramchandran</surname><given-names>S</given-names></name>, <name><surname>Vatanen</surname><given-names>T</given-names></name>, <name><surname>Lietzén</surname><given-names>N</given-names></name>, <name><surname>Lahesmaa</surname><given-names>R</given-names></name>, <name><surname>Vehtari</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>An additive Gaussian process regression model for interpretable non-parametric analysis of longitudinal data</article-title>. <source>Nature communications</source>. <year>2019</year>;<volume>10</volume>(<issue>1</issue>):<fpage>1798</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-019-09785-8</pub-id><?supplied-pmid 30996266?><pub-id pub-id-type="pmid">30996266</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Jokinen</surname><given-names>E</given-names></name>, <name><surname>Heinonen</surname><given-names>M</given-names></name>, <name><surname>Lähdesmäki</surname><given-names>H</given-names></name>. <article-title>mGPfusion: predicting protein stability changes with Gaussian process kernel learning and data fusion</article-title>. <source>Bioinformatics</source>. <year>2018</year>;<volume>34</volume>(<issue>13</issue>):<fpage>i274</fpage>–<lpage>i283</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty238</pub-id><pub-id pub-id-type="pmid">29949987</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Romero</surname><given-names>PA</given-names></name>, <name><surname>Krause</surname><given-names>A</given-names></name>, <name><surname>Arnold</surname><given-names>FH</given-names></name>. <article-title>Navigating the protein fitness landscape with Gaussian processes</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>3</issue>):<fpage>E193</fpage>–<lpage>E201</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1215251110</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Clifton</surname><given-names>L</given-names></name>, <name><surname>Clifton</surname><given-names>DA</given-names></name>, <name><surname>Pimentel</surname><given-names>MA</given-names></name>, <name><surname>Watkinson</surname><given-names>PJ</given-names></name>, <name><surname>Tarassenko</surname><given-names>L</given-names></name>. <article-title>Gaussian processes for personalized e-health monitoring with wearable sensors</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>2012</year>;<volume>60</volume>(<issue>1</issue>):<fpage>193</fpage>–<lpage>197</lpage>. <pub-id pub-id-type="doi">10.1109/TBME.2012.2208459</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Chu</surname><given-names>W</given-names></name>, <name><surname>Ghahramani</surname><given-names>Z</given-names></name>, <name><surname>Falciani</surname><given-names>F</given-names></name>, <name><surname>Wild</surname><given-names>DL</given-names></name>. <article-title>Biomarker discovery in microarray gene expression data with Gaussian processes</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>16</issue>):<fpage>3385</fpage>–<lpage>3393</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bti526</pub-id><pub-id pub-id-type="pmid">15937031</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Opper</surname><given-names>M</given-names></name>, <name><surname>Archambeau</surname><given-names>C</given-names></name>. <article-title>The variational Gaussian approximation revisited</article-title>. <source>Neural computation</source>. <year>2009</year>;<volume>21</volume>(<issue>3</issue>):<fpage>786</fpage>–<lpage>792</lpage>. <pub-id pub-id-type="doi">10.1162/neco.2008.08-07-592</pub-id><pub-id pub-id-type="pmid">18785854</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref032">
      <label>32</label>
      <mixed-citation publication-type="other">Hensman J, Matthews AGdG, Ghahramani Z. Scalable variational Gaussian process classification. In: Artificial Intelligence and Statistics; 2015.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Gielis</surname><given-names>S</given-names></name>, <name><surname>Moris</surname><given-names>P</given-names></name>, <name><surname>Bittremieux</surname><given-names>W</given-names></name>, <name><surname>De Neuter</surname><given-names>N</given-names></name>, <name><surname>Ogunjimi</surname><given-names>B</given-names></name>, <name><surname>Laukens</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Detection of Enriched T Cell Epitope Specificity in Full T Cell Receptor Sequence Repertoires</article-title>. <source>Frontiers in immunology</source>. <year>2019</year>;<volume>10</volume>:<fpage>2820</fpage>. <pub-id pub-id-type="doi">10.3389/fimmu.2019.02820</pub-id><?supplied-pmid 31849987?><pub-id pub-id-type="pmid">31849987</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Shomuradova</surname><given-names>AS</given-names></name>, <name><surname>Vagida</surname><given-names>MS</given-names></name>, <name><surname>Sheetikov</surname><given-names>SA</given-names></name>, <name><surname>Zornikova</surname><given-names>KV</given-names></name>, <name><surname>Kiryukhin</surname><given-names>D</given-names></name>, <name><surname>Titov</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>SARS-CoV-2 epitopes are recognized by a public and diverse repertoire of human T-cell receptors</article-title>. <source>medRxiv</source>. <year>2020</year>. <pub-id pub-id-type="doi">10.1016/j.immuni.2020.11.004</pub-id><?supplied-pmid 33326767?><pub-id pub-id-type="pmid">33326767</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Bosetti</surname><given-names>C</given-names></name>, <name><surname>Turati</surname><given-names>F</given-names></name>, <name><surname>La Vecchia</surname><given-names>C</given-names></name>. <article-title>Hepatocellular carcinoma epidemiology</article-title>. <source>Best Pract Res Clin Gastroenterol</source>. <year>2014</year>;<volume>28</volume>(<issue>5</issue>):<fpage>753</fpage>–<lpage>770</lpage>. <pub-id pub-id-type="doi">10.1016/j.bpg.2014.08.007</pub-id><pub-id pub-id-type="pmid">25260306</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Hassan</surname><given-names>MM</given-names></name>, <name><surname>Hwang</surname><given-names>LY</given-names></name>, <name><surname>Hatten</surname><given-names>CJ</given-names></name>, <name><surname>Swaim</surname><given-names>M</given-names></name>, <name><surname>Li</surname><given-names>D</given-names></name>, <name><surname>Abbruzzese</surname><given-names>JL</given-names></name>, <etal>et al</etal>. <article-title>Risk factors for hepatocellular carcinoma: synergism of alcohol with viral hepatitis and diabetes mellitus</article-title>. <source>Hepatology</source>. <year>2002</year>;<volume>36</volume>(<issue>5</issue>):<fpage>1206</fpage>–<lpage>1213</lpage>. <pub-id pub-id-type="doi">10.1053/jhep.2002.36780</pub-id><?supplied-pmid 12395331?><pub-id pub-id-type="pmid">12395331</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Wu</surname><given-names>MC</given-names></name>, <name><surname>Sham</surname><given-names>JST</given-names></name>, <name><surname>Tai</surname><given-names>LS</given-names></name>, <name><surname>Fang</surname><given-names>Y</given-names></name>, <name><surname>Wu</surname><given-names>WQ</given-names></name>, <etal>et al</etal>. <article-title>Different expression of hepatitis B surface antigen between hepatocellular carcinoma and its surrounding liver tissue, studied using a tissue microarray</article-title>. <source>J Pathol</source>. <year>2002</year>;<volume>197</volume>(<issue>5</issue>):<fpage>610</fpage>–<lpage>616</lpage>. <pub-id pub-id-type="doi">10.1002/path.1150</pub-id><?supplied-pmid 12210080?><pub-id pub-id-type="pmid">12210080</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>C</given-names></name>, <name><surname>Zheng</surname><given-names>L</given-names></name>, <name><surname>Yoo</surname><given-names>JK</given-names></name>, <name><surname>Guo</surname><given-names>H</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Guo</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Landscape of infiltrating T cells in liver cancer revealed by single-cell sequencing</article-title>. <source>Cell</source>. <year>2017</year>;<volume>169</volume>(<issue>7</issue>):<fpage>1342</fpage>–<lpage>1356</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2017.05.035</pub-id><?supplied-pmid 28622514?><pub-id pub-id-type="pmid">28622514</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Cheng</surname><given-names>Y</given-names></name>, <name><surname>Zhu</surname><given-names>YO</given-names></name>, <name><surname>Becht</surname><given-names>E</given-names></name>, <name><surname>Aw</surname><given-names>P</given-names></name>, <name><surname>Chen</surname><given-names>J</given-names></name>, <name><surname>Poidinger</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Multifactorial heterogeneity of virus-specific T cells and association with the progression of human chronic hepatitis B infection</article-title>. <source>Science immunology</source>. <year>2019</year>;<volume>4</volume>(<issue>32</issue>):<fpage>eaau6905</fpage>. <pub-id pub-id-type="doi">10.1126/sciimmunol.aau6905</pub-id><?supplied-pmid 30737354?><pub-id pub-id-type="pmid">30737354</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Bentzen</surname><given-names>AK</given-names></name>, <name><surname>Such</surname><given-names>L</given-names></name>, <name><surname>Jensen</surname><given-names>KK</given-names></name>, <name><surname>Marquard</surname><given-names>AM</given-names></name>, <name><surname>Jessen</surname><given-names>LE</given-names></name>, <name><surname>Miller</surname><given-names>NJ</given-names></name>, <etal>et al</etal>. <article-title>T cell receptor fingerprinting enables in-depth characterization of the interactions governing recognition of peptide–MHC complexes</article-title>. <source>Nature biotechnology</source>. <year>2018</year>;<volume>36</volume>(<issue>12</issue>):<fpage>1191</fpage>. <pub-id pub-id-type="doi">10.1038/nbt.4303</pub-id><?supplied-pmid 30451992?><pub-id pub-id-type="pmid">30451992</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>SQ</given-names></name>, <name><surname>Ma</surname><given-names>KY</given-names></name>, <name><surname>Schonnesen</surname><given-names>AA</given-names></name>, <name><surname>Zhang</surname><given-names>M</given-names></name>, <name><surname>He</surname><given-names>C</given-names></name>, <name><surname>Sun</surname><given-names>E</given-names></name>, <etal>et al</etal>. <article-title>High-throughput determination of the antigen specificities of T cell receptors in single cells</article-title>. <source>Nature biotechnology</source>. <year>2018</year>;<volume>36</volume>(<issue>12</issue>):<fpage>1156</fpage>. <pub-id pub-id-type="doi">10.1038/nbt.4282</pub-id><?supplied-pmid 30418433?><pub-id pub-id-type="pmid">30418433</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref042">
      <label>42</label>
      <mixed-citation publication-type="other">Salimbeni H, Deisenroth M. Doubly stochastic variational inference for deep Gaussian processes. In: Advances in Neural Information Processing Systems; 2017. p. 4588–4599.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>van der Leun</surname><given-names>AM</given-names></name>, <name><surname>Yofe</surname><given-names>I</given-names></name>, <name><surname>Lubling</surname><given-names>Y</given-names></name>, <name><surname>Gelbard-Solodkin</surname><given-names>D</given-names></name>, <name><surname>van Akkooi</surname><given-names>AC</given-names></name>, <etal>et al</etal>. <article-title>Dysfunctional CD8 T cells form a proliferative, dynamically regulated compartment within human melanoma</article-title>. <source>Cell</source>. <year>2019</year>;<volume>176</volume>(<issue>4</issue>):<fpage>775</fpage>–<lpage>789</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2018.11.043</pub-id><?supplied-pmid 30595452?><pub-id pub-id-type="pmid">30595452</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Azizi</surname><given-names>E</given-names></name>, <name><surname>Carr</surname><given-names>AJ</given-names></name>, <name><surname>Plitas</surname><given-names>G</given-names></name>, <name><surname>Cornish</surname><given-names>AE</given-names></name>, <name><surname>Konopacki</surname><given-names>C</given-names></name>, <name><surname>Prabhakaran</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Single-cell map of diverse immune phenotypes in the breast tumor microenvironment</article-title>. <source>Cell</source>. <year>2018</year>;<volume>174</volume>(<issue>5</issue>):<fpage>1293</fpage>–<lpage>1308</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2018.05.060</pub-id><?supplied-pmid 29961579?><pub-id pub-id-type="pmid">29961579</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>X</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Zheng</surname><given-names>L</given-names></name>, <name><surname>Zheng</surname><given-names>C</given-names></name>, <name><surname>Song</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>Q</given-names></name>, <etal>et al</etal>. <article-title>Global characterization of T cells in non-small-cell lung cancer by single-cell sequencing</article-title>. <source>Nature Medicine</source>. <year>2018</year>;<volume>24</volume>(<issue>7</issue>):<fpage>978</fpage>. <pub-id pub-id-type="doi">10.1038/s41591-018-0045-3</pub-id><?supplied-pmid 29942094?><pub-id pub-id-type="pmid">29942094</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Yu</surname><given-names>X</given-names></name>, <name><surname>Zheng</surname><given-names>L</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Fang</surname><given-names>Q</given-names></name>, <etal>et al</etal>. <article-title>Lineage tracking reveals dynamic relationships of T cells in colorectal cancer</article-title>. <source>Nature</source>. <year>2018</year>;<volume>564</volume>(<issue>7735</issue>):<fpage>268</fpage>. <pub-id pub-id-type="doi">10.1038/s41586-018-0694-x</pub-id><?supplied-pmid 30479382?><pub-id pub-id-type="pmid">30479382</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Sade-Feldman</surname><given-names>M</given-names></name>, <name><surname>Yizhak</surname><given-names>K</given-names></name>, <name><surname>Bjorgaard</surname><given-names>SL</given-names></name>, <name><surname>Ray</surname><given-names>JP</given-names></name>, <name><surname>de Boer</surname><given-names>CG</given-names></name>, <name><surname>Jenkins</surname><given-names>RW</given-names></name>, <etal>et al</etal>. <article-title>Defining T cell states associated with response to checkpoint immunotherapy in melanoma</article-title>. <source>Cell</source>. <year>2018</year>;<volume>175</volume>(<issue>4</issue>):<fpage>998</fpage>–<lpage>1013</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2018.10.038</pub-id><?supplied-pmid 30388456?><pub-id pub-id-type="pmid">30388456</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Emerson</surname><given-names>RO</given-names></name>, <name><surname>DeWitt</surname><given-names>WS</given-names></name>, <name><surname>Vignali</surname><given-names>M</given-names></name>, <name><surname>Gravley</surname><given-names>J</given-names></name>, <name><surname>Hu</surname><given-names>JK</given-names></name>, <name><surname>Osborne</surname><given-names>EJ</given-names></name>, <etal>et al</etal>. <article-title>Immunosequencing identifies signatures of cytomegalovirus exposure history and HLA-mediated effects on the T cell repertoire</article-title>. <source>Nature genetics</source>. <year>2017</year>;<volume>49</volume>(<issue>5</issue>):<fpage>659</fpage>. <pub-id pub-id-type="doi">10.1038/ng.3822</pub-id><?supplied-pmid 28369038?><pub-id pub-id-type="pmid">28369038</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Savola</surname><given-names>P</given-names></name>, <name><surname>Kelkka</surname><given-names>T</given-names></name>, <name><surname>Rajala</surname><given-names>H</given-names></name>, <name><surname>Kuuliala</surname><given-names>A</given-names></name>, <name><surname>Kuuliala</surname><given-names>K</given-names></name>, <name><surname>Eldfors</surname><given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Somatic mutations in clonally expanded cytotoxic T lymphocytes in patients with newly diagnosed rheumatoid arthritis</article-title>. <source>Nature Communications</source>. <year>2017</year>;<volume>8</volume>:<fpage>15869</fpage>. <pub-id pub-id-type="doi">10.1038/ncomms15869</pub-id><?supplied-pmid 28635960?><pub-id pub-id-type="pmid">28635960</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref050">
      <label>50</label>
      <mixed-citation publication-type="journal"><name><surname>Tumeh</surname><given-names>PC</given-names></name>, <name><surname>Harview</surname><given-names>CL</given-names></name>, <name><surname>Yearley</surname><given-names>JH</given-names></name>, <name><surname>Shintaku</surname><given-names>IP</given-names></name>, <name><surname>Taylor</surname><given-names>EJ</given-names></name>, <name><surname>Robert</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>PD-1 blockade induces responses by inhibiting adaptive immune resistance</article-title>. <source>Nature</source>. <year>2014</year>;<volume>515</volume>(<issue>7528</issue>):<fpage>568</fpage>. <pub-id pub-id-type="doi">10.1038/nature13954</pub-id><?supplied-pmid 25428505?><pub-id pub-id-type="pmid">25428505</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Allison</surname><given-names>TJ</given-names></name>, <name><surname>Winter</surname><given-names>CC</given-names></name>, <name><surname>Fournié</surname><given-names>JJ</given-names></name>, <name><surname>Bonneville</surname><given-names>M</given-names></name>, <name><surname>Garboczi</surname><given-names>DN</given-names></name>. <article-title>Structure of a human <italic>γδ</italic> T-cell antigen receptor</article-title>. <source>Nature</source>. <year>2001</year>;<volume>411</volume>(<issue>6839</issue>):<fpage>820</fpage>. <pub-id pub-id-type="doi">10.1038/35081115</pub-id><pub-id pub-id-type="pmid">11459064</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Howie</surname><given-names>B</given-names></name>, <name><surname>Sherwood</surname><given-names>AM</given-names></name>, <name><surname>Berkebile</surname><given-names>AD</given-names></name>, <name><surname>Berka</surname><given-names>J</given-names></name>, <name><surname>Emerson</surname><given-names>RO</given-names></name>, <name><surname>Williamson</surname><given-names>DW</given-names></name>, <etal>et al</etal>. <article-title>High-throughput pairing of T cell receptor <italic>α</italic> and <italic>β</italic> sequences</article-title>. <source>Science translational medicine</source>. <year>2015</year>;<volume>7</volume>(<issue>301</issue>):<fpage>301ra131</fpage>–<lpage>301ra131</lpage>. <pub-id pub-id-type="doi">10.1126/scitranslmed.aac5624</pub-id><?supplied-pmid 26290413?><pub-id pub-id-type="pmid">26290413</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Genolet</surname><given-names>R</given-names></name>, <name><surname>Stevenson</surname><given-names>BJ</given-names></name>, <name><surname>Farinelli</surname><given-names>L</given-names></name>, <name><surname>Østerås</surname><given-names>M</given-names></name>, <name><surname>Luescher</surname><given-names>IF</given-names></name>. <article-title>Highly diverse TCR<italic>α</italic> chain repertoire of pre-immune CD8+ T cells reveals new insights in gene recombination</article-title>. <source>The EMBO journal</source>. <year>2012</year>;<volume>31</volume>(<issue>7</issue>):<fpage>1666</fpage>–<lpage>1678</lpage>. <pub-id pub-id-type="doi">10.1038/emboj.2012.48</pub-id><pub-id pub-id-type="pmid">22373576</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref054">
      <label>54</label>
      <mixed-citation publication-type="journal"><name><surname>Ruggiero</surname><given-names>E</given-names></name>, <name><surname>Nicolay</surname><given-names>JP</given-names></name>, <name><surname>Fronza</surname><given-names>R</given-names></name>, <name><surname>Arens</surname><given-names>A</given-names></name>, <name><surname>Paruzynski</surname><given-names>A</given-names></name>, <name><surname>Nowrouzi</surname><given-names>A</given-names></name>, <etal>et al</etal>. <article-title>High-resolution analysis of the human T-cell receptor repertoire</article-title>. <source>Nature communications</source>. <year>2015</year>;<volume>6</volume>:<fpage>8081</fpage>. <pub-id pub-id-type="doi">10.1038/ncomms9081</pub-id><?supplied-pmid 26324409?><pub-id pub-id-type="pmid">26324409</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Ndifon</surname><given-names>W</given-names></name>, <name><surname>Gal</surname><given-names>H</given-names></name>, <name><surname>Shifrut</surname><given-names>E</given-names></name>, <name><surname>Aharoni</surname><given-names>R</given-names></name>, <name><surname>Yissachar</surname><given-names>N</given-names></name>, <name><surname>Waysbort</surname><given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Chromatin conformation governs T-cell receptor J<italic>β</italic> gene segment usage</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>39</issue>):<fpage>15865</fpage>–<lpage>15870</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1203916109</pub-id><?supplied-pmid 22984176?><pub-id pub-id-type="pmid">22984176</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Giguere</surname><given-names>S</given-names></name>, <name><surname>Marchand</surname><given-names>M</given-names></name>, <name><surname>Laviolette</surname><given-names>F</given-names></name>, <name><surname>Drouin</surname><given-names>A</given-names></name>, <name><surname>Corbeil</surname><given-names>J</given-names></name>. <article-title>Learning a peptide-protein binding affinity predictor with kernel ridge regression</article-title>. <source>BMC bioinformatics</source>. <year>2013</year>;<volume>14</volume>(<issue>1</issue>):<fpage>82</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-14-82</pub-id><pub-id pub-id-type="pmid">23497081</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Henikoff</surname><given-names>S</given-names></name>, <name><surname>Henikoff</surname><given-names>JG</given-names></name>. <article-title>Amino acid substitution matrices from protein blocks</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1992</year>;<volume>89</volume>(<issue>22</issue>):<fpage>10915</fpage>–<lpage>10919</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.89.22.10915</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref058">
      <label>58</label>
      <mixed-citation publication-type="book"><name><surname>Rasmussen</surname><given-names>CE</given-names></name>, <name><surname>Williams</surname><given-names>CKI</given-names></name>. <source>Gaussian processes for machine learning</source>. <publisher-loc>Cambridge, Massachusetts</publisher-loc>: <publisher-name>The MIT Press</publisher-name>; <year>2006</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref059">
      <label>59</label>
      <mixed-citation publication-type="other">Snelson E, Ghahramani Z. Sparse Gaussian processes using pseudo-inputs. In: Advances in neural information processing systems; 2006. p. 1257–1264.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref060">
      <label>60</label>
      <mixed-citation publication-type="journal"><name><surname>Blei</surname><given-names>DM</given-names></name>, <name><surname>Kucukelbir</surname><given-names>A</given-names></name>, <name><surname>McAuliffe</surname><given-names>JD</given-names></name>. <article-title>Variational inference: A review for statisticians</article-title>. <source>Journal of the American Statistical Association</source>. <year>2017</year>;<volume>112</volume>(<issue>518</issue>):<fpage>859</fpage>–<lpage>877</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.2017.1285773</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref061">
      <label>61</label>
      <mixed-citation publication-type="other">Hegde P, Heinonen M, Kaski S. Variational zero-inflated Gaussian processes with sparse kernels. In: Uncertainty in Artificial Intelligence; 2018.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref062">
      <label>62</label>
      <mixed-citation publication-type="journal"><name><surname>Nickisch</surname><given-names>H</given-names></name>, <name><surname>Rasmussen</surname><given-names>C</given-names></name>. <article-title>Approximations for binary Gaussian process classification</article-title>. <source>Journal of Machine Learning Research</source>. <year>2008</year>;<volume>9</volume>:<fpage>2035</fpage>–<lpage>2078</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref063">
      <label>63</label>
      <mixed-citation publication-type="journal"><name><surname>Matthews</surname><given-names>AGdG</given-names></name>, <name><surname>van der Wilk</surname><given-names>M</given-names></name>, <name><surname>Nickson</surname><given-names>T</given-names></name>, <name><surname>Fujii</surname><given-names>K</given-names></name>, <name><surname>Boukouvalas</surname><given-names>A</given-names></name>, <name><surname>Le‘on-Villagr‘a</surname><given-names>P</given-names></name>, <etal>et al</etal>. <article-title>GPflow: A Gaussian process library using TensorFlow</article-title>. <source>Journal of Machine Learning Research</source>. <year>2017</year>;<volume>18</volume>(<issue>40</issue>):<fpage>1</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref064">
      <label>64</label>
      <mixed-citation publication-type="other">Abadi M, Agarwal A, Barham P, Brevdo E, Chen Z, Citro C, et al. TensorFlow: Large-Scale Machine Learning on Heterogeneous Systems; 2015. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.tensorflow.org/">https://www.tensorflow.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1008814.ref065">
      <label>65</label>
      <mixed-citation publication-type="journal"><name><surname>Butler</surname><given-names>A</given-names></name>, <name><surname>Hoffman</surname><given-names>P</given-names></name>, <name><surname>Smibert</surname><given-names>P</given-names></name>, <name><surname>Papalexi</surname><given-names>E</given-names></name>, <name><surname>Satija</surname><given-names>R</given-names></name>. <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nature biotechnology</source>. <year>2018</year>;<volume>36</volume>(<issue>5</issue>):<fpage>411</fpage>. <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
