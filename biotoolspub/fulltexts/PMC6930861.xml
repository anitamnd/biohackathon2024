<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with OASIS Tables with MathML3 v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archive-oasis-article1-mathml3.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jpoasis-nisons2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">CPT Pharmacometrics Syst Pharmacol</journal-id>
    <journal-id journal-id-type="iso-abbrev">CPT Pharmacometrics Syst Pharmacol</journal-id>
    <journal-id journal-id-type="doi">10.1002/(ISSN)2163-8306</journal-id>
    <journal-id journal-id-type="publisher-id">PSP4</journal-id>
    <journal-title-group>
      <journal-title>CPT: Pharmacometrics &amp; Systems Pharmacology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2163-8306</issn>
    <publisher>
      <publisher-name>John Wiley and Sons Inc.</publisher-name>
      <publisher-loc>Hoboken</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6930861</article-id>
    <article-id pub-id-type="doi">10.1002/psp4.12467</article-id>
    <article-id pub-id-type="publisher-id">PSP412467</article-id>
    <article-categories>
      <subj-group subj-group-type="overline">
        <subject>Tutorial</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Tutorial</subject>
        <subj-group subj-group-type="heading">
          <subject>Tutorial</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><styled-content style="fixed-case" toggle="no">Quantitative Systems Pharmacology</styled-content> and <styled-content style="fixed-case" toggle="no">Physiologically‐Based Pharmacokinetic</styled-content> Modeling With mrgsolve: A Hands‐On Tutorial</article-title>
      <alt-title alt-title-type="right-running-head"><styled-content style="fixed-case" toggle="no">QSP</styled-content> and <styled-content style="fixed-case" toggle="no">PBPK</styled-content> Modeling in R</alt-title>
      <alt-title alt-title-type="left-running-head">Elmokadem <italic>et al</italic>.</alt-title>
    </title-group>
    <contrib-group>
      <contrib id="psp412467-cr-0001" contrib-type="author">
        <name>
          <surname>Elmokadem</surname>
          <given-names>Ahmed</given-names>
        </name>
        <xref ref-type="aff" rid="psp412467-aff-0001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib id="psp412467-cr-0002" contrib-type="author">
        <name>
          <surname>Riggs</surname>
          <given-names>Matthew M.</given-names>
        </name>
        <xref ref-type="aff" rid="psp412467-aff-0001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib id="psp412467-cr-0003" contrib-type="author" corresp="yes">
        <name>
          <surname>Baron</surname>
          <given-names>Kyle T.</given-names>
        </name>
        <xref ref-type="aff" rid="psp412467-aff-0001">
          <sup>1</sup>
        </xref>
        <address>
          <email>kyleb@metrumrg.com</email>
        </address>
      </contrib>
    </contrib-group>
    <aff id="psp412467-aff-0001">
      <label>
        <sup>1</sup>
      </label>
      <institution>Metrum Research Group</institution>
      <city>Tariffville</city>
      <named-content content-type="country-part">Connecticut</named-content>
      <country country="US">USA</country>
    </aff>
    <author-notes>
      <corresp id="correspondenceTo"><label>*</label>Correspondence: Kyle T. Baron (<email>kyleb@metrumrg.com</email>)</corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <volume>8</volume>
    <issue>12</issue>
    <issue-id pub-id-type="doi">10.1002/psp4.v8.12</issue-id>
    <fpage>883</fpage>
    <lpage>893</lpage>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <!--<copyright-statement content-type="issue-copyright"> &#x000a9; 2019 ASCPT <copyright-statement>-->
      <copyright-statement content-type="article-copyright">© 2019 Metrum Research Group. <italic>CPT: Pharmacometrics &amp; Systems Pharmacology</italic> published by Wiley Periodicals, Inc. on behalf of the American Society for Clinical Pharmacology and Therapeutics.</copyright-statement>
      <license license-type="creativeCommonsBy-nc">
        <license-p>This is an open access article under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link> License, which permits use, distribution and reproduction in any medium, provided the original work is properly cited and is not used for commercial purposes.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="file:PSP4-8-883.pdf"/>
    <abstract id="psp412467-abs-0001">
      <p>mrgsolve is an open‐source R package available on the Comprehensive R Archive Network. It combines R and C++ coding for simulation from hierarchical, ordinary differential equation–based models. Its efficient simulation engine and integration into a parallelizable, R‐based workflow makes mrgsolve a convenient tool both for simple and complex models and thus is ideal for physiologically‐based pharmacokinetic (<styled-content style="fixed-case" toggle="no">PBPK</styled-content>) and quantitative systems pharmacology (<styled-content style="fixed-case" toggle="no">QSP</styled-content>) model. This tutorial will first introduce the basics of the mrgsolve simulation workflow, including model specification, the introduction of interventions (dosing events) into the simulation, and simulated results postprocessing. An applied simulation example is then presented using a <styled-content style="fixed-case" toggle="no">PBPK</styled-content> model for voriconazole, including a model validation step against adult and pediatric data sets. A final simulation example is then presented using a previously published <styled-content style="fixed-case" toggle="no">QSP</styled-content> model for mitogen‐activated protein kinase signaling in colorectal cancer, illustrating population simulation of different combination therapies.</p>
    </abstract>
    <counts>
      <fig-count count="5"/>
      <table-count count="1"/>
      <page-count count="11"/>
      <word-count count="5773"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>source-schema-version-number</meta-name>
        <meta-value>2.0</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>December 2019</meta-value>
      </custom-meta>
      <custom-meta>
        <meta-name>details-of-publishers-convertor</meta-name>
        <meta-value>Converter:WILEY_ML3GV2_TO_JATSPMC version:5.7.3 mode:remove_FC converted:25.12.2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body id="psp412467-body-0001">
  <sec id="psp412467-sec-0001">
    <title>mrgsolve Structure</title>
    <p>mrgsolve is distributed as an R package that is freely available on the Comprehensive R Archive Network (CRAN; <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/mrgsolve/index.html">https://cran.r-project.org/web/packages/mrgsolve/index.html</ext-link>). The mrgsolve package uses Livermore Solver for Ordinary Differential Equations, an ordinary differential equation (ODE) solver from the ODEPACK<xref rid="psp412467-bib-0001" ref-type="ref">1</xref> library, which is interfaced with R through the Rcpp<xref rid="psp412467-bib-0002" ref-type="ref">2</xref> package. C++ classes were developed to abstract solver setup, data sets and records, and pharmacokinetic (PK) dosing events. S4 classes and methods were created to represent the model in R as an updatable object. The modeler creates a model specification file consisting of R and C++ code that is parsed, compiled, and dynamically loaded into the R session. Input data are passed in, and simulated data are returned as R objects, so disk access is never required during the simulation cycle after compiling. The resulting computational efficiency facilitates model exploration and application both during model development and decision‐making phases of a drug development program. mrgsolve features include the following:</p>
    <p>
      <list list-type="bullet" id="psp412467-list-0001">
        <list-item>
          <p>NM‐TRAN‐like input data sets<xref rid="psp412467-bib-0003" ref-type="ref">3</xref>
</p>
        </list-item>
        <list-item>
          <p>Bolus, infusion, compartment on/off, and reset functionality</p>
        </list-item>
        <list-item>
          <p>Bioavailability, absorption lag, steady‐state, interdose interval, additional doses, model event times</p>
        </list-item>
        <list-item>
          <p>Multivariate normal random effects simulated using RcppArmadillo<xref rid="psp412467-bib-0004" ref-type="ref">4</xref>
</p>
        </list-item>
        <list-item>
          <p>Compatible with parameter estimation and design packages in R (nlme,<xref rid="psp412467-bib-0005" ref-type="ref">5</xref> saemix,<xref rid="psp412467-bib-0006" ref-type="ref">6</xref> PopED,<xref rid="psp412467-bib-0007" ref-type="ref">7</xref> PFIM<xref rid="psp412467-bib-0008" ref-type="ref">8</xref>)</p>
        </list-item>
        <list-item>
          <p>Integration with data summary (dplyr<xref rid="psp412467-bib-0009" ref-type="ref">9</xref>) and plotting (ggplot,<xref rid="psp412467-bib-0009" ref-type="ref">9</xref> lattice<xref rid="psp412467-bib-0010" ref-type="ref">10</xref>) packages</p>
        </list-item>
        <list-item>
          <p>Parallelization with existing R infrastructure (mclapply<xref rid="psp412467-bib-0011" ref-type="ref">11</xref>) or Sun Grid Engine (qapply<xref rid="psp412467-bib-0012" ref-type="ref">12</xref>)</p>
        </list-item>
        <list-item>
          <p>Compatible with output from many different model estimation platforms</p>
        </list-item>
        <list-item>
          <p>Easily integrated with Shiny<xref rid="psp412467-bib-0013" ref-type="ref">13</xref> to create interactive model‐visualization applications</p>
        </list-item>
      </list>
    </p>
    <p>In addition to its release on CRAN, active development of mrgsolve is documented on GitHub <ext-link ext-link-type="uri" xlink:href="https://github.com/metrumresearchgroup/mrgsolve">https://github.com/metrumresearchgroup/mrgsolve</ext-link>, with input and contributions encouraged and welcomed from the pharmacometrics modeling and simulation community.</p>
  </sec>
  <sec id="psp412467-sec-0002">
    <title>Modeling and Simulation Workflow</title>
    <p>The general modeling and simulation workflow includes an integration of mrgsolve with other packages available in R to script, in a traceable and reproducible manner, customized data handling, model development and simulation, summarization, and visualization (<bold>Figure</bold> <xref rid="psp412467-fig-0001" ref-type="fig"><bold>1</bold></xref>). The model code and script to fully implement and reproduce a simple example is available in the associated GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/metrumresearchgroup/cptpsp-tutorial-2019">https://github.com/metrumresearchgroup/cptpsp-tutorial-2019</ext-link>. The two main pieces of the mrgsolve component of this workflow, model specification and simulation, are discussed in more detail in the next sections.</p>
    <fig fig-type="Figure" xml:lang="en" id="psp412467-fig-0001" orientation="portrait" position="float">
      <label>Figure 1</label>
      <caption>
        <p>mrgsolve modeling and simulation workflow.</p>
      </caption>
      <graphic id="nlm-graphic-1" xlink:href="PSP4-8-883-g001"/>
    </fig>
    <sec id="psp412467-sec-0003">
      <title>Model specification</title>
      <p>The mrgsolve model specification file contains a description of the model components in different blocks. It takes a mixture of C++ and R syntax. The primary components include blocks for: model parameters (<monospace>[PARAM]</monospace>), state variables (<monospace>[INIT]</monospace>, <monospace>[CMT]</monospace>), the ODEs (<monospace>[ODE]</monospace>), and outputs (<monospace>[TABLE]</monospace>, <monospace>[CAPTURE]</monospace>). Each of these blocks is described in more detail and summarized (<bold>Table</bold> <xref rid="psp412467-tbl-0001" ref-type="table"><bold>1</bold></xref>) in the next sections.</p>
      <table-wrap id="psp412467-tbl-0001" xml:lang="en" orientation="portrait" position="float">
        <label>Table 1</label>
        <caption>
          <p>mrgsolve code blocks description</p>
        </caption>
        <table frame="hsides" rules="groups">
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <col style="border-right:solid 1px #000000" span="1"/>
          <thead valign="top">
            <tr style="border-bottom:solid 1px #000000">
              <th align="left" valign="top" rowspan="1" colspan="1">Code block</th>
              <th align="center" valign="top" rowspan="1" colspan="1">Syntax</th>
              <th align="center" valign="top" rowspan="1" colspan="1">Comments</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>[PROB]</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">Text</td>
              <td align="left" rowspan="1" colspan="1">Used to make notes about the model with no restrictions on the text entered.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>[PARAM]</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">R</td>
              <td align="left" rowspan="1" colspan="1">Used to define the parameter list in the model.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>[CMT]</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">Text</td>
              <td align="left" rowspan="1" colspan="1">Used to declare the names of all compartments in the model. Initial values are assumed to be 0.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>[INIT]</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">Text</td>
              <td align="left" rowspan="1" colspan="1">Used to declare the names and initial values of all compartments in the model.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>[ODE]</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">C++</td>
              <td align="left" rowspan="1" colspan="1">Used to define model differential equations.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>[TABLE]</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">C++</td>
              <td align="left" rowspan="1" colspan="1">Used to interact with parameter, compartment values, and other user‐defined variables after the system advances to the next time.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>[MAIN]</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">C++</td>
              <td align="left" rowspan="1" colspan="1">
                <p>This code block has two main purposes:
<list list-type="bullet" id="psp412467-list-0002"><list-item><p>Derive new algebraic relationships between parameters, random, effects and other derived variables</p></list-item><list-item><p>Set the initial conditions for model compartments</p></list-item></list>
</p>
                <p>For users who are familiar with NONMEM, <monospace>[MAIN]</monospace> is similar to <monospace>$PK</monospace>.</p>
                <p>The <monospace>MAIN</monospace> function gets called just prior to advancing the system from the current time to the next time for each record in the data set. <monospace>[MAIN]</monospace> also gets called several times before starting the problem and just prior to simulating each individual in the population. Finally, it gets called every time the model initial conditions are queried with <monospace>init()</monospace>.</p>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>[GLOBAL]</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">C++</td>
              <td align="left" rowspan="1" colspan="1">
                <p>This block is for writing C++ code that is outside of <monospace>[MAIN]</monospace>, <monospace>[ODE]</monospace> and <monospace>[TABLE]</monospace>. There is no artificial limit on what sort of C++ code can go in <monospace>[GLOBAL];</monospace> however, there are two more common uses:
<list list-type="bullet" id="psp412467-list-0003"><list-item><p>Write <monospace>#define</monospace> preprocessor statements</p></list-item><list-item><p>Define global variables, usually variables other than <monospace>double</monospace>, <monospace>bool</monospace> or <monospace>int</monospace>
</p></list-item></list>
</p>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>[PREAMBLE]</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">C++</td>
              <td align="left" rowspan="1" colspan="1">
                <p>This block is called once in two different settings:
<list list-type="bullet" id="psp412467-list-0004"><list-item><p>Immediately prior to starting the simulation run</p></list-item><list-item><p>Immediately prior to calling <monospace>[MAIN]</monospace> when calculating initial conditions</p></list-item></list>
</p>
                <p><monospace>[PREAMBLE]</monospace> is a function that allows you to set up your C++ environment. It is only called one time during the simulation run (right at the start). The code in this block is typically used to configure or initialize C++ variables or data structures that were declared in <monospace>[GLOBAL]</monospace>.</p>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>[OMEGA]</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">Text</td>
              <td align="left" rowspan="1" colspan="1">Used to enter variance/covariance matrices for subject‐level random effects drawn from multivariate normal distribution. All random effects are assumed to have a mean of 0.</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <monospace>[SIGMA]</monospace>
              </td>
              <td align="center" rowspan="1" colspan="1">Text</td>
              <td align="left" rowspan="1" colspan="1">Use this block to enter variance/covariance matrices for within‐subject random effects drawn from multivariate normal distribution. All random effects are assumed to have a mean of 0.</td>
            </tr>
          </tbody>
        </table>
        <permissions>
          <copyright-holder>John Wiley &amp; Sons, Ltd</copyright-holder>
        </permissions>
      </table-wrap>
      <sec id="psp412467-sec-0004">
        <title>Parameters</title>
        <p>The parameter block <monospace>[PARAM]</monospace> is used to list an updatable set of name–value pairs. Although the name “parameter” may have a certain connotation in the modeling world, in mrgsolve a “parameter” could be any category of numeric data: covariates (e.g., <monospace>WT, AGE, SEX</monospace>), flags, and other numeric data that we commonly call “parameter” (e.g., <monospace>CL</monospace> or <monospace>VC</monospace>).</p>
        <p>Although there may be multiple <monospace>[PARAM]</monospace>blocks in a model, once compiled they become condensed to a single parameter list stored in the model object. The names and values of all parameters must be declared for the model to be compiled. For example: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>[PARAM] CL = 1, VC = 20, KA = 1.2
KM = 25, VMAX = 400, FLAG = 1, WT = 80
SEX = 0, N = sqrt(25)
</monospace></code>
</p>
        <p>Notably, although a default value for each parameter must be declared for compilation at model compile time, the value of any parameter may be updated without recompiling the model using either the <monospace>param()</monospace>function during simulation execution or through an input data set.</p>
      </sec>
      <sec id="psp412467-sec-0005">
        <title>State variables</title>
        <p>Similar to the parameter list, the model state variables or compartments list is a series of name–value pairs that define the number, names, and initial conditions of each state variable (compartment) in the model. Compartments are declared in one of two code blocks: <monospace>[INIT]</monospace> or <monospace>[CMT]</monospace>. Nominal initial values must be supplied for each compartment. The main difference between <monospace>[INIT]</monospace> and <monospace>[CMT]</monospace> is that <monospace>[CMT]</monospace> assumes a default initial value of 0 for each compartment; thus only compartment names are entered. When using <monospace>[INIT]</monospace>, both names and values must be explicitly stated for each compartment. The initial values for each compartment can be queried with the <monospace>init()</monospace> function. For example: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>[CMT] GUT CENT RESP
</monospace></code>
</p>
        <p>or<code xml:space="preserve" position="float" orientation="portrait">
<monospace>[INIT] GUT = 0, CENT = 0, RESP = 25
</monospace></code>
</p>
      </sec>
      <sec id="psp412467-sec-0006">
        <title>ODEs</title>
        <p>The <monospace>[ODE]</monospace> block is where the ordinary differential equations are defined. For each compartment, the value of the differential equation needs to be assigned to <monospace>dxdt_CMT,</monospace> where <monospace>CMT</monospace> is the name of the compartment. The <monospace>dxdt_</monospace> equation may be a function of model parameters (via <monospace>[PARAM]</monospace>), the current value of any compartment (<monospace>CMT</monospace>), or any user‐derived variable. For example: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>[CMT] GUT CENT
[ODE]
dxdt_GUT = -KA*GUT;
dxdt_CENT = KA*GUT - KE*CENT;
</monospace></code>
</p>
        <p>Because the [ODE] block is written in C++, a semicolon is required at the end of each statement.</p>
        <p>It is important to make sure that there is a <monospace>dxdt_</monospace> expression defined for every compartment listed in <monospace>[CMT]</monospace> or <monospace>[INIT]</monospace>, even if it is <monospace>dxdt_CMT = 0</monospace>. The <monospace>[ODE]</monospace> function is called repeatedly (at each solver step) during a simulation run. For computational efficiency it is recommended that any calculations that do not rely on recalculation at each step be included outside of <monospace>[ODE]</monospace>, e.g., in the <monospace>[MAIN]</monospace> block where derived quantities also can be calculated (<bold>Table</bold> <xref rid="psp412467-tbl-0001" ref-type="table"><bold>1</bold></xref>). Notably, any calculation that depends on an amount in a compartment and determines the <monospace>dxdt_</monospace> expression in a model must be written in <monospace>[ODE]</monospace>. For example: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>[CMT] CENT RESP
[PARAM] VC = 100, KE = 0.2, KOUT = 2, KIN = 100
[ODE]
double CP = CENT/VC;
double INH = CP/(IMAX+CP);
dxdt_CENT = -KE*CENT;
dxdt_RESP = KIN*(1 - INH) - RESP*KOUT;
</monospace></code>
</p>
        <p>Note that in the <monospace>[ODE]</monospace> block new C++ variables must be declared as <monospace>double</monospace> with the semicolon at the end of each line.</p>
      </sec>
      <sec id="psp412467-sec-0007">
        <title>Outputs</title>
        <p>When a simulation is run in mrgsolve, the time progression of the state variables (compartments) at each specified time point is returned by default. Any other variable of interest can be returned using the <monospace>[CAPTURE]</monospace> block that will add additional columns to the default output capturing these variables. Often users need to interact with parameters, compartment values, and other user‐defined variables after the system advances to the next time to generate new variables. The block <monospace>[TABLE]</monospace> can be used for this purpose and the newly generated variables can be subsequently captured in <monospace>[CAPTURE]</monospace>. Example: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>[TABLE] double CP = CENT/VC;
[CAPTURE] CP
</monospace></code>
</p>
        <p>The <monospace>[TABLE]</monospace> block also uses C++ syntax, so new variables must be declared (<monospace>double</monospace>) and statements must end with semicolons. For convenience, the user can simply use the <monospace>capture</monospace> type declaration in <monospace>[TABLE],</monospace> and this variable would automatically be integrated in the output without the need for a <monospace>[CAPTURE]</monospace> block. Example: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>[TABLE] capture CP = CENT/VC;
</monospace></code>
</p>
        <p>Following is a complete example of a model specification file code for a one‐compartment PK model with oral absorption: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>[PARAM] CL=0.02, VC=0.5, KA=0.9
[CMT] GUT CENT
[ODE]
dxdt_GUT = -KA*GUT;
dxdt_CENT = KA*GUT - (CL/VC)*CENT;
[TABLE] capture CP = CENT/VC;
</monospace></code>
</p>
        <p>This complete model example is saved as <monospace>model/pk1.cpp</monospace> in the associated GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/metrumresearchgroup/cptpsp-tutorial-2019">https://github.com/metrumresearchgroup/cptpsp-tutorial-2019</ext-link>. Additional references include a summary of the model blocks (<bold>Table </bold>
<xref rid="psp412467-tbl-0001" ref-type="table"><bold>1</bold></xref>) and the mrgsolve user guide: <ext-link ext-link-type="uri" xlink:href="https://mrgsolve.github.io/user_guide/index.html">https://mrgsolve.github.io/user_guide/index.html</ext-link>.</p>
      </sec>
    </sec>
    <sec id="psp412467-sec-0008">
      <title>Creating a model object</title>
      <p>Prior to simulation, a model object is created to contain the mrgsolve model using the <monospace>mread()</monospace>function. This function will read, parse, compile, and load the model to create a model object to be used for running simulations. As an example, the following code snippet will read in the one‐compartment model <monospace>pk1</monospace> saved in the relative path <monospace>../model</monospace>: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>library(mrgsolve)
mod &lt;- mread("pk1", "../model")
</monospace></code>
</p>
      <p>To get information about the model, type <monospace>mod</monospace> in the R console: 
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0001" orientation="portrait"><graphic xlink:href="PSP4-8-883-g006.jpg" position="anchor" id="nlm-graphic-3" orientation="portrait"/></boxed-text>
</p>
      <p>To review the model parameter values, the user can use the <monospace>param()</monospace> function as: 
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0002" orientation="portrait"><graphic xlink:href="PSP4-8-883-g007.jpg" position="anchor" id="nlm-graphic-5" orientation="portrait"/></boxed-text>
</p>
      <p>Note that the <monospace>param()</monospace> function can be used to explore model parameter values as above or to update those values with new values as mentioned previously. For example, if the user wants to update the <monospace>CL</monospace> value, the command to be used is: <monospace>param(mod, CL = 2)</monospace>.</p>
    </sec>
    <sec id="psp412467-sec-0009">
      <title>Setting an intervention</title>
      <p>Setting an intervention, similar to a dosing event, can be done by creating an event object using the <monospace>ev()</monospace> function: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>evnt &lt;- ev(amt = 100, ii = 24, addl = 9)
</monospace></code>
</p>
      <p>This command creates the <monospace>evnt</monospace> object that defines a dose (<monospace>amt</monospace>) of 100 to be taken every day (<monospace>ii</monospace>; interdose interval) for 10 days (<monospace>addl</monospace>; nine additional doses). Intentional similarities between mrgsolve and NONMEM (ICON Development Solutions, Gaithersburg, MD) annotations were purposeful and allow, for example, the use of NM‐TRAN formatted data as input into the simulations. By default, the dose will go into compartment 1, which is the first compartment to be declared in the <monospace>[INIT]</monospace> or <monospace>[CMT]</monospace> blocks. In this example, that is the gut compartment <monospace>GUT</monospace>. To specify a different compartment, the user can use the <monospace>ev()</monospace> function <monospace>cmt</monospace> argument with the specific compartment number or name.</p>
    </sec>
    <sec id="psp412467-sec-0010">
      <title>Simulating</title>
      <p>The created model and event objects are passed to the <monospace>mrgsim()</monospace>function to run the simulation. The code below takes advantage of the <italic>magrittr</italic>
<xref rid="psp412467-bib-0014" ref-type="ref">14</xref> syntax <monospace>%&gt;%</monospace> (available as part of the tidyverse suite<xref rid="psp412467-bib-0009" ref-type="ref">9</xref>; installation and loading of the required packages is also documented and scripted through code; see <monospace>mrgsolveIntro_script.R</monospace> in the GitHub repository) to pass the model <monospace>mod</monospace> and the event <monospace>evnt</monospace> objects into the <monospace>mrgsim()</monospace> function for simulation:</p>
      <p>
        <monospace>out &lt;‐ mod %&gt;% ev(evnt) %&gt;% mrgsim(end = 480, delta = 0.1)</monospace>
      </p>
      <p>The simulation output (a data frame of simulated values) is saved to the object <monospace>out</monospace>. Two elements of the simulation time grid—<monospace>end</monospace> and <monospace>delta</monospace>—are illustrated in the example code. These define the output end time and the interval between output time points, respectively. Other elements are <monospace>start</monospace> that defines the start time and <monospace>add</monospace> that defines any arbitrary vector of additional times to simulate. For an example of the simulation output, <monospace>head(out)</monospace>returns: 
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0003" orientation="portrait"><graphic xlink:href="PSP4-8-883-g008.jpg" position="anchor" id="nlm-graphic-7" orientation="portrait"/></boxed-text>
</p>
      <p>Note that the output captures the values for the two model compartments <monospace>GUT</monospace> and <monospace>CENT</monospace> as well as the captured plasma concentration <monospace>CP</monospace>. The same <monospace>out</monospace> object can be used to plot simulation results (<bold>Figure</bold> <xref rid="psp412467-fig-0001" ref-type="fig"><bold>1</bold></xref>) with the function <monospace>plot(out).</monospace>
</p>
      <p>Additional details and examples are available on the mrgsolve GitHub page (<ext-link ext-link-type="uri" xlink:href="https://github.com/metrumresearchgroup/mrgsolve">https://github.com/metrumresearchgroup/mrgsolve</ext-link>) and vignettes (<ext-link ext-link-type="uri" xlink:href="https://mrgsolve.github.io/vignettes/">https://mrgsolve.github.io/vignettes/</ext-link>).</p>
    </sec>
  </sec>
  <sec id="psp412467-sec-0011">
    <title>PBPK Application: Voriconazole</title>
    <p>Advancements in computation capabilities have contributed to an increased use of PBPK models in recent years. These are typically mamillary models, with individual compartments representing different tissues and organs in the body. The PK of the drug of interest is described via a series of ODEs with the rates controlled by physiological properties of the species (e.g., organ volumes and blood flows) and the physicochemical properties of the drug (e.g., lipophilicity, unbound fraction, and pK<sub><italic>a</italic></sub>). Being based on first principles makes PBPK models particularly useful in running simulations when there are little or no clinical data available as in the case of special populations such as neonates, children, and pregnant women.</p>
    <p>Implementation of a previously developed voriconazole PBPK model<xref rid="psp412467-bib-0015" ref-type="ref">15</xref> in mrgsolve is used as a demonstration. The PBPK model was developed by Zane and Thakker<xref rid="psp412467-bib-0015" ref-type="ref">15</xref> with the intent of providing a mechanistic explanation for the difference in voriconazole PK between adults and children. The PBPK model structure (<bold>Figure</bold> <xref rid="psp412467-fig-0002" ref-type="fig"><bold>2</bold></xref>) included assumptions that the compartments were well stirred and that the transfer of drug between these compartments was flow limited. The generic flow‐limited ODEs were adapted from the previously described mass balance differential equations<xref rid="psp412467-bib-0016" ref-type="ref">16</xref>, <xref rid="psp412467-bib-0017" ref-type="ref">17</xref>, <xref rid="psp412467-bib-0018" ref-type="ref">18</xref> as follows:<disp-formula id="psp412467-disp-0001"><label>(1)</label><mml:math id="nlm-math-1"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>C</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">BP</mml:mi></mml:mfrac></mml:mfrac></mml:mfenced></mml:mrow></mml:math></disp-formula>
<disp-formula id="psp412467-disp-0002"><label>(2)</label><mml:math id="nlm-math-2"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>C</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">BP</mml:mi></mml:mfrac></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mtext>CL</mml:mtext><mml:mi>T</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msub><mml:mi mathvariant="normal">BP</mml:mi></mml:mfrac></mml:mfrac></mml:mrow></mml:math></disp-formula>
<disp-formula id="psp412467-disp-0003"><label>(3)</label><mml:math id="nlm-math-3"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi mathvariant="normal">Lu</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="normal">Lu</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">Lu</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">BP</mml:mi></mml:mfrac></mml:mfrac><mml:mo>-</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math></disp-formula>
<disp-formula id="psp412467-disp-0004"><label>(4)</label><mml:math id="nlm-math-4"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>≠</mml:mo><mml:mi mathvariant="normal">Lu</mml:mi></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mfrac><mml:msub><mml:mi>K</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msub><mml:mi mathvariant="normal">BP</mml:mi></mml:mfrac></mml:mfrac></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi mathvariant="normal">Lu</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
<disp-formula id="psp412467-disp-0005"><label>(5)</label><mml:math id="nlm-math-5"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi mathvariant="normal">Lu</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi mathvariant="normal">Lu</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>C</mml:mi><mml:mi>V</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi mathvariant="normal">Lu</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>K</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="normal">Lu</mml:mi></mml:msub></mml:mrow><mml:mi mathvariant="normal">BP</mml:mi></mml:mfrac></mml:mfrac></mml:mfenced></mml:mrow></mml:math></disp-formula>
</p>
    <fig fig-type="Figure" xml:lang="en" id="psp412467-fig-0002" orientation="portrait" position="float">
      <label>Figure 2</label>
      <caption>
        <p>Voriconazole physiologically‐based pharmacokinetic (<styled-content style="fixed-case" toggle="no">PBPK</styled-content>) model structure. The full <styled-content style="fixed-case" toggle="no">PBPK</styled-content> model structure where <italic>Q</italic> represents the blood flows, CL represents clearance, and the subscripts Ad, Bo, Br, Gu, He, Ki, Li, Lu, Mu, Sp, and Re refer to adipose, bone, brain, gut, heart, kidneys, liver, lungs, muscle, spleen, and rest of the body compartments, respectively. Ha, hepatic artery.</p>
      </caption>
      <graphic id="nlm-graphic-9" xlink:href="PSP4-8-883-g002"/>
    </fig>
    <p>Eqs. <xref rid="psp412467-disp-0001" ref-type="disp-formula">(1)</xref>, <xref rid="psp412467-disp-0002" ref-type="disp-formula">(2)</xref>, <xref rid="psp412467-disp-0003" ref-type="disp-formula">(3)</xref>, <xref rid="psp412467-disp-0004" ref-type="disp-formula">(4)</xref>, <xref rid="psp412467-disp-0005" ref-type="disp-formula">(5)</xref> represent the generic ODEs for noneliminating, eliminating, arterial, venous, and lung compartments, respectively, where <italic>A</italic>
<sub><italic>T</italic></sub> is the amount of drug in tissue <italic>T</italic>;<italic> Q</italic>
<sub><italic>T</italic></sub> is the blood flow to that tissue; <italic>C</italic>
<sub><italic>A</italic></sub> and <italic>C</italic>
<sub><italic>V</italic></sub> are the drug concentrations in the arterial and venous blood compartments, respectively; <italic>Kp</italic>
<sub><italic>T</italic></sub> is the tissue:plasma partition coefficient; BP is the blood:plasma concentration ratio; CL<sub><italic>T</italic></sub> is the tissue clearance; and <italic>f</italic>
<sub><italic>u</italic></sub> is the unbound fraction of drug. The specific organ subscript notations follow the same notations in <bold>Figure</bold> <xref rid="psp412467-fig-0002" ref-type="fig"><bold>2</bold></xref>.</p>
    <p>The parameters required to populate the aforementioned equations were collected as follows: (i) physiological parameters including organ volumes (needed to calculate drug concentrations) and organ blood flows for the typical 30‐year‐old adult male and 5‐year‐old male child were collected from the International Commission on Radiological Protection Publication 89,<xref rid="psp412467-bib-0019" ref-type="ref">19</xref> (ii) <italic>K</italic>
<sub><italic>p</italic></sub> values for each tissue were computed using the Poulin and Theil calculation method with inputs of drug physicochemical properties (log<italic>P</italic>, pK<sub><italic>a</italic></sub>, <italic>f</italic>
<sub><italic>u</italic></sub>, and BP<xref rid="psp412467-bib-0015" ref-type="ref">15</xref>, <xref rid="psp412467-bib-0020" ref-type="ref">20</xref>) and the different tissue fractional composition (water, neutral, and phospholipids) to calculate Kp values as follows<xref rid="psp412467-bib-0020" ref-type="ref">20</xref>: <disp-formula id="psp412467-disp-0006"><label>(6)</label><mml:math id="nlm-math-6"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">nlt</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.3</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">pht</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">wt</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.7</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">pht</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">nlp</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.3</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">php</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">wp</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.7</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">php</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">up</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">ut</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math></disp-formula>
<disp-formula id="psp412467-disp-0007"><label>(7)</label><mml:math id="nlm-math-7"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">nlt</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.3</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">pht</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">wt</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.7</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">pht</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="normal">w</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">nlp</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.3</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">php</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">wp</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>0.7</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">php</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mfrac><mml:msub><mml:mi>f</mml:mi><mml:mi mathvariant="normal">up</mml:mi></mml:msub><mml:mn>1</mml:mn></mml:mfrac></mml:mrow></mml:math></disp-formula>where Eqs. <xref rid="psp412467-disp-0006" ref-type="disp-formula">6</xref> and <xref rid="psp412467-disp-0007" ref-type="disp-formula">7</xref> were used to calculate Kp values for nonadipose and adipose tissues, respectively. <italic>P</italic>
<sub>o:w</sub> is the <italic>n</italic>‐octanol:buffer partition coefficient of the nonionized species and <mml:math id="nlm-math-8"><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mo>:</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msubsup></mml:math> is the olive oil:buffer partition coefficient of both the nonionized and ionized species at pH 7.4. <italic>f</italic>
<sub>nl</sub>, <italic>f</italic>
<sub>ph</sub> and <italic>f</italic>
<sub><italic>w</italic></sub> are the fractional volumes of neutral lipids, phospholipids, and water, respectively. <italic>f</italic>
<sub><italic>u</italic></sub> is the unbound fraction of drug. The subscripts <italic>t</italic> and <italic>p</italic> indicate tissue and plasma, respectively.</p>
    <p>To calculate the <italic>in vivo</italic> hepatic clearance (CL<sub>Li</sub>) for voriconazole, <italic>in vitro</italic> hepatic metabolism data<xref rid="psp412467-bib-0021" ref-type="ref">21</xref> were used as follows:
<disp-formula id="psp412467-disp-0008"><label>(8)</label><mml:math id="nlm-math-9"><mml:mrow><mml:msub><mml:mtext>CL</mml:mtext><mml:mi mathvariant="normal">Li</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mtext>CL</mml:mtext><mml:mrow><mml:mi mathvariant="normal">Li</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">mic</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">mic</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo>·</mml:mo><mml:mtext>MPPGL</mml:mtext><mml:mo>·</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi mathvariant="normal">Li</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>
<disp-formula id="psp412467-disp-0009"><label>(9)</label><mml:math id="nlm-math-10"><mml:mrow><mml:msub><mml:mtext>CL</mml:mtext><mml:mrow><mml:mi mathvariant="normal">Li</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">mic</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi mathvariant="normal">V</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">Li</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">mic</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">Li</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">mic</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></disp-formula>where CL<sub>Li,mic</sub> is the <italic>in vitro</italic> microsomal clearance, <italic>f</italic>
<sub>u,mic</sub> is the free fraction of the drug in the <italic>in vitro</italic> microsomal system, <italic>MPPGL</italic> is the mg microsomal proteins per gram liver, <italic>W</italic>
<sub>Li</sub> is liver weight, <italic>V</italic>
<sub>max,Li,mic</sub> and <italic>K</italic>
<sub>m,Li,mic</sub> are the hepatic maximum rate of clearance and Michaelis‐Menten constant estimated from the <italic>in vitro</italic> system, respectively.</p>
    <sec id="psp412467-sec-0012">
      <title>PBPK model building in mrgsolve</title>
      <p>Two files were created to build the PBPK model: a model specification file for the ODE‐based model and an R script file to compile the model and run simulations. In the associated GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/metrumresearchgroup/cptpsp-tutorial-2019">https://github.com/metrumresearchgroup/cptpsp-tutorial-2019</ext-link>, these files can be found under <monospace>model/voriPBPK.cpp</monospace> and <monospace>script/voriPBPK_script.R</monospace>, respectively. In the model specification file, the main blocks needed to define the model were <monospace>[PARAM], [CMT], [MAIN], [ODE],</monospace> and <monospace>[TABLE]</monospace> blocks; typically a user will start with the <monospace>[CMT]</monospace> and <monospace>[ODE]</monospace> blocks and then walk back to populating the necessary components as parameters and derived parameters required to run the ODEs. Model compartments for the current example were declared according to <bold>Figure</bold> <xref rid="psp412467-fig-0003" ref-type="fig"><bold>3</bold></xref>: 
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0004" orientation="portrait"><graphic xlink:href="PSP4-8-883-g009.jpg" position="anchor" id="nlm-graphic-11" orientation="portrait"/></boxed-text>
</p>
      <fig fig-type="Figure" xml:lang="en" id="psp412467-fig-0003" orientation="portrait" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Model validation against observed data. Voriconazole plasma concentration‐time profiles for 4 mg/kg <styled-content style="fixed-case" toggle="no">intravenous</styled-content> infusion dosing for adults (<bold>a</bold>) and children (<bold>b</bold>). The plots show the observed data (black dots) and the corresponding predictions from the adult and pediatric models (black lines). Error bars represent standard deviation.</p>
        </caption>
        <graphic id="nlm-graphic-13" xlink:href="PSP4-8-883-g003"/>
      </fig>
      <p>The ODEs were declared in the <monospace>[ODE]</monospace> block as: 
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0005" orientation="portrait"><graphic xlink:href="PSP4-8-883-g010.jpg" position="anchor" id="nlm-graphic-15" orientation="portrait"/></boxed-text>
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0006" orientation="portrait"><graphic xlink:href="PSP4-8-883-g011.jpg" position="anchor" id="nlm-graphic-17" orientation="portrait"/></boxed-text>
</p>
      <p>Voriconazole concentrations in different tissues were also declared in the <monospace>[ODE]</monospace> block because they were dependent on the state variables governed by the previous ODEs. For example, the muscle drug concentration was declared as:</p>
      <p>
        <monospace>double Cmuscle = MUSCLE/Vmu;</monospace>
      </p>
      <p>Organ volumes, blood flows, body weight, voriconazole absorption rate constant, unbound fraction, <italic>in vitro</italic> hepatic metabolism parameters, calculated Kp, and blood:plasma concentration ratio BP were directly declared in the <monospace>[PARAM]</monospace> block (see <monospace>voriPBPK.cpp</monospace> in the GitHub repository).</p>
      <p>In the <monospace>[MAIN]</monospace> block, derived parameters included arterial and venous blood volumes, blood flow to the liver, volume and blood flow to the rest of the body compartment, and <italic>in vivo</italic> hepatic clearance as follows: 
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0007" orientation="portrait"><graphic xlink:href="PSP4-8-883-g012.jpg" position="anchor" id="nlm-graphic-19" orientation="portrait"/></boxed-text>
</p>
      <p>Finally, in the <monospace>[TABLE]</monospace> block, voriconazole plasma concentration can be captured to be part of the output as: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>[TABLE] capture CP = Cvenous/BP;
</monospace></code>
</p>
    </sec>
    <sec id="psp412467-sec-0013">
      <title>Model validation</title>
      <p>After model building, the following step would be to use the associated R script <monospace>voriPBPK_script.R</monospace> to compile the model and run simulations for model validation against the observed data. The script starts by cleaning up the working space and loading the necessary libraries. Then the adult model was compiled using the <monospace>mread()</monospace> function as follows: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>modA &lt;- mread("../model/voriPBPK")
</monospace></code>
</p>
      <p>This command compiles the adult model and saves it as <monospace>modA</monospace> object. The <monospace>param()</monospace> function was used to generate the pediatric model. First, a <monospace>pedPhys</monospace> object was created that was a named list of the curated pediatric physiological parameters<xref rid="psp412467-bib-0019" ref-type="ref">19</xref> and then a new pediatric model was generated by updating the adult model as follows: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>modP &lt;- param(modA, pedPhys)
</monospace></code>
</p>
      <p>Note that the updated parameter object needs to be a named list with the same parameter names as declared in the <monospace>[PARAM]</monospace> block.</p>
      <p>Similarly, the <italic>K</italic>
<sub><italic>p</italic></sub> values can be updated to reflect the calculated values using the Poulin and Theil method as previously described.<xref rid="psp412467-bib-0020" ref-type="ref">20</xref> To make this calculation process seamless and easily applicable to drugs other than voriconazole, an R script (<monospace>calcKp_PT.R</monospace>) was created that contains the function <monospace>calcKp_PT()</monospace>. This function takes any drug's physicochemical properties and returns a named list that can be directly used to update the PBPK model object. The function also needs fractional tissue composition data as another input. These data were digitized from the Poulin and Theil publication<xref rid="psp412467-bib-0020" ref-type="ref">20</xref> and saved as <monospace>data/tissue_comp_PT.csv</monospace>. For voriconazole, the <italic>K</italic>
<sub><italic>p</italic></sub> updating was done by first reading in the tissue composition data, sourcing the <monospace>calcKp_PT()</monospace> function, calculating the <italic>K</italic>
<sub><italic>p</italic></sub> values, and saving them as a named list <monospace>Kp</monospace>, then finally updating the model objects: <code xml:space="preserve" position="float" orientation="portrait">
<monospace>tissueComp &lt;- read.csv("../data/tissue_comp_PT.csv") # tissue composition
source("calcKp_PT.R")
Kp &lt;- calcKp_PT(logP=2.56, pKa=1.76, fup=0.42, BP=1, type=3, dat=tissueComp)
modA &lt;- param(modA, Kp)
modP &lt;- param(modP, Kp)
</monospace></code>
</p>
      <p>where the <monospace>calcKp_PT()</monospace> argument <monospace>type</monospace> was set to 3 for monoprotic base (see <monospace>calcKp_PT.R</monospace> for more details).</p>
      <p>Next, simulations can be run to validate the model predictions against the digitized observed data from the Zane and Thakker publication<xref rid="psp412467-bib-0015" ref-type="ref">15</xref> (digitization was done using webplotdigitizer: <ext-link ext-link-type="uri" xlink:href="https://automeris.io/WebPlotDigitizer/">https://automeris.io/WebPlotDigitizer/</ext-link>). The following two sets of clinical data were used for validation: (i) an adult 4 mg/kg <styled-content style="fixed-case" toggle="no">intravenous</styled-content> infusion dose infused over an hour twice a day for a week and (ii) a pediatric 4 mg/kg <styled-content style="fixed-case" toggle="no">intravenous</styled-content> infusion dose infused with a rate of 3 mg/kg/hour twice a day for a week. Steady‐state simulations were run for both populations under the same conditions as the observed data, and the simulation objects <monospace>simA</monospace> (for adults) and <monospace>simP</monospace> (for children) were created as follows: 
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0008" orientation="portrait"><graphic xlink:href="PSP4-8-883-g013.jpg" position="anchor" id="nlm-graphic-21" orientation="portrait"/></boxed-text>
</p>
      <p>In the previous simulations, the function <monospace>ev()</monospace> was used to set the dosing events for the simulations as previously described. The simulation results were then plotted against the observed data and were shown to match well with the latter (<bold>Figure</bold> <xref rid="psp412467-fig-0003" ref-type="fig">3</xref>). As mentioned previously, the workflow in R could also be utilized to wrap the model objects within other R functions to run sensitivity analyses to pinpoint the most influential parameters (e.g., FME<xref rid="psp412467-bib-0022" ref-type="ref">22</xref> and sensitivity<xref rid="psp412467-bib-0023" ref-type="ref">23</xref> package functions) or to further tune the model predictions via parameter optimization.</p>
    </sec>
  </sec>
  <sec id="psp412467-sec-0014">
    <title>QSP Application: Mitogen‐Activated Protein Kinase</title>
    <p>Using the same approach, a QSP application is demonstrated in mrgsolve using the mitogen‐activated protein kinase (MAPK) model published by Kirouac <italic>et al</italic>.<xref rid="psp412467-bib-0024" ref-type="ref">24</xref> (<bold>Figure</bold> <xref rid="psp412467-fig-0004" ref-type="fig"><bold>4</bold></xref>). The authors were interested in the clinical responses to therapy in colorectal cancer caused by a V600E/K mutation in the cytosolic kinase BRAF, which renders the kinase constitutively active and hence activates the downstream MEK and extracellular‐signal‐regulated kinase (ERK) signaling. BRAF and MEK inhibitors were found to be effective in V600E mutant melanoma, but these agents showed only a moderate effect in colorectal cancer. The purpose of the QSP model was to build a signaling cascade for MAPK (<bold>Figure</bold> <xref rid="psp412467-fig-0004" ref-type="fig"><bold>4</bold></xref>) to assess the effect of introducing an ERK inhibitor as a monotherapy or in combination regimens with other agents on tumor size in colorectal cancer.<xref rid="psp412467-bib-0024" ref-type="ref">24</xref>
</p>
    <fig fig-type="Figure" xml:lang="en" id="psp412467-fig-0004" orientation="portrait" position="float">
      <label>Figure 4</label>
      <caption>
        <p><styled-content style="fixed-case" toggle="no">MAPK quantitative systems pharmacology</styled-content> model signaling network. Gray, red, and yellow nodes represent <styled-content style="fixed-case" toggle="no">MAPK</styled-content> signaling pathway, regulatory feedback, and alternative signaling pathway components. Image was reproduced from<xref rid="psp412467-bib-0024" ref-type="ref">24</xref> under a Creative Commons Attribution 4.0 International License. DUSP, dual‐specificity phosphatase; EGFR, epidermal growth factor receptor; ERK, extracellular‐signal‐regulated kinase; FOXO, forkhead box protein; MAPK, mitogen‐activated protein kinase; PI3k, phosphatidylinositol‐3‐Kinase; RTK, receptor tyrosine kinase.</p>
      </caption>
      <graphic id="nlm-graphic-23" xlink:href="PSP4-8-883-g004"/>
    </fig>
    <sec id="psp412467-sec-0015">
      <title>QSP model building in mrgsolve</title>
      <p>A mrgsolve model file was generated programmatically from the Systems Biology Markup Language file attached to the Kirouac <italic>et al</italic>. publication. The translation code was written in R and utilized an R interface to libSBML as linked from <ext-link ext-link-type="uri" xlink:href="https://sbml.org">https://sbml.org</ext-link>. The translated model specification file <monospace>model</monospace>/<monospace>mapkQSP.cpp</monospace> in the associated GitHub repository contained the usual mrgsolve blocks <monospace>[INIT]</monospace>, <monospace>[PARAM]</monospace>, <monospace>[ODE],</monospace> and <monospace>[TABLE],</monospace> where the model compartments with their initial conditions, parameters, ODEs, and outputs were declared. A new <monospace>[GLOBAL]</monospace> block (see <bold>Table</bold> <xref rid="psp412467-tbl-0001" ref-type="table"><bold>1</bold></xref>) was added to the specification file to define a Hill equation that would be used in the <monospace>[ODE]</monospace> block as follows: 
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0009" orientation="portrait"><graphic xlink:href="PSP4-8-883-g014.jpg" position="anchor" id="nlm-graphic-25" orientation="portrait"/></boxed-text>
</p>
      <p>The virtual population of 1,000 randomly sampled parameter values included as a supplement file in the Kirouac <italic>et al</italic>. publication was saved as <monospace>data/s10vpop_pk.RDS.</monospace> One set of these parameter values was used as a placeholder in the specification file <monospace>[PARAM]</monospace> block. For more details about the model structure and parameter values, please refer to <monospace>mapkQSP.cpp</monospace> in the associated GitHub repository.</p>
    </sec>
    <sec id="psp412467-sec-0016">
      <title>Comparing different therapeutic combinations</title>
      <p>The model was then used to compare the responses to different regimens of mono and combination drug therapies with and without an ERK inhibitor. The proposed drugs were the BRAF inhibitor vemurafenib (VEMU), the MEK inhibitor cobimetinib (COBI), the epidermal growth factor receptor antibody cetuximab (CETUX), and the ERK inhibitor GDC‐0994 (GDC). The clinical dosing regimens for COBI and GDC were daily dosing of 60 and 400 mg, respectively, with 21/7‐day on/off cycles, whereas for VEMU and CETUX the dosing was continuous 960 and 450 mg twice daily and weekly, respectively.<xref rid="psp412467-bib-0024" ref-type="ref">24</xref> These dosing regimens were implemented in the <monospace>mapkQSP_script.R</monospace> as follows: <code xml:space="preserve" position="float" orientation="portrait">
<monospace># ERK inhibitor - GCD-994 (GDC) - Compartment 12
dataG &lt;- ev(cmt = 12, amt = 400, ii = 1, addl = 20)
dataG &lt;- seq(dataG, wait = 6, dataG)
# MEK inhibitor - cobimetinib (COBI) - Compartment 10
dataCO &lt;- mutate(dataG, cmt=10, amt=60)
# EGFR inhibitor - cetuximab (CETUX) - Compartment 7
dataCE &lt;- ev(cmt=7, amt=450, ii=7, addl=7)
# BRAF inhibitor - vemurafanib (VEMU) - Compartment 8
dataV &lt;- ev(cmt=8, amt=960, ii=0.5, addl=120)
</monospace></code>
</p>
      <p>Two functions were created, (<monospace>comb()</monospace> and <monospace>sim()</monospace>), to combine dosing regimens and simulate, a data frame was then created to encompass all 16 possible combinations of the four drugs of interest, and finally the simulations were run given the full virtual population as follows: 
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0010" orientation="portrait"><graphic xlink:href="PSP4-8-883-g015.jpg" position="anchor" id="nlm-graphic-27" orientation="portrait"/></boxed-text>
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0011" orientation="portrait"><graphic xlink:href="PSP4-8-883-g016.jpg" position="anchor" id="nlm-graphic-29" orientation="portrait"/></boxed-text>
</p>
      <p>The end time for all simulations was 56 days (8 weeks) because this is the time when the tumor size response is assessed.<xref rid="psp412467-bib-0024" ref-type="ref">24</xref>
</p>
      <p>The results for all simulations were summarized in <bold>Figure</bold> <xref rid="psp412467-fig-0005" ref-type="fig"><bold>5</bold></xref>, which was used as model verification as a reproduction of figure 6B from Kirouac <italic>et al</italic>.<xref rid="psp412467-bib-0024" ref-type="ref">24</xref> The figure depicts the noticeable impact of the ERK inhibitor GDC on tumor size either as a mono or combination therapy (red boxplots). The overall response rate (ORR) to GDC as a monotherapy or as a GDC + COBI combination therapy was quantified in the full virtual population vs. a subset of the population where tumor size was strongly dependent on MAPK signaling (represented by higher <monospace><italic>W</italic><sub>OR</sub></monospace> parameter values). In the R/mrgsolve workflow, this was done as follows: 
<boxed-text position="anchor" content-type="graphic" id="psp412467-blkfxd-0012" orientation="portrait"><graphic xlink:href="PSP4-8-883-g017.jpg" position="anchor" id="nlm-graphic-31" orientation="portrait"/></boxed-text>
</p>
      <fig fig-type="Figure" xml:lang="en" id="psp412467-fig-0005" orientation="portrait" position="float">
        <label>Figure 5</label>
        <caption>
          <p>Effect of different drug combinations on tumor size. Normalized tumor size at week 8 is plotted against each of the 16 corresponding drug combinations. Gray dots and overlaid boxplots represent simulated tumor sizes with combinations containing <styled-content style="fixed-case" toggle="no">GDC</styled-content> highlighted in red. Horizontal black line represents tumor size reduction of 30%. CETUX, cetuximab; COBI, cobimetinib; GDC, GDC‐0994; VEMU, vemurafenib.</p>
        </caption>
        <graphic id="nlm-graphic-33" xlink:href="PSP4-8-883-g005"/>
      </fig>
      <p>Results traceably, and in an open‐source platform, reproduced the previously predicted ORR in the full population (14% and 35.2% for GDC and GDC+COBI, respectively), and a more significant ORR on the MAPK‐dependent subpopulation (28.7% and 70.5% for GDC and GDC+COBI, respectively) with the combination therapy approximating the ORR reached with BRAF<sup>V600E</sup> mutation melanoma patients (~70%).<xref rid="psp412467-bib-0024" ref-type="ref">24</xref> Complete reproduction of this example in mrgsolve is available in the following vignette: <ext-link ext-link-type="uri" xlink:href="https://github.com/metrumresearchgroup/pbpk-qsp-mrgsolve/blob/master/docs/mapk_inhibitors_in_colorectal_cancer.md#translation">https://github.com/metrumresearchgroup/pbpk-qsp-mrgsolve/blob/master/docs/mapk_inhibitors_in_colorectal_cancer.md#translation</ext-link>
</p>
    </sec>
  </sec>
  <sec id="psp412467-sec-0017">
    <title>Funding</title>
    <p>No funding was received for this work.</p>
  </sec>
  <sec sec-type="COI-statement" id="psp412467-sec-0018">
    <title>Conflict of Interest</title>
    <p>The authors declared no competing interests for this work.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="psp412467-sup-0001">
      <caption>
        <p><bold>Supplementary Materials.</bold> mrgsolve model code for physiologically‐based pharmacokinetic and quantitative systems pharmacology example models.</p>
      </caption>
      <media xlink:href="PSP4-8-883-s001.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list content-type="cited-references" id="psp412467-bibl-0001">
    <ref id="psp412467-bib-0001">
      <label>1</label>
      <mixed-citation publication-type="book" id="psp412467-cit-0001"><string-name><surname>Hindmarsh</surname>, <given-names>A.C.</given-names></string-name><chapter-title>ODEPACK, a systematized collection of ODE solvers</chapter-title> In <source xml:lang="en">Scientific Computing</source>, <series>MACS Transactions on Scientific Computation</series>, Vol. <volume>1</volume> (eds. <person-group person-group-type="editor"><name name-style="western"><surname>Stepleman</surname><given-names>R.S.</given-names></name></person-group>
<italic>et al</italic>) <fpage>55</fpage>–<lpage>64</lpage> (<publisher-name>North-Holland</publisher-name>, <publisher-loc>Amsterdam, The Netherlands</publisher-loc>, <year>1983</year>).</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0002">
      <label>2</label>
      <mixed-citation publication-type="book" id="psp412467-cit-0002"><string-name><surname>Eddelbuettel</surname>, <given-names>D.</given-names></string-name><source xml:lang="en">Seamless R and C++ Integration With Rcpp</source> (<publisher-name>Springer Science &amp; Business Media</publisher-name>, <publisher-loc>Berlin, Germany</publisher-loc>, <year>2013</year>).</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0003">
      <label>3</label>
      <mixed-citation publication-type="book" id="psp412467-cit-0003"><string-name><surname>Beal</surname>, <given-names>S.L.</given-names></string-name> &amp; <string-name><surname>Sheiner</surname>, <given-names>L.B.</given-names></string-name>. <source xml:lang="en">NONMEM Users Guide</source> (<publisher-name>University of California</publisher-name>, <publisher-loc>San Francisco, CA</publisher-loc>, <year>1992</year>).</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0004">
      <label>4</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0004"><string-name><surname>Eddelbuettel</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Sanderson</surname>, <given-names>C.</given-names></string-name>
<article-title>RcppArmadillo: accelerating R with high‐performance C linear algebra</article-title>. <source xml:lang="en">Comput. Stat. Data Anal.</source>
<volume>71</volume>, <fpage>1054</fpage>–<lpage>1063</lpage> (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0005">
      <label>5</label>
      <mixed-citation publication-type="miscellaneous" id="psp412467-cit-0005"><string-name><surname>Pinheiro</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Bates</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>DebRoy</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Sarkar</surname>, <given-names>D.</given-names></string-name>; <collab collab-type="authors">R Core Team</collab>
. <article-title>nlme: linear and nonlinear mixed effects models</article-title> &lt;<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=nlme">https://CRAN.R-project.org/package=nlme</ext-link>&gt; (<year>2019</year>).</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0006">
      <label>6</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0006"><string-name><surname>Comets</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Lavenu</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Lavielle</surname>, <given-names>M.</given-names></string-name>
<article-title>Parameter estimation in nonlinear mixed effect models using saemix, an R implementation of the SAEM algorithm [internet]</article-title>. <source xml:lang="en">J. Stat. Softw.</source>
<volume>80</volume> (<year>2017</year>). <pub-id pub-id-type="doi">10.18637/jss.v080.i03</pub-id>.</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0007">
      <label>7</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0007"><string-name><surname>Nyberg</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Ueckert</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Strömberg</surname>, <given-names>E.A.</given-names></string-name>, <string-name><surname>Hennig</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Karlsson</surname>, <given-names>M.O.</given-names></string-name> &amp; <string-name><surname>Hooker</surname>, <given-names>A.C.</given-names></string-name>
<article-title>PopED: an extended, parallelized, nonlinear mixed effects models optimal design tool</article-title>. <source xml:lang="en">Comput. Methods Programs Biomed.</source>
<volume>108</volume>, <fpage>789</fpage>–<lpage>805</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22640817</pub-id></mixed-citation>
    </ref>
    <ref id="psp412467-bib-0008">
      <label>8</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0008"><string-name><surname>Bazzoli</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Retout</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Mentré</surname>, <given-names>F.</given-names></string-name>
<article-title>Design evaluation and optimisation in multiple response nonlinear mixed effect models: PFIM 3.0</article-title>. <source xml:lang="en">Comput. Methods Programs Biomed.</source>
<volume>98</volume>, <fpage>55</fpage>–<lpage>65</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">19892427</pub-id></mixed-citation>
    </ref>
    <ref id="psp412467-bib-0009">
      <label>9</label>
      <mixed-citation publication-type="miscellaneous" id="psp412467-cit-0009"><string-name><surname>Wickham</surname>, <given-names>H.</given-names></string-name><article-title>tidyverse: easily install and load the “Tidyverse”</article-title> &lt;<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=tidyverse">https://CRAN.R-project.org/package=tidyverse</ext-link>&gt; (<year>2017</year>).</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0010">
      <label>10</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0010"><string-name><surname>Lattice Nordhausen</surname>, <given-names>K.</given-names></string-name><article-title>Multivariate data visualization with R by Deepayan Sarkar</article-title>. <source xml:lang="en">Int. Stat. Rev.</source><fpage>440</fpage>(<year>2008</year>). <pub-id pub-id-type="doi">10.1111/j.1751-5823.2008.00062_5.x</pub-id>.</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0011">
      <label>11</label>
      <mixed-citation publication-type="book" id="psp412467-cit-0011"><collab collab-type="authors">R Core Team</collab>
. <source xml:lang="en">R: A Language and Environment for Statistical Computing</source> (<publisher-name>R Foundation for Statistical Computing</publisher-name>, <publisher-loc>Vienna, Austria</publisher-loc>, <year>2018</year>). <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link>
</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0012">
      <label>12</label>
      <mixed-citation publication-type="book" id="psp412467-cit-0012"><string-name><surname>Gentzsch</surname>, <given-names>W.</given-names></string-name><chapter-title>Sun Grid Engine: towards creating a compute power grid</chapter-title><source xml:lang="en">Proceedings First IEEE/ACM International Symposium on Cluster Computing and the Grid</source>. <pub-id pub-id-type="doi">10.1109/ccgrid.2001.923173</pub-id></mixed-citation>
    </ref>
    <ref id="psp412467-bib-0013">
      <label>13</label>
      <mixed-citation publication-type="miscellaneous" id="psp412467-cit-0013"><string-name><surname>Chang</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Cheng</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Allaire</surname>, <given-names>J.J.</given-names></string-name>, <string-name><surname>Xie</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>McPherson</surname>, <given-names>J.</given-names></string-name>
<article-title>shiny: web application framework for R</article-title> &lt;<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=shiny">https://CRAN.R-project.org/package=shiny</ext-link>&gt; (<year>2019</year>)</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0014">
      <label>14</label>
      <mixed-citation publication-type="miscellaneous" id="psp412467-cit-0014"><string-name><surname>Bache</surname>, <given-names>S.M.</given-names></string-name> &amp; <string-name><surname>Wickham</surname>, <given-names>H.</given-names></string-name>. <article-title>magrittr: a forward‐pipe operator for R </article-title>
<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=magrittr">https://CRAN.R-project.org/package=magrittr</ext-link>; (<year>2014</year>).</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0015">
      <label>15</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0015"><string-name><surname>Zane</surname>, <given-names>N.R.</given-names></string-name> &amp; <string-name><surname>Thakker</surname>, <given-names>D.R.</given-names></string-name>
<article-title>A physiologically based pharmacokinetic model for voriconazole disposition predicts intestinal first‐pass metabolism in children</article-title>. <source xml:lang="en">Clin. Pharmacokinet.</source>
<volume>53</volume>, <fpage>1171</fpage>–<lpage>1182</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">25245942</pub-id></mixed-citation>
    </ref>
    <ref id="psp412467-bib-0016">
      <label>16</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0016"><string-name><surname>Thompson</surname>, <given-names>M.D.</given-names></string-name> &amp; <string-name><surname>Beard</surname>, <given-names>D.A.</given-names></string-name>
<article-title>Development of appropriate equations for physiologically based pharmacokinetic modeling of permeability‐limited and flow‐limited transport</article-title>. <source xml:lang="en">J. Pharmacokinet Pharmacodyn.</source>
<volume>38</volume>, <fpage>405</fpage>–<lpage>421</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21584718</pub-id></mixed-citation>
    </ref>
    <ref id="psp412467-bib-0017">
      <label>17</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0017"><string-name><surname>Zhuang</surname>, <given-names>X.</given-names></string-name> &amp; <string-name><surname>Lu</surname>, <given-names>C.</given-names></string-name>
<article-title>PBPK modeling and simulation in drug research and development</article-title>. <source xml:lang="en">Acta Pharm. Sin B.</source>
<volume>6</volume>, <fpage>430</fpage>–<lpage>440</lpage> (<year>2016</year>).<pub-id pub-id-type="pmid">27909650</pub-id></mixed-citation>
    </ref>
    <ref id="psp412467-bib-0018">
      <label>18</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0018"><string-name><surname>Jones</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Rowland‐Yeo</surname>, <given-names>K.</given-names></string-name>
<article-title>Basic concepts in physiologically based pharmacokinetic modeling in drug discovery and development</article-title>. <source xml:lang="en">CPT Pharmacometrics Syst Pharmacol.</source>
<volume>2</volume>, <fpage>e63</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23945604</pub-id></mixed-citation>
    </ref>
    <ref id="psp412467-bib-0019">
      <label>19</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0019"><article-title>Basic anatomical and physiological data for use in radiological protection: reference values. A report of age‐ and gender‐related differences in the anatomical and physiological characteristics of reference individuals</article-title>. ICRP Publication 89. <source xml:lang="en">Ann. ICRP</source>. <volume>32</volume>, <fpage>5</fpage>–<lpage>265</lpage> (<year>2002</year>).<pub-id pub-id-type="pmid">14506981</pub-id></mixed-citation>
    </ref>
    <ref id="psp412467-bib-0020">
      <label>20</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0020"><string-name><surname>Poulin</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Theil</surname>, <given-names>F.‐P.</given-names></string-name>
<article-title>Prediction of pharmacokinetics prior to in vivo studies. 1. Mechanism‐based prediction of volume of distribution</article-title>. <source xml:lang="en">J. Pharm. Sci.</source>
<volume>91</volume>, <fpage>129</fpage>–<lpage>156</lpage> (<year>2002</year>).<pub-id pub-id-type="pmid">11782904</pub-id></mixed-citation>
    </ref>
    <ref id="psp412467-bib-0021">
      <label>21</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0021"><string-name><surname>Yanni</surname>, <given-names>S.B.</given-names></string-name>, <string-name><surname>Annaert</surname>, <given-names>P.P.</given-names></string-name>, <string-name><surname>Augustijns</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Ibrahim</surname>, <given-names>J.G.</given-names></string-name>, <string-name><surname>Benjamin</surname>, <given-names>D.K.</given-names><suffix>Jr</suffix></string-name> &amp; <string-name><surname>Thakker</surname>, <given-names>D.R.</given-names></string-name>
<article-title>In vitro hepatic metabolism explains higher clearance of voriconazole in children versus adults: role of CYP2C19 and flavin‐containing monooxygenase 3</article-title>. <source xml:lang="en">Drug Metab. Dispos.</source>
<volume>38</volume>, <fpage>25</fpage>–<lpage>31</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">19841059</pub-id></mixed-citation>
    </ref>
    <ref id="psp412467-bib-0022">
      <label>22</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0022"><string-name><surname>Soetaert</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Petzoldt</surname>, <given-names>T.</given-names></string-name>
<article-title>Inverse modelling, sensitivity and Monte Carlo analysis in R using package FME</article-title>. <source xml:lang="en">J. Stat. Softw.</source>
<volume>33</volume> (<year>2010</year>). <pub-id pub-id-type="doi">10.18637/jss.v033.i03</pub-id>.</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0023">
      <label>23</label>
      <mixed-citation publication-type="miscellaneous" id="psp412467-cit-0023"><string-name><surname>Iooss</surname>, <given-names>B.</given-names></string-name><italic>et al</italic><article-title>Sensitivity: global sensitivity analysis of model outputs</article-title> &lt;<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=sensitivity">https://CRAN.R-project.org/package=sensitivity</ext-link>&gt; (<year>2018</year>).</mixed-citation>
    </ref>
    <ref id="psp412467-bib-0024">
      <label>24</label>
      <mixed-citation publication-type="journal" id="psp412467-cit-0024"><string-name><surname>Kirouac</surname>, <given-names>D.C.</given-names></string-name><italic>et al</italic><article-title>Clinical responses to ERK inhibition in BRAFV600E‐mutant colorectal cancer predicted using a computational model</article-title>. <source xml:lang="en">NPJ Syst. Biol. Appl.</source><volume>3</volume>, <fpage>14</fpage> (<year>2017</year>).<pub-id pub-id-type="pmid">28649441</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
