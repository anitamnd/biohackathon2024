<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8088563</article-id>
    <article-id pub-id-type="publisher-id">7635</article-id>
    <article-id pub-id-type="doi">10.1186/s12864-021-07635-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Hierarchicell: an R-package for estimating power for tests of differential expression with single-cell data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2943-6612</contrib-id>
        <name>
          <surname>Zimmerman</surname>
          <given-names>Kip D.</given-names>
        </name>
        <address>
          <email>kdzimmer@wakehealth.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Langefeld</surname>
          <given-names>Carl D.</given-names>
        </name>
        <address>
          <email>clangefe@wakehealth.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Center for Precision Medicine, Wake Forest School of Medicine, Winston-Salem, NC USA </aff>
      <aff id="Aff2"><label>2</label>Department of Biostatistics and Data Science, Wake Forest School of Medicine, Winston-Salem, NC USA </aff>
      <aff id="Aff3"><label>3</label>Comprehensive Cancer Center, Wake Forest Baptist Medical Center, Winston-Salem, NC USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>319</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>4</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Study design is a critical aspect of any experiment, and sample size calculations for statistical power that are consistent with that study design are central to robust and reproducible results. However, the existing power calculators for tests of differential expression in single-cell RNA-seq data focus on the total number of cells and not the number of independent experimental units, the true unit of interest for power. Thus, current methods grossly overestimate the power.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2"><italic>Hierarchicell</italic> is the first single-cell power calculator to explicitly simulate and account for the hierarchical correlation structure (i.e., within sample correlation) that exists in single-cell RNA-seq data. <italic>Hierarchicell</italic>, an R-package available on GitHub, estimates the within sample correlation structure from real data to simulate hierarchical single-cell RNA-seq data and estimate power for tests of differential expression. This multi-stage approach models gene dropout rates, intra-individual dispersion, inter-individual variation, variable or fixed number of cells per individual, and the correlation among cells within an individual. Without modeling the within sample correlation structure and without properly accounting for the correlation in downstream analysis, we demonstrate that estimates of power are falsely inflated. <italic>Hierarchicell</italic> can be used to estimate power for binary and continuous phenotypes based on user-specified number of independent experimental units (e.g., individuals) and cells within the experimental unit.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3"><italic>Hierarchicell</italic> is a user-friendly R-package that provides accurate estimates of power for testing hypotheses of differential expression in single-cell RNA-seq data. This R-package represents an important addition to single-cell RNA analytic tools and will help researchers design experiments with appropriate and accurate power, increasing discovery and improving robustness and reproducibility.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12864-021-07635-w.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Hierarchical data</kwd>
      <kwd>Single-cell</kwd>
      <kwd>RNA-sequencing</kwd>
      <kwd>Power calculator</kwd>
      <kwd>Simulation</kwd>
      <kwd>R-package</kwd>
      <kwd>Mixed-effects models</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U01 NS036695</award-id>
        <principal-award-recipient>
          <name>
            <surname>Langefeld</surname>
            <given-names>Carl D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>The Center for Public Health Genomics</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Cancer Institute to the Comprehensive Cancer Center of WFBMC</institution>
        </funding-source>
        <award-id>P30CA012197</award-id>
        <principal-award-recipient>
          <name>
            <surname>Langefeld</surname>
            <given-names>Carl D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000005</institution-id>
            <institution>U.S. Department of Defense</institution>
          </institution-wrap>
        </funding-source>
        <award-id>W81XWH-20-1-0686</award-id>
        <principal-award-recipient>
          <name>
            <surname>Langefeld</surname>
            <given-names>Carl D.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par6">Robust and reproducible science depends on the quality of the experimental design. High quality experimental design revolves around focused research questions or hypotheses, appropriate and valid measures of the central variables related to these hypotheses, statistically sound analysis plans, and properly computed power analysis [<xref ref-type="bibr" rid="CR1">1</xref>]. While power analyses for genetic association studies and bulk RNA-seq approaches are well-established [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR6">6</xref>], such analyses remain a challenge in single-cell RNA-seq studies due to intra-sample correlation inherent in these data [<xref ref-type="bibr" rid="CR7">7</xref>]. Such within sample correlations exist because cells from the same individual share a common genetic and environmental background that often leads to greater similarity in gene expression among cells in the same sample. Therefore, gene expression measures among cells from the same sample have a hierarchical correlation structure where cells nested within an individual are not independent units. At present, the correlative (hierarchical) nature of these data is often neglected, in both power analyses and tests of hypotheses (e.g., differential expression) [<xref ref-type="bibr" rid="CR7">7</xref>]. This was recently highlighted in a valuable paper by Andrews et al. which states that “current single-cell differential expression tests treat each individual cell as a biological replicate and cannot account for shared genetic backgrounds or disease state”. [<xref ref-type="bibr" rid="CR8">8</xref>] Ignoring the hierarchal nature of single-cell RNA-seq data leads to studies that are under powered and inappropriately analyzed [<xref ref-type="bibr" rid="CR7">7</xref>], leading to incorrect inference, poor reproducibility, and financial investments in those errors. A contributor to these flawed practices is the void of single-cell specific methods and literature that properly account for this hierarchical structure. However, just as Andrews et al. pointed out, we – too - expect that, “as scRNA-seq is applied to larger cohorts and comparison studies, [there will be] further developments that lead to more accurate statistical models for more complex experimental designs.” An excellent starting place for more accurate statistical models are accurate power calculations for improved study design.</p>
    <p id="Par7">Besides the classic, closed form, normal theory power calculations (e.g., ANOVA) that make too many overly simplistic assumptions (e.g., normality, independence), the power calculators for testing single-cell RNA differential expression all simulate cells independently, without the within-subject correlation structure [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref>]. Previously, we documented that in tests of differential expression in single-cell RNA-seq data one needs to account for the within experimental unit (e.g., individual) and showed that mixed-effects models with subject/individual as a random effect is a practical and statistically sound approach for these hypotheses [<xref ref-type="bibr" rid="CR7">7</xref>]. Here, we present an R-package, <italic>Hierarchicell</italic>, with two purposes: 1) it is a simulator of hierarchical single-cell RNA-seq data, and 2) it computes power estimates using a mixed-effects models for testing hypotheses of differential gene expression in single-cell RNA-seq data. <italic>Hierarchicell</italic> simulates single-cell RNA-seq data with a hierarchical structure that closely resembles that of real data and can be used by researchers to make informed choices on experimental design while balancing the trade-off between cost and power. Our R-package is user friendly and flexible to a variety of scenarios. It incorporates estimates from real data [<xref ref-type="bibr" rid="CR12">12</xref>] or allows users to input data (e.g., either Fluidigm C1 or 10x Chromium technology, user’s own pilot data) to obtain highly translatable and accurate estimates of power tailored to their technology. Within a well-characterized set of parameters that are modeled from either a user-defined or the default single-cell RNA-seq data, the tool provides users with estimates of power relative to a given fold-change, significance threshold, number of independent samples, and number of cells per independent sample. In addition, the calculator allows for the simulation of either continuous or binary phenotypes of interest. For binary case-control analyses, the user specifies the fold-change they desire to detect. For continuous phenotypes, the user specifies the mean and standard deviation of the phenotype and the degree of correlation with expression the user desires to detect with significance. Currently, most single-cell power calculators only provide estimates for the required number of cells rather than the required number of independent experimental units (e.g. individuals) or are not designed for computing power to detect differences in expression [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref>]. Other power calculations for single-cell RNA-seq are based on bulk RNA-seq methods to estimate the required number of samples [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. Estimating power for a single-cell RNA-seq study using bulk RNA-seq power calculators is a reasonable solution, but will underestimate the study’s power by not incorporating the additional power gained by sequencing numerous cells per individual. This tool provides a valuable resource in an area of critical need for researchers looking to optimize their study’s power and experimental design relative to the hierarchical nature that exists in all single-cell data.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Overview of the <italic>Hierarchicell</italic> simulation engine</title>
      <p id="Par8">A step-by-step overview of the simulation procedure is provided with R-code examples and detailed explanations in <italic>Hierarchicell</italic>’s accompanying vignette. We encourage users to review this vignette (available on GitHub and in the <xref rid="MOESM1" ref-type="media">Supplementary Materials</xref>) before beginning to work with <italic>Hierarchicell</italic>. The single-cell data in that example are used to estimate default simulation parameters for our simulation engine. These data were downloaded from the public accession number E-MTAB-5061 [<xref ref-type="bibr" rid="CR12">12</xref>]. These data were sequenced using the Smart-Seq2 protocol and they include sequence data from 3514 cells from 10 different individuals [<xref ref-type="bibr" rid="CR12">12</xref>]. Genes were previously normalized to account for the differences in library size [<xref ref-type="bibr" rid="CR12">12</xref>]. After filtering down to high quality alpha cells, our dataset contained gene expression values for 22,983 genes and 886 cells (across 10 individuals). This dataset is included as part of the R-package for a number of reasons. Primarily, these data demonstrate the general intra- and inter-individual correlation patterns seen across a variety of single-cell data of different cell types generated by different platforms [<xref ref-type="bibr" rid="CR7">7</xref>]. In addition, these data are not too large, allowing for the rapid estimation of simulation parameters while also minimizing the size of the R-package.</p>
      <p id="Par9">The simulation procedure was designed to simulate independent genes in a way that approximates the hierarchical structure of real data by empirically estimating the range of parameters (i.e., grand mean of the transcript-per-million (TPM) values, within sample variance, between sample variance, relationship between the grand mean and dispersion, dropout) that define the observed distribution of TPM values for a gene. To estimate these parameters, genes were pruned to a set of uncorrelated genes that captured the most representative patterns of detectable TPM values, without the resulting parameter estimates being primarily driven by dropout. Specifically, genes were sequentially sampled one at a time and any other gene having transcript abundances correlated (Spearman’s correlation coefficient &gt; 0.25) with the gene were removed. To estimate the grand means independently from the hierarchical correlation structure, the grand means were estimated by sampling one cell from each individual and computing the mean TPM value 1000 times. The mean of each of those means was used to approximate the grand mean. To approximate the variance of the within-sample means (inter-individual variance), the means of all non-zero TPM values were computed across all cells within each individual and the variance between those values was subsequently computed. To estimate the within-sample dispersion values, the non-zero TPM values were first used to compute a within-sample variance and within-sample mean. Consistent with the classical definition of the Negative Binomial distribution’s dispersion parameter, the within-sample dispersion parameter was then computed as:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\alpha}_{ij}=\frac{{\mu_{ij}}^2}{\sigma_{ij}^2}-{\mu}_{ij} $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:msub><mml:mi>α</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="italic">ij</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi mathvariant="italic">ij</mml:mi></mml:msub></mml:math><graphic xlink:href="12864_2021_7635_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par10">where <italic>α</italic><sub><italic>ij</italic></sub> represents the dispersion parameter, <italic>μ</italic><sub><italic>ij</italic></sub> represents the within-sample mean, and <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_{ij}^2 $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi mathvariant="italic">ij</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7635_Article_IEq1.gif"/></alternatives></inline-formula> represents the within-sample variance for gene <italic>i</italic> and individual <italic>j</italic>. The grand means and variances were computed empirically from the TPM values previously reported in six different cell types across three different single-cell studies [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. Once consistent patterns were identified across cell types, alpha cells from the pancreas dataset, were used as the model data for our simulation. A gamma distribution was fit to the global mean of the TPM values of each gene using maximum-likelihood estimation. For each independently simulated gene <italic>i</italic>, a random value was sampled from this gamma distribution to obtain a grand mean, <italic>μ</italic><sub><italic>i</italic></sub>. The variance of the within-sample means (inter-individual variance) was modeled as a linear function of the grand means, <italic>f</italic><sub>1</sub>(<italic>μ</italic><sub><italic>i</italic></sub>) and the within-sample dispersion (intra-individual variance) was estimated as a logarithmic function of the within-sample means, <italic>f</italic><sub>2</sub>(<italic>μ</italic><sub><italic>i</italic></sub>), and the probability of dropout was estimated independently as a bounded gamma distribution (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Using a normal distribution with an expected value of zero and a variance computed by the first linear relationship, <italic>f</italic><sub>1</sub>(<italic>μ</italic><sub><italic>i</italic></sub>), a difference in means was drawn for each of the individuals <italic>j</italic> in the simulation. This difference was summed with the grand mean to obtain an individual mean, <italic>μ</italic><sub><italic>ij</italic></sub>. Three different methods were used to simulate the number of cells per individual. To simulate scenarios where each of the individuals had the exact same number of cells, the number of cells desired for each individual was fixed at a constant value. In order to simulate scenarios where the number of cells per individual demonstrated slight imbalance, a Poisson distribution with a λ equal to the expected number of cells desired for each individual was then used to obtain the count of cells for each individual. To simulate scenarios where the number of cells per individual demonstrated greater imbalance, the number of cells per individual were modeled as a Negative Binomial random variable with a mean equal to the expected number of cells and a dispersion parameter of one. For each gene <italic>i</italic> and cell <italic>k</italic> assigned to an individual <italic>j</italic>, a read count value, <italic>Y</italic><sub><italic>ijk</italic></sub>, was drawn from a Negative Binomial distribution with an expected value equal to the individual’s assigned read count value, <italic>μ</italic><sub><italic>ij</italic></sub>, and a dispersion parameter, <italic>α</italic><sub><italic>ij</italic></sub>, computed by the logarithmic function of the grand mean <italic>f</italic><sub>2</sub>(<italic>μ</italic><sub><italic>i</italic></sub>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the hierarchicell simulation engine. The simulation procedure begins by estimating parameters from input data (blue) and then combines that information with parameters specified by the user (yellow) to simulate an expression value, <italic>Y</italic><sub><italic>ijk</italic></sub>, for each gene <italic>i</italic>, individual <italic>j</italic>, and cell <italic>k</italic></p></caption><graphic xlink:href="12864_2021_7635_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Overview of <italic>Hierarchicell</italic> power calculations</title>
      <p id="Par11">To compute power, transcripts-per-million (TPM) values were simulated for each gene with the user-specified fold-change or ρ parameter (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Fold-change should be specified where users are interested in computing power for two distinct groups. The ρ parameter, which represents the degree of correlation between gene expression and a simulated continuous phenotype, should be specified where users are interested in computing power for association analysis with a continuous trait. Here, fold-change is a constant that was multiplied by the global mean gene expression values to spike the expression of those genes in the desired treatment group. The direction of the fold-change was simulated with a Bernoulli distribution with a probability of 0.5 to allow the direction of effect to vary equally between groups.</p>
      <p id="Par12">We applied a two-part hurdle model with a random effect for individual as directed in MAST’s reference manual (7,18). Specifically, a log(x + 1) transformation of the data was applied and the hurdle model computed to find genes exhibiting differences in expression. Using their same notation, the addition of random effects for differences among persons is as follows:
<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ logit\left(\Pr \left({Z}_{ig}=1|{X}_i\right)\right)={X}_i{\beta}_g+{W}_i{\gamma}_j $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mtext mathvariant="italic">logit</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mo>Pr</mml:mo><mml:mfenced close=")" open="(" separators="|"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi mathvariant="italic">ig</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><graphic xlink:href="12864_2021_7635_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \Pr \left({Y}_{ig}=y\right|{Z}_{ig}=1\Big)=N\left({X}_i{\beta}_g+{W}_i{\gamma}_j,{\sigma}_g^2\right) $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mo>Pr</mml:mo><mml:mfenced close="|" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi mathvariant="italic">ig</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:mfenced><mml:msub><mml:mi>Z</mml:mi><mml:mi mathvariant="italic">ig</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:math><graphic xlink:href="12864_2021_7635_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par13">where <italic>Y</italic><sub><italic>ig</italic></sub> is the expression level for gene <italic>g</italic> and cell <italic>i</italic>, <italic>Z</italic><sub><italic>ig</italic></sub> is an indicator for whether gene <italic>g</italic> is expressed in cell <italic>i</italic>, <italic>X</italic><sub><italic>i</italic></sub> contains the predictor variables for each cell <italic>i</italic>, and <italic>W</italic><sub><italic>i</italic></sub> is the design matrix for the random effects of each cell <italic>i</italic> belonging to each individual <italic>j</italic> (i.e., the random complement to the fixed <italic>X</italic><sub><italic>i</italic></sub>). β<sub><italic>g</italic></sub> represents the vector of fixed-effects regression coefficients and γ<sub><italic>j</italic></sub> represents the vector of random effects (i.e., the random complement to the fixed β<sub><italic>g</italic></sub>). γ<sub><italic>j</italic></sub> is distributed normally with a mean of zero and variance <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}_g^2 $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12864_2021_7635_Article_IEq2.gif"/></alternatives></inline-formula>. To obtain a single result for each gene, likelihood ratio or Wald test results from each of the two components are summed and the corresponding degrees of freedom for each component are added. These tests have asymptotic χ<sup>2</sup> null distributions; these statistics can be summed and remain asymptotically χ<sup>2</sup> because <italic>Z</italic><sub><italic>g</italic></sub> and <italic>Y</italic><sub><italic>g</italic></sub> are defined conditionally independent for each gene. When summed together, these tests provide a single test for the two-part hurdle model. Our package also offers the ability to compute type 1 error rates (and thereby power) for a variety of different single-cell analysis approaches. New methods that properly handle within sample correlation will be integrated as they become available.</p>
    </sec>
    <sec id="Sec5">
      <title>Software implementation</title>
      <p id="Par14">All simulations and data were compiled in RStudio using R-3.6.2 and is freely available on GitHub. The supplementing dataset that is included to run the R-package without user input data was significantly downsized by removing all of the genes correlated with a Spearman’s correlation coefficient &gt; 0.25. This filtering is one of the first steps in our simulation procedure and doing so greatly reduced the size of the source package to 475 KB as well as the data structures held in memory during use. Currently, the simulation typically completes in less than 5 seconds, depending on user specifications. The simulation-based power calculations, however, can take much longer depending on the model that is used. For the recommended two-part hurdle mixed model (MAST with a random effect for individual), this can range anywhere from 1 to 20 min per simulation-based estimate of power for a given fold-change on a 64-bit Operating system with 8 CPUs and 16 GB of RAM. We note that these run times are heavily dependent on the number of genes, the sample size, the number of cells per individual specified, and the number of CPUs available.</p>
    </sec>
  </sec>
  <sec id="Sec6">
    <title>Results and discussion</title>
    <p id="Par15">Previously, we demonstrated that our simulation recapitulates the most important aspects of single-cell gene expression data, particularly the hierarchical structure of single-cell RNA-seq data which is rarely accounted for in differential expression analysis [<xref ref-type="bibr" rid="CR7">7</xref>]. We also applied our simulation engine to demonstrate that mixed models are a statistically sound method that accounts for the within sample correlation and has appropriate type 1 error control without sacrificing power [<xref ref-type="bibr" rid="CR7">7</xref>]. In addition, we provided power estimates for binary outcomes across a range of experimental conditions to assist researchers in designing appropriately powered studies [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par16">We previously reported power calculations for tests of differential expression in single-cell RNA-seq studies for binary phenotypes (i.e., case/control treatment groups) [<xref ref-type="bibr" rid="CR7">7</xref>]. <italic>Hierarchicell</italic> now also allows users to estimate power for detecting associations between continuous traits and single-cell gene expression (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The simulated expression data can be computed over a range of correlations with the magnitude of expression in each individual’s cells, while accounting for the hierarchical structure of these data.
<fig id="Fig2"><label>Fig. 2</label><caption><p>tSNE plots of gene expression data simulated to correlate with a continuous variable. The continuous phenotype is simulated with normal with a mean of 22 and standard deviation of 5 and correlates at various levels with gene expression. In the top left panel, the correlation between gene expression and the simulated phenotype is 0.99. In the top right it is 0.67, on the bottom left it is 0.33, and on the bottom right it is 0.01</p></caption><graphic xlink:href="12864_2021_7635_Fig2_HTML" id="MO2"/></fig></p>
    <p id="Par17">As expected, increasing the number of independent experimental units (e.g., individuals) in a study is the best way to increase power to detect true differences between traits measured at the individual and not individual cell level (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). Power calculations for binary phenotypes consisting of 10 individuals per treatment group reveal that there are only marginal gains in power when more than 100 cells per individual are sampled for a particular analysis unit (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). We also note that methods that do not account for within person correlation grossly overestimate power. For example, when estimating power with an approach that estimates the power for cells as independent units (assuming a type 1 error rate of α = 0.05, a fold change of 1.3, 10 individuals per treatment and 100 cells per individual), the power is overestimated as 0.93 instead of 0.71 when appropriately accounting for the within person correlation. Power calculations for continuous phenotypes, with the same sample sizes and constant within-person correlations among cells, demonstrate even smaller gains in power when more than 100 cells per individual are sampled for a particular analysis unit (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). The gains in power from sampling more cells per individual will decrease as the numbers of independent experimental units increase (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). This is true for both types of analyses. As the degree of correlation among cells within a person decreases and approaches zero, rarely observed, the value tradeoff between independent experimental units and individual cells will vary. Further, we note that if the cell-type of interest has much more or much less zero-inflation (i.e., less information), then the gains in power from sampling more cells may be greater or smaller, respectively. This is why estimating the data structure of the cell types of interest from preliminary data is a critically important feature of our <italic>Hierarchicell</italic> package. To consistently identify fold-change differences of at least 1.2 as statistically significant (power &gt; 0.80), we approximate that researchers will need a minimum of 40 samples per group and 100 cells per sample in a classical case/control design. To consistently identify genes correlated with a correlation coefficient of 0.4 with a phenotype (power &gt; 0.80), we approximate that researchers will need a minimum of 100 samples and 100 cells per sample.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Power calculations using MAST with a random effect for individual. Power curves for various, but likely, single-cell scenarios using MAST with a random effect for individual. Power is computed at α = 0.05. Panel <bold>a</bold> demonstrates differences in power when sample sizes range between 5 individuals per group to 100 when the number of cells per individual is held constant at 250. Panel <bold>b</bold> demonstrates the differences in power when increasing the number of cells per individual (100, 250, 500, 1000) for 10 individuals per group. Panels <bold>c</bold> and <bold>d</bold> demonstrate the very minor differences in power by increasing the number of cells per individual (100, 250, 500, 1000) when testing for association with a continuous trait for 20 individuals and 100 individuals, respectively</p></caption><graphic xlink:href="12864_2021_7635_Fig3_HTML" id="MO3"/></fig></p>
    <p id="Par18">As experiments get larger, computational time will increase. Future work will parallelize the code. To more rapidly close in on plausible sample size options, a researcher can apply the aggregate (“pseudo-bulk) methods power estimates and as one approaches feasible design shift to refining the estimates using the two-part hurdle mixed model employed here. However, it is important to do this refining step given the differences between these two approaches and the types of scenarios where aggregation methods will be underpowered [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR18">18</xref>].</p>
    <p id="Par19">Future iterations of this package will incorporate any novel single-cell RNA-seq differential expression methods that properly account for the within sample correlation. In addition, we will parallelize the code and improve the speed of software by building components of the software in other languages (such as C++ via rcpp), and/or storing results of a large number of scenarios for quick and easy access to the necessary information. Future developments would be to incorporate the relationship between power and the variance explained by an effect, not simply fold-change between treatments. In real data, the variances explained by an effect fluctuate greatly among genes and cell types. While the simulated expression data herein have variances that are modeled after real data and are allowed to fluctuate by genes, simulating a direct relationship between the variance and an effect will be a meaningful addition to this work.</p>
  </sec>
  <sec id="Sec7">
    <title>Conclusions</title>
    <p id="Par20">To date, none of the primary power calculation methods are directly applicable for differential expression analysis with single-cell RNA-seq data. Here, we present an R-package, <italic>Hierarchicell</italic>, with two purposes: 1) simulation of hierarchical single-cell RNA-seq data, and 2) computation of power estimates using a mixed-effects models for testing hypotheses of differential gene expression in single-cell RNA-seq data. <italic>Hierarchicell</italic> allows for a range of inputs and parameter settings and even the evaluation of various single-cell specific methods, but encourages using linear mixed models with individual as a random effect for both binary and continuous outcomes, as implemented in MAST [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. We recommend these mixed effects models because they retain appropriate type 1 error rates while maintaining power. Proper calculation of statistical power coupled with proper analysis methods that account for the correlation among cells from the same individual will increase robustness and reproducibility of single-cell studies, thereby reducing the cost while accelerating the rate of scientific discovery.</p>
  </sec>
  <sec id="Sec8">
    <title>Availability and requirements</title>
    <p id="Par21">
      <list list-type="bullet">
        <list-item>
          <p id="Par22">Project name: hierarchicell</p>
        </list-item>
        <list-item>
          <p id="Par23">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/kdzimm/hierarchicell">https://github.com/kdzimm/hierarchicell</ext-link></p>
        </list-item>
        <list-item>
          <p id="Par24">Operating system(s): Linux, Mac, and PC</p>
        </list-item>
        <list-item>
          <p id="Par25">Programming language: R</p>
        </list-item>
        <list-item>
          <p id="Par26">Other requirements: No</p>
        </list-item>
        <list-item>
          <p id="Par27">License: CC0</p>
        </list-item>
        <list-item>
          <p id="Par28">Any restrictions to use by non-academics: No</p>
        </list-item>
      </list>
    </p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec9">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12864_2021_7635_MOESM1_ESM.pdf">
            <caption>
              <p>
                <bold>Additional file 1.</bold>
              </p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>RNA-Seq</term>
        <def>
          <p id="Par4">Sequencing technique which uses next-generation sequencing to reveal the presence and quantity of RNA</p>
        </def>
      </def-item>
      <def-item>
        <term>MAST</term>
        <def>
          <p id="Par5">Model-based Analysis of Single-cell Transcriptomics</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <p>Not applicable.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>CDL and KDZ conceived the study. KDZ constructed the R-package and implemented all simulations and analyses with guidance from CDL. KDZ wrote the original draft and reviewed and edited it with CDL. All authors approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by The Center for Public Health Genomics and grant U01 NS036695 (Co-PI Langefeld) from NIH, Department of Defense W81XWH-20-1-0686, and by the Cancer Center Support Grant from the National Cancer Institute to the Comprehensive Cancer Center of Wake Forest Baptist Medical Center (P30CA012197).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data used for the simulated data herein and in the long-form documentation (R vignette) are available under the accession number E-MTAB-5061 at <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-5061/">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-5061/</ext-link>. The R-package is freely available on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/kdzimm/hierarchicell">https://github.com/kdzimm/hierarchicell</ext-link> (DOI: 10.5281/zenodo.4608738).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par29">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par30">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par31">Authors declare no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nayak</surname>
            <given-names>BK</given-names>
          </name>
        </person-group>
        <article-title>Understanding the relevance of sample size calculation</article-title>
        <source>Indian J Ophthalmol</source>
        <year>2010</year>
        <volume>58</volume>
        <issue>6</issue>
        <fpage>469</fpage>
        <lpage>470</lpage>
        <pub-id pub-id-type="pmid">20952828</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C-I</given-names>
          </name>
          <name>
            <surname>Sheng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shyr</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNAseqPS: a web tool for estimating sample size and power for RNAseq experiment</article-title>
        <source>Cancer Inform</source>
        <year>2014</year>
        <volume>13</volume>
        <issue>Suppl 6</issue>
        <fpage>1</fpage>
        <lpage>5</lpage>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C-I</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sheng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Shyr</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RnaSeqSampleSize: real data based sample size estimation for RNA sequencing</article-title>
        <source>BMC Bioinformatics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>191</fpage>
        <pub-id pub-id-type="pmid">29843589</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Statistical power in genome-wide association studies and quantitative trait locus mapping</article-title>
        <source>Heredity</source>
        <year>2019</year>
        <volume>123</volume>
        <issue>3</issue>
        <fpage>287</fpage>
        <lpage>306</lpage>
        <pub-id pub-id-type="pmid">30858595</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hong</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>Sample size and statistical power calculation in genetic association studies</article-title>
        <source>Genomics Inf</source>
        <year>2012</year>
        <volume>10</volume>
        <issue>2</issue>
        <fpage>117</fpage>
        <lpage>122</lpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Abecasis</surname>
            <given-names>GR</given-names>
          </name>
        </person-group>
        <article-title>GAS Power Calculator: web-based power calculator for genetic association studies</article-title>
        <source>bioRxiv</source>
        <year>2017</year>
        <volume>17</volume>
        <fpage>164343</fpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zimmerman</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Espeland</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Langefeld</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A practical solution to pseudoreplication bias in single-cell studies</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>738</fpage>
        <pub-id pub-id-type="pmid">33531494</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Kiselev</surname>
            <given-names>VY</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Tutorial: guidelines for the computational analysis of single-cell RNA sequencing data</article-title>
        <source>Nat Protoc</source>
        <year>2021</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">33288955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baruzzo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Patuzzi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Di Camillo</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>SPARSim single cell: a count data simulator for scRNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>1468</fpage>
        <lpage>1475</lpage>
        <pub-id pub-id-type="pmid">31598633</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>WV</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>A statistical simulator scDesign for rational scRNA-seq experimental design</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>14</issue>
        <fpage>i41</fpage>
        <lpage>i50</lpage>
        <pub-id pub-id-type="pmid">31510652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Zappia L, Phipson B, Oshlack A. Splatter: simulation of single-cell RNA sequencing data. Genome Biol 2017;18(1). [cited 2019 Jan 23]. Available from: 10.1186/s13059-017-1305-0</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>Å</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eliasson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>E-M</given-names>
          </name>
          <name>
            <surname>Andréasson</surname>
            <given-names>A-C</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Picelli</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sabirsh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clausen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bjursell</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Kasper</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ämmälä</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Single-cell Transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>KI</given-names>
          </name>
          <name>
            <surname>Youn</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bolisetty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Palucka</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>George</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Calculating sample size for identifying cell subpopulation in single-cell RNA-seq experiments</article-title>
        <source>bioRxiv</source>
        <year>2019</year>
        <volume>18</volume>
        <fpage>706481</fpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>NE</given-names>
          </name>
        </person-group>
        <article-title>SCOPIT: sample size calculations for single-cell sequencing experiments</article-title>
        <source>BMC Bioinformatics</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>566</fpage>
        <pub-id pub-id-type="pmid">31718533</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vieth</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ziegenhain</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Parekh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Enard</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Hellmann</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>powsimR: power analysis for bulk and single cell RNA-seq experiments</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>21</issue>
        <fpage>3486</fpage>
        <lpage>3488</lpage>
        <pub-id pub-id-type="pmid">29036287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Izar</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prakadan</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wadsworth</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Treacy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Rotem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rodman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lian</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fallahi-Sichani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dutton-Regester</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Genshaft</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Ziegler</surname>
            <given-names>CGK</given-names>
          </name>
          <name>
            <surname>Kazer</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Gaillard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kolb</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Villani</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Johannessen</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Andreev</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>van Allen</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Bertagnolli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sorger</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Flaherty</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Frederick</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Jane-Valbuena</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Rozenblatt-Rosen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garraway</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <issue>6282</issue>
        <fpage>189</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="pmid">27124452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Courtois</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Sengupta</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Goh</surname>
            <given-names>JJL</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Chua</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Wee</surname>
            <given-names>LJK</given-names>
          </name>
          <name>
            <surname>Hillmer</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>IB</given-names>
          </name>
          <name>
            <surname>Robson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Prabhakar</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors</article-title>
        <source>Nat Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <issue>5</issue>
        <fpage>708</fpage>
        <lpage>718</lpage>
        <pub-id pub-id-type="pmid">28319088</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirrell</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Rademaker</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Lieber</surname>
            <given-names>RL</given-names>
          </name>
        </person-group>
        <article-title>Analysis of hierarchical biomechanical data structures using mixed-effects models</article-title>
        <source>J Biomech</source>
        <year>2018</year>
        <volume>69</volume>
        <fpage>34</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="pmid">29366561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Finak G, McDavid A, Yajima M, Deng J, Gersuk V, Shalek AK, et al. MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data. Genome Biol. 2015;16(1) Available from: <ext-link ext-link-type="uri" xlink:href="http://genomebiology.com/2015/16/1/278">http://genomebiology.com/2015/16/1/278</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
