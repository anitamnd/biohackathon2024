<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4784891</article-id>
    <article-id pub-id-type="pmid">26959370</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0149841</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-15-31306</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Diagnostic Medicine</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Pulmonary Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Pulmonary Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Radiology and Imaging</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Pulmonary Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Data Acquisition</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Physics</subject>
          <subj-group>
            <subject>Particle Physics</subject>
            <subj-group>
              <subject>Elementary Particles</subject>
              <subj-group>
                <subject>Photons</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Physiology</subject>
          <subj-group>
            <subject>Respiratory Physiology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Physiology</subject>
          <subj-group>
            <subject>Respiratory Physiology</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Neuroimaging</subject>
            <subj-group>
              <subject>Computed Axial Tomography</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Neuroscience</subject>
          <subj-group>
            <subject>Neuroimaging</subject>
            <subj-group>
              <subject>Computed Axial Tomography</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Diagnostic Medicine</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Tomography</subject>
              <subj-group>
                <subject>Computed Axial Tomography</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Tomography</subject>
              <subj-group>
                <subject>Computed Axial Tomography</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Radiology and Imaging</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Tomography</subject>
              <subj-group>
                <subject>Computed Axial Tomography</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Materials Science</subject>
          <subj-group>
            <subject>Material Properties</subject>
            <subj-group>
              <subject>Texture</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Soft Tissues</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Soft Tissues</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A Novel Prior- and Motion-Based Compressed Sensing Method for Small-Animal Respiratory Gated CT</article-title>
      <alt-title alt-title-type="running-head">Prior- and Motion-Based CS Method for Respiratory Gated CT</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Abascal</surname>
          <given-names>Juan F. P. J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Abella</surname>
          <given-names>Monica</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marinetto</surname>
          <given-names>Eugenio</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pascau</surname>
          <given-names>Javier</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Desco</surname>
          <given-names>Manuel</given-names>
        </name>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Departamento de Bioingeniería e Ingeniería Aeroespacial, Universidad Carlos III de Madrid, Madrid, Spain</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Instituto de Investigación Sanitaria Gregorio Marañón (IiSGM), Madrid, Spain</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Centro de Investigación en Red de Salud Mental (CIBERSAM), Madrid, Spain</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhang</surname>
          <given-names>Qinghui</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>North Shore Long Island Jewish Health System, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con" id="contrib001">
        <p>Conceived and designed the experiments: MA JA. Performed the experiments: JA MA. Analyzed the data: MA JA. Contributed reagents/materials/analysis tools: JA MA EM JP MD. Wrote the paper: JA MA EM JP MD.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>monica.abella@uc3m.es</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>3</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>11</volume>
    <issue>3</issue>
    <elocation-id>e0149841</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>1</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2016 Abascal et al</copyright-statement>
      <copyright-year>2016</copyright-year>
      <copyright-holder>Abascal et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="pone.0149841.pdf"/>
    <abstract>
      <p>Low-dose protocols for respiratory gating in cardiothoracic small-animal imaging lead to streak artifacts in the images reconstructed with a Feldkamp-Davis-Kress (FDK) method. We propose a novel prior- and motion-based reconstruction (PRIMOR) method, which improves prior-based reconstruction (PBR) by adding a penalty function that includes a model of motion. The prior image is generated as the average of all the respiratory gates, reconstructed with FDK. Motion between respiratory gates is estimated using a nonrigid registration method based on hierarchical B-splines. We compare PRIMOR with an equivalent PBR method without motion estimation using as reference the reconstruction of high dose data. From these data acquired with a micro-CT scanner, different scenarios were simulated by changing photon flux and number of projections. Methods were evaluated in terms of contrast-to-noise-ratio (CNR), mean square error (MSE), streak artefact indicator (SAI), solution error norm (SEN), and correction of respiratory motion. Also, to evaluate the effect of each method on lung studies quantification, we have computed the Jaccard similarity index of the mask obtained from segmenting each image as compared to those obtained from the high dose reconstruction. Both iterative methods greatly improved FDK reconstruction in all cases. PBR was prone to streak artifacts and presented blurring effects in bone and lung tissues when using both a low number of projections and low dose. Adopting PBR as a reference, PRIMOR increased CNR up to 33% and decreased MSE, SAI and SEN up to 20%, 4% and 13%, respectively. PRIMOR also presented better compensation for respiratory motion and higher Jaccard similarity index. In conclusion, the new method proposed for low-dose respiratory gating in small-animal scanners shows an improvement in image quality and allows a reduction of dose or a reduction of the number of projections between two and three times with respect to previous PBR approaches.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was funded by the Spanish Ministerio de Economía y Competitividad (<ext-link ext-link-type="uri" xlink:href="http://www.mineco.gob.es/">www.mineco.gob.es/</ext-link>) with projects IDI-20130301, TEC2013-47270-R, IPT-2012-0401-300000, RTC-2014-3028-1, and RD12/0042/0057. Also, the research leading to these results has received funding from the Innovative Medicines Initiative (<ext-link ext-link-type="uri" xlink:href="http://www.imi.europa.eu">www.imi.europa.eu</ext-link>) Joint Undertaking under grant agreement n°115337, resources of which are composed of financial contribution from the European Union's Seventh Framework Programme (FP7/2007-2013) and EFPIA companies' in kind contribution. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="10"/>
      <table-count count="2"/>
      <page-count count="20"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>All relevant data are available from the Zenodo database, under the DOI: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.15685">http://dx.doi.org/10.5281/zenodo.15685</ext-link>. MATLAB code for PBR and PRIMOR methods is available from the GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/HGGM-LIM/prior-motion-reconstruction-CT">https://github.com/HGGM-LIM/prior-motion-reconstruction-CT</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>All relevant data are available from the Zenodo database, under the DOI: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.15685">http://dx.doi.org/10.5281/zenodo.15685</ext-link>. MATLAB code for PBR and PRIMOR methods is available from the GitHub repository <ext-link ext-link-type="uri" xlink:href="https://github.com/HGGM-LIM/prior-motion-reconstruction-CT">https://github.com/HGGM-LIM/prior-motion-reconstruction-CT</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Respiratory gating helps to overcome the problem of breathing motion in cardiothoracic small-animal imaging. This may be relevant in several clinical situations. For instance: 1) when using the CT for attenuation correction in PET [<xref rid="pone.0149841.ref001" ref-type="bibr">1</xref>]; 2) when assessing the degree of infection in lung diseases as tuberculosis, which is generally based on the inspection of images to quantify the density and extension of nodules in the lung [<xref rid="pone.0149841.ref002" ref-type="bibr">2</xref>]; 3) when planning radiation therapy for treatment of tumors in chest and abdomen, in which movement due to normal breathing complicates tumor location [<xref rid="pone.0149841.ref003" ref-type="bibr">3</xref>,<xref rid="pone.0149841.ref004" ref-type="bibr">4</xref>]. We use the term gate to denote each different reconstructed image for different time points over the breathing cycle. One option to generate a gated study is to acquire multiple frames from every projection angle, each one corresponding to a different point over the breathing cycle, and to sort them out assigning each frame to the corresponding gate according to a respiratory signal [<xref rid="pone.0149841.ref005" ref-type="bibr">5</xref>]. To achieve good image quality for each respiratory phase with this approach, conventional reconstruction methods require more data than those actually acquired with a standard protocol for static images. As an example, top panel of <xref ref-type="fig" rid="pone.0149841.g001">Fig 1</xref> shows the effect of sorting data into four gates when using the dose of a standard static protocol: after assigning frames to different gates, few noisy and irregularly distributed projections (less than 8 frames/projection) are left for the reconstruction of each respiratory phase, leading to streak artifacts in the FDK reconstructed images. Bottom row in <xref ref-type="fig" rid="pone.0149841.g001">Fig 1</xref> shows the result for a high-dose protocol (four times more frames per projection angle, if reconstructing four respiratory gates).</p>
    <fig id="pone.0149841.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0149841.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Standard dose vs. versus high dose respiratory gated data.</title>
        <p>Top: FDK reconstructions of gated data with four time points over the breathing cycle (four gates) obtained with a standard protocol for static studies (360 views covering 360° with eight frames per projection angle). After assigning frames to different gates, few and irregularly distributed projections are left for the reconstruction of each respiratory phase. Bottom: FDK reconstructions of gated data obtained with ideal high-dose data comprising 32 frames per projection angle, which is four times the dose of the standard protocol.</p>
      </caption>
      <graphic xlink:href="pone.0149841.g001"/>
    </fig>
    <p>Since radiation can affect the immune system and modify other biological pathways, dose must be kept low, particularly in longitudinal studies [<xref rid="pone.0149841.ref006" ref-type="bibr">6</xref>]. Besides, the ultimate goal of these techniques is to be translated to the clinical field, where the ALARA principle ('As Low As Reasonably Achievable') holds for the patient radiation dose (<ext-link ext-link-type="uri" xlink:href="http://www.nrc.gov/reading-rm/basic-ref/glossary/alara.html">http://www.nrc.gov/reading-rm/basic-ref/glossary/alara.html</ext-link>).</p>
    <p>Compressed sensing enables accurate image reconstruction from few projections using convex optimization, provided that the image is sparse in a transformed domain [<xref rid="pone.0149841.ref007" ref-type="bibr">7</xref>,<xref rid="pone.0149841.ref008" ref-type="bibr">8</xref>,<xref rid="pone.0149841.ref009" ref-type="bibr">9</xref>,<xref rid="pone.0149841.ref010" ref-type="bibr">10</xref>,<xref rid="pone.0149841.ref011" ref-type="bibr">11</xref>]. Prior-based reconstruction (PBR) is widely used for CT since reconstructed images are highly sparse when subtracted from a prior image that, in the case of dynamic applications, can be obtained by averaging all the data.</p>
    <p>The most widely used PBR method is prior image constrained compressed sensing (PICCS), which has been widely tested in different applications [<xref rid="pone.0149841.ref012" ref-type="bibr">12</xref>,<xref rid="pone.0149841.ref013" ref-type="bibr">13</xref>,<xref rid="pone.0149841.ref014" ref-type="bibr">14</xref>,<xref rid="pone.0149841.ref015" ref-type="bibr">15</xref>,<xref rid="pone.0149841.ref016" ref-type="bibr">16</xref>]. The image gradient is the most commonly used transformed domain but, as we showed in a previous study, using a wavelet transform in the prior term instead of the gradient leads to better texture for PICCS [<xref rid="pone.0149841.ref016" ref-type="bibr">16</xref>]. This type of prior is free from artifacts but is blurred due to temporal averaging.</p>
    <p>Motion-based reconstruction obtains an even sparser transformed domain by reconstructing images using an estimation of motion between consecutive frames. This approach has been proposed for cardiac cine MRI [<xref rid="pone.0149841.ref017" ref-type="bibr">17</xref>,<xref rid="pone.0149841.ref018" ref-type="bibr">18</xref>,<xref rid="pone.0149841.ref019" ref-type="bibr">19</xref>].</p>
    <p>Few previous studies have combined prior-based reconstruction methods with registration in CT [<xref rid="pone.0149841.ref020" ref-type="bibr">20</xref>,<xref rid="pone.0149841.ref021" ref-type="bibr">21</xref>,<xref rid="pone.0149841.ref022" ref-type="bibr">22</xref>,<xref rid="pone.0149841.ref023" ref-type="bibr">23</xref>]. These works aimed to improve image quality in low dose acquisition using a previously acquired high-quality prior image not spatially registered with the data, thus requiring a registration step which was implemented by modifying the prior penalty term. However, these methods would not work for respiratory gating in small-animal CT because of two main reasons: first, there is no a high quality previous acquisition image; second, the prior is a blurred image made from averaging all gates.</p>
    <p>In this work, we propose a novel prior- and motion-based reconstruction (PRIMOR) method for respiratory gating in small-animal CT, which extends the PBR method in [<xref rid="pone.0149841.ref016" ref-type="bibr">16</xref>] by including a model of the motion between gates. A prior image is obtained as the average of all respiratory gates reconstructed with an FDK-based algorithm. Motion is estimated using a nonrigid registration method based on hierarchical B-splines. We compared PRIMOR and PBR on different simulated scenarios, created by changing the number of photons (dose) and the number of projections from a reference FDK reconstruction of high dose data previously acquired with a micro-CT scanner. In both cases the problem was solved using the Split Bregman approach, which is efficient for convex constrained optimization [<xref rid="pone.0149841.ref024" ref-type="bibr">24</xref>].</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <sec id="sec003">
      <title>Image Reconstruction</title>
      <sec id="sec004">
        <title>PBR</title>
        <p>Gated CT images can be accurately reconstructed from highly undersampled and noisy data using PBR methods, such as PICCS. These methods assume that each respiratory phase image <italic>u</italic><sub><italic>i</italic></sub> is sparse under the transformation Ψ, which accounts for spatial sparsity, and that there must be a prior image <inline-formula id="pone.0149841.e001"><alternatives><graphic xlink:href="pone.0149841.e001.jpg" id="pone.0149841.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>p</mml:mi><mml:mrow/></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> to ensure that the difference image obtained by subtraction of each gate from the prior, <inline-formula id="pone.0149841.e002"><alternatives><graphic xlink:href="pone.0149841.e002.jpg" id="pone.0149841.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>p</mml:mi><mml:mrow/></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, is sparse under the transformation Φ [<xref rid="pone.0149841.ref012" ref-type="bibr">12</xref>]. If <italic>f</italic><sub><italic>i</italic></sub> represents the data corresponding to the <italic>i-</italic>th gate image and <italic>F</italic> is the forward operator, PICCS solves the convex constrained optimization problem
<disp-formula id="pone.0149841.e003"><alternatives><graphic xlink:href="pone.0149841.e003.jpg" id="pone.0149841.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mi>u</mml:mi></mml:munder><mml:mi>β</mml:mi><mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>Ψ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>Φ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mspace width="1pt"/><mml:mtext>such</mml:mtext><mml:mspace width="1pt"/><mml:mtext>that</mml:mtext><mml:mspace width="1pt"/><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>≤</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>u</italic> represents the reconstructed gates and <italic>f</italic> represents the acquired data for all respiratory gates, i.e. <italic>u</italic> = [<italic>u</italic><sub>1</sub><sup>T</sup>,…,<italic>u</italic><sub>I</sub><sup>T</sup>]<sup>T</sup>, <italic>f</italic> = [<italic>f</italic><sub>1</sub><sup>T</sup>,…,<italic>f</italic><sub>I</sub><sup>T</sup>]<sup>T</sup>, <inline-formula id="pone.0149841.e004"><alternatives><graphic xlink:href="pone.0149841.e004.jpg" id="pone.0149841.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>p</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>p</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>I</italic> is the total number of respiratory phase bins, σ accounts for noise in the data, β weights the image penalty function and α weights the prior penalty function.</p>
        <p>In this work, we use an equivalent of <xref ref-type="disp-formula" rid="pone.0149841.e003">Eq (1)</xref> to recover only the image variation with respect to the prior for each gate, <italic>v</italic> = [<italic>v</italic><sub>1</sub><sup>T</sup>,…,<italic>v</italic><sub>I</sub><sup>T</sup>]<sup>T</sup>. Thus, we define the PBR method used in this work,
<disp-formula id="pone.0149841.e005"><alternatives><graphic xlink:href="pone.0149841.e005.jpg" id="pone.0149841.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mi>v</mml:mi></mml:munder><mml:mi>β</mml:mi><mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>Ψ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>Φ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mspace width="1pt"/><mml:mtext>such</mml:mtext><mml:mspace width="1pt"/><mml:mtext>that</mml:mtext><mml:mspace width="1pt"/><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>≤</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula></p>
        <p>The common choice for Ψ is the spatial discrete gradient that leads to TV, ‖∇<italic>u</italic>‖<sub>1</sub>, which filters out noise while preserving edges in the image. We adopt isotropic TV, <inline-formula id="pone.0149841.e006"><alternatives><graphic xlink:href="pone.0149841.e006.jpg" id="pone.0149841.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>∇</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mo>∇</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mi>u</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mo>∇</mml:mo><mml:mi>y</mml:mi></mml:msub><mml:mi>u</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>. For Φ we use the symlet wavelet transform [<xref rid="pone.0149841.ref025" ref-type="bibr">25</xref>] to impose sparsity on the image variation, which was previously found to provide a more natural texture than TV for the prior term [<xref rid="pone.0149841.ref016" ref-type="bibr">16</xref>].</p>
      </sec>
      <sec id="sec005">
        <title>PRIMOR method</title>
        <p>PRIMOR improves PBR by adding a penalty function that takes into account a previously computed model of motion. If <italic>T</italic> represents an operator that encodes the motion between consecutive gates, we define PRIMOR by including the term ‖<italic>T</italic>(<italic>u</italic><sub><italic>p</italic></sub> + <italic>v</italic>)‖<sub>1</sub> in PBR [<xref ref-type="disp-formula" rid="pone.0149841.e005">Eq (2)</xref>] with the weighting parameter γ
<disp-formula id="pone.0149841.e007"><alternatives><graphic xlink:href="pone.0149841.e007.jpg" id="pone.0149841.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mi>v</mml:mi></mml:munder><mml:mi>β</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>Ψ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo>Φ</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mspace width="1pt"/><mml:mtext>such</mml:mtext><mml:mspace width="1pt"/><mml:mtext>that</mml:mtext><mml:mspace width="1pt"/><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>≤</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula>
where the prior image <inline-formula id="pone.0149841.e008"><alternatives><graphic xlink:href="pone.0149841.e008.jpg" id="pone.0149841.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>u</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>p</mml:mi><mml:mrow/></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is defined as the average of all respiratory gates reconstructed with an FDK-based algorithm [<xref rid="pone.0149841.ref026" ref-type="bibr">26</xref>]. A sketch of the method is shown in <xref ref-type="fig" rid="pone.0149841.g002">Fig 2</xref>.</p>
        <fig id="pone.0149841.g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0149841.g002</object-id>
          <label>Fig 2</label>
          <caption>
            <title>Workflow of PRIMOR reconstruction.</title>
          </caption>
          <graphic xlink:href="pone.0149841.g002"/>
        </fig>
        <p>For the motion estimation, the temporal sparsity transformation <italic>T</italic> can be computed in terms of nonrigid registration between frames as
<disp-formula id="pone.0149841.e009"><alternatives><graphic xlink:href="pone.0149841.e009.jpg" id="pone.0149841.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:mi>T</mml:mi><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>…</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>I</mml:mi></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula></p>
        <p>We selected a free-form deformation (FFD), widely used in medical imaging, which models motion using a sparse mesh of control points based on hierarchical cubic B-splines [<xref rid="pone.0149841.ref027" ref-type="bibr">27</xref>,<xref rid="pone.0149841.ref028" ref-type="bibr">28</xref>]. The hierarchical approach enables robust multiresolution registration, which provides a sequence of meshes with an increasing number of control points. B-splines have interesting properties, such as positivity, symmetry, compact support and maximal order of approximation [<xref rid="pone.0149841.ref029" ref-type="bibr">29</xref>,<xref rid="pone.0149841.ref030" ref-type="bibr">30</xref>], and are therefore a natural choice for the representation of physiological movements [<xref rid="pone.0149841.ref027" ref-type="bibr">27</xref>].</p>
        <p>The nonrigid registration problem searches for the spatial transformation <italic>R</italic><sub><italic>i</italic></sub>:(x,y,z)→(x’,y’,z’), which relates the image domain at the <italic>i</italic><sub>th</sub>-gate <italic>u</italic><sub><italic>i</italic></sub> to the image domain at the previous gate <italic>u</italic><sub>i-1</sub>. This procedure requires interpolation to relate pixel intensity between images, with the result that <italic>R</italic><sub><italic>i</italic></sub>(u<sub>i-1</sub>) comprises both registration and interpolation. The nonrigid registration problem can be expressed as
<disp-formula id="pone.0149841.e010"><alternatives><graphic xlink:href="pone.0149841.e010.jpg" id="pone.0149841.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mspace width="1pt"/><mml:msubsup><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mi>ρ</mml:mi><mml:msub><mml:mtext>C</mml:mtext><mml:mrow><mml:mtext>smooth</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(5)</label></disp-formula>
where <italic>C</italic><sub>smooth</sub> is a smoothness penalty function, generally in the form of a thin plate of metal bending energy and ρ is a regularization parameter [<xref rid="pone.0149841.ref027" ref-type="bibr">27</xref>,<xref rid="pone.0149841.ref028" ref-type="bibr">28</xref>]. The FFD-based registration method was implemented using the software available in MATLAB Central (Dirk-Jan Kroon; B-spline grid, image and point based registration; 2012, retrieved from <ext-link ext-link-type="uri" xlink:href="http://www.mathworks.com/matlabcentral/fileexchange/20057-b-spline-grid-image-and-point-based-registration">http://www.mathworks.com/matlabcentral/fileexchange/20057-b-spline-grid-image-and-point-based-registration</ext-link>), which is based on the Quasi Newton L-BFGS optimization method. It required the selection of several parameters: the regularization parameter ρ that weights the penalty function, the number of grid points, and the number of refinement grids within the hierarchical approach. All results were computed with ρ = 10<sup>−4</sup> and three refinements, the finest being a uniform grid of 47x47 control points. These parameters were heuristically chosen: doing two and three refinements provided similarly good results while with only one refinement the grid was too coarse and led to larger registration errors; ρ values in the range from 10<sup>−3</sup> to 10<sup>−4</sup> led to optimum results while values larger than 10<sup>−2</sup> led to large registration errors.</p>
      </sec>
      <sec id="sec006">
        <title>Split Bregman formulation to solve PRIMOR and PBR problems</title>
        <p>We implemented PBR [<xref ref-type="disp-formula" rid="pone.0149841.e005">Eq (2)</xref>] and PRIMOR using the Split Bregman method, which efficiently handles L1-based constrained problems [<xref rid="pone.0149841.ref024" ref-type="bibr">24</xref>,<xref rid="pone.0149841.ref031" ref-type="bibr">31</xref>,<xref rid="pone.0149841.ref032" ref-type="bibr">32</xref>]. The Split Bregman formulation separates L2- and L1-norm functionals in such a way that they can be solved analytically in two alternating steps. Constraints are imposed using the Bregman iteration. The part including the L2-norm functionals results in a linear system that can be efficiently solved using iterative methods and the part with the L1-norm functionals is solved using shrinkage formulas. As PBR can be obtained from PRIMOR by making γ = 0, we develop the formulation for the general case of PRIMOR.</p>
        <p>To perform the split, we include the new variables <italic>d</italic><sub><italic>x</italic></sub>, <italic>d</italic><sub><italic>y</italic></sub>, <italic>w</italic>, and <italic>t</italic> and formulate a new problem that is equivalent to <xref ref-type="disp-formula" rid="pone.0149841.e007">Eq (3)</xref>
<disp-formula id="pone.0149841.e011"><alternatives><graphic xlink:href="pone.0149841.e011.jpg" id="pone.0149841.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1pt"/><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1pt"/><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mi>β</mml:mi><mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mi>w</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mi>t</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mspace width="1pt"/><mml:mtext>such</mml:mtext><mml:mspace width="1pt"/><mml:mtext>that</mml:mtext><mml:mspace width="1pt"/><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:msubsup><mml:mo>≤</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1pt"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi>y</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1pt"/><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mo>Φ</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1pt"/><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula></p>
        <p><xref ref-type="disp-formula" rid="pone.0149841.e011">Eq (6)</xref> is easily managed using an equivalent unconstrained optimization approach with constraints imposed by adding a Bregman iteration <italic>b</italic><sub><italic>i</italic></sub>. That is,
<disp-formula id="pone.0149841.e012"><alternatives><graphic xlink:href="pone.0149841.e012.jpg" id="pone.0149841.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1pt"/><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1pt"/><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mi>β</mml:mi><mml:mspace width="1pt"/><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mi>w</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mi>t</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>μ</mml:mi><mml:mtext>2</mml:mtext></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mtext>2</mml:mtext></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mi>λ</mml:mi><mml:mtext>2</mml:mtext></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi>y</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mtext>2</mml:mtext></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mo>Φ</mml:mo><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mtext>2</mml:mtext></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
where μ is a regularization parameter that weights the data fidelity term, λ is a regularization parameter that weights the terms imposing the constraints for the dummy variables, <italic>k</italic> is the iteration number and the Bregman iterations are updated as
<disp-formula id="pone.0149841.e013"><alternatives><graphic xlink:href="pone.0149841.e013.jpg" id="pone.0149841.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>k</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mmultiscripts><mml:mo>+</mml:mo><mml:mprescripts/><mml:mi>p</mml:mi><mml:none/></mml:mmultiscripts><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>k</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mmultiscripts><mml:mo>+</mml:mo><mml:mprescripts/><mml:mi>p</mml:mi><mml:none/></mml:mmultiscripts><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>k</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mo>Φ</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>k</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mmultiscripts><mml:mo>+</mml:mo><mml:mprescripts/><mml:mi>p</mml:mi><mml:none/></mml:mmultiscripts><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>f</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mmultiscripts><mml:mo>+</mml:mo><mml:mprescripts/><mml:mi>p</mml:mi><mml:none/></mml:mmultiscripts><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives><label>(8)</label></disp-formula></p>
        <p>Since the image variation <italic>v</italic> and the auxiliary variables <italic>w</italic>, <italic>d</italic><sub><italic>x</italic></sub>, <italic>d</italic><sub><italic>y</italic></sub>, and <italic>t</italic> are independent of each other, <xref ref-type="disp-formula" rid="pone.0149841.e012">Eq (7)</xref> can now be split into several equations (one for each variable) that are solved sequentially, as follows:
<disp-formula id="pone.0149841.e014"><alternatives><graphic xlink:href="pone.0149841.e014.jpg" id="pone.0149841.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mi>v</mml:mi></mml:munder><mml:mspace width="1pt"/><mml:mfrac><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>k</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>k</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mo>Φ</mml:mo><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mi>w</mml:mi></mml:msub></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munder><mml:mrow><mml:mo>=</mml:mo><mml:mtext>min</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mspace width="1pt"/><mml:mi>β</mml:mi><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>w</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mi>w</mml:mi></mml:munder><mml:mspace width="1pt"/><mml:mi>α</mml:mi><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mi>w</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>−</mml:mo><mml:mo>Φ</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mi>w</mml:mi></mml:msub></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow><mml:mi>t</mml:mi></mml:munder><mml:mspace width="1pt"/><mml:mi>γ</mml:mi><mml:msub><mml:mrow><mml:mo>‖</mml:mo><mml:mi>t</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:msubsup><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula></p>
        <p>Since the solution of <italic>v</italic> only involves L2-norm functionals, it can be obtained exactly as the solution of the linear system
<disp-formula id="pone.0149841.e015"><alternatives><graphic xlink:href="pone.0149841.e015.jpg" id="pone.0149841.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>K</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow/><mml:mi>k</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:msup><mml:mi>F</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>F</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>I</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>r</mml:mi><mml:mrow/><mml:mi>k</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>k</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>x</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>k</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mo>Φ</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula></p>
        <p>Note that <xref ref-type="disp-formula" rid="pone.0149841.e015">Eq (10)</xref> constitutes a very large-scale problem, where K = N×N and N is the number of pixels, yet it can be solved efficiently using a Krylov solver, such as the biconjugate gradient stabilized method, which involves only matrix-vector multiplications:
<disp-formula id="pone.0149841.e016"><alternatives><graphic xlink:href="pone.0149841.e016.jpg" id="pone.0149841.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mrow><mml:mi>μ</mml:mi><mml:msup><mml:mi>F</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></alternatives><label>(11)</label></disp-formula></p>
        <p>The auxiliary variables <italic>d</italic><sub><italic>x</italic></sub>, <italic>d</italic><sub><italic>y</italic></sub>, <italic>w</italic>, and <italic>t</italic> are solved analytically using shrinkage formulas, which are thresholding operations [<xref rid="pone.0149841.ref024" ref-type="bibr">24</xref>,<xref rid="pone.0149841.ref033" ref-type="bibr">33</xref>].</p>
        <disp-formula id="pone.0149841.e017">
          <alternatives>
            <graphic xlink:href="pone.0149841.e017.jpg" id="pone.0149841.e017g" mimetype="image" position="anchor" orientation="portrait"/>
            <mml:math id="M17">
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:msubsup>
                      <mml:mi>d</mml:mi>
                      <mml:mi>j</mml:mi>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>=</mml:mo>
                    <mml:mtext>max</mml:mtext>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mi>s</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:msup>
                        <mml:mo>−</mml:mo>
                        <mml:mspace width="1pt"/>
                        <mml:mfrac bevelled="true">
                          <mml:mi>β</mml:mi>
                          <mml:mi>λ</mml:mi>
                        </mml:mfrac>
                        <mml:mo>,</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>D</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>u</mml:mi>
                                  <mml:mi>p</mml:mi>
                                </mml:msub>
                                <mml:mo>+</mml:mo>
                                <mml:msup>
                                  <mml:mi>v</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>+</mml:mo>
                            <mml:msubsup>
                              <mml:mi>b</mml:mi>
                              <mml:mi>j</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mi>s</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msup>
                      <mml:mi>s</mml:mi>
                      <mml:mi>k</mml:mi>
                    </mml:msup>
                    <mml:mo>=</mml:mo>
                    <mml:msqrt>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>D</mml:mi>
                                  <mml:mi>x</mml:mi>
                                </mml:msub>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>u</mml:mi>
                                      <mml:mi>p</mml:mi>
                                    </mml:msub>
                                    <mml:mo>+</mml:mo>
                                    <mml:msup>
                                      <mml:mi>v</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>k</mml:mi>
                                        <mml:mo>+</mml:mo>
                                        <mml:mn>1</mml:mn>
                                      </mml:mrow>
                                    </mml:msup>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>b</mml:mi>
                                  <mml:mi>x</mml:mi>
                                  <mml:mi>k</mml:mi>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo>+</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>|</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>D</mml:mi>
                                  <mml:mi>y</mml:mi>
                                </mml:msub>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>u</mml:mi>
                                      <mml:mi>p</mml:mi>
                                    </mml:msub>
                                    <mml:mo>+</mml:mo>
                                    <mml:msup>
                                      <mml:mi>v</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>k</mml:mi>
                                        <mml:mo>+</mml:mo>
                                        <mml:mn>1</mml:mn>
                                      </mml:mrow>
                                    </mml:msup>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                                <mml:mo>+</mml:mo>
                                <mml:msubsup>
                                  <mml:mi>b</mml:mi>
                                  <mml:mi>y</mml:mi>
                                  <mml:mi>k</mml:mi>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mo>|</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:msqrt>
                    <mml:mo>,</mml:mo>
                    <mml:mi>j</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>y</mml:mi>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msup>
                      <mml:mi>w</mml:mi>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>=</mml:mo>
                    <mml:mtext>shrink</mml:mtext>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mo>Φ</mml:mo>
                        <mml:msup>
                          <mml:mi>v</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mi>b</mml:mi>
                          <mml:mi>w</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:msubsup>
                        <mml:mo>,</mml:mo>
                        <mml:mfrac bevelled="true">
                          <mml:mi>α</mml:mi>
                          <mml:mi>λ</mml:mi>
                        </mml:mfrac>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mtext>max</mml:mtext>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:mrow>
                            <mml:mo>Φ</mml:mo>
                            <mml:msup>
                              <mml:mi>v</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>+</mml:mo>
                            <mml:msubsup>
                              <mml:mi>b</mml:mi>
                              <mml:mi>w</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mi>α</mml:mi>
                        <mml:mo>/</mml:mo>
                        <mml:mi>λ</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mspace width="1pt"/>
                    <mml:mtext>sign</mml:mtext>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mo>Φ</mml:mo>
                        <mml:msup>
                          <mml:mi>v</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mi>b</mml:mi>
                          <mml:mi>w</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msup>
                      <mml:mi>t</mml:mi>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>=</mml:mo>
                    <mml:mtext>shrink</mml:mtext>
                    <mml:mrow>
                      <mml:mo>[</mml:mo>
                      <mml:mrow>
                        <mml:mi>T</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>u</mml:mi>
                              <mml:mi>p</mml:mi>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:msup>
                              <mml:mi>v</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mi>b</mml:mi>
                          <mml:mi>t</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:msubsup>
                        <mml:mo>,</mml:mo>
                        <mml:mfrac bevelled="true">
                          <mml:mi>γ</mml:mi>
                          <mml:mi>λ</mml:mi>
                        </mml:mfrac>
                      </mml:mrow>
                      <mml:mo>]</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mtext>       max</mml:mtext>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>u</mml:mi>
                                  <mml:mi>p</mml:mi>
                                </mml:msub>
                                <mml:mo>+</mml:mo>
                                <mml:msup>
                                  <mml:mi>v</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>+</mml:mo>
                            <mml:msubsup>
                              <mml:mi>b</mml:mi>
                              <mml:mi>t</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mfrac bevelled="true">
                          <mml:mi>γ</mml:mi>
                          <mml:mi>λ</mml:mi>
                        </mml:mfrac>
                        <mml:mo>,</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mspace width="1pt"/>
                    <mml:mtext>sign</mml:mtext>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>T</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>u</mml:mi>
                              <mml:mi>p</mml:mi>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:msup>
                              <mml:mi>v</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mi>b</mml:mi>
                          <mml:mi>t</mml:mi>
                          <mml:mi>k</mml:mi>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </alternatives>
          <label>(12)</label>
        </disp-formula>
      </sec>
      <sec id="sec007">
        <title>Regularization parameter selection</title>
        <p>Regularization parameters related to the Bregman iterations in the reconstruction method (μ and λ in [<xref ref-type="disp-formula" rid="pone.0149841.e012">Eq (7)</xref>]) were selected following suggestions from previous studies [<xref rid="pone.0149841.ref030" ref-type="bibr">30</xref>,<xref rid="pone.0149841.ref032" ref-type="bibr">32</xref>]. For μ≤4 the method converged to the same solution for different iteration numbers, which were selected as a number of iterations that yielded minimum mean-square error, considering the ideal high-dose image as the correct solution.</p>
        <p>The weighting parameters that control the relative degree of image variation sparsity and spatial and temporal image sparsity were heuristically determined as follows. For PBR [<xref ref-type="disp-formula" rid="pone.0149841.e005">Eq (2)</xref>], decreasing α while increasing β (α = 0.2, β = 0.8) results in a patchy-like pattern (due to the high weight of spatial-TV); increasing α while lowering β (α = 0.8, β = 0.2) results in noisy images (due to the low weight of spatial-TV and high weight of the prior). After testing some other intermediate values we decided to choose α = 0.4 and β = 0.2 as a compromise. For PRIMOR we used these same α and β values and verified the effect of γ. Very low γ values (γ = 0.01) led to results similar to those of PBR. Increasing γ imposes gates to be similar, which filters out noise considerably, but also blurs minor image details, as similarity between gates is too enforced. γ values in the range from 0.1 to 1 were a good compromise. We finally selected γ = 0.5 to avoid giving too much weight to temporal sparsity. <xref rid="pone.0149841.t001" ref-type="table">Table 1</xref> shows a summary of the parameter values used.</p>
        <table-wrap id="pone.0149841.t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0149841.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Regularization parameters selected for PBR and PRIMOR methods.</title>
          </caption>
          <alternatives>
            <graphic id="pone.0149841.t001g" xlink:href="pone.0149841.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left" rowspan="1" colspan="1"/>
                  <th align="left" rowspan="1" colspan="1">μ</th>
                  <th align="left" rowspan="1" colspan="1">λ</th>
                  <th align="left" rowspan="1" colspan="1">β</th>
                  <th align="left" rowspan="1" colspan="1">α</th>
                  <th align="left" rowspan="1" colspan="1">γ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>PBR</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.2</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.4</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">
                    <bold>PRIMOR</bold>
                  </td>
                  <td align="left" rowspan="1" colspan="1">2</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.2</td>
                  <td align="char" char="." rowspan="1" colspan="1">0.4</td>
                  <td align="left" rowspan="1" colspan="1">0.5</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
      </sec>
    </sec>
    <sec id="sec008">
      <title>Data Acquisition and Simulation</title>
      <p>Algorithms were evaluated using simulations from rodent data acquired in a real scanner. Real data were acquired with the CT subsystem of an ARGUS PET/CT (SEDECAL) scanner, which is a cone-beam micro-CT scanner based on a flat panel detector [<xref rid="pone.0149841.ref034" ref-type="bibr">34</xref>]. In this scanner, the standard protocol for static imaging acquires 8 frames per projection angle of 512×512 pixels (0.2 mm<sup>2</sup> pixel size) along 360 equispaced angular positions. Respiratory gated studies were carried out by arranging the data into four gates using software-based retrospective gating [<xref rid="pone.0149841.ref005" ref-type="bibr">5</xref>] and reconstructing each of the four gates with an FDK-based algorithm [<xref rid="pone.0149841.ref026" ref-type="bibr">26</xref>]. In order to keep image quality of each gate similar to that of the static image, we acquired another study using a “high dose protocol” with 32 projection images per view, resulting in a fourfold dose increase.</p>
      <p>Using the high dose protocol, we acquired rodent data (10-week-old adult female Wistar rats weighing 300 g and anesthetized with isoflurane). To reduce computational time, we selected a smaller field of view (350×350 pixels) and the central slice (extrapolation to 3D would be straightforward). We used this data set as a gold standard. Animals were handled according to the European Communities Council Directive (2010/63/EU) and national regulations (RD 53/2013) with the approval of the Animal Experimentation Ethics Committee of Hospital General Universitario Gregorio Marañón.</p>
      <p>In a real acquisition of a respiratory gated study with the ARGUS scanner, the dose (and the image noise) depends on the parameters of the x-ray source (amperage and voltage), the number of angular positions and the number of frames per angle. To generalize the effect of these parameters on the resulting image to any scanner, we define two figures: dose, given by the number of photons emitted by the x-ray source, and number of projections.</p>
      <p>We simulated seven different scenarios: low-dose scenarios, with 120 projections and reducing the number of photons emitted by the x-ray source (I<sub>0</sub> = 4.5×10<sup>4</sup>, I<sub>0</sub>/2, I<sub>0</sub>/4 and I<sub>0</sub>/6), and subsampled scenarios, by reducing the number of projections per gate (120, 80, 60 and 40 projections) for number of photons I<sub>0</sub>. I<sub>0</sub> was chosen so as to obtain a noise figure for the prior image similar to that of a real high-dose gate.</p>
      <p>Noise was added by modelling the measurements f<sub>i</sub> as independently distributed Poisson random variables:
<disp-formula id="pone.0149841.e018"><alternatives><graphic xlink:href="pone.0149841.e018.jpg" id="pone.0149841.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>~</mml:mo><mml:mi>P</mml:mi><mml:mi>o</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow/></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mtext>   with   </mml:mtext><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives><label>(13)</label></disp-formula>
where <italic>u</italic>(<italic>x</italic>,<italic>y</italic>,<italic>z</italic>) is the high-dose reconstruction, <italic>I</italic><sub>0</sub> is the number of photons emitted by the x-ray source, and M is the number of measured projections. Then, we simulated respiratory gating by randomly choosing a small number of projections from each gate, and classifying each projection as to pertaining to a specific respiratory phase.</p>
      <p>In order to generate statistical results, we generated five different noise realizations for each low dose scenario and five random selections of projection angles for each of the subsampled scenarios. <xref rid="pone.0149841.t002" ref-type="table">Table 2</xref> shows the 40 simulated data sets, where each scenario is defined by the dose (compared to the dose used in the protocol for static imaging) and the number of projections per gate.</p>
      <table-wrap id="pone.0149841.t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0149841.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Simulated data sets used for the evaluations.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0149841.t002g" xlink:href="pone.0149841.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Scenario</th>
                <th align="left" rowspan="1" colspan="1">Dose</th>
                <th align="left" rowspan="1" colspan="1"># projections per gate</th>
                <th align="left" rowspan="1" colspan="1"># noise realizations</th>
                <th align="left" rowspan="1" colspan="1"># random selection of projections cases</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">High dose protocol (gold standard)</td>
                <td align="left" rowspan="1" colspan="1">4I<sub>0</sub></td>
                <td align="left" rowspan="1" colspan="1">360</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Static protocol 1</td>
                <td align="left" rowspan="1" colspan="1">I<sub>0</sub></td>
                <td align="left" rowspan="1" colspan="1">120</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Static protocol 2</td>
                <td align="left" rowspan="1" colspan="1">I<sub>0</sub></td>
                <td align="left" rowspan="1" colspan="1">120</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Low-dose</td>
                <td align="left" rowspan="1" colspan="1">I<sub>0</sub>/2</td>
                <td align="left" rowspan="1" colspan="1">120</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Low-dose</td>
                <td align="left" rowspan="1" colspan="1">I<sub>0</sub>/4</td>
                <td align="left" rowspan="1" colspan="1">120</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Low-dose</td>
                <td align="left" rowspan="1" colspan="1">I<sub>0</sub>/6</td>
                <td align="left" rowspan="1" colspan="1">120</td>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Subsampled</td>
                <td align="left" rowspan="1" colspan="1">I<sub>0</sub></td>
                <td align="left" rowspan="1" colspan="1">80</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Subsampled</td>
                <td align="left" rowspan="1" colspan="1">I<sub>0</sub></td>
                <td align="left" rowspan="1" colspan="1">60</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Subsampled</td>
                <td align="left" rowspan="1" colspan="1">I<sub>0</sub></td>
                <td align="left" rowspan="1" colspan="1">40</td>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">5</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>Simulations were computed using the IRT code (J A Fessler, Image reconstruction toolbox [IRT], 2011, retrieved from &lt;<ext-link ext-link-type="uri" xlink:href="http://www.eecs.umich.edu/~fessler/code/index.html">http://www.eecs.umich.edu/~fessler/code/index.html</ext-link>&gt;).</p>
      <p>The prior image was obtained by adding all gates and applying a Gaussian filter with a window of 5 pixels and standard deviation of 3 (right panel of <xref ref-type="fig" rid="pone.0149841.g003">Fig 3</xref>).</p>
      <fig id="pone.0149841.g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0149841.g003</object-id>
        <label>Fig 3</label>
        <caption>
          <title>Axial view of respiratory gated data.</title>
          <p>Left: FDK reconstruction of gated ideal high-dose data for frame 1. Right: Prior image obtained with a filtered version of the FDK reconstruction of the average of the whole data set for a subsampled scenario (120 projections and number of photons I<sub>0</sub> = 4.5×10<sup>5</sup>).</p>
        </caption>
        <graphic xlink:href="pone.0149841.g003"/>
      </fig>
    </sec>
    <sec id="sec009">
      <title>Comparison of Methods and Analysis of Images</title>
      <sec id="sec010">
        <title>Analysis of the influence of dose and number of projections</title>
        <p>Data were reconstructed with PBR and PRIMOR. To evaluate the influence of dose and number of projections for each method, images were compared in terms of four metrics: 1) mean-square error (MSE) in bone; 2) contrast-to-noise ratio in lung (ROIs shown in <xref ref-type="fig" rid="pone.0149841.g004">Fig 4</xref>); 3) total variation of the difference between reconstructed images and the target; and 4) solution error norm (SEN). Five different realizations were created for each scenario, thus yielding a total of 40 data sets. To evaluate the statistical significance of the difference between PBR and PRIMOR we used a Mann-Whitney test, as it is more robust and avoids the assumption of normality in the data.</p>
        <fig id="pone.0149841.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0149841.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Masks used to measure contrast-to-noise ratio and MSE.</title>
            <p>Left: Masks used to measure contrast-to-noise ratio as the absolute difference between the yellow and green ROIs divided by the noise measured in the blue ROI. Middle: Masks to compute MSE in the lung area. Right: Masks to compute MSE in the bone area.</p>
          </caption>
          <graphic xlink:href="pone.0149841.g004"/>
        </fig>
        <p>We assessed the recovery of bone tissue by computing the MSE of a ROI in the bone area with respect to the same ROI in the reference high-dose image. Bone region was delimited by using a mask that comprises bone and some of the surrounding tissue in order to account for blurring artefacts. Noise was measured as the standard deviation in a circular ROI drawn in a homogeneous region within the heart. Contrast-to-noise ratio was assessed as the absolute difference between the HU in a lung nodule and the value in healthy lung tissue divided by the noise in the heart. All masks are shown in <xref ref-type="fig" rid="pone.0149841.g004">Fig 4</xref>.</p>
        <p>Artifacts were assessed by the streak artefact indicator (SAI), which measures the total variation of the difference between reconstructed images and the target. It has been previously used to measure artefacts in CT [<xref rid="pone.0149841.ref035" ref-type="bibr">35</xref>]. Convergence was assessed using the solution error norm, computed in the entire image and using high-dose image as a reference.</p>
        <p>Finally, image texture was evaluated by visual inspection. We provide videos of the reconstructed images for different scenarios, which help to appreciate the motion between different respiratory gates (videos can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/HGGM-LIM/prior-motion-reconstruction-CT">https://github.com/HGGM-LIM/prior-motion-reconstruction-CT</ext-link>).</p>
      </sec>
      <sec id="sec011">
        <title>Correction of respiratory motion</title>
        <p>Compensation for respiratory motion was assessed by drawing a profile across an area of soft tissue that presented large movement across respiratory gates and comparing with the same profile for high-dose FDK images.</p>
      </sec>
      <sec id="sec012">
        <title>Application study</title>
        <p>A possible clinical application would be to assess the degree of infection in lung diseases such as tuberculosis, which is generally based on the inspection of images to quantify the density and number of nodules in the lung.</p>
        <p>Since the nodules in tuberculosis have a similar contrast and shape than vessels in an axial slice, we considered vessels as a good surrogate of granulomas and performed the quantification on them. To this end, we used a previously available semiautomatic tool based on region growing for granuloma quantification in tuberculosis. With this tool, an expert segmented five small vessels in all the studies: high dose image (used as a reference) and FDK, PBR and PRIMOR images, for the different scenarios. We then computed the Jaccard similarity index of the masks obtained with the three methods, as compared to those obtained with the reference.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="sec013">
    <title>Results</title>
    <sec id="sec014">
      <title>Analysis of Influence of Dose and Number of Projections</title>
      <p><xref ref-type="fig" rid="pone.0149841.g005">Fig 5</xref> shows the results of PBR and PRIMOR for different noise levels and number of projections for respiratory phase three. For the best case scenario (120 projections and maximum number of photons I<sub>0</sub>) (first row in <xref ref-type="fig" rid="pone.0149841.g005">Fig 5</xref>), PBR leads to slightly blurred edges for bone and soft tissue and to a decrease in contrast within bone tissue, while PRIMOR is almost unaffected. When the number of projections decreases (second row in <xref ref-type="fig" rid="pone.0149841.g005">Fig 5</xref>), PBR leads to streak artefacts and to highly blurred edges for bone and soft tissue, while PRIMOR removes most of these artifacts. When the dose decreases (third row in <xref ref-type="fig" rid="pone.0149841.g005">Fig 5</xref>), PBR leads to noisier images, which affects both bone and soft tissue, and distort nodules in the lung, while PRIMOR is just affected by a slight blur in bone tissue. Overall, PRIMOR leads to improved images for all scenarios. Videos showing reconstructed images of the four respiratory gates for the different scenarios are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HGGM-LIM/prior-motion-reconstruction-CT">https://github.com/HGGM-LIM/prior-motion-reconstruction-CT</ext-link>.</p>
      <fig id="pone.0149841.g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0149841.g005</object-id>
        <label>Fig 5</label>
        <caption>
          <title>Images corresponding to different scenarios for respiratory phase three, reconstructed with PBR and PRIMOR algorithms.</title>
          <p>From top to bottom, each row represents a different scenario: 120 projections and dose corresponding to a maximum number of photons I<sub>0</sub> (subsampled scenario), 40 projections and I<sub>0</sub> (subsampled scenario), and 120 projections and number of photons I<sub>0</sub>/6 (low-dose scenario). Yellow arrows indicate where artifacts are more noticeable: an increase in streak artifacts (1), blurred edges for bone tissue (2), and blurred edges for soft tissue (3). Videos for these results showing images for all gates are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HGGM-LIM/prior-motion-reconstruction-CT">https://github.com/HGGM-LIM/prior-motion-reconstruction-CT</ext-link>.</p>
        </caption>
        <graphic xlink:href="pone.0149841.g005"/>
      </fig>
      <p><xref ref-type="fig" rid="pone.0149841.g006">Fig 6</xref> shows the MSE in the bone area and the contrast-to-noise ratio in the lung area for all the different scenarios. Both iterative methods greatly improve FDK reconstruction in all cases. For all subsampled scenarios PRIMOR provided significantly better contrast recovery and less MSE than PBR (p&lt;0.01). Compared with PBR, PRIMOR obtained similar values of MSE for half number of projections and better CNR for one third of the projections. When lowering the dose, PRIMOR also produced significantly better contrast recovery and less MSE than PBR (p&lt;0.01) for all cases except for the case of lowest dose (I<sub>0</sub>/6), in which PRIMOR presents lower MSE but is not statistically significant. Overall, PRIMOR yielded similar values of MSE and CNR than PBR for a two to threefold reduction in dose or number of projections.</p>
      <fig id="pone.0149841.g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0149841.g006</object-id>
        <label>Fig 6</label>
        <caption>
          <title>Mean-square error in the bone area (top) and contrast-to-noise ratio inside the lungs (bottom) in the images reconstructed with FDK, PBR and PRIMOR for the different scenarios.</title>
          <p>Mean and SD of five noise realizations are provided for each scenario. The left panels show different numbers of projections (40, 60, 80 and 120 projections) for a dose corresponding to a number of photons I<sub>0</sub> = 4.5×10<sup>4</sup>; the right panel represents the different dose values (I<sub>0</sub>, I<sub>0</sub>/2, I<sub>0</sub>/4 and I<sub>0</sub>/6) for 120 projections.</p>
        </caption>
        <graphic xlink:href="pone.0149841.g006"/>
      </fig>
      <p><xref ref-type="fig" rid="pone.0149841.g007">Fig 7</xref> shows the SAI, computed as total variation of the difference between reconstructed images and the target. For different number of projections, PRIMOR presented significantly lower SAI than PBR (p&lt;0.01). For different dose values, PRIMOR also presented lower SAI than PBR, statistically significant in all cases (p&lt;0.05) except for the case of lowest dose (I<sub>0</sub>/6). The effect of dose was less noticeable than that of number of projections. In all cases both PBR and PRIMOR led to much lower SAI than FDK.</p>
      <fig id="pone.0149841.g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0149841.g007</object-id>
        <label>Fig 7</label>
        <caption>
          <title>SAI computed as total variation of the difference between reconstructed images and the target for different number of projections (left) and number of photons (right).</title>
          <p>Graphs show mean values and standard errors.</p>
        </caption>
        <graphic xlink:href="pone.0149841.g007"/>
      </fig>
      <p><xref ref-type="fig" rid="pone.0149841.g008">Fig 8</xref> shows relative MSE vs. iteration number obtained by PBR and PRIMOR methods for the different scenarios. PRIMOR presented lower error in all cases, where differences were most significant for low dose. Regarding convergence, PRIMOR generally converged at higher iteration number but with lower error than PBR.</p>
      <fig id="pone.0149841.g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0149841.g008</object-id>
        <label>Fig 8</label>
        <caption>
          <title>Convergence of PBR and PRIMOR algorithms for different scenarios.</title>
          <p>Relative MSE vs. the iteration number given by both PBR and PRIMOR methods for the static imaging protocol (I<sub>0</sub> = 4.5×10<sup>4</sup>, 120 projections per phase), a decrease in dose (I<sub>0</sub>/6, 120 projections) and decrease in the number of projections (I<sub>0</sub>, 40 projections).</p>
        </caption>
        <graphic xlink:href="pone.0149841.g008"/>
      </fig>
    </sec>
    <sec id="sec015">
      <title>Analysis of Compensation for Respiratory Motion</title>
      <p><xref ref-type="fig" rid="pone.0149841.g009">Fig 9</xref> shows a profile along a line containing soft tissue that presented large motion for the ideal high-dose FDK and for FDK, PBR and PRIMOR reconstructions of respiratory gates 1 and 3 using 120 projections and a number of photons I<sub>0</sub> = 4.5×10<sup>4</sup>. The profiles reveal the presence of respiratory movement for the two respiratory gates. Although both PBR and PRIMOR can improve FDK reconstruction by correcting the movement artifact between the different gates, profiles on PRIMOR reconstructions are more similar to those of the high dose FDK. This is confirmed by the videos mentioned in <xref ref-type="fig" rid="pone.0149841.g005">Fig 5</xref>, which show how PBR is able to correct the motion artefact, recovering the difference between gates, but it is more severely affected by noise and other artefacts than PRIMOR.</p>
      <fig id="pone.0149841.g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0149841.g009</object-id>
        <label>Fig 9</label>
        <caption>
          <title>Respiratory motion correction.</title>
          <p>Normalized profile along the yellow line in the top figure for ideal high-dose FDK (4I<sub>0</sub> and 360 projections) and for a subsampled scenario (120 projections and I<sub>0</sub>) reconstructed with FDK (left) and with PBR and PRIMOR corresponding to respiratory gates 1 and 3. Green arrows show where differences between PBR and PRIMOR are more noticable.</p>
        </caption>
        <graphic xlink:href="pone.0149841.g009"/>
      </fig>
    </sec>
    <sec id="sec016">
      <title>Application Study</title>
      <p>Lowering the dose led to a substantial decrease in Jaccard similarity index for FDK, while PBR and PRIMOR were less affected. PRIMOR led to higher similarity index than PBR in all cases (<xref ref-type="fig" rid="pone.0149841.g010">Fig 10a and 10b</xref>). Decreasing the number of projections showed a similar effect when using FDK, while it did not affect PBR and PRIMOR. <xref ref-type="fig" rid="pone.0149841.g010">Fig 10c</xref> shows an example of the segmented mask on the high dose image (used as the reference) and masks obtained from PBR and PRIMOR reconstructions for the best case scenario (120 projections and I<sub>0</sub>) and worst case scenario (120 projections and I<sub>0</sub>/6). At lower dose, the segmentation from PBR is clearly worse than the segmentation from PRIMOR, due to the presence of artefacts.</p>
      <fig id="pone.0149841.g010" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0149841.g010</object-id>
        <label>Fig 10</label>
        <caption>
          <title>Assessment of the influence of the different scenarios and reconstruction methods on the segmentation of lung tissue.</title>
          <p>Jaccard index for different dose (a) and number of projections (b) when using FDK, PBR and PRIMOR methods. C) Example of the segmented masks from high dose image and PBR and PRIMOR methods for the best (120 projections and I<sub>0</sub>) and worst case scenarios (120 projections and I<sub>0</sub>/6).</p>
        </caption>
        <graphic xlink:href="pone.0149841.g010"/>
      </fig>
    </sec>
    <sec id="sec017">
      <title>Computation Time</title>
      <p>The code was implemented in MATLAB and run on a Linux machine with 16 CPU of 64-bit and 2.3 GHz and with 16 GB RAM. We used a straightforward parallelization of PRIMOR over the four gates to reduce computation times. Motion estimation took 1.9 min. The reconstruction step took 90 s per iteration, out of which 81 s were employed for solving the linear system and 7 s for the Bregman iteration. As the linear system does not need to be solved with high precision, a tolerance of 10<sup>−2</sup> was sufficient and provided the same solution as 10<sup>−4</sup>, which took 145 s. The total computation time was 200 min for 98 iterations for the best case scenario (120 projections and I<sub>0</sub>) and 81 min for 55 iterations for the worst case scenario (120 projections and I<sub>0</sub>/6).</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec018">
    <title>Discussion</title>
    <p>Commercial scanners use traditional FDK for image reconstruction, but it results in severe artifacts when reconstructing respiratory-gated CT data using standard dose. To ensure a sufficient number of projections per gate, a dose four times higher may be needed (for four gates). An alternative is to use a PBR method which has been shown to reduce artefacts when there are insufficient numbers of projections. We propose PRIMOR, a novel PBR and motion-based compressed sensing method for reducing the radiation dose in CT respiratory gating.</p>
    <p>We compared PRIMOR with FDK and PBR, an analogous prior-based method with no estimation of motion, in scenarios corresponding to different dose levels and numbers of projections. PRIMOR produced better results in all scenarios by reducing streak artifacts, reducing noise, and improving image quality in terms of MSE and contrast-to-noise ratio. Adopting PBR as a reference, PRIMOR increased CNR in up to 33% and decreased MSE, streak artifact indicator and solution error norm in up to 20%, 4% and 13%, respectively. PRIMOR also presented better compensation for respiratory motion and more accurate segmentation of lung tissue.</p>
    <p>Few methodologies have previously addressed the lack of projections in respiratory and cardiac gated micro CT. Some methods are based on filling the missing data by using a prior image built from the data. This is the case of the least-error sorting technique [<xref rid="pone.0149841.ref035" ref-type="bibr">35</xref>], which ensures that all angular positions are filled, and the method presented in [<xref rid="pone.0149841.ref036" ref-type="bibr">36</xref>], which fills the missing regions in the Fourier domain. McKinnon-Bates method also used the average of all respiratory gates to construct the prior image [<xref rid="pone.0149841.ref037" ref-type="bibr">37</xref>,<xref rid="pone.0149841.ref038" ref-type="bibr">38</xref>]. However, methods based on compressed sensing show improved results with respect to these previous methods. In a chest phantom, PICCS outperformed both FDK with McKinnon-Bates correction and spatial TV [<xref rid="pone.0149841.ref039" ref-type="bibr">39</xref>]. In a previous study we showed that the use of the wavelet transform in the prior term instead of the gradient commonly used in PICCS led to a more natural texture in the image [<xref rid="pone.0149841.ref016" ref-type="bibr">16</xref>].</p>
    <p>The exploitation of temporal sparsity based on spatiotemporal total variation reconstruction yielded better results than McKinnon-Bates and low dose phase-correlated reconstruction on a mouse phantom [<xref rid="pone.0149841.ref040" ref-type="bibr">40</xref>]. A variation of the previous method, weighted spatiotemporal TV, improved results based on a spatial adaptive weighting function that assigns larger weight to regions without motion. This technique enabled the reconstruction of retrospective cone beam micro-CT data using only between 55 and 95 projections per angle [<xref rid="pone.0149841.ref041" ref-type="bibr">41</xref>]. Comparing our method to PICCS and spatiotemporal TV, PRIMOR is an extension of these two methods, as it combines PICCS with motion based reconstruction methods, which is an improvement with respect to spatiotemporal TV as it accounts for motion between consecutive gates. PICCS assumes that the difference between the different gates and the prior image (the mean of all gates) is sparse. PRIMOR provides a sparser transform by modelling the differences between gates. As PRIMOR combines both PBR and motion-based methods, it achieves the benefits of both methods. On the one hand, the prior image helps to maintain the image texture while on the other hand a sparser transform restricts the solution space, which results in a reduction of artefacts. Regarding the weighted spatiotemporal TV method [<xref rid="pone.0149841.ref041" ref-type="bibr">41</xref>], it is possible to incorporate this strategy into the PRIMOR method by including a similar spatial adaptive weight function, perhaps further improving results.</p>
    <p>As for motion estimation, we used a free-form deformation method based on hierarchical B-splines [<xref rid="pone.0149841.ref027" ref-type="bibr">27</xref>]. B-splines provide a smooth natural choice for representation of physiological movements, and the hierarchical approach enables robust registration. These properties have made this registration approach to be widely used in medical imaging. We found the algorithm very easy to use by controlling the smoothness with the number of control points and the registration error with a thresholding parameter. Previous motion-based reconstruction methods in magnetic resonance imaging have found phase-based motion estimation to be better than previously used block-matching and optical flow methods [<xref rid="pone.0149841.ref017" ref-type="bibr">17</xref>]. Other possible nonrigid registration algorithms are Kanade algorithm or Demons registration algorithm [<xref rid="pone.0149841.ref042" ref-type="bibr">42</xref>,<xref rid="pone.0149841.ref043" ref-type="bibr">43</xref>], which are based on optical flow methods. While we have shown that PRIMOR gains by including a model of motion within the reconstruction algorithm, we will not expect further improvements by using other nonrigid registration algorithms. However, this is limited to our data sets and further work would be required to better understand the differences between motion estimation methods for low-dose CT.</p>
    <p>Few previous studies have combined prior-based reconstruction methods with registration in CT [<xref rid="pone.0149841.ref020" ref-type="bibr">20</xref>,<xref rid="pone.0149841.ref023" ref-type="bibr">23</xref>]. These works aimed to improve image quality in low dose acquisition using a previously acquired high quality prior image which is not registered with the data, so a registration step was included by modifying the prior penalty term. There are two substantial differences with our work: first, we are considering the case in which we do not have a high quality previous acquisition image; second, the built prior is a blurred image made from averaging all un-gated data. Thus, in our work, instead of modifying the prior penalty term, we include in the cost function a new penalty term that takes into account motion between consecutive gates, considering that there would be little difference among them.</p>
    <p>The present study is subject to several limitations. Although we evaluated the methods at different dose levels and with different numbers of projections, further validation with experimentally acquired data is required. Nevertheless, major differences are not expected. Another limitation is that results shown were obtained for a set of user-determined parameters values. Parameter selection was required for the registration algorithm, the Split Bregman method, and the Gaussian smoothing of the prior image. We confirmed that similar results were obtained when varying these parameters within a range. The regularization parameter weighting the penalty function in the registration step was found to yield similar results for a wide range of values. The parameters μ and λ weighting the Bregman iteration terms were chosen following the suggestions from previous studies [<xref rid="pone.0149841.ref024" ref-type="bibr">24</xref>,<xref rid="pone.0149841.ref032" ref-type="bibr">32</xref>]. Goldstein and Osher [<xref rid="pone.0149841.ref024" ref-type="bibr">24</xref>] proved that the final outcome is independent of these parameters as long as they are sufficiently small. Low values ensure that noise is removed in the first iterations, finer scales of the image are recovered sequentially from coarser to finer as the iteration number increases, and noise is recovered the last. Abascal <italic>et al</italic>. [<xref rid="pone.0149841.ref032" ref-type="bibr">32</xref>] showed that, in practice, one can initially select small values for these parameters to ensure convergence and then increase μ (weighting of the data fidelity term) to achieve faster convergence. The most important parameter is the number of iterations, as one must stop before fitting the noise. In this work we have selected a number of iterations that led to the minimum solution error, in order to compare the best possible solution obtained by both PBR and PRIMOR methods. In practice, it may be convenient to select a small μ value that leads to slow convergence, and the solution will be similar for a wide range of number of iterations, as previously reported [<xref rid="pone.0149841.ref019" ref-type="bibr">19</xref>]. The parameters α and β, which control the relative degree of sparsity, were also heuristically chosen to provide best results for PBR. We used these values for PRIMOR and then verified the effect of γ. Higher γ values (higher weight to temporal sparsity) improved image texture. Conversely, very large values may lead to miss minor image details from specific gates, as similarity between gates is enforced. Our trade-off was to choose a relatively small γ, to make sure results were not biased. As future work, finding an optimum γ value may further enhance results with respect to PBR.</p>
    <p>Besides, further improvements could be made to the proposed method. For instance, Ramani and Fessler [<xref rid="pone.0149841.ref044" ref-type="bibr">44</xref>] included statistical data modeling, which improved convergence. Furthermore, we used a prior image based on the average of data for all phase bins, although other priors, such as a running average, could yield better results [<xref rid="pone.0149841.ref013" ref-type="bibr">13</xref>].</p>
    <p>Regarding the execution time, the most computationally expensive parts of the algorithm are the projection and backprojection operators. In this work, these operations were computed using the IRT code (J A Fessler, Image reconstruction toolbox [IRT], 2011, retrieved from &lt;<ext-link ext-link-type="uri" xlink:href="http://www.eecs.umich.edu/~fessler/code/index.html">http://www.eecs.umich.edu/~fessler/code/index.html</ext-link>&gt;). The projection of one slice (350×350) using IRT code took 1.8 s. We are working on a GPU implementation where the projection of a volume (350<sup>3</sup>) takes 0.95 s, thus supporting the idea that with this implementation the algorithm is suitable for practical applications.</p>
    <p>In conclusion, we propose PRIMOR, a novel method for the reconstruction of low-dose CT data with respiratory gating, which improves previous PBR methods by including a new penalty based on the model of motion between consecutive respiratory gates. The proposed method shows an improvement in image quality and allows a reduction of dose or number of projections of two to three times with respect to previous PBR approaches.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0149841.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Sureshbabu</surname><given-names>W</given-names></name>, <name><surname>Mawlawi</surname><given-names>O</given-names></name> (<year>2005</year>) <article-title>PET/CT Imaging Artifacts</article-title>. <source>J Nucl Med Technol</source>
<volume>33</volume>: <fpage>156</fpage>–<lpage>161</lpage>. <?supplied-pmid 16145223?><pub-id pub-id-type="pmid">16145223</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Jeong</surname><given-names>Y</given-names></name>, <name><surname>Lee</surname><given-names>K</given-names></name> (<year>2008</year>) <article-title>Pulmonary Tuberculosis: Up-to-Date Imaging and Management</article-title>. <source>AM J Roentgenol</source>
<volume>191</volume>: <fpage>834</fpage>–<lpage>844</lpage>.<pub-id pub-id-type="pmid">18716117</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Q</given-names></name>, <name><surname>Pevsner</surname><given-names>A</given-names></name>, <name><surname>Hertanto</surname><given-names>A</given-names></name>, <name><surname>Hu</surname><given-names>YC</given-names></name>, <name><surname>Rosenzweig</surname><given-names>KE</given-names></name>, <name><surname>Ling</surname><given-names>CC</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>A patient-specific respiratory model of anatomical motion for radiation treatment planning</article-title>. <source>Med Phys</source>
<volume>34</volume>: <fpage>4772</fpage>–<lpage>4781</lpage>. <?supplied-pmid 18196805?><pub-id pub-id-type="pmid">18196805</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>Q</given-names></name>, <name><surname>Hu</surname><given-names>YC</given-names></name>, <name><surname>Liu</surname><given-names>F</given-names></name>, <name><surname>Goodman</surname><given-names>K</given-names></name>, <name><surname>Rosenzweig</surname><given-names>KE</given-names></name>, <name><surname>Mageras</surname><given-names>GS</given-names></name> (<year>2010</year>) <article-title>Correction of motion artifacts in cone-beam CT using a patient-specific respiratory motion model</article-title>. <source>Med Phys</source>
<volume>37</volume>: <fpage>2901</fpage>–<lpage>2909</lpage>. <?supplied-pmid 20632601?><pub-id pub-id-type="pmid">20632601</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Chavarrías</surname><given-names>C</given-names></name>, <name><surname>Vaquero</surname><given-names>JJ</given-names></name>, <name><surname>Sisniega</surname><given-names>A</given-names></name>, <name><surname>Rodríguez-Ruano</surname><given-names>A</given-names></name>, <name><surname>Soto-Montenegro</surname><given-names>ML</given-names></name>, <name><surname>García-Barreno</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Extraction of the respiratory signal from small-animal CT projections for a retrospective gating method</article-title>. <source>Phys Med Biol</source>
<volume>53</volume>: <fpage>4683</fpage>–<lpage>4695</lpage>. <pub-id pub-id-type="doi">10.1088/0031-9155/53/17/015</pub-id>
<?supplied-pmid 18695300?><pub-id pub-id-type="pmid">18695300</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Boone</surname><given-names>JM</given-names></name>, <name><surname>Velazquez</surname><given-names>O</given-names></name>, <name><surname>Cherry</surname><given-names>SR</given-names></name> (<year>2004</year>) <article-title>Small-animal X-ray dose from micro-CT</article-title>. <source>Mol Imaging</source>
<volume>3</volume>: <fpage>149</fpage>–<lpage>158</lpage>. <?supplied-pmid 15530250?><pub-id pub-id-type="pmid">15530250</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Candès</surname><given-names>EJ</given-names></name>, <name><surname>Romberg</surname><given-names>J</given-names></name> (<year>2005</year>) <article-title>Signal recovery from random projections</article-title>. <source>Proc SPIE, Computational Imaging III</source>
<volume>5914</volume>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Candès</surname><given-names>EJ</given-names></name>, <name><surname>Romberg</surname><given-names>J</given-names></name>, <name><surname>Tao</surname><given-names>T</given-names></name> (<year>2006</year>) <article-title>Robust uncertainty principles: exact signal reconstruction from highly incomplete frequency information</article-title>. <source>IEEE Trans Inf Theory</source>
<volume>52</volume>: <fpage>489</fpage>–<lpage>509</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Candès</surname><given-names>EJ</given-names></name>, <name><surname>Romberg</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>Sparsity and incoherence in compressive sampling</article-title>. <source>Inverse Problems</source>
<volume>23</volume>: <fpage>969</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Bruckstein</surname><given-names>AM</given-names></name>, <name><surname>Donoho</surname><given-names>DL</given-names></name>, <name><surname>Elad</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>From Sparse Solutions of Systems of Equations to Sparse Modeling of Signals and Images SIAM</article-title>
<source>J Appl Math</source>
<volume>51</volume>: <fpage>34</fpage>–<lpage>81</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Pan</surname><given-names>X</given-names></name>, <name><surname>Sidky</surname><given-names>EY</given-names></name>, <name><surname>Vannier</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Why do commercial CT scanners still employ traditional, filtered back-projection for image reconstruction</article-title>. <source>Inverse Probl</source>
<volume>25</volume>: <fpage>123009</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>GH</given-names></name>, <name><surname>Tang</surname><given-names>J</given-names></name>, <name><surname>Leng</surname><given-names>S</given-names></name> (<year>2008</year>) <article-title>Prior image constrained compressed sensing (PICCS): A method to accurately reconstruct dynamic CT images from highly undersampled projection data sets</article-title>. <source>Med Phys</source>
<volume>35</volume>: <fpage>660</fpage>–<lpage>663</lpage>. <?supplied-pmid 18383687?><pub-id pub-id-type="pmid">18383687</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Nett</surname><given-names>BE</given-names></name>, <name><surname>Brauweiler</surname><given-names>R</given-names></name>, <name><surname>Kalender</surname><given-names>W</given-names></name>, <name><surname>Rowley</surname><given-names>H</given-names></name>, <name><surname>Chen</surname><given-names>GH</given-names></name> (<year>2010</year>) <article-title>Perfusion measurements by micro-CT using prior image constrained compressed sensing (PICCS): initial phantom results</article-title>. <source>Phys Med Biol</source>
<volume>55</volume>: <fpage>2333</fpage>–<lpage>2350</lpage>. <pub-id pub-id-type="doi">10.1088/0031-9155/55/8/014</pub-id>
<?supplied-pmid 20360635?><pub-id pub-id-type="pmid">20360635</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>J</given-names></name>, <name><surname>Hsieh</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>GH</given-names></name> (<year>2010</year>) <article-title>Temporal resolution improvement in cardiac CT using PICCS (TRI-PICCS): performance studies</article-title>. <source>Med Phys.</source>, <volume>37</volume>(<issue>8</issue>):<fpage>4377</fpage>–<lpage>88</lpage>. Med Phys 37: 4377–4388. <?supplied-pmid 20879597?><pub-id pub-id-type="pmid">20879597</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Leng</surname><given-names>S</given-names></name>, <name><surname>Tang</surname><given-names>J</given-names></name>, <name><surname>Zambelli</surname><given-names>J</given-names></name><name><surname>N</surname><given-names>B</given-names></name>, <name><surname>Tolakanahalli</surname><given-names>R</given-names></name>, <name><surname>Chen</surname><given-names>GH</given-names></name> (<year>2008</year>) <article-title>High temporal resolution and streak-free four-dimensional cone-beam computed tomography</article-title>. <source>Phys Med Biol</source>
<volume>53</volume>: <fpage>5653</fpage>–<lpage>5673</lpage>. <pub-id pub-id-type="doi">10.1088/0031-9155/53/20/006</pub-id>
<?supplied-pmid 18812650?><pub-id pub-id-type="pmid">18812650</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Abascal</surname><given-names>J</given-names></name>, <name><surname>Abella</surname><given-names>M</given-names></name>, <name><surname>Sisniega</surname><given-names>A</given-names></name>, <name><surname>Vaquero</surname><given-names>J</given-names></name>, <name><surname>Desco</surname><given-names>M</given-names></name> (<year>2015</year>) <article-title>Investigation of different sparsity transforms for the PICCS algorithm in small-animal respiratory gated CT</article-title>. <source>Plos One</source>
<volume>10</volume>: <fpage>e0120140</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0120140</pub-id>
<?supplied-pmid 25836670?><pub-id pub-id-type="pmid">25836670</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Asif</surname><given-names>MS</given-names></name>, <name><surname>Hamilton</surname><given-names>L</given-names></name>, <name><surname>Brummer</surname><given-names>M</given-names></name>, <name><surname>Romberg</surname><given-names>J</given-names></name> (<year>2012</year>) <article-title>Motion-Adaptive Spatio-Temporal Regularization (MASTeR) for Accelerated Dynamic MRI</article-title>. <source>MRM</source>
<volume>70</volume>: <fpage>800</fpage>–<lpage>812</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.24524</pub-id>
<?supplied-pmid 23132400?><pub-id pub-id-type="pmid">23132400</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Abascal</surname><given-names>JFPJ</given-names></name>, <name><surname>Montesinos</surname><given-names>P</given-names></name>, <name><surname>Marinetto</surname><given-names>E</given-names></name>, <name><surname>Pascau</surname><given-names>J</given-names></name>, <name><surname>Vaquero</surname><given-names>JJ</given-names></name>, <name><surname>Desco</surname><given-names>M</given-names></name> (<year>2014</year>) <article-title>A prior-based image variation (PRIVA) approach applied to motion-based Compressed sensing cardiac cine MRI</article-title>. <source>IFMBE proceedings</source>: <fpage>233</fpage>–<lpage>236</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Abascal</surname><given-names>J</given-names></name>, <name><surname>Montesinos</surname><given-names>P</given-names></name>, <name><surname>Marinetto</surname><given-names>E</given-names></name>, <name><surname>Pascau</surname><given-names>J</given-names></name>, <name><surname>Desco</surname><given-names>M</given-names></name> (<year>2014</year>) <article-title>Comparison of total variation with a motion estimation based compressed sensing approach for self-gated cardiac cine MRI in small animal studies</article-title>. <source>Plos One</source>
<volume>9</volume>: <fpage>e110594</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0110594</pub-id>
<?supplied-pmid 25350290?><pub-id pub-id-type="pmid">25350290</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Nett</surname><given-names>B</given-names></name>, <name><surname>Tang</surname><given-names>J</given-names></name>, <name><surname>Aagaard-Kienitz</surname><given-names>B</given-names></name>, <name><surname>Rowley</surname><given-names>H</given-names></name>, <name><surname>Chen</surname><given-names>G-H</given-names></name> (<year>2009</year>) <article-title>Low radiation dose C-arm cone-beam CT based on prior image constrained compressed sensing (PICCS): including compensation for image volume mismatch between multiple data acquisitions</article-title>. <source>Proc SPIE</source>
<volume>7258</volume>: <fpage>725803</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Heußer</surname><given-names>T</given-names></name>, <name><surname>Brehm</surname><given-names>M</given-names></name>, <name><surname>Ritschl</surname><given-names>L</given-names></name>, <name><surname>Sawall</surname><given-names>S</given-names></name>, <name><surname>Kachelrieß</surname><given-names>M</given-names></name> (<year>2014</year>) <article-title>Prior-based artifact correction (PBAC) in computed tomography</article-title>. <source>Medical Physics</source>
<volume>14</volume>: <fpage>021906</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Dang</surname><given-names>H</given-names></name>, <name><surname>Wang</surname><given-names>A</given-names></name>, <name><surname>Sussman</surname><given-names>M</given-names></name>, <name><surname>Siewerdsen</surname><given-names>J</given-names></name>, <name><surname>Stayman</surname><given-names>J</given-names></name> (<year>2014</year>) <article-title>dPIRPLE: a joint estimation framework for deformable registration and penalized-likelihood CT image reconstruction using prior images</article-title>. <source>Phys Med Biol</source>
<volume>59</volume>: <fpage>4799</fpage>–<lpage>4826</lpage>. <pub-id pub-id-type="doi">10.1088/0031-9155/59/17/4799</pub-id>
<?supplied-pmid 25097144?><pub-id pub-id-type="pmid">25097144</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Stayman</surname><given-names>JW</given-names></name>, <name><surname>Zbijewski</surname><given-names>W</given-names></name>, <name><surname>Otake</surname><given-names>Y</given-names></name>, <name><surname>Uneri</surname><given-names>A</given-names></name>, <name><surname>Schafer</surname><given-names>S</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Penalized-likelihood reconstruction for sparse data acquisitions with unregistered prior images and compressed sensing penalties</article-title>. <source>Proc Physics of Medical Imaging, SPIE Medical Imaging</source>
<volume>7961</volume>: <fpage>79611L</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Goldstein</surname><given-names>T</given-names></name>, <name><surname>Osher</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>The Split Bregman Method for L1 Regularized Problems</article-title>. <source>SIAM Journal on Imaging Sciences</source>
<volume>2</volume>: <fpage>323</fpage>–<lpage>343</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Buckheit JB, Chen S, Donoho DL, Johnstone IM, Scargle JD (1995) WaveLab. Reference Manual.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Abella</surname><given-names>M</given-names></name>, <name><surname>Vaquero</surname><given-names>JJ</given-names></name>, <name><surname>Sisniega</surname><given-names>A</given-names></name>, <name><surname>Pascau</surname><given-names>J</given-names></name>, <name><surname>Udías</surname><given-names>A</given-names></name>, <name><surname>García</surname><given-names>V</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Software Architecture for Multi-Bed FDK-based Reconstruction in X-ray CT Scanners</article-title>. <source>Comput Methods Programs Biomed</source>
<volume>107</volume>: <fpage>218</fpage>–<lpage>232</lpage>. <pub-id pub-id-type="doi">10.1016/j.cmpb.2011.06.008</pub-id>
<?supplied-pmid 21908068?><pub-id pub-id-type="pmid">21908068</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Rueckert</surname><given-names>D</given-names></name>, <name><surname>Sonoda</surname><given-names>LI</given-names></name>, <name><surname>Hayes</surname><given-names>C</given-names></name>, <name><surname>Hill</surname><given-names>DLG</given-names></name>, <name><surname>Leach</surname><given-names>MO</given-names></name>, <name><surname>Hawkes</surname><given-names>DJ</given-names></name> (<year>1999</year>) <article-title>Nonrigid registration using free-form deformations: application to breast MR images</article-title>. <source>IEEE Trans Med Imaging</source>
<volume>18</volume>: <fpage>712</fpage>–<lpage>721</lpage>. <?supplied-pmid 10534053?><pub-id pub-id-type="pmid">10534053</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Hill</surname><given-names>DL</given-names></name>, <name><surname>Batchelor</surname><given-names>PG</given-names></name>, <name><surname>M</surname><given-names>H</given-names></name>, <name><surname>Hawkes</surname><given-names>DJ</given-names></name> (<year>2001</year>) <article-title>Medical image registration</article-title>. <source>Phys Med Biol</source>
<volume>46</volume>: <fpage>R1</fpage>–<lpage>45</lpage>. <?supplied-pmid 11277237?><pub-id pub-id-type="pmid">11277237</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Blu</surname><given-names>T</given-names></name>, <name><surname>Thevenaz</surname><given-names>P</given-names></name>, <name><surname>Unser</surname><given-names>M</given-names></name> (<year>2001</year>) <article-title>MOMS: maximal-order interpolation of minimal support</article-title>. <source>IEEE Trans Image Process</source>
<volume>10</volume>: <fpage>1069</fpage>–<lpage>1080</lpage>. <pub-id pub-id-type="doi">10.1109/83.931101</pub-id>
<?supplied-pmid 18249680?><pub-id pub-id-type="pmid">18249680</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Blu</surname><given-names>T</given-names></name>, <name><surname>Thevenaz</surname><given-names>P</given-names></name>, <name><surname>Unser</surname><given-names>M</given-names></name> (<year>2003</year>) <article-title>Complete parameterization of piecewise-polynomial interpolation kernels</article-title>. <source>IEEE Trans Image Process</source>
<volume>12</volume>: <fpage>1297</fpage>–<lpage>1309</lpage>. <pub-id pub-id-type="doi">10.1109/TIP.2003.818018</pub-id>
<?supplied-pmid 18244689?><pub-id pub-id-type="pmid">18244689</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Osher</surname><given-names>S</given-names></name>, <name><surname>Burger</surname><given-names>M</given-names></name>, <name><surname>Goldfarb</surname><given-names>D</given-names></name>, <name><surname>Xu</surname><given-names>J</given-names></name>, <name><surname>Yin</surname><given-names>W</given-names></name> (<year>2005</year>) <article-title>An iterative regularization method for total variation-based image restoration</article-title>. <source>SIAM J Multiscale Model Simul</source>
<volume>4</volume>: <fpage>460</fpage>–<lpage>489</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Abascal</surname><given-names>J</given-names></name>, <name><surname>Chamorro-Servent</surname><given-names>J</given-names></name>, <name><surname>Aguirre</surname><given-names>J</given-names></name>, <name><surname>Arridge</surname><given-names>S</given-names></name>, <name><surname>Correia</surname><given-names>T</given-names></name>, <name><surname>Ripoll</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Fluorescence diffuse optical tomography using the split Bregman method</article-title>. <source>Med Phys</source>
<volume>38</volume>: <fpage>6275</fpage>–<lpage>6284</lpage>. <pub-id pub-id-type="doi">10.1118/1.3656063</pub-id>
<?supplied-pmid 22047393?><pub-id pub-id-type="pmid">22047393</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Yin</surname><given-names>W</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2008</year>) <article-title>A new alternating minimization algorithm for total variation image reconstruction</article-title>. <source>SIAM J Imaging Sci</source>
<volume>1</volume>: <fpage>248</fpage>–<lpage>272</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Vaquero</surname><given-names>JJ</given-names></name>, <name><surname>Redondo</surname><given-names>S</given-names></name>, <name><surname>Lage</surname><given-names>E</given-names></name>, <name><surname>Abella</surname><given-names>M</given-names></name>, <name><surname>Sisniega</surname><given-names>A</given-names></name>, <name><surname>Tapias</surname><given-names>G</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Assessment of a New High-Performance Small- Animal X-ray Tomograph</article-title>. <source>IEEE Trans Nucl Sci</source>
<volume>55</volume>: <fpage>898</fpage>–<lpage>905</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Ford</surname><given-names>NL</given-names></name>, <name><surname>Jeklin</surname><given-names>A</given-names></name>, <name><surname>Yip</surname><given-names>K</given-names></name>, <name><surname>Yohan</surname><given-names>D</given-names></name>, <name><surname>Holdsworth</surname><given-names>DW</given-names></name>, <name><surname>Drangova</surname><given-names>M</given-names></name> (<year>2014</year>) <article-title>Optimization of Image Quality in Retrospective Respiratory-Gated Micro-CT for Quantitative Measurements of Lung Function in Free-Breathing Rats</article-title>. <source>J Bio Sci Eng</source>
<volume>7</volume>: <fpage>157</fpage>–<lpage>172</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0149841.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Badea</surname><given-names>CT</given-names></name>, <name><surname>Johnston</surname><given-names>SM</given-names></name>, <name><surname>Qi</surname><given-names>Y</given-names></name>, <name><surname>Johnson</surname><given-names>GA</given-names></name> (<year>2011</year>) <article-title>4D micro-CT for cardiac and perfusion applications with view under sampling</article-title>. <source>Phys Med Biol</source>
<volume>56</volume>: <fpage>3351</fpage>–<lpage>3369</lpage>. <pub-id pub-id-type="doi">10.1088/0031-9155/56/11/011</pub-id>
<?supplied-pmid 21558587?><pub-id pub-id-type="pmid">21558587</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>McKinnon</surname><given-names>GC</given-names></name>, <name><surname>Bates</surname><given-names>RHT</given-names></name> (<year>1981</year>) <article-title>Towards imaging the beating heart usefully with a conventional CT scanner</article-title>. <source>IEEE Trans Biomed Eng</source>
<volume>28</volume>: <fpage>123</fpage>–<lpage>127</lpage>. <?supplied-pmid 7287019?><pub-id pub-id-type="pmid">7287019</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Sawall</surname><given-names>S</given-names></name>, <name><surname>Bergner</surname><given-names>F</given-names></name>, <name><surname>Lapp</surname><given-names>R</given-names></name>, <name><surname>Mronz</surname><given-names>M</given-names></name>, <name><surname>Karolczak</surname><given-names>M</given-names></name>, <name><surname>Hess</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Low-dose cardio-respiratory phase-correlated cone-beam micro-CT of small animals</article-title>. <source>Med Phys</source>
<volume>38</volume>: <fpage>1416</fpage>–<lpage>1424</lpage>. <?supplied-pmid 21520853?><pub-id pub-id-type="pmid">21520853</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Qi</surname><given-names>Z</given-names></name>, <name><surname>Chen</surname><given-names>GH</given-names></name> (<year>2011</year>) <article-title>Performance studies of four-dimensional cone beam computed tomography</article-title>. <source>Phys Med Biol</source>
<volume>56</volume>: <fpage>6709</fpage>–<lpage>6721</lpage>. <pub-id pub-id-type="doi">10.1088/0031-9155/56/20/013</pub-id>
<?supplied-pmid 21965275?><pub-id pub-id-type="pmid">21965275</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Maier</surname><given-names>J</given-names></name>, <name><surname>Sawall</surname><given-names>S</given-names></name>, <name><surname>Kachelrieß</surname><given-names>M</given-names></name> (<year>2014</year>) <article-title>Assessment of dedicated low-dose cardiac micro-CT reconstruction algorithms using the left ventricular volume of small rodents as a performance measure</article-title>. <source>Med Phys</source>
<volume>41</volume>: <fpage>051908</fpage>
<pub-id pub-id-type="doi">10.1118/1.4870983</pub-id>
<?supplied-pmid 24784387?><pub-id pub-id-type="pmid">24784387</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Ritschl</surname><given-names>L</given-names></name>, <name><surname>Sawall</surname><given-names>S</given-names></name>, <name><surname>Knaup</surname><given-names>M</given-names></name>, <name><surname>Hess</surname><given-names>A</given-names></name>, <name><surname>Kachelriess</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>Iterative 4D cardiac micro-CT image reconstruction using an adaptive spatio-temporal sparsity prior</article-title>. <source>Phys Med Biol</source>
<volume>57</volume>: <fpage>1517</fpage>
<pub-id pub-id-type="doi">10.1088/0031-9155/57/6/1517</pub-id>
<?supplied-pmid 22391045?><pub-id pub-id-type="pmid">22391045</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Thirion</surname><given-names>JP</given-names></name> (<year>1998</year>) <article-title>Image matching as a diffusion process: an analogy with Maxwell's demons</article-title>. <source>Med Image Anal</source>
<volume>2</volume>: <fpage>243</fpage>–<lpage>260</lpage>. <?supplied-pmid 9873902?><pub-id pub-id-type="pmid">9873902</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>H</given-names></name>, <name><surname>Dong</surname><given-names>L</given-names></name>, <name><surname>O'Daniel</surname><given-names>J</given-names></name>, <name><surname>Mohan</surname><given-names>R</given-names></name>, <name><surname>Garden</surname><given-names>AS</given-names></name>, <name><surname>Ang</surname><given-names>KK</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>Validation of an accelerated 'demons' algorithm for deformable image registration in radiation therapy</article-title>. <source>Phys Med Biol</source>
<volume>50</volume>: <fpage>2887</fpage>–<lpage>2905</lpage>. <?supplied-pmid 15930609?><pub-id pub-id-type="pmid">15930609</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0149841.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Ramani</surname><given-names>S</given-names></name>, <name><surname>Fessler</surname><given-names>JA</given-names></name> (<year>2012</year>) <article-title>A Splitting-Based Iterative Algorithm for Accelerated Statistical X-Ray CT Reconstruction</article-title>. <source>IEEE Trans Med Imaging</source>
<volume>31</volume>: <fpage>677</fpage>–<lpage>688</lpage>. <pub-id pub-id-type="doi">10.1109/TMI.2011.2175233</pub-id>
<?supplied-pmid 22084046?><pub-id pub-id-type="pmid">22084046</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
