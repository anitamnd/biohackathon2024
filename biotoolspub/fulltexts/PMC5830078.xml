<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5830078</article-id>
    <article-id pub-id-type="publisher-id">2057</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-018-2057-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>lme4qtl: linear mixed models with flexible covariance structure for genetic studies of related individuals</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Ziyatdinov</surname>
          <given-names>Andrey</given-names>
        </name>
        <address>
          <email>ziyatdinov@hsph.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vázquez-Santiago</surname>
          <given-names>Miquel</given-names>
        </name>
        <address>
          <email>mvazquezs@santpau.cat</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brunel</surname>
          <given-names>Helena</given-names>
        </name>
        <address>
          <email>hb493@medschl.cam.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Martinez-Perez</surname>
          <given-names>Angel</given-names>
        </name>
        <address>
          <email>amartinezp@santpau.cat</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Aschard</surname>
          <given-names>Hugues</given-names>
        </name>
        <address>
          <email>haschard@hsph.harvard.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Soria</surname>
          <given-names>Jose Manuel</given-names>
        </name>
        <address>
          <email>jsoria@santpau.cat</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution>Department of Epidemiology, </institution><institution>Harvard T.H. Chan School of Public Health, </institution></institution-wrap>Boston, Massachusetts United States of America </aff>
      <aff id="Aff2"><label>2</label>Unitat de Genòmica de Malalties Complexes, Institut d’Investigació Biomèdica Sant Pau (IIB-Sant Pau), Barcelona, Spain </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1768 8905</institution-id><institution-id institution-id-type="GRID">grid.413396.a</institution-id><institution>Unitat d’Hemostàsia i Trombosi, </institution><institution>Hospital de la Santa Creu i Sant Pau, </institution></institution-wrap>Barcelona, Spain </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2353 6535</institution-id><institution-id institution-id-type="GRID">grid.428999.7</institution-id><institution>Centre de Bioinformatique, Biostatistique et Biologie Intégrative (C3BI), </institution><institution>Institut Pasteur, </institution></institution-wrap>Paris, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>19</volume>
    <elocation-id>68</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>8</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>2</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Quantitative trait locus (QTL) mapping in genetic data often involves analysis of correlated observations, which need to be accounted for to avoid false association signals. This is commonly performed by modeling such correlations as random effects in linear mixed models (LMMs). The R package <italic>lme4</italic> is a well-established tool that implements major LMM features using sparse matrix methods; however, it is not fully adapted for QTL mapping association and linkage studies. In particular, two LMM features are lacking in the base version of <italic>lme4</italic>: the definition of random effects by custom covariance matrices; and parameter constraints, which are essential in advanced QTL models. Apart from applications in linkage studies of related individuals, such functionalities are of high interest for association studies in situations where multiple covariance matrices need to be modeled, a scenario not covered by many genome-wide association study (GWAS) software.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>To address the aforementioned limitations, we developed a new R package <italic>lme4qtl</italic> as an extension of <italic>lme4</italic>. First, <italic>lme4qtl</italic> contributes new models for genetic studies within a single tool integrated with <italic>lme4</italic> and its companion packages. Second, <italic>lme4qtl</italic> offers a flexible framework for scenarios with multiple levels of relatedness and becomes efficient when covariance matrices are sparse. We showed the value of our package using real family-based data in the Genetic Analysis of Idiopathic Thrombophilia 2 (GAIT2) project.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Our software <italic>lme4qtl</italic> enables QTL mapping models with a versatile structure of random effects and efficient computation for sparse covariances. <italic>lme4qtl</italic> is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/variani/lme4qtl">https://github.com/variani/lme4qtl</ext-link>.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-018-2057-x) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Linear mixed models</kwd>
      <kwd>Covariance</kwd>
      <kwd>Related individuals</kwd>
      <kwd>GWAS</kwd>
      <kwd>lme4</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Instituto de Salud Carlos III Fondo de Investigación Sanitaria</institution>
        </funding-source>
        <award-id>PI 14/0582</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R21HG007687</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Many genetic study designs induce correlations among observations, including, for example, family or cryptic relatedness, shared environments and repeated measurements. The standard statistical approach used in quantitative trait locus (QTL) mapping is linear mixed models (LMMs), which is able to effectively assess and estimate the contribution of an individual genetic locus in the presence of correlated observations [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. However, LMMs are known to be computationally expensive when applied in large-scale data. Indeed, the LMM approach has the cubic computational complexity on the sample size per test [<xref ref-type="bibr" rid="CR3">3</xref>]. This is a major barrier in today’s genome-wide association studies (GWAS), which consist in performing millions of tests in sample size of tens of thousands or more individuals. Therefore, recent methodological developments have been focused on reduction in computational cost [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p>There has been a notable improvement in computation of LMMs with a single genetic random effect. Both population-based [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>] and family-based methods [<xref ref-type="bibr" rid="CR7">7</xref>] use an initial operation on eigendecomposition of the genetic covariance matrix to rotate the data, thereby removing its correlation structure. The computation time drops down to the quadratic complexity on the sample size per test. When LMMs have multiple random effects, the eigendecomposition trick is not applicable and computational speed up can be achieved by tuning the optimization algorithms, for instance, using sparse matrix methods [<xref ref-type="bibr" rid="CR8">8</xref>] or incorporating Monte Carlo simulations [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p>However, the decrease in computation time comes at the expense of flexibility. In particular, most efficient LMM methods developed for GWAS assume a single random genetic effect in model specification and support simple study designs, for example, prohibiting the analysis of longitudinal panels. We have developed a new <italic>lme4qtl</italic> R package that unlocks the well-established <italic>lme4</italic> framework for QTL mapping analysis. We demonstrate the computational efficiency and versatility of our package through the analysis of real family-based data from the Genetic Analysis of Idiopathic Thrombophilia 2 (GAIT2) project [<xref ref-type="bibr" rid="CR10">10</xref>]. More specifically, we first performed a standard GWAS, then showed an advanced model of gene-environment interaction [<xref ref-type="bibr" rid="CR11">11</xref>], and finally estimated the influence of data sparsity on the computation time.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Linear mixed models</title>
      <p>Consider the following polygenic linear model that describes an outcome <italic>y</italic>: 
<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$y = X \beta + Z u + e $$ \end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>Xβ</mml:mi><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">Zu</mml:mtext><mml:mo>+</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2018_2057_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <italic>n</italic> is the number of individuals, <italic>y</italic><sub><italic>n</italic>×1</sub> is vector of size <italic>n</italic>, <italic>X</italic><sub><italic>n</italic>×<italic>p</italic></sub> and <italic>Z</italic><sub><italic>n</italic>×<italic>n</italic></sub> are incidence matrices, <italic>p</italic> is the number of fixed effects, <italic>β</italic><sub><italic>p</italic>×1</sub> is a vector of fixed effects, <italic>u</italic><sub><italic>n</italic>×1</sub> is a vector of a random polygenic effect, and <italic>e</italic><sub><italic>n</italic>×1</sub> is a vector of the residuals errors. The random vectors <italic>u</italic> and <italic>e</italic> are assumed to be mutually uncorrelated and multivariate normally distributed, <inline-formula id="IEq1"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {N}(0, G_{{n}{\times }{n}})$\end{document}</tex-math><mml:math id="M4"><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2057_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {N}(0, R_{n{\times }n})$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2057_Article_IEq2.gif"/></alternatives></inline-formula>. The covariance matrices are parametrized with a few scalar parameters such as <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$G_{n{\times }n} = \sigma _{g}^{2} A_{n{\times }n}$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2018_2057_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$R_{n{\times }n} = \sigma _{e}^{2} I_{n{\times }n}$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2018_2057_Article_IEq4.gif"/></alternatives></inline-formula>, where <italic>A</italic> is a genetic additive relationship matrix and <italic>I</italic> is the identity matrix. In a general case, the model is extended by adding more random effects, for instance, the dominant genetic or shared-environment components.</p>
    </sec>
    <sec id="Sec4">
      <title>R packages for linear mixed models</title>
      <p>The first group of R packages implement routines to fit linear mixed models as stand-alone programs, for example, the most recent <italic>Gaston</italic> package [<xref ref-type="bibr" rid="CR12">12</xref>]. The second group of R packages were developed as extensions of the <italic>lme4</italic> R package, including our <italic>lme4qtl</italic> package. Of the many existing <italic>lme4</italic>-based extensions, the closest to <italic>lme4qtl</italic> is the <italic>pedigreemm</italic> R package [<xref ref-type="bibr" rid="CR13">13</xref>]. Although this package does support analysis of related individuals, the relationships are coded using pedigree annotations rather than custom covariance matrices. Furthermore, the <italic>pedigreemm</italic> package is not able to fit many advanced models in comparison with <italic>lme4qtl</italic> (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 1).</p>
    </sec>
    <sec id="Sec5">
      <title>Implementation of <italic>lme4qtl</italic></title>
      <p>As an extension of the <italic>lme4</italic> R package, <italic>lme4qtl</italic> adopts its features related to model specification, data representation and computation [<xref ref-type="bibr" rid="CR14">14</xref>]. Briefly, models are specified by a single formula, where grouping factors defining random effects can be nested, partially or fully crossed. Also, underlying computation relies on sparse matrix methods and formulation of a penalized least squares problem, for which many optimizers with box constraints are available. While <italic>lme4</italic> fits linear and generalized linear mixed models by means of lmer and glmer functions, <italic>lme4qtl</italic> extends them in relmatLmer and relmatGlmer functions. The new interface has two main additional arguments: relmat for covariance matrices of random effects and vcControl for restrictions on variance component model parameters. Since the developed relmatLmer and relmatGlmer functions return output objects of the same class as lmer and glmer, these outputs can be further used in complement analyses implemented in companion packages of <italic>lme4</italic>, for example, <italic>RLRsim</italic> [<xref ref-type="bibr" rid="CR15">15</xref>] and <italic>lmerTest</italic> [<xref ref-type="bibr" rid="CR16">16</xref>] R packages for inference procedures.</p>
      <p>We have implemented three features in <italic>lme4qtl</italic> to adapt the mixed model framework of <italic>lme4</italic> for QTL mapping analysis. First, we introduce the positive-definite covariance matrix <italic>G</italic> into the random effect structure, as described in [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. Provided that random effects in <italic>lme4</italic> are specified solely by <italic>Z</italic> matrices, we represent <italic>G</italic> by its Cholesky decomposition <italic>LL</italic><sup><italic>T</italic></sup> and applied a substitution <italic>Z</italic><sup>∗</sup>=<italic>ZL</italic>, which takes the <italic>G</italic> matrix off from the variance of the vector <italic>u</italic>
<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$Var(u) = Z G Z^{T} = Z L L^{T} Z^{T} = Z^{*} (Z^{*})^{T} $$ \end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">ZG</mml:mtext><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">ZL</mml:mtext><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><graphic xlink:href="12859_2018_2057_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> Second, we address situations when <italic>G</italic> is positive semi-definite, which happen if genetic studies include twin pairs [<xref ref-type="bibr" rid="CR1">1</xref>]. To define the <italic>Z</italic><sup>∗</sup> substitution in this case, we use the eigendecomposition of <italic>G</italic>. Although <italic>G</italic> is not of full rank, we take advantage of <italic>lme4</italic>’ special representation of covariance matrix in linear mixed model, which is robust to rank deficiency [<xref ref-type="bibr" rid="CR14">14, p. 24-25</xref>].</p>
      <p>Third, we extend the <italic>lme4</italic> interface with an option to specify restrictions on model parameters. Such functionality is necessary in advanced models, for example, for a trait measured in multiple environments (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 2).</p>
      <p>We note that the later two features are available only in <italic>lme4qtl</italic>, but not in other <italic>lme4</italic>-based extensions such as the <italic>pedigreemm</italic> package [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
    </sec>
    <sec id="Sec6">
      <title>Analysis of the GAIT2 data</title>
      <p>The sample from the Genetic Analysis of Idiopathic Thrombophilia 2 (GAIT2) project consisted of 935 individuals from 35 extended families, recruited through a proband with idiopathic thrombophilia [<xref ref-type="bibr" rid="CR10">10</xref>]. We conducted a genome-wide screening of activated partial thromboplastin time (APTT), which is a clinical test used to screen for coagulation-factor deficiencies [<xref ref-type="bibr" rid="CR18">18</xref>]. The samples were genotyped with a combination of two chips, that resulted in 395,556 single-nucleotide polymorphisms (SNPs) after merging the data. We performed the same quality control pre-processing steps as in the original study: phenotypic values were log-transformed; two fixed effects, age and gender, and two random effects, genetic additive and shared house-hold, were included in the model; individuals with missing phenotype values were removed and all genotypes with a minimum allele frequency below 1% were filtered out, leaving 263,764 genotyped SNPs in 903 individuals available for GWAS. We compared the performances between our package and SOLAR [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR19">19</xref>], one of the standard tool in family-based QTL mapping analysis.</p>
    </sec>
  </sec>
  <sec id="Sec7" sec-type="results">
    <title>Results</title>
    <p>We considered three models for the analysis of APTT in the GAIT2 data, namely polygenic, SNP-based association and gene-environment interaction.</p>
    <p>Before conducting the analysis, we organized trait, age, gender, individual identifier id, house-hold identifier hhid variables and SNPs as a table dat. The additive genetic relatedness matrix was estimated using the pedigree information and stored in a matrix mat. A polygenic model m1 was fitted to the data by the relmatLmer function as follows.</p>
    <p>
      <graphic xlink:href="12859_2018_2057_Figa_HTML.gif" id="MO1"/>
    </p>
    <p>The proportion of variance explained by the genetic effect (heritability) was 0.56, and its 95% confidence interval, estimated by profiling the deviance [<xref ref-type="bibr" rid="CR14">14</xref>], was [0.45; 0.84].</p>
    <p>We further tested whether the genetic effect was statistically significant by simulations of the restricted likelihood ratio statistic, as implemented in the exactRLRT function of the <italic>RLRsim</italic> R package [<xref ref-type="bibr" rid="CR15">15</xref>]. The <italic>p</italic>-value of the test was below 2.2×10<sup>−16</sup>.</p>
    <p>For a single SNP named rs1, the update function created an association model m2 from m1 and the anova function then performed the likelihood ratio test.</p>
    <p>
      <graphic xlink:href="12859_2018_2057_Figb_HTML.gif" id="MO2"/>
    </p>
    <p>To automate the GWAS analysis, we created an example assocLmer function with several options such as different tests of association and parallel computation. By using the assocLmer function, we have replicated some loci previously reported for APTT in a larger cohort of 9,240 individuals [<xref ref-type="bibr" rid="CR18">18</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1) applying the likelihood ratio test and running the analysis in parallel on a desktop computer (2.8GHz quad-core Intel Core i5 processor, 8GB RAM).</p>
    <p>The GWAS computation time of the association analysis with two random effects by <italic>lme4qtl</italic> was 7.6 h. We performed the same analyses, using SOLAR, and observed a computation time 3 fold larger (25.1 hours, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). In additional experiments varying the number of fixed and random effects, the <italic>lme4qtl</italic> package was also several times faster than SOLAR (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2), owing to the efficient <italic>lme4</italic> implementation of sparse matrix methods. Though, in a special case when a model has a single random effect, SOLAR had a option to apply the eigendecomposition trick and substantially speed up the computation (3.8 h), while this option has not been implemented in <italic>lme4qtl</italic> (6.6 h). When including a widely used <italic>lmekin</italic> function from the <italic>coxme</italic> package [<xref ref-type="bibr" rid="CR20">20</xref>] in the comparison study, our package <italic>lme4qtl</italic> also showed the lowest computation time (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). As comparison with other packages is beyond the scope of this work, we suspect that <italic>lme4qtl</italic> will likely outperform others or show similar results under scenario of sparse covariance matrices. We note that the <italic>lme4qtl</italic> performance substantially declines for dense covariance matrices, as described further below.</p>
    <p>If one is interested in more complex models than m1 and m2, our package <italic>lme4qtl</italic> is flexible enough for advanced model specification. For instance, <italic>lme4qtl</italic> allows for extension of the polygenic model m1 to assess the hypothesis of sex-specificity (a special case of gene-environment interaction) [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p>
      <graphic xlink:href="12859_2018_2057_Figc_HTML.gif" id="MO3"/>
    </p>
    <p>The first genetic random effect, denoted as (0 + gender|id), has three parameters <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{g_{1}}$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2018_2057_Article_IEq5.gif"/></alternatives></inline-formula>, <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{g_{2}}$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2018_2057_Article_IEq6.gif"/></alternatives></inline-formula> and <italic>ρ</italic><sub><italic>g</italic></sub> and its variance is partitioned among three groups of pairs: male-specific (<inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma ^{2}_{g_{1}}$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2018_2057_Article_IEq7.gif"/></alternatives></inline-formula>, the genetic variance captured by males), female-specific <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\big (\sigma ^{2}_{g_{2}}\big)$\end{document}</tex-math><mml:math id="M20"><mml:mstyle mathsize="1.19em"><mml:mfenced close="" open="(" separators=""><mml:mrow/></mml:mfenced></mml:mstyle><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mstyle mathsize="1.19em"><mml:mfenced close="" open=")" separators=""><mml:mrow/></mml:mfenced></mml:mstyle></mml:math><inline-graphic xlink:href="12859_2018_2057_Article_IEq8.gif"/></alternatives></inline-formula> and male-female pairs <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left (\rho _{g} \sigma _{g_{1}} \sigma _{g_{2}}\right)$\end{document}</tex-math><mml:math id="M22"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2057_Article_IEq9.gif"/></alternatives></inline-formula>. The second random effect, denoted as (0 + dummy(gender)|rid), models the heteroscedasticity in residual variance between the two groups of males and females, where the variable rid is a copy of the individual identifier id variable. The random effect (1|hhid) presented in m1 is not included for simplicity reasons. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Notes 1 and 2 contain the details on model specification and numerical results obtained on the GAIT2 data.</p>
    <p>To assess the null hypothesis of no gene-environment interaction, Blangero proposed the likelihood ratio test when comparing to either of two null models: the correlation coefficient is one (<italic>ρ</italic><sub><italic>g</italic></sub>=1) or the variances are equal (<inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{g_{1}} = \sigma _{g_{2}}$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2018_2057_Article_IEq10.gif"/></alternatives></inline-formula>) [<xref ref-type="bibr" rid="CR11">11</xref>]. We implemented different restrictions on model parameters in <italic>lme4qtl</italic> by means of a special syntax for the vcControl parameter, as described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 2. The next two (null) models, m4 and m5, were fitted with the parameter restrictions described above for the gene-environment interaction analysis.</p>
    <p>
      <graphic xlink:href="12859_2018_2057_Figd_HTML.gif" id="MO4"/>
    </p>
    <p>Numerical results of the likelihood ratio tests in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 3 showed that the evidence for gene-environment interaction is weak. Otherwise, a new m3-based association model can be sought for GWAS, in which a SNP has both marginal and interaction effects with the gender variable.</p>
    <p>Lastly, we evaluated how the <italic>lme4qtl</italic> computation time depends on the sparse structure of covariance matrices, as the genetic relationship matrices are not necessarily sparse. We used the polygenic model m1 as an initial model (the random effect (1|hhid) was omitted), where the genetic relationship matrix mat has a high proportion of zero values (sparsity) equal to 0.98. We then gradually fill zeros in mat by small non-zero values, thus reducing the sparsity towards 0, and refitted the model m1. We found that the time required to fit the polygenic model increased substantially: it became an order of magnitude greater once the sparsity changed from the GAIT2 level 0.98 to 0.60 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4).</p>
  </sec>
  <sec id="Sec8">
    <title>Discussion and conclusions</title>
    <p>We have extended the <italic>lme4</italic> R package, a well-established tool for linear mixed models, for application to QTL mapping. The new <italic>lme4qtl</italic> R package has adopted the <italic>lme4</italic>’s powerful features and contributes with two key building blocks in QTL mapping analysis, custom covariance matrices and restrictions on model parameters. To our knowledge, the <italic>lme4qtl</italic> R package is the most comprehensive extension of <italic>lme4</italic> to date for QTL mapping analysis.</p>
    <p>Our package also has limitations. In particular, introducing covariance matrices in random effects implies that some of the statistical procedures implemented in <italic>lme4</italic> might not be applicable anymore. For instance, bootstrapping in the update function from <italic>lme4</italic> cannot be directly used for <italic>lme4qtl</italic> models. Furthermore, the residual errors in <italic>lme4</italic> models are only allowed to be independent and identically distributed, and ad hoc solutions need to be applied in more general cases, as we showed for the gene-environment interaction model. However, this restriction on the form of residual errors may be relaxed in the future <italic>lme4</italic> releases, according to its development plan on the official website [<xref ref-type="bibr" rid="CR21">21</xref>]. Also, <italic>lme4qtl</italic> cannot compete with tools optimized for particular GWAS models with a single genetic random effect: <italic>lme4qtl</italic> allows for association models with multiple random effects.</p>
    <p>In practice, <italic>lme4qtl</italic> is mostly applicable to datasets with sparse covariance matrices. Its use in population-based studies with dense matrices may lead to a considerable overhead in computation time. The typical study designs suitable for <italic>lme4qtl</italic> are family-based studies, longitudinal and similar studies with many sparse grouping factors. Also, <italic>lme4qtl</italic> would be applicable in a 2-step GWAS procedure even in population-based studies: at the first step, the linear mixed model is fitted a single time under the null hypothesis of no association; at the second step, association tests make use of the variance component parameters estimated at the previous step, thus, avoiding fitting the linear mixed model again and speeding up the computation [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. Of a practical note, <italic>lme4qtl</italic> was able to fit a linear mixed model with many structured random effects, including the dense genetic covariance matrix, on several thouthands of individuals in less than half an hour on the desktop computer (data not shown).</p>
    <p>In conclusion, the <italic>lme4qtl</italic> R package enables QTL mapping models with a versatile structure of random effects and efficient computation for sparse covariances.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional file</title>
    <sec id="Sec9">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2018_2057_MOESM1_ESM.pdf">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary Tables and Figures. Supplementary Note 1: R code to compare lme4qtl and pedigreemm R packages. Supplementary Note 2: Multi-trait and multi-environment linear mixed models. Supplementary Note 3: R code applied to the GAIT2 data. (PDF 1341 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>APTT</term>
        <def>
          <p>Activated partial thromboplastin time</p>
        </def>
      </def-item>
      <def-item>
        <term>GAIT2</term>
        <def>
          <p>Genetic analysis of idiopathic thrombophilia 2</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p>Genome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>LMM</term>
        <def>
          <p>Linear mixed model</p>
        </def>
      </def-item>
      <def-item>
        <term>QTL</term>
        <def>
          <p>Quantitative trait locus</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p>Single nucleotide polymorphism</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (10.1186/s12859-018-2057-x) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <p>AZ thanks Donald Halstead for reading and providing feedback on early drafts of the manuscript.</p>
    <sec id="d29e1484">
      <title>Funding</title>
      <p>This study was supported by funds from the Instituto de Salud Carlos III Fondo de Investigación Sanitaria PI 14/0582. AZ and HA were supported by NIH grant R21HG007687.</p>
    </sec>
    <sec id="d29e1489">
      <title>Availability of data and materials</title>
      <p>Source code of lme4qtl is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/variani/lme4qtl">https://github.com/variani/lme4qtl</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>AZ, MVS and HB conceived the study; AZ implemented the software; AZ, MVS and HB tested the software; AZ, MVS, HB and AMP analyzed the data; HA and JMS directed the study; AZ and HA drafted the manuscript; all authors read and approved the final version of the manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="d29e1505">
      <title>Ethics approval and consent to participate</title>
      <p>The GAIT2 study was performed according to the Declaration of Helsinki and adult subjects gave written informed consent for themselves and for their minor children. The GAIT2 study was reviewed and approved by the Institutional Review Board of the Hospital de la Santa Creu i Sant Pau, Barcelona, Spain.</p>
    </sec>
    <sec id="d29e1510">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d29e1515">
      <title>Competing interests</title>
      <p>The authors have declared that no competing interests exist.</p>
    </sec>
    <sec id="d29e1520">
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lynch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Walsh</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Genetics and analysis of quantitative traits, vol 1</source>
        <year>1998</year>
        <publisher-loc>MA</publisher-loc>
        <publisher-name>Sinauer Sunderland</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Almasy</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Blangero</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Multipoint quantitative-trait linkage analysis in general pedigrees</article-title>
        <source>Am J Human Genet</source>
        <year>1998</year>
        <volume>62</volume>
        <issue>5</issue>
        <fpage>1198</fpage>
        <lpage>211</lpage>
        <pub-id pub-id-type="doi">10.1086/301844</pub-id>
        <pub-id pub-id-type="pmid">9545414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Zaitlen</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Wade</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Kirby</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Heckerman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Efficient control of population structure in model organism association mapping</article-title>
        <source>Genetics</source>
        <year>2008</year>
        <volume>178</volume>
        <issue>3</issue>
        <fpage>1709</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.107.080101</pub-id>
        <?supplied-pmid 18385116?>
        <pub-id pub-id-type="pmid">18385116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaitlen</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Visscher</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>AL</given-names>
          </name>
        </person-group>
        <article-title>Advantages and pitfalls in the application of mixed-model association methods</article-title>
        <source>Nat Genet</source>
        <year>2014</year>
        <volume>46</volume>
        <issue>2</issue>
        <fpage>100</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2876</pub-id>
        <?supplied-pmid 24473328?>
        <pub-id pub-id-type="pmid">24473328</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lippert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Listgarten</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kadie</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>RI</given-names>
          </name>
          <name>
            <surname>Heckerman</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>FaST linear mixed models for genome-wide association studies</article-title>
        <source>Nat Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <issue>10</issue>
        <fpage>833</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1681</pub-id>
        <?supplied-pmid 21892150?>
        <pub-id pub-id-type="pmid">21892150</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide efficient mixed-model analysis for association studies</article-title>
        <source>Nat Genet</source>
        <year>2012</year>
        <volume>44</volume>
        <issue>7</issue>
        <fpage>821</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2310</pub-id>
        <?supplied-pmid 22706312?>
        <pub-id pub-id-type="pmid">22706312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blangero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Diego</surname>
            <given-names>VP</given-names>
          </name>
          <name>
            <surname>Dyer</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Peralta</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kent Jr</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Almasy</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Göring</surname>
            <given-names>HHH</given-names>
          </name>
        </person-group>
        <article-title>A kernel of truth: statistical advances in polygenic variance component models for complex human pedigrees</article-title>
        <source>Adv Genet</source>
        <year>2013</year>
        <volume>81</volume>
        <fpage>1</fpage>
        <?supplied-pmid 23419715?>
        <pub-id pub-id-type="pmid">23419715</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gilmour</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Gogel</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Cullis</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <source>ASReml user guide release 3.0</source>
        <year>2009</year>
        <publisher-loc>UK</publisher-loc>
        <publisher-name>VSN International Ltd, Hemel Hempstead</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loh</surname>
            <given-names>P-R</given-names>
          </name>
          <name>
            <surname>Bhatia</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gusev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Finucane</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Bulik-Sullivan</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Pollack</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>de Candia</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Wray</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Kendler</surname>
            <given-names>KS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Contrasting genetic architectures of schizophrenia and other complex diseases using fast variance-components analysis</article-title>
        <source>Nat Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <issue>12</issue>
        <fpage>1385</fpage>
        <pub-id pub-id-type="doi">10.1038/ng.3431</pub-id>
        <?supplied-pmid 26523775?>
        <pub-id pub-id-type="pmid">26523775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martin-Fernandez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ziyatdinov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Carrasco</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Millon</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Martinez-Perez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vilalta</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Brunel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Font</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hamsten</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Souto</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic determinants of thrombin generation and their relation to venous thrombosis: results from the GAIT-2 project”</article-title>
        <source>PloS ONE</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>e0146922</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0146922</pub-id>
        <?supplied-pmid 26784699?>
        <pub-id pub-id-type="pmid">26784699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blangero</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Statistical genetic approaches to human adaptability</article-title>
        <source>Hum Biol</source>
        <year>2009</year>
        <volume>81</volume>
        <issue>5</issue>
        <fpage>523</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.3378/027.081.0603</pub-id>
        <?supplied-pmid 20504179?>
        <pub-id pub-id-type="pmid">20504179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <mixed-citation publication-type="other">Perdry H, Dandine-Roulland C. Gaston: Genetic Data Handling (QC, GRM, LD, PCA) &amp; Linear Mixed Models. 2017. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=gaston">https://CRAN.R-project.org/package=gaston</ext-link>. R package version 1.5.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vazquez</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Rosa</surname>
            <given-names>GJM</given-names>
          </name>
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weigel</surname>
            <given-names>KA</given-names>
          </name>
        </person-group>
        <article-title>Technical note: an r package for fitting generalized linear mixed models in animal breeding</article-title>
        <source>J Anim Sci</source>
        <year>2010</year>
        <volume>88</volume>
        <issue>2</issue>
        <fpage>497</fpage>
        <lpage>504</lpage>
        <pub-id pub-id-type="doi">10.2527/jas.2009-1952</pub-id>
        <?supplied-pmid 19820058?>
        <pub-id pub-id-type="pmid">19820058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mächler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bolker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fitting linear mixed-effects models using lme4</article-title>
        <source>J Stat Softw</source>
        <year>2015</year>
        <volume>67</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v067.i01</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scheipl</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Greven</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kuechenhoff</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Size and power of tests for a zero random effect variance or polynomial regression in additive and linear mixed models</article-title>
        <source>Comput Stat Data Anal</source>
        <year>2008</year>
        <volume>52</volume>
        <issue>7</issue>
        <fpage>3283</fpage>
        <lpage>99</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csda.2007.10.022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <mixed-citation publication-type="other">Kuznetsova A, Bruun Brockhoff P, Haubo Bojesen Christensen R. lmerTest: Tests in Linear Mixed Effects Models. 2016. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=lmerTest">https://CRAN.R-project.org/package=lmerTest</ext-link>. R package version 2.0-33.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <mixed-citation publication-type="other">Harville DA, Callanan TP. Computational aspects of likelihood-based inference for variance components. In: Advances in statistical methods for genetic improvement of livestock. Springer: 1990. p. 136–76.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Weihong Tang</collab>
          <name>
            <surname>Schwienbacher</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Ben-Shlomo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Oudot-Mellakh</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Samani</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gögele</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic associations for activated partial thromboplastin time and prothrombin time, their gene expression profiles, and risk of coronary artery disease</article-title>
        <source>Am J Hum Genet</source>
        <year>2012</year>
        <volume>91</volume>
        <issue>1</issue>
        <fpage>152</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2012.05.009</pub-id>
        <?supplied-pmid 22703881?>
        <pub-id pub-id-type="pmid">22703881</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrey Ziyatdinov</surname>
            <given-names>HelenaBrunel</given-names>
          </name>
        </person-group>
        <article-title>Alexandre Perera, and Jose Manuel Soria. solarius: an R interface to SOLAR for variance component analysis in pedigrees</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>12</issue>
        <fpage>1901</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw080</pub-id>
        <?supplied-pmid 27153684?>
        <pub-id pub-id-type="pmid">27153684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <mixed-citation publication-type="other">Therneau TM. coxme: Mixed Effects Cox Models. 2015. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=coxme">https://CRAN.R-project.org/package=coxme</ext-link>. R package version 2.2-5.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <mixed-citation publication-type="other">Github. <ext-link ext-link-type="uri" xlink:href="https://github.com/lme4/lme4">https://github.com/lme4/lme4</ext-link>. Last accessed 27 Jan 2017.</mixed-citation>
    </ref>
  </ref-list>
</back>
