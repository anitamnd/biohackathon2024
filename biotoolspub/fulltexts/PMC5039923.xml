<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5039923</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btw352</article-id>
    <article-id pub-id-type="publisher-id">btw352</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic>RADIS:</italic> analysis of <italic>RAD</italic>-seq data for interspecific phylogeny</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cruaud</surname>
          <given-names>Astrid</given-names>
        </name>
        <xref ref-type="aff" rid="btw352-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btw352-cor1">*</xref>
        <xref ref-type="author-notes" rid="btw352-FM1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gautier</surname>
          <given-names>Mathieu</given-names>
        </name>
        <xref ref-type="aff" rid="btw352-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btw352-aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="btw352-FM1">
          <sup>†</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rossi</surname>
          <given-names>Jean-Pierre</given-names>
        </name>
        <xref ref-type="aff" rid="btw352-aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rasplus</surname>
          <given-names>Jean-Yves</given-names>
        </name>
        <xref ref-type="aff" rid="btw352-aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gouzy</surname>
          <given-names>Jérôme</given-names>
        </name>
        <xref ref-type="aff" rid="btw352-aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btw352-aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <aff id="btw352-aff1"><sup>1</sup>INRA, UMR1062 CBGP, F-34988 Montferrier-sur-Lez, France,</aff>
      <aff id="btw352-aff2"><sup>2</sup>IBC, F-34095 Montpellier, France,</aff>
      <aff id="btw352-aff3"><sup>3</sup>INRA, UMR441 LIPM, F31326 Castanet Tolosan, France</aff>
      <aff id="btw352-aff4"><sup>4</sup>CNRS, UMR2594 LIPM, F31326 Castanet Tolosan, France</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btw352-cor1">*To whom correspondence should be addressed.</corresp>
      <fn id="btw352-FM1">
        <p><sup>†</sup>These authors contributed equally to this work.</p>
      </fn>
      <fn id="btw352-FM2">
        <p>Associate Editor: Alfonso Valencia</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>10</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>6</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>19</issue>
    <fpage>3027</fpage>
    <lpage>3028</lpage>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>2</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>4</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>5</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2016. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p>In an attempt to make the processing of RAD-seq data easier and allow rapid and automated exploration of parameters/data for phylogenetic inference, we introduce the perl pipeline <italic>RADIS</italic>. Users of <italic>RADIS</italic> can let their raw Illumina data be processed up to phylogenetic tree inference, or stop (and restart) the process at some point. Different values for key parameters can be explored in a single analysis (e.g. loci building, sample/loci selection), making possible a thorough exploration of data. <italic>RADIS</italic> relies on <italic>Stacks</italic> for demultiplexing of data, removing PCR duplicates and building individual and catalog loci. Scripts have been specifically written for trimming of reads and loci/sample selection. Finally, <italic>RAxML</italic> is used for phylogenetic inferences, though other software may be utilized.</p>
      <p><bold>Availability and implementation:</bold> RADIS is written in perl, designed to run on Linux and Unix platforms. RADIS and its manual are freely available from <ext-link ext-link-type="uri" xlink:href="http://www1.montpellier.inra.fr/CBGP/software/RADIS">http://www1.montpellier.inra.fr/CBGP/software/RADIS</ext-link>/.</p>
      <p>
        <bold>Contact:</bold>
        <email>astrid.cruaud@supagro.inra.fr</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw352/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Restriction site Associated DNA sequencing (RAD-seq, <xref rid="btw352-B1" ref-type="bibr">Baird <italic>et al.</italic>, 2008</xref>; <xref rid="btw352-B10" ref-type="bibr">Miller <italic>et al.</italic>, 2007</xref>) is a promising tool to confidently resolve phylogenetic relationships among eukaryote species and genera (e.g. <xref rid="btw352-B4" ref-type="bibr">Cruaud <italic>et al.</italic>, 2014</xref>; <xref rid="btw352-B6" ref-type="bibr">Eaton and Ree, 2013</xref>; <xref rid="btw352-B7" ref-type="bibr">Hipp <italic>et al.</italic>, 2014</xref>; <xref rid="btw352-B9" ref-type="bibr">McCluskey and Postlethwait, 2015</xref>). However, analyzing RAD-seq data to infer phylogenies remains challenging as it requires many steps and decisions to process raw data into a format ready for analysis. Some steps can be achieved using a collection of well-packaged software, but others require bioinformatic skills. An examination of data is required to better analyze their quality and impact on topology/branch lengths. Assessment of the robustness of the resulting trees to the parameters chosen for loci building and loci/sample selection is required (<xref rid="btw352-B8" ref-type="bibr">Leaché <italic>et al.</italic>, 2015</xref>) but represents a tedious and error-prone task when done manually. In an attempt to standardize processing of RAD-seq data for phylogenetic inference, allow fast and automated exploration of key options, and facilitate comparison among clustering methods to form sets of loci (e.g. Stacks <xref rid="btw352-B3" ref-type="bibr">Catchen <italic>et al.</italic>, 2011</xref>; <xref rid="btw352-B2" ref-type="bibr">Catchen <italic>et al.</italic>, 2013</xref>
<italic>versus PyRAD</italic>, <xref rid="btw352-B5" ref-type="bibr">Eaton 2014</xref>), we designed the user-friendly perl pipeline <italic>RADIS.</italic></p>
  </sec>
  <sec>
    <title>2 Description</title>
    <p>Processing of raw data has been split up into two steps: data cleaning and data analysis (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw352/-/DC1">Supplementary Fig. S1</ext-link>). Example datasets are provided with the package (processing time &lt;1 min on 8-cores of a 16-core Linux, 2.9 GHz, 64 GB RAM computer). Users can choose to (i) process their raw Illumina data up to phylogenetic tree inference (<italic>RADIS.pl</italic>); (ii) perform only data cleaning (<italic>RADIS_step1_data_cleaning.pl</italic>) or (iii) perform only data analysis (<italic>RADIS_step2_data_analysis.pl</italic>).</p>
    <p><italic>RADIS</italic> operates on the basis of a configuration file (RADIS.cfg) in which users provide parameters values to be tested and paths to external software. The software comes with a fully annotated configuration file to facilitate the initialization. A correspondence between barcodes and sample codes can be provided to allow file renaming (barcodes_lib_names.txt). Progress of the analysis can be followed (stdout/stderr files). Output files and necessary subdirectories are automatically created in a directory specified by the user.</p>
    <p><italic>Data cleaning</italic><italic>—</italic>Reads that do not pass Illumina’s filtering are discarded. <italic>RADIS</italic> relies on <italic>process_radtags</italic> from the software pipeline <italic>Stacks</italic> to demultiplex data. Users can choose to remove nucleotides from the 5′ and 3′ ends of forward and reverse reads (e.g. to remove enzyme cut sites or bad quality nucleotides). If barcodes of different sizes are used, reads are automatically trimmed to the same length. To remove PCR duplicates, <italic>RADIS</italic> then uses <italic>clone_filter</italic> (<italic>Stacks</italic>). Finally, sequence files are renamed after the sample codes. At each step of the process, files are created that provide summary statistics on the number of reads removed/kept</p>
    <p><italic>Data analysis</italic>—‘Purified read 1’ outputs from the first step are processed individually and a set of loci is produced for each sample using <italic>ustacks</italic> (<italic>Stacks</italic>). Users can provide a list of values to be tested for M, the maximum number of nucleotides that may be different between stacks (assembly of exactly matching reads) to be merged into a single locus (<ext-link ext-link-type="uri" xlink:href="http://creskolab.uoregon.edu/stacks/param_tut.php">http://creskolab.uoregon.edu/stacks/param_tut.php</ext-link>). Individual loci are then merged into a catalog of loci with <italic>cstacks</italic> (<italic>Stacks</italic>). Users can provide a list of values for the parameter <italic>n</italic>, the number of mismatches allowed between individual loci when generating the catalog. Exploring alternate parameterization allows the user to find a good compromise for merging orthologous loci from distant species, whilst ensuring that paralogs and non-homologous loci are not merged. Users can then perform loci and sample selection to build datasets that fit with their prior knowledge of the studied species. They can fix a minimum number of loci required for a sample to be kept in the analysis, or retain only loci for which at least a given number of samples have sequences (a list of values can be provided). Users can also choose to remove loci in which paralogs and non-homologous sequences are probably merged together. Phylip-formatted files that meet the selection criteria are produced by <italic>RADIS</italic>. Finally, combined datasets (concatenation of the full sequence of each locus) are analyzed using <italic>RAxML</italic> (<xref rid="btw352-B11" ref-type="bibr">Stamatakis, 2006a</xref>,<xref rid="btw352-B12" ref-type="bibr">b</xref>) to produce phylogenetic trees. Users can delay implementation of <italic>RAxML</italic> analyses in order to increase the number of cpus to be used. Explicit names are used for output directories and files making the results obtained with different sets of parameters easily distinguished and compared (e.g. stacks_M2n4S12L10000.sel.phy is the phylip-formatted combined dataset obtained when individual loci are built using <italic>M</italic> = 2 (M2, <italic>ustacks</italic>), the catalog of loci is built using <italic>n</italic> = 4 (n4, <italic>cstacks</italic>), only sample with at least 10 000 loci (L10000) and loci for which at least 12 samples have sequences (S12) are selected (.sel). It is noteworthy that <italic>RADIS</italic> can process data from as many RAD libraries as needed.</p>
  </sec>
  <sec>
    <title>3 Evaluation using empirical data</title>
    <p>To test the program, we reanalyzed the raw data from <xref rid="btw352-B4" ref-type="bibr">Cruaud <italic>et al.</italic> (2014)</xref>. Experimental design was as follows: DNA from 31 samples was first digested with <italic>PstI</italic> and P1 adaptors containing 5 or 6 bp barcodes were then ligated. Paired-end sequencing of the library (2 * 100 nt) was performed on a single lane of a HiSeq 2000. Raw Illumina data were processed with <italic>RADIS.pl</italic> using <italic>Stacks-1.32</italic> and <italic>RAxML 8.2.0-ALPHA</italic> on 8-cores of a 16-core Linux, 2.9 GHz, 64 GB RAM computer. In the R ADIS.cfg file, radis_nttrim_read1_5p was set to 5 (to remove the overhang of the restriction site), radis_nttrim_read2_3p was set to 5 (to remove low quality bases) while radis_nttrim_read1_3p and radis_nttrim_read2_5p were set to 0. <italic>M</italic> was set to 2 and 4 values of <italic>n</italic> were tested (4, 6, 8, 10). We only retained samples with more than 10 000 loci, and loci for which at least 12 or all samples were represented. Phylogenetic analyses were performed without partitioning. A GTR + Γ model with a discrete gamma approximation (4 categories, <xref rid="btw352-B13" ref-type="bibr">Yang, 1994</xref>) was used for the ML analysis and a GTRCAT approximation of models was used for bootstrapping (1000 replicates). Results (identical to published ones) were obtained within 4 h (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw352/-/DC1">Supplementary Fig. S2</ext-link>).</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>By facilitating testing the impact of different parameter combinations, the pipeline <italic>RADIS</italic> automates and standardizes the analyses of RAD-seq data for phylogenetic inference. The program may prove useful to evaluate the robustness of the results to the options chosen to process real RAD-seq data, or to carry out simulation studies. Most importantly, <italic>RADIS</italic> could also help to assess how different clustering methods may impact tree topology (e.g. Stacks versus <italic>PyRAD</italic>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_32_19_3027__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btw352_FigureS1.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btw352_FigureS2.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank C. Kerdelhué and A. Dehne Garcia for discussions, S. McCairns for proofreading and three anonymous reviewers for their comments.</p>
    <sec>
      <title>Funding</title>
      <p>This work was funded by the division SPE of the INRA, the ANR project <italic>‘TriPTIC’</italic> (ANR-14-CE18-0002).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btw352-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baird</surname><given-names>N.A.</given-names></name></person-group><etal/> (<year>2008</year>) <article-title>Rapid SNP discovery and genetic mapping using sequenced RAD markers</article-title>. <source>PLoS ONE</source>, <volume>3</volume>, <fpage>e3376</fpage>.<pub-id pub-id-type="pmid">18852878</pub-id></mixed-citation>
    </ref>
    <ref id="btw352-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Catchen</surname><given-names>J.</given-names></name></person-group><etal/> (<year>2013</year>) <article-title>Stacks: an analysis tool set for population genomics</article-title>. <source>Mol. Ecol</source>., <volume>22</volume>, <fpage>3124</fpage>–<lpage>3140</lpage>.<pub-id pub-id-type="pmid">23701397</pub-id></mixed-citation>
    </ref>
    <ref id="btw352-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Catchen</surname><given-names>J.M.</given-names></name></person-group><etal/> (<year>2011</year>) <article-title>Stacks: building and genotyping loci de novo from short-read sequences</article-title>. <source>G3-Genes Genomes Genet</source>., <volume>1</volume>, <fpage>171</fpage>–<lpage>182</lpage>.</mixed-citation>
    </ref>
    <ref id="btw352-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cruaud</surname><given-names>A.</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>Empirical assessment of RAD sequencing for interspecific phylogeny</article-title>. <source>Mol. Biol. Evol</source>., <volume>31</volume>, <fpage>1272</fpage>–<lpage>1274</lpage>.<pub-id pub-id-type="pmid">24497030</pub-id></mixed-citation>
    </ref>
    <ref id="btw352-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eaton</surname><given-names>D.A.R.</given-names></name></person-group> (<year>2014</year>) <article-title>PyRAD: assembly of de novo RADseq loci for phylogenetic analyses</article-title>. <source>Bioinformatics</source>, <fpage>btu121</fpage>.</mixed-citation>
    </ref>
    <ref id="btw352-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eaton</surname><given-names>D.A.R.</given-names></name><name><surname>Ree</surname><given-names>R.H.</given-names></name></person-group> (<year>2013</year>) <article-title>Inferring phylogeny and introgression using RADseq data: an example from flowering plants (Pedicularis: Orobanchaceae)</article-title>. <source>Syst. Biol</source>., <volume>62</volume>, <fpage>689</fpage>–<lpage>706</lpage>.<pub-id pub-id-type="pmid">23652346</pub-id></mixed-citation>
    </ref>
    <ref id="btw352-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hipp</surname><given-names>A.L.</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>A framework phylogeny of the American oak clade based on sequenced RAD data</article-title>. <source>PLoS ONE</source>, <volume>9</volume>, <fpage>e93975</fpage>.<pub-id pub-id-type="pmid">24705617</pub-id></mixed-citation>
    </ref>
    <ref id="btw352-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leaché</surname><given-names>A.D.</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>Phylogenomics of phrynosomatid lizards: conflicting signals from sequence capture versus restriction site associated DNA sequencing</article-title>. <source>Genome Biol. Evol</source>., <volume>7</volume>, <fpage>706</fpage>–<lpage>719</lpage>.<pub-id pub-id-type="pmid">25663487</pub-id></mixed-citation>
    </ref>
    <ref id="btw352-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCluskey</surname><given-names>B.M.</given-names></name><name><surname>Postlethwait</surname><given-names>J.H.</given-names></name></person-group> (<year>2015</year>) <article-title>Phylogeny of zebrafish, a “model species,” within <italic>Danio</italic>, a “model genus”</article-title>. <source>Mol. Biol. Evol</source>., <volume>32</volume>, <fpage>635</fpage>–<lpage>652</lpage>.<pub-id pub-id-type="pmid">25415969</pub-id></mixed-citation>
    </ref>
    <ref id="btw352-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>M.R.</given-names></name></person-group><etal/> (<year>2007</year>) <article-title>Rapid and cost-effective polymorphism identification and genotyping using restriction site associated DNA (RAD) markers</article-title>. <source>Genome Res</source>., <volume>17</volume>, <fpage>240</fpage>–<lpage>248</lpage>.<pub-id pub-id-type="pmid">17189378</pub-id></mixed-citation>
    </ref>
    <ref id="btw352-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name><surname>Stamatakis</surname><given-names>A.</given-names></name></person-group> (<year>2006a</year>) Phylogenetic models of rate heterogeneity: A High Performance Computing Perspective. International Parallel and Distributed Processing Symposium (IPDPS 2006), Rhodes Island, Greece, pp. <fpage>8</fpage>.</mixed-citation>
    </ref>
    <ref id="btw352-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stamatakis</surname><given-names>A.</given-names></name></person-group> (<year>2006b</year>) <article-title>RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</article-title>. <source>Bioinformatics</source>, <volume>22</volume>, <fpage>2688</fpage>–<lpage>2690</lpage>.<pub-id pub-id-type="pmid">16928733</pub-id></mixed-citation>
    </ref>
    <ref id="btw352-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>Z.</given-names></name></person-group> (<year>1994</year>) <article-title>Maximum likelihood phylogenetic estimation from DNA sequences with variable rates over sites: approximate methods</article-title>. <source>J. Mol. Evol</source>., <volume>39</volume>, <fpage>306</fpage>–<lpage>314</lpage>.<pub-id pub-id-type="pmid">7932792</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
