<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_HLY2530 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEsi1 svg ?>
<?FILEsi2 svg ?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Heliyon</journal-id>
    <journal-id journal-id-type="iso-abbrev">Heliyon</journal-id>
    <journal-title-group>
      <journal-title>Heliyon</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2405-8440</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6812194</article-id>
    <article-id pub-id-type="publisher-id">S2405-8440(19)36190-0</article-id>
    <article-id pub-id-type="doi">10.1016/j.heliyon.2019.e02530</article-id>
    <article-id pub-id-type="publisher-id">e02530</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PVCTools: parallel variation calling tools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Jin</surname>
          <given-names>Jingjing</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">a</xref>
        <xref rid="fn1" ref-type="fn">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Liu</surname>
          <given-names>Jiajun</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">b</xref>
        <xref rid="fn1" ref-type="fn">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Yin</surname>
          <given-names>Yelin</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">c</xref>
        <xref rid="fn1" ref-type="fn">1</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Li</surname>
          <given-names>Zefeng</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au5">
        <name>
          <surname>Lu</surname>
          <given-names>Peng</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au6">
        <name>
          <surname>Xu</surname>
          <given-names>Yalong</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au7">
        <name>
          <surname>Zhang</surname>
          <given-names>Jianfeng</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au8">
        <name>
          <surname>Cao</surname>
          <given-names>Peijian</given-names>
        </name>
        <email>peijiancao@163.com</email>
        <xref rid="aff1" ref-type="aff">a</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <contrib contrib-type="author" id="au9">
        <name>
          <surname>Hu</surname>
          <given-names>Dasha</given-names>
        </name>
        <email>hudasha@scu.edu.cn</email>
        <xref rid="aff2" ref-type="aff">b</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><label>a</label>China Tobacco Gene Research Center, Zhengzhou Tobacco Research Institute of CNTC, Zhengzhou, 450001, China</aff>
    <aff id="aff2"><label>b</label>Computer Science and Technology, Sichuan University, Chengdu, 450000, China</aff>
    <aff id="aff3"><label>c</label>Zhengzhou Tongbiao Environmental Testing Co., LTD, Zhengzhou, 450001, China</aff>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding authors. <email>peijiancao@163.com</email><email>hudasha@scu.edu.cn</email></corresp>
      <fn id="fn1">
        <label>1</label>
        <p id="ntpara0010">These authors contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>03</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>03</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <volume>5</volume>
    <issue>10</issue>
    <elocation-id>e02530</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>7</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>8</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 The Authors</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="CC BY" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <p>As the development of sequencing technology, it is now possible to sequence individuals of each species. Although a number of different tools have been developed to detect individual variations, most of them cannot be run in parallel modes. To accelerate variation detection, PVCTools is introduced in this study. PVCTools splits the reference genome and alignment files into small pieces and runs them in parallel mode. Meanwhile, boundary noise is also considered in PVCTools. From the result of three different sets of test data, PVCTools performs much faster than most other current tools. At the same time, it keeps similar accuracy with other tools. PVCTools is free and open source software. The development of sequencing technology and growing sample numbers will make performance improvements such as PVCTools increasingly interesting.</p>
    </abstract>
    <kwd-group id="kwrds0010">
      <title>Keywords</title>
      <kwd>Plant biology</kwd>
      <kwd>Systems biology</kwd>
      <kwd>Bioinformatics</kwd>
      <kwd>Genetics</kwd>
      <kwd>Transcriptomics</kwd>
      <kwd>Sequencing</kwd>
      <kwd>Variation</kwd>
      <kwd>Parallel</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <label>1</label>
    <title>Introduction</title>
    <p id="p0010">In the past few years, there have been many advances made in the high throughput sequencing technologies (<xref rid="bib1" ref-type="bibr">Altmann et al., 2012</xref>), including Illumina, Applied Biosystems SOLiD System, 454 Life Sciences, Helicos HeliScope, and, most recently, PacBio and Nanopores. Due to these advances, the genomes of many species have been released. Hence, it is now possible to detect potential disease/trait-related variants. Sometimes, next generation sequencing (NGS) data is even used for diagnostic purposes. This is partially due to the development of sequencing technologies and the capacity of the various bioinformatics tools developed to analyze the growing numbers of sequencing datasets (<xref rid="bib6" ref-type="bibr">Mielczarek and Szyda, 2016</xref>).</p>
    <p id="p0015">To detect genetic variants that mark individual variations as distinct from the reference genome, a number of tools have been developed, including GATK-HC (Genome Analysis Tool Kit Haplotype Caller) (<xref rid="bib5" ref-type="bibr">McKenna et al., 2010</xref>), samtools mpileup (<xref rid="bib3" ref-type="bibr">Li et al., 2009a</xref>), freebayes (<xref rid="bib2" ref-type="bibr">Garrison and Marth, 2013</xref>), SOAPsnp (<xref rid="bib4" ref-type="bibr">Li et al., 2009b</xref>) and sambamba (<xref rid="bib7" ref-type="bibr">Tarasov et al., 2015</xref>). Although these tools have some advantages and disadvantages, they have been used to identify a large number of useful variations for disease diagnostics and crop breeding (<xref rid="bib8" ref-type="bibr">Zhou et al., 2016</xref>).</p>
    <p id="p0020">As the price of sequencing drops, more individuals are being sequenced to compare population genetic differences. However, most of the current tools are single-thread or cannot be run on multiple nodes (<xref rid="tbl1" ref-type="table">Table 1</xref>). Although sambamba supports multiple threads (<xref rid="bib7" ref-type="bibr">Tarasov et al., 2015</xref>), the jobs still cannot be assigned onto multiple nodes. This issue also exists in Freebayes-parallel. A new library of GATK (GenotypeGVCFs) has also been introduced to run on multiple threads, however, the final quality score of each variation only uses average values, which may be unacceptable. Spark-GATK (<ext-link ext-link-type="uri" xlink:href="https://github.com/PAA-NCIC/Spark-GATK" id="intref0010">https://github.com/PAA-NCIC/Spark-GATK</ext-link>) supports multiple nodes, which is built on spark cluster and could not run on other popular clusters, such as LSF. Therefore, the speed of data analysis is still the bottleneck, especially for multiple samples of large genomes. Addressing the speed problem matters for both diagnostics and analyzing and sharing computation resources. Introducing new tools supporting multiple threads and nodes can accelerate the variation detecting process.<table-wrap position="float" id="tbl1"><label>Table 1</label><caption><p>Comparison of different variation detection tools.</p></caption><alt-text id="alttext0045">Table 1</alt-text><table frame="hsides" rules="groups"><thead><tr><th>Software</th><th>Multi-sample</th><th>Multi-thread</th><th>Multi-node</th></tr></thead><tbody><tr><td>samtools</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>GATK</td><td>Yes</td><td>Yes</td><td>Yes</td></tr><tr><td>SOAPsnp</td><td>No</td><td>No</td><td>No</td></tr><tr><td>freebayes</td><td>Yes</td><td>Yes</td><td>No</td></tr><tr><td>sambamba</td><td>Yes</td><td>Yes</td><td>No</td></tr></tbody></table></table-wrap></p>
    <p id="p0025">To accelerate variation detection, we developed PVCTools (Parallel Variation Calling Tools), a new software that fully utilizes the parallel processing resources of the server. PVCTools is written in C++, and all internal jobs can be assigned on different nodes and threads. In this way, PVCTools can run much faster than current variation detection tools.</p>
  </sec>
  <sec id="sec2">
    <label>2</label>
    <title>Results</title>
    <sec id="sec2.1">
      <label>2.1</label>
      <title>Datasets</title>
      <p id="p0030">To test the performance of PVCTools, three different datasets, from Arabidopsis (<ext-link ext-link-type="uri" xlink:href="http://mtweb.cs.ucl.ac.uk/mus/www/19genomes/" id="intref0015">http://mtweb.cs.ucl.ac.uk/mus/www/19genomes/</ext-link>), Rice (<ext-link ext-link-type="uri" xlink:href="http://iric.irri.org/resources/3000-genomes-project" id="intref0020">http://iric.irri.org/resources/3000-genomes-project</ext-link>) and Human (<ext-link ext-link-type="uri" xlink:href="http://www.internationalgenome.org/data/" id="intref0025">http://www.internationalgenome.org/data/</ext-link>), with different genome sizes, were selected (<xref rid="tbl2" ref-type="table">Table 2</xref>).<table-wrap position="float" id="tbl2"><label>Table 2</label><caption><p>The information for three test datasets.</p></caption><alt-text id="alttext0050">Table 2</alt-text><table frame="hsides" rules="groups"><thead><tr><th>Species</th><th>Genome size</th><th>Number of samples</th><th>Sequencing depth</th></tr></thead><tbody><tr><td><italic>Arabidopsis thaliana</italic></td><td>125 Mb</td><td>17</td><td>36.7X</td></tr><tr><td><italic>Oryza sativa</italic></td><td>420 Mb</td><td>20</td><td>10.0X</td></tr><tr><td><italic>Homo sapiens</italic></td><td>3.2 Gb</td><td>20</td><td>7.7X</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="sec2.2">
      <label>2.2</label>
      <title>Benchmark</title>
      <p id="p0035">We compared PVCTools with other popular tools (samtools, GATK, freebayes and sambamba) for performance and accuracy.</p>
      <p id="p0040">For performance, we compared PVCTools with other tools in speed and memory usage.</p>
      <p id="p0045">For accuracy, three criteria were defined and measured. If we define <bold>m</bold> as the variations detected by PVCTools, <bold>n</bold> is the variations detected by other tools. <bold>l</bold> is the intersection between <bold>m</bold> and <bold>n</bold>, and <bold>p</bold> is the number of different variations between <bold>m</bold> and <bold>n</bold>.<list list-type="simple" id="olist0010"><list-item id="o0010"><label>▪</label><p id="p0050">Missing rate</p></list-item></list><disp-formula id="ufd1"><mml:math id="M1" altimg="si1.svg"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:mi>m</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><list list-type="simple" id="olist0015"><list-item id="o0015"><label>▪</label><p id="p0055">Difference rate</p></list-item></list><disp-formula id="ufd2"><mml:math id="M2" altimg="si2.svg"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.25em"/><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mspace width="0.25em"/><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>w</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mspace width="0.25em"/><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mo linebreak="badbreak">≥</mml:mo><mml:mn>5</mml:mn><mml:mtext>%</mml:mtext></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mspace width="0.25em"/><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.25em"/><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mspace width="0.25em"/><mml:mi>l</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><list list-type="simple" id="olist0020"><list-item id="o0020"><label>▪</label><p id="p0060">Correlation</p></list-item></list></p>
      <p id="p0065">The correlation of variation scores in l (score difference ≤5%).</p>
    </sec>
    <sec id="sec2.3">
      <label>2.3</label>
      <title>The results of the Arabidopsis dataset</title>
      <p id="p0070">For each test dataset, we compared PVCTools with other tools using single sample and multiple sample datasets. From the results for the Arabidopsis dataset (<xref rid="fig1" ref-type="fig">Fig. 1</xref>), we find that PVCTools has similar speeds to samtools, freebayes and sambamba, around 1–2 h. PVCTools is a little faster than GATK, especially using more than 30 threads (more than one nodes). However, for multiple sample analysis, PVCTools runs much faster than other tools, especially when using more CPUs on multiple nodes. For example, the time is reduced from around 50 h to around 10 h. Although the memory usage of PVCTools is much larger than other tools (around 40GB), the resource is not very limited for current servers.<fig id="fig1"><label>Fig. 1</label><caption><p>The result for the Arabidopsis test dataset. (a) Speed comparison between PVCTools and other tools using a single sample dataset. (b) Memory comparison between PVCTools and other tools using a single sample dataset. (c) Speed comparison between PVCTools and other tools using a multiple sample dataset. (d) Memory comparison between PVCTools and other tools using a multiple sample dataset. Note: X-axis represents the available computer resource for each tool.</p></caption><alt-text id="alttext0010">Fig. 1</alt-text><graphic xlink:href="gr1"/></fig></p>
      <p id="p0075">Moreover, as shown in <xref rid="fig2" ref-type="fig">Fig. 2</xref>, compared to samtools, the difference rate for PVCTools is approximately 1/1000, the missing rate is approximately 1/10000, and the correlation for PVCTools is more than 0.99. Similar results are also found for GATK and freebayes (Figs. <xref rid="fig3" ref-type="fig">3</xref> and <xref rid="fig4" ref-type="fig">4</xref>). In other words, PVCTools is faster than other tools while maintaining similar accuracy.<fig id="fig2"><label>Fig. 2</label><caption><p>Accuracy comparison between PVCTools and samtools. (a) Missing rate comparison between PVCTools and samtools for a single sample. (b) Difference rate comparison between PVCTools and samtools for a single sample. (c) Correlation comparison between PVCTools and samtools for a single sample. (d) Missing rate comparison between PVCTools and samtools for multiple samples. (e) Difference rate comparison between PVCTools and samtools for multiple samples. (f) Correlation comparison between PVCTools and samtools for multiple samples. Note: X-axis represents the available computer resource for each tool.</p></caption><alt-text id="alttext0015">Fig. 2</alt-text><graphic xlink:href="gr2"/></fig><fig id="fig3"><label>Fig. 3</label><caption><p>Accuracy comparison between PVCTools and GATK. (a) Missing rate comparison between PVCTools and GATK for a single sample. (b) Difference rate comparison between PVCTools and GATK for a single sample. (c) Correlation comparison between PVCTools and GATK for a single sample. (d) Missing rate comparison between PVCTools and GATK for multiple samples. (e) Difference rate comparison between PVCTools and GATK for multiple samples. (f) Correlation comparison between PVCTools and GATK for multiple samples. Note: The X-axis represents the available computer resource for each tool.</p></caption><alt-text id="alttext0020">Fig. 3</alt-text><graphic xlink:href="gr3"/></fig><fig id="fig4"><label>Fig. 4</label><caption><p>Accuracy comparison between PVCTools and freebayes. (a) Missing rate comparison between PVCTools and freebayes for a single sample. (b) Difference rate comparison between PVCTools and freebayes for a single sample. (c) Correlation comparison between PVCTools and freebayes for a single sample. (d) Missing rate comparison between PVCTools and freebayes for multiple samples. (e) Difference rate comparison between PVCTools and freebayes for multiple samples. (f) Correlation comparison between PVCTools and freebayes for multiple samples. Note: The X-axis represents the available computer resource for each tool.</p></caption><alt-text id="alttext0025">Fig. 4</alt-text><graphic xlink:href="gr4"/></fig></p>
    </sec>
    <sec id="sec2.4">
      <label>2.4</label>
      <title>The results of the rice dataset</title>
      <p id="p0080">Similar results can be found for the Rice dataset (<xref rid="fig5" ref-type="fig">Fig. 5</xref>). PVCTools has similar speed to samtools, freebayes and sambamba, around 3–5 h. PVCTools is a little faster than GATK, especially using more than 30 threads (more than one nodes). However, for multiple sample analysis, PVCTools also runs much faster than other tools (sometimes 3–4 times, from around 50 h to 6–7 h). Memory usage of PVCTools with the Rice dataset is also similar to that of the Arabidopsis dataset. For accuracy comparisons, we also reach similar conclusions (the difference rate is approximately 1/1000, the missing rate is approximately 1/10000, and the correlation is more than 0.99) (<xref rid="fig2" ref-type="fig">Fig. 2</xref>).<fig id="fig5"><label>Fig. 5</label><caption><p>The result for the Rice test dataset. (a) Speed comparison between PVCTools and other tools using a single sample dataset. (b) Memory comparison between PVCTools and other tools using a single sample dataset. (c) Speed comparison between PVCTools and other tools using a multiple sample dataset. (d) Memory comparison between PVCTools and other tools using a multiple sample dataset. Note: X-axis represents the available computer resource for each tool.</p></caption><alt-text id="alttext0030">Fig. 5</alt-text><graphic xlink:href="gr5"/></fig></p>
    </sec>
    <sec id="sec2.5">
      <label>2.5</label>
      <title>The results of the human dataset</title>
      <p id="p0085">PVCTools has similar speeds to samtools, freebayes and sambamba and is a little faster than GATK on the human dataset (<xref rid="fig6" ref-type="fig">Fig. 6</xref>). For multiple sample analysis, PVCTools runs much faster than other tools (sometimes more than 5 times, from around 150 h–20 h). In other words, for sequencing datasets from large genomes, PVCTools has more advantages than other tools. Even for a large genome, such as the human genome, memory usage (around 80GB) is still acceptable for most servers. The most important characteristic is that PVCTools also maintains high accuracy (the difference rate is approximately 1/1000, the missing rate is approximately 1/10000, and the correlation is more than 0.99) (<xref rid="fig2" ref-type="fig">Fig. 2</xref>).<fig id="fig6"><label>Fig. 6</label><caption><p>The result for the Human test dataset. (a) Speed comparison between PVCTools and other tools using a single sample dataset. (b) Memory comparison between PVCTools and other tools using a single sample dataset. (c) Speed comparison between PVCTools and other tools using a multiple samples dataset. (d) Memory comparison between PVCTools and other tools using a multiple samples dataset. Note: X-axis represents the available computer resource for each tool.</p></caption><alt-text id="alttext0035">Fig. 6</alt-text><graphic xlink:href="gr6"/></fig></p>
    </sec>
  </sec>
  <sec id="sec3">
    <label>3</label>
    <title>Conclusion</title>
    <p id="p0090">PVCTools is a parallel variation calling tool that tries to fully utilize computer resources. By splitting reference genome and alignment files, PVCTools achieves improvements in speed. The results on three different test datasets reveal that PVCTools not only is a faster variation calling process but also achieves a similar level of accuracy as other tools. The reduction of sequencing costs and the growing number of samples makes such performance improvements increasingly relevant.</p>
  </sec>
  <sec id="sec4">
    <label>4</label>
    <title>Materials and methods</title>
    <sec id="sec4.1">
      <label>4.1</label>
      <title>Implementation</title>
      <p id="p0095">PVCTools is a Linux-based pipeline implementing a fully integrative analysis workflow. Standard input and output formats, such as fasta/fastq, BAM and vcf output formats are used to facilitate users. The architecture of PVCTools contains four steps, consisting of the following:<list list-type="simple" id="olist0025"><list-item id="o0025"><label>▪</label><p id="p0100">Split the reference genome into smaller pieces</p></list-item><list-item id="o0030"><label>▪</label><p id="p0105">Split alignment files (BAM) into smaller pieces</p></list-item><list-item id="o0035"><label>▪</label><p id="p0110">Run variation detection jobs in multiple nodes and threads</p></list-item><list-item id="o0040"><label>▪</label><p id="p0115">Merge variation files and modify location of variation</p></list-item></list></p>
      <p id="p0120">Each step is described in detail below, and the workflow of the pipeline is visualized in <xref rid="fig7" ref-type="fig">Fig. 7</xref>. More details for usage are described at <ext-link ext-link-type="uri" xlink:href="https://github.com/CNaibon/PVCTools" id="intref0030">https://github.com/CNaibon/PVCTools</ext-link>.<fig id="fig7"><label>Fig. 7</label><caption><p>The pipeline of PVCTools.</p></caption><alt-text id="alttext0040">Fig. 7</alt-text><graphic xlink:href="gr7"/></fig></p>
      <sec id="sec4.1.1">
        <label>4.1.1</label>
        <title>Step one: split the genome</title>
        <p id="p0125">PVCTools will split relative inputs into smaller pieces to accelerate data analysis. Therefore, the reference genome file is first split into smaller pieces. Users can split the reference genome according to the chromosomes. Moreover, each chromosome can be cut into much smaller pieces according to requirements. At the same time, the modified location for the splitting place is recorded for further analysis. To reduce noise in the boundary of splitting a genome, a region (longer than the sequencing reads) will be kept for each piece.</p>
      </sec>
      <sec id="sec4.1.2">
        <label>4.1.2</label>
        <title>Step two: split the alignment file</title>
        <p id="p0130">According to the split results from step one, the alignment file is further split. Finally, each splitting piece from the reference genome will have a corresponding alignment file from each sample. Meanwhile, the map location will be modified for the new relative locations in the reference genome, and the absolute location will also be recorded for further analysis.</p>
      </sec>
      <sec id="sec4.1.3">
        <label>4.1.3</label>
        <title>Step three: run the variation calling jobs</title>
        <p id="p0135">Based on the job mode in the operating system, batch variation calling jobs will be generated for different pieces from the reference genome. PVCTools supports samtools, GATK and freebayes to detect variations. These jobs will be parallel run in different threads and nodes according to the user's requirement. The corresponding result file (vcf) will be obtained for each job, and the relative location for each vcf file will be modified to an absolute location.</p>
      </sec>
      <sec id="sec4.1.4">
        <label>4.1.4</label>
        <title>Step four: merge the variation results</title>
        <p id="p0140">The corresponding vcf result files will be merged into the final result file for users.</p>
        <p id="p0145">According to the above algorithm, there are nine modules in PVCTools, including GetVCF, SplitFA, SegmentFA, SplitBAM, SegmentBAM, Submit, SmallFA and Environment.<list list-type="simple" id="olist0030"><list-item id="o0045"><label>▪</label><p id="p0150">GetVCF: This module executes all the modules in PVCTools, and outputs the final variation vcf file to users.</p></list-item><list-item id="o0050"><label>▪</label><p id="p0155">SplitFA: This module splits reference genome file by chromosome.</p></list-item><list-item id="o0055"><label>▪</label><p id="p0160">SegmentFA: This module splits longer chromosome into smaller pieces.</p></list-item><list-item id="o0060"><label>▪</label><p id="p0165">SplitBAM: This module splits alignment file by chromosome.</p></list-item><list-item id="o0065"><label>▪</label><p id="p0170">SegmentBAM: This module splits alignment file related to longer chromosome into smaller pieces.</p></list-item><list-item id="o0070"><label>▪</label><p id="p0175">Submit: This module submits batch jobs and assigns them onto multiple nodes/threads.</p></list-item><list-item id="o0075"><label>▪</label><p id="p0180">SmallFA: This module executes batch jobs related to smaller chromosome.</p></list-item><list-item id="o0080"><label>▪</label><p id="p0185">Environment: This module changes environment parameters.</p></list-item></list></p>
        <p id="p0190">Users can run the entire set of modules with one command and can run each individual module according to their requirements.</p>
      </sec>
    </sec>
    <sec id="sec4.2">
      <label>4.2</label>
      <title>Availability and requirements</title>
      <p id="p0195"><bold>Project name</bold>: PVCTools</p>
      <p id="p0200"><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://github.com/CNaibon/PVCTools" id="intref0035">https://github.com/CNaibon/PVCTools</ext-link></p>
      <p id="p0205"><bold>Operating system</bold>: Linux (20 nodes)</p>
      <p id="p0210">Cluster: LSF</p>
      <p id="p0215">CPU: 12 cores (4 Intel Gold-6126)</p>
      <p id="p0220">RAM: 512G</p>
      <p id="p0225"><bold>Programming language</bold>: C++</p>
      <p id="p0230"><bold>Other requirements</bold>: samtools, GATK, bamUtil, freebayes</p>
      <p id="p0235"><bold>License</bold>: GNU GPLv2</p>
      <p id="p0240"><bold>Any restrictions to use by non-academics</bold>: None</p>
    </sec>
  </sec>
  <sec id="sec5">
    <title>Declarations</title>
    <sec id="sec5.1">
      <title>Author contribution statement</title>
      <p id="p0245">Jingjing Jin: Conceived and designed the experiments; Performed the experiments; Wrote the paper.</p>
      <p id="p0250">Jiajun Liu: Conceived and designed the experiments; Performed the experiments.</p>
      <p id="p0255">Yelin Yin, Peng Lu, Jianfeng Zhang: Analyzed and interpreted the data.</p>
      <p id="p0260">Zefeng Li: Analyzed and interpreted the data; Contributed reagents, materials, analysis tools or data.</p>
      <p id="p0265">Yalong Xu: Contributed reagents, materials, analysis tools or data.</p>
      <p id="p0270">Peijian Cao, Dasha Hu: Conceived and designed the experiments; Wrote the paper.</p>
    </sec>
    <sec id="sec5.2">
      <title>Funding statement</title>
      <p id="p0275">This work was supported by the <funding-source id="gs1">Projects of Parallel Variation Calling Tools</funding-source> (902015CA0250), <funding-source id="gs2">ENCODE of Tobacco Genome</funding-source> (110201601033 (JY-07)) and the <funding-source id="gs3">Young Elite Scientists Sponsorship Program</funding-source> by CAST (2016QNRC001).</p>
    </sec>
    <sec id="sec5.3">
      <title>Competing interest statement</title>
      <p id="p0280">The authors declare no conflict of interest.</p>
    </sec>
    <sec id="sec5.4">
      <title>Additional information</title>
      <p id="p0285">No additional information is available for this paper.</p>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Altmann</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>A beginners guide to SNP calling from high-throughput DNA-sequencing data</article-title>
        <source>Hum. Genet.</source>
        <volume>131</volume>
        <issue>10</issue>
        <year>2012</year>
        <fpage>1541</fpage>
        <lpage>1554</lpage>
        <pub-id pub-id-type="pmid">22886560</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <element-citation publication-type="book" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Garrison</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <chapter-title>Haplotype-based variant detection from short-read sequencing</chapter-title>
        <year>2013</year>
        <comment>arXiv: 1207.3907</comment>
      </element-citation>
    </ref>
    <ref id="bib3">
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <volume>25</volume>
        <issue>16</issue>
        <year>2009</year>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>SNP detection for massively parallel whole-genome resequencing</article-title>
        <source>Genome Res.</source>
        <volume>19</volume>
        <issue>6</issue>
        <year>2009</year>
        <fpage>1124</fpage>
        <lpage>1132</lpage>
        <pub-id pub-id-type="pmid">19420381</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>Genome Res.</source>
        <volume>20</volume>
        <issue>9</issue>
        <year>2010</year>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Mielczarek</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Szyda</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Review of alignment and SNP calling algorithms for next-generation sequencing data</article-title>
        <source>J. Appl. Genet.</source>
        <volume>57</volume>
        <issue>1</issue>
        <year>2016</year>
        <fpage>71</fpage>
        <lpage>79</lpage>
        <pub-id pub-id-type="pmid">26055432</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Tarasov</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Vilella</surname>
            <given-names>A.J.</given-names>
          </name>
        </person-group>
        <article-title>Sambamba: fast processing of NGS alignment formats</article-title>
        <source>Bioinformatics</source>
        <volume>31</volume>
        <issue>12</issue>
        <year>2015</year>
        <fpage>2032</fpage>
        <lpage>2034</lpage>
        <pub-id pub-id-type="pmid">25697820</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Convergence and divergence of bitterness biosynthesis and regulation in Cucurbitaceae</article-title>
        <source>Nat. Plants</source>
        <volume>2</volume>
        <year>2016</year>
        <fpage>16183</fpage>
        <pub-id pub-id-type="pmid">27892922</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
