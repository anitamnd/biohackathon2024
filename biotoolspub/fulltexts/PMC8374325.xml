<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_MEX101318 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEfx1 jpg ?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">MethodsX</journal-id>
    <journal-id journal-id-type="iso-abbrev">MethodsX</journal-id>
    <journal-title-group>
      <journal-title>MethodsX</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2215-0161</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8374325</article-id>
    <article-id pub-id-type="pii">S2215-0161(21)00111-4</article-id>
    <article-id pub-id-type="doi">10.1016/j.mex.2021.101318</article-id>
    <article-id pub-id-type="publisher-id">101318</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>‘SleepCycles’ package for R - A free software tool for the detection of sleep cycles from sleep staging</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au0001">
        <name>
          <surname>Blume</surname>
          <given-names>Christine</given-names>
        </name>
        <email>christine.blume@upk.ch</email>
        <xref rid="aff0001" ref-type="aff">a</xref>
        <xref rid="cor0001" ref-type="corresp">⁎</xref>
      </contrib>
      <contrib contrib-type="author" id="au0002">
        <name>
          <surname>Cajochen</surname>
          <given-names>Christian</given-names>
        </name>
        <xref rid="aff0002" ref-type="aff">b</xref>
      </contrib>
      <aff id="aff0001"><label>a</label>Centre for Chronobiology, Psychiatric Hospital of the University of Basel, Basel, Switzerland</aff>
      <aff id="aff0002"><label>b</label>Transfaculty Research Platform Molecular and Cognitive Neurosciences, University of Basel, Basel, Switzerland</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor0001"><label>⁎</label>Corresponding author. <email>christine.blume@upk.ch</email></corresp>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>101318</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 The Authors</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0001">
      <p>The detection of NREM-REM sleep cycles in human sleep data (i.e., polysomnographically assessed sleep stages) enables fine-grained analyses of ultradian variations in sleep microstructure (e.g., sleep spindles, and arousals), or other amplitude- and frequency-specific electroencephalographic features during sleep. While many laboratories have software that is used internally, reproducibility requires the availability of open-source software. Therefore, we here introduce the ‘SleepCycles’ package for R, an open-source software package that identifies sleep cycles and their respective (non-) rapid eye movement ([N]REM) periods from sleep staging data. Additionally, each (N)REM period is subdivided into parts of equal duration (percentiles), which may be useful for further fine-grained analyses. The detection criteria used in the package are, with some adaptations, largely based on criteria originally proposed by Feinberg and Floyd (1979). The latest version of the package can be downloaded from the Comprehensive R Archives Network (CRAN).<list list-type="simple" id="celist0001"><list-item id="celistitem0001"><label>•</label><p id="para0003">The package ‘SleepCycles’ for R allows to identify sleep cycles and their respective NREM and REM periods from sleep staging results.</p></list-item><list-item id="celistitem0002"><label>•</label><p id="para0004">Besides the cycle detection, NREM and REM periods are also split into parts of equal duration (percentiles) thereby allowing for a better temporal resolution across the night and comparisons of sleep cycles with different durations amongst different night recordings.</p></list-item></list></p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0002">
      <title>Graphical abstract</title>
      <p>
        <fig id="fig0004" position="anchor">
          <alt-text id="alttx001">Image, graphical abstract</alt-text>
          <graphic xlink:href="fx1"/>
        </fig>
      </p>
    </abstract>
    <kwd-group id="keys0001">
      <title>Keywords</title>
      <kwd>Sleep</kwd>
      <kwd>Sleep cycles</kwd>
      <kwd>Sleep staging</kwd>
      <kwd>Circadian rhythm</kwd>
      <kwd>R</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="nom0001">
    <title>List of abbreviations</title>
    <def-list>
      <def-item>
        <term id="dt0001">AASM</term>
        <def>
          <p id="para0005">American Association of Sleep Medicine</p>
        </def>
      </def-item>
      <def-item>
        <term id="dt0002">CRAN</term>
        <def>
          <p id="para0006">Comprehensive R Archives Network</p>
        </def>
      </def-item>
      <def-item>
        <term id="dt0003">EEG</term>
        <def>
          <p id="para0007">Electroencephalogram</p>
        </def>
      </def-item>
      <def-item>
        <term id="dt0004">EOG</term>
        <def>
          <p id="para0008">Electrooculogram</p>
        </def>
      </def-item>
      <def-item>
        <term id="dt0005">EMG</term>
        <def>
          <p id="para0009">Electromyogram</p>
        </def>
      </def-item>
      <def-item>
        <term id="dt0006">NREM</term>
        <def>
          <p id="para0010">Non-rapid eye movement</p>
        </def>
      </def-item>
      <def-item>
        <term id="dt0007">NREMP</term>
        <def>
          <p id="para0011">Non-rapid eye movement (sleep) period</p>
        </def>
      </def-item>
      <def-item>
        <term id="dt0008">PSG</term>
        <def>
          <p id="para0012">Polysomnography</p>
        </def>
      </def-item>
      <def-item>
        <term id="dt0009">R</term>
        <def>
          <p id="para0013">Name of the software in which the package was written</p>
        </def>
      </def-item>
      <def-item>
        <term id="dt0010">REM</term>
        <def>
          <p id="para0014">Rapid eye movement</p>
        </def>
      </def-item>
      <def-item>
        <term id="dt0011">REMP</term>
        <def>
          <p id="para0015">Rapid eye movement (sleep) period</p>
        </def>
      </def-item>
      <def-item>
        <term id="dt0012">R&amp;K</term>
        <def>
          <p id="para0016">Rechtschaffen &amp; Kales</p>
        </def>
      </def-item>
    </def-list>
  </sec>
  <sec>
    <p id="para0017">
      <table-wrap position="float" id="utbl0001">
        <caption>
          <p>Specifications Table</p>
        </caption>
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td valign="top">Subject Area</td>
              <td valign="top">Neuroscience</td>
            </tr>
            <tr>
              <td valign="top">More specific subject area</td>
              <td valign="top">
                <italic>Chronobiology; sleep research</italic>
              </td>
            </tr>
            <tr>
              <td valign="top">Method name</td>
              <td valign="top">
                <italic>Detection of sleep cycles</italic>
              </td>
            </tr>
            <tr>
              <td valign="top">Name and reference of original method</td>
              <td valign="top">
                <italic>Feinberg, I., &amp; Floyd, T. (1979). Systematic trends across the night in human sleep cycles. Psychophysiology, 16(3), 283–291</italic>
              </td>
            </tr>
            <tr>
              <td valign="top">Resource availability</td>
              <td valign="top">
                <ext-link ext-link-type="uri" xlink:href="https://github.com/ChristineBlume/SleepCycles" id="interref0001">https://github.com/ChristineBlume/SleepCycles</ext-link>
                <break/>
                <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/SleepCycles/index.html" id="interref0002">https://cran.r-project.org/web/packages/SleepCycles/index.html</ext-link>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </p>
    <sec id="sec0001">
      <title>Method details</title>
      <sec id="sec0002">
        <title>Introduction</title>
        <p id="para0018">In human sleep research, sleep medicine, and chronobiology, the ‘gold standard’ of sleep assessment is the so-called polysomnography (PSG). This method needs to include measurements of brain activity (electroencephalogram; EEG), muscle tone (electromyogram; EMG), and eye movements (electrooculogram; EOG) to allow for subsequent sleep staging, i.e. the assignment of sleep stages to 30 second epochs of signal (cf. <xref rid="bib0001" ref-type="bibr">[1]</xref>). The first formal approach to categorising different sleep stages in human adults based on the signal patterns in the PSG traces back to A. Rechtschaffen and A. Kales (R&amp;K criteria) <xref rid="bib0021" ref-type="bibr">[21]</xref>. According to these criteria, six different sleep stages are distinguished: wake, non-rapid eye movement (NREM) sleep stages S1-S4 (representing a continuum of increasing sleep depth), and rapid eye movement (REM) sleep (cf. <xref rid="tbl0001" ref-type="table">Table 1</xref>). Since 2007, the R&amp;K criteria have largely been replaced by the rules of the American Academy of Sleep Medicine (AASM; <xref rid="bib0001" ref-type="bibr">[1]</xref>). Besides smaller changes in terminology, that is, NREM sleep stages are denoted by a capital ‘N’ rather than ‘S’, the major difference that is relevant in the context of the software package described here is that deep sleep stages S3 and S4, which differ in the proportion of slow waves, were combined into stage N3. Thus, according to the AASM criteria, there are only five sleep stages (cf. <xref rid="tbl0001" ref-type="table">Table 1</xref>; note that the ‘SleepCycles’ package can still handle results from sleep staging according to R&amp;K criteria, see below).<table-wrap position="float" id="tbl0001"><label>Table 1</label><caption><p>Sleep stages in humans according to Rechtschaffen and Kales (R&amp;K) criteria and the criteria of the American Association of Sleep Medicine (AASM).</p></caption><alt-text id="alt0004">Table 1</alt-text><table frame="hsides" rules="groups"><thead><tr><th valign="top"/><th valign="top">Rechtschaffen and Kales <xref rid="bib0021" ref-type="bibr">[21]</xref></th><th valign="top">AmericanAcademy of Sleep Medicine <xref rid="bib0001" ref-type="bibr">[1]</xref></th></tr></thead><tbody><tr><td valign="top">Wake</td><td valign="top">W (0)</td><td valign="top">W (0)</td></tr><tr><td align="left" rowspan="4" valign="top">Non-rapid eye movement (NREM) sleep stages</td><td valign="top">S1 (1)</td><td valign="top">N1 (1)</td></tr><tr><td valign="top">S2 (2)</td><td valign="top">N2 (2)</td></tr><tr><td valign="top">S3 (3)</td><td align="left" rowspan="2" valign="top">N3 (3)</td></tr><tr><td valign="top">S4 (4)</td></tr><tr><td valign="top">Rapid-eye movement (REM) sleep</td><td valign="top">REM (5)</td><td valign="top">REM (5)</td></tr></tbody></table><table-wrap-foot><fn><p>The numbers in brackets denote the numeric value that sleep stages are commonly assigned and which the ‘SleepCycles’ package requires as an input (for details see below).</p></fn></table-wrap-foot></table-wrap></p>
        <p id="para0019">Over the course of a sleep episode, NREM and REM sleep periods alternate in a cyclic fashion (cf. <xref rid="fig0001" ref-type="fig">Fig. 1</xref>), a pattern that has first been described as early as in the 1950s <xref rid="bib0002" ref-type="bibr">[2</xref>,<xref rid="bib0003" ref-type="bibr">3</xref>,<xref rid="bib0009" ref-type="bibr">9]</xref>. Somewhat later, Feinberg and Floyd <xref rid="bib0012" ref-type="bibr">[12]</xref> were the first to propose formal criteria to describe these NREM-REM cycles and their criteria have since been adopted and applied by many researchers. In healthy individuals, a sleep episode begins with N1 sleep, which is followed by N2 and N3 sleep, and finally REM. Following REM, the next sequence of N1, N2, N3, and REM sleep, that is, the next cycle, begins. Deviations from this cyclic pattern can have diagnostic relevance for certain sleep disorders such as narcolepsy, which is characterised by a tendency to start sleep with a REM episode <xref rid="bib0015" ref-type="bibr">[15]</xref>.<fig id="fig0001"><label>Fig. 1</label><caption><p><bold>Examples of sleep cycles detected with the ‘SleepCycles’ package.</bold> Above the hypnogram, i.e. the succession of sleep stages, the NREM and REM periods of each cycle have been marked. Each NREM cycle usually comprises first a NREM (darker colours) and then a REM (yellow) period. (A) Regular night with NREM onset, no NREM period exceeds 120 min in duration. (B) The first detected sleep cycle comprised more than 240 epochs (i.e., 120 min) excluding wakefulness. Thus, the NREM period was split into two, where the first N3 epoch following a lightening of sleep (i.e., at least 12 min of any other stage than N3) marks the onset of the second period.</p></caption><alt-text id="alt0001">Fig. 1</alt-text><graphic xlink:href="gr1"/></fig></p>
        <p id="para0020">Usually, during an 8-hour sleep period, we experience four to five such NREM-REM sleep cycles each lasting about 90–120 min <xref rid="bib0006" ref-type="bibr">[6</xref>,<xref rid="bib0018" ref-type="bibr">18]</xref>. Especially in adolescents and young adults, the first REM period is however sometimes skipped (first described by <xref rid="bib0002" ref-type="bibr">[2</xref>,<xref rid="bib0003" ref-type="bibr">3]</xref>) and only a ‘lightening of sleep’, that is, a period of wake, N1 and/or N2, can be observed <xref rid="bib0013" ref-type="bibr">[13</xref>,<xref rid="bib0017" ref-type="bibr">17]</xref>. Importantly, throughout the night, the relative proportions of each sleep stage per cycle change. While healthy individuals have relatively large amounts of N3 sleep during the earlier sleep cycles, its proportion decreases or it disappears altogether as the night progresses (cf. <xref rid="fig0001" ref-type="fig">Fig. 1</xref>). This decrease in the amount of deep N3 sleep is paralleled by an increase in the amount of REM sleep with most REM sleep occurring in the final third of the night (cf. <xref rid="fig0001" ref-type="fig">Fig. 1</xref>). The variations also reflect changes in homoeostatic sleep drive and the circadian drive for wakefulness <xref rid="bib0005" ref-type="bibr">[5</xref>,<xref rid="bib0010" ref-type="bibr">10</xref>,<xref rid="bib0011" ref-type="bibr">11]</xref>.</p>
        <p id="para0021">For many sleep studies it is of interest to take sleep cycles into account as this allows to investigate the effects of certain interventions across physiologically and phenomenologically meaningful ‘chunks’ (e.g., effects of pre-sleep artificial light exposure on delta power in NREM periods across the night: <xref rid="bib0007" ref-type="bibr">[7]</xref>) or ultradian variations in sleep microstructure (e.g., sleep spindles: <xref rid="bib0008" ref-type="bibr">[8]</xref>; or arousals: <xref rid="bib0022" ref-type="bibr">[22]</xref>). However, the detection of sleep cycles is not trivial, partly because criteria such as those originally proposed by Feinberg and Floyd <xref rid="bib0012" ref-type="bibr">[12]</xref>, which the ‘SleepCycles’ package is largely based on, were initially not developed for a translation into code and are therefore sometimes underspecified. Moreover, the non-availability of (open source) software suggests that most solutions presumably stay inside laboratories, which hinders reproducibility. The ‘SleepCycles’ package for R provides a solution, which is easy to apply to any sleep staging results even for users, who are only little familiar with coding in R. The most recent version of the package can always be downloaded from the Comprehensive R Archives Network (CRAN) and is, just as R itself, open source. As the package will be updated from time to time, e.g. to ensure compatibility with other packages, we do not provide a zip file of the package along with this publication. Users are advised to regularly check CRAN for package updates.</p>
      </sec>
    </sec>
    <sec id="sec0003">
      <title>Method description</title>
      <sec id="sec0004">
        <title>Rules for detection</title>
        <p id="para0022">The ‘SleepCycles’ detection algorithm is largely based on the criteria originally proposed by Feinberg and Floyd <xref rid="bib0012" ref-type="bibr">[12]</xref> with some adaptations. <xref rid="tbl0002" ref-type="table">Table 2</xref> provides an overview of the differences between the original criteria and the ones implemented in the package. More precisely, NREM periods (NREMPs) are defined as periods that start with N1 (default option) or N2 at the beginning of the night. Following a REM period (REMP), wakefulness can also mark the beginning of a new NREMP. At this point, the settings represent an adaptation of the original criteria, where S2 instead of N1 marked the beginning of any NREMP. Regarding the first NREMP, we felt that starting with N1 better corresponds to the AASM criteria, which define sleep onset as any other sleep stage than wake <xref rid="bib0001" ref-type="bibr">[1]</xref>. Moreover, we feel that the first NREMP starting with N1 rather than N2 could increase the comparability of NREMPs across the night, but this choice is up to the user. Last, during the night, the adapted criteria are associated with a smoothing, which previously was presumably done manually to prevent wake and N1/S1 from being added to a preceding REMP and/or breaks between consecutive (N)REMPs. NREMPs have a minimal duration of 15 min, which can include wakefulness and up to &lt;5 min of REM sleep (except for the first REMP where no minimum duration criterion is applied). Thus, any REM sleep following the first NREMP automatically marks the beginning of the first REMP.<table-wrap position="float" id="tbl0002"><label>Table 2</label><caption><p>Criteria for the detection of sleep cycles and differences between criteria originally proposed by <xref rid="bib0012" ref-type="bibr">[12]</xref> and criteria used in the ‘SleepCycles’ package.</p></caption><alt-text id="alt0005">Table 2</alt-text><table frame="hsides" rules="groups"><thead><tr><th valign="top">Criterion</th><th valign="top">Feinberg and Floyd <xref rid="bib0012" ref-type="bibr">[12]</xref></th><th valign="top">‘SleepCycles’ package</th></tr></thead><tbody><tr><td valign="top">Start of NREMPs</td><td valign="top">S2</td><td valign="top">First sleep episode starts with N1 (default) or N2; following a REM period, it can also start with wake</td></tr><tr><td valign="top">Minimum duration of NREMPs</td><td colspan="2" align="left" valign="top">15 min (including wake before final awakening)</td></tr><tr><td valign="top">Maximum duration of NREMPs</td><td valign="top">–</td><td valign="top">120 min (excluding wake)</td></tr><tr><td valign="top">Splitting of NREMPs if duration exceeds 120 min (excl. wake)</td><td valign="top">–</td><td valign="top">Split at first N3 epoch following a period of 12 min with any other sleep stage than N3<sup>1</sup></td></tr><tr><td valign="top">Duration of REMPs</td><td colspan="2" align="left" valign="top">First REMP: no minimum duration; subsequent REMPs: minimum 5 minutes<sup>2</sup></td></tr><tr><td valign="top">Completeness of a (N)REMP</td><td colspan="2" align="left" valign="top">(N)REMP is followed by at least 5 min of (N)REM<sup>3</sup></td></tr></tbody></table><table-wrap-foot><fn><p>(N)REMP = (non-)rapid eye movement period; S1 = stage 1 sleep according to R&amp;K <xref rid="bib0021" ref-type="bibr">[21]</xref> criteria; N1/N3 = NREM sleep stage 1/3 according to the criteria of the American Association of Sleep Medicine (AASM, 2007). <sup>1</sup>Note that the code suggests potential splitting points that fulfil this criterion and in case there are several, users are asked to select one, provide a different point, or indicate that they do not want to split the NREMP (see below and <xref rid="fig0002" ref-type="fig">Fig. 2</xref>). <sup>2</sup>Note that, if there is an ‘obvious’ REMP, e.g. a sequence of REM epochs with a duration of for instance 4 or 4.5 min separating two longer periods without REM, that is NREMPs, which therefore does not meet the duration criterion, the minimum duration can be decreased using the ‘REMP_length’ criterion following careful consideration. <sup>3</sup>By default, incomplete (N)REMPs at the end of the night are not removed, can be changes in the ‘rm_incomplete_periods’ argument.</p></fn></table-wrap-foot></table-wrap></p>
        <p id="para0023">While there is no minimum duration criterion for the first REMP, any other REMP must be at least 5 min long. It can include wake or, theoretically, also short segments of NREM sleep and only ends when the criteria for a next NREMP are met. Especially in younger people or after benzodiazepine intake, the first NREMP can sometimes exceed 120 min in duration (excl. wake). This is because the first REM is skipped, and only a ‘lightening of sleep’ without the presence of REM sleep is observed <xref rid="bib0004" ref-type="bibr">[4</xref>,<xref rid="bib0013" ref-type="bibr">13</xref>,<xref rid="bib0017" ref-type="bibr">17]</xref>. In this case, the ‘SleepCycle’ algorithm suggests splitting this NREMP into two parts. Specifically, the new cycle should then start with the first N3 epoch following an episode(&gt;12 min; <xref rid="bib0013" ref-type="bibr">[13</xref>,<xref rid="bib0016" ref-type="bibr">16</xref>,<xref rid="bib0017" ref-type="bibr">17</xref>,<xref rid="bib0022" ref-type="bibr">22]</xref>) with any other stage than N3, i.e. a lightening of sleep <xref rid="bib0013" ref-type="bibr">[13</xref>,<xref rid="bib0017" ref-type="bibr">17]</xref>. The code generates suggestions where splitting could take place according to these criteria and informs the user about the duration of the two NREMPs that would result from the splitting (cf. <xref rid="fig0002" ref-type="fig">Fig. 2</xref>). Additionally, the potential splitting points are visualised on top of a hypnogram to allow for a better-informed decision. The user can then interactively choose where to split the NREMP. However, the code also offers the possibility to provide a numeric value for an epoch at which to split or users can decide to not split at all. In case the splitting criterion is not fulfilled despite a NREMP exceeding 120 min, users are notified that the NREMP cannot be split.<fig id="fig0002"><label>Fig. 2</label><caption><p><bold>Interactive splitting dialogue in case of a NREMP exceeding 120 min.</bold> The code suggests potential splitting points, which in this case is epoch 152. Specifically, epoch 152 is the first N3 epoch following a lightening of sleep, i.e. a period of any stage other than N3 for a minimum of 12 min. The dialogue in R's console additionally informs the user about how long the resulting NREMPs would be.</p></caption><alt-text id="alt0002">Fig. 2</alt-text><graphic xlink:href="gr2"/></fig></p>
        <p id="para0024">Any combination of a NREMP and the following REMP represents one NREM cycle, except for the case when a NREMP is split. In this case, the first of the two resulting NREMPs represents a sleep cycle (without REM).</p>
        <p id="para0025">In laboratory situations, participants are often woken up in the mornings, which may result in ‘incomplete’ sleep periods. In line with <xref rid="bib0012" ref-type="bibr">[12]</xref>, a REM or NREM sleep period at the end of the night is only considered complete if it is followed by at least five minutes of NREM or REM sleep before awakening, respectively. By default, the code does not remove incomplete sleep periods at the end, but the <italic>rm_incomplete_period</italic> argument can be used to do so.</p>
      </sec>
      <sec id="sec0005">
        <title>Package functions</title>
        <p id="para0026">The main function is the ‘SleepCycles’ function, which loops through all files in the directory <italic>p</italic>. It accepts the arguments listed in <xref rid="tbl0003" ref-type="table">Table 3</xref>. The other functions that come with the package are auxiliary functions and should not be changed, wherefore they are not readily visible to the users.<table-wrap position="float" id="tbl0003"><label>Table 3</label><caption><p>Arguments for the ‘SleepCycles’ function.</p></caption><alt-text id="alt0006">Table 3</alt-text><table frame="hsides" rules="groups"><thead><tr><th valign="top">Argument</th><th valign="top">Default value</th><th valign="top">Input</th></tr></thead><tbody><tr><td valign="top">p</td><td valign="top">–</td><td valign="top">Character string specifying the directory with the staging result files</td></tr><tr><td valign="top">sleepstart</td><td valign="top">“N1”</td><td valign="top">Character string specifying which sleep stage to start the first NREMP with. Can be “N1” (default) or “N2”</td></tr><tr><td valign="top">files</td><td valign="top">NA</td><td valign="top">Numeric vector indicating the files to process, e.g., c(2:5)</td></tr><tr><td valign="top">filetype</td><td valign="top">“txt”</td><td valign="top">“txt” or “vmrk”</td></tr><tr><td valign="top">treat_as_W</td><td valign="top">NA</td><td valign="top">Any numeric value to be treated as stage ‘Wake’</td></tr><tr><td valign="top">treat_as_N3</td><td valign="top">NA</td><td valign="top">Any numeric value to be treated as stage ‘N3’</td></tr><tr><td valign="top">rm_incomplete_period</td><td valign="top">FALSE</td><td valign="top">Logical value; specifies whether an incomplete period at the end should be removed. Default: FALSE.</td></tr><tr><td valign="top">plot</td><td valign="top">TRUE</td><td valign="top">Logical value; specifies whether the results of the analysis should be plotted and the plot saved at the end. Default: TRUE.</td></tr><tr><td valign="top">REMP_length</td><td valign="top">10</td><td valign="top">Numeric value specifying the minimum length of any REM period following the first. Default: 10. Should only be changed after careful consideration.</td></tr></tbody></table><table-wrap-foot><fn><p><italic>W</italic> = wake; REMP = REM period, NA = not available.</p></fn></table-wrap-foot></table-wrap></p>
      </sec>
      <sec id="sec0006">
        <title>Data requirements</title>
        <p id="para0027">The only requirement is that the input file(s) contain a numeric vector representing the sleep stages (i.e., 0, 1, 2, 3, and 5 according to AASM rules) that have been assigned to each 30 second epoch of a night. Multiple nights of the same or several individuals must be stored in different files and the function will loop through these. The package can also handle staging according to R&amp;K criteria; however, users will then have to specify that the numeric value ‘4′ should be treated as N3 in the <italic>treat_as_N3</italic> argument. Please note that at the time of writing this manuscript, the package cannot sleep staging data based on 20 second epochs. The package can also treat one other numeric value as ‘Wake’ using the <italic>treat_as_W</italic> argument, for instance sometimes epochs during which participants move are assigned a different numeric value. In case not all values present in the staging data have been specified, users will receive the error message ‘Please check your file. The vector with the staging seems to contain other numbers than the sleep stages or the numbers you want to treat as a sleep stage’. The code can handle text files (ending ‘.txt’) or BrainVision analyzer 2 marker files (ending ‘.vmrk’). The file type can be specified in the <italic>filetype</italic> argument (“txt” or “vmrk”, default is “txt”). Any further data columns besides the one containing the sleep staging, e.g. sampling points, will simply be copied to the output file and otherwise be ignored by the code. When reading in text files, users will be prompted to specify whether their data contains column names in the first row, i.e. a header, as well as the column separator (can be comma, semicolon, or tabulator).</p>
        <p id="para0028">Please note that staging criteria have originally been developed for adult PSG recordings, although there is a paediatric extension for AASM criteria <xref rid="bib0020" ref-type="bibr">[20]</xref>. Regarding sleep cycles, previous research by <xref rid="bib0017" ref-type="bibr">[17]</xref> suggested that from 2 years of age onwards, the average sleep cycle length remains stable until the age of 19. From this perspective, it seems plausible that the package can also be applied to data from children, although perhaps with some caution. Likewise, while the code should theoretically be able to handle changes in sleep across the lifespan such as decreased amounts of N3 and REM sleep, increased amounts of N1 and N2, and increased sleep fragmentation <xref rid="bib0019" ref-type="bibr">[19]</xref>, the performance of the detection may change. The same holds true for patients suffering from sleep fragmentation due to for example sleep-disordered breathing <xref rid="bib0014" ref-type="bibr">[14]</xref>. We therefore recommend to always review the detection results using the hypnograms with the detection results plotted on top (cf. <xref rid="fig0001" ref-type="fig">Fig. 1</xref>).</p>
      </sec>
      <sec id="sec0007">
        <title>Output</title>
        <p id="para0029">The detection algorithm compiles and saves a separate text (cf. <xref rid="fig0003" ref-type="fig">Fig. 3</xref>) file for each input file. It contains a ‘SleepStages’ column with the staging data the detection is based on, a ‘SleepCycle’ column with a numeric value specifying the NREM cycle (i.e., NREM and REM period), a ‘N_REM’ column, where ‘0′ denotes a NREM period and ‘1′ denotes REM period, as well as a column named ‘percentile’.<fig id="fig0003"><label>Fig. 3</label><caption><p><bold>Output file.</bold> The resulting text file contains the sleep staging data and gives the sleep cycle an epoch belongs to. Further, it contains information about whether an epoch belongs to a REM or NREM period (cf. ‘N_REM’ column) and which percentile of a (N)REMP it pertains to.</p></caption><alt-text id="alt0003">Fig. 3</alt-text><graphic xlink:href="gr3"/></fig></p>
        <p id="para0030">This latter column contains information about the percentile of a NREMP or REMP each epoch belongs to. If a (N)REMP comprises less than 10 epochs, they are all assigned the number ‘1′. In case the length of a period is not divisible by 10 (e.g., 203 epochs), one epoch is added to percentiles in a randomised fashion to reach the correct length of a period (here: 7 percentiles of 20 epochs, 3 of 21 epochs). All data available in the input file are also included in the output file for text files. For ‘vmrk’ files, the original ‘description’ column is renamed to ‘SleepStages’ and the ‘Channel’ and ‘Length’ columns are omitted as well as the first line, which includes information on the sampling rate.</p>
      </sec>
      <sec id="sec0008">
        <title>Examples</title>
        <p id="para0031">For examples, please see the package vignette.</p>
      </sec>
    </sec>
    <sec id="sec0009">
      <title>Funding</title>
      <p id="para0032">CB is supported by an FWF-funded Erwin-Schroedinger Fellowship (J-4243), a grant from the Freiwillige Akademische Gesellschaft Basel, a grant from the Psychiatric Hospital of the University of Basel, and a grant from the Novartis Foundation for Biological-Medical Research.</p>
    </sec>
  </sec>
  <sec sec-type="COI-statement">
    <title>Declaration of Competing Interest</title>
    <p id="para0033">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
  </sec>
</body>
<back>
  <ref-list id="cebibl1">
    <title>References</title>
    <ref id="bib0001">
      <label>1</label>
      <element-citation publication-type="book" id="sbref0001">
        <person-group person-group-type="author">
          <collab>AmericanAcademy of Sleep Medicine, &amp; Iber, C.</collab>
        </person-group>
        <chapter-title>The AASM Manual for the Scoring of Sleep and Associated events: Rules, Terminology and Technical Specifications</chapter-title>
        <year>2007</year>
        <publisher-name>American Academy of Sleep Medicine</publisher-name>
      </element-citation>
    </ref>
    <ref id="bib0002">
      <label>2</label>
      <element-citation publication-type="journal" id="sbref0002">
        <person-group person-group-type="author">
          <name>
            <surname>Aserinsky</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kleitman</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Regularly occurring periods of eye motility, and concomitant phenomena, during sleep</article-title>
        <source>Science</source>
        <volume>118</volume>
        <issue>3062</issue>
        <year>1953</year>
        <fpage>273</fpage>
        <lpage>274</lpage>
        <pub-id pub-id-type="pmid">13089671</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0003">
      <label>3</label>
      <element-citation publication-type="journal" id="sbref0003">
        <person-group person-group-type="author">
          <name>
            <surname>Aserinsky</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kleitman</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Two types of ocular motility occurring in sleep</article-title>
        <source>J. Appl. Physiol.</source>
        <volume>8</volume>
        <issue>1</issue>
        <year>1955</year>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">13242483</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0004">
      <label>4</label>
      <element-citation publication-type="journal" id="sbref0004">
        <person-group person-group-type="author">
          <name>
            <surname>Borbély</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Achermann</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Ultradian dynamics of sleep after a single dose of benzodiazepine hypnotics</article-title>
        <source>Eur. J. Pharmacol.</source>
        <volume>195</volume>
        <issue>1</issue>
        <year>1991</year>
        <fpage>11</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1016/0014-2999(91)90376-2</pub-id>
        <pub-id pub-id-type="pmid">2065705</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0005">
      <label>5</label>
      <element-citation publication-type="journal" id="sbref0005">
        <person-group person-group-type="author">
          <name>
            <surname>Borbély</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Daan</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Wirz-Justice</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Deboer</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>The two-process model of sleep regulation: a reappraisal</article-title>
        <source>J. Sleep Res.</source>
        <volume>25</volume>
        <issue>2</issue>
        <year>2016</year>
        <fpage>131</fpage>
        <lpage>143</lpage>
        <pub-id pub-id-type="doi">10.1111/jsr.12371</pub-id>
        <pub-id pub-id-type="pmid">26762182</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0006">
      <label>6</label>
      <element-citation publication-type="journal" id="sbref0006">
        <person-group person-group-type="author">
          <name>
            <surname>Carskadon</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Dement</surname>
            <given-names>W.C.</given-names>
          </name>
        </person-group>
        <article-title>Normal human sleep: an overview</article-title>
        <source>Principles Pract. Sleep Med.</source>
        <volume>4</volume>
        <year>2005</year>
        <fpage>13</fpage>
        <lpage>23</lpage>
      </element-citation>
    </ref>
    <ref id="bib0007">
      <label>7</label>
      <element-citation publication-type="journal" id="sbref0007">
        <person-group person-group-type="author">
          <name>
            <surname>Chellappa</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Steiner</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Oelhafen</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Lang</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Götz</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Krebs</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Cajochen</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Acute exposure to evening blue-enriched light impacts on human sleep</article-title>
        <source>J. Sleep Res.</source>
        <volume>22</volume>
        <issue>5</issue>
        <year>2013</year>
        <fpage>573</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="pmid">23509952</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0008">
      <label>8</label>
      <element-citation publication-type="journal" id="sbref0008">
        <person-group person-group-type="author">
          <name>
            <surname>De Gennaro</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Ferrara</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bertini</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Topographical distribution of spindles: variations between and within NREM sleep cycles</article-title>
        <source>Sleep Res Online</source>
        <volume>3</volume>
        <issue>4</issue>
        <year>2000</year>
        <fpage>155</fpage>
        <lpage>160</lpage>
        <pub-id pub-id-type="pmid">11382914</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0009">
      <label>9</label>
      <element-citation publication-type="journal" id="sbref0009">
        <person-group person-group-type="author">
          <name>
            <surname>Dement</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Kleitman</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Cyclic variations in EEG during sleep and their relation to eye movements, body motility, and dreaming</article-title>
        <source>Electroencephalogr. Clin. Neurophysiol.</source>
        <volume>9</volume>
        <issue>4</issue>
        <year>1957</year>
        <fpage>673</fpage>
        <lpage>690</lpage>
        <pub-id pub-id-type="pmid">13480240</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0010">
      <label>10</label>
      <element-citation publication-type="journal" id="sbref0010">
        <person-group person-group-type="author">
          <name>
            <surname>Dijk</surname>
            <given-names>D.-.J.</given-names>
          </name>
          <name>
            <surname>Brunner</surname>
            <given-names>D.P.</given-names>
          </name>
          <name>
            <surname>Beersma</surname>
            <given-names>D.G.M.</given-names>
          </name>
          <name>
            <surname>Borbély</surname>
            <given-names>A.A</given-names>
          </name>
        </person-group>
        <article-title>Electroencephalogram power density and slow wave sleep as a function of prior waking and circadian phase</article-title>
        <source>Sleep,</source>
        <volume>13</volume>
        <issue>5</issue>
        <year>1990</year>
        <fpage>430</fpage>
        <lpage>440</lpage>
        <pub-id pub-id-type="doi">10.1093/sleep/13.5.430</pub-id>
        <pub-id pub-id-type="pmid">2287855</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0011">
      <label>11</label>
      <element-citation publication-type="journal" id="sbref0011">
        <person-group person-group-type="author">
          <name>
            <surname>Endo</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kobayashi</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Yamamoto</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Fukuda</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Sasaki</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ohta</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Persistence of the circadian rhythm of REM sleep: a variety of experimental manipulations of the sleep-wake cycle</article-title>
        <source>Sleep</source>
        <volume>4</volume>
        <issue>3</issue>
        <year>1981</year>
        <fpage>319</fpage>
        <lpage>328</lpage>
        <pub-id pub-id-type="pmid">7302463</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0012">
      <label>12</label>
      <element-citation publication-type="journal" id="sbref0012">
        <person-group person-group-type="author">
          <name>
            <surname>Feinberg</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Floyd</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Systematic trends across the night in human sleep cycles</article-title>
        <source>Psychophysiology</source>
        <volume>16</volume>
        <issue>3</issue>
        <year>1979</year>
        <fpage>283</fpage>
        <lpage>291</lpage>
        <pub-id pub-id-type="pmid">220659</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0013">
      <label>13</label>
      <element-citation publication-type="journal" id="sbref0013">
        <person-group person-group-type="author">
          <name>
            <surname>Jenni</surname>
            <given-names>O.G.</given-names>
          </name>
          <name>
            <surname>Carskadon</surname>
            <given-names>M.A.</given-names>
          </name>
        </person-group>
        <article-title>Spectral analysis of the sleep electroencephalogram during adolescence</article-title>
        <source>Sleep</source>
        <volume>27</volume>
        <issue>4</issue>
        <year>2004</year>
        <fpage>774</fpage>
        <lpage>783</lpage>
        <pub-id pub-id-type="pmid">15283014</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0014">
      <label>14</label>
      <element-citation publication-type="journal" id="sbref0014">
        <person-group person-group-type="author">
          <name>
            <surname>Kimoff</surname>
            <given-names>R.J.</given-names>
          </name>
        </person-group>
        <article-title>Sleep fragmentation in obstructive sleep apnea</article-title>
        <source>Sleep,</source>
        <volume>19</volume>
        <issue>suppl_9</issue>
        <year>1996</year>
        <fpage>S61</fpage>
        <lpage>S66</lpage>
        <pub-id pub-id-type="doi">10.1093/sleep/19.suppl_9.S61</pub-id>
        <pub-id pub-id-type="pmid">9122574</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0015">
      <label>15</label>
      <element-citation publication-type="book" id="sbref0015">
        <person-group person-group-type="author">
          <name>
            <surname>Kryger</surname>
            <given-names>M.H.</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Dement</surname>
            <given-names>W.C.</given-names>
          </name>
        </person-group>
        <chapter-title>Principles and Practice of Sleep Medicine</chapter-title>
        <edition>6 ed.</edition>
        <year>2017</year>
        <publisher-name>Elsevier</publisher-name>
        <publisher-loc>Philadelphia, PA</publisher-loc>
      </element-citation>
    </ref>
    <ref id="bib0016">
      <label>16</label>
      <element-citation publication-type="journal" id="sbref0016">
        <person-group person-group-type="author">
          <name>
            <surname>Kurth</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Jenni</surname>
            <given-names>O.G.</given-names>
          </name>
          <name>
            <surname>Riedner</surname>
            <given-names>B.A.</given-names>
          </name>
          <name>
            <surname>Tononi</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Carskadon</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Characteristics of sleep slow waves in children and adolescents</article-title>
        <source>Sleep</source>
        <volume>33</volume>
        <issue>4</issue>
        <year>2010</year>
        <fpage>475</fpage>
        <lpage>480</lpage>
        <pub-id pub-id-type="pmid">20394316</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0017">
      <label>17</label>
      <element-citation publication-type="journal" id="sbref0017">
        <person-group person-group-type="author">
          <name>
            <surname>Kurth</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ringli</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Geiger</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>LeBourgeois</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Jenni</surname>
            <given-names>O.G.</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Mapping of cortical activity in the first two decades of life: a high-density sleep electroencephalogram study</article-title>
        <source>J. Neurosci.</source>
        <volume>30</volume>
        <issue>40</issue>
        <year>2010</year>
        <fpage>13211</fpage>
        <lpage>13219</lpage>
        <pub-id pub-id-type="pmid">20926647</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0018">
      <label>18</label>
      <element-citation publication-type="journal" id="sbref0018">
        <person-group person-group-type="author">
          <name>
            <surname>Merica</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Gaillard</surname>
            <given-names>J.-.M.</given-names>
          </name>
        </person-group>
        <article-title>Internal structure of sleep cycles in a healthy population</article-title>
        <source>Sleep,</source>
        <volume>9</volume>
        <issue>4</issue>
        <year>1986</year>
        <fpage>502</fpage>
        <lpage>513</lpage>
        <pub-id pub-id-type="doi">10.1093/sleep/9.4.502</pub-id>
        <pub-id pub-id-type="pmid">3809864</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0019">
      <label>19</label>
      <element-citation publication-type="journal" id="sbref0019">
        <person-group person-group-type="author">
          <name>
            <surname>Ohayon</surname>
            <given-names>M.M.</given-names>
          </name>
          <name>
            <surname>Carskadon</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Guilleminault</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Vitiello</surname>
            <given-names>M.V.</given-names>
          </name>
        </person-group>
        <article-title>Meta-analysis of quantitative sleep parameters from childhood to old age in healthy individuals: developing normative sleep values across the human lifespan</article-title>
        <source>Sleep,</source>
        <volume>27</volume>
        <issue>7</issue>
        <year>2004</year>
        <fpage>1255</fpage>
        <lpage>1273</lpage>
        <pub-id pub-id-type="doi">10.1093/sleep/27.7.1255</pub-id>
        <pub-id pub-id-type="pmid">15586779</pub-id>
      </element-citation>
    </ref>
    <ref id="bib0020">
      <label>20</label>
      <element-citation publication-type="journal" id="sbref0020">
        <person-group person-group-type="author">
          <name>
            <surname>Pamula</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Coussens</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Davey</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Griffiths</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Maul</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Nixon</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Sayers</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Teng</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>ASTA/ASA addendum to the AASM guidelines for the recording and scoring of paediatric sleep</article-title>
        <source>J. Sleep Res.</source>
        <volume>20</volume>
        <issue>Supp. 1</issue>
        <year>2011</year>
        <fpage>4</fpage>
      </element-citation>
    </ref>
    <ref id="bib0021">
      <label>21</label>
      <mixed-citation publication-type="other" id="sbref0021">Rechtschaffen, A., &amp; Kales, A. (1968). A manual of standardized terminology, techniques and scoring system for sleep stages of human subjects.</mixed-citation>
    </ref>
    <ref id="bib0022">
      <label>22</label>
      <element-citation publication-type="journal" id="sbref0022">
        <person-group person-group-type="author">
          <name>
            <surname>Rudzik</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Thiesse</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Pieren</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Héritier</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Eze</surname>
            <given-names>I.C.</given-names>
          </name>
          <name>
            <surname>Foraster</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Vienneau</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Brink</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Wunderli</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Probst-Hensch</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Röösli</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Fulda</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Cajochen</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Ultradian modulation of cortical arousals during sleep: effects of age and exposure to nighttime transportation noise</article-title>
        <source>Sleep</source>
        <volume>43</volume>
        <issue>7</issue>
        <year>2020</year>
        <pub-id pub-id-type="doi">10.1093/sleep/zsz324</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <ack id="ack0001">
    <title>Acknowledgements</title>
    <p id="para0034">We thank Selina L. Combertaldi (University of Fribourg, Switzerland) and Juliane Tkotz (Central Institute of Mental Health, Mannheim, Germany) for testing of and feedback on the algorithm.</p>
  </ack>
  <fn-group>
    <fn id="d34e286">
      <p id="notep0001">
        <bold>Direct Submission or Co-Submission</bold>
      </p>
      <p id="notep0002">
        <italic>Direct Submission</italic>
      </p>
    </fn>
  </fn-group>
</back>
