<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9617311</article-id>
    <article-id pub-id-type="pmid">36307762</article-id>
    <article-id pub-id-type="publisher-id">4983</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04983-6</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Frugal alignment-free identification of FLT3-internal tandem duplications with FiLT3r</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Boudry</surname>
          <given-names>Augustin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Darmon</surname>
          <given-names>Sasha</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duployez</surname>
          <given-names>Nicolas</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Figeac</surname>
          <given-names>Martin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Geffroy</surname>
          <given-names>Sandrine</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bucci</surname>
          <given-names>Maxime</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Celli-Lebras</surname>
          <given-names>Karine</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duchmann</surname>
          <given-names>Matthieu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Joudinaud</surname>
          <given-names>Romane</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fenwarth</surname>
          <given-names>Laurène</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nibourel</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Goursaud</surname>
          <given-names>Laure</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Itzykson</surname>
          <given-names>Raphael</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dombret</surname>
          <given-names>Hervé</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hunault</surname>
          <given-names>Mathilde</given-names>
        </name>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Preudhomme</surname>
          <given-names>Claude</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Salson</surname>
          <given-names>Mikaël</given-names>
        </name>
        <address>
          <email>mikael.salson@univ-lille.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.410463.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 0471 8845</institution-id><institution>Hematology Laboratory, Centre de Biologie Pathologie Génétique, CHU Lille, </institution></institution-wrap>Lille, France </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.503422.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2242 6780</institution-id><institution>Univ. Lille, CNRS, Centrale Lille, UMR 9189 CRIStAL, </institution></institution-wrap>F-59000 Lille, France </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.15140.31</institution-id><institution-id institution-id-type="ISNI">0000 0001 2175 9188</institution-id><institution>ENS Lyon, </institution></institution-wrap>Lyon, France </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.503422.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2242 6780</institution-id><institution>U1277 Cancer Heterogeneity Plasticity and Resistance to Therapies (CANTHER), University of Lille, INSERM, </institution></institution-wrap>Lille, France </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.410463.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 0471 8845</institution-id><institution>Hematology Department, CHU LILLE, </institution></institution-wrap>Lille, France </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.503422.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2242 6780</institution-id><institution>Univ. Lille, CNRS, Inserm, CHU Lille, Institut Pasteur de Lille, US 41 - UMS 2014 - PLBS, </institution></institution-wrap>F-59000 Lille, France </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.413328.f</institution-id><institution-id institution-id-type="ISNI">0000 0001 2300 6614</institution-id><institution>Department of Hematology, Saint Louis Hospital, Assistance Publique-Hôpitaux de Paris (AP-HP), </institution></institution-wrap>Paris, France </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.508487.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 7885 7602</institution-id><institution>INSERM/CNRS UMR 944/7212, Saint-Louis Research Institute, Paris Diderot University, </institution></institution-wrap>Paris, France </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="GRID">grid.7252.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2248 3363</institution-id><institution>Univ Angers, Université de Nantes, CHU Angers, Inserm, CNRS, CRCI2NA, SFR ICAT, </institution></institution-wrap>F-49000 Angers, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>448</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022, corrected publication 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Internal tandem duplications in the <italic>FLT3</italic> gene, termed <italic>FLT3</italic>-ITDs, are useful molecular markers in acute myeloid leukemia (AML) for patient risk stratification and follow-up. <italic>FLT3</italic>-ITDs are increasingly screened through high-throughput sequencing (HTS) raising the need for robust and efficient algorithms. We developed a new algorithm, which performs no alignment and uses little resources, to identify and quantify <italic>FLT3</italic>-ITDs in HTS data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Our algorithm (FiLT3r) focuses on the <italic>k</italic>-mers from reads covering <italic>FLT3</italic> exons 14 and 15. We show that those <italic>k</italic>-mers bring enough information to accurately detect, determine the length and quantify <italic>FLT3</italic>-ITD duplications. We compare the performances of FiLT3r to state-of-the-art alternatives and to fragment analysis, the gold standard method, on a cohort of 185 AML patients sequenced with capture-based HTS. On this dataset FiLT3r is more precise (no false positive nor false negative) than the other software evaluated. We also assess the software on public RNA-Seq data, which confirms the previous results and shows that FiLT3r requires little resources compared to other software.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">FiLT3r is a free software available at <ext-link ext-link-type="uri" xlink:href="https://gitlab.univ-lille.fr/filt3r/filt3r">https://gitlab.univ-lille.fr/filt3r/filt3r</ext-link>. The repository also contains a Snakefile to reproduce our experiments. We show that FiLT3r detects FLT3-ITDs better than other software while using less memory and time.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04983-6.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Sequence analysis</kwd>
      <kwd>High-throughput sequencing</kwd>
      <kwd>Alignment-free</kwd>
      <kwd>Cancer</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100006364</institution-id>
            <institution>Institut National Du Cancer</institution>
          </institution-wrap>
        </funding-source>
        <award-id>PHRC 2007/1911 and PRTK TRANSLA10-060</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Monitoring the disease progression in blood cancers requires the identification of pathology-specific molecular markers. In acute myeloid leukemia (AML), one of the strongest risk factor used for risk stratification is the presence of an internal tandem duplication in the <italic>FLT3</italic> gene (<italic>FLT3</italic>-ITD), which occurs in 20-30% of the cases [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. <italic>FLT3</italic>-ITD are in-frame duplications of highly variable size, ranging from 3 to more than 400 nucleotides, mostly located within the receptor’s autoinhibitory juxatamembrane domain. This mutation represents a strong prognostic biomarker since patients with <italic>FLT3</italic>-ITD are at higher risk of relapse and have decreased event-free and overall survival [<xref ref-type="bibr" rid="CR5">5</xref>]. The importance of allelic ratio (AR), as assessed by the ratio between the mutated allele and the wild-type allele, has been demonstrated in several studies [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. Presence of <italic>FLT3</italic>-ITD has a major therapeutic impact, such as indication of allogeneic hematopoietic stem cell transplantation (allo-HSCT) in first complete remission [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. <italic>FLT3</italic>-ITD is also a therapeutic target with the emergence of <italic>FLT3</italic> inhibitors, used in combination with chemotherapy during induction and consolidation courses [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>] and more recently as maintenance therapy [<xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p id="Par5">Historically, according to European LeukemiaNet (ELN) guidelines, the identification and quantification of <italic>FLT3</italic>-ITD were performed with fragment analysis [<xref ref-type="bibr" rid="CR7">7</xref>]. DNA fragments were fluorescently labeled, then separated by capillary electrophoresis [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. One or more peaks were obtained depending on the presence or absence of ITD(s). The size of the ITD was determined by subtracting the size of the wild type fragment from that of the mutated fragment, using a scale. The AR was evaluated by dividing the area under the curve of the mutated fragment’s peak by that of the wild-type fragment’s peak. Although robust, this technique has several limitations: (i) the lower limit of quantification of the AR is high, generally at least 1% [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>], (ii) the determination of the size of the ITD using the scale is approximate, (iii) the exact position of insertion and complete sequence of the ITD are not available [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] and (iv) sample multiplexing cannot be performed (v) quantification of very large insertions might be biased. Development of high-throughput sequencing enabled the detection of several genetic alterations in a single sequencing run and has the potential to overcome several of those limitations. However, classical mappers, such as Bowtie2 or BWA, cannot directly identify structural variants such as tandem duplications. Thus initially, the data produced were analysed using pindel, a general-purpose algorithm that detects and quantifies indels and structural variants [<xref ref-type="bibr" rid="CR18">18</xref>]. Although using a general-purpose software can be appealing, it may be under-optimised to address the specific problem of identifying and quantifying tandem duplications, especially <italic>FLT3</italic>-ITD. Thus, many methods were specifically developed to detect <italic>FLT3</italic>-ITD in high-throughput sequencing data [<xref ref-type="bibr" rid="CR19">19</xref>]. Yuan and colleagues distinguished the assembly-based methods from the alignment-based ones, and demonstrated better accuracy of alignment-based methods.</p>
    <p id="Par6">However, alignment-free methods have gained importance in bioinformatics [<xref ref-type="bibr" rid="CR20">20</xref>] as they usually have the advantage of using only a fraction of the resources required by alignment methods while providing similar results. km is an example of an alignment-free strategy for <italic>FLT3</italic>-ITD detection [<xref ref-type="bibr" rid="CR21">21</xref>]. It is based on Jellyfish [<xref ref-type="bibr" rid="CR22">22</xref>], a <italic>k</italic>-mer counting algorithm, to efficiently count <italic>k</italic>-mers in the reads. Then km first builds a linear <italic>k</italic>-mer graph of the reference sequence and traverses it using their count table. Any divergent path that can be identified with the count table is a potential duplication. We introduce a new alignment-free approach based on <italic>k</italic>-mers, which is faster than km because it doesn’t require counting the <italic>k</italic>-mers from the reads. For the detection of duplications, we were inspired by the methodology used in the work of [<xref ref-type="bibr" rid="CR23">23</xref>] by analysing the occurrences of the <italic>k</italic>-mers in the reads.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par7">We introduce our heuristic aimed at finding duplications compared to a reference sequence, though it can more generally detect insertions and deletions. In what follows what is described for duplication also holds for indels without loss of generality.</p>
    <p id="Par8">To determine if a read contains a duplication, we first need to consider all <italic>k</italic>-mers from the read and identify their positions in the reference sequence. The main principle consists of identifying any read in which <italic>k</italic>-mer positions on the reference sequence would suddenly go back. Such an event would correspond to a duplication with respect to the reference sequence. To further explain this principle, here is a concrete example of its application. Let <italic>T</italic> be the reference sequence and <italic>R</italic> a read. Fig. <xref rid="Fig1" ref-type="fig">1</xref> illustrates an example where AGAT is duplicated in <italic>R</italic>. When querying at which positions the <italic>k</italic>-mers of <italic>R</italic> occur in <italic>T</italic>, the positions of the <italic>k</italic>-mers gradually increase from 3 to 5 and then go back to 4 at the start of the duplication. This phenomenon is the signature of a duplication. We use this observation to detect duplications efficiently. As will be shown later, this information is also sufficient to determine the length of the duplication.<fig id="Fig1"><label>Fig. 1</label><caption><p>Identifying duplications from a reference sequence <italic>T</italic> in a read <italic>R</italic> with <italic>k</italic>-mers (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=3$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq1.gif"/></alternatives></inline-formula>). The bottom line represents the positions of the <italic>k</italic>-mers from <italic>R</italic> in <italic>T</italic>. For instance, the first element (3) corresponds to the <italic>k</italic>-mer CAG which appears in position 3 in <italic>T</italic>. The dashes (–) correspond to <italic>k</italic>-mers from <italic>R</italic> that do not occur in <italic>T</italic> (<italic>eg.</italic> ATA or TAG)</p></caption><graphic xlink:href="12859_2022_4983_Fig1_HTML" id="MO1"/></fig></p>
    <sec id="Sec3">
      <title>The FiLT3r algorithm</title>
      <p id="Par9">Our algorithm can be summarised in three main steps: <list list-type="order"><list-item><p id="Par10">Indexing <italic>k</italic>-mers of the reference sequence with their original positions.</p></list-item><list-item><p id="Par11">Traversing all the reads: keep the ones with enough <italic>k</italic>-mers from the reference sequence and determine the position of the read’s <italic>k</italic>-mers in the reference sequence.</p></list-item><list-item><p id="Par12">Detect a duplication event in reads using the <italic>k</italic>-mers positions in the reference sequence.</p></list-item></list>The indexing step is trivial, as the reference sequence (basically exons 14 to 15 in the <italic>FLT3</italic> gene) is very short. With short values of <italic>k</italic>, there may exists several occurrences of the same <italic>k</italic>-mer in the reference sequence (see A in Fig. <xref rid="Fig2" ref-type="fig">2</xref>). Thus, all positions are stored to prevent loss of information. Ambiguities in the positions will be resolved afterwards.</p>
      <p id="Par13">The second step only consists of reading the reads one by one and then querying the index (a hash table) with the <italic>k</italic>-mers of each read (see C in Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The main difficulty comes from the third step. Fig. <xref rid="Fig1" ref-type="fig">1</xref> introduces a simplified version of the problem, but other cases may arise that should be handled correctly to prevent false negatives or false positives as will be shown later.</p>
      <p id="Par14">Duplications are only searched in reads whose number of <italic>k</italic>-mers from the reference sequence is above a given threshold to prevent spending time on reads not coming from the gene of interest. For each of these reads we will now focus on the <italic>k</italic>-mers occurrences in the reference sequence. We call <italic>trace of</italic>
<italic>R</italic>
<italic>in</italic>
<italic>T</italic>, denoted by <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R$$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq2.gif"/></alternatives></inline-formula>, the list of <italic>k</italic>-mers positions in <italic>T</italic> from a read <italic>R</italic>. Then <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[i]$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq3.gif"/></alternatives></inline-formula> is a list of positions where the <italic>k</italic>-mer <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R[i\ldots i+k-1]$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>…</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq4.gif"/></alternatives></inline-formula> occurs in <italic>T</italic> (see <italic>traces of kept reads</italic> in Fig. <xref rid="Fig2" ref-type="fig">2</xref> for examples). This list can obviously be empty whenever the <italic>k</italic>-mer doesn’t occur in <italic>T</italic>. We call a break (as in [<xref ref-type="bibr" rid="CR23">23</xref>]) the maximal span of positions where <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[i]$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq5.gif"/></alternatives></inline-formula> is empty (denoted by <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[i]= -$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq6.gif"/></alternatives></inline-formula>). Thus, a break is identified by its starting position and its ending position. For a read <italic>R</italic> if we have a break (<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j_1, j_2$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq7.gif"/></alternatives></inline-formula>), then <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$trace[j] = -$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq8.gif"/></alternatives></inline-formula>, for each <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j_1\le j \le j_2$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq9.gif"/></alternatives></inline-formula>, and either <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j_1=0$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq10.gif"/></alternatives></inline-formula> or <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_1-1]\not =-$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq11.gif"/></alternatives></inline-formula>, and either <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j_2=|R|-1$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq12.gif"/></alternatives></inline-formula> or <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_2+1]\not =-$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq13.gif"/></alternatives></inline-formula>.</p>
      <p id="Par15">Whenever a duplication occurs in a read <italic>R</italic>, this will create a break in the trace. Note that the converse is not true: many other events can also create breaks. Actually, any difference between the read and the reference sequence will lead to a break. Also, in some rare cases, the duplication will not create a break. However, the probability of this phenomenon decreases exponentially with <italic>k</italic>.</p>
      <p id="Par16">Using the trace of the reads we start by identifying all the breaks in a trace and by determining if the positions before and after the break are compatible with a duplication. Thus, assuming for now that <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_1-1]$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_2+1]$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq15.gif"/></alternatives></inline-formula> both correspond to a single position in the reference sequence, we check whether <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_1-1]+g-1 &gt; t_R[j_2+1]$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq16.gif"/></alternatives></inline-formula>, where <italic>g</italic> is the size of the break. In such a case, a duplication has been detected (see E in Fig. <xref rid="Fig2" ref-type="fig">2</xref>).<fig id="Fig2"><label>Fig. 2</label><caption><p>How FiLT3r processes the reads. <bold>A</bold> The <italic>k</italic>-mers of the reference sequence are indexed in a hash table and a Bloom filter. The keys of the hash table are <italic>k</italic>-mers and the values are a list of positions where the key occurs in the reference sequence. <bold>B</bold> The reads matching a sufficient number of <italic>k</italic>-mers with the reference are kept. <bold>C</bold> The <italic>k</italic>-mer positions in the reference are considered. <bold>D</bold> Substitutions are removed. <bold>E</bold> Duplications, and more generally indels, are called only using the positions of the <italic>k</italic>-mers</p></caption><graphic xlink:href="12859_2022_4983_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par17">The length of the duplication can be deduced from the <italic>k</italic>-mer positions. Let <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(j_1, j_2)$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq17.gif"/></alternatives></inline-formula> be a break corresponding to a duplication. <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_1-1]+k-1$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq18.gif"/></alternatives></inline-formula> is the last nucleotide position before the duplication, while <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_2+1]$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq19.gif"/></alternatives></inline-formula> is the first nucleotide in the duplication. Thus the length of the duplication is <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_1-1]+k-1 - t_R[j_2+1] +1=t_R[j_1-1]-t_R[j_2+1]+k$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq20.gif"/></alternatives></inline-formula>. For instance, in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, the break is (3, 4) and the length of the duplication is <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5-4+3=4$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mn>5</mml:mn><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq21.gif"/></alternatives></inline-formula>. However, the formula does not hold whenever short insertions occur at the breakpoint or when there is an overlap between the start of the duplication and what follows it in the reference sequence. All those cases can actually be easily dealt with. Each inserted nucleotide will lead to a break length increased by one. Conversely, each overlap will lead to a decreased gap length. We note that when no such insertion or overlap occurs, we have <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j_2-j_1+2=k$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq22.gif"/></alternatives></inline-formula> . Hence, we deduce that more generally the duplication size is <inline-formula id="IEq24"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_1-1]-t_R[j_2+1]+j_2-j_1+2$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq24.gif"/></alternatives></inline-formula>. The formula also holds when substitutions occur at <inline-formula id="IEq26"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d&lt;k$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq26.gif"/></alternatives></inline-formula> nucleotides from the breakpoint (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>). In this case, this will make the break longer by <italic>d</italic> nucleotides, but this will also decrease <inline-formula id="IEq27"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_1-1]$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq27.gif"/></alternatives></inline-formula> by <italic>d</italic> or increase <inline-formula id="IEq28"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_2+1]$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq28.gif"/></alternatives></inline-formula> by <italic>d</italic> (depending where the substitution occurs). Thus, the computed duplication size won’t change compared to the situation where no such substitution occurs. Thus, our heuristic is robust to such events.<fig id="Fig3"><label>Fig. 3</label><caption><p>Computing the duplication length. Three examples are shown using the same reference as in  Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In the first example (left) we also have the same read as in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The break <inline-formula id="IEq29"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(j_1,j_2)=(3,4)$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq29.gif"/></alternatives></inline-formula> is due to a duplication. Its length will be computed with <inline-formula id="IEq30"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_1-1]-t_R[j_2+1]+j_2-j_1+2=5-4+4-3+2=4$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq30.gif"/></alternatives></inline-formula>. In the second example (right) a single nucleotide is modified leading to a longer break (1, 4). Thus <inline-formula id="IEq31"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j'_1$$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mi>j</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq31.gif"/></alternatives></inline-formula> decreased by 2 compared to the first example. However, in the meantime <inline-formula id="IEq32"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{R'}[j'_1-1]=3$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>j</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq32.gif"/></alternatives></inline-formula> also decreased by 2 compared to the first example (where <inline-formula id="IEq33"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_1-1]=5$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq33.gif"/></alternatives></inline-formula>). Thus, the duplication length is identical: <inline-formula id="IEq34"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3-4+4-1+2=4$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq34.gif"/></alternatives></inline-formula>. This is an example where our algorithm can detect the duplication even when it contains a substitution. The process is similar with an indel. In the third example (bottom) the duplication starts with the same letter (C) as the letter that follows the duplication, in position 10. The consequence is a shorter break as the <italic>k</italic>-mer in position 3, that overlaps the duplication breakpoint exists in the reference. However, the duplication length is correctly computed as <inline-formula id="IEq35"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j''_1-1]-t_R[j''_2+1]+j''_2-j''_1+2=6-3+2=5$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>j</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>j</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>′</mml:mo><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>6</mml:mn><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq35.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2022_4983_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par18">We are finally able to identify duplications within a read in linear time. In order to limit the false positives, we introduce several strategies to mitigate this risk.</p>
    </sec>
    <sec id="Sec4">
      <title>Mitigating false positives</title>
      <p id="Par19">False positive detection of duplication can be encountered because <italic>k</italic>-mers are short sequences that can occur by chance because of sequencing errors, or other events. We must not detect a duplication whenever a (few) short <italic>k</italic>-mers occur in the wrong place.</p>
      <sec id="Sec5">
        <title>Disambiguating positions</title>
        <p id="Par20">In the read trace, some <italic>k</italic>-mers may occur at several locations in the reference sequence. Of course only one (at most) is correct, thus only one is kept. Assuming we want to disambiguate <inline-formula id="IEq36"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[i]$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq36.gif"/></alternatives></inline-formula> (<italic>ie.</italic>
<inline-formula id="IEq37"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|t_R[i]|&gt;1$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq37.gif"/></alternatives></inline-formula>), we follow those rules: <list list-type="order"><list-item><p id="Par21">First, if <inline-formula id="IEq38"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[i-1]$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq38.gif"/></alternatives></inline-formula> is non-ambiguous and <inline-formula id="IEq39"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[i-1]+1$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq39.gif"/></alternatives></inline-formula> appears in <inline-formula id="IEq40"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[i]$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq40.gif"/></alternatives></inline-formula>, then we retain this value.</p></list-item><list-item><p id="Par22">Otherwise, among the possible positions in <inline-formula id="IEq41"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[i]$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq41.gif"/></alternatives></inline-formula> we choose the one which minimises the distances (<italic>ie.</italic> the absolute values of the subtractions) with the neighbouring positions in <inline-formula id="IEq42"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq42.gif"/></alternatives></inline-formula> (both the original one and the one currently cleaned). The neighbouring positions considered are all the ones that don’t imply crossing a break, or a break can be crossed only if position <italic>i</italic> is just before or just after a break.</p></list-item></list></p>
      </sec>
      <sec id="Sec6">
        <title>Eliminating substitutions</title>
        <p id="Par23">Substitutions are the most frequent mutations and sequencing errors (at least for Illumina sequencers, see [<xref ref-type="bibr" rid="CR24">24</xref>]). Therefore, many breaks will be due to substitutions. To limit the number of breaks to consider, and to have traces with more valid positions, we remove substitutions by correcting them (either mutations or sequencing errors). This also allows detecting duplications in spite of proximate substitutions, and it will improve the estimation of the quantification.</p>
        <p id="Par24">The correction is carried out as follows: let a break <inline-formula id="IEq43"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(j_1,j_2)$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq43.gif"/></alternatives></inline-formula>, we extract the <italic>k</italic>-mer starting at position <inline-formula id="IEq44"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j_1$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq44.gif"/></alternatives></inline-formula>. Since this <italic>k</italic>-mer doesn’t exist in <italic>T</italic>, as position <inline-formula id="IEq45"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j_1$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq45.gif"/></alternatives></inline-formula> is the first one of a break, we try the three other nucleotides at position <inline-formula id="IEq46"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k-1$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq46.gif"/></alternatives></inline-formula> in this <italic>k</italic>-mer. If one of the corrected <italic>k</italic>-mer occurs at a position <italic>p</italic> such that <inline-formula id="IEq47"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p-1$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq47.gif"/></alternatives></inline-formula> occurs in <inline-formula id="IEq48"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_1-1]$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq48.gif"/></alternatives></inline-formula>, then we correct the <italic>k</italic>-mer this way, and we move on to the next <italic>k</italic>-mer. In case the correction did not work, the <italic>k</italic>-mers in the break are not corrected.</p>
      </sec>
      <sec id="Sec7">
        <title>Simulating larger <italic>k</italic>-mers</title>
        <p id="Par25">Before reporting a duplication event, we make sure this event is robust by checking that <inline-formula id="IEq49"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><mml:math id="M94"><mml:mi>δ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq49.gif"/></alternatives></inline-formula> consecutive positions in the trace are consistent. Verifying that <inline-formula id="IEq50"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><mml:math id="M96"><mml:mi>δ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq50.gif"/></alternatives></inline-formula> consecutive positions are consistent is equivalent to considering <inline-formula id="IEq51"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k+\delta$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq51.gif"/></alternatives></inline-formula>-mers instead of <italic>k</italic>-mers. Thus, if we have a candidate break <inline-formula id="IEq52"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(j_1, j_2)$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq52.gif"/></alternatives></inline-formula>, we report this as an event if and only if <inline-formula id="IEq53"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_1 - 1 -i ] + i = t_R[j_1-1]$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq53.gif"/></alternatives></inline-formula>, for <inline-formula id="IEq54"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le \delta$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq54.gif"/></alternatives></inline-formula>, and conversely iff <inline-formula id="IEq55"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[j_2 + 1 +i ] - i = t_R[j_2+1]$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq55.gif"/></alternatives></inline-formula>, for <inline-formula id="IEq56"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le \delta$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq56.gif"/></alternatives></inline-formula>. <inline-formula id="IEq57"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><mml:math id="M110"><mml:mi>δ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq57.gif"/></alternatives></inline-formula> is a user-defined parameter that is set to 2 by default.</p>
        <p id="Par26">Moreover, if two breaks <inline-formula id="IEq58"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(j_1, j_2)$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq58.gif"/></alternatives></inline-formula> and <inline-formula id="IEq59"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(j'_1, j'_2)$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>j</mml:mi><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq59.gif"/></alternatives></inline-formula> are consecutive by less than <inline-formula id="IEq60"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><mml:math id="M116"><mml:mi>δ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq60.gif"/></alternatives></inline-formula> positions (<italic>ie.</italic>
<inline-formula id="IEq61"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j'_2\le j_2+\delta$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:msubsup><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo>≤</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq61.gif"/></alternatives></inline-formula>), we merge them as soon as the indels they correspond to are longer than the one called using the merged break <inline-formula id="IEq62"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(j_1, j'_2)$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq62.gif"/></alternatives></inline-formula>.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Estimating duplication abundance</title>
      <p id="Par27">Identifying a duplication is not sufficient, as its abundance is also a prognosis factor. Rather than a raw abundance, a relative abundance is much more meaningful. We express the relative abundance as a VAF (Variant Allele Frequency) or an AR (allelic ratio). All the duplications sharing the same characteristics (same length and same starting and ending positions) are pooled together.</p>
      <p id="Par28">Briefly speaking, the abundance is computed from the number of reads in which a given duplication is found and the number of reads corresponding to the wildtype sequence. The read counts is further corrected to take into account the duplications that cannot be observed when they occur at one end of the reads.</p>
      <p id="Par29">More precisely, to determine the VAF or the AR we need to know, at the position of the duplication, both the coverage of the wildtype version and of the duplicated version, <italic>ie.</italic> the number of reads that cover the position of the duplication in the reference sequence and in the duplicated version. To do so, we use the disambiguated traces. The traces provide the positions that were covered in the reference sequence, we can thus count the coverage at each position in the reference. More formally, when <inline-formula id="IEq63"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_R[i]=j$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>R</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq63.gif"/></alternatives></inline-formula>, we increment the coverage at position <italic>j</italic> in the reference sequence. This corresponds to the total coverage, which thus includes the coverage of the wildtype as well as the coverage of all the duplications or indels detected. We deduce the wildtype coverage by removing all the coverages from the duplications/indels that have been detected.</p>
      <p id="Par30">However, with our approach we cannot detect duplications that would occur at the start or at the end of a read. As explained previously, for a duplication to be detected, we need to have <inline-formula id="IEq64"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><mml:math id="M124"><mml:mi>δ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq64.gif"/></alternatives></inline-formula> positions in the trace before and after the break. For a duplication creating a break of size <italic>b</italic>, we will need to have <inline-formula id="IEq65"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=2\delta +b+k-1$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq65.gif"/></alternatives></inline-formula> nucleotides in the read. That means that we will not be able to detect duplications occurring in the first <inline-formula id="IEq66"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq66.gif"/></alternatives></inline-formula> or the last <inline-formula id="IEq67"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq67.gif"/></alternatives></inline-formula> nucleotides of the reads. Thus, when quantifying a duplication, the quantification will be under-estimated because <inline-formula id="IEq68"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{2(t-1)}{R}$$\end{document}</tex-math><mml:math id="M132"><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>R</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq68.gif"/></alternatives></inline-formula> of the duplications could not be detected and, thus,counted, where <italic>R</italic> is the size of the reads. The counts are corrected to take this observation into account, and by assuming that any indel has a uniform probability of occurrence within the read. Let <italic>q</italic> be the raw quantification, <italic>ie.</italic> the number of reads in which the duplication was identified, the corrected quantification is <inline-formula id="IEq69"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q'= q\left( 1 + \frac{2(t-1)}{R}\right)$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>R</mml:mi></mml:mfrac></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq69.gif"/></alternatives></inline-formula>. The VAF or AR are then computed using the corrected counts and the wildtype coverage at the position of the duplication.</p>
    </sec>
    <sec id="Sec9">
      <title>Optimising data processing</title>
      <p id="Par31">As specified previously, we only search duplications in reads having enough <italic>k</italic>-mers coming from the reference sequence. However, in most cases most of the reads would not come from the region of interest. Thus, the most time-consuming step in our algorithm is to determine whether the read is coming from that region. To lower this time consumption, we use a heuristic: <italic>k</italic>-mers from the region of interest are stored in a Bloom filter [<xref ref-type="bibr" rid="CR25">25</xref>].</p>
      <p id="Par32">The first step is therefore to query the Bloom filter to determine how many <italic>k</italic>-mers come from the region of interest in the read. If this value is above a threshold then the read goes to the following stages of the algorithm, otherwise it is discarded. By default, this threshold is set at 30 %.</p>
      <p id="Par33">Bloom filters do not yield any false negative, therefore we have the guarantee that this heuristic will not prevent us from identifying a read that actually comes from the region of interest. As the region of interest, namely exons 14 to 15 from the <italic>FLT3</italic> gene, is quite short the Bloom filter can be very small and will likely be stored in the CPU cache, which will allow very quick accesses.</p>
    </sec>
    <sec id="Sec10">
      <title>Implementation and benchmarking</title>
      <p id="Par34">FiLT3r is implemented in C++ using the GATB library [<xref ref-type="bibr" rid="CR26">26</xref>] and is freely distributed <ext-link ext-link-type="uri" xlink:href="https://gitlab.univ-lille.fr/filt3r/filt3r">gitlab.univ-lille.fr/filt3r/filt3r</ext-link>.</p>
      <p id="Par35">We compared FiLT3r with state-of-the-art approaches. We made a preliminary assessment on our cohort with several other software detecting FLT3-ITD-ext, such as pindel [<xref ref-type="bibr" rid="CR18">18</xref>], ITDSeek [<xref ref-type="bibr" rid="CR27">27</xref>], ScanITD [<xref ref-type="bibr" rid="CR28">28</xref>], getITD [<xref ref-type="bibr" rid="CR29">29</xref>] and Genomon ITDetector [<xref ref-type="bibr" rid="CR30">30</xref>] (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table 1). However, with the later publication of [<xref ref-type="bibr" rid="CR19">19</xref>] we preferred referring to their independent assessment and chose to use in our paper the best tool they assessed: FLT3-ITD-ext [<xref ref-type="bibr" rid="CR31">31</xref>]. We also added km [<xref ref-type="bibr" rid="CR21">21</xref>] as it was not evaluated in Yuan et al’s benchmark and showed good performances in our preliminary assessment. km is an alignment-free approach already presented in the introduction. We also add that km is not focused on <italic>FLT3</italic> and can more generally detect variations in raw reads. <italic>FLT3</italic>-ITD-ext relies on a general-purpose aligner (BWA-MEM, [<xref ref-type="bibr" rid="CR32">32</xref>]) to align reads to the reference sequence (the <italic>FLT3</italic> genomic sequence of exons 14-15).</p>
      <p id="Par36">FiLT3r was launched with a <italic>k</italic>-mer size of 12<xref ref-type="fn" rid="Fn1">1</xref>, km with a <italic>k</italic>-mer size of 31 (as advised by km authors) and with a threshold for duplication detections of .01 (thresholds .1 and .001 were attempted, but the best results were achieved with a threshold of .01), Jellyfish parameters were identical to the ones used in km publication (-C -L 2 -Q+ -s 1000000). FLT3-ITD-ext was launched with default parameters. For FLT3-ITD-ext, the deletions were not considered as it would have lead to too many false positives. Within a sample, all the duplications of the same length are pooled together to take into account the fact that the allelic ratio method only differentiates duplications on their lengths. The experiments can be reproduced with a Snakefile available on the Git repository of the software.</p>
      <p id="Par37">All the experiments were performed on a server with 24 Intel®Xeon®CPU E5-2420 and 193 GB of RAM. The data was stored on a NAS connected to the server through NFS. The programs were run on a single thread. User times and peak memory consumptions were measured.</p>
    </sec>
    <sec id="Sec11">
      <title>Benchmarking data</title>
      <p id="Par38">We assessed the three software packages on high-throughput sequencing data of 185 patients aged from 18 to 60 years old, diagnosed with <italic>de novo</italic> or secondary AML at the haematology laboratory of the University Hospital of Lille. This population was composed of 114 <italic>FLT3</italic>-ITD positive patients and 71 <italic>FLT3</italic>-ITD negative patients, according to the gold-standard fragment analysis [<xref ref-type="bibr" rid="CR33">33</xref>]. The study was conducted according to the Declaration of Helsinki and was approved (nos. CSTMT289) by the Human Research Committee of Lille and the institutional review board of the Lille University Hospital Tumor Bank (certification NF 96900-2014/65453-1).</p>
      <p id="Par39">Exons 14-15 of <italic>FLT3</italic> were sequenced in all patients using the following methodology: the library was prepared by a capture method, targeting 62 genes with SureSelect-QXT (AGILENT®) according to the manufacturer’s protocol. Samples were sequenced with NextSeq Illumina®(<inline-formula id="IEq70"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times 121$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>121</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq70.gif"/></alternatives></inline-formula> bp). The region of interest was sequenced with a mean depth of 2116x (range: 421.32 – 4538.84). The base calling was performed with bcl2fastq2 (v:2.20.0) and fastq were trimmed with fastp (v:0.20.0). The number of paired-end reads per sample ranged from 1.8 million to 35 million (median: 4.8 million). The sequences were deposited on SRA (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>). The quantification of the expected ITDs were obtained using the reference method (by capillary electrophoresis) explained in the introduction.</p>
      <p id="Par40">To assess how the three software behaves on datasets with very different characteristics, we used public RNA-seq data. RNA-seq is gaining importance in clinical settings and RNA-seq data differs widely from capture sequencing in terms of quantity of data, variation of expression and random starting positions of the reads. We launched the three software on data from CCLE (Cancel Cell Line Encyclopedia) [<xref ref-type="bibr" rid="CR34">34</xref>]. We randomly selected 76 samples from haematopoeitic and lymphoid tissues and 76 samples from lung tissues (list of accessions in Additional file <xref rid="MOESM10" ref-type="media">10</xref>). It is not known which samples should contain <italic>FLT3</italic>-ITD. However, from a biological point of view, we do not expect to detect any <italic>FLT3</italic>-ITD in lung tissues while we could expect some in haematopoeitic and lymphoid tissues. This dataset will help assess how the three software scale on massive datasets (from 112,328 reads to 1,364,951,510 reads, median: 72.9M) with an average read length ranging from 68nt to 150nt (median: 101nt).</p>
      <p id="Par41">Finally, to check that our results holds on controlled data, we simulated ITDs at different ratios with different qualities.</p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Results</title>
    <sec id="Sec13">
      <title>Capture sequencing of 185 AML patients</title>
      <p id="Par42">The software results on HTS data were compared to DNA fragment analysis, the gold-standard method. Any duplication found by a software, at whatever abundance, and identified with the reference method was considered as a true positive. Any duplication found by a software with an allelic ratio (AR) above .01 and that was not identified by the reference method was for now considered as a false positive. After analysing the results in details, we will change this definition of false positivity as HTS appear to be more sensitive to detect lowly expressed ITDs.<table-wrap id="Tab1"><label>Table 1</label><caption><p>(a) Raw results of the three software packages assessed on the samples of 185 patients. Any result from a software is considered as a false positive as long as its quantification is at least 1% and it is not detected by the reference method. (b) Corrected results, after taking into account two Sanger sequencing to verify the two <italic>FLT3</italic>-ITDs detected by two software, and by considering as false positive only <italic>FLT3</italic>-ITDs detected above 1% by a software in any negative sample</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">FiLT3r</th><th align="left">km</th><th align="left">FLT3-ITD-ext</th></tr></thead><tbody><tr><td align="left" colspan="4"><italic>(a)</italic></td></tr><tr><td align="left">True pos.</td><td align="left">145</td><td align="left">134</td><td align="left">144</td></tr><tr><td align="left">False neg.</td><td align="left">0</td><td align="left">11</td><td align="left">1</td></tr><tr><td align="left">False pos.</td><td align="left">17</td><td align="left">6</td><td align="left">9</td></tr><tr><td align="left" colspan="4"><italic>(b)</italic></td></tr><tr><td align="left">True pos.</td><td align="left">147</td><td align="left">136</td><td align="left">144</td></tr><tr><td align="left">False neg.</td><td align="left">0</td><td align="left">11</td><td align="left">3</td></tr><tr><td align="left">False pos.</td><td align="left">0</td><td align="left">0</td><td align="left">0</td></tr><tr><td align="left">Precision</td><td align="left">1</td><td align="left">1</td><td align="left">1</td></tr><tr><td align="left">Recall</td><td align="left">1</td><td align="left">0.93</td><td align="left">0.98</td></tr><tr><td align="left">F1</td><td align="left">1</td><td align="left">0.96</td><td align="left">0.99</td></tr></tbody></table></table-wrap></p>
      <p id="Par43">Raw results are shown in Table <xref rid="Tab1" ref-type="table">1</xref> (a) (detailed results for each duplication are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>). FiLT3r and FLT3-ITD-ext showed similar performances. FiLT3r was slightly better in terms of true positives, but at the apparent cost of more false positives.</p>
      <p id="Par44">However, some (7/17) of the false positives were shared with either km or FLT3-ITD-ext. We repeated a fragment analysis on the two samples where the false positives were the most abundant, to assess whether they were real false positives. We eventually obtained a sequence by Sanger for both (see Additional file <xref rid="MOESM8" ref-type="media">8</xref>). Two other duplications classified as false positives detected by FiLT3r in SRR15006540 and undetected by the other software had cumulative lengths (16 and 56) corresponding to the length of a duplication detected by the conventional method (72). We thus believe that those two duplications are not false positives and are a consequence of our more fine-grained method that is able to distinguish multiple duplications. This is illustrated in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. 1, with a dotplot of a read from SRR15006540 against our reference sequence. Finally, seven other false positives were due to short single nucleotide deletions that could easily be filtered out.</p>
      <p id="Par45">It is noteworthy that all the false positives were identified in positive samples (apart from one of the Sanger-confirmed duplication) and at lower ratios than the duplication identified by the reference method. Thus, we consider that our original definition of <italic>false positive</italic> was too broad. Instead, we switch to the following, more strict definition: a false positive corresponds to any duplication detected at the threshold of .01 in a negative sample. No software detected a duplication above that threshold among the 71 negative samples. Hence, the most important metric in this context is the false negativity. We show a corrected version of the results in Table <xref rid="Tab1" ref-type="table">1</xref> (b) where false positivity is thus at 0 and where the two Sanger-confirmed sequences are moved from the false positives to the true positives for FiLT3r and km (and added to the false negatives for FLT3-ITD-ext). Among those 185 samples, FiLT3r displayed perfect results as it did not report any false positive nor false negative result. FLT3-ITD-ext discarded all duplications whose length is not a multiple of 3. In AML, it was thought that the <italic>FLT3</italic>-ITD duplication should have a length multiple of 3. However, in our cohort, we showed that two duplications that had not been identified with the reference method did not have lengths multiple of 3. For km the false negatives are of varying lengths (from 6 nt to 126 nt) but with low concentrations. All the false negatives but one has a quantification <inline-formula id="IEq71"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 0.03$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq71.gif"/></alternatives></inline-formula> with the reference method, while the first half of the most abundant duplications were correctly called by km. Also, km correctly detects 10 duplications but is unable to provide a reliable quantification (it gives zero instead).</p>
      <p id="Par46">Beyond the correct detection of ITDs, it is important to also correctly assess the quantification of those duplications as they are meaningful for the prognosis of the patients. Figure <xref rid="Fig4" ref-type="fig">4</xref> shows the quantification computed by the three software packages for the duplications found. Their quantifications are compared to the one found by the reference method. With FiLT3r and FLT3-ITD-ext the quantification is closer to the fragment analysis quantification (respectively <inline-formula id="IEq72"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=.93$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mo>.</mml:mo><mml:mn>93</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq72.gif"/></alternatives></inline-formula> and <inline-formula id="IEq73"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=.88$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mo>.</mml:mo><mml:mn>88</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq73.gif"/></alternatives></inline-formula> for the log-transformed quantifications), compared to km (<inline-formula id="IEq74"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=.76$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mo>.</mml:mo><mml:mn>76</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq74.gif"/></alternatives></inline-formula>). One underestimation of FiLT3r quantification corresponded to the 72nt duplication we previously detailed. Interestingly, the other duplication FiLT3r largely underestimated (in SRR15006376) was also underestimated by a factor of 10 by FLT3-ITD-Ext and was not detected by km.<fig id="Fig4"><label>Fig. 4</label><caption><p>Quantification of duplications found with FiLT3r, km (threshold .01) and FLT3-ITD-ext compared with the fragment analysis method. The grey straight line corresponds to <inline-formula id="IEq75"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y=x$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4983_Article_IEq75.gif"/></alternatives></inline-formula> and ideally the dots should be aligned along that line. The grey area is centred around that line and its width is of one log. The hotter the colour of the dots, the higher the quantification error. Only 8 results are not within this grey area for FiLT3r, 27 for km and 16 for FLT3-ITD-ext</p></caption><graphic xlink:href="12859_2022_4983_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par47">Regarding time and space consumption, FiLT3r showed the best performances (see Figs. <xref rid="Fig5" ref-type="fig">5</xref> and <xref rid="Fig6" ref-type="fig">6</xref> ). We also show the time and memory usage for counting <italic>k</italic>-mers, with Jellyfish, which is a required step for km.<fig id="Fig5"><label>Fig. 5</label><caption><p>Time consumption of FiLT3r, km and FLT3-ITD-Ext on the 185 samples analysed. km-JF is the time taken by Jellyfish (preliminary step required for km), km (0.01) is the time taken by km with the corresponding threshold</p></caption><graphic xlink:href="12859_2022_4983_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par48">In Fig. <xref rid="Fig5" ref-type="fig">5</xref> we see that km at thresholds 0.01 is very fast as it systematically took less than 10 seconds to detect the duplications. However, this does not include Jellyfish time, which must be launched on each sample. While Jellyfish is a very efficient <italic>k</italic>-mer counter, it was 2-3 orders of magnitude slower than km itself. FiLT3r’s median user time (65 s) is 6 times quicker than Jellyfish’s and 9 times quicker than FLT3-ITD-Ext’s. In some cases FLT3-ITD-Ext can be very time-consuming, taking several hours, while FiLT3r never took more than 10 minutes. The progression margin for FiLT3r is quite low as gunzip on the same files took about a third of the time took by FiLT3r (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. 2).</p>
      <p id="Par49">For FiLT3r it appeared that using a Bloom filter dramatically speeded up the software as deactivating the Bloom filter makes FiLT3r one order of magnitude slower (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. 3).<fig id="Fig6"><label>Fig. 6</label><caption><p>Memory consumption of FiLT3r, km and FLT3-ITD-Ext on the 185 samples analysed. km-JF is the memory taken by Jellyfish (preliminary step required for km), km (0.01) is the memory taken by km with the corresponding threshold</p></caption><graphic xlink:href="12859_2022_4983_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par50">Memory consumption was very limited in FiLT3r as we stored a Bloom filter and a hash table of the reference sequence. We also stored reads that match the reference sequence in main memory, but there were generally just a few thousands of them. FLT3-ITD-Ext median memory consumption was close to FiLT3r’s as it was twice as space consuming. However, in some cases the space consumption could reach several GB while FiLT3r used at most 300 MB. Jellyfish memory usage was systematically above that highest memory usage recorded for FiLT3r. We could still improve FiLT3r memory usage by storing on the disk the reads matching the reference sequence. This would however lead to a time penalty.</p>
    </sec>
    <sec id="Sec14">
      <title>152 RNA-Seq samples from CCLE</title>
      <p id="Par51">As expected none of the software detected a <italic>FLT3</italic>-ITD among the 76 lung samples. This tends to confirm the three software have a very low false positive rate. However on 10 samples (all with more than 1 billion reads), FLT3-ITD-ext had to be killed before the results were output as it took too much time (more than 24 h) or too much memory (more than 100 GB).</p>
      <p id="Par52">On the 76 haematological samples, some <italic>FLT3</italic>-ITD were detected by the three software. At the same 0.01 threshold as for the capture sequencing, FiLT3r detected 3 ITDs that were also detected by km, although one of them was only detected by km with -p 0.001 not with -p 0.01. FLT3-ITD-Ext detected the remaining two.</p>
      <p id="Par53">km additionally detected a 60nt ITD in SRR8657348 that was not detected neither by FiLT3r nor FLT3-ITD-Ext. However this 60nt duplication seemed to be an artifact from a 30nt duplication that was actually detected by the three software. km seemed to detect a duplication of the duplication, however we found no read with evidence of such an event.</p>
      <p id="Par54">FLT3-ITD-ext detected three ITDs above the .01 threshold, two of which were not detected by FiLT3r or km: a 108nt ITD in SRR8615750, and a 105nt ITD in SRR8615696. The third ITD (a 78nt duplication in SRR8615696) was also detected by FiLT3r but at a much lower AR (.0007 instead of .02). In this sample we found evidence of only two reads containing the ITD breakpoint, casting doubt on the .02 AR given by FLT3-ITD-Ext. Moreover, km did not detect this ITD but was launched with options -p 0.01 or -p 0.001 and thus could not detect a very lowly expressed ITD. Regarding the 108nt ITD only found by FLT3-ITD-Ext, we found evidence of such a breakpoint in only one read. Concerning the 105nt ITD, the sequence reported by FLT3-ITD-Ext does not align in full-length on the reference, only the first 70nt do align. The last 35nt did not align on NCBI Blast non-redundant nucleotide sequences either. See Additional file <xref rid="MOESM1" ref-type="media">1</xref> for more details.</p>
      <p id="Par55">Overall, FiLT3r completed each task in less than 3 hours with less than 32 MB or RAM (median: 344 s and 26 MB). km (including Jellyfish step) took at most 9.5 hours and 37 GB of RAM for one sample (median: 962 s and 2.5 GB). FLT3-ITD-ext median time was 4400s with a median memory usage of 799 MB of RAM.</p>
    </sec>
    <sec id="Sec15">
      <title>Simulated data</title>
      <p id="Par56">We simulated FLT3-ITDs using itdsim which is part of ITDseek [<xref ref-type="bibr" rid="CR27">27</xref>]. Then the ITDs were sequenced <italic>in silico</italic> using art with the MiSeq v3 profile of errors [<xref ref-type="bibr" rid="CR35">35</xref>]. The detailed results are presented in the Additional files <xref rid="MOESM1" ref-type="media">1</xref>–<xref rid="MOESM15" ref-type="media">15</xref>. In short, they confirmed the results obtained on real data. We also noticed that, the more sequencing errors there are, the more false positives FiLT3r has. However, those false positives are always quantified at ratio below .001. Contrarily to km or FLT3-ITD-ext, FiLT3r did not miss any ITD on the datasets with a normal coverage. FiLT3r also provided the best trade-off between quantification and F1 score.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Conclusions</title>
    <p id="Par57">We introduced FiLT3r, a time and memory efficient algorithm implemented in an open-source C++ software, which showed very good detection and quantification performances compared to state-of-the-art software. On our capture dataset, FiLT3r had a perfect recall, which was not the case of the other software. Even the reference fragment analysis method, exhibited two false negatives, as shown by further Sanger sequencing of the samples. Similarly to the other software, FiLT3r had a perfect precision. FiLT3r performances were better than that of FLT3-ITD-ext, the best software identified so far by an independent benchmark, which is alignment-based. Moreover FLT3-ITD-ext could not run on several RNA-seq dataset due to large resource requirements (both time and memory). In two cases on RNA-seq dataset, FLT3-ITD-ext reported quantification that appeared largely overestimated.</p>
    <p id="Par58">This illustrates that alignment-free algorithms can be more efficient than alignment-based algorithms while using a fraction of the resources they need. Beyond the <italic>FLT3</italic>-ITD analysis, FiLT3r can also be used to detect duplications in any gene as soon as the reference sequence is known. We plan to apply our method to other genes in other contexts, as it has been shown that tandem duplications can be prognostic signatures in other cancers (such as gastric cancers [<xref ref-type="bibr" rid="CR36">36</xref>]).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4983_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>. supp file 1: filt3r-supp.pdf.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2022_4983_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2</bold>. supp file 2: results_sra.xlsx.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2022_4983_MOESM3_ESM.tsv">
            <caption>
              <p><bold>Additional file 3</bold>. supp file 3: accessions.tsv.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2022_4983_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4</bold>. supp file 4: results-different-k.xlsx.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2022_4983_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5</bold>. supp file 5: results-small-k.xlsx.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2022_4983_MOESM6_ESM.xlsx">
            <caption>
              <p><bold>Additional file 6</bold>. supp file 6: results-different-perc.xlsx.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12859_2022_4983_MOESM7_ESM.xlsx">
            <caption>
              <p><bold>Additional file 7</bold>. supp file 7: results-subsamples.xlsx.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="12859_2022_4983_MOESM8_ESM.pdf">
            <caption>
              <p><bold>Additional file 8</bold>. supp file 8: genescan_SRR15006459.pdf.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="12859_2022_4983_MOESM9_ESM.pdf">
            <caption>
              <p><bold>Additional file 9</bold>. supp file 9: genescan_SRR15006372.pdf.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="12859_2022_4983_MOESM10_ESM.csv">
            <caption>
              <p><bold>Additional file 10</bold>. supp file 10: accessions-CCLE.csv.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="12859_2022_4983_MOESM11_ESM.xlsx">
            <caption>
              <p><bold>Additional file 11</bold>. supp file 11: results_simulated_150bp.xlsx.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM12">
          <media xlink:href="12859_2022_4983_MOESM12_ESM.xlsx">
            <caption>
              <p><bold>Additional file 12</bold>. supp file 12: results_simulated_250bp_hq.xlsx.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM13">
          <media xlink:href="12859_2022_4983_MOESM13_ESM.xlsx">
            <caption>
              <p><bold>Additional file 13</bold>. supp file 13: results_simulated_250bp_lc.xlsx.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM14">
          <media xlink:href="12859_2022_4983_MOESM14_ESM.xlsx">
            <caption>
              <p><bold>Additional file 14</bold>. supp file 14: results_simulated_250bp_lq.xlsx.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM15">
          <media xlink:href="12859_2022_4983_MOESM15_ESM.xlsx">
            <caption>
              <p><bold>Additional file 15</bold>. supp file 15: results_simulated_250bp.xls.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par63">For a discussion on the choice of <italic>k</italic>, see the Additional files <xref rid="MOESM1" ref-type="media">1</xref>–<xref rid="MOESM15" ref-type="media">15</xref>, section <italic>Choosing the parameters</italic>.</p>
    </fn>
    <fn>
      <p>The original version of this article was revised: the files are listed separately as additional files.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We are grateful to É. Audemard for valuable discussions on their publications and software. We are also grateful to the bioinformatics service in CHU Lille for their helpful advices.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>AB, SD, MF and MS implemented the software. AB and MS performed the benchmarks. MS supervised the algorithmic design. ND, SG, MB, MD, RJ, LF, ON, CP performed the molecular studies. KCL ensured the data management. LG, RI, HD and MH provided samples and clinical data. HD and MH were the clinical investigators of the study. CP coordinated the biological collection. AB and MS wrote the manuscript. ND, MF, MD, RJ, RI corrected the proofs. All the authors approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This study was partially funded by the French Cancer National Institute (PHRC 2007/1911 and PRTK TRANSLA10-060).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The software is available on the Git repository at <ext-link ext-link-type="uri" xlink:href="https://gitlab.univ-lille.fr/filt3r/filt3r">gitlab.univ-lille.fr/filt3r/filt3r</ext-link> The experiments made in this paper can be reproduced using the Snakefile in the reproducibility/ directory of the aforementioned Git repository. The data analysed in the publication is publicly available on SRA. The accessions of the datasets are provided in the Supplementary files.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par59">The study was conducted according to the Declaration of Helsinki and was approved (nos. CSTMT289) by the Human Research Committee of Lille and the institutional review board of the Lille University Hospital Tumor Bank (certification NF 96900-2014/65453-1). The patients gave their written informed consent.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par60">Not applicable</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par61">RI : Honoraria: Daiichi-Sankyo, Astellas. The other authors don’t have any competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shuai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>The flt3-itd mutation and the expression of its downstream signaling intermediates stat5 and pim-1 are positively correlated with cxcr4 expression in patients with acute myeloid leukemia</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-48687-z</pub-id>
        <pub-id pub-id-type="pmid">30626917</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pratz</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Levis</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Bench to bedside targeting of FLT3 in acute leukemia</article-title>
        <source>Current Drug Targets</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>7</issue>
        <fpage>781</fpage>
        <lpage>789</lpage>
        <pub-id pub-id-type="doi">10.2174/138945010791320782</pub-id>
        <pub-id pub-id-type="pmid">20370649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Small</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>FLT3 mutations: biology and treatment</article-title>
        <source>ASH Edu Prog Book</source>
        <year>2006</year>
        <volume>2006</volume>
        <issue>1</issue>
        <fpage>178</fpage>
        <lpage>184</lpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thiede</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Steudel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mohr</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schaich</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schäkel</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Platzbecker</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Wermke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bornhäuser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ritter</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Neubauer</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of FLT3-activating mutations in 979 patients with acute myelogenous leukemia: association with FAB subtypes and identification of subgroups with poor prognosis</article-title>
        <source>Blood J Am Soc Hematol</source>
        <year>2002</year>
        <volume>99</volume>
        <issue>12</issue>
        <fpage>4326</fpage>
        <lpage>4335</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kottaridis</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Gale</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Frew</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Langabeer</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Belton</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wheatley</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bowen</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Burnett</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The presence of a FLT3 internal tandem duplication in patients with acute myeloid leukemia (AML) adds important prognostic information to cytogenetic risk group and response to the first cycle of chemotherapy: analysis of 854 patients from the United Kingdom Medical Research Council AML 10 and 12 trials</article-title>
        <source>Blood J Am Soc Hematol</source>
        <year>2001</year>
        <volume>98</volume>
        <issue>6</issue>
        <fpage>1752</fpage>
        <lpage>1759</lpage>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schlenk</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Kayser</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bullinger</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kobbe</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Casper</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ringhoffer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Held</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Brossart</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Luebbert</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salih</surname>
            <given-names>HR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differential impact of allelic ratio and insertion site in FLT3-ITD-positive AML with respect to allogeneic transplantation</article-title>
        <source>Blood J Am Soc Hematol</source>
        <year>2014</year>
        <volume>124</volume>
        <issue>23</issue>
        <fpage>3441</fpage>
        <lpage>3449</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Döhner</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Estey</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Grimwade</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Amadori</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Appelbaum</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Büchner</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dombret</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Fenaux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diagnosis and management of AML in adults: 2017 ELN recommendations from an international expert panel</article-title>
        <source>Blood J Am Soc Hematol</source>
        <year>2017</year>
        <volume>129</volume>
        <issue>4</issue>
        <fpage>424</fpage>
        <lpage>447</lpage>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunter</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y-B</given-names>
          </name>
        </person-group>
        <article-title>Current approaches to transplantation for FLT3-ITD AML</article-title>
        <source>Current Hematol Malig Rep</source>
        <year>2020</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1007/s11899-020-00558-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daver</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schlenk</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Russell</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Levis</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Targeting FLT3 mutations in AML: review of current knowledge and evidence</article-title>
        <source>Leukemia</source>
        <year>2019</year>
        <volume>33</volume>
        <issue>2</issue>
        <fpage>299</fpage>
        <lpage>312</lpage>
        <pub-id pub-id-type="doi">10.1038/s41375-018-0357-9</pub-id>
        <pub-id pub-id-type="pmid">30651634</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stone</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Mandrekar</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Sanford</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Laumann</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Geyer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bloomfield</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Thiede</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Prior</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Döhner</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marcucci</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Midostaurin plus chemotherapy for acute myeloid leukemia with a FLT3 mutation</article-title>
        <source>N. Engl. J Med</source>
        <year>2017</year>
        <volume>377</volume>
        <issue>5</issue>
        <fpage>454</fpage>
        <lpage>464</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa1614359</pub-id>
        <pub-id pub-id-type="pmid">28644114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xuan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sorafenib maintenance in patients with FLT3-ITD acute myeloid leukaemia undergoing allogeneic haematopoietic stem-cell transplantation: an open-label, multicentre, randomised phase 3 trial</article-title>
        <source>Lancet Oncol</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>9</issue>
        <fpage>1201</fpage>
        <lpage>1212</lpage>
        <pub-id pub-id-type="doi">10.1016/S1470-2045(20)30455-1</pub-id>
        <pub-id pub-id-type="pmid">32791048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lyu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shuai</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>The prognosis predictive value of FMS-like tyrosine kinase 3-internal tandem duplications mutant allelic ratio (FLT3-ITD MR) in patients with acute myeloid leukemia detected by GeneScan</article-title>
        <source>Gene</source>
        <year>2020</year>
        <volume>726</volume>
        <fpage>144195</fpage>
        <pub-id pub-id-type="doi">10.1016/j.gene.2019.144195</pub-id>
        <pub-id pub-id-type="pmid">31669649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Levis</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hafez</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Geiger</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Small</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Berg</surname>
            <given-names>KD</given-names>
          </name>
        </person-group>
        <article-title>Detection of FLT3 internal tandem duplication and D835 mutations by a multiplex polymerase chain reaction and capillary electrophoresis assay</article-title>
        <source>J Mol Diagn</source>
        <year>2003</year>
        <volume>5</volume>
        <issue>2</issue>
        <fpage>96</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="doi">10.1016/S1525-1578(10)60458-8</pub-id>
        <pub-id pub-id-type="pmid">12707374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Min</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Quantitative fragment analysis of FLT3-ITD efficiently identifying poor prognostic group with high mutant allele burden or long ITD length</article-title>
        <source>Blood Cancer J</source>
        <year>2015</year>
        <volume>5</volume>
        <issue>8</issue>
        <fpage>336</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="doi">10.1038/bcj.2015.61</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sakaguchi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nakajima</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yamaguchi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Najima</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shono</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marumo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Omori</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Fujiwara</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Terada</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Yui</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sensitivity of the FLT3-ITD detection method is an important consideration when diagnosing acute myeloid leukemia</article-title>
        <source>Leukemia Res Rep</source>
        <year>2020</year>
        <volume>13</volume>
        <fpage>100198</fpage>
        <pub-id pub-id-type="pmid">32368486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schranz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hubmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Harin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vosberg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Herold</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Metzeler</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Rothenberg-Thurley</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Janke</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bräundl</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ksienzyk</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clonal heterogeneity of FLT3-ITD detected by high-throughput amplicon sequencing correlates with adverse prognosis in acute myeloid leukemia</article-title>
        <source>Oncotarget</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>53</issue>
        <fpage>30128</fpage>
        <pub-id pub-id-type="doi">10.18632/oncotarget.25729</pub-id>
        <pub-id pub-id-type="pmid">30046393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Rücker FG, Du L, Luck TJ, Benner A, Krzykalla J, Gathmann I, Voso MT, Amadori S, Prior TW, Brandwein JM, et al. Molecular landscape and prognostic impact of flt3-itd insertion site in acute myeloid leukemia: ratify study results. Leukemia. 2021:1–10.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ning</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Pindel: a pattern growth approach to detect break points of large deletions and medium sized insertions from paired-end short reads</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>21</issue>
        <fpage>2865</fpage>
        <lpage>2871</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp394</pub-id>
        <pub-id pub-id-type="pmid">19561018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Yuan D, He X, Han X, Yang C, Liu F, Zhang S, Luan H, Li R, He J, Duan X, Wang D, Zhou Q, Gao S, Niu B. Comprehensive review and evaluation of computational methods for identifying FLT3-internal tandem duplication in acute myeloid leukaemia. Brief Bioinf (bbab099) 2021. 10.1093/bib/bbab099</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zielezinski</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vinga</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Almeida</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Karlowski</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Alignment-free sequence comparison: benefits, applications, and tools</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>186</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1319-7</pub-id>
        <pub-id pub-id-type="pmid">28974235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Audemard EO, Gendron P, Feghaly A, Lavallée V-P, Hébert J, Sauvageau G, Lemieux S. Targeted variant detection using unaligned RNA-Seq reads. Life Sci Alliance 2019;2(4). 10.26508/lsa.201900336. Accessed 2020-08-18</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marçais</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kingsford</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>6</issue>
        <fpage>764</fpage>
        <lpage>770</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr011</pub-id>
        <pub-id pub-id-type="pmid">21217122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Philippe</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Salson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Commes</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Rivals</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>CRAC: an integrated approach to the analysis of RNA-seq reads</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-3-r30</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laehnemann</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Borkhardt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>Denoising dna deep sequencing data-high-throughput sequencing errors and their correction</article-title>
        <source>Brief Bioinf</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>154</fpage>
        <lpage>179</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbv029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bloom</surname>
            <given-names>BH</given-names>
          </name>
        </person-group>
        <article-title>Space/time trade-offs in hash coding with allowable errors</article-title>
        <source>Commun ACM</source>
        <year>1970</year>
        <volume>13</volume>
        <issue>7</issue>
        <fpage>422</fpage>
        <lpage>426</lpage>
        <pub-id pub-id-type="doi">10.1145/362686.362692</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drezen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rizk</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chikhi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Deltel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lemaitre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Peterlongo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lavenier</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Gatb: genome assembly &amp; analysis tool box</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>20</issue>
        <fpage>2959</fpage>
        <lpage>2961</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu406</pub-id>
        <pub-id pub-id-type="pmid">24990603</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Au</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Wa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Clinical evaluation of panel testing by next-generation sequencing (ngs) for gene mutations in myeloid neoplasms</article-title>
        <source>Diagn Pathol</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1186/s13000-016-0456-8</pub-id>
        <pub-id pub-id-type="pmid">26746436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Wang T-Y, Yang R. ScanITD: Detecting internal tandem duplication with robust variant allele frequency estimation. GigaScience 9(giaa089) 2020. 10.1093/gigascience/giaa089</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blätte</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Schmalbrock</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Skambraks</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lux</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cocciardi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dolnik</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Döhner</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Döhner</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bullinger</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>getITD for FLT3-ITD-based MRD monitoring in AML</article-title>
        <source>Leukemia</source>
        <year>2019</year>
        <volume>33</volume>
        <issue>10</issue>
        <fpage>2535</fpage>
        <lpage>2539</lpage>
        <pub-id pub-id-type="doi">10.1038/s41375-019-0483-z</pub-id>
        <pub-id pub-id-type="pmid">31089248</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiba</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shiraishi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nagata</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yoshida</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Imoto</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ogawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Miyano</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Genomon itdetector: a tool for somatic internal tandem duplication detection from cancer genome sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>1</issue>
        <fpage>116</fpage>
        <lpage>118</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu593</pub-id>
        <pub-id pub-id-type="pmid">25192740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Tsai HK, Brackett DG, Szeto D, Frazier R, MacLeay A, Davineni P, Manning DK, Garcia E, Lindeman NI, Le LP, Lennerz JK, Gibson CJ, Lindsley RC, Kim AS, Nardi V. Targeted informatics for optimal detection, characterization, and quantification of FLT3 internal tandem duplications across multiple next-generation sequencing platforms. J Mol Diagn. 2020;22(9):1162–78. 10.1016/j.jmoldx.2020.06.006 Accessed 2021-07-05.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Li, H. Aligning sequence reads, clone sequences and assembly contigs with bwa-mem. arXiv preprint <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1303.3997">arXiv:1303.3997</ext-link> (2013)</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Boissel N, Cayuela J, Preudhomme C, Thomas X, Grardel N, Fund X, Tigaud I, Raffoux E, Rousselot P, Sigaux F, <italic>et al.</italic> Prognostic significance of FLT3 internal tandem repeat in patients with de novo acute myeloid leukemia treated with reinforced courses of chemotherapy. Leukemia 2002;16(9):1699–1704.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ghandi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>FW</given-names>
          </name>
          <name>
            <surname>Jané-Valbuena</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kryukov</surname>
            <given-names>GV</given-names>
          </name>
          <name>
            <surname>Lo</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Barretina</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gelfand</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Bielski</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Next-generation characterization of the cancer cell line encyclopedia</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <issue>7757</issue>
        <fpage>503</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1186-3</pub-id>
        <pub-id pub-id-type="pmid">31068700</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>Art: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xing</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nie</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>WK</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole-genome sequencing reveals novel tandem-duplication hotspots and a prognostic mutational signature in gastric cancer</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09644-6</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
