<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1635428</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-7-389</article-id>
    <article-id pub-id-type="pmid">16930469</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-7-389</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fast index based algorithms and software for matching position specific scoring matrices</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Beckstette</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>mbeckste@techfak.uni-bielefeld.de</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Homann</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>rhomann@techfak.uni-bielefeld.de</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Giegerich</surname>
          <given-names>Robert</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>robert@techfak.uni-bielefeld.de</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Kurtz</surname>
          <given-names>Stefan</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>kurtz@zbh.uni-hamburg.de</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>International NRW Graduate School in Bioinformatics and Genome Research, Center for Biotechnology (CeBITec), Bielefeld University, D-33594 Bielefeld, Germany</aff>
    <aff id="I2"><label>2</label>Technische Fakultät, Universität Bielefeld, Postfach 100 131, D-33501 Bielefeld, Germany</aff>
    <aff id="I3"><label>3</label>Zentrum für Bioinformatik, Universität Hamburg, 20146 Hamburg, Germany</aff>
    <pub-date pub-type="collection">
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>8</month>
      <year>2006</year>
    </pub-date>
    <volume>7</volume>
    <fpage>389</fpage>
    <lpage>389</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/7/389"/>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>4</month>
        <year>2006</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>8</month>
        <year>2006</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2006 Beckstette et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2006</copyright-year>
      <copyright-holder>Beckstette et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Beckstette
               Michael
               
               
               mbeckste@techfak.uni-bielefeld.de
            </dc:author><dc:title>
            Fast index based algorithms and software for matching position specific scoring matrices
         </dc:title><dc:date>2006</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 7(1): 389-. (2006)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2006)7:1&#x0003c;389&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>In biological sequence analysis, position specific scoring matrices (PSSMs) are widely used to represent sequence motifs in nucleotide as well as amino acid sequences. Searching with PSSMs in complete genomes or large sequence databases is a common, but computationally expensive task.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a new non-heuristic algorithm, called <italic>ESAsearch</italic>, to efficiently find matches of PSSMs in large databases. Our approach preprocesses the search space, e.g., a complete genome or a set of protein sequences, and builds an enhanced suffix array that is stored on file. This allows the searching of a database with a PSSM in sublinear expected time. Since <italic>ESAsearch </italic>benefits from small alphabets, we present a variant operating on sequences recoded according to a reduced alphabet. We also address the problem of non-comparable PSSM-scores by developing a method which allows the efficient computation of a matrix similarity threshold for a PSSM, given an E-value or a p-value. Our method is based on dynamic programming and, in contrast to other methods, it employs lazy evaluation of the dynamic programming matrix. We evaluated algorithm <italic>ESAsearch </italic>with nucleotide PSSMs and with amino acid PSSMs. Compared to the best previous methods, <italic>ESAsearch </italic>shows speedups of a factor between 17 and 275 for nucleotide PSSMs, and speedups up to factor 1.8 for amino acid PSSMs. Comparisons with the most widely used programs even show speedups by a factor of at least 3.8. Alphabet reduction yields an additional speedup factor of 2 on amino acid sequences compared to results achieved with the 20 symbol standard alphabet. The lazy evaluation method is also much faster than previous methods, with speedups of a factor between 3 and 330.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>Our analysis of <italic>ESAsearch </italic>reveals sublinear runtime in the expected case, and linear runtime in the worst case for sequences not shorter than |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>m </italic></sup>+ <italic>m </italic>- 1, where <italic>m </italic>is the length of the PSSM and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> a finite alphabet. In practice, <italic>ESAsearch </italic>shows superior performance over the most widely used programs, especially for DNA sequences. The new algorithm for accurate on-the-fly calculations of thresholds has the potential to replace formerly used approximation approaches. Beyond the algorithmic contributions, we provide a robust, well documented, and easy to use software package, implementing the ideas and algorithms presented in this manuscript.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Position specific scoring matrices (PSSMs) have a long history in sequence analysis (see [<xref ref-type="bibr" rid="B1">1</xref>]). A high PSSM-score in some region of a sequence often indicates a possible biological relationship of this sequence to the family or motif characterized by the PSSM. There are several databases utilizing PSSMs for function assignment and annotation, e.g., PROSITE [<xref ref-type="bibr" rid="B2">2</xref>], PRINTS [<xref ref-type="bibr" rid="B3">3</xref>], BLOCKS [<xref ref-type="bibr" rid="B4">4</xref>], EMATRIX [<xref ref-type="bibr" rid="B5">5</xref>], JASPAR [<xref ref-type="bibr" rid="B6">6</xref>], or TRANSFAC [<xref ref-type="bibr" rid="B7">7</xref>]. While these databases are constantly improved, there are only few improvements in the programs searching with PSSMs. E.g., the programs <italic>FingerPrintScan </italic>[<xref ref-type="bibr" rid="B8">8</xref>], <italic>BLIMPS </italic>[<xref ref-type="bibr" rid="B4">4</xref>], and <italic>MatInspector</italic>[<xref ref-type="bibr" rid="B9">9</xref>] still use a straightforward <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>mn</italic>)-time algorithm to search a PSSM of length <italic>m </italic>in a sequence of length <italic>n</italic>. In [<xref ref-type="bibr" rid="B10">10</xref>] the authors presented a method based on Fourier transformation. A different method introduced in [<xref ref-type="bibr" rid="B11">11</xref>] employs data compression. To the best of our knowledge there is no software available implementing these two methods. The most advanced program in the field of searching with PSSMs is <italic>EMATRIX </italic>[<xref ref-type="bibr" rid="B12">12</xref>], which incorporates a technique called lookahead scoring. The lookahead scoring technique is also employed in the suffix tree based method of [<xref ref-type="bibr" rid="B13">13</xref>]. This method performs a limited depth first traversal of the suffix tree of the set of target sequences. This search updates PSSM-scores along the edges of the suffix tree. Lookahead scoring allows to skip subtrees of the suffix tree that do not contain any matches to the PSSM. Unfortunately, the method of [<xref ref-type="bibr" rid="B13">13</xref>] has not found its way into a widely available and robust software system. In [<xref ref-type="bibr" rid="B14">14</xref>], the development of new, more efficient algorithms for searching with PSSMs is considered an important problem, which still needs better solutions.</p>
    <p>In this paper, we present a new, non-heuristic algorithm for searching with PSSMs. With any non-heuristic PSSM searching algorithm, the performance in terms of sensitivity and specificity solely depends on the used PSSM and threshold, i.e. given a PSSM and threshold, all these algorithms give exactly the same results. For the generation of PSSMs from aligned sequences, numerous different methods, were described in literature over the last decades [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B15">15</xref>-<xref ref-type="bibr" rid="B17">17</xref>]. Rather than improving PSSMs, we focus on improvements in terms of time and space efficiency when searching with PSSMs, independently of their underlying generation method. The overall structure of our proposed search algorithm is similar to the method of [<xref ref-type="bibr" rid="B13">13</xref>]. However, instead of suffix trees we use enhanced suffix arrays, a data structure which is as powerful as suffix trees (cf. [<xref ref-type="bibr" rid="B18">18</xref>]). Enhanced suffix arrays provide several advantages over suffix trees, which make them more suitable for searching with PSSMs:</p>
    <p>• While suffix trees require about 12<italic>n </italic>bytes in the best available implementation (cf. [<xref ref-type="bibr" rid="B19">19</xref>]), the enhanced suffix array used for searching with PSSMs only needs 9<italic>n </italic>bytes of space.</p>
    <p>• While the suffix tree is usually only computed in main memory, the enhanced suffix array is computed once and stored on file. Whenever a PSSM is to be searched, the enhanced suffix array is mapped into main memory which requires no extra time.</p>
    <p>• While the depth first traversal of the suffix tree suffers from the poor locality behavior of the data structure (cf. [<xref ref-type="bibr" rid="B20">20</xref>]), the enhanced suffix array provides optimal locality, because when searching with PSSMs it is sequentially scanned from left to right.</p>
    <p>One of the algorithmic contributions of this paper is a new technique that allows to skip parts of the enhanced suffix array containing no matches to the PSSM. Due to the skipping, our algorithm achieves an expected running time that is sublinear in the size of the search space (i.e., the size of the nucleotide or protein database). As a consequence, our algorithm scales very well for large data sizes.</p>
    <p>Since the running time of our algorithm increases with the size of the underlying alphabet, we developed a filtering technique, utilizing alphabet reduction, that achieves better performance especially on sequences/PSSMs over the amino acid alphabet.</p>
    <p>When searching with a PSSM, it is important to determine a suitable threshold for a PSSM-match. Usually, the user prefers to specify a significance threshold (i.e., an E-value or a p-value) which has to be transformed into an absolute score threshold for the PSSM under consideration. This can be done by computing the score distribution of the PSSM, using well-known dynamic programming (DP, for short) methods, e.g., [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B21">21</xref>-<xref ref-type="bibr" rid="B23">23</xref>]. Unfortunately, these methods are not fast enough for large PSSMs. For this reason, we have developed a new, lazy evaluation algorithm that only computes a small fraction of the complete score distribution. Our algorithm speeds up the computation of the threshold by factor of at least 3, compared to standard DP methods. This makes our algorithm applicable for on-the-fly computations of the score thresholds.</p>
    <p>The new algorithms described in this paper are implemented as part of the <italic>PoSSuM </italic>software distribution. This is available free of charge for non-commercial research institutions. For details, see [<xref ref-type="bibr" rid="B24">24</xref>]. Parts of this contribution appeared as [<xref ref-type="bibr" rid="B25">25</xref>] in proceedings of GCB2004.</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>PSSMs and lookahead scoring: LAsearch</title>
      <p>A PSSM is an abstraction of a multiple alignment of related sequences. We define it as a function <italic>M </italic>: [0, <italic>m </italic>- 1] × <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> → ℝ, where <italic>m </italic>is the length of <italic>M </italic>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> is a finite alphabet. Usually <italic>M </italic>is represented by an <italic>m </italic>× |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>| matrix, see Figure <xref ref-type="fig" rid="F1">1</xref> for an example. Each row of the matrix reflects the frequency of occurrence of each amino acid or nucleotide at the corresponding position of the alignment. From now on, let M be a PSSM of length <italic>m </italic>and let <italic>w</italic>[<italic>i</italic>] denote the character of <italic>w </italic>at position <italic>i </italic>for 0 ≤ <italic>i &lt; m</italic>. Further on, <italic>w</italic>[<italic>i</italic>..<italic>j</italic>] denotes the string starting at position <italic>i </italic>and ending at position <italic>j</italic>. We define <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-7-389-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGZbWCcqWGJbWydaqadiqaaiabdEha3jabcYcaSiabd2eanbGaayjkaiaawMcaaiabcQda6iabg2da9maaqadabaGaemyta00aaeWaceaacqWGPbqAcqGGSaalcqWG3bWDcqGGBbWwcqWGPbqAcqGGDbqxaiaawIcacaGLPaaaaSqaaiabdMgaPjabg2da9iabicdaWaqaaiabd2gaTjabgkHiTiabigdaXaqdcqGHris5aaaa@493D@</mml:annotation></mml:semantics></mml:math></inline-formula> for a sequence <italic>w </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula><sup><italic>m </italic></sup>of length <italic>m</italic>. <italic>sc </italic>(<italic>w</italic>, <italic>M</italic>) is the <italic>match score of w </italic>w.r.t. <italic>M</italic>. The <italic>score range </italic>of a PSSM is the interval [<italic>sc</italic><sub>min</sub>(<italic>M</italic>), <italic>sc</italic><sub>max</sub>(<italic>M</italic>)] with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-7-389-i4" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:mstyle><mml:mo>{</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGZbWCcqWGJbWydaWgaaWcbaGagiyBa0MaeiyAaKMaeiOBa4gabeaakiabcIcaOiabd2eanjabcMcaPiabcQda6iabg2da9maaqadabaGagiyBa0MaeiyAaKMaeiOBa4galeaacqWGPbqAcqGH9aqpcqaIWaamaeaacqWGTbqBcqGHsislcqaIXaqma0GaeyyeIuoakiabcUha7jabd2eanjabcIcaOiabdMgaPjabcYcaSiabdggaHjabcMcaPiabcYha8jabdggaHjabgIGioJWaaiab=bq8bjabc2ha9baa@5E75@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-7-389-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:mstyle><mml:mo>{</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>}</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGZbWCcqWGJbWydaWgaaWcbaGagiyBa0MaeiyyaeMaeiiEaGhabeaakiabcIcaOiabd2eanjabcMcaPiabcQda6iabg2da9maaqadabaGagiyBa0MaeiyyaeMaeiiEaGhaleaacqWGPbqAcqGH9aqpcqaIWaamaeaacqWGTbqBcqGHsislcqaIXaqma0GaeyyeIuoakiabcUha7jabd2eanjabcIcaOiabdMgaPjabcYcaSiabdggaHjabcMcaPiabcYha8jabdggaHjabgIGioJWaaiab=bq8bjabc2ha9baa@5E7D@</mml:annotation></mml:semantics></mml:math></inline-formula>. Given a sequence <italic>S </italic>of length <italic>n </italic>over alphabet <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> and a score threshold <italic>th</italic>, the <italic>PSSM matching problem </italic>is to find all positions <italic>j </italic>∈ [0, <italic>n </italic>- <italic>m</italic>] in <italic>S </italic>and their assigned match scores, such that <italic>sc </italic>(<italic>S</italic>[<italic>j..j </italic>+ <italic>m </italic>- 1], <italic>M</italic>) ≥ <italic>th</italic>.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Amino acid PSSM</bold>. Amino acid PSSM of length <italic>m </italic>= 10 of a zinc-finger motif. If the score threshold is <italic>th </italic>= 400, then only substrings beginning with <italic>C </italic>or <italic>V </italic>can match the PSSM, because all other amino acids score below the intermediate threshold <italic>th</italic><sub>0 </sub>= <italic>th </italic>- <italic>σ</italic><sub>0 </sub>= 400 - 398 = 2. That is, lookahead scoring will skip over all substrings which begin with amino acids different from <italic>C </italic>and <italic>V</italic>. Here <italic>σ</italic><sub><italic>d</italic></sub>, <italic>d </italic>∈ [0, <italic>m </italic>- 1] denotes the maximal score that can be achieved in the last <italic>m </italic>- <italic>d </italic>- 1 positions of the PSSM as defined in the text.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-389-1"/>
      </fig>
      <p>A simple algorithm for the PSSM matching problem slides along the sequence and computes <italic>sc </italic>(<italic>w</italic>, <italic>M</italic>) for each <italic>w </italic>= <italic>S </italic>[<italic>j..j </italic>+ <italic>m </italic>- 1], <italic>j </italic>∈ [0, <italic>n </italic>- <italic>m</italic>]. The running time of this algorithm is <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>mn</italic>). It is used e.g., in the programs <italic>FingerPrintScan </italic>[<xref ref-type="bibr" rid="B8">8</xref>], <italic>BLIMPS </italic>[<xref ref-type="bibr" rid="B4">4</xref>], <italic>MatInspector</italic>[<xref ref-type="bibr" rid="B9">9</xref>], and <italic>MATCH </italic>[<xref ref-type="bibr" rid="B17">17</xref>].</p>
      <p>In [<xref ref-type="bibr" rid="B12">12</xref>], lookahead scoring is introduced to improve the simple algorithm. Lookahead scoring allows to stop the calculation of <italic>sc </italic>(<italic>w</italic>, <italic>M</italic>) when it is clear that the given overall score threshold <italic>th </italic>cannot be achieved. To be more precise, we define <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-7-389-i6" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>p</mml:mi><mml:mi>f</mml:mi><mml:mi>x</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGWbaCcqWGMbGzcqWG4baEcqWGZbWCcqWGJbWydaWgaaWcbaGaemizaqgabeaakmaabmGabaGaem4DaCNaeiilaWIaemyta0eacaGLOaGaayzkaaGaeiOoaOJaeyypa0ZaaabmaeaacqWGnbqtdaqadiqaaiabdIgaOjabcYcaSiabdEha3jabcUfaBjabdIgaOjabc2faDbGaayjkaiaawMcaaaWcbaGaemiAaGMaeyypa0JaeGimaadabaGaemizaqganiabggHiLdaaaa@4D06@</mml:annotation></mml:semantics></mml:math></inline-formula>, <italic>max</italic><sub><italic>d </italic></sub>:= max{<italic>M</italic>(<italic>d</italic>, <italic>a</italic>) | <italic>a </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>}, and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-7-389-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaWgaaWcbaGaemizaqgabeaakiabcQda6iabg2da9maaqadabaacbiGae4xBa0Mae4xyaeMae4hEaG3aaSbaaSqaaiabdIgaObqabaaabaGaemiAaGMaeyypa0JaemizaqMaey4kaSIaeGymaedabaGaemyBa0MaeyOeI0IaeGymaedaniabggHiLdaaaa@4260@</mml:annotation></mml:semantics></mml:math></inline-formula> for any <italic>d </italic>∈ [0, <italic>m </italic>- 1]. <italic>pfxsc</italic><sub><italic>d</italic></sub>(<italic>w, M</italic>) is the <italic>prefix score of depth d</italic>. <italic>σ</italic><sub><italic>d </italic></sub>is the maximal score that can be achieved in the last <italic>m </italic>- <italic>d </italic>- 1 positions of the PSSM. Let <italic>th</italic><sub><italic>d </italic></sub>:= <italic>th </italic>- <italic>σ</italic><sub><italic>d </italic></sub>be the <italic>intermediate threshold </italic>at position <italic>d</italic>. The correctness of lookahead scoring, not shown in [<xref ref-type="bibr" rid="B12">12</xref>], is implied by the following Lemma:</p>
      <p><bold>Lemma 1 </bold>The following statements are equivalent:</p>
      <p>(1) <italic>pfxsc</italic><sub><italic>d </italic></sub>(<italic>w</italic>, <italic>M</italic>) ≥ <italic>th</italic><sub><italic>d </italic></sub>for all <italic>d </italic>∈ [0, <italic>m </italic>- 1],</p>
      <p>(2) <italic>sc</italic>(<italic>w</italic>, <italic>M</italic>) ≥ <italic>th</italic>.</p>
      <p><bold>Proof</bold>: (1)⇒(2): Suppose that (1) holds. Then <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-7-389-i8" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFdpWCdaWgaaWcbaGaemyBa0MaeyOeI0IaeGymaedabeaakiabg2da9maaqadabaacbiGae4xBa0Mae4xyaeMae4hEaG3aaSbaaSqaaiabdIgaObqabaGccqGH9aqpcqaIWaamaSqaaiabdIgaOjabg2da9iabd2gaTbqaaiabd2gaTjabgkHiTiabigdaXaqdcqGHris5aaaa@439C@</mml:annotation></mml:semantics></mml:math></inline-formula> and</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-7-389-i9" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mi>s</mml:mi>
                <mml:mi>c</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>h</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>h</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>w</mml:mi>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mi>h</mml:mi>
                        <mml:mo stretchy="false">]</mml:mo>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mtext> </mml:mtext>
                <mml:mtext> </mml:mtext>
                <mml:mi>p</mml:mi>
                <mml:mi>f</mml:mi>
                <mml:mi>x</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:msub>
                  <mml:mi>c</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>≥</mml:mo>
                <mml:mi>t</mml:mi>
                <mml:msub>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:msub>
                  <mml:mi>σ</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mo>.</mml:mo>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGZbWCcqWGJbWydaqadiqaaiabdEha3jabcYcaSiabd2eanbGaayjkaiaawMcaaiabg2da9maaqahabaGaemyta00aaeWaceaacqWGObaAcqGGSaalcqWG3bWDcqGGBbWwcqWGObaAcqGGDbqxaiaawIcacaGLPaaacqGH9aqpaSqaaiabdIgaOjabg2da9iabicdaWaqaaiabd2gaTjabgkHiTiabigdaXaqdcqGHris5aOGaaGPaVlaaykW7cqWGWbaCcqWGMbGzcqWG4baEcqWGZbWCcqWGJbWydaWgaaWcbaGaemyBa0MaeyOeI0IaeGymaedabeaakmaabmGabaGaem4DaCNaeiilaWIaemyta0eacaGLOaGaayzkaaGaeyyzImRaemiDaqNaemiAaG2aaSbaaSqaaiabd2gaTjabgkHiTiabigdaXaqabaGccqGH9aqpcqWG0baDcqWGObaAcqGHsisliiGacqWFdpWCdaWgaaWcbaGaemyBa0MaeyOeI0IaeGymaedabeaakiabg2da9iabdsha0jabdIgaOjabc6caUaaa@72C8@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>(2)⇒(1): Suppose that (2) holds. Let <italic>d </italic>∈ [0, <italic>m </italic>- 1]. Then</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-7-389-i10" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mi>s</mml:mi>
                    <mml:mi>c</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mi>h</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>w</mml:mi>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mi>h</mml:mi>
                            <mml:mo stretchy="false">]</mml:mo>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mstyle>
                    <mml:mo>=</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                        <mml:mi>d</mml:mi>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mi>h</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>w</mml:mi>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mi>h</mml:mi>
                            <mml:mo stretchy="false">]</mml:mo>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mstyle>
                    <mml:mo>+</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>d</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mi>h</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>w</mml:mi>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mi>h</mml:mi>
                            <mml:mo stretchy="false">]</mml:mo>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mtext/>
                    <mml:mtext> </mml:mtext>
                    <mml:mtext> </mml:mtext>
                    <mml:mo>=</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mi>f</mml:mi>
                    <mml:mi>x</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:msub>
                      <mml:mi>c</mml:mi>
                      <mml:mi>d</mml:mi>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>+</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mi>d</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mi>h</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>w</mml:mi>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mi>h</mml:mi>
                            <mml:mo stretchy="false">]</mml:mo>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabdohaZjabdogaJnaabmGabaGaem4DaCNaeiilaWIaemyta0eacaGLOaGaayzkaaGaeyypa0ZaaabCaeaacqWGnbqtdaqadiqaaiabdIgaOjabcYcaSiabdEha3jabcUfaBjabdIgaOjabc2faDbGaayjkaiaawMcaaaWcbaGaemiAaGMaeyypa0JaeGimaadabaGaemyBa0MaeyOeI0IaeGymaedaniabggHiLdGccqGH9aqpdaaeWbqaaiabd2eannaabmGabaGaemiAaGMaeiilaWIaem4DaCNaei4waSLaemiAaGMaeiyxa0facaGLOaGaayzkaaaaleaacqWGObaAcqGH9aqpcqaIWaamaeaacqWGKbaza0GaeyyeIuoakiabgUcaRmaaqahabaGaemyta00aaeWaceaacqWGObaAcqGGSaalcqWG3bWDcqGGBbWwcqWGObaAcqGGDbqxaiaawIcacaGLPaaaaSqaaiabdIgaOjabg2da9iabdsgaKjabgUcaRiabigdaXaqaaiabd2gaTjabgkHiTiabigdaXaqdcqGHris5aaGcbaGaaCzcaiaaykW7caaMc8Uaeyypa0JaemiCaaNaemOzayMaemiEaGNaem4CamNaem4yam2aaSbaaSqaaiabdsgaKbqabaGcdaqadiqaaiabdEha3jabcYcaSiabd2eanbGaayjkaiaawMcaaiabgUcaRmaaqahabaGaemyta00aaeWaceaacqWGObaAcqGGSaalcqWG3bWDcqGGBbWwcqWGObaAcqGGDbqxaiaawIcacaGLPaaaaSqaaiabdIgaOjabg2da9iabdsgaKjabgUcaRiabigdaXaqaaiabd2gaTjabgkHiTiabigdaXaqdcqGHris5aaaaaa@9936@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>Hence <italic>sc</italic>(<italic>w</italic>, <italic>M</italic>) ≥ <italic>th </italic>implies <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-7-389-i11" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>p</mml:mi><mml:mi>f</mml:mi><mml:mi>x</mml:mi><mml:mi>s</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>≥</mml:mo><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGWbaCcqWGMbGzcqWG4baEcqWGZbWCcqWGJbWydaWgaaWcbaGaemizaqgabeaakmaabmGabaGaem4DaCNaeiilaWIaemyta0eacaGLOaGaayzkaaGaey4kaSYaaabmaeaacqWGnbqtdaqadiqaaiabdIgaOjabcYcaSiabdEha3jabcUfaBjabdIgaOjabc2faDbGaayjkaiaawMcaaaWcbaGaemiAaGMaeyypa0JaemizaqMaey4kaSIaeGymaedabaGaemyBa0MaeyOeI0IaeGymaedaniabggHiLdGccqGHLjYScqWG0baDcqWGObaAaaa@54A4@</mml:annotation></mml:semantics></mml:math></inline-formula>. Since <italic>M</italic>(<italic>h</italic>, <italic>w</italic>[<italic>h</italic>]) ≤ <italic>max</italic><sub><italic>h </italic></sub>for <italic>h </italic>∈ [0, <italic>m </italic>- 1], we conclude</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-7-389-i12" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>h</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mi>d</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>h</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>w</mml:mi>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mi>h</mml:mi>
                        <mml:mo stretchy="false">]</mml:mo>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mtext> </mml:mtext>
                <mml:mtext> </mml:mtext>
                <mml:mo>≤</mml:mo>
                <mml:mtext> </mml:mtext>
                <mml:mtext> </mml:mtext>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>h</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mi>d</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mi>h</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mi>σ</mml:mi>
                  <mml:mi>d</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaaeWbqaaiabd2eannaabmGabaGaemiAaGMaeiilaWIaem4DaCNaei4waSLaemiAaGMaeiyxa0facaGLOaGaayzkaaaaleaacqWGObaAcqGH9aqpcqWGKbazcqGHRaWkcqaIXaqmaeaacqWGTbqBcqGHsislcqaIXaqma0GaeyyeIuoakiaaykW7caaMc8UaeyizImQaaGPaVlaaykW7daaeWbqaaGqaciab=1gaTjab=fgaHjab=Hha4naaBaaaleaacqWGObaAaeqaaaqaaiabdIgaOjabg2da9iabdsgaKjabgUcaRiabigdaXaqaaiabd2gaTjabgkHiTiabigdaXaqdcqGHris5aOGaeyypa0dcciGae43Wdm3aaSbaaSqaaiabdsgaKbqabaaaaa@5ECC@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>and hence</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-7-389-i13" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mi>p</mml:mi>
                <mml:mi>f</mml:mi>
                <mml:mi>x</mml:mi>
                <mml:mi>s</mml:mi>
                <mml:msub>
                  <mml:mi>c</mml:mi>
                  <mml:mi>d</mml:mi>
                </mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>≥</mml:mo>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>h</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mi>d</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>m</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>h</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>w</mml:mi>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mi>h</mml:mi>
                        <mml:mo stretchy="false">]</mml:mo>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>≥</mml:mo>
                <mml:mi>t</mml:mi>
                <mml:mi>h</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:msub>
                  <mml:mi>σ</mml:mi>
                  <mml:mi>d</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mi>t</mml:mi>
                <mml:msub>
                  <mml:mi>h</mml:mi>
                  <mml:mi>d</mml:mi>
                </mml:msub>
                <mml:mo>.</mml:mo>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGWbaCcqWGMbGzcqWG4baEcqWGZbWCcqWGJbWydaWgaaWcbaGaemizaqgabeaakmaabmGabaGaem4DaCNaeiilaWIaemyta0eacaGLOaGaayzkaaGaeyyzImRaemiDaqNaemiAaGMaeyOeI0YaaabCaeaacqWGnbqtdaqadiqaaiabdIgaOjabcYcaSiabdEha3jabcUfaBjabdIgaOjabc2faDbGaayjkaiaawMcaaaWcbaGaemiAaGMaeyypa0JaemizaqMaey4kaSIaeGymaedabaGaemyBa0MaeyOeI0IaeGymaedaniabggHiLdGccqGHLjYScqWG0baDcqWGObaAcqGHsisliiGacqWFdpWCdaWgaaWcbaGaemizaqgabeaakiabg2da9iabdsha0jabdIgaOnaaBaaaleaacqWGKbazaeqaaOGaeiOla4caaa@63F8@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>The Lemma suggests a necessary condition for a PSSM-match which can easily be exploited: When computing <italic>sc</italic>(<italic>w</italic>, <italic>M</italic>) by scanning <italic>w </italic>from left to right, one checks for <italic>d </italic>= 0,1,..., <italic>m </italic>- 1, if the intermediate threshold <italic>th</italic><sub><italic>d </italic></sub>is achieved. If not, the computation can be stopped. See Figure <xref ref-type="fig" rid="F1">1</xref> for an example of intermediate thresholds and their implications.</p>
      <p>The lookahead scoring algorithm (herein after called <italic>LAsearch</italic>) runs in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>kn</italic>) time, where <italic>k </italic>is the average number of PSSM-positions per sequence position actually evaluated. In the worst case, <italic>k </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>m</italic>), which leads to the worst case running time of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>mn</italic>), not better than the simple algorithm. However, <italic>k </italic>is expected to be much smaller than <italic>m</italic>, leading to considerable speedups in practice.</p>
      <p>Our reformulation of lookahead scoring and its implementation is the basis for improvements and evaluation in the subsequent sections.</p>
    </sec>
    <sec>
      <title>PSSM searching using enhanced suffix arrays: ESAsearch</title>
      <p>The enhanced suffix array for a given sequence <italic>S </italic>of length <italic>n </italic>consists of three tables suf, lcp, and skp. Let $ be a symbol in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>, larger than all other symbols, which does not occur in <italic>S</italic>. suf is a table of integers in the range 0 to <italic>n</italic>, specifying the lexicographic ordering of the <italic>n </italic>+ 1 suffixes of the string <italic>S</italic>$. That is, <italic>S</italic><sub>suf[0]</sub>, <italic>S</italic><sub>suf[1]</sub>, ... ,<italic>S</italic><sub><italic>suf</italic>[<italic>n</italic>] </sub>is the sequence of suffixes of <italic>S</italic>$ in ascending lexicographic order, where <italic>S</italic><sub><italic>i </italic></sub>= <italic>S</italic>[<italic>i..n </italic>- 1]$ denotes the <italic>i</italic>-th nonempty suffix of the string <italic>S</italic>$, for <italic>i </italic>∈ [0, <italic>n</italic>]. See Figure <xref ref-type="fig" rid="F2">2</xref> for an example. suf can be constructed in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n</italic>) time [<xref ref-type="bibr" rid="B26">26</xref>] and requires 4<italic>n </italic>bytes.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Relationship between enhanced suffix array and suffix tree</bold>. The enhanced suffix array consisting of tables suf, lcp, skp (left) and the suffix tree (right) for sequence <italic>S </italic>= caaaaccacac. Some skp entries are shown in the tree as red arrows: If skp[<italic>i</italic>] = <italic>j</italic>, then an arrow points from row <italic>i </italic>to row <italic>j</italic>. For clarity, suffixes corresponding to suf[<italic>i</italic>] are given in table <italic>S</italic><sub>suf[<italic>i</italic>]</sub>.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-389-2"/>
      </fig>
      <p>lcp is a table in the range 0 to <italic>n </italic>such that lcp[0] := 0 and lcp[<italic>i</italic>] is the length of the longest common prefix of <italic>S</italic><sub>suf[<italic>i </italic>- 1] </sub>and <italic>S</italic><sub>suf[<italic>i</italic>]</sub>, for <italic>i </italic>∈ [1, <italic>n</italic>]. See Figure <xref ref-type="fig" rid="F2">2</xref> for an example. Table lcp can be computed in linear time given table suf [<xref ref-type="bibr" rid="B27">27</xref>]. In practice PSSMs are used to model relatively short, local motifs and hence do not exceed length 255. For searching with PSSMs we therefore do not access values in table lcp larger than 255, and hence we can store lcp in <italic>n </italic>bytes.</p>
      <p>skp is a table in the range 0 to <italic>n </italic>such that skp[<italic>i</italic>] := min({<italic>n </italic>+ 1} ∪ {<italic>j </italic>∈ [<italic>i </italic>+ 1, <italic>n</italic>] | lcp[<italic>i</italic>] &gt; lcp[<italic>j</italic>]}). In terms of suffix trees, skp[<italic>i</italic>] denotes the lexicographically next leaf that does not occur in the subtree below the branching node corresponding to the longest common prefix of <italic>S</italic><sub>suf[<italic>i </italic>- 1] </sub>and <italic>S</italic><sub>suf[<italic>i</italic>]</sub>. Figure <xref ref-type="fig" rid="F2">2</xref> shows this relation. Table skp can be computed in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n</italic>) time given suf and lcp. For the algorithm to be described we assume that the enhanced suffix array for <italic>S </italic>has been precomputed.</p>
      <p>In a suffix tree, all substrings of <italic>S </italic>of a fixed length <italic>m </italic>can be scored with a PSSM by a depth first traversal of the tree. Using lookahead scoring, one can skip certain subtrees that do not contain matches to the PSSM. Since suffix trees have several disadvantages (see the introduction), we use enhanced suffix arrays to search PSSMs. Like in other algorithms on enhanced suffix arrays (cf. [<xref ref-type="bibr" rid="B18">18</xref>]), one simulates a depth first traversal of the suffix tree by processing the arrays suf and lcp from left to right. To incorporate lookahead scoring while searching we must be able to skip certain ranges of suffixes in suf. To facilitate this, we use table skp. We will now make this more precise.</p>
      <p>For <italic>i </italic>∈ [0, <italic>n</italic>], let <italic>v</italic><sub><italic>i </italic></sub>= <italic>S</italic><sub>suf[<italic>i</italic>]</sub>, <italic>l</italic><sub><italic>i </italic></sub>= min{<italic>m</italic>, |<italic>v</italic><sub><italic>i</italic></sub>|} - 1, and <italic>d</italic><sub><italic>i </italic></sub>= max({-1} ∪ {<italic>d </italic>∈ [0, <italic>l</italic><sub><italic>i</italic></sub>] |<italic>pfxsc</italic><sub><italic>d </italic></sub>(<italic>v</italic><sub><italic>i</italic></sub>, <italic>M</italic>) ≥ <italic>th</italic><sub><italic>d</italic></sub>}). Now observe that <italic>d</italic><sub><italic>i </italic></sub>= <italic>m </italic>- 1 ⇔ <italic>pfxsc</italic><sub><italic>m</italic>-1 </sub>(<italic>v</italic><sub><italic>i</italic></sub>, <italic>M</italic>) ≥ <italic>th</italic><sub><italic>m</italic>-1 </sub>⇔ <italic>sc </italic>(<italic>v</italic><sub><italic>i</italic></sub>, <italic>M</italic>) ≥ <italic>th</italic>. Hence, <italic>M </italic>matches at position <italic>j </italic>= suf[<italic>i</italic>] if and only if <italic>d</italic><sub><italic>i </italic></sub>= <italic>m </italic>- 1. Thus, to solve the PSSM searching problem, it suffices to compute all <italic>i </italic>∈ [0, <italic>n</italic>] satisfying <italic>d</italic><sub><italic>i </italic></sub>= <italic>m </italic>- 1. We compute <italic>d</italic><sub><italic>i </italic></sub>along with <italic>C</italic><sub><italic>i</italic></sub>[<italic>d</italic>] = <italic>pfxsc</italic><sub><italic>d </italic></sub>(<italic>v</italic><sub><italic>i</italic></sub>, <italic>M</italic>) for any <italic>d </italic>∈ [0, <italic>d</italic><sub><italic>i</italic></sub>]. <italic>d</italic><sub>0 </sub>and <italic>C</italic><sub>0 </sub>are easily determined in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>m</italic>) time. Now let <italic>i </italic>∈ [1, <italic>n</italic>] and suppose that <italic>d</italic><sub><italic>i</italic>-1 </sub>and <italic>C</italic><sub><italic>i</italic>-1</sub>[<italic>d</italic>] are determined for <italic>d </italic>∈ [0,<italic>d</italic><sub><italic>i</italic>-1</sub>]. Since <italic>v</italic><sub><italic>i</italic>-1 </sub>and <italic>v</italic><sub><italic>i </italic></sub>have a common prefix of length lcp[<italic>i</italic>], we have <italic>C</italic><sub><italic>i</italic></sub>[<italic>d</italic>] = <italic>C</italic><sub><italic>i</italic>-1</sub>[<italic>d</italic>] for all <italic>d </italic>∈ [0, lcp[<italic>i</italic>] - 1]. Consider the following cases:</p>
      <p>• If <italic>d</italic><sub><italic>i</italic>-1 </sub>+ 1 ≥ lcp[<italic>i</italic>], then compute <italic>C</italic><sub><italic>i</italic></sub>[<italic>d</italic>] for <italic>d </italic>≥ lcp[<italic>i</italic>] while <italic>d </italic>≤ <italic>l</italic><sub><italic>i </italic></sub>and <italic>C</italic><sub><italic>i</italic></sub>[<italic>d</italic>] ≥ <italic>th</italic><sub><italic>d</italic></sub>. We obtain <italic>d</italic><sub><italic>i </italic></sub>= <italic>d</italic>.</p>
      <p>• If <italic>d</italic><sub><italic>i</italic>-1 </sub>+ 1 &lt; lcp[<italic>i</italic>], then let <italic>j </italic>be the minimum value in the range [<italic>i </italic>+ 1, <italic>n </italic>+ 1] such that all suffixes <italic>v</italic><sub><italic>i</italic></sub>, <italic>v</italic><sub><italic>i</italic>+1</sub>,...,<italic>v</italic><sub><italic>j</italic>-1 </sub>have a common prefix of length <italic>d</italic><sub><italic>i</italic>-1</sub>+ 1 with <italic>v</italic><sub><italic>i</italic>-1</sub>. Due to the common prefix we have <italic>pfxsc</italic><sub><italic>d</italic></sub>(<italic>v</italic><sub><italic>i</italic>-1</sub>, <italic>M</italic>) = <italic>pfxsc</italic><sub><italic>d</italic></sub>(<italic>v</italic><sub><italic>r</italic></sub>, <italic>M</italic>) for all <italic>d </italic>∈ [0, <italic>d</italic><sub><italic>i</italic>-1 </sub>+ 1] and r ∈ [<italic>i</italic>, <italic>j </italic>- 1]. Hence <italic>d</italic><sub><italic>i</italic>-1 </sub>= <italic>d</italic><sub><italic>r </italic></sub>for r ∈ [<italic>i</italic>, <italic>j </italic>- 1]. If <italic>d</italic><sub><italic>i</italic>-1 </sub>= <italic>m </italic>- 1, then there are PSSM matches at all positions suf[<italic>r</italic>] for <italic>r </italic>∈ [<italic>i</italic>, <italic>j </italic>- 1]. If <italic>d</italic><sub><italic>i</italic>-1 </sub>&lt;<italic>m </italic>- 1, then there are no PSSM matches at any of these positions. That is, we can directly proceed with index <italic>j</italic>. We obtain <italic>j </italic>by following a chain of entries in table skp: compute a sequence of values <italic>j</italic><sub>0 </sub>= <italic>i</italic>, <italic>j</italic><sub>1 </sub>= skp[<italic>j</italic><sub>0</sub>],...,<italic>j</italic><sub><italic>k </italic></sub>= skp[<italic>j</italic><sub><italic>k</italic>-1</sub>] such that <italic>d</italic><sub><italic>i</italic>-1 </sub>+ 1 &lt; lcp[<italic>j</italic><sub>1</sub>],...,<italic>d</italic><sub><italic>i</italic>-1 </sub>+ 1 &lt; lcp[<italic>j</italic><sub><italic>k</italic>-1</sub>], and <italic>d</italic><sub><italic>i</italic>-1 </sub>+ 1 ≥ lcp[<italic>j</italic><sub><italic>k</italic></sub>]. Then <italic>j </italic>= <italic>j</italic><sub><italic>k</italic></sub>.</p>
      <p>These case distinctions lead to the program <italic>ESAsearch </italic>(see Figures <xref ref-type="fig" rid="F3">3</xref>, <xref ref-type="fig" rid="F4">4</xref>).</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>Algorithm ESAsearch</bold>. The algorithm <italic>ESAsearch </italic>formulated in pseudocode. See text for detailed explanations of the used notions.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-389-3"/>
      </fig>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Function skipchain of the ESAsearch algorithm</bold>. Function skipchain computes a chain of entries in table skp to skip certain ranges of suffixes in table suf.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-389-4"/>
      </fig>
      <p>We illustrate the ideas of algorithm <italic>ESAsearch</italic>, formally described above, with the following example. Let <italic>M </italic>be a PSSM of length <italic>m </italic>= 2 over alphabet <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> = {<italic>a, c</italic>} with <italic>M</italic>(0, <italic>a</italic>) = 1, <italic>M</italic>(0, <italic>c</italic>) = 3, <italic>M</italic>(1, <italic>a</italic>) = 3, and <italic>M</italic>(1, <italic>c</italic>) = 2. For a given threshold of <italic>th </italic>= 6 we obtain intermediate thresholds <italic>th</italic><sub>0 </sub>= 3 and <italic>th</italic><sub>1 </sub>= 6. To search with <italic>M </italic>in the enhanced suffix array for sequence <italic>S </italic>= caaaaccacac as given in Figure <xref ref-type="fig" rid="F2">2</xref>, we start processing the enhanced suffix array suf top down by scoring the first suffix <italic>S</italic><sub>suf[0] </sub>= aaaaccacac$ with <italic>M </italic>from left to right. For the first character of <italic>S</italic><sub>suf[0] </sub>we obtain a score of <italic>pfxsc</italic><sub>0</sub>(<italic>S</italic><sub>suf[0]</sub>,<italic>M</italic>)= <italic>M</italic>(0, <italic>a</italic>) = 1 which is below the first intermediate threshold <italic>th</italic><sub>0</sub>= 3. Hence we set <italic>d</italic><sub>0 </sub>= -1 and notice that we can skip all suffixes of <italic>S </italic>that start with character 'a'. Further on, with a lookup in lcp[1] = 3 we find that <italic>S</italic><sub>suf[1] </sub>and <italic>S</italic><sub>suf[0] </sub>share a common prefix of length 3 and <italic>d</italic><sub>0 </sub>+ 1 = -1 + 1 &lt; lcp[1] = 3 (second case described above). The next suffix that may match <italic>M </italic>with <italic>th </italic>= 6 is <italic>S</italic><sub>suf[6] </sub>= caaaaccacac$. Suffixes <italic>S</italic><sub>suf[1]</sub>, <italic>S</italic><sub>suf[2]</sub>,... <italic>S</italic><sub>suf[5] </sub>can be skipped since they all share a common prefix with <italic>S</italic><sub>suf[0] </sub>of at least length 1. That is, they begin all with character 'a' and would also miss the first intermediate threshold <italic>th</italic><sub>0 </sub>= 3 when scored. We find <italic>S</italic><sub>suf[6] </sub>by following a chain of entries in table skp: skp[1] = 2, skp[2] = 3, and skp[3] = 6. When scoring <italic>S</italic><sub>suf[6] </sub>we compute <italic>pfxsc</italic><sub>0</sub>(<italic>S</italic><sub>suf[6]</sub>, <italic>M</italic>) = <italic>M</italic>(0,<italic>c</italic>) = 3 and <italic>pfxsc</italic><sub>1</sub>(<italic>S</italic><sub>suf[6]</sub>, <italic>M</italic>) = <italic>M</italic>(0, <italic>c</italic>) + <italic>M</italic>(1, <italic>a</italic>) = 6 and store them for reuse in <italic>C</italic>[0] and <italic>C</italic>[1]. Since <italic>d</italic><sub>6 </sub>= 1 = <italic>m </italic>- 1 = 1 holds, we report suf[6] = 0 with score <italic>sc </italic>(<italic>S</italic><sub>suf[6]</sub>, <italic>M</italic>) = <italic>pfxsc</italic><sub>1</sub>(<italic>S</italic><sub>suf[6]</sub>,<italic>M</italic>) = 6 as a matching position. With lookups in lcp[7] = 2 and lcp[8] = 3 we notice that <italic>S</italic><sub>suf[7] </sub>and <italic>S</italic><sub>suf[8] </sub>share a common prefix of at least two characters with <italic>S</italic><sub>suf[6]</sub>. Hence we report suf[7] = 6 and suf[8] = 8 with score <italic>C</italic>[1] = 6 as further matching positions. We proceed with the scoring of <italic>S</italic><sub>suf[9]</sub>. Since lcp[9] = 1 holds, we obtain the score for the first character 'c' from array <italic>C </italic>with <italic>pfxsc</italic><sub>0</sub>(<italic>S</italic><sub>suf[9]</sub>, <italic>M</italic>) = <italic>C</italic>[0]. After scoring the second character of <italic>S</italic><sub>suf[9]</sub>, <italic>pfxsc</italic><sub>1</sub>(<italic>S</italic><sub>suf[9]</sub>, <italic>M</italic>) = 5 &lt;<italic>th</italic><sub>1 </sub>= 6 holds and we miss the second intermediate threshold and continue with the next suffix. The last two suffixes <italic>S</italic><sub>suf[10] </sub>and <italic>S</italic><sub>suf[11] </sub>in suf do not have to be considered since their lengths are smaller than to <italic>m </italic>= 2 (not counting the sentinel character $) and therefore they cannot match <italic>M</italic>. We end up with matching positions 0, 6, and 8 of <italic>M </italic>in <italic>S </italic>with match score 6. To find these matches, we processed the enhanced suffix array suf top down and scored suffixes from left to right, facilitating the additional information given in tables lcp and skp to avoid rescoring of characters of common prefixes of suffixes and to skip suffixes that cannot match <italic>M </italic>for the given threshold.</p>
      <sec>
        <title>Analysis</title>
        <p>The <italic>C</italic><sub><italic>i </italic></sub>arrays can be stored in a single <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>m</italic>) space array <italic>C </italic>as any step <italic>i </italic>only needs the <italic>C</italic><sub><italic>i </italic></sub>specific to that step. <italic>C</italic><sub><italic>i </italic></sub>solely depends on <italic>C</italic><sub><italic>i</italic>-1</sub>, and <italic>C</italic><sub><italic>i</italic></sub>[0..<italic>d </italic>- 1] = <italic>C</italic><sub><italic>i</italic>-1</sub>[0..<italic>d </italic>- 1] holds for a certain <italic>d</italic>&lt;<italic>m</italic>, i.e., the first <italic>d </italic>entries in <italic>C</italic><sub><italic>i </italic></sub>are known from the previous step, and thus <italic>C </italic>can be organized as a stack. No other space (apart from the space for the enhanced suffix array) depending on input size is required for <italic>ESAsearch</italic>, leading to an <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>m</italic>) space complexity.</p>
        <p>The worst case for <italic>ESAsearch </italic>occurs, if <italic>th </italic>≤ <italic>sc</italic><sub>min</sub>(<italic>M</italic>) (<italic>M </italic>matches at each position in <italic>S</italic>), and no suffix of <italic>S </italic>shares a common prefix with any other suffix. In this case lookahead scoring does not give any speedup and every suffix must be read up to depth to <italic>m</italic>, leading to an <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>nm</italic>) worst case time complexity. This is not worse but also not better than the complexity for <italic>LAsearch</italic>. Next we show that, <italic>independent </italic>of the chosen threshold <italic>th</italic>, the overall worst case running time boundary for <italic>ESAsearch </italic>drops to <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n </italic>+ <italic>m</italic>) under the assumption that</p>
        <p><italic>n </italic>≥ |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>m </italic></sup>+ <italic>m </italic>- 1     (1)</p>
        <p>holds.</p>
        <p>The shorter the common prefixes of the neighboring suffixes, the slower <italic>ESAsearch </italic>runs. Thus to analyze the worst case, we have to consider sequences containing as many different substrings of some length <italic>q </italic>as possible. Observe that a sequence can contain at most |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>q </italic></sup>different substrings of length <italic>q </italic>&gt; 0, independent of its length. To analyze the behavior of <italic>ESAsearch </italic>on such a sequence, we introduce the concept of suffix-intervals on enhanced suffix arrays, similar to lcp-intervals as used in [<xref ref-type="bibr" rid="B18">18</xref>].</p>
        <p><bold>Definition 1 </bold>An interval [<italic>i</italic>, <italic>j</italic>], 0 ≤ <italic>i </italic>≤ <italic>j </italic>≤ <italic>n</italic>, is a <italic>suffix-interval </italic>with offset ℓ ∈ {0,..., <italic>n</italic>}, or ℓ-<italic>suffix-interval</italic>, denoted ℓ-[<italic>i</italic>, <italic>j</italic>], if the following three conditions hold:</p>
        <p>1. lcp[<italic>i</italic>] &lt; ℓ</p>
        <p>2. lcp[<italic>j </italic>+ 1] &lt; ℓ</p>
        <p>3. lcp[<italic>k</italic>] ≥ ℓ for all <italic>k </italic>∈ {<italic>x </italic>| <italic>i </italic>+ 1 ≤ <italic>x </italic>≤ <italic>j</italic>}</p>
        <p>An <italic>lcp-interval</italic>, or ℓ-interval, with lcp-value ℓ ∈ {0,..., <italic>n</italic>} is a suffix-interval ℓ - [<italic>i</italic>, <italic>j</italic>] with <italic>i </italic>&lt;<italic>j </italic>and lcp[<italic>k</italic>] = ℓ for at least one <italic>k </italic>∈ {<italic>i </italic>+ 1,..., <italic>j</italic>}.</p>
        <p>Every lcp-interval ℓ - [<italic>i</italic>, <italic>j</italic>] of an enhanced suffix array for text <italic>S </italic>corresponds to an internal node <italic>v </italic>in a suffix tree for <italic>S</italic>, and the length of the string spelled out by the edge labels on the path from the root node to <italic>v </italic>is equal to ℓ. Leaves are represented as singleton intervals, ℓ - [<italic>i</italic>, <italic>j</italic>] with <italic>i </italic>= <italic>j</italic>. We say that suffix-interval ℓ - [<italic>i</italic>, <italic>j</italic>] embeds suffix-interval ℓ<sup>+ </sup>- [<italic>k</italic>, <italic>l</italic>], if and only if ℓ<sup>+ </sup>&gt; ℓ, <italic>i </italic>≤ <italic>k </italic>&lt;<italic>l </italic>≤ <italic>j</italic>, and if there is no suffix-interval ℓ' - [<italic>r</italic>, <italic>s</italic>] with ℓ &lt; ℓ' &lt; ℓ<sup>+ </sup>and <italic>i </italic>≤ <italic>r </italic>≤ <italic>k </italic>&lt;<italic>l </italic>≤ <italic>s </italic>≤ <italic>j</italic>. As an example for ℓ-suffix-intervals, consider the enhanced suffix array given in Figure <xref ref-type="fig" rid="F2">2</xref>. [0, 5] is a 1-suffix-interval, because lcp[0] = 0 &lt; 1, lcp[5 + 1] = 0 &lt; 1, and lcp[<italic>k</italic>] ≥ 1, for all <italic>k</italic>, 1 ≤ <italic>k </italic>≤ 5. Suffix-interval 2-[3,5] is embedded in 1-[0,5], but 3-[0,1] is not. Consider an enhanced suffix array of a sequence which contains all possible substrings of length <italic>q</italic>. There are |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>| 1-suffix-intervals, |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup>2 </sup>2-suffix-intervals, and so on. Consequently, up to depth <italic>q</italic>, there are a total of</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" name="1471-2105-7-389-i14" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>E</mml:mi>
                    <mml:mi>q</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>q</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>|</mml:mo>
                            <mml:mi mathvariant="script">A</mml:mi>
                            <mml:mo>|</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo>|</mml:mo>
                            <mml:mi mathvariant="script">A</mml:mi>
                            <mml:mo>|</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>q</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>−</mml:mo>
                      <mml:mrow>
                        <mml:mo>|</mml:mo>
                        <mml:mi mathvariant="script">A</mml:mi>
                        <mml:mo>|</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>|</mml:mo>
                        <mml:mi mathvariant="script">A</mml:mi>
                        <mml:mo>|</mml:mo>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGfbqrdaWgaaWcbaGaemyCaehabeaakiabg2da9maaqahabaWaaqWaaeaaimaacqWFaeFqaiaawEa7caGLiWoadaahaaWcbeqaaiabdMgaPbaaaeaacqWGPbqAcqGH9aqpcqaIXaqmaeaacqWGXbqCa0GaeyyeIuoakiabg2da9maalaaabaWaaqWaaeaacqWFaeFqaiaawEa7caGLiWoadaahaaWcbeqaaiabdghaXjabgUcaRiabigdaXaaakiabgkHiTmaaemaabaGae8haXheacaGLhWUaayjcSdaabaWaaqWaaeaacqWFaeFqaiaawEa7caGLiWoacqGHsislcqaIXaqmaaGaaCzcaiaaxMaadaqadaqaaiabikdaYaGaayjkaiaawMcaaaaa@6120@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>ℓ-suffix-intervals (1 ≤ ℓ ≤ <italic>q</italic>). This corresponds to the number of internal nodes and leaves in a suffix tree, which is atomic up to at least depth <italic>q </italic>under our assumptions.</p>
        <p>Since we are considering sequences that contain all possible substrings of length <italic>q</italic>, there are |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>d</italic></sup><italic>d</italic>-suffix-intervals at any depth <italic>d</italic>, 1 ≤ <italic>d </italic>≤ <italic>q</italic>. Let <italic>d</italic>-[<italic>i</italic>, <italic>j</italic>] be a <italic>d</italic>-suffix-interval. We know that <italic>pfxsc</italic><sub><italic>d </italic></sub>(<italic>v</italic><sub><italic>i</italic></sub>, <italic>M</italic>) is a partial sum of <italic>pfxsc</italic><sub><italic>q </italic></sub>(<italic>v</italic><sub><italic>i</italic></sub>, <italic>M</italic>), and because <italic>v</italic><sub><italic>i</italic></sub>[0.. <italic>d </italic>- 1] = <italic>v</italic><sub><italic>i </italic>+ 1 </sub>[0..<italic>d </italic>- 1] = ... = <italic>v</italic><sub><italic>j </italic></sub>[0.. <italic>d </italic>- 1], <italic>pfxsc</italic><sub><italic>d</italic></sub>(<italic>v</italic><sub><italic>i</italic></sub>, <italic>M</italic>) is also a partial sum of <italic>pfxsc</italic><sub><italic>q </italic></sub>(<italic>v</italic><sub><italic>k</italic></sub>, <italic>M</italic>) for <italic>i </italic>≤ <italic>k </italic>≤ <italic>j</italic>. That is, after <italic>ESAsearch </italic>has calculated <italic>pfxsc</italic><sub><italic>d</italic></sub>(<italic>v</italic><sub><italic>i</italic></sub>, <italic>M</italic>) at depth <italic>d</italic>, at any suffix-interval (<italic>d </italic>+ 1) - [<italic>r</italic>, <italic>s</italic>] embedded in <italic>d</italic>-[<italic>i</italic>, <italic>j</italic>] it suffices to only calculate the "rest" of <italic>pfxsc</italic><sub><italic>q </italic></sub>(<italic>v</italic><sub><italic>k</italic></sub>, <italic>M</italic>). At any depth <italic>d</italic>, the algorithm calculates <italic>pfxsc</italic><sub><italic>d</italic>+1 </sub>(<italic>v</italic><sub><italic>r</italic></sub>, <italic>M</italic>) = <italic>pfxsc</italic><sub><italic>d </italic></sub>(<italic>v</italic><sub><italic>i</italic></sub>, <italic>M</italic>) + <italic>M</italic>(<italic>d</italic>, <italic>v</italic><sub><italic>r</italic></sub>[<italic>d</italic>]), meaning that all prefix scores at depth <italic>d </italic>+ 1 in a <italic>d</italic>-suffix-interval can be computed from the prefix scores at depth <italic>d </italic>by |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>| matrix look-ups and additions as there are |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>| embedded (<italic>d </italic>+ 1)-suffix-intervals. There are |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M42" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>d</italic></sup><italic> d</italic>-suffix-intervals at depth <italic>d</italic>. Hence, it takes <italic>ESAsearch </italic>a total of |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M43" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>d</italic></sup>·|<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M44" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>| matrix look-ups and additions to advance from depth <italic>d </italic>to <italic>d </italic>+ 1, and thus we conclude that the algorithm requires a total of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M45" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>E</italic><sub><italic>q</italic></sub>) operations to compute all scores for all substrings of length <italic>q</italic>.</p>
        <p>Suppose that <italic>ESAsearch </italic>has read suffix <italic>v</italic><sub><italic>i </italic></sub>in some step up to depth <italic>q </italic>- 1 such that character <italic>v</italic><sub><italic>i</italic></sub>[<italic>q </italic>- 1] is the last one read. If lcp[<italic>i </italic>+ 1] ≥ <italic>q </italic>holds, then the algorithm has found a suffix-interval <italic>q</italic>-[<italic>i</italic>, <italic>j</italic>] with a yet unknown right boundary <italic>j</italic>, otherwise <italic>j </italic>= <italic>i</italic>. <italic>ESAsearch </italic>reports all suf[<italic>k</italic>] with <italic>k </italic>∈ [<italic>i</italic>, <italic>j</italic>] as matching positions by scanning over table lcp starting at position <italic>i </italic>until lcp[<italic>k</italic>] &lt; lcp[<italic>i</italic>] (such that it finds <italic>j </italic>= <italic>k </italic>- 1), and continues with suffix <italic>v</italic><sub><italic>k </italic></sub>at depth lcp[<italic>k</italic>]. Hence processing such a suffix-interval requires one matrix look-up and addition to compute the score, and <italic>j </italic>- <italic>i </italic>+ 1 steps to report all matches and find suffix <italic>v</italic><sub><italic>k</italic></sub>. Since suffix-intervals do not overlap, the total length of all suffix-intervals at depth <italic>q </italic>can be at most <italic>n</italic>, so the total time spent on reporting matches is bounded by <italic>n</italic>.</p>
        <p>There are three cases to consider when determining the time required for calculating the match scores for a PSSM of length <italic>m</italic>. Let <italic>p </italic>: = <italic>m </italic>- <italic>q</italic>.</p>
        <p>1. If <italic>p </italic>= 0 (⇒ <italic>m </italic>= <italic>q</italic>), then the time required to calculate all match scores is in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M46" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>E</italic><sub><italic>q</italic></sub>) as discussed above.</p>
        <p>2. If <italic>p </italic>&lt; 0 (⇒ <italic>m</italic>&lt;<italic>q</italic>), then none of the <italic>m</italic>-suffix-intervals are singletons since we assumed that the sequence under consideration contains all possible substrings of length <italic>q</italic>, i.e., there must be suffixes sharing a common prefix of length <italic>m</italic>, and the time required to calculate all match scores is in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M47" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>E</italic><sub><italic>m</italic></sub>).</p>
        <p>3. If <italic>p </italic>&gt; 0 (⇒ <italic>m </italic>&gt; <italic>q</italic>), then every <italic>m</italic>-suffix-interval can be a singleton, and all prefix scores for the PSSM prefix of length <italic>q </italic>are calculated in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M48" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>E</italic><sub><italic>q</italic></sub>) time. However, the remaining scores for the pending substrings of length <italic>p </italic>must be computed for <italic>every </italic>suffix longer than <italic>q</italic>, taking <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M49" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>np</italic>) additional time, and leading to a total <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M50" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>E</italic><sub><italic>q </italic></sub>+ <italic>np</italic>) worst case time complexity for computing all match scores.</p>
        <p>Note that a text containing |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M51" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>q </italic></sup>different substrings must have a certain length, which must be at least |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M52" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>q</italic></sup>. In fact, a minimum length text that contains all strings of length <italic>q </italic>has length <italic>n </italic>= |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M53" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>q </italic></sup>+ <italic>q </italic>- 1. It represents a <italic>de Bruijn sequence</italic>[<xref ref-type="bibr" rid="B28">28</xref>] without wrap-around, i.e., a <italic>de Bruijn </italic>sequence with its first <italic>q </italic>- 1 characters concatenated to its end. Since a <italic>de Bruijn </italic>sequence without wrap-around represents the minimum length worst case, we infer from Equation (2) that <italic>E</italic><sub><italic>q </italic></sub>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M54" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n</italic>). Hence, if <italic>m </italic>= <italic>q</italic>, then it takes <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M55" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n</italic>) time to calculate all match scores. If <italic>m </italic>&lt;<italic>q</italic>, then <italic>E</italic><sub><italic>m </italic></sub>&lt;<italic>E</italic><sub><italic>q </italic></sub>and thus it takes sublinear time. If <italic>m </italic>&gt; <italic>q</italic>, it takes <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M56" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n </italic>+ <italic>np</italic>) time.</p>
        <p>We summarize the worst case running time of <italic>ESAsearch </italic>for preprocessing a PSSM <italic>M </italic>of length <italic>m</italic>, searching with <italic>M</italic>, and reporting all matches with their match scores, as</p>
        <p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M57" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n </italic>+ <italic>n</italic>·max {0, <italic>p</italic>} + <italic>m</italic>).</p>
        <p>Hence, the worst case running time is <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M58" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n </italic>+ <italic>m</italic>) for <italic>p </italic>≤ 0, implying that this time complexity holds for any PSSM of length <italic>m </italic>and threshold on any text of length <italic>n </italic>≥ |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M59" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>m </italic></sup>+ <italic>m </italic>- 1, as already stated in Inequality (1).</p>
        <p>In practice, large numbers of suffixes can be skipped if the threshold is stringent enough, leading to a total running time <italic>sublinear </italic>in the size of the text, regardless of the relation between <italic>n </italic>and <italic>m</italic>. <italic>ESAsearch </italic>reads a suffix up to depth <italic>m </italic>unless an intermediate score falls short of an intermediate threshold, and skips intervals with the same or greater lcp if this happens. Right boundaries of skipped suffix-intervals are found quickly by following the chain of skip-values (see function skipchain in Figure <xref ref-type="fig" rid="F4">4</xref>). It are these jumps that make <italic>ESAsearch </italic>superior in terms of running time to <italic>LAsearch </italic>in practice. The best case is indeed <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M60" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(|<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M61" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|) which occurs whenever there is no score in the first row of the PSSM that is greater than <italic>th</italic><sub>0</sub>.</p>
        <p>See Figure <xref ref-type="fig" rid="F5">5</xref> for examples of enhanced suffix arrays, constructed from texts <italic>S </italic>and <italic>T </italic>that consist of all strings of a certain length <italic>m </italic>over some alphabet. In these enhanced suffix arrays no suffix shares a prefix of length <italic>m </italic>with any other suffix, forcing <italic>ESAsearch </italic>to compute scores for each suffix. But with the intermediate scores available while processing the suffixes, it takes exactly <italic>E</italic><sub><italic>m </italic></sub>steps to compute the scores, as can be figured out by manually applying <italic>ESAsearch </italic>to the depicted enhanced suffix arrays. For <italic>S</italic>, exactly <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M62" name="1471-2105-7-389-i15" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mn>4</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabisda0maaCaaaleqabaGaeG4mamdaaOGaeyOeI0IaeGinaqdabaGaeGinaqJaeyOeI0IaeGymaedaaiabg2da9iabikdaYiabicdaWaaa@3679@</mml:annotation></mml:semantics></mml:math></inline-formula>, for <italic>T</italic>, exactly <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M63" name="1471-2105-7-389-i16" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>14</mml:mn></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabikdaYmaaCaaaleqabaGaeGinaqdaaOGaeyOeI0IaeGOmaidabaGaeGOmaiJaeyOeI0IaeGymaedaaiabg2da9iabigdaXiabisda0aaa@3675@</mml:annotation></mml:semantics></mml:math></inline-formula> operations are needed to compute <italic>all </italic>|<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M64" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>m </italic></sup>≤ <italic>n </italic>- <italic>m </italic>+ 1 possible scores (and to find all matches since <italic>S </italic>and <italic>T </italic>are both <italic>de Bruijn </italic>sequences without wrap-around). Only a single match is reported per matching substring, leading to <italic>E</italic><sub><italic>m </italic></sub>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M65" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n</italic>) operations to be performed during the search phase.</p>
        <fig position="float" id="F5">
          <label>Figure 5</label>
          <caption>
            <p><bold>Minimum size enhanced suffix arrays for worst case analysis</bold>. Enhanced suffix arrays for text <italic>S </italic>= cagataaccgtcttggc, consisting of all strings of length <italic>m </italic>= 2 over an alphabet of size 4, and <italic>T </italic>= ccaaacaccc, consisting of all strings of length <italic>m </italic>= 3 over an alphabet of size 2.</p>
          </caption>
          <graphic xlink:href="1471-2105-7-389-5"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Performance improvements via alphabet transformations</title>
      <p>Inequality (1) provides the necessary condition for <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M66" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n </italic>+ <italic>m</italic>) worst case running time. We now assume that <italic>m </italic>in Inequality (1) identifies not the length of a PSSM, but the threshold dependent <italic>expected reading depth </italic>for some PSSM. We denote this expected depth by <italic>m</italic>*(<italic>th</italic>) ≤ <italic>m </italic>and continue denoting the PSSM's length by <italic>m</italic>. As seen before, for PSSMs with length <italic>m</italic>, such that <italic>p </italic>= <italic>m </italic>- <italic>m</italic>*(<italic>th</italic>), the worst case running time is <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M67" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n </italic>+ <italic>n</italic>·max {0, <italic>p</italic>} + <italic>m</italic>), but the expected running time is <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M68" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n </italic>+ <italic>m</italic>), as on average we expect <italic>p </italic>≤ 0. Inequality (1) with <italic>m </italic>substituted by <italic>m</italic>*(<italic>th</italic>) implies <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M69" name="1471-2105-7-389-i17" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacyGGSbaBcqGGVbWBcqGGNbWzdaWgaaWcbaWaaqWaaeaaimaacqWFaeFqaiaawEa7caGLiWoaaeqaaaaa@3F8D@</mml:annotation></mml:semantics></mml:math></inline-formula> (<italic>n</italic>) ≥ <italic>m</italic>*(<italic>th</italic>). That is, to achieve linear worst case running time for the amino acid alphabet, <italic>m</italic>*(<italic>th</italic>) needs to be very small. For instance, if <italic>n </italic>= 20<sup>7</sup>, then the search time is guaranteed to be linear in <italic>n </italic>only for PSSMs with a maximum length of 7, and expected to be linear for PSSMs with expected reading depth of 7. Observe that for |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M70" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>| = 4, <italic>m</italic>*(<italic>th</italic>) needs to be smaller or equal to 15 to achieve linear or sublinear running times. This provides the motivation to reduce the alphabet size by transforming <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M71" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> into a reduced size <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M72" name="1471-2105-7-389-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaadaqiaaqaaGWaaiab=bq8bbGaayPadaaaaa@38E3@</mml:annotation></mml:semantics></mml:math></inline-formula> such that |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M73" name="1471-2105-7-389-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaadaqiaaqaaGWaaiab=bq8bbGaayPadaaaaa@38E3@</mml:annotation></mml:semantics></mml:math></inline-formula>| &lt; |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M74" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|.</p>
      <p>In practice, for reasonably chosen thresholds <italic>th</italic>, the performance of <italic>ESAsearch </italic>mainly depends on the fact that often large ranges of suffixes in the enhanced suffix array can be skipped. This is always the case if we drop below an intermediate threshold while calculating a prefix' score, and if that prefix is a common prefix of other suffixes. In terms of lcp-intervals, this means that we can skip all ℓ-intervals with ℓ ≥ <italic>m</italic>*(<italic>th</italic>) on average. In contrast to <italic>suffix-intervals</italic>, whose total count is in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M75" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n</italic><sup>2</sup>), size and number of <italic>lcp-intervals </italic>depend on |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M76" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|, as illustrated in Figure <xref ref-type="fig" rid="F6">6</xref>. We observe that smaller alphabet sizes imply (1) larger ℓ-intervals, and (2) an increasing number of ℓ-intervals for larger values of ℓ. Thus, by using reduced alphabets, we expect to skip larger and touch fewer lcp-intervals under the assumption that the average reading depth remains unchanged. Consequently, we expect to end up with an improved performance of <italic>ESAsearch</italic>. This raises the question for a proper reduction strategy for larger alphabets like the amino acid alphabet, and how this strategy can be incorporated into <italic>ESAsearch</italic>.</p>
      <fig position="float" id="F6">
        <label>Figure 6</label>
        <caption>
          <p><bold>Number of ℓ-intervals for various reduced alphabets</bold>. Numbers of ℓ-intervals for ℓ ∈ [1, 20] of different length for various reduced alphabets. We built the enhanced suffix array with sequences from the RCSB protein data bank (PDB) (total sequence length 4,264,239 bytes). The used reduced amino acid alphabets are given in Figure 8. Note that we limited the interval lengths in the figures to 5,000 to prevent distortion.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-389-6"/>
      </fig>
      <p>We now describe how to take advantage of reduced alphabets as fast filters in the <italic>ESAsearch </italic>algorithm. Let <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M77" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> = {<italic>a</italic><sub>0</sub>, <italic>a</italic><sub>1</sub>,..., <italic>a</italic><sub><italic>k</italic></sub>} and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M78" name="1471-2105-7-389-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaadaqiaaqaaGWaaiab=bq8bbGaayPadaaaaa@38E3@</mml:annotation></mml:semantics></mml:math></inline-formula> = {<italic>b</italic><sub>0</sub>, <italic>b</italic><sub>1</sub>,..., <italic>b</italic><sub><italic>l</italic></sub>} be two alphabets, and Φ : <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M79" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> → <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M80" name="1471-2105-7-389-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaadaqiaaqaaGWaaiab=bq8bbGaayPadaaaaa@38E3@</mml:annotation></mml:semantics></mml:math></inline-formula> a surjective function that maps a character <italic>a </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M81" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> to a character <italic>b </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M82" name="1471-2105-7-389-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaadaqiaaqaaGWaaiab=bq8bbGaayPadaaaaa@38E3@</mml:annotation></mml:semantics></mml:math></inline-formula>. We call Φ<sup>-1</sup>(<italic>b</italic>) the character class corresponding to <italic>b</italic>. For a sequence <italic>S </italic>= <italic>s</italic><sub>1</sub><italic>s</italic><sub>2 </sub>... <italic>s</italic><sub><italic>n </italic></sub>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M83" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula><sup><italic>n </italic></sup>we denote the transformed sequence with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M84" name="1471-2105-7-389-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdofatbGaayPadaaaaa@2E9D@</mml:annotation></mml:semantics></mml:math></inline-formula> = Φ(<italic>s</italic><sub>1</sub>) Φ(<italic>s</italic><sub>2</sub>) ... Φ(<italic>s</italic><sub><italic>n</italic></sub>) ∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M85" name="1471-2105-7-389-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaadaqiaaqaaGWaaiab=bq8bbGaayPadaaaaa@38E3@</mml:annotation></mml:semantics></mml:math></inline-formula><sup><italic>n</italic></sup>. Along with the transformation of the sequence, we transform a PSSM such that we have a one to one relationship between the columns in the PSSM and the characters in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M86" name="1471-2105-7-389-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaadaqiaaqaaGWaaiab=bq8bbGaayPadaaaaa@38E3@</mml:annotation></mml:semantics></mml:math></inline-formula>. We define the transformed PSSM <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M87" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> of <italic>M </italic>as follows:</p>
      <p><bold>Definition 2 </bold>Let <italic>M </italic>be a PSSM of length <italic>m </italic>over alphabet <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M88" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>, and Φ : <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M89" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> → <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M90" name="1471-2105-7-389-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaadaqiaaqaaGWaaiab=bq8bbGaayPadaaaaa@38E3@</mml:annotation></mml:semantics></mml:math></inline-formula> a surjective function. The transformed PSSM <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M91" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> is defined as a function <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M92" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula>: [0, <italic>m </italic>- 1] × <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M93" name="1471-2105-7-389-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaadaqiaaqaaGWaaiab=bq8bbGaayPadaaaaa@38E3@</mml:annotation></mml:semantics></mml:math></inline-formula> → ℝ with</p>
      <p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M94" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> (<italic>i</italic>, <italic>b</italic>): = max {<italic>M</italic>(<italic>i</italic>, <italic>a</italic>) | <italic>a </italic>∈ Φ<sup>-1 </sup>(<italic>b</italic>)}.     (3)</p>
      <p>Figure <xref ref-type="fig" rid="F7">7</xref> gives an example of the relationship between <italic>M </italic>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M95" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula>. <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M96" name="1471-2105-7-389-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdofatbGaayPadaaaaa@2E9D@</mml:annotation></mml:semantics></mml:math></inline-formula> can be easily determined from <italic>S </italic>in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M97" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n</italic>) time, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M98" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M99" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(|<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M100" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<italic>m</italic>) time, given <italic>M</italic>. We define the set of matches to <italic>M </italic>on <italic>S </italic>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M101" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> on <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M102" name="1471-2105-7-389-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdofatbGaayPadaaaaa@2E9D@</mml:annotation></mml:semantics></mml:math></inline-formula>, respectively, as</p>
      <fig position="float" id="F7">
        <label>Figure 7</label>
        <caption>
          <p><bold>PSSM alphabet transformation</bold>. In the left PSSM <italic>M </italic>we used the normal four letter nucleotide alphabet <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M103" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> = {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>T</italic>} to describe a transcription factor binding site found in Hox A3 gene promoters. In the right PSSM <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M104" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> we used a reduced two letter alphabet <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M105" name="1471-2105-7-389-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="script">A</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaadaqiaaqaaGWaaiab=bq8bbGaayPadaaaaa@38E3@</mml:annotation></mml:semantics></mml:math></inline-formula> = {<italic>P</italic>, <italic>Y</italic>} that differs only between purine (adenine or guanine) and pyrimidine (cytosine or thymine) nucleotides. Hence we have two character classes: Φ<sup>-1</sup>(<italic>P</italic>) = {<italic>A</italic>, <italic>G</italic>} and Φ<sup>-1</sup>(<italic>Y</italic>) = {<italic>C</italic>, <italic>T</italic>}. Consequently <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M106" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>i</italic>, <italic>P</italic>) = max{<italic>M</italic>(<italic>i</italic>, <italic>a</italic>) | <italic>a </italic>∈ {<italic>A</italic>, <italic>G</italic>}} and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M107" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>i</italic>, <italic>Y</italic>) = max{<italic>M</italic>(<italic>i</italic>, <italic>a</italic>) | <italic>a </italic>∈ {<italic>C</italic>, <italic>T</italic>}} ∀<italic>i </italic>∈ [0, 8]</p>
        </caption>
        <graphic xlink:href="1471-2105-7-389-7"/>
      </fig>
      <p><italic>MS </italic>:= {<italic>j </italic>∈ [0, <italic>n </italic>- <italic>m</italic>] | <italic>sc </italic>(<italic>S</italic>[<italic>j</italic>..<italic>j </italic>+ <italic>m </italic>- 1], <italic>M</italic>) ≥ <italic>th</italic>}</p>
      <p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M108" name="1471-2105-7-389-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanjabdofatbGaayPadaaaaa@2FC0@</mml:annotation></mml:semantics></mml:math></inline-formula> := {<italic>j </italic>∈ [0, <italic>n </italic>- <italic>m</italic>] | <italic>sc </italic>(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M109" name="1471-2105-7-389-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdofatbGaayPadaaaaa@2E9D@</mml:annotation></mml:semantics></mml:math></inline-formula>[<italic>j</italic>..<italic>j </italic>+ <italic>m </italic>- 1], <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M110" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula>) ≥ <italic>th</italic>}.</p>
      <p>Now observe that we can use matches of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M111" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> on <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M112" name="1471-2105-7-389-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdofatbGaayPadaaaaa@2E9D@</mml:annotation></mml:semantics></mml:math></inline-formula>, for the computation of matches of <italic>M </italic>on <italic>S</italic>, since <italic>MS </italic>⊆ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M113" name="1471-2105-7-389-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanjabdofatbGaayPadaaaaa@2FC0@</mml:annotation></mml:semantics></mml:math></inline-formula>. We prove that <italic>MS </italic>⊆ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M114" name="1471-2105-7-389-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanjabdofatbGaayPadaaaaa@2FC0@</mml:annotation></mml:semantics></mml:math></inline-formula> holds for all <italic>th </italic>∈ [<italic>sc</italic><sub>min </sub>(<italic>M</italic>), <italic>sc</italic><sub>max</sub>(<italic>M</italic>)] by proving the more general statement given in the following Lemma.</p>
      <p><bold>Lemma 2 </bold><italic>sc </italic>(<italic>w</italic>, <italic>M</italic>) ≤ <italic>sc </italic>(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M115" name="1471-2105-7-389-i22" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdEha3bGaayPadaaaaa@2EE5@</mml:annotation></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M116" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula>) holds for all <italic>w </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M117" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula><sup><italic>m</italic></sup>.</p>
      <p><bold>Proof</bold>:</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M118" name="1471-2105-7-389-i23" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mi>s</mml:mi>
                    <mml:mi>c</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>w</mml:mi>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo stretchy="false">]</mml:mo>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                        <mml:mo>≤</mml:mo>
                      </mml:mrow>
                    </mml:mstyle>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mi>max</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mrow>
                          <mml:mo>{</mml:mo>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>a</mml:mi>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>|</mml:mo>
                            <mml:mi>a</mml:mi>
                            <mml:mo>∈</mml:mo>
                            <mml:msup>
                              <mml:mi>Φ</mml:mi>
                              <mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mi>Φ</mml:mi>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:mi>w</mml:mi>
                                    <mml:mo stretchy="false">[</mml:mo>
                                    <mml:mi>i</mml:mi>
                                    <mml:mo stretchy="false">]</mml:mo>
                                  </mml:mrow>
                                  <mml:mo>)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo>}</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mtext>     </mml:mtext>
                    <mml:mo>=</mml:mo>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mi>M</mml:mi>
                          <mml:mo stretchy="true">_</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                    </mml:mstyle>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>Φ</mml:mi>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mi>w</mml:mi>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo stretchy="false">]</mml:mo>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>=</mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mi>c</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mi>w</mml:mi>
                          <mml:mo stretchy="true">_</mml:mo>
                        </mml:mover>
                        <mml:mo>,</mml:mo>
                        <mml:mover accent="true">
                          <mml:mi>M</mml:mi>
                          <mml:mo stretchy="true">_</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mo>.</mml:mo>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqGabeWaaGJcaqodaasdbaGaem4CamNaem4yam2aaeWaceaacqWG3bWDcqGGSaalcqWGnbqtaiaawIcacaGLPaaacqGH9aqpdaaeWbqaaiabd2eannaabmGabaGaemyAaKMaeiilaWIaem4DaCNaei4waSLaemyAaKMaeiyxa0facaGLOaGaayzkaaGaeyizImkaleaacqWGPbqAcqGH9aqpcqaIWaamaeaacqWGTbqBcqGHsislcqaIXaqma0GaeyyeIuoakmaaqahabaGagiyBa0MaeiyyaeMaeiiEaG3aaiWabeaacqWGnbqtdaqadiqaaiabdMgaPjabcYcaSiabdggaHbGaayjkaiaawMcaaiabcYha8jabdggaHHGaaiab=HGiolab=z6agnaaCaaaleqabaGaeyOeI0IaeGymaedaaOWaaeWaceaacqWFMoGrdaqadiqaaiabdEha3jabcUfaBjabdMgaPjabc2faDbGaayjkaiaawMcaaaGaayjkaiaawMcaaaGaay5Eaiaaw2haaaWcbaGaemyAaKMaeyypa0JaeGimaadabaGaemyBa0MaeyOeI0IaeGymaedaniabggHiLdaakeaacaWLjaGaaCzcaiaaxMaacqGH9aqpdaaeWbqaamaaHaaabaGaemyta0eacaGLcmaaaSqaaiabdMgaPjabg2da9iabicdaWaqaaiabd2gaTjabgkHiTiabigdaXaqdcqGHris5aOWaaeWaceaacqWGPbqAcqGGSaalcqWFMoGrdaqadiqaaGqaciab+Dha3jab=TfaBjab+LgaPjab=1faDbGaayjkaiaawMcaaaGaayjkaiaawMcaaiabg2da9iabdohaZjabdogaJnaabmGabaWaaecaaeaacqWG3bWDaiaawkWaaiabcYcaSmaaHaaabaGaemyta0eacaGLcmaaaiaawIcacaGLPaaacqGGUaGlaaaa@97B7@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>Thus the following implications follow directly</p>
      <p>• <italic>sc </italic>(<italic>w</italic>, <italic>M</italic>) ≥ <italic>th </italic>⇒ <italic>sc </italic>(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M119" name="1471-2105-7-389-i22" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdEha3bGaayPadaaaaa@2EE5@</mml:annotation></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M120" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula>) ≥ <italic>th</italic></p>
      <p>• <italic>i </italic>∈ <italic>MS </italic>⇒ <italic>i </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M121" name="1471-2105-7-389-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanjabdofatbGaayPadaaaaa@2FC0@</mml:annotation></mml:semantics></mml:math></inline-formula></p>
      <p>and we conclude: <italic>MS </italic>⊆ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M122" name="1471-2105-7-389-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanjabdofatbGaayPadaaaaa@2FC0@</mml:annotation></mml:semantics></mml:math></inline-formula> holds for <italic>th </italic>∈ [<italic>sc</italic><sub>min </sub>(<italic>M</italic>), <italic>sc</italic><sub>max </sub>(<italic>M</italic>)].</p>
      <p>Hence we can search with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M123" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M124" name="1471-2105-7-389-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdofatbGaayPadaaaaa@2E9D@</mml:annotation></mml:semantics></mml:math></inline-formula> prefiltering of matches to <italic>M </italic>in <italic>S</italic>, profiting of longer and larger ℓ-intervals in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M125" name="1471-2105-7-389-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdofatbGaayPadaaaaa@2E9D@</mml:annotation></mml:semantics></mml:math></inline-formula> by extending algorithm <italic>ESAsearch </italic>as follows:</p>
      <p>(1) Transform <italic>S </italic>into <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M126" name="1471-2105-7-389-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdofatbGaayPadaaaaa@2E9D@</mml:annotation></mml:semantics></mml:math></inline-formula> and build the enhanced suffix array for <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M127" name="1471-2105-7-389-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdofatbGaayPadaaaaa@2E9D@</mml:annotation></mml:semantics></mml:math></inline-formula>;</p>
      <p>(2) Construct <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M128" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> from <italic>M</italic>;</p>
      <p>(3) Compute <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M129" name="1471-2105-7-389-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanjabdofatbGaayPadaaaaa@2FC0@</mml:annotation></mml:semantics></mml:math></inline-formula> by searching with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M130" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> on the enhanced suffix array of <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M131" name="1471-2105-7-389-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabdofatbGaayPadaaaaa@2E9D@</mml:annotation></mml:semantics></mml:math></inline-formula> using algorithm <italic>ESAsearch</italic>;</p>
      <p>(4) For each <italic>i </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M132" name="1471-2105-7-389-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanjabdofatbGaayPadaaaaa@2FC0@</mml:annotation></mml:semantics></mml:math></inline-formula> re-score match with <italic>σ </italic>= <italic>sc </italic>(<italic>S</italic>[<italic>i</italic>..<italic>i </italic>+ <italic>m </italic>- 1], <italic>M</italic>), and report <italic>i </italic>and <italic>σ </italic>if and only if <italic>σ </italic>≥ <italic>th</italic>.</p>
      <p>As a further consequence of Definition 2 the maximum score values in each row of <italic>M </italic>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M133" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> and thus the intermediate thresholds remain unchanged in the transformation process. Unfortunately the necessary PSSM transformation accompanying alphabet size reduction affects the expected reading depth <italic>m</italic>*(<italic>th</italic>) in such a way that it increases with more degraded alphabets, and therefore reduces the expected performance improvement. Due to maximization according to Equation (3) the matrix values in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M134" name="1471-2105-7-389-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">_</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqiaaqaaiabd2eanbGaayPadaaaaa@2E91@</mml:annotation></mml:semantics></mml:math></inline-formula> increase and we expect a decreased probability of falling short of an intermediate threshold early. Observe that there is a trade-off between increased expected reading depth and increased lcp-interval sizes at low reading depths. Therefore it is desirable to minimize the effect of maximization by grouping PSSM columns with similar score values, i.e., highly correlated columns. Since PSSMs reflect the properties of the underlying multiple alignment, we expect correlations of PSSM columns according to biologically motivated symbol similarities. Hence character correlation is the motivation for our alphabet reduction strategy.</p>
      <sec>
        <title>Reduced amino acid alphabets</title>
        <p>It is well known that various of the naturally occurring amino acids share certain similarities, like similar physiochemical properties. Accordingly, the complexity of protein sequences can be reduced by sorting these amino acids with similarities into groups and deriving a transformed, reduced alphabet [<xref ref-type="bibr" rid="B29">29</xref>]. These reduced alphabets contain symbols that represent a specific character class of the original alphabet. Since PSSMs and the sequences to be searched have to be encoded over the same alphabet, we are more interested in a single reduced alphabet suitable for all PSSMs under consideration, than in PSSM-specific reduced alphabets. The latter implies an unacceptable overhead of index generation for sequences over PSSM-specific alphabets, even though it may result in a lower expected reading depth. The basis for our reduction of the 20-letter amino acid alphabet to smaller alphabets are correlations indicated by the BLOSUM similarity matrix as described in [<xref ref-type="bibr" rid="B30">30</xref>]. That is, amino acid pairs with high similarity scores are grouped together (see Figure <xref ref-type="fig" rid="F8">8</xref> for an example). Let <italic>a </italic>and <italic>b </italic>be two amino acids and <italic>Y </italic>a 20 × 20 score matrix, then a measure of amino acid correlation <italic>c</italic><sub><italic>a</italic>,<italic>b </italic></sub>between <italic>a </italic>and <italic>b </italic>can be defined as</p>
        <fig position="float" id="F8">
          <label>Figure 8</label>
          <caption>
            <p><bold>Schemes for amino acid alphabet reduction</bold>. Reduction of the amino acid alphabet into smaller groups. Amino acid pairs are iteratively grouped together based on ther correlations <italic>c</italic><sub><italic>a</italic>,<italic>b </italic></sub>(see text for the definition of <italic>c</italic><sub><italic>a</italic>,<italic>b</italic></sub>), starting with the most correlated pairs, until al amino acids are divided into the desired number of groups. Here we used BLOSUM50 similarities for the determination of <italic>c</italic><sub><italic>a</italic>,<italic>b</italic></sub>. Observe that, hydrophobic amino acids, especially (LVIM) and (FYW) are conserved in many reduced alphabets. The same is true for the polar (ST), (EDNQ), and (KR) groups. The smallest alphabet contains two groups that can be categorized broadly as hydrophobic/small (LVIMCAGSTPFYW) and hydrophilic (EDNQKRH).</p>
          </caption>
          <graphic xlink:href="1471-2105-7-389-8"/>
        </fig>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M135" name="1471-2105-7-389-i24" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>c</mml:mi>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>:</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:msubsup>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>20</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>Y</mml:mi>
                            <mml:mrow>
                              <mml:mi>a</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>Y</mml:mi>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:msubsup>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>20</mml:mn>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mi>Y</mml:mi>
                                <mml:mrow>
                                  <mml:mi>a</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                            </mml:mrow>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:msubsup>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>20</mml:mn>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mi>Y</mml:mi>
                                <mml:mrow>
                                  <mml:mi>b</mml:mi>
                                  <mml:mo>,</mml:mo>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:msubsup>
                            </mml:mrow>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaWgaaWcbaGaemyyaeMaeiilaWIaemOyaigabeaakiabcQda6iabg2da9maalaaabaWaaabmaeaacqWGzbqwdaWgaaWcbaGaemyyaeMaeiilaWIaemyAaKgabeaakiabdMfaznaaBaaaleaacqWGIbGycqGGSaalcqWGPbqAaeqaaaqaaiabdMgaPjabg2da9iabigdaXaqaaiabikdaYiabicdaWaqdcqGHris5aaGcbaWaaeWaceaadaaeWaqaaiabdMfaznaaDaaaleaacqWGHbqycqGGSaalcqWGPbqAaeaacqaIYaGmaaaabaGaemyAaKMaeyypa0JaeGymaedabaGaeGOmaiJaeGimaadaniabggHiLdaakiaawIcacaGLPaaadaqadiqaamaaqadabaGaemywaK1aa0baaSqaaiabdkgaIjabcYcaSiabdMgaPbqaaiabikdaYaaaaeaacqWGPbqAcqGH9aqpcqaIXaqmaeaacqaIYaGmcqaIWaama0GaeyyeIuoaaOGaayjkaiaawMcaaaaaaaa@620F@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>and amino acid pairs can be iteratively grouped together according to their correlations, starting with the most correlated pairs, until all the amino acids are divided into the desired number of groups.</p>
      </sec>
    </sec>
    <sec>
      <title>Finding an appropriate threshold for PSSM searching: LazyDistrib</title>
      <sec>
        <title>Probabilities and expectation values</title>
        <p>The results of PSSM searches strongly depend on the choice of an appropriate threshold value <italic>th</italic>. A small threshold may produce a large number of false positive matches without any biological meaning, whereas meaningful matches may not be found if the threshold is too stringent. PSSM-scores are not equally distributed and thus scores of two different PSSMs are not comparable. It is therefore desirable to let the user define a significance threshold instead. The expected number of matches in a given random sequence database (E-value) is a widely accepted measure of the significance. We can compute the E-value for a known background distribution and length of the database by exhaustive enumeration of all substrings. However, the time complexity of such a computation is <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M136" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(|<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M137" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>m</italic></sup><italic>m</italic>) for a PSSM of length <italic>m</italic>. If the values in <italic>M </italic>are integers within a certain range [<italic>r</italic><sub><italic>min</italic></sub>, <italic>r</italic><sub><italic>max</italic></sub>] of size <italic>R </italic>= <italic>r</italic><sub><italic>max </italic></sub>- <italic>r</italic><sub><italic>min </italic></sub>+ 1, then dynamic programming (DP) methods (cf. [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>]) allow to compute the probability distribution (and hence the E-value) in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M138" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>m</italic><sup>2</sup><italic>R</italic>|<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M139" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|) time.</p>
        <p>In practice the probability distribution is often not exactly, or completely calculated due to concerns of speed. E.g., in the <italic>EMATRIX </italic>system [<xref ref-type="bibr" rid="B12">12</xref>] score thresholds are calculated and stored for probability values in the interval <italic>π </italic>= 10<sup>-1</sup>, 10<sup>-2</sup>,..., 10<sup>-40 </sup>only. Consequently, the user can only specify one of these p-value cutoffs. For the calculation of the p-value from a determined match score, <italic>EMATRIX </italic>uses log-linear interpolation on the stored thresholds. A different, commonly used strategy to derive a continuous distribution function uses the extreme value distribution as an approximation [<xref ref-type="bibr" rid="B31">31</xref>-<xref ref-type="bibr" rid="B33">33</xref>] of high scoring matches.</p>
        <p>Even though it is widely accepted that high-scoring local alignment score distributions of the popular position independent scoring systems PAM and BLOSUM can be well approximated by an extreme value distribution, this cannot be generalized for arbitrary PSSMs.</p>
        <p>To check whether an extreme value distribution is a suitable approximation for the distribution of PSSM match scores, we sampled the match scores of PSSMs arbitrarily chosen from the TRANSFAC and BLOCKS database. We randomly shuffled 1000 human promotor sequences of length 1200, taken from the database of transcriptional start sites (DBTSS) and 1000 protein sequences of length 365 (= average sequence length in Uniprot-Swissprot), respectively, preserving their mono-symbol composition. From the derived random PSSM match scores we took the best score for each sequence and calculated the empirical cumulative distribution function. If the match scores <italic>S </italic>are extreme value distributed, a X-Y plot with <italic>X </italic>= <italic>S </italic>and <italic>Y </italic>= log(- log(<italic>S</italic>)) should appear linear, since log<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M140" name="1471-2105-7-389-i25" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqadiqaaiabgkHiTiGbcYgaSjabc+gaVjabcEgaNnaabmGabaGaemyzau2aaWbaaSqabeaacqGHsislcqWGLbqzdaahaaadbeqaaGGaciab=jHiTiab=T7aSnaabmGabaGaemiEaGNaeyOeI0IaemyDauhacaGLOaGaayzkaaaaaaaaaOGaayjkaiaawMcaaaGaayjkaiaawMcaaiabg2da9iabgkHiTiab=T7aSnaabmGabaGaemiEaGNaeyOeI0IaemyDauhacaGLOaGaayzkaaaaaa@49D0@</mml:annotation></mml:semantics></mml:math></inline-formula> holds. For the TRANSFAC PSSM shown in Figure <xref ref-type="fig" rid="F9">9</xref>, the X-Y plot clearly indicates that an extreme value distribution is not an appropriate approximation. For PSSM IPB003211A (see Figure <xref ref-type="fig" rid="F10">10</xref>) from the BLOCKS database, it seems as if the score distribution can be approximated quite well with an extreme value distribution. However, we then still have the problem of adequate parameter estimation for the distribution function. Since we do not make any assumptions about the used PSSMs in our algorithm, neither about the type of scores, nor the score range, a proper approximation of the score distribution of arbitrary PSSMs is not possible, without time consuming simulations. That is why we are more interested in an exact solution and thus we focus on the efficient computation of an exact discrete score distribution.</p>
        <fig position="float" id="F9">
          <label>Figure 9</label>
          <caption>
            <p><bold>Score distribution of TRANSFAC PSSM M00734</bold>. Histogram, cumulative score distribution function, X-Y plot, and normal probability plot of TRANSFAC PSSM M00734 (PSSM length <italic>m </italic>= 9).</p>
          </caption>
          <graphic xlink:href="1471-2105-7-389-9"/>
        </fig>
        <fig position="float" id="F10">
          <label>Figure 10</label>
          <caption>
            <p><bold>Score distribution of BLOCKS PSSM IPB003211A</bold>. Histogram, cumulative score distribution, X-Y plot, and normal probability plot of a PSSM taken from the BLOCKS database (Accession: IPB003211A; PSSM length <italic>m </italic>= 40), describing the UreI protein of <italic>Helicobacter pylori</italic>, a proton gated urea channel [36].</p>
          </caption>
          <graphic xlink:href="1471-2105-7-389-10"/>
        </fig>
      </sec>
      <sec>
        <title>Calculation of exact PSSM score distributions</title>
        <p>While recent publications focus on the computation of the complete probability distribution, what is required specifically for PSSM matching, is computing a partial cumulative distribution corresponding to an E-value resp. p-value specified by the user. Therefore, we have developed a new "lazy" method to efficiently compute only a small fraction of the complete distribution.</p>
        <p>We formulate the problem we solve w.r.t. E-values and p-values: Given a user specified E-value <italic>η</italic>, find the minimum threshold <italic>Tmin</italic><sub><italic>E</italic></sub>(η, <italic>M</italic>), such that the expected number of matches of <italic>M </italic>in a random sequence of given length is at most <italic>η</italic>. Given a user specified p-value <italic>π</italic>, find the minimum threshold <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M141" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>π</italic>, <italic>M</italic>), such that the probability that <italic>M </italic>matches a random string of length <italic>m </italic>is at most <italic>π</italic>. The threshold <italic>Tmin</italic><sub><italic>E </italic></sub>(<italic>η</italic>, <italic>M</italic>) can be computed from <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M142" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>π</italic>, <italic>M</italic>) according to the equation <italic>Tmin</italic><sub><italic>E</italic></sub>(<italic>π</italic>·(<italic>n </italic>- <italic>m </italic>+ 1), <italic>M</italic>) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M143" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>π</italic>, <italic>M</italic>). Hence we restrict on computing <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M144" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>π</italic>, <italic>M</italic>).</p>
        <p>Since all strings of length <italic>m </italic>have a score between <italic>sc</italic><sub>min </sub>(<italic>M</italic>) and <italic>sc</italic><sub>max</sub>(<italic>M</italic>), we conclude <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M145" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(1, <italic>M</italic>) = <italic>sc</italic><sub>min </sub>(<italic>M</italic>) and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M146" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(0, <italic>M</italic>) &gt; <italic>sc</italic><sub>max</sub>(<italic>M</italic>). To explain our lazy evaluation method, we first consider existing methods based on DP.</p>
      </sec>
      <sec>
        <title>Evaluation with dynamic programming</title>
        <p>We assume that at each position in sequence <italic>S</italic>, the symbols occur independently, with probability <italic>f </italic>(<italic>a</italic>) = (1/<italic>n</italic>)·|{<italic>i </italic>∈ [0, <italic>n </italic>- 1] |<italic>S</italic>[<italic>i</italic>] = <italic>a</italic>}|. Thus a substring <italic>w </italic>of length <italic>m </italic>in <italic>S </italic>occurs with probability <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M147" name="1471-2105-7-389-i27" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqeWaqaaiabdAgaMnaabmGabaGaem4DaCNaei4waSLaemyAaKMaeiyxa0facaGLOaGaayzkaaaaleaacqWGPbqAcqGH9aqpcqaIWaamaeaacqWGTbqBcqGHsislcqaIXaqma0Gaey4dIunaaaa@3D5E@</mml:annotation></mml:semantics></mml:math></inline-formula> and the probability of observing the event <italic>sc </italic>(<italic>w</italic>, <italic>M</italic>) = <italic>t </italic>is <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M148" name="1471-2105-7-389-i28" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>:</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaatuuDJXwAK1uy0HMmaeXbfv3ySLgzG0uy0HgiuD3BaGqbaiab=LriqnaadmaabaGaem4CamNaem4yamMaeiikaGIaem4DaCNaeiilaWIaemyta0KaeiykaKIaeyypa0JaemiDaqhacaGLBbGaayzxaaGaeyypa0ZaaabeaeaadaqeWaqaaiabdAgaMjabcIcaOiabdEha3jabcUfaBjabdMgaPjabc2faDjabcMcaPaWcbaGaemyAaKMaeyypa0JaeGimaadabaGaemyBa0MaeyOeI0IaeGymaedaniabg+GivdaaleaacqWG3bWDcqGHiiIZimaacqGFaeFqdaahaaadbeqaaiabd2gaTbaaliabcQda6iabdohaZjabdogaJjabcIcaOiabdEha3jabcYcaSiabd2eanjabcMcaPiabg2da9iabdsha0bqab0GaeyyeIuoaaaa@72DC@</mml:annotation></mml:semantics></mml:math></inline-formula>. We obtain <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M149" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>π</italic>, <italic>M</italic>) by a look-up in the distribution:</p>
        <p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M150" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>π</italic>, <italic>M</italic>) = min{<italic>t </italic>|<italic>sc</italic><sub>min </sub>(<italic>M</italic>) ≤ <italic>t </italic>≤ <italic>sc</italic><sub>max </sub>(<italic>M</italic>), ℙ [<italic>sc </italic>(<italic>w</italic>, <italic>M</italic>) ≥ <italic>t</italic>] ≤ <italic>π</italic>}.</p>
        <p>If the values in the PSSM <italic>M </italic>are integers in a range of width <italic>R</italic>, dynamic programming allows to efficiently compute the probability distribution. The dynamic programming aspect becomes more obvious by introducing for each <italic>k </italic>∈ [0, <italic>m </italic>- 1] the <italic>prefix </italic>PSSM <italic>M</italic><sub><italic>k </italic></sub>: [0, <italic>k</italic>] × <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M151" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula> → ℕ defined by <italic>M</italic><sub><italic>k </italic></sub>(<italic>j</italic>, <italic>a</italic>) = <italic>M </italic>(<italic>j</italic>, <italic>a</italic>) for <italic>j </italic>∈ [0, <italic>k</italic>] and <italic>a </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M152" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>.</p>
        <p>Corresponding distributions <italic>Q</italic><sub><italic>k </italic></sub>(<italic>t</italic>) for <italic>k </italic>∈ [0, <italic>m </italic>- 1] and <italic>t </italic>∈ [<italic>sc</italic><sub>min </sub>(<italic>M</italic><sub><italic>k</italic></sub>), <italic>sc</italic><sub>max </sub>(<italic>M</italic><sub><italic>k</italic></sub>)], and <italic>Q</italic><sub>-1</sub>(<italic>t</italic>), are defined by</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M153" name="1471-2105-7-389-i29" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>Q</mml:mi>
                            <mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>t</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>:</mml:mo>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:mo>{</mml:mo>
                            <mml:mrow>
                              <mml:mtable columnalign="left">
                                <mml:mtr columnalign="left">
                                  <mml:mtd columnalign="left">
                                    <mml:mn>1</mml:mn>
                                  </mml:mtd>
                                  <mml:mtd columnalign="left">
                                    <mml:mrow>
                                      <mml:mtext>if </mml:mtext>
                                      <mml:mi>t</mml:mi>
                                      <mml:mo>=</mml:mo>
                                      <mml:mn>0</mml:mn>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                                <mml:mtr columnalign="left">
                                  <mml:mtd columnalign="left">
                                    <mml:mn>0</mml:mn>
                                  </mml:mtd>
                                  <mml:mtd columnalign="left">
                                    <mml:mrow>
                                      <mml:mtext>otherwise</mml:mtext>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                              </mml:mtable>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>Q</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>t</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>:</mml:mo>
                          <mml:mo>=</mml:mo>
                          <mml:mstyle displaystyle="true">
                            <mml:munder>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>a</mml:mi>
                                <mml:mo>∈</mml:mo>
                                <mml:mi mathvariant="script">A</mml:mi>
                              </mml:mrow>
                            </mml:munder>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>Q</mml:mi>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mstyle>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>t</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>M</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>k</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>a</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>a</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaafaqadeGabaaabaGaemyuae1aaSbaaSqaaiabgkHiTiabigdaXaqabaGccqGGOaakcqWG0baDcqGGPaqkcqGG6aGocqGH9aqpdaGabaqaauaabaqaciaaaeaacqaIXaqmaeaacqqGPbqAcqqGMbGzcqqGGaaicqWG0baDcqGH9aqpcqaIWaamaeaacqaIWaamaeaacqqGVbWBcqqG0baDcqqGObaAcqqGLbqzcqqGYbGCcqqG3bWDcqqGPbqAcqqGZbWCcqqGLbqzaaaacaGL7baaaeaacqWGrbqudaWgaaWcbaGaem4AaSgabeaakiabcIcaOiabdsha0jabcMcaPiabcQda6iabg2da9maaqafabaGaemyuae1aaSbaaSqaaiabdUgaRjabgkHiTiabigdaXaqabaaabaGaemyyaeMaeyicI4mcdaGae8haXheabeqdcqGHris5aOGaeiikaGIaemiDaqNaeyOeI0Iaemyta0KaeiikaGIaem4AaSMaeiilaWIaemyyaeMaeiykaKIaeiykaKIaemOzayMaeiikaGIaemyyaeMaeiykaKcaaaaa@770F@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>We have ℙ[<italic>sc </italic>(<italic>w</italic>, <italic>M</italic>) = <italic>t</italic>] = <italic>Q</italic><sub><italic>m</italic>-1 </sub>(<italic>t</italic>). The algorithm computing <italic>Q</italic><sub><italic>k </italic></sub>determines a set of probability distributions for <italic>M</italic><sub>0</sub>, ..., <italic>M</italic><sub><italic>k</italic></sub>. <italic>Q</italic><sub><italic>k </italic></sub>is evaluated in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M154" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>sc</italic><sub>max </sub>(<italic>M</italic>)|<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M155" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|) time from <italic>Q</italic><sub><italic>k</italic>-1</sub>, summing up to <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M156" name="1471-2105-7-389-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFoe=taaa@383D@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>sc</italic><sub>max </sub>(<italic>M</italic>) | <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M157" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>| <italic>m</italic>) total time. See Figure <xref ref-type="fig" rid="F11">11</xref> for an example.</p>
        <fig position="float" id="F11">
          <label>Figure 11</label>
          <caption>
            <p><bold>Evaluation with dynamic programming</bold>. The simple DP scheme computes all probability vectors <italic>Q</italic><sub>0</sub>, <italic>Q</italic><sub>1</sub>, <italic>Q</italic><sub>2 </sub>completely within the green marked area, corresponding to score ranges of prefix PSSMs <italic>M</italic><sub><italic>k</italic></sub>. In contrast to the simple scheme, the restricted probability computation method computes only the upper end of the probability distribution until the given p-value threshold is exceeded, omitting parts of the green area. In this example we show how to compute the score threshold <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M158" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>π</italic>, <italic>M</italic>) for PSSM <italic>M </italic>of length <italic>m </italic>= 3 and a score range of [4,11] corresponding to a given p-value threshold of <italic>π </italic>= <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M159" name="1471-2105-7-389-i30" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>8</mml:mn></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabiIda4aaaaaa@2EAA@</mml:annotation></mml:semantics></mml:math></inline-formula>. For simplicity we assume a uniform character distribution of <italic>f</italic>(<italic>A</italic>) = <italic>f</italic>(<italic>C</italic>) = <italic>f</italic>(<italic>G</italic>) = <italic>f</italic>(<italic>T</italic>) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M160" name="1471-2105-7-389-i31" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabisda0aaaaaa@2EA2@</mml:annotation></mml:semantics></mml:math></inline-formula>. Cells of the matrix that are computed in the step actually under consideration are marked red. In step <italic>d </italic>= 0, see (A), the algorithm computes <italic>Q</italic><sub>2</sub>(11) recursively for all paths through <italic>M </italic>that achieve a score of 11, i.e. <italic>Q</italic><sub>2</sub>(11) = <italic>Q</italic><sub>1</sub>(8)·<italic>f</italic>(<italic>G</italic>), <italic>Q</italic><sub>1</sub>(8) = <italic>Q</italic><sub>0</sub>(4)·<italic>f</italic>(<italic>G</italic>), <italic>Q</italic><sub>0</sub>(4) = <italic>Q</italic><sub>-1</sub>(0)·<italic>f</italic>(<italic>A</italic>) = 1·<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M161" name="1471-2105-7-389-i31" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabisda0aaaaaa@2EA2@</mml:annotation></mml:semantics></mml:math></inline-formula>, since AGG is the only path achieving score 11. It follows <italic>Q</italic><sub>2</sub>(11) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M162" name="1471-2105-7-389-i32" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabiAda2iabisda0aaaaaa@2F9C@</mml:annotation></mml:semantics></mml:math></inline-formula>. In step <italic>d </italic>= 1 all paths achieving a score of 11 - <italic>d </italic>= 10 to determine <italic>Q</italic><sub>2</sub>(10) are computed, see (B). We conclude <italic>Q</italic><sub>2</sub>(10) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M163" name="1471-2105-7-389-i33" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabigdaXiabiAda2aaaaaa@2F96@</mml:annotation></mml:semantics></mml:math></inline-formula>. In this step, DP allows to reuse value <italic>Q</italic><sub>1</sub>(8) without recomputation. In step <italic>d </italic>= 2, see (C) values <italic>Q</italic><sub>1</sub>(7) and <italic>Q</italic><sub>0</sub>(3) can be reused to compute <italic>Q</italic><sub>2</sub>(9) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M164" name="1471-2105-7-389-i34" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>5</mml:mn><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabiwda1aqaaiabiAda2iabisda0aaaaaa@2FA4@</mml:annotation></mml:semantics></mml:math></inline-formula>. In step <italic>d </italic>= 2 the cumulated probability <italic>Q</italic><sub>2</sub>(11) + <italic>Q</italic><sub>2</sub>(10) + <italic>Q</italic><sub>2</sub>(9) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M165" name="1471-2105-7-389-i35" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>5</mml:mn><mml:mrow><mml:mn>32</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabiwda1aqaaiabiodaZiabikdaYaaaaaa@2F9A@</mml:annotation></mml:semantics></mml:math></inline-formula> exceeds the given p-value threshold of <italic>π </italic>= <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M166" name="1471-2105-7-389-i30" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>8</mml:mn></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabiIda4aaaaaa@2EAA@</mml:annotation></mml:semantics></mml:math></inline-formula>, and the restricted probability computation method skips the rest of the computation. We obtain a score threshold of <italic>th </italic>= 10 correponding to <italic>π</italic>.</p>
          </caption>
          <graphic xlink:href="1471-2105-7-389-11"/>
        </fig>
        <p>If we allow for floating point scores that are rounded to <italic>ε </italic>decimal places, the time and space requirement increases by a factor of 10<sup><italic>ε</italic></sup>. Conversely, if all integer scores share a greatest common divisor <italic>z</italic>, the matrix should be canceled down by <italic>z</italic>.</p>
      </sec>
      <sec>
        <title>Restricted probability computation</title>
        <p>In order to find <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M167" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>π</italic>, <italic>M</italic>) it is not necessary to compute the whole codomain of the distribution function <italic>Q </italic>= <italic>Q</italic><sub><italic>m</italic>-1</sub>. We propose a new method only computing a partial distribution by summing over the probabilities for decreasing threshold values <italic>sc</italic><sub>max </sub>(<italic>M</italic>), <italic>sc</italic><sub>max </sub>(<italic>M</italic>) - 1,..., until the given p-value <italic>π </italic>is exceeded (see Figures <xref ref-type="fig" rid="F11">11</xref>, <xref ref-type="fig" rid="F12">12</xref>).</p>
        <fig position="float" id="F12">
          <label>Figure 12</label>
          <caption>
            <p><bold>Restricted probability computation</bold>. Computation of the partial cumulative distribution function. Observe that in order to determine <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M168" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>π</italic>, <italic>M</italic>) for <italic>π </italic>= 0.3 we do not have to calculate the complete distribution in the score range [<italic>sc</italic><sub>min</sub>(<italic>M</italic>), <italic>sc</italic><sub>max</sub>(<italic>M</italic>)]. It is sufficient to calculate only the upper end (green area) starting with <italic>sc</italic><sub>max</sub>(<italic>M</italic>) until ℙ[<italic>X </italic>≥ <italic>S</italic>] ≥ <italic>π</italic>.</p>
          </caption>
          <graphic xlink:href="1471-2105-7-389-12"/>
        </fig>
        <p>In step <italic>d </italic>we compute <italic>Q </italic>(<italic>sc</italic><sub>max </sub>(<italic>M</italic>) - <italic>d</italic>) where all intermediate scores contributing to <italic>sc</italic><sub>max </sub>(<italic>M</italic>) - <italic>d </italic>have to be considered. In analogy to lookahead scoring, in each row <italic>j </italic>of <italic>M </italic>we avoid all intermediate scores below the intermediate threshold <italic>th</italic><sub><italic>j </italic></sub>because they do not contribute to <italic>Q</italic>(<italic>sc</italic><sub>max </sub>(<italic>M</italic>) - <italic>d</italic>). The algorithm stops if the cumulated probability for threshold <italic>sc</italic><sub>max </sub>(<italic>M</italic>) - <italic>d </italic>exceeds the given p-value <italic>π </italic>and we obtain <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M169" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>π</italic>, <italic>M</italic>) = <italic>sc</italic><sub>max </sub>(<italic>M</italic>) - <italic>d </italic>+ 1.</p>
      </sec>
      <sec>
        <title>Lazy evaluation of the permuted matrix</title>
        <p>The restricted computation strategy performs best if there are only few iterations (i.e., <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M170" name="1471-2105-7-389-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi mathvariant="script">P</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaacqWGubavieGacqWFTbqBcqWFPbqAcqWFUbGBdaWgaaWcbaGaemiuaafabeaaaaa@3D07@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>π</italic>, <italic>M</italic>) is close to <italic>sc</italic><sub>max</sub>(<italic>M</italic>)) and in each iteration step the computation of <italic>Q</italic><sub><italic>k</italic></sub>(<italic>t</italic>) can be skipped in an early stage, i.e., for small values of <italic>k</italic>. The latter occurs to be more likely if the first rows of <italic>M </italic>contain strongly discriminative values leading to the exclusion of the small values by comparison with the intermediate thresholds. An example of this situation is given in Figure <xref ref-type="fig" rid="F1">1</xref>. Since <italic>Q</italic><sub><italic>k</italic></sub>(<italic>t</italic>) is invariant to the permutation of the rows of <italic>M</italic>, we can sort the rows of <italic>M </italic>such that the most discriminative rows come first. We found that the difference between the largest two values of a row is a suitable measure for the level of discrimination since a larger difference increases the probability to remain below the intermediate threshold. Since the rows of <italic>M </italic>are scanned several times, we save time by initially sorting each row in order of descending score. We divide the computation steps where the step <italic>d </italic>computes <italic>Q</italic>(<italic>sc</italic><sub>max</sub>(<italic>M</italic>) - <italic>d</italic>): In step <italic>d </italic>= 0 only the maximal scores max<sub><italic>i</italic></sub>, <italic>i </italic>∈ [0, <italic>m </italic>- 1] in each row have to be evaluated.</p>
        <p>In step <italic>d </italic>&gt; 0 all scores <italic>M</italic>(<italic>i</italic>, <italic>a</italic>) ≥ max<sub><italic>i </italic></sub>- <italic>d </italic>may contribute to <italic>Q</italic>(<italic>sc</italic><sub>max</sub>(<italic>M</italic>) - <italic>d</italic>). Since in general a score value <italic>M</italic>(<italic>i</italic>, <italic>a</italic>) ≥ max<sub><italic>i </italic></sub>- <italic>d </italic>also gives contribution to <italic>Q</italic>(<italic>sc</italic><sub>max</sub>(<italic>M</italic>) - <italic>l</italic>) for <italic>l </italic>&gt; <italic>d</italic>, we can save time by storing <italic>Q</italic><sub><italic>i</italic></sub>(max<sub><italic>i </italic></sub>- <italic>l</italic>) for <italic>l </italic>&gt; <italic>d</italic>, in step <italic>d </italic>in a buffer and reusing the buffer in steps <italic>d </italic>+ 1, <italic>d </italic>+ 2,.... This allows for the computation of <italic>Q</italic><sub><italic>k</italic></sub>(<italic>sc</italic><sub>max</sub>(<italic>M</italic>) - <italic>d</italic>) only based on the buffer and scores <italic>M</italic>(<italic>i</italic>, <italic>a</italic>) = max<sub><italic>i </italic></sub>- <italic>d </italic>while scores <italic>M</italic>(<italic>i</italic>, <italic>a</italic>) &gt; max<sub><italic>i </italic></sub>- <italic>d</italic>, <italic>i </italic>∈ [0, <italic>m </italic>- 1], can be omitted. We therefore have developed an algorithm <italic>LazyDistrib </italic>employing lazy evaluation of the distribution. That is, given a threshold <italic>th</italic>, the algorithm only evaluates parts of the DP vectors necessary to determine <italic>Q</italic><sub><italic>k</italic></sub>(<italic>th</italic>) and simultaneously saves sub-results concerned with score <italic>th </italic>in an additional buffer matrix <italic>Pbuf </italic>(instead of recomputing them later, see Figure <xref ref-type="fig" rid="F13">13</xref> for an example). This is described by the following recurrence:</p>
        <fig position="float" id="F13">
          <label>Figure 13</label>
          <caption>
            <p><bold>Probability computation using lazy evaluation ofthe DP matrix</bold>. In this example we use the same PSSM <italic>M</italic>, character distribution, and p-value threshold <italic>π </italic>= <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M171" name="1471-2105-7-389-i30" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>8</mml:mn></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabiIda4aaaaaa@2EAA@</mml:annotation></mml:semantics></mml:math></inline-formula> as in Figure 11. However, in each row of the PSSM the scores are sorted in descending order, and the rows are sorted with the most discriminant row coming first (see coloured PSSMs for this relationship). Observe that the <italic>LazyDistrib </italic>algorithm evaluates the DP vectors non-recursively top-down. Cells computed in the actual step are marked red. In step <italic>d </italic>= 0 the algorithm computes <italic>Q</italic><sub>2</sub>(11) by evaluating paths through the PSSM contributing to <italic>Q</italic><sub>2</sub>(ll), which is in this example only the high scoring path GGA. Intermediate results of <italic>Q</italic><sub>0</sub>(4), <italic>Q</italic><sub>1</sub>(7), and <italic>Q</italic><sub>2</sub>(11) are collected in buffers <italic>Pbuf</italic><sub>0</sub>(4), <italic>Pbuf</italic><sub>1</sub>(7), and <italic>Pbuf</italic><sub>2</sub>(11) first, and finally copied to the correponding cells in <italic>Q</italic>. See (A) for the situation after step <italic>d </italic>= 0 has been completed. In step <italic>d </italic>= 1, see (B), the algorithm computes <italic>Q</italic><sub>2</sub>(10), starting in row <italic>k </italic>= 1 with the determination of <italic>Pbuf</italic><sub>1</sub>(6) and <italic>Q</italic><sub>1</sub>(6). That is, <italic>Q</italic><sub>1</sub>(6) = <italic>Pbuf</italic><sub>1</sub>(6) = <italic>Q</italic><sub>0</sub>(4)·<italic>f</italic>(<italic>A</italic>) + <italic>Q</italic><sub>0</sub>(4)·<italic>f</italic>(<italic>C</italic>) + <italic>Q</italic><sub>0</sub>(4)·<italic>f</italic>(<italic>T</italic>) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M172" name="1471-2105-7-389-i36" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabiodaZaqaaiabigdaXiabiAda2aaaaaa@2F9A@</mml:annotation></mml:semantics></mml:math></inline-formula>. Analogously <italic>Q</italic><sub>2</sub>(10) and <italic>Pbuf</italic><sub>2</sub>(10) are computed based on <italic>Q</italic><sub>1</sub>(7) and <italic>Q</italic><sub>1</sub>(6). Additionally <italic>Pbuf</italic><sub>2</sub>(9) is filled for further reuse in subsequent steps <italic>d </italic>+ 1, <italic>d </italic>+ 2,.... We compute <italic>Pbuf</italic><sub>2</sub>(9) = <italic>Q</italic><sub>1</sub>(6)·<italic>f</italic>(<italic>C</italic>) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M173" name="1471-2105-7-389-i37" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabiodaZaqaaiabiAda2iabisda0aaaaaa@2FA0@</mml:annotation></mml:semantics></mml:math></inline-formula>. The algorithm can directly start in row <italic>k </italic>= 1 with the computation of <italic>Q</italic><sub>1</sub>(6) instead of <italic>Q</italic><sub>0</sub>(3) since a score of 3 cannot be achieved by the first prefix PSSM <italic>M</italic><sub>0</sub>. Only score 4 of <italic>M</italic><sub>0 </sub>contributes to <italic>Q</italic><sub>2</sub>(10), scores 2 and 1 do not. In step <italic>d </italic>= 2, see (C), the algorithm computes <italic>Q</italic><sub>2</sub>(9), starting in row <italic>k </italic>= 0. <italic>Pbuf</italic><sub>2</sub>(9) is computed reusing the partial sum calculated in previous steps, such that <italic>Pbuf</italic><sub>2</sub>(9) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M174" name="1471-2105-7-389-i37" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabiodaZaqaaiabiAda2iabisda0aaaaaa@2FA0@</mml:annotation></mml:semantics></mml:math></inline-formula> + <italic>Q</italic><sub>1</sub>(7)·<italic>f</italic>(<italic>T</italic>) + <italic>Pbuf</italic><sub>1</sub>(5)·<italic>f</italic>(<italic>A</italic>) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M175" name="1471-2105-7-389-i34" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>5</mml:mn><mml:mrow><mml:mn>64</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabiwda1aqaaiabiAda2iabisda0aaaaaa@2FA4@</mml:annotation></mml:semantics></mml:math></inline-formula>, and then copied to <italic>Q</italic><sub>2</sub>(9). <italic>Pbuf</italic><sub>1</sub>(4), <italic>Pbuf</italic><sub>2</sub>(8), and <italic>Pbuf</italic><sub>2</sub>(7) are filled based on <italic>Pbuf</italic><sub>0</sub>(2), <italic>Q</italic><sub>1</sub>(6), <italic>Pbuf</italic><sub>1</sub>(5), and <italic>Q</italic><sub>1</sub>(5) for further reuse. After step <italic>d </italic>= 2 the rest of the computation can be skipped since the cumulated probability <italic>Q</italic><sub>2</sub>(11) + <italic>Q</italic><sub>2</sub>(10) + <italic>Q</italic><sub>2</sub>(9) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M176" name="1471-2105-7-389-i35" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>5</mml:mn><mml:mrow><mml:mn>32</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabiwda1aqaaiabiodaZiabikdaYaaaaaa@2F9A@</mml:annotation></mml:semantics></mml:math></inline-formula> exceeds the given p-value <italic>π </italic>= <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M177" name="1471-2105-7-389-i30" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>8</mml:mn></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabigdaXaqaaiabiIda4aaaaaa@2EAA@</mml:annotation></mml:semantics></mml:math></inline-formula> and we obtain a score threshold of <italic>th </italic>= 10 corresponding to <italic>π</italic>.</p>
          </caption>
          <graphic xlink:href="1471-2105-7-389-13"/>
        </fig>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M178" name="1471-2105-7-389-i38" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>Q</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>t</mml:mi>
                          <mml:mi>h</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>d</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mo>=</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                          <mml:mi>b</mml:mi>
                          <mml:mi>u</mml:mi>
                          <mml:msub>
                            <mml:mi>f</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>t</mml:mi>
                          <mml:mi>h</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>d</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>+</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow/>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow/>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munder>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>a</mml:mi>
                                <mml:mo>∈</mml:mo>
                                <mml:mi mathvariant="script">A</mml:mi>
                                <mml:mo>:</mml:mo>
                                <mml:mi>M</mml:mi>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>k</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>a</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                                <mml:mo>≥</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>max</mml:mi>
                                    <mml:mo>⁡</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>k</mml:mi>
                                </mml:msub>
                                <mml:mo>−</mml:mo>
                                <mml:mi>d</mml:mi>
                              </mml:mrow>
                            </mml:munder>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>Q</mml:mi>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>t</mml:mi>
                              <mml:mi>h</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mi>d</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mi>M</mml:mi>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>k</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>a</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                              <mml:mo stretchy="false">)</mml:mo>
                              <mml:mi>f</mml:mi>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>a</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                          <mml:mi>b</mml:mi>
                          <mml:mi>u</mml:mi>
                          <mml:msub>
                            <mml:mi>f</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>t</mml:mi>
                          <mml:mi>h</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>d</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mo>:</mml:mo>
                          <mml:mo>=</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mstyle displaystyle="true">
                            <mml:munder>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>a</mml:mi>
                                <mml:mo>∈</mml:mo>
                                <mml:mi mathvariant="script">A</mml:mi>
                                <mml:mo>:</mml:mo>
                                <mml:mi>M</mml:mi>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>k</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>a</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                                <mml:mo>&lt;</mml:mo>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>max</mml:mi>
                                    <mml:mo>⁡</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>k</mml:mi>
                                </mml:msub>
                                <mml:mo>−</mml:mo>
                                <mml:mi>d</mml:mi>
                              </mml:mrow>
                            </mml:munder>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>Q</mml:mi>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>t</mml:mi>
                              <mml:mi>h</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mi>d</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mi>M</mml:mi>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>k</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>a</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                              <mml:mo stretchy="false">)</mml:mo>
                              <mml:mi>f</mml:mi>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>a</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaafaqadeWadaaabaGaemyuae1aaSbaaSqaaiabdUgaRbqabaGccqGGOaakcqWG0baDcqWGObaAcqGHsislcqWGKbazcqGGPaqkaeaacqGH9aqpaeaacqWGqbaucqWGIbGycqWG1bqDcqWGMbGzdaWgaaWcbaGaem4AaSgabeaakiabcIcaOiabdsha0jabdIgaOjabgkHiTiabdsgaKjabcMcaPiabgUcaRaqaaaqaaaqaamaaqafabaGaemyuae1aaSbaaSqaaiabdUgaRjabgkHiTiabigdaXaqabaGccqGGOaakcqWG0baDcqWGObaAcqGHsislcqWGKbazcqGHsislcqWGnbqtcqGGOaakcqWGRbWAcqGGSaalcqWGHbqycqGGPaqkcqGGPaqkcqWGMbGzcqGGOaakcqWGHbqycqGGPaqkaSqaaiabdggaHjabgIGioJWaaiab=bq8bjabcQda6iabd2eanjabcIcaOiabdUgaRjabcYcaSiabdggaHjabcMcaPiabgwMiZkGbc2gaTjabcggaHjabcIha4naaBaaameaacqWGRbWAaeqaaSGaeyOeI0IaemizaqgabeqdcqGHris5aaGcbaGaemiuaaLaemOyaiMaemyDauNaemOzay2aaSbaaSqaaiabdUgaRbqabaGccqGGOaakcqWG0baDcqWGObaAcqGHsislcqWGKbazcqGGPaqkaeaacqGG6aGocqGH9aqpaeaadaaeqbqaaiabdgfarnaaBaaaleaacqWGRbWAcqGHsislcqaIXaqmaeqaaOGaeiikaGIaemiDaqNaemiAaGMaeyOeI0IaemizaqMaeyOeI0Iaemyta0KaeiikaGIaem4AaSMaeiilaWIaemyyaeMaeiykaKIaeiykaKIaemOzayMaeiikaGIaemyyaeMaeiykaKcaleaacqWGHbqycqGHiiIZcqWFaeFqcqGG6aGocqWGnbqtcqGGOaakcqWGRbWAcqGGSaalcqWGHbqycqGGPaqkcqGH8aapcyGGTbqBcqGGHbqycqGG4baEdaWgaaadbaGaem4AaSgabeaaliabgkHiTiabdsgaKbqab0GaeyyeIuoaaaaaaa@BBBD@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>In the present implementation, the algorithm assumes independently distributed symbols. The algorithm can be extended to an order <italic>d</italic>-Markov model (w.r.t. the background alphabet distribution). This increases the computation time by a factor of |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M179" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>d</italic></sup>.</p>
      </sec>
    </sec>
    <sec>
      <title>Implementation and computational results</title>
      <p>We implemented <italic>LAsearch</italic>, <italic>ESAsearch</italic>, both capable to handle reduced alphabets, and <italic>LazyDistrib </italic>in C. The program was compiled with the GNU C compiler (version 3.1, optimization option -03). All measurements were performed on a 8 CPU Sun UltraSparc III computer running at 900 MHz, with 64 GB main memory (using only one CPU and a small fraction of the memory). Enhanced suffix arrays were constructed with the program mkvtree, see [<xref ref-type="bibr" rid="B34">34</xref>].</p>
      <p>We performed seven experiments comparing different programs for searching PSSMs. Table <xref ref-type="table" rid="T1">1</xref> gives more details on the experimental input for Experiments 1–6. Results are given in Table <xref ref-type="table" rid="T2">2</xref> (Exp. 1–5) and Figure <xref ref-type="fig" rid="F14">14</xref> (Exp. 6). For Experiment 7, see Figures <xref ref-type="fig" rid="F15">15</xref> and <xref ref-type="fig" rid="F16">16</xref>. In these experiments <italic>ESAsearch </italic>performed very well, especially on nucleotide PSSMs, see Experiments 2 and 4. It is faster than <italic>MatInspector </italic>by a factor between 63 and 1,037, depending on the stringency of the given thresholds. The commercial advancement of <italic>MatInspector</italic>, called <italic>MATCH</italic>, was not available for our comparisons, but based on [<xref ref-type="bibr" rid="B7">7</xref>] we presume a running time comparable to <italic>MatInspector</italic>. Compared to <italic>LAsearch</italic>, <italic>ESAsearch </italic>is faster by a factor between 17 (MSS = 0.80) and 196 (MSS = 0.95) (see Experiment 2). On larger nucleotide sequences (see Experiment 4) the speedup factors increase, ranging from 58 (MSS = 0.85) to 275 (MSS = 0.95). See Table <xref ref-type="table" rid="T1">1</xref> for the definition of MSS. In the experiments using protein PSSMs, <italic>ESAsearch </italic>is faster than the method of [<xref ref-type="bibr" rid="B13">13</xref>] by a factor between 1.5 and 1.8 (see Experiment 1). This is due to the better locality behavior of the enhanced suffix array compared to a suffix tree. For larger p-values <italic>LAsearch </italic>performs slightly better than <italic>ESAsearch</italic>. Increasing the stringency, the performance of <italic>ESAsearch </italic>increases, resulting in a speedup of factor 1.5 for a p-value of 10<sup>-40</sup>. We explain this behavior by the larger alphabet size, resulting in shorter common prefixes and therefore smaller skipped areas of the enhanced suffix array. With increasing stringency of the threshold, the expected reading depth decreases, resulting in larger skipped areas of the enhanced suffix array. Compared to the <italic>FingerPrintScan </italic>program, <italic>ESAsearch </italic>achieves a speedup factor between 3.8 and 470, see Experiment 3. In comparison to <italic>Blimps</italic>, the PSSM-searching program of the BLOCKS database, <italic>ESAsearch </italic>is faster by a factor of 23 (see Experiment 5) for the chosen threshold. In Experiment 6 (see Figure <xref ref-type="fig" rid="F14">14</xref>), we measured the influence of alphabet reductions on the running time of <italic>ESAsearch </italic>when using protein PSSMs. Compared to the performance of <italic>ESAsearch </italic>operating on the normal 20 letter amino acid alphabet a speedup up to factor 2 can be achieved when using a 4 letter alphabet and a p-value cutoff of 10<sup>-20</sup>. Experiment 7 (see Figures <xref ref-type="fig" rid="F15">15</xref> and <xref ref-type="fig" rid="F16">16</xref>) shows that the expected running time of <italic>ESAsearch </italic>is sublinear, whereas <italic>LAsearch </italic>runs in linear time. In a final experiment, we compared algorithm <italic>LazyDistrib </italic>with the DP-algorithm computing the complete distribution. <italic>LazyDistrib </italic>shows a speedup factor between 3 and 330 on our test set, depending on the stringency of the threshold (see Table <xref ref-type="table" rid="T3">3</xref>).</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Performed experiments and experimental input. </p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="right">Exp. 1</td>
              <td align="right">Exp. 2</td>
              <td align="right">Exp. 3</td>
              <td align="right">Exp. 4</td>
              <td align="right">Exp. 5</td>
              <td align="right">Exp. 6</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left"># searched sequences</td>
              <td align="right">59,021</td>
              <td align="right">30,964</td>
              <td align="right">19,111</td>
              <td align="right">1 (<italic>H.s</italic>. Chr. 6)</td>
              <td align="right">19,111</td>
              <td align="right">19,111</td>
            </tr>
            <tr>
              <td align="left">total length</td>
              <td align="right">20.2 MB</td>
              <td align="right">37.2 MB</td>
              <td align="right">4.3 MB</td>
              <td align="right">162.9 MB</td>
              <td align="right">4.3 MB</td>
              <td align="right">4.3 MB</td>
            </tr>
            <tr>
              <td align="left">sequence source</td>
              <td align="right">see [13]</td>
              <td align="right">DBTSS 5.1</td>
              <td align="right">RCSB PDB</td>
              <td align="right">Sanger V1. 4</td>
              <td align="right">RCSB PDB</td>
              <td align="right">RCSB PDB</td>
            </tr>
            <tr>
              <td align="left">sequence type/PSSM type</td>
              <td align="right">protein</td>
              <td align="right">DNA</td>
              <td align="right">protein</td>
              <td align="right">DNA</td>
              <td align="right">protein</td>
              <td align="right">protein</td>
            </tr>
            <tr>
              <td align="left"># PSSMs</td>
              <td align="right">4,034</td>
              <td align="right">220</td>
              <td align="right">11,411</td>
              <td align="right">576</td>
              <td align="right">28,337</td>
              <td align="right">10,931</td>
            </tr>
            <tr>
              <td align="left">PSSM source</td>
              <td align="right">see [13]</td>
              <td align="right">MatInspector</td>
              <td align="right">PRINTS 38</td>
              <td align="right">TRANSFAC Prof. 6.2</td>
              <td align="right">BLOCKS 14.1</td>
              <td align="right">PRINTS 38</td>
            </tr>
            <tr>
              <td align="left">avg. length of PSSMs</td>
              <td align="right">29.74</td>
              <td align="right">14.21</td>
              <td align="right">17.32</td>
              <td align="right">13.33</td>
              <td align="right">26.3</td>
              <td align="right">17.37</td>
            </tr>
            <tr>
              <td align="left">index construction (sec)</td>
              <td align="right">41</td>
              <td align="right">146</td>
              <td align="right">10.2</td>
              <td align="right">586</td>
              <td align="right">10.2</td>
              <td align="right">10.2</td>
            </tr>
            <tr>
              <td align="left"><italic>mdc </italic>(sec)</td>
              <td align="right">1960</td>
              <td align="right">-</td>
              <td align="right">1486</td>
              <td align="right">-</td>
              <td align="right">11871</td>
              <td align="right">1486</td>
            </tr>
            <tr>
              <td colspan="7">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">
                <italic>MatInspector</italic>
              </td>
              <td/>
              <td align="right">x</td>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">
                <italic>FingerPrintScan</italic>
              </td>
              <td/>
              <td/>
              <td align="right">x</td>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">
                <italic>Blimps</italic>
              </td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td align="right">x</td>
              <td/>
            </tr>
            <tr>
              <td align="left">
                <italic>DN00</italic>
              </td>
              <td align="right">x</td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="left">
                <italic>LAsearch</italic>
              </td>
              <td align="right">x</td>
              <td align="right">x</td>
              <td align="right">x</td>
              <td align="right">x</td>
              <td align="right">x</td>
              <td/>
            </tr>
            <tr>
              <td align="left">
                <italic>ESAsearch</italic>
              </td>
              <td align="right">x</td>
              <td align="right">x</td>
              <td align="right">x</td>
              <td align="right">x</td>
              <td align="right">x</td>
              <td align="right">x</td>
            </tr>
            <tr>
              <td align="left"><italic>ESAsearch </italic>(reduced <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M180" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>)</td>
              <td/>
              <td/>
              <td/>
              <td/>
              <td/>
              <td align="right">x</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Overview of the sequences and PSSMs used in the performed experiments. For the experiments that use p-value or E-value cutoffs, we precomputed the cumulative score distributions and stored them on file. <italic>mdc </italic>is the time needed for this task. In Experiment 1 we measured the running time of the Java-program from [13], referred to by <italic>DN00</italic>. We ran <italic>DN00 </italic>with a maximum of 2 GB memory assigned to the Java virtual machine. <italic>DN00 </italic>constructs the suffix tree in main memory and then performs the searches. For a fair comparison, we therefore measured the total running time, and the time for matching the PSSMs (without suffix tree construction). For Experiment 2, we implemented the matrix similarity scoring scheme (MSS) of <italic>MatInspector </italic>and matched the PSSMs against both strands of the DNA sequences with different MSS cutoff values. The MSS of PSSM <italic>M </italic>of length <italic>m </italic>and a sequence <italic>w </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M181" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula><sup><italic>m </italic></sup>is defined as <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M182" name="1471-2105-7-389-i39" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mtext>MSS</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqqGnbqtcqqGtbWucqqGtbWucqGH9aqpdaWcaaqaaiabdohaZjabdogaJnaabmGabaGaem4DaCNaeiilaWIaemyta0eacaGLOaGaayzkaaGaeyOeI0Iaem4CamNaem4yam2aaSbaaSqaaiGbc2gaTjabcMgaPjabc6gaUbqabaGcdaqadiqaaiabd2eanbGaayjkaiaawMcaaaqaaiabdohaZjabdogaJnaaBaaaleaacyGGTbqBcqGGHbqycqGG4baEaeqaaOWaaeWaceaacqWGnbqtaiaawIcacaGLPaaacqGHsislcqWGZbWCcqWGJbWydaWgaaWcbaGagiyBa0MaeiyAaKMaeiOBa4gabeaakmaabmGabaGaemyta0eacaGLOaGaayzkaaaaaaaa@582A@</mml:annotation></mml:semantics></mml:math></inline-formula> and hence given an MSS cutoff value, the threshold <italic>th </italic>is determined as <italic>th </italic>= MSS·(<italic>sc</italic><sub>max</sub>(<italic>M</italic>) - <italic>sc</italic><sub>min</sub>(<italic>M</italic>)) + <italic>sc</italic><sub>min</sub>(<italic>M</italic>). Instead of using the reverse strand we use the reverse complement <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M183" name="1471-2105-7-389-i40" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqdaaqaaiabd2eanbaaaaa@2DE0@</mml:annotation></mml:semantics></mml:math></inline-formula> of the PSSM <italic>M</italic>, defined by <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M184" name="1471-2105-7-389-i40" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqdaaqaaiabd2eanbaaaaa@2DE0@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>i</italic>, <italic>a</italic>) = <italic>M</italic>(<italic>m </italic>- 1 - <italic>i</italic>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M185" name="1471-2105-7-389-i41" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqdaaqaaiabdggaHbaaaaa@2E08@</mml:annotation></mml:semantics></mml:math></inline-formula>) for all <italic>i </italic>∈ [0, <italic>m </italic>- 1] and <italic>a </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M186" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>, where <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M187" name="1471-2105-7-389-i41" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaqdaaqaaiabdggaHbaaaaa@2E08@</mml:annotation></mml:semantics></mml:math></inline-formula> is the Watson Crick complement of nucleotide <italic>a</italic>. This allows to use the same enhanced suffix array for both strands. In Experiment 5 we used a PERL-based wrapper for the <italic>Blimps </italic>program shipped with the BLIMPS distribution to do bulk sequence searches. The overhead for the PERL interpreter call was found to be negligible. For Experiment 6 we used the reduced alphabets given in Figure 8. The last seven rows show which programs were used in which experiment.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Results of Experiments 1–5. </p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center" colspan="5">Experiment 1: 4,034 PSSMs in 20.2 MB protein sequences</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">p-value</td>
              <td align="right"><italic>DN00 </italic>(total time)</td>
              <td align="right"><italic>DN00 </italic>(search)</td>
              <td align="right">
                <italic>LAsearch</italic>
              </td>
              <td align="right"><italic>ESAsearch </italic>+41 sec.</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">10<sup>-10</sup></td>
              <td align="right">65,808</td>
              <td align="right">64,939</td>
              <td align="right">39,839</td>
              <td align="right">41,813</td>
            </tr>
            <tr>
              <td align="center">10<sup>-20</sup></td>
              <td align="right">38,773</td>
              <td align="right">37,706</td>
              <td align="right">23,786</td>
              <td align="right">24,378</td>
            </tr>
            <tr>
              <td align="center">10<sup>-30</sup></td>
              <td align="right">21,449</td>
              <td align="right">20,362</td>
              <td align="right">14,111</td>
              <td align="right">13,084</td>
            </tr>
            <tr>
              <td align="center">10<sup>-40</sup></td>
              <td align="right">9,606</td>
              <td align="right">8,533</td>
              <td align="right">8,067</td>
              <td align="right">5,374</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" colspan="5">Experiment 2: 220 PSSMs in 37.2 MB DNA</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">MSS</td>
              <td align="right" colspan="2">
                <italic>MatInspector</italic>
              </td>
              <td align="right">
                <italic>LAsearch</italic>
              </td>
              <td align="right"><italic>ESAsearch </italic>+32 sec.</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">0.80</td>
              <td align="right" colspan="2">12,773</td>
              <td align="right">3,605</td>
              <td align="right">202</td>
            </tr>
            <tr>
              <td align="center">0.85</td>
              <td align="right" colspan="2">12,567</td>
              <td align="right">3,189</td>
              <td align="right">108</td>
            </tr>
            <tr>
              <td align="center">0.90</td>
              <td align="right" colspan="2">12,487</td>
              <td align="right">2,818</td>
              <td align="right">53</td>
            </tr>
            <tr>
              <td align="center">0.95</td>
              <td align="right" colspan="2">12,445</td>
              <td align="right">2,356</td>
              <td align="right">12</td>
            </tr>
            <tr>
              <td align="center">1.00</td>
              <td align="right" colspan="2">12,429</td>
              <td align="right">885</td>
              <td align="right">1</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" colspan="5">Experiment 3: 11,411 PSSMs in 4.3 MB protein sequences</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">E-value</td>
              <td align="right" colspan="2">
                <italic>FingerPrintScan</italic>
              </td>
              <td align="right">
                <italic>LAsearch</italic>
              </td>
              <td align="right"><italic>ESAsearch </italic>+10.2 sec.</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">10<sup>-10</sup></td>
              <td align="right" colspan="2">4,733</td>
              <td align="right">3,423</td>
              <td align="right">1.244</td>
            </tr>
            <tr>
              <td align="center">10<sup>-20</sup></td>
              <td align="right" colspan="2">4,710</td>
              <td align="right">486</td>
              <td align="right">52</td>
            </tr>
            <tr>
              <td align="center">10<sup>-30</sup></td>
              <td align="right" colspan="2">4,706</td>
              <td align="right">27</td>
              <td align="right">10</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" colspan="5">Experiment 4: 576 PSSMs in 162.9 MB DNA</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">MSS</td>
              <td/>
              <td/>
              <td align="right">
                <italic>LAsearch</italic>
              </td>
              <td align="right"><italic>ESAsearch </italic>+586 sec.</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">0.85</td>
              <td/>
              <td/>
              <td align="right">18,446</td>
              <td align="right">318</td>
            </tr>
            <tr>
              <td align="center">0.90</td>
              <td/>
              <td/>
              <td align="right">16,376</td>
              <td align="right">150</td>
            </tr>
            <tr>
              <td align="center">0.95</td>
              <td/>
              <td/>
              <td align="right">13,764</td>
              <td align="right">50</td>
            </tr>
            <tr>
              <td align="center">1.00</td>
              <td/>
              <td/>
              <td align="right">5,294</td>
              <td align="right">1</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center" colspan="5">Experiment 5: 28,337 PSSMs in 4.3 MB protein sequences</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">raw-<italic>th</italic></td>
              <td align="right" colspan="2">
                <italic>Blimps</italic>
              </td>
              <td align="right">
                <italic>LAsearch</italic>
              </td>
              <td align="right"><italic>ESAsearch </italic>+10.2 sec.</td>
            </tr>
            <tr>
              <td colspan="5">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">945</td>
              <td align="right" colspan="2">271:30:16</td>
              <td align="right">16:03:12</td>
              <td align="right">11:35:58</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Experiment 1: Running times in seconds of the different PSSM searching methods at different levels of stringency, when searching for 4,034 amino acid PSSMs in 59,021 sequences (21.2 MB) from SwissProt. These are the same PSSMs and sequences used in the experiments of [13]. Experiment 2: Running times in seconds of <italic>MatInspector</italic>, <italic>LAsearch</italic>, and <italic>ESAsearch</italic>, when searching 220 PSSMs on both strands of 37.2 MB DNA sequence data at different matrix similarity score (MSS) cutoffs. Experiment 3: Running times in seconds of <italic>FingerPrintScan</italic>, <italic>LAsearch</italic>, and <italic>ESAsearch </italic>when searching all 11,411 PSSMs from the PRINTS database in the RCSB protein data bank (PDB) for different E-values. Experiment 4: Running times in seconds of <italic>LAsearch </italic>and <italic>ESAsearch </italic>when searching 576 PSSMs in H. sapiens chr. 6 at different matrix similarity score (MSS) cutoffs. Experiment 5: Running times in hh:mm:ss of <italic>Blimps</italic>, <italic>LAsearch</italic>, and <italic>ESAsearch </italic>when searching all 28,337 PSSMs from the BLOCKS database in PDB. We used a raw score threshold of 945 as suggested in the <italic>Blimps </italic>documentation for searching large databases. For each experiment, the additional time needed for the construction of the enhanced suffix array is shown in the head of the <italic>ESAsearch </italic>column.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Running times of the LazyDistrib algorithm. </p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center">p-value</td>
              <td align="right">simple DP</td>
              <td align="right">
                <italic>LazyDistrib</italic>
              </td>
              <td align="right">speedup factor</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">10<sup>-10</sup></td>
              <td align="right">1,486</td>
              <td align="right">485.8</td>
              <td align="right">3</td>
            </tr>
            <tr>
              <td align="center">10<sup>-20</sup></td>
              <td align="right">1,486</td>
              <td align="right">92.5</td>
              <td align="right">95</td>
            </tr>
            <tr>
              <td align="center">10<sup>-30</sup></td>
              <td align="right">1,486</td>
              <td align="right">8.9</td>
              <td align="right">166</td>
            </tr>
            <tr>
              <td align="center">10<sup>-40</sup></td>
              <td align="right">1,486</td>
              <td align="right">4.5</td>
              <td align="right">330</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Running times in seconds when computing score thresholds for all 11,411 PSSMs from the PRINTS database (Rel. 38), given different p-values. Running times given in this table are measurements performed with improved versions of the simple DP and <italic>LazyDistrib </italic>algorithms and thus are much lower than the times given in [25].</p>
        </table-wrap-foot>
      </table-wrap>
      <fig position="float" id="F14">
        <label>Figure 14</label>
        <caption>
          <p><bold>Effect of alphabet reduction on the running time of ESAsearch</bold>. Experiment 6: Relative deviations of running time of <italic>ESAsearch </italic>when using reduced alphabets at different levels of stringency. We measured the relative percentage deviation with respect to the running time when using the standard 20 letter amino acid alphabet (= 0%). We searched with 11,411 PSSMs from the PRINTS database (Rel. 38) in the RCSB Protein Data Bank (PDB) with a total sequence length of 4.3 MB. In this example, the maximum performance improvement is achieved for an alphabet of size 4 and a p-value cutoff of <italic>π </italic>= 10<sup>-20</sup>.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-389-14"/>
      </fig>
      <fig position="float" id="F15">
        <label>Figure 15</label>
        <caption>
          <p><bold>Scaling behaviour of ESAsearch</bold>. Experiment 7: Scaling behavior of <italic>ESAsearch </italic>when searching with 576 TRANSFAC PSSMs on subsets of human chromosome 6 of different sizes and with different matrix similarity cutoff values (MSS). The subsets are prefixes of human chromosome 6 of length 2<sup><italic>k </italic></sup>for <italic>k </italic>= 0, 1, 2,..., 7.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-389-15"/>
      </fig>
      <fig position="float" id="F16">
        <label>Figure 16</label>
        <caption>
          <p><bold>Scaling behaviour of LAsearch</bold>. Experiment 7: Scaling behavior of <italic>LAsearch </italic>when searching with 576 TRANSFAC PSSMs on subsets of human chromosome 6 of different sizes and with different matrix similarity cutoff values (MSS). The subsets are prefixes of human chromosome 6 of length 2<sup><italic>k </italic></sup>for <italic>k </italic>= 0, 1, 2,..., 7.</p>
        </caption>
        <graphic xlink:href="1471-2105-7-389-16"/>
      </fig>
      <sec>
        <title>PoSSuM software distribution</title>
        <p>Our software tool <italic>PoSSuMsearch </italic>implements all algorithms and ideas presented in this work, namely <italic>Simplesearch</italic>, <italic>LAsearch</italic>, <italic>ESAsearch </italic>and <italic>LazyDistrib</italic>. A user can search for PSSMs in enhanced suffix arrays built by mkvtree from the <italic>Vmatch </italic>package, as well as on plain sequence data in FASTA, GENBANK, EMBL, or SWISSPROT format. The search algorithm can be chosen from the command line.</p>
        <p>PSSMs are specified in a simple plain text format, where one file may contain multiple PSSMs. The alphabet a PSSM refers to, and alphabet character to PSSM column assignments can be specified on a per-PSSM basis for most flexible alphabet support. All implemented algorithms support alphabet transformations. PSSMs can contain integer as well as floating point scores. To prevent rounding errors for integer based PSSMs, <italic>PoSSuMsearch </italic>uses integer arithmetics for these, resulting in an additional speedup on most CPU architectures. Searching on the reverse strand of nucleotide sequences is implemented by PSSM transformation according to Watson-Crick base pairing. Hence it is sufficient to build the enhanced suffix array for one strand only. This can then be used to search both strands.</p>
        <p>The cutoff can be specified as p-value, E-value, MSS (matrix similarity score), or raw score threshold. If only the best matches with the highest scores need to be known, then <italic>PoSSuMsearch </italic>can be asked to report only the <italic>k </italic>highest scoring matches without even specifying an explicit cutoff. To do so, the search algorithms dynamically adapt the threshold during the search. When using p- or E-values, the score threshold is determined by either the lazy dynamic programming algorithm introduced in this contribution, or read from file that stores the complete precalculated probability distribution. Background distributions can be specified arbitrarily by the user, or determined from a given sequence database. We provide a tool, <italic>PoSSuMdist</italic>, to generate a compressed file containing the complete precalculated probability distribution for a set of PSSMs.</p>
        <p>PSSM matches can be sorted by specifying a list of sort keys, like p-value, match score, sequence number, and so on. The output formats of <italic>PoSSuMsearch </italic>print out all available information about a match, either in a human readable format, tab delimited, or in machine readable, XML-based CisML [<xref ref-type="bibr" rid="B35">35</xref>]. <italic>PoSSuMsearch </italic>as well as <italic>PoSSuMdist </italic>support multi-threading for a further reduction of running time on multi CPU machines.</p>
        <p>The <italic>PoSSuM </italic>software distribution includes the searching tool <italic>PoSSuMsearch </italic>itself, and additional tools to determine character frequencies from sequence data, for probability distribution calculation, and PSSM format converters for <italic>TRANSFAC</italic>, <italic>BLOCKS</italic>, <italic>PRINTS</italic>, and <italic>EMATRIX </italic>style PSSMs.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Discussion and conclusion</title>
    <p>We have presented a new non-heuristic algorithm for searching with PSSMs, achieving expected sublinear running time. Our analysis of <italic>ESAsearch </italic>shows that for sequences not shorter than |<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M188" name="1471-2105-7-389-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBamrtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaWaaeGaeaaakeaaimaacqWFaeFqaaa@3821@</mml:annotation></mml:semantics></mml:math></inline-formula>|<sup><italic>m </italic></sup>+ <italic>m </italic>- 1 a linear runtime in the worst case is achieved. It shows superior performance over the most widely used programs, especially for DNA sequences. The enhanced suffix array, on which the method is based, requires only 9<italic>n </italic>bytes. This is a space reduction of more than 45 percent compared to the 17<italic>n </italic>bytes implementation of [<xref ref-type="bibr" rid="B13">13</xref>]. Further on, we developed a systematic concept for alphabet reduction, especially useful on amino acid sequences and PSSMs for gaining additional speedup. Our third main contribution is a new algorithm for the efficient calculation of score thresholds from user defined E-values and p-values. The algorithm allows for accurate on-the-fly calculations of thresholds, and has the potential to replace formerly used approximation approaches. Beyond the algorithmic contributions, we provide a robust, well documented, and easy to use software package, implementing the ideas and algorithms presented in this manuscript.</p>
  </sec>
  <sec>
    <title>Availability</title>
    <p>The <italic>PoSSuM </italic>software distribution and its documentation is available precompiled for different operating systems and architectures on [<xref ref-type="bibr" rid="B24">24</xref>]. A version of mkvtree is included. A web based version of <italic>PoSSuMsearch </italic>is available under the same URL.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>M.B. developed the algorithms presented in this manuscript, and wrote significant parts of the manuscript. R.H. implemented the algorithms, created the software distribution, and contributed to the manuscript. M.B. and R.H. wrote the documentation for the software package. R.G. provided supervision and guidance on the project and provided essential infrastructure. S.K. provided supervision, and contributed to the manuscript. All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>The authors thank Sven Rahmann and three anonymous reviewers for comments on the manuscript, Alexander Kel from Biobase GmbH Germany for providing the TRANSFAC PSSMs used in the benchmark experiments, and Jan Krüger for setting up the web interface and integrating <italic>PoSSuMsearch </italic>in our local web-service environment. M.B. and R.H. were supported by the International NRW Graduate School in Bioinformatics and Genome Research.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gribskov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>McLachlan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eisenberg</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Profile Analysis: Detection of Distantly Related Proteins</article-title>
        <source>Proc Nat Acad Sci USA</source>
        <year>1987</year>
        <volume>84</volume>
        <fpage>4355</fpage>
        <lpage>4358</lpage>
        <pub-id pub-id-type="pmid">3474607</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.84.13.4355</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hulo</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sigrist</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Le Saux</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Langendijk-Genevaux</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Bordoli</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gattiker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>De Castro</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bucher</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Recent improvements to the PROSITE database</article-title>
        <source>Nud Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>134</fpage>
        <lpage>137</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh044</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Attwood</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Bradley</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Flower</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Gaulton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Maudling</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mitchell</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Moulton</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Nordle</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Paine</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Uddin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zygouri</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>PRINTS and its automatic supplement, prePRINTS</article-title>
        <source>Nucl Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>400</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="pmid">12520033</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkg030</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henikoff</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Greene</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Pietrokovski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Increased Coverage of Protein Families with the Blocks Database Servers</article-title>
        <source>Nucl Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>228</fpage>
        <lpage>230</lpage>
        <pub-id pub-id-type="pmid">10592233</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.228</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nevill-Manning</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brutlag</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Minimal-risk scoring matrices for sequence analysis</article-title>
        <source>J Comp Biol</source>
        <year>1999</year>
        <volume>6</volume>
        <fpage>219</fpage>
        <lpage>235</lpage>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sandelin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Alkema</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Engstrom</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wasserman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lenhard</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>JASPAR: an open-access database for eukaryotic transcription factor binding profiles</article-title>
        <source>Nucl Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>D91</fpage>
        <lpage>D94</lpage>
        <pub-id pub-id-type="pmid">14681366</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkh012</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matys</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Fricke</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Geffers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gößiling</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Haubrock</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hehl</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hornischer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Karas</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kel</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Kel-Margoulis</surname>
            <given-names>OV</given-names>
          </name>
          <name>
            <surname>Kloos</surname>
            <given-names>DU</given-names>
          </name>
          <name>
            <surname>Land</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lewicki-Potapov</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Michael</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Munch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Reuter</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Rotert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Saxel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Scheer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thiele</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wingender</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>TRANSFAC(R): transcriptional regulation, from patterns to profiles</article-title>
        <source>Nucl Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>374</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="pmid">12520026</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkg108</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scordis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Flower</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Attwood</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>FingerPRINTScan: intelligent searching of the PRINTS motif database</article-title>
        <source>Bioinformatics</source>
        <year>1999</year>
        <volume>15</volume>
        <fpage>799</fpage>
        <lpage>806</lpage>
        <pub-id pub-id-type="pmid">10705433</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/15.10.799</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quandt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Frech</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wingender</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Werner</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MatInd and MatInspector: new fast and versatile tools for detection of consensus matches in nucleotide data</article-title>
        <source>Nucl Acids Res</source>
        <year>1995</year>
        <volume>23</volume>
        <fpage>4878</fpage>
        <lpage>4884</lpage>
        <pub-id pub-id-type="pmid">8532532</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rajasekaran</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Spouge</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The Efficient computation of Position Specific Match Scores with the Fast Fourier Transformation</article-title>
        <source>J Comp Biol</source>
        <year>2002</year>
        <volume>9</volume>
        <fpage>23</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="doi">10.1089/10665270252833172</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freschi</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bogliolo</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Using sequence compression to speedup probabilistic profile matching</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>2225</fpage>
        <lpage>2229</lpage>
        <pub-id pub-id-type="pmid">15713733</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti323</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Nevill-Manning</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brutlag</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Fast Probabilistic Analysis of Sequence Function using Scoring Matrices</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>233</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="pmid">10869016</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/16.3.233</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Dorohonceanu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Nevill-Manning</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Accelerating Protein Classification Using Suffix Trees</article-title>
        <source>Proc of the International Conference on Intelligent Systems for Molecular Biology</source>
        <year>2000</year>
        <publisher-name>Menlo Park, CA: AAAI Press</publisher-name>
        <fpage>128</fpage>
        <lpage>133</lpage>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gonnet</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Some string matching problems from Bioinformatics which still need better solutions</article-title>
        <source>Journal of Discrete Algorithms</source>
        <year>2004</year>
        <volume>2</volume>
        <fpage>3</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1016/S1570-8667(03)00062-5</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tatusov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Altschul</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Koonin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Detection of conserved segments in proteins: Iterative scanning of sequence databases with alignment blocks</article-title>
        <source>Proc Nat Acad Sci USA</source>
        <year>1994</year>
        <volume>91</volume>
        <fpage>12091</fpage>
        <lpage>12095</lpage>
        <pub-id pub-id-type="pmid">7991589</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.91.25.12091</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henikoff</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Henikoff</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Using substitution probabilities to improve position-specific scoring matrices</article-title>
        <source>Bioinformatics</source>
        <year>1996</year>
        <volume>12</volume>
        <fpage>135</fpage>
        <lpage>143</lpage>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gößling</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Reuter</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Cheremushkin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kel-Margoulis</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Wingender</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>MATCH: a tool for searching transcription factor binding sites in DNA sequences</article-title>
        <source>Nucl Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3576</fpage>
        <lpage>3579</lpage>
        <pub-id pub-id-type="pmid">12824369</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkg585</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abouelhoda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ohlebusch</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Replacing Suffix Trees with Enhanced Suffix Arrays</article-title>
        <source>Journal of Discrete Algorithms</source>
        <year>2004</year>
        <volume>2</volume>
        <fpage>53</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1016/S1570-8667(03)00065-0</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Reducing the Space Requirement of Suffix Trees</article-title>
        <source>Software – Practice and Experience</source>
        <year>1999</year>
        <volume>29</volume>
        <fpage>1149</fpage>
        <lpage>1171</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1097-024X(199911)29:13&lt;1149::AID-SPE274&gt;3.0.CO;2-O</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A Comparison of Imperative and Purely Functional Suffix Tree Constructions</article-title>
        <source>Science of Computer Programming</source>
        <year>1995</year>
        <volume>25</volume>
        <fpage>187</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1016/0167-6423(95)00003-8</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Staden</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Methods for calculating the probabilities for finding patterns in sequences</article-title>
        <source>Comp Appl Biosci</source>
        <year>1989</year>
        <volume>5</volume>
        <fpage>89</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="pmid">2720468</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Dynamic programming algorithms for two statistical problems in computational biology</article-title>
        <source>Proc of the 3rd Workshop of Algorithms in Bioinformatics (WABI)</source>
        <year>2003</year>
        <publisher-name>LNCS 2812, Springer Verlag</publisher-name>
        <fpage>151</fpage>
        <lpage>164</lpage>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>On the Power of Profiles for Transcription Factor Binding Site Detection</article-title>
        <source>Statistical Applications in Genetics and Molecular Biology</source>
        <year>2003</year>
        <volume>2</volume>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beckstette</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Homann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>PoSSuM software distribution</article-title>
        <year>2006</year>
        <ext-link ext-link-type="uri" xlink:href="http://bibiserv.techfak.uni-bielefeld.de/possumsearch/"/>
        <pub-id pub-id-type="pmid">16930469</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Beckstette</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Strothmann</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Homann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>PoSSuMsearch: Fast and Sensitive Matching of Position Specific Scoring Matrices using Enhanced Suffix Arrays</article-title>
        <source>Proc of the German Conference on Bioinformatics</source>
        <year>2004</year>
        <volume>P-53</volume>
        <publisher-name>GI Lecture Notes in Informatics</publisher-name>
        <fpage>53</fpage>
        <lpage>64</lpage>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kärkkäinen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Simple Linear Work Suffix Array Construction</article-title>
        <source>Proceedings of the 13th International Conference on Automata, Languages and Programming</source>
        <year>2003</year>
        <publisher-name>Springer</publisher-name>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kasai</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Arimura</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Arikawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Linear-time Longest-Common-Prefix Computation in Suffix Arrays and its Applications</article-title>
        <source>12th Annual Symposium on Combinatorial Pattern Matching (CPM2001)</source>
        <year>2001</year>
        <volume>2089</volume>
        <publisher-name>Springer-Verlag, New York: Lecture Notes in Computer Science</publisher-name>
        <fpage>181</fpage>
        <lpage>192</lpage>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Bruijn</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A Combinatorial Problem</article-title>
        <source>Koninklijke Nederlands Akademie van Wetenschappen Proceedings</source>
        <year>1946</year>
        <volume>49</volume>
        <fpage>758</fpage>
        <lpage>764</lpage>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Reduction of protein sequence complexity by residue grouping</article-title>
        <source>Protein Engineering</source>
        <year>2003</year>
        <volume>16</volume>
        <fpage>323</fpage>
        <lpage>330</lpage>
        <pub-id pub-id-type="pmid">12826723</pub-id>
        <pub-id pub-id-type="doi">10.1093/protein/gzg044</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murphy</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Wallqvist</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Simplified amino acid alphabets for protein fold recognition and implications for folding</article-title>
        <source>Protein Engineering</source>
        <year>2000</year>
        <volume>13</volume>
        <fpage>149</fpage>
        <lpage>152</lpage>
        <pub-id pub-id-type="pmid">10775656</pub-id>
        <pub-id pub-id-type="doi">10.1093/protein/13.3.149</pub-id>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Castillo</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Extreme Value Theory in Engineering</source>
        <year>1988</year>
        <publisher-name>Academic Press</publisher-name>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Embrechts</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Klüppelberg</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mikosch</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>Modelling Extremal Events</source>
        <year>1997</year>
        <publisher-name>Springer</publisher-name>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Approximations to profile score distributions</article-title>
        <source>J Comp Biol</source>
        <year>1994</year>
        <volume>1</volume>
        <fpage>93</fpage>
        <lpage>104</lpage>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>The Vmatch large scale sequence analysis software</article-title>
        <year>2005</year>
        <ext-link ext-link-type="uri" xlink:href="http://www.vmatch.de/"/>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haverty</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>CisML: an XML-based format for sequence motif detection software</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>1815</fpage>
        <lpage>1817</lpage>
        <pub-id pub-id-type="pmid">15001475</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth162</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weeks</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Eskandari</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Scott</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sachs</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>A H+-gated urea channel: the link between Helicobacter pylori urease and gastric colonization</article-title>
        <source>Science</source>
        <year>2000</year>
        <volume>287</volume>
        <fpage>482</fpage>
        <lpage>485</lpage>
        <pub-id pub-id-type="pmid">10642549</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.287.5452.482</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
