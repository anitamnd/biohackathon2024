<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Metabolites</journal-id>
    <journal-id journal-id-type="iso-abbrev">Metabolites</journal-id>
    <journal-id journal-id-type="publisher-id">metabolites</journal-id>
    <journal-title-group>
      <journal-title>Metabolites</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2218-1989</issn>
    <publisher>
      <publisher-name>MDPI</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7916825</article-id>
    <article-id pub-id-type="pmid">33670102</article-id>
    <article-id pub-id-type="doi">10.3390/metabo11020103</article-id>
    <article-id pub-id-type="publisher-id">metabolites-11-00103</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Ranking Metabolite Sets by Their Activity Levels</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-9841-4943</contrib-id>
        <name>
          <surname>McLuskey</surname>
          <given-names>Karen</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-11-00103">1</xref>
        <xref ref-type="author-notes" rid="fn1-metabolites-11-00103">†</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3068-4664</contrib-id>
        <name>
          <surname>Wandy</surname>
          <given-names>Joe</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-11-00103">1</xref>
        <xref ref-type="author-notes" rid="fn1-metabolites-11-00103">†</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-2663-4389</contrib-id>
        <name>
          <surname>Vincent</surname>
          <given-names>Isabel</given-names>
        </name>
        <xref ref-type="aff" rid="af2-metabolites-11-00103">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-9340-5511</contrib-id>
        <name>
          <surname>van der Hooft</surname>
          <given-names>Justin J. J.</given-names>
        </name>
        <xref ref-type="aff" rid="af3-metabolites-11-00103">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-3578-4477</contrib-id>
        <name>
          <surname>Rogers</surname>
          <given-names>Simon</given-names>
        </name>
        <xref ref-type="aff" rid="af4-metabolites-11-00103">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-0881-715X</contrib-id>
        <name>
          <surname>Burgess</surname>
          <given-names>Karl</given-names>
        </name>
        <xref ref-type="aff" rid="af5-metabolites-11-00103">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-1275-6820</contrib-id>
        <name>
          <surname>Daly</surname>
          <given-names>Rónán</given-names>
        </name>
        <xref ref-type="aff" rid="af1-metabolites-11-00103">1</xref>
        <xref rid="c1-metabolites-11-00103" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Meikle</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <aff id="af1-metabolites-11-00103"><label>1</label>Glasgow Polyomics, University of Glasgow, Glasgow G61 1QH, UK; <email>karen.mcluskey@glasgow.ac.uk</email> (K.M.); <email>joe.wandy@glasgow.ac.uk</email> (J.W.)</aff>
    <aff id="af2-metabolites-11-00103"><label>2</label>IBioIC, Strathclyde Institute of Pharmacy and Biomedical Sciences, University of Strathclyde, Glasgow G1 1XQ, UK; <email>isabel.vincent@glasgow.ac.uk</email></aff>
    <aff id="af3-metabolites-11-00103"><label>3</label>Bioinformatics Group, Wageningen University, 6708 PB Wageningen, The Netherlands; <email>justin.vanderhooft@wur.nl</email></aff>
    <aff id="af4-metabolites-11-00103"><label>4</label>School of Computing Science, University of Glasgow, Glasgow G12 8QQ, UK; <email>simon.rogers@glasgow.ac.uk</email></aff>
    <aff id="af5-metabolites-11-00103"><label>5</label>Centre for Synthetic and Systems Biology, School of Biological Sciences, University of Edinburgh, Edinburgh EH9 3JG, UK; <email>Karl.Burgess@ed.ac.uk</email></aff>
    <author-notes>
      <corresp id="c1-metabolites-11-00103"><label>*</label>Correspondence: <email>ronan.daly@glasgow.ac.uk</email></corresp>
      <fn id="fn1-metabolites-11-00103">
        <label>†</label>
        <p>These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <volume>11</volume>
    <issue>2</issue>
    <elocation-id>103</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>2</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 by the authors.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="open-access">
        <license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Related metabolites can be grouped into sets in many ways, e.g., by their participation in series of chemical reactions (forming metabolic pathways), or based on fragmentation spectral similarities or shared chemical substructures. Understanding how such metabolite sets change in relation to experimental factors can be incredibly useful in the interpretation and understanding of complex metabolomics data sets. However, many of the available tools that are used to perform this analysis are not entirely suitable for the analysis of untargeted metabolomics measurements. Here, we present PALS (Pathway Activity Level Scoring), a Python library, command line tool, and Web application that performs the ranking of significantly changing metabolite sets over different experimental conditions. The main algorithm in PALS is based on the pathway level analysis of gene expression (PLAGE) factorisation method and is denoted as mPLAGE (PLAGE for metabolomics). As an example of an application, PALS is used to analyse metabolites grouped as metabolic pathways and by shared tandem mass spectrometry fragmentation patterns. A comparison of mPLAGE with two other commonly used methods (overrepresentation analysis (ORA) and gene set enrichment analysis (GSEA)) is also given and reveals that mPLAGE is more robust to missing features and noisy data than the alternatives. As further examples, PALS is also applied to human African trypanosomiasis, Rhamnaceae, and American Gut Project data. In addition, normalisation can have a significant impact on pathway analysis results, and PALS offers a framework to further investigate this. PALS is freely available from our project Web site.</p>
    </abstract>
    <kwd-group>
      <kwd>liquid chromatography–mass spectrometry (LC/MS)</kwd>
      <kwd>pathways</kwd>
      <kwd>molecular family</kwd>
      <kwd>Mass2Motif</kwd>
      <kwd>SVD</kwd>
      <kwd>matrix decomposition</kwd>
      <kwd>metabolite sets</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1-metabolites-11-00103">
    <title>1. Introduction</title>
    <p>An organism’s metabolism is comprised of all of the chemical reactions involved in its cells; the small-molecule intermediates and products of these reactions are known as metabolites. Untargeted metabolomics provides a profile of all detectable metabolites in a system, allowing the unique chemical fingerprint left behind by the metabolism to be investigated. Such studies are imperative in understanding changes in biological mechanisms related to environmental and genetic variations. Mass spectrometry (MS) is one of the most commonly used techniques for untargeted metabolomics and is often coupled with chromatographic separation using liquid chromatography (LC). Experimental data from a typical LC–MS experimental sample are a series of spectra, where signal intensities are generated for each detected ion. After data preprocessing, a table of chromatographic peaks is produced; each peak can be represented by its mass-to-charge ratio (m/z), retention time (RT), and intensity values. Peaks with a similar m/z and RT can then be grouped across samples into features, which leads to a matrix of peak intensities, indexed by features along the rows and samples as the columns. Identification is performed to associate features with metabolite identities, either by matching the m/z and RT of features with internal library standards or through fragmentation spectra comparisons against mass spectral databases.</p>
    <p>In a cell or organism, metabolites seldom work alone. As result, it it often useful to analyse related groups of metabolites rather than considering individual metabolites in isolation. One way to define metabolite sets is through prior knowledge of how metabolites participate in a series of related chemical reactions, or metabolic pathways. Ranking biologically relevant pathways through changes in the intensities of associated features provides high-level information that helps prioritise relevant pathways [<xref rid="B1-metabolites-11-00103" ref-type="bibr">1</xref>]. An alternative way of producing metabolite sets is to to group features using spectral similarities, which can be incredibly useful for helping to identify unknown features. By exploiting the fragmentation spectra from tandem mass spectrometry, molecular networking [<xref rid="B2-metabolites-11-00103" ref-type="bibr">2</xref>] uses such spectral similarities to group metabolites into molecular families (MF). These MFs potentially correspond to chemical classes and have proved invaluable in enhancing the putative identifications of unknown metabolites [<xref rid="B3-metabolites-11-00103" ref-type="bibr">3</xref>,<xref rid="B4-metabolites-11-00103" ref-type="bibr">4</xref>]. Using tandem MS (MS2) and an algorithm originally used for text mining, latent Dirichlet allocation (LDA), MS2LDA [<xref rid="B5-metabolites-11-00103" ref-type="bibr">5</xref>] features are grouped by co-occurring fragments and neutral losses into Mass2Motifs that reveal potentially related chemical substructures.</p>
    <p>In recent years, enrichment analysis algorithms, originally developed for analysing large collections of genes or transcripts, have been adapted to metabolomics. These methods were traditionally used to test gene expression data for functions or processes that are overrepresented (i.e., enriched) with regard to functional gene sets, pathways, and networks. Considering differentially expressed (DE) gene sets, two of the most commonly used types of gene enrichment techniques are overrepresentation analysis (ORA) and functional class scoring (FCS). ORA approaches rely on testing for the presence or absence of significantly changing genes in a pathway, using statistical significance tests. FCS methods, which include gene set enrichment analysis (GSEA) [<xref rid="B6-metabolites-11-00103" ref-type="bibr">6</xref>] use statistical approaches to identify gene sets that are significantly enriched or depleted in the pathway. FCS improves upon ORA by eliminating the need to preselect significantly changing genes, as well as taking into account how groups of genes can be coexpressed together (instead of assuming they are independent, as in ORA). One such FCS method is pathway level analysis of gene expression (PLAGE) [<xref rid="B7-metabolites-11-00103" ref-type="bibr">7</xref>], which performs singular value decomposition (SVD) to compute an activity value from expression data in a sample. This has advantages over other methods in that it is computationally simple while returning high performance in both sensitivity and specificity [<xref rid="B8-metabolites-11-00103" ref-type="bibr">8</xref>]. In addition, the PLAGE method does not discriminate between upward or downward activity, meaning that both increases and decreases in gene expression contribute to the activity of a pathway.</p>
    <p>The nature of metabolomics data can make enrichment analysis for metabolite groups more challenging than for groups of genes. In particular, an untargeted metabolomics experiment contains a large diversity of chemical structures with the identity of many of the features unknown in mass spectral databases. In addition, there is uncertainty in annotating an MS feature, as a single compound can be matched to multiple features and vice versa even at a high mass accuracy of 1 ppm [<xref rid="B9-metabolites-11-00103" ref-type="bibr">9</xref>]. Other more general omics issues, such as missing data, also influence metabolite pathway reconstruction from metabolomics data. Finally, being the endpoint of the omics cascade, metabolite signals within a pathway may fluctuate or, as a result of a dead-end metabolic reaction, different features may change in opposite directions. As demonstrated in our previous work [<xref rid="B5-metabolites-11-00103" ref-type="bibr">5</xref>] where the PLAGE method was successfully applied to the enrichment analysis of Mass2Motifs, decomposing activity levels via SVD appeared to work well on metabolomics data where noise and missing data are prevalent. However, no comparisons were made in [<xref rid="B5-metabolites-11-00103" ref-type="bibr">5</xref>] to assess the performance and robustness of PLAGE against the alternatives, or to produce a general tool that could be used by the metabolomics community to assess the activity level of metabolite sets, including pathways. While a variety of tools that encompass enrichment analysis of pathways have been developed, many are Web-based [<xref rid="B10-metabolites-11-00103" ref-type="bibr">10</xref>,<xref rid="B11-metabolites-11-00103" ref-type="bibr">11</xref>,<xref rid="B12-metabolites-11-00103" ref-type="bibr">12</xref>] or implemented in the R programming language [<xref rid="B13-metabolites-11-00103" ref-type="bibr">13</xref>,<xref rid="B14-metabolites-11-00103" ref-type="bibr">14</xref>,<xref rid="B15-metabolites-11-00103" ref-type="bibr">15</xref>,<xref rid="B16-metabolites-11-00103" ref-type="bibr">16</xref>]. A comprehensive metabolite set analysis that can be easily integrated into Python-based workflows and applications remains rare.</p>
    <p>In this manuscript, we introduce Pathway Activity Level Scoring (PALS), a comprehensive and modular Python tool for metabolite set enrichment. PALS is designed to look at how metabolic pathways or other groups of metabolites change between different experimental conditions. It achieves this by decomposing peak intensities into latent factors corresponding to observed metabolic changes (activities). Our adaptation of the PLAGE method, denoted as mPLAGE (PLAGE for metabolomics), was independently implemented in Python for use in metabolomics. Using mPLAGE, small correlated changes in a group of metabolites are rated as more interesting than large changes in an individual metabolite, where other metabolites in the set are not changing. The changes are increases and/or decreases in feature intensities, but must occur as part of the group. This is particularly important in situations where enzyme inhibition results in substantial increases to metabolite abundance before a lesion in a pathway, with concomitant decreases after the lesion (see [<xref rid="B17-metabolites-11-00103" ref-type="bibr">17</xref>] for an example). The modularity of PALS also means it is not limited to pathways, and any user-defined grouping of features (representing metabolite sets) can be readily analysed. This is demonstrated by assessing the activity levels of metabolite sets grouped by similarity of fragmentation spectra. The robustness of mPLAGE was evaluated on both synthetic and real data experiments and compared to both ORA and GSEA methods. The results demonstrated that the mPLAGE method is robust to noise and missing values, which is particularly important for metabolomics data. PALS is freely available at <ext-link ext-link-type="uri" xlink:href="https://pals.glasgowcompbio.org">https://pals.glasgowcompbio.org/</ext-link> (accessed on 5 February 2021) [<xref rid="B18-metabolites-11-00103" ref-type="bibr">18</xref>]. It can be easily imported as a Python library, run as a standalone tool or used as a Web application.</p>
  </sec>
  <sec sec-type="results" id="sec2-metabolites-11-00103">
    <title>2. Results and Discussion</title>
    <sec id="sec2dot1-metabolites-11-00103">
      <title>2.1. Synthetic Data Experiments</title>
      <sec id="sec2dot1dot1-metabolites-11-00103">
        <title>2.1.1. Synthetic Data Setup</title>
        <p>To assess the robustness of mPLAGE, benchmarking experiments were performed. Initially, these experiments were performed using synthetic data, as the ground-truth of untargeted metabolomics experiments can be hard to define. In this section, pathways are described for simplicity, but this procedure could be applied to any set of metabolites. Seven synthetic pathways were constructed with significant changes (showing clear block structures between the case and control groups in their peak intensity matrix) between two experimental conditions, each consisting of four samples. To mimic the inclusion of formulae that arise due to incorrect identification/annotation, decoy features were generated using a normal distribution (<xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Section S3</xref>) and standardised for input (<xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Section S1</xref>).</p>
        <p>Each of the seven pathways contained a different number of formulae, and each pathway was named according to the number of features associated with it for clarity, i.e., pathway names for numbers of features were: Two; Four; Six; Ten; Twenty; Forty; and Eighty. A one-to-one relationship between an observed feature and a metabolite was assumed. In addition, 100 background pathways, where each pathway contains between 5 to 50 metabolites that show no significant changes between the case and control groups, were generated and added to the synthetic data set. To simulate missing features, which often occurs in real metabolomics data, features were also randomly removed from pathways with a uniform probability of 0.2. The performance of mPLAGE was compared to widely used overrepresentation (ORA) analysis and gene set enrichment analysis (GSEA) methods (described further in <xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Section S4</xref>). These alternative methods, used for benchmarking experiments, are included in the PALS Python library, allowing all methods to be compared utilising the same database query codes and retrieving identical pathways from KEGG and Reactome.</p>
      </sec>
      <sec id="sec2dot1dot2-metabolites-11-00103">
        <title>2.1.2. Evaluation</title>
        <p>The following evaluation metrics were implemented to assess the performance of the different methods. Let <italic>T</italic> = {Two, Four, Six, Ten, Twenty, Forty, Eighty} be the set of true answers (the labels of seven pathways with the corresponding number of features that are actually changing). Each pathway analysis method <italic>m</italic> will return <inline-formula><mml:math id="mm1"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, a ranking of significantly changing pathways under some threshold <inline-formula><mml:math id="mm2"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula> (set to 0.05 following convention), where pathways with <italic>p</italic>-values below <inline-formula><mml:math id="mm3"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:math></inline-formula> are considered significant (positives).</p>
        <p>For a method <italic>m</italic>, the following counts can now be evaluated: True Positives (TP) = in <inline-formula><mml:math id="mm4"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and in <italic>T</italic>; False Positives (FP) = in <inline-formula><mml:math id="mm5"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> but not in <italic>T</italic>; False Negatives (FN): in <italic>T</italic> but not in <inline-formula><mml:math id="mm6"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. To obtain single-number summaries, precision and recall are used. Here, precision (<inline-formula><mml:math id="mm7"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) measures pathway ranking relevancy and it often occurs as a trade-off to recall (<inline-formula><mml:math id="mm8"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:mo>+</mml:mo><mml:mi>F</mml:mi><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), which measures how many actual relevant changing pathways are returned. High precision suggests that a method has a low false positive rate, while a high recall suggests that the method has a low false negative rate. To summarise overall performance, the <inline-formula><mml:math id="mm9"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> score, which is a harmonic mean of precision and recall and defined as <inline-formula><mml:math id="mm10"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>∗</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo>∗</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, is used.</p>
      </sec>
      <sec id="sec2dot1dot3-metabolites-11-00103">
        <title>2.1.3. Synthetic Experiment Results—Increasing the Number of Decoy Features</title>
        <p>In this experiment, an increasing number of decoy features were added to the seven pathways comprised of significantly changing features. This scenario reflects the case of attempting to find pathways, or sets of metabolites, with high activity levels when the number of significantly changing metabolites are small compared to noisy data, nonchanging or wrongly annotated metabolites. The level of decoy features are defined in an increasing order of severity from 0%, 25%, 50%, 100%, 250%, 500%, and 1000% of the original number of features in the pathway. For example, adding 50% decoy features to pathway Forty results in the 40 significantly changing features and the addition of 20 new decoy (nonchanging) features in the pathway. The resulting synthetic data matrix with the addition of decoy features is then used as input to the methods being compared. This procedure is repeated 500 times for each level of decoy features.</p>
        <p>Assessing changes to the <italic>p</italic>-values of the true changing pathways with higher number of decoy features reveals that increasing the number of decoy features generally produces higher <italic>p</italic>-values (<xref ref-type="fig" rid="metabolites-11-00103-f001">Figure 1</xref>). This suggests that it becomes harder for pathways to be identified as significantly changing when a greater number of decoy features are present. At level 0% (where no additional decoy features are present), both ORA and mPLAGE perform well, returning median <italic>p</italic>-values of <inline-formula><mml:math id="mm11"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and 0.0049, respectively. GSEA performs less well with median <italic>p</italic>-value of 0.0578, which is close to the selected significant threshold of 0.05 (shown as dotted line in <xref ref-type="fig" rid="metabolites-11-00103-f001">Figure 1</xref>). The mean <italic>p</italic>-values from all methods increase as the number of decoy features is increased. At level 100%, both ORA and mPLAGE perform well even when there are as many decoy features as there are actually changing features, returning median <italic>p</italic>-values of 0.0083 and 0.0003 for mPLAGE and ORA, respectively. At higher levels (250%, 500%, and 1000%), GSEA appears most sensitive to the perturbation, while mPLAGE performs best amongst the methods compared.</p>
        <p>Inspection of individual significant pathways of varying sizes (<xref ref-type="fig" rid="metabolites-11-00103-f002">Figure 2</xref>) revealed that the mean <italic>p</italic>-values returned by all methods generally decreases with an increasing number of changing features in a pathway. This suggests that the greater the number of metabolites that are changing together, the higher ranked that pathway would be. As a result of the small number of metabolites in the pathway, all methods struggle to correctly identify pathways Two and Four as significantly changing at any level of added decoy features and generally perform better on the larger pathways Twenty, Forty, and Eighty. This reveals that the larger the number of changing features identified in a pathway (or metabolite set), the more tolerant the method is to nonchanging (random) features.</p>
        <p>For all pathways across all levels of added decoy features, mPLAGE returns lower <italic>p</italic>-values compared to ORA and GSEA, which means that more significantly changing metabolite sets can be detected. This is similar to findings reported by Evangelou et al. [<xref rid="B19-metabolites-11-00103" ref-type="bibr">19</xref>] that compare methods for competitive tests for pathway analysis of gene sets and found that the power of all tested methods increased with the size of the pathway. Finally, <inline-formula><mml:math id="mm12"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> score performance was evaluated. This summarises overall retrieval ability, taking into account the number of true positives, false positives, and false negatives of the methods being tested. Using this metric, it could be seen that the performance of ORA and mPLAGE were roughly similar using 0–100% levels of non-changing features (<xref ref-type="fig" rid="metabolites-11-00103-f003">Figure 3</xref>). At higher levels of added decoy features of 250%, 500%, and 1000%, the <inline-formula><mml:math id="mm13"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> scores of mPLAGE were consistently higher than ORA and GSEA. These results showed that a greater number of true positive pathways could be identified with mPLAGE than with ORA or GSEA. GSEA performed worst among the three methods tested, particularly showing its sensitivity to nonchanging or decoy features.</p>
      </sec>
      <sec id="sec2dot1dot4-metabolites-11-00103">
        <title>2.1.4. Synthetic Experiment Results—Increasing Missing Features</title>
        <p>Additionally, the effect of introducing an increasing number of missing features from the pathways was explored. For this experiment, the level of decoy features was fixed to 100% in order to allow for an equal number of changing and nonchanging features. The percentage of features randomly missing from the data was indicated by <italic>p</italic>, and this value was varied from 20%, 40%, 60%, and 80% of the full data set. The different pathway ranking methods were run 500 times for each data set with each having a different value of <italic>p</italic>. The results in <xref ref-type="fig" rid="metabolites-11-00103-f004">Figure 4</xref> show that as the number of missing features increases, mPLAGE consistently returns lower mean <italic>p</italic>-values with smaller variances than ORA or GSEA. This suggests that mPLAGE is generally more robust to missing features than the alternative methods tested. These results were also supported by the <inline-formula><mml:math id="mm14"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> score performance (<xref ref-type="fig" rid="metabolites-11-00103-f005">Figure 5</xref>), where mPLAGE generally performed best even when large numbers of features were missing from the data.</p>
      </sec>
    </sec>
    <sec id="sec2dot2-metabolites-11-00103">
      <title>2.2. Real Data Experiments</title>
      <p>To evaluate the performance of the proposed method on actual complex biological data, PALS was used to analyse metabolomics data obtained from a study on human African trypanosomiasis (HAT) introduced in [<xref rid="B20-metabolites-11-00103" ref-type="bibr">20</xref>]. The causative agent of HAT is the parasite <italic>Trypanosoma brucei</italic>, which is transmitted to a human/mammalian host by the bite of the tsetse fly. Two data sets of samples collected from human blood plasma and cerebrospinal fluid (CSF) are available from the study, denoted as the Plasma and CSF (cerebrospinal fluid) data sets, respectively. The control group consists of parasite-free patients, while the two case groups are those with stage 1 (S1, parasites present in blood/lymphatics) or stage 2 (S2, parasites found in the CSF) trypanosomiasis.</p>
      <sec id="sec2dot2dot1-metabolites-11-00103">
        <title>2.2.1. Case Study</title>
        <p>Using the HAT data with PALS allows for complex clinical data to be explored and demonstrates how PALS can be used to draw relevant biological conclusions. The Plasma and CSF data sets from the HAT study, comprising of 20/17 control (C) samples and 20 samples from both S1 and S2, respectively, were uploaded and processed through the Polyomics Integrated Metabolomics pipeline (PiMP) [<xref rid="B21-metabolites-11-00103" ref-type="bibr">21</xref>]. PALS was easily integrated into PiMP and set to run automatically at the end of a data analysis workflow. PALS results from the HAT data revealed that a greater number of significantly changing pathways (<italic>p</italic>-value &lt; 0.05) were found between the disease stages for the CSF than Plasma data (52/74, 42/128, and 42/143 for Plasma/CSF when comparing S1:C, S2:C, and S1:S2, respectively). In all of the comparisons, CSF samples have a greater number of changing pathways than those seen in the Plasma data. In particular, there is a notable difference in the changing pathways between the S1:C and S2:C/S1:S2 in the CSF. This can be explained by the fact that the parasites are only present in the CSF in S2 parasitemia and consequently more metabolic changes are expected in the CSF from S2 patients.</p>
        <p>Looking at metabolic differences between S1 and S2 samples, the top-ranking PALS pathways in the CSF were heavily biased towards amino-acid metabolism (<xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Table S5</xref>). Changes in these pathways make sense for two reasons: firstly, because all parasites scavenge nutrients from their hosts and <italic>T. brucei</italic> is predicted to be auxotrophic for the amino acids arginine, glycine, histidine, isoleucine, leucine, lysine, phenylalanine, tryptophan, tyrosine, and valine [<xref rid="B22-metabolites-11-00103" ref-type="bibr">22</xref>], and secondly because it is unlikely that parasites will be present in the CSF of patients with a S1 infection. To support this finding, individual amino acids identified in the experiment were examined, and it was revealed that all of the amino acids required by <italic>T. brucei</italic> (listed above) (excluding glycine, which was undetected) were found to be decreasing in the CSF of patients with S2 of the disease (<xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Table S6</xref>). Interestingly, running the Plasma data through PALS did not show any bias towards amino acid metabolism, suggesting that the parasites potentially have a much more marked effect on the amino acid biosynthesis and availability on their host when it reaches the CSF.</p>
        <p>It is known that when <italic>T. brucei</italic> reside in the human bloodstream, they are exposed to high levels of glucose, which they rely on for their energy metabolism [<xref rid="B23-metabolites-11-00103" ref-type="bibr">23</xref>]. This reliance on glucose changes when the parasites are resident in the insect midgut, as they have a less readily available supply of glucose, and instead switch to amino acids as their main carbon source [<xref rid="B24-metabolites-11-00103" ref-type="bibr">24</xref>]. Little is known about the metabolism of the parasites in the CSF, so it may be possible that amino acid usage is required to supplement the lower levels of glucose in the CSF (4.5 mM and 3 mM in Plasma and CSF, respectively [<xref rid="B25-metabolites-11-00103" ref-type="bibr">25</xref>]). Another reason that uptake of amino acids is evident in the CSF samples but not in the Plasma samples could be a result of amino acid concentrations being much lower in the CSF (4–50-fold lower for the nine amino acids than <italic>T. brucei</italic> are auxotrophic for [<xref rid="B25-metabolites-11-00103" ref-type="bibr">25</xref>]), and consequent salvaging of the nutrients by the parasites is more noticeable in the CSF.</p>
      </sec>
      <sec id="sec2dot2dot2-metabolites-11-00103">
        <title>2.2.2. Real Data Experimental Setup</title>
        <p>The HAT case study results demonstrate how the mPLAGE method in PALS identified significantly changing pathways that can be explained and interpreted as biologically relevant. In this section, the robustness of the different pathway ranking methods on this data is assessed. In a manner similar to the synthetic experiment, a range of missing feature proportions <italic>p</italic> was set from 20% to 80%.</p>
        <p>After processing in PiMP, the complete Plasma and CSF data produced 15,584 and 8154 features, of which 1647 and 1132 had associated metabolite annotations, respectively. Therefore, <italic>p</italic> times the total number of features were randomly removed, and the rest were used as input for pathway analysis. Assuming that a particular pathway ranking <inline-formula><mml:math id="mm15"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> returned by a method <italic>m</italic> on the complete data will be better than the ones obtained from the reduced data (with missing features), results from the complete data could be used as the true answers for evaluation. Here, true answers <italic>T</italic> are restricted to be the set of significant pathways above a threshold of 0.05 for their mPLAGE and ORA <italic>p</italic>-values, and a larger threshold of 0.25 for GSEA (following the suggestion in [<xref rid="B6-metabolites-11-00103" ref-type="bibr">6</xref>]).</p>
        <p>Given <italic>T</italic> and <inline-formula><mml:math id="mm16"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, performance in terms of precision, recall, and <inline-formula><mml:math id="mm17"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> score can be computed as described in <xref ref-type="sec" rid="sec2dot1dot2-metabolites-11-00103">Section 2.1.2</xref>. This evaluation procedure was repeated 500 times. Comparisons were performed between the Stage1/Control groups on the Plasma data and between the Stage2/Control groups on the CSF data, where more changing pathways are expected to be found in the data set between the case and control groups as the disease progresses. The results are reported in <xref ref-type="sec" rid="sec2dot2dot3-metabolites-11-00103">Section 2.2.3</xref>.</p>
      </sec>
      <sec id="sec2dot2dot3-metabolites-11-00103">
        <title>2.2.3. Robustness on Real Data</title>
        <p>For all methods, it can be noted that the <inline-formula><mml:math id="mm18"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> score decreases as the proportion of missing features increase (<xref ref-type="fig" rid="metabolites-11-00103-f006">Figure 6</xref>). This suggests that it becomes harder for all tested methods to reconstruct the original pathway ranking results obtained from the full data when fewer input features are available. On both the Plasma and CSF data, the pathway decomposition in mPLAGE performs best, demonstrating the most robust tolerance to missing features, followed by ORA. In both data sets, GSEA performs worst as a result of its sensitivity to noise. The results obtained for GSEA on the HAT data agree with those obtained for the synthetic data experiment.</p>
        <p>At the highest proportion of missing features (80%) with the Plasma data, mPLAGE achieves a mean <inline-formula><mml:math id="mm19"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> score of 0.48, while ORA and GSEA obtain scores of 0.20 and 0.08, respectively (<xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Table S7</xref>). Similarly, on the CSF data, mPLAGE achieves an <inline-formula><mml:math id="mm20"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> score of 0.60 while ORA and GSEA obtain 0.50 and 0.16, respectively. ORA, on average, returns higher mean precision values among the benchmarked methods, but the better <inline-formula><mml:math id="mm21"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> score of mPLAGE can be attributed to its generally superior recall performance while still offering competitive precision in comparison to ORA. The results here suggest that even when there are many missing features, mPLAGE is able to recover more original pathways in the full data using a small fraction of the features present in the original peak data, returning a higher number of true positives and fewer false positives and false negatives.</p>
      </sec>
    </sec>
    <sec id="sec2dot3-metabolites-11-00103">
      <title>2.3. Analysis of Metabolite Sets: Molecular Families and Mass2Motifs</title>
      <p>To demonstrate the analysis of other types of metabolite sets, PALS was used to assess the activity levels of potentially unknown metabolites grouped into molecular families (MFs) through their fragmentation spectral similarities, and into Mass2Motifs based on shared fragment and neutral loss features.</p>
      <p>For the MF analysis, Global Natural Products Social Molecular Networking (GNPS) example data were taken from the American Gut Project [<xref rid="B26-metabolites-11-00103" ref-type="bibr">26</xref>]. From this, a subset of data was chosen from volunteers who had consumed different amounts of plant-based food. In this study, 35 significantly changing MFs (<italic>p</italic>-value ≤ 0.05) containing 10 or more molecules were found between the case (eating &gt;30 plant-based foods a week) and control (&lt;10 plant-based foods a week) groups. Of particular interest is one significantly changing MF (<italic>p</italic>-value ≤ 0.001) that was identified by PALS, consisting of 23 molecules that have steroid-related GNPS library hits. The intensities of the associated MS peaks in this steroid-related MF were found to be higher in the control group (for more details, see <xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Section S8</xref>), which could be a result of the abundance of steroids in meat, fish, and eggs in their diet. Most other significant MFs did not contain GNPS library hits but could represent potentially novel chemical classes.</p>
      <p>To anaylse Mass2Motifs, a data set from the GNPS-MS2LDA workflow, consisting of 70 Rhamnacea species from two clades and various genera, was used [<xref rid="B4-metabolites-11-00103" ref-type="bibr">4</xref>]. In the original study, 25 Mass2Motifs were manually characterized and their distribution over the Rhamnaceae clades examined. The statistical significance of the results were easily obtained using PALS, whereas all previous efforts relied on manual interpretation.</p>
      <p>Consistent with [<xref rid="B4-metabolites-11-00103" ref-type="bibr">4</xref>], PALS revealed that Mass2Motifs annotated with flavonoid-related substructures (i.e., rhamnocitrin, kaemfperol, flavonoid core framgent, and emodin) are all differently expressed between the <italic>Rhamnus</italic> and <italic>Ziziphus</italic> genera with features generally overrepresented in <italic>Rhamnus</italic> (for more details, see <xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Section S9</xref>). Similarly, the substructure set containing cyclopeptidic alkaloids was found to be overrepresented in <italic>Ziziphus</italic>. Differential metabolite sets for other genera could also be easily examined using PALS (for example, the Xylose or Arabinose moiety substructure was found to be differentially expressed between <italic>Ventilago</italic> and <italic>Rhamnus</italic>).</p>
      <p>Finally, looking at Mass2Motifs in the American Gut Project data, 11 significant Mass2Motifs were prioritised using PALS, with one DE Mass2Motif being more abundant in “plant-eaters” and annotated as related to ferulic acid (12 members)—a molecule that is typically found in plants and could be linked to plant-based foods in this data set (see <xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Section S8</xref> for more details).</p>
    </sec>
  </sec>
  <sec id="sec3-metabolites-11-00103">
    <title>3. Materials and Methods</title>
    <sec id="sec3dot1-metabolites-11-00103">
      <title>3.1. Preparing Intensity Matrix</title>
      <p>As input to activity level decomposition using mPLAGE (see <xref ref-type="sec" rid="sec3dot4-metabolites-11-00103">Section 3.4</xref>), a peak intensity matrix <italic>X</italic> is constructed for each metabolite set, defined here as a collection of features that have been grouped in some manner, e.g., forming a particular metabolic pathway or molecular family. In <italic>X</italic>, each row represents a single feature and each column is a sample, grouped into user-defined factors/conditions. In such multisample LC–MS data sets, it is common to find missing data points across the samples. To address this, data imputation is performed on the intensity matrix as follows: if all of the samples in a single experimental factor have intensities of zero, these are replaced by a minimum intensity value (which can be set by the user), and if only some of the sample values in a factor are zero, then these are replaced by the mean value of the nonzero samples in that factor. As an option for data normalisation, the intensity matrix is subsequently transformed to log space and standardised using the preprocessing module in Scipy [<xref rid="B27-metabolites-11-00103" ref-type="bibr">27</xref>] such that each factor has a zero mean and unit variance across the samples. This has been shown to give good results in preserving the distribution of <italic>p</italic>-values of significantly changing metabolites [<xref rid="B28-metabolites-11-00103" ref-type="bibr">28</xref>].</p>
    </sec>
    <sec id="sec3dot2-metabolites-11-00103">
      <title>3.2. Retrieving Pathway Data</title>
      <p>Metabolites, pathways, and the mapping of metabolites to pathways are obtained in PALS by querying from a local copy of the KEGG database [<xref rid="B29-metabolites-11-00103" ref-type="bibr">29</xref>] or by querying a Reactome instance running on top of a local Neo4j graph database (<xref ref-type="fig" rid="metabolites-11-00103-f007">Figure 7</xref>A). For Reactome, queries are created using Cypher, the query language used in the Neo4j graph database that hosts the Reactome data, to retrieve pathway information. Reactome is regularly updated, with the entire database available from the Reactome website <uri xlink:href="https://reactome.org/">https://reactome.org/</uri> (accessed on 5 February 2021) [<xref rid="B30-metabolites-11-00103" ref-type="bibr">30</xref>].</p>
      <p>The presence of isomeric and isobaric compounds (same mass, different structure/ molecular formula, respectively) in a sample means that multiple features with close m/z values can be annotated with the same molecular formula, although their associated peaks are actually produced by different compounds in the MS. Resolving the actual molecular identities of annotated features is a challenging problem, even at a high resolution [<xref rid="B9-metabolites-11-00103" ref-type="bibr">9</xref>]. To ensure coverage, PALS represents compounds using their chemical formulae when mapping features to pathways. Features are annotated as compound formulae and these are linked to the metabolites in the metabolite set/pathway of interest. To minimise false positive identifications of compounds from features, only those annotated as the most commonly observed adducts were selected: protonated (M+H)<inline-formula><mml:math id="mm22"><mml:mrow><mml:msup><mml:mrow/><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and deprotonated (M-H)<inline-formula><mml:math id="mm23"><mml:mrow><mml:msup><mml:mrow/><mml:mo>−</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> from positive and negative ionisation modes, respectively.</p>
    </sec>
    <sec id="sec3dot3-metabolites-11-00103">
      <title>3.3. Retrieving Molecular Family and Mass2Motif Data</title>
      <p>The decomposition approach employed by mPLAGE is not limited to the analysis of pathways. In fact, any user-defined grouping of features, where each metabolite set can be represented as the intensity matrix <italic>X</italic> (features vs. samples), can be used for for activity level decomposition. Here, two other approaches for producing metabolite sets by grouping features in a data-dependent fashion, in contrast to pathways that rely on prior knowledge, are described. The first method uses molecular networking (FBMN, [<xref rid="B31-metabolites-11-00103" ref-type="bibr">31</xref>]) to cluster peak fragmentation spectra by their similarities and produce the groups of peaks known as molecular families (MF). The second method employs a topic-modelling approach (MS2LDA, [<xref rid="B5-metabolites-11-00103" ref-type="bibr">5</xref>]) to generate groups of peaks (called Mass2Motifs) based on the shared presence of fragment and neutral loss features in their fragmentation spectra. Both FBMN and MS2LDA are accessible as workflows from Global Natural Products Social Molecular Networking (GNPS, [<xref rid="B2-metabolites-11-00103" ref-type="bibr">2</xref>]), which provides community resources to run large-scale molecular networking and annotations of spectra. To analyse both MFs and Mass2Motifs, Python code is provided in PALS to retrieve information on the metabolite sets as well as the peak intensity table from GNPS (<xref ref-type="fig" rid="metabolites-11-00103-f007">Figure 7</xref>B). This is then used to extract features and construct the input matrices for mPLAGE analysis (<xref ref-type="fig" rid="metabolites-11-00103-f007">Figure 7</xref>C).</p>
    </sec>
    <sec id="sec3dot4-metabolites-11-00103">
      <title>3.4. Decomposing Metabolite Set Activity Levels Using mPLAGE</title>
      <p>The initial activity level (AL) score for a set of metabolites is computed using singular value decomposition (SVD) following the method described for PLAGE [<xref rid="B7-metabolites-11-00103" ref-type="bibr">7</xref>], and adapted for metabolomics data (mPLAGE), as described. Similar to the way that gene expression data can be decomposed into metagenes and activity levels in PLAGE [<xref rid="B7-metabolites-11-00103" ref-type="bibr">7</xref>], the intensity matrix <italic>X</italic> can be used to determine an AL score for a compound in a pathway or set of metabolites in mPLAGE. This is calculated as the level of the first metacompound from the SVD of the peak intensity matrix (<xref ref-type="fig" rid="metabolites-11-00103-f007">Figure 7</xref>D) as follows. Given an intensity matrix <italic>X</italic> for a group of metabolites (where rows are the features annotated with formulae and columns are the samples in the data set), the decomposition of <italic>X</italic> can be written as <inline-formula><mml:math id="mm24"><mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mi mathvariant="sans-serif">Σ</mml:mi><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> where columns in <italic>U</italic> are the orthonormal left singular vectors representing “metacompounds’’, <inline-formula><mml:math id="mm25"><mml:mrow><mml:mi mathvariant="sans-serif">Σ</mml:mi></mml:mrow></mml:math></inline-formula> contains the diagonal matrix of singular values arranged in descending order, and rows in <italic>V</italic> are the right singular vectors representing the contribution of the corresponding metacompounds to each sample. The AL score in a sample <italic>j</italic> is given by <inline-formula><mml:math id="mm26"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic>v</italic> is the first row in <italic>V</italic>, which is a vector of coefficients representing the activity levels of the first metacompound in <italic>U</italic> (having the largest singular value) across samples. The singular values <inline-formula><mml:math id="mm27"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="mm28"><mml:mrow><mml:mi mathvariant="sans-serif">Σ</mml:mi></mml:mrow></mml:math></inline-formula> scale the metacompounds so that the original data <italic>X</italic> can be constructed—in fact, the square of each <inline-formula><mml:math id="mm29"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a measure of the variance accounted for by each metacompound <italic>i</italic>. For more details, see [<xref rid="B7-metabolites-11-00103" ref-type="bibr">7</xref>].</p>
      <p>To perform activity level analysis, two experimental factors are compared—for example, a control versus a condition. This is achieved by using the AL scores obtained from the decomposition step to calculate the <italic>t</italic>-statistic for each metabolite set across the varying experimental factors (<xref ref-type="fig" rid="metabolites-11-00103-f007">Figure 7</xref>D). As in [<xref rid="B7-metabolites-11-00103" ref-type="bibr">7</xref>], random permutations of the sample labels are performed to obtain the null distributions of <italic>t</italic>-statistics. However, it is observed that the tail end of the distribution of permuted <italic>t</italic>-statistics occasionally contains some extreme values that could skew results. As part of mPLAGE, an enhancement to the original PLAGE approach is introduced which produces better calibrated <italic>p</italic>-values. The minimum and maximum <italic>t</italic>-statistics from each permutation test are modelled using the generalised extreme value (GEV) distribution [<xref rid="B32-metabolites-11-00103" ref-type="bibr">32</xref>], with parameter fitting using maximum-likelihood estimation. The <italic>t</italic>-statistic of a pathway or set of metabolites is then evaluated against the fitted density in order to produce the final mPLAGE <italic>p</italic>-values of the metabolite sets.</p>
    </sec>
    <sec id="sec3dot5-metabolites-11-00103">
      <title>3.5. Software Implementation</title>
      <p>To facilitate the use of the activity analysis described in this project, PALS (Pathway Activity Level Scoring) software was developed. PALS can be run either as a standalone tool, imported as a Python library, or used via a Web interface allowing users with a wide range of expertise and requirements to use it (input format detailed in <xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Section S1</xref>). To assist beginners, a Web interface is provided to run PALS in an intuitive and user-friendly manner (refer to <xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Section S2</xref> for more details). Intermediate users can run PALS as a standalone command-line tool and incorporate PALS into a workflow as part of a custom script. In this mode, feature and annotation CSV files are input on the command line along with experimental design parameters, and a variety of other available parameters, accessible through command-line options (detailed in <xref ref-type="app" rid="app1-metabolites-11-00103">Supplementary Section S2</xref>). Pathway ranking results are output as a CSV file listing pathways, or metabolite sets, and their <italic>p</italic>-values. Expert users can also incorporate the PALS library directly in their Python application or use it in an interactive data analysis environment such as Jupyter Notebook [<xref rid="B33-metabolites-11-00103" ref-type="bibr">33</xref>]. A comprehensive tutorial describing how to use PALS as a library is available from the project Web site.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec4-metabolites-11-00103">
    <title>4. Conclusions</title>
    <p>This work describes PALS, a comprehensive system that can be used to prioritise metabolite sets, that is freely available at <uri xlink:href="https://pals.glasgowcompbio.org/">https://pals.glasgowcompbio.org/</uri> (accessed on 5 February 2021). From PALS, users obtain the ranking of changing pathways, or user-defined sets of metabolites, between experimental factors. Database queries that map compounds to pathways are integrated into the system using either KEGG or Reactome databases, while code is also available to automatically retrieve measurement data and metabolite sets of molecular families and Mass2Motifs from GNPS and perform activity measurements. Manuscripts comparing pathway ranking methods for metabolomics are still relatively rare. One such manuscript [<xref rid="B34-metabolites-11-00103" ref-type="bibr">34</xref>] compares the performance of overrepresentation analysis (ORA) tools, revealing that tools using ORA for analysis give consistently similar results while incorrect versions of the databases can affect the results more. With PALS, a systematic comparison using synthetic and real data was performed for the mPLAGE method against two different and widely used methods for pathway ranking in metabolomics ORA and GSEA. Comparing these different methods show that mPLAGE is consistently more robust in the presence of noisy and missing features, a common problem in LC–MS peak data. In addition, by choosing to use PALS with the Reactome DB, users can consistently access the most recent version of the DB, avoiding any version issues.</p>
    <p>It is also worth emphasising that unlike many tools surveyed here that specifically deal with pathways, PALS could be easily used to prioritise metabolite sets derived from many sources, whether based on knowledge (pathways) or driven by fragmentation data (molecular families and Mass2Motifs). To our knowledge, this is a unique capability not present in other tools. PALS also presents a comprehensive Python-based library that can be easily run in several modes: as a standalone tool, an interactive Web application (PALS Viewer), or a Python library. This allows PALS to be embedded in many different contexts: as part of a larger Web application, or a custom Python-based workflow and scripts, or to be imported directly into interactive computing environments like Jupyter. As a demonstration of its utility and versatility, the PALS library has been integrated and actively used in several projects such as PiMP [<xref rid="B21-metabolites-11-00103" ref-type="bibr">21</xref>], FlyMet (<ext-link ext-link-type="uri" xlink:href="http://flymet.org/">flymet.org</ext-link> (accessed on 5 February 2021) [<xref rid="B35-metabolites-11-00103" ref-type="bibr">35</xref>]), and WebOmics (<ext-link ext-link-type="uri" xlink:href="https://webomics.glasgowcompbio.org/">webomics.glasgowcompbio.org</ext-link> (accessed on 5 February 2021) [<xref rid="B36-metabolites-11-00103" ref-type="bibr">36</xref>]). To support these projects, PALS was extended to analyse not just metabolite sets, but also gene sets as well as protein sets from Reactome, since the mPLAGE approach used for activity level decomposition could easily generalise to other types of omics data too.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p><bold>Publisher’s Note:</bold> MDPI stays neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <app-group>
    <app id="app1-metabolites-11-00103">
      <title>Supplementary Materials</title>
      <p>A variety of additional text, tables and figures are available online at <uri xlink:href="https://www.mdpi.com/2218-1989/11/2/103/s1">https://www.mdpi.com/2218-1989/11/2/103/s1</uri>. Supplementary Section S1: File format and data imputation, Supplementary Section S2: Running PALS, Supplementary Section S3: Synthetic data generation, Supplementary Section S4: Benchmark methods, Supplementary Table S5: Top 30 ranking pathways from the HAT CSF dataset, Supplementary Table S6: Metabolites annotated in the KEGG aminoacyl-tRNA biosynthesis pathway, Supplementary Table S7: Precision and recall on real HAT data, Supplementary Section S8: Analysis of Differentially Expressed Molecular Families and Mass2Motifs from the AGP Dataset, Supplementary Section S9: Analysis of Differentially Expressed Mass2Motifs from the Rhamnaceae Dataset.</p>
      <supplementary-material content-type="local-data" id="metabolites-11-00103-s001">
        <media xlink:href="metabolites-11-00103-s001.pdf">
          <caption>
            <p>Click here for additional data file.</p>
          </caption>
        </media>
      </supplementary-material>
    </app>
  </app-group>
  <notes>
    <title>Author Contributions</title>
    <p>Conceptualization, S.R. and R.D.; methodology, J.W., K.M. and R.D.; software, J.W., K.M. and R.D.; validation, I.V. and J.J.J.v.d.H.; writing—original draft preparation, J.W. and K.M.; writing—review and editing, K.M., J.W., I.V., J.J.J.v.d.H., S.R., K.B. and R.D.; supervision, K.B. and R.D. All authors have read and agreed to the published version of the manuscript.</p>
  </notes>
  <notes>
    <title>Funding</title>
    <p>R.D. and J.W. were funded by the Wellcome Trust (105614/Z/14/Z). KMcL was funded by Innovate UK (102511). J.J.J.v.d.H. was funded by an ASDI eScience grant, grant no. ASDI.2017.030, from the Netherlands eScience Center—NLeSC.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data Availability Statement</title>
    <p>The data referenced in <xref ref-type="sec" rid="sec2dot2-metabolites-11-00103">Section 2.2</xref> is available at <uri xlink:href="https://www.ebi.ac.uk/metabolights/MTBLS413">https://www.ebi.ac.uk/metabolights/MTBLS413</uri> (accessed on 5 February 2021).</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare no conflict of interest.</p>
  </notes>
  <ref-list>
    <title>References</title>
    <ref id="B1-metabolites-11-00103">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khatri</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Sirota</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Butte</surname>
            <given-names>A.J.</given-names>
          </name>
        </person-group>
        <article-title>Ten years of pathway analysis: Current approaches and outstanding challenges</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2012</year>
        <volume>8</volume>
        <elocation-id>e1002375</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002375</pub-id>
        <?supplied-pmid 22383865?>
        <pub-id pub-id-type="pmid">22383865</pub-id>
      </element-citation>
    </ref>
    <ref id="B2-metabolites-11-00103">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Carver</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Phelan</surname>
            <given-names>V.V.</given-names>
          </name>
          <name>
            <surname>Sanchez</surname>
            <given-names>L.M.</given-names>
          </name>
          <name>
            <surname>Garg</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>D.D.</given-names>
          </name>
          <name>
            <surname>Watrous</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kapono</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Luzzatto-Knaan</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sharing and community curation of mass spectrometry data with Global Natural Products Social Molecular Networking</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>828</fpage>
        <lpage>837</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3597</pub-id>
        <?supplied-pmid 27504778?>
        <pub-id pub-id-type="pmid">27504778</pub-id>
      </element-citation>
    </ref>
    <ref id="B3-metabolites-11-00103">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>K.B.</given-names>
          </name>
          <name>
            <surname>Caraballo-Rodríguez</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Nothias</surname>
            <given-names>L.F.</given-names>
          </name>
          <name>
            <surname>Wandy</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Medema</surname>
            <given-names>M.H.</given-names>
          </name>
          <name>
            <surname>Dorrestein</surname>
            <given-names>P.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MolNetEnhancer: Enhanced molecular networks by integrating metabolome mining and annotation tools</article-title>
        <source>Metabolites</source>
        <year>2019</year>
        <volume>9</volume>
        <elocation-id>144</elocation-id>
        <pub-id pub-id-type="doi">10.3390/metabo9070144</pub-id>
        <?supplied-pmid 31315242?>
        <pub-id pub-id-type="pmid">31315242</pub-id>
      </element-citation>
    </ref>
    <ref id="B4-metabolites-11-00103">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kang</surname>
            <given-names>K.B.</given-names>
          </name>
          <name>
            <surname>Ernst</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>van der Hooft</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>da Silva</surname>
            <given-names>R.R.</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Medema</surname>
            <given-names>M.H.</given-names>
          </name>
          <name>
            <surname>Sung</surname>
            <given-names>S.H.</given-names>
          </name>
          <name>
            <surname>Dorrestein</surname>
            <given-names>P.C.</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive mass spectrometry-guided phenotyping of plant specialized metabolites reveals metabolic diversity in the cosmopolitan plant family Rhamnaceae</article-title>
        <source>Plant J.</source>
        <year>2019</year>
        <volume>98</volume>
        <fpage>1134</fpage>
        <lpage>1144</lpage>
        <pub-id pub-id-type="doi">10.1111/tpj.14292</pub-id>
        <?supplied-pmid 30786088?>
        <pub-id pub-id-type="pmid">30786088</pub-id>
      </element-citation>
    </ref>
    <ref id="B5-metabolites-11-00103">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Der Hooft</surname>
            <given-names>J.J.J.</given-names>
          </name>
          <name>
            <surname>Wandy</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>M.P.</given-names>
          </name>
          <name>
            <surname>Burgess</surname>
            <given-names>K.E.</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Topic modeling for untargeted substructure exploration in metabolomics</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2016</year>
        <volume>113</volume>
        <fpage>13738</fpage>
        <lpage>13743</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1608041113</pub-id>
        <pub-id pub-id-type="pmid">27856765</pub-id>
      </element-citation>
    </ref>
    <ref id="B6-metabolites-11-00103">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>V.K.</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>B.L.</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Paulovich</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Pomeroy</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>T.R.</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>E.S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="B7-metabolites-11-00103">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomfohr</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kepler</surname>
            <given-names>T.B.</given-names>
          </name>
        </person-group>
        <article-title>Pathway level analysis of gene expression using singular value decomposition</article-title>
        <source>BMC Bioinform.</source>
        <year>2005</year>
        <volume>6</volume>
        <elocation-id>225</elocation-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-225</pub-id>
        <?supplied-pmid 16156896?>
        <pub-id pub-id-type="pmid">16156896</pub-id>
      </element-citation>
    </ref>
    <ref id="B8-metabolites-11-00103">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarca</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Bhatti</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Romero</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>A comparison of gene set analysis methods in terms of sensitivity, prioritization and specificity</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <elocation-id>e79217</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0079217</pub-id>
        <?supplied-pmid 24260172?>
        <pub-id pub-id-type="pmid">24260172</pub-id>
      </element-citation>
    </ref>
    <ref id="B9-metabolites-11-00103">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kind</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O.</given-names>
          </name>
        </person-group>
        <article-title>Metabolomic database annotations via query of elemental compositions: Mass accuracy is insufficient even at less than 1 ppm</article-title>
        <source>BMC Bioinform.</source>
        <year>2006</year>
        <volume>7</volume>
        <elocation-id>234</elocation-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-234</pub-id>
        <?supplied-pmid 16646969?>
        <pub-id pub-id-type="pmid">16646969</pub-id>
      </element-citation>
    </ref>
    <ref id="B10-metabolites-11-00103">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Soufan</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Caraus</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Bourque</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Wishart</surname>
            <given-names>D.S.</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>MetaboAnalyst 4.0: Towards more transparent and integrative metabolomics analysis</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>W486</fpage>
        <lpage>W494</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky310</pub-id>
        <?supplied-pmid 29762782?>
        <pub-id pub-id-type="pmid">29762782</pub-id>
      </element-citation>
    </ref>
    <ref id="B11-metabolites-11-00103">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kessler</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Neuweger</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Bonte</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Langenkämper</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Niehaus</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Nattkemper</surname>
            <given-names>T.W.</given-names>
          </name>
          <name>
            <surname>Goesmann</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>MeltDB 2.0—Advances of the metabolomics software system</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2452</fpage>
        <lpage>2459</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt414</pub-id>
        <pub-id pub-id-type="pmid">23918246</pub-id>
      </element-citation>
    </ref>
    <ref id="B12-metabolites-11-00103">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kamburov</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Cavill</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ebbels</surname>
            <given-names>T.M.</given-names>
          </name>
          <name>
            <surname>Herwig</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Keun</surname>
            <given-names>H.C.</given-names>
          </name>
        </person-group>
        <article-title>Integrated pathway-level analysis of transcriptomics and metabolomics data with IMPaLA</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2917</fpage>
        <lpage>2918</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr499</pub-id>
        <pub-id pub-id-type="pmid">21893519</pub-id>
      </element-citation>
    </ref>
    <ref id="B13-metabolites-11-00103">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>MetaboAnalystR: An R package for flexible and reproducible analysis of metabolomics data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>4313</fpage>
        <lpage>4314</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty528</pub-id>
        <pub-id pub-id-type="pmid">29955821</pub-id>
      </element-citation>
    </ref>
    <ref id="B14-metabolites-11-00103">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Q.Y.</given-names>
          </name>
        </person-group>
        <article-title>ReactomePA: An R/Bioconductor package for reactome pathway analysis and visualization</article-title>
        <source>Mol. Biosyst.</source>
        <year>2016</year>
        <volume>12</volume>
        <fpage>477</fpage>
        <lpage>479</lpage>
        <pub-id pub-id-type="doi">10.1039/C5MB00663E</pub-id>
        <pub-id pub-id-type="pmid">26661513</pub-id>
      </element-citation>
    </ref>
    <ref id="B15-metabolites-11-00103">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ulgen</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Ozisik</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Sezerman</surname>
            <given-names>O.U.</given-names>
          </name>
        </person-group>
        <article-title>pathfindR: An R package for comprehensive identification of enriched pathways in omics data through active subnetworks</article-title>
        <source>Front. Genet.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>858</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.00858</pub-id>
        <?supplied-pmid 31608109?>
        <pub-id pub-id-type="pmid">31608109</pub-id>
      </element-citation>
    </ref>
    <ref id="B16-metabolites-11-00103">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Palombo</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Milanesi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sferra</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Capomaccio</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sgorlon</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>D’Andrea</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>PANEV: An R package for a pathway-based network visualization</article-title>
        <source>BMC Bioinform.</source>
        <year>2020</year>
        <volume>21</volume>
        <elocation-id>46</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s12859-020-3371-7</pub-id>
      </element-citation>
    </ref>
    <ref id="B17-metabolites-11-00103">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vincent</surname>
            <given-names>I.M.</given-names>
          </name>
          <name>
            <surname>Creek</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Watson</surname>
            <given-names>D.G.</given-names>
          </name>
          <name>
            <surname>Kamleh</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Woods</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>P.E.</given-names>
          </name>
          <name>
            <surname>Burchmore</surname>
            <given-names>R.J.</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>M.P.</given-names>
          </name>
        </person-group>
        <article-title>A molecular mechanism for eflornithine resistance in African trypanosomes</article-title>
        <source>PLoS Pathog.</source>
        <year>2010</year>
        <volume>6</volume>
        <elocation-id>e1001204</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.ppat.1001204</pub-id>
        <?supplied-pmid 21124824?>
        <pub-id pub-id-type="pmid">21124824</pub-id>
      </element-citation>
    </ref>
    <ref id="B18-metabolites-11-00103">
      <label>18.</label>
      <element-citation publication-type="web">
        <article-title>PALS Website</article-title>
        <comment>Available online: <ext-link ext-link-type="uri" xlink:href="https://pals.glasgowcompbio.org/">https://pals.glasgowcompbio.org/</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2021-02-10">(accessed on 10 February 2021)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B19-metabolites-11-00103">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evangelou</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Rendon</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ouwehand</surname>
            <given-names>W.H.</given-names>
          </name>
          <name>
            <surname>Wernisch</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Dudbridge</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Comparison of methods for competitive tests of pathway analysis</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <elocation-id>e41018</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0041018</pub-id>
        <?supplied-pmid 22859961?>
        <pub-id pub-id-type="pmid">22859961</pub-id>
      </element-citation>
    </ref>
    <ref id="B20-metabolites-11-00103">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vincent</surname>
            <given-names>I.M.</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Courtioux</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Cattanach</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Biéler</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ndung’u</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Bisser</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>M.P.</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics identifies multiple candidate biomarkers to diagnose and stage human African trypanosomiasis</article-title>
        <source>PLoS Neglected Trop. Dis.</source>
        <year>2016</year>
        <volume>10</volume>
        <elocation-id>e0005140</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pntd.0005140</pub-id>
      </element-citation>
    </ref>
    <ref id="B21-metabolites-11-00103">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gloaguen</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Morton</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Gurden</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Wandy</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Barrett</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Burgess</surname>
            <given-names>K.</given-names>
          </name>
        </person-group>
        <article-title>PiMP my metabolome: An integrated, web-based tool for LC-MS metabolomics data</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>4007</fpage>
        <lpage>4009</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx499</pub-id>
        <pub-id pub-id-type="pmid">28961954</pub-id>
      </element-citation>
    </ref>
    <ref id="B22-metabolites-11-00103">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaudhary</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Roos</surname>
            <given-names>D.S.</given-names>
          </name>
        </person-group>
        <article-title>Protozoan genomics for drug discovery</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2005</year>
        <volume>23</volume>
        <fpage>1089</fpage>
        <lpage>1091</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt0905-1089</pub-id>
        <?supplied-pmid 16151400?>
        <pub-id pub-id-type="pmid">16151400</pub-id>
      </element-citation>
    </ref>
    <ref id="B23-metabolites-11-00103">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Creek</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Mazet</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Achcar</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>D.H.</given-names>
          </name>
          <name>
            <surname>Kamour</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Morand</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Millerioux</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Biran</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kerkhoven</surname>
            <given-names>E.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probing the metabolic network in bloodstream-form Trypanosoma brucei using untargeted metabolomics with stable isotope labelled glucose</article-title>
        <source>PLoS Pathog.</source>
        <year>2015</year>
        <volume>11</volume>
        <elocation-id>e1004689</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.ppat.1004689</pub-id>
        <?supplied-pmid 25775470?>
        <pub-id pub-id-type="pmid">25775470</pub-id>
      </element-citation>
    </ref>
    <ref id="B24-metabolites-11-00103">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mantilla</surname>
            <given-names>B.S.</given-names>
          </name>
          <name>
            <surname>Marchese</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Casas-Sánchez</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Dyer</surname>
            <given-names>N.A.</given-names>
          </name>
          <name>
            <surname>Ejeh</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Biran</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Bringaud</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Lehane</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Acosta-Serrano</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Silber</surname>
            <given-names>A.M.</given-names>
          </name>
        </person-group>
        <article-title>Proline metabolism is essential for Trypanosoma brucei brucei survival in the tsetse vector</article-title>
        <source>PLoS Pathog.</source>
        <year>2017</year>
        <volume>13</volume>
        <elocation-id>e1006158</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.ppat.1006158</pub-id>
        <?supplied-pmid 28114403?>
        <pub-id pub-id-type="pmid">28114403</pub-id>
      </element-citation>
    </ref>
    <ref id="B25-metabolites-11-00103">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wishart</surname>
            <given-names>D.S.</given-names>
          </name>
          <name>
            <surname>Jewison</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>A.C.</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Knox</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Djoumbou</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Mandal</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Aziat</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HMDB 3.0—The human metabolome database in 2013</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>41</volume>
        <fpage>D801</fpage>
        <lpage>D807</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1065</pub-id>
        <?supplied-pmid 23161693?>
        <pub-id pub-id-type="pmid">23161693</pub-id>
      </element-citation>
    </ref>
    <ref id="B26-metabolites-11-00103">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McDonald</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Debelius</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Morton</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Ackermann</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Aksenov</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Behsaz</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Brennan</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>American gut: An open platform for citizen science microbiome research</article-title>
        <source>MSystems</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>e00031-18</fpage>
        <pub-id pub-id-type="doi">10.1128/mSystems.00031-18</pub-id>
        <pub-id pub-id-type="pmid">29795809</pub-id>
      </element-citation>
    </ref>
    <ref id="B27-metabolites-11-00103">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Virtanen</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Gommers</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Oliphant</surname>
            <given-names>T.E.</given-names>
          </name>
          <name>
            <surname>Haberland</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Cournapeau</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Burovski</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Weckesser</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Bright</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SciPy 1.0—Fundamental Algorithms for Scientific Computing in Python</article-title>
        <source>arXiv</source>
        <year>2019</year>
        <pub-id pub-id-type="arxiv">1907.10121</pub-id>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
      </element-citation>
    </ref>
    <ref id="B28-metabolites-11-00103">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Xue</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>NOREVA: Normalization and evaluation of MS-based metabolomics data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>W162</fpage>
        <lpage>W170</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx449</pub-id>
        <?supplied-pmid 28525573?>
        <pub-id pub-id-type="pmid">28525573</pub-id>
      </element-citation>
    </ref>
    <ref id="B29-metabolites-11-00103">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>KEGG: Kyoto encyclopedia of genes and genomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2000</year>
        <volume>28</volume>
        <fpage>27</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id>
        <pub-id pub-id-type="pmid">10592173</pub-id>
      </element-citation>
    </ref>
    <ref id="B30-metabolites-11-00103">
      <label>30.</label>
      <element-citation publication-type="web">
        <article-title>Reactome Website</article-title>
        <comment>Available online: <ext-link ext-link-type="uri" xlink:href="https://reactome.org/">https://reactome.org/</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2021-02-10">(accessed on 10 February 2021)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B31-metabolites-11-00103">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nothias</surname>
            <given-names>L.F.</given-names>
          </name>
          <name>
            <surname>Petras</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Dührkop</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Rainer</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Sarvepalli</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Protsyuk</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Ernst</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Tsugawa</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Fleischauer</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Feature-based Molecular Networking in the GNPS Analysis Environment</article-title>
        <source>Nat. Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <fpage>905</fpage>
        <lpage>908</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0933-6</pub-id>
        <?supplied-pmid 32839597?>
        <pub-id pub-id-type="pmid">32839597</pub-id>
      </element-citation>
    </ref>
    <ref id="B32-metabolites-11-00103">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charras-Garrido</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lezaud</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Extreme value analysis: An introduction</article-title>
        <source>J. Soc. Fr. Stat.</source>
        <year>2013</year>
        <volume>154</volume>
        <fpage>66</fpage>
        <lpage>97</lpage>
      </element-citation>
    </ref>
    <ref id="B33-metabolites-11-00103">
      <label>33.</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Kluyver</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Ragan-Kelley</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Pérez</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Granger</surname>
            <given-names>B.E.</given-names>
          </name>
          <name>
            <surname>Bussonnier</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Frederic</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kelley</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Hamrick</surname>
            <given-names>J.B.</given-names>
          </name>
          <name>
            <surname>Grout</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Corlay</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Jupyter Notebooks-a publishing format for reproducible computational workflows</article-title>
        <source>Proceedings of the 20th International Conference on Electronic Publishing</source>
        <conf-loc>Göttingen, Germany</conf-loc>
        <conf-date>7–9 June 2016</conf-date>
        <fpage>87</fpage>
        <lpage>90</lpage>
      </element-citation>
    </ref>
    <ref id="B34-metabolites-11-00103">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marco-Ramell</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Palau-Rodriguez</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Alay</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tulipani</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Urpi-Sarda</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Sanchez-Pla</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Andres-Lacueva</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Evaluation and comparison of bioinformatic tools for the enrichment analysis of metabolomics data</article-title>
        <source>BMC Bioinform.</source>
        <year>2018</year>
        <volume>19</volume>
        <elocation-id>1</elocation-id>
        <pub-id pub-id-type="doi">10.1186/s12859-017-2006-0</pub-id>
        <?supplied-pmid 29291722?>
        <pub-id pub-id-type="pmid">29291722</pub-id>
      </element-citation>
    </ref>
    <ref id="B35-metabolites-11-00103">
      <label>35.</label>
      <element-citation publication-type="web">
        <article-title>FlyMet Website</article-title>
        <comment>Available online: <ext-link ext-link-type="uri" xlink:href="http://flymet.org/">http://flymet.org/</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2021-02-10">(accessed on 10 February 2021)</date-in-citation>
      </element-citation>
    </ref>
    <ref id="B36-metabolites-11-00103">
      <label>36.</label>
      <element-citation publication-type="web">
        <article-title>WebOmics Website</article-title>
        <comment>Available online: <ext-link ext-link-type="uri" xlink:href="https://webomics.glasgowcompbio.org/">https://webomics.glasgowcompbio.org/</ext-link></comment>
        <date-in-citation content-type="access-date" iso-8601-date="2021-02-10">(accessed on 10 February 2021)</date-in-citation>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="metabolites-11-00103-f001" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Adding nonchanging decoy features to the seven known changing pathways <inline-formula><mml:math id="mm30"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>40</mml:mn><mml:mo>,</mml:mo><mml:mn>80</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The percentage of decoy features represents the number of additional noisy features added to a pathway as a percentage of the original number of features in that pathway. The boxplots show the spread of the <italic>p</italic>-values calculated from the pathways, including the median (solid horizontal line). The red dashed line indicates a <italic>p</italic>-value threshold of 0.05. The results show that increasing noise levels generally produces higher <italic>p</italic>-values, making it harder to detect significantly changing pathways. mPLAGE is more robust compared to other methods in returning lower <italic>p</italic>-values in the presence of noise.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00103-g001"/>
  </fig>
  <fig id="metabolites-11-00103-f002" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Mean <italic>p</italic>-values from overrepresentation analysis (ORA), gene set enrichment analysis (GSEA), and pathway level analysis of gene expression for metabolomics (mPLAGE) calculated for each significantly changing synthetic pathway at different levels of decoy features added. Across all levels of added decoy features, it is easier to identify larger pathways as significantly changing than smaller pathways. mPLAGE generally returns lower <italic>p</italic>-values than ORA and GSEA.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00103-g002"/>
  </fig>
  <fig id="metabolites-11-00103-f003" orientation="portrait" position="float">
    <label>Figure 3</label>
    <caption>
      <p>Overall performance of the different pathway ranking methods. Distribution of the <inline-formula><mml:math id="mm31"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> for each method under increasing levels of decoy features is shown with outliers displayed as small diamonds. The performance of mPLAGE and ORA are roughly similar using 0–100% decoy levels, but mPLAGE performs better returning greater <inline-formula><mml:math id="mm32"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-scores at higher decoy levels.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00103-g003"/>
  </fig>
  <fig id="metabolites-11-00103-f004" orientation="portrait" position="float">
    <label>Figure 4</label>
    <caption>
      <p>Resulting <italic>p</italic>-values from removing features from significantly changing pathways. The percentage of features randomly removed from the pathways increases from 20% to 80% and ORA, GSEA, and mPLAGE are compared. The red dashed line indicates a <italic>p</italic>-value threshold of 0.05. The results show that mPLAGE performs better, returning lower <italic>p</italic>-values compared to the alternatives, even in the presence of a large number of missing features.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00103-g004"/>
  </fig>
  <fig id="metabolites-11-00103-f005" orientation="portrait" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Overall performance of the different pathway ranking methods with missing features. Distribution of the <inline-formula><mml:math id="mm33"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> scores for each method under an increasing proportion of missing features (20% to 80%) is shown. The results show that mPLAGE performs better, returning greater <inline-formula><mml:math id="mm34"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-scores at higher proportions of missing features.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00103-g005"/>
  </fig>
  <fig id="metabolites-11-00103-f006" orientation="portrait" position="float">
    <label>Figure 6</label>
    <caption>
      <p><inline-formula><mml:math id="mm35"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> score results from the plasma and cerebrospinal fluid (CSF) samples from the human African trypanosomiasis (HAT) data set for varying percentages of missing features (proportion of full data set). A higher <inline-formula><mml:math id="mm36"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> score means that the method is able to recover more of the original set of significant pathways correctly, even in the presence of missing features. The results show that mPLAGE performs better than the alternatives on real data.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00103-g006"/>
  </fig>
  <fig id="metabolites-11-00103-f007" orientation="portrait" position="float">
    <label>Figure 7</label>
    <caption>
      <p>Overall schematic of Pathway Activity Level Scoring (PALS) using pathways and molecular families as an example of metabolite sets. (<bold>A</bold>) Database queries of pathways. Different databases (Reactome and KEGG) can be used to query pathways in PALS. Features are mapped to pathways through their formula annotations. For a set of compounds, all features sharing the same formula annotations of those compounds are used to construct the input intensity matrix for mPLAGE. (<bold>B</bold>) GNPS queries of molecular families or Mass2Motifs, potentially representing unknown chemical classes or substructures. (<bold>C</bold>) The intensities of features are extracted from peak data and assigned to experimental groups (<bold>D</bold>) The feature intensity matrix and mPLAGE method for a metabolite set. In the matrix, feature intensity levels are shown as a heat map ranging from blue (high) to red (low) peak intensities. The feature intensity matrix is decomposed via SVD to obtain the activity level (AL) scores from a set of metabolites in a sample. The collective AL scores are used to calculate the subsequent mPLAGE <italic>p</italic>-values between the different factor groups. The dashed green line is used to split samples grouped as different factors.</p>
    </caption>
    <graphic xlink:href="metabolites-11-00103-g007"/>
  </fig>
</floats-group>
