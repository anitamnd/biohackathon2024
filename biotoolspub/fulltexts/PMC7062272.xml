<?properties open_access?>
<?subarticle pone.0230276.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7062272</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-30704</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230276</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Mental Health and Psychiatry</subject>
          <subj-group>
            <subject>Mental Health Therapies</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Assessment</subject>
          <subj-group>
            <subject>Reproducibility</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Mental Health and Psychiatry</subject>
          <subj-group>
            <subject>Mood Disorders</subject>
            <subj-group>
              <subject>Depression</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Engineering and Technology</subject>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Research Assessment</subject>
          <subj-group>
            <subject>Research Validity</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Information Technology</subject>
          <subj-group>
            <subject>Data Processing</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Mental Health and Psychiatry</subject>
          <subj-group>
            <subject>Mental Health Therapies</subject>
            <subj-group>
              <subject>Psychotherapy</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Mathematical and Statistical Techniques</subject>
          <subj-group>
            <subject>Statistical Methods</subject>
            <subj-group>
              <subject>Metaanalysis</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Statistics</subject>
            <subj-group>
              <subject>Statistical Methods</subject>
              <subj-group>
                <subject>Metaanalysis</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>suddengains: An R package to identify sudden gains in longitudinal data</article-title>
      <alt-title alt-title-type="running-head">R package to identify sudden gains</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1991-282X</contrib-id>
        <name>
          <surname>Wiedemann</surname>
          <given-names>Milan</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2851-1315</contrib-id>
        <name>
          <surname>Thew</surname>
          <given-names>Graham R.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stott</surname>
          <given-names>Richard</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8742-0192</contrib-id>
        <name>
          <surname>Ehlers</surname>
          <given-names>Anke</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff004">
          <sup>4</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Experimental Psychology, University of Oxford, Oxford, United Kingdom</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Oxford Health NHS Foundation Trust, Oxford, United Kingdom</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Oxford University Hospitals NHS Foundation Trust, Oxford, United Kingdom</addr-line>
    </aff>
    <aff id="aff004">
      <label>4</label>
      <addr-line>King’s College London, London, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Gnambs</surname>
          <given-names>Timo</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Leibniz Institute for Educational Trajectories, GERMANY</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>milan.wiedemann@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>9</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>3</issue>
    <elocation-id>e0230276</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>2</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Wiedemann et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Wiedemann et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0230276.pdf"/>
    <abstract>
      <p>Sudden gains are large and stable improvements in an outcome variable between consecutive measurements, for example during a psychological intervention with multiple assessments. Researching these occurrences could help understand individual change processes in longitudinal data. Three criteria are generally used to identify sudden gains in psychological interventions. However, applying these criteria can be time consuming and prone to errors if not fully automated. Adaptations to these criteria and methodological decisions such as how multiple gains are handled vary across studies and are reported with different levels of detail. These problems limit the comparability of individual studies and make it hard to understand or replicate the exact methods used. The R package <italic>suddengains</italic> provides a set of tools to facilitate sudden gains research. This article illustrates how to use the package to identify sudden gains or sudden losses and how to extract descriptive statistics as well as exportable data files for further analysis. It also outlines how these analyses can be customised to apply adaptations of the standard criteria. The <italic>suddengains</italic> package therefore offers significant scope to improve the efficiency, reporting, and reproducibility of sudden gains research.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100009981</institution-id>
            <institution>Mental Health Research UK</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1991-282X</contrib-id>
          <name>
            <surname>Wiedemann</surname>
            <given-names>Milan</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award002">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
            <institution>Wellcome Trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>102176</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2851-1315</contrib-id>
          <name>
            <surname>Thew</surname>
            <given-names>Graham R.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award003">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100010269</institution-id>
            <institution>Wellcome Trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>069777 and 200976</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8742-0192</contrib-id>
          <name>
            <surname>Ehlers</surname>
            <given-names>Anke</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award004">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100013373</institution-id>
            <institution>NIHR Oxford Biomedical Research Centre</institution>
          </institution-wrap>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2851-1315</contrib-id>
          <name>
            <surname>Thew</surname>
            <given-names>Graham R.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group id="award005">
        <funding-source>
          <institution>Oxford Health NIHR Biomedical Research Centre</institution>
        </funding-source>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8742-0192</contrib-id>
          <name>
            <surname>Ehlers</surname>
            <given-names>Anke</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>This project was supported by a Mental Health Research UK studentship (MW), the Wellcome Trust [102176 (GRT); 069777 and 200976 (AE, RS)], the Oxford Health NIHR Biomedical Research Centre (MW, GRT, AE), and the NIHR Oxford Biomedical Research Centre (GRT). The views expressed are those of the authors and not necessarily those of the NHS, the NIHR or the Department of Health. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="2"/>
      <table-count count="4"/>
      <page-count count="13"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The package can be downloaded from CRAN <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=suddengains">https://CRAN.R-project.org/package=suddengains</ext-link>. All code, materials, and data can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/milanwiedemann/suddengains">https://github.com/milanwiedemann/suddengains</ext-link>. Instructions for installing the package, further technical details, and examples can be found at <ext-link ext-link-type="uri" xlink:href="https://milanwiedemann.github.io/suddengains">https://milanwiedemann.github.io/suddengains</ext-link>. The R code examples in this paper refer to package version 0.4.0.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The package can be downloaded from CRAN <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=suddengains">https://CRAN.R-project.org/package=suddengains</ext-link>. All code, materials, and data can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/milanwiedemann/suddengains">https://github.com/milanwiedemann/suddengains</ext-link>. Instructions for installing the package, further technical details, and examples can be found at <ext-link ext-link-type="uri" xlink:href="https://milanwiedemann.github.io/suddengains">https://milanwiedemann.github.io/suddengains</ext-link>. The R code examples in this paper refer to package version 0.4.0.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>A sudden gain is a large improvement in an outcome variable experienced by an individual participant between two consecutive measurement points that is stable within a longitudinal data series. Sudden gains were first defined and investigated by Tang and DeRubeis [<xref rid="pone.0230276.ref001" ref-type="bibr">1</xref>], who examined session to session changes in depression symptoms among participants undertaking cognitive behavioural therapy. The majority of sudden gains studies to date have been in relation to psychological therapies [<xref rid="pone.0230276.ref002" ref-type="bibr">2</xref>], but the analytic approach could also be considered when investigating within-participant changes in other fields. A meta-analysis of 16 studies of psychological therapies (total <italic>N</italic> = 1104) found that experiencing a sudden gain was associated with better overall clinical outcomes at the end of treatment and at follow-up compared to those who did not experience gains [<xref rid="pone.0230276.ref002" ref-type="bibr">2</xref>]. Given this potential significance of sudden gains, examining such events specifically may be informative in understanding when and why such large improvements occur, which could help to increase the efficacy and efficiency of the intervention.</p>
    <p>Rates of sudden gains within published clinical studies vary considerably (e.g. 17.8% to 52.2% of participants [<xref rid="pone.0230276.ref002" ref-type="bibr">2</xref>]), which may partly be due to differences in the methods used to identify them. However, such differences are hard to examine given that sufficient methodological details to permit a comparison are not always reported. In addition, some studies have raised concerns about the validity of sudden gains identified through current methods, demonstrating that they can be found in placebo interventions and simulated datasets [<xref rid="pone.0230276.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0230276.ref004" ref-type="bibr">4</xref>]. This suggests that not all gains reflect meaningful change or show a causal association with the intervention being studied. This highlights the need to examine the presence and strength of these associations and to consider if the current methods of identification can be refined The <italic>suddengains</italic> R package is the first software program to offer explicit and reproducible methods to automatically identify sudden gains, which may be valuable in improving methodological reporting and consistency across studies. It may also facilitate closer examination of the methods used to identify sudden gains, to help improve their validity and ensure that they more accurately reflect meaningful events. This article aims to provide an accessible overview of how sudden gains are calculated, describe the principal functions of the package, and give instructions on how to use these with longitudinal data. It is hoped that using this package will facilitate improvements in the efficiency, reporting, and reproducibility of sudden gains research.</p>
  </sec>
  <sec id="sec002">
    <title>Identification of sudden gains</title>
    <p>Tang and DeRubeis [<xref rid="pone.0230276.ref001" ref-type="bibr">1</xref>, <xref rid="pone.0230276.ref005" ref-type="bibr">5</xref>] suggested the following three criteria to identify sudden gains:</p>
    <list list-type="order">
      <list-item>
        <p>The gain must be large in absolute terms. While this was originally operationalised as a decrease of at least 7 points on the Beck Depression Inventory (BDI [<xref rid="pone.0230276.ref006" ref-type="bibr">6</xref>]), subsequent studies have generally used the Reliable Change Index (RCI [<xref rid="pone.0230276.ref007" ref-type="bibr">7</xref>]) to define an appropriate cutoff for other scales [<xref rid="pone.0230276.ref008" ref-type="bibr">8</xref>]. Further details are discussed below.</p>
      </list-item>
      <list-item>
        <p>The gain must be large in relative terms. This is defined as a drop of at least 25% of the previous score.</p>
      </list-item>
      <list-item>
        <p>The gain must be large relative to symptom fluctuation. Originally an independent <italic>t</italic> test was proposed to compare the size of the sudden gain with symptom fluctuation before and after the gain. This method was controversial given the assumption of independence of the measurements before and after the gain is not met [<xref rid="pone.0230276.ref003" ref-type="bibr">3</xref>, <xref rid="pone.0230276.ref009" ref-type="bibr">9</xref>]. Consequently the wording of this criterion was updated by Tang and colleagues [<xref rid="pone.0230276.ref005" ref-type="bibr">5</xref>, <xref rid="pone.0230276.ref009" ref-type="bibr">9</xref>], though the calculations remained the same: The difference between the mean scores of the three measurements before the gain (<italic>M</italic><sub>pre</sub>), and the three measurements after the gain (<italic>M</italic><sub>post</sub>), must be greater than the pooled standard deviation of these two groups multiplied by a critical value of 2.776 (i.e. the two-tailed <italic>t</italic> statistic for <italic>α</italic> = 0.05 and <italic>df</italic> = 4). The formula for criterion 3 is therefore:
<disp-formula id="pone.0230276.e001"><alternatives><graphic xlink:href="pone.0230276.e001.jpg" id="pone.0230276.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mtext>critical</mml:mtext><mml:mspace width="4pt"/><mml:mtext>value</mml:mtext><mml:mo>*</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>*</mml:mo><mml:mi>S</mml:mi><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>*</mml:mo><mml:mi>S</mml:mi><mml:msubsup><mml:mi>D</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      </list-item>
    </list>
    <p>The criteria used to identify sudden gains vary between studies. For example, some studies have used different methods to define a cutoff value for criterion one [<xref rid="pone.0230276.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0230276.ref011" ref-type="bibr">11</xref>], criterion two was not included in some studies because of concerns about the impact of different response scales and data suggesting it has little effect on the number of gains found [<xref rid="pone.0230276.ref012" ref-type="bibr">12</xref>], and studies have used different methods to select a critical value for use in criterion 3 [<xref rid="pone.0230276.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0230276.ref013" ref-type="bibr">13</xref>] see <xref ref-type="disp-formula" rid="pone.0230276.e001">Eq 1</xref>.</p>
    <sec id="sec003">
      <title>Defining a cutoff for the first criterion</title>
      <p>Tang and DeRubeis [<xref rid="pone.0230276.ref001" ref-type="bibr">1</xref>] originally defined a 7 point cutoff on the BDI for the first criterion based on frequency distribution plots of session to session change scores on the BDI in clinical trials. The authors reported that 7 BDI points approximately reflected one standard deviation in clinical samples [<xref rid="pone.0230276.ref009" ref-type="bibr">9</xref>]. Stiles et al. [<xref rid="pone.0230276.ref008" ref-type="bibr">8</xref>] noted that 7 BDI points was close to the reliable change value reported in Barkham et al. [<xref rid="pone.0230276.ref014" ref-type="bibr">14</xref>] and therefore used the RCI formula to define a cutoff for a new measure. Subsequent studies have generally adopted this approach. Jacobson and Truax [<xref rid="pone.0230276.ref007" ref-type="bibr">7</xref>] proposed the following formula to test whether the observed pre to post change on a measure reflects more than just fluctuation due to measurement error:
<disp-formula id="pone.0230276.e002"><alternatives><graphic xlink:href="pone.0230276.e002.jpg" id="pone.0230276.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>pre</mml:mtext><mml:mspace width="4pt"/><mml:mo>-</mml:mo><mml:mspace width="4pt"/><mml:mtext>post</mml:mtext></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mtext>diff</mml:mtext></mml:msub></mml:mfrac><mml:mo>=</mml:mo><mml:mtext>RCI</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula></p>
      <p>Following Jacobson and Truax [<xref rid="pone.0230276.ref007" ref-type="bibr">7</xref>], reliable change on a measure is present when:
<disp-formula id="pone.0230276.e003"><alternatives><graphic xlink:href="pone.0230276.e003.jpg" id="pone.0230276.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mtext>pre</mml:mtext><mml:mspace width="4pt"/><mml:mo>-</mml:mo><mml:mspace width="4pt"/><mml:mtext>post</mml:mtext></mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mtext>diff</mml:mtext></mml:msub></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>96</mml:mn><mml:mo>;</mml:mo><mml:mspace width="4pt"/><mml:mtext>therefore</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
<disp-formula id="pone.0230276.e004"><alternatives><graphic xlink:href="pone.0230276.e004.jpg" id="pone.0230276.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>reliable</mml:mtext><mml:mspace width="4pt"/><mml:mtext>change</mml:mtext><mml:mo>&gt;</mml:mo><mml:mtext>1.96</mml:mtext><mml:mo>×</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mtext>diff</mml:mtext></mml:msub><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
where <italic>S</italic><sub>diff</sub> is the standard error of the difference between pre and post scores. Using the standard error of measurement (<italic>S<sub>E</sub></italic>), <italic>S</italic><sub>diff</sub> can be expressed as:
<disp-formula id="pone.0230276.e005"><alternatives><graphic xlink:href="pone.0230276.e005.jpg" id="pone.0230276.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mtext>diff</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
where <italic>S<sub>E</sub></italic> is calculated using the standard deviation of the control group or normal population <italic>s</italic><sub>1</sub> and the test-retest reliability of the measure (<italic>r<sub>xx</sub></italic>):
<disp-formula id="pone.0230276.e006"><alternatives><graphic xlink:href="pone.0230276.e006.jpg" id="pone.0230276.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msqrt><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula></p>
      <p>Some studies have adapted this formula following suggestions from Martinovich, Saunders and Howard [<xref rid="pone.0230276.ref015" ref-type="bibr">15</xref>] by replacing the test-retest reliability with the internal consistency (<italic>α</italic>) and replacing the standard deviation of the normal population (<italic>s</italic><sub>1</sub>) with the standard deviation of the clinical sample at baseline (<italic>SD</italic><sub>pre</sub>) so that all statistics can be extracted from the sample data [<xref rid="pone.0230276.ref016" ref-type="bibr">16</xref>]. Note that the use of the test-retest reliability or internal consistency when calculating <italic>S</italic><sub><italic>E</italic></sub> makes the assumption that the scale being examined is unidimensional, and that these reliability estimates remain constant over time, and between individuals. Exploring the factor structure and measurement invariance of the scale may be appropriate to examine if these assumption hold.
<disp-formula id="pone.0230276.e007"><alternatives><graphic xlink:href="pone.0230276.e007.jpg" id="pone.0230276.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula></p>
      <p>In the sudden gains literature different approaches have been used to define a cutoff for the first criterion using the RCI formula. Some studies [<xref rid="pone.0230276.ref010" ref-type="bibr">10</xref>, <xref rid="pone.0230276.ref017" ref-type="bibr">17</xref>] have used the standard error of the difference (<italic>S</italic><sub>diff</sub>) while others [<xref rid="pone.0230276.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0230276.ref013" ref-type="bibr">13</xref>] have used the reliable change value (1.96 × <italic>S</italic><sub>diff</sub>). When defining a cutoff it is important to consider the statistical assumptions involved, and toensure that this value reflects a meaningful change (large in absolute terms) that is realistic in a session by session context for the intervention.</p>
    </sec>
    <sec id="sec004">
      <title>Missing data</title>
      <p>Missing data, for example where a participant does not provide data on one or more occasions, need to be considered carefully when identifying sudden gains for several reasons. Firstly, depending on the number and pattern of missing data points for an individual, it may not be possible to identify sudden gains, see <xref rid="pone.0230276.t001" ref-type="table">Table 1</xref>. Specifically, in order to estimate the standard deviation values in criterion 3, at least two of the three measurements immediately prior to the gain must be present, as well as at least two of the three measurements immediately following the gain. Some researchers have suggested that methods used to replace missing values, such as <italic>last observation carried forward</italic> or <italic>multiple imputation</italic>, may not be appropriate when identifying sudden gains given the potential for additional gains to be detected based on data that were not provided by participants [<xref rid="pone.0230276.ref018" ref-type="bibr">18</xref>, <xref rid="pone.0230276.ref019" ref-type="bibr">19</xref>].</p>
      <table-wrap id="pone.0230276.t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230276.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Data patterns required to identify sudden gains.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0230276.t001g" xlink:href="pone.0230276.t001"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="left" rowspan="1" colspan="1">
                  <italic>x</italic>
                  <sub>n-2</sub>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>x</italic>
                  <sub>n-1</sub>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>x</italic>
                  <sub>n</sub>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>x</italic>
                  <sub>n+1</sub>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>x</italic>
                  <sub>n+2</sub>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <italic>x</italic>
                  <sub>n+3</sub>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pattern 1</td>
                <td align="left" rowspan="1" colspan="1">∘</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">∘</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pattern 2</td>
                <td align="left" rowspan="1" colspan="1">∘</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">∘</td>
                <td align="left" rowspan="1" colspan="1">•</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pattern 3</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">∘</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">∘</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pattern 4</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">∘</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">•</td>
                <td align="left" rowspan="1" colspan="1">∘</td>
                <td align="left" rowspan="1" colspan="1">•</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t001fn001">
            <p><italic>Note</italic>. <italic>x</italic><sub>n-2</sub> to <italic>x</italic><sub>n+3</sub> represent any six consecutive measurement points within the data set. The minimum number of data points that must be present (•) in order to investigate the interval from <italic>x</italic><sub>n</sub> to <italic>x</italic><sub>n+1</sub> as a potential sudden gain is four, arranged in one of the patterns shown. Note that the pregain (<italic>x</italic><sub><italic>n</italic></sub>) and postgain (<italic>x</italic><sub><italic>x</italic>+1</sub>) data points must always be present. ∘ represents missing data.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Secondly, where values are missing in the period around the potential sudden gain, two approaches have been described to evaluate the stability of the change. Following the updated version of the third criterion by Tang and colleagues [<xref rid="pone.0230276.ref005" ref-type="bibr">5</xref>, <xref rid="pone.0230276.ref009" ref-type="bibr">9</xref>] some studies have used a critical value of 2.776 across all session to session intervals to check the stability [<xref rid="pone.0230276.ref013" ref-type="bibr">13</xref>]. An alternative approach adjusts the critical values used in criterion 3 (see <xref ref-type="disp-formula" rid="pone.0230276.e001">Eq 1</xref>) based on the data that were available in the period around the potential sudden gain [<xref rid="pone.0230276.ref011" ref-type="bibr">11</xref>]: Where no data are missing <italic>t</italic><sub>(4;97.5%)</sub> &gt; 2.776; where one datapoint is missing either before or after the gain <italic>t</italic><sub>(3;97.5%)</sub> &gt; 3.182; and where one datapoint is missing both before and after the gain <italic>t</italic><sub>(2;97.5%)</sub> &gt; 4.303. This method has been adopted in some subsequent studies [<xref rid="pone.0230276.ref020" ref-type="bibr">20</xref>, <xref rid="pone.0230276.ref021" ref-type="bibr">21</xref>].</p>
      <p>It is important to understand the reasons for missing data and consider whether methods to handle missing data need to be employed both at the identification stage and in subsequent analyses [<xref rid="pone.0230276.ref022" ref-type="bibr">22</xref>, <xref rid="pone.0230276.ref023" ref-type="bibr">23</xref>]. Further research to examine the impact of missing data and different methods to handle missing data when identifying sudden gains would be beneficial.</p>
    </sec>
    <sec id="sec005">
      <title>Terminology</title>
      <p>The naming of specific sessions (or measurement points) around the gain follows the convention that the session immediately prior to the gain is session <italic>N</italic> (also known as the <italic>pregain</italic> session), and the session immediately after is session <italic>N+1</italic> (or <italic>postgain</italic> session). Other sessions are referred to in relation to session <italic>N</italic> (e.g. <italic>N-2</italic>, <italic>N+3</italic>).</p>
    </sec>
    <sec id="sec006">
      <title>Reversals</title>
      <p>According to Tang and DeRubeis [<xref rid="pone.0230276.ref001" ref-type="bibr">1</xref>] a sudden gain is counted as reversed if 50% of the improvement made during the gain was lost at any subsequent point. For example, where the sudden gain represents a drop in score from 40 to 30 points, the gain is classed as having reversed if a score of 35 or more is observed at any later session. As discussed in Wucherpfennig et al. [<xref rid="pone.0230276.ref020" ref-type="bibr">20</xref>] a reversal might not necessarily be a stable phenomenon. These authors modified this criterion by suggesting that a stable reversal is present when a reversal is also classified as a sudden loss (see below).</p>
    </sec>
    <sec id="sec007">
      <title>Sudden losses</title>
      <p>Although less frequently studied than sudden gains, sudden losses represent the inverse phenomenon, where a participant shows a large and stable increase of scores on the outcome variable. While some authors invert the three sudden gains criteria [<xref rid="pone.0230276.ref011" ref-type="bibr">11</xref>, <xref rid="pone.0230276.ref024" ref-type="bibr">24</xref>], others further adjust the percentage threshold of the second criterion, e.g. 33% [<xref rid="pone.0230276.ref016" ref-type="bibr">16</xref>].</p>
    </sec>
  </sec>
  <sec id="sec008">
    <title>Why is a package needed?</title>
    <p>As indicated by the criteria above, identifying sudden gains requires the application of each of the three criteria to each session to session interval, and that this is performed for each individual in a given dataset. A large number of calculations and extensive manipulation of data is therefore involved, particularly in larger datasets. Doing these data manipulations manually (e.g. in spreadsheets) can be extremely time consuming and lead to errors. It also means that certain methodological decisions, such as determining the critical value for the third criterion, or handling of participants with multiple gains, may not be addressed sufficiently or in a consistent way across studies. It is hoped that the use of the <italic>suddengains</italic> package will provide faster and more accurate calculations, as well as offering a transparent and consistent method to address these methodological considerations.</p>
  </sec>
  <sec id="sec009">
    <title>Functions of the <italic>suddengains</italic> package</title>
    <p>The <italic>suddengains</italic> package provides a set of functions to calculate the presence of sudden gains (and sudden losses) within a longitudinal dataset, and to provide basic plots and descriptive statistics of the gains. It can also extract scores on secondary outcome or process measures around the period of each gain. Output files (in SPSS, Excel, or CSV formats) arranged by individual gain, or by person can be generated for further analyses in other programs. This package is supplemented by an interactive web application [<xref rid="pone.0230276.ref025" ref-type="bibr">25</xref>] <italic>shinygains</italic> that illustrates the main functions of this package at <ext-link ext-link-type="uri" xlink:href="https://milanwiedemann.shinyapps.io/shinygains/">https://milanwiedemann.shinyapps.io/shinygains/</ext-link>. As it allows users to explore and understand the impact of different methodological choices, it may be useful in planning sudden gains studies. <xref rid="pone.0230276.t002" ref-type="table">Table 2</xref> lists and describes the main functions.</p>
    <table-wrap id="pone.0230276.t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0230276.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Main functions of the <italic>suddengains</italic> R package.</title>
      </caption>
      <alternatives>
        <graphic id="pone.0230276.t002g" xlink:href="pone.0230276.t002"/>
        <table frame="box" rules="all" border="0">
          <colgroup span="1">
            <col align="left" valign="middle" span="1"/>
            <col align="left" valign="middle" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Function</th>
              <th align="left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Identify sudden gains</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> <monospace>define_crit1_cutoff()</monospace></td>
              <td align="left" rowspan="1" colspan="1">Uses RCI formula to help determine a cutoff value for criterion 1</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> <monospace>check_interval()</monospace></td>
              <td align="left" rowspan="1" colspan="1">Checks if a given interval is a sudden gain/loss</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> <monospace>identify_sg()</monospace>, <monospace>identify_sl()</monospace></td>
              <td align="left" rowspan="1" colspan="1">Identifies sudden gains/losses</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Create datasets</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> <monospace>create_bysg()</monospace>, <monospace>create_byperson()</monospace></td>
              <td align="left" rowspan="1" colspan="1">Creates a dataset with one row for each sudden gain/loss</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> <monospace>extract_values()</monospace></td>
              <td align="left" rowspan="1" colspan="1">Extracts values on a secondary measure around the sudden gain/loss</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Describe sudden gains</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> <monospace>describe_sg()</monospace></td>
              <td align="left" rowspan="1" colspan="1">Generates summary descriptive statistics</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> <monospace>plot_sg()</monospace>, <monospace>plot_sg_trajectories()</monospace></td>
              <td align="left" rowspan="1" colspan="1">Creates plots of the average sudden gain, or individual case trajectories</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>Additional functions</bold>
              </td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> <monospace>select_cases()</monospace></td>
              <td align="left" rowspan="1" colspan="1">Selects cases to be included in the sudden gains analysis</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"> <monospace>write_bysg()</monospace>, <monospace>write_byperson()</monospace></td>
              <td align="left" rowspan="1" colspan="1">Exports CSV, SPSS, Excel, or STATA files of the sudden gains datasets</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="t002fn001">
          <p><italic>Note</italic>. More details of each function can be found in the package documentation or using the help() function in R.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec id="sec010">
    <title>Worked example</title>
    <p>This demonstration uses a dataset (<monospace>sgdata</monospace>) that was created to illustrate the functions of this package. The data show self-report weekly questionnaire scores for 43 participants who have received psychological therapy for depression. The intervention lasted for 12 sessions, and each participant completed a set of outcome measures at the beginning of each session, including the BDI and a fictional secondary measure assessing rumination (RQ).</p>
    <sec id="sec011">
      <title>Preparation of data</title>
      <p>The data to be analysed for sudden gains are arranged in wide format i.e. one row per participant, and one column for each questionnaire score at each measurement point. A unique identifier variable also needs to be included. Some researchers have specified a minimum number of measurement points that must be present for participants to be included, to ensure that they received a sufficient amount of the intervention being studied [<xref rid="pone.0230276.ref001" ref-type="bibr">1</xref>]. Alternatively it may be of interest to analyse all cases whose data are distributed such that at least one interval can be examined for a potential sudden gain [<xref rid="pone.0230276.ref021" ref-type="bibr">21</xref>]; For all three criteria to be applied there must be data present for at least two of the three data points prior to, and two of the three following, the interval to be examined, see <xref rid="pone.0230276.t001" ref-type="table">Table 1</xref>. The optional <monospace>select_cases()</monospace> function can be used to identify samples of cases for analysis who fulfil such conditions, though researchers should consider whether these methods are appropriate for the aims of the study.</p>
    </sec>
    <sec id="sec012">
      <title>Identification of sudden gains</title>
      <p>The <monospace>identify_sg()</monospace> function applies the sudden gains criteria as specified by the user to each session to session interval in the dataset. As shown below, the user specifies: <monospace>data</monospace>, the dataset to use in wide format; <monospace>sg_crit1_cutoff</monospace>, the cutoff value to use for criterion 1 (which can be entered manually or calculated using the <monospace>define_crit1_cutoff()</monospace> function); <monospace>sg_crit2_pct</monospace>, the percentage change value to use for criterion 2 (0.25 by default); <monospace>sg_crit3</monospace>, whether or not to apply the third criterion (<monospace>TRUE</monospace> by default); <monospace>sg_crit3_alpha</monospace>, the alpha value to use when calculating the criterion 3 critical value (0.05 by default); <monospace>id_var_name</monospace>, the name of the unique identifier variable within the dataset; and <monospace>sg_var_list</monospace>, a list of the variables representing the span of sessions to be analysed, which is sessions 1 to 12 in this example. By default all functions that identify sudden gains apply the adjustment of the critical value in <xref ref-type="disp-formula" rid="pone.0230276.e001">Eq 1</xref> as described by Lutz and colleagues [<xref rid="pone.0230276.ref011" ref-type="bibr">11</xref>]. To turn off this adjustment and instead apply a manually defined critical value across all session to session intervals, the argument <monospace>sg_crit3_adjust = FALSE</monospace> can be included and <monospace>sg_crit3_critical_value</monospace> specified. Additional options to customise this analysis are discussed in the package documentation. An alternative function, <monospace>identify_sl()</monospace>, is identical to <monospace>identify_sg()</monospace> but applies the criteria in the inverse direction to calculate sudden losses. The function <monospace>check_interval()</monospace> can be used to examine whether a specific session to session interval is a sudden gain/loss.</p>
      <p specific-use="line"># First, install and load the suddengains R package</p>
      <p specific-use="line">install.packages(“suddengains”)</p>
      <p specific-use="line">library(suddengains)</p>
      <p specific-use="line"><italic># Identify sudden gains in the dataset “sgdata”</italic>:</p>
      <p specific-use="line">identify_sg(data = sgdata,</p>
      <p specific-use="line">    sg_crit1_cutoff = 7,</p>
      <p specific-use="line">    sg_crit2_pct = 0.25,</p>
      <p specific-use="line">    sg_crit3 = TRUE,</p>
      <p specific-use="line">    id_var_name = “id”,</p>
      <p specific-use="line">    sg_var_list = c(“bdi_s1”, “bdi_s2”, “bdi_s3”, “bdi_s4”,</p>
      <p specific-use="line">         “bdi_s5”, “bdi_s6”, “bdi_s7”, “bdi_s8”,</p>
      <p specific-use="line">         “bdi_s9”, “bdi_s10”, “bdi_s11”, “bdi_s12”),</p>
      <p specific-use="line">    crit123_details = TRUE)</p>
      <p>The output data frame shows each session to session interval, for example <monospace>sg_2to3</monospace> representing the interval between sessions two and three. Variables indicate whether each of the three criteria were met and therefore whether a sudden gain was observed for each interval. Sudden gains are indicated by a value of 1, see <xref rid="pone.0230276.t003" ref-type="table">Table 3</xref>. Examining this interval in our example data, we see that only <monospace>id</monospace> = 10 meets all three criteria, for <monospace>id</monospace> = 2 none of the three criteria can be tested, for <monospace>id</monospace> = 18 only the third criterion can not be tested, for all other participants at least one criterion is not met.</p>
      <table-wrap id="pone.0230276.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230276.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>A sample of the output data frame created by the <monospace>identify_sg()</monospace> function.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0230276.t003g" xlink:href="pone.0230276.t003"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">
                  <monospace>id</monospace>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <monospace>sg_crit1_2to3</monospace>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <monospace>sg_crit2_2to3</monospace>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <monospace>sg_crit3_2to3</monospace>
                </th>
                <th align="left" rowspan="1" colspan="1">
                  <monospace>sg_2to3</monospace>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">FALSE</td>
                <td align="left" rowspan="1" colspan="1">FALSE</td>
                <td align="left" rowspan="1" colspan="1">FALSE</td>
                <td align="left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>NA</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>NA</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>NA</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>NA</italic>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">10</td>
                <td align="left" rowspan="1" colspan="1">TRUE</td>
                <td align="left" rowspan="1" colspan="1">TRUE</td>
                <td align="left" rowspan="1" colspan="1">TRUE</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">12</td>
                <td align="left" rowspan="1" colspan="1">TRUE</td>
                <td align="left" rowspan="1" colspan="1">FALSE</td>
                <td align="left" rowspan="1" colspan="1">FALSE</td>
                <td align="left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">18</td>
                <td align="left" rowspan="1" colspan="1">FALSE</td>
                <td align="left" rowspan="1" colspan="1">FALSE</td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>NA</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>NA</italic>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">23</td>
                <td align="left" rowspan="1" colspan="1">FALSE</td>
                <td align="left" rowspan="1" colspan="1">FALSE</td>
                <td align="left" rowspan="1" colspan="1">TRUE</td>
                <td align="left" rowspan="1" colspan="1">0</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t003fn001">
            <p><italic>Note</italic>. For the variables testing the three sudden gains criteria, referred to by ‘crit1’, ‘crit2’, and ‘crit3’ in the variable names TRUE indicates that the criterion is met, while FALSE indicates the criterion is not met. <italic>NA</italic> indicates that a particular criterion could not be tested for a sudden gain due to missing data.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>To permit further analysis of our data, we wish to obtain an output dataset containing both the original data and the newly identified sudden gains. As participants may experience more than one gain, as in the present example, and to allow for different subsequent analyses, the package provides two options for output datasets: The <monospace>create_bysg()</monospace> function creates a dataset structured with one row per sudden gain, and the <monospace>create_byperson()</monospace> function creates a dataset structured with one row per person, indicating whether or not they experienced a sudden gain. The <monospace>tx_start_var_name</monospace> and <monospace>tx_end_var_name</monospace> arguments are used to specify the start and end of treatment (tx) variables, and <monospace>sg_measure_name</monospace> specifies the name of the measure used to calculate sudden gains.</p>
      <p specific-use="line"># Create output dataset with one row per sudden gain</p>
      <p specific-use="line"># and save as an object called “bysg” to use later</p>
      <p specific-use="line">bysg &lt;- create_bysg(data = sgdata,</p>
      <p specific-use="line">        sg_crit1_cutoff = 7,</p>
      <p specific-use="line">        sg_crit2_pct = 0.25,</p>
      <p specific-use="line">        sg_crit3 = TRUE,</p>
      <p specific-use="line">        id_var_name = “id”,</p>
      <p specific-use="line">        tx_start_var_name = “bdi_s1”,</p>
      <p specific-use="line">        tx_end_var_name = “bdi_s12”,</p>
      <p specific-use="line">        sg_var_list = c(“bdi_s1”, “bdi_s2”, “bdi_s3”,</p>
      <p specific-use="line">             “bdi_s4”, “bdi_s5”, “bdi_s6”,</p>
      <p specific-use="line">             “bdi_s7”, “bdi_s8”, “bdi_s9”,</p>
      <p specific-use="line">             “bdi_s10”, “bdi_s11”, “bdi_s12”),</p>
      <p specific-use="line">        sg_measure_name = “bdi”)</p>
      <p>The new variables created by the <monospace>create_bysg()</monospace> and <monospace>create_byperson()</monospace> functions are described in <xref rid="pone.0230276.t004" ref-type="table">Table 4</xref>. To continue working in another program (e.g. SPSS, STATA, Excel) the functions <monospace>write_bysg()</monospace> and <monospace>write_byperson()</monospace> can be used to export the datasets created in R [<xref rid="pone.0230276.ref026" ref-type="bibr">26</xref>] as .<italic>sav</italic>, .<italic>dta</italic>, .<italic>xlsx</italic>, or .<italic>csv</italic> files.</p>
      <table-wrap id="pone.0230276.t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230276.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>Description of variables created by the <monospace>create_bysg()</monospace> and <monospace>create_byperson()</monospace> functions.</title>
        </caption>
        <alternatives>
          <graphic id="pone.0230276.t004g" xlink:href="pone.0230276.t004"/>
          <table frame="box" rules="all" border="0">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Variable Name</th>
                <th align="left" rowspan="1" colspan="1">Variable Label</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>id_sg</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Unique ID variable for every identified sudden gain / loss</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_crit123</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Indicates whether all applied sudden gain criteria were met (No = 0; Yes = 1)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_session_n</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Pregain session number</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_freq_byperson</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Frequency of sudden gains / losses per person</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_bdi_2n</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Pre-pre-pre gain session score (N-2)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_bdi_1n</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Pre-pre gain session score (N-1)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_bdi_n</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Pre-gain session score (N)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_bdi_n1</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Post-gain session score (N+1)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_bdi_n2</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Post-post gain session score (N+2)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_bdi_n3</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Post-post-post gain session score (N+3)</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_magnitude</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Raw magnitude of sudden gain</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_bdi_tx_change</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Total change during treatment</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_change_proportion</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Proportion of total change represented by the sudden gain</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_reversal_value</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Reversal value</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <monospace>sg_reversal</monospace>
                </td>
                <td align="left" rowspan="1" colspan="1">Indicates whether the reversal value was met at any point in treatment following the sudden gain (No = 0; Yes = 1)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t004fn001">
            <p><italic>Note</italic>. The variable names listed including <monospace>_bdi_</monospace> will reflect the name of the measure specified in the <monospace>sg_measure_name</monospace> argument.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec id="sec013">
      <title>Analysis of sudden gains</title>
      <p>In this example, we have calculated sudden gains based on depression scores using the BDI. In analysing these gains, we are interested in how rumination scores on the fictional RQ measure change around the period of the sudden gains in depression. The <monospace>extract_values()</monospace> function extracts the RQ values from the three sessions before (<italic>N-2</italic>, <italic>N-1</italic>, <italic>N</italic>) and the three sessions after (<italic>N+1</italic>, <italic>N+2</italic>, <italic>N+3</italic>) each depression sudden gain. In the dataset that gets returned by this function we refer to these sessions as sg_bdi_<bold>2n</bold>, sg_bdi_<bold>1n</bold>, sg_bdi_<bold>n</bold>, sg_bdi_<bold>n1</bold>, sg_bdi_<bold>n2</bold>, and sg_bdi_<bold>n3</bold>, respectively. This function can be applied to either the <monospace>bysg</monospace> or <monospace>byperson</monospace> dataset. By default the extracted values will be added as new variables to the dataset used. Here we demonstrate applying this function to the <monospace>bysg</monospace> dataset, as shown in the code below. First, the RQ variables are added to the <monospace>bysg</monospace> dataset. Second, the <monospace>extract_values()</monospace> function is applied. Note that the list of RQ variables included in the <monospace>extract_var_list</monospace> argument must match those used for the <monospace>sg_var_list</monospace> argument used previously in the <monospace>create_bysg()</monospace> function. This means that the number of variables in these lists has to be identical and measured at the same timepoints. The output data frame can be saved as a new object, or the existing <monospace>bysg</monospace> object can be overwritten, as in this example. The RQ scores now in the <monospace>bysg</monospace> dataset can be examined, for example to look at the temporal relationship between changes in rumination and changes in depression symptoms.</p>
      <p specific-use="line"># 1. Select the ID and variables from a second measure</p>
      <p specific-use="line">sgdata_rq &lt;- dplyr::select(sgdata,</p>
      <p specific-use="line">          “id”,</p>
      <p specific-use="line">          “rq_s1”, “rq_s2”, “rq_s3”,</p>
      <p specific-use="line">          “rq_s4”, “rq_s5”, “rq_s6”,</p>
      <p specific-use="line">          “rq_s7”, “rq_s8”, “rq_s9”,</p>
      <p specific-use="line">          “rq_s10”, “rq_s11”, “rq_s12”)</p>
      <p specific-use="line"># 2. Add variables in ‘sgdata rq’ to the ‘bysg’ dataset created earlier</p>
      <p specific-use="line">bysg &lt;- dplyr::left_join(bysg, sgdata_rq, by = “id”)</p>
      <p specific-use="line"># 3. Extract values on the second measure around the sudden gain</p>
      <p specific-use="line">bysg &lt;- extract_values(data = bysg,</p>
      <p specific-use="line">         id_var_name = “id_sg”,</p>
      <p specific-use="line">         extract_var_list = c(“rq_s1”, “rq_s2”, “rq_s3”,</p>
      <p specific-use="line">                 “rq_s4”, “rq_s5”, “rq_s6”,</p>
      <p specific-use="line">                 “rq_s7”, “rq_s8”, “rq_s9”,</p>
      <p specific-use="line">                 “rq_s10”, “rq_s11”, “rq_s12”),</p>
      <p specific-use="line">         extract_measure_name = “rq”,</p>
      <p specific-use="line">         add_to_data = TRUE)</p>
      <p>The <monospace>describe_sg()</monospace> function provides descriptive statistics about the sudden gains based on the variables from the <monospace>bysg</monospace> and <monospace>byperson</monospace> datasets. For the present example, this function indicates that 16 of the 43 participants experienced a sudden gain, and 9 experienced more than one gain, leading to a total of 26 sudden gains within the data. Information on the mean gain magnitude and reversals is also provided.</p>
      <p>The <monospace>plot_sg()</monospace> function plots the average sudden gain, and can be used to show the primary or secondary outcome measure data (<xref ref-type="fig" rid="pone.0230276.g001">Fig 1A and 1B</xref>). The <monospace>sg_pre_post_var_list</monospace> argument specifies the pregain and postgain variables to be plotted, namely sessions <italic>N-2</italic> to <italic>N+3</italic>. This function is built using the R Package <italic>ggplot2</italic> [<xref rid="pone.0230276.ref027" ref-type="bibr">27</xref>] and additional <italic>ggplot2</italic> functions can be added to the plot. It is also possible to plot the average gain magnitude of different groups (e.g. two treatment arms in a trial) in one figure by using the optional <monospace>group</monospace> argument (see <xref ref-type="fig" rid="pone.0230276.g001">Fig 1C</xref>).</p>
      <fig id="pone.0230276.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230276.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Plots of average changes around sudden gains.</title>
          <p>(A) Average gain magnitude on the BDI across all sudden gains (B) Average changes in rumination (RQ) around sudden gains on the BDI. (C) Average gain magnitude on the BDI for two different treatments.</p>
        </caption>
        <graphic xlink:href="pone.0230276.g001"/>
      </fig>
      <p specific-use="line"><italic># Create average sudden gain plot for BDI data</italic> (<italic>see</italic>
<xref ref-type="fig" rid="pone.0230276.g001">Fig 1A</xref>):</p>
      <p specific-use="line">plot_sg(data = bysg,</p>
      <p specific-use="line">   id_var_name = “id”,</p>
      <p specific-use="line">   tx_start_var_name = “bdi_s1”,</p>
      <p specific-use="line">   tx_end_var_name = “bdi_s12”,</p>
      <p specific-use="line">   sg_pre_post_var_list = c(“sg_bdi_2n”, “sg_bdi_1n”, “sg_bdi_n”,</p>
      <p specific-use="line">            “sg_bdi_n1“, “sg_bdi_n2”, “sg_bdi_n3”),</p>
      <p specific-use="line">   ylab = “BDI”)</p>
      <p>An additional function, <monospace>plot_sg_trajectories()</monospace>, is available to plot the trajectories of a selection of individual cases within the dataset (see <xref ref-type="fig" rid="pone.0230276.g002">Fig 2A</xref>). This function can be paired with a filter command, for example <monospace>filter()</monospace> from the R Package <italic>dplyr</italic> [<xref rid="pone.0230276.ref028" ref-type="bibr">28</xref>], to visualise trajectories of specific groups of participants. For example, all participants with more than one sudden gain, or all participants with a sudden gain between sessions 3 and 4 (see <xref ref-type="fig" rid="pone.0230276.g002">Fig 2B</xref>).</p>
      <fig id="pone.0230276.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0230276.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Plots of trajectories for selected cases.</title>
          <p>(A) Trajectories for a selection of individual cases. (B) Trajectories of BDI scores for all participants with a sudden gain between sessions 3 and 4.</p>
        </caption>
        <graphic xlink:href="pone.0230276.g002"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec014">
    <title>Discussion</title>
    <p>The analysis of sudden gains and losses provides a detailed examination of within-participant changes during the course of an intervention, and may help to understand individual processes of change. The <italic>suddengains</italic> package aims to facilitate the computation of gains, which can be laborious and error-prone. It also aims to address common methodological issues, for example by allowing adjustments to the critical value for the third criterion in the presence of missing data, and by highlighting participants with multiple gains.</p>
    <p>Limitations of the package include the fact that more substantial adaptations to the standard criteria cannot currently be implemented, though as the underlying code is publically available, researchers may wish to use this in combination with other tools for further development work. Second, while the package may significantly increase the speed and accuracy of calculations, it cannot and should not substitute considered methodological thinking. In particular, users should consider carefully the appropriateness of the methods selected within each function, including related assumptions and limitations. Lastly it should be emphasised that sudden gains and losses identified by applying a set of mathematical criteria are not necessarily related to the effects of the intervention being studied, and that further investigation would be required to establish the presence and strength of evidence for a causal relationship.</p>
    <p>Overall, it is hoped that this package will permit faster and more transparent examination of sudden gains within a range of longitudinal datasets, and that it could provide a valuable tool to explore how the criteria might be refined or adapted to better identify gains that reflect meaningful change processes.</p>
  </sec>
</body>
<back>
  <ack>
    <p>Earlier versions of this manuscript were written using the R package <italic>papaja</italic> [<xref rid="pone.0230276.ref029" ref-type="bibr">29</xref>].</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0230276.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>TZ</given-names></name>, <name><surname>DeRubeis</surname><given-names>RJ</given-names></name>. <article-title>Sudden gains and critical sessions in cognitive-behavioral therapy for depression</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>1999</year>;<volume>67</volume>: <fpage>894</fpage>–<lpage>904</lpage>. <pub-id pub-id-type="doi">10.1037//0022-006x.67.6.894</pub-id><?supplied-pmid 10596511?><pub-id pub-id-type="pmid">10596511</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Aderka</surname><given-names>IM</given-names></name>, <name><surname>Nickerson</surname><given-names>A</given-names></name>, <name><surname>Boe</surname><given-names>HJ</given-names></name>, <name><surname>Hofmann</surname><given-names>SG</given-names></name>. <article-title>Sudden gains during psychological treatments of anxiety and depression: A meta-analysis</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>2012</year>;<volume>80</volume>: <fpage>93</fpage>–<lpage>101</lpage>. <pub-id pub-id-type="doi">10.1037/a0026455</pub-id><?supplied-pmid 22122290?><pub-id pub-id-type="pmid">22122290</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Vittengl</surname><given-names>JR</given-names></name>, <name><surname>Clark</surname><given-names>LA</given-names></name>, <name><surname>Jarrett</surname><given-names>RB</given-names></name>. <article-title>Validity of sudden gains in acute phase treatment of depression</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>2005</year>;<volume>73</volume>: <fpage>173</fpage>–<lpage>182</lpage>. <pub-id pub-id-type="doi">10.1037/0022-006X.73.1.173</pub-id><?supplied-pmid 15709845?><pub-id pub-id-type="pmid">15709845</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Vittengl</surname><given-names>JR</given-names></name>, <name><surname>Clark</surname><given-names>LA</given-names></name>, <name><surname>Thase</surname><given-names>ME</given-names></name>, <name><surname>Jarrett</surname><given-names>RB</given-names></name>. <article-title>Detecting sudden gains during treatment of major depressive disorder: Cautions from a monte carlo analysis</article-title>. <source>Current Psychiatry Reviews</source>. <year>2015</year>;<volume>11</volume>: <fpage>19</fpage>–<lpage>31</lpage>. <pub-id pub-id-type="doi">10.2174/1573400510666140929195441</pub-id><?supplied-pmid 26478724?><pub-id pub-id-type="pmid">26478724</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>TZ</given-names></name>, <name><surname>DeRubeis</surname><given-names>RJ</given-names></name>, <name><surname>Beberman</surname><given-names>R</given-names></name>, <name><surname>Pham</surname><given-names>T</given-names></name>. <article-title>Cognitive changes, critical sessions, and sudden gains in cognitive-behavioral therapy for depression</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>2005</year>;<volume>73</volume>: <fpage>168</fpage>–<lpage>172</lpage>. <pub-id pub-id-type="doi">10.1037/0022-006X.73.1.168</pub-id><?supplied-pmid 15709844?><pub-id pub-id-type="pmid">15709844</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref006">
      <label>6</label>
      <mixed-citation publication-type="book"><name><surname>Beck</surname><given-names>AT</given-names></name>, <name><surname>Steer</surname><given-names>RA</given-names></name>. <source>Beck Depression Inventory Manual</source>. <publisher-loc>San Antonio, TX</publisher-loc>: <publisher-name>The Psychological Corporation</publisher-name>; <year>1993</year>.</mixed-citation>
    </ref>
    <ref id="pone.0230276.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Jacobson</surname><given-names>NS</given-names></name>, <name><surname>Truax</surname><given-names>PA</given-names></name>. <article-title>Clinical significance: A statistical approach to defining meaningful change in psychotherapy research</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>1991</year>;<volume>59</volume>: <fpage>12</fpage>–<lpage>19</lpage>. <pub-id pub-id-type="doi">10.1037//0022-006x.59.1.12</pub-id><?supplied-pmid 2002127?><pub-id pub-id-type="pmid">2002127</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Stiles</surname><given-names>WB</given-names></name>, <name><surname>Leach</surname><given-names>C</given-names></name>, <name><surname>Barkham</surname><given-names>M</given-names></name>, <name><surname>Lucock</surname><given-names>M</given-names></name>, <name><surname>Iveson</surname><given-names>S</given-names></name>, <name><surname>Shapiro</surname><given-names>DA</given-names></name>, <etal>et al</etal><article-title>Early sudden gains in psychotherapy under routine clinic conditions: Practice-based evidence</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>2003</year>;<volume>71</volume>: <fpage>14</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1037/0022-006X.71.1.14</pub-id><?supplied-pmid 12602421?><pub-id pub-id-type="pmid">12602421</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref009">
      <label>9</label>
      <mixed-citation publication-type="book"><name><surname>Tang</surname><given-names>TZ</given-names></name>. <chapter-title>Sudden gains</chapter-title> In: <name><surname>Cautin</surname><given-names>RL</given-names></name>, <name><surname>Lilienfeld</surname><given-names>SO</given-names></name>, editors. <source>The Encyclopedia of Clinical Psychology</source>. <publisher-loc>Hoboken, New Jersey</publisher-loc>: <publisher-name>Wiley-Blackwell</publisher-name>; <year>2015</year> pp. <fpage>2745</fpage>–<lpage>2751</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0230276.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Doane</surname><given-names>LS</given-names></name>, <name><surname>Feeny</surname><given-names>NC</given-names></name>, <name><surname>Zoellner</surname><given-names>LA</given-names></name>. <article-title>A preliminary investigation of sudden gains in exposure therapy for PTSD</article-title>. <source>Behaviour Research and Therapy</source>. <year>2010</year>;<volume>48</volume>: <fpage>555</fpage>–<lpage>560</lpage>. <pub-id pub-id-type="doi">10.1016/j.brat.2010.02.002</pub-id><?supplied-pmid 20304385?><pub-id pub-id-type="pmid">20304385</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Lutz</surname><given-names>W</given-names></name>, <name><surname>Ehrlich</surname><given-names>T</given-names></name>, <name><surname>Rubel</surname><given-names>J</given-names></name>, <name><surname>Hallwachs</surname><given-names>N</given-names></name>, <name><surname>Rottger</surname><given-names>M-A</given-names></name>, <name><surname>Jorasz</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>The ups and downs of psychotherapy: Sudden gains and sudden losses identified with session reports</article-title>. <source>Psychotherapy Research</source>. <year>2013</year>;<volume>23</volume>: <fpage>14</fpage>–<lpage>24</lpage>. <pub-id pub-id-type="doi">10.1080/10503307.2012.693837</pub-id><?supplied-pmid 22708586?><pub-id pub-id-type="pmid">22708586</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Hardy</surname><given-names>GE</given-names></name>, <name><surname>Cahill</surname><given-names>J</given-names></name>, <name><surname>Stiles</surname><given-names>WB</given-names></name>, <name><surname>Ispan</surname><given-names>C</given-names></name>, <name><surname>Macaskill</surname><given-names>N</given-names></name>, <name><surname>Barkham</surname><given-names>M</given-names></name>. <article-title>Sudden Gains in Cognitive Therapy for Depression: A Replication and Extension</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>2005</year>;<volume>73</volume>: <fpage>59</fpage>–<lpage>67</lpage>. <pub-id pub-id-type="doi">10.1037/0022-006X.73.1.59</pub-id><?supplied-pmid 15709832?><pub-id pub-id-type="pmid">15709832</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Zilcha-Mano</surname><given-names>S</given-names></name>, <name><surname>Eubanks</surname><given-names>CF</given-names></name>, <name><surname>Muran</surname><given-names>JC</given-names></name>. <article-title>Sudden gains in the alliance in cognitive behavioral therapy versus brief relational therapy</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>2019</year>;<volume>87</volume>: <fpage>501</fpage>–<lpage>509</lpage>. <pub-id pub-id-type="doi">10.1037/ccp0000397</pub-id><?supplied-pmid 31008637?><pub-id pub-id-type="pmid">31008637</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Barkham</surname><given-names>M</given-names></name>, <name><surname>Rees</surname><given-names>A</given-names></name>, <name><surname>Stiles</surname><given-names>WB</given-names></name>, <name><surname>Shapiro</surname><given-names>DA</given-names></name>, <name><surname>Hardy</surname><given-names>GE</given-names></name>, <name><surname>Reynolds</surname><given-names>S</given-names></name>. <article-title>Dose Effect relations in time-limited psychotherapy for depression</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>1996</year>;<volume>64</volume>: <fpage>927</fpage>–<lpage>935</lpage>. <pub-id pub-id-type="doi">10.1037//0022-006x.64.5.927</pub-id><?supplied-pmid 8916621?><pub-id pub-id-type="pmid">8916621</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Martinovich</surname><given-names>Z</given-names></name>, <name><surname>Saunders</surname><given-names>S</given-names></name>, <name><surname>Howard</surname><given-names>K</given-names></name>. <article-title>Some Comments on “Assessing Clinical Significance”</article-title>. <source>Psychotherapy Research</source>. <year>1996</year>;<volume>6</volume>: <fpage>124</fpage>–<lpage>132</lpage>. <pub-id pub-id-type="doi">10.1080/10503309612331331648</pub-id><?supplied-pmid 22242610?><pub-id pub-id-type="pmid">22242610</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>König</surname><given-names>J</given-names></name>, <name><surname>Karl</surname><given-names>R</given-names></name>, <name><surname>Rosner</surname><given-names>R</given-names></name>, <name><surname>Butollo</surname><given-names>W</given-names></name>. <article-title>Sudden gains in two psychotherapies for posttraumatic stress disorder</article-title>. <source>Behaviour Research and Therapy</source>. <year>2014</year>;<volume>60</volume>: <fpage>15</fpage>–<lpage>22</lpage>. <pub-id pub-id-type="doi">10.1016/j.brat.2014.06.005</pub-id><?supplied-pmid 25036539?><pub-id pub-id-type="pmid">25036539</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Jun</surname><given-names>JJ</given-names></name>, <name><surname>Zoellner</surname><given-names>LA</given-names></name>, <name><surname>Feeny</surname><given-names>NC</given-names></name>. <article-title>Sudden gains in prolonged exposure and sertraline for chronic PTSD</article-title>. <source>Depression and Anxiety</source>. <year>2013</year>;<volume>30</volume>: <fpage>607</fpage>–<lpage>613</lpage>. <pub-id pub-id-type="doi">10.1002/da.22119</pub-id><?supplied-pmid 23633445?><pub-id pub-id-type="pmid">23633445</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>TZ</given-names></name>, <name><surname>DeRubeis</surname><given-names>RJ</given-names></name>, <name><surname>Hollon</surname><given-names>SD</given-names></name>, <name><surname>Amsterdam</surname><given-names>J</given-names></name>, <name><surname>Shelton</surname><given-names>R</given-names></name>. <article-title>Sudden gains in cognitive therapy of depression and depression relapse/recurrence</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>2007</year>;<volume>75</volume>: <fpage>404</fpage>–<lpage>408</lpage>. <pub-id pub-id-type="doi">10.1037/0022-006X.75.3.404</pub-id><?supplied-pmid 17563157?><pub-id pub-id-type="pmid">17563157</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Shalom</surname><given-names>JG</given-names></name>, <name><surname>Gilboa-Schechtman</surname><given-names>E</given-names></name>, <name><surname>Atzil-Slonim</surname><given-names>D</given-names></name>, <name><surname>Bar-Kalifa</surname><given-names>E</given-names></name>, <name><surname>Hasson-Ohayon</surname><given-names>I</given-names></name>, <name><surname>van Oppen</surname><given-names>P</given-names></name>, <etal>et al</etal><article-title>Intraindividual variability in symptoms consistently predicts sudden gains: An examination of three independent datasets</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>2018</year>;<volume>86</volume>: <fpage>892</fpage>–<lpage>902</lpage>. <pub-id pub-id-type="doi">10.1037/ccp0000344</pub-id><?supplied-pmid 30335422?><pub-id pub-id-type="pmid">30335422</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Wucherpfennig</surname><given-names>F</given-names></name>, <name><surname>Rubel</surname><given-names>JA</given-names></name>, <name><surname>Hofmann</surname><given-names>SG</given-names></name>, <name><surname>Lutz</surname><given-names>W</given-names></name>. <article-title>Processes of change after a sudden gain and relation to treatment outcome—Evidence for an upward spiral</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>2017</year>;<volume>85</volume>: <fpage>1199</fpage>–<lpage>1210</lpage>. <pub-id pub-id-type="doi">10.1037/ccp0000263</pub-id><?supplied-pmid 29189035?><pub-id pub-id-type="pmid">29189035</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Wiedemann</surname><given-names>M</given-names></name>, <name><surname>Stott</surname><given-names>R</given-names></name>, <name><surname>Nickless</surname><given-names>A</given-names></name>, <name><surname>Beierl</surname><given-names>ET</given-names></name>, <name><surname>Wild</surname><given-names>J</given-names></name>, <name><surname>Warnock-Parkes</surname><given-names>E</given-names></name>, <etal>et al</etal><article-title>Cognitive processes associated with sudden gains in cognitive therapy for posttraumatic stress disorder in routine care</article-title>. <source>Journal of Consulting and Clinical Psychology</source>. <year>2020</year>.</mixed-citation>
    </ref>
    <ref id="pone.0230276.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Rubin</surname><given-names>DB</given-names></name>. <article-title>Inference and Missing Data</article-title>. <source>Biometrica</source>. <year>1976</year>;<volume>63</volume>: <fpage>581</fpage>–<lpage>592</lpage>. <pub-id pub-id-type="doi">10.1093/biomet/63.3.581</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Schafer</surname><given-names>JL</given-names></name>, <name><surname>Graham</surname><given-names>JW</given-names></name>. <article-title>Missing data: Our view of the state of the art</article-title>. <source>Psychological Methods</source>. <year>2002</year>;<volume>7</volume>: <fpage>147</fpage>–<lpage>177</lpage>. <pub-id pub-id-type="doi">10.1037/1082-989X.7.2.147</pub-id><?supplied-pmid 12090408?><pub-id pub-id-type="pmid">12090408</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Krüger</surname><given-names>A</given-names></name>, <name><surname>Ehring</surname><given-names>T</given-names></name>, <name><surname>Priebe</surname><given-names>K</given-names></name>, <name><surname>Dyer</surname><given-names>AS</given-names></name>, <name><surname>Steil</surname><given-names>R</given-names></name>, <name><surname>Bohus</surname><given-names>M</given-names></name>. <article-title>Sudden losses and sudden gains during a DBT-PTSD treatment for posttraumatic stress disorder following childhood sexual abuse</article-title>. <source>European Journal of Psychotraumatology</source>. <year>2014</year>;<volume>5</volume>: <fpage>24470</fpage><pub-id pub-id-type="doi">10.3402/ejpt.v5.24470</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Chang W, Cheng J, Allaire JJ, Xie Y and McPherson J. shiny: Web Application Framework for R. [Internet]. 2019. Available: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=shiny">https://CRAN.R-project.org/package=shiny</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref026">
      <label>26</label>
      <mixed-citation publication-type="other">R Core Team. R: A language and environment for statistical computing [Internet]. Vienna, Austria: R Foundation for Statistical Computing; 2018. Available: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/">https://www.R-project.org/</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref027">
      <label>27</label>
      <mixed-citation publication-type="other">Wickham H. ggplot2: Elegant graphics for data analysis [Internet]. Springer-Verlag New York; 2016. Available: <ext-link ext-link-type="uri" xlink:href="http://ggplot2.org">http://ggplot2.org</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref028">
      <label>28</label>
      <mixed-citation publication-type="other">Wickham H, François R, Henry L, Müller K. dplyr: A grammar of data manipulation [Internet]. 2018. Available: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0230276.ref029">
      <label>29</label>
      <mixed-citation publication-type="other">Aust F, Barth M. papaja: Create APA manuscripts with R Markdown [Internet]. 2018. Available: <ext-link ext-link-type="uri" xlink:href="https://github.com/crsh/papaja">https://github.com/crsh/papaja</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pone.0230276.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230276.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gnambs</surname>
          <given-names>Timo</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Timo Gnambs</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Timo Gnambs</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pone.0230276" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">19 Dec 2019</named-content>
    </p>
    <p>PONE-D-19-30704</p>
    <p>suddengains: An R package to identify sudden gains in longitudinal data</p>
    <p>PLOS ONE</p>
    <p>Dear Mr Wiedemann,</p>
    <p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE’s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p>
    <p>I have now received two reports by experts in the field and also read the manuscript myself. As you can see both reviewers evaluated your manuscript rather favorably and emphasized the important contribution of your work. At the same time, they also raised important shortcomings that need to be addressed before the manuscript can be accepted for publication. I will summarize the most important points and also include some points of my own:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>You define sudden gains as “large and stable changes … between two consecutive measurement points” (page 2, line 2). From this introduction, it was unclear to me how you might infer conclusions about the stability of change if you have only two measurements. In my opinion, it would require at least three measurements to make conclusions about the extent the observed change is stable or not. On page 3, you modified this claim by evaluating six measurement points in criterion 3. I think the definition of sudden gains needs to be more precise and should be modified accordingly.</p>
        </list-item>
        <list-item>
          <p>Equation (1) uses the standard deviation of the difference score. This represents the formula for two independent groups. Although it is also sometimes used for dependent samples, Cohen (1988) suggested including the correlation between the two measures. In situations, when the standard deviation is expected to change (such as in intervention studies) Glass and colleagues (1981) even recommended using the standard deviation of the pre-intervention measurement (you even refer to this approach on page 4, line 63). Thus, there is some discussion on the appropriate way of estimating the variance of difference scores. Please include a more thorough discussion on your choice of the standard deviation and in what way it seems more appropriate than the other suggestions.</p>
        </list-item>
      </list>
    </p>
    <p>Cohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences. New York, NY: Routledge Academic.</p>
    <p>Glass, G. V., McGaw, B., and Smith, M. L. (1981). Meta-Analysis in Social Research. Beverly Hills, CA: Sage.</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>Reviewer 1 raises an important point regarding the assumptions in your approach (e.g., unidimensionality, constant reliabilities). I would recommend being more explicit about the inherent assumptions (and limitations) of you statistical model.</p>
        </list-item>
        <list-item>
          <p>Your way of handling missing data seems suspect to me (page 5). I doubt you can appropriately account for missingness simply by adapting you significance level (Reviewer 1 also raises this point). Please make sure to thoroughly describe the assumptions underlying this approach and also refer to Rubin’s typology of missing mechanisms (MCAR, MAR, MNAR).</p>
        </list-item>
        <list-item>
          <p>What are the criteria for excluding respondents because “it would not be possible to identify any sudden gains” (page 8, line 138)? Looking at Table 2, it seems to me that you considered one measurement point before and at least two measurement points after the pregain session as a necessary requirement. Could you elaborate why? Moreover, criterion 3 on page 3 seems to indicate that at least three measurements before and after the pregain session are needed?</p>
        </list-item>
        <list-item>
          <p>Reviewer 2 has two suggestions for improving the package and increasing its usefulness for applied researchers. You might want to consider these points. However, their implementation is not a requirement for the publication of your manuscript.</p>
        </list-item>
      </list>
    </p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>Your worked example is only partially presented. I would recommend also including the output generated by the functions and providing a step by step interpretation of the printout.</p>
        </list-item>
      </list>
    </p>
    <p>In addition to these points, both reviewers made further excellent suggestions that you should consider in your revision. I strongly encourage you to address these issues and submit a revised version of your manuscript.</p>
    <p>We would appreciate receiving your revised manuscript by Feb 02 2020 11:59PM. When you are ready to submit your revision, log on to <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p>
    <p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter.</p>
    <p>To enhance the reproducibility of your results, we recommend that if applicable you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see: <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols">http://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link></p>
    <p>Please include the following items when submitting your revised manuscript:</p>
    <p>
      <list list-type="bullet">
        <list-item>
          <p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). This letter should be uploaded as separate file and labeled 'Response to Reviewers'.</p>
        </list-item>
        <list-item>
          <p>A marked-up copy of your manuscript that highlights changes made to the original version. This file should be uploaded as separate file and labeled 'Revised Manuscript with Track Changes'.</p>
        </list-item>
        <list-item>
          <p>An unmarked version of your revised paper without tracked changes. This file should be uploaded as separate file and labeled 'Manuscript'.</p>
        </list-item>
      </list>
    </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>We look forward to receiving your revised manuscript.</p>
    <p>Kind regards,</p>
    <p>Timo Gnambs</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Journal Requirements:</p>
    <p>
      <bold>When submitting your revision, we need you to address these additional requirements:</bold>
    </p>
    <p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/attachments/PLOSOne_formatting_sample_main_body.pdf">http://www.plosone.org/attachments/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/attachments/PLOSOne_formatting_sample_title_authors_affiliations.pdf">http://www.plosone.org/attachments/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link></p>
    <p>2. Please note that PLOS ONE has specific guidelines on software sharing (<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/s/materials-and-software-sharing#loc-sharing-software">http://journals.plos.org/plosone/s/materials-and-software-sharing#loc-sharing-software</ext-link>) for manuscripts whose main purpose is the description of a new software or software package. In this case, new software must conform to the Open Source Definition (<ext-link ext-link-type="uri" xlink:href="https://opensource.org/docs/osd">https://opensource.org/docs/osd</ext-link>) and be deposited in an open software archive.</p>
    <p>[Note: HTML markup is below. Please do not edit.]</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Partly</p>
    <p>**********</p>
    <p>2. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: N/A</p>
    <p>**********</p>
    <p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #1: The manuscript “suddengains: An R package to identify sudden gains in longitudinal data” describes the development and use of a statistical package to identify sudden gains in psychotherapy. The rationale for the development of the package is provided and its features and use are discussed.</p>
    <p>I believe that this manuscript is extremely important in the field of sudden gains research. As the authors noted, the application of sudden gains criteria has differed between studies, and the analyses and calculations are highly prone to errors. As a researcher in this field I think it is safe to assume that at least a moderate degree of variance and discrepancy between studies is due to applying criteria differently (e.g., changing vs. maintaining the critical value for the third criterion based on amount of missing data) and due to computational error. As a result, I found myself in complete agreement with the authors on the importance of having a standard package for computing sudden gains. I believe this can reduce some of the “error variance” that exists in the field.</p>
    <p>As part of my review, I compared the suddengains package with a complex, multi-tab excel spreadsheet that I had been using for the past few years to identify sudden gains. The results were identical. While it is more likely that I validated my excel file with the suddengains package than validated the package with my excel file, I believe this suggests that the main functions work without error.</p>
    <p>There are two potential features that I think could strengthen the package further. These are by no means necessary for publication as I believe the current features already represent a substantial contribution to the literature. However, if the authors have plans on updating the package in the future, I hope they consider these features. The first is the ability to chose the critical cutoff for the third criterion. As the authors noted, the third criterion is considered to be more a descriptive cutoff than a valid test of statistical significance. This has led some authors to change to the critical value to 2.5 for instance (Hardy et al., 2005). This option could be helpful in future versions. The second feature would be to allow for an altered 3rd criterion by using 1.5 standard deviations of symptom scores as a critical value. This has been done in many previous studies (e.g., Kelly et al. 2005; 2007). Allowing users to chose such an option could facilitate within-study comparisons of sudden gains identified using different criteria. I believe such a comparison could help the field decide on standard criteria based on empirical data.</p>
    <p>Overall, I think the manuscript and package represent an important contribution to the field of sudden gains and believe the package will be used by many researchers in the field.</p>
    <p>Reviewer #2: Review of the manuscript “suddengains: An R package to identify sudden gains in longitudinal data”</p>
    <p>The manuscript focuses important information on individual change, which can be investigated in longitudinal data (i.e., sudden gains &amp; losses). Central is the description and investigation of sudden gains. For the description of sudden gains, the authors consider specific identification criteria. Based on these criteria, they provide an R-package facilitating automated investigations of sudden gains. This should help to improve the efficiency, reporting, and reproducibility of sudden gains research.</p>
    <p>I support the basic idea of the authors that the R-package “suddengains” is a useful toolbox for applied researches. In addition to a function for obtaining sudden gains, the presented R package has very helpful add-ons, like an illustrative example, a function for creating new output datasets with sudden gains, and graphical functions for illustrating sudden gains and individual trajectories. The authors build on available state-of-the-art packages, like dplyr and ggplot2, and their functions are well documented.</p>
    <p>Despite my respect for developing such a useful R-package, I cannot recommend acceptance of the manuscript in the present form. Here is why: Every automation poses the risk of an unconsidered application of specific methods. In my view, this risk is not appropriately addressed in the manuscript, so far. The authors describe a very broad research field for investigating sudden gains with the presented package (p.2. line 8 – any longitudinal dataset with regular repeated measurement). I would encourage a much more detailed view on the context for the application of the R package, where the major limitations are:</p>
    <p>1) The authors specify specific criteria for the identification of sudden gains, but they do not review the incorporated assumptions. For instance, calculating the standard error of measurement (S_E) in Eq. 6 or 7 with a specific reliability estimate (retest reliability or Chronbach’s alpha) is only possible, when investigating unidimensional scales, for which such reliability estimates hold. Furthermore, even when unidimensionality holds, the reliability of a measure is not necessarily constant over time or persons (see e.g., models of Latent-State-Trait Theory, where multiple time points are considered and Chronbach’s alpha can be calculated for unidimensional scales at each time point, or Item-Response-Theory models, which allow for heterogeneous measurement error variance depending on the ability of a person). Using one reliability measure for all time points and individuals is a rough approximation to control for measurement error and alternative methods are available. I think, more details on the assumptions of the promoted methods would be beneficial, in order to describe the limitations of the related R-package.</p>
    <p>2) In the preparation of the data, the authors facilitate the exclusion of specific cases, when not enough data points are available to identify sudden gains. They clearly describe which cases have to be excluded. However, the assumptions for and the consequences of excluding persons are not mentioned. This is especially important when conducting subsequent analyses, which are encouraged by the presented R-package. When excluding persons with missing data that is not completely at random, then subsequent results can be biased.</p>
    <p>3) A further (minor) comment addresses the statements on the meaning of sudden gains. The authors use a descriptive, databased view on sudden gains. This is appropriate for obtaining such events in the data. However, at the same time they address the meaning of sudden gains, for instance, on page 2 line 20-22 they refer to the meaning of sudden gains in placebo interventions. A clear meaning of sudden gains as effects of an intervention would require a more formal specification of sudden gains as causal effects of the intervention. Accordingly, further (design or analysis) conditions need to hold, for ruling out alternative explanations. I would clearly distinguish between obtaining sudden gains and their meaning.</p>
    <p>To sum up, I encourage a revision of the manuscript - especially for the description of the methods and the discussion. Possible limitations of the methods and the related R package should be included. As such, the circumstances under which the application of the R-package is appropriate would be clearer. I would also appreciate a more detailed view on the meaning of sudden gains. In my view, the suggested changes can support reproducibility of sudden gains research, which is one of the author’s goals.</p>
    <p>**********</p>
    <p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: Yes: Idan M Aderka</p>
    <p>Reviewer #2: No</p>
    <p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files to be viewed.]</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com/">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p>
  </body>
</sub-article>
<sub-article id="pone.0230276.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230276.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pone.0230276" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">4 Feb 2020</named-content>
    </p>
    <p>Editor’s comments:</p>
    <p>E#1. You define sudden gains as “large and stable changes … between two consecutive measurement points” (page 2, line 2). From this introduction, it was unclear to me how you might infer conclusions about the stability of change if you have only two measurements. In my opinion, it would require at least three measurements to make conclusions about the extent the observed change is stable or not. On page 3, you modified this claim by evaluating six measurement points in criterion 3. I think the definition of sudden gains needs to be more precise and should be modified accordingly.</p>
    <p>RESPONSE: Thank you for raising this, having looked again we appreciate the wording was unclear - while ‘large and stable’ tends to be how gains are conceptualised in a broad sense, it is true that stability is evaluated not on 2 points, but on 6 as described later. We have amended the first sentence of the introduction to make this clearer (Page 2):</p>
    <p>“A sudden gain is a large improvement in an outcome variable experienced by an individual participant between two consecutive measurement points that is stable within a longitudinal data series.”</p>
    <p>E#2. Equation (1) uses the standard deviation of the difference score. This represents the formula for two independent groups. Although it is also sometimes used for dependent samples, Cohen (1988) suggested including the correlation between the two measures. In situations, when the standard deviation is expected to change (such as in intervention studies) Glass and colleagues (1981) even recommended using the standard deviation of the pre-intervention measurement (you even refer to this approach on page 4, line 63). Thus, there is some discussion on the appropriate way of estimating the variance of difference scores. Please include a more thorough discussion on your choice of the standard deviation and in what way it seems more appropriate than the other suggestions. </p>
    <p>Cohen, J. (1988). Statistical Power Analysis for the Behavioral Sciences. New York, NY: Routledge Academic.</p>
    <p>Glass, G. V., McGaw, B., and Smith, M. L. (1981). Meta-Analysis in Social Research. Beverly Hills, CA: Sage.</p>
    <p>RESPONSE: You rightly raise this issue, one that has been discussed in various sudden gains papers. Our use of the standard deviation is primarily driven by how Criterion 3 was originally defined by Tang and colleagues (1999, 2005, 2015) and has been subsequently applied in the literature. Our view is that for the R package to be useful it needs to be able to apply the criteria using the methods that are ‘standard’ for the field in order to allow comparability between studies. However, we also agree with the point raised by Reviewer 2 that we want to avoid the ‘unconsidered application’ of the package, so have edited the manuscript to make clearer the situations where there are methodological alternatives, and to make clearer references to studies that explore limitations and criticisms of the ‘standard’ approach. An empirical investigation comparing the standard approach with the Cohen and Glass methods would indeed be valuable for the field, and it is hoped that the open code of this package could facilitate such a study (note that we have recorded this as a suggested ‘issue’ on the package GitHub page, see <ext-link ext-link-type="uri" xlink:href="https://github.com/milanwiedemann/suddengains/issues/23">https://github.com/milanwiedemann/suddengains/issues/23</ext-link>).</p>
    <p>E#3. Reviewer 1 raises an important point regarding the assumptions in your approach (e.g., unidimensionality, constant reliabilities). I would recommend being more explicit about the inherent assumptions (and limitations) of you statistical model.</p>
    <p>RESPONSE: Thank you - as described above we have examined the full manuscript in order to be more explicit in describing the relevant assumptions and limitations. We have improved the referencing of papers that discuss common limitations and relevant methodological issues. The assumptions of unidimensionality and constant reliabilities are now discussed on Page 5:</p>
    <p>“Note that the use of the test-retest reliability or Cronbach’s alpha when calculating SE makes the assumption that the scale being examined is unidimensional, and that these reliability estimates remain constant over time, and between individuals. Researchers should consider exploring the factor structure and measurement invariance of the scale to examine if these assumptions hold.”</p>
    <p>E#4. Your way of handling missing data seems suspect to me (page 5). I doubt you can appropriately account for missingness simply by adapting you significance level (Reviewer 1 also raises this point). Please make sure to thoroughly describe the assumptions underlying this approach and also refer to Rubin’s typology of missing mechanisms (MCAR, MAR, MNAR).</p>
    <p>RESPONSE: We have made a number of changes to the section on missing data including making reference to reservations in the literature about the suitability of common replacement approaches for sudden gains research. It was not our intention to suggest that the adjustment of the critical value in Criterion 3 is sufficient to fully account for missingness - we have reworded this to be clear that this is one approach that has been suggested and used in the literature, but that further work to examine missing data within sudden gains research is warranted. </p>
    <p>As the classification of missing data types (e.g. MCAR, MAR, MNAR) will vary from study to study we have opted to make reference to Rubin’s work and encourage researchers to consider the reasons why data may be missing and what methods may need to be employed as a result. This applies principally to the identification of gains themselves, where replacing missing data might lead to identifying “false gains” and is not therefore appropriate. However, different methods for handling missing data may be appropriate for subsequent analyses, so we have now mentioned this at the end of the section.</p>
    <p>“Missing data, for example where a participant does not provide data on one or more occasions, need to be considered carefully when identifying sudden gains for several reasons. Firstly, depending on the number and pattern of missing data points for an individual, it may not be possible to identify sudden gains, see Table 2. Specifically, in order to estimate the standard deviation values in criterion 3, at least two of the three measurements immediately prior to the gain must be present, as well as at least two of the three measurements immediately following the gain. Some researchers have suggested that methods used to replace missing values, such as last observation carried forward or multiple imputation, may not be appropriate when identifying sudden gains given the potential for additional gains to be detected based on data that were not provided by participants [20,21].</p>
    <p>Secondly, where values are missing in the period around the potential sudden gain, two approaches have been described to evaluate the stability of the change. Following the updated version of the third criterion by Tang and colleagues [5,9] some studies have used a critical value of 2.776 across all session to session intervals to check the stability [17]. An alternative approach adjusts the critical values used in criterion 3 (see Eq 1) based on the data that were available in the period around the potential sudden gain [16]: Where no data are missing t(4;97.5%) &gt; 2.776; where one datapoint is missing either before or after the gain t(3;97.5%) &gt; 3.182; and where one datapoint is missing both before and after the gain t(2;97.5%) &gt; 4.303. This method has been adopted in some subsequent studies [22,24].</p>
    <p>It is important to understand the reasons for missing data and consider whether methods to handle missing data need to be employed both at the identification stage and in subsequent analyses [18,19]. Further research to examine the impact of missing data and different methods to handle missing data when identifying sudden gains would be beneficial.”</p>
    <p>E#5. What are the criteria for excluding respondents because “it would not be possible to identify any sudden gains” (page 8, line 138)? Looking at Table 2, it seems to me that you considered one measurement point before and at least two measurement points after the pregain session as a necessary requirement. Could you elaborate why? Moreover, criterion 3 on page 3 seems to indicate that at least three measurements before and after the pregain session are needed?</p>
    <p>RESPONSE: We have revised the explanation of the select_cases() function to better characterise its use. Some published studies have set a minimum number of datapoints that must be present in order to be included in the analysis, and others have analysed only cases with sufficient data for at least one session-to-session to be tested. The select_cases() function is optional and can be used to apply such conditions should researchers wish. The lowest number of datapoints for a single participant that could still show a sudden gain is four, provided they are arranged in one of the patterns shown in Table 2. We have revised Table 2 in order to improve clarity about these patterns, as well as making a more explicit statement about the minimum amount of data required (Page 9):</p>
    <p>“For all three criteria to be applied there must be data present for at least two of the three data points prior to, and two of the three following, the interval to be examined.”</p>
    <p>E#6. Reviewer 2 has two suggestions for improving the package and increasing its usefulness for applied researchers. You might want to consider these points. However, their implementation is not a requirement for the publication of your manuscript.</p>
    <p>RESPONSE: Thank you, we are grateful for these helpful suggestions and have responded to the specific ideas below.</p>
    <p>E#7. Your worked example is only partially presented. I would recommend also including the output generated by the functions and providing a step by step interpretation of the printout.</p>
    <p>RESPONSE: We have added additional text and tables to provide explanations of the output at each stage (pages 10-12) so that the worked example is clearer to follow. </p>
    <p>In addition to these points, both reviewers made further excellent suggestions that you should consider in your revision. I strongly encourage you to address these issues and submit a revised version of your manuscript.</p>
    <p>Reviewer 1: </p>
    <p>The manuscript “suddengains: An R package to identify sudden gains in longitudinal data” describes the development and use of a statistical package to identify sudden gains in psychotherapy. The rationale for the development of the package is provided and its features and use are discussed.</p>
    <p>I believe that this manuscript is extremely important in the field of sudden gains research. As the authors noted, the application of sudden gains criteria has differed between studies, and the analyses and calculations are highly prone to errors. As a researcher in this field I think it is safe to assume that at least a moderate degree of variance and discrepancy between studies is due to applying criteria differently (e.g., changing vs. maintaining the critical value for the third criterion based on amount of missing data) and due to computational error. As a result, I found myself in complete agreement with the authors on the importance of having a standard package for computing sudden gains. I believe this can reduce some of the “error variance” that exists in the field.</p>
    <p>As part of my review, I compared the suddengains package with a complex, multi-tab excel spreadsheet that I had been using for the past few years to identify sudden gains. The results were identical. While it is more likely that I validated my excel file with the suddengains package than validated the package with my excel file, I believe this suggests that the main functions work without error.</p>
    <p>There are two potential features that I think could strengthen the package further. These are by no means necessary for publication as I believe the current features already represent a substantial contribution to the literature. However, if the authors have plans on updating the package in the future, I hope they consider these features. </p>
    <p>R1#1. The first is the ability to chose the critical cutoff for the third criterion. As the authors noted, the third criterion is considered to be more a descriptive cutoff than a valid test of statistical significance. This has led some authors to change to the critical value to 2.5 for instance (Hardy et al., 2005). This option could be helpful in future versions. </p>
    <p>RESPONSE: Thank you, we have implemented this function in a development version of the package and will add it into the main package after it is fully tested (see commit ce26a73, <ext-link ext-link-type="uri" xlink:href="https://github.com/milanwiedemann/suddengains/commit/ce26a73ffb249c52c85e2c2d37546be3c59cd870">https://github.com/milanwiedemann/suddengains/commit/ce26a73ffb249c52c85e2c2d37546be3c59cd870</ext-link>, on the plos-one-revisions branch (see <ext-link ext-link-type="uri" xlink:href="https://github.com/milanwiedemann/suddengains/tree/plos-one-revisions">https://github.com/milanwiedemann/suddengains/tree/plos-one-revisions</ext-link>); Guidance on installing this developmental version can be found in the Readme file, see <ext-link ext-link-type="uri" xlink:href="https://github.com/milanwiedemann/suddengains/tree/plos-one-revisions">https://github.com/milanwiedemann/suddengains/tree/plos-one-revisions</ext-link>#installation). This function is also implemented in the interactive demonstration of the package, see <ext-link ext-link-type="uri" xlink:href="https://milanwiedemann.shinyapps.io/shinygains/">https://milanwiedemann.shinyapps.io/shinygains/</ext-link>.</p>
    <p>R1#2. The second feature would be to allow for an altered 3rd criterion by using 1.5 standard deviations of symptom scores as a critical value. This has been done in many previous studies (e.g., Kelly et al. 2005; 2007). Allowing users to chose such an option could facilitate within-study comparisons of sudden gains identified using different criteria. I believe such a comparison could help the field decide on standard criteria based on empirical data.</p>
    <p>RESPONSE: Thank you for this suggestion. It raises the interesting topic of identifying sudden gains based on criteria that are different for each individual. We see this as a subsequent project that the package could facilitate - our view is that the development and implementation of these alternative methods would require some broader consideration and experimentation before they are ready to implement within the package, but that we would be keen to support this and to have such functions available in the package in future. We have added an issue describing this feature request on GitHub, see <ext-link ext-link-type="uri" xlink:href="https://github.com/milanwiedemann/suddengains/issues/22">https://github.com/milanwiedemann/suddengains/issues/22</ext-link>. </p>
    <p>R1#3. Overall, I think the manuscript and package represent an important contribution to the field of sudden gains and believe the package will be used by many researchers in the field.</p>
    <p>RESPONSE: Thank you for your kind comments and helpful suggestions.</p>
    <p>Reviewer 2: </p>
    <p>The manuscript focuses important information on individual change, which can be investigated in longitudinal data (i.e., sudden gains &amp; losses). Central is the description and investigation of sudden gains. For the description of sudden gains, the authors consider specific identification criteria. Based on these criteria, they provide an R-package facilitating automated investigations of sudden gains. This should help to improve the efficiency, reporting, and reproducibility of sudden gains research.</p>
    <p>I support the basic idea of the authors that the R-package “suddengains” is a useful toolbox for applied researches. In addition to a function for obtaining sudden gains, the presented R package has very helpful add-ons, like an illustrative example, a function for creating new output datasets with sudden gains, and graphical functions for illustrating sudden gains and individual trajectories. The authors build on available state-of-the-art packages, like dplyr and ggplot2, and their functions are well documented.</p>
    <p>R2#1. Despite my respect for developing such a useful R-package, I cannot recommend acceptance of the manuscript in the present form. Here is why: Every automation poses the risk of an unconsidered application of specific methods. In my view, this risk is not appropriately addressed in the manuscript, so far. The authors describe a very broad research field for investigating sudden gains with the presented package (p.2. line 8 – any longitudinal dataset with regular repeated measurement). I would encourage a much more detailed view on the context for the application of the R package, where the major limitations are:</p>
    <p>RESPONSE: We share your concern regarding the ‘unconsidered application’ of the package and have therefore sought to address this risk within the manuscript. We have changed the mention of ‘any’ longitudinal dataset to suggest that other fields of research investigating within-participant changes may wish to consider this approach (Page 2, Line 7). We have included a number of additions throughout the paper to make readers more aware of the assumptions, limitations, and criticisms of the standard criteria and methods to identify sudden gains, and have improved the citation of relevant literature discussing these issues. These additions include specific statements encouraging the reader to consider their methodological choices carefully when using the package, e.g. Page 15:</p>
    <p>“while the package may significantly increase the speed and accuracy of calculations, it cannot and should not substitute considered methodological thinking. In particular, users should consider carefully the appropriateness of the methods selected within each function, including related assumptions and limitations.”</p>
    <p>On Page 8 we have also added a link to an interactive web-based ‘Shiny’ application we have been developing, that is designed to help readers of the paper and users of the package consider and understand the impact of different methodological choices (see <ext-link ext-link-type="uri" xlink:href="https://milanwiedemann.shinyapps.io/shinygains/">https://milanwiedemann.shinyapps.io/shinygains/</ext-link>). We also note that the package itself provides a range of warning messages and help documentation to encourage careful and considered use of the functions. Responsibility does of course also lie with the end user, but we hope that the manuscript now better encourages considered use of the package functions.</p>
    <p>R2#2. The authors specify specific criteria for the identification of sudden gains, but they do not review the incorporated assumptions. For instance, calculating the standard error of measurement (S_E) in Eq. 6 or 7 with a specific reliability estimate (retest reliability or Chronbach’s alpha) is only possible, when investigating unidimensional scales, for which such reliability estimates hold. Furthermore, even when unidimensionality holds, the reliability of a measure is not necessarily constant over time or persons (see e.g., models of Latent-State-Trait Theory, where multiple time points are considered and Chronbach’s alpha can be calculated for unidimensional scales at each time point, or Item-Response-Theory models, which allow for heterogeneous measurement error variance depending on the ability of a person). Using one reliability measure for all time points and individuals is a rough approximation to control for measurement error and alternative methods are available. I think, more details on the assumptions of the promoted methods would be beneficial, in order to describe the limitations of the related R-package.</p>
    <p>RESPONSE: Thank you for highlighting this point. As noted above, we have now made a number of changes to the manuscript that aim to emphasise the assumptions and potential limitations of the methods that are used as the current ‘standard’ in the field. For the example you give above, we suspect it is true that most studies to date have used the ‘rough approximation’ approach to reliability that you describe, but of course agree it is important for researchers to understand and actively consider whether such assumptions are appropriate for their data. We have now included mention of this issue on Page 5:</p>
    <p>“Note that the use of the test-retest reliability or Cronbach’s alpha when calculating SE makes the assumption that the scale being examined is unidimensional, and that these reliability estimates remain constant over time, and between individuals. Researchers should consider exploring the factor structure and measurement invariance of the scale to examine if these assumptions hold.”</p>
    <p>In addition we have included clearer mention of one of the main limitations of the package in the discussion section (Page 15):</p>
    <p>“Limitations of the package include the fact that more substantial adaptations to the standard criteria cannot currently be implemented, though as the underlying code is publically available, researchers may wish to use this in combination with other tools for further development work.”</p>
    <p>R2#3. In the preparation of the data, the authors facilitate the exclusion of specific cases, when not enough data points are available to identify sudden gains. They clearly describe which cases have to be excluded. However, the assumptions for and the consequences of excluding persons are not mentioned. This is especially important when conducting subsequent analyses, which are encouraged by the presented R-package. When excluding persons with missing data that is not completely at random, then subsequent results can be biased.</p>
    <p>RESPONSE: We have rephrased this section to avoid suggesting that certain participants need to be excluded, and instead clarify that the select_cases() function allows researchers to stipulate a minimum amount of data for each participant should they wish. In many cases, researchers may want to generate a dataset that consists only of participants with sudden gains (for example, to analyse characteristics of the gains themselves, or the participants who experience them), or one that also includes participants with sufficient data to demonstrate a gain but where one was not observed. In both scenarios, participants who have insufficient data to demonstrate a gain may therefore not be of interest. However, this will be determined by the research question and aims of the study, so we have emphasised that researchers should consider if this optional function is appropriate (Page 9; Please see also our response to comment E5).</p>
    <p>“The optional select_cases() function can be used to identify samples of cases for analysis who fulfil such conditions, though researchers should consider whether these methods are appropriate for the aims of the study.”</p>
    <p>R2#4. A further (minor) comment addresses the statements on the meaning of sudden gains. The authors use a descriptive, databased view on sudden gains. This is appropriate for obtaining such events in the data. However, at the same time they address the meaning of sudden gains, for instance, on page 2 line 20-22 they refer to the meaning of sudden gains in placebo interventions. A clear meaning of sudden gains as effects of an intervention would require a more formal specification of sudden gains as causal effects of the intervention. Accordingly, further (design or analysis) conditions need to hold, for ruling out alternative explanations. I would clearly distinguish between obtaining sudden gains and their meaning.</p>
    <p>RESPONSE: Thank you for raising this important point. You rightly highlight the distinction between the data-driven, mathematical definition of a sudden gain, and their more conceptual meaning in relation to the intervention being studied. We have taken this opportunity to clarify wordings within the manuscript in order to better emphasise this difference, for example on Page 2:</p>
    <p>“In addition, some studies have raised concerns about the validity of sudden gains identified through current methods, demonstrating that they can be found in placebo interventions and simulated datasets [3,4]. This suggests that not all gains reflect meaningful change or show a causal association with the intervention being studied. This highlights the need to examine the presence and strength of these associations and to consider if the current methods of identification can be refined.”</p>
    <p>And in the discussion on Page 15:</p>
    <p>“Lastly it should be emphasised that sudden gains and losses identified by applying a set of mathematical criteria are not necessarily related to the effects of the intervention being studied, and that further investigation would be required to establish the presence and strength of the evidence for a causal relationship.”</p>
    <p>R2#5. To sum up, I encourage a revision of the manuscript - especially for the description of the methods and the discussion. Possible limitations of the methods and the related R package should be included. As such, the circumstances under which the application of the R-package is appropriate would be clearer. I would also appreciate a more detailed view on the meaning of sudden gains. In my view, the suggested changes can support reproducibility of sudden gains research, which is one of the author’s goals. </p>
    <p>RESPONSE: Thank you for your helpful comments. We hope we have been able to address them appropriately, and believe the manuscript has been much improved as a result.</p>
    <supplementary-material content-type="local-data" id="pone.0230276.s001">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">r-suddengains-plosone-response-r1-v2.docx</named-content></p>
      </caption>
      <media xlink:href="pone.0230276.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pone.0230276.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230276.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gnambs</surname>
          <given-names>Timo</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Timo Gnambs</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Timo Gnambs</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pone.0230276" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">26 Feb 2020</named-content>
    </p>
    <p>suddengains: An R package to identify sudden gains in longitudinal data</p>
    <p>PONE-D-19-30704R1</p>
    <p>Dear Dr. Wiedemann,</p>
    <p>We are pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it complies with all outstanding technical requirements.</p>
    <p>Within one week, you will receive an e-mail containing information on the amendments required prior to publication. When all required modifications have been addressed, you will receive a formal acceptance letter and your manuscript will proceed to our production department and be scheduled for publication.</p>
    <p>Shortly after the formal acceptance letter is sent, an invoice for payment will follow. To ensure an efficient production and billing process, please log into Editorial Manager at <ext-link ext-link-type="uri" xlink:href="https://www.editorialmanager.com/pone/">https://www.editorialmanager.com/pone/</ext-link>, click the "Update My Information" link at the top of the page, and update your user information. If you have any billing related questions, please contact our Author Billing department directly at <email>authorbilling@plos.org</email>.</p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, you must inform our press team as soon as possible and no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact <email>onepress@plos.org</email>.</p>
    <p>With kind regards,</p>
    <p>Timo Gnambs</p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
    <p>Additional Editor Comments (optional):</p>
    <p>Reviewers' comments:</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Author</bold>
    </p>
    <p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the “Comments to the Author” section, enter your conflict of interest statement in the “Confidential to Editor” section, and submit your "Accept" recommendation.</p>
    <p>Reviewer #2: All comments have been addressed</p>
    <p>**********</p>
    <p>2. Is the manuscript technically sound, and do the data support the conclusions?</p>
    <p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>3. Has the statistical analysis been performed appropriately and rigorously? </p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p>
    <p>The <ext-link ext-link-type="uri" xlink:href="http://www.plosone.org/static/policies.action#sharing">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data—e.g. participant privacy or use of data from a third party—those must be specified.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p>
    <p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>6. Review Comments to the Author</p>
    <p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p>
    <p>Reviewer #2: The authors were very responsive to all suggestions and I found the revised paper very readable. In my view, the meaning of sudden gains and the limitations of standard research methods in this field are clearer. The R package “suddengains” will be very helpful for applied researchers. Furthermore, I support the authors’ statements that their open source code is beneficial for future methodological developments. Next to the good responses to my comments, I really liked the more detailed description of the example output in the manuscript as well as the add-on of a shiny app. Thus, I encourage acceptance of the manuscript.</p>
    <p>**********</p>
    <p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #2: Yes: Marie-Ann Sengewald</p>
  </body>
</sub-article>
<sub-article id="pone.0230276.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pone.0230276.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Gnambs</surname>
          <given-names>Timo</given-names>
        </name>
        <role>Academic Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Timo Gnambs</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Timo Gnambs</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pone.0230276" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">28 Feb 2020</named-content>
    </p>
    <p>PONE-D-19-30704R1 </p>
    <p>suddengains: An R package to identify sudden gains in longitudinal data </p>
    <p>Dear Dr. Wiedemann:</p>
    <p>I am pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now with our production department. </p>
    <p>If your institution or institutions have a press office, please notify them about your upcoming paper at this point, to enable them to help maximize its impact. If they will be preparing press materials for this manuscript, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information please contact <email>onepress@plos.org</email>.</p>
    <p>For any other questions or concerns, please email <email>plosone@plos.org</email>. </p>
    <p>Thank you for submitting your work to PLOS ONE.</p>
    <p>With kind regards,</p>
    <p>PLOS ONE Editorial Office Staff</p>
    <p>on behalf of</p>
    <p>Dr. Timo Gnambs </p>
    <p>Academic Editor</p>
    <p>PLOS ONE</p>
  </body>
</sub-article>
