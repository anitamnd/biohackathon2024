<?properties open_access?>
<?subarticle report47516?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing3.dtd?>
<?SourceDTD.Version 3.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">F1000Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">F1000Res</journal-id>
    <journal-id journal-id-type="pmc">F1000Research</journal-id>
    <journal-title-group>
      <journal-title>F1000Research</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2046-1402</issn>
    <publisher>
      <publisher-name>F1000 Research Limited</publisher-name>
      <publisher-loc>London, UK</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6505635</article-id>
    <article-id pub-id-type="doi">10.12688/f1000research.18676.1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software Tool Article</subject>
      </subj-group>
      <subj-group>
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>pysradb: A Python package to query next-generation sequencing metadata and data from NCBI Sequence Read Archive</article-title>
      <fn-group content-type="pub-status">
        <fn>
          <p>[version 1; peer review: 2 approved]</p>
        </fn>
      </fn-group>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Choudhary</surname>
          <given-names>Saket</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Formal Analysis</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – Original Draft Preparation</role>
        <role content-type="http://credit.casrai.org/">Writing – Review &amp; Editing</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5202-7633</contrib-id>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <aff id="a1"><label>1</label>Computational Biology and Bioinformatics, University of Southern California, Los Angeles, California, 90089, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email xlink:href="mailto:saketkc@gmail.com">saketkc@gmail.com</email>
      </corresp>
      <fn fn-type="COI-statement">
        <p>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>532</elocation-id>
    <history>
      <date date-type="accepted">
        <day>15</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright: © 2019 Choudhary S</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-8-20450.pdf"/>
    <abstract>
      <p>The NCBI Sequence Read Archive (SRA) is the primary archive of next-generation sequencing datasets. SRA makes metadata and raw sequencing data available to the research community to encourage reproducibility and to provide avenues for testing novel hypotheses on publicly available data. However, methods to programmatically access this data are limited. We introduce the Python package, pysradb, which provides a collection of command line methods to query and download metadata and data from SRA, utilizing the curated metadata database available through the SRAdb project. We demonstrate the utility of pysradb on multiple use cases for searching and downloading SRA datasets. It is available freely at https://github.com/saketkc/pysradb.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>bioinformatics</kwd>
      <kwd>metadata</kwd>
      <kwd>SRA</kwd>
      <kwd>NGS</kwd>
      <kwd>NCBI</kwd>
      <kwd>GEO</kwd>
    </kwd-group>
    <funding-group>
      <funding-statement>The author(s) declared that no grants were involved in supporting this work.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Several projects have made efforts to analyze and publish summaries of DNA-
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup> and RNA-seq
<sup><xref rid="ref-2" ref-type="bibr">2</xref>,
<xref rid="ref-3" ref-type="bibr">3</xref></sup> datasets. Obtaining metadata and raw data from the NCBI Sequence Read Archive (SRA)
<sup><xref rid="ref-4" ref-type="bibr">4</xref></sup> is often the first step towards re-analyzing public next-generation sequencing datasets in order to compare them to private data or test a novel hypothesis. The NCBI SRA toolkit
<sup><xref rid="ref-5" ref-type="bibr">5</xref></sup> provides utility methods to download raw sequencing data, while the metadata can be obtained by querying the website or through the Entrez
<monospace>efetch</monospace> command line utility
<sup><xref rid="ref-6" ref-type="bibr">6</xref></sup>. Most workflows analyzing public data rely on first searching for relevant keywords in the metadata either through the command line utility or the website, gathering relevant sample(s) of interest and then downloading these. A more streamlined workflow can enable the performance of all these steps at once.</p>
    <p>In order to make querying both metadata and data more precise and robust, the SRAdb
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup> project provides a frequently updated SQLite database containing all the metadata parsed from SRA.
<monospace>SRAdb</monospace> tracks the five main data objects in SRA’s metadata: submission, study, sample, experiment and run. These are mapped to five different relational database tables that are made available in the SQLite file. The metadata semantics in the file remain as they are on SRA. The accompanying package,
<monospace>SRAdb</monospace>
<sup><xref rid="ref-8" ref-type="bibr">8</xref></sup>, made available in the
<monospace>R</monospace> programming language
<sup><xref rid="ref-9" ref-type="bibr">9</xref></sup>, provides a convenient framework to handle metadata queries and raw data downloads by utilizing the SQLite database. Though powerful, SRAdb requires the end user to be familiar with the
<monospace>R</monospace> programming language and does not provide a command-line interface for querying or downloading operations.</p>
    <p>The
<monospace>pysradb</monospace> package
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup> builds upon the principles of
<monospace>SRAdb</monospace>, providing a simple and user-friendly commandline interface for querying metadata and downloading datasets from SRA. It obviates the need for the user to be familiar with any programming language for querying and downloading datasets from SRA. Additionally, it provides utility functions that will further help a user perform more granular queries, which are often required when dealing with multiple datasets on a large scale. By enabling both metadata search and download operations at the command-line,
<monospace>pysradb</monospace> aims to bridge the gap in seamlessly retrieving public sequencing datasets and the associated metadata.</p>
    <p><monospace>pysradb</monospace><sup><xref rid="ref-10" ref-type="bibr">10</xref></sup> is written in Python
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup> and is currently developed on GitHub under the open-source BSD 3-Clause License. To simplify the installation procedure for the end-user, it is also available for download through
<ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/pysradb/">PyPI</ext-link> and
<ext-link ext-link-type="uri" xlink:href="https://bioconda.github.io/recipes/pysradb/README.html">bioconda</ext-link>
<sup><xref rid="ref-12" ref-type="bibr">12</xref></sup>.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Implementation</title>
      <p>pysradb
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup> is implemented in Python and uses
<monospace>pandas</monospace>
<sup><xref rid="ref-13" ref-type="bibr">13</xref></sup> for data frame based operations. Since downloading datasets can often take a long time,
<monospace>pysradb</monospace> displays progress for long haul tasks using
<monospace>tqdm</monospace>
<sup><xref rid="ref-14" ref-type="bibr">14</xref></sup>. The metadata information is read in the form of an SQLite
<sup><xref rid="ref-15" ref-type="bibr">15</xref></sup> database, made available by SRAdb
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup>.</p>
      <p>Each sub-command of
<monospace>pysradb</monospace> contains a self-contained help string that describes its purpose and usage example. The help text can be accessed by passing the ‘–help’ flag. There is also additional documentation available for the sub-commands on
<ext-link ext-link-type="uri" xlink:href="https://saket-choudhary.me/pysradb/">the project’s website</ext-link>. We also provide example Jupyter
<sup><xref rid="ref-16" ref-type="bibr">16</xref></sup>
<ext-link ext-link-type="uri" xlink:href="https://github.com/saketkc/pysradb/tree/master/notebooks">notebooks</ext-link> that demonstrate the functionality of the Python API.</p>
      <p><monospace>pysradb</monospace>’s development primarily occurred on GitHub and the code is tested continuously using Travis CI webhook. This monitors all incoming pull requests and commits to the master branch. The testing happens on Python version 3.5, 3.6, and 3.7 on an Ubuntu 16.04 LTS virtual machine, while testing webhooks on the bioconda channel provide additional testing on Mac-based systems. Nevertheless,
<monospace>pysradb</monospace> should run on most Unix derivatives.</p>
    </sec>
    <sec>
      <title>Operation</title>
      <p><monospace>pysradb</monospace><sup><xref rid="ref-10" ref-type="bibr">10</xref></sup> can be run on either Linux- or Mac-based operating systems. It supports Python 3.5, 3.6 and 3.7. Requiring just two additional dependencies,
<monospace>pysradb</monospace> can be easily installed using either a
<monospace>pip-</monospace> or
<monospace>conda-</monospace>based package manager via the
<monospace>bioconda</monospace>
<sup><xref rid="ref-12" ref-type="bibr">12</xref></sup> channel.</p>
      <p>An earlier version of this article can be found on bioRxiv
<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/578500">https://doi.org/10.1101/578500</ext-link>
</p>
    </sec>
  </sec>
  <sec sec-type="cases">
    <title>Use cases</title>
    <p><monospace>pysradb</monospace><sup><xref rid="ref-10" ref-type="bibr">10</xref></sup> provides a chain of sub-commands for retrieving metadata, converting one accession to other and downloading. Each sub-command is designed to perform a single operation by default, while additional operations can be performed by passing additional flags. In the following section we demonstrate some of the use cases of these sub-commands.</p>
    <p><monospace>pysradb</monospace> uses
<monospace>SRAmetadb.sqlite,</monospace> a SQLite file produced and made available by SRAdb
<sup><xref rid="ref-7" ref-type="bibr">7</xref></sup> project. The file itself can be downloaded using
<monospace>pysradb</monospace> as:</p>
    <p>
      <preformat>
        <styled-content style="font-size:15px;color:#000000;">$ pysradb srametadb</styled-content>
      </preformat>
    </p>
    <p>The
<monospace>SRAmetadb.sqlite</monospace> file is required for all other operations supported by
<monospace>pysradb</monospace>. This file is required for all the sub-commands to function. By default,
<monospace>pysradb</monospace> assumes that the file is located in the current working directory. Alternatively, it can supplied using the ‘–db path/to/SRAmetadb.sqlite’ argument. The
<monospace>SRAmetadb.sqlite</monospace> is available at:
<ext-link ext-link-type="uri" xlink:href="https://s3.amazonaws.com/starbuck1/sradb/SRAmetadb.sqlite.gz">https://s3.amazonaws.com/starbuck1/sradb/SRAmetadb.sqlite.gz</ext-link> or alternatively at
<ext-link ext-link-type="uri" xlink:href="https://gbnci-abcc.ncifcrf.gov/backup/SRAmetadb.sqlite.gz">https://gbnci-abcc.ncifcrf.gov/backup/SRAmetadb.sqlite.gz</ext-link>. The examples here were run using
<monospace>SRAmetadb.sqlite</monospace> with schema version 1.0 and creation timestamp 2019-01-25 00:38:19.</p>
    <sec>
      <title>Search</title>
      <p>Consider a case where a user is looking for Ribo-seq
<sup><xref rid="ref-17" ref-type="bibr">17</xref></sup> public datasets on SRA. These datasets will often have ‘ribosome profiling’ appearing in the abstract or sample description. We can search for such projects using the ‘search’ sub-command:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb search ‘"ribosome profiling"’ | head</styled-content>
        </preformat>
      </p>
      <table-wrap id="T1" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> study_accession</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   experiment_accession</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   sample_accession</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   run_accession</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> DRP003075</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRX019536</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRS026974</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRR021383</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> DRP003075</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRX019537</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRS026982</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRR021384</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> DRP003075</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRX019538</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRS026979</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRR021385</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> DRP003075</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRX019540</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRS026984</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRR021387</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> DRP003075</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRX019541</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRS026978</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRR021388</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> DRP003075</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRX019543</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRS026980</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRR021390</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> DRP003075</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRX019544</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRS026981</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   DRR021391</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> ERP013565</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   ERX1264364</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   ERS1016056</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   ERR1190989</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The results here list all relevant ‘ribosome profiling’ projects.</p>
    </sec>
    <sec>
      <title>Getting metadata for a SRA project</title>
      <p>Each SRA project (accession prefix ‘SRP’) on SRA consists of single or multiple experiments (accession prefix ‘SRX’) which are sequenced as single or multiple runs (accession prefix ‘SRR’). Each experiment is carried out on an individual biological sample (accession prefix ‘SRS’).</p>
      <p><monospace>pysradb metadata</monospace> can be used to obtain all the experiment, sample, and run accessions associated with a SRA project as:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb metadata SRP010679 | head</styled-content>
        </preformat>
      </p>
      <table-wrap id="T2" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> study_accession</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   experiment_accession</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   sample_accession</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   run_accession</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118285</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290854</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403882</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118286</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290855</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403883</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118287</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290856</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403884</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118288</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290857</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403885</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118289</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290858</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403886</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118290</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290859</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403887</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118291</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290860</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403888</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118292</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290861</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403889</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118293</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290862</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403890</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118294</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290863</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403891</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118295</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290864</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403892</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118296</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290865</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403893</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>However, this information by itself is often incomplete. We require detailed metadata associated with each sample to perform any downstream analysis. For example, the assays used for different samples and the corresponding treatment conditions. This can be done by supplying the ‘–desc’ flag:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb metadata SRP010679 –desc | head -5</styled-content>
        </preformat>
      </p>
      <table-wrap id="T3" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> study_accession</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   experiment_accession</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   sample_accession</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   run_accession</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   sample_attribute</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118285</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290854</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403882</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   source_name: PC3 human
<break/>   prostate cancer cells || cell
<break/>   line: PC3 || sample type:
<break/>   polyA RNA || treatment: vehicle</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118286</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290855</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403883</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   source_name: PC3 human
<break/>   prostate cancer cells || cell
<break/>   line: PC3 || sample type:
<break/>   ribosome protected RNA ||
<break/>   treatment: vehicle</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118287</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290856</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403884</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   source_name: PC3 human
<break/>   prostate cancer cells || cell
<break/>   line: PC3 || sample type:
<break/>   polyA RNA || treatment: rapamycin</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRP010679</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRX118288</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRS290857</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRR403885</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   source_name: PC3 human
<break/>   prostate cancer cells || cell
<break/>   line: PC3 || sample type:
<break/>   ribosome protected RNA ||
<break/>   treatment: rapamycin</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>This can be further expanded to reveal the data in ‘sample_attribute’ column into separate columns via ‘–expand’ flag. This is most useful for samples that have associated treatment or cell type metadata available.</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb metadata SRP010679 –desc –expand</styled-content>
        </preformat>
      </p>
      <table-wrap id="T4" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left" colspan="5" style="background-color:#FFFFFF" valign="top" rowspan="1"> ... [truncated]</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> run_accession</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   cell_line</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   sample_type</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   source_name</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   treatment</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403882</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   polya rna</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   vehicle</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403883</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   ribosome protected rna </td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   vehicle</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403884</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   polya rna</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   rapamycin</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403885</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   ribosome protected rna</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   rapamycin</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403886</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   polya rna</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pp242</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403887</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   ribosome protected rna</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pp242</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403888</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   polya rna</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   vehicle</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403889</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   ribosome protected rna</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   vehicle</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403890</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   polya rna</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   rapamycin</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403891</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   ribosome protected rna</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   rapamycin</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403892</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   polya rna</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pp242</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> SRR403893</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   ribosome protected rna</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pc3 human prostate cancer cells</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   pp242</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Any SRA project might consist of experiments involving multiple assay types. The assay associated with any project can be obtained by providing
<monospace>–assay</monospace> flag:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb metadata SRP000941 –assay | tr -s ’ ’ | cut -f5 -d ’ ’ | tail -n +2 | sort | uniq -c</styled-content>
        </preformat>
      </p>
      <table-wrap id="T5" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> 999</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   Bisulfite-Seq</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> 768</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   ChIP-Seq</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> 121</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   OTHER</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> 353</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   RNA-Seq</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> 28</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   WGS</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Getting SRPs from GSE</title>
      <p>The Gene Expression Omnibus database (GEO)
<sup><xref rid="ref-18" ref-type="bibr">18</xref></sup> is the NCBI data repository for functional genomics data.</p>
      <p>It accepts array and sequence-based data from gene profiling experiments. For sequence-based data, the corresponding raw files are deposited to the SRA. GEO assigns a dataset accession (accession prefix ‘GSE’) that is linked to the corresponding accession on the SRA (accession prefix ‘SRP’). It is often necessary to interpolate between the two accessions.
<monospace>gse-to-srp</monospace> sub-command allows converting GSE to SRP:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb gse-to-srp GSE24355 GSE25842</styled-content>
        </preformat>
      </p>
      <table-wrap id="T6" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> study_alias</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   study_accession</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> GSE24355</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRP003870</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1"> GSE25842</td>
              <td align="left" style="background-color:#FFFFFF" valign="top" rowspan="1" colspan="1">   SRP005378</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>It can be further expanded to obtain the corresponding experiment and run accessions:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb gse-to-srp –detailed –expand GSE100007 | head</styled-content>
        </preformat>
      </p>
      <table-wrap id="T7" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> study_alias</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   study_accession</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   experiment_accession</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   sample_accession</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   experiment_alias</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   sample_alias</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE100007</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRP109126</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRX2916198</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRS2282390</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667747</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667747</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE100007</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRP109126</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRX2916199</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRS2282391</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667748</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667748</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE100007</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRP109126</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRX2916200</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRS2282392</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667749</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667749</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE100007</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRP109126</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRX2916201</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRS2282393</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667750</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667750</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE100007</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRP109126</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRX2916202</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRS2282394</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667751</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667751</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE100007</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRP109126</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRX2916203</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRS2282395</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667752</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667752</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE100007</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRP109126</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRX2916204</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRS2282396</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667753</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667753</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE100007</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRP109126</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRX2916205</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRS2282397</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667754</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667754</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE100007</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRP109126</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRX2916206</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRS2282400</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667755</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM2667755</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Getting a list of GEO experiments for a GEO study</title>
      <p>Any GEO study (accession prefix ‘GSE’) will involve a collection of experiments (accession prefix ‘GSM’). We can obtain an entire list of experiments corresponding to the study using the
<monospace>gse-to-gsm</monospace> sub-command from
<monospace>pysradb</monospace>:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb gse-to-gsm GSE41637 | head</styled-content>
        </preformat>
      </p>
      <table-wrap id="T8" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> study_alias</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   experiment_alias</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637 </td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020640_1</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020641_1</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020642_1</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020643_1</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020644_1</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020645_1</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020646_1</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020647_1</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020648_1</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>However, a list of GSM accessions is not useful if one is performing any downstream analysis, which essentially requires more detailed information about the metadata associated with each experiment. This relevant metadata associated with each sample can be obtained by providing
<monospace>gse-to-gsm</monospace> additional flags:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb gse-to-gsm –desc GSE41637 | head</styled-content>
        </preformat>
      </p>
      <table-wrap id="T9" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> study_alias</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   experiment_alias</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   sample_attribute</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637 </td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020640_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   source_name: mouse_brain || strain: DBA/2J || tissue: brain</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020641_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   source_name: mouse_colon || strain: DBA/2J || tissue: colon</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020642_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   source_name: mouse_heart || strain: DBA/2J || tissue: heart</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020643_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   source_name: mouse_kidney || strain: DBA/2J || tissue: kidney</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020644_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   source_name: mouse_liver || strain: DBA/2J || tissue: liver</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020645_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   source_name: mouse_lung || strain: DBA/2J || tissue: lung</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020646_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   source_name: mouse_skm || strain: DBA/2J || tissue: skeletal muscle</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020647_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   source_name: mouse_spleen || strain: DBA/2J || tissue: spleen</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020648_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   source_name: mouse_testes || strain: DBA/2J || tissue: testes</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The metadata information can then be parsed from the
<monospace>sample_attribute</monospace> column. To obtain more structured metadata, we can use an additional flag
<monospace>‘–expand’:</monospace>
</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb gse-to-gsm –desc –expand GSE41637 | head</styled-content>
        </preformat>
      </p>
      <table-wrap id="T10" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> study_alias</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   experiment_alias</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   source_name</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   strain</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   tissue</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637 </td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020640_1 </td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   mouse_brain </td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   dba/2j</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   brain</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020641_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   mouse_colon</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   dba/2j</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   colon</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020642_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   mouse_heart</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   dba/2j</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   heart</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020643_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   mouse_kidney</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   dba/2j</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   kidney</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020644_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   mouse_liver</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   dba/2j</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   liver</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020645_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   mouse_lung</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   dba/2j</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   lung</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSE41637</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   GSM1020646_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   mouse_skm</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   dba/2j</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   skeletal muscle</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Getting SRR from GSM</title>
      <p><monospace>gsm-to-srr</monospace> allows conversion from GEO experiments (accession prefix ‘GSM’) to SRA runs (accession prefix ‘SRR’):</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb gsm-to-srr GSM1020640 GSM1020646</styled-content>
        </preformat>
      </p>
      <table-wrap id="T11" orientation="portrait" position="anchor">
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> experiment_alias</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   run_accession</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSM1020640_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRR594393</td>
            </tr>
            <tr>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1"> GSM1020646_1</td>
              <td align="left" style="background-color:#FFFFFF" rowspan="1" colspan="1">   SRR594399</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Downloading SRA datasets</title>
      <p><monospace>pysradb</monospace> enables seemless downloads from SRA. It organizes the downloaded data following the NCBI hiererachy: ‘SRP =&gt; SRX =&gt; SRR’ of storing data. Each ‘SRP’ (project) has multiple ‘SRX’ (experiments) and each ‘SRX’ in turn has multiple ‘SRR’ (runs). Multiple projects can be downloaded at once using the
<monospace>download</monospace> sub-command:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb download -p SRP000941 -p SRP010679</styled-content>
        </preformat>
      </p>
      <p><monospace>download</monospace> also allows Unix pipes-based inputs. Consider our previous example of the project SRP000941 with different assays. However, we want to be able to download only ‘RNA-seq’ samples. We can do this by subsetting the metadata output for only ‘RNA-seq’ samples:</p>
      <p>
        <preformat>
          <styled-content style="font-size:15px;color:#000000;">$ pysradb metadata SRP000941 –assay | grep ‘study|RNA-Seq’ | pysradb download</styled-content>
        </preformat>
      </p>
      <p>This will only download the ‘RNA-seq’ samples from the project.</p>
    </sec>
  </sec>
  <sec>
    <title>Summary</title>
    <p>pysradb
<sup><xref rid="ref-10" ref-type="bibr">10</xref></sup> provides a command-line interface to query metadata and download sequencing datasets from the SRA. It enables seamless retrieval of metadata and conversion between different accessions.
<monospace>pysradb</monospace> is written in Python 3 and is available on Linux and Mac OS. The source code is hosted on GitHub and licensed under BSD 3-clause license. It is available for installation through PyPI and bioconda.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <sec>
      <title>Underlying data</title>
      <p>Dataset from DDBJ Sequence Read Archive, Accession number DRP003075:
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/insdc.sra/DRP003075">https://identifiers.org/ insdc.sra/DRP003075</ext-link>
</p>
      <p>Dataset from EMBL-EBI Sequence Read Archive, Accession number ERP013565:
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/insdc.sra/ERP013565">https://identifiers. org/insdc.sra/ERP013565</ext-link>
</p>
      <p>Dataset from Gene Expression Omnibus, Accession number GSE24355:
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo/GSE24355">https://identifiers.org/geo/ GSE24355</ext-link>
</p>
      <p>Dataset from Gene Expression Omnibus, Accession number GSE25842:
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo/GSE25842">https://identifiers.org/geo/ GSE25842</ext-link>
</p>
      <p>Dataset from Gene Expression Omnibus, Accession number GSE100007:
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo/GSE100007">https://identifiers.org/ geo/GSE100007</ext-link>
<sup><xref rid="ref-19" ref-type="bibr">19</xref></sup>
</p>
      <p>Dataset from Gene Expression Omnibus, Accession number GSE41637:
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/geo/GSE41637">https://identifiers.org/geo/ GSE41637</ext-link>
<sup><xref rid="ref-20" ref-type="bibr">20</xref></sup>
</p>
      <p>Dataset from NCBI Sequence Read Archive, Accession number SRP010679:
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/insdc.sra/SRP010679">https://identifiers.org/ insdc.sra/SRP010679</ext-link>
<sup><xref rid="ref-21" ref-type="bibr">21</xref></sup>
</p>
      <p>Dataset from NCBI Sequence Read Archive, Accession number SRP000941:
<ext-link ext-link-type="uri" xlink:href="https://identifiers.org/insdc.sra/SRP000941">https://identifiers.org/ insdc.sra/SRP000941</ext-link>
<sup><xref rid="ref-22" ref-type="bibr">22</xref></sup>
</p>
    </sec>
  </sec>
  <sec>
    <title>Software availability</title>
    <p><bold>Software available from:</bold><ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/pysradb/">https://pypi.org/project/pysradb/</ext-link>.</p>
    <p><bold>Source code available from:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/saketkc/pysradb">https://github.com/saketkc/pysradb</ext-link>.</p>
    <p><bold>Archived source code at time of publication:</bold><ext-link ext-link-type="uri" xlink:href="https://dx.doi.org/10.5281/zenodo.2579446">https://doi.org/10.5281/zenodo.2579446</ext-link><sup><xref rid="ref-10" ref-type="bibr">10</xref></sup>.</p>
    <p>
      <bold>License:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/saketkc/pysradb/blob/master/LICENSE">BSD 3-Clause</ext-link>
    </p>
  </sec>
  <sec>
    <title>Author endorsement</title>
    <p>Dr. Luiz O. Penalva confirms that the author has an appropriate level of expertise to conduct this research, and confirms that the submission is of an acceptable scientific standard. Dr. Luiz O. Penalva declares they have no competing interests. Affiliation: UT Health San Antonio, Children’s Cancer Research Institute, San Antonio, Texas, 78229, USA</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>The author thanks Amal Thomas, Meng Zhou, Rishvanth Prabakar, Wenzheng Li, and Xiaojing Ji at the University of Southern California (USC) and Shweta Ramdas at the University of Pennsylvania for helpful discussions and comments on the software and manuscript. The author acknowledges support from the USC Provost Graduate Research Fellowship.</p>
  </ack>
  <ref-list>
    <ref id="ref-1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacArthur</surname><given-names>DG</given-names></name><name><surname>Balasubramanian</surname><given-names>S</given-names></name><name><surname>Frankish</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>A systematic survey of loss-of-function variants in human protein-coding genes.</article-title><source><italic>Science.</italic></source><year>2012</year>;<volume>335</volume>(<issue>6070</issue>):<fpage>823</fpage>–<lpage>828</lpage>.
<pub-id pub-id-type="doi">10.1126/science.1215040</pub-id><!--<pub-id pub-id-type="pmcid">3299548</pub-id>--><?supplied-pmid 22344438?><pub-id pub-id-type="pmid">22344438</pub-id></mixed-citation>
    </ref>
    <ref id="ref-2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lachmann</surname><given-names>A</given-names></name><name><surname>Torre</surname><given-names>D</given-names></name><name><surname>Keenan</surname><given-names>AB</given-names></name><etal/></person-group>:
<article-title>Massive mining of publicly available RNA-seq data from human and mouse.</article-title><source><italic>Nat Commun.</italic></source><year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1366</fpage>.
<pub-id pub-id-type="doi">10.1038/s41467-018-03751-6</pub-id><!--<pub-id pub-id-type="pmcid">5893633</pub-id>--><?supplied-pmid 29636450?><pub-id pub-id-type="pmid">29636450</pub-id></mixed-citation>
    </ref>
    <ref id="ref-3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collado-Torres</surname><given-names>L</given-names></name><name><surname>Nellore</surname><given-names>A</given-names></name><name><surname>Kammers</surname><given-names>K</given-names></name><etal/></person-group>:
<article-title>Reproducible RNA-seq analysis using
<italic>recount2</italic>.</article-title><source><italic>Nat Biotechnol.</italic></source><year>2017</year>;<volume>35</volume>(<issue>4</issue>):<fpage>319</fpage>–<lpage>321</lpage>.
<pub-id pub-id-type="doi">10.1038/nbt.3838</pub-id><?supplied-pmid 28398307?><pub-id pub-id-type="pmid">28398307</pub-id></mixed-citation>
    </ref>
    <ref id="ref-4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leinonen</surname><given-names>R</given-names></name><name><surname>Sugawara</surname><given-names>H</given-names></name><name><surname>Shumway</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>The sequence read archive.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2011</year>;<volume>39</volume>(<issue>Database issue</issue>):<fpage>D19</fpage>–<lpage>D21</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gkq1019</pub-id><!--<pub-id pub-id-type="pmcid">3013647</pub-id>--><?supplied-pmid 21062823?><pub-id pub-id-type="pmid">21062823</pub-id></mixed-citation>
    </ref>
    <ref id="ref-5">
      <label>5</label>
      <mixed-citation publication-type="journal"><collab>SRA Toolkit Development Team</collab>:
<article-title>Sra toolkit</article-title>.<year>2018</year>; [Online; accessed 10-December-2018].
<ext-link ext-link-type="uri" xlink:href="https://ncbi.github.io/sra-tools/">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kans</surname><given-names>J</given-names></name></person-group>:
<article-title>Entrez direct: E-utilities on the unix command line</article-title>.<year>2018</year><ext-link ext-link-type="uri" xlink:href="http://home.cc.umanitoba.ca/~psgendb/birchhomedir/doc/NCBI/edirect/chapter6.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>Y</given-names></name><name><surname>Stephens</surname><given-names>RM</given-names></name><name><surname>Meltzer</surname><given-names>PS</given-names></name><etal/></person-group>:
<article-title>SRAdb: query and use public next-generation sequencing data from within R.</article-title><source><italic>BMC Bioinformatics.</italic></source><year>2013</year>;<volume>14</volume>(<issue>1</issue>):<fpage>19</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-14-19</pub-id><!--<pub-id pub-id-type="pmcid">3560148</pub-id>--><?supplied-pmid 23323543?><pub-id pub-id-type="pmid">23323543</pub-id></mixed-citation>
    </ref>
    <ref id="ref-8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>J</given-names></name><name><surname>Davis</surname><given-names>S</given-names></name></person-group>:
<article-title>Bioconductor:sradb</article-title>.<year>2018</year><pub-id pub-id-type="doi">10.18129/B9.bioc.SRAdb</pub-id></mixed-citation>
    </ref>
    <ref id="ref-9">
      <label>9</label>
      <mixed-citation publication-type="journal"><collab>R Core Team</collab>:
<article-title>R: A Language and Environment for Statistical Computing</article-title>. R Foundation for Statistical Computing, Vienna, Austria.
<ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choudhary</surname><given-names>S</given-names></name></person-group>:
<article-title>saketkc/pysradb v0.9.0</article-title>.<year>2019</year><pub-id pub-id-type="doi">10.5281/zenodo.2579446</pub-id></mixed-citation>
    </ref>
    <ref id="ref-11">
      <label>11</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Rossum</surname><given-names>G</given-names></name><name><surname>Drake</surname><given-names>FL</given-names></name></person-group>:
<article-title>The Python Language Reference Manual</article-title>. Network Theory Ltd.,<year>2011</year>, ISBN
1906966141, 9781906966140.
<ext-link ext-link-type="uri" xlink:href="https://dl.acm.org/citation.cfm?id=2011965">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-12">
      <label>12</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grüning</surname><given-names>B</given-names></name><name><surname>Dale</surname><given-names>R</given-names></name><name><surname>Sjödin</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences.</article-title><source><italic>Nat Methods.</italic></source><year>2018</year>;<volume>15</volume>(<issue>7</issue>):<fpage>475</fpage>–<lpage>476</lpage>.
<pub-id pub-id-type="doi">10.1038/s41592-018-0046-7</pub-id><?supplied-pmid 29967506?><pub-id pub-id-type="pmid">29967506</pub-id></mixed-citation>
    </ref>
    <ref id="ref-13">
      <label>13</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKinney</surname><given-names>W</given-names></name></person-group>:
<article-title>Data structures for statistical computing in python</article-title>. In Stéfan van der Walt and Jarrod Millman, editors,
<italic>Proceedings of the 9th Python in Science Conference</italic><year>2010</year>;<fpage>51</fpage>–<lpage>56</lpage>.
<ext-link ext-link-type="uri" xlink:href="https://pdfs.semanticscholar.org/f6da/c1c52d3b07c993fe52513b8964f86e8fe381.pdf">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-14">
      <label>14</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>da Costa-Luis</surname><given-names>C</given-names></name><name><surname>Stephen</surname><given-names>L</given-names></name><name><surname>Mary</surname><given-names>H</given-names></name><etal/></person-group>:
<article-title>tqdm/tqdm: tqdm v4.20.0 stable</article-title>.<year>2018</year><pub-id pub-id-type="doi">10.5281/zenodo.1211527</pub-id></mixed-citation>
    </ref>
    <ref id="ref-15">
      <label>15</label>
      <mixed-citation publication-type="journal"><article-title>Sqlite home page</article-title>.<year>2018</year>; [Online; accessed 10-December-2018].
<ext-link ext-link-type="uri" xlink:href="https://sqlite.org/">Reference Source</ext-link></mixed-citation>
    </ref>
    <ref id="ref-16">
      <label>16</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kluyver</surname><given-names>T</given-names></name><name><surname>Ragan-Kelley</surname><given-names>B</given-names></name><name><surname>Pérez</surname><given-names>F</given-names></name><etal/></person-group>:
<article-title>Jupyter notebooks - a publishing format for reproducible computational workflows</article-title>. In F. Loizides and B. Schmidt, editors,
<italic>Positioning and Power in Academic Publishing: Players, Agents and Agendas.</italic>IOS Press,<year>2016</year>;<fpage>87</fpage>–<lpage>90</lpage>.
<pub-id pub-id-type="doi">10.3233/978-1-61499-649-1-87</pub-id></mixed-citation>
    </ref>
    <ref id="ref-17">
      <label>17</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ingolia</surname><given-names>NT</given-names></name><name><surname>Ghaemmaghami</surname><given-names>S</given-names></name><name><surname>Newman</surname><given-names>JR</given-names></name><etal/></person-group>:
<article-title>Genome-wide analysis
<italic>in vivo</italic> of translation with nucleotide resolution using ribosome profiling.</article-title><source><italic>Science.</italic></source><year>2009</year>;<volume>324</volume>(<issue>5924</issue>):<fpage>218</fpage>–<lpage>223</lpage>.
<pub-id pub-id-type="doi">10.1126/science.1168978</pub-id><!--<pub-id pub-id-type="pmcid">2746483</pub-id>--><?supplied-pmid 19213877?><pub-id pub-id-type="pmid">19213877</pub-id></mixed-citation>
    </ref>
    <ref id="ref-18">
      <label>18</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barrett</surname><given-names>T</given-names></name><name><surname>Wilhite</surname><given-names>SE</given-names></name><name><surname>Ledoux</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>NCBI GEO: archive for functional genomics data sets--update.</article-title><source><italic>Nucleic Acids Res.</italic></source><year>2013</year>;<volume>41</volume>(<issue>Database issue</issue>):<fpage>D991</fpage>–<lpage>D995</lpage>.
<pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id><!--<pub-id pub-id-type="pmcid">3531084</pub-id>--><?supplied-pmid 23193258?><pub-id pub-id-type="pmid">23193258</pub-id></mixed-citation>
    </ref>
    <ref id="ref-19">
      <label>19</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blair</surname><given-names>JD</given-names></name><name><surname>Hockemeyer</surname><given-names>D</given-names></name><name><surname>Doudna</surname><given-names>JA</given-names></name><etal/></person-group>:
<article-title>Widespread Translational Remodeling during Human Neuronal Differentiation.</article-title><source><italic>Cell Rep.</italic></source><year>2017</year>;<volume>21</volume>(<issue>7</issue>):<fpage>2005</fpage>–<lpage>2016</lpage>.
<pub-id pub-id-type="doi">10.1016/j.celrep.2017.10.095</pub-id><!--<pub-id pub-id-type="pmcid">5759054</pub-id>--><?supplied-pmid 29141229?><pub-id pub-id-type="pmid">29141229</pub-id></mixed-citation>
    </ref>
    <ref id="ref-20">
      <label>20</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merkin</surname><given-names>J</given-names></name><name><surname>Russell</surname><given-names>C</given-names></name><name><surname>Chen</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Evolutionary dynamics of gene and isoform regulation in Mammalian tissues.</article-title><source><italic>Science.</italic></source><year>2012</year>;<volume>338</volume>(<issue>6114</issue>):<fpage>1593</fpage>–<lpage>1599</lpage>.
<pub-id pub-id-type="doi">10.1126/science.1228186</pub-id><!--<pub-id pub-id-type="pmcid">3568499</pub-id>--><?supplied-pmid 23258891?><pub-id pub-id-type="pmid">23258891</pub-id></mixed-citation>
    </ref>
    <ref id="ref-21">
      <label>21</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hsieh</surname><given-names>AC</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Edlind</surname><given-names>MP</given-names></name><etal/></person-group>:
<article-title>The translational landscape of mTOR signalling steers cancer initiation and metastasis.</article-title><source><italic>Nature.</italic></source><year>2012</year>;<volume>485</volume>(<issue>7396</issue>):<fpage>55</fpage>–<lpage>61</lpage>.
<pub-id pub-id-type="doi">10.1038/nature10912</pub-id><!--<pub-id pub-id-type="pmcid">3663483</pub-id>--><?supplied-pmid 22367541?><pub-id pub-id-type="pmid">22367541</pub-id></mixed-citation>
    </ref>
    <ref id="ref-22">
      <label>22</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schultz</surname><given-names>MD</given-names></name><name><surname>He</surname><given-names>Y</given-names></name><name><surname>Whitaker</surname><given-names>JW</given-names></name><etal/></person-group>:
<article-title>Human body epigenome maps reveal noncanonical DNA methylation variation.</article-title><source><italic>Nature.</italic></source><year>2015</year>;<volume>523</volume>(<issue>7559</issue>):<fpage>212</fpage>–<lpage>6</lpage>.
<pub-id pub-id-type="doi">10.1038/nature14465</pub-id><!--<pub-id pub-id-type="pmcid">4499021</pub-id>--><?supplied-pmid 26030523?><pub-id pub-id-type="pmid">26030523</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="report47516" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20450.r47516</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Dale</surname>
          <given-names>Ryan K.</given-names>
        </name>
        <xref ref-type="aff" rid="r47516a1">1</xref>
        <role>Referee</role>
        <contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2664-3744</contrib-id>
      </contrib>
      <aff id="r47516a1"><label>1</label>Bioinformatics and Scientific Programming Core, National Institute of Child Health and Human Development, National Institutes of Health, Bethesda, MD, USA</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>7</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <related-article related-article-type="peer-reviewed-article" id="d35e2495" ext-link-type="doi" xlink:href="10.12688/f1000research.18676.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>﻿Pysradb is a Python package that extends the existing SRAdb R package by exposing command-line functionality such that metadata queries can be piped to other command-line tools.</p>
    <p> Overall this is a well-written tool with good documentation and tests. As-is, it is very useful and my comments here are only aimed at making the tool more useful.</p>
    <p>
      <bold>Downloading:</bold>
    </p>
    <p> It would be really nice to be able to download fastqs, perhaps using SRAdb's strategy of downloading them from EBI.</p>
    <p> When trying to run the example from the docs, "pysradb download -p SRP000941", I got a 550 HTTP error. Upon closer inspection, some of the SRAs in this entry are no longer available, but it causes the whole download to fail. I'm not quite sure of the underlying cause—this seems to be a mismatch between what's in SRA and the metadata database even though I just downloaded a fresh database with a timestamp of a week ago.</p>
    <p> Two suggestions for making the download more robust. The first is to move on if there are any failures, reporting any failures at the end to stderr. The second is to provide a --list option that only prints the table with URLs such that the user can extract the URLs as needed (for example, to allocate to separate nodes on a cluster where failures can be handled by other mechanisms). With the current set of arguments, the only way to do the latter is to interactively answer "N" to the question of whether to continue downloading.</p>
    <p> It could be useful to just download individual SRRs; I do not see that functionality available.</p>
    <p>
      <bold>Searching:</bold>
    </p>
    <p> An explanation of the search syntax would be helpful (e.g., SQL syntax, which allows wildcards but not regular expressions). More complex examples would be good here. Given the heterogeneity of user-entered metadata in SRA, it would be convenient to use regular expressions when searching (which appears to be possible with Python and sqlite3 using a callback function).</p>
    <p> I would prefer a nicer-formatted "no results found" printed to stderr rather than RuntimeWarning and UserWarning.</p>
    <p>
      <bold>Other:</bold>
    </p>
    <p> An interface to check the timestamp from the metaInfo table of the database would be helpful.</p>
    <p> This may be a personal preference, but I would rather have output be tab-separated instead of requiring additional `tr -s " " | cut -d " "` commands (or awk) to do any sort of manipulation on the command line.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
<sub-article id="report47560" article-type="peer-review">
  <front-stub>
    <article-id pub-id-type="doi">10.5256/f1000research.20450.r47560</article-id>
    <title-group>
      <article-title>Reviewer response for version 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Andrews</surname>
          <given-names>Simon</given-names>
        </name>
        <xref ref-type="aff" rid="r47560a1">1</xref>
        <role>Referee</role>
      </contrib>
      <aff id="r47560a1"><label>1</label>Bioinformatics Group, Babraham Institute, Cambridge, UK</aff>
    </contrib-group>
    <author-notes>
      <fn fn-type="COI-statement">
        <p><bold>Competing interests: </bold>No competing interests were disclosed.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <related-article related-article-type="peer-reviewed-article" id="d35e2578" ext-link-type="doi" xlink:href="10.12688/f1000research.18676.1">Version 1</related-article>
    <custom-meta-group>
      <custom-meta>
        <meta-name>recommendation</meta-name>
        <meta-value>approve</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>Pysradb is a command line utility, written in python, which provides an easy scriptable interface for querying metadata and datasets from the SRA database.</p>
    <p> The authors correctly point out that interacting with GEO/SRA through the official site and APIs can be slow and frustrating, and thus having a tool which can make this process more streamlined is of great value.</p>
    <p> Both the paper and the documentation for the tool are well written and easy to understand.  The tool provides a series of individual operations performing queries, translations or downloads and these can be run individually or chained together through pipes (which is really nice!).</p>
    <p> The tool requires an initial download of the sqlite database from the SRAdb project.  Whilst I can see how this then makes all subsequent operations quick, it does mean that you have to download a &gt;2GB file (which expands to &gt;30GB), taking 30+ mins before you can do anything with the program.  It presumably also means that you need to re-download this file every time there is an update to the data in GEO otherwise your searches are likely to be out of date.  On our site at least, people are often getting data for papers which have just been released so this is going to entail a lot of waiting for this file to download.  It would be great if there was a way to point to a publicly accessible SQL server to do queries without having to do the local download, and then providing the option of pulling a local copy if you need greater performance.  Also having a way to do incremental updates to this file instead of re-downloading the whole thing would be nice. Neither of these is a deal breaker, but they mightn't be too hard to implement?</p>
    <p> The individual tools all worked as described, with the exception of the issues listed at the bottom, and the experience was generally very good with the tool.</p>
    <p> One frustrating limitation is that the piping support is not univeral throughout the tool.  You can pipe into the download command, but not, for example, into the metadata command.  Being able to chain operations such as:</p>
    <p> pysradb gse-to-srp GSE24355 | pysradb metadata | pysra download</p>
    <p> ..or</p>
    <p> pysradb search '"oocyte development"' | head | pysradb metadata</p>
    <p> ..would be really nice and presumably not too hard to support?</p>
    <p> The downloading side of the tool is very useful and probably the part which is hardest to achieve in the main SRA site.  Whilst this worked as described there are some aspects of the way it works which make it a little frustrating.  Firstly, it downloads SRA files, which hardly anyone wants - having a way to get the fastq files directly would be a really useful addition rather than having to run fastq-dump manually afterwards.  It also downloads into a structured set of folders, which makes sense, but for large downloads means your files are scattered through multiple folders which makes life harder when you want to process them.  Even the --out-dir option doesn't mean the files are in that directory, but just that it's used as a basename.  For the names of the files it would be nicer to have a name which incorporated the relevant SRR/SRX ids and maybe the user submitted sample name so that you can actually have a meaningful and complete name from the file.  For example, the types of filenames generated by SRA explorer (https://ewels.github.io/sra-explorer/) are a nice compromise between being predictable, unique and yet informative at the same time.</p>
    <p> If I'm being really picky I'd also quibble a bit at the choice of some of the defaults in the API.  For example, I can't see why the --desc and --expand options aren't the default for the metadata sub-program - give me everything in a nice format and let me cut that down if I don't need everything.  </p>
    <p> Overall this tool is really nice and will be useful for a lot of people.  With a small amount of refinement this is likely to become part of our standard toolbox.</p>
    <p> -----------------------</p>
    <p> Minor points to address:</p>
    <p> 1) The API seems to have changed since the paper was written.  The option to download the metadata is now pysradb metadb, and not pysradb srametadb.  This is wrong in both the paper and the Jupyter notebook example on the github page and should be changed.  It might be nice to allow srametadb as a fallback if people have been using the old name?</p>
    <p> 2) Some of the documentation is incomplete.  For example the quickstart documentation at https://saket-choudhary.me/pysradb/quickstart.html#the-full-list-of-possible-pysradb-operations doesn't list the search operation so I couldn't look up the options I had for that.</p>
    <p> 3) The piping option is great, but on my system generates a crash if there is too much output (possibly more than the pipe buffer can hold?).  Submitted as bug #7</p>
    <p> 4) The metadata command line in the paper is broken.  You need double dashes before the options, so --desc rather than -desc.  This seems to happen elsewhere as well and might just be an auto-format problem.</p>
    <p> 5) If using wget to download the progress bar for downloading doesn't work.  The data comes down but the progress stays at 0%.</p>
    <p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p>
  </body>
</sub-article>
