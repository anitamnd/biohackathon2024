<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7495858</article-id>
    <article-id pub-id-type="publisher-id">3671</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03671-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Model-based clustering for flow and mass cytometry data with clinical information</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Abe</surname>
          <given-names>Ko</given-names>
        </name>
        <address>
          <email>ko.abe@med.nagoya-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Minoura</surname>
          <given-names>Kodai</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maeda</surname>
          <given-names>Yuka</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nishikawa</surname>
          <given-names>Hiroyoshi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Shimamura</surname>
          <given-names>Teppei</given-names>
        </name>
        <address>
          <email>shimamura@med.nagoya-u.ac.jp</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.27476.30</institution-id><institution-id institution-id-type="ISNI">0000 0001 0943 978X</institution-id><institution>Division of Systems Biology, Nagoya University Graduate School of Medicine, </institution></institution-wrap>65 Tsurumai-cho, Showa-ku, Nagoya, 4668550 Japan </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.27476.30</institution-id><institution-id institution-id-type="ISNI">0000 0001 0943 978X</institution-id><institution>Division of Immunology, Nagoya University Graduate School of Medicine, </institution></institution-wrap>65 Tsurumai-cho, Showa-ku, Nagoya, 4668550 Japan </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.272242.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2168 5385</institution-id><institution>Division of Cancer Immunology, Research Institute/EPOC, National Cancer Center, </institution></institution-wrap>Chuo-ku tsukiji 5-1-1/Kashiwa-shi kashiwanoha 6-5-1, Tokyo/Chiba, 1040045/2778577 Japan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <issue>Suppl 13</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. The Supplement Editors declare that they have no competing interests.</issue-sponsor>
    <elocation-id>393</elocation-id>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">High-dimensional flow cytometry and mass cytometry allow systemic-level characterization of more than 10 protein profiles at single-cell resolution and provide a much broader landscape in many biological applications, such as disease diagnosis and prediction of clinical outcome. When associating clinical information with cytometry data, traditional approaches require two distinct steps for identification of cell populations and statistical test to determine whether the difference between two population proportions is significant. These two-step approaches can lead to information loss and analysis bias.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose a novel statistical framework, called LAMBDA (Latent Allocation Model with Bayesian Data Analysis), for simultaneous identification of unknown cell populations and discovery of associations between these populations and clinical information. LAMBDA uses specified probabilistic models designed for modeling the different distribution information for flow or mass cytometry data, respectively. We use a zero-inflated distribution for the mass cytometry data based the characteristics of the data. A simulation study confirms the usefulness of this model by evaluating the accuracy of the estimated parameters. We also demonstrate that LAMBDA can identify associations between cell populations and their clinical outcomes by analyzing real data. LAMBDA is implemented in R and is available from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/abikoushi/lambda">https://github.com/abikoushi/lambda</ext-link>).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Flow cytomety</kwd>
      <kwd>Mass cytometory</kwd>
      <kwd>Bayesian mixture model</kwd>
      <kwd>Stochastic EM algorithm</kwd>
    </kwd-group>
    <conference xlink:href="http://epigenomics.snu.ac.kr/APBC2020/">
      <conf-name>The 18th Asia Pacific Bioinformatics Conference</conf-name>
      <conf-acronym>APBC 2020</conf-acronym>
      <conf-loc>Seoul, Korea</conf-loc>
      <conf-date>18-20 August 2020</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The recent development of high-dimensional flow cytometry and mass cytometry (CyTOF) allows for characterizing cell types and states by detecting the expression levels of pre-defined sets of surface and intracellular proteins at single cell resolution [<xref ref-type="bibr" rid="CR1">1</xref>]. For an individual subject, the modern flow cytometry data consist of 20 or more protein measurements from millions of cells from the subject. The recent mass cytometry systems use antibodies tagged with heavy metal isotopes which reduce signal interference due to spectral overlap and autofluorescence and enable the detection of more than 40 proteins per cell [<xref ref-type="bibr" rid="CR2">2</xref>]. This high-dimensional cytometry data contains useful information to diagnose diseases such as leukemia [<xref ref-type="bibr" rid="CR3">3</xref>] and HIV [<xref ref-type="bibr" rid="CR4">4</xref>], as well as to predict clinical outcomes such as the response to cancer immune-therapies [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p>A key challenge in the analysis of high-dimensional cytometry data is to identify unknown cell populations that relate as prognostic factors to clinical outcomes of interest. Traditional analysis is done by manual gating which suffers not only from the need to detect unknown cell populations, but also from the need to ensure reproducibility [<xref ref-type="bibr" rid="CR6">6</xref>]. This lack of reproducibility has two subjective causes. The first concerns the order in which pairs of markers are explored. This order often allows some degree of freedom in the gating process, so it might lead to the selection of different cells by alternative gating strategies. The second concerns the boundaries of the gates being used. There is considerable diversity between operators in terms of gating strategy, in which some experts gate strictly and others gate generously. The subjective nature of manual gating allows for the production of too wide a variety of results to be accurately reproducible.</p>
    <p>As an alternative to manual gating, researchers have developed several computational methods, including Citrus [<xref ref-type="bibr" rid="CR7">7</xref>], cydar [<xref ref-type="bibr" rid="CR8">8</xref>], and diffcyt [<xref ref-type="bibr" rid="CR9">9</xref>], to infer cell populations or states associated with an outcome variable in high-dimensional cytometry data. However, these methods require two steps: a first step in which cell populations are identified using a clustering algorithm, and a second step in which the summary statistics of the identified cell populations are concatenated into a clinical outcome of interest which can lead to information loss and analysis bias. Furthermore, these methods do not consider the distinctive features of the expression values of mass cytometry data as opposed to flow cytometry data. Mass cytometry data is marked by a zero-inflated distribution (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). That is, proteins can be either ‘on’ or ‘off,’ in which either a positive expression measure is recorded or the recorded expression is zero or negligible, and where a very high proportion of the data entries are zero. On the other hand, in flow cytometry, the boundary between ‘on’ and ‘off’ is more ambiguous, which leads to a bimodal Gaussian distribution (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). Therefore, lack of consideration for this distribution difference in the existing methods masks the underlying difference in cell populations and gives rise to a misleading conclusion in both basic and clinical research.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Conceptual diagram. LAMBDA estimates composition ratio of clusters depends on the clinical information</p></caption><graphic xlink:href="12859_2020_3671_Fig1_HTML" id="MO1"/></fig></p>
    <p>To address the aforementioned problems, we propose a new probabilistic approach for identifying unknown cell populations associated with clinical outcomes of interest which we have named LAMBDA (Latent Allocation Model with Bayesian Data Analysis). The contributions of our proposed method are summarized as follows:
<list list-type="bullet"><list-item><p>Our method is a one-step procedure that directly uses cytometry data at the single cell level to simultaneously discover cell populations and to identify the associations of these populations with clinical outcomes of interest. Our model can also be used to find relationships between cell populations and a single clinical outcome as well as relationships between cell populations and multiple clinical outcomes.</p></list-item><list-item><p>Our method is based on correctly specified probabilistic models that are designed for modeling the different distribution information of flow and mass cytometry data respectively. In the case of flow cytometry, LAMBDA assumes that the data is generated from a mixture of multivariate normal distributions, each of which represents an unknown cell population. On the other hand, in the case of mass cytometry, LAMBDA assumes that the data is generated from a mixture of zero-inflated distributions that represent censoring of expression below a substantial limit of detection. In both models, the compositions of cell populations are assumed to vary with clinical outcomes.</p></list-item><list-item><p>We provide a simple and efficient learning procedure for the proposed model using a stochastic EM algorithm that reduces computational cost. LAMBDA is implemented in the R environment, which is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/abikoushi/LAMBDA">https://github.com/abikoushi/LAMBDA</ext-link>.</p></list-item></list></p>
    <p>From here we will explain the method and its implications in detail. Figure <xref rid="Fig1" ref-type="fig">1</xref> shows a conceptual view of analysis by LAMBDA. The “<xref rid="Sec2" ref-type="sec">Methods</xref>” section details the proposed model and algorithm. The “<xref rid="Sec8" ref-type="sec">Results</xref>” section includes an analysis of the efficiency of LAMBDA using synthetic and real data. The “<xref rid="Sec12" ref-type="sec">Conclusion</xref>” section summarizes the data presented here and describes the possibility for future expansion of this model.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Model for flow cytometry data</title>
      <p>Suppose that we observe the flow cytometry dataset <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {y}_{n} \in \mathbb {R}^{K}$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq1.gif"/></alternatives></inline-formula>, (<italic>n</italic>=1,…,<italic>N</italic>) and clinical information <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {x}_{n} \in \mathbb {R}^{D}$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq2.gif"/></alternatives></inline-formula>. The dataset includes <italic>N</italic> cells, <italic>K</italic> markers and <italic>D</italic>-dimensional clinical information. Our goal is to identify cells populations from the data. Furthermore we seek to understand how these cell populations change depending on the clinical information. LAMBDA is a model based clustering method. Let <italic>L</italic> be the number of clusters. The data generative process of LAMBDA for <bold>flow cytometry</bold> data is defined as follows:
<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \boldsymbol{y}_{n}|w_{n} &amp;\sim \prod_{l=1}^{L} \text{Gaussian}\left(\boldsymbol{\mu_{l}}, \Sigma_{l}\right)^{w_{n,l}}  \\ \boldsymbol{w}_{n} | \boldsymbol{x}_{n} &amp; \sim \text{Categorical}(\boldsymbol{\phi}_{n}) \end{array} $$ \end{document}</tex-math><mml:math id="M6"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mtext>Gaussian</mml:mtext><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:mtext>Categorical</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ1">
          <label>1</label>
          <alternatives>
            <tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \boldsymbol{\phi}_{n} &amp;= \text{softmax}(\boldsymbol{x}_{n}\boldsymbol{\beta})\\[-3pt] \boldsymbol{\mu}_{l} &amp;\sim \text{Gaussian} \left(\boldsymbol{0},\frac{1}{\tau} \boldsymbol{\Sigma}_{l} \right) \\[-3pt] \boldsymbol{\Sigma}_{l}^{-1} &amp;\sim \text{Wishart} \left(\nu,\boldsymbol{\Lambda} \right)  \end{array} $$ \end{document}</tex-math>
            <mml:math id="M8">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">ϕ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mtext>softmax</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">x</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mi mathvariant="bold-italic">β</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">μ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>∼</mml:mo>
                    <mml:mtext>Gaussian</mml:mtext>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:mstyle mathvariant="bold-italic">
                          <mml:mn>0</mml:mn>
                        </mml:mstyle>
                        <mml:mo>,</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>τ</mml:mi>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">Σ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>∼</mml:mo>
                    <mml:mtext>Wishart</mml:mtext>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:mi>ν</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi mathvariant="bold-italic">Λ</mml:mi>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2020_3671_Article_Equ1.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <italic>w</italic><sub><italic>n</italic>,<italic>l</italic></sub> is <italic>l</italic>-th element of <bold><italic>w</italic></bold><sub><italic>n</italic></sub> and <italic>D</italic>×<italic>L</italic> matrix <bold><italic>β</italic></bold> is the effect of clinical information. For identifiability, the first column of <bold><italic>β</italic></bold> is always set as zero. Here, the softmax function is defined by <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {softmax}(\boldsymbol {x})=\frac {\exp (\boldsymbol {x})}{{\sum \nolimits }_{k=1}^{K}{\exp (x_{k})}}$\end{document}</tex-math><mml:math id="M10"><mml:mtext>softmax</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq3.gif"/></alternatives></inline-formula> for vector <bold><italic>x</italic></bold>=(<italic>x</italic><sub>1</sub>,…,<italic>x</italic><sub><italic>K</italic></sub>)<sup>⊤</sup> using an element-wise exponential function. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows a plate diagram of this data generating process. This model is a kind of conditional Gaussian mixture model [<xref ref-type="bibr" rid="CR10">10</xref>]. However, the details of the estimation method are not described in detail in the publication, so we will describe them here.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Plate diagram of the data generating process in LAMBDA for flow cytometry data. The white nodes indicate latent variables and the gray nodes indicate observed variables</p></caption><graphic xlink:href="12859_2020_3671_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Parameter estimation for flow cytometry data</title>
      <p>We find the maximum a posteriori probability (MAP) estimators, using an EM algorithm.</p>
      <p>If the latent variable <italic>w</italic><sub><italic>n</italic>,<italic>l</italic></sub> is given, the complete likelihood of this model is represented by the following formula:
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} L^{(c)} = \prod_{n=1}^{N} \prod_{l=1}^{L} \phi_{n,l}^{w_{n},l} \mathcal{N} (\boldsymbol{y}_{n} | \boldsymbol{\mu}_{l},\boldsymbol{\Sigma}_{l})^{w_{n},l}.  \end{array} $$ \end{document}</tex-math><mml:math id="M12"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>In the E-step, we calculate
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} w_{n,l}^{(i)} = \frac{ \phi_{n,l} \mathcal{N}\left(\boldsymbol{y}_{n} | \boldsymbol{\mu}_{l}^{(i-1)},\boldsymbol{\Sigma}_{l}^{(i-1)}\right) }{{\sum\nolimits}_{l=1}^{L}\phi_{n,l} \mathcal{N}\left(\boldsymbol{y}_{n} | \boldsymbol{\mu}_{l}^{(i-1)},\boldsymbol{\Sigma}_{l}^{(i-1)}\right) },  \end{array} $$ \end{document}</tex-math><mml:math id="M14"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {N}(\boldsymbol {y} | \boldsymbol {\mu },\boldsymbol {\Sigma })$\end{document}</tex-math><mml:math id="M16"><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">Σ</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq4.gif"/></alternatives></inline-formula> is the density function of the multivariate Gaussian distribution with mean <bold><italic>μ</italic></bold> and covariance <bold><italic>Σ</italic></bold>.</p>
      <p>In the M-step, we update the parameters using:
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \mu_{k,l}^{(i)} &amp;= \frac{{\sum\nolimits}_{n=1}^{N} w_{n,l}^{(i)} y_{n,k}}{{\sum\nolimits}_{n=1}^{N} w_{n,l}^{(i)}+ \tau}  \end{array} $$ \end{document}</tex-math><mml:math id="M18"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ5">
          <label>5</label>
          <alternatives>
            <tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \boldsymbol{\Sigma}_{l} &amp;= \frac{{\sum\nolimits}_{n} w_{n,l}^{(i)}\left(\boldsymbol{y}_{n}-\boldsymbol{\mu}_{l}^{(i)}\right)\left(\boldsymbol{y}_{n}-\boldsymbol{\mu}_{l}^{(i)}\right)^{\top} + \tau \boldsymbol{\mu}_{l}^{(i)\top} \boldsymbol{\mu}^{(i)}_{l} +\boldsymbol{\Lambda}}{{\sum\nolimits}_{n} w_{n,l}^{(i)} + \nu - K},  \end{array} $$ \end{document}</tex-math>
            <mml:math id="M20">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi mathvariant="bold-italic">Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>l</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo mathsize="big">∑</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>w</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>l</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mfenced close=")" open="(">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi mathvariant="bold-italic">y</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi mathvariant="bold-italic">μ</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>l</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mfenced>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mfenced close=")" open="(">
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi mathvariant="bold-italic">y</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo>−</mml:mo>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi mathvariant="bold-italic">μ</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>l</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mi>i</mml:mi>
                                    <mml:mo>)</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mfenced>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>⊤</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>+</mml:mo>
                        <mml:mi>τ</mml:mi>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">μ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo>)</mml:mo>
                            <mml:mo>⊤</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">μ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>+</mml:mo>
                        <mml:mi mathvariant="bold-italic">Λ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo mathsize="big">∑</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>w</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>l</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>+</mml:mo>
                        <mml:mi>ν</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="12859_2020_3671_Article_Equ5.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>Because closed form solutions for <bold><italic>β</italic></bold> are unavailable, we use Newton’s method to obtain estimates. We obtain estimates of <bold><italic>β</italic></bold> by maximizing the following equation, with respect to <bold><italic>β</italic></bold>:
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} Q (\boldsymbol{\beta}) = \sum\limits_{n=1}^{N} \sum\limits_{l=1}^{L} &amp; \left\{w_{nl}^{(i)} \left(\sum\limits_{d=1}^{D} x_{nd}\beta_{d,l} \right.\right. \\ &amp;\left. \left. - \log \sum\limits_{l=1}^{L} \exp\left(\sum\limits_{d=1}^{D} x_{n,d} \beta_{d,l} \right) \right) \right\} \end{array} $$ \end{document}</tex-math><mml:math id="M22"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover></mml:mtd><mml:mtd class="align-2"><mml:mfenced open="{"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">nl</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mfenced open="("><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">nd</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mfenced close="}"><mml:mrow><mml:mfenced close=")"><mml:mrow><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>First order derivative of the function <italic>Q</italic>(<bold><italic>β</italic></bold>) is represented by:
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \nabla Q (\boldsymbol{\beta}) = \sum\limits_{n=1}^{N} (\boldsymbol{w}_{n} - \text{softmax}(X_{n} \boldsymbol{\beta})) \otimes \boldsymbol{x}_{n}. \end{array} $$ \end{document}</tex-math><mml:math id="M24"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mo>∇</mml:mo><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext>softmax</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Second order derivative of the function <italic>Q</italic>(<bold><italic>β</italic></bold>) is represented by:
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \nabla^{2} Q (\boldsymbol{\beta}) = \sum\limits_{n=1}^{N} (P_{n} - \text{softmax}(X_{n}\boldsymbol{\beta}) \text{softmax}(X_{n} \boldsymbol{\beta})^{\top}) \otimes \boldsymbol{x}_{n} \boldsymbol{x}_{n}^{\top} \end{array} $$ \end{document}</tex-math><mml:math id="M26"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msup><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext>softmax</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo><mml:mtext>softmax</mml:mtext><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>⊗</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where ⊗ denotes the Kronecker product and <italic>P</italic><sub><italic>n</italic></sub> is defined as follows:
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} P_{n} = \left(\begin{array}{ccccc} \phi_{n,1} &amp; 0 &amp; 0 &amp; \cdots &amp; 0\\ 0 &amp; \phi_{n,2} &amp; 0 &amp;\cdots &amp; 0\\ \vdots &amp; &amp; &amp; &amp; \vdots \\ 0 &amp;0 &amp; 0 &amp;\cdots &amp; \phi_{n,L} \end{array}\right). \end{array} $$ \end{document}</tex-math><mml:math id="M28"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Thus, we update the estimate of <bold><italic>β</italic></bold> using:
<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{vec}(\boldsymbol{\beta}^{(i+1)}) = \text{vec}(\boldsymbol{\beta}^{(i)}) - \text{vec}(\nabla Q (\boldsymbol{\beta})) \left(\nabla^{2} Q (\boldsymbol{\beta}) \right)^{-1},  \end{array} $$ \end{document}</tex-math><mml:math id="M30"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mtext>vec</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>vec</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mtext>vec</mml:mtext><mml:mo>(</mml:mo><mml:mo>∇</mml:mo><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where vec is the vec operator.</p>
    </sec>
    <sec id="Sec5">
      <title>Model for mass cytometry data</title>
      <p>In the same manner as the previous subsection, we observe a mass cytometry dataset, in this case <inline-formula id="IEq5"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {y}_{n} \in \mathbb {R}^{K}$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq5.gif"/></alternatives></inline-formula>, (<italic>n</italic>=1,…,<italic>N</italic>) and clinical information <inline-formula id="IEq6"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {x}_{n} \in \mathbb {R}^{D}$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>ℝ</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq6.gif"/></alternatives></inline-formula>. An important feature of mass cytometry data, is that a very high proportion of the data entries are zero. The ordinary mixture of the Gaussian model can not explain these zeroes. Here, LAMBDA steps in to properly assess the data. The data generative process of LAMBDA for <bold>mass cytometry</bold> data is defined as follows:
<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \boldsymbol{y}_{n} &amp;= \left\{\begin{array}{ll} z_{n,k} &amp; z_{n,k} &gt; 0 \\ 0 &amp; z_{n,k} \le 0 \end{array}\right. \\ \boldsymbol{z}_{n}|w_{n} &amp;\sim \prod_{l=1}^{L} \text{Gaussian}\left(\boldsymbol{\mu_{l}}, \Sigma_{l}\right)^{w_{n,l}}  \\ \boldsymbol{w}_{n} | \boldsymbol{x}_{n} &amp; \sim \text{Categorical}(\boldsymbol{\phi}_{n}) \\ \boldsymbol{\phi}_{n} &amp;= \text{softmax}(\boldsymbol{x}_{n}\boldsymbol{\beta})\\ \boldsymbol{\mu}_{l} &amp;\sim \text{Gaussian} \left(\boldsymbol{0},\frac{1}{\tau} \boldsymbol{\Sigma}_{l} \right)\\ \boldsymbol{\Sigma}_{l}^{-1} &amp;\sim \text{Wishart} \left(\nu,\boldsymbol{\Lambda} \right)  \end{array} $$ \end{document}</tex-math><mml:math id="M36"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mtext>Gaussian</mml:mtext><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mstyle><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:mtext>Categorical</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mtext>softmax</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:mtext>Gaussian</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mn>0</mml:mn></mml:mstyle><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="align-2"><mml:mo>∼</mml:mo><mml:mtext>Wishart</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mi>ν</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">Λ</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> shows a plate diagram of this data generating process.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Plate diagram of the data generating process in LAMBDA for mass cytometry data</p></caption><graphic xlink:href="12859_2020_3671_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Parameter estimation for mass cytometry data</title>
      <p>Looking again at Eq. (<xref rid="Equ11" ref-type="">11</xref>), if the latent variables <italic>w</italic><sub><italic>n</italic></sub> and <italic>z</italic><sub><italic>n</italic></sub> are given, the complete likelihood of this model is represented by the following formula:
<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} L^{(c)} = \prod_{n=1}^{N} \prod_{l=1}^{L} \phi_{n,l}^{w_{n},l} \mathcal{N} (\boldsymbol{z}_{n} | \boldsymbol{\mu}_{l},\boldsymbol{\Sigma}_{l})^{w_{n},l}.  \end{array} $$ \end{document}</tex-math><mml:math id="M38"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>For mass cytometry data, we use a stochastic EM algorithm. In the E step, Monte Carlo samples <inline-formula id="IEq7"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\boldsymbol {w}}_{n}$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\boldsymbol {z}}_{n}$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq8.gif"/></alternatives></inline-formula> replace missing data <bold><italic>w</italic></bold><sub><italic>n</italic></sub> and <bold><italic>z</italic></bold><sub><italic>n</italic></sub>.</p>
      <p>If an arbitrary value for <bold><italic>z</italic></bold><sub><italic>n</italic></sub> is given, we can sample <inline-formula id="IEq9"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde { \boldsymbol {w}}_{n}$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq9.gif"/></alternatives></inline-formula> from following categorical distribution:
<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \tilde{ \boldsymbol{w}}_{n} \sim \text{Categorical} (\boldsymbol{\eta}_{n}) \end{array} $$ \end{document}</tex-math><mml:math id="M46"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Categorical</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">η</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where the <italic>l</italic>-th element of <bold><italic>η</italic></bold><sub><italic>n</italic></sub> is represented by the following formula:
<disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \eta_{nl} = \frac{ \phi_{n,l} \mathcal{N}(\tilde{\boldsymbol{z}}_{n} | \boldsymbol{\mu}_{l},\boldsymbol{\Sigma}_{l}) }{{\sum\nolimits}_{l=1}^{L}\phi_{n,l} \mathcal{N}(\tilde{\boldsymbol{z}}_{n} | \boldsymbol{\mu}_{l},\boldsymbol{\Sigma}_{l}) }. \end{array} $$ \end{document}</tex-math><mml:math id="M48"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">nl</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>In contrast, if an arbitrary value for <bold><italic>w</italic></bold><sub><italic>n</italic></sub> is given, we can sample <inline-formula id="IEq10"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\boldsymbol {z}}_{n}$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq10.gif"/></alternatives></inline-formula> from truncated Normal distribution. The steps of the Gibbs sampler for generating <inline-formula id="IEq11"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\boldsymbol {z}}_{n}$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq11.gif"/></alternatives></inline-formula> are:
<list list-type="bullet"><list-item><p>If <inline-formula id="IEq12"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$y_{n,k} &gt; 0, \tilde z_{n,k} = y_{n,k}$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq12.gif"/></alternatives></inline-formula>, othewise,</p></list-item><list-item><p>let <inline-formula id="IEq13"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu _{k}^{(n)} = \prod _{l=1}^{L} \mu _{k,l}^{\tilde {w}_{n,l}}$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq13.gif"/></alternatives></inline-formula> and <inline-formula id="IEq14"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Sigma _{i,j}^{(n)} = \prod _{l=1}^{L}\Sigma _{i,j,l}^{w_{n,l}}$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq14.gif"/></alternatives></inline-formula>, where <italic>Σ</italic><sub><italic>i</italic>,<italic>j</italic>,<italic>l</italic></sub> is (<italic>i</italic>,<italic>j</italic>)-element of <bold><italic>Σ</italic></bold><sub><italic>l</italic></sub></p></list-item><list-item><p>let <inline-formula id="IEq15"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mu _{k,-k}^{(n)} =\mu _{k}^{(n)} - \Sigma _{k,k}^{(n)} (\boldsymbol {\Sigma }^{(n)})^{-1}_{k,-k}(z_{n,-k} - \boldsymbol {\mu }_{-k}^{(n)})$\end{document}</tex-math><mml:math id="M60"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq15.gif"/></alternatives></inline-formula></p></list-item><list-item><p>let <inline-formula id="IEq16"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$b = \Phi (0| \mu _{k,-k}^{(n)}, \Sigma _{k,k}^{(n)})$\end{document}</tex-math><mml:math id="M62"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mi>Φ</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq16.gif"/></alternatives></inline-formula></p></list-item><list-item><p>let <italic>u</italic>∼Uniform(0,1)</p></list-item><list-item><p><inline-formula id="IEq17"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde z_{n,k} = \mu _{k,-k}^{(n)} + \sqrt {\Sigma _{k,k}^{(n)}} \Phi ^{-1}(u b|0,1)$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt><mml:msup><mml:mrow><mml:mi>Φ</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">ub</mml:mtext><mml:mo>|</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq17.gif"/></alternatives></inline-formula></p></list-item></list></p>
      <p>where <italic>Φ</italic>(<italic>y</italic>|<italic>μ</italic>,<italic>Σ</italic>) denotes the distribution function of a univariate Gaussian distribution with mean <italic>μ</italic> and variance <italic>Σ</italic> and <italic>x</italic><sub>−<italic>i</italic></sub> is the set of all variables in <italic>x</italic> except for the <italic>i</italic>-th variable.</p>
      <p>In the M-step, by replacing <italic>y</italic><sub><italic>n</italic>,<italic>k</italic></sub> and <inline-formula id="IEq18"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$w^{(i)}_{n,l}$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq18.gif"/></alternatives></inline-formula> with samples <inline-formula id="IEq19"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde z_{n,k}$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde w_{n,l}$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq20.gif"/></alternatives></inline-formula>, Eqs. (<xref rid="Equ4" ref-type="">4</xref>), (<xref rid="Equ5" ref-type="">5</xref>), and (<xref rid="Equ10" ref-type="">10</xref>) can be used.</p>
    </sec>
    <sec id="Sec7">
      <title>Model selection</title>
      <p>In fitting the model, it is important to choose an appropriate number for <italic>L</italic>. It is well known that the number of cluster <italic>L</italic> with the lowest Bayesian information criterion (BIC) is an appropriate number. The BIC is defined as follows:
<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{BIC} = -2\log(\mathcal{L}) + f\log(N), \end{array} $$ \end{document}</tex-math><mml:math id="M72"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mtext>BIC</mml:mtext><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="script">ℒ</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq21"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {L}$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="script">ℒ</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq21.gif"/></alternatives></inline-formula> is the likelihood and <italic>f</italic> is the number of estimated parameters. However, for mass cytometry data, it requires a high computational cost to calculate the exact likelihood in the stochastic EM algorithm. Thus, in this article, we use BIC for flow cytometry data, and <italic>elbow</italic> method for mass cytometry data to choose <italic>L</italic>. Elbow method chooses a number of clusters that adding another cluster doesn’t give a better fit to the data. The goodness of fit of the model to data is evaluated by the sum of squared error (SSE). SSE is defined by following:
<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{SSE}=\sum\limits_{n=1}^{N}\sum\limits_{k=1}^{K}\left(y_{n,k} - \text{max}\left(0,\mu_{k}^{(n)}\right)\right)^{2}. \end{array} $$ \end{document}</tex-math><mml:math id="M76"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mtext>SSE</mml:mtext><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mtext>max</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2020_3671_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
  </sec>
  <sec id="Sec8" sec-type="results">
    <title>Results</title>
    <sec id="Sec9">
      <title>Simulation study</title>
      <p>To evaluate the standard error (SE) and the bias of the estimations, we conducted simulation experiments. The bias of <inline-formula id="IEq22"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \theta $\end{document}</tex-math><mml:math id="M78"><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq22.gif"/></alternatives></inline-formula> is defined by the difference between the true value and the estimated value <inline-formula id="IEq23"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(E[\hat {\theta }]-\theta)$\end{document}</tex-math><mml:math id="M80"><mml:mo>(</mml:mo><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>]</mml:mo><mml:mo>−</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq23.gif"/></alternatives></inline-formula>. The synthetic data was naturally produced via the data generating process given by Eq <xref rid="Equ11" ref-type="">11</xref>. We set <italic>K</italic>=10. The <italic>μ</italic> and <italic>Σ</italic> were randomly generated. We used a multivariate normal distribution to generate the synthetic data, and values less than 0 were replaced by 0.</p>
      <p>We estimated the parameters from 100 replicates of the experiment. We set the sample size <italic>N</italic>=2000, the number of clusters <italic>L</italic>=4, and the categories <italic>D</italic>=2. One category has the mixture proportion <bold><italic>ϕ</italic></bold><sub>1</sub>=(0.1,0.2,0.3,0.4)<sup>⊤</sup>, the other has the mixture proportion <bold><italic>ϕ</italic></bold><sub>2</sub>=(0.25,0.25,0.25,0.25)<sup>⊤</sup>. To differentiate these two categories, we set <italic>X</italic>=(<bold><italic>1</italic></bold>,<bold><italic>x</italic></bold>), where <bold><italic>1</italic></bold> is a vector of ones. The variable <bold><italic>x</italic></bold> is a dummy variable to indicate the category. When estimating parameters, we set <italic>τ</italic>=0.01,<italic>ν</italic>=<italic>K</italic>+2, and <italic>Λ</italic> is an identity matrix, which is equivalent to a weakly-informative prior distribution. To avoid the problem of label switching [<xref ref-type="bibr" rid="CR11">11</xref>], the estimated parameters are rearranged as <italic>ϕ</italic><sub>1,1</sub>≤<italic>ϕ</italic><sub>1,2</sub>≤<italic>ϕ</italic><sub>1,3</sub>≤<italic>ϕ</italic><sub>1,4</sub>.</p>
      <p>Synthetic data was analyzed by LAMBDA along with ordinaly Gaussian mixture model (GMM) which cannot incorporate explanatory variables. using R package “mclust”. We estimated the clusters by GMM and calculate the mixture proportion of the estimated clusters by category and the median for each cluster was used as the estimates of <italic>μ</italic>.</p>
      <p>The mean and SE for the estimated <inline-formula id="IEq24"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \mu $\end{document}</tex-math><mml:math id="M82"><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq24.gif"/></alternatives></inline-formula> and <inline-formula id="IEq25"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \Sigma $\end{document}</tex-math><mml:math id="M84"><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq25.gif"/></alternatives></inline-formula> are shown in Figs. <xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>, respectively. We observed that the points were arranged diagonally, indicating that the estimator of LAMBDA is unbiased. In contrast, GMM estimates often have a large bias. The mean and SE for the estimated <inline-formula id="IEq26"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \phi $\end{document}</tex-math><mml:math id="M86"><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq26.gif"/></alternatives></inline-formula> is shown in Table <xref rid="Tab1" ref-type="table">1</xref>. In the case of synthetic data, the algorithm of LAMBDA uses parameters estimated with small biases and is able to produce reasonable estimates.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Simulation result of <bold><italic>μ</italic></bold>. The comparison true <bold><italic>μ</italic></bold> and the mean of estimates <inline-formula id="IEq27"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\hat \mu }$\end{document}</tex-math><mml:math id="M88"><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq27.gif"/></alternatives></inline-formula>. The error bars indicates SE. Left panel show the result of GMM, right panel show the result of LAMBDA</p></caption><graphic xlink:href="12859_2020_3671_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>Simulation result of <bold><italic>Σ</italic></bold>. The comparison true <bold><italic>Σ</italic></bold> and the mean of estimates <inline-formula id="IEq28"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\hat \Sigma }$\end{document}</tex-math><mml:math id="M90"><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq28.gif"/></alternatives></inline-formula>. The error bars indicates SE</p></caption><graphic xlink:href="12859_2020_3671_Fig5_HTML" id="MO5"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Simulation result of mixture proportion</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">cluster</th><th align="left">1</th><th align="left">2</th><th align="left">3</th><th align="left">4</th></tr></thead><tbody><tr><td align="left"/><td align="left" colspan="4">category 1</td></tr><tr><td align="left">true value</td><td align="left">0.1</td><td align="left">0.2</td><td align="left">0.3</td><td align="left">0.4</td></tr><tr><td align="left">mean (LAMBDA)</td><td align="left">0.10</td><td align="left">0.20</td><td align="left">0.30</td><td align="left">0.40</td></tr><tr><td align="left">mean (GMM)</td><td align="left">0.10</td><td align="left">0.20</td><td align="left">0.31</td><td align="left">0.39</td></tr><tr><td align="left">SE (LAMBDA)</td><td align="left">0.01</td><td align="left">0.02</td><td align="left">0.00</td><td align="left">0.01</td></tr><tr><td align="left">SE (GMM)</td><td align="left">0.01</td><td align="left">0.04</td><td align="left">0.03</td><td align="left">0.03</td></tr><tr><td align="left"/><td align="left" colspan="4">category 2</td></tr><tr><td align="left">true value</td><td align="left">0.25</td><td align="left">0.25</td><td align="left">0.25</td><td align="left">0.25</td></tr><tr><td align="left">mean (LAMBDA)</td><td align="left">0.24</td><td align="left">0.26</td><td align="left">0.25</td><td align="left">0.25</td></tr><tr><td align="left">mean (GMM)</td><td align="left">0.25</td><td align="left">0.26</td><td align="left">0.24</td><td align="left">0.24</td></tr><tr><td align="left">SE (LAMBDA)</td><td align="left">0.04</td><td align="left">0.04</td><td align="left">0.03</td><td align="left">0.01</td></tr><tr><td align="left">SE (GMM)</td><td align="left">0.03</td><td align="left">0.04</td><td align="left">0.03</td><td align="left">0.06</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec10">
      <title>Results on real data</title>
      <p>We applied LAMBDA to real world flow and mass cytometry data. When estimating parameters, we set <italic>τ</italic>=0.01,<italic>ν</italic>=<italic>K</italic>+2, and <italic>Λ</italic> is an identity matrix.</p>
      <p>For the case of flow cytometry we turn to Landrigan’s study (<ext-link ext-link-type="uri" xlink:href="https://community.cytobank.org/cytobank/experiments/35226">https://community.cytobank.org/cytobank/experiments/35226</ext-link>), in which naive CD4+ T cells were purified and stimulated by anti-CD3 and anti-CD28 antibodies.</p>
      <p>Five cases were tested: unstimulated, stimulated by only the anti-CD3 antibody, stimulated by both the anti-CD3 and anti-CD28 antibodies, and two cases with different dosages for the anti-CD3 antibody (0.3 <italic>μ</italic>g/mL and 0.8 <italic>μ</italic>g/mL). The purpose of this study is identifying the associations of cell populations with elapsed time from the stimulations start point.</p>
      <p>Thus, we use time, dosage, anti-CD3, and anti-CD28 as the covariate <bold><italic>X</italic></bold>. All variables are treated as dummy variables.</p>
      <p>It is known that stimulation of CD3 triggers activation of naive CD4+ T cells, which accompany the phosphorylation of SLP76/S6 and CD247 (pSLP76/pS6, pCD246) [<xref ref-type="bibr" rid="CR12">12</xref>]. CD28 is the co-stimulatory factor that enhances and prolongs T cell activation [<xref ref-type="bibr" rid="CR13">13</xref>]. Soon after activation, the levels of phosphorylated SLP/S6 and CD247 decrease by negative feedback. Then the cells become CD45RO+ memory T cells. BIC (Fig. <xref rid="Fig6" ref-type="fig">6</xref>) determined the setting of 13 clusters. Figure <xref rid="Fig7" ref-type="fig">7</xref> shows the <inline-formula id="IEq29"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\hat \mu }$\end{document}</tex-math><mml:math id="M92"><mml:mstyle mathvariant="bold-italic"><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mstyle></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq29.gif"/></alternatives></inline-formula>. Also as shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, clusters 1, 3, 4, 11, and 12 are the pSLP76/pS6+ pCD247+activated naive T cells, and clusters 2, 9, and 10 are pSLP76/pS6- pCD247- CD45RO+ memory T cells. The mixture proportion is shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>. While the mixture proportion remains stable over time in unstimulated cases, other cases show a high proportion of activated naive T cells at 3 min and their proportion decreases at 6 and 10 min by deactivation through negative feedback. Figure <xref rid="Fig8" ref-type="fig">8</xref> shows that as activated T cells decrease, the memory T cell population increases, indicating the transformation of naive T cells to memory T cells. This shows that in the case of flow cytometry data the method is able to provide a reasonable interpretation of the cell population clusters.
<fig id="Fig6"><label>Fig. 6</label><caption><p>BIC. <italic>x</italic>-axis corresponds to the number of clusters. <italic>y</italic>-axis corresponds to the BIC</p></caption><graphic xlink:href="12859_2020_3671_Fig6_HTML" id="MO6"/></fig><fig id="Fig7"><label>Fig. 7</label><caption><p>Estimated <inline-formula id="IEq30"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \mu $\end{document}</tex-math><mml:math id="M94"><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq30.gif"/></alternatives></inline-formula> for Landrigan’s study. The <italic>x</italic>-axis corresponds to the markers, and the <italic>y</italic>-axis corresponds to the clusters. Red, white, and blue indicates high, middle, and low marker intensity, respectively</p></caption><graphic xlink:href="12859_2020_3671_Fig7_HTML" id="MO7"/></fig><fig id="Fig8"><label>Fig. 8</label><caption><p>Estimated <inline-formula id="IEq31"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \phi $\end{document}</tex-math><mml:math id="M96"><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq31.gif"/></alternatives></inline-formula> for Landrigan’s study. The <italic>x</italic>-axis corresponds to the timepoints, and the <italic>y</italic>-axis corresponds to the clusters</p></caption><graphic xlink:href="12859_2020_3671_Fig8_HTML" id="MO8"/></fig></p>
      <p>We also applied LAMBDA to mass cytometry data from Jin’s study [<xref ref-type="bibr" rid="CR14">14</xref>]. This data is available in FlowRepository (<ext-link ext-link-type="uri" xlink:href="https://flowrepository.org/">https://flowrepository.org/</ext-link>) under Repository ID: FR-FCM-ZY6C. The purpose of this study is discovering cell population related to clinical responses. In the case of mass cytometry data, for determination of the number of clusters, we used the elbow method, which is performed by plotting the SSE within each cluster against the number of clusters. In this case, the elbow method determined 14 clusters (Fig. <xref rid="Fig9" ref-type="fig">9</xref>).
<fig id="Fig9"><label>Fig. 9</label><caption><p>Elbow plot for Jin’s study. Decrease in SSE saturated at 8 clusters</p></caption><graphic xlink:href="12859_2020_3671_Fig9_HTML" id="MO9"/></fig></p>
      <p>Arranged by severity, clinical responses include healthy donors (ND), partial response (PR), stable disease (SD), and progressive disease (PD). ND were used as the baseline for ICB samples. Figure <xref rid="Fig10" ref-type="fig">10</xref> shows the estimated mixture proportion <inline-formula id="IEq32"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \phi $\end{document}</tex-math><mml:math id="M98"><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq32.gif"/></alternatives></inline-formula>. We observed that the value of the mixture proportion for cluster 2 increases as cancer progresses from PR to PD. Figure <xref rid="Fig11" ref-type="fig">11</xref> shows the estimated <inline-formula id="IEq33"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \mu $\end{document}</tex-math><mml:math id="M100"><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq33.gif"/></alternatives></inline-formula>. We denote hi and lo that the marker is high and low level expressed respectively. Cluster 2 is characterized by CD8+, T-bet lo, EOMES hi, PD1hi, and Ki67 lo. T-bet lo, EOMES hi, PD1hi, and Ki67 lo are exhaustion markers of the T cell. “Exhaustion" refers to cases where a T cell becomes dysfunctional due to the long-term induction of various co-repressive molecules such as PD-1, CTLA-4, and TIM-3. Pauken &amp; Wherry [<xref ref-type="bibr" rid="CR15">15</xref>] reported that the CD8+ T cells of T-bet hi and EOMES lo become T-bet lo, EOMES hi, and PD1 hi through exhaustion. The marker KI67 indicate cell mass culturing. The exhausted T cells have a low expression level in KI67. Blackburn [<xref ref-type="bibr" rid="CR16">16</xref>] reported that the cell populations of T-bet lo, EOMES hi, and PD1 hi are not activated by blocking the PD1 / PDL-1 pathway with immune checkpoint inhibitors. LAMBDA shows that the cluster 2 cell population is high in patients who underwent a PDL1 inhibitor treatment with a poor prognosis. This finding is consistent with Pauken and Blackburn’s study, showing the effectiveness of LAMBDA in interpreting high dimensional mass cytometry data in real situations.
<fig id="Fig10"><label>Fig. 10</label><caption><p>Estimated <inline-formula id="IEq34"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \phi $\end{document}</tex-math><mml:math id="M102"><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq34.gif"/></alternatives></inline-formula> for Jin’s study. In the left figure, <italic>x</italic>-axis corresponds to the mixture proportion <inline-formula id="IEq35"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \phi $\end{document}</tex-math><mml:math id="M104"><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3671_Article_IEq35.gif"/></alternatives></inline-formula>, and the <italic>y</italic>-axis corresponds to the clusters</p></caption><graphic xlink:href="12859_2020_3671_Fig10_HTML" id="MO10"/></fig><fig id="Fig11"><label>Fig. 11</label><caption><p>Heatmap for Jin’s study. <italic>x</italic>-axis corresponds to the markers, and the <italic>y</italic>-axis corresponds to the clusters</p></caption><graphic xlink:href="12859_2020_3671_Fig11_HTML" id="MO11"/></fig></p>
      <p>Through this analysis we can see that LAMBDA is a method that can efficiently estimate various clusters within cell populations and identify the associations between these cell clusters and their clinical outcomes in cases of both flow and mass cytometry data.</p>
    </sec>
  </sec>
  <sec id="Sec11" sec-type="discussion">
    <title>Discussion</title>
    <p>LAMBDA should prove useful as it is described in this paper, but there is room for future study and improvement. Recently, with the development of next generation sequencing technologies, single cell sequencing was introduced to the field of biomedical research. Sequencing the DNA provides a higher resolution of cellular differences and a better understanding of the function of an individual cell in the context of its microenvironment. In this context, our future aim is the extension of LAMBDA for application to single cell DNA data. This will allow us to understand the condition of the cell on a fundamental level, contributing to our overall understanding of biology and its processes.</p>
  </sec>
  <sec id="Sec12" sec-type="conclusion">
    <title>Conclusion</title>
    <p>With the development of high dimensional flow and mass cytometry data, researches have been challenged with the need to properly identify and interpret data about cell populations. To meet this challenge, we proposed a statistical framework that uses flow and mass cytometry data to discover cell clusters and the associations between individual clusters and clinical information.</p>
    <p>As described in the “<xref rid="Sec2" ref-type="sec">Methods</xref>” section, this model uses a stochastic EM to estimate parameters. In terms of computation, this parameter-estimation procedure offers an advantage over procedures that use an ordinary EM algorithm. This is because, in an algorithm that uses ordinary EM, the computational cost is large due to calculating the high-dimensional conditional expectation. By contrast, our procedure involves a Gibbs sampling that substitutes for this requirement, significantly reducing the computational cost.</p>
    <p>In addition to being computationally efficient, our framework also has useful properties from the perspective of data analysis. Usual methods of clustering are not able to support the inclusion of explanatory variables. However, LAMBDA can include any explanatory variables. This property allows LAMBDA to analyze experimental results with various settings. Because of this novel feature, we expect that LAMBDA will be efficiently applied to studies that seek an association between cell populations and clinical information, advancing our ability to predict disease and predict outcomes of treatment.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>BIC</term>
        <def>
          <p>Bayesian information criterion</p>
        </def>
      </def-item>
      <def-item>
        <term>EM</term>
        <def>
          <p>Expectation-maximization</p>
        </def>
      </def-item>
      <def-item>
        <term>GMM</term>
        <def>
          <p>Gaussian mixture model</p>
        </def>
      </def-item>
      <def-item>
        <term>HIV</term>
        <def>
          <p>Human immunodeficiency virus</p>
        </def>
      </def-item>
      <def-item>
        <term>MAP</term>
        <def>
          <p>Maximum a posteriori probability</p>
        </def>
      </def-item>
      <def-item>
        <term>SE</term>
        <def>
          <p>Standard error</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
    <sec id="d30e4474">
      <title>About this supplement</title>
      <p>This article has been published as part of <italic>BMC Bioinformatics Volume 21 Supplement 13, 2020: Selected articles from the 18th Asia Pacific Bioinformatics Conference (APBC 2020): bioinformatics</italic>. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-21-supplement-13">https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-21-supplement-13</ext-link>.;</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>KA and TS designed the proposed algorithm. KM, YM and HN designed the experiments. All authors have read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was supported by JSPS Grant-in-Aid for Scientific Research on Innovative Areas [No. 15H05912, 18H04798, and 19H05210]. It was also supported by the Japan Agency for Medical Research and Development (AMED) under the Strategic Research Program for Brain Sciences [No. JP18dm0107087], and under Practical Research Project for Rare / Intractable Diseases [No. JP17ek0109281]. The super-computing resources were provided by Human Genome Center, University of Tokyo. Publication costs are funded by all of the funding. The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>LAMBDA is implemented with R and is available from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/abikoushi/LAMBDA">https://github.com/abikoushi/LAMBDA</ext-link>).</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p>Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spitzer</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Mass Cytometry: Single Cells, Many Features</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <issue>4</issue>
        <fpage>780</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.019</pub-id>
        <pub-id pub-id-type="pmid">27153492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bendall</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Simonds</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Amir</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Krutzik</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Finck</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bruggner</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Melamed</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Trejo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ornatsky</surname>
            <given-names>OI</given-names>
          </name>
          <name>
            <surname>Balderas</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Plevritis</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Sachs</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pe’er</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tanner</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mass cytometry of differential immune and drug responses across a human hematopoietic continuum</article-title>
        <source>Sci (N Y)</source>
        <year>2011</year>
        <volume>332</volume>
        <issue>6030</issue>
        <fpage>687</fpage>
        <lpage>96</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1198704</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rawstron</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Kreuzer</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Soosapilla</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Spacek</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stehlikova</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Gambell</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Milani</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reproducible diagnosis of chronic lymphocytic leukemia by flow cytometry: An European Research Initiative on CLL (ERIC) &amp; European Society for Clinical Cell Analysis (ESCCA) Harmonisation project</article-title>
        <source>Cytom B Clin Cytom</source>
        <year>2018</year>
        <volume>94</volume>
        <issue>1</issue>
        <fpage>121</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.b.21595</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abraham</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Aubert</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Flow Cytometry, a Versatile Tool for Diagnosis and Monitoring of Primary Immunodeficiencies</article-title>
        <source>Clin Vaccine Immunol</source>
        <year>2016</year>
        <volume>23</volume>
        <issue>4</issue>
        <fpage>254</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1128/CVI.00001-16</pub-id>
        <pub-id pub-id-type="pmid">26912782</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smid</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rodríguez-González</surname>
            <given-names>FG</given-names>
          </name>
          <name>
            <surname>Sieuwerts</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Salgado</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Prager-Van der Smissen</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>van Der Vlugt-Daane</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Van de Vijver</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Breast cancer genome and transcriptome integration implicates specific mutational signatures with immune cell infiltration</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>2910</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms12910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saeys</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Van Gassen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lambrecht</surname>
            <given-names>BN</given-names>
          </name>
        </person-group>
        <article-title>Computational flow cytometry: helping to make sense of high-dimensional immunology data</article-title>
        <source>Nat Rev Immunol</source>
        <year>2016</year>
        <volume>16</volume>
        <issue>7</issue>
        <fpage>449</fpage>
        <pub-id pub-id-type="doi">10.1038/nri.2016.56</pub-id>
        <pub-id pub-id-type="pmid">27320317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bruggner</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Bodenmiller</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dill</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Automated identification of stratifying signatures in cellular subpopulations</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>26</issue>
        <fpage>E2770</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1408792111</pub-id>
        <pub-id pub-id-type="pmid">24979804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <mixed-citation publication-type="other">Lun A, Lun MA, BiocParallel D, biocViews FlowCytometry M. Package ‘cydar’. 2017.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <mixed-citation publication-type="other">Weber LM, Nowicka M, Soneson C, Robinson MD. diffcyt: Differential discovery in high-dimensional cytometry via high-resolution clustering. BioRxiv. 2018:349738.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fahey</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Thane</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Bramwell</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Coward</surname>
            <given-names>WA</given-names>
          </name>
        </person-group>
        <article-title>Conditional Gaussian mixture modelling for dietary pattern analysis</article-title>
        <source>J R Stat Soc Ser A Stat Soc</source>
        <year>2007</year>
        <volume>170</volume>
        <issue>1</issue>
        <fpage>149</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-985X.2006.00452.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Dealing with label switching in mixture models</article-title>
        <source>J R Stat Soc Ser B Stat Methodol</source>
        <year>2000</year>
        <volume>62</volume>
        <issue>4</issue>
        <fpage>795</fpage>
        <lpage>809</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9868.00265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaud</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lesourne</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Love</surname>
            <given-names>PE</given-names>
          </name>
        </person-group>
        <article-title>Regulatory mechanisms in T cell receptor signalling</article-title>
        <source>Nat Rev Immunol</source>
        <year>2018</year>
        <volume>18</volume>
        <issue>8</issue>
        <fpage>485</fpage>
        <lpage>97</lpage>
        <pub-id pub-id-type="doi">10.1038/s41577-018-0020-8</pub-id>
        <pub-id pub-id-type="pmid">29789755</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alegre</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Frauwirth</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>CB</given-names>
          </name>
        </person-group>
        <article-title>T-cell regulation by CD28 and CTLA-4</article-title>
        <source>Nat Rev Immunol</source>
        <year>2001</year>
        <volume>1</volume>
        <issue>3</issue>
        <fpage>220</fpage>
        <pub-id pub-id-type="doi">10.1038/35105024</pub-id>
        <pub-id pub-id-type="pmid">11905831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">Jin G, Xue G, Wang RS, Wu LY, Lance M, Lu Y, Zhang W. Single-Cell Modeling of CD8+ T Cell Exhaustion Predicts Response to Cancer Immunotherapy. bioRxiv. 2018:459867.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pauken</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Wherry</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Overcoming T cell exhaustion in infection and cancer</article-title>
        <source>Trends Immunol</source>
        <year>2015</year>
        <volume>36</volume>
        <issue>4</issue>
        <fpage>265</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1016/j.it.2015.02.008</pub-id>
        <pub-id pub-id-type="pmid">25797516</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blackburn</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Freeman</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Wherry</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Selective expansion of a subset of exhausted CD8 T cells by <italic>α</italic> PD-L1 blockade</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2008</year>
        <volume>105</volume>
        <issue>39</issue>
        <fpage>15016</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0801497105</pub-id>
        <pub-id pub-id-type="pmid">18809920</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
