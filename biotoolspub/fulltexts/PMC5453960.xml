<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5453960</article-id>
    <article-id pub-id-type="publisher-id">2464</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-017-02464-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>UROPA: a tool for Universal RObust Peak Annotation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Kondili</surname>
          <given-names>Maria</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Fust</surname>
          <given-names>Annika</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Preussner</surname>
          <given-names>Jens</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kuenne</surname>
          <given-names>Carsten</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Braun</surname>
          <given-names>Thomas</given-names>
        </name>
        <address>
          <email>thomas.braun@mpi-bn.mpg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Looso</surname>
          <given-names>Mario</given-names>
        </name>
        <address>
          <email>mario.looso@mpi-bn.mpg.de</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Max Planck Institute for Heart and Lung Research, Bioinformatics Core Unit (BCU), Ludwigstrasse 43, 61231 Bad Nauheim, Germany </aff>
      <aff id="Aff2"><label>2</label>Max Planck Institute for Heart and Lung Research, Department of Cardiac Development and Remodeling, Ludwigstrasse 43, 61231 Bad Nauheim, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>2593</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>12</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>4</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <title>﻿﻿﻿﻿Abstract</title>
      <p>The annotation of genomic ranges of interest represents a recurring task for bioinformatics analyses. These ranges can originate from various sources, including peaks called for transcription factor binding sites (TFBS) or histone modification ChIP-seq experiments, chromatin structure and accessibility experiments (such as ATAC-seq), but also from other types of predictions that result in genomic ranges. While peak annotation primarily driven by ChiP-seq was extensively explored, many approaches remain simplistic (“most closely located TSS”), rely on fixed pre-built references, or require complex scripting tasks on behalf of the user. An adaptable, fast, and universal tool, capable to annotate genomic ranges in the respective biological context is critically missing. UROPA (<bold>U</bold>niversal <bold>RO</bold>bust <bold>P</bold>eak <bold>A</bold>nnotator) is a command line based tool, intended for universal genomic range annotation. Based on a configuration file, different target features can be prioritized with multiple integrated queries. These can be sensitive for feature type, distance, strand specificity, feature attributes (e.g. protein_coding) or anchor position relative to the feature. UROPA can incorporate reference annotation files (GTF) from different sources (Gencode, Ensembl, RefSeq), as well as custom reference annotation files. Statistics and plots transparently summarize the annotation process. UROPA is implemented in Python and R.</p>
    </abstract>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p>Many bioinformatic analyses result in the definition of genomic regions of interest, generated by a variety of methods. Minimally, they consist of a chromosome, a start position, and an end position, but can also contain a range of additional data such as the strand of the region. For this type of data, the Browser Extensible Data (BED, https://genome.ucsc.edu/FAQ/FAQformat#format1) format became the <italic>de facto</italic> standard format, and a wide range of tools that are able to handle and produce this datatype were developed. In the context of the extensively used chromatin immunoprecipitation and sequencing (ChIP-seq) method, the regions of interest are commonly referred to as peaks, denoting regions of high coverage of reads produced by the experiment. Peaks are generated by computational tools named “peak callers” (such as MACS2<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> or MUSIC<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>) and denote potential binding sites of the protein under investigation. Frequently, investigated proteins are transcription factors (TF) or histones with specific modifications. In order to interpret these binding sites, a set of peak annotation tools such as Homer<sup><xref ref-type="bibr" rid="CR3">3</xref></sup>, Goldmine<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>, GREAT<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> or ChIPpeakAnno<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> were developed. As these tools are mainly focused on the assignment of TFs or histone modifications to the corresponding gene, they apply methods to calculate the closest distance of a peak to the transcription start site of genes located in the direct neighborhood.</p>
    <p>However, annotation of peaks can become complex (Fig. <xref rid="Fig1" ref-type="fig">1A</xref>), especially in regions where multiple genes are located in close proximity or if features are supposed to be treated preferentially based on their category or relative localization.<fig id="Fig1"><label>Figure 1</label><caption><p>(<bold>A</bold>) Example of a complex annotation situation: region of interest (peak, black bar) overlaps multiple candidate features (blue). These include protein coding genes (PLOD1, MFN2, MIIP, TNFRSF8) with exon (block) and intron (line) structure and non-coding genes (Y-RNA, RN7SL649P, RNU6-777P). Depending on the origin of the peak region the optimal annotation will vary. (<bold>B</bold>) Example on JSON formatted configuration file with two queries: I) begin and end of query section (purple); II) first query targeting gene features with multiple conditions and output filters (key:value pairs, blue); III) second query relating to UTR features (green); IV) global parameters on input files and prioritization. (<bold>C</bold>) Query and feature scheme: Illustration of an oriented feature (orange) and peaks (light and dark blue) that are filtered according to a query with asymmetrical distances as given on top. According to this query, green indicates the valid region around the queried start anchor of the feature. Dark blue peaks centered outside of the green region are never assigned to the feature (upper row, “invalid hits”). Dark blue as well as light blue peaks centered in the green region are assigned to the feature (lower row, “valid hits”). If “internals” key of the query is set to TRUE, light blue peaks given in the upper row are assigned to the feature.</p></caption><graphic xlink:href="41598_2017_2464_Fig1_HTML" id="d29e292"/></fig>
</p>
    <p>The biological origin of peaks can render the annotation step even more complex. In an epigenetics context, the ChIP-seq method is often used to interpret the state of chromatin by the parallel investigation of a number of different histone modifications such as methylation, acetylation or phosphorylation on distinct sites<sup><xref ref-type="bibr" rid="CR7">7</xref></sup>. These marks of open or condensed chromatin are known to influence transcription regulation. In addition, the combination of such histone marks can be used to identify regulatory regions like enhancers, which can be located up to 1 Mb distant from the gene they regulate, thus requiring special care considering optimal annotation.</p>
    <p>While ChIP-seq peaks are one-dimensional in relation to the protein of interest, more recently developed methods are intended to produce information about the global structure of the chromatin (ATAC-seq, FAIRE-seq, DNase-seq, Mnase-seq), giving a detailed footprint on regions that are accessible or closed. However, peaks resulting from such methods implicitly include additional information such as TF and histone binding patterns<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. In order to meaningfully interpret these data, the annotation of these peaks needs to be adapted to combine e.g. genes, TF binding sites and other known regulatory regions.</p>
    <p>Here, we present UROPA (<bold>U</bold>niversal <bold>RO</bold>bust <bold>P</bold>eak <bold>A</bold>nnotator) as a versatile tool to annotate peaks or other genomic regions. UROPA supports a JavaScript Object Notation (JSON) based configuration file format (Fig. <xref rid="Fig1" ref-type="fig">1B</xref>) for simple application, optionally incorporating multiple annotation queries. The tool permits linkage of individual queries including prioritization. Arbitrary features in the reference annotation file can be addressed in a granular way, such as absolute searches for overlaps or searches with distance thresholds for start, center or end position of individual features. Filtering on additional annotation columns in the reference annotation file is supported as well. UROPA generates publication ready graphical statistics on peak annotation rates, feature distribution, and query assessment (Additional File <xref rid="MOESM1" ref-type="media">1</xref>).</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview</title>
      <p>UROPA is a freely available command line application depending on three files: a configuration file (JSON format), a reference annotation file in General Feature Format (GTF, <ext-link ext-link-type="uri" xlink:href="http://www.ensembl.org/info/website/upload/gff.html">http://www.ensembl.org/info/website/upload/gff.html</ext-link>) and a file containing genomic ranges (BED format, e.g. peaks). Beside the widely used genomic annotation files from Gencode, Ensembl, or RefSeq, any custom reference information can be included here, as long as it adheres to the GTF specification (a script to generate GTF files from tab delimited files is provided: see UROPA_to_GTF section in methods). In order to permit simple configuration even for complex annotation problems (Fig. <xref rid="Fig1" ref-type="fig">1C</xref>), we chose JSON format for the configuration file as shown in (Fig. <xref rid="Fig1" ref-type="fig">1B</xref>). Individual queries can be generated that are interpreted one by one for each individual peak under investigation based on the algorithm outlined in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Figure 2</label><caption><p>Outline of the UROPA algorithm. (1) For each peak all queries are consecutively checked for features satisfying various optional criteria. (2) The resulting candidate features are ranked for each query based on the distance of the peak center to the feature anchor(s) of interest (e.g. start, end, center of the feature). (3) All candidate features resulting from any query are stored in the”all hits” table. (4) The best candidate feature for each query is stored in the “best hits” table. (5) Only the one best feature among all queries is stored in the “final hits” table. This step can optionally include prioritization of queries to ensure a desired precedence (e.g. prefer protein_coding genes even if they are located farther away from the peak). These three output files cover various granularities considering the desired outcome.</p></caption><graphic xlink:href="41598_2017_2464_Fig2_HTML" id="d29e357"/></fig>
</p>
    </sec>
    <sec id="Sec4">
      <title>Multi query support and prioritization</title>
      <p>The queries listed in the configuration file defined by the user are flexible statements that allow filtering for all values found in a reference annotation file. UROPA can parse custom generated GTF files with arbitrary keywords as well (see annotation examples below). Within each query line, the user defines filters as <italic>key</italic>:<italic>value</italic> pairs. These independent pairs are linked with a logical AND operation within each row. If multiple values are present for a specific key, these values can be inquired by a list operator (Fig. <xref rid="Fig1" ref-type="fig">1B</xref>). Valid keys are the <italic>features</italic> (e.g. exon, gene, etc.) and <italic>attributes</italic> (e.g. gene_type, gene_status, etc.) of interest, the <italic>distance</italic> that should be used for scanning, the <italic>feature anchor</italic> that should be taken into account for distance calculation, and the <italic>strand</italic> of a peak. The <italic>feature anchor</italic> key specifies the region of a feature that should be used for annotation (e.g. start, end, or center of the feature). This option represents a valuable improvement considering peaks which are located at the end of a gene (<italic>feature anchor</italic>:<italic>end</italic>; e.g. histone modification H3K9me3<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>), or throughout gene bodies (<italic>feature anchor:center</italic>; e.g. H3K36me3<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>). The default annotation mode for many present tools focuses only on the distance to the transcription start site (TSS) (<italic>feature anchor:start</italic>).</p>
      <p>By default, the set of queries specified by the user is connected by an OR operator, attributing the same weight to all queries and giving precedence to the most closely located feature of any query. This behavior can be changed by the global <italic>priority</italic> flag, leading to a hierarchical processing of queries. Here, the first query resulting in a valid candidate feature for a peak will abort any further searches for this peak. This annotation mode is highly versatile, as it permits annotation of peaks with respect to quality levels (e.g. increasing distance sets with respect to TSS), preferred categories (e.g. first protein_coding, then lncRNA, etc.), or exclusive assignments (either genic or intergenic). In order to achieve high quality annotations, two identical queries could be defined with respect to the TSS, that differ considering <italic>distance</italic>. The first one would be defined with a very strict/small distance, the latter with a more relaxed value. In combination with <italic>priority</italic>:true, two groups of peaks would be generated in the result files, one reflecting peaks that are located directly on the TSS (query 0), the second group located in moderate proximity (no hit for query 0, only a hit for query 1). The exclusive priority feature is unique to UROPA (see Table <xref rid="Tab1" ref-type="table">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison matrix of popular annotation tools: the first column defines features supported by the respective tools given in column 2–5. Available/not available features are coded as Y or N, respectively. In case of comparable features, explanations/details are given as key words. *Indicates “only via additional programming”.</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th>Homer</th><th>GREAT</th><th>ChiPpeakAnno</th><th>Goldminer</th><th>UROPA</th></tr></thead><tbody><tr><td>Annotation Database</td><td>Refseq</td><td>UCSC (internal database)</td><td>Pre-calculated sets, e.g. “EnsDb.Hsapiens.v75”</td><td>All genomic range files</td><td>All GTF formatted files</td></tr><tr><td>Helper script to generate annotation file</td><td>assignGenomeAnnotation</td><td>N</td><td>N</td><td>makeGRanges()</td><td>UROPAtoGTF-tool</td></tr><tr><td>Target for distance calculation</td><td>TSS only</td><td>TSS only</td><td>Start/Center/End of selected feature</td><td>Overlap</td><td>Start/Center/End of selected feature</td></tr><tr><td>Select feature type in annotation file</td><td>N</td><td>N</td><td>Y</td><td>(N)*</td><td>Y</td></tr><tr><td>Limitation on characteristics, e.g. “protein_coding”</td><td>N</td><td>N</td><td>N</td><td>(N)*</td><td>Y</td></tr><tr><td>Definition of multiple annotation queries</td><td>N</td><td>N</td><td>N</td><td>N</td><td>Y</td></tr><tr><td>Prioritization of queries</td><td>N</td><td>N</td><td>(Y) no exclusive ranking (precedence)</td><td>(Y) within gene model context, but not globally</td><td>Y</td></tr><tr><td>Limit results to upstream/downstream of selected features</td><td>N</td><td>N</td><td>N</td><td>N</td><td>Y</td></tr><tr><td>Granularity of resulting annotations</td><td>N</td><td>N</td><td>Shows all hits, no aggregation to the best hit</td><td>Clear result structure, but single best hit is often missing</td><td>All hits, best hits per query, and merged best hits among all queries</td></tr><tr><td>Parallelization</td><td>N</td><td>N</td><td>N</td><td>N</td><td>Y</td></tr><tr><td>Simple customizing (no programming)</td><td>N</td><td>Y (only in web-based version)</td><td>N</td><td>N</td><td>Y</td></tr><tr><td>Audience</td><td>Bioinformatician/Biologist</td><td>Biologist</td><td>Bioinformatician</td><td>Bioinformatician</td><td>Bioinformatician/Biologist</td></tr><tr><td>Definition of distance cutoff</td><td>N</td><td>N</td><td>Y</td><td>N</td><td>Y</td></tr></tbody></table></table-wrap>
</p>
    </sec>
    <sec id="Sec5">
      <title>Relative localization</title>
      <p>UROPA can handle a range of cases considering the relative localization of peaks and features versus each other. The strand of peaks can be 1) ignored to retrieve target features on both strands, 2) honored to only retrieve features on the same strand, or 3) can be interpreted to only retrieve features on the opposite strand. These options establish compatibility with various experimental protocols.</p>
      <p>Additionally, we introduced a <italic>direction</italic> key to be set to <italic>upstream</italic> or <italic>downstream</italic>, enabling the assignment of ranges depending on their relative location before or behind a target feature. This option can assist to assign cis-regulatory elements such as transcription factor binding sites to nearby TSS, enforcing candidate genes to be located downstream of the binding site.</p>
      <p>Another useful parameter called <italic>internals</italic> optionally ignores the distance calculation versus candidate features if the peak center is located inside the feature (or vice versa). This exception is supposed to handle cases where large genes fail the distance filter, despite completely overlapping a peak. This option can result in reported distances greater than the maximum distance permitted. The result files report on internal location of the peak inside a feature and vice versa (see also Fig. <xref rid="Fig1" ref-type="fig">1C</xref>).</p>
    </sec>
    <sec id="Sec6">
      <title>Granularity and further result customization</title>
      <p>The interacting attributes <italic>filter attribute</italic> and <italic>attribute value</italic> are unique to UROPA and allow another filtering step during the annotation. Those two keys concern the attributes column of the reference annotation file. The <italic>filter attribute</italic> corresponds to different attributes within this column, e.g. gene_biotype, and the <italic>attribute value</italic> equates to the value of this attribute, e.g. protein coding. Together these can be used to limit the features returned to those of a certain category.</p>
      <p>The two main result files of the tool provide summarizing steps that can either include multiple valid candidate features for the selected queries intended for more complex filtering tasks that the user may apply later, or a final annotation of only one feature per peak (Additional File <xref rid="MOESM1" ref-type="media">1</xref>, Table <xref rid="MOESM1" ref-type="media">1</xref> to <xref rid="MOESM1" ref-type="media">4</xref>). These tables can optionally be condensed further to summarize all valid candidate annotations per peak in one row. If multiple queries are given in the configuration file, an additional intermediate result file is generated, providing the best feature annotation for each query and for each respective peak.</p>
      <p>The output annotation columns can be selected by the user. As indicated in Fig. <xref rid="Fig1" ref-type="fig">1B</xref>, the show.attributes key allows the definition of columns that should be reported in the result files. Furthermore, UROPA optionally generates a global summary report, visualizing characteristics of annotations for a set of input peaks. It generates a number of charts summarizing the occurrences for each feature, the distance for each feature, and the relative position of peaks (Fig. <xref rid="Fig3" ref-type="fig">3A–C</xref>). If UROPA was configured with multiple queries, additional plots comparing the characteristics and overlaps of the individual queries are generated (Fig. <xref rid="Fig3" ref-type="fig">3D–F</xref>). Together, these graphics represent a valuable instrument to interpret the annotation, and can serve to define optimal parameters for future analyses.<fig id="Fig3"><label>Figure 3</label><caption><p>UROPA graphical summary report. (<bold>A</bold>) The distance to the feature anchor is displayed as a fraction of the total peaks annotated using a density plot. This information can be useful to determine optimal distance settings for annotation. (<bold>B</bold>) Relative localization of peaks in relation to the annotated feature (one pie chart plot per feature). (<bold>C</bold>) Bar plot of total occurrence of individual features (one plot per query). (<bold>D</bold>) All queries are included in a pairwise comparison to show possible overlaps. Assuming multiple concurrent queries, the amount of exclusively and commonly annotated peaks can be deduced. (<bold>E</bold>) Distance histogram in relation to query and feature where each query is depicted separately. (<bold>F</bold>) The Chow Ruskey plot represents an area-proportional Venn diagram. It reveals the distribution of peaks that could be annotated per query and works for up to 5 queries.</p></caption><graphic xlink:href="41598_2017_2464_Fig3_HTML" id="d29e799"/></fig>
</p>
      <p>While built-in filter functions of UROPA focus on the distance of the peak center to a target feature, the software furthermore computes overlap percentages between peak and feature, and vice versa. These values can be employed for downstream analyses by the user to perform additional filtering on the annotation candidates to enforce selected amounts of intersection. This can be useful in the ChIP-seq context, e.g. if peaks of a TF are annotated with a custom reference annotation file hosting the location of TF binding sites as features, where a complete overlap of the pattern and peak marks high quality hits.</p>
    </sec>
    <sec id="Sec7">
      <title>Comparison and benchmarking</title>
      <p>In order to demonstrate the universal character as well as the novel features of UROPA, we selected the well-established tools Homer, GREAT, Goldmine and ChIPpeakAnno for a detailed feature comparison and benchmarking (Table <xref rid="Tab1" ref-type="table">1</xref>). As illustrated, UROPA not only combines a set of individual features given by one or some of the other tools in one place, but also considerably extends the functionality of peak annotation processes by features like “free selection of feature characteristics”, “definition of multiple additive or concurrent queries”, “exclusive prioritization”, “limitation to up/downstream locations” and “computational parallelization”. While some of these functions can be manually scripted with methods of existing tools, UROPA reduces the effort by the user significantly, as it is designed to be used without programmatic access and fully encapsulates complex workflows.</p>
      <p>As UROPA is intended to be able to annotate arbitrary regions of interest in a universal manner, it can be configured to simulate the behavior of other annotation tools. We performed a pairwise comparison to the tools named above with a published peak file resulting from a POLR2A ChIP-seq experiment (14989 peaks, see Methods) to prove that we can cover a wide range of existing functionality.</p>
      <p>In our first comparison we used the full reference annotation file of Homer and generated a custom reference file from it to perform annotation with UROPA. As Homer annotates all peaks via the closest feature without any distance limits, we configured UROPA accordingly. As shown in Fig. <xref rid="Fig4" ref-type="fig">4A</xref>, all peaks were annotated via both tools. When we checked for the respective hits for each peak, we found a perfect annotation overlap for 100% of the peaks. Due to these results, we conclude that UROPA is able to simulate the behavior of Homer.<fig id="Fig4"><label>Figure 4</label><caption><p>Global comparison of UROPA to other peak annotation tools. White circles represent peaks without any annotation, blue circles represent the number of peaks exclusively annotated by the respective tool, red circles represent peaks exclusively annotated by UROPA, and violet circles represent peaks annotated by both tools. (<bold>A</bold>) Comparison of UROPA and Homer, no tool specific peaks are reported. (<bold>B</bold>) Comparison of UROPA and Goldminer. (<bold>C</bold>) Comparison of UROPA and GREAT. (<bold>D</bold>) Comparison of UROPA and ChIPpeakAnno.</p></caption><graphic xlink:href="41598_2017_2464_Fig4_HTML" id="d29e838"/></fig>
</p>
      <p>In our second comparison to Goldmine, we used the Gencode hg19 version as reference annotation file. It was downloaded directly from the Gencode website for UROPA, while the getUCSCTable() function was used for Goldmine. We used one query targeting the feature gene, activated the <italic>internals</italic> parameter and set a distance threshold of 100000 for UROPA in order to simulate the basic operation mode of Goldmine (“target closest gene TSS; count overlapping gene as a hit ignoring distance”). As indicated in Fig. <xref rid="Fig4" ref-type="fig">4B</xref>, the results of the tools are very similar, as only a small number of 8 peaks were exclusively annotated by Goldmine. We found all these peaks to be located in a greater distance than demanded by our threshold. When we had a closer look on the single peak annotations, we found seven peaks assigned to different target genes (see Additional File <xref rid="MOESM1" ref-type="media">2</xref>). For six of the genes assigned to these peaks we found no entry in the Gencode version from the website, indicating slight differences between the annotation files. One peak (peak 6230) was annotated to be intergenic with a distance &gt;100000 bp to the next gene in Goldmine, although it overlaps the start position of TLN2, which was assigned via UROPA. Furthermore, we found a considerable number of peaks (~10600) annotated with a distance of 0 in the Goldmine result file that were reported with larger distances in the UROPA result file (see Additional File <xref rid="MOESM1" ref-type="media">2</xref>). From these, we found ~6% to be &gt;10000 bp away, containing two extreme examples (peak_11600 and peak_13322, Additional File <xref rid="MOESM1" ref-type="media">2</xref>) with a distance of 260766 and 116902 to the TSS by UROPA respectively.</p>
      <p>For comparison to GREAT, we utilized the reference annotation file provided at the GREAT homepage for UROPA. Again, we designed the query of UROPA in order to simulate the basal plus extension mode of operation of GREAT (see methods). As indicated in Fig. <xref rid="Fig4" ref-type="fig">4C</xref>, UROPA showed an identical annotation for 99% of the peaks, while ~40% were not annotated by both tools. All annotated peaks were assigned to the identical genes. Due to these results, we conclude that UROPA can simulate the algorithm of GREAT.</p>
      <p>Finally, we benchmarked UROPA against ChIPpeakAnno, a tool that is capable to utilize arbitrary reference annotation files and supports extensive variability considering available parameters. We used an Ensembl based reference annotation file (Homo_sapiens.GRCh37.75), and a comprehensive configuration file (see Methods). As shown in Fig. <xref rid="Fig4" ref-type="fig">4D</xref>, the tools annotated ~72% of all peaks. Within the annotated peaks, we found a large overlap of ~95%, while peaks exclusively annotated by UROPA and ChIPpeakAnno accounted for 2–3% of the total. When we investigated the exclusive peak groups, we found all 200 peaks exclusive to UROPA to be located downstream of features. We thus assume that ChIPpeakAnno removes peaks located downstream of features, ignoring the selected distances. Most of the 320 peaks exclusive to ChIPpeakAnno were located inside or overlapping a feature. As ChIPpeakAnno reports a distance of 0 for these peaks, we were not able to further evaluate this group. However, when we performed a second comparison (Additional File <xref rid="MOESM1" ref-type="media">3</xref>) with our <italic>internals:true</italic> key, we were able to reduce the number of ChIPpeakAnno specific peaks to 103, while the UROPA specific peak number increased to 3166 peaks. In this comparison the latter number was comprised of ~95% of peaks that are located inside of features and ~5% were the already identified downstream assignments. Within the group of annotated peaks, all peaks refer to identical features.</p>
      <p>While we used the same peak file for all comparisons, we found the total number of annotated peaks to be variable (Fig. <xref rid="Fig4" ref-type="fig">4C and D</xref> outer circles). This is assumed to result from differences considering reference annotation files and annotation strategies. Although we were not able to generate a 100% overlap with all reference peak annotation softwares, the benchmark demonstrates that UROPA subsumes basic functions of popular tools.</p>
    </sec>
    <sec id="Sec8">
      <title>Complex use case</title>
      <p>Recent method development in the epigenetics context gave rise to applications that permit the investigation of chromatin structure and accessibility. Assay for Transposase Accessible Chromatin with high-throughput sequencing (ATAC-seq) is one of the latest developments able to report on open chromatin regions. We chose a public dataset from ENCODE (see methods) on megakaryocyte erythroid progenitor (MEP) cells. The progenitor cells give either rise to mature megakaryocytes or erythroid cells. The first lineage specification is driven by a transcription factor (TF) cocktail comprising Runx1, Gabp-alpha and Fli1, while the latter is driven by c-Myc, p300 and Klf1<sup><xref ref-type="bibr" rid="CR10">10</xref></sup> (Fig. <xref rid="Fig5" ref-type="fig">5A</xref>).<fig id="Fig5"><label>Figure 5</label><caption><p>(<bold>A</bold>) Megakaryocyte differentiation, from left to right: Megakaryocyte progenitor cells (MPC) differentiate to erythrocytes (upper branch) or megakaryocytes (lower branch), while specific transcription factors for each branch drive the differentiation process (figure adapted from<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>). (<bold>B</bold>) Heatmaps on four in silico predicted transcription factor binding sites in the mm10 mouse genome assembly. Binding sites are located in the center, surrounded by the ATAC read signal from −1 kb to +1 kb. A globally normalized color scale represents the strength of the respective ATAC signal. The binding profile is shown at the top of each heatmap. Heatmaps from the left to the right represent Gabp-alpha, Fli1and Klf1 as Megakaryocyte progenitor specific transcription factors and Pax7 as Megakaryocyte unrelated factor.</p></caption><graphic xlink:href="41598_2017_2464_Fig5_HTML" id="d29e908"/></fig>
</p>
      <p>The origin of this ATAC-seq dataset suggests that regions with open chromatin will include binding sites of megakaryocyte related TFs and that these binding sites should be located in proximity to protein coding genes. In order to test this assumption, we predicted all potential binding sites for selected TFs (Gabp-alpha, Fli1, Klf1) in the mouse genome <italic>in silico</italic> and visualized the degree of accessible chromatin around these potential binding positions with heat maps and profile plots (Fig. <xref rid="Fig5" ref-type="fig">5B</xref>). As illustrated, megakaryocyte related TFs revealed a clear set of binding sites with accessible chromatin (upper part of the heatmaps, colored dark blue) as well as binding sites that are completely closed (colored in red). Furthermore, the heatmap shows a differing width of the opened chromatin locations, varying from almost 2 kb (upper heatmap) to smaller ranges of ~200 bp (width of dark blue signal). As a control, we included transcription factor Pax7, which is not intended to play a role in megakaryocyte development but is indicated in fetal development and cancer growth<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. As expected, the predicted potential Pax7 binding sites were mostly found to be closed (Fig. <xref rid="Fig5" ref-type="fig">5B</xref> right heatmap). The general degree of chromatin accessibility at the respective sites (shown in the ATAC-seq coverage pattern above heatmaps, Fig. <xref rid="Fig5" ref-type="fig">5B</xref>) is at least a 4 fold higher for the MEP related TFs when compared to the Pax7 control. In order to test our hypothesis expecting proximity of open binding sites to protein coding genes, we clustered the individual heatmaps and generated lists of open and closed potential TF binding sites, respectively. As functional open TF binding sites should be mostly located within the promotor, we annotated the respective lists of genomic positions with an advanced UROPA configuration. We made use of multiple promotor definitions concerning size and localization (small symmetric regions around the TSS and larger asymmetric regions upstream of the TSS (see Methods) in order to unravel the location of TF binding sites in an unbiased way. As expected, we found a large percentage (up to 92%) of the open TF binding sites in the classical promotor regions of protein coding genes, while the corresponding closed TF binding sites are depleted for promotor regions (≪11%). Table <xref rid="Tab2" ref-type="table">2</xref> exemplarily illustrates the distribution of promotor associated binding sites for Gabp-alpha in the open chromatin (c1) and closed chromatin (c2) regions, while the remaining TFs are listed in Additional File <xref rid="MOESM1" ref-type="media">4</xref>. Correspondingly, we examined the results on the Pax7 control TF. We clustered for open and closed binding sites again and annotated the respective groups via UROPA as described before. Not surprisingly, we found a significantly smaller number of open sites that could be assigned to promotors (30–45% for c1, Additional File <xref rid="MOESM1" ref-type="media">4</xref>), indicating a more randomized set of open chromatin locations compared to the megakaryocyte related TFs. In the closed group c2 of Pax7, a similarly low percentage of sites were assigned to promotors as in case of the megakaryocyte related TFs.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Gabp-alpha associated, in silico predicted binding sites: Binding sites are clustered by ATAC-seq signal into open (c1) and closed (c2) regions. For each query indicated as rows, the percentage of peaks with respective annotation is listed. Query 0 to 4 reflect typical promotor definitions, query 5 reflects open intergenic regions. Table is based on the best per query result file.</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Query</th><th rowspan="2">Feature - filter attribute</th><th rowspan="2">Anchor</th><th rowspan="2">Distance</th><th colspan="2">Gabpa</th></tr><tr><th>Cluster 1</th><th>Cluster 2</th></tr></thead><tbody><tr><td><bold>0</bold></td><td>gene - protein coding</td><td>start</td><td>1000:500</td><td>86</td><td>4</td></tr><tr><td><bold>1</bold></td><td>gene - protein coding</td><td>start</td><td>2000:500</td><td>87</td><td>6</td></tr><tr><td><bold>2</bold></td><td>gene - protein coding</td><td>start</td><td>3000:500</td><td>88</td><td>8</td></tr><tr><td><bold>3</bold></td><td>gene - protein coding</td><td>start</td><td>5000:500</td><td>89</td><td>11</td></tr><tr><td><bold>4</bold></td><td>gene - pseudogene</td><td>start</td><td>5000:500</td><td>1</td><td>2</td></tr><tr><td><bold>5</bold></td><td>gene - protein coding</td><td>start</td><td>100000</td><td>100</td><td>78</td></tr></tbody></table></table-wrap>
</p>
    </sec>
    <sec id="Sec9">
      <title>Performance</title>
      <p>As annotation is a reoccurring analysis step applied for many use cases, UROPA supports parallel processing in order to balance computational load and runtime. As shown for a large BED file with &gt;100000 peaks and a complex query set (Additional File <xref rid="MOESM1" ref-type="media">5</xref>), multithreading efficiency approximates a linear trend. For our performance test, we utilized one to sixteen cores on a single socket machine while RAM assignments were constant for all runs. As it was not possible to adjust all tools to perform an identical comparison task, excluding hard-coded additional computations, we decided to not include misleading runtime benchmarks. Nonetheless, we noted that UROPA using 16 threads was approximately twice as fast as the fastest competitor (Goldmine) when annotating peaks with the closest TSS based on Gencode genes, excluding one-time indexing/caching procedures.</p>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p>The correlation of enrichment peaks resulting from ChIP-seq/ATAC-seq or other sequencing based techniques with known features for annotation purposes is a central task for bioinformatics pipelines in the field. Many downstream analyses steps rely on the successful attribution of peaks to the relevant genetic features, which serve as connectors to facilitate pathway enrichment analyses, transcription correlation, network analyses, and other secondary analyses. Especially peaks deriving from histone ChIP-seq experiments present a challenge here, as histone modifications can result in data with variable profiles, targeting not only TSS of genes, but also gene bodies or transcription termination site. Furthermore, different reference annotation files exist which can vary considering gene definitions<sup><xref ref-type="bibr" rid="CR12">12</xref></sup>. Depending on the biological background under investigation, the best reference genes are not necessarily the total set, as non-coding genes may be of lesser interest when compared to protein coding genes or vice versa. Additionally, many peaks do not allow a clear attribution to exactly one reference feature, as multiple valid candidate features may be in range.</p>
    <p>The most popular tools for this class of tasks are arguably Homer and GREAT, which are limited to annotations focused on TSS of the most closely located gene and use fixed reference annotation files that can only be changed with considerable effort. The annotation of peaks resulting from histone modifications not targeting the TSS will invariably lead to inaccurate assignments using these tools. When comparing an annotation run relative to the TSS with another one focusing on the gene center for histone modification H3K36me3, which is mostly enriched in the gene body, we found that ca. 25% of the peaks were annotated with a different gene when using the full Gencode annotation for reference (Analysis of GEO dataset GSM733733, Additional File <xref rid="MOESM1" ref-type="media">6</xref>). ChIPpeakAnno and Goldmine can be adjusted to hone such constraints, but require a certain level of proficiency in the R statistical programming language. Finally a range of other atomic tools like BEDTOOLS<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> and BEDOPS<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> could be chained to effect similar results as provided by UROPA. However, utilizing these tools requires extensive scripting, to combine outputs of multiple separate runs.</p>
    <p>Apart from classical peaks resulting from sequencing based methods as stated above, other genomic ranges of interest exist, where classical peak annotation tools fail. One common example in the epigenetics context are CpG sites, known to be targeted by methyltransferases in order to activate or repress gene transcription. Using UROPA, CpG sites can be easily classified hierarchically as promotor, gene internal, or distal based on three queries.(i: promotor region upstream of protein coding genes; ii: gene body of protein coding genes itself with distance to feature center is zero and internals key set to TRUE; iii: all genes without distance limitation upstream and downstream) and priority key set to TRUE. As a result, one would receive a final annotation file, where each CpG site is classified hierarchically as promotor (i), gene internal (ii), or distal (iii). Similar annotation or classification steps might be carried out for single nucleotide permutations (SNPs). UROPA can be applied with even greater flexibility when employing custom generated reference annotation files. The reference annotation file could host e.g. TFBS for multiple TFs to annotate open chromatin regions derived from ATAC-seq. Another possible application is the correlation of peaks of multiple histone modifications with each other to identify and classify enhancers.</p>
    <p>While there can be a certain amount of complexity involved in setting up a configuration file for a specific task in UROPA, there will be considerable time savings when compared to scripting the underlying agglomerations manually using existing tools. Extensive tutorials are included with UROPA bearing a number of examples for reasonable configurations. As UROPA is fully implemented in Python (only the additional visualization features use R), the installation process is straightforward, while computational load and runtime can easily be adjusted to match the computational resources available.</p>
    <p>Summarizing, UROPA can replace popular tools for peak annotation while considerably extending the functionality and reducing the effort by the user (see Table <xref rid="Tab1" ref-type="table">1</xref>). Particularly ChIP-seq and ATAC-seq datasets can profit from a more dynamic annotation incorporating the specific properties of the respective experiment.</p>
  </sec>
  <sec id="Sec11" sec-type="materials|methods">
    <title>Methods</title>
    <sec id="Sec12">
      <title>UROPA tool</title>
      <p>The tool UROPA was implemented in Python and R. Additionally, we integrate the open-source package tabix<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> for indexing genomic ranges. R is mainly employed for the summary statistics, utilizing the libraries ggplot2<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>, gplots<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, gridExtra<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>, jsonlite<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>, VennDiagram<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>, and Vennerable<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> in their latest version. If multiprocessing is used, the package snow<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> is needed.</p>
      <p>The pipeline is freely available for local execution from our online source repository located at https://github.molgen.mpg.de/loosolab/UROPA. Any GTF formatted reference annotation file as well as any BED formatted regions of interest file can be used as input data. A detailed explanation of all input and output files is available at our online documentation <ext-link ext-link-type="uri" xlink:href="http://uropa.readthedocs.io/en/latest/">http://uropa.readthedocs.io/en/latest/</ext-link>. The UROPA project is licensed under the MIT license.</p>
    </sec>
    <sec id="Sec13">
      <title>Benchmarking</title>
      <p>For tool comparison and benchmarking, we utilized a POLR2A peak file (ENCFF001VFA, assembly hg19, UCSC, version 1.2 from https://www.encodeproject.org/).</p>
      <sec id="Sec14">
        <title>Homer</title>
        <p>The annotatePeaks.pl program from Homer Version 4.7 was used for this comparison. The full annotation file provided during installing Homer (data/genomes/hg19/hg19. full.annotation) was reformatted to GTF format (uropa.to.gtf.R) and used for the UROPA annotation run. Since Homer does not support distance settings, UROPA was also started with the default distance, the query is given below:<disp-formula id="Equ1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mbox{``} queries\mbox{''}:[\{ \mbox{``} show.attributes\mbox{''}: \mbox{``} homer.anno\mbox{''}, \mbox{``} feature.anchor\mbox{''}: \mbox{``} start\mbox{''}\}]$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mo>“</mml:mo><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>[</mml:mo><mml:mo>{</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mo>”</mml:mo><mml:mo>}</mml:mo><mml:mo>]</mml:mo></mml:math><graphic xlink:href="41598_2017_2464_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
      <sec id="Sec15">
        <title>GREAT</title>
        <p>The GREAT run was performed via the web interface (<ext-link ext-link-type="uri" xlink:href="http://bejerano.stanford.edu/great/public/html/">http://bejerano.stanford.edu/great/public/html/</ext-link>) in ‘basal plus extension’ mode with the following parameters: Proximal 5.0 kb upstream, 5.0 kb downstream, plus Distal up to 0.0 k (upstream and downstream of TSS). As the resulting annotation file contained annotations with a distance larger than 5 kb, we manually removed these to achieve equivalence with UROPA. For the UROPA run, we selected the available gene annotation used by GREAT (available at http://bejerano.stanford.edu/help/download/attachments/2752609/hg19.great3.0.genes.txt? version=1&amp;modificationDate=1443465966000&amp;api=v2) after reformatting (uropa.to.gtf.R). The configuration file for UROPA is given below:<disp-formula id="Equ2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c} \mbox{``} queries\mbox{''}:[\{ \mbox{``} feature\mbox{''}: \mbox{``} gene\mbox{''}, \mbox{``} distance\mbox{''}:{5000}, \mbox{``} show.attributes\mbox{''}\\ : \mbox{``} gene\_name\mbox{''}, \mbox{``} feature.anchor\mbox{''}: \mbox{``} start\mbox{''}\}]\end{array}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>“</mml:mo><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>[</mml:mo><mml:mo>{</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mn mathvariant="italic">5000</mml:mn><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>”</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mo>”</mml:mo><mml:mo>}</mml:mo><mml:mo>]</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2017_2464_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p>
      </sec>
      <sec id="Sec16">
        <title>ChIPpeakAnno</title>
        <p>ChIPpeakAnno supports all reference annotation files available in R, e.g. the package Homo_sapiens.GRCh37.75. This file needed translation to GRanges prior usage. The function <italic>annoPeaks (peaks, annoGR, bindingType</italic> = “<italic>startSite</italic>”, <italic>bindingRegion</italic> = <italic>c</italic>(−<italic>5000</italic>, <italic>5000</italic>), <italic>ignore.peak.strand</italic> = <italic>TRUE</italic>) was used for the comparison to UROPA. Homo_sapiens.GRCh37.75 is identical to the Ensembl GTF file, which was used for the UROPA annotation with the following query:<disp-formula id="Equ3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c} \mbox{``} queries\mbox{''}:[\{ \mbox{``} feature\mbox{''}: \mbox{``} gene\mbox{''}, \mbox{``} distance\mbox{''}:{5000}, \mbox{``} show.attributes\mbox{''}\\ :[ \mbox{``} gene\_name\mbox{''}, \mbox{``} gene\_id\mbox{''}], \mbox{``} feature.anchor\mbox{''}: \mbox{``} start\mbox{''}\}]\end{array}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>“</mml:mo><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>[</mml:mo><mml:mo>{</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mn mathvariant="italic">5000</mml:mn><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>”</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>:</mml:mo><mml:mo>[</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>”</mml:mo><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mo>”</mml:mo><mml:mo>}</mml:mo><mml:mo>]</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2017_2464_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>For the comparison displayed in the Additional File <xref rid="MOESM1" ref-type="media">3</xref>, the <italic>internals</italic> key was set to TRUE.</p>
      </sec>
    </sec>
    <sec id="Sec17">
      <title>UROPA to GTF</title>
      <p>The preprocessing tool was implemented in R to transform files that do not adhere to the standard GTF file format. Files intended for reformatting need to include a header line with information about the genomic location (chromosome, start, and end), and may provide further standard GTF columns. Given columns are kept while missing columns are filled with dots. All columns not required for the GTF format will be combined and kept as the attribute column. The tool can either transform one file or a folder of files. Running the tool requires the input file(s) and accepts three more parameters (source, feature, and threads).</p>
      <p>Example command line call:<disp-formula id="Equ4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}Rscript\,UROPAtoGTF.R\,directory/of/various/files/source\\ \quad =UCSC\,feature=TFBS\,threads={5}.\end{array}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>R</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi><mml:mi>t</mml:mi><mml:mspace width=".25em"/><mml:mi>U</mml:mi><mml:mi>R</mml:mi><mml:mi>O</mml:mi><mml:mi>P</mml:mi><mml:mi>A</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mi>F</mml:mi><mml:mo>.</mml:mo><mml:mi>R</mml:mi><mml:mspace width=".25em"/><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>y</mml:mi><mml:mo>/</mml:mo><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mo>/</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>s</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>/</mml:mo><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mi>C</mml:mi><mml:mi>S</mml:mi><mml:mi>C</mml:mi><mml:mspace width=".25em"/><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>F</mml:mi><mml:mi>B</mml:mi><mml:mi>S</mml:mi><mml:mspace width=".25em"/><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn mathvariant="italic">5</mml:mn><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2017_2464_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>
</p>
    </sec>
    <sec id="Sec18">
      <title>Use case ATAC-seq</title>
      <p>ATAC-seq FASTQ/BAM/BIGWIG/BED files were downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.encodeproject.org/">www.encodeproject.org/</ext-link> (accession ENCSR229QKB). The replicates were aligned using STAR<sup><xref ref-type="bibr" rid="CR23">23</xref></sup>.</p>
      <p>Position weight matrices obtained from JASPAR<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> were utilized for TFBS prediction in the mouse genome (assembly mm10) <italic>in silico</italic>. Briefly, all positions across the mouse genome with a 95% match for respective TFs were identified utilizing the R packages TFBSTools<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> and JASPAR 2016<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>. TF binding patterns related to megakaryocyte progenitor cells (Gabp-alpha(MA0062.2), Fli1 (MA0475.2), Klf1 (MA0493.1)) and megakaryocyte unspecific TF Pax7 (adapted from<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> were used. Predicted binding sites were analyzed by extracting the corresponding ATAC-seq coverage with deepTools<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. To distinguish between open and closed chromatin from these regions including a TF binding pattern, kmeans clustering on the ATAC-seq coverage values was applied. Open and closed sites were extracted and annotated with promotors utilizing UROPA. The analysis was performed for all TFs in parallel. The configuration for the annotation with UROPA was defined as followed:<disp-formula id="Equ5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c} \mbox{``} queries\mbox{''}:[\{ \mbox{``} feature\mbox{''}: \mbox{``} gene\mbox{''}, \mbox{``} distance\mbox{''}:[{1000},{500}],\\  \mbox{``} feature.anchor\mbox{''}: \mbox{``} start\mbox{''},filter.attribute\mbox{''}: \mbox{``} gene\_biotype\mbox{''},\\  \mbox{``} attribute.value\mbox{''}: \mbox{``} protein\_coding\mbox{''}, \mbox{``} show.attributes\mbox{''}\\ :[ \mbox{``} gene\_name\mbox{''}, \mbox{``} gene\_id\mbox{''}]\},\end{array}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>“</mml:mo><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>[</mml:mo><mml:mo>{</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>[</mml:mo><mml:mn mathvariant="italic">1000</mml:mn><mml:mo>,</mml:mo><mml:mn mathvariant="italic">500</mml:mn><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>“</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>_</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>”</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>:</mml:mo><mml:mo>[</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mo>”</mml:mo><mml:mo>]</mml:mo><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2017_2464_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}\{ \mbox{``} feature\mbox{''}: \mbox{``} gene\mbox{''}, \mbox{``} distance\mbox{''}:[{2000},{500}], \mbox{``} feature.anchor\mbox{''}: \mbox{``} start\mbox{''},\\  \mbox{``} filter.attribute\mbox{''}: \mbox{``} gene\_biotype\mbox{''}, \mbox{``} attribute.value\mbox{''}: \mbox{``} protein\_coding\mbox{''}\},\end{array}$$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>{</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>[</mml:mo><mml:mn mathvariant="italic">2000</mml:mn><mml:mo>,</mml:mo><mml:mn mathvariant="italic">500</mml:mn><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>_</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>”</mml:mo><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2017_2464_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}\{ \mbox{``} feature\mbox{''}: \mbox{``} gene\mbox{''}, \mbox{``} distance\mbox{''}:[{3000},{500}], \mbox{``} feature.anchor\mbox{''}: \mbox{``} start\mbox{''},\\  \mbox{``} filter.attribute\mbox{''}: \mbox{``} gene\_biotype\mbox{''}, \mbox{``} attribute.value\mbox{''}: \mbox{``} protein\_coding\mbox{''}\},\end{array}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>{</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>[</mml:mo><mml:mn mathvariant="italic">3000</mml:mn><mml:mo>,</mml:mo><mml:mn mathvariant="italic">500</mml:mn><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>_</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>”</mml:mo><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2017_2464_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}\{ \mbox{``} feature\mbox{''}: \mbox{``} gene\mbox{''}, \mbox{``} distance\mbox{''}:[{5000},{500}], \mbox{``} feature.anchor\mbox{''}: \mbox{``} start\mbox{''},\\  \mbox{``} filter.attribute\mbox{''}: \mbox{``} gene\_biotype\mbox{''}, \mbox{``} attribute.value\mbox{''}: \mbox{``} protein\_coding\mbox{''}\},\end{array}$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>{</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>[</mml:mo><mml:mn mathvariant="italic">5000</mml:mn><mml:mo>,</mml:mo><mml:mn mathvariant="italic">500</mml:mn><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>_</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>”</mml:mo><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2017_2464_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}\{ \mbox{``} feature\mbox{''}: \mbox{``} gene\mbox{''}, \mbox{``} distance\mbox{''}:[{5000},{500}], \mbox{``} feature.anchor\mbox{''}: \mbox{``} start\mbox{''},\\  \mbox{``} filter.attribute\mbox{''}: \mbox{``} gene\_biotype\mbox{''}, \mbox{``} attribute.value\mbox{''}: \mbox{``} pseudogene\mbox{''}\},\end{array}$$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>{</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>[</mml:mo><mml:mn mathvariant="italic">5000</mml:mn><mml:mo>,</mml:mo><mml:mn mathvariant="italic">500</mml:mn><mml:mo>]</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>t</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>p</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>u</mml:mi><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2017_2464_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}\{ \mbox{``} feature\mbox{''}: \mbox{``} gene\mbox{''}, \mbox{``} filter.attribute\mbox{''}: \mbox{``} gene\_biotype\mbox{''},\\  \mbox{``} attribute.value\mbox{''}: \mbox{``} protein\_coding\mbox{''}\}]\end{array}$$\end{document}</tex-math><mml:math id="M20" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>{</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo><mml:mo>“</mml:mo><mml:mi>f</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo>.</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mo>_</mml:mo><mml:mi>b</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>“</mml:mo><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mo>.</mml:mo><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo>”</mml:mo><mml:mo>:</mml:mo><mml:mo>“</mml:mo><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo>_</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mo>”</mml:mo><mml:mo>}</mml:mo><mml:mo>]</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="41598_2017_2464_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p>Evaluation of binding site localization was based on the best per query result file.</p>
    </sec>
    <sec id="Sec19">
      <title>Availability of data and material</title>
      <p>All data used for testing and comparison as well as example data for the UROPA algorithm and UROPA itself can be downloaded from the public github repository: https://github.molgen.mpg.de/loosolab/UROPA.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Electronic supplementary material</title>
    <sec id="Sec20">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2017_2464_MOESM1_ESM.pdf">
            <caption>
              <p>Supplemental Info File</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>Maria Kondili and Annika Fust contributed equally to this work.</p>
    </fn>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p><bold>Supplementary information</bold> accompanies this paper at doi:10.1038/s41598-017-02464-y
</p>
    </fn>
    <fn>
      <p><bold>Publisher's note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Excellence Cluster Cardio-Pulmonary System (ECCPS), Deutsches Zentrum für Herz-Kreislauf-Forschung (DZHK); MPI for Heart and Lung Research.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author Contributions</title>
    <p>J.P., C.K. and M.L. conceived the algorithm, M.K., J.P. and A.F. implemented the algorithm, A.F. and M.L. analyzed the example data, C.K., T.B. and M.L. wrote the manuscript. All authors read and approved it.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar1">
      <title>Competing Interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R137</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id>
        <?supplied-pmid 18798982?>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harmanci</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rozowsky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MUSIC: identification of enriched regions in ChIP-Seq experiments using a mappability-corrected multiscale signal processing framework</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>474</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0474-3</pub-id>
        <?supplied-pmid 25292436?>
        <pub-id pub-id-type="pmid">25292436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>
        <source>Mol Cell</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>576</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id>
        <?supplied-pmid 20513432?>
        <pub-id pub-id-type="pmid">20513432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bhasin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Ting</surname>
            <given-names>AH</given-names>
          </name>
        </person-group>
        <article-title>Goldmine integrates information placing genomic ranges into meaningful biological contexts</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>5550</fpage>
        <lpage>5556</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw477</pub-id>
        <?supplied-pmid 27257071?>
        <pub-id pub-id-type="pmid">27257071</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLean</surname>
            <given-names>CY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>495</fpage>
        <lpage>501</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1630</pub-id>
        <?supplied-pmid 20436461?>
        <pub-id pub-id-type="pmid">20436461</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>LJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ChIPpeakAnno: a Bioconductor package to annotate ChIP-seq and ChIP-chip data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>237</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-237</pub-id>
        <?supplied-pmid 20459804?>
        <pub-id pub-id-type="pmid">20459804</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>VW</given-names>
          </name>
          <name>
            <surname>Goren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Charting histone modifications and the functional organization of mammalian genomes</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>7</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2905</pub-id>
        <?supplied-pmid 21116306?>
        <pub-id pub-id-type="pmid">21116306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Giresi</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Zaba</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1213</fpage>
        <lpage>1218</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2688</pub-id>
        <?supplied-pmid 24097267?>
        <pub-id pub-id-type="pmid">24097267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimura</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Histone modifications for human epigenome analysis</article-title>
        <source>J Hum Genet</source>
        <year>2013</year>
        <volume>58</volume>
        <fpage>439</fpage>
        <lpage>445</lpage>
        <pub-id pub-id-type="doi">10.1038/jhg.2013.66</pub-id>
        <?supplied-pmid 23739122?>
        <pub-id pub-id-type="pmid">23739122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldfarb</surname>
            <given-names>AN</given-names>
          </name>
        </person-group>
        <article-title>Transcriptional control of megakaryocyte development</article-title>
        <source>Oncogene</source>
        <year>2007</year>
        <volume>26</volume>
        <fpage>6795</fpage>
        <lpage>6802</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.onc.1210762</pub-id>
        <?supplied-pmid 17934486?>
        <pub-id pub-id-type="pmid">17934486</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tiffin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Shipley</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pritchard-Jones</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>PAX7 expression in embryonal rhabdomyosarcoma suggests an origin in muscle satellite cells</article-title>
        <source>Br J Cancer</source>
        <year>2003</year>
        <volume>89</volume>
        <fpage>327</fpage>
        <lpage>332</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.bjc.6601040</pub-id>
        <?supplied-pmid 12865925?>
        <pub-id pub-id-type="pmid">12865925</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive evaluation of ensembl, RefSeq, and UCSC annotations in the context of RNA-seq read mapping and gene quantification</article-title>
        <source>BMC Genomics</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>97</fpage>
        <pub-id pub-id-type="doi">10.1186/s12864-015-1308-8</pub-id>
        <?supplied-pmid 25765860?>
        <pub-id pub-id-type="pmid">25765860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>BEDTools: The Swiss-Army Tool for Genome Feature Analysis</article-title>
        <source>Curr Protoc Bioinformatics</source>
        <year>2014</year>
        <volume>47</volume>
        <fpage>11.12.1</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="doi">10.1002/0471250953.bi1112s47</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Neph</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Kuehn</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Operating on Genomic Ranges Using BEDOPS</article-title>
        <source>Methods Mol Biol</source>
        <year>2016</year>
        <volume>1418</volume>
        <fpage>267</fpage>
        <lpage>281</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-4939-3578-9_14</pub-id>
        <?supplied-pmid 27008020?>
        <pub-id pub-id-type="pmid">27008020</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Tabix: fast retrieval of sequence features from generic TAB-delimited files</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>718</fpage>
        <lpage>719</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq671</pub-id>
        <?supplied-pmid 21208982?>
        <pub-id pub-id-type="pmid">21208982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Wickham, H. https://cran.r-project.org/web/packages/ggplot2/index.html. (Date of access:03/02/2017) (2016).</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Warnes, G. R. <italic>et al</italic>. https://cran.r-project.org/web/packages/gplots/index.html. (Date of access:03/02/2017) (2016).</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Auguie, B. https://cran.r-project.org/web/packages/gridExtra/index.html. (Date of access:03/02/2017) (2016).</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Ooms, J. https://cran.r-project.org/web/packages/jsonlite/index.html. (Date of access:03/02/2017) (2016).</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Boutros, P. https://cran.r-project.org/web/packages/VennDiagram/. (Date of access:03/02/2017) (Clonality of localized and metastatic prostate cancer, Current opinion in urology <bold>26</bold>, 219–24, doi:10.1097/MOU.0000000000000279) (2016).</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Swinton, J. https://github.com/js229/Vennerable. (Date of access:03/02/2017) (Novel Fibonacci and non-Fibonacci structure in the sunflower: results of a citizen science experiment, Royal Society open science <bold>3</bold>, doi:10.1098/rsos.160091) (2016).</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Tierney, L., Rossini, A. J., Li, N. &amp; Sevcikova, H. https://cran.r-project.org/web/packages/snow/index.html. (Date of access:03/02/2017) (Once Upon a Time in American Medicine, The American journal of medicine, <bold>129</bold>, 653–4, doi:10.1016/j.amjmed.2015.12.004) (2016).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobin</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>15</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts635</pub-id>
        <?supplied-pmid 23104886?>
        <pub-id pub-id-type="pmid">23104886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathelier</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>JASPAR 2016: a major expansion and update of the open-access database of transcription factor binding profiles</article-title>
        <source>Nucleic Acids Research</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D110</fpage>
        <lpage>D115</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1176</pub-id>
        <?supplied-pmid 26531826?>
        <pub-id pub-id-type="pmid">26531826</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lenhard</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>TFBSTools: an R/bioconductor package for transcription factor binding site analysis</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>1555</fpage>
        <lpage>1556</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw024</pub-id>
        <?supplied-pmid 26794315?>
        <pub-id pub-id-type="pmid">26794315</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathelier</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>JASPAR 2016: a major expansion and update of the open-access database of transcription factor binding profiles</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D110</fpage>
        <lpage>115</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1176</pub-id>
        <?supplied-pmid 26531826?>
        <pub-id pub-id-type="pmid">26531826</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Shadrach</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Wagers</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Lassar</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>Id3 Is a Direct Transcriptional Target of Pax7 in Quiescent Satellite Cells</article-title>
        <source>Molecular Biology of the Cell</source>
        <year>2009</year>
        <volume>20</volume>
        <fpage>3170</fpage>
        <lpage>3177</lpage>
        <pub-id pub-id-type="doi">10.1091/mbc.E08-12-1185</pub-id>
        <?supplied-pmid 19458195?>
        <pub-id pub-id-type="pmid">19458195</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramírez</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Dündar</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Diehl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Grüning</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Manke</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>deepTools: a flexible platform for exploring deep-sequencing data</article-title>
        <source>Nucleic Acids Research</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>W187</fpage>
        <lpage>W191</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku365</pub-id>
        <?supplied-pmid 24799436?>
        <pub-id pub-id-type="pmid">24799436</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
