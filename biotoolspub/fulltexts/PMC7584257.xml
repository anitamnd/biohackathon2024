<?properties open_access?>
<?subarticle pcbi.1007940.r001?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">ploscomp</journal-id>
    <journal-title-group>
      <journal-title>PLoS Computational Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1553-734X</issn>
    <issn pub-type="epub">1553-7358</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7584257</article-id>
    <article-id pub-id-type="publisher-id">PCOMPBIOL-D-19-01547</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007940</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Gene Regulatory Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Regulatory Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Medical Conditions</subject>
          <subj-group>
            <subject>Respiratory Disorders</subject>
            <subj-group>
              <subject>Asthma</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Pulmonology</subject>
          <subj-group>
            <subject>Respiratory Disorders</subject>
            <subj-group>
              <subject>Asthma</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Single Nucleotide Polymorphisms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Identification and Analysis</subject>
            <subj-group>
              <subject>Genetic Networks</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Network Analysis</subject>
          <subj-group>
            <subject>Genetic Networks</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genome Analysis</subject>
            <subj-group>
              <subject>Genome-Wide Association Studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis</subject>
              <subj-group>
                <subject>Genome-Wide Association Studies</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Human Genetics</subject>
            <subj-group>
              <subject>Genome-Wide Association Studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Phenotypes</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Gene Expression</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Physical Sciences</subject>
        <subj-group>
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied Mathematics</subject>
            <subj-group>
              <subject>Algorithms</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Learning gene networks underlying clinical phenotypes using SNP perturbation</article-title>
      <alt-title alt-title-type="running-head">Learning gene networks underlying clinical phenotypes using SNP perturbation</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-7257-1350</contrib-id>
        <name>
          <surname>McCarter</surname>
          <given-names>Calvin</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Resources</role>
        <role content-type="https://casrai.org/credit/">Software</role>
        <role content-type="https://casrai.org/credit/">Visualization</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-3182-0450</contrib-id>
        <name>
          <surname>Howrylak</surname>
          <given-names>Judie</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Data curation</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2939-1036</contrib-id>
        <name>
          <surname>Kim</surname>
          <given-names>Seyoung</given-names>
        </name>
        <role content-type="https://casrai.org/credit/">Conceptualization</role>
        <role content-type="https://casrai.org/credit/">Formal analysis</role>
        <role content-type="https://casrai.org/credit/">Funding acquisition</role>
        <role content-type="https://casrai.org/credit/">Investigation</role>
        <role content-type="https://casrai.org/credit/">Methodology</role>
        <role content-type="https://casrai.org/credit/">Project administration</role>
        <role content-type="https://casrai.org/credit/">Supervision</role>
        <role content-type="https://casrai.org/credit/">Writing – original draft</role>
        <role content-type="https://casrai.org/credit/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff003">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Machine Learning Department, Carnegie Mellon University, Pittsburgh, Pennsylvania, USA</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Pulmonary, Allergy and Critical Care Division, Penn State Milton S. Hershey Medical Center, Hershey, Pennsylvania, USA</addr-line>
    </aff>
    <aff id="aff003">
      <label>3</label>
      <addr-line>Computational Biology Department, Carnegie Mellon University, Pittsburgh, Pennsylvania, USA</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Leslie</surname>
          <given-names>Christina S.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Memorial Sloan-Kettering Cancer Center, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>sssykim@cs.cmu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>10</month>
      <year>2020</year>
    </pub-date>
    <volume>16</volume>
    <issue>10</issue>
    <elocation-id>e1007940</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>5</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 McCarter et al</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>McCarter et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pcbi.1007940.pdf"/>
    <abstract>
      <p>Availability of genome sequence, molecular, and clinical phenotype data for large patient cohorts generated by recent technological advances provides an opportunity to dissect the genetic architecture of complex diseases at system level. However, previous analyses of such data have largely focused on the co-localization of SNPs associated with clinical and expression traits, each identified from genome-wide association studies and expression quantitative trait locus mapping. Thus, their description of the molecular mechanisms behind the SNPs influencing clinical phenotypes was limited to the single gene linked to the co-localized SNP. Here we introduce PerturbNet, a statistical framework for learning gene networks that modulate the influence of genetic variants on phenotypes, using genetic variants as naturally occurring perturbation of a biological system. PerturbNet uses a probabilistic graphical model to directly model the cascade of perturbation from genetic variants to the gene network to the phenotype network along with the networks at each layer of the biological system. PerturbNet learns the entire model by solving a single optimization problem with an efficient algorithm that can analyze human genome-wide data within a few hours. PerturbNet inference procedures extract a detailed description of how the gene network modulates the genetic effects on phenotypes. Using simulated and asthma data, we demonstrate that PerturbNet improves statistical power for detecting disease-linked SNPs and identifies gene networks and network modules mediating the SNP effects on traits, providing deeper insights into the underlying molecular mechanisms.</p>
    </abstract>
    <abstract abstract-type="summary">
      <title>Author summary</title>
      <p>We describe PerturbNet, a statistical framework for learning a gene network that modulates the influence of genetic variants on phenotypes, using genetic variants as naturally occurring perturbation of a biological system. PerturbNet directly models the cascade of perturbation from genetic variants to the gene network to the phenotype network, thus integrating the existing computational tools for eQTL mapping, GWAS, co-localization analysis of eQTL and GWAS variants, and gene network discovery under SNP perturbation within a single statistical framework. We demonstrate that PerturbNet improves statistical power for detecting disease-linked SNPs and uncovers gene networks mediating the SNP effects on traits, with computational efficiency that allows for human data analysis within several hours.</p>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution>NSF</institution>
        </funding-source>
        <award-id>MCB-1149885</award-id>
        <principal-award-recipient>
          <contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0003-2939-1036</contrib-id>
          <name>
            <surname>Kim</surname>
            <given-names>Seyoung</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>The study was funded by NSF MCB-1149885, PA CURE, and NIH 1R21HG011116. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="0"/>
      <page-count count="24"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The PerturbNet software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/SeyoungKimLab/PerturbNet">https://github.com/SeyoungKimLab/PerturbNet</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The PerturbNet software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/SeyoungKimLab/PerturbNet">https://github.com/SeyoungKimLab/PerturbNet</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>One of the key questions in biology is how genetic variants perturb gene regulatory systems to influence disease susceptibility in population. Leveraging the naturally-occurring perturbation of gene expression by genetic variants to study gene regulatory systems has many advantages over experimental perturbation methods such as gene knockdown [<xref rid="pcbi.1007940.ref001" ref-type="bibr">1</xref>] and genome editing techniques [<xref rid="pcbi.1007940.ref002" ref-type="bibr">2</xref>], as it is more cost effective, is more easily applicable to humans, and can lead to more meaningful discoveries via subtle perturbations that occur in nature [<xref rid="pcbi.1007940.ref003" ref-type="bibr">3</xref>]. Several computational methods have been proposed to learn gene networks perturbed by single nucleotide polymorphisms (SNPs) given expression quantitative trait locus (eQTL) data [<xref rid="pcbi.1007940.ref004" ref-type="bibr">4</xref>–<xref rid="pcbi.1007940.ref009" ref-type="bibr">9</xref>]. Further combining eQTL data with clinical phenotype data to study how this gene network perturbed by SNPs in turn influences disease phenotypes has the potential to reveal the complex molecular mechanisms that explain the link between genetic variants and diseases.</p>
    <p>However, the existing computational methods for integrating eQTL and clinical phenotype data lack the ability to learn a gene network as a mediator that receives SNP perturbation and then passes the perturbation effects onto clinical traits. Many of these methods have disregarded gene networks entirely, focusing on the co-localization of an eQTL and a trait-associated SNP [<xref rid="pcbi.1007940.ref010" ref-type="bibr">10</xref>–<xref rid="pcbi.1007940.ref013" ref-type="bibr">13</xref>], each of which was identified in a separate eQTL mapping [<xref rid="pcbi.1007940.ref007" ref-type="bibr">7</xref>, <xref rid="pcbi.1007940.ref014" ref-type="bibr">14</xref>–<xref rid="pcbi.1007940.ref016" ref-type="bibr">16</xref>] and a genome-wide association study (GWAS) [<xref rid="pcbi.1007940.ref017" ref-type="bibr">17</xref>, <xref rid="pcbi.1007940.ref018" ref-type="bibr">18</xref>]. Thus, their description of the regulatory role of the trait-associated SNPs was limited to the single gene whose eQTL co-localized with the GWAS SNP. Other works have used a known gene network to evaluate GWAS SNPs [<xref rid="pcbi.1007940.ref019" ref-type="bibr">19</xref>–<xref rid="pcbi.1007940.ref021" ref-type="bibr">21</xref>] or have looked for correlated associations to a trait module in a post processing step only after identifying the links between individual SNPs and traits [<xref rid="pcbi.1007940.ref022" ref-type="bibr">22</xref>, <xref rid="pcbi.1007940.ref023" ref-type="bibr">23</xref>], thus missing out on the opportunity to discover gene networks via SNP perturbation. Bayesian networks have been used to learn gene regulatory networks and to form a predictive model for diseases with this network [<xref rid="pcbi.1007940.ref024" ref-type="bibr">24</xref>]; however, this approach relied on an elaborate pipeline of data analysis to identify disease-related gene modules and genetic variants, leading to loss of statistical power.</p>
    <p>Here, we introduce PerturbNet, a computational framework for learning a gene network that underlies clinical traits, using genetic variants as a source of perturbation. PerturbNet unifies eQTL mapping, GWAS, co-localization analysis of eQTLs and GWAS SNPs, and gene network recovery within a single statistical framework.</p>
    <p>PerturbNet consists of three components: a probabilistic graphical model, learning algorithms, and inference methods. The PerturbNet model represents the cascade of perturbation from SNPs to gene network and from gene network to phenotype network by stacking two sparse conditional Gaussian graphical models (sCGGMs) [<xref rid="pcbi.1007940.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1007940.ref005" ref-type="bibr">5</xref>], previously developed for learning gene networks perturbed by SNPs (<xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1A</xref>). PerturbNet learning algorithm estimates the entire model from data by solving a single optimization problem that is convex with globally optimal solution, achieving high accuracy and minimal loss of statistical power. We introduce Mega-sCGGM, an sCGGM learning algorithm that is orders-of-magnitude faster with no memory restriction compared to the previous Newton coordinate descent (NCD) [<xref rid="pcbi.1007940.ref025" ref-type="bibr">25</xref>], and use it as a key module of the PerturbNet learning algorithm to allow for large human data analysis. The probabilistic graphical model framework [<xref rid="pcbi.1007940.ref026" ref-type="bibr">26</xref>] of PerturbNet naturally leads to a set of inference methods for revealing perturbations and regulatory relationships that are not explicitly represented as edges but only implicitly present in the model (<xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1B</xref>). Given the model estimated from data, PerturbNet uses these inference methods to characterize how the gene network and modules mediate the SNP effects on clinical traits, uncovering the molecular mechanisms that underlie the link between SNPs and traits.</p>
    <fig id="pcbi.1007940.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pcbi.1007940.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Overview of PerturbNet.</title>
        <p>(A) PerturbNet model as a cascade of two sCGGMs. The blue sCGGM for <italic>p</italic>(<bold>y</bold>|<bold>x</bold>) models a gene network perturbed by SNPs and the green sCGGM for <italic>p</italic>(<bold>z</bold>|<bold>y</bold>) models a clinical trait network perturbed by gene expression levels. (B) PerturbNet inference methods. Given the PerturbNet model in (A), the PerturbNet inference methods infer SNP effects on phenotypes mediated by the gene network (gray and tan dashed arrows), a decomposition of SNP effects on phenotypes into component SNP effects mediated by each gene module (yellow and orange modules for gray dashed arrow and pink module for tan dashed arrow), and the posterior gene network with additional edges between the gene modules influencing the same phenotypes (blue dashed edge). PerturbNet also inherits the inference methods of sCGGMs for inferring indirect perturbation effects resulting from the direct perturbation effects propagating through the networks (blue and green dashed arrows).</p>
      </caption>
      <graphic xlink:href="pcbi.1007940.g001"/>
    </fig>
    <p>We demonstrate PerturbNet using simulated and patient cohort data from the Childhood Asthma Management Program (CAMP) [<xref rid="pcbi.1007940.ref027" ref-type="bibr">27</xref>–<xref rid="pcbi.1007940.ref029" ref-type="bibr">29</xref>]. Compared to the existing methods that combine eQTL and GWAS data [<xref rid="pcbi.1007940.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1007940.ref013" ref-type="bibr">13</xref>], we show PerturbNet provides higher sensitivities for detecting trait-perturbing variants and for identifying genes that mediate the genetic effects on traits, as it learns and leverages gene networks rather than individual genes as mediators. We show the PerturbNet inference methods extract rich information on the role of the gene networks as mediators.</p>
  </sec>
  <sec sec-type="results" id="sec002">
    <title>Results</title>
    <sec id="sec003">
      <title>Methods overview</title>
      <p>We briefly describe the model, learning algorithms, and inference methods for PerturbNet (see <xref ref-type="sec" rid="sec013">Methods</xref> for detail). The PerturbNet model represents the cascaded perturbation from SNPs to gene network to trait network as a Gaussian chain graph model obtained by threading two sCGGMs, each modeling a network and perturbation of this network at the given layer (<xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1A</xref>). The PerturbNet learning algorithm obtains a sparse estimate of the model with few edges in the network by minimizing the negative log-likelihood of data with <italic>L</italic><sub>1</sub>-regularization. Since the PerturbNet learning algorithm uses an sCGGM learning method as a key module, we introduce Mega-sCGGM, an efficient sCGGM learning algorithms for reducing computation time and for removing memory constraint of the previous algorithm.</p>
      <p>PerturbNet provides three inference methods for extracting detailed information on the cascaded network perturbation from the estimated model: INF-I for inferring SNP effects on traits mediated by gene network (gray and tan dashed arrows in <xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1B</xref>), which in turn can be used to reveal the co-localization of the inferred trait-associated SNPs and the eQTLs; INF-II for decomposing SNP effects on traits into components mediated by each gene module (yellow, orange, and pink modules in <xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1B</xref>) within the network, uncovering the mediator genes and modules for SNP effects on traits and revealing the pathways underlying these SNP-trait links; and INF-III for obtaining the posterior gene network after accounting for correlated clinical traits (blue dashed edge in <xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1B</xref>). Additionally, PerturbNet inherits the inference methods of sCGGMs [<xref rid="pcbi.1007940.ref005" ref-type="bibr">5</xref>] for inferring indirect perturbation effects that arise from another direct perturbation exerting its influence through the network (blue and green dashed edges in <xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1B</xref>).</p>
      <p>Using simulated data and asthmatic patient cohort data from the CAMP [<xref rid="pcbi.1007940.ref029" ref-type="bibr">29</xref>], we evaluate PerturbNet against eCAVIAR [<xref rid="pcbi.1007940.ref013" ref-type="bibr">13</xref>], PrediXcan [<xref rid="pcbi.1007940.ref012" ref-type="bibr">12</xref>], and two-layer Lasso (<xref ref-type="supplementary-material" rid="pcbi.1007940.s001">S1 Text</xref>). All of these previous methods combined eQTL and GWAS data to identify genes underlying GWAS SNPs, but none considered a gene network as a mediator of SNP effects on traits.</p>
    </sec>
    <sec id="sec004">
      <title>Simulation experiments</title>
      <p>Using data simulated from real genotypes in the CAMP study and the known ground-truth models, we evaluated PerturbNet and other methods on the accuracy of detecting trait-perturbing SNPs and mediator genes, and on the accuracy of gene network recovery (see <xref ref-type="sec" rid="sec013">Methods</xref>). We simulated datasets with 5, 000 genes and 100 clinical traits, given 10, 000 SNPs on chromosome 1 of 540 non-Hispanic Caucasians from the CAMP study.</p>
      <p>For the tasks of identifying trait-perturbing SNPs and mediator genes, PerturbNet had the highest sensitivities across all false discovery rates (FDRs), regardless of the model types used to simulate data, and regardless of whether a gene is a mediator acting independently or cooperating with other genes in the network Figs (<xref ref-type="fig" rid="pcbi.1007940.g002">2A–2C</xref>). Unlike other methods, PerturbNet has the ability to distinguish between direct and indirect perturbation of a network. This enables a categorization of the role of the mediator gene into four possible combinations, based on whether the perturbation effect the mediator gene receives from SNPs and passes onto clinical trait network is direct or indirect. PerturbNet identified these categories for each mediating gene with high accuracy (<xref ref-type="fig" rid="pcbi.1007940.g002">Fig 2B</xref>).</p>
      <fig id="pcbi.1007940.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1007940.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Results on simulated data.</title>
          <p>The accuracy of PerturbNet, eCAVIAR, PrediXcan, and two-layer Lasso is shown for (A) the recovery of SNPs perturbing traits, (B) the recovery of genes mediating the effect of each SNP on each trait (for PerturbNet, categories for the role of each mediator gene are shown for four possible combinations of direct vs. indirect perturbations that the mediator gene receives from SNPs and passes onto clinical trait network), and (C) the recovery of genes mediating the overall SNP effects on each trait. Ground-truth models with two-layer sCGGMs (left) and two-layer linear regression models (right) were used to simulate data. (D) The accuracy of PerturbNet and GGM on gene network recovery. Networks with SNP perturbation (left) and without SNP perturbation (right) were used as the ground-truth models. Sensitivities at FDR = 0.05 are shown.</p>
        </caption>
        <graphic xlink:href="pcbi.1007940.g002"/>
      </fig>
      <p>On gene network recovery, PerturbNet had higher accuracy on data simulated with SNP perturbation, compared to sparse Gaussian graphical models (GGMs) [<xref rid="pcbi.1007940.ref030" ref-type="bibr">30</xref>, <xref rid="pcbi.1007940.ref031" ref-type="bibr">31</xref>], a popular statistical method for learning gene networks (<xref ref-type="fig" rid="pcbi.1007940.g002">Fig 2D</xref>). PerturbNet’s accuracy did not suffer on data simulated without SNP perturbation. PerturbNet achieved higher accuracy by estimating the entire model of cascaded network perturbation in a single statistical analysis.</p>
    </sec>
    <sec id="sec005">
      <title>Analysis of CAMP data</title>
      <sec id="sec006">
        <title>PerturbNet is scalable for human data analysis</title>
        <p>We compared the computation time of PerturbNet against eCAVIAR, PrediXcan, and two-layer Lasso. We also compared the scalability of Mega-sCGGM, the key subroutine of PerturbNet, against Lasso and NCD [<xref rid="pcbi.1007940.ref025" ref-type="bibr">25</xref>], the previous state-of-the-art optimization method for learning an sCGGM. We used all CAMP data for 11,598 genes and 35 phenotypes, while varying the number of SNPs from 40,056 SNPs in chromosome 1 to 212,757 SNPs in chromosomes 1-6 and to 495,597 SNPs in all autosomal chromosomes.</p>
        <p>PerturbNet analyzed all CAMP data in less than four hours and scaled similarly to other methods that are not concerned with gene networks (<xref ref-type="fig" rid="pcbi.1007940.g003">Fig 3A</xref>). On expression and SNP data, Mega-sCGGM scaled similarly to Lasso [<xref rid="pcbi.1007940.ref032" ref-type="bibr">32</xref>], a computationally efficient but less powerful method, as it only learns eQTLs but not the gene network (<xref ref-type="fig" rid="pcbi.1007940.g003">Fig 3B</xref>). Mega-sCGGM was also significantly more efficient than NCD in terms of both memory requirement and computation time: it analyzed all 495, 597 SNPs within three and a half hours, whereas NCD spent the same amount of time on 1,000 SNPs and ran out of memory on SNPs from chromosome 1. When an estimate from NCD could be obtained on the dataset with 1, 000 SNPs, NCD and Mega-sCGGM obtained an identical estimate, as was expected since they solve the same convex optimization problem with a single global optimum using an exact method without approximation.</p>
        <fig id="pcbi.1007940.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007940.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Comparison of computation time.</title>
            <p>(A) Computation time for analysis of SNP, expression, and clinical trait data from the CAMP study. (B) Computation time for analysis of eQTL data from the CAMP study. NCD, the previous algorithm for sCGGMs, ran out of memory at chromosome 1. The expression levels of 11,598 genes, 35 traits, and varying numbers of SNPs were used.</p>
          </caption>
          <graphic xlink:href="pcbi.1007940.g003"/>
        </fig>
      </sec>
      <sec id="sec007">
        <title>PerturbNet asthma gene network and gene modules</title>
        <p>PerturbNet has the unique ability to determine the gene network perturbed by SNPs underlying clinical traits. To demonstrate this, we first examine the PerturbNet model estimated from the CAMP data (<xref ref-type="supplementary-material" rid="pcbi.1007940.s003">S1 Fig</xref>), focusing on the asthma gene network. In the gene network, out of 11,598 genes, 6,102 genes had at least one neighbor in the network, while the rest of the genes were singleton nodes in the network. To characterize the module structure in this network for further functional analysis, we post-processed the estimated gene network by excluding the singleton nodes and clustering the part of the network corresponding to the 6,102 genes into 20 modules, using the <italic>k</italic>-way network clustering algorithm METIS [<xref rid="pcbi.1007940.ref033" ref-type="bibr">33</xref>]. We tried a variety of settings for the number of clusters <italic>k</italic> and chose <italic>k</italic> = 20 modules as it produced modules that map to dense subnetworks within the full network from visual inspection (<xref ref-type="supplementary-material" rid="pcbi.1007940.s003">S1(B) Table</xref>).</p>
        <p>A close examination of the 20 modules in the PerturbNet gene network revealed that a subset of those modules, modules 13-20, are likely to be involved in asthma. To determine the functional role of the 20 gene modules, we performed GO gene set enrichment analysis [<xref rid="pcbi.1007940.ref034" ref-type="bibr">34</xref>]. For each module, we performed a Fisher’s exact test to find significantly enriched GO categories in biological processes (<italic>p</italic>-value &lt; 0.05 after Bonferroni correction for multiple testing), using the GO database with annotations for 21,002 genes. Modules 13-15 had statistically significant enrichment of GO terms related to immune system function (<xref ref-type="supplementary-material" rid="pcbi.1007940.s011">S1 Table</xref>), suggesting these modules are likely to play a role in asthma, since asthma is an immune disorder. Even though modules 16-20 did not have any significant enrichment of the same GO categories, the set of 374 genes in these modules that are connected to genes in modules 13-15 in the posterior gene network from the PerturbNet inference method INF-III (<xref ref-type="supplementary-material" rid="pcbi.1007940.s004">S2 Fig</xref>) were significantly enriched for several GO categories related to immune system processes (<italic>p</italic>-value &lt; 0.05 after Bonferroni correction; <xref ref-type="supplementary-material" rid="pcbi.1007940.s012">S2 Table</xref>). These genes with immune system GO annotations formed sub-clusters within each of modules 13-20. Overall, the enrichment of immune-related genes in modules 13-20 suggests that these modules are likely the network components involved in the disease process of asthma.</p>
        <p>Furthermore, in the overall PerturbNet model, while all gene modules were perturbed by SNPs in the SNP-to-gene sCGGM (<xref ref-type="supplementary-material" rid="pcbi.1007940.s005">S3(A) Fig</xref>), modules 13-20 had substantially larger effects on the asthma phenotypes in the gene-to-trait sCGGM (<xref ref-type="supplementary-material" rid="pcbi.1007940.s005">S3(B) Fig</xref>), providing additional evidence that modules 13-20 are likely to be implicated in asthma.</p>
      </sec>
      <sec id="sec008">
        <title>PerturbNet finds gene modules 13-20 mediate most of the genetic effects on asthma traits</title>
        <p>Another unique feature of PerturbNet is its inference methods for uncovering how SNP effects on traits are mediated by the gene network and modules. Given the estimated PerturbNet model, we first applied the inference method INF-I to infer the genetic effects on traits mediated by the network, identifying top 500 SNPs with the largest overall effects on traits (<xref ref-type="supplementary-material" rid="pcbi.1007940.s006">S4 Fig</xref> and <xref ref-type="fig" rid="pcbi.1007940.g004">Fig 4</xref> left).</p>
        <fig id="pcbi.1007940.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007940.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>SNP effects on asthma traits mediated by gene network and gene modules from PerturbNet.</title>
            <p>SNP effects on traits for top 50 SNPs from the PerturbNet inference method INF-I (left). The decomposition of these SNP effects into 20 component effects mediated by each gene module from the PerturbNet inference method INF-II (right). Summary of these component effects by summing over traits (center).</p>
          </caption>
          <graphic xlink:href="pcbi.1007940.g004"/>
        </fig>
        <p>Then we applied INF-II to infer the decomposition of these SNP effects from INF-I into component effects mediated by each of the 20 gene modules (<xref ref-type="fig" rid="pcbi.1007940.g004">Fig 4</xref> right). For 99 out of top 500 SNPs, the primary mediators were modules rather than single isolated genes in the network. Moreover, for all of those 99 SNPs, modules 13-20 mediated nearly all of those genetic effects (<xref ref-type="fig" rid="pcbi.1007940.g004">Fig 4</xref> right), providing evidence that the modules enriched with genes involved in immume system function above (<xref ref-type="supplementary-material" rid="pcbi.1007940.s011">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007940.s011">S2</xref> Tables, <xref ref-type="supplementary-material" rid="pcbi.1007940.s005">S3 Fig</xref>) also explain the molecular mechanisms behind the top asthma SNPs. Additionally, the effect of each SNP on traits was mediated by only one of modules 13-20 (<xref ref-type="fig" rid="pcbi.1007940.g004">Fig 4</xref> center), except for two SNPs with two mediator modules, suggesting a SNP influences asthma traits via localized perturbation of the gene network. Our results demonstrate that PerturbNet inference methods can identify candidate gene modules that are mediators of SNP effects on traits. Unlike eCAVIAR, PerturbNet explains the molecular mechanisms behind trait-associated SNPs not simply through an individual gene, whose eQTLs co-localize with GWAS SNPs, but through gene modules mediating SNP effects on traits.</p>
        <p>Most of these asthma SNPs from the inference co-localized with eQTLs for modules 13-20 in the estimated SNP-to-gene sCGGM component of the PerturbNet model (<xref ref-type="supplementary-material" rid="pcbi.1007940.s007">S5 Fig</xref>). Although a small subset of these trait-perturbing SNPs co-localized with eQTLs for modules 1-12, the genetic effects mediated by these modules were weak, suggesting these modules do not propagate the SNP perturbations to the traits and are not likely to play a central role in the development of the disease.</p>
      </sec>
      <sec id="sec009">
        <title>PerturbNet SNPs are most strongly supported by external annotations</title>
        <p>For the top asthma-associated SNPs identified by PerturbNet, eCAVIAR, PrediXcan, and two-layer Lasso, we examined the functional annotations in three external resources (see <xref ref-type="sec" rid="sec013">Methods</xref>): the Encyclopedia of DNA Elements (ENCODE) DNase hypersensitivity sites (GSM1008572) in GM12878 B-lymphoblastoid cell line [<xref rid="pcbi.1007940.ref035" ref-type="bibr">35</xref>], a blood cell type as in CD4+ T lymphocytes in the CAMP study; RegulomeDB [<xref rid="pcbi.1007940.ref036" ref-type="bibr">36</xref>] integrating ENCODE and other sources of annotations for diverse cell types; and SNPs in the National Human Genome Research Institute (NHGRI) GWAS catalog.</p>
        <p>PerturbNet SNPs were most strongly supported as functional by all of the three external resources. PerturbNet SNPs had the largest overlap with the DNase-seq hypersensitivity sites from the ENCODE B-lymphoblastoid cell-line [<xref rid="pcbi.1007940.ref035" ref-type="bibr">35</xref>] with statistical significance (<xref ref-type="fig" rid="pcbi.1007940.g005">Fig 5A</xref>), and also with functionally annotated SNPs in RegulomeDB [<xref rid="pcbi.1007940.ref036" ref-type="bibr">36</xref>], especially with SNPs in the RegulomeDB category 1, which corresponds to the strongest evidence of being located in the functional region and includes SNPs previously identified as eQTLs (<xref ref-type="fig" rid="pcbi.1007940.g005">Fig 5B</xref>). Furthermore, PerturbNet had the largest numbers of SNPs located within 10, 20, 50, and 100kb of 557 asthma SNPs in the NHGRI GWAS catalog [<xref rid="pcbi.1007940.ref037" ref-type="bibr">37</xref>] (<xref ref-type="fig" rid="pcbi.1007940.g005">Fig 5C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007940.s009">S7 Fig</xref>). Applying the PerturbNet inference method to the PerturbNet asthma SNPs within 20kb of the NHGRI GWAS SNPs revealed for all except for one SNP the SNP effects on traits were mediated by modules 13-20 (<xref ref-type="fig" rid="pcbi.1007940.g005">Fig 5D</xref>), showing they may be the key modules underlying these SNPs from the GWAS catalog.</p>
        <fig id="pcbi.1007940.g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007940.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>Comparison of top asthma SNPs from different methods.</title>
            <p>Top asthma SNPs identified by PerturbNet, eCAVIAR, PrediXcan, and two-layer Lasso are compared against external annotations. (A) Overlaps between top asthma SNPs from each method and the ENCODE DNase hypersensitivity sites for B-lymphoblastoid cell line. Statistically significant enrichments (<italic>p</italic>-value &lt; 0.05) are highlighted with red. (B) Overlaps between top 500 asthma SNPs from each method and functionally annotated SNPs in RegulomeDB. Lower scores indicate more likely to be functional. (C) Overlaps with asthma SNPs in the NHGRI GWAS catalog. An overlap is defined as less than 20kb between two SNPs. Statistically significant enrichments (permutation test <italic>p</italic>-value &lt; 0.05) are highlighted with red. (D) PerturbNet gene modules mediating the effects of NHGRI GWAS SNPs that overlap with PerturbNet asthma SNPs in (C). The colorbar indicates the number of PerturbNet asthma SNPs overlapping with each NHGRI SNP.</p>
          </caption>
          <graphic xlink:href="pcbi.1007940.g005"/>
        </fig>
      </sec>
      <sec id="sec010">
        <title>Module 13 mediates the genetic effects of SNP rs12441382 on asthma traits</title>
        <p>We examined module 13 mediating the perturbation of traits by SNP rs12441382, one of the top PerturbNet SNPs (<xref ref-type="fig" rid="pcbi.1007940.g006">Fig 6</xref>). This SNP is located 17kb from rs1841128 in the NHGRI catalog [<xref rid="pcbi.1007940.ref037" ref-type="bibr">37</xref>] for a lung function trait, forced vital capacity [<xref rid="pcbi.1007940.ref038" ref-type="bibr">38</xref>]. These two SNPs have normalized linkage disequilibrium coefficient <italic>D</italic>′ = 1.0 in the 1000 Genomes Project CEU population [<xref rid="pcbi.1007940.ref039" ref-type="bibr">39</xref>]. PerturbNet found two genes, <italic>ATF3</italic> and <italic>EGR2</italic>, that are directly perturbed by this SNP with the strongest effect sizes. Both genes have been previously linked to allergic asthma. <italic>ATF3</italic> is a known negative regulator of allergic asthma and was recently proposed to be a hub of the cellular adaptive-response network, playing a key role in immune diseases [<xref rid="pcbi.1007940.ref040" ref-type="bibr">40</xref>]. The perturbation of <italic>ATF3</italic> by this SNP is also reflected in statistically significant association in univariate regression analysis (FDR <italic>q</italic> = 6.851 × 10<sup>−5</sup>). <italic>EGR2</italic> has been linked to migration of CD4+ T cells to lung and to blood eosinophil levels in asthma [<xref rid="pcbi.1007940.ref041" ref-type="bibr">41</xref>–<xref rid="pcbi.1007940.ref043" ref-type="bibr">43</xref>]. Indirectly perturbed genes near <italic>ATF3</italic> and <italic>EGR2</italic> in the network include <italic>C2</italic> [<xref rid="pcbi.1007940.ref044" ref-type="bibr">44</xref>–<xref rid="pcbi.1007940.ref046" ref-type="bibr">46</xref>], <italic>SERPING1</italic> [<xref rid="pcbi.1007940.ref047" ref-type="bibr">47</xref>], <italic>ZG16B</italic> [<xref rid="pcbi.1007940.ref048" ref-type="bibr">48</xref>], and <italic>CEACAM3</italic> [<xref rid="pcbi.1007940.ref049" ref-type="bibr">49</xref>], all of which have been linked to immune response, asthma, or auto-immune diseases. PerturbNet provided new insights into the molecular characterization based on <italic>ATF3</italic>-centered pathway for the known GWAS SNP whose functional role in asthma has not been fully elucidated.</p>
        <fig id="pcbi.1007940.g006" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007940.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>PerturbNet module 13 mediating the effects of SNP rs12441382 on asthma traits.</title>
            <p>The PerturbNet cascade from SNP rs12441382 to module 13 (outside of yellow box) to trait network (inside of yellow box). Direct SNP perturbations (red arrows), indirect SNP perturbations of expression levels and phenotypes (node colors), and the component of the SNP effects mediated by each gene, summed across all traits (gene node sizes) are shown.</p>
          </caption>
          <graphic xlink:href="pcbi.1007940.g006"/>
        </fig>
      </sec>
      <sec id="sec011">
        <title>PerturbNet robustness analysis on asthma data</title>
        <p>We evaluated the robustness of PerturbNet by fitting the model to perturbed CAMP datasets with either fewer samples or samples with added noise. To generate a modified CAMP dataset with fewer samples, given a desired fraction of samples, we took a random subset of samples without replacement of the fully-observed samples and of the partially-observed samples. To generate CAMP datasets with added noise, given a desired noise standard deviation, we added independent Gaussian noise to both gene expression and phenotype data. For each of the modified datasets, we fit a PerturbNet model. Then, we evaluated the nonzero elements of the estimated parameters in terms of the area under curve (AUC) of receiver operating characteristic (ROC) curves, assuming the parameters obtained from the original CAMP dataset is the ground-truth. We found that the PerturbNet estimates tend to be robust across different fractions of samples and noise levels and do not show significant changes with small perturbation in data (<xref ref-type="fig" rid="pcbi.1007940.g007">Fig 7</xref>).</p>
        <fig id="pcbi.1007940.g007" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1007940.g007</object-id>
          <label>Fig 7</label>
          <caption>
            <title>Robustness of the PerturbNet estimates on perturbed CAMP datasets.</title>
            <p>ROC AUCs are shown for PerturbNet models fit to the CAMP datasets modified with (A) fractions of samples and (B) noise added to the expression and clinical trait data. The non-zero elements in the PerturbNet parameters obtained from the modified datasets were compared against those from the original CAMP data.</p>
          </caption>
          <graphic xlink:href="pcbi.1007940.g007"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec012">
    <title>Discussion</title>
    <p>PerturbNet combined genetic variant, expression, and trait data in a single statistical analysis to model the cascade of influence from SNPs to gene network to phenotype network in a multi-layered biological system. Our results demonstrated several key advantages of our approach. First, PerturbNet detected SNPs perturbing traits through gene expression with higher sensitivity by leveraging gene networks, compared to the existing methods that narrowly focused on detecting the co-localization of eQTLs and GWAS variants with multi-stage analysis [<xref rid="pcbi.1007940.ref010" ref-type="bibr">10</xref>–<xref rid="pcbi.1007940.ref013" ref-type="bibr">13</xref>]. Second, unlike other methods, PerturbNet, using inference methods, could infer how different parts of the gene network act as mediators of the genetic influence on phenotypes, providing insights into the gene regulatory mechanisms underlying the genetic effects on the phenotypes. Finally, PerturbNet accomplished these without sacrificing the computation time, allowing for human data analysis within a few hours.</p>
    <p>PerturbNet is a flexible tool that can be easily extended to model a more complex biological system under genetic influence. Because PerturbNet uses sCGGMs as building blocks, sCGGMs could be threaded in different ways to integrate different data types. To model tissue-specific gene networks underlying genetic effects on clinical traits, a PerturbNet model could be set up with multiple SNP-to-gene sCGGMs, one for each tissue type, all of which are linked to the same gene-to-trait sCGGM. Such a model could explain the phenotypic variability by the gene expression of the relevant tissue types and enable a discovery of SNPs that affect disease phenotypes through specific tissue types. To model genetic perturbation of a biological system with more than two layers that includes microRNAs, proteomes, and metabolomes, multiple sCGGMs could be combined in a PerturbNet model by assigning an sCGGM to each level of the cascaded perturbation. While in this work, we only considered continuous-valued traits, discrete-valued traits could be modeled with conditional random fields (CRFs) [<xref rid="pcbi.1007940.ref026" ref-type="bibr">26</xref>, <xref rid="pcbi.1007940.ref050" ref-type="bibr">50</xref>], a discrete counterpart of sCGGMs, where efficient learning and inference algorithms are available from the huge literature on applications of CRFs to image and text data analysis.</p>
    <p>Our study considered genetic variant, expression, and clinical data collected from the same patient cohort. One future direction is to apply PerturbNet to datasets, where different data types were collected from different cohorts. Each component sCGGM in the model could be estimated using data collected from different cohorts, if not all data types are available from the same cohort.</p>
    <p>Another future direction is to extend PerturbNet to account for the characteristics of non-independent samples such as population structure. Linear mixed effects models (LMMs) have been widely used in genetics to model non-homogenous samples with population stratification. Multi-trait mixed effects models have been proposed to extend an LMM to model multivariate traits through matrix normal distribution [<xref rid="pcbi.1007940.ref051" ref-type="bibr">51</xref>]. A similar strategy could be used to combine LMMs with sCGGMs in a PerturbNet model.</p>
    <p>Finally, PerturbNet could be extended to model non-linear relationships among expression/clinical traits and between traits genetic variants. The sCGGM component of PerturbNet assumed that multivariate expression traits are Gaussian distributed. This is essentially equivalent to assuming that the expression of each gene is a linear function of genetic variants and the expression of other neighboring genes in the gene network. Gaussian graphical models have been extended to non-parametric models to model non-linear dependencies among multiple random variables in high-dimensional setting [<xref rid="pcbi.1007940.ref052" ref-type="bibr">52</xref>]. Our future work includes employing a similar strategy to extend sCGGMs of PerturbNet to model non-linear dependencies.</p>
    <p>The PerturbNet software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/SeyoungKimLab/PerturbNet">https://github.com/SeyoungKimLab/PerturbNet</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec013">
    <title>Methods</title>
    <p>We describe the probabilistic graphical model, learning algorithms, and inference methods of our PerturbNet framework.</p>
    <sec id="sec014">
      <title>PerturbNet model</title>
      <p>We introduce the probabilistic graphical model of the PerturbNet framework. Let <bold>x</bold> denote genotypes at <italic>p</italic> loci for an individual, given as the number of minor alleles at the loci taking values from {0, 1, 2}. Let <inline-formula id="pcbi.1007940.e001"><alternatives><graphic xlink:href="pcbi.1007940.e001.jpg" id="pcbi.1007940.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>q</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> denote expression levels for <italic>q</italic> genes and <inline-formula id="pcbi.1007940.e002"><alternatives><graphic xlink:href="pcbi.1007940.e002.jpg" id="pcbi.1007940.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mi>r</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> measurements for <italic>r</italic> phenotypes for the same individual. Then, PerturbNet models the cascade of influence from SNPs to a gene network to a phenotype network as a Gaussian chain graph model (<xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1A</xref>), a factorized conditional probability distribution defined as follows:
<disp-formula id="pcbi.1007940.e003"><alternatives><graphic xlink:href="pcbi.1007940.e003.jpg" id="pcbi.1007940.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p>
      <p>Each probability factor above is modeled as an sCGGM [<xref rid="pcbi.1007940.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1007940.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1007940.ref025" ref-type="bibr">25</xref>]:
<disp-formula id="pcbi.1007940.e004"><alternatives><graphic xlink:href="pcbi.1007940.e004.jpg" id="pcbi.1007940.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mrow><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mi mathvariant="bold">y</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
<disp-formula id="pcbi.1007940.e005"><alternatives><graphic xlink:href="pcbi.1007940.e005.jpg" id="pcbi.1007940.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mrow><mml:mo form="prefix">exp</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi mathvariant="bold">z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:mi mathvariant="bold">z</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mi mathvariant="bold">z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula></p>
      <p>The first probability factor in <xref ref-type="disp-formula" rid="pcbi.1007940.e004">Eq (2)</xref> models the gene network perturbed by SNPs, representing the gene network as a <italic>q</italic> × <italic>q</italic> positive definite matrix <bold>Λ</bold><sub><bold>y</bold></sub> and the SNP perturbation of this network as <inline-formula id="pcbi.1007940.e006"><alternatives><graphic xlink:href="pcbi.1007940.e006.jpg" id="pcbi.1007940.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The second probability factor in <xref ref-type="disp-formula" rid="pcbi.1007940.e005">Eq (3)</xref> models the phenotype network perturbed by gene expression levels, where the phenotype network <bold>Λ</bold><sub><bold>z</bold></sub> is an <italic>r</italic> × <italic>r</italic> positive definite matrix and the perturbation of this network by gene expression levels is modeled as <inline-formula id="pcbi.1007940.e007"><alternatives><graphic xlink:href="pcbi.1007940.e007.jpg" id="pcbi.1007940.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. <italic>Z</italic><sub>1</sub>(<bold>x</bold>) and <italic>Z</italic><sub>2</sub>(<bold>y</bold>) in Eqs <xref ref-type="disp-formula" rid="pcbi.1007940.e004">(2)</xref> and <xref ref-type="disp-formula" rid="pcbi.1007940.e005">(3)</xref> are constants for ensuring that each sCGGM is a proper probability distribution that integrates to one. Our model in <xref ref-type="disp-formula" rid="pcbi.1007940.e003">Eq (1)</xref> defines a probability distribution over the graph shown in <xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1A</xref>. A non-zero value in the (<italic>i</italic>, <italic>j</italic>)th element of the network parameters, [<bold>Λ</bold><sub><bold>y</bold></sub>]<sub><italic>i</italic>,<italic>j</italic></sub> of <bold>Λ</bold><sub><bold>y</bold></sub> and [<bold>Λ</bold><sub><bold>z</bold></sub>]<sub><italic>i</italic>,<italic>j</italic></sub> of <bold>Λ</bold><sub><bold>z</bold></sub>, corresponds to presence of an edge between the <italic>i</italic>th and <italic>j</italic>th nodes of the corresponding network. Similarly, a non-zero value in the (<italic>i</italic>, <italic>j</italic>)th element of the perturbation parameters, [<bold>Θ<sub>xy</sub>]<sub><italic>i,j</italic></sub></bold> of [<bold>Θ<sub>xy</sub></bold>] and [<bold>Θ<sub>yz</sub>]<sub><italic>i,j</italic></sub></bold> of [<bold>Θ<sub>yz</sub></bold>], indicates an edge between the <italic>i</italic>th perturbant and the <italic>j</italic>th node in the network.</p>
      <p>This Gaussian chain graph model corresponds to the continuous counterpart of the chain graph model obtained by threading CRFs for discrete random variables [<xref rid="pcbi.1007940.ref050" ref-type="bibr">50</xref>]. CRFs and the chain graph models built from CRFs have been hugely popular in other application areas of statistical machine learning such as text modeling and image analysis for modeling multiple correlated output features influenced by input features [<xref rid="pcbi.1007940.ref026" ref-type="bibr">26</xref>, <xref rid="pcbi.1007940.ref050" ref-type="bibr">50</xref>, <xref rid="pcbi.1007940.ref053" ref-type="bibr">53</xref>]. Here, we explore the use of a chain graph model constructed with sCGGMs. We develop an efficient learning algorithm that runs on human data within a few hours and a set of inference algorithms for dissecting the gene regulatory mechanisms that govern the influence of SNPs on phenotypes.</p>
    </sec>
    <sec id="sec015">
      <title>PerturbNet inference methods</title>
      <p>The probabilistic graphical model for PerturbNet naturally leads to a set of inference methods for revealing dependencies that are not explicitly represented as edges in the model. In general, inference methods in probabilistic graphical models are computationally expensive [<xref rid="pcbi.1007940.ref026" ref-type="bibr">26</xref>]. However, because the PerturbNet model is built upon sCGGMs, a form of Gaussian distributions, it is possible to obtain efficient inference methods that involve simple matrix operations. Below, we describe two inference methods that PerturbNet inherits from sCGGM and introduce three inference methods for the Gaussian chain graph model of PerturbNet.</p>
      <p>PerturbNet inherits the following two inference methods directly from the inference method for an sCGGM [<xref rid="pcbi.1007940.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1007940.ref005" ref-type="bibr">5</xref>]. They are used to infer the indirect perturbation effects that arise from the direct perturbation effects propagating to other parts of the network.</p>
      <list list-type="bullet">
        <list-item>
          <p><bold>Indirect SNP perturbation effects on gene expression levels:</bold><inline-formula id="pcbi.1007940.e008"><alternatives><graphic xlink:href="pcbi.1007940.e008.jpg" id="pcbi.1007940.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where [<bold>B</bold><sub><bold>xy</bold></sub>]<sub><italic>k</italic>,<italic>i</italic></sub> represents the indirect perturbation effect of SNP <italic>k</italic> on the expression level of gene <italic>i</italic> (<xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1B</xref>, blue dashed arrow). This can be seen by re-writing the sCGGM component <italic>p</italic>(<bold>y</bold>|<bold>x</bold>) of the PerturbNet model as follows:
<disp-formula id="pcbi.1007940.e009"><alternatives><graphic xlink:href="pcbi.1007940.e009.jpg" id="pcbi.1007940.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
from which the marginal distribution for the expression level [<bold>y</bold>]<sub><italic>i</italic></sub> of gene <italic>i</italic> can be obtained as <inline-formula id="pcbi.1007940.e010"><alternatives><graphic xlink:href="pcbi.1007940.e010.jpg" id="pcbi.1007940.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where [<bold>B</bold><sub><bold>xy</bold></sub>]<sub>:,<italic>i</italic></sub> represents the <italic>i</italic>th column of <bold>B</bold><sub><bold>xy</bold></sub>. While <inline-formula id="pcbi.1007940.e011"><alternatives><graphic xlink:href="pcbi.1007940.e011.jpg" id="pcbi.1007940.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> models the direct perturbation effect of SNP <italic>k</italic> on the expression of gene <italic>i</italic>, [<bold>B</bold><sub><bold>xy</bold></sub>]<sub><italic>k</italic>,<italic>i</italic></sub> corresponds to the overall perturbation effect that aggregates all indirect influence of SNP <italic>k</italic> on gene <italic>i</italic> through other genes. When SNP <italic>k</italic> does not influence the expression of gene <italic>i</italic> directly but exerts influence on gene <italic>i</italic> through other genes connected to gene <italic>i</italic> in the network <bold>Λ</bold><sub><bold>y</bold></sub>, we have <inline-formula id="pcbi.1007940.e012"><alternatives><graphic xlink:href="pcbi.1007940.e012.jpg" id="pcbi.1007940.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> but [<bold>B</bold><sub><bold>xy</bold></sub>]<sub><italic>k</italic>,<italic>i</italic></sub> ≠ 0.</p>
        </list-item>
        <list-item>
          <p><bold>Indirect effects of gene expression levels on clinical phenotypes:</bold><inline-formula id="pcbi.1007940.e013"><alternatives><graphic xlink:href="pcbi.1007940.e013.jpg" id="pcbi.1007940.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, where [<bold>B</bold><sub><bold>yz</bold></sub>]<sub><italic>k</italic>,<italic>i</italic></sub> represents the indirect influence of the expression level of gene <italic>k</italic> on phenotype <italic>i</italic> (<xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1B</xref>, green dashed arrow). Similarly as above, this can be seen by deriving the marginal distribution from the sCGGM component <italic>p</italic>(<bold>z</bold>|<bold>y</bold>) of the PerturbNet model as follows:
<disp-formula id="pcbi.1007940.e014"><alternatives><graphic xlink:href="pcbi.1007940.e014.jpg" id="pcbi.1007940.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
          <p>Then, the marginal distribution for [<bold>z</bold>]<sub><italic>i</italic></sub> of phenotype <italic>i</italic> can be obtained as <italic>p</italic>([<bold>z</bold>]<sub><italic>i</italic></sub>|<bold>y</bold>) <inline-formula id="pcbi.1007940.e015"><alternatives><graphic xlink:href="pcbi.1007940.e015.jpg" id="pcbi.1007940.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        </list-item>
      </list>
      <p>PerturbNet builds upon the sCGGM inference methods above and provides the following three inference methods on the sparse Gaussian chain graph model for characterizing the role of the gene network as a mediator of SNP effects on clinical traits.</p>
      <list list-type="bullet">
        <list-item>
          <p><bold>INF-I for inferring SNP effects on clinical phenotypes mediated by gene network:</bold> INF-I computes <bold>B</bold><sub><bold>xz</bold></sub> = <bold>B</bold><sub><bold>xy</bold></sub>
<bold>B</bold><sub><bold>yz</bold></sub>, where [<bold>B</bold><sub><bold>xz</bold></sub>]<sub><italic>k</italic>,<italic>i</italic></sub> represents the overall influence of SNP <italic>k</italic> on phenotype <italic>i</italic> mediated by gene network <bold>Λ</bold><sub><bold>y</bold></sub> (<xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1B</xref>, gray and tan dashed arrows). Such SNP effects on phenotypes are not directly modeled in the PerturbNet model but can be inferred by deriving the marginal distribution <italic>p</italic>(<bold>z</bold>|<bold>x</bold>) as follows:
<disp-formula id="pcbi.1007940.e016"><alternatives><graphic xlink:href="pcbi.1007940.e016.jpg" id="pcbi.1007940.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="-0.166667em"/><mml:mo>+</mml:mo><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula></p>
          <p>From this, the marginal distribution of [<bold>z</bold>]<sub><italic>i</italic></sub> for phenotype <italic>i</italic> given <bold>x</bold> can be obtained as <inline-formula id="pcbi.1007940.e017"><alternatives><graphic xlink:href="pcbi.1007940.e017.jpg" id="pcbi.1007940.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xz</mml:mtext></mml:mstyle></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. <xref ref-type="disp-formula" rid="pcbi.1007940.e016">Eq (5)</xref> can also be obtained from the marginalization of <bold>y</bold> in the joint distribution <italic>p</italic>(<bold>z</bold>, <bold>y</bold>|<bold>x</bold>) derived from <xref ref-type="disp-formula" rid="pcbi.1007940.e003">Eq (1)</xref>:
<disp-formula id="pcbi.1007940.e018"><alternatives><graphic xlink:href="pcbi.1007940.e018.jpg" id="pcbi.1007940.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>zy</mml:mtext></mml:mstyle></mml:msub></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>zy</mml:mtext></mml:mstyle><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>zy</mml:mtext></mml:mstyle></mml:msub></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
where <bold>Θ<sub>zy,x</sub></bold> = (<bold>0</bold><sub><italic>p</italic>×<italic>r</italic></sub>, <bold>Θ<sub>xy</sub></bold>) with <bold>0</bold><sub><italic>p</italic>×<italic>r</italic></sub> for <italic>p</italic> × <italic>r</italic> matrix of 0’s and <inline-formula id="pcbi.1007940.e019"><alternatives><graphic xlink:href="pcbi.1007940.e019.jpg" id="pcbi.1007940.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>z</mml:mi><mml:mi>y</mml:mi></mml:mstyle></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable equalcolumns="true" equalrows="true"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi><mml:mi>z</mml:mi></mml:mstyle></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi><mml:mi>z</mml:mi></mml:mstyle></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi><mml:mi>z</mml:mi></mml:mstyle></mml:mrow></mml:msub><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>z</mml:mi></mml:mstyle></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi><mml:mi>z</mml:mi></mml:mstyle></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> This joint distribution is an alternative representation of the PerturbNet model in <xref ref-type="disp-formula" rid="pcbi.1007940.e003">Eq (1)</xref> and corresponds to another sCGGM over <bold>y</bold> and <bold>z</bold> conditional on <bold>x</bold> with network <bold>Λ<sub>zy</sub></bold> and perturbation <bold>Θ</bold><sub><bold>zy</bold>,<bold>x</bold></sub>.</p>
        </list-item>
        <list-item>
          <p><bold>INF-II for inferring SNP effects on clinical phenotypes mediated by a gene module:</bold> Let <italic>M</italic><sub>1</sub>, …, <italic>M</italic><sub><italic>s</italic></sub> be disjoint subsets of <italic>q</italic> genes, where ∪<sub><italic>m</italic>=1,…, <italic>s</italic></sub>
<italic>M</italic><sub><italic>m</italic></sub> is the full set of <italic>q</italic> genes (<xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1B</xref>, gray and tan gene modules). Then, the overall SNP effects on phenotypes in <bold>B</bold><sub><bold>xz</bold></sub> can be decomposed into SNP effects on phenotypes mediated by each gene module <inline-formula id="pcbi.1007940.e020"><alternatives><graphic xlink:href="pcbi.1007940.e020.jpg" id="pcbi.1007940.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xz</mml:mtext></mml:mstyle><mml:msub><mml:mi>M</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:msubsup></mml:math></alternatives></inline-formula> as follows:
<disp-formula id="pcbi.1007940.e021"><alternatives><graphic xlink:href="pcbi.1007940.e021.jpg" id="pcbi.1007940.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xz</mml:mtext></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:munderover><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xz</mml:mtext></mml:mstyle><mml:msub><mml:mi>M</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where
<disp-formula id="pcbi.1007940.e022"><alternatives><graphic xlink:href="pcbi.1007940.e022.jpg" id="pcbi.1007940.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xz</mml:mtext></mml:mstyle><mml:msub><mml:mi>M</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
          <p>In this decomposition, <inline-formula id="pcbi.1007940.e023"><alternatives><graphic xlink:href="pcbi.1007940.e023.jpg" id="pcbi.1007940.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xz</mml:mtext></mml:mstyle><mml:msub><mml:mi>M</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> quantifies the effect of SNP <italic>k</italic> on phenotype <italic>i</italic> through the expression levels of genes in module <italic>M</italic><sub><italic>m</italic></sub>. If the module size is 1, <inline-formula id="pcbi.1007940.e024"><alternatives><graphic xlink:href="pcbi.1007940.e024.jpg" id="pcbi.1007940.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xz</mml:mtext></mml:mstyle><mml:msub><mml:mi>M</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> corresponds to the SNP effect on the phenotype mediated by the single gene in the module.</p>
        </list-item>
        <list-item>
          <p><bold>INF-III for inferring posterior gene network after seeing phenotype data:</bold> INF-III computes <inline-formula id="pcbi.1007940.e025"><alternatives><graphic xlink:href="pcbi.1007940.e025.jpg" id="pcbi.1007940.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for gene network <bold>Λ</bold><sub><bold>y</bold></sub> augmented with the component <inline-formula id="pcbi.1007940.e026"><alternatives><graphic xlink:href="pcbi.1007940.e026.jpg" id="pcbi.1007940.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1007940.g001">Fig 1B</xref>, blue dashed edge). In this augmented network, additional edges are introduced between two genes if their expression levels influence the same trait or if they both affect traits that are connected in the phenotype network <bold>Λ</bold><sub><bold>z</bold></sub>. The posterior gene network <bold>Λ</bold><sub><bold>y</bold>|<bold>x</bold>, <bold>z</bold></sub> can be obtained by inferring the posterior distribution of expression levels given phenotypes from the estimated PerturbNet model:
<disp-formula id="pcbi.1007940.e027"><alternatives><graphic xlink:href="pcbi.1007940.e027.jpg" id="pcbi.1007940.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mi mathvariant="bold">z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mspace width="0.166667em"/><mml:msup><mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
          <p>This can also be seen from the alternative representation of the estimated model given as the joint distribution in <xref ref-type="disp-formula" rid="pcbi.1007940.e018">Eq (6)</xref>, in which <bold>Λ</bold><sub><bold>y</bold>|<bold>x</bold>,<bold>z</bold></sub> defines the network over <bold>y</bold> in the full network <bold>Λ</bold><sub><bold>zy</bold></sub>. This process of introducing additional dependencies via <inline-formula id="pcbi.1007940.e028"><alternatives><graphic xlink:href="pcbi.1007940.e028.jpg" id="pcbi.1007940.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in this sCGGM for joint distribution is known as moralization in the probabilistic graphical model literature [<xref rid="pcbi.1007940.ref026" ref-type="bibr">26</xref>].</p>
        </list-item>
      </list>
    </sec>
    <sec id="sec016">
      <title>SNP perturbation effects on gene modules and trait groups</title>
      <p>We summarize the estimated and inferred SNP perturbation effects at the module level and at the trait-group level, using a score function <italic>S</italic>([<bold>A</bold>]<sub><italic>I</italic>,<italic>J</italic></sub>) = ∑<sub><italic>i</italic>∈<italic>I</italic>,<italic>j</italic>∈<italic>J</italic></sub>|[<bold>A</bold>]<sub><italic>i</italic>,<italic>j</italic></sub>| for perturbation effects <bold>A</bold> of <italic>R</italic> × <italic>C</italic> matrix and for subsets of rows <italic>I</italic> ⊂ {1, …, <italic>R</italic>} and columns <italic>J</italic> ⊂ {1, …, <italic>C</italic>}, as follows:</p>
      <list list-type="bullet">
        <list-item>
          <p><bold>The effects of SNP <italic>i</italic> on gene module <italic>M</italic>:</bold><italic>S</italic>([<bold>Θ</bold><sub><bold>xy</bold></sub>]<sub><italic>i</italic>,<italic>M</italic></sub>) for direct effects and <italic>S</italic>([<bold>B</bold><sub><bold>xy</bold></sub>]<sub><italic>i</italic>,<italic>M</italic></sub>) for indirect effects. Similarly, we summarize the overall SNP effects on gene module <italic>M</italic> as <italic>S</italic>([<bold>Θ</bold><sub><bold>xy</bold></sub>]<sub>:,<italic>M</italic></sub>) for direct effects and <italic>S</italic>([<bold>B</bold><sub><bold>xy</bold></sub>]<sub>:,<italic>M</italic></sub>) for indirect effects.</p>
        </list-item>
        <list-item>
          <p><bold>The effects of gene module <italic>M</italic> on trait group <italic>T</italic>:</bold><italic>S</italic>([<bold>Θ</bold><sub><bold>yz</bold></sub>]<sub><italic>M</italic>,<italic>T</italic></sub>) for direct effects and <italic>S</italic>([<bold>B</bold><sub><bold>y</bold><bold>z</bold></sub>]<sub><italic>M</italic>,<italic>T</italic></sub>) for indirect effects.</p>
        </list-item>
        <list-item>
          <p><bold>The effects of SNP <italic>i</italic> on trait group <italic>T</italic>:</bold><italic>S</italic>([<bold>B</bold><sub><bold>xz</bold></sub>]<sub><italic>i</italic>,<italic>T</italic></sub>). Similarly, we use <italic>S</italic>([<bold>B</bold><sub><bold>xz</bold></sub>]<sub>:,<italic>T</italic></sub>) to represent overall effects of SNPs on trait group <italic>T</italic>.</p>
        </list-item>
        <list-item>
          <p><bold>The effects of SNP <italic>i</italic> on trait group <italic>T</italic> mediated by module <italic>M</italic>:</bold><inline-formula id="pcbi.1007940.e029"><alternatives><graphic xlink:href="pcbi.1007940.e029.jpg" id="pcbi.1007940.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mrow><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xz</mml:mtext></mml:mstyle><mml:mi>M</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Overall SNP effects on trait group <italic>T</italic> mediated by module <italic>M</italic> is obtained as <inline-formula id="pcbi.1007940.e030"><alternatives><graphic xlink:href="pcbi.1007940.e030.jpg" id="pcbi.1007940.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:mrow><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mi mathvariant="bold">B</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xz</mml:mtext></mml:mstyle><mml:mi>M</mml:mi></mml:msubsup><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
        </list-item>
      </list>
    </sec>
    <sec id="sec017">
      <title>PerturbNet learning algorithms</title>
      <p>We introduce an efficient algorithm for obtaining a sparse estimate of the PerturbNet model parameters with few edges in the graph. Given genotype data <inline-formula id="pcbi.1007940.e031"><alternatives><graphic xlink:href="pcbi.1007940.e031.jpg" id="pcbi.1007940.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> for <italic>n</italic> samples and <italic>p</italic> SNPs, expression data <inline-formula id="pcbi.1007940.e032"><alternatives><graphic xlink:href="pcbi.1007940.e032.jpg" id="pcbi.1007940.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> for <italic>q</italic> genes, and phenotype data <inline-formula id="pcbi.1007940.e033"><alternatives><graphic xlink:href="pcbi.1007940.e033.jpg" id="pcbi.1007940.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:mrow><mml:mi mathvariant="bold">Z</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> for <italic>r</italic> phenotypes, we estimate a sparse Gaussian chain graph model in <xref ref-type="disp-formula" rid="pcbi.1007940.e003">Eq (1)</xref> by minimizing the negative log-likelihood of data along with sparsity-inducing <italic>L</italic><sub>1</sub> penalty:
<disp-formula id="pcbi.1007940.e034"><alternatives><graphic xlink:href="pcbi.1007940.e034.jpg" id="pcbi.1007940.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mo>≻</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:mo>≻</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub></mml:mrow></mml:munder><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
where
<disp-formula id="pcbi.1007940.e035"><alternatives><graphic xlink:href="pcbi.1007940.e035.jpg" id="pcbi.1007940.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo><mml:mspace width="-0.166667em"/><mml:mo>-</mml:mo><mml:mspace width="-0.166667em"/><mml:mo form="prefix">log</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mspace width="-0.166667em"/><mml:mo>+</mml:mo><mml:mspace width="-0.166667em"/><mml:mo form="prefix">tr</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>yy</mml:mtext></mml:mstyle></mml:msub><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mspace width="-0.166667em"/><mml:mo>+</mml:mo><mml:mspace width="-0.166667em"/><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xx</mml:mtext></mml:mstyle></mml:msub><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub></mml:msub><mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>∥</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8a)</label></disp-formula>
<disp-formula id="pcbi.1007940.e036"><alternatives><graphic xlink:href="pcbi.1007940.e036.jpg" id="pcbi.1007940.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo><mml:mspace width="-0.166667em"/><mml:mo>-</mml:mo><mml:mspace width="-0.166667em"/><mml:mo form="prefix">log</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mspace width="-0.166667em"/><mml:mo>+</mml:mo><mml:mspace width="-0.166667em"/><mml:mo form="prefix">tr</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>zz</mml:mtext></mml:mstyle></mml:msub><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:mspace width="-0.166667em"/><mml:mo>+</mml:mo><mml:mspace width="-0.166667em"/><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>yy</mml:mtext></mml:mstyle></mml:msub><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub></mml:msub><mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mo>∥</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8b)</label></disp-formula>
given data covariance matrices <inline-formula id="pcbi.1007940.e037"><alternatives><graphic xlink:href="pcbi.1007940.e037.jpg" id="pcbi.1007940.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:mrow><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xx</mml:mtext></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1007940.e038"><alternatives><graphic xlink:href="pcbi.1007940.e038.jpg" id="pcbi.1007940.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mrow><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1007940.e039"><alternatives><graphic xlink:href="pcbi.1007940.e039.jpg" id="pcbi.1007940.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:mrow><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>yy</mml:mtext></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1007940.e040"><alternatives><graphic xlink:href="pcbi.1007940.e040.jpg" id="pcbi.1007940.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:mrow><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">Z</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1007940.e041"><alternatives><graphic xlink:href="pcbi.1007940.e041.jpg" id="pcbi.1007940.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:mrow><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>zz</mml:mtext></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">Z</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">Z</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> for mean-centered data matrices <inline-formula id="pcbi.1007940.e042"><alternatives><graphic xlink:href="pcbi.1007940.e042.jpg" id="pcbi.1007940.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:mover accent="true"><mml:mi mathvariant="bold">X</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1007940.e043"><alternatives><graphic xlink:href="pcbi.1007940.e043.jpg" id="pcbi.1007940.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:mover accent="true"><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1007940.e044"><alternatives><graphic xlink:href="pcbi.1007940.e044.jpg" id="pcbi.1007940.e044g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M44"><mml:mover accent="true"><mml:mi mathvariant="bold">Z</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and ‖⋅‖<sub>1</sub> for non-smooth elementwise <italic>L</italic><sub>1</sub> penalty. The regularization parameters <inline-formula id="pcbi.1007940.e045"><alternatives><graphic xlink:href="pcbi.1007940.e045.jpg" id="pcbi.1007940.e045g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M45"><mml:mrow><mml:msub><mml:mo>λ</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> are chosen to maximize the Bayesian information criterion (BIC). We do not penalize the diagonal entries of <bold>Λ</bold><sub><bold>y</bold></sub> and <bold>Λ</bold><sub><bold>z</bold></sub>, following the common practice for sparse inverse covariance estimation. Solving <xref ref-type="disp-formula" rid="pcbi.1007940.e034">Eq (7)</xref> is a convex optimization problem with a guarantee in finding the optimal solution.</p>
      <p>To solve the PerturbNet estimation problem in <xref ref-type="disp-formula" rid="pcbi.1007940.e034">Eq (7)</xref>, we introduce Fast-sCGGM and Mega-sCGGM for an efficient sCGGM estimation to be used as a key subroutine. The problem in <xref ref-type="disp-formula" rid="pcbi.1007940.e034">Eq (7)</xref> decouples into two subproblems, each containing one of two disjoint sets of parameters {<bold>Λ<sub>y</sub></bold>, <bold>Θ<sub>xy</sub></bold>} and {<bold>Λ<sub>z</sub></bold>, <bold>Θ<sub>yz</sub></bold>}, each of which can be solved with an sCGGM optimization algorithm. Below, we introduce Fast-sCGGM for learning an sCGGM that substantially reduces computation time, compared to the previous state-of-the-art method NCD [<xref rid="pcbi.1007940.ref025" ref-type="bibr">25</xref>]. Then, we describe Mega-sCGGM, a modification of Fast-sCGGM, that performs block-wise computation to learn from a large dataset on a machine with limited memory. Empirically Fast-sCGGM and Meta-sCGGM led to orders-of-magnitude speedup compared to the existing state-of-the-art method.</p>
      <sec id="sec018">
        <title>Fast-sCGGM for improving computation time</title>
        <p>We discuss Fast-sCGGM for solving the sCGGM optimization problem in <xref ref-type="disp-formula" rid="pcbi.1007940.e035">Eq (8a)</xref>. The same approach can be used to solve <xref ref-type="disp-formula" rid="pcbi.1007940.e036">Eq (8b)</xref>. We drop the subscripts and use <bold>Θ</bold> for <bold>Θ</bold><sub>xy</sub> and <bold>Λ</bold> for <bold>Λ</bold><sub><bold>y</bold></sub> to simplify the notation. We re-write the problem in <xref ref-type="disp-formula" rid="pcbi.1007940.e035">Eq (8a)</xref> as
<disp-formula id="pcbi.1007940.e046"><alternatives><graphic xlink:href="pcbi.1007940.e046.jpg" id="pcbi.1007940.e046g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:munder><mml:mo form="prefix" movablelimits="true">min</mml:mo><mml:mrow><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>≻</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo></mml:mrow></mml:munder></mml:mtd><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>h</mml:mi><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
where <inline-formula id="pcbi.1007940.e047"><alternatives><graphic xlink:href="pcbi.1007940.e047.jpg" id="pcbi.1007940.e047g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M47"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo><mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="-0.166667em"/><mml:mo form="prefix">log</mml:mo><mml:mo>|</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>|</mml:mo><mml:mspace width="-0.166667em"/></mml:mrow><mml:mo>+</mml:mo><mml:mspace width="-0.166667em"/><mml:mo form="prefix">tr</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>yy</mml:mtext></mml:mstyle></mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mspace width="-0.166667em"/><mml:mo>+</mml:mo><mml:mspace width="-0.166667em"/><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mspace width="-0.166667em"/><mml:mo>+</mml:mo><mml:mspace width="-0.166667em"/><mml:msup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mi mathvariant="bold">S</mml:mi><mml:mstyle mathvariant="bold"><mml:mtext>xx</mml:mtext></mml:mstyle></mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the smooth negative log-likelihood and <italic>h</italic>(<bold>Λ</bold>, <bold>Θ</bold>) = λ<sub><bold>Λ</bold></sub>‖<bold>Λ</bold>‖<sub>1</sub> + λ<sub><bold>Θ</bold></sub>‖<bold>Θ</bold>‖<sub>1</sub> is the non-smooth elementwise <italic>L</italic><sub>1</sub> penalty with regularization parameters λ<sub><bold>Λ</bold></sub> and λ<sub><bold>Θ</bold></sub>.</p>
        <p>Fast-sCGGM uses an alternate Newton coordinate descent method and alternately updates <bold>Λ</bold> and <bold>Θ</bold>, optimizing <xref ref-type="disp-formula" rid="pcbi.1007940.e046">Eq (9)</xref> over <bold>Λ</bold> given <bold>Θ</bold> and vice versa until convergence. Our approach is based on the key observation that with <bold>Λ</bold> fixed, the problem of solving <xref ref-type="disp-formula" rid="pcbi.1007940.e046">Eq (9)</xref> over <bold>Θ</bold> becomes simply the well-known Lasso optimization, which can be solved efficiently using a coordinate descent method [<xref rid="pcbi.1007940.ref032" ref-type="bibr">32</xref>]. On the other hand, optimizing <xref ref-type="disp-formula" rid="pcbi.1007940.e046">Eq (9)</xref> for <bold>Λ</bold> given <bold>Θ</bold> requires forming a quadratic approximation to find a generalized Newton direction and performing line search to find a step size. However, this computation is significantly simpler than performing the same type of computation on both <bold>Λ</bold> and <bold>Θ</bold> jointly as in the previous approach NCD [<xref rid="pcbi.1007940.ref025" ref-type="bibr">25</xref>]. Our algorithm iterates between the following two steps until convergence:</p>
        <list list-type="bullet">
          <list-item>
            <p><bold>Coordinate descent optimization for Θ given Λ:</bold> With <bold>Λ</bold> fixed, the optimization problem in <xref ref-type="disp-formula" rid="pcbi.1007940.e046">Eq (9)</xref> becomes
<disp-formula id="pcbi.1007940.e048"><alternatives><graphic xlink:href="pcbi.1007940.e048.jpg" id="pcbi.1007940.e048g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M48"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo form="prefix">argmin</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo></mml:munder><mml:mspace width="4pt"/><mml:msub><mml:mi>g</mml:mi><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo></mml:msub><mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>∥</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula>
where <italic>g</italic><sub>Λ</sub>(<bold>Θ</bold>) = tr(2<bold>S<sub>xy</sub></bold><italic><sup>T</sup></italic><bold>Θ</bold> + <bold>Λ<sup>−1</sup>Θ</bold><italic><sup>T</sup></italic><bold>S<sub>xx</sub>Θ</bold>). Since <italic>g</italic><sub><bold>Λ</bold></sub>(<bold>Θ</bold>) is a quadratic function, <xref ref-type="disp-formula" rid="pcbi.1007940.e048">Eq (10)</xref> corresponds to the Lasso problem and the coordinate descent method can be used to solve this efficiently.</p>
          </list-item>
          <list-item>
            <p><bold>Coordinate descent optimization for Λ given Θ:</bold> With <bold>Θ</bold> fixed, the problem in <xref ref-type="disp-formula" rid="pcbi.1007940.e046">Eq (9)</xref> becomes
<disp-formula id="pcbi.1007940.e049"><alternatives><graphic xlink:href="pcbi.1007940.e049.jpg" id="pcbi.1007940.e049g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M49"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo form="prefix">argmin</mml:mo><mml:mrow><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>≻</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mi>g</mml:mi><mml:mo mathvariant="bold">Θ</mml:mo></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>∥</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula>
where <italic>g</italic><sub><bold>Θ</bold></sub>(<bold>Λ</bold>) = −log |<bold>Λ</bold>| + tr(<bold>S</bold><sub><bold>yy</bold></sub>
<bold>Λ</bold> + <bold>Λ</bold><sup>−1</sup>
<bold>Θ</bold><sup><italic>T</italic></sup>
<bold>S</bold><sub><bold>xx</bold></sub>
<bold>Θ</bold>). To solve this, we first find a generalized Newton direction that minimizes the <italic>L</italic><sub>1</sub>-regularized quadratic approximation <inline-formula id="pcbi.1007940.e050"><alternatives><graphic xlink:href="pcbi.1007940.e050.jpg" id="pcbi.1007940.e050g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M50"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of <italic>g</italic><sub><bold>Θ</bold></sub>(<bold>Λ</bold>):
<disp-formula id="pcbi.1007940.e051"><alternatives><graphic xlink:href="pcbi.1007940.e051.jpg" id="pcbi.1007940.e051g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">D</mml:mi><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo form="prefix">argmin</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub></mml:munder><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:msub><mml:mrow><mml:mo>∥</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mo>∥</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula>
where <inline-formula id="pcbi.1007940.e052"><alternatives><graphic xlink:href="pcbi.1007940.e052.jpg" id="pcbi.1007940.e052g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M52"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is obtained from a second-order Taylor expansion and is given as
<disp-formula id="pcbi.1007940.e053"><alternatives><graphic xlink:href="pcbi.1007940.e053.jpg" id="pcbi.1007940.e053g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo form="prefix">vec</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo form="prefix">vec</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo form="prefix">vec</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msubsup><mml:mo>∇</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo form="prefix">vec</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
            <p>In the above equation, ∇<sub><bold>Λ</bold></sub>
<italic>g</italic>(<bold>Λ</bold>, <bold>Θ</bold>) = <bold>S</bold><sub><bold>yy</bold></sub> − <bold>Σ</bold> − <bold>Ψ</bold> and <inline-formula id="pcbi.1007940.e054"><alternatives><graphic xlink:href="pcbi.1007940.e054.jpg" id="pcbi.1007940.e054g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M54"><mml:mrow><mml:msubsup><mml:mo>∇</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>Σ</mml:mo><mml:mo>⊗</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mo>Σ</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>Ψ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <bold>Σ</bold> = <bold>Λ</bold><sup>−1</sup> and <bold>Ψ</bold> = <bold>ΣΘ</bold><sup><italic>T</italic></sup>
<bold>S</bold><sub><bold>xx</bold></sub><bold>ΘΣ</bold>, are the components of the gradient and Hessian matrices corresponding to <bold>Λ</bold>. The problem in <xref ref-type="disp-formula" rid="pcbi.1007940.e051">Eq (12)</xref> is again equivalent to the Lasso problem, which can be solved efficiently via coordinate descent. Given the Newton direction for <bold>Λ</bold>, we update <bold>Λ</bold> ← <bold>Λ</bold>+ <italic>α</italic>
<bold>D</bold><sub><bold>Λ</bold></sub>, where step size 0 &lt; <italic>α</italic> ≤ 1 is set by line search on the objective in <xref ref-type="disp-formula" rid="pcbi.1007940.e049">Eq (11)</xref> to ensure sufficient decrease in <xref ref-type="disp-formula" rid="pcbi.1007940.e046">Eq (9)</xref> and positive definiteness of <bold>Λ</bold>.</p>
          </list-item>
        </list>
        <p>In order to further reduce computation time, we adopt the following strategies that have been previously used for sparse GGM and sCGGM optimizations [<xref rid="pcbi.1007940.ref025" ref-type="bibr">25</xref>, <xref rid="pcbi.1007940.ref054" ref-type="bibr">54</xref>]. First, to improve the efficiency of coordinate descent for the Lasso problem in Eqs (<xref ref-type="disp-formula" rid="pcbi.1007940.e048">10</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1007940.e051">12</xref>), we restrict the updates to an active set of variables given as
<disp-formula id="pcbi.1007940.e055"><alternatives><graphic xlink:href="pcbi.1007940.e055.jpg" id="pcbi.1007940.e055g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mspace width="4pt"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mspace width="1em"/><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mo>∨</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mo mathvariant="bold">Θ</mml:mo></mml:msub><mml:mspace width="4pt"/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mspace width="1em"/><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mo>Δ</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mo>∇</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo></mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo mathvariant="bold">Λ</mml:mo><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:msub><mml:mo>λ</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo></mml:msub><mml:mo>∨</mml:mo><mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Because the active set sizes <inline-formula id="pcbi.1007940.e056"><alternatives><graphic xlink:href="pcbi.1007940.e056.jpg" id="pcbi.1007940.e056g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mo mathvariant="bold">Λ</mml:mo></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mo mathvariant="bold">Θ</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mo mathvariant="bold">Θ</mml:mo></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> approach the number of non-zero entries in the sparse solutions for <bold>Λ</bold> and <bold>Θ</bold> over iterations, this strategy yields a substantial speedup. Second, to further improve the efficiency of coordinate descent, we store intermediate results for the large matrix products that need to be computed repeatedly. We compute and store <bold>U</bold> ≔ Δ<sub><bold>Λ</bold></sub><bold>Σ</bold> and <bold>V</bold> ≔ Δ<sub><bold>Θ</bold></sub><bold>Σ</bold> at the beginning of the optimization. Then, after a coordinate descent update to [Δ<sub><bold>Λ</bold></sub>]<sub><italic>i</italic>,<italic>j</italic></sub>, rows <italic>i</italic> and <italic>j</italic> of <bold>U</bold> are updated. Similarly, after an update to [Δ<sub><bold>Θ</bold></sub>]<sub><italic>i</italic>,<italic>j</italic></sub>, row <italic>i</italic> of <bold>V</bold> is updated. Finally, in each iteration, we warm-start <bold>Λ</bold> and <bold>Θ</bold> from the results of the previous iteration and make a single pass over the active set. This ensures decrease in the objective in <xref ref-type="disp-formula" rid="pcbi.1007940.e046">Eq (9)</xref>, while reducing the overall computation time in practice. The pseudocode for Fast-sCGGM is provided in <xref ref-type="supplementary-material" rid="pcbi.1007940.s002">S2 Text</xref>.</p>
      </sec>
      <sec id="sec019">
        <title>Mega-sCGGM for removing memory constraint</title>
        <p>Fast-sCGGM as described above is still limited by the space required to store large matrices during coordinate descent computation. Solving <xref ref-type="disp-formula" rid="pcbi.1007940.e051">Eq (12)</xref> for updating <bold>Λ</bold> requires precomputing and storing <italic>q</italic> × <italic>q</italic> matrices, <bold>Σ</bold> and <bold>Ψ</bold> = <bold>ΣΘ</bold><sup><italic>T</italic></sup><bold>S</bold><sub><bold>xx</bold></sub><bold>ΘΣ</bold>, and solving <xref ref-type="disp-formula" rid="pcbi.1007940.e048">Eq (10)</xref> for updating <bold>Θ</bold> requires <bold>Σ</bold> and a <italic>p</italic> × <italic>p</italic> matrix <bold>S</bold><sub><bold>xx</bold></sub>. A naive approach to reduce the memory footprint would be to recompute portions of these matrices on demand for each coordinate update, which would be very expensive.</p>
        <p>Here, we describe Mega-sCGGM that combines the alternating Newton coordinate descent algorithm in Fast-sCGGM with block coordinate descent to scale up the optimization to very large problems on a machine with limited memory. During coordinate descent optimization, Mega-sCGGM updates blocks of <bold>Λ</bold> and <bold>Θ</bold> so that within each block, the computation of the large matrices can be cached and re-used. These blocks are determined automatically by exploiting the sparse stucture. For <bold>Λ</bold>, we extend the block coordinate descent approach in BIG&amp;QUIC [<xref rid="pcbi.1007940.ref031" ref-type="bibr">31</xref>] developed for sparse GGMs to take into account the conditioning variables in sCGGMs. For <bold>Θ</bold>, we describe a new approach for block coordinate descent update. The block-wise update in Mega-sCGGM is described in detail in <xref ref-type="supplementary-material" rid="pcbi.1007940.s002">S2 Text</xref> and illustrated in <xref ref-type="supplementary-material" rid="pcbi.1007940.s010">S8 Fig</xref>. Our algorithm can, in principle, be applied to problems of any size on a machine with limited memory.</p>
        <p>The previous method NCD, Fast-sCGGM, and Mega-sCGGM solve the same optimization problem and produce nearly identical estimate. However, Fast-sCGGM reaches this estimate more efficiently than the NCD and Mega-sCGGM finds the estimate without running out of memory.</p>
      </sec>
      <sec id="sec020">
        <title>Parallelization in Fast-sCGGM and Mega-sCGGM</title>
        <p>We parallelize some of the expensive computations in Fast-sCGGM and Mega-sCGGM on multi-core machines. For both methods, we parallelize all matrix-matrix and matrix-vector multiplications. In addition, we parallelize the computation of columns of <bold>Σ</bold> and <bold>Ψ</bold> in Fast-sCGGM and the same computation within each block in Mega-sCGGM. In Mega-sCGGM, we parallelize the computation of each row of <bold>S</bold><sub><bold>xx</bold></sub> whenever it is recomputed.</p>
      </sec>
      <sec id="sec021">
        <title>Semi-supervised learning</title>
        <p>We introduce a modification of our learning algorithm for semi-supervised learning, to handle the situation where expression data are available only for a subset of individuals because of the difficulty of obtaining tissue samples. Our strategy is to use an EM algorithm [<xref rid="pcbi.1007940.ref055" ref-type="bibr">55</xref>] that imputes the missing expression levels in the E-step and performs our Fast-sCGGM or Mega-sCGGM optimization in the M-step. Given a dataset <inline-formula id="pcbi.1007940.e057"><alternatives><graphic xlink:href="pcbi.1007940.e057.jpg" id="pcbi.1007940.e057g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M57"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1007940.e058"><alternatives><graphic xlink:href="pcbi.1007940.e058.jpg" id="pcbi.1007940.e058g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M58"><mml:mrow><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for the fully-observed data and <inline-formula id="pcbi.1007940.e059"><alternatives><graphic xlink:href="pcbi.1007940.e059.jpg" id="pcbi.1007940.e059g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M59"><mml:mrow><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for the samples with missing gene-expression levels, our EM algorithm [<xref rid="pcbi.1007940.ref055" ref-type="bibr">55</xref>] maximizes the expected log-likelihood of data:
<disp-formula id="pcbi.1007940.e060"><alternatives><graphic xlink:href="pcbi.1007940.e060.jpg" id="pcbi.1007940.e060g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M60"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mo>[</mml:mo><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
combined with <italic>L</italic><sub>1</sub>-regularization, where <inline-formula id="pcbi.1007940.e061"><alternatives><graphic xlink:href="pcbi.1007940.e061.jpg" id="pcbi.1007940.e061g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M61"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007940.e062"><alternatives><graphic xlink:href="pcbi.1007940.e062.jpg" id="pcbi.1007940.e062g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M62"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mo mathvariant="bold">Θ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are the log-likelihood of data <inline-formula id="pcbi.1007940.e063"><alternatives><graphic xlink:href="pcbi.1007940.e063.jpg" id="pcbi.1007940.e063g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M63"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007940.e064"><alternatives><graphic xlink:href="pcbi.1007940.e064.jpg" id="pcbi.1007940.e064g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M64"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math></alternatives></inline-formula> with respect to the model in <xref ref-type="disp-formula" rid="pcbi.1007940.e003">Eq (1)</xref> and the expectation is taken with respect to:
<disp-formula id="pcbi.1007940.e065"><alternatives><graphic xlink:href="pcbi.1007940.e065.jpg" id="pcbi.1007940.e065g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M65"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>Σ</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mo>Σ</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:mi mathvariant="bold">z</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>xy</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="5.0pt"/><mml:mspace width="4pt"/><mml:mtext>and</mml:mtext><mml:mspace width="4pt"/><mml:mspace width="5.0pt"/><mml:msub><mml:mo>Σ</mml:mo><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(13)</label></disp-formula></p>
        <p>In E-step, a naive inversion of <inline-formula id="pcbi.1007940.e066"><alternatives><graphic xlink:href="pcbi.1007940.e066.jpg" id="pcbi.1007940.e066g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M66"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> to obtain <bold>Σ</bold><sub><bold>y|x</bold>,<bold>z</bold></sub> is expensive and requires a storage for this dense matrix that may exceed computer memory for large gene expression datasets. To make the EM algorithm efficient in terms of both time and memory, we assume that the number of phenotypes <italic>r</italic> is relatively small compared to the number of genes (i.e., <italic>r</italic> ≪ <italic>q</italic>), which is typical for most studies. Then, instead of explicitly performing the E-step, we embed the E-step within the M-step by representing the E-step results implicitly to fit in memory and computing them explicitly on-demand as needed in the M-step. Specifically, we implicitly represent <inline-formula id="pcbi.1007940.e067"><alternatives><graphic xlink:href="pcbi.1007940.e067.jpg" id="pcbi.1007940.e067g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M67"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:msubsup><mml:mo mathvariant="bold">Λ</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> as <bold>Λ</bold><sub><bold>y</bold></sub>+ <bold>KK</bold><sup><italic>T</italic></sup>, using low-rank component <inline-formula id="pcbi.1007940.e068"><alternatives><graphic xlink:href="pcbi.1007940.e068.jpg" id="pcbi.1007940.e068g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M68"><mml:mrow><mml:mi mathvariant="bold">K</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo mathvariant="bold">Θ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>yz</mml:mtext></mml:mstyle></mml:msub><mml:msubsup><mml:mi mathvariant="bold">L</mml:mi><mml:mi mathvariant="bold">z</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and the sparse Cholesky factorization of trait network <inline-formula id="pcbi.1007940.e069"><alternatives><graphic xlink:href="pcbi.1007940.e069.jpg" id="pcbi.1007940.e069g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M69"><mml:mrow><mml:msub><mml:mi mathvariant="bold">L</mml:mi><mml:mi mathvariant="bold">z</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">L</mml:mi><mml:mi mathvariant="bold">z</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mo mathvariant="bold">Λ</mml:mo><mml:mstyle mathvariant="bold"><mml:mtext>zz</mml:mtext></mml:mstyle></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Then, during M-step, we invert <bold>Λ</bold><sub><bold>y</bold></sub>+ <bold>KK</bold><sup><italic>T</italic></sup>, one column at a time as needed, using the conjugate gradient method. This modified EM algorithm produces the same estimate as the original EM algorithm that iterates between an M-step and an E-step.</p>
      </sec>
    </sec>
    <sec id="sec022">
      <title>Simulation experiments</title>
      <sec id="sec023">
        <title>Simulated data</title>
        <p>To assess the accuracy of the computational methods, we generated simulated data from the known ground-truth models and SNPs in the CAMP data. For each type of models, we obtained sensitivities at different FDRs averaged over 10 simulated datasets. To assess accuracy on the recovery of trait-perturbing SNPs and mediator genes, we simulated data from two types of ground-truth models: a two-layer sCGGM as in PerturbNet to mimic the SNP perturbations of clinical traits modulated by gene networks and a two-layer linear regression model to mirror the assumptions of mediator genes acting independently of other genes as in the existing methods. To assess the accuracy of gene network learning, we again simulated data from two types of ground-truth models: a two-layer sCGGM with a gene network perturbed by SNPs and a two-layer GGM [<xref rid="pcbi.1007940.ref056" ref-type="bibr">56</xref>] with no perturbation of networks.</p>
        <p>We set the ground-truth two-layer sCGGM as follows. We assumed gene network <bold>Λ</bold><sub><bold>y</bold></sub> of size <italic>q</italic> = 5, 000 and trait network <bold>Λ</bold><sub><bold>z</bold></sub> of size <italic>r</italic> = 100. In both networks, we assumed 50 nodes in each module, leading to 100 modules in <bold>Λ</bold><sub><bold>y</bold></sub> and two modules in <bold>Λ</bold><sub><bold>z</bold></sub>. Then, the algorithm described in [<xref rid="pcbi.1007940.ref057" ref-type="bibr">57</xref>] was used to generate scale-free networks with average degree 3 and with 90% of the edges within modules and 10% of the edges across modules. Edge weights were randomly generated from normal distribution <inline-formula id="pcbi.1007940.e070"><alternatives><graphic xlink:href="pcbi.1007940.e070.jpg" id="pcbi.1007940.e070g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M70"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The diagonal elements of <bold>Λ</bold><sub><bold>z</bold></sub> and <bold>Λ</bold><sub><bold>y</bold></sub> were set to ensure the minimum eigenvalue of the matrix is 0.3. The perturbation parameters <bold>Θ</bold><sub><bold>yz</bold></sub> and <bold>Θ</bold><sub><bold>xy</bold></sub> were set to represent perturbation of modules. For <bold>Θ</bold><sub><bold>yz</bold></sub>, 10 out of 50 gene modules were set to have no influence on the traits. Each half of the other 40 modules were set to influence primarily each of the two trait modules, 90% of the edges connecting to one trait module and 10% to the other trait module. For <bold>Θ</bold><sub><bold>xy</bold></sub>, 25 gene modules were perturbed by 1,000 randomly-selected SNPs and the other 25 modules were not perturbed by any SNPs. In both perturbation parameters, each expression and clinical trait was perturbed by three perturbants. The magnitudes of perturbations were sampled from normal distribution <inline-formula id="pcbi.1007940.e071"><alternatives><graphic xlink:href="pcbi.1007940.e071.jpg" id="pcbi.1007940.e071g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M71"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, with edge signs randomly assigned with probability 0.5 to positive or negative.</p>
        <p>For simulation from a two-layer linear regression model, the regression parameters were set using the same approach as <bold>Θ</bold><sub><bold>xy</bold></sub> and <bold>Θ</bold><sub><bold>yz</bold></sub> above and the noise variances were set to 0.5. For comparison on the task of gene network recovery, we generated data from a model assuming no SNP perturbations, using a two-layer GGM [<xref rid="pcbi.1007940.ref030" ref-type="bibr">30</xref>] with the same parameters as in the sCGGM network parameters.</p>
      </sec>
      <sec id="sec024">
        <title>Comparison of methods on simulated data</title>
        <p>Using simulated data, we compared the accuracy of PerturbNet, PrediXcan [<xref rid="pcbi.1007940.ref012" ref-type="bibr">12</xref>], eCAVIAR [<xref rid="pcbi.1007940.ref013" ref-type="bibr">13</xref>], and two-layer Lasso (<xref ref-type="supplementary-material" rid="pcbi.1007940.s001">S1 Text</xref>) on the tasks of identifying SNPs perturbing clinical traits and identifying genes mediating these perturbations. PrediXcan tests for an association between a trait and an imputed gene expression value obtained as an elastic-net prediction given SNPs, providing a list of genes mediating overall genetic effects on each trait (<italic>p</italic>-value &lt; 0.01). From these mediator genes for overall SNP effects, we obtained the mediator genes for an individual SNP by further weighting −log(<italic>p</italic>- value) for the given gene/trait pair with the elastic-net regression coefficient for each SNP/gene pair. To obtain SNPs with the strongest effects on each trait, we further aggregated these scores by summing over all genes for each SNP/trait pair. eCAVIAR assigns a colocalization posterior probability (CLPP) score, the posterior probability of a GWAS SNP and an eQTL in the same genomic region of <italic>M</italic> SNPs co-localizing, to each triplet of SNP, gene, and trait, given statistically significant GWAS SNPs and eQTLs (FDR <italic>q</italic> &lt; 10<sup>−3</sup>). To find SNPs with the strongest effects on traits, we collapsed the CLPP scores for triplets into scores for SNP/trait pairs by taking the maximum CLPP score across all genes for each SNP/trait pair. Then, we identified the corresponding gene as the strongest mediating gene for each SNP/trait pair. To identify genes that are the strongest mediators of overall SNP effects on a trait, we collapsed the CLPP scores for triplets into scores for gene/trait pairs by summing CLPP scores over all SNPs for the given/trait pair and selected the highest-scoring gene. For PerturbNet and two-layer Lasso, we selected the regularization parameters that maximize the BIC.</p>
      </sec>
    </sec>
    <sec id="sec025">
      <title>Analysis of CAMP asthma data</title>
      <sec id="sec026">
        <title>Asthma dataset</title>
        <p>We preprocessed the genotype, gene expression, and clinical phenotype data, collected from asthma patients participating in the CAMP study [<xref rid="pcbi.1007940.ref027" ref-type="bibr">27</xref>–<xref rid="pcbi.1007940.ref029" ref-type="bibr">29</xref>] for our analysis. We used 174 non-Hispanic Caucasian subjects for whom both genotype and clinical phenotype data were available. For a subset of 140 individuals, gene expression data from primary peripheral blood CD4+ lymphocytes were also available. After removing SNPs with minor allele frequency less than 0.1 and those with missing reference SNP ids, we obtained 495,597 SNPs for autosomal chromosomes. Given expression levels for 22,184 mRNA transcripts profiled with Illumina HumanRef8 v2 BeadChip arrays [<xref rid="pcbi.1007940.ref029" ref-type="bibr">29</xref>], we removed transcript levels with expression variance less than 0.01, which resulted in the 11,598 transcript levels to be used in our analysis. Then, we converted the expression values to their <italic>z</italic>-scores. The clinical phenotype data comprised 35 phenotypes (<xref ref-type="supplementary-material" rid="pcbi.1007940.s013">S3 Table</xref>), including 25 features related to lung function and 10 features collected via blood testing. The phenotypes were verified to be well-approximated by normal distributions: with the exception of rescue_bd_7day and prevent_bd_7day, which are counts and skewed right, all the other variables represented continuous measurements distributed roughly symmetrically in quantile-quantile (QQ) plots (<xref ref-type="supplementary-material" rid="pcbi.1007940.s009">S7 Fig</xref>). The clinical phenotypes were converted to their <italic>z</italic>-scores within each phenotype so that all phenotypes have equal variance. We then imputed missing values using low-rank matrix completion [<xref rid="pcbi.1007940.ref058" ref-type="bibr">58</xref>].</p>
      </sec>
      <sec id="sec027">
        <title>Comparison of methods on asthma data</title>
        <p>We compared PerturbNet with PrediXcan, eCAVIAR, and two-layer Lasso on the asthma data. We applied PerturbNet with semi-supervised learning to all samples, including the samples with only genotype and clinical trait data. In PerturbNet and two-layer Lasso, we selected the regularization parameters using the BIC. With PrediXcan, we mimiced semi-supervised learning by fitting elastic net to the samples with both expression and genotype data, imputing the missing expression data, and using all samples to perform association tests between the imputed gene expression values and traits. To obtain top trait-associated SNPs, we scored each SNP by first scoring SNP-trait pairs as in the simulation study above and summing these scores across all traits. For eCAVIAR, GWAS SNPs were found using all samples, while eQTLs were found using only the samples with expression data. Then, top asthma-associated SNPs were found by summarizing CLPP scores of all triplets into scores of each SNP by taking maximum over all mediator genes and summing over all traits. We applied the two-layer Lasso only to the samples with all data and obtained top SNPs perturbing asthma traits using the same strategy as in PerturbNet.</p>
      </sec>
      <sec id="sec028">
        <title>Comparison of computation time</title>
        <p>To assess the computation time of Mega-sCGGM, PerturbNet, and other existing methods, we used the same hardware setup with comparable software implementations. For Lasso, we used the implementation in GLMNET [<xref rid="pcbi.1007940.ref059" ref-type="bibr">59</xref>] with a backend written in Fortran. For NCD, we took the implementation written in C++ provided by the authors [<xref rid="pcbi.1007940.ref025" ref-type="bibr">25</xref>] and sped up this implementation with the Eigen matrix library [<xref rid="pcbi.1007940.ref060" ref-type="bibr">60</xref>], by employing low-rank matrix representations and using sparse matrix multiplications. For Mega-sCGGM and NCD, we used the same regularization parameters to ensure the resulting estimates are identical, and for Lasso, we chose the regularization parameters so that the <italic>L</italic><sub>1</sub>-norm of the regression coefficients roughly matched that of inferred indirect SNP effects in PerturbNet. We used the C++ implementation of eCAVIAR provided by the authors [<xref rid="pcbi.1007940.ref013" ref-type="bibr">13</xref>], and used PrediXcan [<xref rid="pcbi.1007940.ref012" ref-type="bibr">12</xref>] with elastic-net as implemented in GLMNET [<xref rid="pcbi.1007940.ref059" ref-type="bibr">59</xref>]. For all methods, the code was compiled and run with OpenMP multi-threading enabled on the same machines with 20Gb memory and 16 cores.</p>
      </sec>
      <sec id="sec029">
        <title>Comparison of SNPs with external annotations</title>
        <p>For comparison with the DNase hypersensitivity sites, we used the UES tool [<xref rid="pcbi.1007940.ref061" ref-type="bibr">61</xref>] to identify the sites enriched in top asthma SNPs from each method and to compute the enrichment <italic>p</italic>-values for these overlaps with 100 Monte Carlo simulations. For comparison with annotations in RegulomeDB [<xref rid="pcbi.1007940.ref036" ref-type="bibr">36</xref>], we scored the top 500 asthma SNPs from each method into six categories: category 1 for overlaps with previously reported eQTLs with additional functional annotation on TF binding; categories 2-5 for overlaps with TF binding sites in ChIP-seq, DNase-seq, and motif hits, where lower scores indicate stronger evidence for being functional; and category 6 for little evidence of being functional. Finally, we compared the asthma SNPs found by each method with the previously reported asthma-associated SNPs in the NHGRI GWAS catalog [<xref rid="pcbi.1007940.ref037" ref-type="bibr">37</xref>]. Out of 557 SNPs in the NHGRI GWAS catalog for asthma, we examined how many of these SNPs are within 10, 20, 50, and 100kb of top <italic>k</italic> SNPs from each method, <italic>k</italic> ranging from 1 to 500. To assess the statistical significance of the overlap between two sets of SNPs, we performed a permutation test: for top <italic>k</italic> SNPs from the given method, we generated 10,000 random sets of <italic>k</italic> SNPs from the SNPs employed in the analysis to find the distribution of overlaps under the null hypothesis and reported the overlaps with <italic>p</italic>-value &lt; 0.05.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="sec030">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s001">
      <label>S1 Text</label>
      <caption>
        <title>Two-layer Lasso.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s002">
      <label>S2 Text</label>
      <caption>
        <title>Fast-sCGGM and Mega-sCGGM for efficient sCGGM optimization.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s003">
      <label>S1 Fig</label>
      <caption>
        <title>The PerturbNet model estimated from the CAMP data.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s004">
      <label>S2 Fig</label>
      <caption>
        <title>The PerturbNet posterior gene network for asthma.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s005">
      <label>S3 Fig</label>
      <caption>
        <title>SNP effects on gene modules and gene-module effects on phenotypes in asthma determined by PerturbNet.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s006">
      <label>S4 Fig</label>
      <caption>
        <title>Manhattan plots for overall SNP effects on asthma phenotypes determined by PerturbNet.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s006.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s007">
      <label>S5 Fig</label>
      <caption>
        <title>PerturbNet asthma SNPs as eQTLs.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s007.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s008">
      <label>S6 Fig</label>
      <caption>
        <title>Overlap with asthma SNPs in NHGRI GWAS catalog.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s008.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s009">
      <label>S7 Fig</label>
      <caption>
        <title>The distribution of clinical phenotypes in the CAMP data.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s009.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s010">
      <label>S8 Fig</label>
      <caption>
        <title>Schematic of block coordinate descent in Mega-sCGGM.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s010.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s011">
      <label>S1 Table</label>
      <caption>
        <title>GO categories enriched in gene modules in the PerturbNet asthma gene network.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s012">
      <label>S2 Table</label>
      <caption>
        <title>GO categories enriched in genes in modules 16-20 connected to modules 13-15 in the PerturbNet asthma posterior gene network.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s013">
      <label>S3 Table</label>
      <caption>
        <title>Description of asthma clinical phenotypes in CAMP data.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pcbi.1007940.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors thank Kathryn Roeder for helpful discussion.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pcbi.1007940.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Cusanovich</surname><given-names>DA</given-names></name>, <name><surname>Pavlovic</surname><given-names>B</given-names></name>, <name><surname>Pritchard</surname><given-names>JK</given-names></name>, <name><surname>Gilad</surname><given-names>Y</given-names></name>. <article-title>The functional consequences of variation in transcription factor binding</article-title>. <source>PLoS Genet</source>. <year>2014</year>;<volume>10</volume>(<issue>3</issue>):<fpage>e1004226</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1004226</pub-id><pub-id pub-id-type="pmid">24603674</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Shalem</surname><given-names>O</given-names></name>, <name><surname>Sanjana</surname><given-names>NE</given-names></name>, <name><surname>Zhang</surname><given-names>F</given-names></name>. <article-title>High-throughput functional genomics using CRISPR–Cas9</article-title>. <source>Nature Reviews Genetics</source>. <year>2015</year>;<volume>16</volume>(<issue>5</issue>):<fpage>299</fpage><pub-id pub-id-type="doi">10.1038/nrg3899</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Jansen</surname><given-names>RC</given-names></name>. <article-title>Studying complex biological systems using multifactorial perturbation</article-title>. <source>Nature Reviews Genetics</source>. <year>2003</year>;<volume>4</volume>(<issue>2</issue>):<fpage>145</fpage><pub-id pub-id-type="doi">10.1038/nrg996</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref004">
      <label>4</label>
      <mixed-citation publication-type="other">Sohn KA, Kim S. Joint estimation of structured sparsity and output structure in multiple-output regression via inverse-covariance regularization. In: Proceedings of the 15th International Conference on Artificial Intelligence and Statistics (AISTATS). JMLR W&amp;CP; 2012. p. 1081–1089.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Kim</surname><given-names>S</given-names></name>. <article-title>Learning gene networks under SNP perturbations using eQTL datasets</article-title>. <source>PLoS Computational Biology</source>. <year>2014</year>;<volume>10</volume>(<issue>2</issue>):<fpage>e1003420</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003420</pub-id><pub-id pub-id-type="pmid">24586125</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Frot</surname><given-names>B</given-names></name>, <name><surname>Jostins</surname><given-names>L</given-names></name>, <name><surname>McVean</surname><given-names>G</given-names></name>. <article-title>Graphical model selection for Gaussian conditional random fields in the presence of latent variables</article-title>. <source>Journal of the American Statistical Association</source>. <year>2018</year>;<volume>114</volume>(<issue>526</issue>):<fpage>723</fpage>–<lpage>734</lpage>.<pub-id pub-id-type="pmid">31391793</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Emilsson</surname><given-names>V</given-names></name>, <name><surname>Thorleifsson</surname><given-names>G</given-names></name>, <name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Leonardson</surname><given-names>AS</given-names></name>, <name><surname>Zink</surname><given-names>F</given-names></name>, <name><surname>Zhu</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Genetics of gene expression and its effect on disease</article-title>. <source>Nature</source>. <year>2008</year>;<volume>452</volume>:<fpage>423</fpage>–<lpage>428</lpage>. <pub-id pub-id-type="doi">10.1038/nature06758</pub-id><?supplied-pmid 18344981?><pub-id pub-id-type="pmid">18344981</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Schadt</surname><given-names>EE</given-names></name>. <article-title>Molecular networks as sensors and drivers of common human diseases</article-title>. <source>Nature</source>. <year>2009</year>;<volume>461</volume>:<fpage>218</fpage>–<lpage>223</lpage>. <pub-id pub-id-type="doi">10.1038/nature08454</pub-id><pub-id pub-id-type="pmid">19741703</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Schadt</surname><given-names>EE</given-names></name>, <name><surname>Molony</surname><given-names>C</given-names></name>, <name><surname>Chudin</surname><given-names>E</given-names></name>, <name><surname>Hao</surname><given-names>K</given-names></name>, <name><surname>Yang</surname><given-names>X</given-names></name>, <name><surname>Lum</surname><given-names>PY</given-names></name>, <etal>et al</etal><article-title>Mapping the genetic architecture of gene expression in human liver</article-title>. <source>PLoS biology</source>. <year>2008</year>;<volume>6</volume>(<issue>5</issue>):<fpage>e107</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.0060107</pub-id><?supplied-pmid 18462017?><pub-id pub-id-type="pmid">18462017</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Giambartolomei</surname><given-names>C</given-names></name>, <name><surname>Vukcevic</surname><given-names>D</given-names></name>, <name><surname>Schadt</surname><given-names>EE</given-names></name>, <name><surname>Franke</surname><given-names>L</given-names></name>, <name><surname>Hingorani</surname><given-names>AD</given-names></name>, <name><surname>Wallace</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>Bayesian test for colocalisation between pairs of genetic association studies using summary statistics</article-title>. <source>PLoS Genetics</source>. <year>2014</year>;<volume>10</volume>(<issue>5</issue>):<fpage>e1004383</fpage><pub-id pub-id-type="doi">10.1371/journal.pgen.1004383</pub-id><?supplied-pmid 24830394?><pub-id pub-id-type="pmid">24830394</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>He</surname><given-names>X</given-names></name>, <name><surname>Fuller</surname><given-names>CK</given-names></name>, <name><surname>Song</surname><given-names>Y</given-names></name>, <name><surname>Meng</surname><given-names>Q</given-names></name>, <name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Yang</surname><given-names>X</given-names></name>, <etal>et al</etal><article-title>Sherlock: detecting gene-disease associations by matching patterns of expression QTL and GWAS</article-title>. <source>The American Journal of Human Genetics</source>. <year>2013</year>;<volume>92</volume>(<issue>5</issue>):<fpage>667</fpage>–<lpage>680</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2013.03.022</pub-id><?supplied-pmid 23643380?><pub-id pub-id-type="pmid">23643380</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Gamazon</surname><given-names>ER</given-names></name>, <name><surname>Wheeler</surname><given-names>HE</given-names></name>, <name><surname>Shah</surname><given-names>KP</given-names></name>, <name><surname>Mozaffari</surname><given-names>SV</given-names></name>, <name><surname>Aquino-Michaels</surname><given-names>K</given-names></name>, <name><surname>Carroll</surname><given-names>RJ</given-names></name>, <etal>et al</etal><article-title>A gene-based association method for mapping traits using reference transcriptome data</article-title>. <source>Nature Genetics</source>. <year>2015</year>;<volume>47</volume>(<issue>9</issue>):<fpage>1091</fpage>–<lpage>1098</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3367</pub-id><?supplied-pmid 26258848?><pub-id pub-id-type="pmid">26258848</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Hormozdiari</surname><given-names>F</given-names></name>, <name><surname>Van De Bunt</surname><given-names>M</given-names></name>, <name><surname>Segre</surname><given-names>AV</given-names></name>, <name><surname>Li</surname><given-names>X</given-names></name>, <name><surname>Joo</surname><given-names>JWJ</given-names></name>, <name><surname>Bilow</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Colocalization of GWAS and eQTL signals detects target genes</article-title>. <source>The American Journal of Human Genetics</source>. <year>2016</year>;<volume>99</volume>(<issue>6</issue>):<fpage>1245</fpage>–<lpage>1260</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2016.10.003</pub-id><?supplied-pmid 27866706?><pub-id pub-id-type="pmid">27866706</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Greenawalt</surname><given-names>DM</given-names></name>, <name><surname>Dobrin</surname><given-names>R</given-names></name>, <name><surname>Chudin</surname><given-names>E</given-names></name>, <name><surname>Hatoum</surname><given-names>IJ</given-names></name>, <name><surname>Suver</surname><given-names>C</given-names></name>, <name><surname>Beaulaurier</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>A survey of the genetics of stomach, liver, and adipose gene expression from a morbidly obese cohort</article-title>. <source>Genome Research</source>. <year>2011</year>;<volume>21</volume>(<issue>7</issue>):<fpage>1008</fpage>–<lpage>1016</lpage>. <pub-id pub-id-type="doi">10.1101/gr.112821.110</pub-id><?supplied-pmid 21602305?><pub-id pub-id-type="pmid">21602305</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Gibson</surname><given-names>G</given-names></name>, <name><surname>Powell</surname><given-names>JE</given-names></name>, <name><surname>Marigorta</surname><given-names>UM</given-names></name>. <article-title>Expression quantitative trait locus analysis for translational medicine</article-title>. <source>Genome Medicine</source>. <year>2015</year>;<volume>7</volume>(<issue>1</issue>):<fpage>60</fpage><pub-id pub-id-type="doi">10.1186/s13073-015-0186-7</pub-id><pub-id pub-id-type="pmid">26110023</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><collab>GTEx Consortium</collab>. <article-title>The Genotype-Tissue Expression (GTEx) pilot analysis: multi-tissue gene regulation in humans</article-title>. <source>Science</source>. <year>2015</year>;<volume>348</volume>(<issue>6235</issue>):<fpage>648</fpage>–<lpage>660</lpage>. <pub-id pub-id-type="doi">10.1126/science.1262110</pub-id><pub-id pub-id-type="pmid">25954001</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Moffatt</surname><given-names>MF</given-names></name>, <name><surname>Gut</surname><given-names>IG</given-names></name>, <name><surname>Demenais</surname><given-names>F</given-names></name>, <name><surname>Strachan</surname><given-names>DP</given-names></name>, <name><surname>Bouzigon</surname><given-names>E</given-names></name>, <name><surname>Heath</surname><given-names>S</given-names></name>, <etal>et al</etal><article-title>A large-scale, consortium-based genomewide association study of asthma</article-title>. <source>New England Journal of Medicine</source>. <year>2010</year>;<volume>363</volume>(<issue>13</issue>):<fpage>1211</fpage>–<lpage>1221</lpage>. <pub-id pub-id-type="doi">10.1056/NEJMoa0906312</pub-id><?supplied-pmid 20860503?><pub-id pub-id-type="pmid">20860503</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><collab>Wellcome Trust Case Control Consortium</collab>. <article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3,000 shared controls</article-title>. <source>Nature</source>. <year>2007</year>;<volume>447</volume>(<issue>7145</issue>):<fpage>661</fpage>–<lpage>678</lpage>. <pub-id pub-id-type="doi">10.1038/nature05911</pub-id><pub-id pub-id-type="pmid">17554300</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Nakka</surname><given-names>P</given-names></name>, <name><surname>Raphael</surname><given-names>BJ</given-names></name>, <name><surname>Ramachandran</surname><given-names>S</given-names></name>. <article-title>Gene and network analysis of common variants reveals novel associations in multiple complex diseases</article-title>. <source>Genetics</source>. <year>2016</year>;<volume>204</volume>(<issue>2</issue>):<fpage>783</fpage>–<lpage>798</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.116.188391</pub-id><pub-id pub-id-type="pmid">27489002</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Mezlini</surname><given-names>AM</given-names></name>, <name><surname>Goldenberg</surname><given-names>A</given-names></name>. <article-title>Incorporating networks in a probabilistic graphical model to find drivers for complex human diseases</article-title>. <source>PLoS Computational Biology</source>. <year>2017</year>;<volume>13</volume>(<issue>10</issue>):<fpage>e1005580</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1005580</pub-id><pub-id pub-id-type="pmid">29023450</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>YA</given-names></name>, <name><surname>Wuchty</surname><given-names>S</given-names></name>, <name><surname>Przytycka</surname><given-names>TM</given-names></name>. <article-title>Identifying causal genes and dysregulated pathways in complex diseases</article-title>. <source>PLoS computational biology</source>. <year>2011</year>;<volume>7</volume>(<issue>3</issue>):<fpage>e1001095</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1001095</pub-id><pub-id pub-id-type="pmid">21390271</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Botzman</surname><given-names>M</given-names></name>, <name><surname>Nachshon</surname><given-names>A</given-names></name>, <name><surname>Brodt</surname><given-names>A</given-names></name>, <name><surname>Gat-Viks</surname><given-names>I</given-names></name>. <article-title>POEM: Identifying joint additive effects on regulatory circuits</article-title>. <source>Frontiers in genetics</source>. <year>2016</year>;<volume>7</volume>:<fpage>48</fpage>.<pub-id pub-id-type="pmid">27148351</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Oren</surname><given-names>Y</given-names></name>, <name><surname>Nachshon</surname><given-names>A</given-names></name>, <name><surname>Frishberg</surname><given-names>A</given-names></name>, <name><surname>Wilentzik</surname><given-names>R</given-names></name>, <name><surname>Gat-Viks</surname><given-names>I</given-names></name>. <article-title>Linking traits based on their shared molecular mechanisms</article-title>. <source>Elife</source>. <year>2015</year>;<volume>4</volume>:<fpage>e04346</fpage><pub-id pub-id-type="doi">10.7554/eLife.04346</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Peters</surname><given-names>LA</given-names></name>, <name><surname>Perrigoue</surname><given-names>J</given-names></name>, <name><surname>Mortha</surname><given-names>A</given-names></name>, <name><surname>Iuga</surname><given-names>A</given-names></name>, <name><surname>Song</surname><given-names>Wm</given-names></name>, <name><surname>Neiman</surname><given-names>EM</given-names></name>, <etal>et al</etal><article-title>A functional genomics predictive network model identifies regulators of inflammatory bowel disease</article-title>. <source>Nature genetics</source>. <year>2017</year>;<volume>49</volume>(<issue>10</issue>):<fpage>1437</fpage>–<lpage>1449</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3947</pub-id><?supplied-pmid 28892060?><pub-id pub-id-type="pmid">28892060</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref025">
      <label>25</label>
      <mixed-citation publication-type="other">Wytock M, Kolter JZ. Sparse Gaussian conditional random fields: algorithms, theory, and application to energy forecasting. In: Proceedings of the 30th International Conference on Machine Learning. vol. 28. JMLR W&amp;CP; 2013. p. 1265–1273.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref026">
      <label>26</label>
      <mixed-citation publication-type="book"><name><surname>Koller</surname><given-names>D</given-names></name>, <name><surname>Friedman</surname><given-names>N</given-names></name>. <source>Probabilistic graphical models: principles and techniques</source>. <publisher-name>MIT Press</publisher-name>; <year>2009</year>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><collab>Childhood Asthma Management Program Research Group</collab>. <article-title>The childhood asthma management program (CAMP): design, rationale, and methods</article-title>. <source>Controlled Clinical Trials</source>. <year>1999</year>;<volume>20</volume>(<issue>1</issue>):<fpage>91</fpage>–<lpage>120</lpage>. <pub-id pub-id-type="doi">10.1016/S0197-2456(98)00044-0</pub-id><pub-id pub-id-type="pmid">10027502</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><collab>Childhood Asthma Management Program Research Group</collab>. <article-title>Long-term effects of budesonide or nedocromil in children with asthma</article-title>. <source>New England Journal of Medicine</source>. <year>2000</year>;<volume>343</volume>(<issue>15</issue>):<fpage>1054</fpage>–<lpage>1063</lpage>. <pub-id pub-id-type="doi">10.1056/NEJM200010123431501</pub-id><pub-id pub-id-type="pmid">11027739</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Murphy</surname><given-names>A</given-names></name>, <name><surname>Chu</surname><given-names>JH</given-names></name>, <name><surname>Xu</surname><given-names>M</given-names></name>, <name><surname>Carey</surname><given-names>VJ</given-names></name>, <name><surname>Lazarus</surname><given-names>R</given-names></name>, <name><surname>Liu</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Mapping of numerous disease-associated expression polymorphisms in primary peripheral blood CD4+ lymphocytes</article-title>. <source>Human Molecular Genetics</source>. <year>2010</year>;<volume>19</volume>(<issue>23</issue>):<fpage>4745</fpage>–<lpage>4757</lpage>. <pub-id pub-id-type="doi">10.1093/hmg/ddq392</pub-id><?supplied-pmid 20833654?><pub-id pub-id-type="pmid">20833654</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Sparse inverse covariance estimation with the graphical lasso</article-title>. <source>Biostatistics</source>. <year>2008</year>;<volume>9</volume>(<issue>3</issue>):<fpage>432</fpage>–<lpage>441</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/kxm045</pub-id><pub-id pub-id-type="pmid">18079126</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref031">
      <label>31</label>
      <mixed-citation publication-type="other">Hsieh CJ, Sustik MA, Dhillon IS, Ravikumar PK, Poldrack R. BIG &amp; QUIC: Sparse inverse covariance estimation for a million variables. In: Advances in Neural Information Processing Systems 26. Curran Associates; 2013. p. 3165–3173.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Höfling</surname><given-names>H</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Pathwise coordinate optimization</article-title>. <source>The Annals of Applied Statistics</source>. <year>2007</year>;<volume>1</volume>(<issue>2</issue>):<fpage>302</fpage>–<lpage>332</lpage>. <pub-id pub-id-type="doi">10.1214/07-AOAS131</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref033">
      <label>33</label>
      <mixed-citation publication-type="other">Karypis G, Kumar V. METIS—unstructured graph partitioning and sparse matrix ordering system, version 2.0. University of Minnesota, Department of Computer Science and Engineering, Army HPC Research Center, Minneapolis, MN; 1995.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><collab>Gene Ontology Consortium</collab>. <article-title>The Gene Ontology (GO) database and informatics resource</article-title>. <source>Nucleic Acids Research</source>. <year>2004</year>;<volume>32</volume>(<issue>suppl_1</issue>):<fpage>D258</fpage>–<lpage>D261</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkh036</pub-id><pub-id pub-id-type="pmid">14681407</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><collab>ENCODE Project Consortium</collab>. <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>489</volume>(<issue>7414</issue>):<fpage>57</fpage>–<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1038/nature11247</pub-id><pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Boyle</surname><given-names>AP</given-names></name>, <name><surname>Hong</surname><given-names>EL</given-names></name>, <name><surname>Hariharan</surname><given-names>M</given-names></name>, <name><surname>Cheng</surname><given-names>Y</given-names></name>, <name><surname>Schaub</surname><given-names>MA</given-names></name>, <name><surname>Kasowski</surname><given-names>M</given-names></name>, <etal>et al</etal><article-title>Annotation of functional variation in personal genomes using RegulomeDB</article-title>. <source>Genome Research</source>. <year>2012</year>;<volume>22</volume>(<issue>9</issue>):<fpage>1790</fpage>–<lpage>1797</lpage>. <pub-id pub-id-type="doi">10.1101/gr.137323.112</pub-id><?supplied-pmid 22955989?><pub-id pub-id-type="pmid">22955989</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Buniello</surname><given-names>A</given-names></name>, <name><surname>MacArthur</surname><given-names>JAL</given-names></name>, <name><surname>Cerezo</surname><given-names>M</given-names></name>, <name><surname>Harris</surname><given-names>LW</given-names></name>, <name><surname>Hayhurst</surname><given-names>J</given-names></name>, <name><surname>Malangone</surname><given-names>C</given-names></name>, <etal>et al</etal><article-title>The NHGRI-EBI GWAS Catalog of published genome-wide association studies, targeted arrays and summary statistics 2019</article-title>. <source>Nucleic Acids Research</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D1005</fpage>–<lpage>D1012</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gky1120</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Kichaev</surname><given-names>G</given-names></name>, <name><surname>Bhatia</surname><given-names>G</given-names></name>, <name><surname>Loh</surname><given-names>PR</given-names></name>, <name><surname>Gazal</surname><given-names>S</given-names></name>, <name><surname>Burch</surname><given-names>K</given-names></name>, <name><surname>Freund</surname><given-names>MK</given-names></name>, <etal>et al</etal><article-title>Leveraging polygenic functional enrichment to improve GWAS power</article-title>. <source>The American Journal of Human Genetics</source>. <year>2019</year>;<volume>104</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>75</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2018.11.008</pub-id><?supplied-pmid 30595370?><pub-id pub-id-type="pmid">30595370</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref039">
      <label>39</label>
      <mixed-citation publication-type="journal"><collab>1000 Genomes Project Consortium</collab>. <article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>. <source>Nature</source>. <year>2012</year>;<volume>491</volume>(<issue>7422</issue>):<fpage>56</fpage>–<lpage>65</lpage>. <pub-id pub-id-type="doi">10.1038/nature11632</pub-id><pub-id pub-id-type="pmid">23128226</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref040">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Hai</surname><given-names>T</given-names></name>, <name><surname>Wolford</surname><given-names>CC</given-names></name>, <name><surname>Chang</surname><given-names>YS</given-names></name>. <article-title>ATF3, a hub of the cellular adaptive-response network, in the pathogenesis of diseases: is modulation of inflammation a unifying component?</article-title><source>Gene Expression</source>. <year>2010</year>;<volume>15</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <pub-id pub-id-type="doi">10.3727/105221610X12819686555015</pub-id><pub-id pub-id-type="pmid">21061913</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref041">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>Z</given-names></name>, <name><surname>MacNeil</surname><given-names>AJ</given-names></name>, <name><surname>Junkins</surname><given-names>R</given-names></name>, <name><surname>Li</surname><given-names>B</given-names></name>, <name><surname>Berman</surname><given-names>JN</given-names></name>, <name><surname>Lin</surname><given-names>TJ</given-names></name>. <article-title>Mast cell Fc<italic>ε</italic>RI-induced early growth response 2 regulates CC chemokine ligand 1–dependent CD4+ T cell migration</article-title>. <source>The Journal of Immunology</source>. <year>2013</year>;<volume>190</volume>(<issue>9</issue>):<fpage>4500</fpage>–<lpage>4507</lpage>. <pub-id pub-id-type="doi">10.4049/jimmunol.1203158</pub-id><pub-id pub-id-type="pmid">23536637</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref042">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Temple</surname><given-names>R</given-names></name>, <name><surname>Allen</surname><given-names>E</given-names></name>, <name><surname>Fordham</surname><given-names>J</given-names></name>, <name><surname>Phipps</surname><given-names>S</given-names></name>, <name><surname>Schneider</surname><given-names>HC</given-names></name>, <name><surname>Lindauer</surname><given-names>K</given-names></name>, <etal>et al</etal><article-title>Microarray analysis of eosinophils reveals a number of candidate survival and apoptosis genes</article-title>. <source>American Journal of Respiratory Cell and Molecular Biology</source>. <year>2001</year>;<volume>25</volume>(<issue>4</issue>):<fpage>425</fpage>–<lpage>433</lpage>. <pub-id pub-id-type="doi">10.1165/ajrcmb.25.4.4456</pub-id><?supplied-pmid 11694447?><pub-id pub-id-type="pmid">11694447</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref043">
      <label>43</label>
      <mixed-citation publication-type="journal"><name><surname>Barnig</surname><given-names>C</given-names></name>, <name><surname>Alsaleh</surname><given-names>G</given-names></name>, <name><surname>Jung</surname><given-names>N</given-names></name>, <name><surname>Dembélé</surname><given-names>D</given-names></name>, <name><surname>Paul</surname><given-names>N</given-names></name>, <name><surname>Poirot</surname><given-names>A</given-names></name>, <etal>et al</etal><article-title>Circulating human eosinophils share a similar transcriptional profile in asthma and other hypereosinophilic disorders</article-title>. <source>PLoS One</source>. <year>2015</year>;<volume>10</volume>(<issue>11</issue>):<fpage>e0141740</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0141740</pub-id><?supplied-pmid 26524763?><pub-id pub-id-type="pmid">26524763</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref044">
      <label>44</label>
      <mixed-citation publication-type="journal"><name><surname>Khan</surname><given-names>MA</given-names></name>, <name><surname>Assiri</surname><given-names>AM</given-names></name>, <name><surname>Broering</surname><given-names>DC</given-names></name>. <article-title>Complement mediators: Key regulators of airway tissue remodeling in asthma</article-title>. <source>Journal of Translational Medicine</source>. <year>2015</year>;<volume>13</volume>(<issue>1</issue>):<fpage>272</fpage><pub-id pub-id-type="doi">10.1186/s12967-015-0565-2</pub-id><pub-id pub-id-type="pmid">26289385</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref045">
      <label>45</label>
      <mixed-citation publication-type="journal"><name><surname>Kay</surname><given-names>A</given-names></name>, <name><surname>Bacon</surname><given-names>G</given-names></name>, <name><surname>Mercer</surname><given-names>B</given-names></name>, <name><surname>Simpson</surname><given-names>H</given-names></name>, <name><surname>Crofton</surname><given-names>J</given-names></name>. <article-title>Complement components and IgE in bronchial asthma</article-title>. <source>The Lancet</source>. <year>1974</year>;<volume>304</volume>(<issue>7886</issue>):<fpage>916</fpage>–<lpage>920</lpage>. <pub-id pub-id-type="doi">10.1016/S0140-6736(74)91128-3</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref046">
      <label>46</label>
      <mixed-citation publication-type="journal"><name><surname>Jönsson</surname><given-names>G</given-names></name>, <name><surname>Sjöholm</surname><given-names>A</given-names></name>, <name><surname>Truedsson</surname><given-names>L</given-names></name>, <name><surname>Bengtsson</surname><given-names>A</given-names></name>, <name><surname>Braconier</surname><given-names>JH</given-names></name>, <name><surname>Sturfelt</surname><given-names>G</given-names></name>. <article-title>Rheumatological manifestations, organ damage and autoimmunity in hereditary C2 deficiency</article-title>. <source>Rheumatology</source>. <year>2007</year>;<volume>46</volume>(<issue>7</issue>):<fpage>1133</fpage>–<lpage>1139</lpage>. <pub-id pub-id-type="doi">10.1093/rheumatology/kem023</pub-id><pub-id pub-id-type="pmid">17478473</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref047">
      <label>47</label>
      <mixed-citation publication-type="journal"><name><surname>Charignon</surname><given-names>D</given-names></name>, <name><surname>Ponard</surname><given-names>D</given-names></name>, <name><surname>de Gennes</surname><given-names>C</given-names></name>, <name><surname>Drouet</surname><given-names>C</given-names></name>, <name><surname>Ghannam</surname><given-names>A</given-names></name>. <article-title>SERPING1 and F12 combined variants in a hereditary angioedema family</article-title>. <source>Annals of Allergy, Asthma &amp; Immunology</source>. <year>2018</year>;<volume>121</volume>(<issue>4</issue>):<fpage>500</fpage>–<lpage>502</lpage>. <pub-id pub-id-type="doi">10.1016/j.anai.2018.05.031</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref048">
      <label>48</label>
      <mixed-citation publication-type="journal"><name><surname>Luo</surname><given-names>W</given-names></name>, <name><surname>Obeidat</surname><given-names>M</given-names></name>, <name><surname>Di Narzo</surname><given-names>AF</given-names></name>, <name><surname>Chen</surname><given-names>R</given-names></name>, <name><surname>Sin</surname><given-names>DD</given-names></name>, <name><surname>Paré</surname><given-names>PD</given-names></name>, <etal>et al</etal><article-title>Airway epithelial expression quantitative trait loci reveal genes underlying asthma and other airway diseases</article-title>. <source>American Journal of Respiratory Cell and Molecular Biology</source>. <year>2016</year>;<volume>54</volume>(<issue>2</issue>):<fpage>177</fpage>–<lpage>187</lpage>. <pub-id pub-id-type="doi">10.1165/rcmb.2014-0381OC</pub-id><?supplied-pmid 26102239?><pub-id pub-id-type="pmid">26102239</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref049">
      <label>49</label>
      <mixed-citation publication-type="journal"><name><surname>Buntru</surname><given-names>A</given-names></name>, <name><surname>Kopp</surname><given-names>K</given-names></name>, <name><surname>Voges</surname><given-names>M</given-names></name>, <name><surname>Frank</surname><given-names>R</given-names></name>, <name><surname>Bachmann</surname><given-names>V</given-names></name>, <name><surname>Hauck</surname><given-names>CR</given-names></name>. <article-title>Phosphatidylinositol 3’-kinase activity is critical for initiating the oxidative burst and bacterial destruction during CEACAM3-mediated phagocytosis</article-title>. <source>Journal of Biological Chemistry</source>. <year>2011</year>;<volume>286</volume>(<issue>11</issue>):<fpage>9555</fpage>–<lpage>9566</lpage>. <pub-id pub-id-type="doi">10.1074/jbc.M110.216085</pub-id><pub-id pub-id-type="pmid">21216968</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref050">
      <label>50</label>
      <mixed-citation publication-type="other">Lafferty J, McCallum A, Pereira FC. Conditional random fields: Probabilistic models for segmenting and labeling sequence data. In: Proceedings of the 18th International Conference on Machine Learning. vol. 951; 2001. p. 282–289.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref051">
      <label>51</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Yang</surname><given-names>C</given-names></name>, <name><surname>Shi</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Huang</surname><given-names>J</given-names></name>, <name><surname>Zhao</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>Analyzing association mapping in pedigree-based GWAS using a penalized multitrait mixed model</article-title>. <source>Genetic Epidemiology</source>. <year>2016</year>;<volume>40</volume>(<issue>5</issue>):<fpage>382</fpage>–<lpage>393</lpage>. <pub-id pub-id-type="doi">10.1002/gepi.21975</pub-id><?supplied-pmid 27247027?><pub-id pub-id-type="pmid">27247027</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref052">
      <label>52</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>H</given-names></name>, <name><surname>Lafferty</surname><given-names>J</given-names></name>, <name><surname>Wasserman</surname><given-names>L</given-names></name>. <article-title>The nonparanormal: Semiparametric estimation of high dimensional undirected graphs</article-title>. <source>Journal of Machine Learning Research</source>. <year>2009</year>;<volume>10</volume>(<issue>Oct</issue>):<fpage>2295</fpage>–<lpage>2328</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref053">
      <label>53</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Zeng</surname><given-names>Z</given-names></name>, <name><surname>Ji</surname><given-names>Q</given-names></name>. <article-title>Probabilistic image modeling with an extended chain graph for human activity recognition and image segmentation</article-title>. <source>IEEE Transactions on Image Processing</source>. <year>2011</year>;<volume>20</volume>(<issue>9</issue>):<fpage>2401</fpage>–<lpage>2413</lpage>. <pub-id pub-id-type="doi">10.1109/TIP.2011.2128332</pub-id><pub-id pub-id-type="pmid">21421443</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref054">
      <label>54</label>
      <mixed-citation publication-type="book"><name><surname>Hsieh</surname><given-names>CJ</given-names></name>, <name><surname>Dhillon</surname><given-names>IS</given-names></name>, <name><surname>Ravikumar</surname><given-names>PK</given-names></name>, <name><surname>Sustik</surname><given-names>MA</given-names></name>. <chapter-title>Sparse inverse covariance matrix estimation using quadratic approximation</chapter-title> In: <source>Advances in Neural Information Processing Systems 24</source>. <publisher-name>Curran Associates</publisher-name>; <year>2011</year> p. <fpage>2330</fpage>–<lpage>2338</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref055">
      <label>55</label>
      <mixed-citation publication-type="journal"><name><surname>Dempster</surname><given-names>AP</given-names></name>, <name><surname>Laird</surname><given-names>NM</given-names></name>, <name><surname>Rubin</surname><given-names>DB</given-names></name>. <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>Journal of the Royal Statistical Society: Series B (Methodological)</source>. <year>1977</year>;<volume>39</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref056">
      <label>56</label>
      <mixed-citation publication-type="journal"><name><surname>Friedman</surname><given-names>J</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Sparse inverse covariance estimation with the graphical lasso</article-title>. <source>Biostatistics</source>. <year>2008</year>;<volume>9</volume>(<issue>3</issue>):<fpage>432</fpage>–<lpage>441</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/kxm045</pub-id><pub-id pub-id-type="pmid">18079126</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref057">
      <label>57</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>JJ</given-names></name>, <name><surname>Gao</surname><given-names>ZY</given-names></name>, <name><surname>Sun</surname><given-names>HJ</given-names></name>. <article-title>Cascade and breakdown in scale-free networks with community structure</article-title>. <source>Physical Review E</source>. <year>2006</year>;<volume>74</volume>(<issue>6</issue>):<fpage>066111</fpage><pub-id pub-id-type="doi">10.1103/PhysRevE.74.066111</pub-id></mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref058">
      <label>58</label>
      <mixed-citation publication-type="other">Lin Z, Chen M, Ma Y. The augmented Lagrange multiplier method for exact recovery of corrupted low-rank matrices. Coordinated Science Laboratory, University of Illinois at Urbana-Champaign; 2010. Report no. UILU-ENG-09-2215.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref059">
      <label>59</label>
      <mixed-citation publication-type="other">Qian J, Hastie T, Friedman J, Tibshirani R, Simon N. Glmnet for Matlab; 2013. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.stanford.edu/~hastie/glmnet_matlab/">http://www.stanford.edu/~hastie/glmnet_matlab/</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref060">
      <label>60</label>
      <mixed-citation publication-type="other">Guennebaud G, Jacob B. Eigen v3; 2010. Available from: <ext-link ext-link-type="uri" xlink:href="http://eigen.tuxfamily.org">http://eigen.tuxfamily.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="pcbi.1007940.ref061">
      <label>61</label>
      <mixed-citation publication-type="journal"><name><surname>Hayes</surname><given-names>JE</given-names></name>, <name><surname>Trynka</surname><given-names>G</given-names></name>, <name><surname>Vijai</surname><given-names>J</given-names></name>, <name><surname>Offit</surname><given-names>K</given-names></name>, <name><surname>Raychaudhuri</surname><given-names>S</given-names></name>, <name><surname>Klein</surname><given-names>RJ</given-names></name>. <article-title>Tissue-specific enrichment of lymphoma risk loci in regulatory elements</article-title>. <source>PloS One</source>. <year>2015</year>;<volume>10</volume>(<issue>9</issue>):<fpage>e0139360</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0139360</pub-id><pub-id pub-id-type="pmid">26422229</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<sub-article id="pcbi.1007940.r001" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007940.r001</article-id>
    <title-group>
      <article-title>Decision Letter 0</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leslie</surname>
          <given-names>Christina S.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Noble, Leslie</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Noble, Leslie</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj001" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007940" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>0</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <boxed-text id="pgen-1009040-box001" position="float" specific-use="prior_peer_review_unavailable" orientation="portrait">
      <sec id="sec031">
        <title>Transfer Alert</title>
        <p>This paper was transferred from another journal. As a result, its full editorial history (including decision letters, peer reviews and author responses) may not be present.</p>
      </sec>
    </boxed-text>
    <p>
      <named-content content-type="letter-date">9 Jan 2020</named-content>
    </p>
    <p>Dear Dr Kim,</p>
    <p>Thank you very much for submitting your manuscript 'Learning Gene Networks Underlying Clinical Phenotypes Using SNP Perturbation' for review by PLOS Computational Biology. We apologize for the rather lengthy initial review process, as finding reviewers with the required expertise took some time. </p>
    <p>Your manuscript has now been fully evaluated by the PLOS Computational Biology editorial team and by independent peer reviewers. The reviewers appreciated the attention to an important problem, but raised some substantial concerns about the manuscript as it currently stands. While your manuscript cannot be accepted in its present form, we are willing to consider a revised version in which the issues raised by the reviewers have been adequately addressed. </p>
    <p>Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.</p>
    <p>Your revisions should address the specific points made by each reviewer. Please return the revised version within the next 60 days. If you anticipate any delay in its return, we ask that you let us know the expected resubmission date by email at <email>ploscompbiol@plos.org</email>. Revised manuscripts received beyond 60 days may require evaluation and peer review similar to that applied to newly submitted manuscripts.</p>
    <p>In addition, when you are ready to resubmit, please be prepared to provide the following:</p>
    <p>(1) A detailed list of your responses to the review comments and the changes you have made in the manuscript. We require a file of this nature before your manuscript is passed back to the editors.</p>
    <p>(2) A copy of your manuscript with the changes highlighted (encouraged). We encourage authors, if possible to show clearly where changes have been made to their manuscript e.g. by highlighting text.</p>
    <p>(3) A striking still image to accompany your article (optional). If the image is judged to be suitable by the editors, it may be featured on our website and might be chosen as the issue image for that month. These square, high-quality images should be accompanied by a short caption. Please note as well that there should be no copyright restrictions on the use of the image, so that it can be published under the Open-Access license and be subject only to appropriate attribution.</p>
    <p>Before you resubmit your manuscript, please consult our Submission Checklist to ensure your manuscript is formatted correctly for PLOS Computational Biology: <ext-link ext-link-type="uri" xlink:href="http://www.ploscompbiol.org/static/checklist.action">http://www.ploscompbiol.org/static/checklist.action</ext-link>. Some key points to remember are:</p>
    <p>- Figures uploaded separately as TIFF or EPS files (if you wish, your figures may remain in your main manuscript file in addition).</p>
    <p>- Supporting Information uploaded as separate files, titled Dataset, Figure, Table, Text, Protocol, Audio, or Video.</p>
    <p>- Funding information in the 'Financial Disclosure' box in the online system.</p>
    <p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, <ext-link ext-link-type="uri" xlink:href="https://pacev2.apexcovantage.com">https://pacev2.apexcovantage.com</ext-link> PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at <email>figures@plos.org</email>.</p>
    <p>To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions see <ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/submission-guidelines#loc-materials-and-methods">here</ext-link>. </p>
    <p>If you have any concerns or questions, please do not hesitate to contact us.</p>
    <p>Sincerely,</p>
    <p>Christina S. Leslie</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>A link appears below if there are any accompanying review attachments. If you believe any reviews to be missing, please contact <email>ploscompbiol@plos.org</email> immediately:</p>
    <p>[LINK]</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: This paper introduces a method called PerturbNet, which can integrate SNP, gene expression and trait information in a single graphical model that can be used to infer the gene network mediated effect of SNPs on the traits. Furthermore, it can decompose the impact of different SNPs on different network components and also infer the underlying network. The model is based on a sparse Conditional Gaussian graphical model (sCGGM). The authors also introduce a new algorithm for learning the scGGM, which is significantly faster than the current implementations. They apply their approach to simulated data and also to data from the Childhood Asthma Management Program (CAMP) and also compare to other methods</p>
    <p>such PrediXcan, eCAVIAR and a two-layered LASSO and show that their method is much better for identifying the relevant snps. Overall, this is an interesting piece of work and the PerturbNet method should be helpful to analyze datasets from consortia where all three types of measurements are being made. My only main comments to improve the work are (a) a better description of the method (b) comparisons to related work, (c) availability of PerturbNet. Details follow:</p>
    <p>1. The PerturbNet approach is based on a sparse CGGM model, which aims to model p(y,z|x) as p(y|x)p(z|y) where x is the SNP information, y is the expre ssion and z is the phenotypic traits. However, fig 1 does not provide any description about the components of the sCGGM approach that is being used. A more annotated version of fig 1 which introduces the different components of the model would be very helpful to the reader. The manuscript text could also go into more details of the methods rather than pushing everything to methods.</p>
    <p>2. The simulation makes use of a GGM and CGGM model and hence it is not surprising that PerturbNet works very well here. It might be good to discuss the simulation model in the content of the modeling assumptions of the different methods.</p>
    <p>3. All the methods compared for linking SNPs to traits via networks are not network based. There have been other pieces of work that aim to identify subnetworks that are perturbed or explain the impact of the SNPs on phenotypes by a network. For example, the work from <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4835676/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4835676/</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/25781485">https://www.ncbi.nlm.nih.gov/pubmed/25781485</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/21390271">https://www.ncbi.nlm.nih.gov/pubmed/21390271</ext-link>. Comparison of PerturbNet to some network-based methods would be very beneficial.</p>
    <p>4. The module identification step is not discussed in much detail. It is unclear how the number of modules is defined, why it is needed and if and how the module information is leveraged for network inference. It seems that it is used primarily as a post-processing step. It is also not clear how the modules are defined, is it on the network structure inferred or is it on the precision matrix or some other weighted graph.</p>
    <p>5. The number of samples in the dataset seems low. It is unclear if the authors can assert any confidence on the inferred model. The FDR is mentioned but it is unclear how it is estimated.</p>
    <p>6. The code for PerturbNet is not available. This is important to make available as soon as possible.</p>
    <p>7. The Gaussian assumption has some nice properties which make the inference tractable. But it might be worth discussing if the variables, namely the traits are Gaussian.</p>
    <p>8. The new Mega-sCGGM method seems a nice contribution of this work. Code for this should be made available. It would also be helpful to see if this more efficient version has the same or different performance as the original/exisiting implementations of CGMMs.</p>
    <p>9. I might have missed this, but there must be hyperparamters to control for sparsity, but I did not see how this was set.</p>
    <p>Minor:</p>
    <p>1. Please define CLPP on page 12</p>
    <p>2. The number of modules in the simulation is not clear. The sentence "..were assumed to have modules of size 50 each, leading to 100 and 2 442</p>
    <p>modules in each network." needs revision (line 442).</p>
    <p>Reviewer #2: McCarter et al. focus on an important research problem of identifying SNPs that influence phenotypes via molecular networks. While a number of computational methods exist for various GWAS and eQTL analysis, very few methods, if any, exist that connect genotype to phenotypes via transcriptional networks.</p>
    <p>Authors propose a model that builds on probabilistic graphical models, in particular (multivariate) conditional Gaussian graphical model (or Markov random field). The model is constructed as a chain-structured graph in such a way that transcriptional level (or network) is conditioned with genotype and phenotype level is conditioned by the transcriptional networks. This construction allows considering perturbations in the genotype to affect phenotypes via the intermediate transcriptional networks. Authors propose a sparsity promoting optimisation method for the model including all layers using the standard L1 regularizers. Authors also propose three inference procedures to study the learned model to gain more detailed understanding of how genotype affects phenotypes via transcriptional networks. The model is coherently defined in the probabilistic graphical modeling framework. The model is well-motivated, although it is built on the assumption of all variables having a joint Gaussian distribution. Despite the joint normal assumption, the method can reveal reasonable results and probably serves as a good first approximation. The model and methods are clearly described and seems technically correct. Results demonstrate good performance relative to the state-of-the-art.</p>
    <p>Major comments:</p>
    <p>- page 9: The model space is extremely large while only limited amounts of data is typically available. Although the model learning relies on standard regularisation methods, I am worried that the model learning can be very sensitive. Authors should demonstrate the robustness (or sensitivity) or they model learning with an appropriate robustness analysis. E.g. how much does the learned model/network structure differ for small perturbations in the input data? How much do these changes affect the interpretation of the model (ref. the proposed 3 inference methods)? Are the results in Results section sensitive to small perturbations in the training data? I am OK with the method being marginally sensitive, as long as authors give a comprehensive evaluation of their methods, and give a fair discussion of potential limitations as well.</p>
    <p>- page 12: For simulation studies, data is generated from Gaussian distributions. Can you carry out simulated experiments where data is generated from a model that includes nonlinearities?</p>
    <p>- page 12: Authors should describe that how realistic the simulation set-up is? Or mention that data is simulated from a model that does not necessarily represent a realistic system.</p>
    <p>Minor comments:</p>
    <p>- page 7, row 282: A reader can easily misinterpret that x is a three-valued vector of length p, but text says "given as minor allele frequencies". Can you define the domain of x similarly as you do for y and z.</p>
    <p>- page 9, row 331: I understood that the speed improvement (of several orders of magnitude) is based on *empirical* analysis. Please explicitly clarify that in the text too.</p>
    <p>- pages 10-11: Could authors specify and write the joint Gaussian distribution for the (whole) model from which the marginals (e.g. Eq. On row 381-382) could be obtained using standard marginalisation techniques?</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007940.r002" article-type="author-comment">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007940.r002</article-id>
    <title-group>
      <article-title>Author response to Decision Letter 0</article-title>
    </title-group>
    <related-article id="rel-obj002" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007940" related-article-type="editor-report"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="author-response-date">16 Mar 2020</named-content>
    </p>
    <supplementary-material content-type="local-data" id="pcbi.1007940.s014">
      <label>Attachment</label>
      <caption>
        <p>Submitted filename: <named-content content-type="submitted-filename">Responses to Reviewers.pdf</named-content></p>
      </caption>
      <media xlink:href="pcbi.1007940.s014.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </body>
</sub-article>
<sub-article id="pcbi.1007940.r003" article-type="aggregated-review-documents">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007940.r003</article-id>
    <title-group>
      <article-title>Decision Letter 1</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leslie</surname>
          <given-names>Christina S.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Noble, Leslie</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Noble, Leslie</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj003" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007940" related-article-type="reviewed-article"/>
    <custom-meta-group>
      <custom-meta>
        <meta-name>Submission Version</meta-name>
        <meta-value>1</meta-value>
      </custom-meta>
    </custom-meta-group>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">11 May 2020</named-content>
    </p>
    <p>Dear Dr. Kim,</p>
    <p>We are pleased to inform you that your manuscript 'Learning Gene Networks Underlying Clinical Phenotypes Using SNP Perturbation' has been provisionally accepted for publication in PLOS Computational Biology.</p>
    <p>Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.</p>
    <p>Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.</p>
    <p>IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.</p>
    <p>Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.</p>
    <p>Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. </p>
    <p>Best regards,</p>
    <p>Christina S. Leslie</p>
    <p>Associate Editor</p>
    <p>PLOS Computational Biology</p>
    <p>William Noble</p>
    <p>Deputy Editor</p>
    <p>PLOS Computational Biology</p>
    <p>***********************************************************</p>
    <p>Reviewer's Responses to Questions</p>
    <p>
      <bold>Comments to the Authors:</bold>
    </p>
    <p>
      <bold>Please note here if the review is uploaded as an attachment.</bold>
    </p>
    <p>Reviewer #1: The authors have addressed my comments.</p>
    <p>Reviewer #2: The authors have addressed all my comments. (Upon rereading my previous comments I noticed a typo in one of my comments, but authors had appropriately addressed the comment anyways.)</p>
    <p>**********</p>
    <p>
      <bold>Have all data underlying the figures and results presented in the manuscript been provided?</bold>
    </p>
    <p>Large-scale datasets should be made available via a public repository as described in the <italic>PLOS Computational Biology</italic>
<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/ploscompbiol/s/data-availability">data availability policy</ext-link>, and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.</p>
    <p>Reviewer #1: Yes</p>
    <p>Reviewer #2: Yes</p>
    <p>**********</p>
    <p>PLOS authors have the option to publish the peer review history of their article (<ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p>
    <p>If you choose “no”, your identity will remain anonymous but your review may still be made public.</p>
    <p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link ext-link-type="uri" xlink:href="https://www.plos.org/privacy-policy">Privacy Policy</ext-link>.</p>
    <p>Reviewer #1: No</p>
    <p>Reviewer #2: No</p>
  </body>
</sub-article>
<sub-article id="pcbi.1007940.r004" article-type="editor-report">
  <front-stub>
    <article-id pub-id-type="doi">10.1371/journal.pcbi.1007940.r004</article-id>
    <title-group>
      <article-title>Acceptance letter</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <role>Deputy Editor</role>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leslie</surname>
          <given-names>Christina S.</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <permissions>
      <copyright-statement>© 2020 Noble, Leslie</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Noble, Leslie</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <related-article id="rel-obj004" ext-link-type="doi" xlink:href="10.1371/journal.pcbi.1007940" related-article-type="reviewed-article"/>
  </front-stub>
  <body>
    <p>
      <named-content content-type="letter-date">6 Oct 2020</named-content>
    </p>
    <p>PCOMPBIOL-D-19-01547R1 </p>
    <p>Learning Gene Networks Underlying Clinical Phenotypes Using SNP Perturbation</p>
    <p>Dear Dr Kim,</p>
    <p>I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.</p>
    <p>The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript. </p>
    <p>Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.</p>
    <p>Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work! </p>
    <p>With kind regards,</p>
    <p>Sarah Hammond</p>
    <p>PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom <email>ploscompbiol@plos.org</email> | Phone +44 (0) 1223-442824 | <ext-link ext-link-type="uri" xlink:href="http://ploscompbiol.org">ploscompbiol.org</ext-link> | @PLOSCompBiol</p>
  </body>
</sub-article>
