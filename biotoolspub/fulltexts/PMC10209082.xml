<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10209082</article-id>
    <article-id pub-id-type="pmid">37225726</article-id>
    <article-id pub-id-type="publisher-id">35296</article-id>
    <article-id pub-id-type="doi">10.1038/s41598-023-35296-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Prediction of protein subplastid localization and origin with PlastoGram</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Sidorczuk</surname>
          <given-names>Katarzyna</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gagat</surname>
          <given-names>Przemysław</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kała</surname>
          <given-names>Jakub</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nielsen</surname>
          <given-names>Henrik</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pietluch</surname>
          <given-names>Filip</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mackiewicz</surname>
          <given-names>Paweł</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Burdukiewicz</surname>
          <given-names>Michał</given-names>
        </name>
        <address>
          <email>michalburdukiewicz@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.8505.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 1010 5103</institution-id><institution>Faculty of Biotechnology, </institution><institution>University of Wrocław, </institution></institution-wrap>50-383 Wrocław, Poland </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.1035.7</institution-id><institution-id institution-id-type="ISNI">0000000099214842</institution-id><institution>Faculty of Mathematics and Information Science, </institution><institution>Warsaw University of Technology, </institution></institution-wrap>00-662 Warsaw, Poland </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.5170.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2181 8870</institution-id><institution>Department of Health Technology, </institution><institution>Technical University of Denmark, </institution></institution-wrap>2800 Kgs. Lyngby, Denmark </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.7080.f</institution-id><institution-id institution-id-type="ISNI">0000 0001 2296 0625</institution-id><institution>Institute of Biotechnology and Biomedicine, </institution><institution>Autonomous University of Barcelona, </institution></institution-wrap>08193 Cerdanyola del Vallés, Spain </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.48324.39</institution-id><institution-id institution-id-type="ISNI">0000000122482838</institution-id><institution>Clinical Research Centre, </institution><institution>Medical University of Białystok, </institution></institution-wrap>15-089 Białystok, Poland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>8365</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Due to their complex history, plastids possess proteins encoded in the nuclear and plastid genome. Moreover, these proteins localize to various subplastid compartments. Since protein localization is associated with its function, prediction of subplastid localization is one of the most important steps in plastid protein annotation, providing insight into their potential function. Therefore, we create a novel manually curated data set of plastid proteins and build an ensemble model for prediction of protein subplastid localization. Moreover, we discuss problems associated with the task, e.g. data set sizes and homology reduction. PlastoGram classifies proteins as nuclear- or plastid-encoded and predicts their localization considering: envelope, stroma, thylakoid membrane or thylakoid lumen; for the latter, the import pathway is also predicted. We also provide an additional function to differentiate nuclear-encoded inner and outer membrane proteins. PlastoGram is available as a web server at <ext-link ext-link-type="uri" xlink:href="https://biogenies.info/PlastoGram">https://biogenies.info/PlastoGram</ext-link> and as an R package at <ext-link ext-link-type="uri" xlink:href="https://github.com/BioGenies/PlastoGram">https://github.com/BioGenies/PlastoGram</ext-link>. The code used for described analyses is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/BioGenies/PlastoGram-analysis">https://github.com/BioGenies/PlastoGram-analysis</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Computational platforms and environments</kwd>
      <kwd>Machine learning</kwd>
      <kwd>Protein analysis</kwd>
      <kwd>Software</kwd>
      <kwd>Computational biology and bioinformatics</kwd>
      <kwd>Plant sciences</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004281</institution-id>
            <institution>Narodowe Centrum Nauki</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2018/31/N/NZ2/01338</award-id>
        <award-id>2017/26/D/NZ8/00444</award-id>
        <award-id>2019/35/N/NZ8/03366</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sidorczuk</surname>
            <given-names>Katarzyna</given-names>
          </name>
          <name>
            <surname>Gagat</surname>
            <given-names>Przemysław</given-names>
          </name>
          <name>
            <surname>Pietluch</surname>
            <given-names>Filip</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>European Union-NextGenerationEU</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© Springer Nature Limited 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">Plastids play an essential role in sustaining life on Earth. Using CO<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$_2$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow/><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="41598_2023_35296_Article_IEq1.gif"/></alternatives></inline-formula> and light in the process of photosynthesis, they produce energy to synthesize carbohydrates, fatty acids and amino acids, as well as oxygen – a byproduct of the reaction. The most well-known type of plastids is the chloroplast, i.e., the photosynthetic organelle of green plants. The relevance of chloroplast capabilities and efficiency makes them promising subjects for bioengineering in search of answers to the biggest challenges of our century<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Specifically, chloroplasts have been successfully used as environmental sensors for biomolecules, for the production of biopharmaceuticals, e.g. edible vaccines, in synthetic biology to design new biomaterials, and have the potential to satisfy the demand for increased food production<sup><xref ref-type="bibr" rid="CR2">2</xref></sup>.</p>
    <p id="Par3">Chloroplasts are bounded by the envelope (E) composed of the outer and inner membrane (OM and IM) separated by the intermembrane space. The envelope encloses the stroma (S), i.e. an aqueous compartment filling the organelle, and the thylakoids. Thylakoid membranes (TM) contain photosystems responsible for the light-dependent phase of photosynthesis and enclose the thylakoid lumen (TL), another aqueous compartment<sup><xref ref-type="bibr" rid="CR3">3</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Thylakoid membranes also give origin to plastoglobules, which are spherical lipoprotein complexes containing enzymes and structural proteins. They are considered a separate chloroplast compartment but remain physically coupled to thylakoids<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>.</p>
    <p id="Par4">Plastid genomes are highly reduced and encode only about 100 proteins. The majority of proteins required for their proper functioning are encoded in the nuclear genome. It is estimated that 2000-3000 proteins synthesized in the cytosol have to be imported into the chloroplast<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Targeting of proteins into their final location occurs thanks to the presence of specific signals within protein sequences. For many chloroplast proteins, such features have been identified, revealing a vast variety of targeting signals (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>). However, some of the signals may be characteristic of only a single protein e.g., the bipartite presequence of Toc75<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, or specific groups of proteins e.g., signal-anchored proteins of OM<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. They also depend on the origin of protein (plastid- or nuclear-encoded), e.g. nuclear-encoded proteins possess transit peptides responsible for their import via the plastid envelope. However, the exact import mechanism has been studied only for a fraction of proteins, so many targeting signals and pathways may still be unknown.<fig id="Fig1"><label>Figure 1</label><caption><p>Schematic representation of a plastid structure and plastid protein import. The compartments of plastids considered in this study include the outer (OM) and inner membrane (IM), which together are termed as the envelope (E), stroma (S), thylakoid membrane (TM) and thylakoid lumen (TL) (<bold>a</bold>). Nuclear-encoded proteins are synthesised outside the plastid, in the cytosol, with an N-terminal transit peptide responsible for their targeting to this organelle. They are imported to OM, IM, TM, TL or S. Plastid-encoded proteins are synthesised in the stroma and subsequently transported to IM, TM, or remain in the stroma (<bold>b</bold>).</p></caption><graphic xlink:href="41598_2023_35296_Fig1_HTML" id="MO2"/></fig></p>
    <p id="Par5">The fact that protein location is tightly associated with its function makes the prediction of their suborganellar localization very desirable. It is reflected by the number of software created for the prediction of subchloroplast location<sup><xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR17">17</xref></sup>, recently reviewed by Liu et al.<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. The first programs were designed to differentiate only between four compartments and trained on very small data sets (Table <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="MOESM1" ref-type="media">S1</xref>). Over the years, the number of available plastid sequences have increased, leading to the development of models differentiating between more locations and accounting for the fact that some proteins may be located in more than one subplastid compartment. The first multi-label algorithm was published in 2015 and introduced plastoglobule as another location (Table <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="MOESM1" ref-type="media">S1</xref>). Noteworthy, only one of the currently available programs, SChloro, can differentiate between six subplastid compartments, i.e. additionally classifies envelope proteins into those located in IM and OM. It is also the only software with architecture influenced by biological properties of proteins, e.g., the presence of a transit peptide or membrane interaction.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Homology reduction methods and numbers of sequences used by available software. Abbreviations: HR - homology reduction, HP - homology partitioning, TM - thylakoid membrane, TL - thylakoid lumen, IM - inner membrane, OM - outer membrane. *Authors report that the threshold was set to 25% but they use data from MultiP-Schlo created with 40% cutoff.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Software</th><th align="left">Year</th><th align="left">Homology reduction strategy (cutoff)</th><th align="left">Final number of sequences</th><th align="left">Envelope</th><th align="left">Stroma</th><th align="left">TM</th><th align="left">TL</th><th align="left">Plastoglobule</th></tr></thead><tbody><tr><td align="left">SubChlo</td><td align="left">2009</td><td align="left">CD-HIT HR (60%)</td><td align="left">262</td><td align="left">40</td><td align="left">49</td><td align="left">129</td><td align="left">44</td><td align="left">-</td></tr><tr><td align="left">ChloroRF</td><td align="left">2010</td><td align="left">CD-HIT HR (60%)</td><td align="left">261</td><td align="left">40</td><td align="left">49</td><td align="left">128</td><td align="left">44</td><td align="left">-</td></tr><tr><td align="left">SubIdent</td><td align="left">2011</td><td align="left">CD-HIT HR (60%)</td><td align="left">262</td><td align="left">40</td><td align="left">49</td><td align="left">129</td><td align="left">44</td><td align="left">-</td></tr><tr><td align="left">BS-KNN</td><td align="left">2012</td><td align="left">CD-HIT HR (60%)</td><td align="left">253</td><td align="left">40</td><td align="left">46</td><td align="left">127</td><td align="left">40</td><td align="left">-</td></tr><tr><td align="left">ChloPred</td><td align="left">2013</td><td align="left">PISCES HR (25%)</td><td align="left">259</td><td align="left">77</td><td align="left">60</td><td align="left">103</td><td align="left">19</td><td align="left">-</td></tr><tr><td align="left">SCLAP</td><td align="left">2013</td><td align="left">PISCES HR (60%)</td><td align="left">341</td><td align="left">118</td><td align="left">72</td><td align="left">111</td><td align="left">41</td><td align="left">-</td></tr><tr><td align="left">WS-LCHI</td><td align="left">2014</td><td align="left">CD-HIT HR (60%)</td><td align="left">262</td><td align="left">40</td><td align="left">49</td><td align="left">129</td><td align="left">44</td><td align="left">-</td></tr><tr><td align="left">MultiP-Schlo</td><td align="left">2015</td><td align="left">CD-HIT HR (40%)</td><td align="left">578</td><td align="left">199</td><td align="left">105</td><td align="left">233</td><td align="left">34</td><td align="left">30</td></tr><tr><td align="left">LNP-Chlo</td><td align="left">2016</td><td align="left">CD-HIT HR (40%*)</td><td align="left">578</td><td align="left">199</td><td align="left">105</td><td align="left">233</td><td align="left">34</td><td align="left">30</td></tr><tr><td align="left">SChloro</td><td align="left">2016</td><td align="left">HP with PSI-BLAST</td><td align="left">367</td><td align="left">71 (47 IM, 24 OM)</td><td align="left">119</td><td align="left">131</td><td align="left">37</td><td align="left">32</td></tr><tr><td align="left">EnTrans-Chlo</td><td align="left">2017</td><td align="left">CD-HIT HR (40%*)</td><td align="left">578</td><td align="left">199</td><td align="left">105</td><td align="left">233</td><td align="left">34</td><td align="left">30</td></tr><tr><td align="left">Bankapur &amp;Patil</td><td align="left">2022</td><td align="left">CD-HIT HR (40%)</td><td align="left">578</td><td align="left">199</td><td align="left">105</td><td align="left">233</td><td align="left">34</td><td align="left">30</td></tr></tbody></table></table-wrap></p>
    <p id="Par6">Given a limited number of available sequences, addressing the issue of sequence homology is an essential step in creating a model for subplastid localization. There are two frequently used methods: homology reduction and homology partitioning. The former ensures that no pair of sequences shares identity higher than a given threshold, whereas the latter clusters sequences in a way that their identity percent to sequences in other clusters is lower than a predefined threshold. Homology reduction with 60% identity threshold was applied for data sets used to train all single-label algorithms except ChloPred. The latter employed a 25% cutoff resulting in only 19 proteins in the TL class. The majority of multi-label models were trained on data sets with a maximum of 40% identity. Only one algorithm, SChloro, used a different strategy and utilized homology partitioning to ensure that sequences with local similarity are found in the same set in cross-validation to avoid bias. In all cases, the number of sequences in the most underrepresented class varied from 19 to 40. Consequently, it is worth considering if a model trained on such a small number of sequences can yield reliable predictions, especially taking into account that most algorithms were evaluated using only k-fold cross-validation (CV) or leave-one-out cross-validation (LOOCV) (Table <xref rid="MOESM1" ref-type="media">S1</xref>). Moreover, in some cases (e.g. LNP-Chlo and EnTrans-Chlo), independent data sets used to evaluate algorithms were not subject to homology reduction due to the small number of sequences, which also questions the credibility of their predictions.</p>
    <p id="Par7">In this project, we wanted to use the increased number of plastid sequences and investigate if it is feasible to create a reliable model with the available data. First, we created a novel manually curated data set of plastid proteins. We focused on biological insights and targeting signals that could increase the model accuracy, i.e. the information if a protein is nuclear- or plastid-encoded and their import pathways. In our opinion, there is still too little data to build a robust multi-label model. Therefore, we focused on predicting one most probable location and additional information about the analysed protein, i.e., its origin and import pathway for TL proteins. The latter may suggest functional or structural properties, e.g., Tat substrates are transported in a folded conformation and might contain cofactors<sup><xref ref-type="bibr" rid="CR19">19</xref>,<xref ref-type="bibr" rid="CR20">20</xref></sup>.</p>
    <p id="Par8">The result of our research is PlastoGram, an algorithm that allows differentiation of plastid proteins between four compartments (E, S, TL, TM), predicts sequence origin (plastid- or nuclear-encoded) and determines the import pathway for TL proteins. We also discuss problems associated with the prediction of subplastid localization, such as data set sizes, homology reduction and reliability of these predictions. Finally, we suggest directions for future studies, which along with the increase in sequence number and knowledge about mechanisms of protein import could further improve the prediction of subplastid localization.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Data sets</title>
      <p id="Par9">To create data sets of sequences corresponding to compartments of photosynthetic plastids, we searched the UniProt database for proteins annotated as localized in the chloroplast. Importantly, the UniProt keyword ’Chloroplast’ includes not only chloroplasts of green algae and land plants but also plastids of <italic>Rhodophyta</italic>, haptophytes and the SAR supergroup<sup><xref ref-type="bibr" rid="CR21">21</xref></sup>. Therefore, we use the term subplastid localization for sequences of chloroplasts and other types of photosynthetic plastids.</p>
      <p id="Par10">We searched for proteins localized in TL, TM, IM, OM and stroma. For each location, we used separate queries to obtain nuclear- and plastid-encoded proteins. This division is motivated by the fact that protein origin determines its route to the final location, which is reflected in different targeting signals (Fig. <xref rid="MOESM1" ref-type="media">S1</xref>). We downloaded sequences and their annotations from UniProt release 2021_01<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> using queries provided in Table <xref rid="MOESM1" ref-type="media">S2</xref>. We obtained 6198 proteins from chloroplasts of land plants and green algae as well as 746 proteins from other photosynthetic plastids.</p>
      <p id="Par11">We noticed a few mistakes in the annotations concerning the sequence origin, i.e., Toc34 and Toc64 proteins of <italic>Pisum sativum</italic> described as encoded in the plastid genome though they are nuclear-encoded<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>. The list of incorrectly annotated proteins has been reported to UniProt (see <xref rid="MOESM1" ref-type="media">Supplementary Methods</xref>). We also observed that proteins reported as peripheral membrane proteins in the original articles are sometimes annotated only as membrane proteins in the same way as integral ones. Considering these issues, we manually curated all downloaded sequences and their annotations to ensure the correctness of our data sets. We discarded fragmented sequences, proteins localized in more than one compartment, nuclear-encoded proteins after processing (lacking transit peptides), and those for which we could not find localization evidence in the literature. We also eliminated proteins that localize to plastids and other organelles because due to the scarcity of available data it would introduce too much noise. We grouped peripheral membrane proteins with others localizing in the same aqueous compartments as they are not permanently attached to the membrane. We also decided to exclude a group of 19 plastid-encoded TL proteins because of the insufficient number of sequences and taxonomic representation (only species of rhodophytes and cryptophytes). We did not include plastoglobule as a separate location because there are only 33 plastoglobule proteins identified<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Moreover, most of them are also present in other compartments, which is expected considering that plastoglobules originate from thylakoids<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Table with accessions, curated locations and references is available in the <xref rid="MOESM2" ref-type="media">Supplementary File</xref>.</p>
      <p id="Par12">To create final data sets, we separated the thylakoid lumen proteins into two classes according to their import pathway, i.e. Sec or Tat, because each route is associated with the presence of specific, well-characterized targeting signals<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Then, we performed additional filtering to prepare data sets for model training. We removed sequences containing amino acids other than standard and reduced the homology of each class-specific data set with CD-HIT<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> applying the 90% identity threshold and word length 2. The high cutoff value is motivated by the fact that information about protein homology is an important factor in the prediction of subplastid localization. Recent programs utilize this information by performing homology search with, e.g., PSI-BLAST and using obtained PSSMs which hold information about homologous proteins<sup><xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR17">17</xref></sup>. In contrast, we decided to retain more sequences to keep some level of homology information in our data set while still removing the most similar sequences.</p>
      <p id="Par13">We created two versions of data sets depending on how we divided sequences between the train-test and independent sets. In the first approach (holdout version), we randomly extracted 15% of sequences from each class to create an independent data set for future benchmarking. The rest of the sequences were used in the cross-validation to select the best-performing ensemble (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). In the second approach (partitioning version), following the homology reduction, we applied homology partitioning to ensure that independent and train-test data sets do not contain sequences with identity percent above a given threshold. To do that, we have followed the procedure described elsewhere <sup><xref ref-type="bibr" rid="CR24">24</xref></sup> with a 40% cutoff, 85%/15% ratio of validation/train-test data sets and without moving between clusters option (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). This option disables the relocation of sequences to another partition if there are other sequences within a specified threshold, thus limiting the imbalance between partitions in the case of highly homologous data sets such as plastid proteins. The numbers of sequences at each step are provided in Table <xref rid="Tab2" ref-type="table">2</xref>. We calculated mean pairwise identity percent between train-test and independent data sets for all classes (Table <xref rid="MOESM1" ref-type="media">S3</xref>) using the Needleman-Wunsch alignment algorithm implemented in needle<sup><xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR26">26</xref></sup>.<fig id="Fig2"><label>Figure 2</label><caption><p>The overall workflow of the best-performing ensemble selection. First, we generated two versions of data sets that differ in the strategy of division between train-test and independent sets. We start with different types of lower-level models designed to deal with specific labeling problems and use them to create model sets. Each set consists of: (i) all base models, (ii) one or both of Sec and Tat models, (iii) none or one of N_TL and TL models, (iv) N_E vs. N_TM model or two class-specific models for prediction of nuclear-encoded membrane proteins, (v) none or one of stroma model, N_S and P_S models, N_E vs. N_S model, (vi) any number of additional models. Next, we built ensembles by combining a set of lower-level models with a higher-level model (random forest or multinomial log-linear model) and specifying information flow between lower-level models (see the Stacked model subsection for details). All ensembles were evaluated in fivefold cross-validation repeated five times on both versions of train-test data sets. The higher-level models were trained on prediction results for folds used to train lower-level models and evaluated on predictions from a test fold. Performance measures were calculated for each fold and replication and then averaged over folds and replications to obtain mean values for each ensemble and data set version. The ensemble that achieved the highest mean kappa value in CV was selected as the final PlastoGram model. Additionally, we provide a separate function to further divide proteins predicted as nuclear-encoded and localized to the envelope into the OM and IM classes. Abbreviations as in Table <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="MOESM1" ref-type="media">S4</xref>.</p></caption><graphic xlink:href="41598_2023_35296_Fig2_HTML" id="MO3"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Numbers of sequences in each class at each step of data set preparation. Filtering indicates homology reduction with CD-HIT and removal of sequences with non-standard amino acids, which was performed before the division into two versions of the train-test and independent data sets.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Localization, origin</th><th align="left" rowspan="2">Dataset</th><th align="left" rowspan="2">Before filtering</th><th align="left" rowspan="2">After filtering</th><th align="left" colspan="2">Holdout version</th><th align="left" colspan="2">Partitioning version</th></tr><tr><th align="left">Train-test</th><th align="left">Independent</th><th align="left">Train-test</th><th align="left">Independent</th></tr></thead><tbody><tr><td align="left">Envelope, nuclear-encoded</td><td align="left">N_E</td><td align="left">118 (59 IM, 59 OM)</td><td align="left">115 (59 IM, 56 OM)</td><td align="left">98 (50 IM, 48 OM)</td><td align="left">17 (9 IM, 8 OM)</td><td align="left">96 (50 IM, 46 OM)</td><td align="left">10 (6 IM, 4 OM)</td></tr><tr><td align="left">Thylakoid membrane, nuclear-encoded</td><td align="left">N_TM</td><td align="left">276</td><td align="left">222</td><td align="left">189</td><td align="left">33</td><td align="left">192</td><td align="left">30</td></tr><tr><td align="left">Stroma, nuclear-encoded</td><td align="left">N_S</td><td align="left">357</td><td align="left">340</td><td align="left">289</td><td align="left">51</td><td align="left">287</td><td align="left">53</td></tr><tr><td align="left">Thylakoid lumen, nuclear-encoded(imported via Sec pathway)</td><td align="left">N_TL_SEC</td><td align="left">49</td><td align="left">43</td><td align="left">37</td><td align="left">6</td><td align="left">37</td><td align="left">4</td></tr><tr><td align="left">Thylakoid lumen, nuclear-encoded (imported via Tat pathway)</td><td align="left">N_TL_TAT</td><td align="left">84</td><td align="left">79</td><td align="left">67</td><td align="left">12</td><td align="left">67</td><td align="left">6</td></tr><tr><td align="left">Inner membrane, plastid-encoded</td><td align="left">P_IM</td><td align="left">187</td><td align="left">128</td><td align="left">109</td><td align="left">19</td><td align="left">106</td><td align="left">11</td></tr><tr><td align="left">Thylakoid membrane, plastid-encoded</td><td align="left">P_TM</td><td align="left">4456</td><td align="left">1237</td><td align="left">1051</td><td align="left">186</td><td align="left">1073</td><td align="left">156</td></tr><tr><td align="left">Stroma, plastid-encoded</td><td align="left">P_S</td><td align="left">1417</td><td align="left">419</td><td align="left">356</td><td align="left">63</td><td align="left">360</td><td align="left">42</td></tr><tr><td align="left">Total number of sequences</td><td align="left">-</td><td align="left">6944</td><td align="left">2583</td><td align="left">2196</td><td align="left">387</td><td align="left">2218</td><td align="left">312</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec4">
      <title>Prediction of subplastid localization</title>
      <sec id="Sec5">
        <title>Considered models</title>
        <p id="Par14">First, we created a simple multiclass random forest model to use it as a baseline for comparison with more complex ensembles. Baseline was trained to differentiate between all classes at once. We used the random forest algorithm because of its robustness and internal regularization. Moreover, it has been recently shown to outperform deep learning on tabular data<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>. This model was trained without tuning using n-gram presence/absence matrix as a sequence feature representation. N-grams are short amino acid motifs and may be continuous or with gaps, where gap means any amino acid. We used n-grams of lengths from 1 to 3. For those of length 2, we considered gaps ranging from 1 to 3, whereas for n-grams of length 3, only gaps of length 1 were allowed.</p>
        <p id="Par15">Next, we built separate machine learning models for each labeling problem. The list of considered models with the data subset used for their training is provided in Table <xref rid="MOESM1" ref-type="media">S4</xref>. We trained both general models, such as for prediction of sequence origin (Nuclear model) or membrane proteins (Membrane model), as well as class-specific models, e.g. Plastid membrane model for discrimination between plastid-encoded TM and IM proteins.</p>
        <p id="Par16">For the prediction of all locations except TL, we used random forest models based on n-grams. Sequence features were represented in a form of n-gram presence/absence matrix. We extracted n-grams of the same length as in the baseline model. Then, we used the quick permutation test (QuiPT)<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> with a <italic>p</italic>-value cutoff 0.01 for feature selection. Such threshold allowed removal of the insignificant n-grams while keeping sufficiently large feature space for random forest training. The most informative n-grams were then used to build machine learning models using the random forest algorithm from the ranger R package<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. The numbers of informative n-grams used to train each model are listed in Table <xref rid="MOESM1" ref-type="media">S5</xref> and overlap in features used by holdout and partitioning versions of the same model is shown in Fig. <xref rid="MOESM1" ref-type="media">S2</xref>. Models trained to diffrentiate between N_E and others, N_TM and others, as well as identifying TM were also tested in a setting with SMOTE algorithm to balance the classes. We performed only over-sampling of the minority class in the training set using the SmoteClassif function from the UBL R package<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>.</p>
        <p id="Par17">To build profile HMM models, we aligned sequences from the Sec and Tat data sets with MAFFT<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> using the most accurate L-INS-i method. Then, we applied the hmmbuild function from HMMER 3.3 software<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> to generate HMM profiles of Sec and Tat signals.</p>
      </sec>
      <sec id="Sec6">
        <title>Stacked model</title>
        <p id="Par18">Our prediction algorithm is a collection of diverse models dedicated to solve a specific labelling problem (a combination of subplastid localization and the origin of a protein). It consists of lower-level models, i.e., random forests and profile HMMs, each designed to answer a specific question, as well as a higher-order model. Such an approach is a type of ensemble learning called model stacking<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>. The idea behind ensemble learning is that the aggregation of predictions from multiple models outperforms the individuals.</p>
        <p id="Par19">Given a set of models (either classifiers or regression models) <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathscr {S}=\{S_1, S_2, \dots , S_n \}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="script">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2023_35296_Article_IEq2.gif"/></alternatives></inline-formula>, that can be extended by transformations like PCA or identity (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(x) = x$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2023_35296_Article_IEq3.gif"/></alternatives></inline-formula>), and an aggregation function <italic>G</italic>, an ensemble model is a pair <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\mathscr {S}, G)$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41598_2023_35296_Article_IEq4.gif"/></alternatives></inline-formula> defined such that each prediction can be defined as:<disp-formula id="Equ1"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{y} = (G, \mathscr {S})~(x) = G(S_1(x), S_2(x), \dots , S_n(x)),$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="3.33333pt"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="41598_2023_35296_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>x</italic> is an example, and <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{y} \in \mathbb {R}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2023_35296_Article_IEq5.gif"/></alternatives></inline-formula> for regression and <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{y} \in \mathbb {Z}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="41598_2023_35296_Article_IEq6.gif"/></alternatives></inline-formula> for classification tasks. Model stacking is a special case of an ensemble model, where the aggregation function <italic>G</italic> is a predictive model.</p>
        <p id="Par20">For each data set version, we tested 336 different variants of lower-level model sets. Then, we further diversified them using five main factors: (i) type of the model for the prediction of nuclear-encoded membrane proteins; (ii) presence of stromal- and thylakoid lumen-specific models; (iii) presence of additional models for the most problematic classes; (iv) presence of the HMM-based models; (v) utilization of SMOTE. We inspected all possible configurations of models within mentioned variants. It resulted in the generation of 18,600 sets of models representing combinations of these five factors (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>).</p>
        <p id="Par21">Additionally, we have tested two types of ensembles considering the presence of conditionally restricted models. Here, the conditionally restricted models are models where a protein, instead of being classified by all available models, is classified by the subset of the models based on decision rules derived from the expert knowledge. In other words, a protein is analysed by some models only if it fulfills certain conditions, i.e., is predicted by one of the other models as belonging to a specific class. For example, proteins predicted to be encoded in the nuclear genome are being further processed only by the subset of models for nuclear-encoded proteins.</p>
        <p id="Par22">We also considered two types of higher-level models, i.e., random forests and a multinomial log-linear model. We selected these algorithms because they do not need tuning, are relatively interpretable and have been previously used in model stacking<sup><xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR36">36</xref></sup>. We tested all combinations of ensemble and higher-level model types resulting in 74,400 considered ensembles for each data set version. We did not use model weights as it was the goal of the higher-level model to provide a final prediction based on the results from lower-level models. Due to the difficulty of predicting N_OM and N_IM classes as separate in the whole pipeline, we created an additional model for differentiating proteins predicted as nuclear-encoded and localized in the envelope (for details see Supplementary Methods and Table <xref rid="MOESM1" ref-type="media">S6</xref>).</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Validation and benchmark</title>
      <p id="Par23">To select the best ensemble, we performed a stratified fivefold CV using train-test part of each data set version (for details see Supplementary Methods). The fivefold CV procedure was repeated five times to ensure reliable accuracy estimates. We calculated mean values of kappa, average 1 vs. 1 multiclass AUC (AU1U) and class-specific accuracies (all measures are defined in Supplementary Methods). For the final model we selected the ensemble yielding the highest kappa, as it is a robust measure of the chance-corrected agreement<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p>
      <p id="Par24">The best-performing ensemble (hereafter termed PlastoGram) in each version was then trained on the whole train-test data set and evaluated using sequences from the independent set, which were not used in any earlier steps of the analysis. To assess the performance of our algorithm, we calculated kappa, AU1U and class-specific accuracies.</p>
      <p id="Par25">We compared the performance of PlastoGram with SChloro<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>, one of the latest multi-label programs, which was proven to outperform all algorithms created before its publication <sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. We were not able to perform benchmark with EnTransChlo<sup><xref ref-type="bibr" rid="CR15">15</xref></sup> and LNP-Chlo<sup><xref ref-type="bibr" rid="CR16">16</xref></sup> as their web servers seemed to experience technical problems when provided with multiple sequences, even though they should be able to handle up to 10 sequences at once. The web server of Bankapur &amp;Patil software<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> also seemed to accept only a single sequence because when provided with a multi-fasta query it returned a single prediction result. Moreover, none of these algorithms is available in a standalone version. We also did not compare our tool with a simple homology search, e.g. BLAST, because this approach has been shown previously to be outperformed by predictive models<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>.</p>
      <p id="Par26">We used the standalone version of SChloro with the current release of the UniProtKB/SwissProt (2022_01) database. We run predictions on both versions of the independent data set and evaluated results in terms of generalized classes: envelope, stroma, thylakoid membrane and thylakoid lumen to make the comparison possible. For example, if a protein was predicted to be OM or IM by SChloro, it was considered an envelope prediction. Similarly, in the case of PlastoGram, the envelope class was assigned to proteins predicted as N_E or P_IM. Moreover, as SChloro is a multi-label model, we considered a protein as properly predicted even if it was assigned to multiple locations, provided that one of them was the correct one.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results and discussion</title>
    <p id="Par27">PlastoGram for both data set versions (H–holdout, P–partitioning) had the same architecture. It consisted of eight lower-level models (see Table <xref rid="MOESM1" ref-type="media">S4</xref> or Fig. <xref rid="Fig2" ref-type="fig">2</xref> for details) and a random forest higher-level model. It yielded mean kappa 0.869 and AU1U 0.791 for the H version and mean kappa 0.875 and AU1U 0.800 for the P version in repeated cross-validation. Class-specific mean accuracies obtained by both versions of PlastoGram in CV are presented in Fig. <xref rid="MOESM1" ref-type="media">S3</xref> with the highest values for P_TM, P_IM, P_S, N_S, and the lowest for N_E. Statistical analysis using Kruskall-Wallis test confirmed consistency of the results obtained by both versions for all classes except N_E and N_TM (<italic>p</italic> = 0.0008 and <italic>p</italic> = 0.0184, respectively; Table <xref rid="MOESM1" ref-type="media">S9</xref>).</p>
    <p id="Par28">Investigation of the performance measure distribution for all ensembles and the naive baseline model in CV shows that there is indeed a necessity for more complex architecture to correctly predict some classes (Figs. <xref rid="MOESM1" ref-type="media">S4</xref>, Tables <xref rid="MOESM1" ref-type="media">S7</xref>–<xref rid="MOESM1" ref-type="media">S8</xref>). The high imbalance of the data set sizes causes the naive baseline models to obtain a high AU1U (H: 0.818, P: 0.822), which is associated with their ability to predict the most abundant classes; however, they completely fail for less frequent classes (0.03 accuracy for N_E in both versions). Differences in kappa, a more robust metric, show the actual gain from ensembles (baseline H: 0.229, PlastoGram H: 0.869 and baseline P: 0.241, PlastoGram P: 0.875).</p>
    <p id="Par29">On the independent data set, PlastoGram H achieves similar results with kappa 0.893 and accuracies over 0.9 for five classes (Table <xref rid="Tab3" ref-type="table">3</xref>). PlastoGram P performance decreases on the independent data when compared with CV. It yields kappa 0.530 and the accuracies of the least represented classes drop substantially. Such results are expected considering that the overall means of identity percent between the train-test and independent sets are 13.68% and 9.02% for holdout and partitioning versions, respectively. The mean identity percent between the train-test and independent data sets are lower in the partitioning version for all classes (Table <xref rid="MOESM1" ref-type="media">S3</xref>). Moreover, the partitioning version of the independent data set contained fewer sequences than the holdout, especially for N_TL_SEC, N_TL_TAT and N_E classes with only 4, 6 and 10 cases, respectively. Considering these numbers, it does not necessarily reflect the overall quality of the model predictions.<table-wrap id="Tab3"><label>Table 3</label><caption><p>Class-specific accuracies obtained in the independent test using 387 (holdout) and 312 (partitioning) sequences and mean values of class-specific accuracies with standard deviations from cross-validation. SD values were not calculated for kappa and AU1U. Abbreviations as in Table <xref rid="Tab2" ref-type="table">2</xref>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Measure</th><th align="left" colspan="3">Holdout version</th><th align="left" colspan="3">Partitioning version</th></tr><tr><th align="left">Independent</th><th align="left">Mean</th><th align="left">SD</th><th align="left">Independent</th><th align="left">Mean</th><th align="left">SD</th></tr></thead><tbody><tr><td align="left">kappa</td><td align="left">0.893</td><td align="left">0.869</td><td align="left">-</td><td align="left">0.530</td><td align="left">0.875</td><td align="left">-</td></tr><tr><td align="left">AU1U</td><td align="left">0.790</td><td align="left">0.791</td><td align="left">-</td><td align="left">0.699</td><td align="left">0.800</td><td align="left">-</td></tr><tr><td align="left">N_E accuracy</td><td align="left">0.235</td><td align="left">0.484</td><td align="left">0.114</td><td align="left">0.300</td><td align="left">0.348</td><td align="left">0.085</td></tr><tr><td align="left">N_TM accuracy</td><td align="left">0.727</td><td align="left">0.653</td><td align="left">0.059</td><td align="left">0.233</td><td align="left">0.710</td><td align="left">0.074</td></tr><tr><td align="left">N_S accuracy</td><td align="left">0.980</td><td align="left">0.915</td><td align="left">0.039</td><td align="left">0.736</td><td align="left">0.936</td><td align="left">0.035</td></tr><tr><td align="left">N_TL_SEC accuracy</td><td align="left">1.000</td><td align="left">0.644</td><td align="left">0.167</td><td align="left">0.000</td><td align="left">0.700</td><td align="left">0.150</td></tr><tr><td align="left">N_TL_TAT accuracy</td><td align="left">0.833</td><td align="left">0.707</td><td align="left">0.117</td><td align="left">0.333</td><td align="left">0.714</td><td align="left">0.099</td></tr><tr><td align="left">P_IM accuracy</td><td align="left">0.947</td><td align="left">0.969</td><td align="left">0.040</td><td align="left">0.818</td><td align="left">0.949</td><td align="left">0.049</td></tr><tr><td align="left">P_TM accuracy</td><td align="left">1.000</td><td align="left">0.997</td><td align="left">0.004</td><td align="left">0.981</td><td align="left">0.998</td><td align="left">0.003</td></tr><tr><td align="left">P_S accuracy</td><td align="left">0.952</td><td align="left">0.940</td><td align="left">0.032</td><td align="left">0.071</td><td align="left">0.944</td><td align="left">0.021</td></tr></tbody></table></table-wrap></p>
    <p id="Par30">These results show that with the available number of sequences it is difficult to create a reliable model that would predict all localizations well. Considering the high sequence similarity between plastid proteins, generally accepted identity thresholds for homology reduction reduce some classes to much less than 50 sequences. The necessity of creating an independent data set reduces the number of sequences that can be used for training even more. It makes the prediction of subplastid localization particularly challenging for deep learning. The ability of neural networks to generalize on small data sets has been demonstrated with tabular but not sequence data<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. Another difficulty for deep learning methods is the sequence length distribution of plastid proteins with the shortest proteins of length below 50 amino acids (e.g., components of photosystem reaction centers, such as psbK, psaJ, psbN, psbF) and the longest with over 1500 amino acids (e.g., translocon component Tic214 and ferredoxin-dependent glutamate synthase).</p>
    <p id="Par31">The best performance is generally achieved for all plastid-encoded proteins with the majority of accuracies in CV and the independent test over 0.94, in some cases even approaching 1 (Table <xref rid="Tab3" ref-type="table">3</xref>). It is probably not only due to a large number of available plastid sequences but also the distinct differences in the amino acid composition of plastid- and nuclear-encoded proteins<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>. Moreover, plastid-encoded proteins localize to fewer possible compartments and possess less complex targeting signals. All these features indeed result in more accurate prediction of localization for plastid-encoded proteins.</p>
    <p id="Par32">The lowest accuracy is generally obtained for nuclear-encoded envelope proteins. We observed that many of these proteins are incorrectly classified as nuclear-encoded stromal proteins. We performed the principal component analysis of the protein amino acid composition to find the possible cause of these incorrect predictions (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). It shows that generally, plastid-encoded proteins form more separated clusters, whereas most of the nuclear-encoded proteins overlap. Interestingly, N_S and N_OM proteins overlap almost completely. Further investigation of physicochemical properties of the nuclear-encoded membrane and stromal proteins revealed that they are all similar in terms of net charge, hydrophobicity and polarity (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). Noteworthy, there are no statistically significant differences between distributions of these property values for stromal and outer membrane proteins (Table <xref rid="MOESM1" ref-type="media">S8</xref>).<fig id="Fig3"><label>Figure 3</label><caption><p>Principal component analysis of the amino acid composition of peptides in each class (<bold>a</bold>). Generally, plastid-encoded proteins form more separated clusters, whereas most of the nuclear-encoded proteins overlap. Noteworthy, the clusters of N_OM and N_S proteins overlap almost completely. Distribution of selected physicochemical properties for nuclear-encoded membrane and stromal proteins in the train-test data set (<bold>b</bold>). OM and stromal proteins follow very similar distribution of all the three properties. IM proteins are characterized by slightly higher net charge and are diverse in terms of mean hydrophobicity and polarity. TM proteins are generally more hydrophobic and less polar than OM and stromal proteins. Abbreviations as in Table <xref rid="Tab2" ref-type="table">2</xref>.</p></caption><graphic xlink:href="41598_2023_35296_Fig3_HTML" id="MO4"/></fig></p>
    <p id="Par33">To check if n-grams capture any known motifs, we analysed the decision rules of n-gram models. Many of the targeting signals of plastid proteins are still unknown, but there are a few described characteristics. One is the DPLG motif found in thylakoid membrane proteins of the light-harvesting chlorophyll-binding protein (LHCP) family<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. This motif is essential for the interaction of LHCPs with one of the SRP subunits (cpSRP43) and consequently for their import<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>. As LHCPs are nuclear-encoded, we searched for n-grams that are contained within the DPLG motif in the features with the highest Gini importance for Nuclear_membrane model of the PlastoGram P. Out of 4443 informative n-grams used to train this model 13 match the DPLG motif. Moreover, four of them, i.e. DP_G, PLG, D_LG and D_ _G, are among the 50 most important n-grams (Fig. <xref rid="MOESM1" ref-type="media">S5</xref>). It suggests that n-grams do capture known sequence features and may provide further insights into the process of protein import.</p>
    <p id="Par34">We compared the performance of PlastoGram with SChloro, one of the latest software, on our independent data set. The benchmark results are presented in Fig. <xref rid="MOESM1" ref-type="media">S6</xref> and show that PlastoGram outperforms SChloro in all generalized classes except envelope though some of these sequences could have been used in SChloro training. However, it should be noted that SChloro was trained to predict peripheral proteins as located in the membrane, unlike our approach, which might have affected benchmark results to some extent. Interestingly, SChloro seems to exhibit the opposite bias than PlastoGram in the case of envelope proteins. We noticed that many stromal proteins were predicted by SChloro as located in the outer membrane (considered with IM as envelope class in our benchmark). It shows that the issue of high similarity between nuclear-encoded stromal and outer membrane proteins should be considered in future attempts at the prediction of subplastid localization.</p>
    <p id="Par35">Another issue with currently available software is its availability and ability to process large numbers of sequences. Although most of the recently developed algorithms have dedicated web servers, they usually do not allow the analysis of many sequences at once. Moreover, only three of the programs are available in a standalone version. To address this problem, we made PlastoGram accessible as an R package from GitHub, making it easy to implement as a part of the analysis pipelines. It is also available as a web server, which accepts queries up to 50 sequences at once. It is an improvement over EnTransChlo and LNP-Chlo, which allow analyses of up to 10 proteins, and SChloro and Bankapur &amp;Patil, accepting only a single sequence. Another advantage of our tool is its speed, as it does not require the calculation of position specific scoring matrices. Moreover, it introduces means to predict sequence origin and import pathways for thylakoid lumen proteins.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusion</title>
    <p id="Par36">Our results show that with the currently available sequences we still cannot predict all possible subplastid localizations well, especially IM and OM. We provide a novel manually-curated data set of plastid proteins for future studies while acknowledging that the low number of sequences for some classes not only makes model training challenging but also renders its proper evaluation difficult as it may result in overly optimistic assessment of the performance, especially in the case of holdout version.</p>
    <p id="Par37">Nevertheless, we propose the algorithm developed during this study as an improvement over the existing methods. PlastoGram classifies a protein as nuclear- or plastid-encoded and predicts its most probable localization considering envelope, stroma, thylakoid membrane or thylakoid lumen. For the latter, also the import pathway (Sec or Tat) is predicted. We provided an additional function to differentiate nuclear-encoded inner and outer membrane proteins and made PlastoGram easy to use in different settings, both as a web server and an R package. We implemented both model versions described in the study. Similar to previously published tools, PlastoGram is dedicated to work exclusively on plastid proteins. We did not try to include a step of prediction if a protein localizes to plastids because excellent tools for prediction of subcellular localization already exist, e.g. TargetP<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> or DeepLoc<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. Therefore, using PlastoGram for genome annotation requires conjunction with subcellular localization predictors. Considering the already mentioned issues with available software, we believe that PlastoGram offers a lot of new possibilities in the field of plastid protein annotation.</p>
    <p id="Par38">However, there is still room for improvement in the future. New well-annotated sequences (mainly nuclear-encoded), more detailed information about protein targeting signals and novel feature selection techniques should improve the prediction of the most difficult classes, especially the differentiation of outer membrane proteins from stromal ones. Addition of new sequences that localize to multiple compartments or organelles and use of data from large-scale fluorescent tag studies of plastid proteins should also enable development of robust multi-label models. Another issue concerns proteins from other types of photosynthetic plastids than chloroplasts, e.g. rhodoplasts, which represented only 10% of all sequences we collected. Future studies of photosynthetic organisms will provide novel data, which should improve prediction of localization in diverse types of plastids. Moreover, subplastid localization prediction could be extended to multimembrane plastids, including non-photosynthetic plastids of parasitic apicomplexans.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec39">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41598_2023_35296_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41598_2023_35296_MOESM2_ESM.xlsx">
            <caption>
              <p>Supplementary Information.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1038/s41598-023-35296-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Felix Teufel (Novo Nordisk A/S and University of Copenhagen) for his remarks on the optimal method of homology reduction. This work has been supported by the National Science Centre grant 2017/26/D/NZ8/00444 to P.G., the National Science Centre grant 2018/31/N/NZ2/01338 to K.S. and the National Science Centre grant 2019/35/N/NZ8/03366 to F.P. M. B. was supported by the Maria Zambrano grant funded by the European Union-NextGenerationEU.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>K.S., P.G., M.B. conceived and designed the analysis, K.S. collected the data, K.S. and P.G. curated the data, K.S., J.K., M.B. performed the analysis, K.S., P.G., J.K., H.N., P.M., M.B. analysed the results, K.S., F.P., M.B. created software, K.S. prepared figures, P.G., H.N., P.M. and M.B. supervised the project, K.S. wrote the initial draft. All authors reviewed and approved the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availibility</title>
    <p>All data, code and information necessary to reproduce the study are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/BioGenies/PlastoGram-analysis">https://github.com/BioGenies/PlastoGram-analysis</ext-link>. PlastoGram is available as a web server at <ext-link ext-link-type="uri" xlink:href="https://biogenies.info/PlastoGram">https://biogenies.info/PlastoGram</ext-link> and as an R package at <ext-link ext-link-type="uri" xlink:href="https://github.com/BioGenies/PlastoGram">https://github.com/BioGenies/PlastoGram</ext-link>.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par39">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daniell</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Green giant- a tiny chloroplast genome with mighty power to produce high-value proteins: History and phylogeny</article-title>
        <source>Plant Biotechnol. J.</source>
        <year>2021</year>
        <volume>19</volume>
        <fpage>430</fpage>
        <lpage>447</lpage>
        <pub-id pub-id-type="doi">10.1111/pbi.13556</pub-id>
        <?supplied-pmid 33484606?>
        <pub-id pub-id-type="pmid">33484606</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newkirk</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>de Allende</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jinkerson</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Giraldo</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Nanotechnology approaches for chloroplast biotechnology advancements</article-title>
        <source>Front. Plant Sci.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>691295</fpage>
        <pub-id pub-id-type="doi">10.3389/fpls.2021.691295</pub-id>
        <?supplied-pmid 34381480?>
        <pub-id pub-id-type="pmid">34381480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kirchhoff</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Chloroplast ultrastructure in plants</article-title>
        <source>New Phytol.</source>
        <year>2019</year>
        <volume>223</volume>
        <fpage>565</fpage>
        <lpage>574</lpage>
        <pub-id pub-id-type="doi">10.1111/nph.15730</pub-id>
        <?supplied-pmid 30721547?>
        <pub-id pub-id-type="pmid">30721547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Austin</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Frost</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vidi</surname>
            <given-names>P-A</given-names>
          </name>
          <name>
            <surname>Kessler</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Staehelin</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Plastoglobules are lipoprotein subcompartments of the chloroplast that are permanently coupled to thylakoid membranes and contain biosynthetic enzymes</article-title>
        <source>Plant Cell</source>
        <year>2006</year>
        <volume>18</volume>
        <fpage>1693</fpage>
        <lpage>1703</lpage>
        <pub-id pub-id-type="doi">10.1105/tpc.105.039859</pub-id>
        <?supplied-pmid 16731586?>
        <pub-id pub-id-type="pmid">16731586</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nakai</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>New perspectives on chloroplast protein import</article-title>
        <source>Plant Cell Physiol.</source>
        <year>2018</year>
        <volume>59</volume>
        <fpage>1111</fpage>
        <lpage>1119</lpage>
        <pub-id pub-id-type="doi">10.1093/pcp/pcy083</pub-id>
        <?supplied-pmid 29684214?>
        <pub-id pub-id-type="pmid">29684214</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofmann</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Theg</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Chloroplast outer membrane protein targeting and insertion</article-title>
        <source>Trends Plant Sci.</source>
        <year>2005</year>
        <volume>10</volume>
        <fpage>450</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tplants.2005.07.009</pub-id>
        <?supplied-pmid 16085449?>
        <pub-id pub-id-type="pmid">16085449</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Du</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>SubChlo: Predicting protein subchloroplast locations with pseudo-amino acid composition and the evidence-theoretic K-nearest neighbor (ET-KNN) algorithm</article-title>
        <source>J. Theor. Biol.</source>
        <year>2009</year>
        <volume>261</volume>
        <fpage>330</fpage>
        <lpage>335</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2009.08.004</pub-id>
        <?supplied-pmid 19679138?>
        <pub-id pub-id-type="pmid">19679138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tung</surname>
            <given-names>C-W</given-names>
          </name>
          <name>
            <surname>Liaw</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>S-J</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>S-Y</given-names>
          </name>
        </person-group>
        <article-title>Prediction of protein subchloroplast locations using random forests</article-title>
        <source>World Acad. Sci. Eng. Technol.</source>
        <year>2010</year>
        <volume>65</volume>
        <fpage>903</fpage>
        <lpage>907</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>SP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identify submitochondria and subchloroplast locations with pseudo amino acid composition: Approach from the strategy of discrete wavelet transform feature extraction</article-title>
        <source>Mol. Cell Res.</source>
        <year>2011</year>
        <volume>1813</volume>
        <fpage>424</fpage>
        <lpage>430</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>BS-KNN: An effective algorithm for predicting protein subchloroplast localization</article-title>
        <source>Evol. Bioinform.</source>
        <year>2012</year>
        <volume>8</volume>
        <fpage>79</fpage>
        <lpage>87</lpage>
        <pub-id pub-id-type="doi">10.4137/EBO.S8681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predicting subchloroplast locations of proteins based on the general form of Chou’s pseudo amino acid composition: approached from optimal tripeptide composition</article-title>
        <source>Int. J. Biomath.</source>
        <year>2013</year>
        <volume>06</volume>
        <fpage>1350003</fpage>
        <pub-id pub-id-type="doi">10.1142/S1793524513500034</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saravanan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Lakshmi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>SCLAP: An adaptive boosting method for predicting subchloroplast localization of plant proteins</article-title>
        <source>OMICS: J. Integrat. Biol.</source>
        <year>2013</year>
        <volume>17</volume>
        <fpage>106</fpage>
        <lpage>115</lpage>
        <pub-id pub-id-type="doi">10.1089/omi.2012.0070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Robust feature generation for protein subchloroplast location prediction with a weighted GO transfer model</article-title>
        <source>J. Theor. Biol.</source>
        <year>2014</year>
        <volume>347</volume>
        <fpage>84</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jtbi.2014.01.003</pub-id>
        <?supplied-pmid 24423409?>
        <pub-id pub-id-type="pmid">24423409</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G-Z</given-names>
          </name>
        </person-group>
        <article-title>MultiP-SChlo: Multi-label protein subchloroplast localization prediction with Chou’s pseudo amino acid composition and a novel multi-label classifier</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>2639</fpage>
        <lpage>2645</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv212</pub-id>
        <?supplied-pmid 25900916?>
        <pub-id pub-id-type="pmid">25900916</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mak</surname>
            <given-names>M-W</given-names>
          </name>
          <name>
            <surname>Kung</surname>
            <given-names>S-Y</given-names>
          </name>
        </person-group>
        <article-title>Transductive learning for multi-label protein subchloroplast localization prediction</article-title>
        <source>IEEE/ACM Trans. Comput. Biol. Bioinf.</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>212</fpage>
        <lpage>224</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2016.2527657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mak</surname>
            <given-names>M-W</given-names>
          </name>
          <name>
            <surname>Kung</surname>
            <given-names>S-Y</given-names>
          </name>
        </person-group>
        <article-title>Ensemble linear neighborhood propagation for predicting subchloroplast localization of multi-location proteins</article-title>
        <source>J. Proteome Res.</source>
        <year>2016</year>
        <volume>15</volume>
        <fpage>4755</fpage>
        <lpage>4762</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.jproteome.6b00686</pub-id>
        <?supplied-pmid 27766879?>
        <pub-id pub-id-type="pmid">27766879</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Savojardo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Martelli</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Fariselli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Casadio</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>SChloro: Directing Viridiplantae proteins to six chloroplastic sub-compartments</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>33</volume>
        <fpage>347</fpage>
        <lpage>353</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M-L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An overview on predicting protein subchloroplast localization by using machine learning methods</article-title>
        <source>Curr. Protein Peptide Sci.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1229</fpage>
        <lpage>1241</lpage>
        <pub-id pub-id-type="doi">10.2174/1389203721666200117153412</pub-id>
        <pub-id pub-id-type="pmid">31957607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aldridge</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cain</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Protein transport in organelles: Protein transport into and across the thylakoid membrane</article-title>
        <source>FEBS J.</source>
        <year>2009</year>
        <volume>276</volume>
        <fpage>1177</fpage>
        <lpage>1186</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1742-4658.2009.06875.x</pub-id>
        <?supplied-pmid 19187234?>
        <pub-id pub-id-type="pmid">19187234</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Cline, K.C., &amp; Theg, S.M., The Sec and Tat Protein Translocation Pathways in Chloroplasts. In The Enzymes: Molecular Machines Involved in Protein Transport across Cellular Membranes, 463–492 ( Academic Press, 2008), xxv edn.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>The UniProt Consortium</collab>
        </person-group>
        <article-title>UniProt: The universal protein knowledgebase in 2021</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2021</year>
        <volume>49</volume>
        <fpage>D480</fpage>
        <lpage>D489</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa1100</pub-id>
        <pub-id pub-id-type="pmid">33237286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ytterberg</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Peltier</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>van Wijk</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <article-title>Protein profiling of plastoglobules in chloroplasts and chromoplasts. A surprising site for differential accumulation of metabolic enzymes</article-title>
        <source>Plant Physiol.</source>
        <year>2006</year>
        <volume>140</volume>
        <fpage>984</fpage>
        <lpage>997</lpage>
        <pub-id pub-id-type="doi">10.1104/pp.105.076083</pub-id>
        <?supplied-pmid 16461379?>
        <pub-id pub-id-type="pmid">16461379</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Godzik</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Cd-hit: A fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1658</fpage>
        <lpage>1659</lpage>
        <?supplied-pmid 16731699?>
        <pub-id pub-id-type="pmid">16731699</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gíslason</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Almagro Armenteros</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Johansen</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Prediction of GPI-anchored proteins with pointer neural networks</article-title>
        <source>Curr. Res. Biotechnol.</source>
        <year>2021</year>
        <volume>3</volume>
        <fpage>6</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1016/j.crbiot.2021.01.001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Needleman</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Wunsch</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>
        <source>J. Mol. Biol.</source>
        <year>1970</year>
        <volume>48</volume>
        <fpage>443</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id>
        <?supplied-pmid 5420325?>
        <pub-id pub-id-type="pmid">5420325</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rice</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Longden</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bleasby</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>EMBOSS: The European molecular biology open software suite</article-title>
        <source>Trends Genet.: TIG</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>276</fpage>
        <lpage>277</lpage>
        <pub-id pub-id-type="doi">10.1016/S0168-9525(00)02024-2</pub-id>
        <?supplied-pmid 10827456?>
        <pub-id pub-id-type="pmid">10827456</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Grinsztajn, L., Oyallon, E., &amp; Varoquaux, G. Why do tree-based models still outperform deep learning on tabular data? 10.48550/ARXIV.2207.08815 (2022).</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burdukiewicz</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Amyloidogenic motifs revealed by n-gram analysis</article-title>
        <source>Sci. Rep.</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>12961</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-13210-9</pub-id>
        <?supplied-pmid 29021608?>
        <pub-id pub-id-type="pmid">29021608</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wright</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Ziegler</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Ranger: A fast implementation of random forests for high dimensional data in C++ and R</article-title>
        <source>J. Stat. Softw.</source>
        <year>2017</year>
        <volume>77</volume>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.18637/jss.v077.i01</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Branco, P., Ribeiro, R. P. &amp; Torgo, L. UBL: An R package for Utility-based Learning. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1604.08079">arXiv:1604.08079</ext-link> [cs, stat] (2016). eprint1604.08079.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Standley</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>MAFFT multiple sequence alignment software version 7: Improvements in performance and usability</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2013</year>
        <volume>30</volume>
        <fpage>772</fpage>
        <lpage>780</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>
        <?supplied-pmid 23329690?>
        <pub-id pub-id-type="pmid">23329690</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mistry</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Finn</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Punta</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Challenges in homology search: HMMER3 and convergent evolution of coiled-coil regions</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>e121</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt263</pub-id>
        <?supplied-pmid 23598997?>
        <pub-id pub-id-type="pmid">23598997</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolpert</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Stacked generalization</article-title>
        <source>Neural Netw.</source>
        <year>1992</year>
        <volume>5</volume>
        <fpage>241</fpage>
        <lpage>259</lpage>
        <pub-id pub-id-type="doi">10.1016/S0893-6080(05)80023-1</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chowdhury</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khaledian</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Broschat</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Capreomycin resistance prediction in two species of Mycobacterium using a stacked ensemble method</article-title>
        <source>J. Appl. Microbiol.</source>
        <year>2019</year>
        <volume>127</volume>
        <fpage>1656</fpage>
        <lpage>1664</lpage>
        <pub-id pub-id-type="doi">10.1111/jam.14413</pub-id>
        <?supplied-pmid 31419358?>
        <pub-id pub-id-type="pmid">31419358</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bie</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Contour detection via stacking random forest learning</article-title>
        <source>Neurocomputing</source>
        <year>2018</year>
        <volume>275</volume>
        <fpage>2702</fpage>
        <lpage>2715</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neucom.2017.11.046</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burdukiewicz</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Proteomic screening for prediction and design of antimicrobial peptides with AmpGram</article-title>
        <source>Int. J. Mol. Sci.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>4310</fpage>
        <pub-id pub-id-type="doi">10.3390/ijms21124310</pub-id>
        <?supplied-pmid 32560350?>
        <pub-id pub-id-type="pmid">32560350</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vanacore</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pellegrino</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Robustness of <italic>κ</italic>-type coefficients for clinical agreement</article-title>
        <source>Stat. Med.</source>
        <year>2022</year>
        <volume>41</volume>
        <fpage>1986</fpage>
        <lpage>2004</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.9341</pub-id>
        <?supplied-pmid 35124830?>
        <pub-id pub-id-type="pmid">35124830</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bankapur</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Patil</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>An effective multi-label protein sub-chloroplast localization prediction by skipped-grams of evolutionary profiles using deep neural network</article-title>
        <source>IEEE/ACM Trans. Comput. Biol. Bioinf.</source>
        <year>2022</year>
        <volume>19</volume>
        <fpage>1449</fpage>
        <lpage>1458</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2020.3037465</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Olson, M., Wyner, A. &amp; Berk, R. Modern neural networks generalize on small data sets. In Bengio, S. et al. (eds.) Advances in Neural Information Processing Systems, vol. 31 (Curran Associates, Inc., 2018).</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Howe</surname>
            <given-names>CJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolution of the chloroplast genome</article-title>
        <source>Philos. Trans. R. Soc. Lond. Ser. B: Biol. Sci.</source>
        <year>2003</year>
        <volume>358</volume>
        <fpage>99</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="doi">10.1098/rstb.2002.1176</pub-id>
        <pub-id pub-id-type="pmid">12594920</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Almagro Armenteros</surname>
            <given-names>JJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detecting sequence signals in targeting peptides using deep learning</article-title>
        <source>Life Sci. Alliance</source>
        <year>2019</year>
        <volume>2</volume>
        <fpage>e201900429</fpage>
        <pub-id pub-id-type="doi">10.26508/lsa.201900429</pub-id>
        <?supplied-pmid 31570514?>
        <pub-id pub-id-type="pmid">31570514</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Thumuluri, V., Almagro Armenteros, J. J., Johansen, A. R., Nielsen, H. &amp; Winther, O. DeepLoc 2.0: Multi-label subcellular localization prediction using protein language models <italic>Nucleic Acids Res.</italic><bold>50</bold>, W228–W234 (2022).</mixed-citation>
    </ref>
  </ref-list>
</back>
