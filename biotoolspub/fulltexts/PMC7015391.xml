<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7015391</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0229034</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-19-22929</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Diagnostic Medicine</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Ultrasound Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Ultrasound Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Radiology and Imaging</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Ultrasound Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Bioassays and Physiological Analysis</subject>
          <subj-group>
            <subject>Muscle Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Physiology</subject>
          <subj-group>
            <subject>Muscle Physiology</subject>
            <subj-group>
              <subject>Muscle Functions</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Physiology</subject>
          <subj-group>
            <subject>Muscle Physiology</subject>
            <subj-group>
              <subject>Muscle Functions</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Architecture</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Image Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Connective Tissue</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Biological Tissue</subject>
            <subj-group>
              <subject>Connective Tissue</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Musculoskeletal System</subject>
            <subj-group>
              <subject>Muscles</subject>
              <subj-group>
                <subject>Gastrocnemius Muscles</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Musculoskeletal System</subject>
            <subj-group>
              <subject>Muscles</subject>
              <subj-group>
                <subject>Gastrocnemius Muscles</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Simple Muscle Architecture Analysis (SMA): An ImageJ macro tool to automate measurements in B-mode ultrasound scans</article-title>
      <alt-title alt-title-type="running-head">Automated analysis of muscle architecture</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1289-246X</contrib-id>
        <name>
          <surname>Seynnes</surname>
          <given-names>Olivier R.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Cronin</surname>
          <given-names>Neil J.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Data curation</role>
        <role content-type="http://credit.casrai.org/">Formal analysis</role>
        <role content-type="http://credit.casrai.org/">Funding acquisition</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Project administration</role>
        <role content-type="http://credit.casrai.org/">Resources</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Supervision</role>
        <role content-type="http://credit.casrai.org/">Validation</role>
        <role content-type="http://credit.casrai.org/">Visualization</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department for Physical Performance, Norwegian School of Sport Sciences, Oslo, Norway</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Neuromuscular Research Centre, Faculty of Sport and Health Sciences, University of Jyväskylä, Jyväskylä, Finland</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Abraham</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>Pennsylvania State Hershey College of Medicine, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>olivier.seynnes@nih.no</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>15</volume>
    <issue>2</issue>
    <elocation-id>e0229034</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2020 Seynnes, Cronin</copyright-statement>
      <copyright-year>2020</copyright-year>
      <copyright-holder>Seynnes, Cronin</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0229034.pdf"/>
    <abstract>
      <p>In vivo measurements of muscle architecture (i.e. the spatial arrangement of muscle fascicles) are routinely included in research and clinical settings to monitor muscle structure, function and plasticity. However, in most cases such measurements are performed manually, and more reliable and time-efficient automated methods are either lacking completely, or are inaccessible to those without expertise in image analysis. In this work, we propose an ImageJ script to automate the entire analysis process of muscle architecture in ultrasound images: Simple Muscle Architecture Analysis (SMA). Images are filtered in the spatial and frequency domains with built-in commands and external plugins to highlight aponeuroses and fascicles. Fascicle dominant orientation is then computed in regions of interest using the <italic>OrientationJ</italic> plugin. Bland-Altman plots of analyses performed manually or with SMA indicate that the automated analysis does not induce any systematic bias and that both methods agree equally through the range of measurements. Our test results illustrate the suitability of SMA to analyse images from superficial muscles acquired with a broad range of ultrasound settings.</p>
    </abstract>
    <funding-group>
      <funding-statement>The author(s) received no specific funding for this work.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="7"/>
      <table-count count="0"/>
      <page-count count="13"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The three datasets analysed during the current study are available as separate compressed files at the following address: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.17632/dpmf9bz8pt.2">http://dx.doi.org/10.17632/dpmf9bz8pt.2</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The three datasets analysed during the current study are available as separate compressed files at the following address: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.17632/dpmf9bz8pt.2">http://dx.doi.org/10.17632/dpmf9bz8pt.2</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec001">
    <title>Introduction</title>
    <p>Musculoskeletal ultrasound imaging is used in a wide range of fields, including the study of muscle and tendon function [<xref rid="pone.0229034.ref001" ref-type="bibr">1</xref>,<xref rid="pone.0229034.ref002" ref-type="bibr">2</xref>], the effects of training on muscle architecture [<xref rid="pone.0229034.ref003" ref-type="bibr">3</xref>], and in the study of architectural parameters in different clinical populations [<xref rid="pone.0229034.ref004" ref-type="bibr">4</xref>]. The images generated by this method are complex and require a great deal of time and effort from practitioners to interpret and extract meaning from them. In recent years, efforts have been made to automate parts of this process [<xref rid="pone.0229034.ref005" ref-type="bibr">5</xref>–<xref rid="pone.0229034.ref010" ref-type="bibr">10</xref>]. However, these efforts have been fragmented, and suffer from a number of limitations: they often focus on analysing a single parameter of interest; most publications do not reveal specific details of how to implement the method; some methods rely on software that require expensive licence fees; the majority of methods are only semi-automated, requiring manual, subjective interpretation of at least some images; and often tracking methods involve complex mathematics and require computer programming experience. Collectively, these factors limit the widespread use of existing methods. In this study we present Simple Muscle Architecture Analysis (SMA), a fully automated method of analysing muscle architectural parameters from individual images or collections of images. The method consists of a single macro in Fiji [<xref rid="pone.0229034.ref011" ref-type="bibr">11</xref>], which is a distribution of ImageJ [<xref rid="pone.0229034.ref012" ref-type="bibr">12</xref>,<xref rid="pone.0229034.ref013" ref-type="bibr">13</xref>], and is open source software that is commonly used to process ultrasound images. We provide full instructions for using the method, and no previous programming experience is required. In the following sections we present an overview of the method, as well as examples of analysis output and a range of test metrics.</p>
    <p>A preprint version of this paper was first published at the following address: <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/1905.09490v2">https://arxiv.org/abs/1905.09490v2</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="sec002">
    <title>Methods</title>
    <sec id="sec003">
      <title>Overview</title>
      <p>In addition to the connective tissue surrounding bundles of muscle fibres (perimysium) and whole muscles (aponeuroses), ultrasound scans of muscle architecture acquired in brightness (B) mode show several types of echogenic tissues (e.g. fat, other types of connective tissue, blood vessels). A challenge associated with automatic segmentation of fascicles and aponeuroses is therefore to discriminate between signals from all echogenic regions (and artefactual echoes) and those from objects of interest. One of the originalities of the present approach is the implementation of filters in the frequency domain to isolate objects of interest (i.e. aponeuroses or fascicles) and improve their detection and registration. The sample images used to test the present method were collected in previous projects, for which the subjects gave permission to use images by signing an informed consent and ethical approval was granted by the ethical committee of the Norwegian School of Sport Sciences. The analysis method is summarised in <xref ref-type="fig" rid="pone.0229034.g001">Fig 1</xref>.</p>
      <fig id="pone.0229034.g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0229034.g001</object-id>
        <label>Fig 1</label>
        <caption>
          <title>Workflow of the SMA (Simple Muscle Architecture Analysis) macro.</title>
        </caption>
        <graphic xlink:href="pone.0229034.g001"/>
      </fig>
      <p>The analysis script is written in ImageJ 1.x macro language and runs in Fiji [<xref rid="pone.0229034.ref011" ref-type="bibr">11</xref>]. Although this scripting language is less powerful than others (e.g. Python), it is easy to learn and use, and was chosen with the goal of developing a tool customisable by most users. The script includes a header, a macro and auxiliary functions called within the macro. The header contains information about necessary plugins, the GNU General Public License, and the script parameters selectable by the user. The macro contains a main function <italic>SingleImageAnalysis</italic> and sub-scripts to display the results and run the macro on a single image or in batch mode (i.e. on series of images). The <italic>SingleImageAnalysis</italic> function is divided into four main sections, which perform the following operations: i) detect the ultrasound field of view (FoV), ii) segment and register superficial and deep aponeuroses, iii) measure dominant orientation of fascicles, and iv) calculate and compile variables of interest. The first three sections include a pre-processing step to isolate objects of interest and a function or a plugin (for fascicle orientation) to segment these objects. Several spatial filters are used in pre-processing. Although the purpose of their implementation is specified, their description would extend beyond the scope of this article. The reader is therefore referred to the relevant references for additional information.</p>
    </sec>
    <sec id="sec004">
      <title>Detection of the ultrasound field of view</title>
      <p>Ultrasound images nearly always come with a frame containing various information about institution/patient name, scanning parameters and scaling. To proceed with the analysis of the ultrasound FoV, this section optionally (see the “Program description” section) identifies and crops the frame out. This step is achieved by filtering out most of the text from the frame by applying a convolution and a median filter, and binarizing the whole image with a median local threshold. The resulting segmentation enables the selection and deletion of the frame from a duplicate scan but does not alter the original image. The duplicate image of the FoV obtained at the end of this step is used in the three following sections.</p>
    </sec>
    <sec id="sec005">
      <title>Detection of the aponeuroses</title>
      <p>The pre-processing of this section begins with a series of spatial filters using built-in commands or plugins (<italic>Enhance Local Contrast</italic>, <italic>CLAHE</italic> [<xref rid="pone.0229034.ref014" ref-type="bibr">14</xref>]; <italic>Tubeness</italic> [<xref rid="pone.0229034.ref015" ref-type="bibr">15</xref>]) in ImageJ/Fiji and a separately installed plugin (<italic>Non-Local Means Denoising</italic> [<xref rid="pone.0229034.ref016" ref-type="bibr">16</xref>,<xref rid="pone.0229034.ref017" ref-type="bibr">17</xref>]), to remove ultrasound noise and enhance muscle aponeuroses and fascicles. The <italic>Tubeness</italic> plugin is an implementation of multiscale vessel enhancement filtering first proposed by Frangi et al. [<xref rid="pone.0229034.ref018" ref-type="bibr">18</xref>]. The plugin scores each point on the basis of eigenvalues of the Hessian matrix, to determine an index of “tubeness”. Although this approach was first developed to detect blood vessels, it can also effectively enhance muscle fascicles in ultrasound images [<xref rid="pone.0229034.ref005" ref-type="bibr">5</xref>]. A Fourier transform (FFT) is then applied to the filtered image. The resulting power spectrum is thresholded to retain the dominant signal from muscular aponeuroses and fascicles, and a mask is applied to the thresholded image to suppress features orientated in the expected direction of fascicles (see the “Program description” section). The inverse FFT of the filtered power spectrum is subsequently computed, and the edges of the aponeuroses are segmented (<italic>Canny Edge Detector</italic> plugin [<xref rid="pone.0229034.ref019" ref-type="bibr">19</xref>]) and registered using a custom-written function. This function uses a simple contrast threshold to search for parallel ‘lines’ in the horizontal direction, which typify the appearance of aponeuroses (see <xref ref-type="fig" rid="pone.0229034.g002">Fig 2B</xref>).</p>
      <fig id="pone.0229034.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0229034.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <p><bold>Examples of raw images of the ultrasound field of view, aponeuroses edge detection and overlaid ROIs (yellow) on a suitable scan (A-C), and on a scan where the lower aponeurosis is imaged with insufficient contrast (D-G).</bold> In C and G, the paths of the superficial and deep aponeuroses are also indicated as green lines. When the aponeurosis is imaged with insufficient contrast it is not detected (E). In this case using a higher Tubeness sigma may help detection (F-G), although too high values may cause a slight distortion of the aponeurosis edge.</p>
        </caption>
        <graphic xlink:href="pone.0229034.g002"/>
      </fig>
    </sec>
    <sec id="sec006">
      <title>Measurement of the dominant fascicle orientation</title>
      <p>At least two overlapping regions of interest (ROI) are defined along the width of non-filtered duplicates of the FoV, excluding aponeuroses (see the “Program description” section). Multiple overlapping ROIs were shown in pilot experiments to yield the dominant fascicle orientation more consistently than single or non-overlapping ROIs. Similarly to the aponeurosis detection, ROIs are first filtered spatially and in the frequency domain. However, to better preserve fascicular features, noise filtering is “lighter” than for aponeuroses (median filter and <italic>Non-Local Means Denoising</italic> plugin). Unless set manually (see the “Program description” section), a thresholding proportional to the brightness of the filtered image is applied to the power spectrum to mostly retain the frequencies corresponding to fascicles in the ROI. Following an inverse FFT, fascicles are enhanced with the <italic>Tubeness</italic> plugin. Their dominant orientation is measured within each ROI with the <italic>OrientationJ</italic> plugin [<xref rid="pone.0229034.ref020" ref-type="bibr">20</xref>,<xref rid="pone.0229034.ref021" ref-type="bibr">21</xref>]. <italic>OrientationJ</italic> is a plugin developed by Daniel Sage [<xref rid="pone.0229034.ref020" ref-type="bibr">20</xref>] to compute orientation and isotropy properties within a ROI, based on the evaluation of the gradient structure tensor in a local neighbourhood. The local window is characterized by a 2D Gaussian function of standard deviation σ, and here the gradient is computed with a (quasi-isotropic) cubic spline filter. The standard deviation of the Gaussian filter σ is defined by the user (see the “Program description” section), and should be proportional to the thickness of the fascicles (i.e. thicker fascicles are associated with a larger σ). The dominant angles from all ROIs are collected and either the greatest, the mean or the median angle—as selected by the user—is retained for each analysed image.</p>
    </sec>
    <sec id="sec007">
      <title>Calculation of architecture parameters and display</title>
      <p>The angle of fascicle pennation is computed as the sum of the angles characterising the orientations of the deeper aponeurosis and fascicles, measured in previous steps. Fascicle length is computed as the length of a straight line running between aponeuroses, at an angle corresponding to the dominant fascicle orientation (either greatest, mean or median angle). Thus, the current version of the script estimates linear fascicle paths. A previous study comparing the length of gastrocnemius medialis fascicles when taking their curvature into account versus when assuming a straight path and parallel aponeuroses found a 6% difference during maximal contraction [<xref rid="pone.0229034.ref022" ref-type="bibr">22</xref>]. The difference seen in resting muscle was negligible. Because the current approach takes the orientation of aponeuroses into account, we expect an error negligible at rest and smaller than that reported by Muramatsu and colleagues during contraction. Future implementations of the script may estimate curved paths. Although the analysis was developed for scans displaying entire fascicles, the script enables the extrapolation of aponeuroses if the composite fascicle runs outside the FoV. Muscle thickness is calculated as the mean distance between aponeuroses. The <italic>SingleImageAnalysis</italic> function ends after this step; if batch mode was selected the macro loops back to the beginning of the function and repeats the analysis for all other images. Numerical results are displayed in a table and a composite fascicular line is overlaid on corresponding original images, arranged in a stack.</p>
    </sec>
    <sec id="sec008">
      <title>Program description</title>
      <p>The script can be opened and launched in Fiji without installation, but end users are advised to install it in the Fiji.app/plugins folder. It can then be found in the Plugins menu of the Fiji software. When launched, the script opens a user interface divided into 5 sections. A brief description is displayed when the mouse pointer hovers over a parameter. A message at the top reminds the user that the analysis script was designed for ultrasound scans displaying the proximal side to the left of the image, where fascicles would typically be angled upward to the left and the lower aponeurosis would be orientated horizontally or downwards to the left. The check box below this message allows the user to flip analysed images horizontally if required. In addition to the orientation of the image, we recommend following some basic scanning guidelines. The transducer should be used in the highest frequency range and the focal zone set to the deeper aponeurosis. When possible, the ultrasound beam can be steered towards the perpendicular to the direction of the fascicles, as long as aponeuroses still appear clearly. Using compound imaging is a preferred alternative to changing the beam orientation, when this feature is available. Any other feature (e.g. tissue harmonic imaging, speckle reduction) capable of reducing noise is also recommended. The dynamic range (or compression) should be moderate or low. The following sections detail the choices offered in the user interface.</p>
      <sec id="sec009">
        <title>Type of analysis</title>
        <p>The user chooses here to analyse single images, or, if multiple images are being analysed, selects target input and output folders. In the second case the extension corresponding to the file format must be specified. A check box enables the user to print all analysis parameters in the results table.</p>
      </sec>
      <sec id="sec010">
        <title>Image cropping</title>
        <p>Images can be cropped manually. In this case the user is prompted to draw a selection around the field of view. In the case of folder analysis, the same dimensions of the cropping selection are used for all files, so it is advisable to only include images taken at the same scanning depth to avoid accidentally cropping the FoV. Manual cropping is recommended when aponeurosis detection fails, in particular when bright structures (e.g. other aponeuroses, bone edges) are visible under the muscle of interest.</p>
      </sec>
      <sec id="sec011">
        <title>Aponeurosis detection</title>
        <p>The only parameter that can be adjusted at this step is the standard deviation—sigma—of the Gaussian used in the <italic>Tubeness</italic> plugin to convolve the image (see section “Detection of the aponeuroses”). The default value is set to 10 on the basis of our sample images, but different spatial resolutions may require another value. A lower sigma (e.g. 8) is recommended whenever possible, as larger values may result in inaccurate detection of aponeuroses edges. Aponeuroses imaged with an insufficient contrast may not be detected. In such cases, an error message is displayed and the user is invited to crop the image manually or to use a higher value of Tubeness sigma (<xref ref-type="fig" rid="pone.0229034.g002">Fig 2D–2G</xref>). Note that choosing too high values may cause a slight distortion of the aponeurosis edge. The alternative suggestion of cropping the image manually may help to exclude areas of the image (i.e. subcutaneous fat, blood vessels or connective tissue) that are too close to the aponeuroses and prevent their accurate detection.</p>
      </sec>
      <sec id="sec012">
        <title>Fascicle orientation</title>
        <p>In this section the user chooses the number and the size of the ROIs used to measure dominant fascicle orientation. These parameters define the degree of overlap and the depth of the ROIs. The choice of ROI height enables the computation of fascicle orientation within the whole image or in regions closer to the deeper aponeurosis. The latter is often favoured by researchers because of the better alignment between the deeper aponeurosis and the direction of muscle force, but this theoretical argument should be weighed against the smaller number and consistency of visible fascicles within smaller ROIs.</p>
        <p>As explained in section “Measurement of the dominant fascicle orientation”, structures aligned in a different direction than the fascicles are filtered out by thresholding the power spectrum of ROIs (<xref ref-type="fig" rid="pone.0229034.g003">Fig 3</xref>). The threshold value is set automatically but the user can uncheck this option and set the threshold manually. In the next step, the Laplacian of Gaussian filter value (referred to as σ in “Measurement of the dominant fascicle orientation”) can be set according to the spatial resolution of the image and expected fascicle thickness. The default value (4) was found to be suitable in most of our tests. However, the value of this parameter will influence the measurements and using a σ consistently is necessary to obtain reliable results. A “Test” function is available here, to display the output measurements with σ values computed between 0 and 7. The displayed table indicates notably the dominant orientation and coherency, the latter being an index (0-to-1) representing the anisotropy level. In addition to informing the decision of σ value, this test can be useful to identify scans of insufficient quality for this analysis: in case of an insufficient fascicle resolution the orientation will increase continuously with σ. For such scans, the dominant orientation will appear lower than that of the fascicles upon visual inspection of the final overlaid image. Finally, the user can select the method used to obtain the dominant fascicle orientation out of the values obtained in each ROI.</p>
        <fig id="pone.0229034.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0229034.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <p><bold>Example of raw (A) and processed (B) images of fascicles.</bold> Processing amplifies the signal of structures aligned with the direction of the fascicles by thresholding of the power spectrum (C). The resulting distribution of orientation computed with the OrientationJ plugin is narrower for the processed image (E) than for the original one (D).</p>
          </caption>
          <graphic xlink:href="pone.0229034.g003"/>
        </fig>
      </sec>
      <sec id="sec013">
        <title>Pixel scaling</title>
        <p>For single images or series of images acquired at the same depth, measurements can be scaled if this option is checked. The user should then select the scanning depth, and at the onset of the analysis when prompted, draw a straight line over the scale bar usually included in the frame of ultrasound scans (as is normally done when scaling images in ImageJ/Fiji).</p>
      </sec>
      <sec id="sec014">
        <title>System requirements</title>
        <p>Hardware/software specifications are based on Fiji/ImageJ requirements. Currently, the following systems are supported:</p>
        <list list-type="bullet">
          <list-item>
            <p>Windows XP, Vista, 7, 8 and 10</p>
          </list-item>
          <list-item>
            <p>Mac OS X 10.8 "Mountain Lion" or later</p>
          </list-item>
          <list-item>
            <p>Linux on amd64 and x86 architectures</p>
          </list-item>
        </list>
        <p>However, the capability to use Java 8 runtime is the only real requirement.</p>
      </sec>
      <sec id="sec015">
        <title>Mode of availability</title>
        <p>The SMA script and the necessary (<italic>Non Local Means Denoise</italic>, <italic>Canny Edge Detector</italic> and <italic>OrientationJ</italic>) or optional (<italic>FFMPEG</italic>) plugins are installed via the ImageJ Updater interface, by adding relevant update sites. This relatively simple procedure has the advantage of automatically updating all of the required components and libraries. Generic steps for adding an update site are explained on the ImageJ website (<ext-link ext-link-type="uri" xlink:href="https://imagej.net/Following_an_update_site">https://imagej.net/Following_an_update_site</ext-link>), but detailed instructions for installing SMA are provided in the <xref ref-type="supplementary-material" rid="pone.0229034.s001">S1 Supporting Information</xref>. The script can also be accessed directly: <ext-link ext-link-type="uri" xlink:href="https://sites.imagej.net/SMA/plugins/">https://sites.imagej.net/SMA/plugins/</ext-link>.</p>
      </sec>
      <sec id="sec016">
        <title>Performance measure</title>
        <p>To assess the performance of the automated analysis, scans of muscle architecture were analysed with SMA and manually, by the two investigators. For all variables, measurements obtained from SMA and manual analyses had equal variance (Bartlett criterion) and were normally distributed (Shapiro–Wilk test). The agreement between manual and automated analysis was assessed with Bland-Altman plots. Measures of reliability were not included since repeated SMA analyses of the same scans yield identical results. Likewise, we chose here not to include any comparison between SMA analyses performed on repeated scans. The repeatability of probe placement and generally, the skills of the operator of the ultrasound are critical factors affecting repeated measures of muscle architecture but this extends beyond the scope of this article as it does not relate to the performance of the algorithm.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="sec017">
    <title>Results</title>
    <p>The analysis is currently optimised for superficial muscle architecture images taken at rest, with entire fascicles visible within the FoV. However, aponeuroses can be extrapolated linearly and the length of elongated fascicles (e.g. when the muscle is being stretched) can be estimated with satisfactory accuracy. The primary purpose of the macro is therefore to obtain reliable estimates of muscle architecture in repeated measurements from the same individuals. In the first example below, we compared the reliability and validity of this type of analysis against manual analysis (Figs <xref ref-type="fig" rid="pone.0229034.g004">4</xref> &amp; <xref ref-type="fig" rid="pone.0229034.g005">5</xref>). To illustrate the effect of variations in image parameters due to the use of different equipment and ultrasound settings, sample scans of gastrocnemius medialis muscle were acquired from 15 individuals (Sample A), at 9 MHz, with a 96-element transducer (60mm, LV7.5/60/96Z, LogicScan 128 EXT-1Z, Telemed, Lithuania), and 15 different sample scans (Sample B) were acquired at 12 MHz, with a 128-element transducer (50 mm, 5–12 MHz HD11XE, Phillips, Bothell, Washington, USA). Ultrasound parameters were adjusted to visualise fascicles and aponeuroses appropriately but differently for each sample (e.g. contrast, smoothing), to reflect a broader range of image quality than obtained with hardware alone. Therefore, the results of the analysis of these samples do not reflect brand-specific capabilities of the ultrasound systems used here. Both samples were analysed with the SMA script, and manually (and independently) by the two authors. Manual analysis consisted of digitising 3 fascicles per image and the distance between superficial and deep aponeuroses at 3 different sites (approximately 25, 50 and 75% of image width). An average of these measurements was used to represent pennation angle, fascicle length and muscle thickness.</p>
    <fig id="pone.0229034.g004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0229034.g004</object-id>
      <label>Fig 4</label>
      <caption>
        <title>Bland-Altman plots of pennation angle, fascicle length and muscle thickness obtained from scans of the gastrocnemius medialis in Sample A.</title>
        <p>Comparisons between automated analysis (SMA), manual analyses from investigator 1 (Inv1) and investigator 2 (Inv2) are illustrated by differences between pairs of measurements as a function of the mean measurements. Solid and dotted lines depict bias and 95% limits of agreement, respectively.</p>
      </caption>
      <graphic xlink:href="pone.0229034.g004"/>
    </fig>
    <fig id="pone.0229034.g005" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0229034.g005</object-id>
      <label>Fig 5</label>
      <caption>
        <title>Bland-Altman plots of pennation angle, fascicle length and muscle thickness obtained from scans of the gastrocnemius medialis in Sample B.</title>
        <p>Comparisons between automated analysis (SMA), manual analyses from investigator 1 (Inv1) and investigator 2 (Inv2) are illustrated by differences between pairs of measurements as a function of the mean measurements. Solid and dotted lines depict bias and 95% limits of agreement, respectively.</p>
      </caption>
      <graphic xlink:href="pone.0229034.g005"/>
    </fig>
    <p>Tracking of architecture parameters in image series is also possible with the SMA script, as long as fascicles are imaged consistently, as in during slow contractions or passive stretching. If scans were acquired as movies, the user should first install FFMPEG plugins [<xref rid="pone.0229034.ref023" ref-type="bibr">23</xref>] to be able to import them into Fiji, before saving them as image sequences. An example of analysis of images (Sample C) acquired at 12 MHz, with a 128-element transducer (60mm, HL9.0/60/128Z-2, LogicScan 128 EXT-1Z, Telemed, Lithuania) on the tibialis anterior muscle of an individual is illustrated in <xref ref-type="fig" rid="pone.0229034.g006">Fig 6</xref>. Scans were acquired at 15 frames per second, during an unconstrained dorsiflexion-plantarflexion movement. The analysis was performed with the following parameters: automatic cropping, Tubeness sigma (aponeurosis detection) = 7, 3 ROIs, ROI width = 60, ROI height = 90, automatic thresholding of the ROIs power spectrum, OrientationJ σ = 4 and maximal value of all dominant orientations detected in ROIs. The mean analysis time per frame was 8.4s on the computer used for this example.</p>
    <fig id="pone.0229034.g006" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0229034.g006</object-id>
      <label>Fig 6</label>
      <caption>
        <title>Changes in thickness (Th), fascicle length (Lf) and pennation angle (theta) in the tibialis anterior of one individual during unrestrained dorsiflexion and plantarflexion (Sample C).</title>
        <p>Raw data were fitted with a lowess curve to improve visualisation of change patterns.</p>
      </caption>
      <graphic xlink:href="pone.0229034.g006"/>
    </fig>
    <p>The three datasets analysed during the current study are available as separate compressed files at the following address: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.17632/dpmf9bz8pt.2">http://dx.doi.org/10.17632/dpmf9bz8pt.2</ext-link>.</p>
  </sec>
  <sec sec-type="conclusions" id="sec018">
    <title>Discussion</title>
    <p>The measurements of muscle architecture parameters obtained with SMA are within the range of expected values obtained manually. Bland-Altman plots show that the automated analysis does not induce any substantial bias, in particular when taking the inter-rater comparison into account. The bias in pennation angle is in all cases less than or equal to 1°. Image quality (i.e. spatial resolution and contrast) probably influenced the estimation of fascicle length, with a bias of up to 5.6 mm in Sample A and less than 1 mm in Sample B. Importantly, the bias magnitude was not specific to manual vs. automated analysis. The bias in muscle thickness was negligible in all comparisons (&lt;1 mm). None of the measured biases were found to be proportional to averaged values, indicating that manual and automatic analyses agree equally through the range of measurements. The validity of muscle architecture measurements performed manually has previously been shown [<xref rid="pone.0229034.ref024" ref-type="bibr">24</xref>]. The present comparisons demonstrate that the results obtained with SMA and manual measurements are comparable and, indirectly, equally valid. In addition, automated measurements improve the reliability of muscle architecture measurements by removing the variability induced by manual segmentation, particularly when multiple raters are involved [<xref rid="pone.0229034.ref025" ref-type="bibr">25</xref>]. As shown in examples of scans processed with the SMA script (<xref ref-type="fig" rid="pone.0229034.g007">Fig 7</xref>), the implemented filtering and user adjustments allow the processing of scans acquired with a broad range of ultrasound settings.</p>
    <fig id="pone.0229034.g007" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0229034.g007</object-id>
      <label>Fig 7</label>
      <caption>
        <title>Examples of processed scans from Samples A, B and C, with overlay of composite fascicles and regions of interest used in the analysis.</title>
      </caption>
      <graphic xlink:href="pone.0229034.g007"/>
    </fig>
    <p>However, the analysis relies heavily on sufficient contrast and homogeneity of grey values when imaging fascicles and aponeuroses. For instance, large differences between grey values of the lower and upper aponeuroses may cause the detection to fail. Likewise, inconsistent grey values along the length of an aponeurosis may affect its segmentation. Users are advised to test the suitability of new image settings prior to data collection. This step is important since different settings will influence the results of any analysis. For instance, different <italic>sigma</italic> values chosen to detect the aponeurosis (see sections “Detection of the aponeuroses” and “Aponeurosis detection”) will yield slight differences in the computed orientation of these structures. Similarly, the parameters used to compute the dominant fascicle orientation (e.g. ROI size and number, σ, see section “Fascicle orientation”) will influence the results. In addition to testing these parameters on sample data, the user is advised to keep the same settings when analysing subsequently collected data. Except in cases where parts of the image need to be excluded (e.g. due to excessive connective tissue) and cropping must be done manually, the above precautions will generally enable the analysis process to be fully automated if desired. Finally, the script was designed for superficial muscles. Deeper muscles may be targeted by manually cropping the FoV but the above requirements may limit their analysis. The automated analysis proposed here yields results comparable to those obtained manually. The SMA script, the first implementation of such an analysis to be proposed as a free and open source software, is therefore a suitable tool to reduce some of the variability introduced by manual analyses, and to improve the overall quality of muscle architecture measurements. Since it relies on sufficient contrast and homogeneity of grey values, it is mainly intended for use with images from resting muscles, but our test results also show that scans acquired during motion can be analysed, as long as qualitative image criteria are met.</p>
  </sec>
  <sec sec-type="supplementary-material" id="sec019">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0229034.s001">
      <label>S1 Supporting Information</label>
      <caption>
        <title>Installation instructions for SMA (Simple Muscle Architecture Analysis): An ImageJ/Fiji based macro for automated analysis of B-mode ultrasound images.</title>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0229034.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0229034.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Cronin</surname><given-names>NJ</given-names></name>, <name><surname>Lichtwark</surname><given-names>G a</given-names></name>. <article-title>The use of ultrasound to study muscle-tendon function in human posture and locomotion</article-title>. <source>Gait &amp; posture</source>. <year>2012</year>; <pub-id pub-id-type="doi">10.1016/j.gaitpost.2012.07.024</pub-id><?supplied-pmid 22910172?><pub-id pub-id-type="pmid">22910172</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Seynnes</surname><given-names>OR</given-names></name>, <name><surname>Bojsen-Møller</surname><given-names>J</given-names></name>, <name><surname>Albracht</surname><given-names>K</given-names></name>, <name><surname>Arndt</surname><given-names>A</given-names></name>, <name><surname>Cronin</surname><given-names>NJ</given-names></name>, <name><surname>Finni</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>Ultrasound-based testing of tendon mechanical properties: a critical evaluation</article-title>. <source>Journal of Applied Physiology</source>. <year>2015</year>;<volume>118</volume>: <fpage>133</fpage>–<lpage>141</lpage>. <pub-id pub-id-type="doi">10.1152/japplphysiol.00849.2014</pub-id><?supplied-pmid 25414247?><pub-id pub-id-type="pmid">25414247</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Timmins</surname><given-names>RG</given-names></name>, <name><surname>Shield</surname><given-names>AJ</given-names></name>, <name><surname>Williams</surname><given-names>MD</given-names></name>, <name><surname>Lorenzen</surname><given-names>C</given-names></name>, <name><surname>Opar</surname><given-names>DA</given-names></name>. <article-title>Architectural adaptations of muscle to training and injury: a narrative review outlining the contributions by fascicle length, pennation angle and muscle thickness</article-title>. <source>Br J Sports Med</source>. <year>2016</year>; <pub-id pub-id-type="doi">10.1136/bjsports-2015-094881</pub-id><?supplied-pmid 26817705?><pub-id pub-id-type="pmid">26817705</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Connolly</surname><given-names>B</given-names></name>, <name><surname>MacBean</surname><given-names>V</given-names></name>, <name><surname>Crowley</surname><given-names>C</given-names></name>, <name><surname>Lunt</surname><given-names>A</given-names></name>, <name><surname>Moxham</surname><given-names>J</given-names></name>, <name><surname>Rafferty</surname><given-names>GF</given-names></name>, <etal>et al</etal><article-title>Ultrasound for the assessment of peripheral skeletal muscle architecture in critical illness: a systematic review</article-title>. <source>Crit Care Med</source>. <year>2015</year>;<volume>43</volume>: <fpage>897</fpage>–<lpage>905</lpage>. <pub-id pub-id-type="doi">10.1097/CCM.0000000000000821</pub-id><?supplied-pmid 25559437?><pub-id pub-id-type="pmid">25559437</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Rana</surname><given-names>M</given-names></name>, <name><surname>Hamarneh</surname><given-names>G</given-names></name>, <name><surname>Wakeling</surname><given-names>JM</given-names></name>. <article-title>Automated tracking of muscle fascicle orientation in B-mode ultrasound images</article-title>. <source>Journal of biomechanics</source>. <year>2009</year>;<volume>42</volume>: <fpage>2068</fpage>–<lpage>73</lpage>. <pub-id pub-id-type="doi">10.1016/j.jbiomech.2009.06.003</pub-id><?supplied-pmid 19646699?><pub-id pub-id-type="pmid">19646699</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Cronin</surname><given-names>NJ</given-names></name>, <name><surname>Carty</surname><given-names>CP</given-names></name>, <name><surname>Barrett</surname><given-names>RS</given-names></name>, <name><surname>Lichtwark</surname><given-names>G</given-names></name>. <article-title>Automatic tracking of medial gastrocnemius fascicle length during human locomotion</article-title>. <source>J Appl Physiol</source>. <year>2011</year>;<volume>111</volume>: <fpage>1491</fpage>–<lpage>1496</lpage>. <pub-id pub-id-type="doi">10.1152/japplphysiol.00530.2011</pub-id><?supplied-pmid 21836045?><pub-id pub-id-type="pmid">21836045</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref007">
      <label>7</label>
      <mixed-citation publication-type="other">Zhou G-Q, Chan P, Zheng Y-P. Automatic Measurement of Pennation Angle and Fascicle Length of Gastrocnemius Muscles Using Real-time Ultrasound Imaging. Ultrasonics. 2014;</mixed-citation>
    </ref>
    <ref id="pone.0229034.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Farris</surname><given-names>DJ</given-names></name>, <name><surname>Lichtwark</surname><given-names>GA</given-names></name>. <article-title>UltraTrack: Software for semi-automated tracking of muscle fascicles in sequences of B-mode ultrasound images</article-title>. <source>Comput Methods Programs Biomed</source>. <year>2016</year>;<volume>128</volume>: <fpage>111</fpage>–<lpage>118</lpage>. <pub-id pub-id-type="doi">10.1016/j.cmpb.2016.02.016</pub-id><?supplied-pmid 27040836?><pub-id pub-id-type="pmid">27040836</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Caresio</surname><given-names>C</given-names></name>, <name><surname>Salvi</surname><given-names>M</given-names></name>, <name><surname>Molinari</surname><given-names>F</given-names></name>, <name><surname>Meiburger</surname><given-names>KM</given-names></name>, <name><surname>Minetto</surname><given-names>MA</given-names></name>. <article-title>Fully Automated Muscle Ultrasound Analysis (MUSA): Robust and Accurate Muscle Thickness Measurement</article-title>. <source>Ultrasound in Medicine &amp; Biology</source>. <year>2017</year>;<volume>43</volume>: <fpage>195</fpage>–<lpage>205</lpage>. <pub-id pub-id-type="doi">10.1016/j.ultrasmedbio.2016.08.032</pub-id><?supplied-pmid 27720522?><pub-id pub-id-type="pmid">27720522</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Nikolaidou</surname><given-names>ME</given-names></name>, <name><surname>Marzilger</surname><given-names>R</given-names></name>, <name><surname>Bohm</surname><given-names>S</given-names></name>, <name><surname>Mersmann</surname><given-names>F</given-names></name>, <name><surname>Arampatzis</surname><given-names>A</given-names></name>. <article-title>Operating length and velocity of human M. vastus lateralis fascicles during vertical jumping</article-title>. <source>Royal Society Open Science</source>. <year>2017</year>;<volume>4</volume>: <fpage>170185</fpage><pub-id pub-id-type="doi">10.1098/rsos.170185</pub-id><?supplied-pmid 28573027?><pub-id pub-id-type="pmid">28573027</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Schindelin</surname><given-names>J</given-names></name>, <name><surname>Arganda-Carreras</surname><given-names>I</given-names></name>, <name><surname>Frise</surname><given-names>E</given-names></name>, <name><surname>Kaynig</surname><given-names>V</given-names></name>, <name><surname>Longair</surname><given-names>M</given-names></name>, <name><surname>Pietzsch</surname><given-names>T</given-names></name>, <etal>et al</etal><article-title>Fiji: an open-source platform for biological-image analysis</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>: <fpage>676</fpage>–<lpage>682</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id><?supplied-pmid 22743772?><pub-id pub-id-type="pmid">22743772</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Schneider</surname><given-names>CA</given-names></name>, <name><surname>Rasband</surname><given-names>WS</given-names></name>, <name><surname>Eliceiri</surname><given-names>KW</given-names></name>. <article-title>NIH Image to ImageJ: 25 years of image analysis</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>: <fpage>671</fpage>–<lpage>675</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2089</pub-id><?supplied-pmid 22930834?><pub-id pub-id-type="pmid">22930834</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Rueden</surname><given-names>CT</given-names></name>, <name><surname>Schindelin</surname><given-names>J</given-names></name>, <name><surname>Hiner</surname><given-names>MC</given-names></name>, <name><surname>DeZonia</surname><given-names>BE</given-names></name>, <name><surname>Walter</surname><given-names>AE</given-names></name>, <name><surname>Arena</surname><given-names>ET</given-names></name>, <etal>et al</etal><article-title>ImageJ2: ImageJ for the next generation of scientific image data</article-title>. <source>BMC Bioinformatics</source>. <year>2017</year>;<volume>18</volume>: <fpage>529</fpage><pub-id pub-id-type="doi">10.1186/s12859-017-1934-z</pub-id><?supplied-pmid 29187165?><pub-id pub-id-type="pmid">29187165</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref014">
      <label>14</label>
      <mixed-citation publication-type="other">Saalfeld S. Enhance Local Contrast (CLAHE)—ImageJ [Internet]. [cited 17 Oct 2018]. <ext-link ext-link-type="uri" xlink:href="https://imagej.net/Enhance_Local_Contrast_">https://imagej.net/Enhance_Local_Contrast_</ext-link>(CLAHE)</mixed-citation>
    </ref>
    <ref id="pone.0229034.ref015">
      <label>15</label>
      <mixed-citation publication-type="other">Longair M, Preibisch S. Tubeness—ImageJ [Internet]. [cited 17 Oct 2018]. <ext-link ext-link-type="uri" xlink:href="https://imagej.net/Tubeness">https://imagej.net/Tubeness</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Buades</surname><given-names>A</given-names></name>, <name><surname>Coll</surname><given-names>B</given-names></name>, <name><surname>Morel</surname><given-names>J-M</given-names></name>. <article-title>Non-Local Means Denoising</article-title>. <source>Image Processing On Line</source>. <year>2011</year>;<volume>1</volume>: <fpage>208</fpage>–<lpage>212</lpage>. <pub-id pub-id-type="doi">10.5201/ipol.2011.bcm_nlm</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref017">
      <label>17</label>
      <mixed-citation publication-type="other">Darbon J, Cunha A, Chan TF, Osher S, Jensen GJ. Fast nonlocal filtering applied to electron cryomicroscopy. 2008 5th IEEE International Symposium on Biomedical Imaging: From Nano to Macro. 2008. pp. 1331–1334.</mixed-citation>
    </ref>
    <ref id="pone.0229034.ref018">
      <label>18</label>
      <mixed-citation publication-type="book"><name><surname>Frangi</surname><given-names>AF</given-names></name>, <name><surname>Niessen</surname><given-names>WJ</given-names></name>, <name><surname>Vincken</surname><given-names>KL</given-names></name>, <name><surname>Viergever</surname><given-names>MA</given-names></name>. <chapter-title>Multiscale vessel enhancement filtering</chapter-title> In: <name><surname>Wells</surname><given-names>WM</given-names></name>, <name><surname>Colchester</surname><given-names>A</given-names></name>, <name><surname>Delp</surname><given-names>S</given-names></name>, editors. <source>Medical Image Computing and Computer-Assisted Intervention—MICCAI’98</source>. <publisher-name>Springer</publisher-name>
<publisher-loc>Berlin Heidelberg</publisher-loc>; <year>1998</year> pp. <fpage>130</fpage>–<lpage>137</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0229034.ref019">
      <label>19</label>
      <mixed-citation publication-type="other">Gibara T. Canny Edge Detector [Internet]. [cited 17 Oct 2018]. <ext-link ext-link-type="uri" xlink:href="https://imagej.nih.gov/ij/plugins/canny/index.html">https://imagej.nih.gov/ij/plugins/canny/index.html</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref020">
      <label>20</label>
      <mixed-citation publication-type="book"><name><surname>Püspöki</surname><given-names>Z</given-names></name>, <name><surname>Storath</surname><given-names>M</given-names></name>, <name><surname>Sage</surname><given-names>D</given-names></name>, <name><surname>Unser</surname><given-names>M</given-names></name>. <chapter-title>Transforms and Operators for Directional Bioimage Analysis: A Survey</chapter-title> In: <name><surname>De Vos</surname><given-names>WH</given-names></name>, <name><surname>Munck</surname><given-names>S</given-names></name>, <name><surname>Timmermans</surname><given-names>J-P</given-names></name>, editors. <source>Focus on Bio-Image Informatics</source>. <publisher-loc>Cham</publisher-loc>: <publisher-name>Springer International Publishing</publisher-name>; <year>2016</year> pp. <fpage>69</fpage>–<lpage>93</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0229034.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Fonck</surname><given-names>E</given-names></name>, <name><surname>Feigl</surname><given-names>GG</given-names></name>, <name><surname>Fasel</surname><given-names>J</given-names></name>, <name><surname>Sage</surname><given-names>D</given-names></name>, <name><surname>Unser</surname><given-names>M</given-names></name>, <name><surname>Rüfenacht</surname><given-names>D a</given-names></name>, <etal>et al</etal><article-title>Effect of aging on elastin functionality in human cerebral arteries</article-title>. <source>Stroke; a journal of cerebral circulation</source>. <year>2009</year>;<volume>40</volume>: <fpage>2552</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1161/STROKEAHA.108.528091</pub-id><?supplied-pmid 19478233?><pub-id pub-id-type="pmid">19478233</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Muramatsu</surname><given-names>T</given-names></name>, <name><surname>Muraoka</surname><given-names>T</given-names></name>, <name><surname>Kawakami</surname><given-names>Y</given-names></name>, <name><surname>Shibayama</surname><given-names>A</given-names></name>, <name><surname>Fukunaga</surname><given-names>T</given-names></name>. <article-title>In vivo determination of fascicle curvature in contracting human skeletal muscles</article-title>. <source>Journal of Applied Physiology</source>. <year>2002</year>;<volume>92</volume>: <fpage>129</fpage>–<lpage>134</lpage>. <pub-id pub-id-type="doi">10.1152/jappl.2002.92.1.129</pub-id><?supplied-pmid 11744651?><pub-id pub-id-type="pmid">11744651</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref023">
      <label>23</label>
      <mixed-citation publication-type="other">Schindelin J. FFMPEG plugins [Internet]. [cited 1 Nov 2018]. <ext-link ext-link-type="uri" xlink:href="http://fiji.sc/~schindelin/ffmpeg-plugins/">http://fiji.sc/~schindelin/ffmpeg-plugins/</ext-link></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Kwah</surname><given-names>LK</given-names></name>, <name><surname>Pinto</surname><given-names>RZ</given-names></name>, <name><surname>Diong</surname><given-names>J</given-names></name>, <name><surname>Herbert</surname><given-names>RD</given-names></name>. <article-title>Reliability and validity of ultrasound measurements of muscle fascicle length and pennation in humans: a systematic review</article-title>. <source>J Appl Physiol</source>. <year>2013</year>;<volume>114</volume>: <fpage>761</fpage>–<lpage>769</lpage>. <pub-id pub-id-type="doi">10.1152/japplphysiol.01430.2011</pub-id><?supplied-pmid 23305989?><pub-id pub-id-type="pmid">23305989</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0229034.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>König</surname><given-names>N</given-names></name>, <name><surname>Cassel</surname><given-names>M</given-names></name>, <name><surname>Intziegianni</surname><given-names>K</given-names></name>, <name><surname>Mayer</surname><given-names>F</given-names></name>. <article-title>Inter-rater reliability and measurement error of sonographic muscle architecture assessments</article-title>. <source>J Ultrasound Med</source>. <year>2014</year>;<volume>33</volume>: <fpage>769</fpage>–<lpage>777</lpage>. <pub-id pub-id-type="doi">10.7863/ultra.33.5.769</pub-id><?supplied-pmid 24764331?><pub-id pub-id-type="pmid">24764331</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
