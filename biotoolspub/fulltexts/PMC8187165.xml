<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_CSBJ1043 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEga1 jpg ?>
<?FILEmmc1 docx ?>
<?FILEmmc2 docx ?>
<?FILEsi1 svg ?>
<?FILEsi2 svg ?>
<?FILEsi3 svg ?>
<?FILEsi4 svg ?>
<?FILEsi5 svg ?>
<?FILEsi6 svg ?>
<?FILEsi7 svg ?>
<?FILEsi8 svg ?>
<?FILEsi9 svg ?>
<?FILEsi10 svg ?>
<?FILEsi11 svg ?>
<?FILEsi12 svg ?>
<?FILEsi13 svg ?>
<?FILEsi14 svg ?>
<?FILEsi15 svg ?>
<?FILEsi16 svg ?>
<?FILEsi17 svg ?>
<?FILEsi18 svg ?>
<?FILEsi19 svg ?>
<?FILEsi20 svg ?>
<?FILEsi21 svg ?>
<?FILEsi22 svg ?>
<?FILEsi23 svg ?>
<?FILEsi24 svg ?>
<?FILEsi25 svg ?>
<?FILEsi26 svg ?>
<?FILEsi27 svg ?>
<?FILEsi28 svg ?>
<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Comput Struct Biotechnol J</journal-id>
    <journal-id journal-id-type="iso-abbrev">Comput Struct Biotechnol J</journal-id>
    <journal-title-group>
      <journal-title>Computational and Structural Biotechnology Journal</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2001-0370</issn>
    <publisher>
      <publisher-name>Research Network of Computational and Structural Biotechnology</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8187165</article-id>
    <article-id pub-id-type="pii">S2001-0370(21)00227-0</article-id>
    <article-id pub-id-type="doi">10.1016/j.csbj.2021.05.046</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scDA: Single cell discriminant analysis for single-cell RNA sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au005">
        <name>
          <surname>Shi</surname>
          <given-names>Qianqian</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au010">
        <name>
          <surname>Li</surname>
          <given-names>Xinxing</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au015">
        <name>
          <surname>Peng</surname>
          <given-names>Qirui</given-names>
        </name>
        <xref rid="af005" ref-type="aff">a</xref>
      </contrib>
      <contrib contrib-type="author" id="au020">
        <name>
          <surname>Zhang</surname>
          <given-names>Chuanchao</given-names>
        </name>
        <email>chaozhangchuan@163.com</email>
        <xref rid="af010" ref-type="aff">b</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <contrib contrib-type="author" id="au025">
        <name>
          <surname>Chen</surname>
          <given-names>Luonan</given-names>
        </name>
        <email>lnchen@sibs.ac.cn</email>
        <xref rid="af010" ref-type="aff">b</xref>
        <xref rid="af015" ref-type="aff">c</xref>
        <xref rid="af020" ref-type="aff">d</xref>
        <xref rid="cor1" ref-type="corresp">⁎</xref>
      </contrib>
      <aff id="af005"><label>a</label>Agricultural Bioinformatics Key Laboratory of Hubei Province, College of Informatics, Huazhong Agricultural University, Wuhan 430070, China</aff>
      <aff id="af010"><label>b</label>Key Laboratory of Systems Health Science of Zhejiang Province, Hangzhou Institute for Advanced Study, University of Chinese Academy of Sciences, Chinese Academy of Sciences, Hangzhou 310024, China</aff>
      <aff id="af015"><label>c</label>State Key Laboratory of Cell Biology, Shanghai Institute of Biochemistry and Cell Biology, Center for Excellence in Molecular Cell Science, Chinese Academy of Sciences, Shanghai 200031, China</aff>
      <aff id="af020"><label>d</label>Center for Excellence in Animal Evolution and Genetics, Chinese Academy of Sciences, Kunming 650223, China</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>⁎</label>Corresponding authors at: Key Laboratory of Systems Health Science of Zhejiang Province, Hangzhou Institute for Advanced Study, University of Chinese Academy of Sciences, Chinese Academy of Sciences, Hangzhou 310024, China (L. Chen). <email>chaozhangchuan@163.com</email><email>lnchen@sibs.ac.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <volume>19</volume>
    <fpage>3234</fpage>
    <lpage>3244</lpage>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 The Authors</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/4.0/).</license-p>
      </license>
    </permissions>
    <abstract abstract-type="graphical" id="ab005">
      <title>Graphical abstract</title>
      <fig id="f0035" position="anchor">
        <graphic xlink:href="ga1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="ab010">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="l0005">
          <list-item id="o0005">
            <label>•</label>
            <p id="p0005">Cell-to-Cell representation graph could be constructed.</p>
          </list-item>
          <list-item id="o0010">
            <label>•</label>
            <p id="p0010">Cell groups and Discriminant metagenes could be identified simultaneously.</p>
          </list-item>
          <list-item id="o0015">
            <label>•</label>
            <p id="p0015">scDA less sensitive to drop-out events and capable to label a mass of cells after learning even from a small set of data.</p>
          </list-item>
          <list-item id="o0020">
            <label>•</label>
            <p id="p0020">scDA can avoid unnecessary re-clustering, and is actually a combinational approach simultaneously performing both clustering and classification.</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract id="ab015">
      <p>Single-cell RNA-sequencing (scRNA-seq) techniques provide unprecedented opportunities to investigate phenotypic and molecular heterogeneity in complex biological systems. However, profiling massive amounts of cells brings great computational challenges to accurately and efficiently characterize diverse cell populations. Single cell discriminant analysis (scDA) solves this problem by simultaneously identifying cell groups and discriminant metagenes based on the construction of cell-by-cell representation graph, and then using them to annotate unlabeled cells in data. We demonstrate scDA is effective to determine cell types, revealing the overall variabilities between cells from eleven data sets. scDA also outperforms several state-of-the-art methods when inferring the labels of new samples. In particular, we found scDA less sensitive to drop-out events and capable to label a mass of cells within or across datasets after learning even from a small set of data. The scDA approach offers a new way to efficiently analyze scRNA-seq profiles of large size or from different batches. scDA was implemented and freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ZCCQQWork/scDA" id="ir005">https://github.com/ZCCQQWork/scDA</ext-link>.</p>
    </abstract>
    <kwd-group id="kg005">
      <title>Keywords</title>
      <kwd>Single-cell RNA-sequencing</kwd>
      <kwd>Discriminant analysis</kwd>
      <kwd>Discriminant features</kwd>
      <kwd>Cell-by-cell representation graph</kwd>
      <kwd>Cell annotation</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec id="s0005">
    <label>1</label>
    <title>Introduction</title>
    <p id="p0025">Single-cell RNA sequencing profiles gene expression of individual cells, allowing to detailly characterize multicellular organisms than bulk RNA-seq <xref rid="b0005" ref-type="bibr">[1]</xref>, <xref rid="b0010" ref-type="bibr">[2]</xref>, <xref rid="b0015" ref-type="bibr">[3]</xref>. While, given a scRNA-seq transcriptomic data set, one challenge is to unsupervisedly find out distinguishing features (or genes) for different cell populations <xref rid="b0020" ref-type="bibr">[4]</xref>, <xref rid="b0025" ref-type="bibr">[5]</xref>. In particular, reliable features would greatly improve efficiency to annotate large data sets or newly profiled cells <xref rid="b0025" ref-type="bibr">[5]</xref>, <xref rid="b0030" ref-type="bibr">[6]</xref>.</p>
    <p id="p0030">Recently, a popular way is a two-step schema <xref rid="b0035" ref-type="bibr">[7]</xref>, i.e., firstly identifying cell groups based on clustering approaches, then obtaining discriminant genes between these cell groups. These genes are usually referred to as marker genes <xref rid="b0025" ref-type="bibr">[5]</xref>. For instance, the pipeline of SC3 <xref rid="b0040" ref-type="bibr">[8]</xref> is to first infer cell clusters, and then conduct binary comparisons (i.e., one cluster vs the remaining cells) for selecting cluster-specific markers. SparseDC <xref rid="b0045" ref-type="bibr">[9]</xref> model can extract diverse types of marker genes with known cell labels based on two-sample statistical theory. Unfortunately, this schema roughly defines a stepwise solution, which ignores the inherent correlations between genes and cells. Both results may be overfull dependent on cell clustering and easily lead to biased analysis. Meanwhile, group-level comparisons construct a separating line or hyper-plane in the original data but are difficult to capture the crucial information underlying heterogeneous structures. This could largely depress their performances to discriminate cells from new data sets.</p>
    <p id="p0035">Such issues thus turn the attention to those feature extraction methods, which enable to discover a set of informative genes (or metagenes) by preserving the supportive structure inherent in data. Actually, many models are ever developed and widely used for analogous problems in bulk RNA-seq <xref rid="b0050" ref-type="bibr">[10]</xref>, <xref rid="b0055" ref-type="bibr">[11]</xref>. For example, principal component analysis (PCA), is directly borrowed to analyze scRNA-seq data sets <xref rid="b0060" ref-type="bibr">[12]</xref>, or modified to handle noisy data (e.g., dropouts) in experiments <xref rid="b0065" ref-type="bibr">[13]</xref>. Considering high heterogeneity among cells, some nonlinear methods, such as <italic>t</italic>-SNE <xref rid="b0070" ref-type="bibr">[14]</xref> and SNN-Cliq <xref rid="b0075" ref-type="bibr">[15]</xref>, were also proposed. They aim to preserve local variations of data in a lower dimensional feature space and help improve the visualization of natural cell groups, appearing more viable for scRNA-seq profiles. However, there are two main shortcomings in these involved approaches: (i) they only retain part of the data structures in new feature space, e.g., global linear structure (e.g., PCA) or neighborhood relationship (e.g., <italic>t</italic>-SNE), which cannot take advantage of the full population heterogeneity; and (ii) consequently the obtained features are usually ineffective for annotating new samples. In most cases, these limitations further require costly re-analysis when handling merged data sets, or may take more time and memories with large amount of cells (e.g., <italic>t</italic>-SNE).</p>
    <p id="p0040">To address such challenges in real applications, we propose a novel model, which can unsupervisedly capture the overall relationship of cells and meanwhile obtain powerful discriminants (metagenes) from scRNA-seq data sets. In particular, the cell-by-cell relationship can be expressed as representations of multiple neighboring cells <xref rid="b0080" ref-type="bibr">[16]</xref>, <xref rid="b0085" ref-type="bibr">[17]</xref>, which provides information on the gross (global and local) variabilities among the inherent cell types (Supplementary note 1). The representation graph in our method is more robust to noise and data heterogeneity in profiles <xref rid="b0080" ref-type="bibr">[16]</xref>, rather than the pair-wise distances. Moreover, the metagenes are also identified to best fit in with the full representation configuration. These features carry optimal discriminative information, and can be used to discriminate unlabeled cells from new dataset.</p>
    <p id="p0045">With the model, we made the analytic pipeline of single cell discriminant analysis (scDA) for scRNA-seq data (<xref rid="f0005" ref-type="fig">Fig. 1</xref>). We separate the whole data set into two parts: discovery (or old) set and validation (or new) set. On this basis, scDA implements two main steps: identify data structures (cell quantitative affinities and cell clusters) and discriminant features (metagenes) with the discovery set, and then use them to label the cells in the validation set. Thus, scDA can avoid unnecessary re-clustering, and is actually a combinational approach simultaneously performing both clustering and classification. We demonstrate the effectiveness and efficiency of our scDA on eleven scRNA-seq data sets involving different biological systems and technologies.<fig id="f0005"><label>Fig. 1</label><caption><p>Illustrative scheme of scDA. (a) Identify cell affinities and discriminants from profiles of discovery cohort. Matrix <italic>Z</italic> and <italic>P</italic> respectively denote representation matrix and discrimination matrix, which are solved through the formula using expression matrix of <italic>X</italic>. The representation matrix can be converted to similarity matrix, then used to define cell clusters in discovery data set. (b) Classify new samples from validation cohort (i.e., <italic>X</italic>*) based on the obtained cell clusters and discriminants. Red stars highlight scDA implemented in two available ways: (i) unsupervised mode only with scRNA-seq dataset; (ii) supervised mode with data and given labels of cells in training set. In supervised mode, the prior cell annotations can help constrain scDA model either to obtain features (i.e., representation and discrimination matrices) or build classifiers (i.e., with the discriminant vectors and cell annotations). (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr1"/></fig></p>
  </sec>
  <sec id="s0010">
    <label>2</label>
    <title>Materials and methods</title>
    <sec id="s0015">
      <label>2.1</label>
      <title>Processing of scRNA-seq expression profiles</title>
      <p id="p0050">Ten scRNA-seq data sets were selected for method evaluation in total (<xref rid="t0005" ref-type="table">Table 1</xref>); we kept the originally normalized data from corresponding researches. All these datasets were log-transformed after adding a pseudo count of 1, and further preprocessed by different approaches for different feature measurements.<table-wrap position="float" id="t0005"><label>Table 1</label><caption><p>Datasets for scDA evaluation.</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Datasets</th><th><italic>k</italic></th><th><italic>N</italic></th><th>Unit</th><th>Description</th><th>Protocol</th><th>Reference</th></tr></thead><tbody><tr><td>Camp</td><td>7</td><td>777</td><td>FPKM</td><td>Human liver bud</td><td>SMARTer</td><td>Ref. <xref rid="b0165" ref-type="bibr">[33]</xref></td></tr><tr><td>Goolam</td><td>5</td><td>124</td><td>CPM</td><td>Mouse embryo</td><td>Smart-Seq2</td><td>Ref. <xref rid="b0170" ref-type="bibr">[34]</xref></td></tr><tr><td>Li</td><td>9</td><td>561</td><td>FPKM</td><td>Human cell line</td><td>SMARTer</td><td>Ref. <xref rid="b0175" ref-type="bibr">[35]</xref></td></tr><tr><td>Pollen</td><td>11</td><td>301</td><td>TPM</td><td>Human cell line</td><td>SMARTer</td><td>Ref. <xref rid="b0180" ref-type="bibr">[36]</xref></td></tr><tr><td>Lawlor</td><td>6</td><td>597</td><td>RSEM</td><td>Human pancreas</td><td>Smart-Seq2</td><td>Ref. <xref rid="b0185" ref-type="bibr">[37]</xref></td></tr><tr><td>Segerstolpe</td><td>6</td><td>1,812</td><td>RPKM</td><td>Human pancreas</td><td>Smart-Seq2</td><td>Ref. <xref rid="b0190" ref-type="bibr">[38]</xref></td></tr><tr><td>Muraro</td><td>6</td><td>1,940</td><td>Count</td><td>Human pancreas</td><td>CEL-Seq2</td><td>Ref. <xref rid="b0195" ref-type="bibr">[39]</xref></td></tr><tr><td>Enge</td><td>5</td><td>2,174</td><td>Count</td><td>Human pancreas</td><td>Smart-Seq2</td><td>Ref. <xref rid="b0200" ref-type="bibr">[40]</xref></td></tr><tr><td>Baron</td><td>6</td><td>7,742</td><td>Count</td><td>Human pancreas</td><td>inDrop</td><td>Ref. <xref rid="b0205" ref-type="bibr">[41]</xref></td></tr><tr><td>Galen</td><td>15</td><td>4,677</td><td>CPM</td><td>Human bone marrow aspirate</td><td>Seq-Well</td><td>Ref. <xref rid="b0210" ref-type="bibr">[42]</xref></td></tr><tr><td>1 M</td><td>20</td><td>1,306,127</td><td>Count</td><td>Mouse brain</td><td>10X Genomics Chromium</td><td>–</td></tr></tbody></table><table-wrap-foot><fn id="sp0055"><p><italic>k</italic>: number of groups provided by the authors.</p></fn><fn id="sp0060"><p><italic>N</italic>: number of cells.</p></fn></table-wrap-foot></table-wrap></p>
      <p id="p0055">With the four datasets from Camp to Pollen, we considered the effect of dropouts on clustering and classification, and generated series of corresponding data subsets with different numbers of genes. Since the sparsity rate is empirical and uncertain, we simply filtered out those genes when a gene has more than a certain proportion of zeros (i.e., 0.1 ∼ 0.9 by 0.1) across cells. Thus, these benchmarks were expanded to <inline-formula><mml:math id="M1" altimg="si2.svg"><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> data sets.</p>
      <p id="p0060">With pancreas datasets, we tested clustering and classification performances of scDA within and across datasets. For the first purpose, we generated two large datasets, namely Large1 and Large2. Large1 is a mix of 4 profiles including Lawlor, Segerstolpe, Muraro and Enge. Large2 is Baron. The raw data sets were firstly preprocessed, including quality control and normalization. Then Large1 sets are further batch corrected. All the process steps are similar as Haghverdi’s work<xref rid="b0090" ref-type="bibr">[18]</xref> except that we use all the genes rather than highly variable genes when removing batch effects of Large1. We abandoned these ‘Unknown’ cells and retained the other six types of cells in all. We applied scDA to Large1 under sparsity rate of 0.3 and Large2 under 0.1 to make a similar number of genes ∼ 10,000. The specialized experiments can be used to test the robustness of scDA as well as to evaluate intra-dataset classification performances. For the evaluation of inter-dataset classification performances, we keep all the common (i.e., 15,446) genes across the five pancreas datasets for fair comparison instead.</p>
      <p id="p0065">We also used the Galen data for classification evaluation across different subjects. The whole amount of genes, i.e., 27,672, passing the filtering thresholds in the original paper are used in our work. 1 M dataset (obtained from <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.3.0/1M_neurons" id="ir010">https://support.10xgenomics.com/single-cell-gene-expression/datasets/1.3.0/1M_neurons</ext-link>) is mainly used to test time efficiency and computing capacities of scDA, where top 2000 highly variable genes are remained for simplicity.</p>
    </sec>
    <sec id="s0020">
      <label>2.2</label>
      <title>Method overview</title>
      <p id="p0070">Given the processed scRNA-seq data (e.g., from discovery set), scDA could construct two matrices, defined as the ‘representation matrix’ and ‘discrimination matrix’ respectively, to accomplish two tasks: characterizing cell types, i.e. clustering in discovery set (<xref rid="f0005" ref-type="fig">Fig. 1</xref>a), and predicting new cells in unannotated set (<xref rid="f0005" ref-type="fig">Fig. 1</xref>b) based on the model-determined or prior-given labels, i.e., identified in unsupervised and supervised modes (details in <xref rid="s0025" ref-type="sec">2.3</xref>, <xref rid="s0035" ref-type="sec">2.5</xref>).</p>
      <p id="p0075">The ‘representation matrix’ describes the inherent relationship of cells, available for cell clustering, and the ‘discrimination matrix’ contains representation-learning-based features, qualified for classification. In fact, the key issue of scDA approach is to solve the two matrices that involves three basic assumptions: (i) different cell populations belong to distinct biological subspaces or processes, (ii) each cell can be mathematically represented by other cells with similar biological properties, and (iii) the intrinsic heterogeneity as described in (i)-(ii) can be approximately reconstructed on a common feature subspace.</p>
      <p id="p0080">Under assumptions (i) and (ii), which cover global differences and local similarities of underlying data, the cell-by-cell representation graph can be built based on expression profiles by subspace segmentation theory <xref rid="b0085" ref-type="bibr">[17]</xref>, <xref rid="b0095" ref-type="bibr">[19]</xref>. It presents as a sparsely filled matrix, where the coefficients are equal to zero if cells are faraway or in different clusters (Supplementary note 1), and reveals implicit subspaces of various cell populations. Note that representation-based measurement not only describes cell affinities as well as pairwise metrics, but also has robust performances against data biases or noises from scRNA-seq experiments (<xref rid="f0010" ref-type="fig">Fig. 2</xref> and <xref rid="s0090" ref-type="sec">Supplementary Figs. S1–S4</xref>). Broadly, the graph quantitatively defines intrinsic heterogeneity from cells, which is of great importance to obtain discriminant features.<fig id="f0010"><label>Fig. 2</label><caption><p>Comparative performances of scDA approach to existing methods. (a, b) Adjusted Rand index (ARI) values of clustering (a) and classification (b) for small data subsets in scDA supervised mode at different sparsity rates, e.g., from 0.8 to 0.2 by 0.2. Performances at other sparsity rates are seen in Supplementary Figs. 1 and 2. Clustering and classification are respectively abbreviated to <italic>clu</italic> and <italic>cla</italic>, which are used as footnotes in <xref rid="f0010" ref-type="fig">Fig. 2</xref>, <xref rid="f0020" ref-type="fig">Fig. 4</xref> and Supplementary Figs. 1–3, 5, 9, 10, 13. Bars with zero height indicate NA values. Error bars in (b) indicate upper 95% confidence interval of cross-validation results.</p></caption><graphic xlink:href="gr2"/></fig><fig id="f0015"><label>Fig. 3</label><caption><p>Characteristics of representation and discrimination matrices from scDA with small data sets. (a, b) Illustration of representation matrices (a) and projected data (b) from <xref rid="f0010" ref-type="fig">Fig. 2</xref>a. Column-side colors indicate the reference cell types provided by the original authors. Sample orders are the same in (a) and (b). The optimal groups estimated by the largest eigen gap are separated by black vertical lines in (b). The top discriminants (eigen vectors) occupying 5% of the total number of involved cells, were selected and marked according to eigen values. (c, d) Discriminative abilities of the example discriminants to separate model-identified cell populations between the most distant pairs (c) or neighboring groups (d). DDS, discrimination score for distant groups; NDS, discrimination score for neighboring groups (see Methods). Discrimination scores smaller than 0 are not shown. Fitness curves were created under ‘loess’ regression. <italic>P</italic>-value was calculated using Wilcoxon test.</p></caption><graphic xlink:href="gr3"/></fig><fig id="f0020"><label>Fig. 4</label><caption><p>Application of scDA on two large data sets. (a) Clustering (for discovery cohort) and classification (for validation cohort) performances in unsupervised manner with trained datasets of different sizes. For each data set, random sampling was repeated 100 times to construct the discovery sets at certain sampling rates, depicting the percentage of cell amount in total. The validation set is the rest dataset with removal of discovery set. (b) ARI difference (i.e., mean <inline-formula><mml:math id="M2" altimg="si1.svg"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mi>I</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>±</mml:mo></mml:mrow></mml:math></inline-formula><italic>s</italic>.<italic>e</italic>.) between clustering and classification performances from <xref rid="f0020" ref-type="fig">Fig. 4</xref>a. (c) Classification performance with construction of classifiers using reference labels. The dashed gray line indicates ARI of 0.9. (d) Enrichment results of marker genes with discriminant vectors from Large1 pancreas dataset. Marker genes in Fi. 4 and Supplementary Fig. S12 are obtained from CellMarker database <xref rid="b0140" ref-type="bibr">[28]</xref>. The top 5% dimensions (or discriminant vectors) of discrimination matrix is used for enrichment analysis. Discriminant vectors were ascendingly sorted according to the eigen values. The visual example is selected owing to the highest clustering accuracy at sampling rate of 8% with Large1 dataset (<italic>k</italic> = 40). Each dot indicates enrichment significance.</p></caption><graphic xlink:href="gr4"/></fig></p>
      <p id="p0085">While, it is usually considered that the number of features inherent in data is much smaller than the total number of profiled genes <xref rid="b0025" ref-type="bibr">[5]</xref>, <xref rid="b0090" ref-type="bibr">[18]</xref>. As assumed in (iii), our dimensionality reduction is constrained by the obtained representation structure (Supplementary note 2). Based on metric-learning theory <xref rid="b0100" ref-type="bibr">[20]</xref>, this approach aims to project the original data onto a subspace which best fits in with the detailed configuration of within- and between- groups <xref rid="b0105" ref-type="bibr">[21]</xref>. Therefore, the projection matrix contains the information of underlying cell differences and has more discriminating power on new objects than PCA or <italic>t</italic>-SNE.</p>
      <p id="p0090">However, it is generally impossible to simultaneously obtain the optimal solutions of the two matrices. Inspired by the phenotypic and feature (metagene) correlations, here we design an alternately iterative optimization algorithm, which is guaranteed to converge theoretically <xref rid="b0085" ref-type="bibr">[17]</xref>, <xref rid="b0095" ref-type="bibr">[19]</xref>. Our method is robust to a variety of the hyperparameter settings (Supplementary Figs. 5 and 6). We emphasize that the whole solving process forms a data-driven closed loop to alternately compute the cell-by-cell and feature-by-gene matrices until it reaches convergence. The loop ensures scDA could unbiasedly derive inherent information from (discovery) data sets.</p>
      <p id="p0095">Then, with the optimal representation matrix, scDA is capable to estimate the involved cell types through a graph-based clustering method, e.g., spectral clustering <xref rid="b0110" ref-type="bibr">[22]</xref>; and classify the unlabeled cells to the acquired assignments based on discriminant vectors, e.g., <italic>K</italic>NN classifier. The hybrid approach dispenses with re-analysis, appearing more feasible to deal with large amount of cells within or across datasets. We also provide supervised mode to accommodate valuable prior-knowledge from experiencers to obtain more reliable annotations. Regardless of running modes, the performance of scDA is considered to be closely related to the characteristics of these two matrices.</p>
    </sec>
    <sec id="s0025">
      <label>2.3</label>
      <title>Optimization problem of scDA</title>
      <p id="p0100">Suppose we describe a scRNA-seq data with <italic>g</italic> biological measurements and <italic>N</italic> samples as a matrix <inline-formula><mml:math id="M3" altimg="si3.svg"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mfenced open="[" close="]"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math></inline-formula>. scDA could learn the representation matrix <bold><italic>Z</italic></bold> and the discrimination matrix <inline-formula><mml:math id="M4" altimg="si4.svg"><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow></mml:math></inline-formula> from the input data matrix by solving the following objective function:<disp-formula id="e0005"><label>(1)</label><mml:math id="M5" altimg="si5.svg"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:mo movablelimits="false">min</mml:mo><mml:mrow><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mi>P</mml:mi></mml:mrow></mml:munder><mml:mspace width="4pt"/><mml:msub><mml:mfenced open="∥" close="∥"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>+</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>λ</mml:mi><mml:mspace width="4pt"/><mml:msub><mml:mfenced open="∥" close="∥"><mml:mrow><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>-</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>s</mml:mtext><mml:mtext>.t</mml:mtext><mml:mrow><mml:mtext>.</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mfenced open="{"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn><mml:mo>=</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M6" altimg="si6.svg"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is an <inline-formula><mml:math id="M7" altimg="si7.svg"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> matrix containing all the coefficient vectors of <inline-formula><mml:math id="M8" altimg="si8.svg"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="M9" altimg="si9.svg"><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mfenced open="|" close="|"><mml:mrow><mml:mo>∙</mml:mo></mml:mrow></mml:mfenced><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> represents the nuclear norm of the matrix, which is the sum of singular values. The projection matrix <inline-formula><mml:math id="M10" altimg="si10.svg"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>×</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> denotes the <italic>d</italic> discrimination vectors transformed from all the profiled genes and <inline-formula><mml:math id="M11" altimg="si11.svg"><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>-norm is used to measure the reconstructive error matrix due to its robustness <xref rid="b0095" ref-type="bibr">[19]</xref>. In the constraint conditions, <bold><italic>I</italic></bold> denotes the identity matrix, indicating <bold><italic>P</italic></bold> is an orthogonal subspace without redundancy. Here <bold>1</bold> is an all-one vector for normalization. And <inline-formula><mml:math id="M12" altimg="si12.svg"><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>-</mml:mo></mml:mover></mml:math></inline-formula> is the complement of <inline-formula><mml:math id="M13" altimg="si13.svg"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>, where <inline-formula><mml:math id="M14" altimg="si13.svg"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula> is a set of edges between the samples in a predefined adjacency graph. For example, if <inline-formula><mml:math id="M15" altimg="si14.svg"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M16" altimg="si15.svg"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are not neighbors, then we have<inline-formula><mml:math id="M17" altimg="si16.svg"><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>-</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>. Thus, the third constraint can guarantee the preservation of local structure underlying data. In unsupervised mode, we use <italic>K</italic> nearest neighbor (<italic>K</italic>NN) algorithm with pair-wise Euclidean distances to determine the sample adjacency graph; in supervised mode, the local constraint is fully or partly determined by prior-knowledge, e.g., known cell labels. While, parameter <italic>K</italic> is actually free to set and besides it, the equation <xref rid="e0005" ref-type="disp-formula">(1)</xref> have a tuning parameter<inline-formula><mml:math id="M18" altimg="si17.svg"><mml:mi>λ</mml:mi></mml:math></inline-formula> to balance the two terms. They both can be selected according to data properties, or settled empirically.</p>
      <p id="p0105">Next, we focus on the solution of the objective function. Considering either of the objective terms can be solved separately, we design an alternately iterative algorithm to compute one matrix by fixing the other one. The splitting problems can then be seen as follows.</p>
      <p id="p0110">(1) Solving the optimal matrix <bold><italic>Z</italic></bold> by fixing <bold><italic>P</italic></bold></p>
      <p id="p0115">Let’s convert the Eq. <xref rid="e0005" ref-type="disp-formula">(1)</xref> to an equivalent form when <bold><italic>P</italic></bold> is fixed:<disp-formula id="e0010"><label>(2)</label><mml:math id="M19" altimg="si18.svg"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:munder><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mspace width="4pt"/></mml:mrow><mml:mrow><mml:mi>Z</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mi>E</mml:mi></mml:mrow></mml:munder><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:msub><mml:mfenced open="∥" close="∥"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>+</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>λ</mml:mi><mml:mspace width="4pt"/><mml:msub><mml:mfenced open="∥" close="∥"><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>s</mml:mtext><mml:mtext>.t</mml:mtext><mml:mrow><mml:mtext>.</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mfenced open="{"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>=</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi><mml:mi>Z</mml:mi><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>+</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mn mathvariant="bold">1</mml:mn><mml:mo>=</mml:mo><mml:mn mathvariant="bold">1</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:mover><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M20" altimg="si19.svg"><mml:mrow><mml:mi mathvariant="bold-italic">E</mml:mi></mml:mrow></mml:math></inline-formula> presents the reconstructive error matrix. It can be solved via modified low-rank representation algorithm <xref rid="b0085" ref-type="bibr">[17]</xref> (Supplementary Note 1).</p>
      <p id="p0120">(2) Solving the optimal matrix <bold><italic>P</italic></bold> by fixing <bold><italic>Z</italic></bold></p>
      <p id="p0125">When <bold><italic>Z</italic></bold> is given, the substantial problem becomes as:<disp-formula id="e0015"><label>(3)</label><mml:math id="M21" altimg="si20.svg"><mml:mrow><mml:mi>P</mml:mi><mml:mo>∗</mml:mo><mml:mo linebreak="goodbreak">=</mml:mo><mml:munder><mml:mrow><mml:mo>arg</mml:mo><mml:mo movablelimits="true">min</mml:mo></mml:mrow><mml:mi>P</mml:mi></mml:munder><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:mspace width="4pt"/><mml:msub><mml:mfenced open="∥" close="∥"><mml:mrow><mml:mrow><mml:msup><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi><mml:mi>Z</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="4pt"/><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo><mml:mspace width="0.333333em"/><mml:msup><mml:mi>P</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>P</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></disp-formula></p>
      <p id="p0130">The problem <xref rid="e0015" ref-type="disp-formula">(3)</xref> can be solved using <inline-formula><mml:math id="M22" altimg="si11.svg"><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>-norm minimization technique <xref rid="b0115" ref-type="bibr">[23]</xref> (Supplementary Note 2).</p>
    </sec>
    <sec id="s0030">
      <label>2.4</label>
      <title>scDA clustering for discovery set</title>
      <p id="p0135">Given representation matrix <bold><italic>Z</italic></bold>, the corresponding affinity matrix <bold><italic>W</italic></bold> is obtained by <inline-formula><mml:math id="M23" altimg="si21.svg"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mfenced open="|" close="|"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. With the affinity graph, we used spectral clustering algorithm (e.g., RatioCut <xref rid="b0120" ref-type="bibr">[24]</xref>) to identify the underlying groups of cells. And the number of groups, i.e., <italic>k</italic>, is estimated in this work by the eigengap heuristic <xref rid="b0110" ref-type="bibr">[22]</xref>, or determined by other approaches, e.g., silhouette coefficients <xref rid="b0125" ref-type="bibr">[25]</xref>. If <bold><italic>Z</italic></bold> is constrained fully by known cell labels, clustering step can be omitted, e.g. study with Galen.</p>
    </sec>
    <sec id="s0035">
      <label>2.5</label>
      <title>scDA classification for unannotated set</title>
      <p id="p0140">For 4 small data sets, we adopted five-fold cross-validation experiments. All the cells in data are randomly separated into five folds, while each fold is treated as the testing set and the remaining folds as the training set. We use a set of discriminant vectors obtained from training set and (i) inferred labels with representation matrix or (ii) the gold-standard cell labels to build <italic>K</italic>NN classifiers, i.e., classifications in unsupervised /supervised way, for annotating testing cells. Additionally, the prediction accuracy is impacted by the number of discriminant vectors. We pick the first <italic>d</italic> eigen vectors of the discrimination matrix <bold><italic>P</italic></bold>, as they are ordered ascendingly by the eigen values.</p>
      <p id="p0145">For pancreas data sets in Results section, we have small discovery subsets, of which (i) the cell number ranges from 3% to 10% of all the cells from large datasets for classification intra-datasets, (ii) less than 10% size of Baron for classification cross-datasets, and the remaining cells as validation subsets. Under the same sizes, the paired subsets were randomly generated for 100 times. At every time, we randomly selected the same proportion of cells from all the six cell types to guarantee a full learning with training sets. Then, the classification experiments in unsupervised /supervised way are similar to the above descriptions in small data sets.</p>
      <p id="p0150">For 1 M dataset, we firstly run PCA and get the 2,000 medoids with 50 PCs as discovery landmarks for clustering, and then completed classification step.</p>
    </sec>
    <sec id="s0040">
      <label>2.6</label>
      <title>Methods comparison</title>
      <p id="p0155">SC3 (version 1.14.0), <italic>t</italic>-SNE (package Rtsne version 0.15), Seurat (version 2.3.4) and SparseDC (version 0.1.17) were also applied to the small data sets, where all four are to benchmark cell clustering, and three for classification except <italic>t</italic>-SNE. For SC3, the default parameters provided by the author are used for clustering and marker-genes identification. For <italic>t</italic>-SNE, given the existing cell types in each data set, we took the expected smallest amount of cells as its perplexity parameter, and the projected data are clustered following <italic>k-</italic>means. For Seurat, we chose the improved PCA-based clustering pipeline as representative method from several packaged dimensionality reduction models. For SparseDC, we randomly divided the cells into two groups as it requires two conditions before identifying cell types and the related marker genes. Note that for SparseDC we only selected the cell type-specific genes for classification. The number of cell clusters is inferred by the default functions for SC3 and Seurat, or directly set as original group number for SparseDC and <italic>t</italic>-SNE. The whole sets of the identified marker genes are used when built corresponding <italic>K</italic>NN classifiers for SC3, Seurat and SparseDC.</p>
    </sec>
    <sec id="s0045">
      <label>2.7</label>
      <title>Evaluation metrics</title>
      <p id="p0160">We used two metrics to evaluate the performances of scDA, one is adjusted Rand index (ARI) and the other is discrimination score (DS).</p>
      <p id="p0165">ARI is used to quantify the similarity between the reference labels and the clusters/predictions obtained by scDA and other involved methods, as the cell labels were known or ever inferred by the authors in all the applied data sets. For <italic>n</italic> objects, there are two groups denoted as <italic>a</italic> and <italic>b</italic>, and the relationship of the two groups can be summarized by a contingency table. Each entry of the table stores the number of common observations between <italic>a</italic> and <italic>b</italic>. Given the table, the ARI is calculated as<disp-formula id="e0020"><mml:math id="M24" altimg="si22.svg"><mml:mrow><mml:mi mathvariant="italic">ARI</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced open="[" close="]"><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced open="[" close="]"><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced open="[" close="]"><mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M25" altimg="si23.svg"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the entry at the <italic>i</italic>th row and <italic>j</italic>th column in the contingency table, <inline-formula><mml:math id="M26" altimg="si24.svg"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M27" altimg="si25.svg"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></inline-formula> are the marginal sums for the corresponding groups, and () represents a binomial coefficient.</p>
      <p id="p0170">The definition of DS is inspired by the fisher’s discriminant rule <xref rid="b0130" ref-type="bibr">[26]</xref> and a measure of group coherence, i.e., silhouette coefficient <xref rid="b0125" ref-type="bibr">[25]</xref>. We use it to assess how effective each projection vector (feature) is to discriminate a given pair of groups, for instance, denoted as <italic>a</italic> and <italic>b</italic>. With the cell <italic>i</italic> in <italic>a</italic>, let <italic>a</italic>(<italic>i</italic>) be the median distance of cell <italic>i</italic> to all other cells within <italic>a</italic>, and <italic>b</italic>(<italic>i</italic>) denotes the median distance of cell <italic>i</italic> to all cells in <italic>b</italic>. The DS for cell <italic>i</italic> is defined as:<disp-formula id="e0025"><mml:math id="M28" altimg="si26.svg"><mml:mrow><mml:mi mathvariant="italic">ds</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak">=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>1</mml:mtext><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.277778em"/><mml:mi>a</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.277778em"/><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mtext>if</mml:mtext><mml:mspace width="0.277778em"/><mml:mi>a</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:math></disp-formula></p>
      <p id="p0175">For simplicity, we further define distant DS (DDS) to measure the separations between the most distant groups, and neighboring DS (NDS) for neighboring groups. Both the scores range from + 1 to −1. And its median value over all the cells can then be used to measure the discriminative power of the examined feature to separate different groups. With the value bigger than 0, the feature could make positive contributions to distinguish groups. While if the value is closed to 1, it suggests that on the projected axis (or direction), cells are grouped tightly within respective clusters and far from the other clusters (similar to the Fisher’s ratio of between- to within-group distance), then indicates that the projection feature brilliantly discriminates cells from the two groups.</p>
    </sec>
    <sec id="s0050">
      <label>2.8</label>
      <title>Biological insights</title>
      <p id="p0180">We adopted GSEA approach <xref rid="b0135" ref-type="bibr">[27]</xref> to explore the biological significance of discriminant features (metagenes). Features are sorted in a descending order according to the absolute scores of <bold><italic>P</italic></bold> (i.e., discrimination matrix), and gene sets of certain biological functions or sources are then tested. After FDR correction, the significant gene sets, e.g., <italic>P</italic>-value <inline-formula><mml:math id="M29" altimg="si27.svg"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, can reveal the true biological information contained in the features. For example, when we applied scDA to the large data sets, we used the marker genes of known pancreatic cell types from CellMarker database <xref rid="b0140" ref-type="bibr">[28]</xref> to determine whether the features are interpretable by the prior knowledge. It is implemented by phenoTest package (version 1.34.0).</p>
    </sec>
  </sec>
  <sec id="s0055">
    <label>3</label>
    <title>Results</title>
    <sec id="s0060">
      <label>3.1</label>
      <title>Study on small benchmark datasets</title>
      <p id="p0185">To exploit the characteristics of representation and discrimination matrices identified by scDA, we considered four small scRNA-seq datasets with well-defined cell types and different sequencing protocols (<xref rid="t0005" ref-type="table">Table 1</xref>). As the representation graph is used to identify cell groups, and with discriminant vectors together to predict labels of new cells, we simply evaluate the two types of matrices by clustering/classification accuracies. We also conducted robustness tests using series of data subsets with different sparsity rates (see Methods). Note that both matrices and clustering/classification performances are assessed by adjusted Rand index (see Methods), which scores closer to 1 when the tested labels are similar to gold-standard ones. Here, we considered four established methods: SC3, <italic>t</italic>-SNE, Seurat<xref rid="b0145" ref-type="bibr">[29]</xref> and SparseDC for fair comparisons.</p>
      <p id="p0190">In respect of clustering, scDA performed generally better than other involved methods, or pretty close to the best results (<xref rid="f0010" ref-type="fig">Fig. 2</xref>a and <xref rid="s0090" ref-type="sec">Supplementary Fig. S1</xref>). It is remarkable that scDA was the most stable method with respect to the percent of dropouts. Overall, the clustering achievements reveal that scDA can recognize the inherent data structures, and this feature is crucially important as the discriminative projection learns from such representation configuration (<xref rid="f0005" ref-type="fig">Fig. 1</xref>a). To classify unlabeled cells with discriminant vectors, scDA outperformed the three tested models (<italic>t</italic>-SNE not included): stable and accurate across the spectrum of input gene sets (<xref rid="f0010" ref-type="fig">Fig. 2</xref>b and <xref rid="s0090" ref-type="sec">Supplementary Figs. S2, S3</xref>). While, the second best method is SC3, which uses marker genes from binary classifiers. But the individual markers are less informative to discriminate different cell clusters with the increase of sample size; scDA showed more obvious superiority, such as on Li and Camp data sets, in both unsupervised and supervised modes. Furthermore, we compared clustering time cost of the best two algorithms and found scDA (implemented in python) also computes faster than SC3 (<xref rid="s0090" ref-type="sec">Supplementary Fig. S7</xref>).</p>
      <p id="p0195">In addition to these simple assessments, the cell-by-cell representation matrices could provide more affinity details than plain separations (<xref rid="f0015" ref-type="fig">Fig. 3</xref>a). Their illustrations appear nearly block-diagonal, indicating cells are tightly grouped in the identified clusters. Such “block” structures even can be seen in individual dimensions of the discrimination space (<xref rid="f0015" ref-type="fig">Fig. 3</xref>b). Here we use discrimination score (DS) to evaluate how powerful each single feature can discriminate different cell types (see Methods). We also compared scDA to principal component analysis (PCA), which also yields orthogonal rotations but without restrictions of cell relations. According to the scores, these projection vectors derived from scDA are overwhelmingly more favorable for distinct cell populations (<xref rid="f0015" ref-type="fig">Fig. 3</xref>c, d). Together with the minor differences between clustering and classifications (<xref rid="s0090" ref-type="sec">Supplementary Fig. S4</xref>), all the results showed that the scDA projection space with the preservation of overall-relationship is indeed spanned by remarkable discriminant vectors.</p>
      <p id="p0200">Above all, scDA model can unsupervisedly recognize the intrinsic sample patterns, and also obtain a number of powerful discriminants. These characteristics allow us to apply scDA to large scRNA-seq profiles or across datasets.</p>
    </sec>
    <sec id="s0065">
      <label>3.2</label>
      <title>Performance within large benchmark datasets</title>
      <p id="p0205">Inspired by the performance of scDA on small data sets, we evaluated the applicability of scDA with two large scRNA-seq profiles denoted as Large1 and Large2 (see Methods). Both data sets are generated to study human pancreas, a highly heterogeneous tissue with several determined cell types (<xref rid="s0090" ref-type="sec">Supplementary Table S1</xref>). The difference between them is that some cell groups inherent in the mixed data set (after batch correction), i.e., Large1, present less coherent than those in the single-sourced Large2 (<xref rid="s0090" ref-type="sec">Supplementary Fig. S8</xref>), thereby enabling to make comparative and contrasted evaluations with datasets in different qualities. Furthermore, we expected capacity of scDA to use small subsets of cells to discriminate the majority of cells, and thus conducted random experiments varying different sample sizes of discovery set (see Methods). Here, we use clustering ARI, classification ARI and their agreement to assess the utility of scDA.</p>
      <p id="p0210">Firstly, we did unsupervised clustering with training data sets, and used the inferred labels to classify the other unlabeled cells. The results show that classification performance has strong correlation with clustering qualities in both large datasets (<xref rid="f0020" ref-type="fig">Fig. 4</xref>a and <xref rid="s0090" ref-type="sec">Supplementary Figs. S9, S10</xref>). However, more misclassifications were made when model learnt data patterns from very few samples, e.g., less than 5% of the total cells. This is probably caused due to the unbalanced distribution of given cell types (<xref rid="s0090" ref-type="sec">Supplementary Table S1</xref>), and small sampling ratio is more likely to obtain invalid training sets. Moreover, such mistakes still may occur even if sampling ratio increased in the dataset of Large1. Using this mixed dataset, we can also see more variances of ARI difference (<xref rid="f0020" ref-type="fig">Fig. 4</xref>b). The unsatisfactory performances may be subject to data qualities, for Large1 is multi-sourced and some confounding effects may still exist even after batch correction. While such situations get greatly improved to obtain accuracies and consistencies very close to those outcomes in Large2 when we use more training cells, e.g., 8% but still less than 10% of the total cell amount for Large1 data (<xref rid="f0020" ref-type="fig">Fig. 4</xref>b). All the results suggest the robustness of scDA to data coherences.</p>
      <p id="p0215">Furthermore, we then constructed the classifier with the reference cell labels instead, and also observed the classification can achieve comparably reliable outcomes between Large1 and Large2 when training the classifier with cells occupying 8% ∼ 10% of total sample size (<xref rid="f0020" ref-type="fig">Fig. 4</xref>c). Our discriminant vectors show fair discrimination capacities to separate the farthest or closest cell groups (<xref rid="s0090" ref-type="sec">Supplementary Fig. S11</xref>) and these metagenes are found highly enriched with the known cell markers (<xref rid="f0020" ref-type="fig">Fig. 4</xref>d and <xref rid="s0090" ref-type="sec">Supplementary Fig. S12</xref>). All the results indicate the discrimination matrix can capture true biological variances inherent in scRNA-seq datasets; thus, with the matrix, scDA can well predict the unlabeled cells in unsupervised (<xref rid="s0090" ref-type="sec">Supplementary Fig. S10</xref>) or supervised (<xref rid="f0020" ref-type="fig">Fig. 4</xref>c) manners. Besides, we were able to analyze a very large 10X dataset with more than 1.3 million cells and 20 clusters, generating results in good agreement with its original annotations (<xref rid="s0090" ref-type="sec">Supplementary Table S2</xref>). Taken together, the above analyses show excellent generalization of scDA, enabling the model to use a handful of cells to well predict the labels of abundant cells within data sets.</p>
    </sec>
    <sec id="s0070">
      <label>3.3</label>
      <title>Classification evaluation across datasets</title>
      <p id="p0220">We next tested the prediction ability of scDA across datasets as batches or batch effects are really common between different scRNA-seq experiments <xref rid="b0150" ref-type="bibr">[30]</xref>, e.g., from different labs, sequencing protocols or subjects. An approach, which could handle cross-dataset classification, is more preferred and practical. We used the human pancreas and bone marrow aspirate datasets (<xref rid="t0005" ref-type="table">Table 1</xref>) for inter-dataset evaluation, and made directional classifications where to use small datasets to predict large datasets.</p>
      <p id="p0225">We firstly tested classification performance of scDA across labs/protocols with five pancreas data sets. Specially, we made extreme tests to have scDA build classifiers from cells no more than 10% of Baron, the largest of pancreas profiles, and randomly divided all other datasets into different subsets, i.e., 2 folds for Lawlor, 3 folds for Segerstolpe, Muraro and Enge. Applied to the subsets, scDA obtained good cell annotations within each dataset in unsupervised way (<xref rid="s0090" ref-type="sec">Supplementary Fig. S13</xref>), consistent with our findings in previous sub-section. While, we then built classifiers with identified discrimination matrix and cell gold labels, and summarized their performances in <xref rid="f0025" ref-type="fig">Fig. 5</xref>a. All the classifiers performed well on predicting Lawlor’s dataset due to its small amount of cells. However, the classifiers originated from Enge subsets predicted the other datasets not as well, but still acceptable (ARI<inline-formula><mml:math id="M30" altimg="si28.svg"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0.79</mml:mn></mml:mrow></mml:math></inline-formula>), as the rest classifiers (<xref rid="f0025" ref-type="fig">Fig. 5</xref>a). This may be because Enge is the only dataset that doesn’t contain PP (pancreatic polypeptide) cells (<xref rid="s0090" ref-type="sec">Supplementary Table S2</xref>) and produces incomplete classifiers. While, from Lawlor, Segerstolpe, Muraro subsets, the classifiers were theoretically unbiasedly trained, and performed much better on across-dataset classifications, even on predicting the largest dataset, i.e., Baron, with unsupervised cell annotations (<xref rid="s0090" ref-type="sec">Supplementary Fig. S14</xref>). We then used principal component analysis to project our discrimination space onto three-dimensional visualization space (<xref rid="f0025" ref-type="fig">Fig. 5</xref>b and c), which clearly shows the “shifted gaps” across the involved datasets. These gaps explicitly reveal external differences between batches. The results indicate that the scDA discrimination space preserves biological variances underlying trained dataset, therefore it allows to label unannotated dataset of the same tissue or similar condition in regardless of batch effects.<fig id="f0025"><label>Fig. 5</label><caption><p>Classification performance across pancreatic datasets. (a) Heatmap of cross-dataset classification ARI values. Each dataset in discovery set is randomly divided into 2 or 3 folds to unsupervisedly get representation and discrimination matrices. Classifiers with prior-provided cell annotations are to classify the whole cells in each prediction dataset. Classification ARI values are shown explicitly. Blue striped rectangle means NA value. (b, c) Visualization of trained and predicted cells in 3-dimenstional discrimination space. Fold2 of Muraro is used to train classifier for classification of other two Muraro folds in (b); then also to predict cell labels across Lawlor, Segerstolpe, Enge and Baron data sets in (c) Each point in graph represents a cell and colored by two annotation categories: data source and cell type. Cells are colored by given labels in training fold and predicted labels in testing datasets. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></caption><graphic xlink:href="gr5"/></fig></p>
      <p id="p0230">We next tested classification performance of scDA across subjects with bone marrow (BM) aspirate dataset, which contains 4 human donors named as BM1 to BM4 according to the ascending order of available cell amounts. These sets have a total of 15 cell types belonging to 4 developmental lineages (<xref rid="s0090" ref-type="sec">Supplementary Fig. S15</xref>). To guarantee that the training set has at least 10 cells for one cell type, we trained with BMs1–3, i.e., about 25% the size of BM4, to classify cells in BM4. We first obtained corresponding discrimination matrix to the representation matrix, which was initially constrained by <italic>K</italic>NN using given cell annotations of BMs1-3. The top 14 discriminant vectors contribute most to different types of cells (<xref rid="f0030" ref-type="fig">Fig. 6</xref>a), thus are then used to build the classifier for BM4. Subsequently, we compared the classified assignments with the original annotations (<xref rid="f0030" ref-type="fig">Fig. 6</xref>b). Around 83.0% of cells are classified correctly according to their cell types. Among the mis-classified cells (17.0%), 13.0% are assigned to their related cell types within the same lineages, or predicted between HSC/Prog and other committed progenitor cells (2.4%), early Ery and proB, GMP (1.0%). It means that our mis-classifications mainly come from predicting the intermediated states or cell types with differentiation potency along the continuum of cells. Besides, we can also observe the putative differentiation relationships from undifferentiated cells to other lineages with our discrimination space (<xref rid="f0030" ref-type="fig">Fig. 6</xref>c and <xref rid="s0090" ref-type="sec">Supplementary Fig. S16</xref>). And the expression of marker signatures also supports our classification performance across different donors (<xref rid="f0030" ref-type="fig">Fig. 6</xref>d).<fig id="f0030"><label>Fig. 6</label><caption><p>Classification performance using subjects of BMs1-3 to annotate BM4. (a) Scatter chart of discrimination scores of top 20 discriminant vectors. We select the top discriminants by: (i) before the steep drop of median DDS, and (ii) with median NDS bigger than 0. (b) Prediction comparison for 3,738 hematopoietic cells in BM4. The square of heatmap represents the ratio of cells in prediction class over all cells of the same annotation. (c) Visualization of BMs1-4 in 3-dimenstional discrimination space. Dashed lines with arrows imply committed lineages from undifferentiated to mature states, which are inferred by cell labels (Supplementary Fig. 16). (d) Expression heatmap of 55 selected cell-type-specific genes (rows) across our annotated cell classes (columns). The median expression was calculated for each cell group. HSC: Hematopoietic stem cell; Prog: Progenitor; early Ery: Early erythroid progenitor; late Ery: Late erythroid progenitor; pro B: Progenitor B cell; B: Mature B cell; Plasma: Plasma cell; T: Naïve T cell; CTL: Cytotoxic T Lymphocyte; NK: Natural Killer cell; GMP: Granulocyte-macrophage progenitor; pro Mono: Promonocyte; Mono: Monocyte; pDC: Plasmacytoid dendritic cell; cDC: Conventional dendritic cell.</p></caption><graphic xlink:href="gr6"/></fig></p>
      <p id="p0235">Overall, the evaluation of cross-dataset classification performance revalidates the effectiveness of our discrimination matrix to predict large amount of cells with small dataset. The discrimination space embodies inherent information from discovery dataset, that is, it is capable to overcome batches or batch effects for new dataset. Meanwhile, our approach allows to accommodate more prior knowledge, making the results of great biological interpretation.</p>
    </sec>
  </sec>
  <sec id="s0075">
    <label>4</label>
    <title>Discussion</title>
    <p id="p0240">Identifying genes (or metagenes) to discriminate different cell populations is effective to annotate large amount of cells within or across scRNA-seq data sets. The challenge is that cell states are temporally and spatially heterogeneous but always unknown in biological systems. While, existing methods usually adopt (i) label-based discrimination approaches, e.g., scID <xref rid="b0155" ref-type="bibr">[31]</xref>, which needs a reference annotation to identify cluster or cell type specific genes; or (ii) unsupervised dimensionality reductions, e.g., PCA, <italic>t</italic>-SNE, to learn hidden structures from unlabeled cells. Supervised discrimination methods can be used to infer unlabeled cells in validation datasets, but limited to the biological variances and cell compositions underlying the discovery dataset. While, unsupervised methods transform genes to metagenes, generally without the ability to transfer cell labels between different datasets. In fact, neither of the two types accounts for overall affinities inherent in multiple cell populations, thereby easily resulting in misclassification on new data. We demonstrated that our scDA method is able to successfully achieve powerful discriminant features in both unsupervised and supervised manners using eleven scRNA-seq data sets.</p>
    <p id="p0245">The notable advantage of scDA is that the model finds out discriminant features based on cell-by-cell representation graph. The graph quantitatively reveals both local (within cell groups) and global (across different groups) variations in data sets, and is robust to data heterogeneity. scDA features learnt from full representation configuration, accommodate affinity differences between any pairs of cells, and present more specific for cell discrimination. Moreover, scDA uses an alternately iterative solution to take advantage of the inherent correlations between samples and features. Such approach makes our model data driven and can correct the obtained information from data sets. The optimal results become reliable when considering the underlying heterogeneity across profiled cells.</p>
    <p id="p0250">We demonstrated that scDA accurately predicts plentiful unlabeled cells after obtaining discriminant metagenes and estimating potential cell types from a small amount of cells, such that unnecessary re-analysis can be avoided for large studies. The differences between estimation and prediction are proven quite small, suggesting that scDA is flexible to only implement the objective of recognizing cell populations for those small or finished studies. Moreover, the separable pipeline of scDA adopts spectral clustering and <italic>K</italic>NN classification in this work, but it also allows integrations of other useful approaches for scRNA-seq data, for example, hierarchical clustering or support vector machine algorithm. Theoretically, even the representation matrix of core model can be alternatively initialized (rather than <italic>K</italic>NN graph), e.g., with prior knowledge of cell groups, which helps to obtain more interpretable outcomes. Its potential scalability would deal with different practical issues and thus be well in conjunction with other information or analytical procedures <xref rid="b0160" ref-type="bibr">[32]</xref>.</p>
  </sec>
  <sec id="s0080">
    <title>CRediT authorship contribution statement</title>
    <p id="p0255"><bold>Qianqian Shi:</bold> Conceptualization, Methodology, Investigation, Formal analysis, Writing - original draft, Writing - review &amp; editing, Visualization, Project administration, Funding acquisition. <bold>Xinxing Li:</bold> Software, Validation. <bold>Qirui Peng:</bold> Data curation. <bold>Chuanchao Zhang:</bold> Conceptualization, Methodology, Writing - review &amp; editing. <bold>Luonan Chen:</bold> Writing - review &amp; editing, Supervision, Project administration, Funding acquisition.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Declaration of Competing Interest</title>
    <p id="p0260">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
  </sec>
</body>
<back>
  <ref-list id="bi005">
    <title>References</title>
    <ref id="b0005">
      <label>1</label>
      <element-citation publication-type="journal" id="h0005">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Fei</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Mapping the mouse cell atlas by microwell-seq</article-title>
        <source>Cell</source>
        <volume>172</volume>
        <year>2018</year>
        <fpage>1091</fpage>
        <pub-id pub-id-type="pmid">29474909</pub-id>
      </element-citation>
    </ref>
    <ref id="b0010">
      <label>2</label>
      <element-citation publication-type="journal" id="h0010">
        <person-group person-group-type="author">
          <name>
            <surname>Regev</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>E.S.</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Benoist</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>The human cell atlas</article-title>
        <source>Elife</source>
        <volume>6</volume>
        <year>2017</year>
      </element-citation>
    </ref>
    <ref id="b0015">
      <label>3</label>
      <element-citation publication-type="journal" id="h0015">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>A.P.</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>A.K.</given-names>
          </name>
          <name>
            <surname>Gillespie</surname>
            <given-names>S.M.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>
        <source>Science</source>
        <volume>344</volume>
        <year>2014</year>
        <fpage>1396</fpage>
        <lpage>1401</lpage>
        <pub-id pub-id-type="pmid">24925914</pub-id>
      </element-citation>
    </ref>
    <ref id="b0020">
      <label>4</label>
      <element-citation publication-type="journal" id="h0020">
        <person-group person-group-type="author">
          <name>
            <surname>Saliba</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Westermann</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Gorski</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Vogel</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq: advances and future challenges</article-title>
        <source>Nucleic Acids Res</source>
        <volume>42</volume>
        <year>2014</year>
        <fpage>8845</fpage>
        <lpage>8860</lpage>
        <pub-id pub-id-type="pmid">25053837</pub-id>
      </element-citation>
    </ref>
    <ref id="b0025">
      <label>5</label>
      <element-citation publication-type="journal" id="h0025">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>V.Y.</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>
        <source>Nat Rev Genet</source>
        <volume>20</volume>
        <year>2019</year>
        <fpage>273</fpage>
        <lpage>282</lpage>
        <pub-id pub-id-type="pmid">30617341</pub-id>
      </element-citation>
    </ref>
    <ref id="b0030">
      <label>6</label>
      <element-citation publication-type="journal" id="h0030">
        <person-group person-group-type="author">
          <name>
            <surname>Abdelaal</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Michielsen</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Cats</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Hoogduin</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <volume>20</volume>
        <year>2019</year>
        <fpage>194</fpage>
        <pub-id pub-id-type="pmid">31500660</pub-id>
      </element-citation>
    </ref>
    <ref id="b0035">
      <label>7</label>
      <element-citation publication-type="journal" id="h0035">
        <person-group person-group-type="author">
          <name>
            <surname>Hwang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J.H.</given-names>
          </name>
          <name>
            <surname>Bang</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA sequencing technologies and bioinformatics pipelines</article-title>
        <source>Exp Mol Med</source>
        <volume>50</volume>
        <year>2018</year>
        <fpage>96</fpage>
      </element-citation>
    </ref>
    <ref id="b0040">
      <label>8</label>
      <element-citation publication-type="journal" id="h0040">
        <person-group person-group-type="author">
          <name>
            <surname>Kiselev</surname>
            <given-names>V.Y.</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Schaub</surname>
            <given-names>M.T.</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Yiu</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>
        <source>Nat Methods</source>
        <volume>14</volume>
        <year>2017</year>
        <fpage>483</fpage>
        <lpage>486</lpage>
        <pub-id pub-id-type="pmid">28346451</pub-id>
      </element-citation>
    </ref>
    <ref id="b0045">
      <label>9</label>
      <element-citation publication-type="journal" id="h0045">
        <person-group person-group-type="author">
          <name>
            <surname>Barron</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>A sparse differential clustering algorithm for tracing cell type changes via single-cell RNA-sequencing data</article-title>
        <source>Nucleic Acids Res</source>
        <volume>46</volume>
        <year>2018</year>
        <object-id pub-id-type="publisher-id">e14</object-id>
      </element-citation>
    </ref>
    <ref id="b0050">
      <label>10</label>
      <element-citation publication-type="journal" id="h0050">
        <person-group person-group-type="author">
          <name>
            <surname>Jean-Philippe</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Pablo</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>T.R.</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>J.P.</given-names>
          </name>
        </person-group>
        <article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <volume>101</volume>
        <year>2004</year>
        <fpage>4164</fpage>
        <lpage>4169</lpage>
        <pub-id pub-id-type="pmid">15016911</pub-id>
      </element-citation>
    </ref>
    <ref id="b0055">
      <label>11</label>
      <element-citation publication-type="journal" id="h0055">
        <person-group person-group-type="author">
          <name>
            <surname>Markus</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>What is principal component analysis?</article-title>
        <source>Nat Biotechnol</source>
        <volume>26</volume>
        <year>2008</year>
        <fpage>303</fpage>
        <pub-id pub-id-type="pmid">18327243</pub-id>
      </element-citation>
    </ref>
    <ref id="b0060">
      <label>12</label>
      <element-citation publication-type="journal" id="h0060">
        <person-group person-group-type="author">
          <name>
            <surname>Barbara</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Brownfield</surname>
            <given-names>D.G.</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>A.R.</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>N.F.</given-names>
          </name>
          <name>
            <surname>Mantalas</surname>
            <given-names>G.L.</given-names>
          </name>
        </person-group>
        <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>
        <source>Nature</source>
        <volume>509</volume>
        <year>2014</year>
        <fpage>371</fpage>
        <lpage>375</lpage>
        <pub-id pub-id-type="pmid">24739965</pub-id>
      </element-citation>
    </ref>
    <ref id="b0065">
      <label>13</label>
      <element-citation publication-type="journal" id="h0065">
        <person-group person-group-type="author">
          <name>
            <surname>Pierson</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>ZIFA: dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>
        <source>Genome Biol</source>
        <volume>16</volume>
        <year>2015</year>
        <fpage>241</fpage>
        <pub-id pub-id-type="pmid">26527291</pub-id>
      </element-citation>
    </ref>
    <ref id="b0070">
      <label>14</label>
      <element-citation publication-type="journal" id="h0070">
        <person-group person-group-type="author">
          <name>
            <surname>Laurens</surname>
            <given-names>V.D.M.</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Visualizing Data using t-SNE</article-title>
        <source>J Mach Learn Res</source>
        <volume>9</volume>
        <year>2008</year>
        <fpage>2579</fpage>
        <lpage>2605</lpage>
      </element-citation>
    </ref>
    <ref id="b0075">
      <label>15</label>
      <element-citation publication-type="journal" id="h0075">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zhengchang</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Identification of cell types from single-cell transcriptomes using a novel clustering method</article-title>
        <source>Bioinformatics</source>
        <volume>31</volume>
        <year>2015</year>
        <fpage>1974</fpage>
        <lpage>1980</lpage>
        <pub-id pub-id-type="pmid">25805722</pub-id>
      </element-citation>
    </ref>
    <ref id="b0080">
      <label>16</label>
      <element-citation publication-type="journal" id="h0080">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Robust subspace segmentation via low-rank representation</article-title>
        <source>IEEE Trans Cybern</source>
        <volume>44</volume>
        <year>2014</year>
        <fpage>1432</fpage>
        <lpage>1445</lpage>
        <pub-id pub-id-type="pmid">24196982</pub-id>
      </element-citation>
    </ref>
    <ref id="b0085">
      <label>17</label>
      <element-citation publication-type="journal" id="h0085">
        <person-group person-group-type="author">
          <name>
            <surname>Zhuang</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>A.Y.</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Locality-preserving low-rank representation for graph construction from nonlinear manifolds</article-title>
        <source>Neurocomputing</source>
        <volume>175</volume>
        <year>2015</year>
        <fpage>715</fpage>
        <lpage>722</lpage>
      </element-citation>
    </ref>
    <ref id="b0090">
      <label>18</label>
      <element-citation publication-type="journal" id="h0090">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Lun</surname>
            <given-names>A.T.L.</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>J.C.</given-names>
          </name>
        </person-group>
        <article-title>Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors</article-title>
        <source>Nat Biotechnol</source>
        <volume>36</volume>
        <year>2018</year>
        <fpage>421</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="pmid">29608177</pub-id>
      </element-citation>
    </ref>
    <ref id="b0095">
      <label>19</label>
      <element-citation publication-type="journal" id="h0095">
        <person-group person-group-type="author">
          <name>
            <surname>Wai Keung</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Zhihui</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Jiajun</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Xiaozhao</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Yuwu</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Low-rank embedding for robust image feature extraction</article-title>
        <source>IEEE Trans Image Process</source>
        <volume>26</volume>
        <year>2017</year>
        <fpage>2905</fpage>
        <lpage>2917</lpage>
        <pub-id pub-id-type="pmid">28410104</pub-id>
      </element-citation>
    </ref>
    <ref id="b0100">
      <label>20</label>
      <element-citation publication-type="journal" id="h0100">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>An overview of distance metric learning</article-title>
        <source>Proc Computer Vision &amp; Pattern Recognition</source>
        <year>2007</year>
      </element-citation>
    </ref>
    <ref id="b0105">
      <label>21</label>
      <element-citation publication-type="journal" id="h0105">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>T.F.</given-names>
          </name>
          <name>
            <surname>Ferry</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Discriminant analysis using non-metric multidimensional scaling</article-title>
        <source>Pattern Recogn</source>
        <volume>26</volume>
        <year>1993</year>
        <fpage>145</fpage>
        <lpage>153</lpage>
      </element-citation>
    </ref>
    <ref id="b0110">
      <label>22</label>
      <element-citation publication-type="journal" id="h0110">
        <person-group person-group-type="author">
          <name>
            <surname>Von Luxburg</surname>
            <given-names>U.</given-names>
          </name>
        </person-group>
        <article-title>A tutorial on spectral clustering</article-title>
        <source>Statist Comput</source>
        <volume>17</volume>
        <year>2007</year>
        <fpage>395</fpage>
        <lpage>416</lpage>
      </element-citation>
    </ref>
    <ref id="b0115">
      <label>23</label>
      <element-citation publication-type="journal" id="h0115">
        <person-group person-group-type="author">
          <name>
            <surname>Argyriou</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Evgeniou</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Pontil</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Multi-task feature learning</article-title>
        <source>Adv Neural Inform Process Syst</source>
        <volume>19</volume>
        <year>2006</year>
        <fpage>41</fpage>
        <lpage>48</lpage>
      </element-citation>
    </ref>
    <ref id="b0120">
      <label>24</label>
      <element-citation publication-type="journal" id="h0120">
        <person-group person-group-type="author">
          <name>
            <surname>Hagen</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Kahng</surname>
            <given-names>A.B.</given-names>
          </name>
        </person-group>
        <article-title>New spectral methods for ratio cut partitioning and clustering</article-title>
        <source>IEEE Trans Comput Aided Des Integr Circuits Syst</source>
        <volume>11</volume>
        <year>1992</year>
        <fpage>1074</fpage>
        <lpage>1085</lpage>
      </element-citation>
    </ref>
    <ref id="b0125">
      <label>25</label>
      <element-citation publication-type="journal" id="h0125">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>P.J.</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <volume>20</volume>
        <year>1999</year>
        <fpage>53</fpage>
        <lpage>65</lpage>
      </element-citation>
    </ref>
    <ref id="b0130">
      <label>26</label>
      <element-citation publication-type="journal" id="h0130">
        <person-group person-group-type="author">
          <name>
            <surname>Lachenbruch</surname>
            <given-names>P.A.</given-names>
          </name>
          <name>
            <surname>Goldstein</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Discriminant analysis</article-title>
        <source>Biometrics</source>
        <year>1979</year>
        <fpage>69</fpage>
        <lpage>85</lpage>
      </element-citation>
    </ref>
    <ref id="b0135">
      <label>27</label>
      <element-citation publication-type="journal" id="h0135">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>V.K.</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>B.L.</given-names>
          </name>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <volume>102</volume>
        <year>2005</year>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="b0140">
      <label>28</label>
      <element-citation publication-type="journal" id="h0140">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Cell marker: a manually curated resource of cell markers in human and mous<italic>e</italic></article-title>
        <source>Nucleic Acids Res</source>
        <volume>47</volume>
        <year>2019</year>
        <fpage>D721</fpage>
        <lpage>D728</lpage>
        <pub-id pub-id-type="pmid">30289549</pub-id>
      </element-citation>
    </ref>
    <ref id="b0145">
      <label>29</label>
      <element-citation publication-type="journal" id="h0145">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat Biotechnol</source>
        <volume>36</volume>
        <year>2018</year>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="b0150">
      <label>30</label>
      <element-citation publication-type="journal" id="h0150">
        <person-group person-group-type="author">
          <name>
            <surname>Tran</surname>
            <given-names>H.T.N.</given-names>
          </name>
          <name>
            <surname>Ang</surname>
            <given-names>K.S.</given-names>
          </name>
          <name>
            <surname>Chevrier</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>N.Y.S.</given-names>
          </name>
        </person-group>
        <article-title>A benchmark of batch-effect correction methods for single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <volume>21</volume>
        <year>2020</year>
        <fpage>12</fpage>
        <pub-id pub-id-type="pmid">31948481</pub-id>
      </element-citation>
    </ref>
    <ref id="b0155">
      <label>31</label>
      <element-citation publication-type="journal" id="h0155">
        <person-group person-group-type="author">
          <name>
            <surname>Boufea</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Seth</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Batada</surname>
            <given-names>N.N.</given-names>
          </name>
        </person-group>
        <article-title>scID uses discriminant analysis to identify transcriptionally equivalent cell types across single-cell RNA-Seq data with batch effect</article-title>
        <source>iScience</source>
        <volume>23</volume>
        <year>2020</year>
        <object-id pub-id-type="publisher-id">100914</object-id>
      </element-citation>
    </ref>
    <ref id="b0160">
      <label>32</label>
      <element-citation publication-type="journal" id="h0160">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Pattern fusion analysis by adaptive alignment of multiple heterogeneous omics data</article-title>
        <source>Bioinformatics</source>
        <volume>33</volume>
        <year>2017</year>
        <fpage>2706</fpage>
        <lpage>2714</lpage>
        <pub-id pub-id-type="pmid">28520848</pub-id>
      </element-citation>
    </ref>
    <ref id="b0165">
      <label>33</label>
      <element-citation publication-type="journal" id="h0165">
        <person-group person-group-type="author">
          <name>
            <surname>Camp</surname>
            <given-names>J.G.</given-names>
          </name>
          <name>
            <surname>Sekine</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Gerber</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Loeffler-Wirth</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Binder</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Multilineage communication regulates human liver bud development from pluripotency</article-title>
        <source>Nature</source>
        <volume>546</volume>
        <year>2017</year>
        <fpage>533</fpage>
        <lpage>538</lpage>
        <pub-id pub-id-type="pmid">28614297</pub-id>
      </element-citation>
    </ref>
    <ref id="b0170">
      <label>34</label>
      <element-citation publication-type="journal" id="h0170">
        <person-group person-group-type="author">
          <name>
            <surname>Goolam</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Scialdone</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Graham</surname>
            <given-names>S.J.L.</given-names>
          </name>
          <name>
            <surname>Macaulay</surname>
            <given-names>I.C.</given-names>
          </name>
          <name>
            <surname>Jedrusik</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Heterogeneity in Oct4 and Sox2 targets biases cell fate in 4-cell mouse embryos</article-title>
        <source>Cell</source>
        <volume>165</volume>
        <year>2016</year>
        <fpage>61</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="pmid">27015307</pub-id>
      </element-citation>
    </ref>
    <ref id="b0175">
      <label>35</label>
      <element-citation publication-type="journal" id="h0175">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Courtois</surname>
            <given-names>E.T.</given-names>
          </name>
          <name>
            <surname>Sengupta</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K.H.</given-names>
          </name>
        </person-group>
        <article-title>Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors</article-title>
        <source>Nat Genet</source>
        <volume>49</volume>
        <year>2017</year>
        <fpage>708</fpage>
        <lpage>718</lpage>
        <pub-id pub-id-type="pmid">28319088</pub-id>
      </element-citation>
    </ref>
    <ref id="b0180">
      <label>36</label>
      <element-citation publication-type="journal" id="h0180">
        <person-group person-group-type="author">
          <name>
            <surname>Pollen</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Nowakowski</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Shuga</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Leyrat</surname>
            <given-names>A.A.</given-names>
          </name>
        </person-group>
        <article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title>
        <source>Nat Biotechnol</source>
        <volume>32</volume>
        <year>2014</year>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <pub-id pub-id-type="pmid">25086649</pub-id>
      </element-citation>
    </ref>
    <ref id="b0185">
      <label>37</label>
      <element-citation publication-type="journal" id="h0185">
        <person-group person-group-type="author">
          <name>
            <surname>Lawlor</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>George</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Bolisetty</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kursawe</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptomes identify human islet cell signatures and reveal cell-type-specific expression changes in type 2 diabetes</article-title>
        <source>Genome Res</source>
        <volume>27</volume>
        <year>2017</year>
        <fpage>208</fpage>
        <lpage>222</lpage>
        <pub-id pub-id-type="pmid">27864352</pub-id>
      </element-citation>
    </ref>
    <ref id="b0190">
      <label>38</label>
      <element-citation publication-type="journal" id="h0190">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Eliasson</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Andersson</surname>
            <given-names>E.M.</given-names>
          </name>
          <name>
            <surname>Andreasson</surname>
            <given-names>A.C.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab</source>
        <volume>24</volume>
        <year>2016</year>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="b0195">
      <label>39</label>
      <element-citation publication-type="journal" id="h0195">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Dharmadhikari</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Grun</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Groen</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Dielen</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human Pancreas</article-title>
        <source>Cell Syst</source>
        <volume>3</volume>
        <year>2016</year>
        <fpage>385</fpage>
        <lpage>394.e383</lpage>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="b0200">
      <label>40</label>
      <element-citation publication-type="journal" id="h0200">
        <person-group person-group-type="author">
          <name>
            <surname>Enge</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Arda</surname>
            <given-names>H.E.</given-names>
          </name>
          <name>
            <surname>Mignardi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Beausang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Bottino</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Single-Cell Analysis of Human Pancreas Reveals Transcriptional Signatures of Aging and Somatic Mutation Patterns</article-title>
        <source>Cell</source>
        <volume>171</volume>
        <year>2017</year>
        <fpage>321</fpage>
        <lpage>330.e314</lpage>
        <pub-id pub-id-type="pmid">28965763</pub-id>
      </element-citation>
    </ref>
    <ref id="b0205">
      <label>41</label>
      <element-citation publication-type="journal" id="h0205">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Wolock</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Faust</surname>
            <given-names>A.L.</given-names>
          </name>
          <name>
            <surname>Gaujoux</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>
        <source>Cell Syst</source>
        <volume>3</volume>
        <year>2016</year>
        <fpage>346</fpage>
        <lpage>360.e344</lpage>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="b0210">
      <label>42</label>
      <element-citation publication-type="journal" id="h0210">
        <person-group person-group-type="author">
          <name>
            <surname>van Galen</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Hovestadt</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Wadsworth Ii</surname>
            <given-names>M.H.</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>T.K.</given-names>
          </name>
          <name>
            <surname>Griffin</surname>
            <given-names>G.K.</given-names>
          </name>
        </person-group>
        <article-title>Single-Cell RNA-Seq reveals AML hierarchies relevant to disease progression and immunity</article-title>
        <source>Cell</source>
        <volume>176</volume>
        <year>2019</year>
        <fpage>1265</fpage>
        <lpage>1281.e1224</lpage>
        <pub-id pub-id-type="pmid">30827681</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="s0090" sec-type="supplementary-material">
    <label>Appendix A</label>
    <title>Supplementary data</title>
    <p id="p0275">The following are the Supplementary data to this article:<supplementary-material content-type="local-data" id="m0010"><caption><title>Supplementary data 1</title></caption><media xlink:href="mmc1.docx"/></supplementary-material></p>
    <p id="p0280">
      <supplementary-material content-type="local-data" id="m0005">
        <caption>
          <title>Supplementary data 2</title>
        </caption>
        <media xlink:href="mmc2.docx"/>
      </supplementary-material>
    </p>
  </sec>
  <ack id="ak005">
    <title>Acknowledgements</title>
    <p id="p0265">This work was supported by <funding-source id="gp005"><institution-wrap><institution-id institution-id-type="doi">10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap></funding-source> (Grant Nos. 61802141, 31930022 and 31771476), Strategic Priority Research Program of the Chinese Academy of Sciences (Grant No. XDB38040400), Shanghai Municipal Science and Technology Major Project (Grant No. 2017SHZDZX01) and Huazhong Agricultural University Scientific &amp; Technological Self-innovation Foundation (Grant No. 2662017QD043).</p>
  </ack>
  <fn-group>
    <fn id="s0085" fn-type="supplementary-material">
      <label>Appendix A</label>
      <p id="p0270">Supplementary data to this article can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.csbj.2021.05.046" id="ir015">https://doi.org/10.1016/j.csbj.2021.05.046</ext-link>.</p>
    </fn>
  </fn-group>
</back>
