<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4016701</article-id>
    <article-id pub-id-type="pmid">24451624</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu028</article-id>
    <article-id pub-id-type="publisher-id">btu028</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CAFE: an R package for the detection of gross chromosomal abnormalities from gene expression microarray data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bollen</surname>
          <given-names>Sander</given-names>
        </name>
        <xref ref-type="aff" rid="btu028-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu028-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btu028-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Leddin</surname>
          <given-names>Mathias</given-names>
        </name>
        <xref ref-type="aff" rid="btu028-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Andrade-Navarro</surname>
          <given-names>Miguel A.</given-names>
        </name>
        <xref ref-type="aff" rid="btu028-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mah</surname>
          <given-names>Nancy</given-names>
        </name>
        <xref ref-type="aff" rid="btu028-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu028-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="btu028-AFF1"><sup>1</sup>Computational Biology and Data Mining Group, Max Delbruck Center for Molecular Medicine, 13125 Berlin, Germany, <sup>2</sup>Graduate School of Life Sciences, Utrecht University, Universiteitsweg 98, 3584 CG, Utrecht, the Netherlands and <sup>3</sup>Roche Diagnostics GmbH, 82377 Penzberg, Germany</aff>
    <author-notes>
      <corresp id="btu028-COR1">*To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Janet Kelso</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>1</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>1</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>10</issue>
    <fpage>1484</fpage>
    <lpage>1485</lpage>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>8</month>
        <year>2013</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>1</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>1</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> The current methods available to detect chromosomal abnormalities from DNA microarray expression data are cumbersome and inflexible. CAFE has been developed to alleviate these issues. It is implemented as an R package that analyzes Affymetrix *.CEL files and comes with flexible plotting functions, easing visualization of chromosomal abnormalities.</p>
      <p><bold>Availability and implementation:</bold> CAFE is available from <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/cob87icW6z/cafe/">https://bitbucket.org/cob87icW6z/cafe/</ext-link> as both source and compiled packages for Linux and Windows. It is released under the GPL version 3 license. CAFE will also be freely available from Bioconductor.</p>
      <p><bold>Contact:</bold><email>sander.h.bollen@gmail.com</email> or <email>nancy.mah@mdc-berlin.de</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu028/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>1 INTRODUCTION</title>
    <p>Gross chromosomal abnormalities are a hallmark of cancers (<xref rid="btu028-B3" ref-type="bibr">Hanahan and Weinberg, 2011</xref>) and are frequently acquired by cultured cells as an adaptation to cell culture conditions (<xref rid="btu028-B1" ref-type="bibr">Baker <italic>et al.</italic>, 2007</xref>). Recently, it has been recognized that induced pluripotent stem cells often feature gross chromosomal duplications or deletions (<xref rid="btu028-B4" ref-type="bibr">Laurent <italic>et al.</italic>, 2011</xref>).</p>
    <p>Various methods exist to detect chromosomal gains or losses. Traditional karyotyping relies on careful examination of Giemsa-stained metaphase chromosomes. Newer techniques like spectral karyotyping have increased ease of analysis but nevertheless feature low resolution. For high-throughput and high resolution analysis of gross chromosomal abnormalities, array-based Comparative Genomic Hybridization (a-CGH) is often used. This a-CGH approach is based on the detection of a quantitative difference of DNA content. Whole-genome and SNP-based sequencing approaches have also been developed.</p>
    <p>Although not initially developed for this purpose, it is possible to use gene expression microarray data for the detection of copy number abnormalities. This approach is not based on the measurements of DNA content but rather on mRNA expression levels. A protocol to use expression microarrays to ‘karyotype' samples was recently published by Benvenisty and coworkers but requires the manual use of different tools (<xref rid="btu028-B2" ref-type="bibr">Ben-David <italic>et al.</italic>, 2013</xref>).</p>
    <p>Here, we present CAFE—Chromosomal Aberration Finder in Expression data—as an R package for the detection of gross chromosomal gains and losses from expression microarrays, with a resolution up to cytoband level. CAFE follows the expression-based karyotyping workflow (e-karyotyping) and greatly simplifies and speeds up the detection analysis of chromosomal aberrations from expression DNA microarrays.</p>
  </sec>
  <sec sec-type="methods">
    <title>2 FEATURES AND METHODS</title>
    <p>The starting point of a CAFE analysis is a set of gene expression microarrays from samples whose e-karyotype will be computed and another (larger) set of microarrays representing controls. The controls define a normal e-karyotype against which the altered e-karyotype will be defined. We recommend choosing a dataset of at least 10 controls for 2–3 test samples. More controls may be required depending on the particular case. CAFE is implemented as an R package and relies on several Bioconductor packages. It runs on version 2.10 or newer of R. The analyses are performed using Affymetrix *.CEL files as input. Using the <monospace>ProcessCels()</monospace> function, a list object is created from these *.CEL files and returned to the user. This object contains normalized and relative expression levels, along with several mappings of probesets to chromosomes, chromosomal arms, cytobands and chromosomal locations. The output can be further filtered so as to exclude multiple probesets that map to the same gene or to the same location. CAFE can then be used to perform several enrichment tests for the detection of duplications or deletions of chromosomes, chromosomal arms and cytobands. Furthermore, several plot functions are available to visualize any detected aberrations.</p>
    <sec id="SEC2.1">
      <title>2.1 Enrichment testing</title>
      <p>CAFE contains three statistical functions that determine enrichment or depletion of a given chromosome/chromosomal region. One function exists for each of the three resolutions: <monospace>chromosomeStats(), armStats()</monospace> and <monospace>bandStats()</monospace>, corresponding to chromosomes, arms and cytobands, respectively. The ability of CAFE to detect aberrations within chromosome, arm or cytoband is dependent on the density of the microarray probesets within these areas. Areas that are gene-poor are not likely to be detected, as expression microarrays are designed to detect transcribed genes. The user defines two thresholds as a ratio of median expression values, ‘over’ and ‘under’, for which probesets are called over- and under-expressed. The threshold for genomic DNA hybridized onto a comparative genomic hybridization array would be ±log<sub>2</sub>(2) ratio to detect a chromosome gain or loss, respectively. Because CAFE uses mRNA expression as a surrogate for DNA copy number and because the levels of mRNA expression are variable and do not strictly reflect DNA copy number, a less restrictive default threshold is recommended as a starting point for analysis: ±log<sub>2</sub>(1.5) ratio. Using these thresholds, enrichment of under- and over-expressed probes in chromosomes or chromosomal regions is computed using a Fisher’s exact test or a χ<sup>2</sup> test. <italic>P</italic>-values are Bonferroni-corrected by default.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Graphics</title>
      <p>For graphics, CAFE uses the ggplot2 plotting system (<xref rid="btu028-B5" ref-type="bibr">Wickham, 2009</xref>). There are four different plotting functions available: (i) <monospace>rawPlot()</monospace>: the ‘raw’ log-transformed relative expression values are plotted along the chromosome of interest; (ii) <monospace>slidPlot()</monospace>: a moving average smoother is applied to the log-transformed relative expression values before plotting the values along the chromosome of interest; (iii) <monospace>discontPlot()</monospace>: a discontinuous smoother is applied to the log-transformed relative expression values and the values are plotted along the chromosome of interest; (iv) <monospace>facetPlot()</monospace>: all chromosomes are plotted in one horizontally aligned graph, with relative expression values along each chromosome. This function can be used in conjunction with a moving average smoother.</p>
      <p>For all plot functions except <monospace>facetPlot()</monospace>, it is possible to add a chromosome idiogram over the chromosome plot. This allows easy visualization of chromosomal abnormalities. See <xref ref-type="fig" rid="btu028-F1">Figure 1</xref> for example plots. All plots are printed to the file system and returned as ggplot2 objects. Plot parameters, such as labels and scales, can be modified to the user's liking by altering the ggplot2 object.
<fig id="btu028-F1" position="float"><label>Fig. 1.</label><caption><p>Samples GSM652238 (orange) and GSM652239 (blue) from GEO dataset GSE26526 were plotted. GSM652238 is known to have a deletion in Chromosome 11q. (<bold>A</bold>) The output of <monospace>slidPlot()</monospace>. (<bold>B</bold>) The output of <monospace>discontPlot()</monospace></p></caption><graphic xlink:href="btu028f1p"/></fig></p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Comparison with other tools</title>
      <p>To the best of our knowledge, there are currently no other Bioconductor packages that are designed to identify chromosomal copy number abnormalities from mRNA expression microarray data. However, there are other packages that perform similar functions, such as processing comparative genomic hybridization arrays (aCGH, snapCGH) or identifying differentially regulated regions on a chromosome from expression microarrays (MACAT). The initial choice of datasets for analysis is critical and must be completed by hand, regardless of the package used. Once this is done, CAFE is able to normalize and preprocess the *.CEL files in one step. Although aCGH and snapCGH were designed to analyze CGH arrays, one can use CAFE to preprocess the *.CEL files and then subsequently reformat the preprocessed data for input into these packages. Both aCGH and snapCGH use hidden Markov models to predict state changes (i.e. changes in chromosomal copy number). Plotting functions then show the course of state changes over the chromosome. MACAT uses a modified <italic>t</italic>-statistic and permutation to score regions of the chromosome that are differentially regulated. The scores for a selected chromosome are shown as a static html page. To compare the performance, CAFE and the other three packages were used to analyze two test datasets with known chromosomal aberrations (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu028/-/DC1">Supplementary Data</ext-link>). CAFE was able to detect copy number abnormalities just as well as or better than the other packages.</p>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>3 DISCUSSION</title>
    <p>Karyotyping by expression microarrays, as described by <xref rid="btu028-B2" ref-type="bibr">Ben-David <italic>et al.</italic> (2013)</xref>, extends the utility of expression microarray data by providing some limited information on the status of chromosomal aberrations in a sample. However, the original e-karyotyping method is a tedious process, using four different programs and requiring an estimated 15 h to analyze only 15 samples. At the time of writing, there are no Bioconductor packages to specifically carry out e-karyotyping from raw microarray data. The CAFE package simplifies the e-karyotyping protocol. Starting from the *.CEL files, CAFE can do the same analysis in minutes and requires no more than basic R knowledge. Bioconductor packages for CGH analysis can be used to perform an e-karyotyping analysis, but the data preprocessing steps must be carried out manually and the resulting graphs are static and not user-configurable. In contrast, CAFE processes the expression data from *.CEL files and all plotting functions return a ggplot2 object that can be modified by the end-user to his or her specific needs. CAFE will become a Bioconductor package, to be freely available for anyone to use, distribute, modify and easily integrate into an R-workflow for automatic analysis.</p>
    <p>Currently, only Affymetrix *.CEL files from 3’IVT arrays can be seamlessly preprocessed in CAFE; functions for processing raw microarray data from other platforms may be added in the future if there is demand for this feature. Data import from other platforms is still possible, as CAFE data are represented by a simple R list structure. CAFE analysis currently works with three different resolutions: whole chromosome, chromosomal arm and cytoband. Therefore, it is not suited for smaller deletions or duplications. In addition, it is not readily possible to detect insertions or translocations using this technique, as the probesets will be mapped to the original chromosome or location. Therefore, CAFE is most suited for the detection of numerical abnormalities, rather than structural abnormalities. CAFE has not been designed to replace existing karyotyping techniques but rather to gain information when data from more specific approaches is not yet available.</p>
    <p><italic>Funding</italic>: <funding-source>German Research Foundation Priority Programme</funding-source> 1463 (Project No. <award-id>AN 735/2-1</award-id>) (to N.M.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_30_10_1484__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu028_BollenS_2013_SupplementalData.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu028-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baker</surname>
            <given-names>DE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adaptation to culture of human embryonic stem cells and oncogenesis <italic>in vivo</italic></article-title>
        <source>Nat. Biotechnol.</source>
        <year>2007</year>
        <volume>25</volume>
        <fpage>207</fpage>
        <lpage>215</lpage>
        <pub-id pub-id-type="pmid">17287758</pub-id>
      </element-citation>
    </ref>
    <ref id="btu028-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ben-David</surname>
            <given-names>U</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Virtual karyotyping of pluripotent stem cells on the basis of their global gene expression profiles</article-title>
        <source>Nat. Protoc.</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>989</fpage>
        <lpage>997</lpage>
        <pub-id pub-id-type="pmid">23619890</pub-id>
      </element-citation>
    </ref>
    <ref id="btu028-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanahan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Weinberg</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Hallmarks of cancer: the next generation</article-title>
        <source>Cell</source>
        <year>2011</year>
        <volume>144</volume>
        <fpage>646</fpage>
        <lpage>674</lpage>
        <pub-id pub-id-type="pmid">21376230</pub-id>
      </element-citation>
    </ref>
    <ref id="btu028-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laurent</surname>
            <given-names>LC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamic changes in the copy number of pluripotency and cell proliferation genes in human ESCs and iPSCs during reprogramming and time in culture</article-title>
        <source>Cell Stem Cell</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>106</fpage>
        <lpage>118</lpage>
        <pub-id pub-id-type="pmid">21211785</pub-id>
      </element-citation>
    </ref>
    <ref id="btu028-B5">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>ggplot2: Elegant Graphics for Data Analysis</source>
        <year>2009</year>
        <publisher-loc>New York, USA</publisher-loc>
        <publisher-name>Springer Science + Business Media</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
