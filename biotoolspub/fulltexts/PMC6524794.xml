<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, CA USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6524794</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0216594</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-18-24930</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Diagnostic Medicine</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Magnetic Resonance Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Magnetic Resonance Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Radiology and Imaging</subject>
          <subj-group>
            <subject>Diagnostic Radiology</subject>
            <subj-group>
              <subject>Magnetic Resonance Imaging</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Simulation and Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computerized Simulations</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computer Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Biological Databases</subject>
            <subj-group>
              <subject>Sequence Databases</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Database and Informatics Methods</subject>
          <subj-group>
            <subject>Bioinformatics</subject>
            <subj-group>
              <subject>Sequence Analysis</subject>
              <subj-group>
                <subject>Sequence Databases</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Research and Analysis Methods</subject>
        <subj-group>
          <subject>Imaging Techniques</subject>
          <subj-group>
            <subject>Computer Imaging</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Brain</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Medicine and Health Sciences</subject>
        <subj-group>
          <subject>Anatomy</subject>
          <subj-group>
            <subject>Brain</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v3">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Computing Systems</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>coreMRI: A high-performance, publicly available MR simulation platform on the cloud</article-title>
      <alt-title alt-title-type="running-head">coreMRI: A high-performance, publicly available MR simulation platform on the cloud</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Xanthis</surname>
          <given-names>Christos G.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Software</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3786-3817</contrib-id>
        <name>
          <surname>Aletras</surname>
          <given-names>Anthony H.</given-names>
        </name>
        <role content-type="http://credit.casrai.org/">Conceptualization</role>
        <role content-type="http://credit.casrai.org/">Investigation</role>
        <role content-type="http://credit.casrai.org/">Methodology</role>
        <role content-type="http://credit.casrai.org/">Writing – original draft</role>
        <role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
        <xref ref-type="aff" rid="aff001">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff002">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor001">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff001">
      <label>1</label>
      <addr-line>Department of Clinical Sciences Lund, Clinical Physiology, Skåne University Hospital, Lund University, Lund, Sweden</addr-line>
    </aff>
    <aff id="aff002">
      <label>2</label>
      <addr-line>Laboratory of Computing, Medical Informatics and Biomedical–Imaging Technologies, School of Medicine, Aristotle University of Thessaloniki, Thessaloniki, Greece</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Chen</surname>
          <given-names>Xi</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>McLean Hospital, UNITED STATES</addr-line>
    </aff>
    <author-notes>
      <fn fn-type="COI-statement" id="coi001">
        <p><bold>Competing Interests: </bold>I have read the journal's policy and the authors of this manuscript have the following competing in terests: CGX is a co-founder, board member and CEO of corsMED AB. AHA is a co-founder and board member of corsMED AB. This does not alter our adherence to PLOS ONE policies on sharing data and materials. IP protected software owned by corsMED AB or Siemens Healthcare GmbH will not be shared.</p>
      </fn>
      <corresp id="cor001">* E-mail: <email>aletras@auth.gr</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>5</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>14</volume>
    <issue>5</issue>
    <elocation-id>e0216594</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>9</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2019 Xanthis, Aletras</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Xanthis, Aletras</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="pone.0216594.pdf"/>
    <abstract>
      <sec id="sec001">
        <title>Introduction</title>
        <p>A <bold>C</bold>loud-<bold>OR</bold>iented <bold>E</bold>ngine for advanced <bold>MRI</bold> simulations (coreMRI) is presented in this study. The aim was to develop the first advanced MR simulation platform delivered as a web service through an on-demand, scalable cloud-based and GPU-based infrastructure. We hypothesized that such an online MR simulation platform could be utilized as a virtual MRI scanner but also as a cloud-based, high-performance engine for advanced MR simulations in simulation-based quantitative MR (qMR) methods.</p>
      </sec>
      <sec id="sec002">
        <title>Methods and results</title>
        <p>The simulation framework of coreMRI was based on the solution of the Bloch equations and utilized a ground-up-approach design based on the principles already published in the literature. The development of a front-end environment allowed the connection of the end-users to the GPU-equipped instances on the cloud. The coreMRI simulation platform was based on a modular design where individual modules (such as the Gadgetron reconstruction framework and a newly developed Pulse Sequence Designer) could be inserted in the main simulation framework. Different types and sources of pulse sequences and anatomical models were utilized in this study revealing the flexibility that the coreMRI simulation platform offers to the users. The performance and scalability of coreMRI were also examined on multi-GPU configurations on the cloud, showing that a multi-GPU computer on the cloud equipped with a newer generation of GPU cards could significantly mitigate the prolonged execution times that accompany more realistic MRI and qMR simulations.</p>
      </sec>
      <sec id="sec003">
        <title>Conclusions</title>
        <p>coreMRI is available to the entire MR community, whereas its high performance and scalability allow its users to configure advanced MRI experiments without the constraints imposed by experimentation in a true MRI scanner (such as time constraint and limited availability of MR scanners), without upfront investment for purchasing advanced computer systems and without any user expertise on computer programming or MR physics. coreMRI is available to the users through the webpage <ext-link ext-link-type="uri" xlink:href="https://www.coreMRI.org">https://www.coreMRI.org</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group id="award001">
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100008536</institution-id>
            <institution>Amazon Web Services</institution>
          </institution-wrap>
        </funding-source>
        <award-id>AWS Cloud Credits for Research</award-id>
        <principal-award-recipient>
          <name>
            <surname>Xanthis</surname>
            <given-names>Christos G.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <funding-statement>Cloud computing hours were awarded to CGX through a “AWS Cloud Credits for Research” program (<ext-link ext-link-type="uri" xlink:href="https://aws.amazon.com/research-credits">https://aws.amazon.com/research-credits</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <fig-count count="18"/>
      <table-count count="4"/>
      <page-count count="26"/>
    </counts>
    <custom-meta-group>
      <custom-meta id="data-availability">
        <meta-name>Data Availability</meta-name>
        <meta-value>The 2 MOLLIs and the simulator executable code are available from <ext-link ext-link-type="uri" xlink:href="https://figshare.com/projects/coreMRI_com_simulation_platform/60860">https://figshare.com/projects/coreMRI_com_simulation_platform/60860</ext-link>. The DOIs of the datasets are the following: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.7808042">10.6084/m9.figshare.7808042</ext-link>; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.7808297">10.6084/m9.figshare.7808297</ext-link>; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.7808051">10.6084/m9.figshare.7808051</ext-link>; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.7808291">10.6084/m9.figshare.7808291</ext-link>.</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
  <notes>
    <title>Data Availability</title>
    <p>The 2 MOLLIs and the simulator executable code are available from <ext-link ext-link-type="uri" xlink:href="https://figshare.com/projects/coreMRI_com_simulation_platform/60860">https://figshare.com/projects/coreMRI_com_simulation_platform/60860</ext-link>. The DOIs of the datasets are the following: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.7808042">10.6084/m9.figshare.7808042</ext-link>; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.7808297">10.6084/m9.figshare.7808297</ext-link>; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.7808051">10.6084/m9.figshare.7808051</ext-link>; <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.6084/m9.figshare.7808291">10.6084/m9.figshare.7808291</ext-link>.</p>
  </notes>
</front>
<body>
  <sec sec-type="intro" id="sec004">
    <title>1 Introduction</title>
    <p>Magnetic Resonance Imaging (MRI) simulations have been utilized to date mostly as a research tool to provide insight with respect to pulse sequence design [<xref rid="pone.0216594.ref001" ref-type="bibr">1</xref>–<xref rid="pone.0216594.ref003" ref-type="bibr">3</xref>] and as hardware development/improvement [<xref rid="pone.0216594.ref004" ref-type="bibr">4</xref>] as well as an educational platform to provide basic understanding of the MRI physics to students, physicians and technologists [<xref rid="pone.0216594.ref005" ref-type="bibr">5</xref>–<xref rid="pone.0216594.ref007" ref-type="bibr">7</xref>]. However, due to their rather limited scope and in order to reduce the complexity of the magnetic resonance (MR) experiment so as to execute the simulation within reasonable times, these MR simulators made several assumptions with respect to the underlying MR physics framework which limit their application in more realistic simulations.</p>
    <p>In recent years, more advanced and general-purpose MR simulation platforms have been presented in the literature [<xref rid="pone.0216594.ref008" ref-type="bibr">8</xref>, <xref rid="pone.0216594.ref009" ref-type="bibr">9</xref>]. SIMRI [<xref rid="pone.0216594.ref008" ref-type="bibr">8</xref>] was mainly developed for training purposes and consisted of a Graphical User Interface (GUI) for manipulating a number of MR protocol parameters whereas JEMRIS [<xref rid="pone.0216594.ref009" ref-type="bibr">9</xref>] provided a comprehensive, open-source solution for answering more complex questions on pulse sequence design and its performance was evaluated on a 32-dual-core CPU cluster. Although these simulation platforms allowed for application in large-scale analysis, they required advanced technical knowledge, advanced setup of a computer cluster and the ability to modify the source code. More recently, the latest advancements in graphics processing unit (GPU) technology and general-purpose computing on graphics processing units (GPGPU computing) allowed for complex large-scale MR simulations on a single computer without requiring simplifications of the MRI physics model so as to yield reasonable execution times [<xref rid="pone.0216594.ref010" ref-type="bibr">10</xref>–<xref rid="pone.0216594.ref013" ref-type="bibr">13</xref>]. MRISIMUL [<xref rid="pone.0216594.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0216594.ref013" ref-type="bibr">13</xref>] was the first comprehensive MR simulation platform that utilized GPU-technology and brought the computational supercomputer-level power or a computer cluster on a single, GPU-equipped, personal computer whereas MRiLab [<xref rid="pone.0216594.ref011" ref-type="bibr">11</xref>] was an open-source MRI simulation tool that utilized GPU-technology and allowed for a flexible representation of tissues by multi-pool exchange models. However, despite the latest progress on GPU-based MR simulations, the utilization of GPU-based MR simulation platforms remained limited since it required the purchase of an expensive computer system and advanced programming and installation expertise. Furthermore, the increased spatial resolution provided by newer MR systems and the incorporation of more realistic aspects in simulations (such as motion) may require the utilization of more advanced computer systems [<xref rid="pone.0216594.ref012" ref-type="bibr">12</xref>] equipped with the latest GPU technology available. In addition to this, research groups around the world have shown during the last few years an increasing interest in quantitative MRI by means of advanced MR simulations. Novel techniques, such as Magnetic Resonance Fingerprinting [<xref rid="pone.0216594.ref014" ref-type="bibr">14</xref>] and parallel Simulations for QUantifying RElaxation Magnetic Resonance constants (SQUAREMR) [<xref rid="pone.0216594.ref015" ref-type="bibr">15</xref>], utilize MR simulations to significantly improve quantitative MRI through the generation of large databases of simulated MR signals. Recently, Kantasis et al. [<xref rid="pone.0216594.ref016" ref-type="bibr">16</xref>] demonstrated how SQUAREMR performance could be improved through a cloud-based implementation that distributes the computational load to several GPU-enabled nodes and through the optimization of the parameter space that reduces the computational load without compromising the quantitative estimates. However, this solution was limited to SQUAREMR applications, was not accessible by the users and required the setup of an advanced computer architecture on the cloud. Last but not least, there is no simulation standard today within the MR field. A variety of MR simulators have been published in the literature to date, but they have mainly been developed and utilized for specific MR applications and they have not been validated extensively over a wider range of MR applications [<xref rid="pone.0216594.ref017" ref-type="bibr">17</xref>, <xref rid="pone.0216594.ref018" ref-type="bibr">18</xref>].</p>
    <p>All of the above point out the need for having an advanced MR simulation platform as a service, which can be easily accessible by the entire MR community, will remain common across research groups and will not require programming expertise. This simulation platform will allow researchers, technologists, physicians and students to design and configure advanced MR experiments without the time constraint imposed by costly experimentation on an MRI scanner or by the limited availability of MR scanners for research purposes. In particular, such a simulation platform could be used in MR research for answering particular methodological problems, providing insight with respect to future pulse sequence development, improving the idea-to-product time and reducing the need for MR experiments on human volunteers, patients and animals. In the field of MR education, such a simulation platform could be used for improving the way MR education is performed today by generating educational material that cover a wide range of variations of both the imaging protocol and the computer model, which is not easy today with a true MRI experiment configuration (MRI system, patient recruitment, etc.). Moreover, such a simulation platform could offer a hands-on experience to students, physicists, technologists and physicians that would like to investigate how changes on the configuration of an MR experiment affect the quality of the final MR image.</p>
    <p>The specific aim of this study was the development of an advanced MR simulation platform (<bold>C</bold>loud <bold>OR</bold>iented <bold>E</bold>ngine for advanced <bold>MRI</bold> simulations—coreMRI) delivered as a web service through an on-demand, scalable cloud-based and GPU-based infrastructure. We hypothesized that such an online MR simulation platform could be utilized 1) as a virtual MRI scanner delivered worldwide through the cloud that simulates the entire MRI process, from pulse sequence development to signal generation and image formation, and 2) as a cloud-based, high-performance engine for advanced MR simulations in simulation-based quantitative MR methods [<xref rid="pone.0216594.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0216594.ref015" ref-type="bibr">15</xref>].</p>
  </sec>
  <sec sec-type="materials|methods" id="sec005">
    <title>2 Materials and methods</title>
    <p>A simplified block diagram of the coreMRI simulation platform is shown in <xref ref-type="fig" rid="pone.0216594.g001">Fig 1</xref>. The entire solution was installed on the cloud and is reachable from any web browser through the domain name <ext-link ext-link-type="uri" xlink:href="http://www.coremri.org/">www.coremri.org</ext-link>. A Secure Sockets Layer (SSL) was established to provide an encrypted connection between the web browser and the web server on the cloud.</p>
    <fig id="pone.0216594.g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g001</object-id>
      <label>Fig 1</label>
      <caption>
        <title>Simplified block diagram of the coreMRI simulation platform.</title>
        <p>The computational kernel (in bold orange) accepts two inputs: the pulse sequence and the spin model. Depending on the mode (MR Imaging or quantitative MR), the output of the coreMRI simulation platform is either raw simulated MR data that can be reconstructed (optionally) to a simulated MR image or a database of simulated MR signals. The modular design of the coreMRI simulation platform modular allows individual modules (such as the Gadgetron reconstruction framework [<xref rid="pone.0216594.ref019" ref-type="bibr">19</xref>]) to be added in the simulation workflow.</p>
      </caption>
      <graphic xlink:href="pone.0216594.g001"/>
    </fig>
    <p>The simulation framework of coreMRI utilized a ground-up-approach design based on the principles already published in the literature [<xref rid="pone.0216594.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0216594.ref013" ref-type="bibr">13</xref>]. The coreMRI simulation platform of the Bloch equations was based on a modular design where individual modules (such as the Gadgetron reconstruction framework [<xref rid="pone.0216594.ref019" ref-type="bibr">19</xref>]) could be inserted in the main simulation framework. Amazon Web Services (AWS—<ext-link ext-link-type="uri" xlink:href="http://aws.amazon.com">aws.amazon.com</ext-link>) were utilized for the provision of cloud-based and GPU-based services to the end-users. The development of a web-server (front-end) allowed the connection of the end-users to the GPU-equipped instances (back-end) on the cloud.</p>
    <sec id="sec006">
      <title>2.1 coreMRI platform architecture: Front-end system</title>
      <p>The front-end system was mainly employed as a job-manager that 1) activated the GPU resources required for the MR simulations, 2) distributed the data to the GPU instances, 3) collected the data generated from the GPU instances and 4) delivered the MR simulation data to the end-users. The front-end system is accessible to the end-users through the web (<ext-link ext-link-type="uri" xlink:href="http://www.coremri.org/">www.coremri.org</ext-link>) and consists of a web-page and a web-application. The web-page was built on a Joomla framework and acted as a user and content management system. The web-application was built with the use of HTML5, CSS3, bootstrap 3, JavaScript, jQuery, Java (as a middleware) and MySQL. The web-application was the main simulation platform of coreMRI that bridged the end-user with the cloud-based and GPU-based infrastructure, prepared the MR simulations, activated the GPU-resources required for the MR simulations and presented the simulated MR data. Once the simulation is ordered, the web-application requests through the AWS SDK (Software Development Kit) for PHP the initiation on the cloud of the type of the GPU-equipped instance that the user selected. A more detailed description of this process is given in section 2.2.</p>
      <p><xref ref-type="fig" rid="pone.0216594.g002">Fig 2</xref> shows screenshots of the web-application. The coreMRI simulation platform is available in two different modes: Magnetic Resonance Imaging (MR Imaging) and quantitative Magnetic Resonance (quantitative MR). The MR Imaging mode simulates the entire MRI process, from pulse sequence development and selection of the anatomical model to signal generation and image formation. The quantitative MR mode utilizes MR simulations for the generation of databases of simulated MR signals to be used in simulation-based quantitative MR methods, such as MRF and SQUAREMR [<xref rid="pone.0216594.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0216594.ref015" ref-type="bibr">15</xref>]. The MR Imaging mode colors the web-application in blue (<xref ref-type="fig" rid="pone.0216594.g002">Fig 2A</xref>), whereas the quantitative MR mode colors the web-application in green (<xref ref-type="fig" rid="pone.0216594.g002">Fig 2B</xref>). The user can switch between the two modes by clicking on the top left corner of the coreMRI simulation platform. Last, at the top-right corner of the web-application there is an area with icons that provide important information to the user, such as the remaining GPU-hours that the user has available for MR simulations, notifications on the status of the MR simulations, the number and type of GPU instances the user is currently using, the version of the coreMRI platform, etc.</p>
      <fig id="pone.0216594.g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g002</object-id>
        <label>Fig 2</label>
        <caption>
          <title>Screenshots of the web-application of the coreMRI simulation platform and the two simulation modes.</title>
          <p>A) The MR imaging mode simulates the entire MR process and colors the web-application in blue. B) The quantitative MR mode utilizes MR simulations for the generation of databases of simulated MR signals and colors the web-application in green.</p>
        </caption>
        <graphic xlink:href="pone.0216594.g002"/>
      </fig>
      <sec id="sec007">
        <title>2.1.1Magnetic Resonance (MR) imaging mode</title>
        <p>The MR Imaging mode requires the selection of one pulse sequence and one computer model for the execution of the MR simulation and the presentation of the outcome.</p>
        <p>In more detail, the list with the pulse sequences is available through the tab “Pulse Sequences” from the left-side menu (<xref ref-type="fig" rid="pone.0216594.g002">Fig 2A</xref>). In this page, the user is allowed to 1) upload pulse sequences in a .mat (MATLAB) file format, 2) view/download the uploaded pulse sequences, 3) share pulse sequences with the coreMRI community, 4) view the pulse sequences that other users have uploaded and shared (through the Public Repository), and 5) design new pulse sequences through an online pulse sequence designer. More details about the pulse sequence designer are given in a separate section (Section 2.1.3).</p>
        <p>The selection of the anatomical model is performed through the tab “Anatomical Models” from the left-side menu (<xref ref-type="fig" rid="pone.0216594.g002">Fig 2A</xref>). In this page, the user is allowed to 1) upload anatomical models in a .mat file format, 2) view/download the uploaded anatomical models, 3) share anatomical models with the coreMRI community, 4) view the anatomical models that other users have uploaded and shared (through the Public Repository).</p>
        <p>The tab “Simulation” from the left-side menu (<xref ref-type="fig" rid="pone.0216594.g002">Fig 2A</xref>) allows the user to select the pulse sequence, the anatomical model, and the type of the GPU-equipped instance on the cloud that will perform the MR simulation. On this page, the user can also define/edit more characteristics of the MR simulation, such as the gyromagnetic ratio, the motion of the anatomical model, the reconstruction method, the magnetization transfer (MT) effect, etc.</p>
        <p>The structure of the anatomical model allowed for a more complex tissue configuration. The basic tissue configuration involved the assignment of every single isochromat in 3D space with a set of basic MR characteristics (such as T1, T2 and proton density). The user could optionally assign more complex characteristics at every single isochromat in 3D space, such as chemical shift and parameters that define a two-pool model of MT exchange [<xref rid="pone.0216594.ref020" ref-type="bibr">20</xref>] that consists of a liquid pool (water protons) and a small semisolid pool (macromolecular content). Moreover, the structure of the anatomical model allowed for the utilization of multiple isochromats at the same location. Once the anatomical model was structured with more complex characteristics, their activation was performed through the proper selection of characteristics of the MR simulation in tab “Simulation”, such as activation of the MT module.</p>
        <p>The tab “Experiments” from the left-side menu (<xref ref-type="fig" rid="pone.0216594.g002">Fig 2A</xref>) presents the current status for all the MR simulations performed by the user along with the MR simulation output for all the MR simulations that completed successfully. In this page, the user is allowed to 1) download the raw data of the MR simulation in a .mat file format, 2) view and download the Gadgetron-reconstructed images for the MR simulations if this option had been selected, and 3) view the log and characteristics of each MR simulation.</p>
      </sec>
      <sec id="sec008">
        <title>2.1.2 Quantitative Magnetic Resonance (MR) mode</title>
        <p>The quantitative MR mode requires the selection of one pulse sequence and the definition of the size of the spin model and range of spin parameters for the execution of the MR simulation and the presentation of the outcome.</p>
        <p>In more detail, the list with the pulse sequences is available through the tab “Pulse Sequences” from the left-side menu (<xref ref-type="fig" rid="pone.0216594.g002">Fig 2B</xref>) in a similar manner as described in section 2.1.1. It should be noted, though, that the list of pulse sequences in the quantitative MR mode presents different pulse sequences from the ones presented in the MR imaging mode.</p>
        <p>The tab “Simulation” from the left-side menu (<xref ref-type="fig" rid="pone.0216594.g002">Fig 2B</xref>) allows the user to select the pulse sequence and the type of the GPU-equipped instance on the cloud that will perform the MR simulation. On this page, the user also defines the characteristics of the spin model such as the range of the T1 and T2 values of the spin population, the position of the spins along the slice direction, the main field inhomogeneity that each spin experiences, etc. More characteristics of the MR experiment can also be defined/edited on this page, such as the gyromagnetic ratio, the magnetization transfer effect, etc.</p>
        <p>The tab “Experiments” from the left-side menu (<xref ref-type="fig" rid="pone.0216594.g002">Fig 2B</xref>) presents the current status for all the MR simulations performed by the user along with the MR simulation output for all the MR simulations that completed successfully. On this page, the user is allowed to download the database with the simulated MR signals in a .mat file format and view the log and characteristics of each MR simulation.</p>
      </sec>
      <sec id="sec009">
        <title>2.1.3 Pulse sequence designer</title>
        <p>A Graphical User Interface for pulse sequence design was developed using HTML5, CSS3, JavaScript and MySQL. The Pulse Sequence Designer is available through the coreMRI framework, and its layout is shown in <xref ref-type="fig" rid="pone.0216594.g003">Fig 3</xref>.</p>
        <fig id="pone.0216594.g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g003</object-id>
          <label>Fig 3</label>
          <caption>
            <title>Layout of the pulse sequence designer.</title>
            <p>The layout involves four different areas: 1) the action buttons, 2) the tree-view representation of the pulse sequence, 3) the graphical representation of the pulse sequence, and 4) the tab area.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g003"/>
        </fig>
        <p>Pulse sequences are designed in the tree-view interface and the sequence events are organized in blocks of RF, gradient and acquisition objects. Each block holds up to one object of each category (RF pulse, acquisition object, gradient pulse on X axis, gradient pulse on Y axis and gradient pulse on Z axis), whereas custom-designed RF and gradient pulses can be imported into the Designer. In addition to the regular types of objects, artificial types of objects (such as software crushers and single acquisition objects) can also be introduced in the design of the pulse sequence. Software crushers [<xref rid="pone.0216594.ref012" ref-type="bibr">12</xref>] is a form of crushers that apply on single time-points of the pulse sequence and induce instant nullification of the transverse components of all isochromats within the anatomical object. The single acquisition objects apply also to single time-points of the pulse sequence and define when the MR simulator records the transverse components of every spin of the spin model in simulation-based quantitative MR methods, such as SQUAREMR. The number of the single acquisition objects in the pulse sequence and the number of spins in the spin model define the size of the database of the simulated MR signals in such methods.</p>
        <p>Each object of the pulse sequence designer is assigned with a set of attributes, whereas functional programming can be applied for calculating the parameters dynamically. The blocks can be further grouped in groups of blocks, whereas copy-paste actions allow for easy deployment of long pulse sequences. The group of blocks, the blocks and the objects that belong to the same category (such as RF pulses, gradient pulses, etc.) receive a unique increasing ID to facilitate the functional programming. The operation of functional programming allows the formation of mathematical expressions with 1) the global parameters, 2) the attributes of the objects that belong to the same block, and 3) the attributes of the parent block and group of blocks. Moreover, the graphical representation of the objects on the right side of the designer allows the users to view the changes performed on the individual objects within the selected block.</p>
        <p>The pulse sequences developed in the designer can be exported in a format compatible either with the coreMRI simulation platform (.mat) or with the pulseq (.seq) framework [<xref rid="pone.0216594.ref021" ref-type="bibr">21</xref>]. Pulse sequences in pulseq (.seq) format can also be loaded in the designer either for visualization purposes or for further processing. The combination of the Sequence Designer with the pulseq framework allows the execution of the .seq files on real MR scanner with the use of hardware-dependent interpreters and their direct comparison with their simulation on the coreMRI simulation platform. Last, the designer allows the user to define an ISMRMRD header [<xref rid="pone.0216594.ref022" ref-type="bibr">22</xref>] that accompanies the pulse sequence throughout the simulation process and facilitates the reconstruction of the simulated MR data on the Gadgetron.</p>
      </sec>
    </sec>
    <sec id="sec010">
      <title>2.2 coreMRI platform architecture: Back-end system</title>
      <p>The back-end system consists of instances on the cloud equipped with GPU cards that run the computationally demanding core services of the MR simulations. An Amazon Machine Image (AMI) of an Ubuntu 14.04 LTS instance was created and was used to launch new instances on the cloud. The NVIDIA drivers, the CUDA toolkit and the MATLAB Compiler Runtime (MCR) along with the Docker Engine and the Docker image of Gadgetron were included in the AMI.</p>
      <p>Once the user defines the pulse sequence, the spin model, the total number and the type of the available GPU cards for the MR simulation and initiates the MR simulation in the front-end web-application, the front-end system uses the AMI to launch in the back-end a new instance with the GPU characteristics (GPU model and number of GPU cards) requested by the user. Once the GPU-equipped instance initiates, the components of the MR simulation (pulse sequence, anatomical model and configuration parameters) are transferred from the front-end system to the back-end system through a scalable file system. The MR simulation is performed through a compiled MATLAB application based on the mathematical model that describes the MR physics and has already been introduced in the literature [<xref rid="pone.0216594.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0216594.ref013" ref-type="bibr">13</xref>]. Distribution of data is performed through the MATLAB single-program-multiple-data (spmd) framework, whereas CUDA-C is utilized for the computationally intensive simulations on the GPUs (kernel). The anatomical model is divided evenly in space based on the available GPU cards and the characteristics of the GPU card, such as number of multi-processors, global memory, shared memory, registers, etc. and the kernel is called for every part of the anatomical model. The simulation computational kernel executes the matrix operations for every isochromat and for every time-step of the pulse sequence. These operations involve the calculation of the isochromat’s magnetization vector and the position (when motion models are included in the simulation). For every time-step of the pulse sequence that belongs to the acquisition window, the components of the net magnetization vector of the corresponding part of the anatomical model are stored in the global memory of the GPU. At the end of every kernel call, these data are transferred to the host CPU and the k-space matrix of the object is stored. At this stage, noise is added to the simulated signal (optional). The noise is in the form of an array of random floating-point numbers that are drawn from a normal distribution with zero mean and user-defined standard deviation. At the end of the simulation, the raw data are directed to the Gadgetron system for reconstruction purposes (if applicable) and then they are transferred to the front-end system through the scalable file system.</p>
      <p>For this study, Amazon g2-type (up to 4 GPUs, NVIDIA GRID K520, 1536 CUDA cores and 4GB GPU memory), g3-type (up to 4 GPUs, NVIDIA Tesla M60, 2048 CUDA cores and 8GB GPU memory) and p2-type (up to 16 GPUs, NVIDIA K80, 2496 CUDA cores and 12GB GPU memory) instances were utilized.</p>
      <p>A full documentation of the coreMRI simulation platform along with the latest updates and the format of all the .mat files can be found in <ext-link ext-link-type="uri" xlink:href="http://www.coremri.org/documentation">www.coremri.org/documentation</ext-link>.</p>
    </sec>
    <sec id="sec011">
      <title>2.3 Simulated experiments</title>
      <sec id="sec012">
        <title>2.3.1 MR imaging mode: Pulse sequence designer</title>
        <p>Three Gradient Recalled Echo (GRE) pulse sequences that resulted in different image resolution were designed on the Pulse Sequence Designer. The GRE pulse sequences were designed with TR 10ms, whereas the RF pulse was a three lobe sinc-shaped pulse of 3 ms duration and 15° flip angle. A software crusher pulse was applied at the end of each TR. The time-step (temporal resolution) of the pulse sequence was 1 μs, the bandwidth of the receiver was 100 kHz, the field-of-view (FOV) was 40 cm x 40 cm, and the slice thickness was 10 mm. The static magnetic field was set to 1.5 T and the maximum gradient strength was set to 40 mT/m. The ramps of all gradients were considered as steep steps.</p>
        <p>For the first GRE pulse sequence, the k-space-matrix was 128 x 128, the TE was 2.23 ms, and the total duration of the pulse sequence 1.28 s; for the second GRE pulse sequence, the k-space-matrix was 256 x 256, the TE was 2.94 ms, and the total duration of the pulse sequence 2.56 s; and for the third GRE pulse sequence, the k-space-matrix was 512 x 512, the TE was 4.43 ms, and the total duration of the pulse sequence 5.12 s. The size of the k-space matrix, the FOV, the slice thickness, the receiver-bandwidth, the gyromagnetic ratio (gamma) and the maximum gradient strength were defined as global parameters in order to be readable by all the objects within the pulse sequence.</p>
        <p>Functional programming was applied during the design of the first group of blocks and the addition of the RF, gradient and acquisition objects. For this purpose, some attributes of the objects were defined as functions of the global parameters, other objects’ attributes and the unique increasing ID of the group of blocks. A detailed description of the design of the GRE pulse sequence on the pulse sequence designer is given in <xref ref-type="supplementary-material" rid="pone.0216594.s001">S1 Appendix</xref>.</p>
      </sec>
      <sec id="sec013">
        <title>2.3.2 MR Imaging mode: coreMRI as a virtual MRI scanner</title>
        <p>In order to investigate the utilization of the coreMRI simulation platform as a virtual MRI scanner that simulates the entire MRI process, the three GRE pulse sequences previously generated by the Pulse Sequence Designer (previous section) were applied on an anatomical model of the human brain and the images were reconstructed on Gadgetron.</p>
        <p>The anatomical model of the human brain used for simulations was the discrete version of a brain phantom available online by the McConnell Brain Imaging Center at McGill University (Montreal, QC, Canada) [<xref rid="pone.0216594.ref023" ref-type="bibr">23</xref>, <xref rid="pone.0216594.ref024" ref-type="bibr">24</xref>]. The discrete version of the anatomical model supported only one tissue per position in the 3D space. The 3-D digital brain phantom consisted of 7 different tissue types (connective tissue, fat, glial matter, grey matter, muscle and skin, skull, and white matter) and every tissue type was assigned with its own relaxation times T1 and T2. The size of this model was 18.1 cm x 21.7 cm x 18.1 cm (X x Y x Z) and consisted of 2 380 471 isochromats. The isocenter was placed in the center of the anatomical model and the simulation performed on the entire volume of the anatomical model (i.e. not only within the slice of interest). The simulated MR images were generated with no noise, with Gaussian distributed noise on each signal of the quadrature detector with zero mean and standard deviation equal to 20, and with Gaussian distributed noise on each signal of the quadrature detector with zero mean and standard deviation equal to 40.</p>
        <p>To investigate the effect that the volume of the anatomical model has on the reconstructed images, the 512 x 512 GRE pulse sequences was also applied 1) only on the spins located at the z-position of the isocenter (21 113 isochromats) and 2) only on the spins located up to 3 mm (slice thickness 6mm) away from the z-position of the isocenter (147 235 isochromats). No noise was added in these images.</p>
        <p>All images were reconstructed on the Gadgetron reconstruction framework using a simple 2D Fourier-Transform (FT) MRI reconstruction as it was described by the Gadgetron configuration file default.xml. The simulations were performed on a p2.16xlarge instance type provided by Amazon AWS equipped with 16 GPUs (NVIDIA K80).</p>
      </sec>
      <sec id="sec014">
        <title>2.3.3 MR Imaging mode: coreMRI for signal simulation purposes</title>
        <p>To demonstrate the utilization of coreMRI for signal simulation purposes, a MOdified Look-Locker Inversion recovery (MOLLI) pulse sequence [<xref rid="pone.0216594.ref025" ref-type="bibr">25</xref>] and a computer model of two cylindrical phantoms were developed offline and uploaded to the cloud through the frontend of the coreMRI platform.</p>
        <p>The pulse sequence parameters were the following: the TR/TE was 2.06/1.03 ms, the bSSFP readout used a 490 μs sinc-shaped RF pulse with 6 mm slice thickness and 35° excitation flip angle, the IR pulse was a hyperbolic secant adiabatic pulse with 4.74 ms duration, a linear ramp-up preparation of 10 pulses was used to reach steady state prior to the bSSFP readout, the field of view was 360 (FE) x 270 (PE) mm, the scan matrix size was 165 (FE) x 123 (PE), the receiver BW was 200 kHz, and the acquisition scheme was 5(3p)3. The total number of time-steps was 3,300,000.</p>
        <p>The computer model consisted of two cylindrical phantoms of radius equal to 50mm and height equal to 2mm each. The left cylinder was assigned with T1 = 900 ms and T2 = 50 ms representing the relaxation times of normal myocardium [<xref rid="pone.0216594.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0216594.ref027" ref-type="bibr">27</xref>], whereas the right cylinder was assigned with T1 = 1500 ms and T2 = 250 ms representing the relaxation times of blood pool [<xref rid="pone.0216594.ref028" ref-type="bibr">28</xref>, <xref rid="pone.0216594.ref029" ref-type="bibr">29</xref>]. The isocenter was placed at (0,0,0), and Gaussian distributed noise was introduced on each signal of the quadrature detector with zero mean and standard deviation equal to 20.</p>
        <p>The raw data of the simulation were downloaded through the frontend of the coreMRI platform and reconstructed offline using a simple Fourier transform. A MOLLI T1 map was generated and the quantified T1 values were compared against the true values. The simulations were performed on a p2.xlarge instance type provided by Amazon AWS equipped with 1 GPU (NVIDIA K80).</p>
      </sec>
      <sec id="sec015">
        <title>2.3.4 MR Imaging mode: Magnetization transfer</title>
        <p>A generalized exchange model that simulated Magnetization Transfer (MT) was developed in coreMRI. This model was based on the solutions of the Bloch-McConnell equations [<xref rid="pone.0216594.ref030" ref-type="bibr">30</xref>] at every point of the anatomical object and at each time point of the pulse sequence. To demonstrate the effect of MT on T1 mapping, the MOLLI pulse sequence (Section 2.3.3) was applied on a computer model both with and without the MT model.</p>
        <p>The computer model consisted of three cylinders of radius equal to 50 mm each. The height of both the cylindrical phantoms was selected equal to 2 mm to reduce the total number of isochromats in the computer model and, in turn, to improve the performance of the simulation. The three cylinders represented agar phantoms with an increasing macromolecular content (2%, 4% and 8% agar concentration). The physical properties of these computer phantoms are shown in <xref rid="pone.0216594.t001" ref-type="table">Table 1</xref> [<xref rid="pone.0216594.ref020" ref-type="bibr">20</xref>, <xref rid="pone.0216594.ref031" ref-type="bibr">31</xref>]. The raw data of the simulations were downloaded through the frontend of the coreMRI platform and reconstructed offline using a simple Fourier transform in MATLAB. MOLLI T1 maps were generated for both cases (with and without MT model) and the quantified T1 values were compared against the true values. The simulations were performed on a p2.xlarge instance equipped with 1 GPU (NVIDIA K80).</p>
        <table-wrap id="pone.0216594.t001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.t001</object-id>
          <label>Table 1</label>
          <alternatives>
            <graphic id="pone.0216594.t001g" xlink:href="pone.0216594.t001"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="center" rowspan="1" colspan="1">
                    <italic>Phantom</italic>
                  </th>
                  <th align="center" rowspan="1" colspan="1">
                    <italic>T1 (ms)</italic>
                  </th>
                  <th align="center" rowspan="1" colspan="1">
                    <italic>T2 (ms)</italic>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="center" rowspan="1" colspan="1">
                    <italic>Agar 2%</italic>
                  </td>
                  <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">2294</td>
                  <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">71</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">
                    <italic>Agar4%</italic>
                  </td>
                  <td align="center" rowspan="1" colspan="1">1735</td>
                  <td align="center" rowspan="1" colspan="1">37</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">
                    <italic>Agar 8%</italic>
                  </td>
                  <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">1218</td>
                  <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">19</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="t001fn001">
              <p>Physical properties of three computer models that represent phantoms with an increased macromolecular content (2%, 4% and 8% agar concentration). T1 and T2 values were taken from the literature [<xref rid="pone.0216594.ref031" ref-type="bibr">31</xref>].</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec id="sec016">
        <title>2.3.5 MR imaging mode: Motion</title>
        <p>To simulate more realistic aspects of the MRI experiment and to investigate the performance of the coreMRI platform on a heavy computational environment, two rigid-body motion models were utilized in this study, a translational motion model and a rotational motion model. The translational motion model allowed the translation of the anatomical model along a single axis by a distance D from the initial position with a frequency given in Hz. The rotational motion model allowed the rotation in the XY-plane of the anatomical model around a center of rotation by a rotational angle θ from the initial position with a frequency given in Hz. The rotational motion model was given by:
<disp-formula id="pone.0216594.e001"><alternatives><graphic xlink:href="pone.0216594.e001.jpg" id="pone.0216594.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mi mathvariant="normal">sin</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mi mathvariant="normal">cos</mml:mi></mml:mrow><mml:mrow><mml:mi>θ</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>y</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where x’ and y’ were the new coordinates of each point after rotation around a center of rotation with coordinates x<sub>center</sub> and y<sub>center</sub>. A graphical representation of the two motion models is given in <xref ref-type="fig" rid="pone.0216594.g004">Fig 4</xref>. The displacement of the anatomical model isochromats from their initial position was calculated within the computational kernel of the coreMRI simulation platform for every time-step of the pulse sequence.</p>
        <fig id="pone.0216594.g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g004</object-id>
          <label>Fig 4</label>
          <caption>
            <title>Graphical representation of the two motion models utilized in this study.</title>
            <p>Translational motion model on the left, rotational motion model on the right.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g004"/>
        </fig>
        <p>For both motion models, the 512 x 512 GRE pulse sequence (section 2.3.1) was applied on the entire volume of the McGill anatomical model of the human brain. For translational-motion simulations, translational motion was induced on the three axes separately for a 5 cm distance and frequency 1Hz. For rotational-motion simulations, rotational motion was induced for 1) a rotational angle of 20<sup>o</sup> and frequency 1Hz, 2) a rotational angle of 10<sup>o</sup> and frequency 1Hz, and 3) a rotational angle of 10<sup>o</sup> and frequency 3Hz. The simulated MR images were generated with no noise. The simulations were performed on a p2.xlarge instance equipped with 1 GPU (NVIDIA K80).</p>
        <p>For comparison purposes, a similar GRE pulse sequence was applied on a healthy volunteer with no medical history (female, age 29 years). The healthy volunteer was instructed to rotate her head within the head-coil with a rotational angle of approximately 10<sup>o</sup> and frequency approximately 2 Hz. The study was approved by the local ethics committee (The Regional Ethics Committee, Lund, Sweden) and the subject provided written consent.</p>
      </sec>
      <sec id="sec017">
        <title>2.3.6 MR Imaging mode: B0 inhomogeneity</title>
        <p>The structure of the anatomical model allowed the introduction of a main-magnetic-field (B0) inhomogeneity map which held the strength of the effective magnetic field that applied on each individual isochromat of the anatomical model. To demonstrate the incorporation of the B0 inhomogeneity map into the coreMRI simulation, the effect of a linear B0 inhomogeneity on T1 mapping was investigated. For this purpose, the MOLLI pulse sequence (Section 2.3.3) was applied on a computer model of a single hollow cylinder with relaxation times (T1 = 900 ms and T2 = 50 ms) similar to the ones reported in the literature for normal myocardium at 1.5 T [<xref rid="pone.0216594.ref026" ref-type="bibr">26</xref>, <xref rid="pone.0216594.ref027" ref-type="bibr">27</xref>]. The hollow cylinder had a diameter equal to 56 mm and a wall thickness equal to 8 mm representing approximate dimensions of a normal left ventricle [<xref rid="pone.0216594.ref032" ref-type="bibr">32</xref>, <xref rid="pone.0216594.ref033" ref-type="bibr">33</xref>]. A linear inhomogeneity map that induced a B0 variation of ±150 Hz across the phantom diameter was introduced along the PE direction (<xref ref-type="fig" rid="pone.0216594.g005">Fig 5</xref>), covering the maximum B0 variation over the left ventricle of the heart as reported in literature [<xref rid="pone.0216594.ref034" ref-type="bibr">34</xref>]. The T1 values from ROIs within the center of 6 segments (<xref ref-type="fig" rid="pone.0216594.g006">Fig 6</xref>) around the phantom were quantified and compared against the true T1 value. The simulations were performed on a p2.xlarge instance equipped with 1 GPU (NVIDIA K80).</p>
        <fig id="pone.0216594.g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g005</object-id>
          <label>Fig 5</label>
          <caption>
            <title>Computer model with a linear B0 inhomogeneity map.</title>
            <p>Computer model of a cylinder with a linear B0 inhomogeneity map of ±150 Hz across its diameter along the PE direction.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g005"/>
        </fig>
        <fig id="pone.0216594.g006" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g006</object-id>
          <label>Fig 6</label>
          <caption>
            <title>Computer phantom segmentation.</title>
            <p>Segmentation of the computer phantom for measuring the T1 values from the simulated MR images.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g006"/>
        </fig>
        <p>In a similar manner, a second experiment was performed to demonstrate how close MR simulations are to real conditions. For this purpose, a phantom (plastic bottle of 500 ml) with target T1 and T2 values close to the relaxations constants of native myocardium was prepared in the lab. Agarose powder was weighed and dissolved in distilled water and the proper amount of 10 mM CuSO4 was added. The mixture was heated, poured into a separate container and left to reach the MR scanner room temperature. The phantom was placed in the scanner in an upright position (long axis of phantom along the posterior-anterior direction) and the T1 and T2 reference values of the phantom were measured. B0 variation of ±150Hz across the phantom diameter (along the z direction) was induced by adding a voltage offset to the first order Z-shim gradient (along the read direction) during imaging and a MOLLI pulse sequence was acquired (TR/TE selected to be the lowest available 2.46/1.23 ms, the bSSFP readout used a 490 μs sinc-shaped RF pulse with 6 mm slice thickness and 35° excitation flip angle, the IR pulse was a tan/tanh adiabatic pulse with 2.56 ms duration, a linear ramp-up preparation of 10 pulses was used to reach steady state prior to the bSSFP readout, the field of view was 360 (FE) x 270 (PE) mm, the scan matrix size was 160 (FE) x 120 (PE), the receiver BW was 200 kHz, and the acquisition scheme was 5(3p)3). B0-maps were estimated on a pixel-wise basis using a multi-echo gradient-recalled echo sequence using six echo times ranging from 4.1–28.5ms, ΔTE 4.9ms, TR 500ms, flip-angle 50° and monopolar readout gradients.</p>
        <p>A computer model of the phantom (identical diameter, reference T1 and T2 values, voxel size 0.05mm<sup>3</sup>) was developed and a linear inhomogeneity map that induced a B0 variation of ±150 Hz across the phantom diameter was introduced along the PE direction. The MOLLI pulse sequence (Section 2.3.3) was applied on the computer model of the phantom and the variation of the mean T1 values from three ROIs that were placed along the direction of the induced B0 inhomogeneity were compared against the real MR experiment. A second set of experiments (MR scanner and simulation) was performed without the application of B0 inhomogeneity.</p>
      </sec>
      <sec id="sec018">
        <title>2.3.7 MR Imaging mode: Multiple-element receiver coil</title>
        <p>The structure of the anatomical model allowed the simulation of a multiple-element receiver coil through the introduction of the sensitivity maps of every coil element. Eight circular coil elements of 60 mm radius each were placed in the three-dimensional space around the McGill anatomical model of the human brain, around the transversal slice at z position equal to 9.05 cm, as shown in <xref ref-type="fig" rid="pone.0216594.g007">Fig 7</xref>. The three-dimensional sensitivity maps of the coil elements were calculated using the Biot-Savart law with a spatial resolution identical to the resolution of the anatomical model. The anatomical model of the human brain (including the coil sensitivity maps) was uploaded on the coreMRI platform and the 512 x 512 GRE pulse sequence was applied on the entire volume of the anatomical model. The simulation was performed on a p2.16xlarge instance equipped with 16 GPUs (NVIDIA K80).</p>
        <fig id="pone.0216594.g007" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g007</object-id>
          <label>Fig 7</label>
          <caption>
            <title>Position of the coil elements.</title>
            <p>Position of the eight circular coil elements around the transversal slice of the McGill anatomical model of the human brain at z position of 9.05 cm.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g007"/>
        </fig>
      </sec>
      <sec id="sec019">
        <title>2.3.8 Quantitative MR mode: Simulation-based quantitative MR methods (SQUAREMR)</title>
        <p>To investigate the utilization of coreMRI in simulation-based quantitative MR techniques (such as SQUAREMR [<xref rid="pone.0216594.ref015" ref-type="bibr">15</xref>]), the coreMRI simulation platform was used for the generation of extensive databases of simulated MR signals. A MOLLI pulse sequence was first applied on a healthy human volunteer on a MAGNETOM Aera 1.5 T scanner (Siemens Healthcare, Erlangen, Germany) and then extracted from the MR scanner and simulated on coreMRI for a wide range of T1 and T2 values [<xref rid="pone.0216594.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0216594.ref031" ref-type="bibr">31</xref>]. One SASHA experiment [<xref rid="pone.0216594.ref034" ref-type="bibr">34</xref>] using a prototype sequence and a T2prep-bSSFP experiment [<xref rid="pone.0216594.ref035" ref-type="bibr">35</xref>] as reference for T1 and T2 mapping, respectively, were acquired. The study was approved by the local ethics committee (The Regional Ethics Committee, Lund, Sweden) and the subject provided written consent.</p>
        <p>The MOLLI pulse sequence parameters were the following: an acquisition scheme 5s(3s)3s was used, the IR pulse was a 5.12 ms tangent/hyperbolic tangent adiabatic, the inversion time (TI) range was 103–183 ms, the bSSFP readout used a 1050 μs sinc-shaped RF pulse with 6 mm slice thickness and 70<sup>o</sup> excitation flip angle, the field-of-view (FOV) was 360 mm × 270 mm, the acquisition matrix was 192 ×144, the receiver bandwidth (rBW) was 1085 Hz/pixel, the TE/TR were 1.29/2.95 ms, whereas phase partial Fourier 7/8, GRAPPA acceleration factor of 2 with 36 reference lines acquired at the end of the MOLLI pulse sequence (GRE-separate), linear k-space trajectory and linear ramp up preparation of 5 RF pulses were utilized. The bSSFP acquisition window was 185 ms and the total duration of the MOLLI acquisition was 11 s. The MOLLI pulse sequence was extracted through the sequence development environment from the IDEA framework (Siemens Healthcare, Erlangen, Germany) as a .dsv file format and converted to a coreMRI compatible format. The effective inversion times of the single-shot images [<xref rid="pone.0216594.ref015" ref-type="bibr">15</xref>] were defined and the pulse sequence was uploaded to the cloud through the frontend of the coreMRI platform.</p>
        <p>The pulse sequence was simulated on a spin population (138,621 spins) covering a large range of physiological combinations of native myocardial T1 and T2 values. T1 and T2 values of 700–1500 ms and 20– 100 ms, respectively, were simulated with a T1 step of 5 ms and a T2 step of 2 ms. The excitation slice profile was simulated on 21 spins across the slice-selection direction [<xref rid="pone.0216594.ref015" ref-type="bibr">15</xref>]. The pulse sequence consisted of 1,286,041 discrete time-steps and a database of 6,601 entries, each with 8 points, was generated. The simulation was performed on a p2.xlarge instance equipped with 1 GPU (NVIDIA K80).</p>
        <p>T1 and T2 maps from the healthy volunteer with no medical history (female, age 22 years) were produced using the SQUAREMR method [<xref rid="pone.0216594.ref015" ref-type="bibr">15</xref>] and the SQUAREMR-based quantified T1 and T2 values from a septal ROI were compared against the corresponding values resulted from conventional T1 and T2 mapping techniques (MOLLI [<xref rid="pone.0216594.ref025" ref-type="bibr">25</xref>] and SASHA [<xref rid="pone.0216594.ref035" ref-type="bibr">35</xref>] for T1 mapping and T2prep-bSSFP [<xref rid="pone.0216594.ref036" ref-type="bibr">36</xref>] for T2 mapping). An extensive validation of the SQUAREMR technique on phantoms and healthy volunteers is available in the literature [<xref rid="pone.0216594.ref031" ref-type="bibr">31</xref>].</p>
      </sec>
      <sec id="sec020">
        <title>2.3.9 coreMRI performance assessment</title>
        <p>To demonstrate the performance and scalability of coreMRI on multi-GPU configurations on the cloud, the execution times of the computational kernel were recorded for eight (8) different types of GPU-equipped instances (g2, g3 and p2 family types of GPU-equipped instances), two (2) different types of experiments (MR Imaging and quantitative MR) and several different sizes of simulations (size of anatomical model and size of pulse sequence).</p>
        <p>For the purpose of MR imaging, the 512 x 512 GRE pulse sequence (section 2.3.1) was applied on the McGill human brain phantom (section 2.3.2). The GRE pulse sequence was applied in its uncompressed and compressed versions (fast algorithm [<xref rid="pone.0216594.ref013" ref-type="bibr">13</xref>]) on both the entire volume and a single slice of the McGill human brain phantom. The fast algorithm allowed for a variable time step size during times when no changes occurred within the pulse sequence and when the acquisition window was off. These combinations resulted in four (4) different sets of simulations in total: 1) Uncompressed GRE pulse sequence on the entire volume of the anatomical model, 2) Compressed GRE pulse sequence on the entire anatomical model, 3) Uncompressed GRE pulse sequence on a single slice of the anatomical model and 4) Compressed GRE pulse sequence on a single slice of the anatomical model. The number of the total time-steps of the pulse sequence was 5,120,000 for its uncompressed version (fast algorithm disabled) and 3,651,072 for its compressed version (fast algorithm enabled). The entire anatomical model consisted of 2,380 471 isochromats, whereas the single slice consisted of 21,113 isochromats. Last, for comparison purposes, the simulation of the compressed version of the 512 x 512 GRE pulse sequence on the entire volume of the McGill human brain phantom was also performed using another simulation platform, MRISIMUL [<xref rid="pone.0216594.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0216594.ref013" ref-type="bibr">13</xref>], on an in-house, single GPU computer system equipped with a TESLA C2070 GPU card (448 CUDA cores and 6GB GPU memory).</p>
        <p>For the purpose of quantitative MR mode, the compressed version (fast algorithm [<xref rid="pone.0216594.ref013" ref-type="bibr">13</xref>]) of MOLLI pulse sequence was utilized on a population of spins and one database of simulated MR signals was generated for the range of physiological combinations of native myocardial T1 and T2 values described in section 2.3.8 (total database entries 6,601).</p>
        <p>For every family type of the GPU-equipped instances (g2, g3 and p2), the speedup was calculated against the single-GPU configuration of the g2 family (g2.2xlarge) which is considered as the earliest/oldest available GPU-based instance provided by Amazon AWS. The execution times of the computational kernel were measured in seconds.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="sec021">
    <title>3 Results</title>
    <sec id="sec022">
      <title>3.1 MR imaging mode</title>
      <sec id="sec023">
        <title>3.1.1 Pulse sequence designer</title>
        <p>The graphical representation of the first Group of Blocks (GoB) of the 128x128 Gradient Echo pulse sequence is shown in <xref ref-type="fig" rid="pone.0216594.g008">Fig 8</xref>. This GoB represents the first repetition time (TR). In the tree-view interface, on the left side of the pulse sequence designer, the GoB is organized in three blocks, and these blocks hold RF, gradient, software crushers and acquisition objects. On the right side of the pulse sequence designer, the graphical representation of the selected GoB is shown. The graphical representation is divided into the following five diagrams (from top to bottom): RF objects, gradient objects on X axis (frequency-encoding direction), gradient objects on Y axis (phase-encoding direction), gradient objects on Z axis (slice-selection direction) and acquisition objects. <xref ref-type="fig" rid="pone.0216594.g009">Fig 9</xref> shows the acquisition object’s parameters organized in a table form, whereas the fourth column (Custom) of the table shows the functional programming that was applied during the design of this object. Last, <xref ref-type="fig" rid="pone.0216594.g010">Fig 10</xref> shows the design of the entire GRE pulse sequence.</p>
        <fig id="pone.0216594.g008" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g008</object-id>
          <label>Fig 8</label>
          <caption>
            <title>Pulse sequence designer.</title>
            <p>The web-application of the Pulse Sequence Designer and the graphical representation of the first Group of Blocks (GoB) of the 128x128 Gradient Echo pulse sequence.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g008"/>
        </fig>
        <fig id="pone.0216594.g009" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g009</object-id>
          <label>Fig 9</label>
          <caption>
            <title>Pulse sequence designer.</title>
            <p>The web-application of the Pulse Sequence Designer and the presentation of the acquisition object’s parameters organized in a table form. The fourth column (Custom) of the table shows the functional programming that was applied during the design of this object.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g009"/>
        </fig>
        <fig id="pone.0216594.g010" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g010</object-id>
          <label>Fig 10</label>
          <caption>
            <title>Illustration of the entire 128x128 Gradient Echo pulse sequence.</title>
            <p>This figure was generated offline. The first graph (top to bottom) presents the magnitude of the RF pulses, the second to fourth graphs present the magnitude of the gradients applied on X, Y and Z axis, respectively, whereas the fifth graph presents the acquisition objects. (A MATLAB script to display the entire pulse sequence is available at this link: <ext-link ext-link-type="uri" xlink:href="http://www.coremri.org/index.php/documentation/29-pulse-sequence-gui-plot-the-entire-pulse-sequence">www.coremri.org/index.php/documentation/29-pulse-sequence-gui-plot-the-entire-pulse-sequence</ext-link>).</p>
          </caption>
          <graphic xlink:href="pone.0216594.g010"/>
        </fig>
      </sec>
      <sec id="sec024">
        <title>3.1.2 Virtual MR scanner</title>
        <p><xref ref-type="fig" rid="pone.0216594.g011">Fig 11</xref> shows GRE images obtained with the simulator after the application of the GRE pulse sequences (128x128, 256x256 and 512x512) on the entire volume of the McGill anatomical model of the human brain and reconstructed on Gadgetron. The first row of <xref ref-type="fig" rid="pone.0216594.g011">Fig 11</xref> shows the GRE images with no noise, the second row shows the same GRE images with Gaussian distributed noise on each signal of the quadrature detector with zero mean and standard deviation equal to 20, whereas the third row shows the same GRE images with Gaussian distributed noise on each signal of the quadrature detector with zero mean and standard deviation equal to 40.</p>
        <fig id="pone.0216594.g011" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g011</object-id>
          <label>Fig 11</label>
          <caption>
            <title>Simulated MR images after the application of GRE pulse sequences on the entire volume of the McGill anatomical model of the human brain and reconstructed on Gadgetron.</title>
            <p>Left column presents the simulated MR images from a 128x128 GRE pulse sequence, center column presents the simulated MR images from a 256x256 GRE pulse sequence, and right column presents the simulated MR images from a 512x512 GRE pulse sequence. The first row shows the GRE images with no noise, the second row shows the same GRE images with Gaussian distributed noise with zero mean and standard deviation equal to 20, whereas the third row shows the same GRE images with Gaussian distributed noise with zero mean and standard deviation equal to 40. The contrast of each image was adjusted to fit the image data range, with a 2% padding at the upper and lower bounds. The kernel execution time on a p2.16xlarge instance was 99s for the 128x128 GRE pulse sequence, 209s for the 256x256 GRE pulse sequence and 457s for the 512x512 GRE pulse sequence.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g011"/>
        </fig>
        <p><xref ref-type="fig" rid="pone.0216594.g012">Fig 12</xref> presents the noiseless GRE images obtained with the simulator after the application of the 512x512 GRE pulse sequence A) only on the spins located at the z-position of the isocenter B) only on the spins located up to ±3 mm away from the z-position of the isocenter and C) on the entire volume of the anatomical model. The generated MR images present well the anatomical regions of the computer model of the human brain (compared to <xref ref-type="fig" rid="pone.0216594.g007">Fig 7</xref>) and the contrast between the different tissue types as defined by the different tissues characteristics (T1, T2, etc.) and the characteristics of the pulse sequence (TE, TR, etc.).</p>
        <fig id="pone.0216594.g012" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g012</object-id>
          <label>Fig 12</label>
          <caption>
            <title>Noiseless GRE images obtained with the simulator after the application of the 512x512 GRE pulse sequence.</title>
            <p>A) only on the spins located at the z-position of the isocenter B) only on the spins located ±3 mm (slice thickness 6mm) away from the z-position of the isocenter, and C) on the entire volume of the anatomical model. The kernel execution time on a p2.xlarge instance was 292 s for case A, 451 s for case B and 4,801 s for case C. Note the different appearance of the simulated MR images for the different volumes of spins of the same anatomical model.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g012"/>
        </fig>
      </sec>
      <sec id="sec025">
        <title>3.1.3 coreMRI for simulation purposes only</title>
        <p><xref ref-type="fig" rid="pone.0216594.g013">Fig 13</xref> depicts the magnitude images sorted by inversion time and the resulting coloured MOLLI T1 map. The average T1 values of the two phantoms were measured equal to 837 ms and 1451 ms. The underestimation of MOLLI on the true T1 values (900 ms and 1500 ms, respectively) agrees with previous studies [<xref rid="pone.0216594.ref015" ref-type="bibr">15</xref>, <xref rid="pone.0216594.ref028" ref-type="bibr">28</xref>].</p>
        <fig id="pone.0216594.g013" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g013</object-id>
          <label>Fig 13</label>
          <caption>
            <title>MOLLI pulse sequence images.</title>
            <p>On the left, magnitude images obtained from MOLLI pulse sequence sorted by inversion time. On the right, the resulting coloured MOLLI T1 map. The kernel execution time on a p2.xlarge instance was 118 s.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g013"/>
        </fig>
      </sec>
      <sec id="sec026">
        <title>3.1.4 Magnetization transfer</title>
        <p><xref ref-type="fig" rid="pone.0216594.g014">Fig 14</xref> (right) shows the magnitude images of the three-cylinder phantom setup. The images were obtained from the simulator with the application of the MT model. The signal intensity curves for the three agar phantoms, with and without the simulation of the MT model, are shown in <xref ref-type="fig" rid="pone.0216594.g014">Fig 14</xref> (left) at a simulated heart rate of 60 bpm. The corresponding T1 values were 2031 ms, 1512 ms and 1003 ms for the first case (no MT), and 1920 ms, 1405 ms and 902 ms for the second case (with MT) for the phantoms agar 2%, 4% and 8%, respectively. The bias in T1 estimates due to the MT effect agrees with previous studies [<xref rid="pone.0216594.ref028" ref-type="bibr">28</xref>, <xref rid="pone.0216594.ref031" ref-type="bibr">31</xref>] that investigate the effect of MT on MOLLI T1 estimates.</p>
        <fig id="pone.0216594.g014" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g014</object-id>
          <label>Fig 14</label>
          <caption>
            <title>Magnetization transfer.</title>
            <p>(Left) Signal intensity curves for the three agar computer phantoms: Agar 2% on the left, Agar 4% in the center, and Agar 8% on the right. The curve in blue shows the signal intensity without the simulation of the MT model, whereas the curve in orange shows the corresponding signal intensity with simulation of the MT model. Note the change of the shapes of the inversion recovery curves due to MT. (Right) Magnitude images of the computer model of three cylinders after the application of a MOLLI pulse sequence for inversion times 1200 ms and 2300 ms. The bottom left cylinder represents an Agar phantom with a 2% macromolecular content, the bottom right cylinder represents an Agar phantom with a 4% macromolecular content, whereas the top cylinder represents an Agar phantom with an 8% macromolecular content. The kernel execution time on a p2.xlarge instance was 105 s without the simulation of the MT model and 137 s with the simulation of the MT model.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g014"/>
        </fig>
      </sec>
      <sec id="sec027">
        <title>3.1.5 Motion</title>
        <p>The motion-induced artifacts on the GRE images of the McGill anatomical model of the human brain are presented in <xref ref-type="fig" rid="pone.0216594.g015">Fig 15</xref>. <xref ref-type="fig" rid="pone.0216594.g015">Fig 15A, 15B and 15C</xref> illustrate the anatomical model under translational motion of 5 cm distance and frequency 1 Hz on x, y and z axis, respectively, whereas <xref ref-type="fig" rid="pone.0216594.g015">Fig 15D, 15E and 15F</xref> illustrate the anatomical model under rotational motion with a rotational angle of 20<sup>o</sup> and frequency 1 Hz, a rotational angle of 10<sup>o</sup> and frequency 1 Hz, and a rotational angle of 10<sup>o</sup> and frequency 3 Hz, respectively. For comparison purposes, <xref ref-type="fig" rid="pone.0216594.g015">Fig 15H</xref> presents the GRE head image that was acquired from a healthy volunteer who was instructed to rotate the head within the head-coil with a rotational angle of approximately 10o and frequency approximately 2 Hz. <xref ref-type="fig" rid="pone.0216594.g015">Fig 15G</xref> shows the GRE head image that was acquired from the healthy volunteer under no motion.</p>
        <fig id="pone.0216594.g015" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g015</object-id>
          <label>Fig 15</label>
          <caption>
            <title>Noiseless GRE images with motion-induced artifacts after the application of the 512x512 GRE pulse sequence on the entire volume of the McGill anatomical model of the human brain.</title>
            <p>A) Under translational motion of 5cm distance and frequency 1 Hz on x axis, B) under translational motion of 5cm distance and frequency 1 Hz on y axis, C) under translational motion of 5cm distance and frequency 1 Hz on z axis, D) under rotational motion with a rotational angle of 20<sup>o</sup> and frequency 1 Hz, E) under rotational motion with a rotational angle of 10<sup>o</sup> and frequency 1 Hz, and F) under rotational motion with a rotational angle of 10<sup>o</sup> and frequency 3 Hz. Note the motion artifacts in the phase-encoding direction. The kernel execution time on a p2.xlarge instance was 4235 s without the simulation of the motion model, 4408 s for the translational motion model and 4709 s for the rotational motion model. For comparison purposes, Fig H presents the GRE head image that was acquired from a healthy volunteer who was instructed to rotate the head within the head-coil with a rotational angle of approximately 10<sup>o</sup> and frequency approximately 2 Hz. Motion artifacts are present in the phase-encoding direction (posterior to anterior). Fig G shows the GRE head image that was acquired from the healthy volunteer under no motion.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g015"/>
        </fig>
      </sec>
      <sec id="sec028">
        <title>3.1.6 B0 inhomogeneity</title>
        <p><xref ref-type="fig" rid="pone.0216594.g016">Fig 16</xref> shows the T1 maps of the computer model of the myocardium. The left image of <xref ref-type="fig" rid="pone.0216594.g016">Fig 16</xref> presents the T1 map obtained from the simulator without the application of the B0 inhomogeneity map, whereas the right image presents the T1 map obtained with the application of a B0 variation of ±150 Hz across the phantom diameter along the PE direction. The measured T1 values from the ROIs within the center of the six segments with and without the B0 variation were 804 ms vs. 831 ms (segment 1), 828 ms vs. 835 ms (segment 2), 826 ms vs. 833 ms (segment 3), 814 ms vs. 835 ms (segment 4), 824 ms vs. 835 ms (segment 5), and 827 ms vs. 834 ms (segment 6). The variation in T1 estimates due to off-resonance is larger in segments 1 and 4 where the B0 variation is stronger. This trend has already been shown in a previous study in the literature [<xref rid="pone.0216594.ref034" ref-type="bibr">34</xref>].</p>
        <fig id="pone.0216594.g016" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g016</object-id>
          <label>Fig 16</label>
          <caption>
            <title>T1 maps of the computer model of the myocardium after the application of the MOLLI pulse sequence.</title>
            <p>The left image depicts the T1 map without the application of the B0 inhomogeneity map, whereas the right image presents the T1 map with the application of a B0 variation of ±150 Hz across the phantom diameter along the PE direction. Note artifactual local variations in the estimated T1 across the phase-encoding direction on the computer model in the right image. The kernel execution time on a p2.xlarge instance was 115 s with and without the application of the B0 inhomogeneity map.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g016"/>
        </fig>
        <p>For comparison purposes, a second experiment was performed to demonstrate how close MR simulations are to real conditions. The reference T1 and T2 values of the phantom were 1091 ms and 44 ms respectively. The measured T1 values from the three ROIs that were placed along the direction of the induced B0 inhomogeneity in true and simulated MOLLI images (noiseless) with and without the application of B0 inhomogeneity are presented in <xref rid="pone.0216594.t002" ref-type="table">Table 2</xref>. The T1 measurements in true MOLLI images are close to the T1 measurements in simulated MOLLI images with and without the application of B0 inhomogeneity.</p>
        <table-wrap id="pone.0216594.t002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.t002</object-id>
          <label>Table 2</label>
          <alternatives>
            <graphic id="pone.0216594.t002g" xlink:href="pone.0216594.t002"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
                <col align="left" valign="middle" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="center" rowspan="1" colspan="1"/>
                  <th align="center" rowspan="1" colspan="1"/>
                  <th align="center" colspan="3" style="background-color:#D0CECE" rowspan="1">T1 values (ms, mean±SD)</th>
                </tr>
                <tr>
                  <th align="center" rowspan="1" colspan="1"/>
                  <th align="center" rowspan="1" colspan="1"/>
                  <th align="center" rowspan="1" colspan="1">ROI on one side of phantom (negative B0 inhom.)</th>
                  <th align="center" rowspan="1" colspan="1">ROI at the center of phantom</th>
                  <th align="center" rowspan="1" colspan="1">ROI on one side of phantom (positive B0 inhom.)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="center" rowspan="2" colspan="1">With B0 inhomogeneity</td>
                  <td align="center" rowspan="1" colspan="1">MR scanner</td>
                  <td align="center" rowspan="1" colspan="1">954±27</td>
                  <td align="center" rowspan="1" colspan="1">1002±8</td>
                  <td align="center" rowspan="1" colspan="1">957±12</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Simulation</td>
                  <td align="center" rowspan="1" colspan="1">956±3</td>
                  <td align="center" rowspan="1" colspan="1">994±9</td>
                  <td align="center" rowspan="1" colspan="1">953±4</td>
                </tr>
                <tr>
                  <td align="center" rowspan="2" colspan="1">Without B0 inhomogeneity</td>
                  <td align="center" rowspan="1" colspan="1">MR scanner</td>
                  <td align="center" rowspan="1" colspan="1">1003±18</td>
                  <td align="center" rowspan="1" colspan="1">1000±6</td>
                  <td align="center" rowspan="1" colspan="1">1014±10</td>
                </tr>
                <tr>
                  <td align="center" rowspan="1" colspan="1">Simulation</td>
                  <td align="center" rowspan="1" colspan="1">994±1</td>
                  <td align="center" rowspan="1" colspan="1">996±1</td>
                  <td align="center" rowspan="1" colspan="1">994±1</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="t002fn001">
              <p>T1 values (in ms, mean±SD) measured from three ROIs that were placed along the direction of the induced B0 inhomogeneity in true and simulated MOLLI images (noiseless) with and without the application of B0 inhomogeneity. The reference T1 and T2 values of the phantom were 1091 ms and 44 ms.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec id="sec029">
        <title>3.1.7 Multiple-element receiver coil</title>
        <p><xref ref-type="fig" rid="pone.0216594.g017">Fig 17</xref> shows the results obtained with coreMRI and a multiple-element receive configuration with a GRE pulse sequence (512x512) applied on the entire volume of the McGill human brain phantom. <xref ref-type="fig" rid="pone.0216594.g017">Fig 17A–17H</xref> illustrate the per-coil-element reconstructed magnitude images, whereas <xref ref-type="fig" rid="pone.0216594.g017">Fig 17I</xref> shows the final reconstructed image.</p>
        <fig id="pone.0216594.g017" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g017</object-id>
          <label>Fig 17</label>
          <caption>
            <title>Multiple-element receiver coil.</title>
            <p>A-H) Noiseless GRE images per coil element after the application of the 512x512 GRE pulse sequence on the entire volume of the McGill human brain phantom. I) The final noiseless reconstructed GRE image after the combination of all the coil-elements. The images were reconstructed on Gadgetron. The kernel execution time on a p2.16xlarge instance was 1177 s.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g017"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec030">
      <title>3.2 Quantitative MR mode</title>
      <sec id="sec031">
        <title>3.2.1 Simulation-based quantitative MR methods (SQUAREMR)</title>
        <p><xref ref-type="fig" rid="pone.0216594.g018">Fig 18</xref> presents the T1 and T2 maps from the healthy volunteer derived from the SQUAREMR method. The average myocardial T1 from an ROI placed at the septum was 1149±56 ms for SQUAREMR and 1005±23 ms for conventional MOLLI and 1251±70 ms for conventional SASHA, whereas the average myocardial T2 from the same ROI was 43±8 ms for SQUAREMR and 46±2 ms for conventional T2prep-bSSFP.</p>
        <fig id="pone.0216594.g018" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0216594.g018</object-id>
          <label>Fig 18</label>
          <caption>
            <title>Quantitative measurements using the modified version of the MOLLI pulse sequence and the SQUAREMR method.</title>
            <p>T1 and T2 maps of a healthy volunteer extracted from the modified version of the MOLLI pulse sequence and the SQUAREMR method [<xref rid="pone.0216594.ref015" ref-type="bibr">15</xref>]. The kernel execution time on a p2.xlarge instance for the generation of database with the simulated MR signals took 154 s.</p>
          </caption>
          <graphic xlink:href="pone.0216594.g018"/>
        </fig>
      </sec>
    </sec>
    <sec id="sec032">
      <title>3.3 coreMRI performance assessment</title>
      <p><xref rid="pone.0216594.t003" ref-type="table">Table 3</xref> displays the kernel execution times for the eight different types of GPU-equipped instances provided by Amazon AWS and for the four different MR Imaging experiment types: 1) Uncompressed GRE pulse sequence on the entire volume of the anatomical model, 2) Compressed GRE pulse sequence on the entire anatomical model, 3) Uncompressed GRE pulse sequence on a single slice of the anatomical model, and 4) Compressed GRE pulse sequence on a single slice of the anatomical model.</p>
      <table-wrap id="pone.0216594.t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0216594.t003</object-id>
        <label>Table 3</label>
        <alternatives>
          <graphic id="pone.0216594.t003g" xlink:href="pone.0216594.t003"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="center" colspan="2" rowspan="1">Uncompressed GRE (512x512) on entire volume</th>
                <th align="center" colspan="2" rowspan="1">Compressed GRE (512x512) on entire volume</th>
                <th align="center" colspan="2" rowspan="1">Uncompressed GRE (512x512) on single slice</th>
                <th align="center" colspan="2" rowspan="1">Compressed GRE (512x512) on single slice</th>
              </tr>
              <tr>
                <th align="center" rowspan="1" colspan="1">instance-type</th>
                <th align="center" rowspan="1" colspan="1">GPU-type</th>
                <th align="center" rowspan="1" colspan="1">no. GPUs</th>
                <th align="center" rowspan="1" colspan="1">Kernel <break/>Time (s)</th>
                <th align="center" rowspan="1" colspan="1">Speedup</th>
                <th align="center" rowspan="1" colspan="1">Kernel Time (s)</th>
                <th align="center" rowspan="1" colspan="1">Speedup</th>
                <th align="center" rowspan="1" colspan="1">Kernel Time (s)</th>
                <th align="center" rowspan="1" colspan="1">Speedup</th>
                <th align="center" rowspan="1" colspan="1">Kernel Time (s)</th>
                <th align="center" rowspan="1" colspan="1">Speedup</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">g2.2xlarge</td>
                <td align="center" rowspan="1" colspan="1">K520</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">54162</td>
                <td align="left" style="background-color:#D0CECE" rowspan="1" colspan="1"> </td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">50031</td>
                <td align="left" style="background-color:#D0CECE" rowspan="1" colspan="1"> </td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">2690</td>
                <td align="left" style="background-color:#D0CECE" rowspan="1" colspan="1"> </td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">2496</td>
                <td align="left" style="background-color:#D0CECE" rowspan="1" colspan="1"> </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">g2.8xlarge</td>
                <td align="center" rowspan="1" colspan="1">K520</td>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">13923</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">3.9</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">13247</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">3.8</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">2550</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">1.1</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">2478</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">1.0</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">g3.4xlarge</td>
                <td align="center" rowspan="1" colspan="1">Tesla M60</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">3336</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">16.2</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">2605</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">19.2</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">194</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">13.9</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">150</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">16.6</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">g3.8xlarge</td>
                <td align="center" rowspan="1" colspan="1">Tesla M60</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">1781</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">30.4</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">1385</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">36.1</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">196</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">13.7</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">152</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">16.4</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">g3.16xlarge</td>
                <td align="center" rowspan="1" colspan="1">Tesla M60</td>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">894</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">60.6</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">694</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">72.1</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">197</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">13.7</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">152</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">16.4</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">p2.xlarge</td>
                <td align="center" rowspan="1" colspan="1">K80</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">4235</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">12.8</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">3049</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">16.4</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">240</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">11.2</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">180</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">13.9</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">p2.8xlarge</td>
                <td align="center" rowspan="1" colspan="1">K80</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">669</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">81.0</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">513</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">97.6</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">242</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">11.1</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">184</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">13.6</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">p2.16xlarge</td>
                <td align="center" rowspan="1" colspan="1">K80</td>
                <td align="center" rowspan="1" colspan="1">16</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">454</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">119.3</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">345</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">145.0</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">245</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">11.0</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">184</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">13.5</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t003fn001">
            <p>Kernel execution times for eight different types of GPU-equipped instances (g2, g3 and p2 family types of GPU-equipped instances) and four different sizes of simulations: 1. Uncompressed GRE pulse sequence on the entire volume of the anatomical model (5,120,000 time-steps and 2,380,471 isochromats), 2. Compressed GRE pulse sequence on the entire anatomical model (3,651,072 time-steps and 2, 380,471 isochromats), 3. Uncompressed GRE pulse sequence on a single slice of the anatomical model (5,120,000 time-steps and 21,113 isochromats), and 4. Compressed GRE pulse sequence on a single slice of the anatomical model (3,651,072 time-steps and 21,113 isochromats). Note that a single-GPU computer configuration performed fast simulations of a large pulse sequence on a single slice of the anatomical model (150 s on g3.4xlarge), whereas a multi-GPU computer performed fast simulations of a large pulse sequence on the entire volume of the anatomical model (345 s on p2.16xlarge).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p><xref rid="pone.0216594.t004" ref-type="table">Table 4</xref> displays the kernel execution times for the eight different types of GPU-equipped instances provided by Amazon AWS and for the application of the compressed MOLLI pulse sequence on the spin population.</p>
      <table-wrap id="pone.0216594.t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0216594.t004</object-id>
        <label>Table 4</label>
        <alternatives>
          <graphic id="pone.0216594.t004g" xlink:href="pone.0216594.t004"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
              <col align="left" valign="middle" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="left" rowspan="1" colspan="1"/>
                <th align="center" colspan="2" rowspan="1">Quantitative MR for T1 and T2 mapping using SQUAREMR</th>
              </tr>
              <tr>
                <th align="center" style="background-color:#FFFFFF" rowspan="1" colspan="1">instance-type</th>
                <th align="center" style="background-color:#FFFFFF" rowspan="1" colspan="1">GPU-type</th>
                <th align="center" style="background-color:#FFFFFF" rowspan="1" colspan="1">no. GPUs</th>
                <th align="center" style="background-color:#FFFFFF" rowspan="1" colspan="1">Kernel Time (s)</th>
                <th align="center" style="background-color:#FFFFFF" rowspan="1" colspan="1">Speedup</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" rowspan="1" colspan="1">g2.2xlarge</td>
                <td align="center" rowspan="1" colspan="1">K520</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">208.42</td>
                <td align="left" style="background-color:#D0CECE" rowspan="1" colspan="1"> </td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">g2.8xlarge</td>
                <td align="center" rowspan="1" colspan="1">K520</td>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">62.84</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">3.3</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">g3.4xlarge</td>
                <td align="center" rowspan="1" colspan="1">Tesla M60</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">105.12</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">2.0</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">g3.8xlarge</td>
                <td align="center" rowspan="1" colspan="1">Tesla M60</td>
                <td align="center" rowspan="1" colspan="1">2</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">56.45</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">3.7</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">g3.16xlarge</td>
                <td align="center" rowspan="1" colspan="1">Tesla M60</td>
                <td align="center" rowspan="1" colspan="1">4</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">31.81</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">6.6</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">p2.xlarge</td>
                <td align="center" rowspan="1" colspan="1">K80</td>
                <td align="center" rowspan="1" colspan="1">1</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">155.30</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">1.3</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">p2.8xlarge</td>
                <td align="center" rowspan="1" colspan="1">K80</td>
                <td align="center" rowspan="1" colspan="1">8</td>
                <td align="center" style="background-color:#F2F2F2" rowspan="1" colspan="1">28.54</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">7.3</td>
              </tr>
              <tr>
                <td align="center" rowspan="1" colspan="1">p2.16xlarge</td>
                <td align="center" rowspan="1" colspan="1">K80</td>
                <td align="center" rowspan="1" colspan="1">16</td>
                <td align="center" style="background-color:#FFFFFF" rowspan="1" colspan="1">20.12</td>
                <td align="center" style="background-color:#D0CECE" rowspan="1" colspan="1">10.4</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="t004fn001">
            <p>Kernel execution times for the eight different types of GPU-equipped instances (g2, g3 and p2 family types of GPU-equipped instances) and for the application of the compressed version of the MOLLI pulse sequence (1,286,041 time-steps) on the population of spins (138,621 isochromats). Note that the generation of the database of simulated MR signals is feasible within clinically acceptable levels (20 s on p2.16xlarge).</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The generation of the brain image took 454 s on the 16 GPUs computer system (p2.16xlarge type equipped with 16 K80 GPU devices) using the uncompressed version of the pulse sequence on the entire volume of the anatomical model (heavy computational environment) and 150 s on the single GPU computer system (g3.4xlarge type equipped with 1 Tesla M60 GPU device) using the compressed version of the pulse sequence on a single slice of the anatomical model (simple computational environment). The generation of the database of simulated MR signals took 20 s using the compressed version of the MOLLI pulse sequence on the 16-GPU computer system (p2.16xlarge type equipped with 16 K80 GPU devices). These results point out that a single-GPU computer configuration performs well on a single slice of the anatomical model, whereas a multi-GPU computer configuration performs similarly well on heavier computational environments and within clinically acceptable levels in quantitative MRI methods. Last, for comparison purposes, the simulation of the compressed version of the 512 x 512 GRE pulse sequence on the entire volume of the McGill human brain phantom with the use of the simulation platform MRISIMUL [<xref rid="pone.0216594.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0216594.ref013" ref-type="bibr">13</xref>] took 1693 s on an in-house, single GPU, computer system (TESLA C2070 GPU card).</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec033">
    <title>4 Discussion</title>
    <p>An advanced and high-performance MR simulation platform that is delivered as a web service through the cloud by utilizing a cloud-and-GPU-based infrastructure, was presented in this study. The coreMRI simulation platform is publicly available to the entire MR community (<ext-link ext-link-type="uri" xlink:href="http://www.coremri.org/">www.coremri.org</ext-link>) and allows its users to configure advanced MRI experiments without the constraints imposed by experimentation in a true MRI scanner (such as time constraint and limited availability of MR scanners), without upfront investment for purchasing advanced computer systems and without any user expertise on computer programming or MR physics.</p>
    <p>In this study, the coreMRI simulation platform was designed and developed as a web service that provided a web-based interface to the cloud-and-GPU-based infrastructure where the computationally demanding MR simulations were performed. Two simulation modes were considered that allowed the coreMRI simulation platform to be utilized either as a virtual MR scanner that simulates the entire MRI process (from pulse sequence development and selection of the anatomical model to signal generation and image formation) or as a generator of databases of simulated MR signals to be used in simulation-based quantitative MR methods, such as SQUAREMR [<xref rid="pone.0216594.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0216594.ref015" ref-type="bibr">15</xref>]. Moreover, the coreMRI simulation platform was based on a flexible, modular design that allowed individual modules to be added in the main simulation framework. In this study, the Gadgetron reconstruction framework was added as a reconstruction module in the coreMRI workflow, whereas a new module (Pulse Sequence Designer) that provided a web-application for pulse sequence design was developed and added in the coreMRI simulation platform.</p>
    <p>The different types and sources of pulse sequences and anatomical models that were utilized in this study showed the flexibility that the current design of the coreMRI simulation platform offered to the users. Three types and sources of pulse sequences were used in the current work: 1) Gradient Echo pulse sequences that were developed in the Pulse Sequence Designer of the coreMRI simulation platform, 2) a MOLLI pulse sequence that was developed offline and uploaded to the coreMRI platform, and 3) a MOLLI pulse sequence that was extracted from a true MR scanner and uploaded to the coreMRI platform. The pulse sequences were applied on a 3-D digital phantom of the human brain and on custom-made anatomical models, whereas other true aspects of MR Imaging, such as magnetization transfer, motion, B0 inhomogeneity and multi-element receive, were implemented in this study.</p>
    <p>Last, to demonstrate the relationship between the simulation size, the computer configuration and the kernel execution time, several test cases were examined with different combinations of the total pulse sequence time-steps, the total anatomical model isochromats, and the total number and model of GPU devices. The current work demonstrated that a single-GPU computer configuration performed fast simulations of large pulse sequences on a single slice of the anatomical model, whereas a multi-GPU computer equipped with a newer generation of GPU cards performed similarly well on the entire volume of the anatomical model. Although the recorded kernel execution times are highly dependent on the simulation size (size of pulse sequence and anatomical model), this study showed that a multi-GPU computer on the cloud equipped with a newer generation of GPU cards could significantly mitigate the prolonged execution times that accompany more realistic MRI and qMR simulations. Moreover, the latest and future advancements in GPU technology suggest that the performance of the coreMRI simulation platform has the potential to be further improved in the upcoming years.</p>
    <p>Despite the latest advancements in GPU and cloud computing and the user-friendliness of the coreMRI simulation platform, the proper design of a simulation experiment still requires the user to have experience in MR physics in order to avoid the appearance of non-realistic artifacts in the simulated MR images. Previous work [<xref rid="pone.0216594.ref012" ref-type="bibr">12</xref>, <xref rid="pone.0216594.ref013" ref-type="bibr">13</xref>, <xref rid="pone.0216594.ref037" ref-type="bibr">37</xref>, <xref rid="pone.0216594.ref038" ref-type="bibr">38</xref>] has already demonstrated that an insufficient frequency spacing among neighbouring isochromats within the anatomical model in combination with a strong-gradients pulse sequence may cause an image quality degradation. The user should be able to properly design the anatomical model based on the design of the pulse sequence and on the question at hand. For this purpose, the coreMRI simulation platform gives the user the ability to use artificial objects in the pulse sequence design, such as software crushers [<xref rid="pone.0216594.ref012" ref-type="bibr">12</xref>].</p>
    <p>The work presented here is the first step towards the development of a multi-purpose simulation platform as a web service which is publicly available and common across research groups. The current design of the coreMRI simulation platform, that combines not only high availability, scalability and performance but also compatibility with other platforms and standards (such as the pulseq framework and the ISMRMRD format), is expected to lay the foundations for establishing a simulation standard within the MR field and an online community for developing and sharing pulse sequences, anatomical models and simulation experiments that will eventually promote the MR research and education. Future work will be focused on the expansion of the MR simulation model in other MR applications (such as diffusion) and on the addition of more features (such as custom-defined motion models).</p>
  </sec>
  <sec sec-type="conclusions" id="sec034">
    <title>5 Conclusions</title>
    <p>coreMRI is the first advanced MR simulation platform delivered as a web service through an on-demand, scalable cloud-based and GPU-based infrastructure. coreMRI allows its users to exploit the highly tuned computer performance of GPUs on MR simulations with neither upfront investment for purchasing advanced computer systems nor technical programming expertise. coreMRI is available to the users through the webpage <ext-link ext-link-type="uri" xlink:href="https://www.coreMRI.org">https://www.coreMRI.org</ext-link>. An online and up-to-date documentation is available through the link: <ext-link ext-link-type="uri" xlink:href="https://www.coremri.org/documentation">https://www.coremri.org/documentation</ext-link></p>
  </sec>
  <sec sec-type="supplementary-material" id="sec035">
    <title>Supporting information</title>
    <supplementary-material content-type="local-data" id="pone.0216594.s001">
      <label>S1 Appendix</label>
      <caption>
        <title>Gradient Echo pulse sequence design with the coreMRI pulse sequence designer.</title>
        <p>(DOCX)</p>
      </caption>
      <media xlink:href="pone.0216594.s001.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The Amazon-cloud resources were awarded through the “AWS Cloud Credits for Research” program. The authors would like to acknowledge the Master Research Agreement between Skane University Hospital and Siemens Healthcare and Dr. Kelvin Chow for the prototype sequence.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0216594.ref001">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Jochimsen</surname><given-names>TH</given-names></name>, <name><surname>von Mengershausen</surname><given-names>M</given-names></name>. <article-title>ODIN-object-oriented development interface for NMR</article-title>. <source>Journal of magnetic resonance (San Diego, Calif: 1997)</source>. <year>2004</year>;<volume>170</volume>(<issue>1</issue>):<fpage>67</fpage>–<lpage>78</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmr.2004.05.021</pub-id> .<?supplied-pmid 15324759?><pub-id pub-id-type="pmid">15324759</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref002">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Magland</surname><given-names>JF</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Langham</surname><given-names>MC</given-names></name>, <name><surname>Wehrli</surname><given-names>FW</given-names></name>. <article-title>Pulse sequence programming in a dynamic visual environment: SequenceTree</article-title>. <source>Magn Reson Med</source>. <year>2016</year>;<volume>75</volume>(<issue>1</issue>):<fpage>257</fpage>–<lpage>65</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.25640</pub-id><?supplied-pmid 25754837?><pub-id pub-id-type="pmid">25754837</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref003">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Wissmann</surname><given-names>L</given-names></name>, <name><surname>Santelli</surname><given-names>C</given-names></name>, <name><surname>Segars</surname><given-names>WP</given-names></name>, <name><surname>Kozerke</surname><given-names>S</given-names></name>. <article-title>MRXCAT: Realistic numerical phantoms for cardiovascular magnetic resonance</article-title>. <source>Journal of cardiovascular magnetic resonance: official journal of the Society for Cardiovascular Magnetic Resonance</source>. <year>2014</year>;<volume>16</volume>:<fpage>63</fpage><pub-id pub-id-type="doi">10.1186/s12968-014-0063-3</pub-id><?supplied-pmid 25204441?><pub-id pub-id-type="pmid">25204441</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref004">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Stöcker</surname><given-names>T</given-names></name>, <name><surname>Vahedipour</surname><given-names>K</given-names></name>, <name><surname>Shah</surname><given-names>NJ</given-names></name>. <article-title>Simulation of spin dynamics: a tool in MRI system development</article-title>. <source>Journal of Physics Conference Series</source>. <year>2011</year>;<volume>295</volume>(<issue>1</issue>).</mixed-citation>
    </ref>
    <ref id="pone.0216594.ref005">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Hacklander</surname><given-names>T</given-names></name>, <name><surname>Mertens</surname><given-names>H</given-names></name>, <name><surname>Cramer</surname><given-names>BM</given-names></name>. [<article-title>Computer simulation of a clinical magnet resonance tomography scanner for training purposes</article-title>]. <source>RoFo: Fortschritte auf dem Gebiete der Rontgenstrahlen und der Nuklearmedizin</source>. <year>2004</year>;<volume>176</volume>(<issue>8</issue>):<fpage>1151</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1055/s-2004-813215</pub-id> .<?supplied-pmid 15346291?><pub-id pub-id-type="pmid">15346291</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref006">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Hanson</surname><given-names>LG</given-names></name>. <article-title>A graphical simulator for teaching basic and advanced MR imaging techniques</article-title>. <source>Radiographics</source>. <year>2007</year>;<volume>27</volume>(<issue>6</issue>):<fpage>e27</fpage> Epub 2007/09/11. <pub-id pub-id-type="doi">10.1148/radiographics.27.6.e27</pub-id> .<?supplied-pmid 17827344?><pub-id pub-id-type="pmid">17827344</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref007">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Rundle</surname><given-names>D</given-names></name>, <name><surname>Kishore</surname><given-names>S</given-names></name>, <name><surname>Seshadri</surname><given-names>S</given-names></name>, <name><surname>Wehrli</surname><given-names>F</given-names></name>. <article-title>Magnetic resonance imaging simulator: a teaching tool for radiology</article-title>. <source>J Digit Imaging</source>. <year>1990</year>;<volume>3</volume>(<issue>4</issue>):<fpage>226</fpage>–<lpage>9</lpage>. .<?supplied-pmid 2085559?><pub-id pub-id-type="pmid">2085559</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref008">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Benoit-Cattin</surname><given-names>H</given-names></name>, <name><surname>Collewet</surname><given-names>G</given-names></name>, <name><surname>Belaroussi</surname><given-names>B</given-names></name>, <name><surname>Saint-Jalmes</surname><given-names>H</given-names></name>, <name><surname>Odet</surname><given-names>C</given-names></name>. <article-title>The SIMRI project: a versatile and interactive MRI simulator</article-title>. <source>Journal of magnetic resonance (San Diego, Calif: 1997)</source>. <year>2005</year>;<volume>173</volume>(<issue>1</issue>):<fpage>97</fpage>–<lpage>115</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmr.2004.09.027</pub-id> .<?supplied-pmid 15705518?><pub-id pub-id-type="pmid">15705518</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref009">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Stocker</surname><given-names>T</given-names></name>, <name><surname>Vahedipour</surname><given-names>K</given-names></name>, <name><surname>Pflugfelder</surname><given-names>D</given-names></name>, <name><surname>Shah</surname><given-names>NJ</given-names></name>. <article-title>High-performance computing MRI simulations</article-title>. <source>Magn Reson Med</source>. <year>2010</year>;<volume>64</volume>(<issue>1</issue>):<fpage>186</fpage>–<lpage>93</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.22406</pub-id> .<?supplied-pmid 20577987?><pub-id pub-id-type="pmid">20577987</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref010">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Kose</surname><given-names>R</given-names></name>, <name><surname>Kose</surname><given-names>K</given-names></name>. <article-title>BlochSolver: A GPU-optimized fast 3D MRI simulator for experimentally compatible pulse sequences</article-title>. <source>Journal of magnetic resonance (San Diego, Calif: 1997)</source>. <year>2017</year>;<volume>281</volume>:<fpage>51</fpage>–<lpage>65</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmr.2017.05.007</pub-id> .<?supplied-pmid 28550818?><pub-id pub-id-type="pmid">28550818</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref011">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>F</given-names></name>, <name><surname>Velikina</surname><given-names>JV</given-names></name>, <name><surname>Block</surname><given-names>WF</given-names></name>, <name><surname>Kijowski</surname><given-names>R</given-names></name>, <name><surname>Samsonov</surname><given-names>AA</given-names></name>. <article-title>Fast Realistic MRI Simulations Based on Generalized Multi-Pool Exchange Tissue Model</article-title>. <source>IEEE Trans Med Imaging</source>. <year>2017</year>;<volume>36</volume>(<issue>2</issue>):<fpage>527</fpage>–<lpage>37</lpage>. <pub-id pub-id-type="doi">10.1109/TMI.2016.2620961</pub-id><?supplied-pmid 28113746?><pub-id pub-id-type="pmid">28113746</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref012">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Xanthis</surname><given-names>CG</given-names></name>, <name><surname>Venetis</surname><given-names>IE</given-names></name>, <name><surname>Aletras</surname><given-names>AH</given-names></name>. <article-title>High performance MRI simulations of motion on multi-GPU systems</article-title>. <source>Journal of cardiovascular magnetic resonance: official journal of the Society for Cardiovascular Magnetic Resonance</source>. <year>2014</year>;<volume>16</volume>:<fpage>48</fpage><pub-id pub-id-type="doi">10.1186/1532-429X-16-48</pub-id><?supplied-pmid 24996972?><pub-id pub-id-type="pmid">24996972</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref013">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Xanthis</surname><given-names>CG</given-names></name>, <name><surname>Venetis</surname><given-names>IE</given-names></name>, <name><surname>Chalkias</surname><given-names>AV</given-names></name>, <name><surname>Aletras</surname><given-names>AH</given-names></name>. <source>MRISIMUL: A GPU-based Parallel Approach to MRI Simulations IEEE Transactions on Medical Imaging</source>. <year>2014</year>;<volume>3</volume>:<fpage>607</fpage>–<lpage>17</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0216594.ref014">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>D</given-names></name>, <name><surname>Gulani</surname><given-names>V</given-names></name>, <name><surname>Seiberlich</surname><given-names>N</given-names></name>, <name><surname>Liu</surname><given-names>K</given-names></name>, <name><surname>Sunshine</surname><given-names>JL</given-names></name>, <name><surname>Duerk</surname><given-names>JL</given-names></name>, <etal>et al</etal><article-title>Magnetic resonance fingerprinting</article-title>. <source>Nature</source>. <year>2013</year>;<volume>495</volume>(<issue>7440</issue>):<fpage>187</fpage>–<lpage>92</lpage>. <pub-id pub-id-type="doi">10.1038/nature11971</pub-id><?supplied-pmid 23486058?><pub-id pub-id-type="pmid">23486058</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref015">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Xanthis</surname><given-names>CG</given-names></name>, <name><surname>Bidhult</surname><given-names>S</given-names></name>, <name><surname>Kantasis</surname><given-names>G</given-names></name>, <name><surname>Heiberg</surname><given-names>E</given-names></name>, <name><surname>Arheden</surname><given-names>H</given-names></name>, <name><surname>Aletras</surname><given-names>AH</given-names></name>. <article-title>Parallel simulations for QUAntifying RElaxation magnetic resonance constants (SQUAREMR): an example towards accurate MOLLI T1 measurements</article-title>. <source>Journal of cardiovascular magnetic resonance: official journal of the Society for Cardiovascular Magnetic Resonance</source>. <year>2015</year>;<volume>17</volume>:<fpage>104</fpage><pub-id pub-id-type="doi">10.1186/s12968-015-0206-1</pub-id><?supplied-pmid 26610703?><pub-id pub-id-type="pmid">26610703</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref016">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Kantasis</surname><given-names>G</given-names></name>, <name><surname>Xanthis</surname><given-names>CG</given-names></name>, <name><surname>Haris</surname><given-names>K</given-names></name>, <name><surname>Heiberg</surname><given-names>E</given-names></name>, <name><surname>Aletras</surname><given-names>AH</given-names></name>. <article-title>Cloud GPU-based simulations for SQUAREMR</article-title>. <source>Journal of magnetic resonance (San Diego, Calif: 1997)</source>. <year>2017</year>;<volume>274</volume>:<fpage>80</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1016/j.jmr.2016.11.007</pub-id> .<?supplied-pmid 27889652?><pub-id pub-id-type="pmid">27889652</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref017">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Fortin</surname><given-names>A</given-names></name>, <name><surname>Salmon</surname><given-names>S</given-names></name>, <name><surname>Baruthio</surname><given-names>J</given-names></name>, <name><surname>Delbany</surname><given-names>M</given-names></name>, <name><surname>Durand</surname><given-names>E</given-names></name>. <article-title>Flow MRI simulation in complex 3D geometries: Application to the cerebral venous network</article-title>. <source>Magn Reson Med</source>. <year>2018</year><pub-id pub-id-type="doi">10.1002/mrm.27114</pub-id> .<?supplied-pmid 29405357?><pub-id pub-id-type="pmid">29405357</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref018">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Yin</surname><given-names>FF</given-names></name>, <name><surname>Rhee</surname><given-names>D</given-names></name>, <name><surname>Cai</surname><given-names>J</given-names></name>. <article-title>Accuracy of respiratory motion measurement of 4D-MRI: A comparison between cine and sequential acquisition</article-title>. <source>Med Phys</source>. <year>2016</year>;<volume>43</volume>(<issue>1</issue>):<fpage>179</fpage><pub-id pub-id-type="doi">10.1118/1.4938066</pub-id><?supplied-pmid 26745910?><pub-id pub-id-type="pmid">26745910</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref019">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Hansen</surname><given-names>MS</given-names></name>, <name><surname>Sorensen</surname><given-names>TS</given-names></name>. <article-title>Gadgetron: an open source framework for medical image reconstruction</article-title>. <source>Magn Reson Med</source>. <year>2013</year>;<volume>69</volume>(<issue>6</issue>):<fpage>1768</fpage>–<lpage>76</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.24389</pub-id> .<?supplied-pmid 22791598?><pub-id pub-id-type="pmid">22791598</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref020">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Henkelman</surname><given-names>RM</given-names></name>, <name><surname>Huang</surname><given-names>X</given-names></name>, <name><surname>Xiang</surname><given-names>QS</given-names></name>, <name><surname>Stanisz</surname><given-names>GJ</given-names></name>, <name><surname>Swanson</surname><given-names>SD</given-names></name>, <name><surname>Bronskill</surname><given-names>MJ</given-names></name>. <article-title>Quantitative interpretation of magnetization transfer</article-title>. <source>Magn Reson Med</source>. <year>1993</year>;<volume>29</volume>(<issue>6</issue>):<fpage>759</fpage>–<lpage>66</lpage>. .<?supplied-pmid 8350718?><pub-id pub-id-type="pmid">8350718</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref021">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Layton</surname><given-names>KJ</given-names></name>, <name><surname>Kroboth</surname><given-names>S</given-names></name>, <name><surname>Jia</surname><given-names>F</given-names></name>, <name><surname>Littin</surname><given-names>S</given-names></name>, <name><surname>Yu</surname><given-names>H</given-names></name>, <name><surname>Leupold</surname><given-names>J</given-names></name>, <etal>et al</etal><article-title>Pulseq: A rapid and hardware-independent pulse sequence prototyping framework</article-title>. <source>Magn Reson Med</source>. <year>2017</year>;<volume>77</volume>(<issue>4</issue>):<fpage>1544</fpage>–<lpage>52</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.26235</pub-id> .<?supplied-pmid 27271292?><pub-id pub-id-type="pmid">27271292</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref022">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Inati</surname><given-names>SJ</given-names></name>, <name><surname>Naegele</surname><given-names>JD</given-names></name>, <name><surname>Zwart</surname><given-names>NR</given-names></name>, <name><surname>Roopchansingh</surname><given-names>V</given-names></name>, <name><surname>Lizak</surname><given-names>MJ</given-names></name>, <name><surname>Hansen</surname><given-names>DC</given-names></name>, <etal>et al</etal><article-title>ISMRM Raw data format: A proposed standard for MRI raw datasets</article-title>. <source>Magn Reson Med</source>. <year>2017</year>;<volume>77</volume>(<issue>1</issue>):<fpage>411</fpage>–<lpage>21</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.26089</pub-id><?supplied-pmid 26822475?><pub-id pub-id-type="pmid">26822475</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref023">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Aubert-Broche</surname><given-names>B</given-names></name>, <name><surname>Griffin</surname><given-names>M</given-names></name>, <name><surname>Pike</surname><given-names>GB</given-names></name>, <name><surname>Evans</surname><given-names>AC</given-names></name>, <name><surname>Collins</surname><given-names>DL</given-names></name>. <article-title>Twenty new digital brain phantoms for creation of validation image data bases</article-title>. <source>IEEE Trans Med Imaging</source>. <year>2006</year>;<volume>25</volume>(<issue>11</issue>):<fpage>1410</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1109/TMI.2006.883453</pub-id> .<?supplied-pmid 17117770?><pub-id pub-id-type="pmid">17117770</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref024">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Collins</surname><given-names>DL</given-names></name>, <name><surname>Zijdenbos</surname><given-names>AP</given-names></name>, <name><surname>Kollokian</surname><given-names>V</given-names></name>, <name><surname>Sled</surname><given-names>JG</given-names></name>, <name><surname>Kabani</surname><given-names>NJ</given-names></name>, <name><surname>Holmes</surname><given-names>CJ</given-names></name>, <etal>et al</etal><article-title>Design and construction of a realistic digital brain phantom</article-title>. <source>IEEE Trans Med Imaging</source>. <year>1998</year>;<volume>17</volume>(<issue>3</issue>):<fpage>463</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1109/42.712135</pub-id> .<?supplied-pmid 9735909?><pub-id pub-id-type="pmid">9735909</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref025">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Messroghli</surname><given-names>DR</given-names></name>, <name><surname>Radjenovic</surname><given-names>A</given-names></name>, <name><surname>Kozerke</surname><given-names>S</given-names></name>, <name><surname>Higgins</surname><given-names>DM</given-names></name>, <name><surname>Sivananthan</surname><given-names>MU</given-names></name>, <name><surname>Ridgway</surname><given-names>JP</given-names></name>. <article-title>Modified Look-Locker inversion recovery (MOLLI) for high-resolution T1 mapping of the heart</article-title>. <source>Magn Reson Med</source>. <year>2004</year>;<volume>52</volume>(<issue>1</issue>):<fpage>141</fpage>–<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.20110</pub-id> .<?supplied-pmid 15236377?><pub-id pub-id-type="pmid">15236377</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref026">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Roujol</surname><given-names>S</given-names></name>, <name><surname>Weingartner</surname><given-names>S</given-names></name>, <name><surname>Foppa</surname><given-names>M</given-names></name>, <name><surname>Chow</surname><given-names>K</given-names></name>, <name><surname>Kawaji</surname><given-names>K</given-names></name>, <name><surname>Ngo</surname><given-names>LH</given-names></name>, <etal>et al</etal><article-title>Accuracy, precision, and reproducibility of four T1 mapping sequences: a head-to-head comparison of MOLLI, ShMOLLI, SASHA, and SAPPHIRE</article-title>. <source>Radiology</source>. <year>2014</year>;<volume>272</volume>(<issue>3</issue>):<fpage>683</fpage>–<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1148/radiol.14140296</pub-id> .<?supplied-pmid 24702727?><pub-id pub-id-type="pmid">24702727</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref027">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>Verhaert</surname><given-names>D</given-names></name>, <name><surname>Thavendiranathan</surname><given-names>P</given-names></name>, <name><surname>Giri</surname><given-names>S</given-names></name>, <name><surname>Mihai</surname><given-names>G</given-names></name>, <name><surname>Rajagopalan</surname><given-names>S</given-names></name>, <name><surname>Simonetti</surname><given-names>OP</given-names></name>, <etal>et al</etal><article-title>Direct T2 quantification of myocardial edema in acute ischemic injury</article-title>. <source>JACC Cardiovascular imaging</source>. <year>2011</year>;<volume>4</volume>(<issue>3</issue>):<fpage>269</fpage>–<lpage>78</lpage>. <pub-id pub-id-type="doi">10.1016/j.jcmg.2010.09.023</pub-id> .<?supplied-pmid 21414575?><pub-id pub-id-type="pmid">21414575</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref028">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Kellman</surname><given-names>P</given-names></name>, <name><surname>Hansen</surname><given-names>MS</given-names></name>. <article-title>T1-mapping in the heart: accuracy and precision</article-title>. <source>Journal of cardiovascular magnetic resonance: official journal of the Society for Cardiovascular Magnetic Resonance</source>. <year>2014</year>;<volume>16</volume>:<fpage>2</fpage><pub-id pub-id-type="doi">10.1186/1532-429X-16-2</pub-id><?supplied-pmid 24387626?><pub-id pub-id-type="pmid">24387626</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref029">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Kellman</surname><given-names>P</given-names></name>, <name><surname>Wilson</surname><given-names>JR</given-names></name>, <name><surname>Xue</surname><given-names>H</given-names></name>, <name><surname>Ugander</surname><given-names>M</given-names></name>, <name><surname>Arai</surname><given-names>AE</given-names></name>. <article-title>Extracellular volume fraction mapping in the myocardium, part 1: evaluation of an automated method</article-title>. <source>Journal of cardiovascular magnetic resonance: official journal of the Society for Cardiovascular Magnetic Resonance</source>. <year>2012</year>;<volume>14</volume>:<fpage>63</fpage><pub-id pub-id-type="doi">10.1186/1532-429X-14-63</pub-id><?supplied-pmid 22963517?><pub-id pub-id-type="pmid">22963517</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref030">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>McConnell</surname><given-names>HM</given-names></name>. <article-title>Reaction Rates by Nuclear Magnetic Resonance</article-title>. <source>The Journal of chemical physics</source>. <year>1958</year>;<volume>28</volume>(<issue>3</issue>):<fpage>430</fpage>–<lpage>1</lpage>. <pub-id pub-id-type="doi">10.1063/1.1744152</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref031">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Xanthis</surname><given-names>CG</given-names></name>, <name><surname>Bidhult</surname><given-names>S</given-names></name>, <name><surname>Greiser</surname><given-names>A</given-names></name>, <name><surname>Chow</surname><given-names>K</given-names></name>, <name><surname>Thompson</surname><given-names>RB</given-names></name>, <name><surname>Arheden</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>Simulation-based quantification of native T1 and T2 of the myocardium using a modified MOLLI scheme and the importance of Magnetization Transfer</article-title>. <source>Magn Reson Imaging</source>. <year>2018</year>;<volume>48</volume>:<fpage>96</fpage>–<lpage>106</lpage>. <pub-id pub-id-type="doi">10.1016/j.mri.2017.12.020</pub-id> .<?supplied-pmid 29288037?><pub-id pub-id-type="pmid">29288037</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref032">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Kawel</surname><given-names>N</given-names></name>, <name><surname>Turkbey</surname><given-names>EB</given-names></name>, <name><surname>Carr</surname><given-names>JJ</given-names></name>, <name><surname>Eng</surname><given-names>J</given-names></name>, <name><surname>Gomes</surname><given-names>AS</given-names></name>, <name><surname>Hundley</surname><given-names>WG</given-names></name>, <etal>et al</etal><article-title>Normal left ventricular myocardial thickness for middle-aged and older subjects with steady-state free precession cardiac magnetic resonance: the multi-ethnic study of atherosclerosis</article-title>. <source>Circulation Cardiovascular imaging</source>. <year>2012</year>;<volume>5</volume>(<issue>4</issue>):<fpage>500</fpage>–<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1161/CIRCIMAGING.112.973560</pub-id><?supplied-pmid 22705587?><pub-id pub-id-type="pmid">22705587</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref033">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>Narayanan</surname><given-names>K</given-names></name>, <name><surname>Reinier</surname><given-names>K</given-names></name>, <name><surname>Teodorescu</surname><given-names>C</given-names></name>, <name><surname>Uy-Evanado</surname><given-names>A</given-names></name>, <name><surname>Aleong</surname><given-names>R</given-names></name>, <name><surname>Chugh</surname><given-names>H</given-names></name>, <etal>et al</etal><article-title>Left ventricular diameter and risk stratification for sudden cardiac death</article-title>. <source>Journal of the American Heart Association</source>. <year>2014</year>;<volume>3</volume>(<issue>5</issue>):<fpage>e001193</fpage><pub-id pub-id-type="doi">10.1161/JAHA.114.001193</pub-id><?supplied-pmid 25227407?><pub-id pub-id-type="pmid">25227407</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref034">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Kellman</surname><given-names>P</given-names></name>, <name><surname>Herzka</surname><given-names>DA</given-names></name>, <name><surname>Arai</surname><given-names>AE</given-names></name>, <name><surname>Hansen</surname><given-names>MS</given-names></name>. <article-title>Influence of Off-resonance in myocardial T1-mapping using SSFP based MOLLI method</article-title>. <source>Journal of cardiovascular magnetic resonance: official journal of the Society for Cardiovascular Magnetic Resonance</source>. <year>2013</year>;<volume>15</volume>:<fpage>63</fpage><pub-id pub-id-type="doi">10.1186/1532-429X-15-63</pub-id><?supplied-pmid 23875774?><pub-id pub-id-type="pmid">23875774</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref035">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Chow</surname><given-names>K</given-names></name>, <name><surname>Flewitt</surname><given-names>JA</given-names></name>, <name><surname>Green</surname><given-names>JD</given-names></name>, <name><surname>Pagano</surname><given-names>JJ</given-names></name>, <name><surname>Friedrich</surname><given-names>MG</given-names></name>, <name><surname>Thompson</surname><given-names>RB</given-names></name>. <article-title>Saturation recovery single-shot acquisition (SASHA) for myocardial T(1) mapping</article-title>. <source>Magn Reson Med</source>. <year>2014</year>;<volume>71</volume>(<issue>6</issue>):<fpage>2082</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1002/mrm.24878</pub-id> .<?supplied-pmid 23881866?><pub-id pub-id-type="pmid">23881866</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref036">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>Giri</surname><given-names>S</given-names></name>, <name><surname>Chung</surname><given-names>YC</given-names></name>, <name><surname>Merchant</surname><given-names>A</given-names></name>, <name><surname>Mihai</surname><given-names>G</given-names></name>, <name><surname>Rajagopalan</surname><given-names>S</given-names></name>, <name><surname>Raman</surname><given-names>SV</given-names></name>, <etal>et al</etal><article-title>T2 quantification for improved detection of myocardial edema</article-title>. <source>Journal of cardiovascular magnetic resonance: official journal of the Society for Cardiovascular Magnetic Resonance</source>. <year>2009</year>;<volume>11</volume>:<fpage>56</fpage><pub-id pub-id-type="doi">10.1186/1532-429X-11-56</pub-id><?supplied-pmid 20042111?><pub-id pub-id-type="pmid">20042111</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref037">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Kwan</surname><given-names>RK</given-names></name>, <name><surname>Evans</surname><given-names>AC</given-names></name>, <name><surname>Pike</surname><given-names>GB</given-names></name>. <article-title>MRI simulation-based evaluation of image-processing and classification methods</article-title>. <source>IEEE Trans Med Imaging</source>. <year>1999</year>;<volume>18</volume>(<issue>11</issue>):<fpage>1085</fpage>–<lpage>97</lpage>. <pub-id pub-id-type="doi">10.1109/42.816072</pub-id> .<?supplied-pmid 10661326?><pub-id pub-id-type="pmid">10661326</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0216594.ref038">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Shkarin</surname><given-names>P</given-names></name>, <name><surname>Spencer</surname><given-names>R</given-names></name>. <article-title>Time domain simulation of fourier imaging by summation of isochromats</article-title>. <source>International Journal of Imaging Systems and Technology</source>. <year>1998</year>;<volume>8</volume>(<issue>5</issue>):<fpage>419</fpage>–<lpage>26</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
