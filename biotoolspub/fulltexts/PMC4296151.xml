<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4296151</article-id>
    <article-id pub-id-type="pmid">25143291</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu555</article-id>
    <article-id pub-id-type="publisher-id">btu555</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Poretools: a toolkit for analyzing nanopore sequence data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Loman</surname>
          <given-names>Nicholas J.</given-names>
        </name>
        <xref ref-type="aff" rid="btu555-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btu555-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Quinlan</surname>
          <given-names>Aaron R.</given-names>
        </name>
        <xref ref-type="aff" rid="btu555-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btu555-COR1">*</xref>
      </contrib>
      <aff id="btu555-AFF1"><sup>1</sup>Institute of Microbiology and Infection, University of Birmingham, Birmingham B15 2TT, UK and <sup>2</sup>Department of Public Health Sciences, University of Virginia, Charlottesville 22932, VA, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu555-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Inanc Birol</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>12</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>8</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>23</issue>
    <fpage>3399</fpage>
    <lpage>3401</lpage>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>7</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>7</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>8</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<uri xlink:type="simple" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</uri>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Nanopore sequencing may be the next disruptive technology in genomics, owing to its ability to detect single DNA molecules without prior amplification, lack of reliance on expensive optical components, and the ability to sequence long fragments. The MinION™ from Oxford Nanopore Technologies (ONT) is the first nanopore sequencer to be commercialized and is now available to early-access users. The MinION™ is a USB-connected, portable nanopore sequencer that permits real-time analysis of streaming event data. Currently, the research community lacks a standardized toolkit for the analysis of nanopore datasets.</p>
      <p><bold>Results:</bold> We introduce <monospace>poretools</monospace>, a flexible toolkit for exploring datasets generated by nanopore sequencing devices from MinION™ for the purposes of quality control and downstream analysis. <monospace>Poretools</monospace> operates directly on the native FAST5 (an application of the HDF5 standard) file format produced by ONT and provides a wealth of format conversion utilities and data exploration and visualization tools.</p>
      <p><bold>Availability and implementation:</bold> Poretools is an open-source software and is written in Python as both a suite of command line utilities and a Python application programming interface. Source code is freely available in Github at <ext-link ext-link-type="uri" xlink:href="https://www.github.com/arq5x/poretools">https://www.github.com/arq5x/poretools</ext-link></p>
      <p><bold>Contact:</bold><email>n.j.loman@bham.ac.uk</email> and <email>aaronquinlan@gmail.com</email></p>
      <p><bold>Supplementary information:</bold> An IPython notebook demonstrating the functionality of <monospace>poretools</monospace> is in Github. Complete documentation is available at <ext-link ext-link-type="uri" xlink:href="http://poretools.readthedocs.org">http://poretools.readthedocs.org</ext-link>.</p>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>DNA sequencing with biological nanopores was proposed almost 20 years ago (<xref rid="btu555-B1" ref-type="bibr">Church <italic>et al.</italic>, 1995</xref>). This approach relies on the direct electrical detection of single DNA strands in contact with an individual pore. Single molecule detection and the absence of a prior amplification step means that extremely long fragments can be sequenced without any loss in quality. In May 2014, Oxford Nanopore Technologies released MinION™, the first commercially available nanopore DNA sequencing device. MinION™ is noteworthy for its portability, size (around the same length as an iPhone™) and USB 3.0 connectivity, meaning it can be run on a standard Internet-connected laptop. Research groups throughout the world are actively evaluating this device for a broad range of applications. Sequencing with the MinION yields raw signals reflecting modulation of the ionic current at each pore by a DNA molecule. The resulting time-series of nanopore translocation, ‘events’, are base-called by proprietary software running as a cloud service. The resulting files for each sequenced read are stored in ‘FAST5’ format, an application of the HDF5 format. However, at present, no specific software is available to facilitate downstream analyses starting with this file format.</p>
  </sec>
  <sec>
    <title>2 FEATURES AND METHODS</title>
    <p>We have developed <monospace>poretools</monospace>, an open-source software toolkit that addresses the pressing need for methods to manipulate the FAST5 format and permit explorations of the raw nanopore event data and the resulting DNA sequences. <monospace>Poretools</monospace> provides an extensive set of data analysis methods that operate directly on either a single FAST5 file or a set of files from one or more sequencing runs. A Python programming library is provided to facilitate access to the FAST5 file structure and enable other researchers to extend the tools and create new analytical methods. In the following sections, we summarize the functionality currently available in <monospace>poretools</monospace>.</p>
    <sec id="SEC2.1">
      <title>2.1 Format conversion</title>
      <p>The most fundamental functionality provided by <monospace>poretools</monospace> is the ability to convert the output data resulting from a MinION run from HDF5/FAST5 format to either FASTA or FASTQ format to facilitate analyses with sequence alignment and/or assembly software. This is accomplished with the <monospace>fasta</monospace> and <monospace>fastq</monospace> commands in the <monospace>poretools</monospace> suite.
<list list-type="simple"><list-item><p><monospace>poretools </monospace><monospace><bold>fasta</bold></monospace><monospace>/</monospace><monospace>path/to/fast5/example.fast5</monospace></p></list-item><list-item><p><monospace>poretools </monospace><monospace><bold>fastq</bold></monospace><monospace>/</monospace><monospace>path/to/fast5/example.fast5</monospace></p></list-item></list>
</p>
      <p>At the time of writing, each MinION run generates individual HDF5/FAST5 files for each sequenced read. Consequently, there are often tens of thousands of individual files that must be stored for a single experiment. <monospace>Poretools</monospace> provides two different strategies for facilitating the analysis of such datasets. The first approach allows one to execute a <monospace>poretools</monospace> command on an entire directory of FAST5 files.
<list list-type="simple"><list-item><p><monospace>poretools </monospace><monospace><bold>fastq</bold></monospace><monospace>/</monospace><monospace>path/to/fast5/directory/</monospace></p></list-item></list>
</p>
      <p>Alternatively, we provide a utility to <monospace>combine</monospace> a set of HDF5/FAST5 files into a single TAR file. This allows an entire run to be archived into one file and once combined, all other <monospace>poretools</monospace> commands are able to operate on each HDF5/FAST5 file therein. For example:
<list list-type="simple"><list-item><p><monospace>poretools combine -o run.tar</monospace><monospace>/</monospace><monospace>path/to/fast5/directory/poretools </monospace><monospace><bold>fastq</bold></monospace><monospace> run.tar</monospace></p></list-item></list>
</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Data exploration and visualization</title>
      <p>There is a need to visualize MinION™ run performance to assess its quality and troubleshoot different fragmentation and library preparation strategies. <monospace>Poretools</monospace> provides two utilties, <monospace>hist</monospace> and <monospace>yield_plot</monospace>, that characterize the fragment size distribution and display a collector’s curve of the overall sequencing yield, respectively. Example commands are provided here, with corresponding figures shown (<xref ref-type="fig" rid="btu555-F1">Fig. 1</xref>A and B).
<list list-type="simple"><list-item><p><monospace>poretools </monospace><monospace><bold>hist</bold></monospace><monospace>/</monospace><monospace>path/to/fast5/directory/</monospace></p></list-item><list-item><p><monospace>poretools </monospace><monospace><bold>yield_plot</bold></monospace><monospace>/</monospace><monospace>path/to/fast5/directory/</monospace></p></list-item></list>
As summarized in <xref ref-type="table" rid="btu555-T1">Table 1</xref>, <monospace>poretools</monospace> also provides several utilities for extracting the low-level details that led to each base called sequence (see <xref ref-type="table" rid="btu555-T1">Table 1</xref> for details). In particular, the <monospace>events</monospace> utility reports the mean current observed for each nanopore translocation event, as well as the time (in milliseconds) of each event and the k-mer that was predicted to have occupied the nanopore during the event. The <monospace>squiggle</monospace> utility permits visualization of this information (<xref ref-type="fig" rid="btu555-F1">Fig. 1</xref>C). The Oxford Nanopore base-calling software uses a Hidden Markov Model to predict a fragment’s sequence based on this event data. We anticipate that the <monospace>events</monospace> utility (and others) will help developers explore improved base-calling strategies.
<fig id="btu555-F1" position="float"><label>Fig. 1.</label><caption><p>Example <monospace>poretools</monospace> visualizations from a set of FAST5 files generated by a single MinION™ run. Panel <bold>A</bold> shows a histogram of read lengths. Panel <bold>B</bold> shows a collector’s curve of reads over time. Panel <bold>C</bold> shows an example squiggle plot of detected event transitions originating from MinION™</p></caption><graphic xlink:href="btu555f1p"/></fig>
<table-wrap id="btu555-T1" position="float"><label>Table 1.</label><caption><p>Summary of currently supported operations in poretools</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Command</th><th rowspan="1" colspan="1">Description</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1"><monospace>combine</monospace></td><td rowspan="1" colspan="1">Combine a set of FAST5 files in a TAR archive.</td></tr><tr><td rowspan="1" colspan="1"><monospace>events</monospace></td><td rowspan="1" colspan="1">Extract each nanopore event for each read.</td></tr><tr><td rowspan="1" colspan="1"><monospace>fasta</monospace></td><td rowspan="1" colspan="1">Extract FASTA sequences from a set of FAST5 files.</td></tr><tr><td rowspan="1" colspan="1"><monospace>fastq</monospace></td><td rowspan="1" colspan="1">Extract FASTQ sequences from a set of FAST5 files.</td></tr><tr><td rowspan="1" colspan="1"><monospace>hist</monospace></td><td rowspan="1" colspan="1">Plot read size histogram for a set of FAST5 files.</td></tr><tr><td rowspan="1" colspan="1"><monospace>nucdist</monospace></td><td rowspan="1" colspan="1">Measure the nucleotide composition.</td></tr><tr><td rowspan="1" colspan="1"><monospace>qualdist</monospace></td><td rowspan="1" colspan="1">Measure the quality score composition.</td></tr><tr><td rowspan="1" colspan="1"><monospace>readstats</monospace></td><td rowspan="1" colspan="1">Extract signal information for each read over time.</td></tr><tr><td rowspan="1" colspan="1"><monospace>squiggle</monospace></td><td rowspan="1" colspan="1">Plot the observed signals for FAST5 reads.</td></tr><tr><td rowspan="1" colspan="1"><monospace>stats</monospace></td><td rowspan="1" colspan="1">Get read size stats for a set of FAST5 files.</td></tr><tr><td rowspan="1" colspan="1"><monospace>tabular</monospace></td><td rowspan="1" colspan="1">Extract sequence information in TAB delimited format</td></tr><tr><td rowspan="1" colspan="1"><monospace>times</monospace></td><td rowspan="1" colspan="1">Return the start times from a set of FAST5 files.</td></tr><tr><td rowspan="1" colspan="1"><monospace>winner</monospace></td><td rowspan="1" colspan="1">Extract the longest read from a set of FAST5 files.</td></tr><tr><td rowspan="1" colspan="1"><monospace>yield</monospace><monospace>_plot</monospace></td><td rowspan="1" colspan="1">Plot the sequencing yield over time.</td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Python library for data analysis</title>
      <p>The utilities provided in the <monospace>poretools</monospace> suite will inevitably prove to be insufficient for every analysis that a researcher wishes to conduct. Recognizing this, we have developed a Python programming interface that researchers can use to directly access the sequence data, the raw nanopore event data and other metadata (e.g. the flowcell and run identifiers) contained in one or more FAST5 files. To demonstrate of the Python interface, the following code reports the start time, the specific nanopore and the based-called sequence for each FAST5 file in a sequencing run.
<list list-type="simple"><list-item><p><bold>from</bold> poretools <bold>import</bold> Fast5FileSet</p></list-item><list-item><p>fast5s = Fast5FileSet(’/path/to/fast5/files/’)</p></list-item><list-item><p><bold>for</bold> fast5 <bold>in</bold> fast5s:</p></list-item><list-item><p> start = fast5.get_start_time()</p></list-item><list-item><p> porenum = fast5.get_channel_number()</p></list-item><list-item><p> fq = fast5.get_fastq()</p></list-item><list-item><p> <bold>print</bold> porenum, start, fq.seq, fq.qual</p></list-item><list-item><p> fast5.close()</p></list-item></list>
</p>
    </sec>
  </sec>
  <sec>
    <title>3 DISCUSSION</title>
    <p>The <monospace>poretools</monospace> software helps solve pressing requirements for analysis of nanopore sequencing data. By focusing on the Python development environment and adopting expected interface conventions as popularized by other popular bioinformatics tools such as <monospace>samtools</monospace> (<xref rid="btu555-B2" ref-type="bibr">Li <italic>et al.</italic>, 2010</xref>) and <monospace>bedtools</monospace> (<xref rid="btu555-B3" ref-type="bibr">Quinlan <italic>et al.</italic>, 2009</xref>), we expect that users will be able to rapidly exploit the functionality offered by this software. We anticipate that other toolkits will become available written in other programming languages. Further efforts are required for downstream analysis for common tasks including alignment and <italic>de novo</italic> assembly of both event and base-called sequence data from this platform.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors would like to express their gratitude to the employees of ONT for assistance during the MinION Access Programme™, with particular thanks to Zoe McDougall, Clive Brown, Daniel Turner, Stephanie Brooking, Roger Pettett and Stuart Reid. We would like to thank members of the MinION user community who have tested <monospace>poretools</monospace> and continue to provide feedback and bug reports.</p>
    <p><italic>Funding</italic>: N.J.L. is funded by a <funding-source>Medical Research Council Special Training Fellowship in Biomedical Informatics</funding-source>. A.R.Q. was supported by the <funding-source>NIH</funding-source> (<funding-source>NGHRI</funding-source>; <award-id>1R01HG006693-01</award-id>).</p>
    <p><italic>Conflict of interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu555-B1">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterization of individual polymer molecules based on monomer-interface interaction</article-title>
        <year>1998</year>
        <comment>US patent no. 5,795,782 (filed March 1995) <ext-link ext-link-type="uri" xlink:href="http://www.google.com/patents/US20120160687">http://www.google.com/patents/US20120160687</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="btu555-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Sequence alignment/map (SAM) format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2049</lpage>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="btu555-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Hall</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>841</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="pmid">20110278</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
