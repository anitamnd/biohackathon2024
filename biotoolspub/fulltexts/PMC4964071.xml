<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4964071</article-id>
    <article-id pub-id-type="publisher-id">1083</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-016-1083-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>flowVS: channel-specific variance stabilization in flow cytometry</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Azad</surname>
          <given-names>Ariful</given-names>
        </name>
        <address>
          <email>azad@lbl.gov</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rajwa</surname>
          <given-names>Bartek</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pothen</surname>
          <given-names>Alex</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Computational Research Division, Lawrence Berkeley National Laboratory, 1 Cyclotron Rd, Berkeley, 94720 CA USA </aff>
      <aff id="Aff2"><label>2</label>Bindley Bioscience Center, Purdue University, West Lafayette, 47907 IN USA </aff>
      <aff id="Aff3"><label>3</label>Department of Computer Science, Purdue University, West Lafayette, 47907 IN USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>7</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>7</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>291</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>8</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>5</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Azad et al. 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Comparing phenotypes of heterogeneous cell populations from multiple biological conditions is at the heart of scientific discovery based on flow cytometry (FC). When the biological signal is measured by the average expression of a biomarker, standard statistical methods require that variance be approximately stabilized in populations to be compared. Since the mean and variance of a cell population are often correlated in fluorescence-based FC measurements, a preprocessing step is needed to stabilize the within-population variances.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a variance-stabilization algorithm, called flowVS, that removes the mean-variance correlations from cell populations identified in each fluorescence channel. flowVS transforms each channel from all samples of a data set by the inverse hyperbolic sine (asinh) transformation. For each channel, the parameters of the transformation are optimally selected by Bartlett’s likelihood-ratio test so that the populations attain homogeneous variances. The optimum parameters are then used to transform the corresponding channels in every sample. flowVS is therefore an explicit variance-stabilization method that stabilizes within-population variances in each channel by evaluating the homoskedasticity of clusters with a likelihood-ratio test.</p>
        <p>With two publicly available datasets, we show that flowVS removes the mean-variance dependence from raw FC data and makes the within-population variance relatively homogeneous. We demonstrate that alternative transformation techniques such as flowTrans, flowScape, logicle, and FCSTrans might not stabilize variance. Besides flow cytometry, flowVS can also be applied to stabilize variance in microarray data. With a publicly available data set we demonstrate that flowVS performs as well as the VSN software, a state-of-the-art approach developed for microarrays.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>The homogeneity of variance in cell populations across FC samples is desirable when extracting features uniformly and comparing cell populations with different levels of marker expressions. The newly developed flowVS algorithm solves the variance-stabilization problem in FC and microarrays by optimally transforming data with the help of Bartlett’s likelihood-ratio test. On two publicly available FC datasets, flowVS stabilizes within-population variances more evenly than the available transformation and normalization techniques. flowVS-based variance stabilization can help in performing comparison and alignment of phenotypically identical cell populations across different samples. flowVS and the datasets used in this paper are publicly available in Bioconductor.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Variance stabilization</kwd>
      <kwd>Flow cytometry</kwd>
      <kwd>Bartlett’s test</kwd>
      <kwd>Microarrays</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000015</institution-id>
            <institution>U.S. Department of Energy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DE-FG02-13ER26135</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution>NSF</institution>
        </funding-source>
        <award-id>CCF-1218916</award-id>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000070</institution-id>
            <institution>National Institute of Biomedical Imaging and Bioengineering</institution>
          </institution-wrap>
        </funding-source>
        <award-id>5R21EB015707</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>We describe an algorithm that transforms a collection of flow cytometry (FC) samples in order to stabilize the variance within cell populations in each fluorescence channel for the entire collection of samples. This transformation enables cell populations (clusters of cells with similar phenotypes) with homogeneous variances to be easily compared with each other by standard statistical methods. Between-population comparisons are important in detecting changes in populations across biological conditions, which might help us to diagnose diseases, develop new drugs, and understand the immune system in general [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. Hence, our variance-stabilization algorithm could play a supporting role in automating biological discovery based on flow cytometry and similar imaging technologies.</p>
    <p>FC technology measures morphology (from light scattering) and the expression of multiple biomarkers (from fluorescence emission of fluorophores attached to antibodies) at the single-cell level. An FC sample consists of hundreds of thousands or more of such single-cell measurements, and a study could consist of thousands of samples from different individuals at different time points under different experimental conditions [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p>Variance inhomogeneity is an inherent problem in fluorescence-based FC measurements and can be an obstacle both for manual data analysis performed by qualified cytometry operators and for automated multi-sample comparisons, which typically rely on an intermediate step of cell clustering using a plethora of approaches from modified k-means to non-parametric Bayesian methodologies [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. The origin of the problem is the physics of fluorescence signal formation and the detection processes that monotonically increase the variance of the fluorescence signal with the average signal intensity [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. For example, Fig. <xref rid="Fig1" ref-type="fig">1</xref> demonstrates how the variances of cell populations increase with their mean fluorescence intensities (MFIs) in a set of FC samples collected from several healthy individuals. Owing to such signal-variance dependence, a cell population with higher levels of marker expressions (i.e., higher fluorescence emission) has higher variance than another population with relatively low levels of marker expressions (i.e., low fluorescence emission). This inhomogeneity of within-population variance creates problems in extracting features uniformly and comparing cell populations with different levels of marker expressions.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Mean fluorescence intensities (MFIs) of one-dimensional cell populations (also called density peaks) are plotted against the variances of the populations. Blood samples were collected from five healthy individuals on different days and stained with labeled antibodies against five biomarkers (see Section <xref rid="Sec11" ref-type="sec">3</xref>). Samples are compensated and gated for the lymphocytes, but no transformation is used. Populations identified in each fluorescence channel are shown with the same symbol and color. We observe that without proper transformation, variance increases monotonically with MFI</p></caption><graphic xlink:href="12859_2016_1083_Fig1_HTML" id="MO1"/></fig></p>
    <p>In order to demonstrate the flowVS results we evaluate the pre- and post-processing cluster homogeneity, and quantify the improvement offered by our approach. We report the results using a simple measure of effect size, rather than through a hypothesis-testing framework. As an example, consider the population registration problem in which corresponding cell clusters from multiple FC samples are identified based on the average levels of markers expressed by the clusters [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR12">12</xref>–<xref ref-type="bibr" rid="CR14">14</xref>]. The clusters of cells representing the same immunophenotype identified in multiple samples are represented by a hypothetical metacluster (a biological generalization of the particular immunophenotype, observed across multiple samples). The existence of metaclusters is typically assessed by hemopathologists or other skilled FC operators on the basis of their experience and knowledge of previous examples of normal and aberrant immunophenotypes. The biological hypothesis behind assigning a cluster to a metacluster can be formulated as “all clusters in a metacluster represent the same cell type (immunophenotype).” However, translating this hypothesis to a null stating “all clusters in a metacluster have equal mean” and using a traditional hypothesis-testing framework accompanied by <italic>p</italic>-values may not be appropriate. First, we know that such a null hypothesis is unrealistic: biological variability, technical variability of blood or bone-marrow sample measurements, and random effects associated with the biochemistry of antibody binding will certainly produce clusters of differing means. Second, a hypothesis-testing framework addresses only the question of whether the clusters have the same location, but it is not designed to measure the magnitude of the difference or lack of homogeneity within a postulated metacluster. Finally, the <italic>p</italic>-values are affected by both cluster size and metacluster homogeneity. Thus, the <italic>p</italic>-values obtained would not be comparable for various metaclusters or different clusters within metaclusters.</p>
    <p>Variance stabilization (VS) is a process for dissociating data variability from mean signals [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. Other fluorescence-based technologies such as the microarrays stabilize variance by data transformation [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref>]. However, unlike microarray data, explicit VS is not usually performed in FC data analysis. Traditionally, FC data are transformed with nonlinear functions to project cell populations with normally distributed clusters – a choice that usually simplifies subsequent visual analysis [<xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR27">27</xref>]. Recently, Finak et al. [<xref ref-type="bibr" rid="CR27">27</xref>] used the maximum-likelihood approach to explicitly satisfy normality of the cell populations. Ray et al. [<xref ref-type="bibr" rid="CR28">28</xref>] transformed each channel with the asinh function whose parameters are optimally selected by the Jarque-Bera test of normality (a goodness-of-fit test of whether sample data have the skewness and kurtosis matching a normal distribution). While these transformations approximately normalize FC data, they might not stabilize variance, as may be seen in Figs. 6 and 7.</p>
    <p>The VS problem in FC, however, cannot be solved directly by applying mature VS techniques from the microarray literature. In microarrays, each gene is measured multiple times (possibly under multiple conditions) and the between-sample variance for each gene is stabilized with respect to the average expression of the gene across samples. By contrast, variance is defined by within-population cell-to-cell variation in FC, and this within-population variance is stabilized with respect to the average expression of markers within each population. These contrasting objectives prevent us from applying VS methods from microarray literature directly to flow cytometry.</p>
    <p>We address the need for explicit VS in FC with a maximum likelihood (ML)-based method, called flowVS, which is built on top of a commonly used inverse hyperbolic sine (asinh) transformation. The choice of asinh function is motivated by its success as a variance stabilizer for microarray data [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. flowVS stabilizes the within-population variances separately for each fluorescence channel <italic>z</italic> across a collection of <italic>N</italic> samples. After transforming <italic>z</italic> by asinh(<italic>z</italic>/<italic>c</italic>), where <italic>c</italic> is a normalization <italic>cofactor</italic>, flowVS identifies one-dimensional clusters (density peaks) in the transformed channel. Assume that a total of <italic>m</italic> 1-D clusters are identified from <italic>N</italic> samples with the <italic>i</italic>-th cluster having variance <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma ^{2}_{i}}$\end{document}</tex-math><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq1.gif"/></alternatives></inline-formula>. Then the asinh(<italic>z</italic>/<italic>c</italic>) transformation works as a variance stabilizer if the variances of the 1-D clusters are approximately equal, i.e., <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma ^{2}_{1}} \sim {\sigma ^{2}_{2}}\sim \ldots \sim {\sigma ^{2}_{m}}$\end{document}</tex-math><mml:math id="M4"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mo>…</mml:mo><mml:mo>∼</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq2.gif"/></alternatives></inline-formula>. To evaluate the homogeneity of variance (also known as homoskedasticity), we use Bartlett’s likelihood-ratio test [<xref ref-type="bibr" rid="CR29">29</xref>]. From a wide range of cofactors, our algorithm selects one that minimizes Bartlett’s test statistic, resulting in a transformation with the best possible VS. Note that, in contrast to other transformation approaches, our algorithm applies the same transformation to corresponding channels in every sample. flowVS is therefore an explicit VS method that stabilizes within-population variances in each channel by evaluating the homoskedasticity of clusters with a likelihood-ratio test.</p>
    <p>Using a healthy-subject data set from Purdue and publicly available immune tolerance network (ITN) data, we demonstrate that flowVS removes the mean-variance dependence from raw FC data and makes the within-population variance relatively homogeneous. We demonstrate that alternative transformation techniques might not stabilize variance. Variance homogeneity is especially useful to build metaclusters from a collection of phenotypically similar cell populations across samples [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>]. Previous studies (Hahne et al. [<xref ref-type="bibr" rid="CR32">32</xref>], for example) shifted the distribution of each fluorescence channel to ensure homogeneity in metaclusters, but such shifting might hide useful biological signals present in the MFIs of cell populations. By contrast, we can build homogeneous metaclusters from variance-stabilized populations without removing the differences in their MFIs. Hence, flowVS could provide additional flexibility in processing and analyzing a large collection of FC samples.</p>
  </sec>
  <sec id="Sec2">
    <title>Related work</title>
    <p>VS has been a widely studied topic in applied statistics for its central role in making heteroskedastic data easily tractable by standard methods. Heteroskedasticity appears in various data sets mostly because the data follow a distribution with correlated mean and variance, e.g., Poisson or Gamma; there are many more examples, but these two are relevant for fluorescence. For well-known distribution families, VS is usually performed by transforming data with an analytically chosen function <italic>f</italic>. For example, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$f(z)=\sqrt {z+3/8}$\end{document}</tex-math><mml:math id="M6"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq3.gif"/></alternatives></inline-formula> works as a good (asymptotic) stabilizer for a random variable <italic>z</italic> following the Poisson distribution [<xref ref-type="bibr" rid="CR33">33</xref>]. Variance stabilizers for several well-known distribution families are described in [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. For unknown distributions, heuristic and data-driven stabilizers are often used [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR17">17</xref>].</p>
    <p>However, traditional transformations are often inadequate for low-count (photon-limited) signals [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR35">35</xref>] because of unknown error patterns in fluorescence data. Past work developed ad hoc VS schemes for different types of fluorescence data. For example, in microarrays, the VS problem has been addressed by various non-linear transformations [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR21">21</xref>]. Most notably, the widely used approach by Huber et al. [<xref ref-type="bibr" rid="CR18">18</xref>] uses an asinh transformation whose parameters are selected by a maximum-likelihood estimation.</p>
    <p>For FC data, researchers have used various non-linear transformations, such as the logarithm, hyperlog, generalized Box-Cox, and biexponential (e.g., logicle and generalized arcsinh) functions [<xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR27">27</xref>]. In past work, parameters of these transformations were adjusted in a data-driven manner to maximize the likelihood (flowTrans by Finak et al. [<xref ref-type="bibr" rid="CR27">27</xref>]), to satisfy the normality (flowScape by Ray et al. [<xref ref-type="bibr" rid="CR28">28</xref>]), and to comply with simulations (FCSTrans by Qian et al. [<xref ref-type="bibr" rid="CR36">36</xref>]). flowTrans estimates transformation parameters for each sample by maximizing the likelihood of data’s being generated by a multivariate-normal distribution on the transformed scale. flowScape optimizes the normalization factor of asinh transformation by the Jarque-Bera test of normality. FCSTrans selects the parameters of the linear, logarithm, and logicle transformations with an extensive set of simulations. However, normalizing data may not necessarily stabilize its variance, e.g., for a Poisson variable <italic>z</italic>, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sqrt {z+3/8}$\end{document}</tex-math><mml:math id="M8"><mml:msqrt><mml:mrow><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq4.gif"/></alternatives></inline-formula> is an approximate variance-stabilizer, whereas <italic>z</italic><sup>2/3</sup> is a normalizer [<xref ref-type="bibr" rid="CR16">16</xref>]. Therefore, we consider an approach built upon the well-known asinh transformation and estimate transformation parameters for explicitly stabilizing within-population variations.</p>
  </sec>
  <sec id="Sec3">
    <title>Methods</title>
    <sec id="Sec4">
      <title>Motivation</title>
      <p>Consider two representative samples from the ITN data set taken from the flowStats package in Bioconductor. We gate the samples for lymphocytes, transform using an asinh transformation (with cofactor set to 1), and plot T-cell subpopulations and distribution of CD8 marker in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Across these two samples, T-cell subpopulations have different proportions and MFIs. For example, in Subfig. <xref rid="Fig2" ref-type="fig">2</xref>a and <xref rid="Fig2" ref-type="fig">2</xref>c, CD8<sup>+</sup> T-cell subpopulation is 35.4 % of total T-cells with MFI 5.31. By contrast, CD8<sup>+</sup> T-cell subpopulation is 28.7 % of total T cells with MFI 6.23 in Subfig. <xref rid="Fig2" ref-type="fig">2</xref>b and <xref rid="Fig2" ref-type="fig">2</xref>d. Should we consider the differences between CD8<sup>+</sup> populations in these two samples to be biologically significant? The answer to this question depends on our assumption about the data. If we assume that a cell type either expresses or does not express a biomarker and that the biological information lies only in the proportion of positively and negatively expressed cells, then MFI does not bear meaningful information other than defining positive and negative cells. In this case, we could consider the differences in MFIs across cell populations of the same type as technical variations and eliminate them by aligning cell populations described by Hahne et al. [<xref ref-type="bibr" rid="CR32">32</xref>] and Finak et al. [<xref ref-type="bibr" rid="CR37">37</xref>]. However, past work has shown that both cell proportion and MFI can possess biological information [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. Hence, aligning cell populations to a common MFI might remove meaningful biological signal from data. In the latter case, we want to compare MFIs of cell populations to evaluate whether they are statistically different. A common statistical approach to compare average expressions of cell population is to use a statistical test in an ANOVA model that explicitly requires that variance be approximately stabilized in populations. Hence, VS is necessary to detect statistically meaningful changes across populations from different samples.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Subfigs. (<bold>a</bold>) and (<bold>b</bold>) show the 2D-projections of T-cell subpopulations from two samples in the ITN data set. Distributions of CD8 marker are shown below the corresponding samples in Subfigs. (<bold>c</bold>) and (<bold>d</bold>)</p></caption><graphic xlink:href="12859_2016_1083_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>The goal of VS in flow cytometry</title>
      <p>The aim of VS in FC is to make within-population variances of different cell populations approximately equal and thereby independent of the average marker expressed by populations. Recall that the expression of a marker is measured by the intensity of light at a particular channel of fluorescence. VS therefore stabilizes the within-population fluorescence variance and makes it independent of the MFIs of the cell populations. In this paper, we refer to fluorescence channels more frequently because the nature of fluorescence emissions – not the protein expressions – dominates the mean-variance relationship in FC data. We do not stabilize variance on the scatter channels because, as pointed out by Finak et al. [<xref ref-type="bibr" rid="CR27">27</xref>], there are few benefits to transforming forward- and side-scatter channels.</p>
    </sec>
    <sec id="Sec6">
      <title>Channel-specific variance stabilization</title>
      <p>We assume that correlations among fluorescence channels due to the overlap of spectra are removed by spectral unmixing before we transform data. Even though the expression of biomarkers can still be correlated [<xref ref-type="bibr" rid="CR24">24</xref>], we do not incorporate such correlations in VS because the nature of such correlation is difficult to model. Therefore, we assume that compensated fluorescence channels are independent and stabilize variance on each channel separately.</p>
      <p>Selecting an optimal transformation for FC data is a nontrivial problem because the accurate error model of FC data is often unknown. In previous work, researchers have successfully used a number of functions to transform FC data, such as logarithm, asinh, Box-Cox, logicle, etc. [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. In our flowVS algorithm, we decided to use the asinh function to transform FC data. This choice of asinh function is motivated by its success in FC data visualization and normalization [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>] and in stabilizing variance in fluorescence readouts from microarray data [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]. Stabilizing variance with other transformations can be performed using the same flowVS framework but is not discussed here.</p>
      <p>To transform a fluorescence channel <italic>z</italic>, we use the asinh transformation with a single parameter <italic>c</italic>: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \operatorname{asinh} (z/c) = \ln(z/c + \sqrt{(z/c)^{2} + 1}).   $$ \end{document}</tex-math><mml:math id="M10"><mml:mo>asinh</mml:mo><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>ln</mml:mo><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>c</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2016_1083_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>In this transformation, <italic>c</italic> is called the normalization cofactor, whose value is optimally selected to stabilize within-population variance in channel <italic>z</italic>. Note that in a more general form asinh transformation is expressed with three parameters, <italic>a</italic>∗asinh(<italic>b</italic>+<italic>z</italic>/<italic>c</italic>), where in addition to the cofactor <italic>c</italic>, <italic>a</italic> denotes a scaling after transformation, and <italic>b</italic> denotes a translation before transformation. We set <italic>a</italic>=1 because scaling after transformation does not affect downstream analysis and set <italic>b</italic>=0 to avoid shifting cell populations. Hence, we are left with a single parameter <italic>c</italic> whose value is estimated in order to stabilize the variance.</p>
    </sec>
    <sec id="Sec7">
      <title>The flowVS algorithm</title>
      <p>Assume that we have a collection of <italic>N</italic> FC samples. Then the objective of the flowVS algorithm is to transform each sample such that the within-population variance is stabilized in each fluorescence channel across <italic>N</italic> samples. Here, we describe the algorithm for a single channel <italic>z</italic>; the process can be applied independently to other channels. First, we discuss the process of evaluating homoskedasticity of a transformed channel for a selected cofactor <italic>c</italic> by computing Bartlett’s likelihood-ratio test. Then, we elaborate the process of selecting an optimum cofactor that would stabilize variance when used with asinh transformation.</p>
      <sec id="Sec8">
        <title>Steps to compute Bartlett’s statistic on channel <italic>z</italic> for a selected cofactor <italic>c</italic></title>
        <p>
          <list list-type="bullet">
            <list-item>
              <p><bold>Step1:</bold><italic>Transforming channel z in each sample.</italic> Let <italic>z</italic><sub><italic>j</italic></sub> be a vector denoting channel <italic>z</italic> in the <italic>j</italic>-th sample, where 1≤<italic>j</italic>≤<italic>N</italic>. We transform <italic>z</italic><sub><italic>j</italic></sub> by the asinh function: <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$z^{\prime }_{j} = \operatorname {asinh} (z_{j}/c)$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>asinh</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq5.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$z^{\prime }_{j}$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq6.gif"/></alternatives></inline-formula> is the transformed channel.</p>
            </list-item>
            <list-item>
              <p><bold>Step2:</bold><italic>Detecting 1-D density peaks (1-D clusters)</italic>. We estimate the density of <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$z^{\prime }_{j}$\end{document}</tex-math><mml:math id="M16"><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq7.gif"/></alternatives></inline-formula> by a kernel density estimation method (the density function of stats package in R). The peaks in the density of <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$z^{\prime }_{j}$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq8.gif"/></alternatives></inline-formula> are identified as regions of high local density and significant curvature (also called landmarks in [<xref ref-type="bibr" rid="CR32">32</xref>]). We identify high-density regions in <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$z^{\prime }_{j}$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq9.gif"/></alternatives></inline-formula> by the curv1Filter function of the flowCore package [<xref ref-type="bibr" rid="CR39">39</xref>] in Bioconductor. The boundaries of density peaks are identified by detecting minima between two adjacent density peaks. Here, a density peak represents a 1-D cluster of cells. Let <italic>P</italic><sub><italic>j</italic></sub> be the collection of all density peaks identified in <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$z^{\prime }_{j}$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq10.gif"/></alternatives></inline-formula>.</p>
            </list-item>
            <list-item>
              <p><bold>Step3:</bold><italic>Collecting density peaks from all samples.</italic> Let <italic>P</italic> be the set of density peaks collected from all samples, i.e., <italic>P</italic>=∪<sub>1≤<italic>j</italic>≤<italic>N</italic></sub><italic>P</italic><sub><italic>j</italic></sub>. Let <italic>P</italic> contain a total of <italic>m</italic> density peaks where the <italic>i</italic>-th peak contains <italic>n</italic><sub><italic>i</italic></sub> cells with mean <italic>μ</italic><sub><italic>i</italic></sub> and variance <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma ^{2}_{i}}$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq11.gif"/></alternatives></inline-formula>.</p>
            </list-item>
            <list-item>
              <p><bold>Step4:</bold><italic>Computing Bartlett’s test statistic.</italic> Let <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$n=\sum _{1\leq i \leq m} n_{i}$\end{document}</tex-math><mml:math id="M26"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq12.gif"/></alternatives></inline-formula> be the total number of cells in <italic>P</italic> and <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma ^{2}_{p}}$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq13.gif"/></alternatives></inline-formula> be the pooled variance of <italic>m</italic> density peaks. Then we compute Bartlett’s statistic as follows: 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ B(c) = \frac{(n-m)\: \ln\left({\sigma_{p}^{2}}\right) - \sum_{i=1}^{m} (n_{i}-1)\: \ln\left({\sigma_{i}^{2}}\right)}{1 + \frac{1}{3(m-1)} \left(\sum_{i=1}^{m} \frac{1}{n_{i}-1} - \frac{1}{n-m}\right)}.   $$ \end{document}</tex-math><mml:math id="M30"><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo><mml:mspace width="2.22144pt"/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mspace width="2.22144pt"/><mml:mo>ln</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:munderover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2016_1083_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
              <p>This statistic <italic>B</italic>(<italic>c</italic>) is specific to the cofactor <italic>c</italic> used to transform the data and measures the degree of homogeneity across all 1-D clusters in the transformed channel <italic>z</italic><sup>′</sup>.</p>
            </list-item>
          </list>
        </p>
      </sec>
      <sec id="Sec9">
        <title>Finding a cofactor for optimum VS</title>
        <p>The optimum variance-stabilizing cofactor <italic>c</italic><sup>∗</sup> is a cofactor giving the minimum value of Bartlett’s statistic: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ c^{*} = \arg\!\min B(c).   $$ \end{document}</tex-math><mml:math id="M32"><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:mspace width="0.3em"/><mml:mo>min</mml:mo><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2016_1083_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Minimizing Eq. <xref rid="Equ2" ref-type="">2</xref> is a nontrivial optimization problem because Bartlett’s test statistic <italic>B</italic>(<italic>c</italic>) depends indirectly on the cofactor <italic>c</italic> and is not differentiable with respect to <italic>c</italic>. This prevents us from applying optimization methods from the gradient-descent family. Therefore, we employ a piecewise minimization without derivatives [<xref ref-type="bibr" rid="CR40">40</xref>]. Let <italic>c</italic><sub><italic>low</italic></sub> and <italic>c</italic><sub><italic>high</italic></sub> be the lowest and highest possible values of the cofactor on a logarithmic scale. By default, we set <italic>c</italic><sub><italic>low</italic></sub>=−2 and <italic>c</italic><sub><italic>high</italic></sub>=10, i.e., the lowest and highest values of cofactor is exp(−2)∼0.135 and exp(10)∼22026, respectively. Users can also supply these extreme values. We assume that the optimum cofactor lies in the range [ exp(<italic>c</italic><sub><italic>low</italic></sub>), exp(<italic>c</italic><sub><italic>high</italic></sub>)]. Then the optimization procedure works as follows: 
<list list-type="bullet"><list-item><p>(a) We divide the interval [ <italic>c</italic><sub><italic>low</italic></sub>, <italic>c</italic><sub><italic>high</italic></sub>] into <italic>k</italic>=(<italic>c</italic><sub><italic>high</italic></sub>−<italic>c</italic><sub><italic>low</italic></sub>) equal regions where the <italic>i</italic>-th region is defined by the interval [<italic>c</italic><sub><italic>i</italic></sub>,<italic>c</italic><sub><italic>i</italic>+1</sub>] and <italic>c</italic><sub><italic>i</italic>+1</sub>−<italic>c</italic><sub><italic>i</italic></sub>=1.</p></list-item><list-item><p>(b) For the <italic>i</italic>-th interval, we look for a cofactor in the range [ exp(<italic>c</italic><sub><italic>i</italic></sub>), exp(<italic>c</italic><sub><italic>i</italic>+1</sub>)] with minimum Bartlett’s statistic. For each cofactor, we compute the Bartlett’s statistic with the steps described in Sec. <xref rid="Sec8" ref-type="sec">3</xref>. For faster convergence, we call the optimize function from the stats package in R, which uses a combination of golden section search and successive parabolic interpolation [<xref ref-type="bibr" rid="CR41">41</xref>]. Interested readers might see the R documentation for a detailed description of the function. Let <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$c^{*}_{i}$\end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq14.gif"/></alternatives></inline-formula> be the optimum cofactor in the <italic>i</italic>-th interval with the associated Bartlett’s statistic <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$B(c^{*}_{i})$\end{document}</tex-math><mml:math id="M36"><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq15.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p>(c) We identify the overall optimum cofactor <italic>c</italic><sup>∗</sup> as follows: 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ c^{*} = \arg\!\min_{i=1}^{k} B(c^{*}_{i}).   $$ \end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:mspace width="0.3em"/><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>min</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:mi>B</mml:mi><mml:mo>(</mml:mo><mml:munderover><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:munderover><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2016_1083_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
        <p>Equation <xref rid="Equ4" ref-type="">4</xref> provides an approximate solution to Eq. <xref rid="Equ3" ref-type="">3</xref>. Since we divided the search space into smaller intervals, the probability of having multiple local optima in an interval is small. Hence, the procedure described above is expected to return a variance stabilizing cofactor. After we obtain the optimum cofactor <italic>c</italic><sup>∗</sup>, channel <italic>z</italic> in each sample is transformed by asinh(<italic>z</italic><sub><italic>j</italic></sub>/<italic>c</italic><sup>∗</sup>) and used in subsequent analysis.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="results">
    <title>Results</title>
    <sec id="Sec11">
      <title>Data sets</title>
      <p>We demonstrate the use of flowVS and other related methods by using a healthy-subject data set from Purdue University (HD) and publicly available immune tolerance network (ITN) data. The original HD data set consists of 65 samples from five healthy individuals who donated blood on different days [<xref ref-type="bibr" rid="CR42">42</xref>]. Here, for simplicity, we used a smaller subset of the HD data set consisting of 12 samples from three healthy individuals, “A”, “C”, and “D”. From each individual, we keep samples from two (randomly selected) days and two technical replicates from each day. Each HD sample was stained using labeled antibodies against CD45, CD3, CD4, CD8, and CD19 protein markers. In this paper, an HD sample “C_4_2” means that it is collected on day 4 from individual “C” and it is the second replicate on that day. The healthy data set is part of our Bioconductor package flowVS. The ITN data set is collected from 15 patients. It includes 3 patient groups with 5 samples each. Each sample was stained using labeled antibodies against CD3, CD4, CD8, CD69 and HLADr. The ITN data set is available in the flowStats package in Bioconductor. We selected these data sets because they are available in standard R packages. Hence, the results presented here can be easily reproduced.</p>
      <p>We identify lymphocytes in each sample of the HD and ITN datasets by using a two-step gating shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. In this paper, we perform data transformation only on lymphocytes.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Identifying lymphocytes by a two-step gating from a representative sample in the HD data set. <bold>a</bold> We select an approximate rectangular region in the lower left corner of side-scatter vs. forward-scatter plot. <bold>b</bold> A dense elliptical region within the rectangular gate defines lymphocytes</p></caption><graphic xlink:href="12859_2016_1083_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>Stabilizing variance in the HD dataset</title>
      <p>At first, flowVs identifies an optimum cofactor for asinh transformation for each fluorescence channel of the HD dataset. This process is performed by identifying density peaks in each channel and minimizing Bartlett’s statistic, as described in Section <xref rid="Sec7" ref-type="sec">3</xref>. The top row in Fig. <xref rid="Fig4" ref-type="fig">4</xref> shows Bartlett’s statistic computed from density peaks of all samples after the data are transformed by asinh transformation with different cofactors. The range of values of the cofactor is selected by the automated algorithm described in Section <xref rid="Sec7" ref-type="sec">3</xref>. An optimum variance-stabilizing cofactor is obtained where Bartlett’s statistic is a minimum. From Fig. <xref rid="Fig4" ref-type="fig">4</xref>, the variance-stabilizing cofactors for different markers are: (a) 17,956 for CD45, (b) 5,685 for CD3, (c) 6,317 for CD4, (d) 4,937 for CD8, and (e) 5,976 for CD19. For every channel except CD45, we obtain a clear global minimum, denoting the existence of a unique variance-stabilizing cofactor with respect to Bartlett’s test. For CD45, we observe a sharp decrease in Bartlett’s statistic at cofactor 17,000. Since CD45 is a common leukocyte marker, it is always expressed on lymphocytes – the subset of cells that we preselected for this study. Hence, most cells are CD45+ in our preprocessed samples, which might produce a non-convex relationship between Bartlett’s statistic and cofactors. For the same reason, the value of Bartlett’s statistic at the optimum cofactor for CD45 is the smallest (less than 700) compared to the minimum value of Bartlett’s statistic achieved in other channels. Note that the minimum Bartlett’s statistic denotes the degree to which we are able to stabilize the within-population variance of a channel considering the between-sample variations.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Transforming five fluorescence channels in HD data. Subfigures in the top row show Bartlett’s statistic computed from density peaks after data are transformed by different cofactors. An optimum cofactor is obtained where Bartlett’s statistic reaches the minimum. The bottom row shows the density plots after the data are transformed by an asinh transformation with the optimum cofactors</p></caption><graphic xlink:href="12859_2016_1083_Fig4_HTML" id="MO4"/></fig></p>
      <p>We transform each sample of the HD data set by the asinh function with the variance-stabilizing cofactors and plot the density of the transformed channels in the bottom row of Fig. <xref rid="Fig4" ref-type="fig">4</xref>. In each channel, we observe that density peaks (a.k.a. one-dimensional clusters) have approximately equal width across all samples, which visually confirms the homogeneity of within-population variances in one-dimensional clusters. When both positive and negative peaks (i.e., clusters with high or low marker expression) are present in a channel, e.g., CD3, CD4, and CD8, their variances are also approximately stabilized. Note that the density peaks may not be well aligned owing to the between-subject variations. Aligning density peaks across samples is not an objective of flowVS, because such shifting of density might potentially eclipse biological signals present in the mean expressions of a cell populations. When necessary, data normalization can be performed after variance stabilization, as was done by Hahne et al. [<xref ref-type="bibr" rid="CR32">32</xref>] and Finak et al. [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>Stabilizing variance in the ITN dataset</title>
      <p>We stabilize variance in each channel of the ITN dataset and show the results in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Similar to the HD data set, the top row shows Bartlett’s statistic computed from density peaks of all samples of the ITN data set after each channel is transformed by asinh transformation with different cofactor for each one. From Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the variance stabilizing cofactors for different markers are: (a) 3.66 for CD3, (b) 25.1 for CD4, (c).75 for CD8, and (d) 0.2 for CD69. The curves showing the relationship between Bartlett’s statistic and cofactors might have multiple local minima. Nevertheless, a clear global minimum is obtained for channels in the ITN dataset. We note that the variance-stabilizing cofactors for the HD data set are an order of magnitude greater than those of the ITN data set. For example, the variance-stabilizing cofactor for the CD channel is 6317 in the former data set, whereas for the same channel, variance is stabilized at a cofactor of 25.1 in the latter. The primary contributing factor behind this difference is the maximum range of values in each channel. The maximum value of a fluorescence channel is 10,000 for the ITN data set, and 1,048,575 for the HD data set. Hence, variance is stabilized at higher cofactor values for the channels in the HD data set.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Transforming four fluorescence channels in ITN data. Subfigures in the top row show Bartlett’s statistic computed from density peaks after data are transformed by different cofactors. An optimum cofactor is obtained where Bartlett’s statistic reaches the minimum. The bottom row shows the density plots after the data are transformed by the optimum cofactor</p></caption><graphic xlink:href="12859_2016_1083_Fig5_HTML" id="MO5"/></fig></p>
      <p>After identifying the optimum cofactors for each channel, we transform each sample of the ITN data set by asinh functions with the variance-stabilizing cofactors and plot the density of the transformed channels in the bottom row of Fig. <xref rid="Fig5" ref-type="fig">5</xref>. Similar to the HD data set (Fig. <xref rid="Fig5" ref-type="fig">5</xref>), the density peaks have approximately equal variance across all samples, thus confirming the homogeneity of within-population variances in one-dimensional clusters.</p>
    </sec>
    <sec id="Sec14">
      <title>Comparing flowVS with other transformation methods</title>
      <p>We compare flowVS with three automated methods developed for transforming FC data: (a) flowTrans (b) logicle (flowCore), and (c) FCSTrans. We selected these three methods because they automatically select parameters for different transformations. As discussed earlier, flowTrans estimates the parameters of different transformations (e.g., asinh, biexponential, linlog, and Box-Cox) by maximizing the likelihood of data’s being generated from normal distributions [<xref ref-type="bibr" rid="CR27">27</xref>]. In this paper, we chose the results of flowTrans with asinh transformation because it generated relatively better segregation of populations than the other options and is directly comparable to flowVS that also uses the asinh transformation. We generate our results by calling the flowTrans function of the Bioconductor package flowTrans. Next, we select the logicle transformation implemented in the flowCore package in Bioconductor. To estimate the parameters of logicle transformation, we use the estimateLogicle function of the flowCore package. Finally, FCSTrans also uses the logicle transformation. We obtained the R source code of FCSTrans from <ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/immportflock/files/FCSTrans">http://sourceforge.net/projects/immportflock/files/FCSTrans</ext-link>.</p>
      <p>The top row of Fig. <xref rid="Fig6" ref-type="fig">6</xref> shows the densities of the transformed CD4 channel of the HD data set after the samples are transformed by four methods using their optimum parameters. From visual inspection, we observe that the logicle and FCSTrans stabilize variance of the CD4<sup>+</sup> and CD4<sup>-</sup> populations separately. However, these two methods do not stabilize variances across CD4<sup>+</sup> and CD4<sup>-</sup> populations. flowTrans fails to converge for six samples (all samples from subject D and day 3 samples from subject C) and uses default cofactor=1 for these samples. Hence, the peaks transformed by flowTrans are on different scales, and they are hard to compare against each other. By contrast, flowVS stabilizes variance across all peaks of CD4 channels, including CD4<sup>+</sup> and CD4<sup>-</sup> populations. Furthermore, flowVS selects a single cofactor for a channel across all samples in a data set, whereas flowTrans selects different parameters for different samples. Thus, populations are more comparable after data are transformed by flowVS.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Transforming CD4 channels in HD data by four transformation algorithms. The top row shows the density plots after the data are optimally transformed by different transformations. The bottom row shows the standard deviation of density peaks against the rank of MFI</p></caption><graphic xlink:href="12859_2016_1083_Fig6_HTML" id="MO6"/></fig></p>
      <p>Next, we quantitatively compare the stability of variance across multiple transformation methods. This comparison, however, can not be performed on the actual transformed data because different transformations convert data to different scales. Hence, we convert each transformed channel <italic>z</italic> to [0,1] scale by rescaling each element <italic>z</italic><sub><italic>i</italic></sub> with the following equation (<italic>z</italic><sub><italic>i</italic></sub>− min{<italic>z</italic>})/(max{<italic>z</italic>}− min{<italic>z</italic>}). For each transformation, we identify the density peaks in the converted CD4 channel and plot standard deviations of density peaks against their ranks of MFI in the bottom row of Fig. <xref rid="Fig6" ref-type="fig">6</xref>. Here we use rank of the means, instead of actual means, to distribute the points evenly along the x-axis. We observe that all four transformations are able to eliminate the systematic dependence of variance on mean, which is typically observed in untransformed fluorescence data, such as in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Therefore, these transformations have inherent ability to stabilize variance, mostly owing to the properties of the underlying asinh and logicle transformations. However, flowVS is able to stabilize variance more evenly than other transformations, as can be seen in the bottom right plot in Fig. <xref rid="Fig6" ref-type="fig">6</xref>.</p>
      <p>The comparison of different transformations on the ITN data set is shown in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. As before, the top row shows the densities of the transformed CD4 channel and the bottom row plots the standard deviations of the density peaks. As with the HD data set, flowVS stabilizes variance more evenly than other methods.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Transforming CD4 channels in ITN data by four transformation algorithms. The top row shows the density plots after the data are optimally transformed by different transformations. The bottom row shows the standard deviation of density peaks against the rank of MFI</p></caption><graphic xlink:href="12859_2016_1083_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Normality of the variance-stabilized clusters</title>
      <p>Bartlett’s test assumes that the cell populations are normally distributed and is sensitive to departures from normality. Density peaks (1-D cell populations) in data sets that we have studied approximately follow normal distributions. This normality assumption is typical for many FC data sets as well. Hence, a VS approach based on Bartlett’s test is expected to work well for most FC data sets. For example, in Fig. <xref rid="Fig8" ref-type="fig">8</xref>, we show the normality of cell populations in a representative sample of the HD data set with quantile-quantile plots (Q-Q plots) [<xref ref-type="bibr" rid="CR43">43</xref>] of eight 1-D clusters. In each Q-Q plot, the distribution of a 1-D cluster is compared with the standard normal distribution by plotting their quantiles against each other. If a cluster is normally distributed (i.e., linearly related to the standard normal distribution), the points in the Q-Q plot lie approximately on a straight line. We observe that all eight Q-Q plots in Fig. <xref rid="Fig8" ref-type="fig">8</xref> show linearity in their central parts, except for small deviations at the ends, indicating that the 1-D clusters approximately follow normal distributions with heavier tails. Therefore, flowVS based on Bartlett’s statistic works well for this data.
<fig id="Fig8"><label>Fig. 8</label><caption><p>The Q-Q plots for the eight 1-D clusters obtained from a representative sample in the HD data set. Every Q-Q plot shows linearity in the central part, except for a little deviation at the end, indicating that the clusters approximately follow normal distributions with heavier tails</p></caption><graphic xlink:href="12859_2016_1083_Fig8_HTML" id="MO8"/></fig></p>
      <p>However, if cell populations deviate significantly from normality, we could use other likelihood ratio statistic that is less sensitive to departures from normality, such as Levene’s [<xref ref-type="bibr" rid="CR44">44</xref>] or the Brown-Forsythe statistic [<xref ref-type="bibr" rid="CR45">45</xref>]. In our experiments, we found Bartlett’s approach working significantly better than Levene’s, and therefore, did not show results of the latter method.</p>
    </sec>
    <sec id="Sec16">
      <title>Impact of variance stabilization in comparing cell populations</title>
      <p>We now briefly demonstrate the impact of variance stabilization on the homogeneity of metaclusters (i.e., groups of phenotypically concordant clusters). In metacluster homogeneity evaluation, the underlying assumption is that all clusters in a metacluster represent the same cellular immunophenotype. As mentioned before, the hypothesis-testing framework may not be appropriate for the described problem, since a null hypothesis claiming that all clusters in a metacluster have equal mean is essentially always false. Moreover, when the number of cells (sampling units of the test) increases, the power of a statistical test such as a t-test or an F-test increases too. Consequently, a statistical test would inevitably detect small (i.e., statistically significant, but biologically irrelevant) differences between clusters. For example, performing a t-test with CD4<sup>+</sup> cell clusters from the first and the second samples of the ITN data set, we observe <italic>p</italic>-values less than 10<sup>−10</sup> for all transformations despite the fact that the tested cell populations are biologically identical (in an immunophenotypic sense).</p>
      <p>Therefore, we use an effect size measure rather than <italic>p</italic>-values to illustrate the impact of the proposed algorithm on metacluster homogeneity. We employ the ratio of between-cluster variation (<inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma _{b}^{2}}$\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq16.gif"/></alternatives></inline-formula>) to within-cluster variation (<inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma _{w}^{2}}$\end{document}</tex-math><mml:math id="M42"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq17.gif"/></alternatives></inline-formula>) [<xref ref-type="bibr" rid="CR42">42</xref>]. Consider a set of <italic>k</italic> clusters where the <italic>i</italic>-th cluster containing <italic>n</italic><sub><italic>i</italic></sub> cells has mean <italic>μ</italic><sub><italic>i</italic></sub> and variance <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma ^{2}_{i}}$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq18.gif"/></alternatives></inline-formula>. If <italic>N</italic> is the total number of cells in all clusters and <italic>μ</italic> is the combined mean then the ratio of <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma _{b}^{2}}$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma _{w}^{2}}$\end{document}</tex-math><mml:math id="M48"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq20.gif"/></alternatives></inline-formula> is computed as follows: 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \frac{{\sigma^{2}_{b}}}{{\sigma_{w}^{2}}} = \frac{\frac 1 {N-k} \sum_{i=1}^{k} (n_{i}-1)(\mu_{i} - \mu)^{2}}{\frac{1}{N-k}\sum_{i=1}^{k} {(n_{i}-1)\: {\sigma^{2}_{i}}}}.   $$ \end{document}</tex-math><mml:math id="M50"><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mspace width="2.22144pt"/><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2016_1083_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Unlike the F-test for comparing multiple clusters, the above ratio does not depend on the sample size, and it is constructed so that the increasing homogeneity of a metacluster results in a progressively smaller value of the ratio. Table <xref rid="Tab1" ref-type="table">1</xref> shows the <inline-formula id="IEq21"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {{\sigma ^{2}_{b}}}{{\sigma _{w}^{2}}}$\end{document}</tex-math><mml:math id="M52"><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq21.gif"/></alternatives></inline-formula> values of CD4<sup>+</sup> metacluster and a biologically erroneous metacluster grouping CD4<sup>+</sup> and CD4<sup>-</sup> cells. The values are computed after the data are transformed by four transformations considered in this paper. In this example, the flowVS transformation gives the best homogeneity within the CD4<sup>+</sup> metacluster, and an increased heterogeneity of the CD4<sup>+</sup>/CD4<sup>-</sup> clusters mixture. Thus application of flowVS not only results in the highest homogeneity of a set of known phenotypically identical cell clusters, but also provides the best discrimination between homogeneous and heterogeneous collection of clusters. The result demonstrates that the flowVS-based variance stabilization can help in performing comparison and alignment of phenotypically identical cell populations across different samples.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>The ratio of between-cluster to within-cluster variations (a measure of effect size of metacluster homogeneity defined in Eq. <xref rid="Equ5" ref-type="">5</xref>) after four transformations</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cell populations</th><th align="left">dataset</th><th align="left">flowTrans</th><th align="left">logicle</th><th align="left">FCSTrans</th><th align="left">flowVS</th></tr></thead><tbody><tr><td align="left">CD4<sup>+</sup> metacluster</td><td align="left">HD</td><td align="left">2.8</td><td align="left">13.70</td><td align="left">13.42</td><td align="left">.87</td></tr><tr><td align="left"/><td align="left">ITN</td><td align="left">1.3</td><td align="left">1.55</td><td align="left">1.54</td><td align="left">.61</td></tr><tr><td align="left">erronous CD4<sup>-</sup>/CD4<sup>+</sup> metacluster</td><td align="left">HD</td><td align="left">24.40</td><td align="left">21.63</td><td align="left">12.64</td><td align="left">36.77</td></tr><tr><td align="left"/><td align="left">ITN</td><td align="left">11.68</td><td align="left">11.30</td><td align="left">10.38</td><td align="left">26.47</td></tr></tbody></table><table-wrap-foot><p>CD4<sup>+</sup> cell populations are used in top two rows, and a mixture of CD4<sup>+</sup> and CD4<sup>-</sup> cell populations are used in bottom two rows. Small and large values of the ratio denote homogeneous and heterogeneous collections of clusters, respectively. In this example, flowVS transformation results in the highest homogeneity when only CD4<sup>+</sup> clusters are considered, and highest heterogeneity when CD4<sup>+</sup> and CD4<sup>-</sup> clusters are mixed together</p></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="Sec17">
      <title>Application to microarray data</title>
      <p>The VS approach based on optimizing Bartlett’s statistic can also be used to stabilize variance in microarray data. However, the initial steps of flowVS need to be adapted for microarrays. Assume that the expression of <italic>m</italic> genes are measured from <italic>N</italic> samples in a microarray experiment. After transforming the data by the asinh function, the mean <italic>μ</italic><sub><italic>i</italic></sub> and variance <inline-formula id="IEq22"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}${\sigma ^{2}_{i}}$\end{document}</tex-math><mml:math id="M54"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1083_Article_IEq22.gif"/></alternatives></inline-formula> of the <italic>i</italic><sup><italic>t</italic><italic>h</italic></sup> gene <italic>g</italic><sub><italic>i</italic></sub> are computed from the expressions of <italic>g</italic><sub><italic>i</italic></sub> in all samples. flowVS then stabilizes the variances of the genes by transforming data using the asinh function with an optimum choice of cofactor. Unlike FC, a single cofactor is selected for all genes in microarrays.</p>
      <p>We have applied the modified flowVS to the publicly available kidney microarray data provided by Huber et al. [<xref ref-type="bibr" rid="CR18">18</xref>]. The kidney data report the expression of 8704 genes from two neighboring parts of a kidney tumor, using cDNA microarray technology. For different values of the cofactor, flowVS transforms the kidney data with the asinh function and identifies the optimum cofactor by minimizing Bartlett’s statistic. Figure <xref rid="Fig9" ref-type="fig">9</xref> shows that a minimum value of Bartlett’s statistic is obtained when the cofactor is set to exp(6) (∼400). The optimum cofactor is then used with the asinh function to transform the kidney data.
<fig id="Fig9"><label>Fig. 9</label><caption><p>For kidney microarray data [<xref ref-type="bibr" rid="CR18">18</xref>], flowVs selects the optimum cofactor for the asinh transformation by minimizing Bartlett’s statistic. The cofactors are shown in the natural logarithm scale</p></caption><graphic xlink:href="12859_2016_1083_Fig9_HTML" id="MO9"/></fig></p>
      <p>We compare the VS performance of flowVS with two software packages, VSN by Huber et al. [<xref ref-type="bibr" rid="CR18">18</xref>] and DDHFm by Motakis et al. [<xref ref-type="bibr" rid="CR46">46</xref>]. Similar to flowVS, VSN uses an asinh transformation whose parameters are optimized by maximizing a likelihood function [<xref ref-type="bibr" rid="CR18">18</xref>]. DDHFm applies a data-driven Haar-Fisz transformation (HFT)[<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR47">47</xref>] to stabilize the variance. Both VSN and DDHFm are developed for stabilizing variance in microarray data and can not be applied to FC.</p>
      <p>In Subfig. <xref rid="Fig10" ref-type="fig">10</xref>, we plot the mean and standard deviation of every gene before transforming the kidney data and after transforming it by flowVS, VSN, and DDHFm. In this figure, we have applied a loess regression to obtain smooth average curves. We observe in Subfig. <xref rid="Fig10" ref-type="fig">10</xref> that the standard deviation of the untransformed kidney data increases monotonically with the mean. Both VSN and flowVs approximately stabilize the variance across all genes in this data. However, the Haar-Fisz transformation achieves good VS properties only for genes with higher levels of expression.
<fig id="Fig10"><label>Fig. 10</label><caption><p>The standard deviation and mean of each gene from the kidney data are plotted before transformation and after variance stabilization by flowVs, VSN, and DDHFm. Loess regression is used to smoothen the curves</p></caption><graphic xlink:href="12859_2016_1083_Fig10_HTML" id="MO10"/></fig></p>
      <p>To take a closer look at the transformed data by flowVS and VSN, we plot the variances of genes against the ranks of their means in Fig. <xref rid="Fig11" ref-type="fig">11</xref>. These figures are generated by the meanSdPlot function from the VSN package. Here, the ranks of means distribute the data evenly along the <italic>x</italic>-axis and thus make it easy to visualize the homogeneity of variances. We also show the running median estimator of standard deviation by the red lines. Both VSN and flowVS remove the mean-variance dependence because the red lines are approximately horizontal for both transformations. Hence, flowVS performs at least as well as a state-of-the-art approach developed for microarray data.
<fig id="Fig11"><label>Fig. 11</label><caption><p>Variance stabilization of the kidney microarray data [<xref ref-type="bibr" rid="CR18">18</xref>] by (<bold>a</bold>) flowVs and (<bold>b</bold>) VSN [<xref ref-type="bibr" rid="CR18">18</xref>]. Each black dot plots the standard deviation of a gene against the rank of its mean. The red lines depict the running median estimator. If there is no mean-variance dependence, then the red lines should be approximately horizontal</p></caption><graphic xlink:href="12859_2016_1083_Fig11_HTML" id="MO11"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec18" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We describe a variance-stabilization framework, flowVS, that removes the mean-variance correlations observed in cell populations from FC samples. This framework transforms each fluorescence channel by the asinh function whose normalization cofactor is optimally selected by Bartlett’s likelihood-ratio test. Variance homogeneity (homoskedasticity) is a desirable property for comparing populations across conditions, building metaclusters from phenotypically similar populations, and analyzing metaclusters in an ANOVA model. However, unlike the earlier approach by Hahne et al. [<xref ref-type="bibr" rid="CR32">32</xref>], flowVS does not artificially shift populations to align them in the marker space. By stabilizing the variances, flowVS homogenizes similar cell populations and establishes the foundation of biologically meaningful metaclusters and templates.</p>
    <p>flowVS is built on several assumptions that limit our approach. First, flowVS stabilizes variance separately in each channel. Thus it might be unable to stabilize covariances across multiple channels when they are correlated. Second, flowVS identifies 1-D density peaks and evaluates the homogeneity of populations by the likelihood-ratio test. Therefore, this algorithm might not perform well when density peaks are not easily identifiable. Third, flowVS stabilizes variance more accurately when a number of samples are simultaneously passed to the algorithm. Hence, this approach is not suitable for normalizing a single sample or stabilizing variances of sequentially arriving samples. Finally, Bartlett’s test used in flowVS assumes that the deviation from normality is relatively modest. If data deviate significantly from normality, other likelihood ratio tests can be employed, such as Levene’s test [<xref ref-type="bibr" rid="CR44">44</xref>] or the Brown-Forsythe test [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
    <p>flowVS operates as an independent module in the FC data analysis pipeline. It does not depend on the preprocessing algorithms applied before VS nor on the post-analysis methods such as matching, metaclustering, and classification. Hence, flowVs is capable of working with most automated clustering and metaclustering algorithms developed for flow cytometry.</p>
  </sec>
  <sec id="Sec19">
    <title>Abbreviations</title>
    <p>asinh, inverse hyperbolic sine; FC, flow cytometry; ITN, immune tolerance network; MFI, mean fluorescence intensity; VS, variance stabilization.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>This work is supported in part by the US Department of Energy (DE-FG02-13ER26135 and DE-AC02-05CH11231), the National Science Foundation (CCF-1218916), the National Institute of Biomedical Imaging and Bioengineering (NIBIB) under Grant Number 5R21EB015707, and an IBM Fellowship.</p>
    <sec id="d30e2555">
      <title>Availability</title>
      <p>flowVS is available as a free package in Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/flowVS.html">http://bioconductor.org/packages/release/bioc/html/flowVS.html</ext-link>). The data sets used in the paper are publicly available in flowVS and flowStats packages in Bioconductor. Results presented in the paper are reproducible and reported in flowVS package vignette.</p>
    </sec>
    <sec id="d30e2565">
      <title>Authors’ contributions</title>
      <p>AA, BR, and AP participated in the discussions to conceive the study, designed the algorithms and experiments, and were involved in writing the manuscript. Additionally, AA implemented the algorithms and created the flowVS software. BR created the Purdue healthy-subject data set. All three authors read and approved the final manuscript.</p>
    </sec>
    <sec id="d30e2570">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d30e2575">
      <title>Ethics approval and consent to participate</title>
      <p>All data analyzed in this study is in the public domain and have been analyzed in previous studies.</p>
    </sec>
    <sec id="d30e2580">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peters</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Ansari</surname>
            <given-names>MQ</given-names>
          </name>
        </person-group>
        <article-title>Multiparameter flow cytometry in the diagnosis and management of acute leukemia</article-title>
        <source>Arch Pathol Lab Med</source>
        <year>2011</year>
        <volume>135</volume>
        <issue>1</issue>
        <fpage>44</fpage>
        <lpage>54</lpage>
        <?supplied-pmid 21204710?>
        <pub-id pub-id-type="pmid">21204710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Seder</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Darrah</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Roederer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>T-cell quality in memory and protection: implications for vaccine design</article-title>
        <source>Nat Rev Immunol</source>
        <year>2008</year>
        <volume>8</volume>
        <issue>4</issue>
        <fpage>247</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1038/nri2274</pub-id>
        <?supplied-pmid 18323851?>
        <pub-id pub-id-type="pmid">18323851</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pyne</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rossin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>TI</given-names>
          </name>
          <name>
            <surname>Maier</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Baecher-Allan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>McLachlan</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafler</surname>
            <given-names>DA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated high-dimensional flow cytometric data analysis</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>21</issue>
        <fpage>8519</fpage>
        <lpage>524</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0903028106</pub-id>
        <?supplied-pmid 19443687?>
        <pub-id pub-id-type="pmid">19443687</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perfetto</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Chattopadhyay</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Roederer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Seventeen-colour flow cytometry: unravelling the immune system</article-title>
        <source>Nat Rev Immunol</source>
        <year>2004</year>
        <volume>4</volume>
        <issue>8</issue>
        <fpage>648</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1038/nri1416</pub-id>
        <?supplied-pmid 15286731?>
        <pub-id pub-id-type="pmid">15286731</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <mixed-citation publication-type="other">Azad A, Rajwa B, Pothen A. Immunophenotypes of acute myeloid leukemia from flow cytometry data using templates. 2014. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1403.6358">http://arxiv.org/abs/1403.6358</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aghaeepour</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hoos</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mosmann</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Scheuermann</surname>
            <given-names>RH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Critical assessment of automated flow cytometry data analysis techniques</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>228</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2365</pub-id>
        <?supplied-pmid 23396282?>
        <pub-id pub-id-type="pmid">23396282</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Shapiro</surname>
            <given-names>HM</given-names>
          </name>
        </person-group>
        <source>Practical Flow Cytometry</source>
        <year>2005</year>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aghaeepour</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nikolic</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hoos</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
        </person-group>
        <article-title>Rapid cell population identification in flow cytometry data</article-title>
        <source>Cytometry Part A</source>
        <year>2011</year>
        <volume>79</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.21007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dundar</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Akova</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yerebakan</surname>
            <given-names>HZ</given-names>
          </name>
          <name>
            <surname>Rajwa</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A non-parametric Bayesian model for joint cell clustering and cluster matching: Identification of anomalous sample phenotypes with random effects</article-title>
        <source>BMC Bioinforma</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>314</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Snow</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Flow cytometer electronics</article-title>
        <source>Cytometry Part A</source>
        <year>2004</year>
        <volume>57</volume>
        <issue>2</issue>
        <fpage>63</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.10120</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Novo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grégori</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rajwa</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Generalized unmixing model for multispectral flow cytometry utilizing nonsquare compensation matrices</article-title>
        <source>Cytometry Part A</source>
        <year>2013</year>
        <volume>83</volume>
        <issue>5</issue>
        <fpage>508</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22272</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>SX</given-names>
          </name>
          <name>
            <surname>McLachlan</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Pyne</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Modeling of inter-sample variation in flow cytometric data with the joint clustering and matching procedure</article-title>
        <source>Cytometry Part A</source>
        <year>2016</year>
        <volume>89A</volume>
        <fpage>30</fpage>
        <lpage>43</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Azad</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Langguth</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pothen</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Identifying rare cell populations in comparative flow cytometry</article-title>
        <source>Lect Notes Comput Sci</source>
        <year>2010</year>
        <volume>6293</volume>
        <fpage>162</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-642-15294-8_14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <mixed-citation publication-type="other">Azad A, Pothen A. Multithreaded algorithms for matching in graphs with application to data analysis in flow cytometry. In: IEEE Parallel and Distributed Processing Symposium Workshops &amp; PhD Forum (IPDPSW). IEEE: 2012. p. 2494–497.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartlett</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The square root transformation in analysis of variance</article-title>
        <source>Suppl J R Stat Soc</source>
        <year>1936</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>68</fpage>
        <lpage>78</lpage>
        <pub-id pub-id-type="doi">10.2307/2983678</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Transformation theory: How normal is a family of distributions?</article-title>
        <source>Ann Stat</source>
        <year>1982</year>
        <volume>10</volume>
        <issue>2</issue>
        <fpage>323</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176345777</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Estimating transformations for regression via additivity and variance stabilization</article-title>
        <source>J Am Stat Assoc</source>
        <year>1988</year>
        <volume>83</volume>
        <issue>402</issue>
        <fpage>394</fpage>
        <lpage>405</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1988.10478610</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Von Heydebreck</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sültmann</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Poustka</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Variance stabilization applied to microarray data calibration and to the quantification of differential expression</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>suppl 1</issue>
        <fpage>96</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.suppl_1.S96</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schena</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shalon</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
        </person-group>
        <article-title>Quantitative monitoring of gene expression patterns with a complementary DNA microarray</article-title>
        <source>Science</source>
        <year>1995</year>
        <volume>270</volume>
        <issue>5235</issue>
        <fpage>467</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1126/science.270.5235.467</pub-id>
        <?supplied-pmid 7569999?>
        <pub-id pub-id-type="pmid">7569999</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dougherty</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Bittner</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Ratio-based decisions and the quantitative analysis of cDNA microarray images</article-title>
        <source>J Biomed Opt</source>
        <year>1997</year>
        <volume>2</volume>
        <issue>4</issue>
        <fpage>364</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1117/12.281504</pub-id>
        <?supplied-pmid 23014960?>
        <pub-id pub-id-type="pmid">23014960</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Hardin</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Rocke</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>A variance-stabilizing transformation for gene-expression microarray data</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>suppl 1</issue>
        <fpage>105</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.suppl_1.S105</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Automated gating of flow cytometry data via robust model-based clustering</article-title>
        <source>Cytometry Part A</source>
        <year>2008</year>
        <volume>73</volume>
        <issue>4</issue>
        <fpage>321</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bagwell</surname>
            <given-names>CB</given-names>
          </name>
        </person-group>
        <article-title>Hyperlog – A flexible log-like transform for negative, zero, and positive valued data</article-title>
        <source>Cytometry Part A</source>
        <year>2005</year>
        <volume>64</volume>
        <issue>1</issue>
        <fpage>34</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Roederer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>WA</given-names>
          </name>
        </person-group>
        <article-title>A new logicle display method avoids deceptive effects of logarithmic scaling for low signals and compensated data</article-title>
        <source>Cytometry Part A</source>
        <year>2006</year>
        <volume>69</volume>
        <issue>6</issue>
        <fpage>541</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Novo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wood</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Flow cytometry histograms: Transformations, resolution, and display</article-title>
        <source>Cytometry Part A</source>
        <year>2008</year>
        <volume>73</volume>
        <issue>8</issue>
        <fpage>685</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dvorak</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>SM</given-names>
          </name>
        </person-group>
        <article-title>Modified Box-Cox transform for modulating the dynamic range of flow cytometry data</article-title>
        <source>Cytometry</source>
        <year>2005</year>
        <volume>10</volume>
        <issue>6</issue>
        <fpage>811</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.990100622</pub-id>
        <pub-id pub-id-type="pmid">2582974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Perez</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Optimizing transformations for automated, high throughput analysis of flow cytometry data</article-title>
        <source>BMC Bioinforma</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>546</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ray</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pyne</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A computational framework to emulate the human perspective in flow cytometric data analysis</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>35693</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0035693</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartlett</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Properties of sufficiency and statistical tests</article-title>
        <source>Proc R Soc Lond Ser A Math Phys Sci</source>
        <year>1937</year>
        <volume>160</volume>
        <issue>901</issue>
        <fpage>268</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1098/rspa.1937.0109</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Azad</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pyne</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pothen</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Matching phosphorylation response patterns of antigen-receptor-stimulated T cells via flow cytometry</article-title>
        <source>BMC Bioinforma</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>Suppl 2</issue>
        <fpage>10</fpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <mixed-citation publication-type="other">Azad A, Khan A, Rajwa B, Pyne S, Pothen A. Classifying immunophenotypes with templates from flow cytometry. In: Proceedings of the International Conference on Bioinformatics, Computational Biology and Biomedical Informatics (ACM BCB). ACM: 2013. p. 256.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hahne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Khodabakhshi</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Bashashati</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Gascoyne</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Seyfert-Margolis</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bourcier</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Asare</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lumley</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Per-channel basis normalization methods for flow cytometry data</article-title>
        <source>Cytometry Part A</source>
        <year>2010</year>
        <volume>77</volume>
        <issue>2</issue>
        <fpage>121</fpage>
        <lpage>31</lpage>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anscombe</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>The transformation of Poisson, binomial and negative-binomial data</article-title>
        <source>Biometrika</source>
        <year>1948</year>
        <volume>35</volume>
        <issue>3/4</issue>
        <fpage>246</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.2307/2332343</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bar-Lev</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Enis</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>On the classical choice of variance stabilizing transformations and an application for a Poisson variate</article-title>
        <source>Biometrika</source>
        <year>1988</year>
        <volume>75</volume>
        <issue>4</issue>
        <fpage>803</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/75.4.803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Fadili</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Starck</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Wavelets, ridgelets, and curvelets for Poisson noise removal</article-title>
        <source>IEEE Trans Image Process</source>
        <year>2008</year>
        <volume>17</volume>
        <issue>7</issue>
        <fpage>1093</fpage>
        <lpage>1108</lpage>
        <pub-id pub-id-type="doi">10.1109/TIP.2008.924386</pub-id>
        <?supplied-pmid 18586618?>
        <pub-id pub-id-type="pmid">18586618</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qian</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>YM</given-names>
          </name>
          <name>
            <surname>Scheuermann</surname>
            <given-names>RH</given-names>
          </name>
        </person-group>
        <article-title>FCSTrans: An open source software system for fcs file conversion and data transformation</article-title>
        <source>Cytometry Part A</source>
        <year>2012</year>
        <volume>81</volume>
        <issue>5</issue>
        <fpage>353</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22037</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Krouse</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sanz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Phippard</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Asare</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosa</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Self</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>High-throughput flow cytometry data normalization for clinical trials</article-title>
        <source>Cytometry Part A</source>
        <year>2014</year>
        <volume>85</volume>
        <issue>3</issue>
        <fpage>277</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22433</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maier</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>De Jager</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Wicker</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Hafler</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>Allelic variant in CTLA4 alters T cell phosphorylation patterns</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2007</year>
        <volume>104</volume>
        <issue>47</issue>
        <fpage>18607</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0706409104</pub-id>
        <?supplied-pmid 18000051?>
        <pub-id pub-id-type="pmid">18000051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hahne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>LeMeur</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Haaland</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sarkar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Spidlen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Strain</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>flowCore: a Bioconductor package for high throughput flow cytometry</article-title>
        <source>BMC Bioinforma</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>106</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-106</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Brent</surname>
            <given-names>RP</given-names>
          </name>
        </person-group>
        <source>Algorithms for Minimization Without Derivatives</source>
        <year>2013</year>
        <publisher-loc>Chicago</publisher-loc>
        <publisher-name>Courier Corporation</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kiefer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Sequential minimax search for a maximum</article-title>
        <source>Proc Am Math Soc</source>
        <year>1953</year>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>502</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1090/S0002-9939-1953-0055639-3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <mixed-citation publication-type="other">Azad A. An algorithmic pipeline for analyzing multi-parametric flow cytometry data. PhD thesis, Purdue University. 2014. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1501.03461">http://arxiv.org/abs/1501.03461</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilk</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Gnanadesikan</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Probability plotting methods for the analysis of data</article-title>
        <source>Biometrika</source>
        <year>1968</year>
        <volume>55</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <?supplied-pmid 5661047?>
        <pub-id pub-id-type="pmid">5661047</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levene</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Robust tests for equality of variances</article-title>
        <source>Contributions to Probability and Statistics: Essays in Honor of Harold Hotelling</source>
        <year>1960</year>
        <volume>2</volume>
        <fpage>278</fpage>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Forsythe</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>Robust tests for the equality of variances</article-title>
        <source>J Am Stat Assoc</source>
        <year>1974</year>
        <volume>69</volume>
        <issue>346</issue>
        <fpage>364</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1974.10482955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Motakis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nason</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Fryzlewicz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rutter</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Variance stabilization and normalization for one-color microarray data using a data-driven multiscale approach</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>20</issue>
        <fpage>2547</fpage>
        <lpage>553</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl412</pub-id>
        <?supplied-pmid 16877753?>
        <pub-id pub-id-type="pmid">16877753</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <mixed-citation publication-type="other">Fryzlewicz P, Delouille V. A data-driven Haar-Fisz transform for multiscale variance stabilization. In: IEEE/SP 13th Workshop on Statistical Signal Processing. IEEE: 2005. p. 539–44.</mixed-citation>
    </ref>
  </ref-list>
</back>
