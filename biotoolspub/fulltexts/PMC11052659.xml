<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11052659</article-id>
    <article-id pub-id-type="pmid">38597887</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae192</article-id>
    <article-id pub-id-type="publisher-id">btae192</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VirusPredictor: XGBoost-based software to predict virus-related sequences in human data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Guangchen</given-names>
        </name>
        <aff><institution>Department of Microbiology and Molecular Genetics, University of Vermont</institution>, Burlington, Vermont 05405, <country country="US">United States</country></aff>
        <aff><institution>School of Mathematics, Shandong University</institution>, Jinan, Shandong 250100, <country country="CN">China</country></aff>
        <aff><institution>School of Mathematics and Statistics, Ludong University</institution>, Yantai, Shandong 264025, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0327-1888</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Xun</given-names>
        </name>
        <aff><institution>Department of Microbiology and Molecular Genetics, University of Vermont</institution>, Burlington, Vermont 05405, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Luan</surname>
          <given-names>Yihui</given-names>
        </name>
        <aff><institution>School of Mathematics, Shandong University</institution>, Jinan, Shandong 250100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9214-4487</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Dawei</given-names>
        </name>
        <aff><institution>Department of Microbiology and Molecular Genetics, University of Vermont</institution>, Burlington, Vermont 05405, <country country="US">United States</country></aff>
        <aff><institution>Department of Immunology and Molecular Microbiology, Texas Tech University Health Sciences Center</institution>, Lubbock, Texas 79430, <country country="US">United States</country></aff>
        <aff><institution>ICanCME Research Network, Sainte-Justine University Hospital Research Center</institution>, Montreal, Quebec H3T 1C5, <country country="CA">Canada</country></aff>
        <xref rid="btae192-FM1" ref-type="author-notes"/>
        <xref rid="btae192-cor1" ref-type="corresp"/>
        <!--dawei.li@ttuhsc.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Martelli</surname>
          <given-names>Pier Luigi</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae192-cor1">Corresponding author. Department of Immunology &amp; Molecular Microbiology, Texas Tech University Health Sciences Center, Lubbock, Texas 79430, United States. E-mail: <email>dawei.li@ttuhsc.edu</email></corresp>
      <fn id="btae192-FM1">
        <p>The University of Vermont and Shandong University contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-04-10">
      <day>10</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>4</issue>
    <elocation-id>btae192</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>05</day>
        <month>4</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>08</day>
        <month>4</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>26</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae192.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Discovering disease causative pathogens, particularly viruses without reference genomes, poses a technical challenge as they are often unidentifiable through sequence alignment. Machine learning prediction of patient high-throughput sequences unmappable to human and pathogen genomes may reveal sequences originating from uncharacterized viruses. Currently, there is a lack of software specifically designed for accurately predicting such viral sequences in human data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed a fast XGBoost method and software VirusPredictor leveraging an in-house viral genome database. Our two-step XGBoost models first classify each query sequence into one of three groups: infectious virus, endogenous retrovirus (ERV) or non-ERV human. The prediction accuracies increased as the sequences became longer, i.e. 0.76, 0.93, and 0.98 for 150–350 (Illumina short reads), 850–950 (Sanger sequencing data), and 2000–5000 bp sequences, respectively. Then, sequences predicted to be from infectious viruses are further classified into one of six virus taxonomic subgroups, and the accuracies increased from 0.92 to &gt;0.98 when query sequences increased from 150–350 to &gt;850 bp. The results suggest that Illumina short reads should be <italic toggle="yes">de novo</italic> assembled into contigs (e.g. ∼1000 bp or longer) before prediction whenever possible. We applied VirusPredictor to multiple real genomic and metagenomic datasets and obtained high accuracies. VirusPredictor, a user-friendly open-source Python software, is useful for predicting the origins of patients’ unmappable sequences. This study is the first to classify ERVs in infectious viral sequence prediction. This is also the first study combining virus sub-group predictions.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="http://www.dllab.org/software/VirusPredictor.html" ext-link-type="uri">www.dllab.org/software/VirusPredictor.html</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Start-up Funds</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
            <institution-id institution-id-type="DOI">10.13039/100000060</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>AI147084</award-id>
        <award-id>AI159710</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Solve ME/CFS Initiative Ramsay Research Grant Program, Open Medicine Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Department of Defense Lung Cancer Research Program</institution>
          </institution-wrap>
        </funding-source>
        <award-id>LC190467</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Despite remarkable advances in high-throughput sequencing (HTS) methods, there remain many human infectious viruses that have not yet been identified or characterized (<xref rid="btae192-B9" ref-type="bibr">Kowarsky <italic toggle="yes">et al.</italic> 2017</xref>). These uncharacterized viruses may contribute to the etiopathology of some “unsolved” human diseases, such as myalgic encephalomyelitis/chronic fatigue syndrome (ME/CFS), where a viral origin has long been speculated but not conclusively established. Approximately 1%–15% (<xref rid="btae192-B6" ref-type="bibr">Chen and Li 2021</xref>) of the Illumina whole-genome sequencing short reads cannot be aligned to the human reference genome or existing viral genomes. While some of these unmapped reads may be attributed to genetic variations, repetitive regions, sequencing errors, or contaminations (<xref rid="btae192-B6" ref-type="bibr">Chen and Li 2021</xref>), the remainder could harbor sequences from yet-to-be-identified pathogens. Experimentally screening each of these sequences is both costly and impractical. HTS data has been generated for these “unsolved” diseases and made publicly available, e.g. whole-genome, whole-transcriptome, and metagenomic sequencing which captured all sequences present in patient biosamples, including sequences derived from any DNA and RNA viruses. Of clinical interest, patient derived HTS data can be used to computationally discover a short list of pathogen sequences that may be related to disease etiology, which can then be verified experimentally. Therefore, re-analyzing the existing patient HTS unmappable sequences will allow us to investigate possible viral associations or causalities in diseases with unclear etiologies. This study is motivated by the need to develop a computational approach capable of predicting viral sequences from unmappable sequence data.</p>
    <p>There are two primary categories of viral sequence detection approaches: alignment-based and alignment-free. Alignment-based approaches, e.g. BLASTN, rely on sequence homology for membership inference, making them successful in many applications (<xref rid="btae192-B19" ref-type="bibr">Roux <italic toggle="yes">et al.</italic> 2011</xref>) but less sensitive to divergent viral sequences with rearrangements, e.g. genetic recombination, shuffling, and horizontal gene transfer, which are common in various viral genomes (<xref rid="btae192-B2" ref-type="bibr">Borozan <italic toggle="yes">et al.</italic> 2015</xref>). Uncharacterized and emerging viruses typically have no reference genomes available for alignment. Another limitation of alignment-based approaches is the intense computational capacity required to analyze large datasets (<xref rid="btae192-B23" ref-type="bibr">Vinga and Almeida 2003</xref>, <xref rid="btae192-B2" ref-type="bibr">Borozan <italic toggle="yes">et al.</italic> 2015</xref>), which are becoming increasingly common. In contrast, alignment-free approaches offer different advantages, e.g. they involve comparisons of sequence features such as word patterns and frequencies of sequences (<xref rid="btae192-B21" ref-type="bibr">Song <italic toggle="yes">et al.</italic> 2014</xref>), and thus are not affected by genome rearrangements (<xref rid="btae192-B11" ref-type="bibr">Leimeister <italic toggle="yes">et al.</italic> 2014</xref>); and their runtime is usually linear in proportion to sequence lengths (<xref rid="btae192-B23" ref-type="bibr">Vinga and Almeida 2003</xref>, <xref rid="btae192-B11" ref-type="bibr">Leimeister <italic toggle="yes">et al.</italic> 2014</xref>), allowing for more efficient big data analyses.</p>
    <p>Machine learning techniques, particularly tree-based ensemble classifiers consisting of multiple decision trees, have greatly improved data processing capabilities in recent years. The eXtreme Gradient Boosting (XGBoost) (<xref rid="btae192-B4" ref-type="bibr">Chen and Guestrin 2016</xref>) is a state-of-the-art ensemble machine learning algorithm known for its scalability and effectiveness in classification and regression problems. “Boosting” is an effective and widely used model training algorithm that can continuously improve and integrate classifiers to create a more accurate classifier. XGBoost uses additive models and forward distribution algorithms to form an ensemble tree with multiple classification and regression tree-based learners, and then scores multiple trees based on the “higher score wins” principle to achieve target value prediction. XGBoost has the advantages of fast parallel processing, high performance, scalability to big data, and the ability to handle sparse training data. XGBoost has been applied to various biomedical fields, such as gene-gene interactions (<xref rid="btae192-B8" ref-type="bibr">Guo <italic toggle="yes">et al.</italic> 2021</xref>), diabetes detection (<xref rid="btae192-B14" ref-type="bibr">Paleczek <italic toggle="yes">et al.</italic> 2021</xref>), and prediction of COVID-19 vaccine administration priorities (<xref rid="btae192-B18" ref-type="bibr">Romeo and Frontoni 2022</xref>), yet, XGBoost has not been explored to detect uncharacterized or emerging viruses from human sequence data.</p>
    <p>One of the unique challenges in predicting viral sequences in HTS data is the presence of &gt;600 000 endogenous retrovirus (ERV) sequences, comprising 8% of the human genome. ERVs resulted from the fixation of ancient retroviral infections and integrations into the human genome. Thus, although functionally distinct, ERVs share high sequence similarities with exogenous infectious viruses, particularly retro-transcribing viruses and other single-stranded RNA viruses. However, ERVs are not considered in infectious viral sequence prediction, which may be problematic. In this study, we introduce a novel XGBoost framework, leveraging our in-house viral genome database, to predict viral-related sequences, including ERVs, in patient’s unmappable sequences.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Datasets and preprocessing</title>
      <p>To develop the three-class virus prediction XGBoost model (i.e. to classify among infectious virus, human ERV, and non-ERV human sequences), we first curated the infectious viral sequences based on two databases: our in-house viral reference genome database (<xref rid="btae192-B5" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2019</xref>) containing 377 009 unique sequences with a minimum length of 100 base pair (bp) and the NCBI Viral Genomes database containing 13 273 complete genome sequences. Combining the two databases led to a total of 390 282 viral sequences utilized in this study. We then extracted ERV sequences from the human genome reference GRCh38.p13 using bedtools <italic toggle="yes">getfasta</italic> function and kept 614 316 ERV sequences with a minimum length of 100 bp. Our non-ERV human sequences were compiled from two sources: the human GRCh38.p13 reference genome after we masked all ERV sequences using bedtools <italic toggle="yes">maskfasta</italic> function (mitochondrial sequences included), and the NCBI Consensus Coding Sequence database containing 33 408 sequences with a minimum length of 100 bp. To develop the six-class subgroup prediction XGBoost model (i.e. to classify among six virus taxonomy subgroups), we utilized the 377 009 partial and whole genomes from our in-house viral genome database, each having been annotated according to the Baltimore classification, i.e. double-strand DNA (dsDNA), single-strand DNA (ssDNA), retro-transcribing (Retro), negative-sense single strand RNA [ssRNA (−)], positive-sense single strand RNA [ssRNA (+)], and double-strand RNA (dsRNA). All sequence data are stored in FASTA format in our pipeline.</p>
      <p>To satisfy our model requirements, we performed three data preprocessing procedures. First, we only retained sequences with lengths ≥100 bp, which was necessary for feature extraction, also in part because most Illumina HTS read lengths are ≥100 bp. Second, we filtered out sequences with ambiguous nucleotides “N”. Third, to train our models for classifying various sequence lengths, particularly assembled contigs, we created additional training datasets by randomly cutting our training datasets (i.e. 95% of the total datasets) by 10 different length gradients (i.e. 100, 150, 200, 300, 500, 700, 1000, 1500, 2000, and 3000 bp), which cover the sequence lengths of, for instance, Illumina short read sequencing (150–350 bp), Sanger sequencing (850–950 bp), and assembled contigs (we examined sequences of 2000–5000 bp, but not longer, because our results have already shown very high accuracies when sequences were &gt;1000 bp). To balance the number of sequences among all the examined groups, we controlled the amounts of the sequences from the length gradients and then merged them with the original sequences. After the preprocessing, for our three-class virus prediction model, we obtained 1 489 300 viral, 1 515 342 ERV, and 1 578 686 non-ERV sequences, with 8838 sequences for testing and the rest for model training (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>); and for our six-class subgroup prediction model, we obtained a total of 1 153 837 viral sequences, with 8387 sequences for testing and the rest for training (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
    </sec>
    <sec>
      <title>2.2 XGBoost classification models</title>
      <p>Using our preprocessed training datasets, we developed XGBoost-based classification models, which showed the best performance compared to other machine learning algorithms (described below). Our trained XGBoost models have three distinct functions; first, the training sequences are transformed into numerical vectors, and a total of 237 informative features of the sequences are extracted via the K-tuple relative abundance and recoding system; second, our virus prediction model classifies each testing sequence into one of the three groups (infectious virus, ERV or non-ERV human); third, our subgroup prediction model then further classifies each viral sequence into one of six taxonomy subgroups. <xref rid="btae192-F1" ref-type="fig">Figure 1</xref> depicts the flowchart of our method and software package (VirusPredictor). The following paragraphs illustrate the development process of the models and software.</p>
      <fig position="float" id="btae192-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Flowchart of VirusPredictor sequence prediction pipeline. <italic toggle="yes">N</italic> is the number of input sequences.</p>
        </caption>
        <graphic xlink:href="btae192f1" position="float"/>
      </fig>
      <sec>
        <title>2.2.1 Sequence feature extraction</title>
        <p>To extract informative numerical features from the training sequences, we first transformed each DNA sequence into a numerical sequence using the alignment-free K-tuple (<xref rid="btae192-B13" ref-type="bibr">Ning <italic toggle="yes">et al.</italic> 2001</xref>) and recoding system (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1.1</xref>). We extracted 237 informative features using relative abundance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1.2 formulas S2</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>) and DNA spectral analyses (<xref rid="btae192-B10" ref-type="bibr">Kwan <italic toggle="yes">et al.</italic> 2012</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref> illustrates our sequence transform and feature extraction strategy. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref> depicts the hierarchical structure of methods for our feature extraction procedures. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref> summarizes the specific methods used in the recoding system.</p>
      </sec>
      <sec>
        <title>2.2.2 Selections of machine learning algorithms and features</title>
        <p>To determine the best machine learning algorithm, we developed multiple classification models using four different algorithms, including random forest, K nearest neighbor, support vector machine, and XGBoost. We then compared the performance among the four algorithms using the same training and testing files, and comparable procedures (e.g. tuning hyperparameters for the optimal performance). To determine the minimum number of informative features, we implemented feature engineering procedures followed by comparing the performance of various numbers of features, i.e. we computed an importance score for each feature using random forest (<xref rid="btae192-B24" ref-type="bibr">Yu <italic toggle="yes">et al.</italic> 2021</xref>), and then selected the top 20, 50, 100 important features and compared their prediction performance with when all features were used. The procedures are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1.3.</xref></p>
      </sec>
      <sec>
        <title>2.2.3 Summary of our two-step XGBoost models</title>
        <p>Our XGBoost models contain two steps: three-class virus prediction followed by six-class subgroup prediction. The details of our XGBoost models are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.2.1 and S1.2.2.</xref> In our virus prediction model, our testing data included three length gradients, including 2938 sequences of 150–350 bp (Illumina short reads), 2937 sequences of 850–950 bp (Sanger sequencing), and 2963 sequences of 2000–5000 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). In our subgroup prediction model, the testing data also contained three length gradients, including 2792 sequences of 150–350 bp, 2711 sequences of 850–950 bp, and 2884 sequences of 2000–5000 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). All necessary data preprocessing procedures, e.g. normalization of training and testing data, have been considered in our analyses (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.2.3</xref> for details).</p>
      </sec>
      <sec>
        <title>2.2.4 Model performance assessment</title>
        <p>Our two-step prediction models from each of the four machine learning algorithms can be considered as a collection of multiple binary classifications. To assess the performance of each trained model, we adopted the macro average of binary metrics, including macro average accuracy, recall, precision, and F1-score (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.3</xref>), which provides equal weight to these binary classes (<xref rid="btae192-B20" ref-type="bibr">Sokolova and Lapalme 2009</xref>).</p>
      </sec>
      <sec>
        <title>2.2.5 VirusPredictor software development</title>
        <p>To implement our two-step XGBoost models, we developed a new software package named VirusPredictor. The software first transforms query sequences into a feature matrix where 23 different methods are utilized to generate a total of 237 features for each input sequence. Then, our trained virus prediction model classifies sequences among infectious virus, ERV, and non-ERV human groups. Our trained subgroup prediction model further classifies each predicted viral sequence into subgroups. Users can modify the algorithms and/or parameters for advanced analyses. VirusPredictor is written in Python and is open-source and freely available (<ext-link xlink:href="http://www.dllab.org/software/VirusPredictor.html" ext-link-type="uri">www.dllab.org/software/VirusPredictor.html</ext-link>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Machine learning algorithms and features</title>
      <p>A total of 237 numerical features were extracted for each training sequence regardless of its original length. We sorted the 237 features according to their relative importance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>). We compared the performance to predict infectious virus, ERV, and non-ERV human sequences among the four algorithms, including random forest, K nearest neighbor, support vector machine, and XGBoost, as well as different numbers of features using 302 169 sequences, a subset randomly selected from our whole sequence data, with 15 108 sequences used for testing and the remaining for model training. Our results showed that the models achieved higher accuracy and F1-scores when more features were included; and XGBoost outperformed almost all the other machine learning algorithms with the highest accuracies using identical data and procedures. Among all the combinations, XGBoost with all 237 features resulted in the best performance, i.e. 0.904 macro average accuracy and 0.904 F1-score (<xref rid="btae192-F2" ref-type="fig">Fig. 2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). Therefore, we then utilized our whole sequence database to train the two-step XGBoost models using the entire 237 features.</p>
      <fig position="float" id="btae192-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Performance comparisons of four machine learning algorithms and different features. Macro average accuracy, F1-score, precision, and recall are shown.</p>
        </caption>
        <graphic xlink:href="btae192f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Three-class XGBoost model to identify viral-related sequences</title>
      <p>Our three-class virus prediction XGBoost model performance metrics increased as the lengths of the testing sequences increased. The macro average accuracies were 0.76 and 0.93 when the testing sequences were 150–350 bp and 850–950 bp, respectively. When the testing sequences were 2000–5000 bp (e.g. assembled long contigs), the prediction accuracies further increased with average accuracy 0.978, recall 0.968, precision 0.967, and F1-score 0.967 (<xref rid="btae192-F3" ref-type="fig">Fig. 3A</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). The pair-wise confusion matrix and model performance metrics of the virus prediction XGBoost model are shown in <xref rid="btae192-F4" ref-type="fig">Fig. 4A</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>.</p>
      <fig position="float" id="btae192-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Performance of (A) our three-class virus prediction and (B) six-class subgroup prediction XGBoost models. The sequence lengths 150–350 and 850–950 bp represent the typical ranges of Illumina short reads and Sanger sequencing data, respectively. Macro average accuracy, F1-score, precision, and recall are shown.</p>
        </caption>
        <graphic xlink:href="btae192f3" position="float"/>
      </fig>
      <fig position="float" id="btae192-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Heatmaps of pair-wise confusion matrix of (A) our virus prediction and (B) subgroup prediction XGBoost models. The value in each cell is the ratio of predicted number divided by the total number of testing sequences of each row (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S7 and S9</xref>). The cells on the diagonal represent correct predictions.</p>
        </caption>
        <graphic xlink:href="btae192f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Six-class XGBoost model to predict virus taxonomic subgroups</title>
      <p>To classify each identified viral sequence into one of the six virus taxonomic subgroups, we further trained a six-class XGBoost classifier using our in-house viral database. After hyperparameter tuning, the trained model showed high accuracies in classifying among the six subgroups, i.e. dsDNA, ssDNA, Retro, ssRNA(−), ssRNA(+), and dsRNA. When the testing sequences were 150–350 bp, the macro average accuracy and F1-score were 0.919 and 0.727, respectively. When the testing sequences were 850–950 bp and 2000–5000 bp, the accuracy and F1-score reached &gt; 0.98. Considering that each of the six classes only has ∼0.16 probability of being correctly classified at random, our model has high performance in predicting viral subgroups (<xref rid="btae192-F3" ref-type="fig">Fig. 3B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S8</xref>). The pair-wise confusion matrix of the subgroup prediction model is shown in <xref rid="btae192-F4" ref-type="fig">Fig. 4B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S9</xref>. The optimal hyperparameter combinations used in our models are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S10</xref>.</p>
    </sec>
    <sec>
      <title>3.4 Applications of VirusPredictor software</title>
      <p>We developed a novel Python software, VirusPredictor, to implement our two-step XGBoost models. We then applied VirusPredictor to five publicly available real viral sequence datasets and obtained high prediction accuracies. For example, a study (<xref rid="btae192-B9" ref-type="bibr">Kowarsky <italic toggle="yes">et al.</italic> 2017</xref>) identified 3761 contigs, validated by polymerase chain reactions, of uncharacterized microbes colonized in human circulating cell-free DNA. We used VirusPredictor to predict these contigs (average length 2595 bp with minimum 1000 bp and maximum 105 439 bp). Our results showed that 3747 of the 3761 contigs were predicted as viral sequences, suggesting 0.996 accuracy. We then added 4000 ERV and 4000 non-ERV human sequences randomly selected from the whole human genome (i.e. the entire ERV and non-ERV human sequences, respectively), and repeated the prediction. We obtained 0.967–0.996 sensitivity, 0.981–0.997 specificity, 0.965–0.993 precision, 0.003–0.019 false positive rates, and 0.986–0.997 accuracies to predict among virus, ERV, and non-ERV human sequences (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S11</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5A</xref>).</p>
      <fig position="float" id="btae192-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Heatmaps of pair-wise confusion matrix of our virus prediction XGBoost model to predict (A) 3761 viral contigs, (B1–B3) SARS-CoV-2 sequences, (C) Illumina 300 bp short reads from human metagenomic data, (D1–D5) phage sequences, and (E1–E5) DNA viruses from human gut microbiome. The value in each cell is ratio of predicted number divided by total number of testing sequences of each row (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S11, S13–S16</xref>). The cells on the diagonal represent correct predictions.</p>
        </caption>
        <graphic xlink:href="btae192f5" position="float"/>
      </fig>
      <p>In our second application, we used VirusPredictor to predict the severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) genome (NC_045512.2; 29 903 bp). When the whole SARS-CoV-2 genome sequence was used as input, VirusPredictor predicted it to be of viral origin, and then accurately classified it as a ssRNA(+) virus. To challenge VirusPredictor, we randomly extracted 300 continuous fragments from the SARS-CoV-2 genome with three length gradients (150–350, 850–950, and 2000–5000 bp), and then used VirusPredictor to predict each of the 300 fragments. The results showed that when the SARS-CoV-2 fragments were 150–350 bp, 69% of the fragments were predicted as being a virus, while the other 31% were classified as ERVs, which admittedly share high sequence similarities with various infectious viral genomes, including the SARS-CoV-2 genome; and 80% of the viral sequences were further predicted as ssRNA(+) (the random rate is 16.7%). When the fragments were 850–950 bp, 97% were predicted as viral sequences; and 88% of the viral sequences were further predicted as ssRNA(+). When the fragments were 2000–5000 bp, 100% were predicted as virus; and 96% were further predicted as ssRNA(+) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S12</xref>). We then added 300 ERV and 300 non-ERV human sequences randomly selected from the whole genome and repeated the prediction for each length group. We obtained 0.9–1 sensitivity, 0.935–1 specificity, 0.881–1 precision, 0–0.065 false positive rates, and 0.943–1 accuracies to predict among virus, ERV, and non-ERV human when the sequence lengths were &gt;850 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S13</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5B</xref>).</p>
      <p>In our third application, we applied VirusPredictor to directly predict the 5551 Illumina short reads (300 bp) of potential viral sequences from 19 metagenomic datasets (<xref rid="btae192-B22" ref-type="bibr">Tampuu <italic toggle="yes">et al.</italic> 2019</xref>) after we randomly checked by BLAST that the vast majority of these reads map to viruses. Our results showed that 83.3% of these short reads were predicted as virus. We then added 5600 ERV and 5600 non-ERV human sequences (300 bp) randomly selected from the whole genome and repeated the prediction. We obtained 0.806–0.833 sensitivity, 0.819–0.957 specificity, 0.694–0.906 precision, 0.043–0.18 false positive rates, and 0.818–0.916 accuracies to predict among virus, ERV, and non-ERV human (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S14</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5C</xref>).</p>
      <p>In our fourth application, we applied VirusPredictor to predict the viruses (mostly phages) used in an existing study (<xref rid="btae192-B17" ref-type="bibr">Ren <italic toggle="yes">et al.</italic> 2020</xref>). After downloading the complete genomes (mean = 70 865 bp with min = 4184 and max = 348 113) from the NCBI viral genome database and removing sequences containing missing nucleotides, we used VirusPredictor to predict the cleaned 674 genomes. All of them were classified to be viruses. We then randomly fragmented these 674 genomes into 5000 sequences with five lengths (i.e. 150, 300, 500, 1000, and 3000 bp, the same lengths as in the Ren <italic toggle="yes">et al.</italic> paper), and further added the same numbers of our ERV and non-ERV human sequences randomly selected from the whole genome. Our results showed 0.815–1 sensitivity, 0.897–1 specificity, 0.801–0.999 precision, 0.001–0.103 false positive rates, and 0.874–1 accuracies to predict among virus, ERV, and non-ERV human when the sequence lengths were &gt;300 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S15</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5D</xref>).</p>
      <p>A study (<xref rid="btae192-B12" ref-type="bibr">Nayfach <italic toggle="yes">et al.</italic> 2021</xref>) released the genome sequences of 189 680 under-represented DNA viruses (98% were dsDNA viruses) from the human gut microbiome. We randomly selected from these viral genomes and fragmented them into 20 000 sequences with various lengths (i.e. 150–350, 850–950, 2000–5000, 10 000–30 000, and 30 000–100 000 bp), and applied VirusPredictor. Our results showed that &gt;99% were predicted as virus, and 81%–98.6% were further predicted into subgroups correctly when the sequence lengths were &gt;850 bp. We then added the same numbers of randomly selected ERV and non-ERV human sequences and repeated the prediction for each length group. We obtained 0.853–1 sensitivity, 0.923–1 specificity, 0.863–1 precision, 0–0.077 false positive rates, and 0.939–1 accuracies to predict among virus, ERV, and non-ERV human when the sequence lengths were &gt;850 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S16</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5E</xref>). Our study is the first of its kind classifying ERVs in viral sequence prediction. Our study is also the first to combine virus subgroup predictions.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Many human diseases, including ME/CFS and some virus-associated cancers (<xref rid="btae192-B3" ref-type="bibr">Cao and Li 2018</xref>), have long been suspected to originate from viral infections, yet the identification of causative pathogens has remained difficult. Discovering viral sequences in these patients’ HTS data has been challenging, particularly for uncharacterized viruses without reference genomes. However, this is a worthwhile endeavor because unmapped sequences from patient HTS data may contain DNA/RNA derived from disease causative pathogens. In this study, we developed a fast and accurate XGBoost-based sequence screening method with user-friendly software to predict infectious viruses from human sequence data derived from long/short read genomic, transcriptomic, and metagenomic sequencing or Sanger sequencing. VirusPredictor is useful specifically for predicting the origins of sequences that cannot be aligned to existing reference genomes of species of interest. VirusPredictor can discover sequences derived from uncharacterized infectious viruses and endogenous retroviruses (for which no actual reference genomes exist), and other viral sequences that are not identifiable by alignment. We demonstrated that our XGBoost models outperformed the other machine learning algorithms (<xref rid="btae192-F2" ref-type="fig">Fig. 2</xref>). Adding to user convenience, VirusPredictor accepts assembled contigs and long/short read sequences in either FASTQ or FASTA format. Since the prediction accuracies increase as the testing sequences become longer (<xref rid="btae192-F3" ref-type="fig">Fig. 3</xref>), we suggest assembling short reads into contigs, e.g. ∼1000 bp (at least ∼800 bp) or longer sequences, whenever possible before predictions.</p>
    <p>Our method has several advantages. We manually built the largest viral reference genome database and utilized it as training data in this study. We implemented a wide range of feature engineering for DNA sequences by leveraging biophysically meaningful methods, e.g. k-tuple, GC content, relative ambiguity, and genomic signal processing (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1 and S2</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). Thus, compared to black boxes in deep learning models, an advantage of our models is their interpretability, i.e. while obtaining high efficiency, our models can identify the key features for classifying groups (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>), providing better understanding of the connections from features to predictions. Our XGBoost models are not affected by multicollinearity. Since XGBoost is based on decision trees, if two or more features are correlated, our method calculates information gain for all the features to select the optimal segmentation feature when deciding upon a splitting tree. Thus, our models are more robust than traditional multi-linear regression when handling multicollinearity. XGBoost can also prevent overfitting while improving accuracy and computational speed through multiple mechanisms (e.g. adding regular terms to objective functions, using one- and second-order Taylor expansions, adopting novel sparsity-aware algorithm, and supporting parallelism algorithm) (<xref rid="btae192-B4" ref-type="bibr">Chen and Guestrin 2016</xref>). Our method can be easily broadened to classify other species (e.g. bacteria, fungi, and plants), and to investigate the global diversity of species.</p>
    <p>However, we have also recognized the limitations of this study. First, almost all machine learning algorithms cannot handle missing data with satisfactory accuracy. In this study, our software automatically checks data quality, discards sequences with missing nucleotides, and generates missing nucleotide warnings to users. Users can choose to manually remove all missing nucleotides or cut sequences into fragments at missing nucleotide junctions and use the cleaned fragments for predictions. In the latter option, as each fragment will obtain its own classification label, the final prediction can be determined by the majority of votes. Second, while it is known that the use of larger training data will lead to better predictions, the limitations of currently available CPU/GPU power led to only a fraction (∼8.9%) of the (non-ERV) human genome being used in our model training process. We anticipate these limitations can be addressed with ongoing advancements in computational resources and collaborative efforts (we made all our source code publicly available). Our software’s prediction accuracies can further increase when more powerful computers become available, allowing for using the complete human genome or a larger portion of it for training. Third, in our virus prediction model, when the testing sequences are 150–350 bp, certain non-ERV human sequences are predicted as ERVs. This reflects the fact that many <italic toggle="yes">individual</italic> ERVs have not yet been identified or annotated in the human genome, i.e. some sequences currently known as “non-ERV” are likely ERVs. In a separate study, our group is identifying individual transposable element sequences (unpublished). Our future plans involve incorporating new transposable element sequences into our models and additional algorithms (<xref rid="btae192-B16" ref-type="bibr">Ren <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btae192-B22" ref-type="bibr">Tampuu <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae192-B17" ref-type="bibr">Ren <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae192-B1" ref-type="bibr">Alshayeji <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btae192-B7" ref-type="bibr">Elbasir <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btae192-B15" ref-type="bibr">Rajkumar <italic toggle="yes">et al.</italic> 2022</xref>) to enhance the predictive power of VirusPredictor. Despite the lack of annotated full ERV sequences, when the testing sequences are &gt;850 bp, the prediction accuracies of our software increased to &gt;90% for all scenarios.</p>
    <p>In summary, we developed and demonstrated a novel XGBoost-based method with user-friendly software, VirusPredictor. It is capable of efficiently screening patients’ unmappable sequence data, preferably assembled contigs or sequences longer than 1000 bp, to identify potential viral-related sequences that can then be verified experimentally. This tool is especially valuable for studying suspected viral associations or causalities in diseases with unclear etiologies. By including ERVs, this research marks a pioneering step in infectious viral sequence prediction, opening avenues for further exploration and discovery.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae192_Supplementary_Data</label>
      <media xlink:href="btae192_supplementary_data.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Michael Mariani, Arvis Sulovari, Jason Kost, Dominic Obraitis, and Synanth Texocaelum for their contributions, discussions, and/or critiques of the analysis or manuscript. We thank the anonymous reviewers for their constructive comments and suggestions.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was partially supported by Start-up Funds [to D.L.], and the research grants [to D.L.] from National Institutes of Health, National Institute of Allergy and Infectious Diseases [AI147084 and AI159710], Solve ME/CFS Initiative Ramsay Research Grant Program, Open Medicine Foundation, and Department of Defense Lung Cancer Research Program [LC190467].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data and software availability</title>
    <p>URLs for data presented herein are as follows:</p>
    <p>NCBI Human Genome Resources: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/projects/genome/guide/human" ext-link-type="uri">www.ncbi.nlm.nih.gov/projects/genome/guide/human</ext-link></p>
    <p>Human genome reference GRCh38.p13: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/assembly/GCF_000001405.39" ext-link-type="uri">www.ncbi.nlm.nih.gov/assembly/GCF_000001405.39</ext-link></p>
    <p>Transposable element annotation hg38_rmsk_TE.gtf.gz: <ext-link xlink:href="http://hammelllab.labsites.cshl.edu/software" ext-link-type="uri">http://hammelllab.labsites.cshl.edu/software</ext-link></p>
    <p>NCBI Consensus Coding Sequence database: <ext-link xlink:href="https://ftp.ncbi.nlm.nih.gov/pub/CCDS" ext-link-type="uri">https://ftp.ncbi.nlm.nih.gov/pub/CCDS</ext-link></p>
    <p>NCBI Viral Genomes: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/genome/viruses" ext-link-type="uri">www.ncbi.nlm.nih.gov/genome/viruses</ext-link></p>
    <p>NCBI Viral Genomes database: <ext-link xlink:href="https://ftp.ncbi.nlm.nih.gov/refseq/release/viral" ext-link-type="uri">https://ftp.ncbi.nlm.nih.gov/refseq/release/viral</ext-link></p>
    <p>International Committee on Taxonomy of Viruses: <ext-link xlink:href="https://talk.ictvonline.org/ictvreports/ictv_online_report" ext-link-type="uri">https://talk.ictvonline.org/ictvreports/ictv_online_report</ext-link></p>
    <p>Baltimore classification: <ext-link xlink:href="http://viralzone.expasy.org/254" ext-link-type="uri">http://viralzone.expasy.org/254</ext-link></p>
    <p>bedtools/getfasta: <ext-link xlink:href="https://bedtools.readthedocs.io/en/latest/content/tools/getfasta.html" ext-link-type="uri">https://bedtools.readthedocs.io/en/latest/content/tools/getfasta.html</ext-link></p>
    <p>VirusPredictor Python package: <ext-link xlink:href="https://www.dllab.org/software/VirusPredictor.html" ext-link-type="uri">www.dllab.org/software/VirusPredictor.html</ext-link></p>
    <p>VirusPredictor transposable element-masked human genome reference GRCh38.p13: <ext-link xlink:href="https://www.dllab.org/software/VirusPredictor/hg38_rmsk_ERV.fa" ext-link-type="uri">www.dllab.org/software/VirusPredictor/hg38_rmsk_ERV.fa</ext-link></p>
    <p>VirusPredictor endogenous retrovirus training data (minimum length = 100 bp): <ext-link xlink:href="https://www.dllab.org/software/VirusPredictor/hg38_ERV_100bp.fa" ext-link-type="uri">www.dllab.org/software/VirusPredictor/hg38_ERV_100bp.fa</ext-link></p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae192-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alshayeji</surname><given-names>MH</given-names></string-name>, <string-name><surname>Sindhu</surname><given-names>SC</given-names></string-name>, <string-name><surname>Abed</surname><given-names>S.</given-names></string-name></person-group><article-title>Viral genome prediction from raw human DNA sequence samples by combining natural language processing and machine learning techniques</article-title>. <source>Expert Syst Appl</source><year>2023</year>;<volume>218</volume>:<fpage>119641</fpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Borozan</surname><given-names>I</given-names></string-name>, <string-name><surname>Watt</surname><given-names>S</given-names></string-name>, <string-name><surname>Ferretti</surname><given-names>V.</given-names></string-name></person-group><article-title>Integrating alignment-based and alignment-free sequence similarity measures for biological sequence classification</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>1396</fpage>–<lpage>404</lpage>.<pub-id pub-id-type="pmid">25573913</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>D.</given-names></string-name></person-group><article-title>Searching for human oncoviruses: histories, challenges, and opportunities</article-title>. <source>J Cell Biochem</source><year>2018</year>;<volume>119</volume>:<fpage>4897</fpage>–<lpage>906</lpage>.<pub-id pub-id-type="pmid">29377246</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>T</given-names></string-name>, <string-name><surname>Guestrin</surname><given-names>C.</given-names></string-name></person-group> XGBoost: a scalable tree boosting system. In: <italic toggle="yes">Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</italic>. San Francisco, CA, USA: Association for Computing Machinery. <year>2016</year>. <fpage>785</fpage>–<lpage>94</lpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Kost</surname><given-names>J</given-names></string-name>, <string-name><surname>Sulovari</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>A virome-wide clonal integration analysis platform for discovering cancer viral etiology</article-title>. <source>Genome Res</source><year>2019</year>;<volume>29</volume>:<fpage>819</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">30872350</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>D.</given-names></string-name></person-group><article-title>Sequencing facility and DNA source associated patterns of virus-mappable reads in whole-genome sequencing data</article-title>. <source>Genomics</source><year>2021</year>;<volume>113</volume>:<fpage>1189</fpage>–<lpage>98</lpage>.<pub-id pub-id-type="pmid">33301893</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elbasir</surname><given-names>A</given-names></string-name>, <string-name><surname>Ye</surname><given-names>Y</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>DE</given-names></string-name></person-group><etal>et al</etal><article-title>A deep learning approach reveals unexplored landscape of viral expression in cancer</article-title>. <source>Nat Commun</source><year>2023</year>;<volume>14</volume>:<fpage>785</fpage>.<pub-id pub-id-type="pmid">36774364</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wu</surname><given-names>C</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Gene-based testing of interactions using XGBoost in genome-wide association studies</article-title>. <source>Front Cell Dev Biol</source><year>2021</year>;<volume>9</volume>:<fpage>801113</fpage>.<pub-id pub-id-type="pmid">34977040</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kowarsky</surname><given-names>M</given-names></string-name>, <string-name><surname>Camunas-Soler</surname><given-names>J</given-names></string-name>, <string-name><surname>Kertesz</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Numerous uncharacterized and highly divergent microbes which colonize humans are revealed by circulating cell-free DNA</article-title>. <source>Proc Natl Acad Sci USA</source><year>2017</year>;<volume>114</volume>:<fpage>9623</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">28830999</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kwan</surname><given-names>HK</given-names></string-name>, <string-name><surname>Kwan</surname><given-names>BY</given-names></string-name>, <string-name><surname>Kwan</surname><given-names>JY.</given-names></string-name></person-group><article-title>Novel methodologies for spectral classification of exon and intron sequences</article-title>. <source>EURASIP J Adv Signal Process</source><year>2012</year>;<volume>2012</volume>:<fpage>1</fpage>–<lpage>14</lpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leimeister</surname><given-names>C-A</given-names></string-name>, <string-name><surname>Boden</surname><given-names>M</given-names></string-name>, <string-name><surname>Horwege</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Fast alignment-free sequence comparison using spaced-word frequencies</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>30</volume>:<fpage>1991</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24700317</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nayfach</surname><given-names>S</given-names></string-name>, <string-name><surname>Páez-Espino</surname><given-names>D</given-names></string-name>, <string-name><surname>Call</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Metagenomic compendium of 189,680 DNA viruses from the human gut microbiome</article-title>. <source>Nat Microbiol</source><year>2021</year>;<volume>6</volume>:<fpage>960</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">34168315</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ning</surname><given-names>Z</given-names></string-name>, <string-name><surname>Cox</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Mullikin</surname><given-names>JC.</given-names></string-name></person-group><article-title>SSAHA: a fast search method for large DNA databases</article-title>. <source>Genome Res</source><year>2001</year>;<volume>11</volume>:<fpage>1725</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">11591649</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paleczek</surname><given-names>A</given-names></string-name>, <string-name><surname>Grochala</surname><given-names>D</given-names></string-name>, <string-name><surname>Rydosz</surname><given-names>A.</given-names></string-name></person-group><article-title>Artificial breath classification using XGBoost algorithm for diabetes detection</article-title>. <source>Sensors (Basel)</source><year>2021</year>;<volume>21</volume>:<fpage>4187</fpage>.<pub-id pub-id-type="pmid">34207196</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Rajkumar</surname><given-names>U</given-names></string-name></person-group><etal>et al</etal> DeepViFi: detecting oncoviral infections in cancer genomes using transformers. In: <italic toggle="yes">Proceedings of the 13th ACM International Conference on Bioinformatics, Computational Biology and Health Informatics</italic>. Northbrook, IL: Association for Computing Machinery. <year>2022</year>. Article 2.</mixed-citation>
    </ref>
    <ref id="btae192-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>J</given-names></string-name>, <string-name><surname>Ahlgren</surname><given-names>NA</given-names></string-name>, <string-name><surname>Lu</surname><given-names>YY</given-names></string-name></person-group><etal>et al</etal><article-title>VirFinder: a novel k-mer based tool for identifying viral sequences from assembled metagenomic data</article-title>. <source>Microbiome</source><year>2017</year>;<volume>5</volume>:<fpage>69</fpage>.<pub-id pub-id-type="pmid">28683828</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>J</given-names></string-name>, <string-name><surname>Song</surname><given-names>K</given-names></string-name>, <string-name><surname>Deng</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Identifying viruses from metagenomic data using deep learning</article-title>. <source>Quant Biol</source><year>2020</year>;<volume>8</volume>:<fpage>64</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">34084563</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Romeo</surname><given-names>L</given-names></string-name>, <string-name><surname>Frontoni</surname><given-names>E.</given-names></string-name></person-group><article-title>A unified hierarchical XGBoost model for classifying priorities for COVID-19 vaccination campaign</article-title>. <source>Pattern Recognit</source><year>2022</year>;<volume>121</volume>:<fpage>108197</fpage>.<pub-id pub-id-type="pmid">34312570</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roux</surname><given-names>S</given-names></string-name>, <string-name><surname>Faubladier</surname><given-names>M</given-names></string-name>, <string-name><surname>Mahul</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Metavir: a web server dedicated to virome analysis</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>3074</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">21911332</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sokolova</surname><given-names>M</given-names></string-name>, <string-name><surname>Lapalme</surname><given-names>G.</given-names></string-name></person-group><article-title>A systematic analysis of performance measures for classification tasks</article-title>. <source>Inf Process Manag</source><year>2009</year>;<volume>45</volume>:<fpage>427</fpage>–<lpage>37</lpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>K</given-names></string-name>, <string-name><surname>Ren</surname><given-names>J</given-names></string-name>, <string-name><surname>Reinert</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>New developments of alignment-free sequence comparison: measures, statistics and next-generation sequencing</article-title>. <source>Brief Bioinform</source><year>2014</year>;<volume>15</volume>:<fpage>343</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">24064230</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tampuu</surname><given-names>A</given-names></string-name>, <string-name><surname>Bzhalava</surname><given-names>Z</given-names></string-name>, <string-name><surname>Dillner</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>ViraMiner: deep learning on raw DNA sequences for identifying viral genomes in human samples</article-title>. <source>PLoS One</source><year>2019</year>;<volume>14</volume>:<fpage>e0222271</fpage>.<pub-id pub-id-type="pmid">31509583</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vinga</surname><given-names>S</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>J.</given-names></string-name></person-group><article-title>Alignment-free sequence comparison-a review</article-title>. <source>Bioinformatics</source><year>2003</year>;<volume>19</volume>:<fpage>513</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">12611807</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>F</given-names></string-name>, <string-name><surname>Wei</surname><given-names>C</given-names></string-name>, <string-name><surname>Deng</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Deep exploration of random Forest model boosts the interpretability of machine learning studies of complicated immune responses and lung burden of nanoparticles</article-title>. <source>Sci Adv</source><year>2021</year>;<volume>7</volume>:<fpage>eabf4130</fpage>.<pub-id pub-id-type="pmid">34039604</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11052659</article-id>
    <article-id pub-id-type="pmid">38597887</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae192</article-id>
    <article-id pub-id-type="publisher-id">btae192</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VirusPredictor: XGBoost-based software to predict virus-related sequences in human data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Guangchen</given-names>
        </name>
        <aff><institution>Department of Microbiology and Molecular Genetics, University of Vermont</institution>, Burlington, Vermont 05405, <country country="US">United States</country></aff>
        <aff><institution>School of Mathematics, Shandong University</institution>, Jinan, Shandong 250100, <country country="CN">China</country></aff>
        <aff><institution>School of Mathematics and Statistics, Ludong University</institution>, Yantai, Shandong 264025, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0327-1888</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Xun</given-names>
        </name>
        <aff><institution>Department of Microbiology and Molecular Genetics, University of Vermont</institution>, Burlington, Vermont 05405, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Luan</surname>
          <given-names>Yihui</given-names>
        </name>
        <aff><institution>School of Mathematics, Shandong University</institution>, Jinan, Shandong 250100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9214-4487</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Dawei</given-names>
        </name>
        <aff><institution>Department of Microbiology and Molecular Genetics, University of Vermont</institution>, Burlington, Vermont 05405, <country country="US">United States</country></aff>
        <aff><institution>Department of Immunology and Molecular Microbiology, Texas Tech University Health Sciences Center</institution>, Lubbock, Texas 79430, <country country="US">United States</country></aff>
        <aff><institution>ICanCME Research Network, Sainte-Justine University Hospital Research Center</institution>, Montreal, Quebec H3T 1C5, <country country="CA">Canada</country></aff>
        <xref rid="btae192-FM1" ref-type="author-notes"/>
        <xref rid="btae192-cor1" ref-type="corresp"/>
        <!--dawei.li@ttuhsc.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Martelli</surname>
          <given-names>Pier Luigi</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae192-cor1">Corresponding author. Department of Immunology &amp; Molecular Microbiology, Texas Tech University Health Sciences Center, Lubbock, Texas 79430, United States. E-mail: <email>dawei.li@ttuhsc.edu</email></corresp>
      <fn id="btae192-FM1">
        <p>The University of Vermont and Shandong University contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-04-10">
      <day>10</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>4</issue>
    <elocation-id>btae192</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>05</day>
        <month>4</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>08</day>
        <month>4</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>26</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae192.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Discovering disease causative pathogens, particularly viruses without reference genomes, poses a technical challenge as they are often unidentifiable through sequence alignment. Machine learning prediction of patient high-throughput sequences unmappable to human and pathogen genomes may reveal sequences originating from uncharacterized viruses. Currently, there is a lack of software specifically designed for accurately predicting such viral sequences in human data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed a fast XGBoost method and software VirusPredictor leveraging an in-house viral genome database. Our two-step XGBoost models first classify each query sequence into one of three groups: infectious virus, endogenous retrovirus (ERV) or non-ERV human. The prediction accuracies increased as the sequences became longer, i.e. 0.76, 0.93, and 0.98 for 150–350 (Illumina short reads), 850–950 (Sanger sequencing data), and 2000–5000 bp sequences, respectively. Then, sequences predicted to be from infectious viruses are further classified into one of six virus taxonomic subgroups, and the accuracies increased from 0.92 to &gt;0.98 when query sequences increased from 150–350 to &gt;850 bp. The results suggest that Illumina short reads should be <italic toggle="yes">de novo</italic> assembled into contigs (e.g. ∼1000 bp or longer) before prediction whenever possible. We applied VirusPredictor to multiple real genomic and metagenomic datasets and obtained high accuracies. VirusPredictor, a user-friendly open-source Python software, is useful for predicting the origins of patients’ unmappable sequences. This study is the first to classify ERVs in infectious viral sequence prediction. This is also the first study combining virus sub-group predictions.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="http://www.dllab.org/software/VirusPredictor.html" ext-link-type="uri">www.dllab.org/software/VirusPredictor.html</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Start-up Funds</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
            <institution-id institution-id-type="DOI">10.13039/100000060</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>AI147084</award-id>
        <award-id>AI159710</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Solve ME/CFS Initiative Ramsay Research Grant Program, Open Medicine Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Department of Defense Lung Cancer Research Program</institution>
          </institution-wrap>
        </funding-source>
        <award-id>LC190467</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Despite remarkable advances in high-throughput sequencing (HTS) methods, there remain many human infectious viruses that have not yet been identified or characterized (<xref rid="btae192-B9" ref-type="bibr">Kowarsky <italic toggle="yes">et al.</italic> 2017</xref>). These uncharacterized viruses may contribute to the etiopathology of some “unsolved” human diseases, such as myalgic encephalomyelitis/chronic fatigue syndrome (ME/CFS), where a viral origin has long been speculated but not conclusively established. Approximately 1%–15% (<xref rid="btae192-B6" ref-type="bibr">Chen and Li 2021</xref>) of the Illumina whole-genome sequencing short reads cannot be aligned to the human reference genome or existing viral genomes. While some of these unmapped reads may be attributed to genetic variations, repetitive regions, sequencing errors, or contaminations (<xref rid="btae192-B6" ref-type="bibr">Chen and Li 2021</xref>), the remainder could harbor sequences from yet-to-be-identified pathogens. Experimentally screening each of these sequences is both costly and impractical. HTS data has been generated for these “unsolved” diseases and made publicly available, e.g. whole-genome, whole-transcriptome, and metagenomic sequencing which captured all sequences present in patient biosamples, including sequences derived from any DNA and RNA viruses. Of clinical interest, patient derived HTS data can be used to computationally discover a short list of pathogen sequences that may be related to disease etiology, which can then be verified experimentally. Therefore, re-analyzing the existing patient HTS unmappable sequences will allow us to investigate possible viral associations or causalities in diseases with unclear etiologies. This study is motivated by the need to develop a computational approach capable of predicting viral sequences from unmappable sequence data.</p>
    <p>There are two primary categories of viral sequence detection approaches: alignment-based and alignment-free. Alignment-based approaches, e.g. BLASTN, rely on sequence homology for membership inference, making them successful in many applications (<xref rid="btae192-B19" ref-type="bibr">Roux <italic toggle="yes">et al.</italic> 2011</xref>) but less sensitive to divergent viral sequences with rearrangements, e.g. genetic recombination, shuffling, and horizontal gene transfer, which are common in various viral genomes (<xref rid="btae192-B2" ref-type="bibr">Borozan <italic toggle="yes">et al.</italic> 2015</xref>). Uncharacterized and emerging viruses typically have no reference genomes available for alignment. Another limitation of alignment-based approaches is the intense computational capacity required to analyze large datasets (<xref rid="btae192-B23" ref-type="bibr">Vinga and Almeida 2003</xref>, <xref rid="btae192-B2" ref-type="bibr">Borozan <italic toggle="yes">et al.</italic> 2015</xref>), which are becoming increasingly common. In contrast, alignment-free approaches offer different advantages, e.g. they involve comparisons of sequence features such as word patterns and frequencies of sequences (<xref rid="btae192-B21" ref-type="bibr">Song <italic toggle="yes">et al.</italic> 2014</xref>), and thus are not affected by genome rearrangements (<xref rid="btae192-B11" ref-type="bibr">Leimeister <italic toggle="yes">et al.</italic> 2014</xref>); and their runtime is usually linear in proportion to sequence lengths (<xref rid="btae192-B23" ref-type="bibr">Vinga and Almeida 2003</xref>, <xref rid="btae192-B11" ref-type="bibr">Leimeister <italic toggle="yes">et al.</italic> 2014</xref>), allowing for more efficient big data analyses.</p>
    <p>Machine learning techniques, particularly tree-based ensemble classifiers consisting of multiple decision trees, have greatly improved data processing capabilities in recent years. The eXtreme Gradient Boosting (XGBoost) (<xref rid="btae192-B4" ref-type="bibr">Chen and Guestrin 2016</xref>) is a state-of-the-art ensemble machine learning algorithm known for its scalability and effectiveness in classification and regression problems. “Boosting” is an effective and widely used model training algorithm that can continuously improve and integrate classifiers to create a more accurate classifier. XGBoost uses additive models and forward distribution algorithms to form an ensemble tree with multiple classification and regression tree-based learners, and then scores multiple trees based on the “higher score wins” principle to achieve target value prediction. XGBoost has the advantages of fast parallel processing, high performance, scalability to big data, and the ability to handle sparse training data. XGBoost has been applied to various biomedical fields, such as gene-gene interactions (<xref rid="btae192-B8" ref-type="bibr">Guo <italic toggle="yes">et al.</italic> 2021</xref>), diabetes detection (<xref rid="btae192-B14" ref-type="bibr">Paleczek <italic toggle="yes">et al.</italic> 2021</xref>), and prediction of COVID-19 vaccine administration priorities (<xref rid="btae192-B18" ref-type="bibr">Romeo and Frontoni 2022</xref>), yet, XGBoost has not been explored to detect uncharacterized or emerging viruses from human sequence data.</p>
    <p>One of the unique challenges in predicting viral sequences in HTS data is the presence of &gt;600 000 endogenous retrovirus (ERV) sequences, comprising 8% of the human genome. ERVs resulted from the fixation of ancient retroviral infections and integrations into the human genome. Thus, although functionally distinct, ERVs share high sequence similarities with exogenous infectious viruses, particularly retro-transcribing viruses and other single-stranded RNA viruses. However, ERVs are not considered in infectious viral sequence prediction, which may be problematic. In this study, we introduce a novel XGBoost framework, leveraging our in-house viral genome database, to predict viral-related sequences, including ERVs, in patient’s unmappable sequences.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Datasets and preprocessing</title>
      <p>To develop the three-class virus prediction XGBoost model (i.e. to classify among infectious virus, human ERV, and non-ERV human sequences), we first curated the infectious viral sequences based on two databases: our in-house viral reference genome database (<xref rid="btae192-B5" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2019</xref>) containing 377 009 unique sequences with a minimum length of 100 base pair (bp) and the NCBI Viral Genomes database containing 13 273 complete genome sequences. Combining the two databases led to a total of 390 282 viral sequences utilized in this study. We then extracted ERV sequences from the human genome reference GRCh38.p13 using bedtools <italic toggle="yes">getfasta</italic> function and kept 614 316 ERV sequences with a minimum length of 100 bp. Our non-ERV human sequences were compiled from two sources: the human GRCh38.p13 reference genome after we masked all ERV sequences using bedtools <italic toggle="yes">maskfasta</italic> function (mitochondrial sequences included), and the NCBI Consensus Coding Sequence database containing 33 408 sequences with a minimum length of 100 bp. To develop the six-class subgroup prediction XGBoost model (i.e. to classify among six virus taxonomy subgroups), we utilized the 377 009 partial and whole genomes from our in-house viral genome database, each having been annotated according to the Baltimore classification, i.e. double-strand DNA (dsDNA), single-strand DNA (ssDNA), retro-transcribing (Retro), negative-sense single strand RNA [ssRNA (−)], positive-sense single strand RNA [ssRNA (+)], and double-strand RNA (dsRNA). All sequence data are stored in FASTA format in our pipeline.</p>
      <p>To satisfy our model requirements, we performed three data preprocessing procedures. First, we only retained sequences with lengths ≥100 bp, which was necessary for feature extraction, also in part because most Illumina HTS read lengths are ≥100 bp. Second, we filtered out sequences with ambiguous nucleotides “N”. Third, to train our models for classifying various sequence lengths, particularly assembled contigs, we created additional training datasets by randomly cutting our training datasets (i.e. 95% of the total datasets) by 10 different length gradients (i.e. 100, 150, 200, 300, 500, 700, 1000, 1500, 2000, and 3000 bp), which cover the sequence lengths of, for instance, Illumina short read sequencing (150–350 bp), Sanger sequencing (850–950 bp), and assembled contigs (we examined sequences of 2000–5000 bp, but not longer, because our results have already shown very high accuracies when sequences were &gt;1000 bp). To balance the number of sequences among all the examined groups, we controlled the amounts of the sequences from the length gradients and then merged them with the original sequences. After the preprocessing, for our three-class virus prediction model, we obtained 1 489 300 viral, 1 515 342 ERV, and 1 578 686 non-ERV sequences, with 8838 sequences for testing and the rest for model training (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>); and for our six-class subgroup prediction model, we obtained a total of 1 153 837 viral sequences, with 8387 sequences for testing and the rest for training (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
    </sec>
    <sec>
      <title>2.2 XGBoost classification models</title>
      <p>Using our preprocessed training datasets, we developed XGBoost-based classification models, which showed the best performance compared to other machine learning algorithms (described below). Our trained XGBoost models have three distinct functions; first, the training sequences are transformed into numerical vectors, and a total of 237 informative features of the sequences are extracted via the K-tuple relative abundance and recoding system; second, our virus prediction model classifies each testing sequence into one of the three groups (infectious virus, ERV or non-ERV human); third, our subgroup prediction model then further classifies each viral sequence into one of six taxonomy subgroups. <xref rid="btae192-F1" ref-type="fig">Figure 1</xref> depicts the flowchart of our method and software package (VirusPredictor). The following paragraphs illustrate the development process of the models and software.</p>
      <fig position="float" id="btae192-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Flowchart of VirusPredictor sequence prediction pipeline. <italic toggle="yes">N</italic> is the number of input sequences.</p>
        </caption>
        <graphic xlink:href="btae192f1" position="float"/>
      </fig>
      <sec>
        <title>2.2.1 Sequence feature extraction</title>
        <p>To extract informative numerical features from the training sequences, we first transformed each DNA sequence into a numerical sequence using the alignment-free K-tuple (<xref rid="btae192-B13" ref-type="bibr">Ning <italic toggle="yes">et al.</italic> 2001</xref>) and recoding system (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1.1</xref>). We extracted 237 informative features using relative abundance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1.2 formulas S2</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>) and DNA spectral analyses (<xref rid="btae192-B10" ref-type="bibr">Kwan <italic toggle="yes">et al.</italic> 2012</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref> illustrates our sequence transform and feature extraction strategy. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref> depicts the hierarchical structure of methods for our feature extraction procedures. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref> summarizes the specific methods used in the recoding system.</p>
      </sec>
      <sec>
        <title>2.2.2 Selections of machine learning algorithms and features</title>
        <p>To determine the best machine learning algorithm, we developed multiple classification models using four different algorithms, including random forest, K nearest neighbor, support vector machine, and XGBoost. We then compared the performance among the four algorithms using the same training and testing files, and comparable procedures (e.g. tuning hyperparameters for the optimal performance). To determine the minimum number of informative features, we implemented feature engineering procedures followed by comparing the performance of various numbers of features, i.e. we computed an importance score for each feature using random forest (<xref rid="btae192-B24" ref-type="bibr">Yu <italic toggle="yes">et al.</italic> 2021</xref>), and then selected the top 20, 50, 100 important features and compared their prediction performance with when all features were used. The procedures are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1.3.</xref></p>
      </sec>
      <sec>
        <title>2.2.3 Summary of our two-step XGBoost models</title>
        <p>Our XGBoost models contain two steps: three-class virus prediction followed by six-class subgroup prediction. The details of our XGBoost models are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.2.1 and S1.2.2.</xref> In our virus prediction model, our testing data included three length gradients, including 2938 sequences of 150–350 bp (Illumina short reads), 2937 sequences of 850–950 bp (Sanger sequencing), and 2963 sequences of 2000–5000 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). In our subgroup prediction model, the testing data also contained three length gradients, including 2792 sequences of 150–350 bp, 2711 sequences of 850–950 bp, and 2884 sequences of 2000–5000 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). All necessary data preprocessing procedures, e.g. normalization of training and testing data, have been considered in our analyses (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.2.3</xref> for details).</p>
      </sec>
      <sec>
        <title>2.2.4 Model performance assessment</title>
        <p>Our two-step prediction models from each of the four machine learning algorithms can be considered as a collection of multiple binary classifications. To assess the performance of each trained model, we adopted the macro average of binary metrics, including macro average accuracy, recall, precision, and F1-score (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.3</xref>), which provides equal weight to these binary classes (<xref rid="btae192-B20" ref-type="bibr">Sokolova and Lapalme 2009</xref>).</p>
      </sec>
      <sec>
        <title>2.2.5 VirusPredictor software development</title>
        <p>To implement our two-step XGBoost models, we developed a new software package named VirusPredictor. The software first transforms query sequences into a feature matrix where 23 different methods are utilized to generate a total of 237 features for each input sequence. Then, our trained virus prediction model classifies sequences among infectious virus, ERV, and non-ERV human groups. Our trained subgroup prediction model further classifies each predicted viral sequence into subgroups. Users can modify the algorithms and/or parameters for advanced analyses. VirusPredictor is written in Python and is open-source and freely available (<ext-link xlink:href="http://www.dllab.org/software/VirusPredictor.html" ext-link-type="uri">www.dllab.org/software/VirusPredictor.html</ext-link>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Machine learning algorithms and features</title>
      <p>A total of 237 numerical features were extracted for each training sequence regardless of its original length. We sorted the 237 features according to their relative importance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>). We compared the performance to predict infectious virus, ERV, and non-ERV human sequences among the four algorithms, including random forest, K nearest neighbor, support vector machine, and XGBoost, as well as different numbers of features using 302 169 sequences, a subset randomly selected from our whole sequence data, with 15 108 sequences used for testing and the remaining for model training. Our results showed that the models achieved higher accuracy and F1-scores when more features were included; and XGBoost outperformed almost all the other machine learning algorithms with the highest accuracies using identical data and procedures. Among all the combinations, XGBoost with all 237 features resulted in the best performance, i.e. 0.904 macro average accuracy and 0.904 F1-score (<xref rid="btae192-F2" ref-type="fig">Fig. 2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). Therefore, we then utilized our whole sequence database to train the two-step XGBoost models using the entire 237 features.</p>
      <fig position="float" id="btae192-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Performance comparisons of four machine learning algorithms and different features. Macro average accuracy, F1-score, precision, and recall are shown.</p>
        </caption>
        <graphic xlink:href="btae192f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Three-class XGBoost model to identify viral-related sequences</title>
      <p>Our three-class virus prediction XGBoost model performance metrics increased as the lengths of the testing sequences increased. The macro average accuracies were 0.76 and 0.93 when the testing sequences were 150–350 bp and 850–950 bp, respectively. When the testing sequences were 2000–5000 bp (e.g. assembled long contigs), the prediction accuracies further increased with average accuracy 0.978, recall 0.968, precision 0.967, and F1-score 0.967 (<xref rid="btae192-F3" ref-type="fig">Fig. 3A</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). The pair-wise confusion matrix and model performance metrics of the virus prediction XGBoost model are shown in <xref rid="btae192-F4" ref-type="fig">Fig. 4A</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>.</p>
      <fig position="float" id="btae192-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Performance of (A) our three-class virus prediction and (B) six-class subgroup prediction XGBoost models. The sequence lengths 150–350 and 850–950 bp represent the typical ranges of Illumina short reads and Sanger sequencing data, respectively. Macro average accuracy, F1-score, precision, and recall are shown.</p>
        </caption>
        <graphic xlink:href="btae192f3" position="float"/>
      </fig>
      <fig position="float" id="btae192-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Heatmaps of pair-wise confusion matrix of (A) our virus prediction and (B) subgroup prediction XGBoost models. The value in each cell is the ratio of predicted number divided by the total number of testing sequences of each row (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S7 and S9</xref>). The cells on the diagonal represent correct predictions.</p>
        </caption>
        <graphic xlink:href="btae192f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Six-class XGBoost model to predict virus taxonomic subgroups</title>
      <p>To classify each identified viral sequence into one of the six virus taxonomic subgroups, we further trained a six-class XGBoost classifier using our in-house viral database. After hyperparameter tuning, the trained model showed high accuracies in classifying among the six subgroups, i.e. dsDNA, ssDNA, Retro, ssRNA(−), ssRNA(+), and dsRNA. When the testing sequences were 150–350 bp, the macro average accuracy and F1-score were 0.919 and 0.727, respectively. When the testing sequences were 850–950 bp and 2000–5000 bp, the accuracy and F1-score reached &gt; 0.98. Considering that each of the six classes only has ∼0.16 probability of being correctly classified at random, our model has high performance in predicting viral subgroups (<xref rid="btae192-F3" ref-type="fig">Fig. 3B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S8</xref>). The pair-wise confusion matrix of the subgroup prediction model is shown in <xref rid="btae192-F4" ref-type="fig">Fig. 4B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S9</xref>. The optimal hyperparameter combinations used in our models are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S10</xref>.</p>
    </sec>
    <sec>
      <title>3.4 Applications of VirusPredictor software</title>
      <p>We developed a novel Python software, VirusPredictor, to implement our two-step XGBoost models. We then applied VirusPredictor to five publicly available real viral sequence datasets and obtained high prediction accuracies. For example, a study (<xref rid="btae192-B9" ref-type="bibr">Kowarsky <italic toggle="yes">et al.</italic> 2017</xref>) identified 3761 contigs, validated by polymerase chain reactions, of uncharacterized microbes colonized in human circulating cell-free DNA. We used VirusPredictor to predict these contigs (average length 2595 bp with minimum 1000 bp and maximum 105 439 bp). Our results showed that 3747 of the 3761 contigs were predicted as viral sequences, suggesting 0.996 accuracy. We then added 4000 ERV and 4000 non-ERV human sequences randomly selected from the whole human genome (i.e. the entire ERV and non-ERV human sequences, respectively), and repeated the prediction. We obtained 0.967–0.996 sensitivity, 0.981–0.997 specificity, 0.965–0.993 precision, 0.003–0.019 false positive rates, and 0.986–0.997 accuracies to predict among virus, ERV, and non-ERV human sequences (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S11</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5A</xref>).</p>
      <fig position="float" id="btae192-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Heatmaps of pair-wise confusion matrix of our virus prediction XGBoost model to predict (A) 3761 viral contigs, (B1–B3) SARS-CoV-2 sequences, (C) Illumina 300 bp short reads from human metagenomic data, (D1–D5) phage sequences, and (E1–E5) DNA viruses from human gut microbiome. The value in each cell is ratio of predicted number divided by total number of testing sequences of each row (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S11, S13–S16</xref>). The cells on the diagonal represent correct predictions.</p>
        </caption>
        <graphic xlink:href="btae192f5" position="float"/>
      </fig>
      <p>In our second application, we used VirusPredictor to predict the severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) genome (NC_045512.2; 29 903 bp). When the whole SARS-CoV-2 genome sequence was used as input, VirusPredictor predicted it to be of viral origin, and then accurately classified it as a ssRNA(+) virus. To challenge VirusPredictor, we randomly extracted 300 continuous fragments from the SARS-CoV-2 genome with three length gradients (150–350, 850–950, and 2000–5000 bp), and then used VirusPredictor to predict each of the 300 fragments. The results showed that when the SARS-CoV-2 fragments were 150–350 bp, 69% of the fragments were predicted as being a virus, while the other 31% were classified as ERVs, which admittedly share high sequence similarities with various infectious viral genomes, including the SARS-CoV-2 genome; and 80% of the viral sequences were further predicted as ssRNA(+) (the random rate is 16.7%). When the fragments were 850–950 bp, 97% were predicted as viral sequences; and 88% of the viral sequences were further predicted as ssRNA(+). When the fragments were 2000–5000 bp, 100% were predicted as virus; and 96% were further predicted as ssRNA(+) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S12</xref>). We then added 300 ERV and 300 non-ERV human sequences randomly selected from the whole genome and repeated the prediction for each length group. We obtained 0.9–1 sensitivity, 0.935–1 specificity, 0.881–1 precision, 0–0.065 false positive rates, and 0.943–1 accuracies to predict among virus, ERV, and non-ERV human when the sequence lengths were &gt;850 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S13</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5B</xref>).</p>
      <p>In our third application, we applied VirusPredictor to directly predict the 5551 Illumina short reads (300 bp) of potential viral sequences from 19 metagenomic datasets (<xref rid="btae192-B22" ref-type="bibr">Tampuu <italic toggle="yes">et al.</italic> 2019</xref>) after we randomly checked by BLAST that the vast majority of these reads map to viruses. Our results showed that 83.3% of these short reads were predicted as virus. We then added 5600 ERV and 5600 non-ERV human sequences (300 bp) randomly selected from the whole genome and repeated the prediction. We obtained 0.806–0.833 sensitivity, 0.819–0.957 specificity, 0.694–0.906 precision, 0.043–0.18 false positive rates, and 0.818–0.916 accuracies to predict among virus, ERV, and non-ERV human (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S14</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5C</xref>).</p>
      <p>In our fourth application, we applied VirusPredictor to predict the viruses (mostly phages) used in an existing study (<xref rid="btae192-B17" ref-type="bibr">Ren <italic toggle="yes">et al.</italic> 2020</xref>). After downloading the complete genomes (mean = 70 865 bp with min = 4184 and max = 348 113) from the NCBI viral genome database and removing sequences containing missing nucleotides, we used VirusPredictor to predict the cleaned 674 genomes. All of them were classified to be viruses. We then randomly fragmented these 674 genomes into 5000 sequences with five lengths (i.e. 150, 300, 500, 1000, and 3000 bp, the same lengths as in the Ren <italic toggle="yes">et al.</italic> paper), and further added the same numbers of our ERV and non-ERV human sequences randomly selected from the whole genome. Our results showed 0.815–1 sensitivity, 0.897–1 specificity, 0.801–0.999 precision, 0.001–0.103 false positive rates, and 0.874–1 accuracies to predict among virus, ERV, and non-ERV human when the sequence lengths were &gt;300 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S15</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5D</xref>).</p>
      <p>A study (<xref rid="btae192-B12" ref-type="bibr">Nayfach <italic toggle="yes">et al.</italic> 2021</xref>) released the genome sequences of 189 680 under-represented DNA viruses (98% were dsDNA viruses) from the human gut microbiome. We randomly selected from these viral genomes and fragmented them into 20 000 sequences with various lengths (i.e. 150–350, 850–950, 2000–5000, 10 000–30 000, and 30 000–100 000 bp), and applied VirusPredictor. Our results showed that &gt;99% were predicted as virus, and 81%–98.6% were further predicted into subgroups correctly when the sequence lengths were &gt;850 bp. We then added the same numbers of randomly selected ERV and non-ERV human sequences and repeated the prediction for each length group. We obtained 0.853–1 sensitivity, 0.923–1 specificity, 0.863–1 precision, 0–0.077 false positive rates, and 0.939–1 accuracies to predict among virus, ERV, and non-ERV human when the sequence lengths were &gt;850 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S16</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5E</xref>). Our study is the first of its kind classifying ERVs in viral sequence prediction. Our study is also the first to combine virus subgroup predictions.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Many human diseases, including ME/CFS and some virus-associated cancers (<xref rid="btae192-B3" ref-type="bibr">Cao and Li 2018</xref>), have long been suspected to originate from viral infections, yet the identification of causative pathogens has remained difficult. Discovering viral sequences in these patients’ HTS data has been challenging, particularly for uncharacterized viruses without reference genomes. However, this is a worthwhile endeavor because unmapped sequences from patient HTS data may contain DNA/RNA derived from disease causative pathogens. In this study, we developed a fast and accurate XGBoost-based sequence screening method with user-friendly software to predict infectious viruses from human sequence data derived from long/short read genomic, transcriptomic, and metagenomic sequencing or Sanger sequencing. VirusPredictor is useful specifically for predicting the origins of sequences that cannot be aligned to existing reference genomes of species of interest. VirusPredictor can discover sequences derived from uncharacterized infectious viruses and endogenous retroviruses (for which no actual reference genomes exist), and other viral sequences that are not identifiable by alignment. We demonstrated that our XGBoost models outperformed the other machine learning algorithms (<xref rid="btae192-F2" ref-type="fig">Fig. 2</xref>). Adding to user convenience, VirusPredictor accepts assembled contigs and long/short read sequences in either FASTQ or FASTA format. Since the prediction accuracies increase as the testing sequences become longer (<xref rid="btae192-F3" ref-type="fig">Fig. 3</xref>), we suggest assembling short reads into contigs, e.g. ∼1000 bp (at least ∼800 bp) or longer sequences, whenever possible before predictions.</p>
    <p>Our method has several advantages. We manually built the largest viral reference genome database and utilized it as training data in this study. We implemented a wide range of feature engineering for DNA sequences by leveraging biophysically meaningful methods, e.g. k-tuple, GC content, relative ambiguity, and genomic signal processing (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1 and S2</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). Thus, compared to black boxes in deep learning models, an advantage of our models is their interpretability, i.e. while obtaining high efficiency, our models can identify the key features for classifying groups (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>), providing better understanding of the connections from features to predictions. Our XGBoost models are not affected by multicollinearity. Since XGBoost is based on decision trees, if two or more features are correlated, our method calculates information gain for all the features to select the optimal segmentation feature when deciding upon a splitting tree. Thus, our models are more robust than traditional multi-linear regression when handling multicollinearity. XGBoost can also prevent overfitting while improving accuracy and computational speed through multiple mechanisms (e.g. adding regular terms to objective functions, using one- and second-order Taylor expansions, adopting novel sparsity-aware algorithm, and supporting parallelism algorithm) (<xref rid="btae192-B4" ref-type="bibr">Chen and Guestrin 2016</xref>). Our method can be easily broadened to classify other species (e.g. bacteria, fungi, and plants), and to investigate the global diversity of species.</p>
    <p>However, we have also recognized the limitations of this study. First, almost all machine learning algorithms cannot handle missing data with satisfactory accuracy. In this study, our software automatically checks data quality, discards sequences with missing nucleotides, and generates missing nucleotide warnings to users. Users can choose to manually remove all missing nucleotides or cut sequences into fragments at missing nucleotide junctions and use the cleaned fragments for predictions. In the latter option, as each fragment will obtain its own classification label, the final prediction can be determined by the majority of votes. Second, while it is known that the use of larger training data will lead to better predictions, the limitations of currently available CPU/GPU power led to only a fraction (∼8.9%) of the (non-ERV) human genome being used in our model training process. We anticipate these limitations can be addressed with ongoing advancements in computational resources and collaborative efforts (we made all our source code publicly available). Our software’s prediction accuracies can further increase when more powerful computers become available, allowing for using the complete human genome or a larger portion of it for training. Third, in our virus prediction model, when the testing sequences are 150–350 bp, certain non-ERV human sequences are predicted as ERVs. This reflects the fact that many <italic toggle="yes">individual</italic> ERVs have not yet been identified or annotated in the human genome, i.e. some sequences currently known as “non-ERV” are likely ERVs. In a separate study, our group is identifying individual transposable element sequences (unpublished). Our future plans involve incorporating new transposable element sequences into our models and additional algorithms (<xref rid="btae192-B16" ref-type="bibr">Ren <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btae192-B22" ref-type="bibr">Tampuu <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae192-B17" ref-type="bibr">Ren <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae192-B1" ref-type="bibr">Alshayeji <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btae192-B7" ref-type="bibr">Elbasir <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btae192-B15" ref-type="bibr">Rajkumar <italic toggle="yes">et al.</italic> 2022</xref>) to enhance the predictive power of VirusPredictor. Despite the lack of annotated full ERV sequences, when the testing sequences are &gt;850 bp, the prediction accuracies of our software increased to &gt;90% for all scenarios.</p>
    <p>In summary, we developed and demonstrated a novel XGBoost-based method with user-friendly software, VirusPredictor. It is capable of efficiently screening patients’ unmappable sequence data, preferably assembled contigs or sequences longer than 1000 bp, to identify potential viral-related sequences that can then be verified experimentally. This tool is especially valuable for studying suspected viral associations or causalities in diseases with unclear etiologies. By including ERVs, this research marks a pioneering step in infectious viral sequence prediction, opening avenues for further exploration and discovery.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae192_Supplementary_Data</label>
      <media xlink:href="btae192_supplementary_data.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Michael Mariani, Arvis Sulovari, Jason Kost, Dominic Obraitis, and Synanth Texocaelum for their contributions, discussions, and/or critiques of the analysis or manuscript. We thank the anonymous reviewers for their constructive comments and suggestions.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was partially supported by Start-up Funds [to D.L.], and the research grants [to D.L.] from National Institutes of Health, National Institute of Allergy and Infectious Diseases [AI147084 and AI159710], Solve ME/CFS Initiative Ramsay Research Grant Program, Open Medicine Foundation, and Department of Defense Lung Cancer Research Program [LC190467].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data and software availability</title>
    <p>URLs for data presented herein are as follows:</p>
    <p>NCBI Human Genome Resources: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/projects/genome/guide/human" ext-link-type="uri">www.ncbi.nlm.nih.gov/projects/genome/guide/human</ext-link></p>
    <p>Human genome reference GRCh38.p13: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/assembly/GCF_000001405.39" ext-link-type="uri">www.ncbi.nlm.nih.gov/assembly/GCF_000001405.39</ext-link></p>
    <p>Transposable element annotation hg38_rmsk_TE.gtf.gz: <ext-link xlink:href="http://hammelllab.labsites.cshl.edu/software" ext-link-type="uri">http://hammelllab.labsites.cshl.edu/software</ext-link></p>
    <p>NCBI Consensus Coding Sequence database: <ext-link xlink:href="https://ftp.ncbi.nlm.nih.gov/pub/CCDS" ext-link-type="uri">https://ftp.ncbi.nlm.nih.gov/pub/CCDS</ext-link></p>
    <p>NCBI Viral Genomes: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/genome/viruses" ext-link-type="uri">www.ncbi.nlm.nih.gov/genome/viruses</ext-link></p>
    <p>NCBI Viral Genomes database: <ext-link xlink:href="https://ftp.ncbi.nlm.nih.gov/refseq/release/viral" ext-link-type="uri">https://ftp.ncbi.nlm.nih.gov/refseq/release/viral</ext-link></p>
    <p>International Committee on Taxonomy of Viruses: <ext-link xlink:href="https://talk.ictvonline.org/ictvreports/ictv_online_report" ext-link-type="uri">https://talk.ictvonline.org/ictvreports/ictv_online_report</ext-link></p>
    <p>Baltimore classification: <ext-link xlink:href="http://viralzone.expasy.org/254" ext-link-type="uri">http://viralzone.expasy.org/254</ext-link></p>
    <p>bedtools/getfasta: <ext-link xlink:href="https://bedtools.readthedocs.io/en/latest/content/tools/getfasta.html" ext-link-type="uri">https://bedtools.readthedocs.io/en/latest/content/tools/getfasta.html</ext-link></p>
    <p>VirusPredictor Python package: <ext-link xlink:href="https://www.dllab.org/software/VirusPredictor.html" ext-link-type="uri">www.dllab.org/software/VirusPredictor.html</ext-link></p>
    <p>VirusPredictor transposable element-masked human genome reference GRCh38.p13: <ext-link xlink:href="https://www.dllab.org/software/VirusPredictor/hg38_rmsk_ERV.fa" ext-link-type="uri">www.dllab.org/software/VirusPredictor/hg38_rmsk_ERV.fa</ext-link></p>
    <p>VirusPredictor endogenous retrovirus training data (minimum length = 100 bp): <ext-link xlink:href="https://www.dllab.org/software/VirusPredictor/hg38_ERV_100bp.fa" ext-link-type="uri">www.dllab.org/software/VirusPredictor/hg38_ERV_100bp.fa</ext-link></p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae192-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alshayeji</surname><given-names>MH</given-names></string-name>, <string-name><surname>Sindhu</surname><given-names>SC</given-names></string-name>, <string-name><surname>Abed</surname><given-names>S.</given-names></string-name></person-group><article-title>Viral genome prediction from raw human DNA sequence samples by combining natural language processing and machine learning techniques</article-title>. <source>Expert Syst Appl</source><year>2023</year>;<volume>218</volume>:<fpage>119641</fpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Borozan</surname><given-names>I</given-names></string-name>, <string-name><surname>Watt</surname><given-names>S</given-names></string-name>, <string-name><surname>Ferretti</surname><given-names>V.</given-names></string-name></person-group><article-title>Integrating alignment-based and alignment-free sequence similarity measures for biological sequence classification</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>1396</fpage>–<lpage>404</lpage>.<pub-id pub-id-type="pmid">25573913</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>D.</given-names></string-name></person-group><article-title>Searching for human oncoviruses: histories, challenges, and opportunities</article-title>. <source>J Cell Biochem</source><year>2018</year>;<volume>119</volume>:<fpage>4897</fpage>–<lpage>906</lpage>.<pub-id pub-id-type="pmid">29377246</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>T</given-names></string-name>, <string-name><surname>Guestrin</surname><given-names>C.</given-names></string-name></person-group> XGBoost: a scalable tree boosting system. In: <italic toggle="yes">Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</italic>. San Francisco, CA, USA: Association for Computing Machinery. <year>2016</year>. <fpage>785</fpage>–<lpage>94</lpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Kost</surname><given-names>J</given-names></string-name>, <string-name><surname>Sulovari</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>A virome-wide clonal integration analysis platform for discovering cancer viral etiology</article-title>. <source>Genome Res</source><year>2019</year>;<volume>29</volume>:<fpage>819</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">30872350</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>D.</given-names></string-name></person-group><article-title>Sequencing facility and DNA source associated patterns of virus-mappable reads in whole-genome sequencing data</article-title>. <source>Genomics</source><year>2021</year>;<volume>113</volume>:<fpage>1189</fpage>–<lpage>98</lpage>.<pub-id pub-id-type="pmid">33301893</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elbasir</surname><given-names>A</given-names></string-name>, <string-name><surname>Ye</surname><given-names>Y</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>DE</given-names></string-name></person-group><etal>et al</etal><article-title>A deep learning approach reveals unexplored landscape of viral expression in cancer</article-title>. <source>Nat Commun</source><year>2023</year>;<volume>14</volume>:<fpage>785</fpage>.<pub-id pub-id-type="pmid">36774364</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wu</surname><given-names>C</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Gene-based testing of interactions using XGBoost in genome-wide association studies</article-title>. <source>Front Cell Dev Biol</source><year>2021</year>;<volume>9</volume>:<fpage>801113</fpage>.<pub-id pub-id-type="pmid">34977040</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kowarsky</surname><given-names>M</given-names></string-name>, <string-name><surname>Camunas-Soler</surname><given-names>J</given-names></string-name>, <string-name><surname>Kertesz</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Numerous uncharacterized and highly divergent microbes which colonize humans are revealed by circulating cell-free DNA</article-title>. <source>Proc Natl Acad Sci USA</source><year>2017</year>;<volume>114</volume>:<fpage>9623</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">28830999</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kwan</surname><given-names>HK</given-names></string-name>, <string-name><surname>Kwan</surname><given-names>BY</given-names></string-name>, <string-name><surname>Kwan</surname><given-names>JY.</given-names></string-name></person-group><article-title>Novel methodologies for spectral classification of exon and intron sequences</article-title>. <source>EURASIP J Adv Signal Process</source><year>2012</year>;<volume>2012</volume>:<fpage>1</fpage>–<lpage>14</lpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leimeister</surname><given-names>C-A</given-names></string-name>, <string-name><surname>Boden</surname><given-names>M</given-names></string-name>, <string-name><surname>Horwege</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Fast alignment-free sequence comparison using spaced-word frequencies</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>30</volume>:<fpage>1991</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24700317</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nayfach</surname><given-names>S</given-names></string-name>, <string-name><surname>Páez-Espino</surname><given-names>D</given-names></string-name>, <string-name><surname>Call</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Metagenomic compendium of 189,680 DNA viruses from the human gut microbiome</article-title>. <source>Nat Microbiol</source><year>2021</year>;<volume>6</volume>:<fpage>960</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">34168315</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ning</surname><given-names>Z</given-names></string-name>, <string-name><surname>Cox</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Mullikin</surname><given-names>JC.</given-names></string-name></person-group><article-title>SSAHA: a fast search method for large DNA databases</article-title>. <source>Genome Res</source><year>2001</year>;<volume>11</volume>:<fpage>1725</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">11591649</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paleczek</surname><given-names>A</given-names></string-name>, <string-name><surname>Grochala</surname><given-names>D</given-names></string-name>, <string-name><surname>Rydosz</surname><given-names>A.</given-names></string-name></person-group><article-title>Artificial breath classification using XGBoost algorithm for diabetes detection</article-title>. <source>Sensors (Basel)</source><year>2021</year>;<volume>21</volume>:<fpage>4187</fpage>.<pub-id pub-id-type="pmid">34207196</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Rajkumar</surname><given-names>U</given-names></string-name></person-group><etal>et al</etal> DeepViFi: detecting oncoviral infections in cancer genomes using transformers. In: <italic toggle="yes">Proceedings of the 13th ACM International Conference on Bioinformatics, Computational Biology and Health Informatics</italic>. Northbrook, IL: Association for Computing Machinery. <year>2022</year>. Article 2.</mixed-citation>
    </ref>
    <ref id="btae192-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>J</given-names></string-name>, <string-name><surname>Ahlgren</surname><given-names>NA</given-names></string-name>, <string-name><surname>Lu</surname><given-names>YY</given-names></string-name></person-group><etal>et al</etal><article-title>VirFinder: a novel k-mer based tool for identifying viral sequences from assembled metagenomic data</article-title>. <source>Microbiome</source><year>2017</year>;<volume>5</volume>:<fpage>69</fpage>.<pub-id pub-id-type="pmid">28683828</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>J</given-names></string-name>, <string-name><surname>Song</surname><given-names>K</given-names></string-name>, <string-name><surname>Deng</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Identifying viruses from metagenomic data using deep learning</article-title>. <source>Quant Biol</source><year>2020</year>;<volume>8</volume>:<fpage>64</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">34084563</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Romeo</surname><given-names>L</given-names></string-name>, <string-name><surname>Frontoni</surname><given-names>E.</given-names></string-name></person-group><article-title>A unified hierarchical XGBoost model for classifying priorities for COVID-19 vaccination campaign</article-title>. <source>Pattern Recognit</source><year>2022</year>;<volume>121</volume>:<fpage>108197</fpage>.<pub-id pub-id-type="pmid">34312570</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roux</surname><given-names>S</given-names></string-name>, <string-name><surname>Faubladier</surname><given-names>M</given-names></string-name>, <string-name><surname>Mahul</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Metavir: a web server dedicated to virome analysis</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>3074</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">21911332</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sokolova</surname><given-names>M</given-names></string-name>, <string-name><surname>Lapalme</surname><given-names>G.</given-names></string-name></person-group><article-title>A systematic analysis of performance measures for classification tasks</article-title>. <source>Inf Process Manag</source><year>2009</year>;<volume>45</volume>:<fpage>427</fpage>–<lpage>37</lpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>K</given-names></string-name>, <string-name><surname>Ren</surname><given-names>J</given-names></string-name>, <string-name><surname>Reinert</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>New developments of alignment-free sequence comparison: measures, statistics and next-generation sequencing</article-title>. <source>Brief Bioinform</source><year>2014</year>;<volume>15</volume>:<fpage>343</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">24064230</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tampuu</surname><given-names>A</given-names></string-name>, <string-name><surname>Bzhalava</surname><given-names>Z</given-names></string-name>, <string-name><surname>Dillner</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>ViraMiner: deep learning on raw DNA sequences for identifying viral genomes in human samples</article-title>. <source>PLoS One</source><year>2019</year>;<volume>14</volume>:<fpage>e0222271</fpage>.<pub-id pub-id-type="pmid">31509583</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vinga</surname><given-names>S</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>J.</given-names></string-name></person-group><article-title>Alignment-free sequence comparison-a review</article-title>. <source>Bioinformatics</source><year>2003</year>;<volume>19</volume>:<fpage>513</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">12611807</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>F</given-names></string-name>, <string-name><surname>Wei</surname><given-names>C</given-names></string-name>, <string-name><surname>Deng</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Deep exploration of random Forest model boosts the interpretability of machine learning studies of complicated immune responses and lung burden of nanoparticles</article-title>. <source>Sci Adv</source><year>2021</year>;<volume>7</volume>:<fpage>eabf4130</fpage>.<pub-id pub-id-type="pmid">34039604</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11052659</article-id>
    <article-id pub-id-type="pmid">38597887</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae192</article-id>
    <article-id pub-id-type="publisher-id">btae192</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VirusPredictor: XGBoost-based software to predict virus-related sequences in human data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Guangchen</given-names>
        </name>
        <aff><institution>Department of Microbiology and Molecular Genetics, University of Vermont</institution>, Burlington, Vermont 05405, <country country="US">United States</country></aff>
        <aff><institution>School of Mathematics, Shandong University</institution>, Jinan, Shandong 250100, <country country="CN">China</country></aff>
        <aff><institution>School of Mathematics and Statistics, Ludong University</institution>, Yantai, Shandong 264025, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0327-1888</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Xun</given-names>
        </name>
        <aff><institution>Department of Microbiology and Molecular Genetics, University of Vermont</institution>, Burlington, Vermont 05405, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Luan</surname>
          <given-names>Yihui</given-names>
        </name>
        <aff><institution>School of Mathematics, Shandong University</institution>, Jinan, Shandong 250100, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9214-4487</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Dawei</given-names>
        </name>
        <aff><institution>Department of Microbiology and Molecular Genetics, University of Vermont</institution>, Burlington, Vermont 05405, <country country="US">United States</country></aff>
        <aff><institution>Department of Immunology and Molecular Microbiology, Texas Tech University Health Sciences Center</institution>, Lubbock, Texas 79430, <country country="US">United States</country></aff>
        <aff><institution>ICanCME Research Network, Sainte-Justine University Hospital Research Center</institution>, Montreal, Quebec H3T 1C5, <country country="CA">Canada</country></aff>
        <xref rid="btae192-FM1" ref-type="author-notes"/>
        <xref rid="btae192-cor1" ref-type="corresp"/>
        <!--dawei.li@ttuhsc.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Martelli</surname>
          <given-names>Pier Luigi</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae192-cor1">Corresponding author. Department of Immunology &amp; Molecular Microbiology, Texas Tech University Health Sciences Center, Lubbock, Texas 79430, United States. E-mail: <email>dawei.li@ttuhsc.edu</email></corresp>
      <fn id="btae192-FM1">
        <p>The University of Vermont and Shandong University contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-04-10">
      <day>10</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>4</issue>
    <elocation-id>btae192</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>10</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>05</day>
        <month>4</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>08</day>
        <month>4</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>26</day>
        <month>4</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae192.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Discovering disease causative pathogens, particularly viruses without reference genomes, poses a technical challenge as they are often unidentifiable through sequence alignment. Machine learning prediction of patient high-throughput sequences unmappable to human and pathogen genomes may reveal sequences originating from uncharacterized viruses. Currently, there is a lack of software specifically designed for accurately predicting such viral sequences in human data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed a fast XGBoost method and software VirusPredictor leveraging an in-house viral genome database. Our two-step XGBoost models first classify each query sequence into one of three groups: infectious virus, endogenous retrovirus (ERV) or non-ERV human. The prediction accuracies increased as the sequences became longer, i.e. 0.76, 0.93, and 0.98 for 150–350 (Illumina short reads), 850–950 (Sanger sequencing data), and 2000–5000 bp sequences, respectively. Then, sequences predicted to be from infectious viruses are further classified into one of six virus taxonomic subgroups, and the accuracies increased from 0.92 to &gt;0.98 when query sequences increased from 150–350 to &gt;850 bp. The results suggest that Illumina short reads should be <italic toggle="yes">de novo</italic> assembled into contigs (e.g. ∼1000 bp or longer) before prediction whenever possible. We applied VirusPredictor to multiple real genomic and metagenomic datasets and obtained high accuracies. VirusPredictor, a user-friendly open-source Python software, is useful for predicting the origins of patients’ unmappable sequences. This study is the first to classify ERVs in infectious viral sequence prediction. This is also the first study combining virus sub-group predictions.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="http://www.dllab.org/software/VirusPredictor.html" ext-link-type="uri">www.dllab.org/software/VirusPredictor.html</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Start-up Funds</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
            <institution-id institution-id-type="DOI">10.13039/100000060</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>AI147084</award-id>
        <award-id>AI159710</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Solve ME/CFS Initiative Ramsay Research Grant Program, Open Medicine Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Department of Defense Lung Cancer Research Program</institution>
          </institution-wrap>
        </funding-source>
        <award-id>LC190467</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Despite remarkable advances in high-throughput sequencing (HTS) methods, there remain many human infectious viruses that have not yet been identified or characterized (<xref rid="btae192-B9" ref-type="bibr">Kowarsky <italic toggle="yes">et al.</italic> 2017</xref>). These uncharacterized viruses may contribute to the etiopathology of some “unsolved” human diseases, such as myalgic encephalomyelitis/chronic fatigue syndrome (ME/CFS), where a viral origin has long been speculated but not conclusively established. Approximately 1%–15% (<xref rid="btae192-B6" ref-type="bibr">Chen and Li 2021</xref>) of the Illumina whole-genome sequencing short reads cannot be aligned to the human reference genome or existing viral genomes. While some of these unmapped reads may be attributed to genetic variations, repetitive regions, sequencing errors, or contaminations (<xref rid="btae192-B6" ref-type="bibr">Chen and Li 2021</xref>), the remainder could harbor sequences from yet-to-be-identified pathogens. Experimentally screening each of these sequences is both costly and impractical. HTS data has been generated for these “unsolved” diseases and made publicly available, e.g. whole-genome, whole-transcriptome, and metagenomic sequencing which captured all sequences present in patient biosamples, including sequences derived from any DNA and RNA viruses. Of clinical interest, patient derived HTS data can be used to computationally discover a short list of pathogen sequences that may be related to disease etiology, which can then be verified experimentally. Therefore, re-analyzing the existing patient HTS unmappable sequences will allow us to investigate possible viral associations or causalities in diseases with unclear etiologies. This study is motivated by the need to develop a computational approach capable of predicting viral sequences from unmappable sequence data.</p>
    <p>There are two primary categories of viral sequence detection approaches: alignment-based and alignment-free. Alignment-based approaches, e.g. BLASTN, rely on sequence homology for membership inference, making them successful in many applications (<xref rid="btae192-B19" ref-type="bibr">Roux <italic toggle="yes">et al.</italic> 2011</xref>) but less sensitive to divergent viral sequences with rearrangements, e.g. genetic recombination, shuffling, and horizontal gene transfer, which are common in various viral genomes (<xref rid="btae192-B2" ref-type="bibr">Borozan <italic toggle="yes">et al.</italic> 2015</xref>). Uncharacterized and emerging viruses typically have no reference genomes available for alignment. Another limitation of alignment-based approaches is the intense computational capacity required to analyze large datasets (<xref rid="btae192-B23" ref-type="bibr">Vinga and Almeida 2003</xref>, <xref rid="btae192-B2" ref-type="bibr">Borozan <italic toggle="yes">et al.</italic> 2015</xref>), which are becoming increasingly common. In contrast, alignment-free approaches offer different advantages, e.g. they involve comparisons of sequence features such as word patterns and frequencies of sequences (<xref rid="btae192-B21" ref-type="bibr">Song <italic toggle="yes">et al.</italic> 2014</xref>), and thus are not affected by genome rearrangements (<xref rid="btae192-B11" ref-type="bibr">Leimeister <italic toggle="yes">et al.</italic> 2014</xref>); and their runtime is usually linear in proportion to sequence lengths (<xref rid="btae192-B23" ref-type="bibr">Vinga and Almeida 2003</xref>, <xref rid="btae192-B11" ref-type="bibr">Leimeister <italic toggle="yes">et al.</italic> 2014</xref>), allowing for more efficient big data analyses.</p>
    <p>Machine learning techniques, particularly tree-based ensemble classifiers consisting of multiple decision trees, have greatly improved data processing capabilities in recent years. The eXtreme Gradient Boosting (XGBoost) (<xref rid="btae192-B4" ref-type="bibr">Chen and Guestrin 2016</xref>) is a state-of-the-art ensemble machine learning algorithm known for its scalability and effectiveness in classification and regression problems. “Boosting” is an effective and widely used model training algorithm that can continuously improve and integrate classifiers to create a more accurate classifier. XGBoost uses additive models and forward distribution algorithms to form an ensemble tree with multiple classification and regression tree-based learners, and then scores multiple trees based on the “higher score wins” principle to achieve target value prediction. XGBoost has the advantages of fast parallel processing, high performance, scalability to big data, and the ability to handle sparse training data. XGBoost has been applied to various biomedical fields, such as gene-gene interactions (<xref rid="btae192-B8" ref-type="bibr">Guo <italic toggle="yes">et al.</italic> 2021</xref>), diabetes detection (<xref rid="btae192-B14" ref-type="bibr">Paleczek <italic toggle="yes">et al.</italic> 2021</xref>), and prediction of COVID-19 vaccine administration priorities (<xref rid="btae192-B18" ref-type="bibr">Romeo and Frontoni 2022</xref>), yet, XGBoost has not been explored to detect uncharacterized or emerging viruses from human sequence data.</p>
    <p>One of the unique challenges in predicting viral sequences in HTS data is the presence of &gt;600 000 endogenous retrovirus (ERV) sequences, comprising 8% of the human genome. ERVs resulted from the fixation of ancient retroviral infections and integrations into the human genome. Thus, although functionally distinct, ERVs share high sequence similarities with exogenous infectious viruses, particularly retro-transcribing viruses and other single-stranded RNA viruses. However, ERVs are not considered in infectious viral sequence prediction, which may be problematic. In this study, we introduce a novel XGBoost framework, leveraging our in-house viral genome database, to predict viral-related sequences, including ERVs, in patient’s unmappable sequences.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Datasets and preprocessing</title>
      <p>To develop the three-class virus prediction XGBoost model (i.e. to classify among infectious virus, human ERV, and non-ERV human sequences), we first curated the infectious viral sequences based on two databases: our in-house viral reference genome database (<xref rid="btae192-B5" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2019</xref>) containing 377 009 unique sequences with a minimum length of 100 base pair (bp) and the NCBI Viral Genomes database containing 13 273 complete genome sequences. Combining the two databases led to a total of 390 282 viral sequences utilized in this study. We then extracted ERV sequences from the human genome reference GRCh38.p13 using bedtools <italic toggle="yes">getfasta</italic> function and kept 614 316 ERV sequences with a minimum length of 100 bp. Our non-ERV human sequences were compiled from two sources: the human GRCh38.p13 reference genome after we masked all ERV sequences using bedtools <italic toggle="yes">maskfasta</italic> function (mitochondrial sequences included), and the NCBI Consensus Coding Sequence database containing 33 408 sequences with a minimum length of 100 bp. To develop the six-class subgroup prediction XGBoost model (i.e. to classify among six virus taxonomy subgroups), we utilized the 377 009 partial and whole genomes from our in-house viral genome database, each having been annotated according to the Baltimore classification, i.e. double-strand DNA (dsDNA), single-strand DNA (ssDNA), retro-transcribing (Retro), negative-sense single strand RNA [ssRNA (−)], positive-sense single strand RNA [ssRNA (+)], and double-strand RNA (dsRNA). All sequence data are stored in FASTA format in our pipeline.</p>
      <p>To satisfy our model requirements, we performed three data preprocessing procedures. First, we only retained sequences with lengths ≥100 bp, which was necessary for feature extraction, also in part because most Illumina HTS read lengths are ≥100 bp. Second, we filtered out sequences with ambiguous nucleotides “N”. Third, to train our models for classifying various sequence lengths, particularly assembled contigs, we created additional training datasets by randomly cutting our training datasets (i.e. 95% of the total datasets) by 10 different length gradients (i.e. 100, 150, 200, 300, 500, 700, 1000, 1500, 2000, and 3000 bp), which cover the sequence lengths of, for instance, Illumina short read sequencing (150–350 bp), Sanger sequencing (850–950 bp), and assembled contigs (we examined sequences of 2000–5000 bp, but not longer, because our results have already shown very high accuracies when sequences were &gt;1000 bp). To balance the number of sequences among all the examined groups, we controlled the amounts of the sequences from the length gradients and then merged them with the original sequences. After the preprocessing, for our three-class virus prediction model, we obtained 1 489 300 viral, 1 515 342 ERV, and 1 578 686 non-ERV sequences, with 8838 sequences for testing and the rest for model training (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>); and for our six-class subgroup prediction model, we obtained a total of 1 153 837 viral sequences, with 8387 sequences for testing and the rest for training (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
    </sec>
    <sec>
      <title>2.2 XGBoost classification models</title>
      <p>Using our preprocessed training datasets, we developed XGBoost-based classification models, which showed the best performance compared to other machine learning algorithms (described below). Our trained XGBoost models have three distinct functions; first, the training sequences are transformed into numerical vectors, and a total of 237 informative features of the sequences are extracted via the K-tuple relative abundance and recoding system; second, our virus prediction model classifies each testing sequence into one of the three groups (infectious virus, ERV or non-ERV human); third, our subgroup prediction model then further classifies each viral sequence into one of six taxonomy subgroups. <xref rid="btae192-F1" ref-type="fig">Figure 1</xref> depicts the flowchart of our method and software package (VirusPredictor). The following paragraphs illustrate the development process of the models and software.</p>
      <fig position="float" id="btae192-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Flowchart of VirusPredictor sequence prediction pipeline. <italic toggle="yes">N</italic> is the number of input sequences.</p>
        </caption>
        <graphic xlink:href="btae192f1" position="float"/>
      </fig>
      <sec>
        <title>2.2.1 Sequence feature extraction</title>
        <p>To extract informative numerical features from the training sequences, we first transformed each DNA sequence into a numerical sequence using the alignment-free K-tuple (<xref rid="btae192-B13" ref-type="bibr">Ning <italic toggle="yes">et al.</italic> 2001</xref>) and recoding system (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1.1</xref>). We extracted 237 informative features using relative abundance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1.2 formulas S2</xref> and <xref rid="sup1" ref-type="supplementary-material">S3</xref>) and DNA spectral analyses (<xref rid="btae192-B10" ref-type="bibr">Kwan <italic toggle="yes">et al.</italic> 2012</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref> illustrates our sequence transform and feature extraction strategy. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref> depicts the hierarchical structure of methods for our feature extraction procedures. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref> summarizes the specific methods used in the recoding system.</p>
      </sec>
      <sec>
        <title>2.2.2 Selections of machine learning algorithms and features</title>
        <p>To determine the best machine learning algorithm, we developed multiple classification models using four different algorithms, including random forest, K nearest neighbor, support vector machine, and XGBoost. We then compared the performance among the four algorithms using the same training and testing files, and comparable procedures (e.g. tuning hyperparameters for the optimal performance). To determine the minimum number of informative features, we implemented feature engineering procedures followed by comparing the performance of various numbers of features, i.e. we computed an importance score for each feature using random forest (<xref rid="btae192-B24" ref-type="bibr">Yu <italic toggle="yes">et al.</italic> 2021</xref>), and then selected the top 20, 50, 100 important features and compared their prediction performance with when all features were used. The procedures are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1.3.</xref></p>
      </sec>
      <sec>
        <title>2.2.3 Summary of our two-step XGBoost models</title>
        <p>Our XGBoost models contain two steps: three-class virus prediction followed by six-class subgroup prediction. The details of our XGBoost models are described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.2.1 and S1.2.2.</xref> In our virus prediction model, our testing data included three length gradients, including 2938 sequences of 150–350 bp (Illumina short reads), 2937 sequences of 850–950 bp (Sanger sequencing), and 2963 sequences of 2000–5000 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). In our subgroup prediction model, the testing data also contained three length gradients, including 2792 sequences of 150–350 bp, 2711 sequences of 850–950 bp, and 2884 sequences of 2000–5000 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). All necessary data preprocessing procedures, e.g. normalization of training and testing data, have been considered in our analyses (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.2.3</xref> for details).</p>
      </sec>
      <sec>
        <title>2.2.4 Model performance assessment</title>
        <p>Our two-step prediction models from each of the four machine learning algorithms can be considered as a collection of multiple binary classifications. To assess the performance of each trained model, we adopted the macro average of binary metrics, including macro average accuracy, recall, precision, and F1-score (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.3</xref>), which provides equal weight to these binary classes (<xref rid="btae192-B20" ref-type="bibr">Sokolova and Lapalme 2009</xref>).</p>
      </sec>
      <sec>
        <title>2.2.5 VirusPredictor software development</title>
        <p>To implement our two-step XGBoost models, we developed a new software package named VirusPredictor. The software first transforms query sequences into a feature matrix where 23 different methods are utilized to generate a total of 237 features for each input sequence. Then, our trained virus prediction model classifies sequences among infectious virus, ERV, and non-ERV human groups. Our trained subgroup prediction model further classifies each predicted viral sequence into subgroups. Users can modify the algorithms and/or parameters for advanced analyses. VirusPredictor is written in Python and is open-source and freely available (<ext-link xlink:href="http://www.dllab.org/software/VirusPredictor.html" ext-link-type="uri">www.dllab.org/software/VirusPredictor.html</ext-link>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Machine learning algorithms and features</title>
      <p>A total of 237 numerical features were extracted for each training sequence regardless of its original length. We sorted the 237 features according to their relative importance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>). We compared the performance to predict infectious virus, ERV, and non-ERV human sequences among the four algorithms, including random forest, K nearest neighbor, support vector machine, and XGBoost, as well as different numbers of features using 302 169 sequences, a subset randomly selected from our whole sequence data, with 15 108 sequences used for testing and the remaining for model training. Our results showed that the models achieved higher accuracy and F1-scores when more features were included; and XGBoost outperformed almost all the other machine learning algorithms with the highest accuracies using identical data and procedures. Among all the combinations, XGBoost with all 237 features resulted in the best performance, i.e. 0.904 macro average accuracy and 0.904 F1-score (<xref rid="btae192-F2" ref-type="fig">Fig. 2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). Therefore, we then utilized our whole sequence database to train the two-step XGBoost models using the entire 237 features.</p>
      <fig position="float" id="btae192-F2">
        <label>Figure 2.</label>
        <caption>
          <p>Performance comparisons of four machine learning algorithms and different features. Macro average accuracy, F1-score, precision, and recall are shown.</p>
        </caption>
        <graphic xlink:href="btae192f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Three-class XGBoost model to identify viral-related sequences</title>
      <p>Our three-class virus prediction XGBoost model performance metrics increased as the lengths of the testing sequences increased. The macro average accuracies were 0.76 and 0.93 when the testing sequences were 150–350 bp and 850–950 bp, respectively. When the testing sequences were 2000–5000 bp (e.g. assembled long contigs), the prediction accuracies further increased with average accuracy 0.978, recall 0.968, precision 0.967, and F1-score 0.967 (<xref rid="btae192-F3" ref-type="fig">Fig. 3A</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). The pair-wise confusion matrix and model performance metrics of the virus prediction XGBoost model are shown in <xref rid="btae192-F4" ref-type="fig">Fig. 4A</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>.</p>
      <fig position="float" id="btae192-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Performance of (A) our three-class virus prediction and (B) six-class subgroup prediction XGBoost models. The sequence lengths 150–350 and 850–950 bp represent the typical ranges of Illumina short reads and Sanger sequencing data, respectively. Macro average accuracy, F1-score, precision, and recall are shown.</p>
        </caption>
        <graphic xlink:href="btae192f3" position="float"/>
      </fig>
      <fig position="float" id="btae192-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Heatmaps of pair-wise confusion matrix of (A) our virus prediction and (B) subgroup prediction XGBoost models. The value in each cell is the ratio of predicted number divided by the total number of testing sequences of each row (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S7 and S9</xref>). The cells on the diagonal represent correct predictions.</p>
        </caption>
        <graphic xlink:href="btae192f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Six-class XGBoost model to predict virus taxonomic subgroups</title>
      <p>To classify each identified viral sequence into one of the six virus taxonomic subgroups, we further trained a six-class XGBoost classifier using our in-house viral database. After hyperparameter tuning, the trained model showed high accuracies in classifying among the six subgroups, i.e. dsDNA, ssDNA, Retro, ssRNA(−), ssRNA(+), and dsRNA. When the testing sequences were 150–350 bp, the macro average accuracy and F1-score were 0.919 and 0.727, respectively. When the testing sequences were 850–950 bp and 2000–5000 bp, the accuracy and F1-score reached &gt; 0.98. Considering that each of the six classes only has ∼0.16 probability of being correctly classified at random, our model has high performance in predicting viral subgroups (<xref rid="btae192-F3" ref-type="fig">Fig. 3B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S8</xref>). The pair-wise confusion matrix of the subgroup prediction model is shown in <xref rid="btae192-F4" ref-type="fig">Fig. 4B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S9</xref>. The optimal hyperparameter combinations used in our models are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S10</xref>.</p>
    </sec>
    <sec>
      <title>3.4 Applications of VirusPredictor software</title>
      <p>We developed a novel Python software, VirusPredictor, to implement our two-step XGBoost models. We then applied VirusPredictor to five publicly available real viral sequence datasets and obtained high prediction accuracies. For example, a study (<xref rid="btae192-B9" ref-type="bibr">Kowarsky <italic toggle="yes">et al.</italic> 2017</xref>) identified 3761 contigs, validated by polymerase chain reactions, of uncharacterized microbes colonized in human circulating cell-free DNA. We used VirusPredictor to predict these contigs (average length 2595 bp with minimum 1000 bp and maximum 105 439 bp). Our results showed that 3747 of the 3761 contigs were predicted as viral sequences, suggesting 0.996 accuracy. We then added 4000 ERV and 4000 non-ERV human sequences randomly selected from the whole human genome (i.e. the entire ERV and non-ERV human sequences, respectively), and repeated the prediction. We obtained 0.967–0.996 sensitivity, 0.981–0.997 specificity, 0.965–0.993 precision, 0.003–0.019 false positive rates, and 0.986–0.997 accuracies to predict among virus, ERV, and non-ERV human sequences (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S11</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5A</xref>).</p>
      <fig position="float" id="btae192-F5">
        <label>Figure 5.</label>
        <caption>
          <p>Heatmaps of pair-wise confusion matrix of our virus prediction XGBoost model to predict (A) 3761 viral contigs, (B1–B3) SARS-CoV-2 sequences, (C) Illumina 300 bp short reads from human metagenomic data, (D1–D5) phage sequences, and (E1–E5) DNA viruses from human gut microbiome. The value in each cell is ratio of predicted number divided by total number of testing sequences of each row (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S11, S13–S16</xref>). The cells on the diagonal represent correct predictions.</p>
        </caption>
        <graphic xlink:href="btae192f5" position="float"/>
      </fig>
      <p>In our second application, we used VirusPredictor to predict the severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) genome (NC_045512.2; 29 903 bp). When the whole SARS-CoV-2 genome sequence was used as input, VirusPredictor predicted it to be of viral origin, and then accurately classified it as a ssRNA(+) virus. To challenge VirusPredictor, we randomly extracted 300 continuous fragments from the SARS-CoV-2 genome with three length gradients (150–350, 850–950, and 2000–5000 bp), and then used VirusPredictor to predict each of the 300 fragments. The results showed that when the SARS-CoV-2 fragments were 150–350 bp, 69% of the fragments were predicted as being a virus, while the other 31% were classified as ERVs, which admittedly share high sequence similarities with various infectious viral genomes, including the SARS-CoV-2 genome; and 80% of the viral sequences were further predicted as ssRNA(+) (the random rate is 16.7%). When the fragments were 850–950 bp, 97% were predicted as viral sequences; and 88% of the viral sequences were further predicted as ssRNA(+). When the fragments were 2000–5000 bp, 100% were predicted as virus; and 96% were further predicted as ssRNA(+) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S12</xref>). We then added 300 ERV and 300 non-ERV human sequences randomly selected from the whole genome and repeated the prediction for each length group. We obtained 0.9–1 sensitivity, 0.935–1 specificity, 0.881–1 precision, 0–0.065 false positive rates, and 0.943–1 accuracies to predict among virus, ERV, and non-ERV human when the sequence lengths were &gt;850 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S13</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5B</xref>).</p>
      <p>In our third application, we applied VirusPredictor to directly predict the 5551 Illumina short reads (300 bp) of potential viral sequences from 19 metagenomic datasets (<xref rid="btae192-B22" ref-type="bibr">Tampuu <italic toggle="yes">et al.</italic> 2019</xref>) after we randomly checked by BLAST that the vast majority of these reads map to viruses. Our results showed that 83.3% of these short reads were predicted as virus. We then added 5600 ERV and 5600 non-ERV human sequences (300 bp) randomly selected from the whole genome and repeated the prediction. We obtained 0.806–0.833 sensitivity, 0.819–0.957 specificity, 0.694–0.906 precision, 0.043–0.18 false positive rates, and 0.818–0.916 accuracies to predict among virus, ERV, and non-ERV human (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S14</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5C</xref>).</p>
      <p>In our fourth application, we applied VirusPredictor to predict the viruses (mostly phages) used in an existing study (<xref rid="btae192-B17" ref-type="bibr">Ren <italic toggle="yes">et al.</italic> 2020</xref>). After downloading the complete genomes (mean = 70 865 bp with min = 4184 and max = 348 113) from the NCBI viral genome database and removing sequences containing missing nucleotides, we used VirusPredictor to predict the cleaned 674 genomes. All of them were classified to be viruses. We then randomly fragmented these 674 genomes into 5000 sequences with five lengths (i.e. 150, 300, 500, 1000, and 3000 bp, the same lengths as in the Ren <italic toggle="yes">et al.</italic> paper), and further added the same numbers of our ERV and non-ERV human sequences randomly selected from the whole genome. Our results showed 0.815–1 sensitivity, 0.897–1 specificity, 0.801–0.999 precision, 0.001–0.103 false positive rates, and 0.874–1 accuracies to predict among virus, ERV, and non-ERV human when the sequence lengths were &gt;300 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S15</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5D</xref>).</p>
      <p>A study (<xref rid="btae192-B12" ref-type="bibr">Nayfach <italic toggle="yes">et al.</italic> 2021</xref>) released the genome sequences of 189 680 under-represented DNA viruses (98% were dsDNA viruses) from the human gut microbiome. We randomly selected from these viral genomes and fragmented them into 20 000 sequences with various lengths (i.e. 150–350, 850–950, 2000–5000, 10 000–30 000, and 30 000–100 000 bp), and applied VirusPredictor. Our results showed that &gt;99% were predicted as virus, and 81%–98.6% were further predicted into subgroups correctly when the sequence lengths were &gt;850 bp. We then added the same numbers of randomly selected ERV and non-ERV human sequences and repeated the prediction for each length group. We obtained 0.853–1 sensitivity, 0.923–1 specificity, 0.863–1 precision, 0–0.077 false positive rates, and 0.939–1 accuracies to predict among virus, ERV, and non-ERV human when the sequence lengths were &gt;850 bp (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S16</xref> and <xref rid="btae192-F5" ref-type="fig">Fig. 5E</xref>). Our study is the first of its kind classifying ERVs in viral sequence prediction. Our study is also the first to combine virus subgroup predictions.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Many human diseases, including ME/CFS and some virus-associated cancers (<xref rid="btae192-B3" ref-type="bibr">Cao and Li 2018</xref>), have long been suspected to originate from viral infections, yet the identification of causative pathogens has remained difficult. Discovering viral sequences in these patients’ HTS data has been challenging, particularly for uncharacterized viruses without reference genomes. However, this is a worthwhile endeavor because unmapped sequences from patient HTS data may contain DNA/RNA derived from disease causative pathogens. In this study, we developed a fast and accurate XGBoost-based sequence screening method with user-friendly software to predict infectious viruses from human sequence data derived from long/short read genomic, transcriptomic, and metagenomic sequencing or Sanger sequencing. VirusPredictor is useful specifically for predicting the origins of sequences that cannot be aligned to existing reference genomes of species of interest. VirusPredictor can discover sequences derived from uncharacterized infectious viruses and endogenous retroviruses (for which no actual reference genomes exist), and other viral sequences that are not identifiable by alignment. We demonstrated that our XGBoost models outperformed the other machine learning algorithms (<xref rid="btae192-F2" ref-type="fig">Fig. 2</xref>). Adding to user convenience, VirusPredictor accepts assembled contigs and long/short read sequences in either FASTQ or FASTA format. Since the prediction accuracies increase as the testing sequences become longer (<xref rid="btae192-F3" ref-type="fig">Fig. 3</xref>), we suggest assembling short reads into contigs, e.g. ∼1000 bp (at least ∼800 bp) or longer sequences, whenever possible before predictions.</p>
    <p>Our method has several advantages. We manually built the largest viral reference genome database and utilized it as training data in this study. We implemented a wide range of feature engineering for DNA sequences by leveraging biophysically meaningful methods, e.g. k-tuple, GC content, relative ambiguity, and genomic signal processing (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1 and S2</xref>, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). Thus, compared to black boxes in deep learning models, an advantage of our models is their interpretability, i.e. while obtaining high efficiency, our models can identify the key features for classifying groups (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>), providing better understanding of the connections from features to predictions. Our XGBoost models are not affected by multicollinearity. Since XGBoost is based on decision trees, if two or more features are correlated, our method calculates information gain for all the features to select the optimal segmentation feature when deciding upon a splitting tree. Thus, our models are more robust than traditional multi-linear regression when handling multicollinearity. XGBoost can also prevent overfitting while improving accuracy and computational speed through multiple mechanisms (e.g. adding regular terms to objective functions, using one- and second-order Taylor expansions, adopting novel sparsity-aware algorithm, and supporting parallelism algorithm) (<xref rid="btae192-B4" ref-type="bibr">Chen and Guestrin 2016</xref>). Our method can be easily broadened to classify other species (e.g. bacteria, fungi, and plants), and to investigate the global diversity of species.</p>
    <p>However, we have also recognized the limitations of this study. First, almost all machine learning algorithms cannot handle missing data with satisfactory accuracy. In this study, our software automatically checks data quality, discards sequences with missing nucleotides, and generates missing nucleotide warnings to users. Users can choose to manually remove all missing nucleotides or cut sequences into fragments at missing nucleotide junctions and use the cleaned fragments for predictions. In the latter option, as each fragment will obtain its own classification label, the final prediction can be determined by the majority of votes. Second, while it is known that the use of larger training data will lead to better predictions, the limitations of currently available CPU/GPU power led to only a fraction (∼8.9%) of the (non-ERV) human genome being used in our model training process. We anticipate these limitations can be addressed with ongoing advancements in computational resources and collaborative efforts (we made all our source code publicly available). Our software’s prediction accuracies can further increase when more powerful computers become available, allowing for using the complete human genome or a larger portion of it for training. Third, in our virus prediction model, when the testing sequences are 150–350 bp, certain non-ERV human sequences are predicted as ERVs. This reflects the fact that many <italic toggle="yes">individual</italic> ERVs have not yet been identified or annotated in the human genome, i.e. some sequences currently known as “non-ERV” are likely ERVs. In a separate study, our group is identifying individual transposable element sequences (unpublished). Our future plans involve incorporating new transposable element sequences into our models and additional algorithms (<xref rid="btae192-B16" ref-type="bibr">Ren <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btae192-B22" ref-type="bibr">Tampuu <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae192-B17" ref-type="bibr">Ren <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae192-B1" ref-type="bibr">Alshayeji <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btae192-B7" ref-type="bibr">Elbasir <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btae192-B15" ref-type="bibr">Rajkumar <italic toggle="yes">et al.</italic> 2022</xref>) to enhance the predictive power of VirusPredictor. Despite the lack of annotated full ERV sequences, when the testing sequences are &gt;850 bp, the prediction accuracies of our software increased to &gt;90% for all scenarios.</p>
    <p>In summary, we developed and demonstrated a novel XGBoost-based method with user-friendly software, VirusPredictor. It is capable of efficiently screening patients’ unmappable sequence data, preferably assembled contigs or sequences longer than 1000 bp, to identify potential viral-related sequences that can then be verified experimentally. This tool is especially valuable for studying suspected viral associations or causalities in diseases with unclear etiologies. By including ERVs, this research marks a pioneering step in infectious viral sequence prediction, opening avenues for further exploration and discovery.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae192_Supplementary_Data</label>
      <media xlink:href="btae192_supplementary_data.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Michael Mariani, Arvis Sulovari, Jason Kost, Dominic Obraitis, and Synanth Texocaelum for their contributions, discussions, and/or critiques of the analysis or manuscript. We thank the anonymous reviewers for their constructive comments and suggestions.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was partially supported by Start-up Funds [to D.L.], and the research grants [to D.L.] from National Institutes of Health, National Institute of Allergy and Infectious Diseases [AI147084 and AI159710], Solve ME/CFS Initiative Ramsay Research Grant Program, Open Medicine Foundation, and Department of Defense Lung Cancer Research Program [LC190467].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data and software availability</title>
    <p>URLs for data presented herein are as follows:</p>
    <p>NCBI Human Genome Resources: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/projects/genome/guide/human" ext-link-type="uri">www.ncbi.nlm.nih.gov/projects/genome/guide/human</ext-link></p>
    <p>Human genome reference GRCh38.p13: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/assembly/GCF_000001405.39" ext-link-type="uri">www.ncbi.nlm.nih.gov/assembly/GCF_000001405.39</ext-link></p>
    <p>Transposable element annotation hg38_rmsk_TE.gtf.gz: <ext-link xlink:href="http://hammelllab.labsites.cshl.edu/software" ext-link-type="uri">http://hammelllab.labsites.cshl.edu/software</ext-link></p>
    <p>NCBI Consensus Coding Sequence database: <ext-link xlink:href="https://ftp.ncbi.nlm.nih.gov/pub/CCDS" ext-link-type="uri">https://ftp.ncbi.nlm.nih.gov/pub/CCDS</ext-link></p>
    <p>NCBI Viral Genomes: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/genome/viruses" ext-link-type="uri">www.ncbi.nlm.nih.gov/genome/viruses</ext-link></p>
    <p>NCBI Viral Genomes database: <ext-link xlink:href="https://ftp.ncbi.nlm.nih.gov/refseq/release/viral" ext-link-type="uri">https://ftp.ncbi.nlm.nih.gov/refseq/release/viral</ext-link></p>
    <p>International Committee on Taxonomy of Viruses: <ext-link xlink:href="https://talk.ictvonline.org/ictvreports/ictv_online_report" ext-link-type="uri">https://talk.ictvonline.org/ictvreports/ictv_online_report</ext-link></p>
    <p>Baltimore classification: <ext-link xlink:href="http://viralzone.expasy.org/254" ext-link-type="uri">http://viralzone.expasy.org/254</ext-link></p>
    <p>bedtools/getfasta: <ext-link xlink:href="https://bedtools.readthedocs.io/en/latest/content/tools/getfasta.html" ext-link-type="uri">https://bedtools.readthedocs.io/en/latest/content/tools/getfasta.html</ext-link></p>
    <p>VirusPredictor Python package: <ext-link xlink:href="https://www.dllab.org/software/VirusPredictor.html" ext-link-type="uri">www.dllab.org/software/VirusPredictor.html</ext-link></p>
    <p>VirusPredictor transposable element-masked human genome reference GRCh38.p13: <ext-link xlink:href="https://www.dllab.org/software/VirusPredictor/hg38_rmsk_ERV.fa" ext-link-type="uri">www.dllab.org/software/VirusPredictor/hg38_rmsk_ERV.fa</ext-link></p>
    <p>VirusPredictor endogenous retrovirus training data (minimum length = 100 bp): <ext-link xlink:href="https://www.dllab.org/software/VirusPredictor/hg38_ERV_100bp.fa" ext-link-type="uri">www.dllab.org/software/VirusPredictor/hg38_ERV_100bp.fa</ext-link></p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae192-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alshayeji</surname><given-names>MH</given-names></string-name>, <string-name><surname>Sindhu</surname><given-names>SC</given-names></string-name>, <string-name><surname>Abed</surname><given-names>S.</given-names></string-name></person-group><article-title>Viral genome prediction from raw human DNA sequence samples by combining natural language processing and machine learning techniques</article-title>. <source>Expert Syst Appl</source><year>2023</year>;<volume>218</volume>:<fpage>119641</fpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Borozan</surname><given-names>I</given-names></string-name>, <string-name><surname>Watt</surname><given-names>S</given-names></string-name>, <string-name><surname>Ferretti</surname><given-names>V.</given-names></string-name></person-group><article-title>Integrating alignment-based and alignment-free sequence similarity measures for biological sequence classification</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>1396</fpage>–<lpage>404</lpage>.<pub-id pub-id-type="pmid">25573913</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>D.</given-names></string-name></person-group><article-title>Searching for human oncoviruses: histories, challenges, and opportunities</article-title>. <source>J Cell Biochem</source><year>2018</year>;<volume>119</volume>:<fpage>4897</fpage>–<lpage>906</lpage>.<pub-id pub-id-type="pmid">29377246</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>T</given-names></string-name>, <string-name><surname>Guestrin</surname><given-names>C.</given-names></string-name></person-group> XGBoost: a scalable tree boosting system. In: <italic toggle="yes">Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</italic>. San Francisco, CA, USA: Association for Computing Machinery. <year>2016</year>. <fpage>785</fpage>–<lpage>94</lpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Kost</surname><given-names>J</given-names></string-name>, <string-name><surname>Sulovari</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>A virome-wide clonal integration analysis platform for discovering cancer viral etiology</article-title>. <source>Genome Res</source><year>2019</year>;<volume>29</volume>:<fpage>819</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">30872350</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>D.</given-names></string-name></person-group><article-title>Sequencing facility and DNA source associated patterns of virus-mappable reads in whole-genome sequencing data</article-title>. <source>Genomics</source><year>2021</year>;<volume>113</volume>:<fpage>1189</fpage>–<lpage>98</lpage>.<pub-id pub-id-type="pmid">33301893</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elbasir</surname><given-names>A</given-names></string-name>, <string-name><surname>Ye</surname><given-names>Y</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>DE</given-names></string-name></person-group><etal>et al</etal><article-title>A deep learning approach reveals unexplored landscape of viral expression in cancer</article-title>. <source>Nat Commun</source><year>2023</year>;<volume>14</volume>:<fpage>785</fpage>.<pub-id pub-id-type="pmid">36774364</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wu</surname><given-names>C</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Gene-based testing of interactions using XGBoost in genome-wide association studies</article-title>. <source>Front Cell Dev Biol</source><year>2021</year>;<volume>9</volume>:<fpage>801113</fpage>.<pub-id pub-id-type="pmid">34977040</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kowarsky</surname><given-names>M</given-names></string-name>, <string-name><surname>Camunas-Soler</surname><given-names>J</given-names></string-name>, <string-name><surname>Kertesz</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Numerous uncharacterized and highly divergent microbes which colonize humans are revealed by circulating cell-free DNA</article-title>. <source>Proc Natl Acad Sci USA</source><year>2017</year>;<volume>114</volume>:<fpage>9623</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">28830999</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kwan</surname><given-names>HK</given-names></string-name>, <string-name><surname>Kwan</surname><given-names>BY</given-names></string-name>, <string-name><surname>Kwan</surname><given-names>JY.</given-names></string-name></person-group><article-title>Novel methodologies for spectral classification of exon and intron sequences</article-title>. <source>EURASIP J Adv Signal Process</source><year>2012</year>;<volume>2012</volume>:<fpage>1</fpage>–<lpage>14</lpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leimeister</surname><given-names>C-A</given-names></string-name>, <string-name><surname>Boden</surname><given-names>M</given-names></string-name>, <string-name><surname>Horwege</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Fast alignment-free sequence comparison using spaced-word frequencies</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>30</volume>:<fpage>1991</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24700317</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nayfach</surname><given-names>S</given-names></string-name>, <string-name><surname>Páez-Espino</surname><given-names>D</given-names></string-name>, <string-name><surname>Call</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Metagenomic compendium of 189,680 DNA viruses from the human gut microbiome</article-title>. <source>Nat Microbiol</source><year>2021</year>;<volume>6</volume>:<fpage>960</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">34168315</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ning</surname><given-names>Z</given-names></string-name>, <string-name><surname>Cox</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Mullikin</surname><given-names>JC.</given-names></string-name></person-group><article-title>SSAHA: a fast search method for large DNA databases</article-title>. <source>Genome Res</source><year>2001</year>;<volume>11</volume>:<fpage>1725</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">11591649</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paleczek</surname><given-names>A</given-names></string-name>, <string-name><surname>Grochala</surname><given-names>D</given-names></string-name>, <string-name><surname>Rydosz</surname><given-names>A.</given-names></string-name></person-group><article-title>Artificial breath classification using XGBoost algorithm for diabetes detection</article-title>. <source>Sensors (Basel)</source><year>2021</year>;<volume>21</volume>:<fpage>4187</fpage>.<pub-id pub-id-type="pmid">34207196</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Rajkumar</surname><given-names>U</given-names></string-name></person-group><etal>et al</etal> DeepViFi: detecting oncoviral infections in cancer genomes using transformers. In: <italic toggle="yes">Proceedings of the 13th ACM International Conference on Bioinformatics, Computational Biology and Health Informatics</italic>. Northbrook, IL: Association for Computing Machinery. <year>2022</year>. Article 2.</mixed-citation>
    </ref>
    <ref id="btae192-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>J</given-names></string-name>, <string-name><surname>Ahlgren</surname><given-names>NA</given-names></string-name>, <string-name><surname>Lu</surname><given-names>YY</given-names></string-name></person-group><etal>et al</etal><article-title>VirFinder: a novel k-mer based tool for identifying viral sequences from assembled metagenomic data</article-title>. <source>Microbiome</source><year>2017</year>;<volume>5</volume>:<fpage>69</fpage>.<pub-id pub-id-type="pmid">28683828</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ren</surname><given-names>J</given-names></string-name>, <string-name><surname>Song</surname><given-names>K</given-names></string-name>, <string-name><surname>Deng</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Identifying viruses from metagenomic data using deep learning</article-title>. <source>Quant Biol</source><year>2020</year>;<volume>8</volume>:<fpage>64</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">34084563</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Romeo</surname><given-names>L</given-names></string-name>, <string-name><surname>Frontoni</surname><given-names>E.</given-names></string-name></person-group><article-title>A unified hierarchical XGBoost model for classifying priorities for COVID-19 vaccination campaign</article-title>. <source>Pattern Recognit</source><year>2022</year>;<volume>121</volume>:<fpage>108197</fpage>.<pub-id pub-id-type="pmid">34312570</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roux</surname><given-names>S</given-names></string-name>, <string-name><surname>Faubladier</surname><given-names>M</given-names></string-name>, <string-name><surname>Mahul</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Metavir: a web server dedicated to virome analysis</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>3074</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">21911332</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sokolova</surname><given-names>M</given-names></string-name>, <string-name><surname>Lapalme</surname><given-names>G.</given-names></string-name></person-group><article-title>A systematic analysis of performance measures for classification tasks</article-title>. <source>Inf Process Manag</source><year>2009</year>;<volume>45</volume>:<fpage>427</fpage>–<lpage>37</lpage>.</mixed-citation>
    </ref>
    <ref id="btae192-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>K</given-names></string-name>, <string-name><surname>Ren</surname><given-names>J</given-names></string-name>, <string-name><surname>Reinert</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>New developments of alignment-free sequence comparison: measures, statistics and next-generation sequencing</article-title>. <source>Brief Bioinform</source><year>2014</year>;<volume>15</volume>:<fpage>343</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">24064230</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tampuu</surname><given-names>A</given-names></string-name>, <string-name><surname>Bzhalava</surname><given-names>Z</given-names></string-name>, <string-name><surname>Dillner</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>ViraMiner: deep learning on raw DNA sequences for identifying viral genomes in human samples</article-title>. <source>PLoS One</source><year>2019</year>;<volume>14</volume>:<fpage>e0222271</fpage>.<pub-id pub-id-type="pmid">31509583</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vinga</surname><given-names>S</given-names></string-name>, <string-name><surname>Almeida</surname><given-names>J.</given-names></string-name></person-group><article-title>Alignment-free sequence comparison-a review</article-title>. <source>Bioinformatics</source><year>2003</year>;<volume>19</volume>:<fpage>513</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">12611807</pub-id></mixed-citation>
    </ref>
    <ref id="btae192-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>F</given-names></string-name>, <string-name><surname>Wei</surname><given-names>C</given-names></string-name>, <string-name><surname>Deng</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Deep exploration of random Forest model boosts the interpretability of machine learning studies of complicated immune responses and lung burden of nanoparticles</article-title>. <source>Sci Adv</source><year>2021</year>;<volume>7</volume>:<fpage>eabf4130</fpage>.<pub-id pub-id-type="pmid">34039604</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
