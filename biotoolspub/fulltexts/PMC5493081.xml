<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5493081</article-id>
    <article-id pub-id-type="publisher-id">1735</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-017-1735-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>BioNanoAnalyst: a visualisation tool to assess genome assembly quality using BioNano data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yuan</surname>
          <given-names>Yuxuan</given-names>
        </name>
        <address>
          <email>yuxuan.yuan@research.uwa.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bayer</surname>
          <given-names>Philipp E.</given-names>
        </name>
        <address>
          <email>philipp.bayer@uwa.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Scheben</surname>
          <given-names>Armin</given-names>
        </name>
        <address>
          <email>armin.scheben@research.uwa.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chan</surname>
          <given-names>Chon-Kit Kenneth</given-names>
        </name>
        <address>
          <email>kenneth.chan@uwa.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Edwards</surname>
          <given-names>David</given-names>
        </name>
        <address>
          <email>dave.edwards@uwa.edu.au</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7910</institution-id><institution-id institution-id-type="GRID">grid.1012.2</institution-id><institution>School of Biological Sciences, </institution><institution>the University of Western Australia, </institution></institution-wrap>Perth, WA Australia </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>323</elocation-id>
    <history>
      <date date-type="received">
        <day>8</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>6</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Reference genome assemblies are valuable, as they provide insights into gene content, genetic evolution and domestication. The higher the quality of a reference genome assembly the more accurate the downstream analysis will be. During the last few years, major efforts have been made towards improving the quality of genome assemblies. However, erroneous and incomplete assemblies are still common. Complementary to DNA sequencing technologies, optical mapping has advanced genomic studies by facilitating the production of genome scaffolds and assessing structural variation. However, there are few tools available to comprehensively examine misassemblies in reference genome sequences using optical map data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present BioNanoAnalyst, a software package to examine genome assemblies based on restriction endonuclease cut sites and optical map data. A graphical user interface (GUI) allows users to assess reference genome sequences on different computer platforms without the requirement of programming knowledge. The zoom function makes visualisation convenient, while a GFF3 format output file gives an option to directly visualise questionable assembly regions by location and nucleotides following import into a local genome browser.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">BioNanoAnalyst is a tool to identify misassemblies in a reference genome sequence using optical map data. With the reported information, users can rapidly identify assembly errors and correct them using other software tools, which could facilitate an accurate downstream analysis.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-017-1735-4) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>BioNano</kwd>
      <kwd>Misassembly</kwd>
      <kwd>Restriction enzyme cut site</kwd>
      <kwd>Optical map</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000923</institution-id>
            <institution>Australian Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>LP140100537</award-id>
        <award-id>LP130100925</award-id>
        <principal-award-recipient>
          <name>
            <surname>Edwards</surname>
            <given-names>David</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par13">Reference genome assembly plays an important role in genomic studies, as it supports the analysis of genetic diversity, genome evolution and the genetic basis of heritable phenotypes. Since the advent of second generation sequencing (SGS), the number of available genome assemblies has constantly grown. Compared to Sanger sequencing, SGS technologies are faster, with higher throughput and lower costs [<xref ref-type="bibr" rid="CR1">1</xref>]. However, due to the large number of repetitive regions in some genomes and the short length of sequencing reads, assemblies generated using SGS are often collapsed and fragmented [<xref ref-type="bibr" rid="CR2">2</xref>]. To overcome these problems, long read sequencing such as produced by Pacific Biosciences and Oxford Nanopore have been applied. However, relatively high costs and error rates associated with these technologies have hampered their broad adoption [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. In contrast to DNA sequencing, optical mapping uses the physical location of restriction endonuclease cut sites to assist genome scaffolding and structural variation detection. The average length of single physical maps is more than 200 Kb [<xref ref-type="bibr" rid="CR5">5</xref>], substantially longer than any single molecule sequencing reads produced by commonly used sequencing platforms.</p>
    <p id="Par14">The most common optical mapping approach uses the BioNano Irys and has been applied to a wide range of organisms [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR11">11</xref>]. Among these studies, most used BioNano optical mapping to help genome scaffolding and for structural variation detection, and there are still no studies reported of genome misassembly identification and correction using BioNano data or use of this data to examine the reference genome assembly quality. Here we describe BioNanoAnalyst, an open-source software package to facilitate the quality assessment of genome assemblies using BioNano data. Written in Python and converted to system specific applications, BioNanoAnalyst can run on all common computing platforms with minimal dependencies. It offers a Graphical User Interface (GUI) to visualise the results in forms of tables showing the enzyme restriction site information, and graphs displaying the assembly qualities. BioNanoAnalyst can export the results in GFF3 format for incorporation in a genome browser to assess misassemblies at the nucleotide level. Based on this information, misassembly correction can be undertaken using other tools to improve the quality of genome assemblies.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par15">BioNanoAnalyst uses an assessment procedure based on a reference cmap file, query cmap file and the combined xmap file. The combined xmap file is obtained by a comparison between the reference cmap file and query cmap file using RefAligner. Two starting options are available in BioNanoAnalyst, using either raw data or previously aligned data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The first option uses the raw data from BioNano platforms such as Irys to produce the assessment. In this case, BioNanoAnalyst follows the same steps as BioNano IrysView by using the executables RefAligner and Assembler to perform single molecule map <italic>de novo</italic> assembly and optical mapping. Parameter settings allow users to customise the software based on their available computing resource, such as the number of CPUs or size of requested memory. The second option uses previously aligned results in cmap and xmap format. Both options require the input of a reference genome sequence.<fig id="Fig1"><label>Fig. 1</label><caption><p>Pipeline used in BioNanoAnalyst. Two starting point options are available. Both options require the input of an NGS genome assembly</p></caption><graphic xlink:href="12859_2017_1735_Fig1_HTML" id="MO1"/></fig>
</p>
    <p id="Par16">The confidence score is one of the assessment criteria introduced by BioNano Genomics to evaluate the alignment quality between a reference and query maps. A higher confidence score means a higher possibility to get a better alignment between matched adjacent enzyme restriction sites. In IrysView, the range of confidence score is 0–60 with a step size of 5, while in BioNanoAnalyst we allow any number &gt; =0. Users can select their optimal confidence score depending on their mappings, and usually we recommend 10–20. If users select a large confidence score, the information with a confidence score below will be hidden in the xmap file. After specifying a confidence score and processing, reports are generated detailing the quality assessment.</p>
    <sec id="Sec3">
      <title>Tukey’s method to detect misassemblies</title>
      <p id="Par17">BioNanoAnalyst reports the assembly quality of the input reference sequences based on restriction site ID and distance differences between BioNano consensus maps and reference genome sequences. It does this by comparing pairs of restriction sites aligning between the assembly and BioNano maps. As an example (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>), assume that the assembly sequence has 6 restriction sites from 1 to 6, and the BioNano map has 6 restriction sites from A to F, each restriction cut site has its own position (denoted as <italic>P)</italic>. In the alignment, (1, A), (2, B), (3, C), (4, D), (5, E) and (6, F) are matched. However, some cases such as restriction site 2 in the assembly in Fig. <xref rid="Fig2" ref-type="fig">2b</xref> have no BioNano data match, so BioNanoAnalyst reports them as a questionable restriction site, which may not belong to that position and may be misplaced or cannot be captured owing to a low coverage of the BioNano map or DNA double-strand breaks in that position leading to an enzyme cut site missing in the BioNano map [<xref ref-type="bibr" rid="CR12">12</xref>].<fig id="Fig2"><label>Fig. 2</label><caption><p>Examples to show how BioNanoAnalyst assesses the quality of NGS genome assembly. In the examples we assume that there are 6 selected enzyme cut sites (e.g. Nt.BspQI) on the NGS reference. Five different mapping cases are given to assist the understanding of the scoring in BioNanoAnalyst. <bold>a</bold> shows a good match between NGS reference and BioNano map, and BioNanoAnalyst gives score 4 to each restriction site on the NGS reference. <bold>b</bold> shows a conflict in the number of mapped restriction site between matched adjacent restriction sites. In this case, BioNanoAnanlyst assigns 3 to site 1–3. <bold>c</bold> shows a physical distance matching conflict (<italic>diff</italic> falls outside one of the boundaries) between mapped NGS reference and BioNano map. In this case, BioNano scores site 1 and 2 with score 2. <bold>d</bold> shows a physical distance matching conflicts and number of restriction site matching conflict between NGS reference and BioNano map. In this case, score 1 is given to site 1–3. <bold>e</bold> shows a case that there is no BioNano map mapping to some sites on the NGS reference, such as site 1 and 2. In this case BioNanoAnalyst gives score 0 to site 1 and 2</p></caption><graphic xlink:href="12859_2017_1735_Fig2_HTML" id="MO2"/></fig>
</p>
      <p id="Par18">In a perfect assembly, the absolute distance between restriction site 1 and 2 (<italic>d</italic>
<sub><italic>1, 2</italic></sub> = |<italic>P</italic>
<sub><italic>2</italic></sub>
<italic>–P</italic>
<sub><italic>1</italic></sub>|, <italic>d</italic> means distance, <italic>d</italic>
<sub><italic>1, 2</italic></sub> means distance between restriction 1 and 2), 2 and 3, 3 and 4, 4 and 5, and 5 and 6 should be the same as the distance between restriction site A and B, B and C, C and D, D and E, and E and F respectively (normalized) (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). However, noise from the BioNano consensus maps and the genome assembly influences the relative difference between restriction sites. Misassemblies can increase the differences between calculated distances and affect their statistical distribution, preventing them from following a normal distribution or skewing the normal distribution. To find significant differences between distances, we use Tukey’s method [<xref ref-type="bibr" rid="CR13">13</xref>] to report questionable assembly regions in the reference genome sequence by identifying distance-difference outliers.</p>
      <p id="Par19">For each pair of restriction site pairs, the difference in distance is recorded as <italic>diff</italic> (e.g. <italic>diff</italic>
<sub><italic>1</italic></sub> = <italic>d</italic>
<sub><italic>1, 2</italic></sub> - <italic>d</italic>
<sub><italic>A, B</italic></sub> in Fig. <xref rid="Fig2" ref-type="fig">2a</xref>), and all <italic>diffs</italic> of all pairs are sorted to calculate the first and third quartile. Based on the first quartile (Q1) and third quartile (Q3), the “lower boundary” (2.5Q1–1.5Q3) and “upper boundary” (2.5Q3–1.5Q1) are calculated. If <italic>diff</italic> falls within the lower and upper boundary, the alignment is counted as valid and the assembly agrees with the BioNano map. If <italic>diff</italic> is outside the upper or lower boundary, the region is classed as a candidate misassembly. When <italic>diff</italic> &lt; lower boundary this means there is sequence information missing in the reference genome, and when <italic>diff</italic> &gt; upper boundary this indicates that there is additional sequence information in the reference genome. A complex case occurs when <italic>diff</italic> is outside the upper or lower boundary and the region contains one or more restriction sites without a match in the BioNano map. For example, assuming there is a significant difference between <italic>d</italic>
<sub>1, 3</sub> and <italic>d</italic>
<sub>A, B</sub> in Fig. <xref rid="Fig2" ref-type="fig">2d</xref>, we mark this case as a restriction site id- and position- matching problem between restriction site 1 and 3 on the NGS reference, and it has a high potential of contig misplacement between restriction site 1 and 3.</p>
    </sec>
    <sec id="Sec4">
      <title>Scoring each restriction endonuclease cut site</title>
      <p id="Par20">BioNanoAnalyst divides the restriction endonuclease cut sites on the reference into five quality groups with a numerical score assigned to each. Quality scoring is based on the consistency between the BioNano map and the reference, which is evaluated using the <italic>diff</italic> and matched number of restriction sites in the two assemblies (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). By comparing these, restriction sites are assigned a quality score from 4 to 0. Score 4 is given when there are no <italic>diff</italic> and number of restriction site conflicts between matched BioNano map and reference, such as all restriction sites in Fig. <xref rid="Fig2" ref-type="fig">2a</xref>. Score 3 is assigned when <italic>diff</italic> is consistent between assemblies but the number of restriction sites in the mapped regions is in conflict, for instance restriction site 1–3 in Fig. <xref rid="Fig2" ref-type="fig">2b</xref>. Score 2 indicates that there is only distance conflict between restriction sites and <italic>diff</italic> is outside the boundaries, such as restriction sites 1 and 2 in Fig. <xref rid="Fig2" ref-type="fig">2c</xref>. Restriction sites are assigned a score of 1 when they have both distance conflict (<italic>diff</italic> falls outside the boundaries) and number of restriction site conflict between matched regions, for example restriction site 1–3 in Fig. <xref rid="Fig2" ref-type="fig">2d</xref>. A score of 0 means that there is no BioNano data mapping to those restriction site regions in the reference and the restriction site is not involved in any condition which has already been described, such as restriction 1 and 2 in Fig. <xref rid="Fig2" ref-type="fig">2e</xref>. This can be caused by low coverage of BioNano maps or misassembly in the reference. Scores are displayed in a double y-axis plot with the coverage of corresponding BioNano data on the left y-axis and score on the right y-axis. Users can verify the accuracy of the assessment from BioNanoAnalyst by locating the position and coverage of the restriction cut site. The coverage comes from the restriction site on the query maps. If the query maps have no restriction site mapping to the corresponding site on the reference, there will no coverage information showing on the mapping canvas. If the coverage of a restriction site is high (&gt; the average) and BioNanoAnalyst reports the restriction site is a questionable restriction site, it highly suggests that the assessment by BioNanoAnalyst is correct. If the coverage of the restriction site is lower than the average, we suggest checking the quality score first. If the quality score is less than 10, other method may be needed to check the report from BioNanoAnalyst. If the quality score is larger than 10, it highly suggests that the assessment from BioNanoAnalyst is correct.</p>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results</title>
    <sec id="Sec6">
      <title>Visualization</title>
      <p id="Par21">BioNanoAnalyst provides a GUI, with tables and graphs which the information from the initial enzyme digestion to the final mapping. All information is displayed by clicking the respective button on the “Workflow” canvas (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>). The assembly quality of each reference sequence is displayed on the “Mapping plots” canvas (Fig. <xref rid="Fig3" ref-type="fig">3b</xref>). On this canvas, a double y plot assists misassembly assessment in terms of restriction site ID and location (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>). In this plot, users can scroll to zoom and visualise specific restriction sites. Users can also click on a restriction site to view its ID and location on the reference genome. The GFF3 file generated by BioNanoAnalyst can be imported directly to a genome browser such as JBrowse [<xref ref-type="bibr" rid="CR14">14</xref>], to visualise the location and nucleotide sequences of the predicted misassemblies (Fig. <xref rid="Fig4" ref-type="fig">4b</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>A screenshot of the graphical user interface of BioNanoAnalyst. Once the analysis if finish, users can click the buttons on the ‘Workflow’ canvas to check the corresponding restriction site ID and location (<bold>a</bold>). Users can also select a contig from the drop-down box to visualise the results (<bold>b</bold>). In the double y plot, users can click and zoom on each restriction site to view its id and location on the reference genome. The figure was generated using the first public subterranean clover genome assembly</p></caption><graphic xlink:href="12859_2017_1735_Fig3_HTML" id="MO3"/></fig>
<fig id="Fig4"><label>Fig. 4</label><caption><p>Misassembly visualisation in BioNanoAnalyst (<bold>a</bold>) and a JBrowse genome browser (<bold>b</bold>). The upper figure (<bold>a</bold>) is generated by BioNanoAnalyst, which can be shown in the ‘Mapping plots’ canvas. The lower figure (<bold>b</bold>) is a screenshot from JBrowse presenting the GFF3 file generated by BioNanoAnalyst. In this browser, users can right click the mouse to check the sequence of misassemblies. The data used to generate this figure was from the test data which has been provided in the Github repository</p></caption><graphic xlink:href="12859_2017_1735_Fig4_HTML" id="MO4"/></fig>
</p>
    </sec>
    <sec id="Sec7">
      <title>Computational requirement test</title>
      <p id="Par22">To test the running efficiency and platform requirements of BioNanoAnalyst, we used small (5 Mb), medium (500 Mb) and large genome sizes (1000 Mb) for three different species (<italic>E. coli</italic>, clover and <italic>Brassica napus</italic> canola) analysed on local Windows, Linux and MacOS platforms. The coverage of BioNano optical mapping data is over 70X. The selected enzyme density in the three genomes is around 11/100Kb. The analysis files used were xmap, r.cmap and q.cmap. The confidence score (10) was selected using the average confidence score of these three datasets. The computing configuration and test running time are shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. During task processing, BioNanoAnalyst mostly used one CPU, and during specific stages, such as assigning a score to each restriction site, it used all available CPUs −1. The peak memory consumption was ~100 Mb, ~1 Gb and ~1.5 Gb for the three datasets respectively.<fig id="Fig5"><label>Fig. 5</label><caption><p>Performance of BioNanoAnalyst on different operating systems and computing configurations. The tested genome sizes are 5 Mb, 500 Mb and 1000 Mb. The Y axis indicates the running time (seconds) for different genome sizes. The X axis shows the computing configuration of different platforms tested</p></caption><graphic xlink:href="12859_2017_1735_Fig5_HTML" id="MO5"/></fig>
</p>
    </sec>
    <sec id="Sec8">
      <title>Performance of the Tukey’s method</title>
      <p id="Par23">To test the performance of method used in BioNanoAnalyst, we used the public NA12878 datasets and the hg19 human reference. After mapping using RefAligner, ~90% of the h19 reference was covered by NA12878 BioNano data. A distribution of all <italic>diffs</italic> calculated from the mappings between hg19 and NA12878 BioNano maps without outlier trimming is shown in Fig. <xref rid="Fig6" ref-type="fig">6a</xref>, with an R<sup>2</sup>=0.0564. After outlier trimming, the distribution shown in Fig. <xref rid="Fig6" ref-type="fig">6b</xref> had an R<sup>2</sup>=0.9492 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1).<fig id="Fig6"><label>Fig. 6</label><caption><p>The distribution of <italic>diffs</italic> in NA12878 to hg19 with and without outlier trimming. Before outlier trimming (<bold>a</bold>), the R<sup>2</sup>=0.0564 which means that <italic>diffs</italic> don’t follow a normal distribution. After outlier trimming (<bold>b</bold>), R<sup>2</sup>=0.9492 which means that the remained <italic>diffs</italic> follow a normal distribution</p></caption><graphic xlink:href="12859_2017_1735_Fig6_HTML" id="MO6"/></fig>
</p>
      <p id="Par24">The number of questionable restriction sites between NA12878 and hg19 has been shown in Table <xref rid="Tab1" ref-type="table">1</xref>. As most human BioNano data is used to detect structure variations, we also used the table provided by BioNanoAnalyst to check indels in NA12878. When <italic>diff</italic> &lt; 0, there is an insertion in NA12878, and when <italic>diff</italic> &gt; 0, there is a deletion. In total, we find 165,180 Indels, which account for 94.5% of those benchmarked by Zook et al. [<xref ref-type="bibr" rid="CR15">15</xref>]. Missing indels may exist in the BioNano data uncovered regions.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Number of restriction sites for cases as shown in Fig. <xref rid="Fig2" ref-type="fig">2a-e</xref> between NA12878 and hg19, and between hg18 and hg19</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Case</th><th>hg18_to_hg19</th><th>NA12878_to_hg19</th></tr></thead><tbody><tr><td>Figure <xref rid="Fig2" ref-type="fig">2a</xref>
</td><td>229,989</td><td>213,146</td></tr><tr><td>Figure <xref rid="Fig2" ref-type="fig">2b</xref>
</td><td>83</td><td>18,544</td></tr><tr><td>Figure <xref rid="Fig2" ref-type="fig">2c</xref>
</td><td>33,573</td><td>105,273</td></tr><tr><td>Figure <xref rid="Fig2" ref-type="fig">2d</xref>
</td><td>29,437</td><td>5308</td></tr><tr><td>Figure <xref rid="Fig2" ref-type="fig">2e</xref>
</td><td>61,144</td><td>13,665</td></tr></tbody></table></table-wrap>
</p>
    </sec>
    <sec id="Sec9">
      <title>Accuracy test</title>
      <p id="Par25">The human reference genome assembly is the most well assembled of the available large genomes, but continuous upgrades of this reference are ongoing. To validate the accuracy of the misassemblies detected by BioNanoAnalyst, we selected the public human BioNano genomic data Sample NA12891 and different versions of public human genome references (hg19 and hg18). We firstly used mummerplot [<xref ref-type="bibr" rid="CR16">16</xref>] to show the differences between the assemblies. The enzyme used to generate the BioNano data was <italic>Nt.BspQI</italic> (GCTCTTCN). The confidence score (60) selected in this test was the maximum used in IrysView. An example output from BioNanoAnalyst is presented in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, showing the consistency between the findings from BioNanAnalyst and mummerplot in the first 6 Mb of chromosome 1 on hg18 and hg19. In the mummerplot, apart from the unknown sequences (Ns) and the non-BioNano mapped regions, the biggest difference found is shown at position 5.35 Mb (Fixed assembly). When tracking back to the BioNanoAnalyst result on hg18 (Fig. <xref rid="Fig7" ref-type="fig">7a</xref>), we found that BioNanoAnalyst gave a ‘distance mapping problem’ report (Fig. <xref rid="Fig7" ref-type="fig">7b</xref>). When checking the same region in hg19, it shows that the error has been fixed and there is no misassembly report from BioNanoAnalyst.<fig id="Fig7"><label>Fig. 7</label><caption><p>Validation of the findings from BioNanoAnalyst. The mummerplot shows the consistency of assembly from a nucleotide level. The BioNano optical mapping indicates the consistency of assembly in a motif level. From both comparisons, it can be seen BioNano optical mapping and mummerplot results can be consistent with each other. When validating the accuracy of the finding from BioNanoAnalyst (<bold>b</bold>), the BioNano optical mapping gives a support (<bold>a</bold>)</p></caption><graphic xlink:href="12859_2017_1735_Fig7_HTML" id="MO7"/></fig>
</p>
      <p id="Par26">To directly compare the differences between the human references hg18 and hg19, we digested both assemblies in silico with the enzyme <italic>Nt.BspQI</italic>. We used the generated hg19.cmap as the reference map and hg18.cmap as the query map and compared them using the RefAligner. After obtaining the xmap file, we analysed the data with BioNanoAnalyst and found that in hg19 there was 19.74 Mb nucleotide information missing from the hg18 and an additional 22.68 Mb of nucleotide information. The remaining matched sequences are the same with <italic>diff</italic> equal to 0 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2). Number of restriction sites reported by BioNanoAnalyst has been given in Table <xref rid="Tab1" ref-type="table">1</xref>.</p>
      <p id="Par27">To test the false positive and false negative identification rates in the comparison between hg18 and hg19, we randomly selected 100 regions from the 247,580 BioNanoAnalyst reported consistent regions (<italic>diff</italic> == 0) in hg18 and hg19, and 100 regions from the 39,822 potentially modified regions (<italic>diff</italic>! = 0) in hg19 and hg18 and pairwise aligned them using BLASTN (v2.2.29+) [<xref ref-type="bibr" rid="CR17">17</xref>]. The assessment criteria were from the default BLASTN results, which were percentage of identical matches, alignment length, number of mismatches and number of gap openings. We found that both the false positive rate and the false negative rate were 0. However, among the <italic>diff</italic>! = 0 regions, we found that 97% of those extracted hg19 sequences only added or deleted some nucleotides in either 5′ end or 3′ end compared to those sequences extracted from hg18. For the remaining 3% of sequences, they changed some information inside the 5′ and 3′ ends compared to those sequences in hg18.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Discussion</title>
    <p id="Par28">BioNanoAnalyst uses hashtables to store information. The computational requirement test showed that BioNanoAnalyst is efficient in memory use with an acceptable running speed on a local computer. The performance of Tukey’s method used in BioNanoAnalyst was tested using public NA12878 and NA12891 BioNano datasets, and comparison between the human reference genome hg18 and hg19. Although a percentage of false positives and false negatives have been given based on analysis of human genome references, these numbers may vary depending on data used. Because BioNanoAnalyst uses the aligned result from RefAligner, the accuracy of BioNanoAnalyst can be affected by the performance of RefAligner. The quality of reference and query maps are also important for the analysis carried out in BioNanoAnalyst. During testing, the majority reported misassemblies have a distance-difference with BioNano consensus maps. The reason might be a poor resolution in the reference in repeat reconstruction.</p>
    <p id="Par29">BioNanoAnalyst is designed to detect misassembed regions in a reference genome. When assembly quality is high, such as in the human genome reference, BioNanoAnalyst can compare individuals to identify deletions or insertions in particular regions. However, as many non-human assemblies are not high quality, additional information is required to identify whether inconsistencies are caused by a deletion or insertion. In many non-human genomes, there is a high potential of misassembly in the reference through, for instance, collapsed repeats. As we use distance differences to detect misassembly, BioNanoAnalyst is not efficient in finding complex misassemblies such as false translocations and inversions, however the BioNanoAnalyst results table can be used to help assess false inversions.</p>
  </sec>
  <sec id="Sec11">
    <title>Conclusions</title>
    <p id="Par30">The BioNanoAnalyst package offers a simple way to assess genome assemblies using BioNano data, with fast run times for different genome sizes and on different platforms, detailed misassembly reports and standard GFF3 based visualisation. BioNanoAnalyst is a useful and unique tool to evaluate the quality of reference genome assemblies. The GUI provides a visual representation of the assembly using restriction site IDs and physical locations, enabling users to easily find misassembled regions. It also provides options for users to visualise and present misassemblies in GFF3 format using standard genome browsers such as JBrowse. The graphs and tables generated by the tool comprehensively show the locations and status of assemblies as classified. We believe that BioNanoAnalyst is a valuable tool for assessment of the quality of reference assemblies using BioNano data.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec12">
        <title>Additional file</title>
        <p id="Par39">
          <media position="anchor" xlink:href="12859_2017_1735_MOESM1_ESM.xlsx" id="MOESM1">
            <label>Additional file 1: Table S1.</label>
            <caption>
              <p>Mappings between NA12878 BioNano data and hg19. <bold>Table S2.</bold> Mappings between hg19 and hg18 using RefAligner. (XLSX 59183 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CPU</term>
        <def>
          <p id="Par4">Central processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>Diff</term>
        <def>
          <p id="Par5">Physical distance difference between mapped adjacent enzyme restriction sites</p>
        </def>
      </def-item>
      <def-item>
        <term>GFF</term>
        <def>
          <p id="Par6">Generic feature format</p>
        </def>
      </def-item>
      <def-item>
        <term>GUI</term>
        <def>
          <p id="Par7">Graphical user interface</p>
        </def>
      </def-item>
      <def-item>
        <term>NGS</term>
        <def>
          <p id="Par8">Next generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>Q1</term>
        <def>
          <p id="Par9">First quartile</p>
        </def>
      </def-item>
      <def-item>
        <term>Q3</term>
        <def>
          <p id="Par10">Third quartile</p>
        </def>
      </def-item>
      <def-item>
        <term>SGS</term>
        <def>
          <p id="Par11">Second generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>SV</term>
        <def>
          <p id="Par12">Structural variation</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (doi:10.1186/s12859-017-1735-4) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Y.Y. is supported by the China Scholarship Council (CSC) for his PhD studies at the University of Western Australia. A.S. is supported by an International Postgraduate Research Scholarship Awarded by the Australian government. We thank Kees-Jan Francoijs and Sean Tan from BioNano Genomics for their assistance in using BioNano optical mapping. We appreciate Susan Brown for allowing using her <italic>E</italic>.coli BioNano test data. Support is also acknowledged from the Pawsey Supercomputing Centre, with funding from the Australian Government and the Government of Western Australia, and the National Computational Infrastructure (NCI), which is supported by the Australian Government. We thank for the helpful and conductive comments from three anonymous reviewers on improving this manuscript and software.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par31">This work is funded by the Australian Research Council (Projects LP140100537 and LP130100925).</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p id="Par32">The software package is freely available on the GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/AppliedBioinformatics/BioNanoAnalyst">https://github.com/AppliedBioinformatics/BioNanoAnalyst</ext-link>)</p>
      <p id="Par33">The tested human reference genomes are available at <ext-link ext-link-type="uri" xlink:href="ftp://hgdownload.cse.ucsc.edu/goldenPath/hg19/chromosomes">ftp://hgdownload.cse.ucsc.edu/goldenPath/hg19/chromosomes</ext-link> and <ext-link ext-link-type="uri" xlink:href="ftp://hgdownload.cse.ucsc.edu/goldenPath/hg18/chromosomes">ftp://hgdownload.cse.ucsc.edu/goldenPath/hg18/chromosomes</ext-link> respectively.</p>
      <p id="Par34">The tested human BioNano genomic datasets can be freely downloaded at <ext-link ext-link-type="uri" xlink:href="http://www.bnxinstall.com/publicdatasets/NA12878_Mt_Sinai_89x_180kb.tar.gz">http://www.bnxinstall.com/publicdatasets/NA12878_Mt_Sinai_89x_180kb.tar.gz</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://www.bnxinstall.com/publicdatasets/NA12891_75x_150kb.tar.gz">http://www.bnxinstall.com/publicdatasets/NA12891_75x_150kb.tar.gz</ext-link>
</p>
      <p id="Par35">Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1–2 are available at <ext-link ext-link-type="uri" xlink:href="http://appliedbioinformatics.com.au/download/BioNanoAnalyst/Supplementary%20Table%20S1-2.xlsx">http://appliedbioinformatics.com.au/download/BioNanoAnalyst/Supplementary%20Table%20S1-2.xlsx</ext-link>
</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>YY designed and coded the software package. PEB and CKC helped with the coding. AS tested and commented on the software package. DE and PEB guided this research. YY, DE and PB prepared the manuscript. All authors read and approved the manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p id="Par36">Not applicable.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p id="Par37">The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p id="Par38">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goodwin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>McCombie</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>Coming of age: ten years of next-generation sequencing technologies</article-title>
        <source>Nat Rev Genet</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>6</issue>
        <fpage>333</fpage>
        <lpage>351</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg.2016.49</pub-id>
        <?supplied-pmid 27184599?>
        <pub-id pub-id-type="pmid">27184599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alkan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sajjadian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Eichler</surname>
            <given-names>EE</given-names>
          </name>
        </person-group>
        <article-title>Limitations of next-generation genome sequence assembly</article-title>
        <source>Nat Methods</source>
        <year>2011</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>61</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1527</pub-id>
        <?supplied-pmid 21102452?>
        <pub-id pub-id-type="pmid">21102452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berlin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Drake</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Landolin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Assembling large genomes with single-molecule sequencing and locality-sensitive hashing</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>6</issue>
        <fpage>623</fpage>
        <lpage>630</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3238</pub-id>
        <?supplied-pmid 26006009?>
        <pub-id pub-id-type="pmid">26006009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>One chromosome, one contig: complete microbial genomes from long-read sequencing and assembly</article-title>
        <source>Curr Opin Microbiol</source>
        <year>2015</year>
        <volume>23</volume>
        <fpage>110</fpage>
        <lpage>120</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mib.2014.11.014</pub-id>
        <?supplied-pmid 25461581?>
        <pub-id pub-id-type="pmid">25461581</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Shelton JM, Coleman MC, Herndon N, Lu N, Lam ET, Anantharaman T, et al. Tools and pipelines for BioNano data: molecule assembly pipeline and FASTA super scaffolding tool. BMC Genomics. 2015;16:734.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Mostovoy Y, Levy-Sakin M, Lam J, Lam ET, Hastie AR, Marks P, et al. A hybrid approach for de novo human genome sequence assembly and phasing. Nat Methods. 2016;13(7):587–90.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Pendleton M, Sebra R, Pang AW, Ummat A, Franzen O, Rausch T, et al. Assembly and diploid architecture of an individual human genome via single-molecule technologies. Nat Methods. 2015;12(8):780–6.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Rosenfeld JA, Reeves D, Brugler MR, Narechania A, Simon S, Durrett R, et al. Genome assembly and geospatial phylogenomics of the bed bug <italic>Cimex lectularius</italic>. Nat Commun. 2016;7:10164.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Stankova H, Hastie AR, Chan S, Vrana J, Tulpova Z, Kubalakova M, et al. BioNano genome mapping of individual chromosomes supports physical mapping and sequence assembly in complex plant genomes. Plant Biotechnol J. 2016;14(7):1523–31.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">VanBuren R, Bryant D, Edger PP, Tang H, Burgess D, Challabathula D, et al. Single-molecule sequencing of the desiccation-tolerant grass Oropetium thomaeum. Nature. 2015;527(7579):508–11.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Xiao S, Li J, Ma F, Fang L, Xu S, Chen W, et al. Rapid construction of genome map for large yellow croaker (<italic>Larimichthys crocea</italic>) by the whole-genome mapping in BioNano Genomics Irys system. BMC Genomics. 2015;16:670.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Hastie AR, Dong L, Smith A, Finklestein J, Lam ET, Huo N, et al. Rapid genome mapping in nanochannel arrays for highly complete and accurate de novo sequence assembly of the complex <italic>Aegilops tauschii</italic> genome. PLoS One. 2013;8(2):e55864.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Tukey JW. Exploratory data analysis. Reading, MA: Addison-Wesley; 1977.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Skinner</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Uzilov</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Mungall</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>IH</given-names>
          </name>
        </person-group>
        <article-title>JBrowse: a next-generation genome browser</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <issue>9</issue>
        <fpage>1630</fpage>
        <lpage>1638</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.094607.109</pub-id>
        <?supplied-pmid 19570905?>
        <pub-id pub-id-type="pmid">19570905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Zook JM, Chapman B, Wang J, Mittelman D, Hofmann O, Hide W, et al. Integrating human sequence data sets provides a resource of benchmark SNP and indel genotype calls. Nat Biotechnol. 2014;32(3):246–51.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Kurtz S, Phillippy A, Delcher AL, Smoot M, Shumway M, Antonescu C, et al. Versatile and open software for comparing large genomes. Genome Biol. 2004;5(2):R12.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <issue>3</issue>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
        <?supplied-pmid 2231712?>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
