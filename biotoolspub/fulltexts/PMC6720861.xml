<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6720861</article-id>
    <article-id pub-id-type="publisher-id">3055</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3055-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Cytokit: a single-cell analysis toolkit for high dimensional fluorescent microscopy imaging</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4254-4255</contrib-id>
        <name>
          <surname>Czech</surname>
          <given-names>Eric</given-names>
        </name>
        <address>
          <email>eric@hammerlab.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aksoy</surname>
          <given-names>Bulent Arman</given-names>
        </name>
        <address>
          <email>arman@hammerlab.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Aksoy</surname>
          <given-names>Pinar</given-names>
        </name>
        <address>
          <email>pinar@hammerlab.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hammerbacher</surname>
          <given-names>Jeff</given-names>
        </name>
        <address>
          <email>hammer@hammerlab.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2189 3475</institution-id><institution-id institution-id-type="GRID">grid.259828.c</institution-id><institution>Microbiology and Immunology Department at Medical University of South Carolina, </institution></institution-wrap>Charleston, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>448</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Multiplexed in-situ fluorescent imaging offers several advantages over single-cell assays that do not preserve the spatial characteristics of biological samples. This spatial information, in addition to morphological properties and extensive intracellular or surface marker profiling, comprise promising avenues for rapid advancements in the understanding of disease progression and diagnosis. As protocols for conducting such imaging experiments continue to improve, it is the intent of this study to provide and validate software for processing the large quantity of associated data in kind.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Cytokit offers <italic>(i)</italic> an end-to-end, GPU-accelerated image processing pipeline; (ii) efficient input/output (I/O) strategies for operations specific to high dimensional microscopy; and (iii) an interactive user interface for cross filtering of spatial, graphical, expression, and morphological cell properties within the 100+ GB image datasets common to multiplexed immunofluorescence. Image processing operations supported in Cytokit are generally sourced from existing deep learning models or are at least in part adapted from open source packages to run in a single or multi-GPU environment. The efficacy of these operations is demonstrated through several imaging experiments that pair Cytokit results with those from an independent but comparable assay. A further validation also demonstrates that previously published results can be reproduced from a publicly available multiplexed image dataset.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">Cytokit is a collection of open source tools for quantifying and analyzing properties of individual cells in large fluorescent microscopy datasets that are often, but not necessarily, generated from multiplexed antibody labeling protocols over many fields of view or time periods. This project is best suited to bioinformaticians or other technical users that wish to analyze such data in a batch-oriented, high-throughput setting. All source code, documentation, and data generated for this article are available under the Apache License 2.0 at <ext-link ext-link-type="uri" xlink:href="https://github.com/hammerlab/cytokit">https://github.com/hammerlab/cytokit</ext-link>.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s12859-019-3055-3) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Automatic image processing</kwd>
      <kwd>Multiplexed fluorescence imaging</kwd>
      <kwd>Data visualization</kwd>
      <kwd>Data exploration</kwd>
      <kwd>GPU</kwd>
      <kwd>CellProfiler</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par13">Molecular profiling of cell culture and tissue samples traditionally relies on techniques that do not support a diverse panel of protein targets without disturbing important in situ characteristics of cells. Immunofluorescence imaging preserves these characteristics but is limited to a small number of expression measurements due to the need to avoid overlapping fluorophore emission spectra. This limitation can be overcome to an extent through repeated imaging of the same specimen over several cycles, where each cycle typically involves capturing images of 3 or 4 markers at a time, however the incubation period necessary between cycles is often hours or days and methods for removing markers from previous cycles can be detrimental to assay quality. By contrast, techniques like Mass Cytometry [<xref ref-type="bibr" rid="CR1">1</xref>] and Multispectral Flow Cytometry [<xref ref-type="bibr" rid="CR2">2</xref>] enable the measurement of more target compounds but provide little to no morphological or spatial information. Other methods such as Multiplexed Immunohistochemistry [<xref ref-type="bibr" rid="CR3">3</xref>] and Multiplexed Ion Beam Imaging [<xref ref-type="bibr" rid="CR4">4</xref>] overcome these limitations but require special appliances that are not compatible with standard or commercial microscopy platforms. For these reasons, analysis of data from multiplexed fluorescent labeling methods are appealing as they are economical, can be conducted with any fluorescent imaging platform, and rely on well documented immunostaining protocols.</p>
    <p id="Par14">Methods developed for multiplexed fluorescent labeling include Co-Detection by Indexing (CODEX) [<xref ref-type="bibr" rid="CR5">5</xref>], DNA Exchange Imaging (DEI) [<xref ref-type="bibr" rid="CR6">6</xref>], and t-CyCIF [<xref ref-type="bibr" rid="CR7">7</xref>], all of which outline a cyclical protocol in which 2 or 3 antigen markers and a DNA stain are introduced in each cycle prior to imaging. Unlike in the t-CyCIF protocol, where a relatively lengthy antibody incubation step is required as a part of each cycle, both CODEX and DEI begin with a single incubation step in which a large (possibly &gt; 100) number of oligonucleotide-conjugated antibodies bind to cognate antigens. Fluorophores bound to complementary oligonucleotide sequences are then introduced to enable the collection of a small number (typically 4) of fluorescent images before being washed away and allowing the process to repeat. These procedures are capable of measuring the expression of tens or hundreds of different proteins but introduce several key computational challenges that make employing them difficult. The primary challenge is that incorporating the larger number of expression targets within 3D image volumes that encompass hundreds of thousands of cells, a sample size often necessary for studying less common cell types [<xref ref-type="bibr" rid="CR8">8</xref>], leads to 100+ GB raw image sets including well over 10,000 images. As this data is often the product of commodity imaging platforms, substantial processing is necessary for analysis and the time associated with this processing becomes prohibitive for high dimensional acquisitions without GPU acceleration. With GPU acceleration however, we show how a CODEX experiment, shared by Goltsev et al., including 51 k 16-bit images (129 GB), 54 expression markers, and ~ 70 k individual cells can be aligned, deconvolved, and segmented for analysis in less than 90 min per workstation. Another challenge prevalent among such large imaging assays is managing the heterogeneity that arises across replicates and treatment groups for experiments that span multiple days or weeks and involve multiple laboratory practitioners. Images collected as a part of these experiments may include variation between samples in bit-depth, spatial resolution, grid size, dye intensity, microscope channel definition or a variety of other parameters that are not critical to measuring quantities of interest but that do demand a software pipeline that supports programmatic configuration.</p>
    <p id="Par15">Open source tools similar to Cytokit include the CODEX toolkit, histoCAT [<xref ref-type="bibr" rid="CR9">9</xref>], KNIME [<xref ref-type="bibr" rid="CR10">10</xref>], ImageJ [<xref ref-type="bibr" rid="CR11">11</xref>], Ilastik [<xref ref-type="bibr" rid="CR12">12</xref>] and CellProfiler (CP) [<xref ref-type="bibr" rid="CR13">13</xref>]. The CODEX toolkit is most similar but requires Windows as well as licensed deconvolution software, and it does not make use of common image processing libraries for segmentation or quantification so it is difficult to understand, debug, and extend. histoCAT is also very similar as it was built for analyzing multiplexed tissue images and the authors demonstrate how to use CellProfiler, Ilastik, and MATLAB to generate the data necessary for doing so. The primary drawback with this approach is that the operator needs to configure processing in a different graphical user interface (GUI) for each of the classification (Ilastik), segmentation (CellProfiler), and analysis (histoCAT) components of the pipeline. Cytokit aims to have a single configuration that can be applied to all downstream operations in an unattended manner, which makes it easier to run the same pipeline on similar data with only minor modifications (e.g. different channels). This comes at a loss of versatility because the provided segmentation method in Cytokit is not suitable for all imaging modalities, but custom segmentation routines can be integrated if they were developed externally. Out of the remaining tools, ImageJ, CellProfiler and Ilastik can all be utilized in the processing of multiplexed image data (as well as a multitude of other use cases Cytokit is not appropriate for) but none of them directly support this well as each would require a user to configure per-channel operations. This is a substantial burden when it means that some action needs to be taken in a GUI for each of potentially 20 or more channels, and it is particularly problematic when those channels change slightly in a new experiment. Programmatic configuration of such operations is more resilient to these changes and as an example of how Cytokit accomplishes this, CellProfiler is integrated as an option for image intensity quantification where the CP pipeline instance is generated and executed dynamically based on a static experiment configuration that can be altered without requiring the tedious and error-prone GUI interactions otherwise necessary with multiplexed image data. Lastly, KNIME is also similar to Cytokit in that it offers a way to implement control flow around native image processing operations as well as those provided by other projects. It is very likely that the same functionality in Cytokit could be captured by a comparable KNIME workflow, but Cytokit emphasizes support for offline, batch processing without a GUI-driven configuration -- a choice most likely to appeal only to bioinformaticians.</p>
    <p id="Par16">In summary, we present and validate a library providing programmatic configuration and GPU accelerated implementations of image processing algorithms for, but not exclusive to, analyzing high dimensional immunofluorescence data. This library is open source, requires nothing more than an existing nvidia-docker installation to run, is adherent to best practices such as continuous integration and unit testing, and includes a novel user interface alongside support for CellProfiler Analyst [<xref ref-type="bibr" rid="CR14">14</xref>] to help navigate the cellular characteristics measured by this next generation of fluorescent imaging technology.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par17">Cytokit consists of four major components, each of which will be discussed further in the following sections:
<list list-type="bullet"><list-item><p id="Par18"><bold>Processing</bold> - Processing operations are applied to tiled images in parallel and in a predefined order to maximize ease of use as well as ensure that I/O for large image files is minimized by avoiding multiple reads and writes for the same images;</p></list-item><list-item><p id="Par19"><bold>Configuration</bold> - Beginning from a template configuration, image operations and extractions can be enabled/parameterized through “deltas” to concisely define variations on experimental results;</p></list-item><list-item><p id="Par20"><bold>Extraction</bold> - Cytometric single cell data can be exported as Flow Cytometry Standard (FCS) or comma-separated values (CSV) files and individual channels can be grouped into arbitrary subsets for extraction into ImageJ compatible Tagged ImageFile Format (TIFF) hyperstacks for custom analysis;</p></list-item><list-item><p id="Par21"><bold>Visualization</bold> - The Cytokit Explorer UI allows for Individual cells to be isolated based on phenotype and visualized within the entire field of view for an experiment, individual fields of view, or as single cells.</p></list-item></list></p>
    <sec id="Sec3">
      <title>Processing</title>
      <p id="Par22">The imaging processing pipeline in Cytokit, based largely on the original CODEX toolkit, is designed to support datasets with the following dimensions:
<list list-type="bullet"><list-item><p id="Par23">Tile - A single field of view</p></list-item><list-item><p id="Par24">X/Y/Z - 3D images captured at each tile location</p></list-item><list-item><p id="Par25">Channel - Images for different expression markers</p></list-item><list-item><p id="Par26">Cycle - Groups of channels (usually 3 or 4) captured between dye exchange cycles</p></list-item><list-item><p id="Par27">Region - Groups of tiles often collected as square grids</p></list-item></list></p>
      <p id="Par28">This seven dimensional structure, illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, is common in multiplexed imaging but dimensions of length 1 are also supported in nearly all cases. In other words, the smallest Cytokit-compatible experiment would consist of a single, grayscale 2D image with a height and width exceeding some minimum value (currently 88 pixels). All of the imaging processing steps applied to these datasets can be enabled or disabled based on the experiment configuration and are executed in a predetermined order. The individual steps themselves are implemented using existing deep learning models or are ported from other Java or Python libraries to run as GPU-accelerated TensorFlow [<xref ref-type="bibr" rid="CR15">15</xref>] computational graphs. There are some exceptions to this such as image I/O and cell segmentation post-processing, but all of these are discussed below.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Seven dimensional multiplexed experiment structure illustrating how 3D single channel images are grouped as cycles, captured as tiles on a grid, and then potentially repeated over multiple fields of view (as “regions”) before being quantified as two dimensional single-cell information</p></caption><graphic xlink:href="12859_2019_3055_Fig1_HTML" id="MO1"/></fig></p>
      <sec id="Sec4">
        <title>Operations</title>
        <p id="Par29">As illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the first step in the Cytokit pipeline involves loading images into memory in a way that is decoupled from all further processing steps. This is done using a separate thread, outside of any TensorFlow graphs, to assemble 2D grayscale images as 5 dimensional tile arrays that are then loaded onto a queue of configurable size (typically 1). This ensures that as processing for a single tile completes, there is no delay introduced by disk I/O before beginning processing on the next tile. This is an important feature for maximizing GPU utilization and reduces overall processing time substantially when the time necessary to process a single tile is not drastically larger than the time necessary to load it from disk. The image files themselves are assumed to be 8 or 16-bit 2D grayscale images with file names containing region, tile, cycle, z-plane, and channel index numbers, in a configurable format, so that the array structure matches that of the experiment.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Processing pipeline overview with operations in original CODEX project replaced by GPU-accelerated equivalents, decoupled from tile assembly, and modified to support labeled object extraction as well as ad-hoc image stacks/montages</p></caption><graphic xlink:href="12859_2019_3055_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par30">The remaining image manipulation operations include:
<list list-type="bullet"><list-item><p id="Par31"><bold>Cycle Registration</bold> - This operation serves as a way to align reference images across cycles and then apply the inferred translation to all other non-reference images. As is necessary in multiplexed imaging, a reference channel usually containing a nuclear stain must be collected in each cycle so that the sample drift occurring in the time elapsed between fluorophore exchanges can be compensated for in downstream analysis. In Cytokit, this operation is implemented as a port of the cross correlation algorithm [<xref ref-type="bibr" rid="CR16">16</xref>] in scikit-image [<xref ref-type="bibr" rid="CR17">17</xref>] register_translation to TensorFlow<italic>.</italic></p></list-item><list-item><p id="Par32"><bold>Image Quality Assessment</bold> - This is provided by the Microscope Image Quality [<xref ref-type="bibr" rid="CR18">18</xref>] project, a TensorFlow classifier that allows for images to be scored based on their quality, and is used in Cytokit to select individual 2D images for visualization and/or quantification.</p></list-item><list-item><p id="Par33"><bold>Deconvolution</bold> - 3D image deconvolution in Cytokit is provided by the Flowdec project, which is a direct port of the Richardson Lucy algorithm in the DeconvolutionLab2 [<xref ref-type="bibr" rid="CR19">19</xref>] library to TensorFlow. Cytokit also includes support for automatically generating Point Spread Functions based on an experiment configuration through a fast Gibson-Lanni kernel approximation method [<xref ref-type="bibr" rid="CR20">20</xref>].</p></list-item><list-item><p id="Par34"><bold>Segmentation</bold> - Identification of cell nuclei is performed using the deep learning model [<xref ref-type="bibr" rid="CR21">21</xref>] featured in CellProfiler. The semantic segmentation provided by this model produces a 3 class prediction for background, nucleus interior, and nucleus boundary pixel classification. A nuclei object image is generated from these predictions as a single pixel dilation of binary objects resulting from the selection of the pixels that have the highest probability of belonging to the nucleus interior class, after removing nuclei below a configuration size threshold. The nuclei objects are then used to identify entire cell objects based on either a fixed radius outside the nucleus or, if available, a membrane stain channel used to create a threshold image serving as a watershed mask or as both a mask and a “height” image for propagation segmentation [<xref ref-type="bibr" rid="CR22">22</xref>] (to trade off distances between nuclei with membrane image intensity in the formation of cell boundaries). Any intermediate image processing subsequent to segmentation is implemented using scikit-image, SciPy [<xref ref-type="bibr" rid="CR23">23</xref>], and OpenCV [<xref ref-type="bibr" rid="CR24">24</xref>]. Quantification of expression images over the area of the segmented objects is also performed using modules in CellProfiler. This operation will produce files compatible with either Cytokit Explorer or CellProfiler Analyst.</p></list-item></list></p>
      </sec>
      <sec id="Sec5">
        <title>Configuration</title>
        <p id="Par35">Experimental variation in high throughput microscopy imaging often requires processing pipelines that are very tunable. While the intention in Cytokit is to employ algorithms that require this as little as possible, some configurability is unavoidable. The approach taken to address this problem involves two core capabilities -- iteration and evaluation. Much like any general hyperparameter optimization process, Cytokit attempts to make defining iterations and evaluating them as simple as possible so that tuning individual operations for individual images is much less common than being able to view the effects of parameter settings across an entire experiment. For example, a common process in our lab is to generate a template configuration that is then modified incrementally to produce several variants of an experiment for analysis. A simple version of this process is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> and demonstrates how the volume of data incorporated may be increased as appropriate parameter settings become clearer.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Example iterative pipeline optimization process with CLI commands used to continually refine and expand the scope of experiment processing for large raw image datasets</p></caption><graphic xlink:href="12859_2019_3055_Fig3_HTML" id="MO3"/></fig></p>
        <p id="Par36">Template configurations, which may also simply be the sole configuration for an experiment, need to at least include the dimensions of the experiment (grid size, number of Z planes, image overlap, etc.), microscope parameters, and channel names. They may also contain definitions for any commands to be run as a way to ensure that all processing for an experiment is defined in one place. Practically speaking, this means that arguments to a command line interface (CLI) controlling processing, data extraction, or analysis may be specified in the experiment configuration or overridden at the command line. This often fosters reproducibility since it eliminates the need to keep track of how a pipeline was invoked while still making it possible to introduce small changes in behavior. A good example of this is defining channel subsets to extract for visualization as this can be done completely ad-hoc at a command line or defined in the template configuration if the extraction is commonly useful.</p>
      </sec>
    </sec>
    <sec id="Sec6">
      <title>Extraction</title>
      <p id="Par37">Extracting data from high dimensional experiments can be challenging, particularly when slices of interest across those dimensions span image volumes that are too large for other visualization and analysis software. Extraction utilities in Cytokit make it possible to mix raw image data with processed image results as well labeled object data (for cells/nuclei) and can be parameterized to operate on subsets of image grids or fields of view, lists of specific channel names, or z-plane subsets. Those extracted images can then also be stitched together such as in Fig. <xref rid="Fig4" ref-type="fig">4</xref> where a 49 tile (7 × 7 grid) montage of 1008 × 1344 images was generated as single TIFF file (cropped to 8192 × 8192 pixels) containing marker expression levels and cell/nucleus boundary data.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Example extraction and montage CLI commands. <bold>a</bold> CLI commands define slices as names (where relevant) or as lists and ranges of indexes to extract raw, processed, or object image data. <bold>b</bold> Resulting TIFF files are ImageJ compatible for blending and visualization, like the example shown with human T cells labeled as CD3 (green), DAPI (blue), nuclei boundaries (cyan), and cell boundaries (red)</p></caption><graphic xlink:href="12859_2019_3055_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par38">In addition to image extraction utilities, Cytokit also offers single cell data as FCS or CSV files containing cell identifiers linking back to object images, location coordinates within the experiment, morphological properties (diameter, size, circularity, etc.), mean expression levels across the entire cell or within the nucleus alone, and graphical properties like identifiers of adjacent cells, number of adjacent cells, and size of contact boundary. The same information (and more) can also be exported using CellProfiler directly to generate a SQLite database compatible with CellProfiler Analyst.</p>
    </sec>
    <sec id="Sec7">
      <title>Visualization</title>
      <p id="Par39">One of the primary challenges in in-situ image cytometry is developing an understanding of the relationship between phenotypic and spatial properties of cells. Multiplexed imaging further complicates this process as the quantity of images produced both increases the likelihood that illumination artifacts exist along the spatial dimensions and often makes finding them manually infeasible. To assist in interrogating these relationships as well as build phenotypic profiles for cell populations, an interactive Dash (by <ext-link ext-link-type="uri" xlink:href="http://plot.ly">Plot.ly</ext-link>) application is provided that allows for gates applied to cytometric data to be projected onto images within an experiment. Shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref><bold>,</bold> this application can be used to visualize individual cell/nucleus segmentations, highlighted as SVG overlays, within the context of a stitched grid view of an experiment as well as a single field of view. Additionally, single cell images can be extracted from an entire experiment with blended overlays of various expression channels (having user defined contrasts) as a means of ensuring that the characteristics of cells assumed to exist in any one population gated purely based on numerical information match expectations. Custom metrics can also be computed and attached for visualization in this interface using any of the fields mentioned in the “Extraction” section above.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Cytokit Explorer screenshot (see <underline>screencast</underline> for animated version) showing a CODEX sample imaged at 20x. <bold>a</bold> 1D or 2D plots of expression, morphological, or graphical cell features support box and free-hand gating. <bold>b</bold> Custom filtering, to ignore a central photobleached region of cells in this case, or summarizations are applied immediately. <bold>c</bold> Single cell images match current gate and selected channel display settings and can also be buffered onto the page as tiles are selected, or across the entire image grid (not shown). <bold>d</bold> Gated cell population projected onto selected tile image with current display settings</p></caption><graphic xlink:href="12859_2019_3055_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Results</title>
    <sec id="Sec9">
      <title>Cellular marker profiling</title>
      <p id="Par40">To demonstrate the extraction and analysis features of Cytokit as well as validate the underlying image processing libraries, a series of traditional immunofluorescence experiments were first conducted on human primary T cells. The first of these, shown in Figs. <xref rid="Fig6" ref-type="fig">6</xref> and <xref rid="Fig7" ref-type="fig">7</xref>, comprised of primary human T cell samples stained with CODEX oligonucleotide-conjugated antibodies against human CD3, CD4, and CD8 (and a separate HOECHST stain). These slides were then imaged at 20X on a 1.9 mm × 2.5 mm grid of 25 images over an axial depth of 12.5 μm. The resulting 1008x1344x25 (height x width x depth) image volumes were then deconvolved, segmented, and quantified before being gated using Cytokit Explorer to isolate helper (CD4 positive) and cytotoxic (CD8 positive) subpopulations.
<fig id="Fig6"><label>Fig. 6</label><caption><p>T cell CD3 (blue), CD4 (red), and CD8 (green) intensity. <bold>a</bold> First row of 5 images in 5 × 5 experiment grid. <bold>b</bold> Single tile image with corresponding cell and nucleus segmentation, where cells are defined as a fixed radius away from the nucleus in the absence of a plasma membrane stain. <bold>c</bold> Center zoom on (b) showing co-expression of CD3 and CD4 (magenta) and CD3 and CD8 (cyan) as well as debris in DAPI channel</p></caption><graphic xlink:href="12859_2019_3055_Fig6_HTML" id="MO6"/></fig>
<fig id="Fig7"><label>Fig. 7</label><caption><p>T cell gating workflow as annotated Explorer screenshots. <bold>a</bold> Morphological and intensity gates applied to isolate CD3+ cells. <bold>b</bold> Cytotoxic and helper cell subpopulations. <bold>c</bold> Individual cell images matched to subpopulations in (b)</p></caption><graphic xlink:href="12859_2019_3055_Fig7_HTML" id="MO7"/></fig></p>
      <p id="Par41">While these CD4 and CD8 positive (i.e. CD4+ and CD8+) populations were easily resolved in this experiment (Fig. <xref rid="Fig7" ref-type="fig">7</xref>), we found that dissociated cell samples like this are difficult to prepare without non-trivial amounts of debris and diffuse nuclear staining, usually as a result of lysed cells that did not survive the centrifuge. This is visible in Fig. <xref rid="Fig6" ref-type="fig">6</xref>
<bold>(c)</bold> where a minority of the nuclei segmentations resulting from the CellProfiler U-Net are fixed around roughly circular areas of greater DAPI intensity, albeit at low contrast. This invariance to contrast is generally very desirable, but it also demonstrates the importance of curation in image cytometry as artifacts like this can easily go undetected without a way to relate variations in inferred morphological or expression profiles for cells back to raw images.</p>
      <p id="Par42">A further investigation of the ability of this method to isolate CD4 + CD8- and CD4-CD8+ cell populations was also conducted on experimental replicates and validated against flow cytometry based surface marker profiling. Shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>, population proportions matched closely and verified that dissociated cells quantified in this way can produce results comparable to other methods; however, tools like Explorer and OpenCyto [<xref ref-type="bibr" rid="CR25">25</xref>] were necessary to reach this degree of parity due to over-saturated image tiles (detected in Explorer) and intensity calibration differences resulting in substantial movement in the modes of the CD4/CD8 populations across replicates and donors. This latter issue was compensated for, in a downstream analysis, through the use of the t-distributed mixture models provided in OpenCyto (via flowClust [<xref ref-type="bibr" rid="CR26">26</xref>]) that can capture translated distributions regardless of the intensity scale unique to each imaging dataset.
<fig id="Fig8"><label>Fig. 8</label><caption><p>T cell population recovery comparison (<underline>notebook</underline>). <bold>a</bold> CD4/CD8 gating results, as determined by automatic gating functions in OpenCyto [<xref ref-type="bibr" rid="CR25">25</xref>], over two imaging replicates for each of 4 donors. While all images were collected over a field of view of the same size, samples for donors 40 and 41 were prepared at 3x higher cell concentrations to demonstrate that segmentation and intensity measurements are robust to greater image object densities. <bold>b</bold> Cell population size for both replicates compared to a single flow cytometry measurement for each donor as well as Pearson correlation demonstrating strong agreement between the two (r &gt; 0.99, <italic>P</italic> &lt; 0.0001, two-tailed t-test). <bold>c</bold> Cell images from donor 41 showing (from left to right): DAPI (blue) and PHA (red) stain, DAPI and PHA with cell and nuclei segmentations, and DAPI with CD4 (red) as well as CD8 (green). See supplementary file Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1 for a comparison of these results to those from the same workflow without much of the gating used here to remove invalid cells</p></caption><graphic xlink:href="12859_2019_3055_Fig8_HTML" id="MO8"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Cell size estimation</title>
      <p id="Par43">A second validation was also conducted to attempt recovery of known morphology differences between unstimulated and activated T cell samples. Samples were stained with DAPI and Phalloidin-Fluor 594 (PHA), the latter of which identifies cytoskeletal actin filaments and is used here to define cell boundaries. The Cytokit pipeline for processing both samples was configured to blur PHA images before applying a threshold to create a binary image used as a watershed segmentation mask, with nuclei as seeds. As in the previous experiments, Explorer was used to find appropriate gates for singlet cell populations before attempting to compare cell diameter distributions (Fig. <xref rid="Fig9" ref-type="fig">9</xref>).
<fig id="Fig9"><label>Fig. 9</label><caption><p>Cell diameter recovery workflow as annotated Explorer screenshots. <bold>a</bold> Unstimulated/naive cells with DAPI stain (gray), binary PHA image (red), and resulting cell segmentation (green). <bold>b</bold> Projection of modes in phalloidin/DAPI distribution to segmented cells in original image. <bold>c</bold> Diameter distribution comparison for unstimulated and activated samples along with corresponding single cell images</p></caption><graphic xlink:href="12859_2019_3055_Fig9_HTML" id="MO9"/></fig></p>
      <p id="Par44">Much like the previous section demonstrating estimation of CD4+/CD8+ T cell population sizes, obtaining accurate cell size distributions was found to be difficult without first establishing proper filters to eliminate debris, lysed cells, and poorly segmented nuclei. Similar procedures for assays based on dissociated cells, e.g. Flow and Mass Cytometry, are far more formalized yet satisfactory results can still be obtained with image cytometry as long as the relationships between spatial and expression dimensions can be properly characterized. As this characterization becomes more difficult across different experimental replicates and modalities, a series of similar experiments were also carried out to better define these difficulties on a larger scale. Figure <xref rid="Fig10" ref-type="fig">10</xref> demonstrates results from these experiments where a workflow based on automatic gating functions, with resulting filters validated against individual cell images in Explorer, was used to extract cell size distributions for different cell types, levels of magnification, and replicates for comparison to similar results from a dedicated cell counting device.
<fig id="Fig10"><label>Fig. 10</label><caption><p>T cell size recovery comparison (<underline>notebook</underline>) showing inferred cell diameter distributions (violin with bars indicating +/− 1 s.d.) vs point estimates of mean diameter from Thermo Fisher cell counter (dot) as well as filtered single cell population sizes (counts); All images taken at 20x magnification except where indicated otherwise. See supplementary file Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2 for a comparison of these results to those from the same workflow without much of the gating used here to remove invalid cells</p></caption><graphic xlink:href="12859_2019_3055_Fig10_HTML" id="MO10"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>Codex</title>
      <p id="Par45">Representative preparations of image datasets resulting from CODEX protocol applications were also carried out to characterize performance at a larger scale. The first of these included an analysis of the reference dataset shared by the CODEX authors which, in its totality, contains ~ 700 k cells spread across 9 individual tissue preparations and ~ 1.1 TB of microscope images. These images, of normal and autoimmune murine spleens, were prepared as separate replicates of tissue slides with a single replicate being subjected to 18 cycles of imaging (on a 9 × 7 grid) to capture 54 expression signals. Cytokit was applied to a single replicate containing 51,030 images (129GB) to demonstrate that cycle alignment, deconvolution, image quality assessment, and segmentation can be executed in ~ 80 min on one (2x Nvidia GTX 1080 GPU) workstation. Segmentation results*<xref ref-type="fn" rid="Fn1">1</xref> were visually and quantifiably similar to those in the original study (Fig. <xref rid="Fig11" ref-type="fig">11</xref>).
<fig id="Fig11"><label>Fig. 11</label><caption><p>BALB/c spleen (slide 1) CODEX image segmentation/quantification results. <bold>a</bold> ~ 200 cells with DRAQ5 nuclear stain (above) and corresponding cell/nucleus segmentation (below). <bold>b</bold> ~ 71 k cells in stitched, downscaled 9072 × 9408 pixel image showing IgD (green) and CD90 (red) expression as well as location of CD169+ marginal zone macrophages as white dots. <bold>c</bold> Double positive cell population rates post cleanup-gating with expected percentages in green</p></caption><graphic xlink:href="12859_2019_3055_Fig11_HTML" id="MO11"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Conclusion</title>
    <p id="Par47">Multiplexed, in-situ image cytometry offers many potential advantages over traditional single cell assays, but the volume of image data produced by these procedures makes processing and analyzing them difficult. Cytokit is an open source Python package that attempts to help overcome these issues by providing GPU-accelerated implementations of cycle registration and image deconvolution as well as an interactive user interface for characterizing the phenotypic features of cells alongside their spatial distribution. We find that understanding modalities in expression distributions as projections onto original images and the ability to iteratively optimize pipelines operating on large datasets are both important capabilities needed to achieve good results, even for the relatively simple tasks presented here such as size estimation and cellular marker profiling. We also find that the need for this software arises largely out of the inability of existing software packages to support experiments with large numbers of imaging channels well. It is likely that as CellProfiler continues to mature, it will eventually support a Python API that would make it possible to provide many of the same features with CP modules alone. Until then, Cytokit is an efficient, flexible pipeline suitable for bioinformaticians that need to process and analyze multiplexed imaging data.</p>
  </sec>
  <sec id="Sec13">
    <title>Methods</title>
    <p id="Par48">For all human primary T cell imaging datasets generated in this study, cells were isolated, cultured, activated, and prepared for immunofluorescence microscopy as previously described [<xref ref-type="bibr" rid="CR27">27</xref>]. PBMCs were isolated from healthy human donors (purchased from Plasma Consultants LLC, Monroe Township, NJ) by Ficoll centrifugation (Lymphocyte separation medium; Corning, Corning, NY). T cells were isolated using Dynabeads Untouched Human T Cells Kit using manufacturer’s protocols (Thermo Fisher, Waltham, MA). Isolated T cells were kept in T cell media: RPMI with L-glutamine (Corning), 10% fetal bovine serum (Atlas Biologicals, Fort Collins, CO), 50 uM 2-mercaptoethanol (EMD Millipore), 25 mM HEPES (HyClone, GE Healthcare, Chicago, IL), 1% Penicillin-Streptomycin (Thermo Fisher), 1X sodium pyruvate (HyClone, GE Healthcare, Chicago, IL), and 1X non-essential amino acids (HyClone, GE Healthcare). T cells were activated for 2 days with anti-CD3/CD28 magnetic dynabeads (Thermo Fisher) at a beads to cells concentration of 1:1, with supplement of 200 IU/ml of IL-2 (NCI preclinical repository) and then mounted onto a glass slide with the Prolong anti-fade mounting reagent. For samples stained with only DAPI and phalloidin, T cells from cultures were washed and re-suspended in PBS, fixed in 4% formaldehyde solution for 30 min, washed and stained with the phalloidin dye for 30 min within BD CytoPerm solution, and re-suspended in PBS before cytospinning. T cells from pmel-1 mouse were activated by adding 1 uM of gp100 peptide to freshly isolated splenocytes and culturing for 3 days.</p>
    <sec id="Sec14">
      <title>Protocol details</title>
      <p id="Par49">Culture media: DOI:10.17504/protocols.io.qu5dwy6</p>
      <p id="Par50">PBMC isolation from buffy coat: DOI:10.17504/protocols.io.qu2dwye</p>
      <p id="Par51">FL staining: <ext-link ext-link-type="uri" xlink:href="https://www.protocols.io/view/preparing-primary-t-cells-for-fluorescence-microsc-vede3a6">https://www.protocols.io/view/preparing-primary-t-cells-for-fluorescence-microsc-vede3a6</ext-link></p>
    </sec>
  </sec>
  <sec id="Sec15">
    <title>Availability and requirements</title>
    <p id="Par52"><bold>Project name</bold>: Cytokit.</p>
    <p id="Par53"><bold>Project home page</bold>: <ext-link ext-link-type="uri" xlink:href="https://github.com/hammerlab/cytokit">https://github.com/hammerlab/cytokit</ext-link></p>
    <p id="Par54"><bold>Operating system(s)</bold>: Linux, Mac OS X.</p>
    <p id="Par55"><bold>Programming language</bold>: Python.</p>
    <p id="Par56"><bold>Other requirements</bold>: Python 3.5 or higher.</p>
    <p id="Par57"><bold>License</bold>: Apache 2.0.</p>
    <p id="Par58"><bold>Any restrictions to use by non-academics</bold>: None beyond license terms.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec16">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3055_MOESM1_ESM.pdf">
            <label>Additional file 1:</label>
            <caption>
              <p><bold>Figure S1</bold> Supplement to Fig. <xref rid="Fig8" ref-type="fig">8</xref> demonstrating improvement in quantification after the inclusion of gates to remove debris and other segmentation artifacts. <bold>a</bold> CD4/CD8 cell populations for all 4 donors with both before and after groups including a terminal gate in the workflow to detect modes for each population, but all other gates left out in the “Before Quality Control Gating” example. <bold>b</bold> Cell population size for both replicates compared to flow cytometry measurements with improvement in correlation across populations after application of quality control gating (pearson correlation shown with significance from two-tailed t-test). (PDF 533 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_3055_MOESM2_ESM.pdf">
            <label>Additional file 2:</label>
            <caption>
              <p><bold>Figure S2</bold> Supplement to Fig. <xref rid="Fig10" ref-type="fig">10</xref> demonstrating improvement in quantification after the inclusion of gates to remove debris and other segmentation artifacts. Cell counts from the two workflows are shown below each diameter distribution (violin with bars indicating +/− 1 s.d.) and corresponding Thermo Fisher cell counter diameter measurements are shown as colored dots. (PDF 371 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CLI</term>
        <def>
          <p id="Par4">Command Line Interface</p>
        </def>
      </def-item>
      <def-item>
        <term>CODEX</term>
        <def>
          <p id="Par5">Co-detection by indexing</p>
        </def>
      </def-item>
      <def-item>
        <term>CP</term>
        <def>
          <p id="Par6">CellProfiler</p>
        </def>
      </def-item>
      <def-item>
        <term>DEI</term>
        <def>
          <p id="Par7">DNA Exchange Imaging</p>
        </def>
      </def-item>
      <def-item>
        <term>FCS</term>
        <def>
          <p id="Par8">Flow Cytometry Standard</p>
        </def>
      </def-item>
      <def-item>
        <term>GUI</term>
        <def>
          <p id="Par9">Graphical User Interface</p>
        </def>
      </def-item>
      <def-item>
        <term>I/O</term>
        <def>
          <p id="Par10">Input / Output</p>
        </def>
      </def-item>
      <def-item>
        <term>PHA</term>
        <def>
          <p id="Par11">Phalloidin-Fluor 594</p>
        </def>
      </def-item>
      <def-item>
        <term>TIFF</term>
        <def>
          <p id="Par12">Tagged ImageFile Format</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par46">CODEX reference data was already aligned and deconvolved so segmentation was applied separately from preprocessing operations used for time benchmarks</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Paulos Lab for providing previously acquired mouse PMEL cell samples and Mehtora Lab for help with the cytospin. They would also like to thank Google for supporting our work through providing research credits (#38362142) for the Google Cloud Platform, which enables us to share our complete raw imaging data set with other scientists. Additionally, they thank River Abedon for his contributions to our early image segmentation and modeling efforts. This work is supported in part by the Flow Cytometry and Cell Sorting Unit Shared Resource, Hollings Cancer Center, Medical University of South Carolina (P30 CA138313).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>EC designed and developed the software as well as wrote the paper. BAA and PA prepared all cell cultures and conducted the subsequent imaging. JH supervised both software and experimental design. All authors have read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported through funding provided by the MUSC Startup Fund with additional resources provided by the Flow Cytometry and Cell Sorting Unit Shared Resource, Hollings Cancer Center, Medical University of South Carolina (P30 CA138313). The funding body did not play any role in the design of the study, collection, analysis, and interpretation of data, or in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets generated for this study are available at <ext-link ext-link-type="uri" xlink:href="https://console.cloud.google.com/storage/browser/cytokit/datasets">https://console.cloud.google.com/storage/browser/cytokit/datasets</ext-link> and the related analysis as well as configurations necessary for reproduction can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/hammerlab/cytokit">https://github.com/hammerlab/cytokit</ext-link>. CODEX data used for comparison to results in the original publication can be found at <ext-link ext-link-type="uri" xlink:href="http://welikesharingdata.blob.core.windows.net/forshare/index.html">http://welikesharingdata.blob.core.windows.net/forshare/index.html</ext-link>.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par59">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par60">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par61">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spitzer</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
        </person-group>
        <article-title>Mass cytometry: single cells</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>165</volume>
        <fpage>780</fpage>
        <lpage>791</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.04.019</pub-id>
        <pub-id pub-id-type="pmid">27153492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feher</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>von Volkmann</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kirsch</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Radbruch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Popien</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kaiser</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Multispectral flow cytometry: The consequences of increased light collection</article-title>
        <source>Cytometry A</source>
        <year>2016</year>
        <volume>89</volume>
        <fpage>681</fpage>
        <lpage>689</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.22888</pub-id>
        <pub-id pub-id-type="pmid">27295550</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blom</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Paavolainen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bychkov</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Turkki</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mäki-Teeri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hemmes</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systems pathology by multiplexed immunohistochemistry and whole-slide digital image analysis</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>15580</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-15798-4</pub-id>
        <pub-id pub-id-type="pmid">29138507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angelo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bendall</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Finck</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hale</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Hitzman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Borowsky</surname>
            <given-names>AD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiplexed ion beam imaging of human breast tumors</article-title>
        <source>Nat Med</source>
        <year>2014</year>
        <volume>20</volume>
        <fpage>436</fpage>
        <lpage>442</lpage>
        <pub-id pub-id-type="doi">10.1038/nm.3488</pub-id>
        <pub-id pub-id-type="pmid">24584119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goltsev</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Samusik</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kennedy-Darling</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bhate</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hale</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vazquez</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep Profiling of Mouse Splenic Architecture with CODEX Multiplexed Imaging</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>968</fpage>
        <lpage>981</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.07.010</pub-id>
        <pub-id pub-id-type="pmid">30078711</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Woehrstein</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Donoghue</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Avendaño</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Schackmann</surname>
            <given-names>RCJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rapid sequential in situ multiplexing with DNA exchange imaging in neuronal cells and tissues</article-title>
        <source>Nano Lett</source>
        <year>2017</year>
        <volume>17</volume>
        <fpage>6131</fpage>
        <lpage>6139</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.nanolett.7b02716</pub-id>
        <pub-id pub-id-type="pmid">28933153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Lin J-R, Izar B, Wang S, Yapp C, Mei S, Shah PM, et al. Highly multiplexed immunofluorescence imaging of human tissues and tumors using t-CyCIF and conventional optical microscopes. Elife. 2018;7. 10.7554/eLife.31657.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hedley</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Keeney</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Technical issues: flow cytometry and rare event analysis</article-title>
        <source>Int J Lab Hematol</source>
        <year>2013</year>
        <volume>35</volume>
        <fpage>344</fpage>
        <lpage>350</lpage>
        <pub-id pub-id-type="doi">10.1111/ijlh.12068</pub-id>
        <pub-id pub-id-type="pmid">23590661</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schapiro</surname>
            <given-names>Denis</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>Hartland W</given-names>
          </name>
          <name>
            <surname>Raghuraman</surname>
            <given-names>Swetha</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>Jana R</given-names>
          </name>
          <name>
            <surname>Zanotelli</surname>
            <given-names>Vito R T</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>Daniel</given-names>
          </name>
          <name>
            <surname>Giesen</surname>
            <given-names>Charlotte</given-names>
          </name>
          <name>
            <surname>Catena</surname>
            <given-names>Raúl</given-names>
          </name>
          <name>
            <surname>Varga</surname>
            <given-names>Zsuzsanna</given-names>
          </name>
          <name>
            <surname>Bodenmiller</surname>
            <given-names>Bernd</given-names>
          </name>
        </person-group>
        <article-title>histoCAT: analysis of cell phenotypes and interactions in multiplex image cytometry data</article-title>
        <source>Nature Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>873</fpage>
        <lpage>876</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4391</pub-id>
        <pub-id pub-id-type="pmid">28783155</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Berthold</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Cebron</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dill</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Kötter</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meinl</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <source>KNIME: The Konstanz Information Miner. Studies in Classification, Data Analysis, and Knowledge Organization (GfKL 2007)</source>
        <year>2007</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rueden</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Schindelin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hiner</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>DeZonia</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Arena</surname>
            <given-names>ET</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ImageJ2: ImageJ for the next generation of scientific image data</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>529</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1934-z</pub-id>
        <pub-id pub-id-type="pmid">29187165</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Sommer C, Straehle C, Kothe U, Hamprecht FA. Ilastik: Interactive learning and segmentation toolkit: 2011 IEEE International Symposium on Biomedical Imaging: From Nano to Macro. New York: IEEE; 2011. 10.1109/isbi.2011.5872394.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carpenter</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Lamprecht</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>IH</given-names>
          </name>
          <name>
            <surname>Friman</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CellProfiler: image analysis software for identifying and quantifying cell phenotypes</article-title>
        <source>Genome Biol</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>R100</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2006-7-10-r100</pub-id>
        <pub-id pub-id-type="pmid">17076895</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>IH</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Lindquist</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Papallo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sabatini</surname>
            <given-names>DM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CellProfiler Analyst: data exploration and analysis software for complex image-based screens</article-title>
        <source>BMC Bioinformatics.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>482</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-482</pub-id>
        <pub-id pub-id-type="pmid">19014601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Abadi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Agarwal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barham</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brevdo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Citro</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Corrado</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dean</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Devin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ghemawat</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Goodfellow</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Harp</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Irving</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Isard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jozefowicz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kaiser</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kudlur</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Levenberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mané</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Monga</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Murray</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Olah</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shlens</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Steiner</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sutskever</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Talwar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tucker</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vanhoucke</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vasudevan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Viégas</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Vinyals</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Warden</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wattenberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wicke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <source>TensorFlow: Large-scale machine learning on heterogeneous systems</source>
        <year>2015</year>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guizar-Sicairos</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thurman</surname>
            <given-names>ST</given-names>
          </name>
          <name>
            <surname>Fienup</surname>
            <given-names>JR</given-names>
          </name>
        </person-group>
        <article-title>Efficient subpixel image registration algorithms</article-title>
        <source>Opt Lett</source>
        <year>2008</year>
        <volume>33</volume>
        <fpage>156</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="doi">10.1364/OL.33.000156</pub-id>
        <pub-id pub-id-type="pmid">18197224</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Walt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schönberger</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Nunez-Iglesias</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Boulogne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Warner</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Yager</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scikit-image: image processing in Python</article-title>
        <source>Peer J</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>e453</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.453</pub-id>
        <pub-id pub-id-type="pmid">25024921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Berndl</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Michael Ando</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Barch</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Narayanaswamy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Christiansen</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assessing microscope image focus quality with deep learning</article-title>
        <source>BMC Bioinformatics</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>77</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-018-2087-4</pub-id>
        <pub-id pub-id-type="pmid">29540156</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sage</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Donati</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Soulez</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fortun</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schmit</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Seitz</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DeconvolutionLab2: an open-source software for deconvolution microscopy</article-title>
        <source>Methods.</source>
        <year>2017</year>
        <volume>115</volume>
        <fpage>28</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2016.12.015</pub-id>
        <pub-id pub-id-type="pmid">28057586</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Blu</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate three-dimensional point spread function computation for fluorescence microscopy</article-title>
        <source>J Opt Soc Am A Opt Image Sci Vis</source>
        <year>2017</year>
        <volume>34</volume>
        <fpage>1029</fpage>
        <lpage>1034</lpage>
        <pub-id pub-id-type="doi">10.1364/JOSAA.34.001029</pub-id>
        <pub-id pub-id-type="pmid">29036087</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McQuin</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Goodman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chernyshev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kamentsky</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cimini</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Karhohs</surname>
            <given-names>KW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CellProfiler 3.0: Next-generation image processing for biology</article-title>
        <source>PLoS Biol</source>
        <year>2018</year>
        <volume>16</volume>
        <fpage>e2005970</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.2005970</pub-id>
        <pub-id pub-id-type="pmid">29969450</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Carpenter</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Golland</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <source>Voronoi-Based Segmentation of Cells on Image Manifolds. Lecture Notes in Computer Science</source>
        <year>2005</year>
        <fpage>535</fpage>
        <lpage>543</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>Eric Jones and Travis Oliphant and Pearu Peterson and others</collab>
        </person-group>
        <source>SciPy: Open source scientific tools for Python</source>
        <year>2001</year>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bradski</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>The OpenCV Library. Dr Dobb’s journal of software tools</source>
        <year>2000</year>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Frelinger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Newell</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Ramey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>MM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>OpenCyto: an open source infrastructure for scalable, robust, reproducible, and automated, end-to-end flow cytometry data analysis</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>e1003806</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003806</pub-id>
        <pub-id pub-id-type="pmid">25167361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lo</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hahne</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Brinkman</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Flowclust: a Bioconductor package for automated gating of flow cytometry data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>145</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-145</pub-id>
        <pub-id pub-id-type="pmid">19442304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Aksoy</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Aksoy</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wyatt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paulos</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hammerbacher</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Human primary T cells: a practical guide</source>
        <year>2018</year>
      </element-citation>
    </ref>
  </ref-list>
</back>
