<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Behav Neurosci</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Behav Neurosci</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Behav. Neurosci.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Behavioral Neuroscience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1662-5153</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6753174</article-id>
    <article-id pub-id-type="doi">10.3389/fnbeh.2019.00205</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Behavioral Neuroscience</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A Freely Available, Self-Calibrating Software for Automatic Measurement of Freezing Behavior</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Amorim</surname>
          <given-names>Felippe E.</given-names>
        </name>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="https://loop.frontiersin.org/people/747054/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moulin</surname>
          <given-names>Thiago C.</given-names>
        </name>
        <uri xlink:type="simple" xlink:href="https://loop.frontiersin.org/people/534138/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Amaral</surname>
          <given-names>Olavo B.</given-names>
        </name>
        <uri xlink:type="simple" xlink:href="https://loop.frontiersin.org/people/134889/overview"/>
      </contrib>
    </contrib-group>
    <aff><institution>Institute of Medical Biochemistry Leopoldo de Meis, Federal University of Rio de Janeiro</institution>, <addr-line>Rio de Janeiro</addr-line>, <country>Brazil</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Michael Fanselow, University of California, Los Angeles, United States</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Patrese A. Robinson-Drummer, New York University, United States; Raül Andero, Autonomous University of Barcelona, Spain</p>
      </fn>
      <corresp id="c001">*Correspondence: Felippe E. Amorim <email>felippe.amorim@bioqmed.ufrj.br</email></corresp>
      <fn fn-type="other" id="fn001">
        <p><bold>Specialty section:</bold> This article was submitted to Learning and Memory, a section of the journal Frontiers in Behavioral Neuroscience</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>205</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>8</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2019 Amorim, Moulin and Amaral.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Amorim, Moulin and Amaral</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Freezing behavior is commonly used as a measure of associative fear memory. It can be measured by a trained observer, but this task is time-consuming and subject to variation. Commercially available software packages can also be used to quantify freezing; however, they can be expensive and usually require various parameters to be adjusted by the researcher, leading to additional work and variability in results. With this in mind, we developed Phobos, a freely available, self-calibrating software that measures freezing in a set of videos using a brief manual quantification performed by the user to automatically adjust parameters. To optimize the software, we used four different video sets with different features in order to determine the most relevant parameters, the amount of videos needed for calibration and the minimum criteria to consider it reliable. The results of four different users were compared in order to test intra- and interobserver variability in manual and automated freezing scores. Our results suggest that Phobos can be an inexpensive, simple and reliable tool for measurement of fear-related behavior, with intra- and interuser variability similar to that obtained with manual scoring.</p>
    </abstract>
    <kwd-group>
      <kwd>freezing behavior</kwd>
      <kwd>fear conditioning</kwd>
      <kwd>software</kwd>
      <kwd>fear-related behavior</kwd>
      <kwd>video analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">Conselho Nacional de Desenvolvimento Científico e Tecnológico<named-content content-type="fundref-id">10.13039/501100003593</named-content></funding-source>
      </award-group>
      <award-group>
        <funding-source id="cn002">Fundação Carlos Chagas Filho de Amparo à Pesquisa do Estado do Rio de Janeiro<named-content content-type="fundref-id">10.13039/501100004586</named-content></funding-source>
        <award-id rid="cn002">E-26/203.222/2017, E-26/201.544/2014</award-id>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="8"/>
      <table-count count="2"/>
      <equation-count count="0"/>
      <ref-count count="16"/>
      <page-count count="12"/>
      <word-count count="7284"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="introduction" id="s1">
    <title>Introduction</title>
    <p>The pairing of a conditioned stimulus (CS, e.g., context) with an aversive unconditioned stimulus (US, e.g., electric shock) produces an association between stimuli that leads to fear conditioning, a phenomenon that is widely used to study memory in laboratory animals (Fendt and Fanselow, <xref rid="B5" ref-type="bibr">1999</xref>). Fear conditioning in rodents is typically measured by freezing behavior in response to the CS, a response defined as the suppression of all movements, except respiratory and cardiac ones.</p>
    <p>Freezing is easily quantified through visual examination by researchers with minimal training, either by direct observation or by analysis of video recordings. Although the method is considered reliable, issues such as subjectivity, interobserver variability and labor-intensiveness have led to the development of various automated methods to quantify freezing behavior, either based on physical setups (e.g., photobeam detectors, pressure sensors; Valentinuzzi et al., <xref rid="B16" ref-type="bibr">1998</xref>; Nielsen and Crnic, <xref rid="B11" ref-type="bibr">2002</xref>) or video analysis (Shoji et al., <xref rid="B15" ref-type="bibr">2014</xref>). In a systematic review of the rodent fear conditioning literature in 2013 (Carneiro et al., <xref rid="B3" ref-type="bibr">2018</xref>), 56.6% of studies used an automated system to assess freezing behavior (<xref rid="T1" ref-type="table">Table 1</xref>), mostly through the use of video-based systems. Of these automated tools, 79.7% were commercial systems, and only 2.9% were personalized or freely-available tools.</p>
    <table-wrap id="T1" position="float">
      <label>Table 1</label>
      <caption>
        <p>Quantification of freezing assessment methods in the rodent fear conditioning literature.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left" colspan="2" rowspan="1">Method of freezing assessment (<italic>n</italic> = 122)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="1" colspan="1">Automated</td>
            <td align="center" rowspan="1" colspan="1">69 (56.6%)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Software (<italic>n</italic> = 25)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">   VideoFreeze</td>
            <td align="center" rowspan="1" colspan="1">11 (15.9%)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">   AnyMaze</td>
            <td align="center" rowspan="1" colspan="1">4 (5.8%)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">   Other</td>
            <td align="center" rowspan="1" colspan="1">10 (14.5%)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Recording system (<italic>n</italic> = 35)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">   FreezeFrame</td>
            <td align="center" rowspan="1" colspan="1">22 (31.9%)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">   FreezeScan</td>
            <td align="center" rowspan="1" colspan="1">7 (10.1%)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">   Other</td>
            <td align="center" rowspan="1" colspan="1">6 (8.7%)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Unspecified automated method</td>
            <td align="center" rowspan="1" colspan="1">9 (13.1%)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Manual</td>
            <td align="center" rowspan="1" colspan="1">42 (34.4%)</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Not specified</td>
            <td align="center" rowspan="1" colspan="1">11 (9.0%)</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p><italic>We analyzed data from a previous systematic review (Carneiro et al., <xref rid="B3" ref-type="bibr">2018</xref>) and obtained the overall percentage of automated freezing assessment among articles using the task published in 2013. The software subheading includes software that operate on standard video files, while recording systems are methods requiring both software and an apparatus or hardware to operate</italic>.</p>
      </table-wrap-foot>
    </table-wrap>
    <p>Nevertheless, automated scoring methods have their disadvantages. Studies have shown that some systems have detection problems (e.g., poor signal-to-noise ratio) that render them incapable of making precise measurements (Richmond et al., <xref rid="B14" ref-type="bibr">1998</xref>; Anagnostaras et al., <xref rid="B2" ref-type="bibr">2000</xref>). In addition, most systems request parameter inputs from the researcher in order to calibrate the program. In EthoVision 3.1, for instance, one must choose the immobility threshold, image filters, frame rate and detection method (Pham et al., <xref rid="B13" ref-type="bibr">2009</xref>). This large number of parameters means that a reasonable amount of time and adjustment is required to set up the system in a specific laboratory. Finally, most systems have a high financial cost for acquisition and maintenance, putting them out of reach of many research groups, especially in developing countries.</p>
    <p>Another issue is that some currently available systems have not been well validated in the literature, or have shown limited correlation with human measurements. One study, for example, showed that even with a good correlation between a photobeam-based system and human observer, automated measurements were almost always higher than those obtained by manual scoring (Valentinuzzi et al., <xref rid="B16" ref-type="bibr">1998</xref>). Moreover, some studies describing automated systems do not compare them to other methods (Richmond et al., <xref rid="B14" ref-type="bibr">1998</xref>), while others use a single set of videos to analyze performance, with no mention of how different recording conditions can affect freezing measurements (Anagnostaras et al., <xref rid="B1" ref-type="bibr">2010</xref>; Shoji et al., <xref rid="B15" ref-type="bibr">2014</xref>).</p>
    <p>In the current study, we present Phobos, a freely available software developed in Matlab that is capable of automatically setting the optimal parameters for analyzing a given set of videos, based on a single 2-min manual measurement by the user. We show that the procedure is sufficient to achieve good performance for video sets recorded under most conditions, and that intra- and interobserver variability using the software is similar to that obtained manually. The software is made freely accessible both as Matlab code and as a standalone Windows application under a BSD-3 license, and can be an inexpensive, useful and time-saving tool for laboratories studying fear conditioning.</p>
  </sec>
  <sec id="s2">
    <title>Methods</title>
    <sec id="s2-1">
      <title>Software Description</title>
      <p>Code for the software was written in MATLAB 2017 (MathWorks) and is provided as supplementary material along with the user manual. Code can either be run on MATLAB or as a standalone program, both available under a BSD-3 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/Felippe-espinelli/Phobos">https://github.com/Felippe-espinelli/Phobos</ext-link>). For contact regarding the software, an e-mail address has been setup at <email>phobos.freezing@gmail.com</email>.</p>
      <p>The video analysis pipeline performed by the software is described in <xref ref-type="fig" rid="F1">Figure 1</xref>. The program analyzes video files in .avi format by converting frames to binary images with black and white pixels using Otsu’s method (Otsu, <xref rid="B12" ref-type="bibr">1979</xref>). Suggested minimum requirements for videos are a native resolution of 384 × 288 pixels and a frame rate of 5 frames/s, as the software has not been tested below those levels. The above mentioned resolution is for the whole video; however, as the crop image step reduces the amount of pixels used for analysis, a larger crop area is recommended when close to the minimum. Each pair of consecutive frames is compared, and the number of non-overlapping pixels between both frames is calculated. When this number is below a given threshold, the animal is considered to be freezing.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Pipeline for automated video analysis. Initially, the user manually quantifies a video to be used as the basis for calibration (top row). After this, the system calibrates two parameters (freezing threshold and minimum freezing time) to achieve the best possible correlation in the calibration video and uses these for automated video analysis. In this step, two adjacent frames of a video are converted into black and white images and compared to each other. The difference between both—i.e., the total amount of non-overlapping pixels, shown in white, is used as a measure of movement that will be counted as freezing behavior when it is (a) beneath the freezing threshold and (b) above the minimum freezing time. The next pair of consecutive frames is then compared, in order to produce a freezing estimate for the whole video or for specific epochs within it. After quantification of the last video, the user sets the time bins in which freezing values will be displayed and exports results to an .xls file.</p>
        </caption>
        <graphic xlink:href="fnbeh-13-00205-g0001"/>
      </fig>
      <p>For calibration, a reference video is chosen to be scored manually by the user using the software interface. The user is asked to press a button each time the animal freezes to start quantification of freezing time, and to press it again to stop it. For each video, an output file is created containing the timestamp for every frame in which the observer judged the rodent to be freezing. A warning message appears if freezing scores for manual quantification represent less than 10% or more than 90% of the total video time, as both situations can compromise calibration.</p>
      <p>The data is analyzed in blocks of 20 s, and freezing time is calculated for each of these bins. The same video is then analyzed automatically by the software using various combinations of two parameters (freezing threshold and minimum freezing time), and the results for each 20-s block are systematically compared with the experimenter’s manual freezing score for the corresponding epoch. Methods for determining parameters, calibration duration and validation criteria will be detailed in the software validation section.</p>
      <p>The 10 parameter combinations leading to the highest correlation between manual and automatic scoring for 20-s epoch freezing times (measured in Pearson’s <italic>r</italic>) are initially chosen, and a linear fit for each one is generated. Among these, the software then selects the five combinations of parameters with the slopes closest to 1, and after that, the one with the intercept closest to 0, in order to avoid choosing a combination of parameters with good correlation and poor linear fit for absolute freezing values. For each reference video, a MAT file containing the best parameters is created and can be used as a calibration reference for use in other videos recorded under similar conditions.</p>
    </sec>
    <sec id="s2-2">
      <title>Validation</title>
      <sec id="s2-2-1">
        <title>Video Sets</title>
        <p>Videos for testing the software were obtained from three different laboratories recording rodent fear conditioning experiments using different systems. These videos had been recorded for distinct studies and had been previously reviewed and approved by the animal ethics committees of their respective institutions. <xref rid="T2" ref-type="table">Table 2</xref> shows video features considered relevant for freezing detection, such as frame rate, contrast between animal and environment, presence of mirror artifacts (i.e., reflections caused by out of focus recording and reflective surfaces); and recording angle used during the experiments. All videos had a duration of 120 s and were converted to .avi as a standard input format.</p>
        <table-wrap id="T2" position="float">
          <label>Table 2</label>
          <caption>
            <p>Video set features.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="left" rowspan="1" colspan="1">Set</th>
                <th align="left" rowspan="1" colspan="1">Animals</th>
                <th align="center" rowspan="1" colspan="1">
                  <italic>n</italic>
                </th>
                <th align="center" rowspan="1" colspan="1">Frame rate</th>
                <th align="left" rowspan="1" colspan="1">Recording angle</th>
                <th align="left" rowspan="1" colspan="1">Contrast</th>
                <th align="left" rowspan="1" colspan="1">Mirror artifact</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">Swiss mice</td>
                <td align="center" rowspan="1" colspan="1">13</td>
                <td align="center" rowspan="1" colspan="1">30</td>
                <td align="left" rowspan="1" colspan="1">Horizontal</td>
                <td align="left" rowspan="1" colspan="1">Good</td>
                <td align="left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">Swiss mice</td>
                <td align="center" rowspan="1" colspan="1">15</td>
                <td align="center" rowspan="1" colspan="1">30</td>
                <td align="left" rowspan="1" colspan="1">Horizontal</td>
                <td align="left" rowspan="1" colspan="1">Medium</td>
                <td align="left" rowspan="1" colspan="1">Yes</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">Lister Hooded rats</td>
                <td align="center" rowspan="1" colspan="1">14</td>
                <td align="center" rowspan="1" colspan="1">25</td>
                <td align="left" rowspan="1" colspan="1">Vertical</td>
                <td align="left" rowspan="1" colspan="1">Medium</td>
                <td align="left" rowspan="1" colspan="1">No</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">Wistar rats</td>
                <td align="center" rowspan="1" colspan="1">12</td>
                <td align="center" rowspan="1" colspan="1">24</td>
                <td align="left" rowspan="1" colspan="1">Diagonal</td>
                <td align="left" rowspan="1" colspan="1">Poor</td>
                <td align="left" rowspan="1" colspan="1">No</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p><italic>The four video sets used to evaluate the software are classified by animal species and strain, frame rate (in frames/s), contrast between the animals and the environment, presence of a mirror artifact (i.e., duplication and/or blurring of the image due to a reflective surface between the animal and the camera) and recording angle used during the experiments</italic>.</p>
          </table-wrap-foot>
        </table-wrap>
        <p>Freezing behavior was scored by four different human observers in each video using the software. Experimenters used the same software interface used for calibration, in which they were asked to press a button to record the start of freezing behavior, and to press it again to signal its cessation. For each observer, a MAT file with the beginning and end of each freezing epoch was created to be accessed by the software during the parameter adjusting and validation phases.</p>
      </sec>
      <sec id="s2-2-2">
        <title>Parameter Selection</title>
        <p>To validate the software, we first tested which parameters improved the correlation with a human observer when adjusted by automatic calibration. The tested parameters were: (a) the freezing threshold, defined as the quantity of non-overlapping pixels between adjacent frames below which the animal was considered to be freezing; (b) the use of separate thresholds to begin and end the recording of freezing epochs; and (c) the minimum freezing time for an epoch, defined as the minimum amount of frames in which the score needed to remain below threshold to be counted. Thresholds was varied between 100 and 6,000 pixels with steps of 100, while minimum freezing time varied between 0 and 2 s with steps of 0.25. For these validation steps, we used all videos from each set to calibrate the parameters.</p>
        <p>For parameter selection, we correlated the total freezing time recorded by the software under each parameter combination with the experimenter’s manual freezing score for each 2-min video using Pearson’s <italic>r</italic>. Correlation between automated and manual scores was performed with optimization of each parameter (e.g., choosing the parameter yielding the best correlation) and without it (e.g., using a default value—namely, 500 pixels for freezing thresholds and 0 s for minimum freezing time) in order to assess their importance (<xref ref-type="fig" rid="F2">Figures 2</xref>–<xref ref-type="fig" rid="F4">4</xref>). To compare correlation coefficients obtained in the presence or absence of each parameter, we used Fisher’s transformations to transform <italic>r</italic>-values into <italic>z</italic> scores, followed by a <italic>z</italic>-test (Diedenhofen and Musch, <xref rid="B4" ref-type="bibr">2015</xref>). Linear regression was used to determine slope and intercept values between manual and automatic scores. For each video set, we also compared slope and intercept between the linear regressions obtained in the presence or absence of each parameter using ANCOVA (intercept comparisons were only performed when there was no significant difference between slopes).</p>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p>Effects of varying freezing threshold on software performance. Correlations of automated freezing measurements (y axis) using a fixed (red) or variable (blue) threshold with those measured by a human observer (manual freezing, x axis) for the four video sets. Each point represents the total freezing time measured in a 2-min video. Each subpanel shows the values for Pearson’s coefficient (<italic>r</italic>), slope (<italic>β</italic>) and corresponding <italic>p</italic>-value for each correlation. Comparisons between correlations, slopes and intercepts are as follows: <bold>(A)</bold>
<italic>r</italic>-value, <italic>p</italic> = 0.03; slope, <italic>p</italic> = 0.002; <bold>(B)</bold>
<italic>r</italic>-value, <italic>p</italic> = 0.86; slope, <italic>p</italic> = 0.56; intercept, <italic>p</italic> &lt; 0.0001; <bold>(C)</bold>
<italic>r</italic>-value, <italic>p</italic> = 1; slope, <italic>p</italic> = 1; intercept, <italic>p</italic> = 1; <bold>(D)</bold>
<italic>r</italic>-value, <italic>p</italic> = 0.09; slope, <italic>p</italic> = 0.25; intercept, <italic>p</italic> &lt; 0.0001.</p>
          </caption>
          <graphic xlink:href="fnbeh-13-00205-g0002"/>
        </fig>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p>Effects of using a single or dual threshold on software performance. Correlations of automated freezing measurements using a single variable threshold (red) or two variable thresholds (blue; y axis) with those measured by a human observer (manual freezing, x axis) for the four video sets. Each point represents the total freezing time measured in a 2-min video. Each figure shows the values for Pearson’s coefficient (<italic>r</italic>), slope (<italic>β</italic>) and corresponding <italic>p</italic>-value for each correlation. Comparisons between correlations, slopes and intercepts are as follows: <bold>(A)</bold>
<italic>r</italic>-value, <italic>p</italic> = 1; slope, <italic>p</italic> = 1; intercept, <italic>p</italic> = 1; <bold>(B)</bold>
<italic>r</italic>-value, <italic>p</italic> = 0.82; slope, <italic>p</italic> = 0.87; intercept, <italic>p</italic> = 0.02; <bold>(C)</bold>
<italic>r</italic>-value, <italic>p</italic> = 0.92; slope, <italic>p</italic> = 0.41; intercept, <italic>p</italic> &lt; 0.0001; <bold>(D)</bold>
<italic>r</italic>-value, <italic>p</italic> = 0.39; slope, <italic>p</italic> = 0.003.</p>
          </caption>
          <graphic xlink:href="fnbeh-13-00205-g0003"/>
        </fig>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p>Effect of a minimum freezing time on software performance. Correlation of automated freezing measurements using a fixed minimum (red) or variable minimum freezing duration (blue; y axis) with those measured by a human observer (manual freezing, x axis) for the four video sets. Each point represents the total freezing time measured in a 2-min video. Each figure shows the values for Pearson’s coefficient (<italic>r</italic>), slope (<italic>β</italic>) and corresponding <italic>p</italic>-value for each correlation. Comparisons between correlations, slopes and intercepts are as follows: <bold>(A)</bold>
<italic>r</italic>-value, <italic>p</italic> = 0.91; slope, <italic>p</italic> = 0.81; intercept, <italic>p</italic> = 0.43; <bold>(B)</bold>
<italic>r</italic>-value, <italic>p</italic> = 0.81; slope, <italic>p</italic> = 0.76; intercept, <italic>p</italic> = 0.0009; <bold>(C)</bold>
<italic>r</italic>-value, <italic>p</italic> = 0.35; slope, <italic>p</italic> = 0.08; intercept, <italic>p</italic> &lt; 0.0001; <bold>(D)</bold>
<italic>r</italic>-value, <italic>p</italic> = 0.78; slope, <italic>p</italic> = 0.87; intercept, <italic>p</italic> = 0.28.</p>
          </caption>
          <graphic xlink:href="fnbeh-13-00205-g0004"/>
        </fig>
      </sec>
      <sec id="s2-2-3">
        <title>Calibration Requirements</title>
        <p>We then studied the amount of videos needed to provide reliable calibration and defined criteria to establish whether a video could be reliably used to calibrate the system. For this, we examined the correlation between manual and automatic scoring using all possible combinations of 1, 2 or 3 videos of a set for calibration, yielding a total of 2, 4 or 6 min of video time to be analyzed in this step, respectively. Thus, calibration was performed based on either 6, 12 or 18 20-s blocks for correlation with manual scoring, in order to analyze whether this led to an improvement (<xref ref-type="fig" rid="F5">Figure 5</xref>). A one-way ANOVA with Tukey’s <italic>post hoc</italic> test was used to compare the <italic>r</italic>-values obtained with each approach (<xref ref-type="fig" rid="F5">Figure 5</xref>).</p>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p>Number of videos used for calibration and software performance. Line histograms of correlation values obtained for the four video sets after performing calibration using different combinations of one (red), two (blue) or three (green) videos (2, 4 or 6 min of video time, respectively). <bold>(A)</bold> Set 1: <italic>n</italic> = 13 (2 min), 78 (4 min) or 286 (6 min). One-way ANOVA, <italic>p</italic> = 0.11; Tukey’s <italic>post hoc</italic>, 2 min vs. 4 min, <italic>p</italic> = 0.94; 2 min vs. 6 min, <italic>p</italic> = 0.46; 4 min vs. 6 min, <italic>p</italic> = 0.15. <bold>(B)</bold> Set 2: <italic>n</italic> = 15 (2 min), 105 (4 min) or 455 (6 min). One-way ANOVA, <italic>p</italic> = 0.44; Tukey’s <italic>post hoc</italic>, 2 min vs. 4 min, <italic>p</italic> = 0.99; 2 min vs. 6 min, <italic>p</italic> = 0.88; 4 min vs. 6 min, <italic>p</italic> = 0.44. <bold>(C)</bold> Set 3: <italic>n</italic> = 14 (2 min), 91 (4 min) or 364 (6 min). One-way ANOVA, <italic>p</italic> = 0.011; Tukey’s <italic>post hoc</italic>, 2 min vs. 4 min, <italic>p</italic> = 0.76; 2 min vs. 6 min, <italic>p</italic> = 0.85; 4 min vs. 6 min, <italic>p</italic> = 0.008. <bold>(D)</bold> Set 4: <italic>n</italic> = 12 (2 min), 66 (4 min) or 220 (6 min). One-way ANOVA, <italic>p</italic> = 0.77; Tukey’s <italic>post hoc</italic>, 2 min vs. 4 min, <italic>p</italic> = 0.76; 2 min vs. 6 min, <italic>p</italic> = 0.83; 4 min vs. 6 min, <italic>p</italic> = 0.94.</p>
          </caption>
          <graphic xlink:href="fnbeh-13-00205-g0005"/>
        </fig>
        <p>To analyze whether a specific video could be used as a reliable template for calibration, we tested the effect of using different minimum thresholds for <italic>r</italic> and slope values at the calibration step—i.e., on a single 2-min video—on performance of the software on the rest of the video set. For this, we build receiver operating characteristic (ROC) curves to predict whether calibration using a specific video would yield an <italic>r</italic>-value of at least 0.6 between automated and manual scoring in the whole video set, using either the <italic>r</italic>-value or the slope (<italic>β</italic>) of the calibration video as a predictor. Values for <italic>r</italic> and slope leading to optimal sensitivity and sensitivity were selected for further analysis. We then investigated the sensitivity and specificity of these parameters to predict correlation values other than 0.6 in the whole set (<xref ref-type="fig" rid="F6">Figure 6</xref>).</p>
        <fig id="F6" position="float">
          <label>Figure 6</label>
          <caption>
            <p>Evaluation of minimum criteria for valid videos. <bold>(A)</bold> Receiver operating characteristic (ROC) curve used for estimating accuracy, sensitivity and specificity of different <italic>r</italic>-values (blue line) and slopes (green line) at calibration to predict a correlation with <italic>r</italic> &gt; 0.6 for the whole video set. Optimal sensitivity and specificity values to detect valid videos were 0.73 and 0.64 for <italic>r</italic> &gt; 0.963 and 0.70 and 0.71 for <italic>β</italic> &gt; 0.84. <bold>(B)</bold> Line graph depicting sensitivity (y axis, blue line) and specificity (y axis, orange line) of the chosen validation criteria (<italic>r</italic> &gt; 0.963 and <italic>β</italic> &gt; 0.84) to predict different minimum values of r in the whole video set (x axis).</p>
          </caption>
          <graphic xlink:href="fnbeh-13-00205-g0006"/>
        </fig>
      </sec>
      <sec id="s2-2-4">
        <title>Interuser Variation</title>
        <p>Finally, we studied the impact of the software on interuser variability. For this purpose, we used calibrations performed by four different users, using the first video to reach minimum criteria for all experimenters in each set, thus obtaining four different parameter files for the same video. A correlation matrix was then built to compare manual scores from the four observers and automatic scores using each of the four calibrations among themselves (<xref ref-type="fig" rid="F7">Figure 7</xref>). To analyze the impact of different sources of variability, we used one-way ANOVA with Tukey’s <italic>post hoc</italic> test to compare <italic>r</italic>-values for correlations between: (a) manual scores by different users; (b) automated scores based on calibrations by different users; (c) manual and automated scores using the user’s own calibration; and (d) manual and automated scores using another user’s calibration. We also investigated whether the video used for calibration influenced interuser variability by performing linear regressions between the automatic scores of two observers using the same video or randomly chosen videos passing minimum criteria (<xref ref-type="fig" rid="F8">Figure 8</xref>). We used Fisher’s transformation followed by a <italic>z</italic>-test to compare the correlation coefficients obtained in each group. Linear regression was used to determine slope and intercept values for the three groups, followed by an ANCOVA for comparison of slopes.</p>
        <fig id="F7" position="float">
          <label>Figure 7</label>
          <caption>
            <p>Intra- and interuser variability for manual and automated scoring. Heat maps show correlation matrices between manual freezing measurements of four experimenters (M1–M4) and automated assessment based on each user’s calibration (A1–A4) for the four video sets. (Right columns) Distribution of <italic>r</italic>-values for manual vs. manual interobserver correlations (MxM, <italic>n</italic> = 12); automated vs. automated interuser correlations (AxA, <italic>n</italic> = 12); manual vs. automated intra-user correlations [MxA (Intra), <italic>n</italic> = 4] and manual vs. automated interuser correlations MxA (Inter), <italic>n</italic> = 12). <bold>(A)</bold> Set 1. One-way ANOVA, <italic>p</italic> = 0.0064; <bold>(B)</bold> one-way ANOVA, <italic>p</italic> &lt; 0.0001; <bold>(C)</bold> one-way ANOVA, <italic>p</italic> = 0.0072; <bold>(D)</bold> one-way ANOVA, <italic>p</italic> &lt; 0.0001. For statistical comparisons between specific groups, see <xref ref-type="supplementary-material" rid="SM1">Supplementary Table S1</xref>.</p>
          </caption>
          <graphic xlink:href="fnbeh-13-00205-g0007"/>
        </fig>
        <fig id="F8" position="float">
          <label>Figure 8</label>
          <caption>
            <p>Interuser correlations for different measurements. Correlation between two independent experimenters’ freezing measurements using manual quantification (red), automated quantification using the same video (blue) or different videos passing calibration criteria (green). Comparisons between correlation coefficients are as follows: <bold>(A)</bold> MxM vs. auto (same video), <italic>p</italic> = 0.30; MxM vs. auto (different video), <italic>p</italic> = 0.44; auto (same video) vs. auto (different video), <italic>p</italic> = 0.07; <bold>(B)</bold> MxM vs. auto (same video), <italic>p</italic> = 0.38; MxM vs. auto (different video), <italic>p</italic> = 0.78; auto (same video) vs. auto (different video), <italic>p</italic> = 0.55; <bold>(C)</bold> MxM vs. auto (same video), <italic>p</italic> = 0.27; MxM vs. auto (different video), <italic>p</italic> = 0.27; auto (same video) vs. auto (different video), <italic>p</italic> = 1; <bold>(D)</bold> MxM vs. auto (same video), <italic>p</italic> = 0.08; MxM vs. auto (different video), <italic>p</italic> = 0.0005; auto (same video) vs. auto (different video), <italic>p</italic> = 0.08.</p>
          </caption>
          <graphic xlink:href="fnbeh-13-00205-g0008"/>
        </fig>
      </sec>
    </sec>
    <sec id="s2-3">
      <title>Statistical Analysis</title>
      <p>Significance was set at <italic>α</italic> = 0.05, with data presented as mean ± SEM. IBM SPSS 21 (ROC curve), Matlab 2017 (Fisher Z transformation and <italic>Z</italic>-test) and Graphpad Prism 7 (linear regression, one-way ANOVA, Tukey’s <italic>post hoc</italic>, correlation matrix and ANCOVA) were used for the analysis.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s3">
    <title>Results</title>
    <sec id="s3-1">
      <title>Effect of Different Parameters on Correlations Between Automatic and Manual Freezing Scores</title>
      <sec id="s3-1-1">
        <title>Variable vs. Fixed Threshold</title>
        <p>To test whether the use of a variable threshold results in better automated freezing scores than a fixed threshold, we correlated manual freezing scores for the four video sets with those obtained using: (a) a fixed threshold of 500 pixels varying between frames for freezing detection; or (b) a variable threshold ranging from 100 to 6,000 pixels with steps of 100, in which the best parameter was selected based on correlations between manual and automatic freezing detection (see “Methods” section).</p>
        <p>We found a difference between the <italic>r</italic>-values with both approaches in set 1 (<italic>r</italic> = 0.99 with variable threshold vs. 0.9 with fixed threshold, <italic>p</italic> = 0.03), but not in sets 2 (<italic>p</italic> = 0.86) or 3 (<italic>p</italic> = 1); in the later, the chosen threshold was the same as the fixed one (<xref ref-type="fig" rid="F2">Figure 2</xref>). Set 4 had a large but non-significant increase in <italic>r</italic>-value with variable threshold (0.7 vs. 0.08, <italic>p</italic> = 0.09). There were significant differences between slopes in set 1 (1.03 vs. 0.65, <italic>p</italic> = 0.0017) and between intercepts in two sets (6.66 vs. 57.76, set 2, <italic>p</italic> &lt; 0.0001; 103.9 vs. 12.51, set 4, <italic>p</italic> &lt; 0.0001), leading to an improvement in the similarity of absolute values with manual freezing scores in sets 1 and 2. In set 4, in which the quality of video recording was poor, neither approach was able to provide meaningful correlations between both scores.</p>
      </sec>
      <sec id="s3-1-2">
        <title>Single vs. Dual Threshold</title>
        <p>While the use of a variable threshold improved the correlation and linear fit of the software when compared with a fixed threshold, other parameters could be added in order to optimize calibration. We first tested a dual threshold, in which different movement levels are used to start and end the counting of freezing behavior. While there was no difference between both approaches in their correlation with manual scores (<xref ref-type="fig" rid="F3">Figure 3</xref>), they led to significantly different slopes for set 4 (0.43 with dual threshold vs. 0.12 with single threshold, <italic>p</italic> = 0.003) and different intercepts for sets 2 (29.3 vs. 6.7, <italic>p</italic> = 0.019) and 3 (11.2 vs. 51.6, <italic>p</italic> &lt; 0.0001). Nevertheless, there was no clear improvement in accuracy (as in the case of set 2, the correspondence of absolute values was actually better with the single threshold approach). Moreover, the use of a second threshold led to a significant increase in processing time (<xref ref-type="supplementary-material" rid="SM1">Supplementary Figure S1</xref>), which led us to opt for the single threshold method.</p>
      </sec>
      <sec id="s3-1-3">
        <title>Fixed vs. Variable Minimum Freezing Time</title>
        <p>The third parameter varied was the minimum duration for a freezing epoch to be counted, comparing the use of a variable minimum freezing time against a fixed one. There was no significant difference between correlations or slopes obtained using both approaches in any of the video sets (<xref ref-type="fig" rid="F4">Figure 4</xref>), but <italic>r</italic>-values were equal or greater when minimum freezing times were used in the four sets, with a non-significant improvement in the slope of set 3 (0.77 with variable minimum vs. 0.48 with fixed minimum, <italic>p</italic> = 0.08). Once more, there was a difference in the intercepts of sets 2 (40.9 vs. 6.7, <italic>p</italic> = 0.0009) and 3 (1.8 vs. 51.6, <italic>p</italic> &lt; 0.0001), with an improvement in the correspondence of absolute values in set 3 and a worsening in set 2. As varying the minimum freezing time did not add as much processing time as the dual-threshold approach (<xref ref-type="supplementary-material" rid="SM1">Supplementary Figure S1</xref>), we chose to include this parameter in software calibration.</p>
      </sec>
    </sec>
    <sec id="s3-2">
      <title>A Single 2-Min Video Is Sufficient for Calibration</title>
      <p>The next step was to define the amount of videos that had to be manually scored to provide reliable calibration. To analyze this, a combination of one, two or three 2-min videos (corresponding to 2, 4 or 6 min of video time) was used to calibrate the two variable parameters (variable threshold and freezing time) on the basis of the best fit between manual and automatic calibration. The chosen parameters were then used to automatically score freezing behavior in the remaining videos.</p>
      <p><xref ref-type="fig" rid="F5">Figure 5</xref> shows the frequency distribution of <italic>r</italic>-values for each set after calibration with 2, 4 or 6 min of video time using different videos or video combinations. Using more videos to calibrate the software did not appreciably change the frequency distribution of correlation values. An ANOVA used to compare the <italic>r</italic>-values among the three approaches in each set detected significant differences only in set 3 (<italic>p</italic> = 0.011). However, Tukey’s <italic>post hoc</italic> comparisons only showed a difference between the 4- and 6-min groups (4 min vs. 6 min, <italic>p</italic> = 0.008). We thus judged that the use of additional videos did not lead to a meaningful improvement in calibration and that a single manually scored 2-min video was enough for selecting parameters.</p>
    </sec>
    <sec id="s3-3">
      <title>Defining Automatic Criteria to Validate Calibration</title>
      <p>Although adding more videos did not improve calibration, the variability within each group in <xref ref-type="fig" rid="F5">Figure 5</xref> shows that the specific video (or video combination) used for calibration can have a large impact on software performance. This is predictable, as videos with very low or high freezing levels, for example, might not provide enough data for adequate calibration. Thus, calibration using a single video does not always provide the best parameters to quantify a whole set. Nevertheless, it is reasonable to assume that this is less likely to happen if correlation and slope values are high for the calibration video; thus, validating calibration on the basis of this criteria might help in choosing an adequate video.</p>
      <p>To establish minimum criteria to validate a video as a calibration template, we asked what <italic>r</italic> or slope values obtained in calibration could be used as thresholds to predict an <italic>r</italic>-value of at least 0.6 in the whole video set to which the calibration video belonged. For this, we built ROC curves to calculate the thresholds for correlation coefficients and slope values that provided optimal sensitivity and specificity values to detect valid videos in the four sets. The optimal thresholds for <italic>r</italic>-values and slope in the calibration step were 0.963 and 0.84, respectively (<xref ref-type="fig" rid="F6">Figure 6A</xref>), which provided sensitivity and specificity values of 0.78 and 0.615, respectively. These thresholds were subsequently used as criteria to define calibration as valid for analysis, and incorporated in the software in order to inform users whether calibration was deemed adequate. The sensitivity of this combination of <italic>r</italic> and slope to predict different outcomes (e.g., different minimum <italic>r</italic>-values for the whole set of videos to which the calibration video belongs) is shown in <xref ref-type="fig" rid="F6">Figure 6B</xref>.</p>
    </sec>
    <sec id="s3-4">
      <title>Effects of Automated Scoring on Intra- and Interuser Variability</title>
      <p>To evaluate the impact of using automated scoring on the intra- and interuser variability of freezing measurements, we had four independent observers manually score the four video sets. We then scored the same videos automatically based on calibrations performed by each of the observers, using the first video that provided valid calibration for all users within each video set. A correlation matrix was then built between the four manual scores and the automatic scores obtained with the four calibrations (<xref ref-type="fig" rid="F7">Figure 7</xref>, left columns).</p>
      <p>All correlations in set 1 were highly significant (<italic>p</italic> &lt; 0.0001), with <italic>r</italic>-values above 0.93. Interuser agreement was similar when using manual and automatic scores (<xref ref-type="fig" rid="F7">Figure 7A</xref>, right column, MxM vs. AxA; <italic>p</italic> = 0.72, Tukey’s test). Agreement between manual and automatic scores was also similar whether automatic scoring was calibrated by the same user that performed manual counting or a different one [<xref ref-type="fig" rid="F7">Figure 7A</xref>, MxA (intra) vs. MxA (inter); <italic>p</italic> = 0.98, Tukey’s test], although slightly lower than interuser agreements within the same category (i.e., MxM, <italic>p</italic> = 0.006; AxA, <italic>p</italic> = 0.08). This suggests that, for high-quality videos, manual and automatic scoring provide similarly high interuser agreement.</p>
      <p>For sets 2 and 3, agreement was also high among observers using either manual or automated scoring, with <italic>r</italic>-values above 0.90 (<italic>p</italic> &lt; 0.0001 for all cases). Correlations between automatic and manual scoring were high in set 3 (<xref ref-type="fig" rid="F7">Figure 7C</xref>, left column, <italic>r</italic> = 0.72–0.93, <italic>p</italic> &lt; 0.0001 for all cases), but not as good in set 2 (<xref ref-type="fig" rid="F7">Figure 7B</xref>, left column, <italic>r</italic> = 0.62–0.78, <italic>p</italic> &lt; 0.02 for all cases). In set 4 (<xref ref-type="fig" rid="F7">Figure 7D</xref>, left column), there was no significant correlation between manual and automated scoring in any case (<italic>p</italic> &gt; 0.1 in all cases), with some negative <italic>r</italic>-values in the correlation matrix. Interuser agreement after automated calibration was also poor in some cases, showing that automatic scoring is heavily dependent on video quality, even after optimal calibration.</p>
      <p><xref ref-type="fig" rid="F8">Figure 8</xref> shows that interuser correlations between the automated scores of two observers were better when the same videos were used for calibration (blue lines) than when different videos were used (green lines), even when both videos passed calibration criteria. Nevertheless, even when calibration was performed with different videos, correlations were still high for all sets. Thus, no significant difference was found between <italic>r</italic>-values, with the exception of set 4, in which video quality was markedly lower than in the other ones. An ANCOVA for comparing slopes revealed no significant difference between the regression lines obtained for manual × manual, automated × automated (same video) and automated × automated (different videos) correlations between these observers (<xref ref-type="fig" rid="F8">Figure 8A</xref>, <italic>p</italic> = 0.19; <xref ref-type="fig" rid="F8">Figure 8B</xref>, <italic>p</italic> = 0.63; <xref ref-type="fig" rid="F8">Figure 8C</xref>, <italic>p</italic> = 0.76; <xref ref-type="fig" rid="F8">Figure 8D</xref>, <italic>p</italic> = 0.73).</p>
      <p>Choosing different videos for calibration also led to variability within a single observer’s automatic measurements (<xref ref-type="supplementary-material" rid="SM1">Supplementary Figure S2</xref>), although this was minor in set 1, with <italic>r</italic> &gt; 0.86 for correlations involving all but one of the calibration videos that passed minimum criteria. For other sets, the number of videos reaching minimum calibration criteria was insufficient to adequately perform this analysis.</p>
    </sec>
    <sec id="s3-5">
      <title>User Interface Testing</title>
      <p>After the main software features were established and intra- and interuser variability was determined, the user interface went through two rounds of beta testing. A first round involved four users, who ran the software on the first version of the Matlab code and suggested features to be added to the user interface. Stopwatches for manual quantification, sliders to set the start and finish time for each video and progress bars for processing steps were added at this point. After this, a second round of testing involved two of these users and an additional researcher who had no previous contact with the software was used to detect bugs in the system—including both the MATLAB code and compiled version—using different hardware and operational systems. Further options for the output file were also added at this step.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>Discussion</title>
    <p>We have developed a freely-available, self-calibrating software to automatically score rodent freezing behavior during fear conditioning protocols using .avi video files. Our system shows good performance using a combination of movement threshold and minimum freezing time duration as variable parameters set by the system on the basis of manual calibration using a single 2-min video.</p>
    <p>Existing software to assess freezing behavior use parameters similar to those tested in our study, as well as others such as object intensity and frame rate (Pham et al., <xref rid="B13" ref-type="bibr">2009</xref>; Shoji et al., <xref rid="B15" ref-type="bibr">2014</xref>). While we did not test all parameters used in these software packages, the inclusion of independent thresholds for initiating and ending freezing epochs did not significantly improve performance in our study. As our results show good agreement between automated and manual scoring with only two parameters, the use of several variables in freezing measurement systems might not be necessary and could be a complicating factor if the user needs to set them up manually.</p>
    <p>Several studies have described video-analyzing systems with good performance in freezing detection (Marchand et al., <xref rid="B9" ref-type="bibr">2003</xref>; Kopec et al., <xref rid="B8" ref-type="bibr">2007</xref>; Shoji et al., <xref rid="B15" ref-type="bibr">2014</xref>). However, to our knowledge, only one study analyzed how different video conditions could influence performance (Meuth et al., <xref rid="B10" ref-type="bibr">2013</xref>). Our results show that performance of our software is heavily dependent on video quality. Since there is no standardization of video recording protocols between laboratories, this is an issue that should be taken into consideration when evaluating this type of software.</p>
    <p>To avoid these issues, some recommendations include using a high contrast between animal and background (e.g., white animal in a dark background), avoiding diagonal angles to record the experiment and using the same recording system for all videos in an experiment. Strains of rodents with more than one color and/or rodents markings will affect the number of contrasting pixels during binary conversion; nevertheless, the software was robust to detect freezing performance accurately in these cases (e.g., set 3, using Lister Hooded rats). The method was also able to accurately assess freezing with frame rates as low as 5 frames/s, and with resolutions as low as 384 × 288 (although we note that video cropping can lower the number of pixels that can actually be used by the software). We would not advise using rates below that due to lack of testing.</p>
    <p>By measuring software performance against manual observation during the calibration step, our system also works to ensure that video quality is adequate for freezing measurement. This is an important advantage, as even with calibration, there are conditions that lead to poor system performance (as shown for Set 4 in our case), demonstrating that video quality is an important concern for automated freezing measurement. The use of a minimal threshold for validating calibration thus allows the user to detect low-quality video sets that might be inappropriate for automated assessment.</p>
    <p>A limitation of our automated calibration approach is that the method is not able to accurately set parameters if an animal presents very low or high freezing percentage in the calibration video, as this reduces the amount of freezing and non-freezing epochs available for correlation. Nevertheless, users are warned by the software to choose another video if this is the case. The criteria for valid calibration also helps to detect this issue, as videos leading to poor calibration due to inadequate freezing time are less likely to reach validation criteria.</p>
    <p>Another limitation of the software is that it is currently not able to detect active forms of fear responses, such as darting (Gruene et al., <xref rid="B7" ref-type="bibr">2015</xref>). Such active responses can compete with freezing behavior, reducing the total amount of freezing time in spite of a robust fear memory. Nevertheless, this limitation is shared by any method that bases the assessment of fear on freezing quantification, including manual observation. Future releases of the code could add the option to detect sudden increases in movement as well, which could be useful to assess other types of fear responses.</p>
    <p>Automatic assessment of freezing behavior should ideally provide results with good correlation between manual and automatic scores, as well as low interuser variability (Anagnostaras et al., <xref rid="B2" ref-type="bibr">2000</xref>). Our software was robust in providing reliable results when high-quality videos were used, even when calibration was performed by observers with different training experiences. Nevertheless, the manual component involved in calibration leads to some variation between users, although this was shown to be roughly equivalent to that observed with manual scoring for videos with good quality.</p>
    <p>Although the use of manual calibration may seem like a step back from fully automated analysis, it serves to streamline a process of parameter adjustment that inevitably happens—though usually in a more cumbersome, trial-and-error basis—for any freezing detection software. Thus, even though the use of stringent calibration criteria may lead to the need to quantify several videos until proper calibration is achieved, we feel that the process ultimately saves time for researchers, besides helping to ensure that freezing assessment is accurate. Moreover, if recording conditions are kept similar from one experiment to another, the end user can opt to use a previously generated calibration file, thus skipping the manual step for later experiments.</p>
    <p>Finally, whereas the majority of the systems available are expensive, our program was developed to be freely available as an open-source code. This approach benefits laboratories with low financial budget which cannot afford commercial software or hardware such as photobeams (Valentinuzzi et al., <xref rid="B16" ref-type="bibr">1998</xref>) or force transducer detection systems (Fitch et al., <xref rid="B6" ref-type="bibr">2002</xref>). Moreover, even though our code still runs on proprietary software, we have compiled a standalone application for end users with no access to MATLAB and shared the source code under an open-source license. We thus hope that Phobos will remain accessible and open for further improvement by any user, contributing to the study of learning and memory in rodents worldwide.</p>
  </sec>
  <sec sec-type="data-availability" id="s5">
    <title>Data Availability</title>
    <p>The datasets generated for this study are available on request to the corresponding author.</p>
  </sec>
  <sec id="s6">
    <title>Ethics Statement</title>
    <p>Ethical review and approval was not required, as all data in the article are based on secondary analysis of previously acquired videos. These procedures had been recorded for distinct studies and reviewed and approved by their respective animal ethics commitees at the Federal University of Rio de Janeiro, Federal University of Rio Grande do Sul and University of Birmingham.</p>
  </sec>
  <sec id="s7">
    <title>Author Contributions</title>
    <p>FA developed the software main code and user interface, performed the statistical analysis, prepared the figures and wrote the manuscript. TM developed the software main code, performed the statistical analysis and prepared the figures. OA contributed with funding acquisition, supervision and manuscript editing. All authors contributed equally with conceptualization, methodology, data interpretation and manuscript revision.</p>
  </sec>
  <sec id="s8">
    <title>Conflict of Interest Statement</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We are indebted to Drs. Jonathan Lee and Lucas Alvares for donating the video sets, to Lara Junqueira, Roberto Maia and Victor Queiroz for assisting in quantifying freezing behavior and to Clarissa Carneiro and Ana Paula Wasilewska-Sampaio for testing the software.</p>
  </ack>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> FA and TM were both supported by Conselho Nacional de Desenvolvimento Científico e Tecnológico (CNPq) scholarships. General costs for this work were supported by Fundação Carlos Chagas Filho de Amparo à Pesquisa do Estado do Rio de Janeiro (FAPERJ; grants E-26/201.544/2014 and E-26/203.222/2017).</p>
    </fn>
  </fn-group>
  <sec sec-type="supplementary material" id="s9">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fnbeh.2019.00205/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fnbeh.2019.00205/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="SM1">
      <media xlink:href="Table_1.DOCX">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SM2">
      <media xlink:href="Data_Sheet_1.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="SM3">
      <media xlink:href="Data_Sheet_2.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anagnostaras</surname><given-names>S. G.</given-names></name><name><surname>Josselyn</surname><given-names>S. A.</given-names></name><name><surname>Frankland</surname><given-names>P. W.</given-names></name><name><surname>Silva</surname><given-names>A. J.</given-names></name></person-group> (<year>2000</year>). <article-title>Computer-assisted behavioral assessment of Pavlovian fear conditioning in mice</article-title>. <source>Learn. Mem.</source>
<volume>7</volume>, <fpage>58</fpage>–<lpage>72</lpage>. <pub-id pub-id-type="doi">10.1101/lm.7.1.58</pub-id><?supplied-pmid 10706603?><pub-id pub-id-type="pmid">10706603</pub-id></mixed-citation>
    </ref>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anagnostaras</surname><given-names>S. G.</given-names></name><name><surname>Wood</surname><given-names>S. C.</given-names></name><name><surname>Shuman</surname><given-names>T.</given-names></name><name><surname>Cai</surname><given-names>D. J.</given-names></name><name><surname>Leduc</surname><given-names>A. D.</given-names></name><name><surname>Zurn</surname><given-names>K. R.</given-names></name><etal/></person-group>. (<year>2010</year>). <article-title>Automated assessment of Pavlovian conditioned freezing and shock reactivity in mice using the video freeze system</article-title>. <source>Front. Behav. Neurosci.</source><volume>4</volume>:<fpage>158</fpage>. <pub-id pub-id-type="doi">10.3389/fnbeh.2010.00158</pub-id><?supplied-pmid 20953248?><pub-id pub-id-type="pmid">20953248</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carneiro</surname><given-names>C. F. D.</given-names></name><name><surname>Moulin</surname><given-names>T. C.</given-names></name><name><surname>Macleod</surname><given-names>M. R.</given-names></name><name><surname>Amaral</surname><given-names>O. B.</given-names></name></person-group> (<year>2018</year>). <article-title>Effect size and statistical power in the rodent fear conditioning literature—a systematic review</article-title>. <source>PLoS One</source>
<volume>13</volume>:<fpage>e0196258</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0196258</pub-id><?supplied-pmid 29698451?><pub-id pub-id-type="pmid">29698451</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Diedenhofen</surname><given-names>B.</given-names></name><name><surname>Musch</surname><given-names>J.</given-names></name></person-group> (<year>2015</year>). <article-title>cocor: a comprehensive solution for the statistical comparison of correlations</article-title>. <source>PLoS One</source>
<volume>10</volume>:<fpage>e0121945</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0121945</pub-id><?supplied-pmid 25835001?><pub-id pub-id-type="pmid">25835001</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fendt</surname><given-names>M.</given-names></name><name><surname>Fanselow</surname><given-names>M. S.</given-names></name></person-group> (<year>1999</year>). <article-title>The neuroanatomical and neurochemical basis of conditioned fear</article-title>. <source>Neurosci. Biobehav. Rev.</source>
<volume>23</volume>, <fpage>743</fpage>–<lpage>760</lpage>. <pub-id pub-id-type="doi">10.1016/s0149-7634(99)00016-0</pub-id><?supplied-pmid 10392663?><pub-id pub-id-type="pmid">10392663</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fitch</surname><given-names>T.</given-names></name><name><surname>Adams</surname><given-names>B.</given-names></name><name><surname>Chaney</surname><given-names>S.</given-names></name><name><surname>Gerlai</surname><given-names>R.</given-names></name></person-group> (<year>2002</year>). <article-title>Force transducer-based movement detection in fear conditioning in mice: a comparative analysis</article-title>. <source>Hippocampus</source>
<volume>12</volume>, <fpage>4</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.1002/hipo.10009.abs</pub-id><?supplied-pmid 11918287?><pub-id pub-id-type="pmid">11918287</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gruene</surname><given-names>T. M.</given-names></name><name><surname>Flick</surname><given-names>K.</given-names></name><name><surname>Stefano</surname><given-names>A.</given-names></name><name><surname>Shea</surname><given-names>S. D.</given-names></name><name><surname>Shansky</surname><given-names>R. M.</given-names></name></person-group> (<year>2015</year>). <article-title>Sexually divergent expression of active and passive conditioned fear responses in rats</article-title>. <source>Elife</source>
<volume>4</volume>:<fpage>e11352</fpage>. <pub-id pub-id-type="doi">10.7554/elife.11352</pub-id><?supplied-pmid 26568307?><pub-id pub-id-type="pmid">26568307</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kopec</surname><given-names>C. D.</given-names></name><name><surname>Kessels</surname><given-names>H. W. H. G.</given-names></name><name><surname>Bush</surname><given-names>D. E. A.</given-names></name><name><surname>Cain</surname><given-names>C. K.</given-names></name><name><surname>LeDoux</surname><given-names>J. E.</given-names></name><name><surname>Malinow</surname><given-names>R.</given-names></name></person-group> (<year>2007</year>). <article-title>A robust automated method to analyze rodent motion during fear conditioning</article-title>. <source>Neuropharmacology</source>
<volume>52</volume>, <fpage>228</fpage>–<lpage>233</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuropharm.2006.07.028</pub-id><?supplied-pmid 16926033?><pub-id pub-id-type="pmid">16926033</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marchand</surname><given-names>A. R.</given-names></name><name><surname>Luck</surname><given-names>D.</given-names></name><name><surname>DiScala</surname><given-names>G.</given-names></name></person-group> (<year>2003</year>). <article-title>Evaluation of an improved automated analysis of freezing behaviour in rats and its use in trace fear conditioning</article-title>. <source>J. Neurosci. Methods</source>
<volume>126</volume>, <fpage>145</fpage>–<lpage>153</lpage>. <pub-id pub-id-type="doi">10.1016/s0165-0270(03)00076-1</pub-id><?supplied-pmid 12814839?><pub-id pub-id-type="pmid">12814839</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meuth</surname><given-names>P.</given-names></name><name><surname>Gaburro</surname><given-names>S.</given-names></name><name><surname>Lesting</surname><given-names>J.</given-names></name><name><surname>Legler</surname><given-names>A.</given-names></name><name><surname>Herty</surname><given-names>M.</given-names></name><name><surname>Budde</surname><given-names>T.</given-names></name><etal/></person-group>. (<year>2013</year>). <article-title>Standardizing the analysis of conditioned fear in rodents: a multidimensional software approach</article-title>. <source>Genes Brain Behav.</source><volume>12</volume>, <fpage>583</fpage>–<lpage>592</lpage>. <pub-id pub-id-type="doi">10.1111/gbb.12040</pub-id><?supplied-pmid 23566274?><pub-id pub-id-type="pmid">23566274</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>D. M.</given-names></name><name><surname>Crnic</surname><given-names>L. S.</given-names></name></person-group> (<year>2002</year>). <article-title>Automated analysis of foot-shock sensitivity and concurrent freezing behavior in mice</article-title>. <source>J. Neurosci. Methods</source>
<volume>115</volume>, <fpage>199</fpage>–<lpage>209</lpage>. <pub-id pub-id-type="doi">10.1016/s0165-0270(02)00020-1</pub-id><?supplied-pmid 11992671?><pub-id pub-id-type="pmid">11992671</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otsu</surname><given-names>N.</given-names></name></person-group> (<year>1979</year>). <article-title>A threshold selection method from gray-level histograms</article-title>. <source>IEEE Trans. Syst. Man. Cybern.</source>
<volume>9</volume>, <fpage>62</fpage>–<lpage>66</lpage>. <pub-id pub-id-type="doi">10.1109/tsmc.1979.4310076</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pham</surname><given-names>J.</given-names></name><name><surname>Cabrera</surname><given-names>S. M.</given-names></name><name><surname>Sanchis-Segura</surname><given-names>C.</given-names></name><name><surname>Wood</surname><given-names>M. A.</given-names></name></person-group> (<year>2009</year>). <article-title>Automated scoring of fear-related behavior using EthoVision software</article-title>. <source>J. Neurosci. Methods</source>
<volume>178</volume>, <fpage>323</fpage>–<lpage>326</lpage>. <pub-id pub-id-type="doi">10.1016/j.jneumeth.2008.12.021</pub-id><?supplied-pmid 19150629?><pub-id pub-id-type="pmid">19150629</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Richmond</surname><given-names>M. A.</given-names></name><name><surname>Murphy</surname><given-names>C. A.</given-names></name><name><surname>Pouzet</surname><given-names>B.</given-names></name><name><surname>Schmid</surname><given-names>P.</given-names></name><name><surname>Rawlins</surname><given-names>J. N. P.</given-names></name><name><surname>Feldon</surname><given-names>J.</given-names></name></person-group> (<year>1998</year>). <article-title>A computer controlled analysis of freezing behaviour</article-title>. <source>J. Neurosci. Methods</source>
<volume>86</volume>, <fpage>91</fpage>–<lpage>99</lpage>. <pub-id pub-id-type="doi">10.1016/s0165-0270(98)00150-2</pub-id><?supplied-pmid 9894789?><pub-id pub-id-type="pmid">9894789</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shoji</surname><given-names>H.</given-names></name><name><surname>Takao</surname><given-names>K.</given-names></name><name><surname>Hattori</surname><given-names>S.</given-names></name><name><surname>Miyakawa</surname><given-names>T.</given-names></name></person-group> (<year>2014</year>). <article-title>Contextual and cued fear conditioning test using a video analyzing system in mice</article-title>. <source>J. Vis. Exp.</source>
<volume>85</volume>:<fpage>e50871</fpage>. <pub-id pub-id-type="doi">10.3791/50871</pub-id><?supplied-pmid 24637495?><pub-id pub-id-type="pmid">24637495</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Valentinuzzi</surname><given-names>V. S.</given-names></name><name><surname>Kolker</surname><given-names>D. E.</given-names></name><name><surname>Vitaterna</surname><given-names>M. H.</given-names></name><name><surname>Shimomura</surname><given-names>K.</given-names></name><name><surname>Whiteley</surname><given-names>A.</given-names></name><name><surname>Low-Zeddies</surname><given-names>S.</given-names></name><etal/></person-group>. (<year>1998</year>). <article-title>Automated measurement of mouse freezing behavior and its use for quantitative trait locus analysis of contextual fear conditioning in (BALB/cJ × C57BL/6J)F2 mice</article-title>. <source>Learn. Mem.</source><volume>5</volume>, <fpage>391</fpage>–<lpage>403</lpage>. <?supplied-pmid 10454363?><pub-id pub-id-type="pmid">10454363</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
