<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4852466</article-id>
    <article-id pub-id-type="publisher-id">925</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-016-0925-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ChromNet: Learning the human chromatin network from all ENCODE ChIP-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lundberg</surname>
          <given-names>Scott M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tu</surname>
          <given-names>William B.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Raught</surname>
          <given-names>Brian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Penn</surname>
          <given-names>Linda Z.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hoffman</surname>
          <given-names>Michael M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2"/>
        <xref ref-type="aff" rid="Aff3"/>
        <xref ref-type="aff" rid="Aff4"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Lee</surname>
          <given-names>Su-In</given-names>
        </name>
        <address>
          <email>suinlee@uw.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff5"/>
      </contrib>
      <aff id="Aff1"><label/>Department of Computer Science and Engineering, University of Washington, Seattle, WA USA </aff>
      <aff id="Aff2"><label/>Department of Medical Biophysics, University of Toronto, Toronto, ON Canada </aff>
      <aff id="Aff3"><label/>Princess Margaret Cancer Centre, Toronto, ON Canada </aff>
      <aff id="Aff4"><label/>Department of Computer Science, University of Toronto, Toronto, ON Canada </aff>
      <aff id="Aff5"><label/>Department of Genome Sciences, University of Washington, Seattle, WA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>30</day>
      <month>4</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>4</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>82</elocation-id>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>1</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>3</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Lundberg et al. 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>A cell’s epigenome arises from interactions among regulatory factors—transcription factors and histone modifications—co-localized at particular genomic regions. We developed a novel statistical method, ChromNet, to infer a network of these interactions, the <italic>chromatin network</italic>, by inferring conditional-dependence relationships among a large number of ChIP-seq data sets. We applied ChromNet to all available 1451 ChIP-seq data sets from the ENCODE Project, and showed that ChromNet revealed previously known physical interactions better than alternative approaches. We experimentally validated one of the previously unreported interactions, MYC–HCFC1. An interactive visualization tool is available at <ext-link ext-link-type="uri" xlink:href="http://chromnet.cs.washington.edu">http://chromnet.cs.washington.edu</ext-link>.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-016-0925-0) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DBI-1355899</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lee</surname>
            <given-names>Su-In</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DGE-1256082</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lundberg</surname>
            <given-names>Scott M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000038</institution-id>
            <institution>Natural Sciences and Engineering Research Council of Canada</institution>
          </institution-wrap>
        </funding-source>
        <award-id>RGPIN-2015-03948</award-id>
        <principal-award-recipient>
          <name>
            <surname>Hoffman</surname>
            <given-names>Michael M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution>Canadian Institute for Health Research</institution>
        </funding-source>
        <award-id>MOP-275788</award-id>
        <principal-award-recipient>
          <name>
            <surname>Penn</surname>
            <given-names>Linda Z.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p>Regulatory factors—such as transcription factors, histone modifications, and other DNA-associated proteins—co-localize in the genome and interact with each other to regulate gene expression [<xref ref-type="bibr" rid="CR14">14</xref>], the physical structure of the genome [<xref ref-type="bibr" rid="CR10">10</xref>], cell differentiation [<xref ref-type="bibr" rid="CR5">5</xref>], and other cellular processes. Identifying the genomic co-localization in this network among regulatory factors, which we termed the <italic>chromatin network</italic>, is important for understanding genome regulation and the function of each regulatory factor [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR55">55</xref>]. To identify the chromatin network, we can use chromatin immunoprecipitation-sequencing (ChIP-seq) to measure the genome-wide localization of regulatory factors, and then compare ChIP-seq data sets to find regulatory factors that co-localize [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR42">42</xref>]. Co-localization may indicate that two factors interact physically, by forming a complex, or functionally, by regulating similar DNA targets.</p>
    <p>However, identifying pairwise co-localization alone fails to distinguish direct interactions from indirect interactions. A direct interaction represents physical contact or close functional coupling that requires spatial proximity. An indirect interaction is not from physical contact or direct functional coupling, but instead reflects the transitive effect of other direct interactions. Consider a simulated chromatin network among four factors, where factor <italic>C</italic> recruits <italic>A</italic> and <italic>B</italic>, and <italic>A</italic> in turn recruits <italic>D</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">a</xref>, top). Because all pairs of ChIP-seq data sets are correlated to each other (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">a</xref>, middle), a simple co-localization method would incorrectly infer interactions among all the factors (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">a</xref>, bottom left). In a <italic>conditional-dependence network</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">a</xref>, bottom right), if two variables (here, factors) are <italic>conditionally dependent</italic>, then there is an edge between them. The <italic>conditional dependence</italic> between two factors measures their co-localization after accounting for information provided by other factors. If we infer a conditional-dependence network, we eliminate indirect edges from the network, such as between factors <italic>A</italic> and <italic>B</italic>, because their co-localization at peaks 3 and 5 can be <italic>explained away</italic> by another factor <italic>C</italic> (<italic>C</italic> recruits <italic>A</italic> and <italic>B</italic>). Hence, incorporating more ChIP-seq data sets allows more indirect edges to be removed, resulting in a higher-quality network.
<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold><italic>Top:</italic> Interaction network among four simulated regulatory factors. <italic>Middle:</italic> Binding activity from simulated ChIP-seq data sets, where each peak represents a putative binding position of a protein. <italic>Bottom:</italic> Networks inferred from ChIP-seq data sets based on co-occurrence (<italic>left</italic>) or conditional dependence (<italic>right</italic>). <bold>b</bold> Comparison of separate cell-type networks (<italic>top</italic>) with a single joint network (<italic>bottom</italic>). In a joint model, factors in each cell type have opportunities to be connected with new regulatory factors in other cell types, as highlighted by the <italic>blue shaded region</italic> (<italic>bottom</italic>). <bold>c</bold> Redundant information obscures conditional-dependence connections. <italic>Left:</italic> Without redundancy, standard methods robustly infer a conditional-dependence network. <italic>Middle:</italic> Highly correlated variables (such as <italic>A</italic> and <italic>A</italic>
<sup>′</sup>) are strongly connected with each other and lose their connections with other variables. <italic>Right:</italic> A group graphical model (GroupGM) represents the conditional dependence between groups of correlated variables, which restores the connection between <italic>A</italic> and <italic>B</italic>
</p></caption><graphic xlink:href="13059_2016_925_Fig1_HTML" id="MO1"/></fig></p>
    <p>Here we present ChromNet, an approach that estimates the human chromatin network using a conditional-dependence network among regulatory factors from 1451 human ENCODE ChIP-seq data sets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Integrating all ENCODE data sets from many cell types into a single network provides several advantages. First, it enables the extraction of global patterns in the conditional-dependence relationships among regulatory factors in all cell types. Second, it provides a flexible model that allows direct comparison of cell-type specific sub-networks because factors are conditioned on the same global set of ChIP-seq data sets across all cell types. Finally, it greatly increases the number of edges to consider by allowing edges connected to factors outside a single cell type (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">b</xref>). We show that this leads to a substantially increased fold enrichment for known protein interactions.</p>
    <p>Learning a joint network among all available ENCODE ChIP-seq data sets involves three key challenges. First, learning a network among thousands of ChIP-seq data sets based on millions of genomic regions is highly computationally intensive. To solve this challenge, we utilized an efficient approach that involves the computation of an <italic>inverse correlation matrix</italic>, which does not require an expensive iterative learning procedure. This is in contrast to some other methods, such as Bayesian networks [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR57">57</xref>] and Markov random fields [<xref ref-type="bibr" rid="CR65">65</xref>], which face difficulties in scaling up, making it infeasible to run them on all 1451 ChIP-seq data sets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 1). Second, some regulatory factors are in the same complexes, and factors are often measured in different labs, conditions, or cell types, which creates significant correlations in the data. When some variables are highly correlated with each other, standard methods often learn edges only among these variables and disconnect them from the rest of the network (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">c</xref>, middle) [<xref ref-type="bibr" rid="CR2">2</xref>]. Incorporating more ChIP-seq data sets exacerbates this problem. To solve this challenge, we present the <italic>group graphical model</italic> (GroupGM) representation of a conditional-dependence network that expresses conditional-dependence relationships among groups of regulatory factors as well as individual factors (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">c</xref>, right). We show that GroupGM improves the interpretation of a conditional-dependence network by allowing edges to connect groups of variables, which makes the edges robust against data redundancy. Third, network edges can be driven by interactions in specific genomic contexts. To help understand these contexts, we present an efficient method to estimate the impact of each genomic position on an inferred GroupGM edge.</p>
    <p>Previous work on learning interactions among regulatory factors from ChIP-seq data used much smaller data collections. ENCODE identified conditional-dependence relationships among groups of up to approximately 100 data sets in specific genomic contexts [<xref ref-type="bibr" rid="CR20">20</xref>]. Other authors used partial correlation on 21 data sets [<xref ref-type="bibr" rid="CR32">32</xref>], Bayesian networks for 38 data sets [<xref ref-type="bibr" rid="CR34">34</xref>], and partial correlation combined with penalized regression for 27 human data sets [<xref ref-type="bibr" rid="CR49">49</xref>] and for 139 mouse embryonic stem cell data sets [<xref ref-type="bibr" rid="CR25">25</xref>]. Still other authors used a Markov random field with 73 data sets in <italic>D. melanogaster</italic> [<xref ref-type="bibr" rid="CR65">65</xref>], a Boltzmann machine with 116 human transcription factors [<xref ref-type="bibr" rid="CR40">40</xref>], and bootstrapped Bayesian networks in 112 regulatory factors in <italic>D. melanogaster</italic> [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR57">57</xref>]. Only other approaches also based on linear dependence models, such as the partial correlation used by Lasserre et al. [<xref ref-type="bibr" rid="CR32">32</xref>], scale to all ENCODE data sets [Partial correlation and rank(Raw read pileup) in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1]. The ChromNet approach extends these methods in four distinct ways: 
<list list-type="order"><list-item><p>We show that linear dependence models can directly be applied to the genome-wide untransformed read count data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p></list-item><list-item><p>ChromNet addresses a fundamental challenge in network estimation when some of the variables are highly correlated with each other (collinearity) through a novel statistical method, the group graphical model.</p></list-item><list-item><p>ChromNet uses a novel method to identify genomic positions and genomic contexts that drive specific network edges.</p></list-item><list-item><p>Jointly modeling multiple cell types leads to a more informative network with a substantially higher enrichment for known protein interactions.</p></list-item></list></p>
    <p>Network inference has also been applied to gene expression data, but the number of available samples in expression data is much lower than that in ChIP-seq data sets, which leads to different challenges.</p>
    <p>ChromNet departs from previous approaches by enabling the inclusion of all 1451 ENCODE ChIP-seq data sets into a single joint conditional-dependence network. GroupGM and an efficient learning algorithm allow seamless integration of all data sets comprising 223 transcription factors and 14 histone marks from 105 cell types without requiring manual removal of potential redundancies (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). We show that this approach significantly increases the proportion of network relationships among ChIP-seq data sets supported by previously known protein–protein interactions compared to other scalable methods (see “<xref rid="Sec2" ref-type="sec">Results</xref>”). We also demonstrate the potential of ChromNet to aid new discoveries by experimentally validating a novel interaction.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Uniformly processed data reduces noise when learning conditional dependence</title>
      <p>To ensure comparable signals across all ChIP-seq data sets, we reprocessed raw ENCODE sequence data with a uniform pipeline (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">a</xref>). We downloaded raw FASTQ files from the ENCODE Data Coordination Center [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR51">51</xref>] (Additional file <xref rid="MOESM2" ref-type="media">2</xref>) and mapped them using Bowtie2 [<xref ref-type="bibr" rid="CR31">31</xref>] to the human genome reference assembly (build GRCh38/hg38) [<xref ref-type="bibr" rid="CR19">19</xref>]. We binned mapped read start sites into 1000–base-pair (bp) bins across the entire genome, which results in a 3,209,287×1451 data matrix <italic>X</italic> where genomic positions are viewed as samples (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">a</xref>). We compared several different data preprocessing methods and chose binned read counts for three reasons: 
<list list-type="order"><list-item><p>They allow easy integration of external ChIP-seq experiments.
</p></list-item><list-item><p>They do not require the determination of various cut-offs in a peak calling algorithm.</p></list-item><list-item><p>A network inferred from read counts performs well, revealing previously known protein–protein interactions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p></list-item></list><fig id="Fig2"><label>Fig. 2</label><caption><p><bold>a</bold> The uniform processing pipeline includes aligning sequences using Bowtie2, and then binning them into 1000–base-pair regions. <bold>b</bold> We inferred the GroupGM from all 1451 ChIP-seq data sets and integrated the model learned into a web interface to facilitate broad use. <bold>c</bold> We evaluated the model learned against known physical protein interactions (BioGRID), mapped global patterns through network embedding, and validated a novel predicted MYC-HCFC1 interaction with the proximity ligation assay (PLA)</p></caption><graphic xlink:href="13059_2016_925_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>A conditional-dependence network can be efficiently learned from binned read count data</title>
      <p>Learning a conditional-dependence network among thousands of ChIP-seq data sets each containing millions of samples (genomic positions) requires an efficient algorithm (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">b</xref>). It is well known that the nonzero pattern of the <italic>inverse covariance matrix</italic> of Gaussian random variables represents the conditional-dependence network [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. The inverse correlation matrix, <italic>Σ</italic><sup>−1</sup>, is a normalized version of the inverse covariance matrix and also represents conditional dependence. A zero element ({<italic>Σ</italic><sup>−1</sup>}<sub><italic>ij</italic></sub>=0) means that the <italic>i</italic>th and <italic>j</italic>th variables are conditionally independent of each other given all other variables—they are not connected by an edge.</p>
      <p>While it is common practice to learn the conditional-dependence network among continuous-valued variables based on the estimation of <italic>Σ</italic><sup>−1</sup> [<xref ref-type="bibr" rid="CR23">23</xref>], count data requires more care. Distributions of counts in binned ChIP-seq reads are often clearly truncated at zero, and also increase in variance for high read counts. Multivariate distributions with count-valued marginal distributions are often very restrictive (for example only allowing positive correlations) or are infeasible to estimate for thousands of dimensions [<xref ref-type="bibr" rid="CR62">62</xref>]. An often employed alternative is to use a multivariate Gaussian distribution after appropriately transforming the count data, such as with the sqrt or asinh function [<xref ref-type="bibr" rid="CR9">9</xref>]. However, interestingly, our results show that applying a linear Gaussian model directly to the binned read counts of ENCODE ChIP-seq data better recovers known protein–protein interactions than when using standard normalizing data transforms (“<xref rid="Sec17" ref-type="sec">Methods</xref>” and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S1 and S2). This leads to an efficient and simple model formulation for ChromNet applied directly to the mapped read counts, which is relatively easier to obtain compared to other ChIP-seq data preprocessing methods and does not require any threshold.</p>
      <p>ChromNet first computes the <italic>inverse sample correlation matrix</italic><inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \Sigma ^{-1}$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq1.gif"/></alternatives></inline-formula> from the data matrix <italic>X</italic> of 1451 variables and 3,209,287 samples, and then uses a GroupGM approach to interpret elements of <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \Sigma ^{-1}$\end{document}</tex-math><mml:math id="M4"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq2.gif"/></alternatives></inline-formula> as weights of network edges (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">b</xref>).</p>
    </sec>
    <sec id="Sec5">
      <title>Group modeling mitigates the effects of redundancy</title>
      <p>Many ENCODE ChIP-seq data sets contain redundant positional information. Conventional conditional-dependence methods have a key limitation in modeling redundant data. If data sets <italic>A</italic> and <italic>A</italic><sup>′</sup> are highly correlated, a conventional method would connect <italic>A</italic> with <italic>A</italic><sup>′</sup> but connect <italic>A</italic> to the rest of the network only weakly (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">c</xref>). Arbitrarily removing or merging redundant data sets can hide or eliminate important information in the data.</p>
      <p>GroupGM overcomes challenges with redundant data in conditional-dependence models by allowing edges that connect groups of data sets (such as [ <italic>A</italic>,<italic>A</italic><sup>′</sup>] and [ <italic>B</italic>,<italic>B</italic><sup>′</sup>]). A group edge weight represents the total dependence between the variables in the two groups that the edge connects, and is computed from <italic>Σ</italic><sup>−1</sup> as (“<xref rid="Sec17" ref-type="sec">Methods</xref>”): 
<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ G_{[A,A'][B,B']}=\Sigma_{AB}^{-1}+\Sigma_{AB'}^{-1}+\Sigma_{A'B}^{-1}+\Sigma_{A'B'}^{-1} \textrm{.} $$ \end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo><mml:mo>[</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>]</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AB</mml:mtext></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mtext>.</mml:mtext></mml:mrow></mml:math><graphic xlink:href="13059_2016_925_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>An edge in a GroupGM model implies conditional dependence between the linked groups, but does not specify the involvement of individual factors in each group. We prove that GroupGM correctly reveals conditional dependencies in the presence of redundancy (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 2).</p>
      <p>A group is defined as a set of highly correlated variables whose individual conditional-dependence relationships with other variables are not likely to be captured, as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">c</xref>. To obtain groups, we used complete linkage hierarchical clustering, and restricted groups to have a minimum pairwise correlation of <italic>ρ</italic> (=0.8) within each group. The choice of complete-linkage clustering allows us to obtain groups where all the factors are highly correlated. Because the complete-linkage distance metric merges two clusters based on the minimum correlation between any two variables in the groups, we can stop merging when the minimum correlation becomes less than or equal to <italic>ρ</italic> before creating all 2<italic>p</italic>−1 groups, where <italic>p</italic>=1451.</p>
      <p>Each variable (a ChIP-seq data set) can be in multiple groups as long as it is highly correlated with at least one other data set. This multi-scale nature of groups is a unique feature of the group graphical model. It allows us to capture multiple ways each factor can be connected with other factors. Say that a data set for factor <italic>A</italic> forms a group with another data set for factor <italic>B</italic>. In the group graphical model, <italic>A</italic> can have connections specific to itself and connections shared with <italic>B</italic>, and their edge weight values would indicate which connections are statistically robust. This allows us to reveal multiple kinds of interactions <italic>A</italic> can have: specifically with itself and with <italic>A</italic> and <italic>B</italic> as a complex. The latter may not be captured by a conventional conditional-dependence network, such as inverse correlation or partial correlation, if <italic>A</italic> and <italic>B</italic> are highly correlated with one another.</p>
      <p>The purpose of having a threshold for minimum pairwise correlation <italic>ρ</italic> is to identify sets of variables whose high within-group correlation is likely to prevent them from being connected to other variables in the network. The threshold used in this paper <italic>ρ</italic>=0.8 captures 53 <italic>%</italic> of all the multi-factor groups formed by hierarchical clustering, and was chosen so as to include strong groups while still keeping the size of groups small enough to interpret (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3).</p>
    </sec>
    <sec id="Sec6">
      <title>Conditional dependence and joint group modeling improve the recovery of known protein–protein interactions</title>
      <p>To evaluate how conditional dependence and group modeling both contribute to the performance of ChromNet, we estimated three networks among ChIP-seq data sets using the following three methods, where each method produces a set of weighted edges: 
<list list-type="order"><list-item><p>Correlation: We learned a naive co-occurrence network, using a pairwise Pearson’s correlation between all pairs of data sets.</p></list-item><list-item><p>Inverse correlation: We learned a conditional-dependence network, by computing the matrix inverse of the correlation matrix.</p></list-item><list-item><p>GroupGM: We learned a group conditional-dependence network, which addresses tight correlation among data sets by allowing edges between groups of variables.</p></list-item></list></p>
      <p>Partial correlation is similar to inverse correlation and performs nearly as well (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). We did not include other previously described methods because they do not scale to the large data collection we used (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 1 and Figure S5).</p>
      <p>To assess the quality of the estimated networks, we identified the edges corresponding to published protein–protein interactions. As ground truth, we used the BioGRID database’s assessment of physical interactions between human proteins from experiments deemed low throughput [<xref ref-type="bibr" rid="CR56">56</xref>]. For evaluation, we excluded edges connecting the same regulatory factor even when measured in different labs, cell types, or treatment conditions. These edges were excluded from evaluation to prevent them from artificially inflating the accuracy of the methods. We also excluded edges involving a histone mark because they do not exist in BioGRID. For these edges, we ran a separate evaluation using the HIstome database [<xref ref-type="bibr" rid="CR26">26</xref>] and showed that the group graphical model shows higher enrichment than the alternative methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6). When we measured the conditional dependence between a pair of ChIP-seq data sets in GroupGM, to avoid the inclusion of many redundant edges, for each pair of data sets, we picked the maximum edge weight out of all network edges connecting groups, each of which contains one of the corresponding data sets. This way, we consider exactly the same number of data set pairs for evaluation across all three methods. We only scored edges from groups containing a single type of factor (about half of the groups; see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3), because if a group contains more than one factor, there is no clear way to characterize such an edge as true or false from BioGRID, or match it with an edge from competing methods for comparison.</p>
      <sec id="Sec7">
        <title>Group modeling improves the recovery of interactions within and between cell types</title>
        <p>We compared the performance of the three methods described above across a range of prediction thresholds. For each network, we varied the number of evaluated edges <italic>N</italic> from 1 to the total number of edges. For each value of <italic>N</italic>, we identified the set of <italic>N</italic> edges with the largest weights. We also randomly picked <italic>N</italic> edges without regard to weight rank as a background set. We then calculated how many edges in each set matched known protein–protein interactions from BioGRID. We computed fold enrichment by dividing the number of matched edges in the prediction set by the expectation of the number in the background set. Since 8.4 % of data set pairs in the same cell type are supported by a BioGRID physical interaction, an enrichment fold of 1 corresponds to 8.4 % of recovered edges matching prior knowledge. Enrichment fold captures the effect of both type I and type II error rates (see “<xref rid="Sec17" ref-type="sec">Methods</xref>”).</p>
        <p>We first measured performance within all cell types, excluding edges between data sets in different cell types (Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">a</xref> top). Since the limited number of annotations in BioGRID imperfectly represents the human chromatin network, one cannot draw strong conclusions about absolute performance from this benchmark. The relative performance of the methods, however, is clear; inverse correlation performs better than correlation, and GroupGM outperforms inverse correlation. This supports the idea that better resolution of direct versus indirect interactions contributes to improved performance of inverse correlation over correlation, while greater robustness against redundancy likely contributes to improved performance of GroupGM over inverse correlation. The value of conditional dependence and group modeling is also further supported by specific examples in the network (Fig. <xref rid="Fig4" ref-type="fig">4</xref>; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S7 and S8), and by the fact that GroupGM still outperforms inverse correlation even after attempting to remove the strongest redundancies by merging data sets from different labs targeting the same factor in the same cell type/condition (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Enrichment of BioGRID-supported edges between transcription factors in networks estimated by correlation (<italic>yellow</italic>), inverse correlation (<italic>red</italic>), and GroupGM (<italic>blue</italic>). In (<bold>a</bold>) and (<bold>b</bold>), <italic>light lines</italic> represent bootstrap resampling variability, and <italic>dark lines</italic> represent average performance over all resampled networks. <bold>a</bold> Fold enrichment for BioGRID-supported edges against a varying number of evaluated network edges. <italic>Top:</italic> Excluding edges between different cell types. <italic>Bottom:</italic> Only including edges between different cell types. <bold>b</bold> Enrichment against a varying number of evaluated network edges. Here, we compared between a joint model and a cell-type specific model in four different cell types. <bold>c</bold> Enrichment within cell types that have 25 supported edges or more, where the network density was set to match the number of BioGRID-supported edges in each cell type. Beneath each cell-type name is the number of data sets in that cell type</p></caption><graphic xlink:href="13059_2016_925_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p><bold>a</bold><italic>Left:</italic> RAD21, MXI1, and SMC3 co-localize with one another, suggesting that they may all interact with each other. <italic>Right:</italic> ChromNet reveals that the co-localization of RAD21 and MXI1 was largely mediated by the presence of SMC3. <bold>b</bold> GroupGM overcomes edge instability between tight clusters of H3K27me3 (<italic>blue</italic>) and H3K4me3 (<italic>red</italic>) data sets in H7-hESC measured at different differentiation time points. Edge darkness indicates the strength of the connection; <italic>dashed lines</italic> indicate negative interactions. We have removed within-group edges for clarity. <italic>Left</italic>: Correlation. <italic>Middle</italic>: Inverse correlation. <italic>Right</italic>: GroupGM. <bold>c</bold> The part of the ChromNet network that interacts with EZH2 in H1-hESC embryonic stem cells. This is a screen capture from our web interface with a search for “EZH2 H1-hESC.” Shaded regions represent the GroupGM groups learned by hierarchical clustering; darker regions represent tighter clusters. We set the edge threshold to capture the six strongest edges connected to EZH2</p></caption><graphic xlink:href="13059_2016_925_Fig4_HTML" id="MO4"/></fig></p>
        <p>To assess the variability of the enrichment estimate, we performed bootstrap resampling of regulatory factor targets (Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">a</xref>, <xref rid="Fig3" ref-type="fig">b</xref>, light curves). All data sets with the same factor are sampled together, leading to a conservative (high) estimated variability (“<xref rid="Sec17" ref-type="sec">Methods</xref>”). GroupGM showed a statistically significant improvement over both correlation (<italic>P</italic>=0.0004) and inverse correlation (<italic>P</italic>=0.0036) for edges within cell types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10).</p>
        <p>To assess variability over cell types, we estimated enrichment separately for each cell type with 25 or more BioGRID-supported edges. In each cell type, we identified the number <italic>N</italic> of BioGRID-supported edges in that cell type. Then, we calculated the enrichment for BioGRID-supported edges among the top <italic>N</italic> edges in that cell type (Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">c</xref>). GroupGM performed consistently better than correlation or inverse correlation in individual cell types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11).</p>
        <p>We also generated a simulated data set meant to mirror the characteristics of real ChIP-seq data sets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12). Using this simulated data, we found a similar relative performance of various methods, with GroupGM recovering the most true network edges (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S13 and “<xref rid="Sec17" ref-type="sec">Methods</xref>”).</p>
        <p>To assess how well a joint model can recover relationships between factors measured in different cell types, we checked edges between different cell types for enrichment in known protein–protein interactions (Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">a</xref> bottom). The GroupGM network showed a clear enrichment for known interactions above random (<italic>P</italic>=0.0095), and also outperformed inverse correlation (<italic>P</italic>=0.0174) and correlation (<italic>P</italic>=0.0282) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14 and “<xref rid="Sec17" ref-type="sec">Methods</xref>”). This implies that information about many physical protein interactions can be recovered even from data sets in different cell types.</p>
      </sec>
      <sec id="Sec8">
        <title>Comparison between a joint model of all cell types and cell-type specific models</title>
        <p>Integrating ChIP-seq data sets from multiple cell types into a single network model provides the following three advantages. First, we can capture high-level patterns in the joint chromatin network that would not otherwise be visible. Second, a joint model allows the direct comparison of cell-type specific sub-networks because factors are conditioned on the same global set of ChIP-seq data sets across all cell types. Finally, a data set for a regulatory factor in one cell type can serve as a proxy for a missing data set for that factor in another cell type, if the factor’s localization in the genome is conserved between the cell types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S15). This greatly expands potential chromatin network edges to include the union of regulatory factors measured in any cell type. This global network contains both conserved and cell-type specific sub-networks, and proves useful in analyzing data from ENCODE, which only measures a few factors in some cell types.</p>
        <p>To compare directly a joint model across all cell types with cell-type specific models for each cell type separately, we focused on the four best characterized ENCODE cell types and compared enrichment of BioGRID-supported edges (Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">b</xref>). By varying the number of edges in the networks, we find that the joint model consistently identifies interactions with higher fold enrichment for known interactions. In addition, a joint model also identifies more unique BioGRID supported protein–protein interactions than cell-type specific models (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S16).</p>
        <p>We show as well that the large increase in potential edges from a joint model does not introduce spurious associations among edges within a cell type. When we excluded all cross-cell-type edges from the joint model, the joint model still marginally outperforms cell-type specific models (<italic>P</italic>=0.0672; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S17).</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>An example of the importance of conditional dependence: SMC3 separates RAD21 and MXI1</title>
      <p>A specific example illustrates how conditional dependence reveals experimentally supported direct interactions better than pairwise correlation (Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">a</xref>). In the correlation network among RAD21, SMC3, and MXI1, the three factors were tightly connected with one another in HeLa-S3 cervical carcinoma cells. The conditional-dependence network, however, separated RAD21 and MXI1. This separation arose from the ability of SMC3 to explain away the correlation between RAD21 and MXI1. The factor pairs left connected in the conditional-dependence network, RAD21–SMC3 and SMC3–MXI1, have physical interactions described in BioGRID [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR36">36</xref>]. BioGRID lacks any direct connection between RAD21 and MXI1. Panigrahi et al. discovered more than 200 RAD21 interactors using yeast two-hybrid screening, immunoprecipitation–coupled mass spectrometry, and affinity pull-down assays [<xref ref-type="bibr" rid="CR44">44</xref>]. They did not identify a RAD21–MXI1 interaction, which implies that RAD21 may not directly interact with MXI1.</p>
      <p>To focus on the comparison between conditional dependence and correlation, we have not displayed the group that contains SMC3 and RAD21. This grouping reflects their common role in the cohesion complex and is present in many cell types. We also note that Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">a</xref> is only a small part of the full ChromNet network and considering more factors reveals additional relationships that involve CTCF and ZNF143, which is consistent with prior knowledge [<xref ref-type="bibr" rid="CR67">67</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S18).</p>
    </sec>
    <sec id="Sec10">
      <title>An example of the importance of group dependency: recovering a connection between H3K27me3 and H3K4me3</title>
      <p>Another specific example shows how GroupGM mitigates the effect of redundancy on conventional conditional-dependence models. We examined edges between multiple H3K27me3 and H3K4me3 data sets from H7-hESC embryonic stem cells, collected at different time points in differentiation [<xref ref-type="bibr" rid="CR43">43</xref>]. H3K27me3 is a repressive mark and H3K4me3 is an activating mark. Since the data sets represent different portions of the differentiation process, one should not average them or pick a reference data set arbitrarily. However, the H3K27me3 data sets are correlated highly enough with one another to form a group, and so are the four H3K4me3 data sets. This implies that conventional conditional-dependence methods would identify edges between the two histone marks incorrectly.</p>
      <p>Edges estimated using correlation indicate that the ChIP-seq data sets targeting H3K27me3 and those targeting H3K4me3 are positively correlated. However, H3K27me3 is associated with repressed genomic regions while H3K4me3 is associated with actively transcribed regions [<xref ref-type="bibr" rid="CR66">66</xref>]. Since a minority of promoters in embryonic stem cells are bivalently marked, these two marks should not have an overall positive association [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR66">66</xref>]. In fact, most ChIP-seq data sets are positively correlated with each other (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S15), which is induced by mappability and many regions that are transcriptionally silent or active. Resolving this problem by removing some of these regions is unlikely to be successful, because it is not clear what criteria we need to exclude regions. In conditional-dependence models, such as inverse correlation and the group graphical model, by conditioning on many other variables, these global confounding effects are naturally removed. Edges estimated by inverse correlation account for these confounders but become weak and unstable showing a mixture of positive and negative associations (Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">b</xref>, middle). By allowing group edges, GroupGM has power to recover the negative association between H3K27me3 and H3K4me3 (Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">b</xref>, right), which is consistent with prior knowledge [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR66">66</xref>].</p>
    </sec>
    <sec id="Sec11">
      <title>An example of learning genomic context: ZNF143 mediates the conditional-dependence relationship between CTCF and SIX5</title>
      <p>Many relationships between regulatory factors only occur in a particular genomic context. This raises the question of how, or whether, this context specificity is encoded in ChromNet. We can gain insight into this by considering what it means for one factor to mediate the relationship between two other factors, such as <italic>A</italic> mediating the relationship between <italic>C</italic> and <italic>D</italic> in Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">a</xref>. When this occurs, it means that the connection between <italic>C</italic> and <italic>D</italic> can be explained by their co-occurrence with <italic>A</italic>. In other words, <italic>A</italic> is the context in which the relationship between <italic>C</italic> and <italic>D</italic> occurs.</p>
      <p>A practical example of this is found in the relationships between SIX5, ZNF143, and CTCF in the K562 cell type. Simple correlation connects all three factors together with positive edges, but GroupGM shows that ZNF143 actually mediates the relationship between SIX5 and CTCF (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S7 and S8). This means that the association of SIX5 with CTCF primarily occurs in the presence of ZNF143, the CTCF–SIX5 relationship is context-specific, and ZNF143 is the context. More generally, when an association between two factors, <italic>C</italic> and <italic>D</italic>, is specific to a certain genomic context and that context is well represented by a third factor, <italic>A</italic>, then <italic>A</italic> would mediate <italic>C</italic> and <italic>D</italic>. This gives the connections <italic>C</italic>–<italic>A</italic>–<italic>D</italic> in the conditional-dependence network; thus context-specific relationships, such as the relationship between CTCF and SIX5 in the presence of ZNF143, are captured in a GroupGM network, if all three factors are present.</p>
      <p>It is important to understand the genomic context in which any given edge occurs regardless of whether that context is well represented by another factor in the network. Even if <italic>A</italic> is not observed, we want to be able to infer the genomic context of the interaction between <italic>C</italic> and <italic>D</italic>. To address this need, we designed an efficient method to label every genomic position with its influence on a group network edge (“<xref rid="Sec17" ref-type="sec">Methods</xref>”). Using CTCF–ZNF143–SIX5 as an example, we removed all ZNF143 experiments from ChromNet and then computed the genomic context of the edge between CTCF and SIX5. To validate this genomic context, we took the top 1000 bins (1,000,000 bp) and intersected them with the top 1000 bins from all other experiments in K562, including ZNF143. Even though ZNF143 was not present in the model and ZNF143 data sets were not used when inferring the genomic context, it had the highest overlap of any experiment with the context driving the CTCF–SIX5 edge, even higher than the CTCF and SIX5 experiments themselves (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19).</p>
    </sec>
    <sec id="Sec12">
      <title>An example of network accuracy: recovered interactions with EZH2 in H1-hESC recapitulate known functions</title>
      <p>As an example illustrating the utility of ChromNet in revealing the potential interactors of a specific regulatory factor, we examined a small portion of the network associated with the well-characterized protein EZH2 (Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">c</xref>). We focused on the H1-hESC cell type because it had many strong EZH2 connections in ChromNet. Examining connections to EZH2 in H1-hESC highlighted several known interactions, which we discuss in decreasing order of edge strength. The strongest connection is from H3K27me3, and EZH2 is a methyltransferase involved in H3K27me3 maintenance [<xref ref-type="bibr" rid="CR1">1</xref>]. The next strongest connections are with SUZ12, which is an essential part of the Polycomb repressive complex 2 (PRC2), and is required for EZH2’s methyltransferase activity [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR13">13</xref>]. The next connection to CTBP2 is supported by this co-repressor’s possible role in deacetylation of H3K27 in preparation for PRC2-mediated methylation [<xref ref-type="bibr" rid="CR28">28</xref>]. H3K4me3 is well known to be present in active regions of the genome, so a negative relationship with EZH2 (represented by a dashed line) that deposits the repressive H3K27me3 mark is expected. SP1 is a potentially novel interactor of EZH2, while TCF12 is known to co-immunoprecipitate with EZH2, which suggests that TCF12 interacts with PRC2 [<xref ref-type="bibr" rid="CR35">35</xref>]. In summary, most of the strongest interactions with EZH2 have support in the literature. We found this mixture of interactions supported by the literature and potential novel connections in many parts of the network.</p>
    </sec>
    <sec id="Sec13">
      <title>An example of cross-cell-type comparison: enhancer-associated regulatory factors</title>
      <p>Learning a conditional-dependence network for all ENCODE cell types allows the comparison of within cell type connections across different cell types. Active enhancers are known to be flanked by a combination of the histone marks, H3K27ac and H3K4me1 [<xref ref-type="bibr" rid="CR53">53</xref>]. To quantify how strongly different transcription factors associate with active enhancers in different cell types, we calculated the sum of the group edges between each regulatory factor (except histone marks) and H3K27ac and H3K4me1 measured in that cell type. This provides a score for each factor in each cell type. Seven ENCODE cell types with 20 or more data sets contain both H3K27ac and H3K4me1, while also containing EP300, which is known to bind active enhancers [<xref ref-type="bibr" rid="CR53">53</xref>]. We focused on these seven cell types and ranked the factors in each cell type by their association with H3K27ac and H3K4me1. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 lists the top ten factors in each cell type most associated with active enhancers. EP300 can be considered a validation for the list and is highly ranked in all seven cell types (<italic>P</italic>&lt;10<sup>−5</sup>). Interestingly, even more highly ranked than EP300 is POLR2A. This association is likely because active enhancers are in close proximity to active transcription start sites in promoters in 3D space, due to the looping mechanisms for enhancer–promoter communication. The influence that 3D conformation can have on measures of co-localization in the genome is important to bear in mind when analyzing the edges in ChromNet. Other factors that are consistently associated with enhancers across cell types are shown in red, while cell-type specific associations are in black (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2).</p>
    </sec>
    <sec id="Sec14">
      <title>An example of a novel protein interaction: experimental validation of an interaction between MYC and HCFC1</title>
      <p>The c-MYC (MYC) transcription factor is frequently deregulated in a large number and wide variety of cancers [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. It heterodimerizes with its partner protein MAX to bind an estimated 10–15 % of the genome to regulate the gene expression programs of many biological processes, including cell growth, cell cycle progression, and oncogenesis [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. The mechanisms by which MYC regulates these specific biological and oncogenic outcomes are not well understood. Interactions with additional co-regulators are thought to modulate MYC’s binding specificity and transcriptional activity [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR58">58</xref>]; however, only a few MYC interactors have been evaluated on a genome-wide level. Analysis of the large number of ENCODE ChIP-seq data sets can therefore further elucidate MYC interactions at the chromatin level.</p>
      <p>ChromNet showed that MAX is the strongest interactor of MYC across multiple cell types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3), highlighting the ubiquitous nature of this interaction. Top-scoring ChromNet connections also included other known MYC interactors, for example, components of the RNA polymerase II complex such as POLR2A and chromatin-modifying proteins such as EP300 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). This shows how ChromNet can help identify protein complexes and interactions.</p>
      <p>In addition to the known interactors described above, ChromNet also revealed previously uncharacterized, high-scoring interactions, including the transcriptional regulator Host Cell Factor C1 (HCFC1) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). HCFC1 binds largely to active promoters [<xref ref-type="bibr" rid="CR39">39</xref>] and is involved in biological processes, such as cell cycle progression [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR50">50</xref>] and oncogenesis [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR48">48</xref>]. This further supports its possible role as an interactor of MYC in regulating these activities. To validate the novel MYC–HCFC1 interaction, we performed a proximity ligation assay (PLA) in MCF10A mammary epithelial cells. This technique detects endogenous protein–protein interactions in intact cells [<xref ref-type="bibr" rid="CR54">54</xref>] and has been used to validate novel interactors of MYC [<xref ref-type="bibr" rid="CR18">18</xref>]. When two proteins that are probed with specific antibodies are within close proximity of each other, fluorescence signals are produced that are measured and quantified using fluorescence microscopy. We saw only background fluorescence when incubating with an antibody against MYC (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">a</xref>, top) or HCFC1 (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">a</xref>, middle) alone. Incubation with both MYC and HCFC1 antibodies yielded a significant increase in the fluorescence signal in the nuclear compartment (Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">a</xref>, bottom, Fig. <xref rid="Fig5" ref-type="fig">5</xref><xref rid="Fig5" ref-type="fig">b</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S20). This suggests that MYC and HCFC1 interact in the nucleus, and HCFC1 may be a novel co-regulator of MYC. Future investigation will reveal the importance of HCFC1 in regulating the biological functions of MYC, such as cell cycle progression and oncogenesis. This discovery illustrates how ChromNet can suggest novel protein–protein interactions within chromatin complexes.
<fig id="Fig5"><label>Fig. 5</label><caption><p><bold>a</bold> Proximity ligation assay showing MYC and HCFC1 interaction in the nucleus. Representative micrographs show DAPI nuclear staining (<italic>left</italic>), proximity ligation signal (<italic>middle</italic>), and overlay (<italic>right</italic>) at 20× magnification, with <italic>insets</italic> at 100× magnification. <italic>Top:</italic> Cells probed with MYC antibody alone. <italic>Middle:</italic> Cells probed with HCFC1 antibody alone. <italic>Bottom:</italic> Cells probed with both antibodies. <bold>b</bold> Proximity ligation assay signal quantified as number of foci per nucleus, with 254, 293, and 381 nuclei quantified for the MYC antibody alone, the HCFC1 antibody alone, and both antibodies together, respectively. Individual values (<italic>gray dots</italic>) and mean ± standard deviation <italic>black bars</italic> from three biological replicates are shown; **** <italic>p</italic>&lt;0.0001, one-way analysis of variance with Bonferroni post test. Quantifications for each independent replicate are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S20. <italic>PLA</italic> proximity ligation assay</p></caption><graphic xlink:href="13059_2016_925_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Spatial embedding reveals global patterns in the human chromatin network</title>
      <p>By integrating all ENCODE data sets from many cell types into a single network, ChromNet enables extraction of global patterns in the relationships among regulatory factors. We used multidimensional scaling [<xref ref-type="bibr" rid="CR7">7</xref>] to embed the entire network into a 2D layout (Fig. <xref rid="Fig6" ref-type="fig">6</xref> and “<xref rid="Sec17" ref-type="sec">Methods</xref>”). In this embedding, the spatial proximity of two nodes is designed to reflect their distance in the network, where positive edges pull nodes closer together and negative edges push them father apart. Nodes for the same regulatory factor in different cell types form a cluster when that factor’s genomic position is conserved across cell types. For example, CTCF forms a clear cluster in this manner (Fig. <xref rid="Fig6" ref-type="fig">6</xref><xref rid="Fig6" ref-type="fig">a</xref>). Relationships between regulatory factors are represented by their proximity in the embedding. For example, MYC and MAX nodes are located in the same region; so are CTCF and RAD21. In contrast to the joint network, relationships in individual cell-type-specific networks (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">b</xref> top) are much less distinct (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S21).
<fig id="Fig6"><label>Fig. 6</label><caption><p>2D embedding of the entire human chromatin network estimated by ChromNet. The spatial proximity of nodes and node groups reflects the strength of their inferred edge weights. In three views of this embedding, we have highlighted three different aspects: <bold>a</bold> Specific regulatory factors discussed in this article. <bold>b</bold> Data sets from the three ENCODE tier 1 cell types, showing a separation of data sets by cell type. <bold>c</bold> Correlation with five Segway genome annotation labels. We only colored the data sets from cell types where the Ensembl Regulatory Build had a corresponding Segway annotation. Node size represents correlation with a label, in comparison to all other nodes assigned to that label</p></caption><graphic xlink:href="13059_2016_925_Fig6_HTML" id="MO6"/></fig></p>
      <p>The relative positions of regulatory factors in the embedded graph highlight important aspects of biology. This is especially apparent among histone marks, where there is a clear separation between activating marks such as H3K4me3 and H3K27ac on the lower right and repressive marks such as H3K27me3 and H3K9me3 on the upper left (Fig. <xref rid="Fig6" ref-type="fig">6</xref><xref rid="Fig6" ref-type="fig">a</xref>). H3K27me3 and H3K9me3 are both repressive marks, but form distinct clusters because they target distinct regions of the genome. H3K27me3 marks facultative heterochromatin, thought to regulate temporary repression of gene-rich regions [<xref ref-type="bibr" rid="CR27">27</xref>]. H3K9me3 marks constitutive heterochromatin, and acts as a more permanent repressor [<xref ref-type="bibr" rid="CR30">30</xref>]. Between the active and repressive marks, we find H3K36me3 and H3K79me2. H3K36me3 is closer to the inactive marks and is implicated in restricting the spread of H3K27me3 [<xref ref-type="bibr" rid="CR63">63</xref>]. H3K79me2 varies with the cell cycle and is associated with replication initiation sites [<xref ref-type="bibr" rid="CR17">17</xref>]. The relative position of histones and protein factors is also interesting. ZNF274 has been implicated in the recruitment of methyltransferases for H3K9me3 and is found nearby in the network [<xref ref-type="bibr" rid="CR16">16</xref>]. EZH2 is involved in the deposition of H3K27me3 and is found between the H3K27me3 cluster and the rest of the network [<xref ref-type="bibr" rid="CR61">61</xref>].</p>
      <p>The positions of regulatory factor data sets reflect both their cell-type identities and association with chromatin states. Highlighting the three tier 1 ENCODE cell types shows a weak clustering of regulatory factor data sets by cell type (Fig. <xref rid="Fig6" ref-type="fig">6</xref><xref rid="Fig6" ref-type="fig">b</xref>). K562 and GM12878 are both derived from blood cell lines and overlap spatially with one another in the network more than with the H1-hESC human embryonic stem cells. Coloring the network by correlation with chromatin state also reveals spatial patterns. We chose five (out of seven) Segway [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR64">64</xref>] annotation labels that highlight distinct areas of the network (Fig. <xref rid="Fig6" ref-type="fig">6</xref><xref rid="Fig6" ref-type="fig">c</xref>), illustrating a clear separation between active and inactive regions of the genome, and that chromatin domains are reflected in the interactions of the chromatin network. Spatially embedding regulatory factor data sets using the ChromNet network simultaneously captures many important aspects of their function, such as chromatin state, cell lineage, and known factor–factor interactions.</p>
    </sec>
  </sec>
  <sec id="Sec16" sec-type="discussion">
    <title>Discussion</title>
    <p>Characterizing the chromatin network, the network of interactions among regulatory factors, is a key part of understanding gene regulation. ChromNet provides a new way to learn the chromatin network from ChIP-seq data. ChromNet addresses key problems encountered when learning a joint conditional-dependence network from a large number of ChIP-seq data sets, such as the need to distinguish direct from indirect regulatory factor interactions while remaining robust to data redundancy. ChromNet also provides an efficient method to learn the genomic context driving an edge, which allows a more comprehensive understanding of the inferred interactions. We demonstrated that ChromNet’s GroupGM network infers known protein–protein interactions in the joint chromatin network more accurately than other methods. Unlike many previous methods, ChromNet is also efficient enough to integrate thousands of genome-wide ChIP-seq data sets into a single joint network. To our knowledge, this study represents the first construction of an interaction network from all 1451 ENCODE ChIP-seq data sets. ChromNet already scales to the number of data sets necessary to represent all 1400– 1900 human transcription factors [<xref ref-type="bibr" rid="CR60">60</xref>], once such data is available.</p>
    <p>ChromNet provides a general computational framework to identify a joint dependence network from many ChIP-seq data sets. It can build a custom joint dependence network by incorporating user-provided ChIP-seq data sets or a combination of the ENCODE ChIP-seq data sets and user-provided data sets. To allow easier exploration of regulatory factor interactions and to facilitate generation of novel hypotheses, we have created a dynamic search and visualization web interface for both the ENCODE network and networks built from custom data sets (<ext-link ext-link-type="uri" xlink:href="http://chromnet.cs.washington.edu">http://chromnet.cs.washington.edu</ext-link>). By building a large model and allowing easy inspection of small sub-networks, ChromNet combines a large-scale conditional-dependence model with practical accessibility.</p>
    <p>To demonstrate ChromNet’s ability to reveal novel regulatory factor interactions, we experimentally validated the interaction between the MYC and HCFC1 proteins. The biological functions of the MYC oncoprotein are complex and dependent on its protein–protein interactions. Uncovering these interactions will provide insights into MYC transcriptional complexes involved in the oncogenic process and may also reveal potential targets for anti-cancer therapies. While this manuscript was under review, the MYC–HCFC1 interaction was independently described by Thomas et al. [<xref ref-type="bibr" rid="CR59">59</xref>], further strengthening our validation of the interaction discovered through ChromNet and establishing HCFC1 as a bona fide interactor of MYC. Through ChromNet, we identified HCFC1 as a novel interactor of MYC that may be involved in regulating biological and oncogenic functions of MYC.</p>
    <p>We envision several future extensions to the approach described in this article. First, while we have demonstrated the utility of applying ChromNet to ChIP-seq data alone, we plan to incorporate other data types into the network. RNA-seq expression data sets could resolve regulatory factor relationships that occur as a consequence of mutual involvement in gene expression. Incorporating feature annotations such as gene models could highlight direct interactions between factors and genomic regions of interest. The human genome’s billions of base pairs provide a large sample size that allows joint comparisons of many genome-wide signals in a single model. Robust conditional-dependence networks provide a benefit that is likely not limited to ChIP-seq data. Second, we plan to consider relationships between regulatory factors at genomic position offsets. Here, we considered only co-occurrence relationships within the same 1000-bp region. To model positional ordering constraints, we can also consider relationships between a factor in one region and another factor in an adjacent or nearby region. This would allow us to learn phenomena such as promoter-associated factors preceding gene-body–associated factors. Third, just as the co-occurrence of different regulatory factors has been used to annotate the genome automatically, variations in the chromatin network at different positions may also prove useful to annotate functional genomic regions. This would also provide insight into the biological mechanisms behind specific regulatory factor interactions and the chromatin states in which they occur.</p>
  </sec>
  <sec id="Sec17">
    <title>Methods</title>
    <sec id="Sec18">
      <title>Data processing</title>
      <p>ENCODE has the largest collection of high-quality ChIP-seq data sets [<xref ref-type="bibr" rid="CR11">11</xref>], and continues depositing new data sets. ENCODE has processed many ChIP-seq data sets through a uniform pipeline. However, we reprocessed all the data sets from raw ChIP-seq reads (Fig. <xref rid="Fig2" ref-type="fig">2</xref>) for two reasons. First, this allowed us to incorporate data sets not available yet through ENCODE’s uniform pipeline. Second, specifying our own pipeline makes it easier to process external users’ data in an identical way. This facilitates adding ChIP-seq data sets that are not from the ENCODE project to the ChromNet network.</p>
      <p>We aligned reads from 3574 FASTQ files to GRCh38/hg38 [<xref ref-type="bibr" rid="CR19">19</xref>] using Bowtie2 [<xref ref-type="bibr" rid="CR31">31</xref>]. We grouped BAM files by data set using metadata from the ENCODE web site [<xref ref-type="bibr" rid="CR15">15</xref>]. Then, we pooled and processed BAM files using a custom binning method that counts the number of read starts in each of 3,209,287 1000-bp bins covering all contigs in GRCh38/hg38. Binning all count data sets yielded a <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X \in \mathbb {Z}_{*}^{3,209,287 \times {1451}}$\end{document}</tex-math><mml:math id="M8"><mml:mi>X</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>209</mml:mn><mml:mo>,</mml:mo><mml:mn>287</mml:mn><mml:mo>×</mml:mo><mml:mn>1451</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq3.gif"/></alternatives></inline-formula> count-valued <italic>data matrix</italic>. Each bin has a corresponding row in the matrix. We interpreted each of the 3,209,287 rows as a sample from a set <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {X} = \{X_{1}, \ldots, X_{p}\}$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="script">X</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq4.gif"/></alternatives></inline-formula> of <italic>p</italic>=1451 count-valued random variables representing occupancy of each regulatory factor at a given position. Using this interpretation, we computed a sample correlation matrix <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \Sigma \in \mathbb {R}^{p \times p}$\end{document}</tex-math><mml:math id="M12"><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq5.gif"/></alternatives></inline-formula> among the standardized variables in <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {X}$\end{document}</tex-math><mml:math id="M14"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq6.gif"/></alternatives></inline-formula>. To create the <italic>correlation network</italic>, we set the weight of every edge between two data sets <italic>i</italic> and <italic>j</italic> equal to the corresponding entry <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \Sigma _{i,j}$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq7.gif"/></alternatives></inline-formula> in the sample correlation matrix. This captures the pairwise linear dependence between two data sets (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">a</xref>, bottom left).</p>
    </sec>
    <sec id="Sec19">
      <title>Generation of simulated data</title>
      <p>A large-scale simulated data set was generated to validate the ability of ChromNet to recover interactions from raw count data. Representing the conditional dependence among large numbers of count variables for the purpose of simulation is not trivial. It is important that the model is not overly simplistic, but also still interpretable. Here we use a multivariate Gaussian distribution to represent the means of marginal Poisson distributions, threshold the values when they fall below zero, and add additional negative binomial distributed noise to represent random reads unrelated to regulatory factor localization.</p>
      <p>In this model the count for a ChIP-seq data set <italic>j</italic>, <italic>c</italic><sub><italic>j</italic></sub>, at a given position is described by 
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} c_{j} = v_{j} + \epsilon_{j}, \end{array} $$ \end{document}</tex-math><mml:math id="M18"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_925_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>v</italic><sub><italic>j</italic></sub>∼Poisson(rate<sub><italic>j</italic></sub>),rate<sub><italic>j</italic></sub>=max(0,<italic>s</italic><sub><italic>j</italic></sub>), and <italic>ε</italic><sub><italic>j</italic></sub>∼NegativeBinomial(<italic>r</italic>,<italic>p</italic>). The signal follows a thresholded normal distribution <italic>s</italic><sub><italic>j</italic></sub>∼ max(<italic>N</italic>(<italic>μ</italic>,<italic>Σ</italic>),0). The background noise (<italic>r</italic>=25,<italic>p</italic>=0.9) and the parameters of the normal distribution are all fixed during the course of the simulation. <italic>Σ</italic><sup>−1</sup> represents the structure of the underlying conditional-dependence network.</p>
      <p>The inverse covariance matrix of the simulated data <italic>Σ</italic><sup>−1</sup> was randomly generated with a sparsity of 10 <italic>%</italic>. In addition, data sets were grouped into complexes of size one (60 %), two (20 %), or three (20 %) to represent the type of close coupling observed in real data among some factors. The correlation within complexes was set to be between 0.8 and 0.9 to match the magnitudes of high correlations observed in real data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). A total of 80 complexes were simulated across 200,000 positional samples. This results in 126 experiments and 200,000 samples. To model the complexities found in real data sets better, we added dependency between nearby samples by replacing each rate<sub><italic>j</italic></sub> with 
<disp-formula id="Equb"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\frac{1}{20} \text{rate}_{j-1} + \frac{9}{10} \text{rate}_{j} + \frac{1}{20} \text{rate}_{j+1}. $$ \end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mtext>rate</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>9</mml:mn></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mtext>rate</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mtext>rate</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2016_925_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> This caused nearby bins to be more similar to each other and thus the samples are not independently and identically distributed. Since larger correlations between regions of the genome are also present due to batch effects or other confounding factors, we added one of eight different random genome-wide batch effects to each of the 126 data sets.</p>
      <p>The resulting marginal count distributions from this model are visually similar to those observed in real data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12). Because we based the correlations between data sets on a (largely transformed) multivariate normal distribution, we can treat data sets connected in the underlying generative model as true connections and seek to recover them using a variety of methods. The results of this analysis are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S13, which is consistent with Fig. <xref rid="Fig3" ref-type="fig">3</xref>, where the group graphical model performs better than alternative approaches including correlation, inverse correlation, and partial correlation.</p>
    </sec>
    <sec id="Sec20">
      <title>Efficient estimation of conditional dependence from count data</title>
      <p>Given data sets drawn from a set <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {X}$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq8.gif"/></alternatives></inline-formula> of count-valued random variables, learning an exact joint model that captures the dependency structure of these data sets could be challenging. Although there are a variety of multivariate count distributions, all are either overly restrictive or challenging to estimate for large numbers of variables [<xref ref-type="bibr" rid="CR62">62</xref>]. A common alternative is to use a multivariate Gaussian distribution and some type of transform on the marginals to make them more Gaussian, such as sqrt or asinh. Since count data are often heteroscedastic, where variance increases with higher counts, these transforms squash higher values, making the distribution more symmetric. This causes the least-squares error term to focus less on high-valued samples and proportionately more on lower values. Interestingly, for ChIP-seq data sets, this is not desirable because higher values are more likely to represent a strong signal while lower values are more likely driven by noise.</p>
      <p>Because of its efficiency and interpretability, we used a multivariate Gaussian approximation to the count data for ChromNet. We also chose to use untransformed raw read counts in the model. This choice was based on observing a clear decrease in performance when using transforms designed to mitigate heteroscedasticity (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1). An additional benefit of using a multivariate Gaussian is that it can also serve as a reasonable approximation to a Markov random field distribution. This allows a comparison with other methods designed to work strictly with binary data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S22, S23 and Supplementary Note 3).</p>
      <p>To create the <italic>inverse correlation network</italic> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), we began by inverting the sample correlation matrix <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \Sigma $\end{document}</tex-math><mml:math id="M24"><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq9.gif"/></alternatives></inline-formula> to get an inverse sample correlation matrix <inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \Sigma ^{-1}$\end{document}</tex-math><mml:math id="M26"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq10.gif"/></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR37">37</xref>]. We then set the weight of every edge between two data sets <italic>i</italic> and <italic>j</italic> equal to the corresponding entry <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\{\hat \Sigma ^{-1}\}_{i,j}$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq11.gif"/></alternatives></inline-formula>. This inverse correlation network captures the pairwise linear dependence between two data sets when conditioned on all other variables in the network.</p>
      <p>Note that partial correlation is very similar to inverse correlation and has been used before by Lasserre et al. to model connections between histone marks from human ChIP-seq data effectively (using rank-transformed data from gene start sites) [<xref ref-type="bibr" rid="CR32">32</xref>]. The matrix of partial correlations, <italic>P</italic>, is a renormalization of inverse correlation <italic>P</italic>=−<italic>D</italic><sup>−1/2</sup>×<italic>Σ</italic><sup>−1</sup>×<italic>D</italic><sup>−1/2</sup> where <italic>D</italic> is the diagonal matrix of <italic>Σ</italic><sup>−1</sup>. A direct application of partial correlation to all ENCODE data suffers from the same issues as inverse correlation, performing slightly worse in the recovery of known protein–protein interactions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). We chose to use inverse correlation as the foundation of the group graphical model (GroupGM) because the proof that GroupGM recovers the correct edge weights in the presence of near perfect redundancy does not hold when applied to the partial correlation matrix (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 2).</p>
      <p>One additional concern when applying a Gaussian graphical model to ChIP-seq data is that the values at each 1000-bp bin in the genome are not independent of each other. Fortunately, while this may reduce the power of the model (i.e., it will need more samples), it does not bias the model. This is because the edges of a Gaussian graphical model can be interpreted in terms of linear regression coefficients. Standard linear regression coefficients are unbiased even when samples are not statistically independent when the data follows a linear relationship. To validate this on ChIP-seq data and to confirm that any loss of power is unimportant, we evenly subsampled the data at progressively larger intervals. We found that performance when recovering known protein–protein interactions does not degrade until we subsample 100-fold (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S24).</p>
    </sec>
    <sec id="Sec21">
      <title>Group graphical model</title>
      <p>To create the <italic>group graphical model (GroupGM) network</italic>, we began with the inverse correlation matrix created above. We extended the idea of pairwise relationships to groups of data sets by considering a set <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M30"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq12.gif"/></alternatives></inline-formula> of <italic>q</italic> groups chosen by hierarchical clustering (see below). This effectively allows edges to express relationships between groups of variables. We let <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat G \in \mathbb {R}^{q \times q}$\end{document}</tex-math><mml:math id="M32"><mml:mi>Ĝ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq13.gif"/></alternatives></inline-formula> represent pairwise interaction strengths between all groups in the model. For any two groups <italic>i</italic> and <italic>j</italic> in the model, their weight is given by the sum of entries between them in the inverse correlation matrix (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">c</xref>): 
<disp-formula id="Equ2"><label>(2)</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \hat G_{i,j} = \sum_{k \in \mathcal{G}_{i},l \in \mathcal{G}_{j}} \hat \Sigma_{k,l}^{-1}.  \end{array} $$ \end{document}</tex-math><mml:math id="M34"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>Ĝ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_925_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>We prove that Eq. <xref rid="Equ2" ref-type="">2</xref> correctly maintains the original edge magnitude when there is redundancy (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Supplementary Note 2).</p>
      <p>To select the set <inline-formula id="IEq14"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M36"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq14.gif"/></alternatives></inline-formula> of groups, we used complete-linkage hierarchical agglomerative clustering of the correlation matrix [<xref ref-type="bibr" rid="CR23">23</xref>]. This clustering method starts by merging the two groups with the smallest maximum correlation distance between their data sets, then continues recursively until all groups have been merged. The use of hierarchical clustering eliminates the need to choose a fixed arbitrary number of clusters in advance. From the clustering results, we chose all the leaf and internal nodes from the clustering algorithm as groups <inline-formula id="IEq15"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {G}$\end{document}</tex-math><mml:math id="M38"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq15.gif"/></alternatives></inline-formula>. Then, <italic>G</italic> became a <italic>q</italic>×<italic>q</italic> matrix filled according to Eq. <xref rid="Equ2" ref-type="">2</xref>, where <italic>q</italic>=2<italic>p</italic>−1 (the total number of internal and leaf nodes). This method avoids comparing all possible subsets of data sets, which would make calculating <italic>G</italic> prohibitively expensive. Since groups with low correlation are less likely to cause the collinearity problem (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">c</xref>), we only consider groups with a correlation greater than 0.8, which captures 53 <italic>%</italic> of all the multi-factor groups formed by the hierarchical clustering (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3).</p>
      <p>Since GroupGM uses the cluster assignments to mitigate strong redundancy, clustering accuracy is most important for tightly correlated data sets. When two data sets are highly correlated, it is important to group them together to mitigate the outcome of correlated data sets in network inference. When two data sets are only mildly correlated, the effects of their redundancy will also be mild, so it is less important to group them together. Hierarchical clustering is an attractive choice because it starts by creating groups among the most correlated data sets.</p>
    </sec>
    <sec id="Sec22">
      <title>Computing the genomic context that drives a network edge</title>
      <p>The conditional-dependence relationships represented by an edge in ChromNet can occur primarily in certain genomic regions. Here we seek to identify what parts of the genome (i.e., samples) drove the creation of an edge in ChromNet. Understanding what positions in the genome caused ChromNet to estimate a network edge provides insight into the genomic regions driving the relationship.</p>
      <p>The most natural way to define the influence of a genomic position (i.e., sample) on an edge is as the difference in edge value between when we observe a position and when we do not observe a position in the genome. If implemented directly, this could easily become computationally intractable since it involves relearning the entire model for every position in the genome. For a highly optimized implementation on 16 cores, computing the correlation matrix takes approximately 2 minutes, which would lead to a run time of over 12 years for 3,209,287 binned genomic positions. This can be sped up dramatically by using rank-1 matrix updates to avoid recalculating most of the correlation matrix. This results in a much faster method, where the slowest step is the inversion of the correlation matrix. However, computing this inversion for each genomic sample still leads to over 4 days of computation on recent high-performance servers. Pre-computing this information is also undesirable, since it would create 54 TB of largely incompressible data for all group edges. Below we show that for the ChromNet model, the calculation of a genomic position’s impact on an edge can be made extremely efficient. The ideas are similar to those used in efficient leave-one-out cross-validation implementations for linear models.</p>
      <p>Removing a genomic position and computing the new inverse correlation matrix can be written in terms of a rank-1 update and the inverse correlation matrix before the position (sample) is removed. This equation holds under the assumption that removing the sample does not change the mean of the data. Let <italic>Σ</italic> be the correlation matrix of all the data, and <inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar \Sigma $\end{document}</tex-math><mml:math id="M40"><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq16.gif"/></alternatives></inline-formula> be the correlation matrix with the sample removed. Let <italic>u</italic> be the column vector representing the sample to be removed (already mean centered). Letting <italic>D</italic> be a normalizing diagonal matrix <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$D_{i,i} = \sqrt {1 - {u_{i}^{2}}}$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq17.gif"/></alternatives></inline-formula>, we get: 
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}  \bar\Sigma &amp;= (D^{-1}(\Sigma - uu^{\mathrm{T}})D^{-1})^{-1} \end{array} $$ \end{document}</tex-math><mml:math id="M44"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mspace width="-10.0pt"/><mml:mover accent="true"><mml:mrow><mml:mi>Σ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>(</mml:mo><mml:mi>Σ</mml:mi><mml:mo>−</mml:mo><mml:mi>u</mml:mi><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_925_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ4">
          <label>(4)</label>
          <alternatives>
            <tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp;= D(\Sigma - uu^{\mathrm{T}})^{-1}D \end{array} $$ \end{document}</tex-math>
            <mml:math id="M46">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mspace width="-10.0pt"/>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>Σ</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mi>u</mml:mi>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">T</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>D</mml:mi>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="13059_2016_925_Article_Equ4.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ5">
          <label>(5)</label>
          <alternatives>
            <tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp;= D(\Sigma + uBu^{\mathrm{T}})^{-1}D \hspace{75pt} (B = -1) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M48">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mspace width="-10.0pt"/>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>Σ</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mtext mathvariant="italic">uB</mml:mtext>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">T</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>D</mml:mi>
                    <mml:mspace width="75.0pt"/>
                    <mml:mo>(</mml:mo>
                    <mml:mi>B</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="13059_2016_925_Article_Equ5.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ6">
          <label>(6)</label>
          <alternatives>
            <tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp;= D(\Sigma^{-1} - \Sigma^{-1}u(B^{-1} + u^{\mathrm{T}}\Sigma^{-1}u)^{-1}u^{\mathrm{T}} \Sigma^{-1})D\\ &amp;\hspace{108pt} (\text{Woodbury formula}) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M50">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mspace width="-10.0pt"/>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>u</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>B</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>+</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">T</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>Σ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mi>u</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">T</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>)</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mspace width="-10.0pt"/>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mspace width="108.0pt"/>
                    <mml:mo>(</mml:mo>
                    <mml:mtext>Woodbury formula</mml:mtext>
                    <mml:mo>)</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="13059_2016_925_Article_Equ6.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ7">
          <label>(7)</label>
          <alternatives>
            <tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp;= D(\Sigma^{-1} - \Sigma^{-1}u(-1 + u^{\mathrm{T}}\Sigma^{-1}u)^{-1}u^{\mathrm{T}} \Sigma^{-1})D \end{array} $$ \end{document}</tex-math>
            <mml:math id="M52">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mspace width="-10.0pt"/>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>u</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>+</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">T</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>Σ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mi>u</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">T</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>)</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="13059_2016_925_Article_Equ7.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ8">
          <label>(8)</label>
          <alternatives>
            <tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp;= D(\Sigma^{-1} - v(-1 + u^{\mathrm{T}}v)^{-1}v^{\mathrm{T}})D \hspace{15pt} (\Sigma^{-1}u = v) \end{array} $$ \end{document}</tex-math>
            <mml:math id="M54">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mspace width="-10.0pt"/>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>−</mml:mo>
                    <mml:mi>v</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>+</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">T</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mi>v</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>v</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">T</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>)</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mspace width="15.0pt"/>
                    <mml:mo>(</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>Σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>u</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mi>v</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="13059_2016_925_Article_Equ8.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ9">
          <label>(9)</label>
          <alternatives>
            <tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp;= D \left(\Sigma^{-1} - \frac{vv^{\mathrm{T}}}{u^{\mathrm{T}}v - 1} \right)D. \end{array} $$ \end{document}</tex-math>
            <mml:math id="M56">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mspace width="-10.0pt"/>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mfenced close=")" open="(" separators="">
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>Σ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>−</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mi>v</mml:mi>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>v</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">T</mml:mi>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>u</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi mathvariant="normal">T</mml:mi>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mi>v</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mi>D.</mml:mi>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="13059_2016_925_Article_Equ9.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>Included in the ChromNet software release is an optimized implementation utilizing the above inverse rank-1 update formulation. It can solve 40,000 model updates to the full joint chromatin network per second, which leads to a run time of just over 1 minute for a single-group edge over the human genome. The output is the effect each genomic position has on an edge when that position is added to the data set. This information can be used to examine the highest impact positions and determine the genomic context driving an edge (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S19).</p>
    </sec>
    <sec id="Sec23">
      <title>Visualization of the hierarchical chromatin network</title>
      <p>To enable exploration of the chromatin network, we built an interactive visualization tool (<ext-link ext-link-type="uri" xlink:href="http://chromnet.cs.washington.edu">http://chromnet.cs.washington.edu</ext-link>). This tool displays the nodes and edges of the chromatin network using a real-time force model (Fig. <xref rid="Fig4" ref-type="fig">4</xref><xref rid="Fig4" ref-type="fig">c</xref>). The tool’s responsive interface lets users control which nodes and edges it displays. It immediately changes its display after a user types a search term to restrict displayed nodes. It also immediately changes its display when a user moves a slider that controls the minimum strength of a displayed edge. Our visualization tool facilitates exploring the chromatin network without excessive visual distraction.</p>
      <p>The ChromNet visualization tool displays hierarchical groups from GroupGM by shading areas that enclose a group’s members. It shades these areas with some amount of transparency. It displays the strongest groups with the highest opacity. The parents of two connected groups in the GroupGM hierarchy are themselves very likely connected. Therefore, for clarity we hide redundant parental edges.</p>
      <p>To find a reasonable lower bound for the user-defined strength threshold, we examined the relationship between edge magnitude and known physical interactions. Within cell type, edges from all cell types were sorted by magnitude and then binned. For each bin, we computed the number of edges matching low-throughput physical interactions in BioGRID and plotted how this varied over the bins. This enrichment curve suggested a lower bound of 0.2 to capture only edges enriched for known interactions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S25).</p>
    </sec>
    <sec id="Sec24">
      <title>Fold enrichment reflects both type I and type II error rates</title>
      <p>The fold enrichment is a single quantity that captures the effects of both type I and type II error rates. This can be seen from the definition of fold enrichment: 
<disp-formula id="Equ10"><label>(10)</label><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} &amp;\text{fold enrichment}\\ &amp;\quad= \frac{\text{\# of correct edges}}{\text{\# of randomly correct edges}} \end{aligned}  $$ \end{document}</tex-math><mml:math id="M58"><mml:mspace width="-15.0pt"/><mml:mtable><mml:mtr><mml:mtd><mml:mtext>fold enrichment</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext># of correct edges</mml:mtext></mml:mrow><mml:mrow><mml:mtext># of randomly correct edges</mml:mtext></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_925_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>
        <disp-formula id="Equ11">
          <label>(11)</label>
          <alternatives>
            <tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\fontsize{8.3}{6} \begin{aligned} =\frac{\text{TP}}{\left(\text{\# network edge predictions}\right) \times \left(\text{\# BioGRID interactions}\right)/N} \end{aligned}}  $$ \end{document}</tex-math>
            <mml:math id="M60">
              <mml:mspace width="-3.0pt"/>
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mtext>TP</mml:mtext>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfenced close=")" open="(" separators="">
                          <mml:mrow>
                            <mml:mtext># network edge predictions</mml:mtext>
                          </mml:mrow>
                        </mml:mfenced>
                        <mml:mo>×</mml:mo>
                        <mml:mfenced close=")" open="(" separators="">
                          <mml:mrow>
                            <mml:mtext># BioGRID interactions</mml:mtext>
                          </mml:mrow>
                        </mml:mfenced>
                        <mml:mo>/</mml:mo>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
            <graphic xlink:href="13059_2016_925_Article_Equ11.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="Equ12">
          <label>(12)</label>
          <alternatives>
            <tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ =\frac{\text{TP} \times N}{\left(\text{TP} + \text{FP}\right) \times \left(\text{TP} + \text{FN}\right)}  $$ \end{document}</tex-math>
            <mml:math id="M62">
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mtext>TP</mml:mtext>
                  <mml:mo>×</mml:mo>
                  <mml:mi>N</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mfenced close=")" open="(" separators="">
                    <mml:mrow>
                      <mml:mtext>TP</mml:mtext>
                      <mml:mo>+</mml:mo>
                      <mml:mtext>FP</mml:mtext>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>×</mml:mo>
                  <mml:mfenced close=")" open="(" separators="">
                    <mml:mrow>
                      <mml:mtext>TP</mml:mtext>
                      <mml:mo>+</mml:mo>
                      <mml:mtext>FN</mml:mtext>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
              </mml:mfrac>
            </mml:math>
            <graphic xlink:href="13059_2016_925_Article_Equ12.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <italic>N</italic> is the total number of possible edges, and TP, FP, and FN refer to the number of true positives, false positives, and false negatives, respectively. The fold enrichment is inversely proportional to the number of false positives (type I error) and number of false negatives (type II error). The type I error rate is equal to (type I error) /(total number of BioGRID interactions), and the type II error rate is equal to (type II error)/(total number of interactions − number of BioGRID interactions). Since the denominators of the type I and type II error rates are fixed numbers, we can say that the fold enrichment is inversely proportional to the type I and type II error rates.</p>
    </sec>
    <sec id="Sec25">
      <title>A conservative bootstrap estimate of protein–protein interaction enrichment variability</title>
      <p>We estimated the variability of enrichment for known protein–protein interactions in the chromatin network (Fig. <xref rid="Fig3" ref-type="fig">3</xref>) using bootstrap resampling over regulatory factors. We performed resampling over regulatory factors, and not over edges or individual data sets, because valid bootstrap resampling assumes independent and identically distributed samples. If we had resampled over the edges, we would have estimated a much smaller variability. This is because edges do not vary independently, and changes in a single data set can affect all edges connected to that data set. Variation specific to a single regulatory factor would affect all data sets measuring that factor. Those individual data sets, therefore, lack the independence assumed by the bootstrap sampling.</p>
      <p>Under a regulatory factor bootstrap, we might sample a widely measured regulatory factor a number of times. For example, ChromNet contains 130 CTCF data sets. Every time we sample CTCF, we add all 130 of these columns (where a column represents a variable in the data matrix <italic>X</italic>) to the bootstrap data matrix. Adding many data sets in unison greatly increases variability in the resampled data matrix. This yields conservative high variability estimates, ensuring that enrichment performance is not solely due to a few commonly measured factors. Using these bootstrap samples, we compared the area under the enrichment rank curves (Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">a</xref>, <xref rid="Fig3" ref-type="fig">b</xref>) between methods. The statistical significance of GroupGM’s improvement was quantified as the fraction of bootstrap samples where GroupGM outperformed the other methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S10 and S14).</p>
    </sec>
    <sec id="Sec26">
      <title>Proximity ligation assay</title>
      <p>We seeded 2.5×10<sup>4</sup> MCF10A cells (a kind gift from S. Muthuswamy, Princess Margaret Cancer Centre) onto glass cover slips. After 1 day, we fixed cells in 2 % paraformaldehyde, permeabilized the cells, and blocked them with bovine serum albumin. We then incubated the cells overnight with a mouse monoclonal antibody against MYC (1:25; C-33, Santa Cruz Biotechnology, Dallas, TX) and a rabbit polyclonal antibody against HCFC1 (1:50; A301-400, Bethyl Laboratories, Montgomery, TX). Then, we incubated cells with Duolink In Situ PLA anti-mouse MINUS and anti-rabbit PLUS probes (Sigma-Aldrich, St. Louis, MO). We processed cells using Duolink In Situ Detection Reagents Red following the manufacturer’s instructions (Sigma-Aldrich, St. Louis, MO). We imaged six fields of view per slide with a LSM700 confocal fluorescence microscope (Zeiss, Oberkochen, Germany). We unbiasedly quantified the PLA signal per nucleus (as defined by DAPI staining) using the software ImageJ [<xref ref-type="bibr" rid="CR52">52</xref>].</p>
    </sec>
    <sec id="Sec27">
      <title>Embedding the full chromatin network into a single plot</title>
      <p>Embedding a graph into a space involves defining distances between all nodes in the graph. Because GroupGM is inherently multi-scale, we sought a distance metric that accurately represented forces between individual nodes, and between all possible node groupings. In GroupGM, the edge weight between two groups is the sum of the conditional-dependence weights between all the individual data sets of those groups.</p>
      <p>A common method of computing graph distances that accounts for the total effect of all edges between two groups is the resistance distance [<xref ref-type="bibr" rid="CR29">29</xref>]. The name is derived from an interpretation of the distance as the electrical resistance between two nodes in the graph where edges are viewed as wires. This can be computed as: 
<disp-formula id="Equc"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\Omega_{i,j} = \Gamma_{i,i} + \Gamma_{j,j} - \Gamma_{i,j} - \Gamma_{j,i}, $$ \end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>Γ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Γ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2016_925_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> where <italic>Γ</italic> is the inverse of the graph Laplacian. While at first glance the resistance distance may seem like an arbitrary metric to use for node distances, upon closer inspection we find striking parallels between it and Gaussian graphical models. First, note that the weighted graph Laplacian [<xref ref-type="bibr" rid="CR41">41</xref>], <italic>L</italic>, is defined as: 
<disp-formula id="Equd"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$L = W \otimes (D - A), $$ \end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mo>⊗</mml:mo><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2016_925_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> where <italic>D</italic> is a diagonal matrix of edge degrees, <italic>A</italic> is the binary adjacency matrix of the graph, <italic>W</italic> is a matrix of positive edge weights, and ⊗ represents element-wise multiplication. A general Gaussian graphical model has a complete graph, so <italic>A</italic> will be all ones, and <italic>D</italic> will be constant on the diagonal. The edge weights will be symmetric and can be positive or negative. Positive edge weights will lead to negative off-diagonal entries in <italic>L</italic>, just as positive connections in the GroupGM will lead to negative off-diagonal entries in <italic>Θ</italic>=<italic>Σ</italic><sup>−1</sup>. So by allowing <italic>W</italic> to contain negative entries, we can view <italic>Θ</italic> as a type of graph Laplacian.</p>
      <p>Viewing <italic>Θ</italic> as a type of graph Laplacian allows us to compute the resistance distance by setting <italic>Γ</italic>=<italic>Θ</italic><sup>−1</sup>. Simplifying gives <inline-formula id="IEq18"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Omega _{i,j} = 1 - \Theta ^{-1}_{i,j}$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi>Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2016_925_Article_IEq18.gif"/></alternatives></inline-formula>.</p>
      <p>So, the resistance distance is just a constant offset of the correlation matrix of the network. This means that if we are trying to compute distances between nodes in a graph represented by the inverse correlation matrix, correlation is a very natural distance measure. We note, however, that unlike the original data correlation matrix, this matrix is computed from the inverse of the edge weights matrix. This causes a difference because we threshold small edge values that are likely to represent only noise. We chose this threshold to maximize the visual clarity of the network, which led to a threshold of 0.01.</p>
      <p>We overlaid chromatin state annotation on the graph embedding by computing the correlation between each data set and each Segway [<xref ref-type="bibr" rid="CR24">24</xref>] region from the Ensembl Regulatory Build for GRCh38/hg38 [<xref ref-type="bibr" rid="CR64">64</xref>]. We drew a separate network labeling for each region by sizing each data set node by its correlation with that Segway region. We normalized the size of the largest node in each network to a constant value and overlaid three of these network colorings (Fig. <xref rid="Fig6" ref-type="fig">6</xref><xref rid="Fig6" ref-type="fig">c</xref>).</p>
    </sec>
  </sec>
  <sec id="Sec28">
    <title>Availability of supporting data</title>
    <p>ChromNet is freely available as a ready-to-use package under an Apache license at <ext-link ext-link-type="uri" xlink:href="https://github.com/slundberg/ChromNet.jl">https://github.com/slundberg/ChromNet.jl</ext-link>. Supporting data including a preprocessed data matrix from all human ENCODE ChIP-seq data are linked from the code repository and at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.45900">http://dx.doi.org/10.5281/zenodo.45900</ext-link>. The microscopy data that we used for validation of the MYC–HCFC1 interaction are available at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.45768">http://dx.doi.org/10.5281/zenodo.45768</ext-link>.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec29">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="13059_2016_925_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p> Supplementary information. (PDF 4,962 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="13059_2016_925_MOESM2_ESM.txt" id="MOESM2">
            <label>Additional file 2</label>
            <caption>
              <p> ENCODE data sets used in ChromNet (1451 total). (TXT 34 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>
        <bold>Ethical approval</bold>
      </p>
      <p>No ethical approval was required.</p>
    </fn>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>SML and SIL designed the statistical methods and various analyses. SML developed the algorithm, performed the analyses, and developed the visualization tool. SML, WBT, LZP, MMH and SIL wrote the manuscript. WBT and LZP designed and performed the PLA. BR contributed to the data analysis of the experimental validation. All authors read and approved the final manuscript.</p>
    </fn>
    <fn>
      <p>
        <bold>Funding</bold>
      </p>
      <p>This work was supported by a National Science Foundation (NSF) Graduate Research Fellowship to SML (DGE-1256082), a NSF grant to SIL (DBI-1355899), a Natural Sciences and Engineering Research Council of Canada grant to MMH (RGPIN-2015-03948), a Canada Research Chair in Molecular Oncology to LZP, a Canadian Institute for Health Research grant to LZP and BR (MOP-275788), and a Canadian Breast Cancer Foundation Ontario Region Doctoral Fellowship to WBT. Cloud computing resources for this research were generously provided by Google.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We would like to acknowledge William S. Noble, Zhiping Weng, R. David Hawkins, W. Larry Ruzzo, and Maxwell W. Libbrecht for their helpful feedback during the development of ChromNet.</p>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Au</surname>
            <given-names>SLK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>EZH2-mediated H3K27me3 is involved in epigenetic repression of deleted in liver cancer 1 in human cancers</article-title>
        <source>PloS One</source>
        <year>2013</year>
        <volume>8</volume>
        <fpage>e68226</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0068226</pub-id>
        <?supplied-pmid 23826380?>
        <pub-id pub-id-type="pmid">23826380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Belsley</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kuh</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Welsch</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <source>Regression diagnostics: identifying influential data and sources of collinearity. Vol. 571.</source>
        <year>2005</year>
        <publisher-loc>Hoboken, NJ</publisher-loc>
        <publisher-name>John Wiley &amp; Sons</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Bemmel</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A network model of the molecular organization of chromatin in <italic>Drosophila</italic></article-title>
        <source>Mol Cell</source>
        <year>2013</year>
        <volume>49</volume>
        <fpage>759</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2013.01.040</pub-id>
        <?supplied-pmid 23438860?>
        <pub-id pub-id-type="pmid">23438860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berger</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>The complex language of chromatin regulation during transcription</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>447</volume>
        <fpage>407</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05915</pub-id>
        <?supplied-pmid 17522673?>
        <pub-id pub-id-type="pmid">17522673</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A bivalent chromatin structure marks key developmental genes in embryonic stem cells</article-title>
        <source>Cell</source>
        <year>2006</year>
        <volume>125</volume>
        <fpage>315</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2006.02.041</pub-id>
        <?supplied-pmid 16630819?>
        <pub-id pub-id-type="pmid">16630819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blackwood</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Eisenman</surname>
            <given-names>RN</given-names>
          </name>
        </person-group>
        <article-title>Max: a helix-loop-helix zipper protein that forms a sequence-specific DNA-binding complex with Myc</article-title>
        <source>Science</source>
        <year>1991</year>
        <volume>251</volume>
        <fpage>1211</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1126/science.2006410</pub-id>
        <?supplied-pmid 2006410?>
        <pub-id pub-id-type="pmid">2006410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Borg</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Groenen</surname>
            <given-names>PJF</given-names>
          </name>
        </person-group>
        <source>Modern multidimensional scaling: theory and applications</source>
        <year>2005</year>
        <publisher-loc>Berlin, Germany</publisher-loc>
        <publisher-name>Springer Science &amp; Business Media</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>SUZ12 is required for both the histone methyltransferase activity and the silencing function of the EED-EZH2 complex</article-title>
        <source>Mol Cell</source>
        <year>2004</year>
        <volume>15</volume>
        <fpage>57</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2004.06.020</pub-id>
        <?supplied-pmid 15225548?>
        <pub-id pub-id-type="pmid">15225548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Carroll</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Ruppert</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>Transformation and weighting in regression. Vol. 30.</source>
        <year>1988</year>
        <publisher-loc>Boca Raton, FL</publisher-loc>
        <publisher-name>CRC Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clapier</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Cairns</surname>
            <given-names>BR</given-names>
          </name>
        </person-group>
        <article-title>The biology of chromatin remodeling complexes</article-title>
        <source>Annu Rev Biochem</source>
        <year>2009</year>
        <volume>78</volume>
        <fpage>273</fpage>
        <lpage>304</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev.biochem.77.062706.153223</pub-id>
        <?supplied-pmid 19355820?>
        <pub-id pub-id-type="pmid">19355820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>ENCODE Project Consortium</collab>
        </person-group>
        <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dey</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Loss of the tumor suppressor BAP1 causes myeloid transformation</article-title>
        <source>Science</source>
        <year>2012</year>
        <volume>337</volume>
        <fpage>1541</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1221711</pub-id>
        <?supplied-pmid 22878500?>
        <pub-id pub-id-type="pmid">22878500</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Croce</surname>
            <given-names>L1</given-names>
          </name>
          <name>
            <surname>Helin</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Transcriptional regulation by Polycomb group proteins</article-title>
        <source>Nat Struct Mol Biol</source>
        <year>2013</year>
        <volume>20</volume>
        <fpage>1147</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1038/nsmb.2669</pub-id>
        <?supplied-pmid 24096405?>
        <pub-id pub-id-type="pmid">24096405</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diamond</surname>
            <given-names>MI</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcription factor interactions: selectors of positive or negative regulation from a single DNA element</article-title>
        <source>Science</source>
        <year>1990</year>
        <volume>249</volume>
        <fpage>1266</fpage>
        <lpage>72</lpage>
        <pub-id pub-id-type="doi">10.1126/science.2119054</pub-id>
        <?supplied-pmid 2119054?>
        <pub-id pub-id-type="pmid">2119054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <mixed-citation publication-type="other">Encode Project Data. <ext-link ext-link-type="uri" xlink:href="http://encodeproject.org">encodeproject.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frietze</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ZNF274 recruits the histone methyltransferase SETDB1 to the 3<sup>′</sup> ends of ZNF genes</article-title>
        <source>PLoS One</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e15082</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0015082</pub-id>
        <?supplied-pmid 21170338?>
        <pub-id pub-id-type="pmid">21170338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Methylation of histone H3 on lysine 79 associates with a group of replication origins and helps limit DNA replication once per cell cycle</article-title>
        <source>PLoS Genet</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003542</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1003542</pub-id>
        <?supplied-pmid 23754963?>
        <pub-id pub-id-type="pmid">23754963</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garcia-Sanz</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sin3b interacts with Myc and decreases Myc levels</article-title>
        <source>J Biol Chem</source>
        <year>2014</year>
        <volume>289</volume>
        <fpage>22221</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="doi">10.1074/jbc.M113.538744</pub-id>
        <?supplied-pmid 24951594?>
        <pub-id pub-id-type="pmid">24951594</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <mixed-citation publication-type="other">Genome Reference Consortium. <ext-link ext-link-type="uri" xlink:href="http://genomereference.org">genomereference.org</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerstein</surname>
            <given-names>MB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Architecture of the human regulatory network derived from ENCODE data</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>91</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11245</pub-id>
        <?supplied-pmid 22955619?>
        <pub-id pub-id-type="pmid">22955619</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mmip1: a novel leucine zipper protein that reverses the suppressive effects of Mad family members on c-Myc</article-title>
        <source>Oncogene</source>
        <year>1998</year>
        <volume>16</volume>
        <fpage>1149</fpage>
        <lpage>59</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.onc.1201634</pub-id>
        <?supplied-pmid 9528857?>
        <pub-id pub-id-type="pmid">9528857</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hann</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>MYC cofactors: molecular switches controlling diverse biological outcomes</article-title>
        <source>Cold Spring Harb Perspect Med</source>
        <year>2014</year>
        <volume>4</volume>
        <fpage>a014399</fpage>
        <pub-id pub-id-type="doi">10.1101/cshperspect.a014399</pub-id>
        <?supplied-pmid 24939054?>
        <pub-id pub-id-type="pmid">24939054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <source>The elements of statistical learning. Vol. 2.1.</source>
        <year>2009</year>
        <publisher-loc>Berlin, Germany</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffman</surname>
            <given-names>MM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unsupervised pattern discovery in human chromatin structure through genomic segmentation</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>473</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1937</pub-id>
        <?supplied-pmid 22426492?>
        <pub-id pub-id-type="pmid">22426492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <mixed-citation publication-type="other">Juan D, et al.Epigenomic co-localization and co-evolution reveal a key role for 5hmC as a communication hub in the chromatin network of ESCs. bioRxiv. 2015. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/008821">10.1101/008821</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khare</surname>
            <given-names>SP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HIstome—a relational knowledgebase of human histone proteins and histone modifying enzymes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>D337</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr1125</pub-id>
        <?supplied-pmid 22140112?>
        <pub-id pub-id-type="pmid">22140112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Recruitment and biological consequences of histone modification of H3K27me3 and H3K9me3</article-title>
        <source>ILAR J</source>
        <year>2012</year>
        <volume>53</volume>
        <fpage>232</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/ilar.53.3-4.232</pub-id>
        <?supplied-pmid 23744963?>
        <pub-id pub-id-type="pmid">23744963</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>TW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ctbp2 modulates NuRD-mediated deacetylation of H3K27 and facilitates PRC2-mediated H3K27me3 in active embryonic stem cell genes during exit from pluripotency</article-title>
        <source>Stem Cells</source>
        <year>2015</year>
        <volume>33</volume>
        <fpage>2442</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1002/stem.2046</pub-id>
        <?supplied-pmid 25944056?>
        <pub-id pub-id-type="pmid">25944056</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>DJ</given-names>
          </name>
          <collab>Randić M</collab>
        </person-group>
        <article-title>Resistance distance</article-title>
        <source>J Math Chem</source>
        <year>1993</year>
        <volume>12</volume>
        <fpage>81</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01164627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lachner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>O’Sullivan</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Jenuwein</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>An epigenetic road map for histone lysine methylation</article-title>
        <source>J Cell Sci</source>
        <year>2003</year>
        <volume>116</volume>
        <fpage>2117</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1242/jcs.00493</pub-id>
        <?supplied-pmid 12730288?>
        <pub-id pub-id-type="pmid">12730288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast gapped-read alignment with Bowtie 2</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>357</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>
        <?supplied-pmid 22388286?>
        <pub-id pub-id-type="pmid">22388286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lasserre</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Finding associations among histone modifications using sparse partial correlation networks</article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003168</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003168</pub-id>
        <?supplied-pmid 24039558?>
        <pub-id pub-id-type="pmid">24039558</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <mixed-citation publication-type="other">Lauritzen SL. Graphical models: Oxford University Press; 1996.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Le</surname>
            <given-names>NT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A nucleosomal approach to inferring causal relationships of histone modifications</article-title>
        <source>BMC Genom</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>Suppl 1</issue>
        <fpage>S7</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-15-S1-S7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>CC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TCF12 protein functions as transcriptional repressor of E-cadherin, and its overexpression is correlated with metastasis of colorectal cancer</article-title>
        <source>J Biol Chem</source>
        <year>2012</year>
        <volume>287</volume>
        <fpage>2798</fpage>
        <lpage>809</lpage>
        <pub-id pub-id-type="doi">10.1074/jbc.M111.258947</pub-id>
        <?supplied-pmid 22130667?>
        <pub-id pub-id-type="pmid">22130667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Losada</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yokochi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hirano</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Functional contribution of Pds5 to cohesin-mediated cohesion in human cells and <italic>Xenopus</italic> egg extracts</article-title>
        <source>J Cell Sci</source>
        <year>2005</year>
        <volume>118</volume>
        <fpage>2133</fpage>
        <lpage>41</lpage>
        <pub-id pub-id-type="doi">10.1242/jcs.02355</pub-id>
        <?supplied-pmid 15855230?>
        <pub-id pub-id-type="pmid">15855230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <mixed-citation publication-type="other">Mardia KV, Kent JT, Bibby JM. Multivariate analysis: Academic Press; 1979.</mixed-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Penn</surname>
            <given-names>LZ</given-names>
          </name>
        </person-group>
        <article-title>Reflecting on 25 years with MYC</article-title>
        <source>Nat Rev Cancer</source>
        <year>2008</year>
        <volume>8</volume>
        <fpage>976</fpage>
        <lpage>90</lpage>
        <pub-id pub-id-type="doi">10.1038/nrc2231</pub-id>
        <?supplied-pmid 19029958?>
        <pub-id pub-id-type="pmid">19029958</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michaud</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>HCFC1 is a common component of active human CpG-island promoters and coincides with ZNF143, THAP11, YY1, and GABP transcription factor occupancy</article-title>
        <source>Genome Res</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>907</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.150078.112</pub-id>
        <?supplied-pmid 23539139?>
        <pub-id pub-id-type="pmid">23539139</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <mixed-citation publication-type="other">Min MR, et al.Interpretable sparse high-order Boltzmann machines. In: Proceedings of the 17th International Conference on Artificial Intelligence and Statistics: 2014. p. 614–22.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Networks: an introduction</source>
        <year>2010</year>
        <publisher-loc>Oxford, UK</publisher-loc>
        <publisher-name>Oxford University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Niu</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Diverse transcription factor binding features revealed by genome-wide ChIPseq in <italic>C. elegans</italic></article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>245</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.114587.110</pub-id>
        <?supplied-pmid 21177963?>
        <pub-id pub-id-type="pmid">21177963</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paige</surname>
            <given-names>SL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A temporal chromatin signature in human embryonic stem cells identifies regulators of cardiac development</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>151</volume>
        <fpage>221</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.08.027</pub-id>
        <?supplied-pmid 22981225?>
        <pub-id pub-id-type="pmid">22981225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Panigrahi</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A cohesin-RAD21 interactome</article-title>
        <source>Biochem J</source>
        <year>2012</year>
        <volume>442</volume>
        <fpage>661</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1042/BJ20111745</pub-id>
        <?supplied-pmid 22145905?>
        <pub-id pub-id-type="pmid">22145905</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parker</surname>
            <given-names>JB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A transcriptional regulatory role of the THAP11-HCF-1 complex in colon cancer cell function</article-title>
        <source>Mol Cell Biol</source>
        <year>2012</year>
        <volume>32</volume>
        <fpage>1654</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1128/MCB.06033-11</pub-id>
        <?supplied-pmid 22371484?>
        <pub-id pub-id-type="pmid">22371484</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parker</surname>
            <given-names>JB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Host Cell Factor-1 recruitment to E2F-bound and cell-cycle-control genes is mediated by THAP11 and ZNF143</article-title>
        <source>Cell Rep</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>967</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2014.09.051</pub-id>
        <?supplied-pmid 25437553?>
        <pub-id pub-id-type="pmid">25437553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>JH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Analysis of genomic targets reveals complex functions of MYC</article-title>
        <source>Nat Rev Cancer</source>
        <year>2004</year>
        <volume>4</volume>
        <fpage>562</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/nrc1393</pub-id>
        <?supplied-pmid 15229481?>
        <pub-id pub-id-type="pmid">15229481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peña-Llopis</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BAP1 loss defines a new class of renal cell carcinoma</article-title>
        <source>Nat Genet</source>
        <year>2012</year>
        <volume>44</volume>
        <fpage>751</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2323</pub-id>
        <?supplied-pmid 22683710?>
        <pub-id pub-id-type="pmid">22683710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perner</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inference of interactions between chromatin modifiers and histone modifications: from ChIP-Seq data to chromatin-signaling</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>13689</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1234</pub-id>
        <?supplied-pmid 25414326?>
        <pub-id pub-id-type="pmid">25414326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Piluso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bilan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Capone</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Host cell factor-1 interacts with and antagonizes transactivation by the cell cycle regulatory factor Miz-1</article-title>
        <source>J Biol Chem</source>
        <year>2002</year>
        <volume>277</volume>
        <fpage>46799</fpage>
        <lpage>808</lpage>
        <pub-id pub-id-type="doi">10.1074/jbc.M206226200</pub-id>
        <?supplied-pmid 12244100?>
        <pub-id pub-id-type="pmid">12244100</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosenbloom</surname>
            <given-names>KR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ENCODE data in the UCSC genome browser: year 5 update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>D56</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1172</pub-id>
        <?supplied-pmid 23193274?>
        <pub-id pub-id-type="pmid">23193274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schneider</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Rasband</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Eliceiri</surname>
            <given-names>KW</given-names>
          </name>
        </person-group>
        <article-title>NIH Image to ImageJ: 25 years of image analysis</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>671</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2089</pub-id>
        <?supplied-pmid 22930834?>
        <pub-id pub-id-type="pmid">22930834</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shlyueva</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stampfel</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Transcriptional enhancers: from properties to genome-wide predictions</article-title>
        <source>Nat Rev Genet</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>272</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3682</pub-id>
        <?supplied-pmid 24614317?>
        <pub-id pub-id-type="pmid">24614317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Söderberg</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Characterizing proteins and their interactions in cells and tissues using the in situ proximity ligation assay</article-title>
        <source>Methods</source>
        <year>2008</year>
        <volume>45</volume>
        <fpage>227</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2008.06.014</pub-id>
        <?supplied-pmid 18620061?>
        <pub-id pub-id-type="pmid">18620061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spitz</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Furlong</surname>
            <given-names>EE</given-names>
          </name>
        </person-group>
        <article-title>Transcription factors: from enhancer binding to developmental control</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>613</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3207</pub-id>
        <?supplied-pmid 22868264?>
        <pub-id pub-id-type="pmid">22868264</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stark</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>BioGRID: a general repository for interaction datasets</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>D535</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkj109</pub-id>
        <?supplied-pmid 16381927?>
        <pub-id pub-id-type="pmid">16381927</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Steensel</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bayesian network analysis of targeting interactions in chromatin</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>190</fpage>
        <lpage>200</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.098822.109</pub-id>
        <?supplied-pmid 20007327?>
        <pub-id pub-id-type="pmid">20007327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>LR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Interaction with WDR5 promotes target gene recognition and tumorigenesis by MYC</article-title>
        <source>Mol Cell</source>
        <year>2015</year>
        <volume>58</volume>
        <fpage>440</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2015.02.028</pub-id>
        <?supplied-pmid 25818646?>
        <pub-id pub-id-type="pmid">25818646</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59</label>
      <mixed-citation publication-type="other">Thomas LR, Foshage AM, Weissmiller AM, Popay TM, Grieb BC, Qualls SJ, Ng V, Carboneau B, Lorey S, Eischen CM, et al. Interaction of MYC with host cell factor-1 is mediated by the evolutionarily conserved Myc box IV motif. Oncogene. 2015. Nature Publishing Group doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/onc.2015.416">10.1038/onc.2015.416</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR60">
      <label>60</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vaquerizas</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A census of human transcription factors: function, expression and evolution</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>252</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2538</pub-id>
        <?supplied-pmid 19274049?>
        <pub-id pub-id-type="pmid">19274049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Viré E</collab>
          <etal/>
        </person-group>
        <article-title>The Polycomb group protein EZH2 directly controls DNA methylation</article-title>
        <source>Nature</source>
        <year>2006</year>
        <volume>439</volume>
        <fpage>871</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1038/nature04431</pub-id>
        <?supplied-pmid 16357870?>
        <pub-id pub-id-type="pmid">16357870</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Winkelmann</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Econometric analysis of count data</source>
        <year>2008</year>
        <publisher-loc>Heidelberg</publisher-loc>
        <publisher-name>Springer Berlin</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>H3K36 methylation antagonizes PRC2-mediated H3K27 methylation</article-title>
        <source>J Biol Chem</source>
        <year>2011</year>
        <volume>286</volume>
        <fpage>7983</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1074/jbc.M110.194027</pub-id>
        <?supplied-pmid 21239496?>
        <pub-id pub-id-type="pmid">21239496</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zerbino</surname>
            <given-names>DR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Ensembl Regulatory Build</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>56</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0621-5</pub-id>
        <?supplied-pmid 25887522?>
        <pub-id pub-id-type="pmid">25887522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Troyanskaya</surname>
            <given-names>OG</given-names>
          </name>
        </person-group>
        <article-title>Global quantitative modeling of chromatin factor interactions</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>e1003525</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003525</pub-id>
        <?supplied-pmid 24675896?>
        <pub-id pub-id-type="pmid">24675896</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>VW</given-names>
          </name>
          <name>
            <surname>Goren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Charting histone modifications and the functional organization of mammalian genomes</article-title>
        <source>Nat Rev Genet</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>7</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2905</pub-id>
        <?supplied-pmid 21116306?>
        <pub-id pub-id-type="pmid">21116306</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zlotorynski</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Chromatin: ZNF143 in the loop</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>127</fpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
