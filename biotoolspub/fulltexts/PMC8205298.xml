<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="pmc">peerj-cs</journal-id>
    <journal-id journal-id-type="publisher-id">peerj-cs</journal-id>
    <journal-title-group>
      <journal-title>PeerJ Computer Science</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2376-5992</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8205298</article-id>
    <article-id pub-id-type="publisher-id">cs-585</article-id>
    <article-id pub-id-type="doi">10.7717/peerj-cs.585</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Algorithms and Analysis of Algorithms</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Graphics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Spatial and Geographic Information Systems</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Visual Analytics</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Contrast optimization of mass spectrometry imaging (MSI) data visualization by threshold intensity quantization (TrIQ)</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author">
        <name>
          <surname>Rosas-Román</surname>
          <given-names>Ignacio</given-names>
        </name>
      </contrib>
      <contrib id="author-2" contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-6732-1958</contrib-id>
        <name>
          <surname>Winkler</surname>
          <given-names>Robert</given-names>
        </name>
        <email>robert.winkler@cinvestav.mx</email>
      </contrib>
      <aff><institution>Biotechnology and Biochemistry, CINVESTAV Unidad Irapuato</institution>, <addr-line>Irapuato, Guanajuato</addr-line>, <country>Mexico</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhang</surname>
          <given-names>Li</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2021-06-09">
      <day>9</day>
      <month>6</month>
      <year iso-8601-date="2021">2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>e585</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2020-10-09">
        <day>9</day>
        <month>10</month>
        <year iso-8601-date="2020">2020</year>
      </date>
      <date date-type="accepted" iso-8601-date="2021-05-18">
        <day>18</day>
        <month>5</month>
        <year iso-8601-date="2021">2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Rosas-Román and Winkler</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Rosas-Román and Winkler</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ Computer Science) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/cs-585"/>
    <abstract>
      <p>Mass spectrometry imaging (MSI) enables the unbiased characterization of surfaces with respect to their chemical composition. In biological MSI, zones with differential mass profiles hint towards localized physiological processes, such as the tissue-specific accumulation of secondary metabolites, or diseases, such as cancer. Thus, the efficient discovery of ‘regions of interest’ (ROI) is of utmost importance in MSI. However, often the discovery of ROIs is hampered by high background noise and artifact signals. Especially in ambient ionization MSI, unmasking biologically relevant information from crude data sets is challenging. Therefore, we implemented a Threshold Intensity Quantization (TrIQ) algorithm for augmenting the contrast in MSI data visualizations. The simple algorithm reduces the impact of extreme values (‘outliers’) and rescales the dynamic range of mass signals. We provide an R script for post-processing MSI data in the imzML community format (<uri xlink:href="https://bitbucket.org/lababi/msi.r">https://bitbucket.org/lababi/msi.r</uri>) and implemented the TrIQ in our open-source imaging software RmsiGUI (<uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>). Applying these programs to different biological MSI data sets demonstrated the universal applicability of TrIQ for improving the contrast in the MSI data visualization. We show that TrIQ improves a subsequent detection of ROIs by sectioning. In addition, the adjustment of the dynamic signal intensity range makes MSI data sets comparable.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Ambient ionization</kwd>
      <kwd>Mass spectrometry imaging</kwd>
      <kwd>Image processing</kwd>
      <kwd>Data normalization</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>CONACyT bilateral grant</funding-source>
        <award-id>CONACyT-DFG 2016/277850</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source>CONACyT PostDoc scholarship</funding-source>
      </award-group>
      <funding-statement>The project was funded by the CONACyT bilateral grant CONACyT-DFG 2016/277850. Ignacio Rosas-Román received a CONACyT PostDoc scholarship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Imaging methods such as microscopy, infrared thermography, and magnetic resonance tomography play a central role in science, technology, and medicine (<xref rid="ref-12" ref-type="bibr">Gomès, Assy &amp; Chapuis, 2015</xref>; <xref rid="ref-6" ref-type="bibr">Doi, 2006</xref>).</p>
    <p>Mass spectrometry imaging (MSI) datasets contain spatially resolved spectral information. The parallel detection of multiple compounds with high sensitivity established mass spectrometry (MS) as the first-choice tool for exploratory studies, particularly in combination with data mining methods (<xref rid="ref-15" ref-type="bibr">López-Fernández et al., 2015</xref>; <xref rid="ref-37" ref-type="bibr">Winkler, 2015</xref>). Numerous MSI technologies have been reported; the most commonly used MSI platform is based on matrix-assisted laser desorption/ionization (MALDI), suitable for a wide range of molecules (<xref rid="ref-26" ref-type="bibr">Rae Buchberger et al., 2018</xref>). However, conventional MSI usually requires significant sample preparation and physical conditions, which are incompatible with life. Therefore, there is a keen interest in developing ambient ionization MSI (AIMSI) methods because they enable the direct analysis of delicate materials and biological tissues with no or minimal sample preparation (<xref rid="ref-16" ref-type="bibr">Lu et al., 2018</xref>).</p>
    <p>Unlike digital image acquisition equipment where the luminous intensity is digitalized, MSI signal intensities must be converted to discrete values by a process termed quantization. Each discrete intensity level is known as gray level; intensity quantized images are called grayscale images. Zones in MSI spectra with distinct intensities indicate localized biochemical activity, such as the biosynthesis of natural products or physiological processes. Such <italic>regions of interest</italic> (ROI) can be identified by visual inspection or automated segmentation (<xref rid="ref-13" ref-type="bibr">Gormanns et al., 2012</xref>; <xref rid="ref-40" ref-type="bibr">Bemis et al., 2015</xref>).</p>
    <p>The human vision is limited to the perception of only 700 to 900 shades of gray (<xref rid="ref-14" ref-type="bibr">Kimpe &amp; Tuytschaever, 2007</xref>). With the mapping of gray levels to colors, the visualization of features in an image can be improved. However, color perception is a subjective experience affected by illumination and the individual response of rod and cone photoreceptors located in our eyes. Thus, the used color schemes significantly affect the human perception of scientific data (<xref rid="ref-30" ref-type="bibr">Rogowitz, Treinish &amp; Bryson, 1996</xref>; <xref rid="ref-25" ref-type="bibr">Race &amp; Bunch, 2015</xref>). The frequently used rainbow color map generates colorful images that accentuate differences in signal intensities. However, the resulting images do not comply with ‘perceptual ordering,’ i.e., the spectators of a rainbow-colored MSI visualization cannot intuitively assign the different colors according to the signal intensities. Thus, rainbow color schemes are confusing and even might actively mislead viewers (<xref rid="ref-4" ref-type="bibr">Borland &amp; Taylor li, 2007</xref>). The online tool hclwizard (<uri xlink:href="http://hclwizard.org">http://hclwizard.org</uri>) helps in the generation of custom color maps, which follow the hue-chroma-luminance (HCL) concept and are suitable for different types of scientific data visualizations (<xref rid="ref-39" ref-type="bibr">Zeileis, Hornik &amp; Murrell, 2009</xref>; <xref rid="ref-41" ref-type="bibr">Stauffer et al., 2015</xref>; <xref rid="ref-8" ref-type="bibr">Gamboa-Becerra et al., 2015</xref>). The current gold standard for plotting scientific data is the color map Viridis, which provides linear perception and considers viewers with color vision deficiencies (CVD) (<xref rid="ref-19" ref-type="bibr">Nuñez, Anderton &amp; Renslow, 2018</xref>).</p>
    <p>Another critical aspect of image processing is the adaption of quantitative data to the human vision, i.e., an adjustment of physical data to the biological receiver (<xref rid="ref-33" ref-type="bibr">Stockham, 1972</xref>). Histogram equalization is widely used for enhancing the contrast in images and therefore supporting the recognition of patterns. The application of histogram equalization is simple and computationally fast. In the global histogram equalization (GHE), the entire image data are used to remap the representation levels (<xref rid="ref-1" ref-type="bibr">Abdullah-Al-Wadud et al., 2007</xref>). But the original intensity levels of the pixels are lost, and the fidelity of the data visualization is infringed.</p>
    <p>Thus, we introduce the use of <italic>Threshold Intensity Quantization</italic> (TrIQ) for the processing of conventional and ambient ionization mass spectrometry imaging (MSI/AIMSI) datasets.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <sec>
      <title>Data sets and formats</title>
      <p>We analyzed publicly available mass spectrometry imaging data sets from different MSI acquisition techniques, lateral resolutions, and sample types. The datasets used in this work are listed in <xref rid="table-1" ref-type="table">Table 1</xref>.</p>
      <table-wrap id="table-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/table-1</object-id>
        <label>Table 1</label>
        <caption>
          <title>Mass spectrometry imaging data sets. AP-MALDI-Atmospheric pressure matrix assisted laser desorption/ionization, DESI-Desorption electrospray ionization, LAESI-Laser ablation/electrospray ionization, LTP-Low-temperature plasma, Res.-lateral resolution, Tol.-mass tolerance. References: <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>, <xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš (2020)</xref>, <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al. (2014)</xref>, <xref rid="ref-18" ref-type="bibr">Maldonado-Torres et al. (2017)</xref>, <xref rid="ref-27" ref-type="bibr">Römpp et al. (2010)</xref>, <xref rid="ref-28" ref-type="bibr">Römpp et al. (2014)</xref>.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-cs-07-585-g010"/>
          <table frame="hsides" rules="groups" content-type="text">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Organism, tissue, ref.</th>
                <th rowspan="1" colspan="1">Method</th>
                <th rowspan="1" colspan="1">Res. [<inline-formula id="ieqn-1"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i001.jpg"/><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-1"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m]</th>
                <th rowspan="1" colspan="1">Tol. [ <italic>m/z</italic>]</th>
                <th rowspan="1" colspan="1">Size [pix.]</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Human, colorectal cancer (<xref rid="ref-20" ref-type="bibr">Oetjen et al., 2015</xref>)</td>
                <td rowspan="1" colspan="1">DESI (−)</td>
                <td rowspan="1" colspan="1">100</td>
                <td rowspan="1" colspan="1">±0.3</td>
                <td rowspan="1" colspan="1">67 × 64</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"><italic>A. thaliana</italic>, leaf (<xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš, 2020</xref>)</td>
                <td rowspan="1" colspan="1">LAESI (−)</td>
                <td rowspan="1" colspan="1">200</td>
                <td rowspan="1" colspan="1">±0.3</td>
                <td rowspan="1" colspan="1">46 × 26</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Chili, fruit (<xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al., 2014</xref>; <xref rid="ref-18" ref-type="bibr">Maldonado-Torres et al., 2017</xref>)</td>
                <td rowspan="1" colspan="1">LTP (+)</td>
                <td rowspan="1" colspan="1">1,000</td>
                <td rowspan="1" colspan="1">±0.3</td>
                <td rowspan="1" colspan="1">85 × 50</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Mouse, urinary bladder (<xref rid="ref-27" ref-type="bibr">Römpp et al., 2010</xref>; <xref rid="ref-28" ref-type="bibr">Römpp et al., 2014</xref>)</td>
                <td rowspan="1" colspan="1">AP-MALDI (+)</td>
                <td rowspan="1" colspan="1">10</td>
                <td rowspan="1" colspan="1">±0.1</td>
                <td rowspan="1" colspan="1">260 × 134</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The original DESI data set consists of four samples per image, which we separated for further processing.</p>
      <p>All datasets comply with the imzML data format community standard (<xref rid="ref-32" ref-type="bibr">Schramm et al., 2012</xref>; <xref rid="ref-29" ref-type="bibr">Römpp et al., 2011</xref>), implemented in many proprietary and open source programs for MSI data processing (<xref rid="ref-36" ref-type="bibr">Weiskirchen et al., 2019</xref>).</p>
    </sec>
    <sec>
      <title>Threshold intensity quantization (TrIQ) algorithm</title>
      <p>An image is a function <inline-formula id="ieqn-2"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i002.jpg"/><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}f(x,y)\end{document}</tex-math><mml:math id="mml-ieqn-2"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> that assigns an intensity level for each point <inline-formula id="ieqn-3"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i003.jpg"/><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}x,y\end{document}</tex-math><mml:math id="mml-ieqn-3"><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:math></alternatives></inline-formula> in a two-dimension space. For visualizing <inline-formula id="ieqn-4"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i004.jpg"/><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}f(x,y)\end{document}</tex-math><mml:math id="mml-ieqn-4"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> on a computer screen or printer, the image must be digitized for both intensity and spatial coordinates. As MSI is a scanning technique, spatial coordinates <inline-formula id="ieqn-5"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i005.jpg"/><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}x\end{document}</tex-math><mml:math id="mml-ieqn-5"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="ieqn-6"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i006.jpg"/><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}y\end{document}</tex-math><mml:math id="mml-ieqn-6"><mml:mi>y</mml:mi></mml:math></alternatives></inline-formula> are already discrete values related to the lateral resolution of the scanning device. The intensity values provided by the MS ion detector are analog quantities that must be transformed into discrete ones. Quantization is a process for mapping a range of analog intensity values to a single discrete value, known as a <italic>gray level</italic>. <italic>Zero-memory</italic> is a widely used quantization method. The zero-memory quantizer computes equally spaced intensity bins of width <inline-formula id="ieqn-7"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i007.jpg"/><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}w\end{document}</tex-math><mml:math id="mml-ieqn-7"><mml:mi>w</mml:mi></mml:math></alternatives></inline-formula>:</p>
      <p>
        <disp-formula id="eqn-1">
          <label>(1)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e001.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}w = \left[ {\displaystyle{{max(f) - min(f)} \over n}} \right]\end{document}</tex-math>
            <mml:math id="mml-eqn-1">
              <mml:mi>w</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mrow>
                  <mml:mstyle scriptlevel="0" displaystyle="true">
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>a</mml:mi>
                          <mml:mi>x</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>−</mml:mo>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:mi>n</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo>]</mml:mo>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <inline-formula id="ieqn-8"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i008.jpg"/><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}n\end{document}</tex-math><mml:math id="mml-ieqn-8"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula> represents the number of discrete values, usually 256; <inline-formula id="ieqn-9"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i009.jpg"/><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}min(f)\end{document}</tex-math><mml:math id="mml-ieqn-9"><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> and <inline-formula id="ieqn-10"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i010.jpg"/><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}max(f)\end{document}</tex-math><mml:math id="mml-ieqn-10"><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> operators provide minimum and maximum intensity values. Quantization is based on a comparison with the <italic>transition levels</italic>
<inline-formula id="ieqn-11"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i011.jpg"/><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}{t_k}\end{document}</tex-math><mml:math id="mml-ieqn-11"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>:</p>
      <p>
        <disp-formula id="eqn-2">
          <label>(2)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e002.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}{t_k} = w + min(f),2w + min(f), \ldots ,nw + min(f)\end{document}</tex-math>
            <mml:math id="mml-eqn-2">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo>…</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mi>n</mml:mi>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>Finally, the discrete mapped value <inline-formula id="ieqn-12"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i012.jpg"/><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q\end{document}</tex-math><mml:math id="mml-ieqn-12"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula> is obtained:</p>
      <p>
        <disp-formula id="eqn-3">
          <label>(3)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e003.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q(f(x,y)) = \left\{ {\matrix{  {0,}  {f(x,y) \le {t_1}} \cr  {k,}   {{t_k} &lt; f(x,y) \le {t_{k + 1}}}   } } \right.\end{document}</tex-math>
            <mml:math id="mml-eqn-3">
              <mml:mi>Q</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mtable columnspacing="1em" rowspacing="4pt">
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>&lt;</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
                <mml:mo stretchy="true" symmetric="true" fence="true"/>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>(AI)MSI methods often produce <italic>outliers</italic>, i.e., infrequent extreme intensity values, which drastically reduce image contrast. The <italic>Threshold Intensity Quantization</italic>, or TrIQ, addresses this issue by setting a new upper limit <inline-formula id="ieqn-13"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i013.jpg"/><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-13"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>; intensities above this threshold will be grouped within the highest bin. <inline-formula id="ieqn-14"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i014.jpg"/><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-14"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> computation involves the <italic>cumulative distributive function</italic>
<inline-formula id="ieqn-15"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i015.jpg"/><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}p(k)\end{document}</tex-math><mml:math id="mml-ieqn-15"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> (CDF), defined as</p>
      <p>
        <disp-formula id="eqn-4">
          <label>(4)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e004.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q \approx p(k) = \displaystyle{{\sum\limits_{i = 1}^k h(i)} \over N}\end{document}</tex-math>
            <mml:math id="mml-eqn-4">
              <mml:mi>q</mml:mi>
              <mml:mo>≈</mml:mo>
              <mml:mi>p</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>k</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mstyle scriptlevel="0" displaystyle="true">
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo movablelimits="false">∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munderover>
                      <mml:mi>h</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mstyle>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p><inline-formula id="ieqn-16"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i016.jpg"/><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}h(i)\end{document}</tex-math><mml:math id="mml-ieqn-16"><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> stands for the <inline-formula id="ieqn-17"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i017.jpg"/><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}i\end{document}</tex-math><mml:math id="mml-ieqn-17"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula> bin’s frequency within an image histogram, <inline-formula id="ieqn-18"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i018.jpg"/><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}N\end{document}</tex-math><mml:math id="mml-ieqn-18"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula> is the image’s pixel count. Given a target probability <inline-formula id="ieqn-19"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i019.jpg"/><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-19"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula> it is possible to find the bin <inline-formula id="ieqn-20"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i020.jpg"/><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-20"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> whose CDF closely resembles <inline-formula id="ieqn-21"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i021.jpg"/><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-21"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>. Then, the upper limit of the bin <inline-formula id="ieqn-22"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i022.jpg"/><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-22"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> in <inline-formula id="ieqn-23"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i023.jpg"/><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}h\end{document}</tex-math><mml:math id="mml-ieqn-23"><mml:mi>h</mml:mi></mml:math></alternatives></inline-formula> will be used as the threshold value <inline-formula id="ieqn-24"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i024.jpg"/><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-24"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>. The new transition levels can be defined as:</p>
      <p>
        <disp-formula id="eqn-5">
          <label>(5)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e005.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}w = \left[ {\displaystyle{{T - min(f)} \over {n - 1}}} \right]\end{document}</tex-math>
            <mml:math id="mml-eqn-5">
              <mml:mi>w</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mrow>
                  <mml:mstyle scriptlevel="0" displaystyle="true">
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>T</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:mi>n</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo>]</mml:mo>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="eqn-6">
          <label>(6)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e006.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}{t_k} = w + min(f),2w + min(f), \ldots ,(n - 1)w + min(f)\end{document}</tex-math>
            <mml:math id="mml-eqn-6">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo>…</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>n</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>Therefore, <inline-formula id="ieqn-25"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i025.jpg"/><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q\end{document}</tex-math><mml:math id="mml-ieqn-25"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula> mapping will be</p>
      <p>
        <disp-formula id="eqn-7">
          <label>(7)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e007.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q(f(x,y)) = \left\{ {\matrix{  \hskip-1.5pc{0,} \hskip-2pc  {f(x,y) \le {t_1}} \cr\hskip-1.5pc {k,}   {{t_k} \lt f(x,y) \le {t_{k + 1}}} \cr  {n - 1,} \hskip-1.35pc  {f(x,y) \gt {t_{n - 1}}} } } \right.\end{document}</tex-math>
            <mml:math id="mml-eqn-7">
              <mml:mi>Q</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mtable columnspacing="1em" rowspacing="4pt">
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>&lt;</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>&gt;</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
                <mml:mo stretchy="true" symmetric="true" fence="true"/>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>with <inline-formula id="ieqn-26"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i026.jpg"/><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-26"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> running from 1 to <inline-formula id="ieqn-27"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i027.jpg"/><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}n - 1\end{document}</tex-math><mml:math id="mml-ieqn-27"><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>. From <xref ref-type="disp-formula" rid="eqn-7">Eq. (7)</xref> follows that a higher <inline-formula id="ieqn-28"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i028.jpg"/><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-28"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> leads to a better approximation of <inline-formula id="ieqn-29"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i029.jpg"/><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-29"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>. Default values for <inline-formula id="ieqn-30"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i030.jpg"/><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-30"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="ieqn-31"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i031.jpg"/><tex-math id="M38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-31"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula> in RmsiGUI are 100 and 98%, respectively.</p>
      <p>Using the default values of the TrIQ, 98% (= <inline-formula id="ieqn-32"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i032.jpg"/><tex-math id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-32"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>) of the image’s total intensity are visualized. Pixel intensities above the calculated threshold value <italic>T</italic> are limited to a maximum value. Therefore, the rescaled 100 (= <inline-formula id="ieqn-33"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i033.jpg"/><tex-math id="M40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-33"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>) bins visualize the dataset’s intensity levels with more detail.</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>Several programs and workflows for MSI data analysis employ the statistical language R (<xref rid="ref-24" ref-type="bibr">R Core Team, 2018</xref>), such as MSI.R (<xref rid="ref-8" ref-type="bibr">Gamboa-Becerra et al., 2015</xref>), Cardinal (<xref rid="ref-40" ref-type="bibr">Bemis et al., 2015</xref>), and the Galaxy MSI module (<xref rid="ref-7" ref-type="bibr">Föll et al., 2019</xref>). The Otsu segmentation method (<xref rid="ref-21" ref-type="bibr">Otsu, 1979</xref>) tested in this work comes with the R package EBImage (<xref rid="ref-23" ref-type="bibr">Pau et al., 2010</xref>). Recently, we published an R-based platform for MSI data processing with a graphical user interface, RmsiGUI, which provides modules for the control of an open hardware imaging robot (<italic>Open LabBot</italic>), the processing of raw data, and the analysis of MSI data (<xref rid="ref-31" ref-type="bibr">Rosas-Román et al., 2020</xref>). We integrated the TrIQ algorithm into RmsiGUI and provide the R code snippets for facilitating its adoption into other programs. The source code is freely available from the project repository <uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>.</p>
      <p>We use the viridis color map, which is optimized for human perception and people with color vision deficiencies (<xref rid="ref-19" ref-type="bibr">Nuñez, Anderton &amp; Renslow, 2018</xref>; <xref rid="ref-9" ref-type="bibr">Garnier et al., 2018</xref>). Reading and processing MSI data in imzML format are done with the MALDIquantForeign and MALDIquant libraries (<xref rid="ref-11" ref-type="bibr">Gibb &amp; Strimmer, 2012</xref>; <xref rid="ref-10" ref-type="bibr">Gibb &amp; Franceschi, 2019</xref>).</p>
      <p><xref ref-type="fig" rid="fig-1">Figure 1</xref> shows the graphical user interface of RmsiGUI with the TrIQ option selector.</p>
      <fig id="fig-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-1</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Implementation of the Threshold Intensity Quantization (TrIQ) in the graphical user interface of RmsiGUI (dataset and image from <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>).</title>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g001"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="results|discussion">
    <title>Results and discussion</title>
    <p>The contrast of digital images can be enhanced with additional operations, such as global or local histogram equalization algorithms; however, such image processing tools do not preserve the original gray level scale’s linearity. In contrast, our <italic>Threshold Intensity Quantization</italic> (TrIQ) approach finds an intensity threshold <inline-formula id="ieqn-34"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i034.jpg"/><tex-math id="M41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-34"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> for saturating the images’ last gray level. Importantly, the linearity of the experimentally determined intensity scale is preserved.</p>
    <p>In the next sections, we demonstrate the application of the TrIQ for the processing of mass spectrometry imaging (MSI) datasets. The term <italic>raw image</italic> is used in this paper for denoting images rendered with the default quantization method of R.</p>
    <sec>
      <title>Contrast optimization</title>
      <p><xref ref-type="fig" rid="fig-2">Figure 2</xref> shows the mass spectrometry image of a human colorectal adenocarcinoma sample, acquired with DESI and 100 <inline-formula id="ieqn-35"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i035.jpg"/><tex-math id="M42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-35"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m spatial resolution (<xref rid="ref-20" ref-type="bibr">Oetjen et al., 2015</xref>). The imaged signal of 885.55 <italic>m/z</italic> corresponds to de-protonated phosphatidylinositol (18:0/20:4), [C<inline-formula id="ieqn-36"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i036.jpg"/><tex-math id="M43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{47}\end{document}</tex-math><mml:math id="mml-ieqn-36"><mml:msub><mml:mi/><mml:mrow><mml:mn>47</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-37"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i037.jpg"/><tex-math id="M44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{83}\end{document}</tex-math><mml:math id="mml-ieqn-37"><mml:msub><mml:mi/><mml:mrow><mml:mn>83</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-38"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i038.jpg"/><tex-math id="M45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{13}\end{document}</tex-math><mml:math id="mml-ieqn-38"><mml:msub><mml:mi/><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>P-H]<inline-formula id="ieqn-39"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i039.jpg"/><tex-math id="M46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-39"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula> (<xref rid="ref-35" ref-type="bibr">Tillner et al., 2017</xref>).</p>
      <fig id="fig-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-2</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Contrast enhancement by Threshold Intensity Quantization (TrIQ).</title>
          <p>The mass trace 885.55 <italic>m/z</italic> of DESI MSI data of a human colorectal adenocarcinoma sample was visualized with different quantization methods. (A) Raw data, rendered with 256 gray levels. (B) Plotting with applying the natural logarithm to the intensity values. (C) Image contrast improvement after zero-memory quantization and linear histogram equalization (D) Image contrast improvement using TrIQ with 95 percent and 32 gray levels. Histograms A, B and D were computed with 32 bins; histogram C has 256 bins. (E) Histological staining of a tissue slice (dataset and image E) from <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>.</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g002"/>
      </fig>
      <p>The direct plotting of the extracted <italic>m/z</italic> slice results in the image shown in <xref ref-type="fig" rid="fig-2">Fig. 2A</xref>. The image contains pixels with intensity values of up to 70,280 arbitrary units. Such extreme and infrequent intensity values are called <italic>outliers</italic> and drastically reduce image contrast. The histogram below reveals the reason for the low contrast of the image: Most of the pixels fall into the first four bins after the default R quantization.</p>
      <p>A typical data transformation for imaging is the use of a logarithmic intensity scale. <xref ref-type="fig" rid="fig-2">Figure 2B</xref> shows the image after applying the natural logarithm to the MSI signal intensities and default quantization. The contrast is improved. However, further operations would be necessary, such as the subtraction of the background level. Besides, the interpretation of the non-linear color scale is not intuitive.</p>
      <p>The conventional sequence for improving the contrast of an MSI image is applying the zero-memory quantization of MSI data and a transformation function on the quantized pixels. <xref ref-type="fig" rid="fig-2">Figure 2C</xref> shows the result of this process. Although improved contrast is gained with linear equalization, the corresponding histogram shows that many gray levels were lost in the transformation process. Only eighteen remaining gray levels contain data. This information loss is irreversible and may have adverse effects on the performance of standard segmentation algorithms. To make TrIQ and equalized images comparable, we selected an intensity threshold for saturating the equalized image near to the <inline-formula id="ieqn-40"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i040.jpg"/><tex-math id="M47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-40"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> threshold provided by the TrIQ algorithm. The shown linear equalization histogram has 256 bins.</p>
      <p>Applying the TrIQ algorithm with <inline-formula id="ieqn-41"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i041.jpg"/><tex-math id="M48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}P = 0.95\end{document}</tex-math><mml:math id="mml-ieqn-41"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:math></alternatives></inline-formula> resulted in <xref ref-type="fig" rid="fig-2">Fig. 2D</xref>. Pixels with intensities above <inline-formula id="ieqn-42"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i042.jpg"/><tex-math id="M49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T = 4,244\end{document}</tex-math><mml:math id="mml-ieqn-42"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>244</mml:mn></mml:math></alternatives></inline-formula> were binned within the highest gray level. The corresponding histogram shows an almost flat frequency over a wide intensity range. Compared to the unprocessed image, the contrast of the image was drastically improved, and the linear intensity scale of the color representation was preserved. <xref ref-type="fig" rid="fig-2">Figure 2E</xref> shows the histological staining of the tissue section analyzed. The mass image processed with the TrIQ algorithm reassembles best the anatomical details which are recognizable in the optical image.</p>
    </sec>
    <sec>
      <title>Background optimization</title>
      <p>Various causes can result in background noise, such as sample metabolites with low vapor pressure and matrix compounds. <xref ref-type="fig" rid="fig-3">Figure 3A</xref> shows the rendering of signals from an <italic>Arabidopsis thaliana</italic> leaf, analyzed by LAESI MSI with a lateral resolution of 200 <inline-formula id="ieqn-43"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i043.jpg"/><tex-math id="M50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-43"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m (<xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš, 2020</xref>). The images correspond to the putative negative ions of 4-hydroxymethyl-3-methoxyphenoxyacetic acid ([C<inline-formula id="ieqn-44"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i044.jpg"/><tex-math id="M51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{10}\end{document}</tex-math><mml:math id="mml-ieqn-44"><mml:msub><mml:mi/><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-45"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i045.jpg"/><tex-math id="M52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{12}\end{document}</tex-math><mml:math id="mml-ieqn-45"><mml:msub><mml:mi/><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-46"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i046.jpg"/><tex-math id="M53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_5\end{document}</tex-math><mml:math id="mml-ieqn-46"><mml:msub><mml:mi/><mml:mn>5</mml:mn></mml:msub></mml:math></alternatives></inline-formula>-3H]<inline-formula id="ieqn-47"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i047.jpg"/><tex-math id="M54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-47"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, 209.0 <italic>m/z</italic>), 4-methylsulfonylbutyl glucosinolate ([C<inline-formula id="ieqn-48"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i048.jpg"/><tex-math id="M55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{12}\end{document}</tex-math><mml:math id="mml-ieqn-48"><mml:msub><mml:mi/><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-49"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i049.jpg"/><tex-math id="M56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{23}\end{document}</tex-math><mml:math id="mml-ieqn-49"><mml:msub><mml:mi/><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>NO<inline-formula id="ieqn-50"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i050.jpg"/><tex-math id="M57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{10}\end{document}</tex-math><mml:math id="mml-ieqn-50"><mml:msub><mml:mi/><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>S<inline-formula id="ieqn-51"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i051.jpg"/><tex-math id="M58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_3\end{document}</tex-math><mml:math id="mml-ieqn-51"><mml:msub><mml:mi/><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>-H]<inline-formula id="ieqn-52"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i052.jpg"/><tex-math id="M59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-52"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, 436.0 <italic>m/z</italic>), and indol-3-ylmethyl glucosinolate ([C<inline-formula id="ieqn-53"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i053.jpg"/><tex-math id="M60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{16}\end{document}</tex-math><mml:math id="mml-ieqn-53"><mml:msub><mml:mi/><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-54"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i054.jpg"/><tex-math id="M61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{20}\end{document}</tex-math><mml:math id="mml-ieqn-54"><mml:msub><mml:mi/><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>N<inline-formula id="ieqn-55"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i055.jpg"/><tex-math id="M62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_2\end{document}</tex-math><mml:math id="mml-ieqn-55"><mml:msub><mml:mi/><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-56"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i056.jpg"/><tex-math id="M63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_9\end{document}</tex-math><mml:math id="mml-ieqn-56"><mml:msub><mml:mi/><mml:mn>9</mml:mn></mml:msub></mml:math></alternatives></inline-formula>S<inline-formula id="ieqn-57"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i057.jpg"/><tex-math id="M64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_2\end{document}</tex-math><mml:math id="mml-ieqn-57"><mml:msub><mml:mi/><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>-H]<inline-formula id="ieqn-58"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i058.jpg"/><tex-math id="M65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-58"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, 447.1 <italic>m/z</italic>) (<xref rid="ref-38" ref-type="bibr">Wu et al., 2018</xref>).</p>
      <fig id="fig-3" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-3</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Background optimization with TrIQ.</title>
          <p>Three mass traces of LAESI MSI data from a <italic>A. thaliana</italic> leaf are plotted. (A) Raw data plotting with 256 gray levels. (B) TrIQ with 32 gray levels. (C) TrIQ with 9 gray levels. The background uniformity is improved by reducing the intensity and gray levels. (D) TrIQ with 32 gray levels and black level adjustment eliminates background noise without reducing color depth (dataset from <xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš (2020)</xref>). (E) Photograph of the sample.</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g003"/>
      </fig>
      <p>Removing outliers with TrIQ and reducing gray levels lead to improved image brightness (see <xref ref-type="fig" rid="fig-3">Figs. 3A</xref> and <xref ref-type="fig" rid="fig-3">3B</xref>). Nevertheless, background noise is also enhanced, and the sample shape is not well defined (see ion 209 <italic>m/z</italic> in <xref ref-type="fig" rid="fig-3">Fig. 3B</xref>). There are two possibilities for background correction with TrIQ. The first option is reducing the number of gray levels, thus grouping a wider range of values within a single bin. Reducing the gray levels from 32 to 9 produced an almost perfectly uniform background and a well-defined sample shape, as shown in <xref ref-type="fig" rid="fig-3">Fig. 3C</xref>. The second method finds a new <italic>black level threshold</italic> that substitutes the operator <inline-formula id="ieqn-59"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i059.jpg"/><tex-math id="M66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}min(f)\end{document}</tex-math><mml:math id="mml-ieqn-59"><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="eqn-5">Eq. (5)</xref>. As the color bars for this approach indicate, the black level thresholds depend on the individual image data (see <xref ref-type="fig" rid="fig-3">Fig. 3D</xref>). Both methods efficiently diminish the impact of background noise. But whereas reducing the gray levels is the simpler approach, defining a new black level threshold maintains the color depth.</p>
    </sec>
    <sec>
      <title>Normalization for comparable mass spectrometry images</title>
      <p>Comparing mass spectrometry images (MSI) is a challenge because standard quantization procedures create images with distinct intensity and color scales, even if they were measured under the same experimental conditions.</p>
      <p>Global TrIQ finds the highest <inline-formula id="ieqn-60"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i060.jpg"/><tex-math id="M67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-60"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> among a given MSI set. This threshold is used for computing the transition levels and mapping MSI intensities to discrete values on every image within the set.</p>
      <p><xref ref-type="fig" rid="fig-4">Figure 4</xref> shows human colorectal adenocarcinoma images. The samples come from the same tissue, cut into slices with a thickness of 10 <inline-formula id="ieqn-61"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i061.jpg"/><tex-math id="M68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-61"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m (<xref rid="ref-20" ref-type="bibr">Oetjen et al., 2015</xref>). All images visualize the abundance of the ion 885.55 <italic>m/z</italic>. The plotting of the raw data resulted in images of low contrast, which are difficult to interpret and to compare (see <xref ref-type="fig" rid="fig-4">Fig. 4A</xref>). Using the Global TrIQ algorithm, a maximum threshold <inline-formula id="ieqn-62"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i062.jpg"/><tex-math id="M69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-62"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> of 4,970 was calculated and applied for all twelve images; the accumulated probability was set to 0.91. The resulting color scale is the same for all images (see <xref ref-type="fig" rid="fig-4">Fig. 4B</xref>). Thus, the relative abundance and distribution of the ion in multiple images can be evaluated at a single glance.</p>
      <fig id="fig-4" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-4</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Global TrIQ applied to the ion 885.55 <italic>m/z</italic> of human colorectal adenocarcinoma DESI MSI slices, with <italic>P</italic> = 0.91 and 32 gray levels.</title>
          <p>Compared to the raw data visualization (A), the contrast is drastically enhanced by applying the TrIQ algorithm (B). The normalization also allows a direct comparison of the images (dataset from <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g004"/>
      </fig>
      <p><xref ref-type="fig" rid="fig-5">Figure 5</xref> provides another example of global TrIQ. The image compares the 62.1, 84.1, and 306.1 <italic>m/z</italic> ions of chili (<italic>Capsicum annuum)</italic> slices sampled at 1 mm lateral resolution with low-temperature plasma (LTP) MSI (<xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al., 2014</xref>). LTP MSI detects small, volatile compounds. Therefore, the images resulting from this ambient ionization technique are noisy. TrIQ with <inline-formula id="ieqn-63"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i063.jpg"/><tex-math id="M70">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}P = 0.98\end{document}</tex-math><mml:math id="mml-ieqn-63"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>0.98</mml:mn></mml:math></alternatives></inline-formula> and five gray levels improves the contrast. The remaining noise is efficiently removed with a <inline-formula id="ieqn-64"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i064.jpg"/><tex-math id="M71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}3 \times 3\end{document}</tex-math><mml:math id="mml-ieqn-64"><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:math></alternatives></inline-formula> median filter (see <xref ref-type="fig" rid="fig-5">Fig. 5</xref>). The signals with a mass-to-charge ratio of 62.1 and 84.1 display a defined localization at the seeds and at the center of the placenta. The signal with 306.1 <italic>m/z</italic> is enriched in placenta tissue and corresponds to the [C<inline-formula id="ieqn-65"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i065.jpg"/><tex-math id="M72">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{18}\end{document}</tex-math><mml:math id="mml-ieqn-65"><mml:msub><mml:mi/><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-66"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i066.jpg"/><tex-math id="M73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{27}\end{document}</tex-math><mml:math id="mml-ieqn-66"><mml:msub><mml:mi/><mml:mrow><mml:mn>27</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>NO<inline-formula id="ieqn-67"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i067.jpg"/><tex-math id="M74">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_3\end{document}</tex-math><mml:math id="mml-ieqn-67"><mml:msub><mml:mi/><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>+H]<inline-formula id="ieqn-68"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i068.jpg"/><tex-math id="M75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ +\end{document}</tex-math><mml:math id="mml-ieqn-68"><mml:msup><mml:mi/><mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> ion of capsaicin, the compound responsible for the hot taste of chili peppers (<xref rid="ref-2" ref-type="bibr">Aza-González, Núñez-Palenius &amp; Ochoa-Alejo, 2011</xref>; <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al., 2014</xref>; <xref rid="ref-8" ref-type="bibr">Gamboa-Becerra et al., 2015</xref>; <xref rid="ref-5" ref-type="bibr">Cervantes-Hernández et al., 2019</xref>).</p>
      <fig id="fig-5" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-5</object-id>
        <label>Figure 5</label>
        <caption>
          <title>LTP MSI of a chili <italic>C. annuum</italic> fruit with 1 mm lateral resolution.</title>
          <p>TrIQ with <italic>P</italic> = 0.98 and 5 gray levels improves the contrast; an additional median filter removes technical noise (dataset from <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al. (2014</xref>, <xref rid="ref-18" ref-type="bibr">2017)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g005"/>
      </fig>
      <p>Both examples demonstrate the usefulness of TrIQ to normalize MSI data for image comparison.</p>
    </sec>
    <sec>
      <title>Segmentation and visualization of regions of interest (ROI)</title>
      <p>Finding regions of interest (ROI) in MSI datasets is essential for biomarker discovery and physiological studies. High-contrast and low-noise images favor the automated segmentation. <xref ref-type="fig" rid="fig-6">Figure 6</xref> compares binary masks obtained using the standard Otsu algorithm and TrIQ. The input image was zero-memory quantized with 256 bins before applying the Otsu algorithm. The TrIQ binary masks were obtained by setting TRUE all non-zero values of the median filtered images of <xref ref-type="fig" rid="fig-5">Fig. 5</xref>.</p>
      <fig id="fig-6" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-6</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Image segmentation for <italic>C. annuum</italic> obtained with Otsu and TrIQ.</title>
          <p>For images with intensity outliers and noisy regions, TrIQ combined with median filtering gives larger and more uniform regions compared to the standard Otsu algorithm (dataset from <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al. (2014</xref>, <xref rid="ref-18" ref-type="bibr">2017)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g006"/>
      </fig>
      <p>TrIQ-median filtered images show more extensive and homogenous regions compared to the Otsu masks and fit well with the anatomical fruit sections of the optical image (see <xref ref-type="fig" rid="fig-6">Fig. 6</xref>).</p>
      <p><xref ref-type="fig" rid="fig-7">Figure 7</xref> shows the Global TrIQ segmentation of mouse urinary bladder data, scanned with AP-MALDI MSI at a lateral resolution of 10 <italic>μ</italic>m (<xref rid="ref-27" ref-type="bibr">Römpp et al., 2010</xref>; <xref rid="ref-28" ref-type="bibr">Römpp et al., 2014</xref>). The distribution of 741.53 <italic>m/z</italic>, identified as a sphingomyelin [C<inline-formula id="ieqn-69"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i069.jpg"/><tex-math id="M76">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{39}\end{document}</tex-math><mml:math id="mml-ieqn-69"><mml:msub><mml:mi/><mml:mrow><mml:mn>39</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-70"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i070.jpg"/><tex-math id="M77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{79}\end{document}</tex-math><mml:math id="mml-ieqn-70"><mml:msub><mml:mi/><mml:mrow><mml:mn>79</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>N<inline-formula id="ieqn-71"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i071.jpg"/><tex-math id="M78">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_2\end{document}</tex-math><mml:math id="mml-ieqn-71"><mml:msub><mml:mi/><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-72"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i072.jpg"/><tex-math id="M79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_6\end{document}</tex-math><mml:math id="mml-ieqn-72"><mml:msub><mml:mi/><mml:mn>6</mml:mn></mml:msub></mml:math></alternatives></inline-formula>P + K]<inline-formula id="ieqn-73"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i073.jpg"/><tex-math id="M80">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ +\end{document}</tex-math><mml:math id="mml-ieqn-73"><mml:msup><mml:mi/><mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> ion, is related to muscle tissue. 743.54 <italic>m/z</italic> is associated with the <italic>lamina propria</italic> structure, while 798.54 <italic>m/z</italic> is mainly found in the <italic>urothelium</italic> (<xref rid="ref-27" ref-type="bibr">Römpp et al., 2010</xref>). Global TrIQ was applied with <italic>P</italic> = 0.95 and 25 gray levels. TrIQ and median filtering allow clear discrimination between muscle tissue and <italic>lamina propria</italic> using the marker ions 741.53 and 743.54 <italic>m/z</italic>. For separating the <italic>urothelium</italic> structure from the muscular tissue, the binary image for 798.54 <italic>m/z</italic> was calculated by zeroing gray levels below nine. In contrast, if the Otsu method is applied to the 798.54 <italic>m/z</italic> ion, the <italic>urothelium</italic> region is isolated automatically. This result is expected since the Otsu method assumes an image histogram distribution with a deep sharp valley between two peaks. <xref ref-type="fig" rid="fig-8">Figure 8</xref> shows an overlay of the TrIQ processed ion images, representing correctly the anatomical structures of the mouse urinary bladder.</p>
      <fig id="fig-7" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-7</object-id>
        <label>Figure 7</label>
        <caption>
          <title>AP-MALDI MSI of a mouse urinary bladder imaged with a lateral resolution of 10 <italic>μ</italic>m.</title>
          <p>TrIQ was applied with <italic>P</italic> = 0.95 and 25 gray levels. Binary images serve for defining regions of interest (ROI) and segmentation: 741.53 <italic>m/z</italic>-muscle tissue, 743.54 <italic>m/z</italic>-lamina propria structure, 798.54 <italic>m/z</italic>-urothelium (dataset from <xref rid="ref-27" ref-type="bibr">Römpp et al. (2010</xref>, <xref rid="ref-28" ref-type="bibr">2014)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g007"/>
      </fig>
      <fig id="fig-8" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-8</object-id>
        <label>Figure 8</label>
        <caption>
          <title>Overlay image, representing the anatomical structures in mouse urinary bladder.</title>
          <p>Blue: 741.53 <italic>m/z</italic>-muscle tissue, red: 743.54 <italic>m/z</italic>-lamina propria, yellow: 798.54 <italic>m/z</italic>-urothelium (dataset from <xref rid="ref-27" ref-type="bibr">Römpp et al. (2010</xref>, <xref rid="ref-28" ref-type="bibr">2014)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g008"/>
      </fig>
    </sec>
    <sec>
      <title>Computational performance of the algorithm</title>
      <p>For estimating the computational performance of the TrIQ algorithm, we reprocessed selected ion traces presented in this paper (DESI 885.55 <italic>m/z</italic>, LAESI 209 <italic>m/z</italic>, LTP 62.1 <italic>m/z</italic>, and AP-MALDI 741.53 <italic>m/z</italic>) and measured the time for applying the TrIQ. To test the suitability of the TrIQ algorithm for large images, we built synthetic slices by sequentially doubling the DESI data. Time calculation was executed 25 times to account for variations in system processes of the operating system. <xref ref-type="fig" rid="fig-9">Figure 9</xref> demonstrates the results from running the R script Timing. R (provided as supplemental code) on a standard Linux laptop (Intel(R) Core(TM) i7-7700HQ CPU with 2.80 GHz, 16 Gb RAM, Peppermint OS 10). On average, more than 1,000 pixels were processed per millisecond. In the tested range, i.e., up to &gt;500,000 pixels, the execution speed was proportional to the image’s size. Thus, the TrIQ algorithm is computationally efficient and scalable.</p>
      <fig id="fig-9" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-9</object-id>
        <label>Figure 9</label>
        <caption>
          <title>Execution speed of the TrIQ algorithm, implemented in R, using a standard laptop (experimental and synthetic data).</title>
          <p>About 1,000 pixels were processed per millisecond. The TrIQ algorithm scales linearly.</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g009"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>Threshold Intensity Optimization (TrIQ) improves the visualization of mass spectrometry imaging (MSI) data by augmenting the contrast and homogenizing the background. Contrary to histogram equalization algorithms, TrIQ preserves the linearity of measured ion intensities.</p>
    <p>The processing with TrIQ facilitates the recognition of regions of interest (ROI) in MSI data sets, either by visual inspection of by automated segmentation algorithms, supporting the interpretation of MSI data in biology and medicine.</p>
    <p>As with any data filtering method, TrIQ could remove or alter valuable information. Therefore, it is recommendable to compare raw and processed images and carefully adjust the target probability and the number of gray levels. MSI technology itself causes further sources of errors. Fixation agents, solvents, and matrix compounds can lead to background signals. To some extent, such off-sample ions can be removed manually, or using MSI software (<xref rid="ref-22" ref-type="bibr">Ovchinnikova et al., 2020</xref>). Technical variations caused by the sample topology or unstable ionization add additional inaccuracies (<xref rid="ref-3" ref-type="bibr">Bartels et al., 2017</xref>). Further, the ion count is not strictly proportional to the abundance of a molecule but depends on the local sample structure and composition, and the desorption/ionization principle. Thus, complementary MSI, optical and histological methods should be used on the same sample (<xref rid="ref-34" ref-type="bibr">Swales et al., 2019</xref>).</p>
    <p>Applying TrIQ to a set of images equalizes their intensity scales and makes them comparable. We demonstrated the implementation of the TrIQ algorithms in R to process MSI data in the community format imzML. The algorithm is computationally fast and only requires basic operations, and thus can be quickly adapted to any programming language. TrIQ can be applied to improve any scientific data plotting with extreme values, respecting the original intensity levels of raw data.</p>
  </sec>
  <sec>
    <title>Code availability</title>
    <p>RmsiGUI is freely available from <uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>. We released TrIQ R scripts and the R package RmsiGUI under the terms of the GNU General Public License, GPL V3 (<uri xlink:href="http://gplv3.fsf.org/">http://gplv3.fsf.org/</uri>).</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Dr. Abigail Moreno Pedraza, Dr. Teresa Maria Teresa Carrillo Rayas, Maria Isabel Cristina Elizarraraz Anaya, and Thermo Mexico for technical support and the research groups that made their code and MSI datasets public.</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn fn-type="COI-statement" id="conflict-1">
        <p>Robert Winkler is an Academic Editor for PeerJ, co-inventor of the patent application “Non-thermal plasma jet device as source of spatial ionisation for ambient mass spectrometry and method of application” (WO 2014/057409) and a shareholder of the company Kuturabi SA. de CV.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn fn-type="con" id="contribution-1">
        <p><xref ref-type="contrib" rid="author-1">Ignacio Rosas-Román</xref> conceived and designed the experiments, performed the experiments, analyzed the data, performed the computation work, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
      <fn fn-type="con" id="contribution-2">
        <p><xref ref-type="contrib" rid="author-2">Robert Winkler</xref> conceived and designed the experiments, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Patent Disclosures</title>
      <fn id="addinfo-1">
        <p>The following patent dependencies were disclosed by the authors:</p>
        <p>Robert Winkler is a co-inventor of the patent application “Non-thermal plasma jet device as source of spatial ionisation for ambient mass spectrometry and method of application” (WO 2014/057409).</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-2">
        <p>The following information was supplied regarding data availability:</p>
        <p>The software RmsiGUI is freely available from <uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Abdullah-Al-Wadud et al. (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdullah-Al-Wadud</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kabir</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Akber Dewan</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Chae</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A dynamic histogram equalization for image contrast enhancement</article-title>
        <source>IEEE Transactions on Consumer Electronics</source>
        <year>2007</year>
        <volume>53</volume>
        <issue>2</issue>
        <fpage>593</fpage>
        <lpage>600</lpage>
        <pub-id pub-id-type="doi">10.1109/TCE.2007.381734</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Aza-González, Núñez-Palenius &amp; Ochoa-Alejo (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aza-González</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Núñez-Palenius</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Ochoa-Alejo</surname>
            <given-names>Ní</given-names>
          </name>
        </person-group>
        <article-title>Molecular biology of capsaicinoid biosynthesis in chili pepper (Capsicum spp.)</article-title>
        <source>Plant cell reports</source>
        <year>2011</year>
        <volume>30</volume>
        <issue>5</issue>
        <fpage>695</fpage>
        <lpage>706</lpage>
        <pub-id pub-id-type="doi">10.1007/s00299-010-0968-8</pub-id>
        <pub-id pub-id-type="pmid">21161234</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Bartels et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartels</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kulkarni</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Danz</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Böcker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Saluz</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Svatoš</surname>
            <given-names>Aš</given-names>
          </name>
        </person-group>
        <article-title>Mapping metabolites from rough terrain: laser ablation electrospray ionization on non-flat samples</article-title>
        <source>RSC Advances</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>15</issue>
        <fpage>9045</fpage>
        <lpage>9050</lpage>
        <pub-id pub-id-type="doi">10.1039/C6RA26854D</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-40">
      <label>Bemis et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bemis</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Harry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eberlin</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>van de Ven</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stolowitz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vitek</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Cardinal: an R package for statistical analysis of mass spectrometry based imaging experiments</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>14</issue>
        <fpage>2418</fpage>
        <lpage>2420</lpage>
        <pub-id pub-id-type="pmid">25777525</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Borland &amp; Taylor li (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Borland</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Taylor li</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Rainbow color map (still) considered harmful</article-title>
        <source>IEEE Computer Graphics and Applications</source>
        <year>2007</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>14</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1109/MCG.2007.323435</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Cervantes-Hernández et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cervantes-Hernández</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Alcalá-González</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Martínez</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ordaz-Ortiz</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Placenta, pericarp, and seeds of tabasco chili pepper fruits show a contrasting diversity of bioactive metabolites</article-title>
        <source>Metabolites</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>206</fpage>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Doi (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doi</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Diagnostic imaging over the last 50 years: research and development in medical imaging science and technology</article-title>
        <source>Physics in Medicine and Biology</source>
        <year>2006</year>
        <volume>51</volume>
        <issue>13</issue>
        <fpage>R5</fpage>
        <lpage>R27</lpage>
        <pub-id pub-id-type="pmid">16790920</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Föll et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Föll</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Moritz</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wollmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stillger</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Vockert</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Werner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bronsert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rohr</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Grüning</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Schilling</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Accessible and reproducible mass spectrometry imaging data analysis in Galaxy</article-title>
        <source>GigaScience</source>
        <year>2019</year>
        <volume>8</volume>
        <issue>12</issue>
        <fpage>143</fpage>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Gamboa-Becerra et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gamboa-Becerra</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ramírez-Chávez</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Molina-Torres</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>MSI.R scripts reveal volatile and semi-volatile features in low-temperature plasma mass spectrometry imaging (LTP-MSI) of chilli (Capsicum annuum)</article-title>
        <source>Analytical and Bioanalytical Chemistry</source>
        <year>2015</year>
        <volume>407</volume>
        <issue>19</issue>
        <fpage>5673</fpage>
        <lpage>5684</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-015-8744-9</pub-id>
        <pub-id pub-id-type="pmid">26007697</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Garnier et al. (2018)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Garnier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rudis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sciaini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Viridis: default Color Maps from ‘matplotlib’</article-title>
        <year>2018</year>
        <uri xlink:href="https://CRAN.R-project.org/package=viridis">https://CRAN.R-project.org/package=viridis</uri>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Gibb &amp; Franceschi (2019)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Gibb</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Franceschi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>MALDIquantForeign: import/export routines for ‘MALDIquant’</article-title>
        <year>2019</year>
        <uri xlink:href="https://CRAN.R-project.org/package=MALDIquantForeign">https://CRAN.R-project.org/package=MALDIquantForeign</uri>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Gibb &amp; Strimmer (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibb</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>MALDIquant: a versatile R package for the analysis of mass spectrometry data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>17</issue>
        <fpage>2270</fpage>
        <lpage>2271</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts447</pub-id>
        <pub-id pub-id-type="pmid">22796955</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Gomès, Assy &amp; Chapuis (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gomès</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Assy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chapuis</surname>
            <given-names>P-O</given-names>
          </name>
        </person-group>
        <article-title>Scanning thermal microscopy: a review</article-title>
        <source>Physica Status Solidi (A)</source>
        <year>2015</year>
        <volume>212</volume>
        <issue>3</issue>
        <fpage>477</fpage>
        <lpage>494</lpage>
        <pub-id pub-id-type="doi">10.1002/pssa.201400360</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Gormanns et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gormanns</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Reckow</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Poczatek</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Turck</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Lechene</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Segmentation of multi-isotope imaging mass spectrometry data for semi-automatic detection of regions of interest</article-title>
        <source>PLOS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>2</issue>
        <elocation-id>e30576</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0030576</pub-id>
        <pub-id pub-id-type="pmid">22347386</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Kimpe &amp; Tuytschaever (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimpe</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tuytschaever</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Increasing the number of gray shades in medical display systems 2014 how much is enough?</article-title>
        <source>Journal of Digital Imaging</source>
        <year>2007</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>422</fpage>
        <lpage>432</lpage>
        <pub-id pub-id-type="doi">10.1007/s10278-006-1052-3</pub-id>
        <pub-id pub-id-type="pmid">17195900</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>López-Fernández et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>López-Fernández</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Santos</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Capelo</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Fdez-Riverola</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Glez-Peña</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reboiro-Jato</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Mass-up: an all-in-one open software application for MALDI-TOF mass spectrometry knowledge discovery</article-title>
        <source>BMC Bioinformatics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>318</fpage>
        <pub-id pub-id-type="pmid">26437641</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Lu et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chingin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Ambient mass spectrometry for food science and industry</article-title>
        <source>TrAC Trends in Analytical Chemistry</source>
        <year>2018</year>
        <volume>107</volume>
        <fpage>99</fpage>
        <lpage>115</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trac.2018.07.017</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Maldonado-Torres et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maldonado-Torres</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>López-Hernández</surname>
            <given-names>Jé F</given-names>
          </name>
          <name>
            <surname>Jiménez-Sandoval</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Plug and play’ assembly of a low-temperature plasma ionization mass spectrometry imaging (LTP-MSI) system</article-title>
        <source>Journal of Proteomics</source>
        <year>2014</year>
        <volume>102C</volume>
        <fpage>60</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jprot.2014.03.003</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Maldonado-Torres et al. (2017)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Maldonado-Torres</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>López-Hernández</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Jiménez-Sandoval</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Low-temperature plasma mass spectrometry imaging (LTP-MSI) of Chili pepper. type: dataset</article-title>
        <year>2017</year>
        <uri xlink:href="https://zenodo.org/record/484496">https://zenodo.org/record/484496</uri>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Nuñez, Anderton &amp; Renslow (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nuñez</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Anderton</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Renslow</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>Optimizing colormaps with consideration for color vision deficiency to enable accurate interpretation of scientific data</article-title>
        <source>PLOS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <issue>7</issue>
        <elocation-id>e0199239</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0199239</pub-id>
        <pub-id pub-id-type="pmid">30067751</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Oetjen et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oetjen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Veselkov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Watrous</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McKenzie</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hauberg-Lotte</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kobarg</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Strittmatter</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>MrÃ3z</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Trede</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Palmer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schiffler</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Steinhorst</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Aichler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goldin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Guntinas-Lichius</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>von Eggeling</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Thiele</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Maedler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Walch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Maass</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dorrestein</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Benchmark datasets for 3D MALDI-and DESI-imaging mass spectrometry</article-title>
        <source>GigaScience</source>
        <year>2015</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>2105</fpage>
        <pub-id pub-id-type="doi">10.1186/s13742-015-0059-4</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Otsu (1979)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Otsu</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A threshold selection method from gray-level histograms</article-title>
        <source>IEEE Transactions on Systems, Man, and Cybernetics</source>
        <year>1979</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>62</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1109/TSMC.1979.4310076</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Ovchinnikova et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ovchinnikova</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kovalev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Stuart</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>OffsampleAI: artificial intelligence approach to recognize off-sample mass spectrometry images</article-title>
        <source>BMC Bioinformatics</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>129</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-020-3425-x</pub-id>
        <pub-id pub-id-type="pmid">32245392</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Pau et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pau</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fuchs</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sklyar</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>EBImage–an R package for image processing with applications to cellular phenotypes</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>7</issue>
        <fpage>979</fpage>
        <lpage>981</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq046</pub-id>
        <pub-id pub-id-type="pmid">20338898</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>R Core Team (2018)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>
            <institution>R Core Team</institution>
          </collab>
        </person-group>
        <source>R: A Language and Environment for Statistical Computing</source>
        <year>2018</year>
        <publisher-loc>Vienna, Austria</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Race &amp; Bunch (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Race</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Bunch</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Optimisation of colour schemes to accurately display mass spectrometry imaging data based on human colour perception</article-title>
        <source>Analytical and Bioanalytical Chemistry</source>
        <year>2015</year>
        <volume>407</volume>
        <issue>8</issue>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-014-8404-5</pub-id>
        <pub-id pub-id-type="pmid">25552319</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Rae Buchberger et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rae Buchberger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>DeLaney</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Mass spectrometry imaging: a review of emerging advancements and future insights</article-title>
        <source>Analytical Chemistry</source>
        <year>2018</year>
        <volume>90</volume>
        <issue>1</issue>
        <fpage>240</fpage>
        <lpage>265</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.7b04733</pub-id>
        <pub-id pub-id-type="pmid">29155564</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Römpp et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guenther</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schober</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kummer</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Histology by mass spectrometry: label-free tissue characterization obtained from high-accuracy bioanalytical imaging</article-title>
        <source>Angewandte Chemie International Edition</source>
        <year>2010</year>
        <volume>49</volume>
        <issue>22</issue>
        <fpage>3834</fpage>
        <lpage>3838</lpage>
        <pub-id pub-id-type="doi">10.1002/anie.200905559</pub-id>
        <pub-id pub-id-type="pmid">20397170</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Römpp et al. (2014)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guenther</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schober</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kummer</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>ProteomeXchange dataset PXD001283</article-title>
        <year>2014</year>
        <uri xlink:href="http://proteomecentral.proteomexchange.org/cgi/GetDataset?ID=PXD001283">http://proteomecentral.proteomexchange.org/cgi/GetDataset?ID=PXD001283</uri>
      </element-citation>
    </ref>
    <ref id="ref-29">
      <label>Römpp et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schramm</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klinkert</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Both</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Heeren</surname>
            <given-names>RMA</given-names>
          </name>
          <name>
            <surname>Stöckli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>imzML: imaging mass spectrometry markup language: a common data format for mass spectrometry imaging</article-title>
        <source>Methods in Molecular Biology</source>
        <year>2011</year>
        <volume>696</volume>
        <fpage>205</fpage>
        <lpage>224</lpage>
        <pub-id pub-id-type="pmid">21063949</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-30">
      <label>Rogowitz, Treinish &amp; Bryson (1996)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogowitz</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Treinish</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Bryson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>How not to lie with visualization</article-title>
        <source>Computers in Physics</source>
        <year>1996</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>268</fpage>
        <pub-id pub-id-type="doi">10.1063/1.4822401</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-31">
      <label>Rosas-Román et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosas-Román</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ovando-Vázquez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Moreno-Pedraza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guillén-Alonso</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Open LabBot and RmsiGUI: community development kit for sampling automation and ambient imaging</article-title>
        <source>Microchemical Journal</source>
        <year>2020</year>
        <volume>152</volume>
        <fpage>104343</fpage>
      </element-citation>
    </ref>
    <ref id="ref-32">
      <label>Schramm et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schramm</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Klinkert</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Both</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Heeren</surname>
            <given-names>RMA</given-names>
          </name>
          <name>
            <surname>Brunelle</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laprévote</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Desbenoit</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Robbe</surname>
            <given-names>M-F</given-names>
          </name>
          <name>
            <surname>Stoeckli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>imzML—a common data format for the flexible exchange and processing of mass spectrometry imaging data</article-title>
        <source>Journal of Proteomics</source>
        <year>2012</year>
        <volume>75</volume>
        <issue>16</issue>
        <fpage>5106</fpage>
        <lpage>5110</lpage>
        <pub-id pub-id-type="pmid">22842151</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-41">
      <label>Stauffer et al. (2015)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Stauffer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Dabernig</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zeileis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Somewhere over the rainbow: howtomake effective use of colors inmeteorological visualizations</article-title>
        <source>Bulletin of the American Meteorological Society</source>
        <year>2015</year>
        <volume>96</volume>
        <publisher-loc>Boston MA, USA Publisher</publisher-loc>
        <publisher-name>Place</publisher-name>
        <fpage>203</fpage>
        <lpage>216</lpage>
      </element-citation>
    </ref>
    <ref id="ref-33">
      <label>Stockham (1972)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stockham</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Image processing in the context of a visual model</article-title>
        <source>Proceedings of the IEEE</source>
        <year>1972</year>
        <volume>60</volume>
        <issue>7</issue>
        <fpage>828</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="doi">10.1109/PROC.1972.8782</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-34">
      <label>Swales et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swales</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Hamm</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Clench</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Goodwin</surname>
            <given-names>RJA</given-names>
          </name>
        </person-group>
        <article-title>Mass spectrometry imaging and its application in pharmaceutical research and development: a concise review</article-title>
        <source>International Journal of Mass Spectrometry</source>
        <year>2019</year>
        <volume>437</volume>
        <fpage>99</fpage>
        <lpage>112</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijms.2018.02.007</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-35">
      <label>Tillner et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tillner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Karancsi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dannhorn</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Veselkov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>McKenzie</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Faster, more reproducible desi-ms for biological tissue imaging</article-title>
        <source>Journal of the American Society for Mass Spectrometry</source>
        <year>2017</year>
        <volume>28</volume>
        <issue>10</issue>
        <fpage>2090</fpage>
        <lpage>2098</lpage>
        <pub-id pub-id-type="doi">10.1007/s13361-017-1714-z</pub-id>
        <pub-id pub-id-type="pmid">28620847</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-36">
      <label>Weiskirchen et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiskirchen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weiskirchen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Software solutions for evaluation and visualization of laser ablation inductively coupled plasma mass spectrometry imaging (LA-ICP-MSI) data: a short overview</article-title>
        <source>Journal of Cheminformatics</source>
        <year>2019</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>16</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-019-0338-7</pub-id>
        <pub-id pub-id-type="pmid">30778692</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-37">
      <label>Winkler (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>An evolving computational platform for biological mass spectrometry: workflows, statistics and data mining with MASSyPup64</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <issue>e1401</issue>
        <fpage>1</fpage>
        <lpage>34</lpage>
      </element-citation>
    </ref>
    <ref id="ref-38">
      <label>Wu et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tohge</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cuadros-Inostroza</surname>
            <given-names>l</given-names>
          </name>
          <name>
            <surname>Tong</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tenenboim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kooke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>MÃ©ret</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Keurentjes</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Nikoloski</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Fernie</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Willmitzer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Brotman</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Mapping the arabidopsis metabolic landscape by untargeted metabolomics at different environmental conditions</article-title>
        <source>Molecular Plant</source>
        <year>2018</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>118</fpage>
        <lpage>134</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molp.2017.08.012</pub-id>
        <pub-id pub-id-type="pmid">28866081</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-39">
      <label>Zeileis, Hornik &amp; Murrell (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeileis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hornik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Murrell</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Escaping RGBland: selecting colors for statistical graphics</article-title>
        <source>Computational Statistics &amp; Data Analysis</source>
        <year>2009</year>
        <volume>53</volume>
        <issue>9</issue>
        <fpage>3259</fpage>
        <lpage>3270</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csda.2008.11.033</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-42">
      <label>Zheng, Bartels &amp; Svatoš (2020)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bartels</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Svatoš</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Laser ablation electrospray ionization mass spectrometry imaging (LAESI MSI) of Arabidopsis thaliana leaf</article-title>
        <year>2020</year>
        <uri xlink:href="https://zenodo.org/record/3678473">https://zenodo.org/record/3678473</uri>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="pmc">peerj-cs</journal-id>
    <journal-id journal-id-type="publisher-id">peerj-cs</journal-id>
    <journal-title-group>
      <journal-title>PeerJ Computer Science</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2376-5992</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8205298</article-id>
    <article-id pub-id-type="publisher-id">cs-585</article-id>
    <article-id pub-id-type="doi">10.7717/peerj-cs.585</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Algorithms and Analysis of Algorithms</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Graphics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Spatial and Geographic Information Systems</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Visual Analytics</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Contrast optimization of mass spectrometry imaging (MSI) data visualization by threshold intensity quantization (TrIQ)</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author">
        <name>
          <surname>Rosas-Román</surname>
          <given-names>Ignacio</given-names>
        </name>
      </contrib>
      <contrib id="author-2" contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-6732-1958</contrib-id>
        <name>
          <surname>Winkler</surname>
          <given-names>Robert</given-names>
        </name>
        <email>robert.winkler@cinvestav.mx</email>
      </contrib>
      <aff><institution>Biotechnology and Biochemistry, CINVESTAV Unidad Irapuato</institution>, <addr-line>Irapuato, Guanajuato</addr-line>, <country>Mexico</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhang</surname>
          <given-names>Li</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2021-06-09">
      <day>9</day>
      <month>6</month>
      <year iso-8601-date="2021">2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>e585</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2020-10-09">
        <day>9</day>
        <month>10</month>
        <year iso-8601-date="2020">2020</year>
      </date>
      <date date-type="accepted" iso-8601-date="2021-05-18">
        <day>18</day>
        <month>5</month>
        <year iso-8601-date="2021">2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Rosas-Román and Winkler</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Rosas-Román and Winkler</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ Computer Science) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/cs-585"/>
    <abstract>
      <p>Mass spectrometry imaging (MSI) enables the unbiased characterization of surfaces with respect to their chemical composition. In biological MSI, zones with differential mass profiles hint towards localized physiological processes, such as the tissue-specific accumulation of secondary metabolites, or diseases, such as cancer. Thus, the efficient discovery of ‘regions of interest’ (ROI) is of utmost importance in MSI. However, often the discovery of ROIs is hampered by high background noise and artifact signals. Especially in ambient ionization MSI, unmasking biologically relevant information from crude data sets is challenging. Therefore, we implemented a Threshold Intensity Quantization (TrIQ) algorithm for augmenting the contrast in MSI data visualizations. The simple algorithm reduces the impact of extreme values (‘outliers’) and rescales the dynamic range of mass signals. We provide an R script for post-processing MSI data in the imzML community format (<uri xlink:href="https://bitbucket.org/lababi/msi.r">https://bitbucket.org/lababi/msi.r</uri>) and implemented the TrIQ in our open-source imaging software RmsiGUI (<uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>). Applying these programs to different biological MSI data sets demonstrated the universal applicability of TrIQ for improving the contrast in the MSI data visualization. We show that TrIQ improves a subsequent detection of ROIs by sectioning. In addition, the adjustment of the dynamic signal intensity range makes MSI data sets comparable.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Ambient ionization</kwd>
      <kwd>Mass spectrometry imaging</kwd>
      <kwd>Image processing</kwd>
      <kwd>Data normalization</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>CONACyT bilateral grant</funding-source>
        <award-id>CONACyT-DFG 2016/277850</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source>CONACyT PostDoc scholarship</funding-source>
      </award-group>
      <funding-statement>The project was funded by the CONACyT bilateral grant CONACyT-DFG 2016/277850. Ignacio Rosas-Román received a CONACyT PostDoc scholarship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Imaging methods such as microscopy, infrared thermography, and magnetic resonance tomography play a central role in science, technology, and medicine (<xref rid="ref-12" ref-type="bibr">Gomès, Assy &amp; Chapuis, 2015</xref>; <xref rid="ref-6" ref-type="bibr">Doi, 2006</xref>).</p>
    <p>Mass spectrometry imaging (MSI) datasets contain spatially resolved spectral information. The parallel detection of multiple compounds with high sensitivity established mass spectrometry (MS) as the first-choice tool for exploratory studies, particularly in combination with data mining methods (<xref rid="ref-15" ref-type="bibr">López-Fernández et al., 2015</xref>; <xref rid="ref-37" ref-type="bibr">Winkler, 2015</xref>). Numerous MSI technologies have been reported; the most commonly used MSI platform is based on matrix-assisted laser desorption/ionization (MALDI), suitable for a wide range of molecules (<xref rid="ref-26" ref-type="bibr">Rae Buchberger et al., 2018</xref>). However, conventional MSI usually requires significant sample preparation and physical conditions, which are incompatible with life. Therefore, there is a keen interest in developing ambient ionization MSI (AIMSI) methods because they enable the direct analysis of delicate materials and biological tissues with no or minimal sample preparation (<xref rid="ref-16" ref-type="bibr">Lu et al., 2018</xref>).</p>
    <p>Unlike digital image acquisition equipment where the luminous intensity is digitalized, MSI signal intensities must be converted to discrete values by a process termed quantization. Each discrete intensity level is known as gray level; intensity quantized images are called grayscale images. Zones in MSI spectra with distinct intensities indicate localized biochemical activity, such as the biosynthesis of natural products or physiological processes. Such <italic>regions of interest</italic> (ROI) can be identified by visual inspection or automated segmentation (<xref rid="ref-13" ref-type="bibr">Gormanns et al., 2012</xref>; <xref rid="ref-40" ref-type="bibr">Bemis et al., 2015</xref>).</p>
    <p>The human vision is limited to the perception of only 700 to 900 shades of gray (<xref rid="ref-14" ref-type="bibr">Kimpe &amp; Tuytschaever, 2007</xref>). With the mapping of gray levels to colors, the visualization of features in an image can be improved. However, color perception is a subjective experience affected by illumination and the individual response of rod and cone photoreceptors located in our eyes. Thus, the used color schemes significantly affect the human perception of scientific data (<xref rid="ref-30" ref-type="bibr">Rogowitz, Treinish &amp; Bryson, 1996</xref>; <xref rid="ref-25" ref-type="bibr">Race &amp; Bunch, 2015</xref>). The frequently used rainbow color map generates colorful images that accentuate differences in signal intensities. However, the resulting images do not comply with ‘perceptual ordering,’ i.e., the spectators of a rainbow-colored MSI visualization cannot intuitively assign the different colors according to the signal intensities. Thus, rainbow color schemes are confusing and even might actively mislead viewers (<xref rid="ref-4" ref-type="bibr">Borland &amp; Taylor li, 2007</xref>). The online tool hclwizard (<uri xlink:href="http://hclwizard.org">http://hclwizard.org</uri>) helps in the generation of custom color maps, which follow the hue-chroma-luminance (HCL) concept and are suitable for different types of scientific data visualizations (<xref rid="ref-39" ref-type="bibr">Zeileis, Hornik &amp; Murrell, 2009</xref>; <xref rid="ref-41" ref-type="bibr">Stauffer et al., 2015</xref>; <xref rid="ref-8" ref-type="bibr">Gamboa-Becerra et al., 2015</xref>). The current gold standard for plotting scientific data is the color map Viridis, which provides linear perception and considers viewers with color vision deficiencies (CVD) (<xref rid="ref-19" ref-type="bibr">Nuñez, Anderton &amp; Renslow, 2018</xref>).</p>
    <p>Another critical aspect of image processing is the adaption of quantitative data to the human vision, i.e., an adjustment of physical data to the biological receiver (<xref rid="ref-33" ref-type="bibr">Stockham, 1972</xref>). Histogram equalization is widely used for enhancing the contrast in images and therefore supporting the recognition of patterns. The application of histogram equalization is simple and computationally fast. In the global histogram equalization (GHE), the entire image data are used to remap the representation levels (<xref rid="ref-1" ref-type="bibr">Abdullah-Al-Wadud et al., 2007</xref>). But the original intensity levels of the pixels are lost, and the fidelity of the data visualization is infringed.</p>
    <p>Thus, we introduce the use of <italic>Threshold Intensity Quantization</italic> (TrIQ) for the processing of conventional and ambient ionization mass spectrometry imaging (MSI/AIMSI) datasets.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <sec>
      <title>Data sets and formats</title>
      <p>We analyzed publicly available mass spectrometry imaging data sets from different MSI acquisition techniques, lateral resolutions, and sample types. The datasets used in this work are listed in <xref rid="table-1" ref-type="table">Table 1</xref>.</p>
      <table-wrap id="table-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/table-1</object-id>
        <label>Table 1</label>
        <caption>
          <title>Mass spectrometry imaging data sets. AP-MALDI-Atmospheric pressure matrix assisted laser desorption/ionization, DESI-Desorption electrospray ionization, LAESI-Laser ablation/electrospray ionization, LTP-Low-temperature plasma, Res.-lateral resolution, Tol.-mass tolerance. References: <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>, <xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš (2020)</xref>, <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al. (2014)</xref>, <xref rid="ref-18" ref-type="bibr">Maldonado-Torres et al. (2017)</xref>, <xref rid="ref-27" ref-type="bibr">Römpp et al. (2010)</xref>, <xref rid="ref-28" ref-type="bibr">Römpp et al. (2014)</xref>.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-cs-07-585-g010"/>
          <table frame="hsides" rules="groups" content-type="text">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Organism, tissue, ref.</th>
                <th rowspan="1" colspan="1">Method</th>
                <th rowspan="1" colspan="1">Res. [<inline-formula id="ieqn-1"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i001.jpg"/><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-1"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m]</th>
                <th rowspan="1" colspan="1">Tol. [ <italic>m/z</italic>]</th>
                <th rowspan="1" colspan="1">Size [pix.]</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Human, colorectal cancer (<xref rid="ref-20" ref-type="bibr">Oetjen et al., 2015</xref>)</td>
                <td rowspan="1" colspan="1">DESI (−)</td>
                <td rowspan="1" colspan="1">100</td>
                <td rowspan="1" colspan="1">±0.3</td>
                <td rowspan="1" colspan="1">67 × 64</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"><italic>A. thaliana</italic>, leaf (<xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš, 2020</xref>)</td>
                <td rowspan="1" colspan="1">LAESI (−)</td>
                <td rowspan="1" colspan="1">200</td>
                <td rowspan="1" colspan="1">±0.3</td>
                <td rowspan="1" colspan="1">46 × 26</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Chili, fruit (<xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al., 2014</xref>; <xref rid="ref-18" ref-type="bibr">Maldonado-Torres et al., 2017</xref>)</td>
                <td rowspan="1" colspan="1">LTP (+)</td>
                <td rowspan="1" colspan="1">1,000</td>
                <td rowspan="1" colspan="1">±0.3</td>
                <td rowspan="1" colspan="1">85 × 50</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Mouse, urinary bladder (<xref rid="ref-27" ref-type="bibr">Römpp et al., 2010</xref>; <xref rid="ref-28" ref-type="bibr">Römpp et al., 2014</xref>)</td>
                <td rowspan="1" colspan="1">AP-MALDI (+)</td>
                <td rowspan="1" colspan="1">10</td>
                <td rowspan="1" colspan="1">±0.1</td>
                <td rowspan="1" colspan="1">260 × 134</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The original DESI data set consists of four samples per image, which we separated for further processing.</p>
      <p>All datasets comply with the imzML data format community standard (<xref rid="ref-32" ref-type="bibr">Schramm et al., 2012</xref>; <xref rid="ref-29" ref-type="bibr">Römpp et al., 2011</xref>), implemented in many proprietary and open source programs for MSI data processing (<xref rid="ref-36" ref-type="bibr">Weiskirchen et al., 2019</xref>).</p>
    </sec>
    <sec>
      <title>Threshold intensity quantization (TrIQ) algorithm</title>
      <p>An image is a function <inline-formula id="ieqn-2"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i002.jpg"/><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}f(x,y)\end{document}</tex-math><mml:math id="mml-ieqn-2"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> that assigns an intensity level for each point <inline-formula id="ieqn-3"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i003.jpg"/><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}x,y\end{document}</tex-math><mml:math id="mml-ieqn-3"><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:math></alternatives></inline-formula> in a two-dimension space. For visualizing <inline-formula id="ieqn-4"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i004.jpg"/><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}f(x,y)\end{document}</tex-math><mml:math id="mml-ieqn-4"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> on a computer screen or printer, the image must be digitized for both intensity and spatial coordinates. As MSI is a scanning technique, spatial coordinates <inline-formula id="ieqn-5"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i005.jpg"/><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}x\end{document}</tex-math><mml:math id="mml-ieqn-5"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="ieqn-6"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i006.jpg"/><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}y\end{document}</tex-math><mml:math id="mml-ieqn-6"><mml:mi>y</mml:mi></mml:math></alternatives></inline-formula> are already discrete values related to the lateral resolution of the scanning device. The intensity values provided by the MS ion detector are analog quantities that must be transformed into discrete ones. Quantization is a process for mapping a range of analog intensity values to a single discrete value, known as a <italic>gray level</italic>. <italic>Zero-memory</italic> is a widely used quantization method. The zero-memory quantizer computes equally spaced intensity bins of width <inline-formula id="ieqn-7"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i007.jpg"/><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}w\end{document}</tex-math><mml:math id="mml-ieqn-7"><mml:mi>w</mml:mi></mml:math></alternatives></inline-formula>:</p>
      <p>
        <disp-formula id="eqn-1">
          <label>(1)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e001.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}w = \left[ {\displaystyle{{max(f) - min(f)} \over n}} \right]\end{document}</tex-math>
            <mml:math id="mml-eqn-1">
              <mml:mi>w</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mrow>
                  <mml:mstyle scriptlevel="0" displaystyle="true">
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>a</mml:mi>
                          <mml:mi>x</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>−</mml:mo>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:mi>n</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo>]</mml:mo>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <inline-formula id="ieqn-8"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i008.jpg"/><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}n\end{document}</tex-math><mml:math id="mml-ieqn-8"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula> represents the number of discrete values, usually 256; <inline-formula id="ieqn-9"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i009.jpg"/><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}min(f)\end{document}</tex-math><mml:math id="mml-ieqn-9"><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> and <inline-formula id="ieqn-10"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i010.jpg"/><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}max(f)\end{document}</tex-math><mml:math id="mml-ieqn-10"><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> operators provide minimum and maximum intensity values. Quantization is based on a comparison with the <italic>transition levels</italic>
<inline-formula id="ieqn-11"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i011.jpg"/><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}{t_k}\end{document}</tex-math><mml:math id="mml-ieqn-11"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>:</p>
      <p>
        <disp-formula id="eqn-2">
          <label>(2)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e002.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}{t_k} = w + min(f),2w + min(f), \ldots ,nw + min(f)\end{document}</tex-math>
            <mml:math id="mml-eqn-2">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo>…</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mi>n</mml:mi>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>Finally, the discrete mapped value <inline-formula id="ieqn-12"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i012.jpg"/><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q\end{document}</tex-math><mml:math id="mml-ieqn-12"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula> is obtained:</p>
      <p>
        <disp-formula id="eqn-3">
          <label>(3)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e003.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q(f(x,y)) = \left\{ {\matrix{  {0,}  {f(x,y) \le {t_1}} \cr  {k,}   {{t_k} &lt; f(x,y) \le {t_{k + 1}}}   } } \right.\end{document}</tex-math>
            <mml:math id="mml-eqn-3">
              <mml:mi>Q</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mtable columnspacing="1em" rowspacing="4pt">
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>&lt;</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
                <mml:mo stretchy="true" symmetric="true" fence="true"/>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>(AI)MSI methods often produce <italic>outliers</italic>, i.e., infrequent extreme intensity values, which drastically reduce image contrast. The <italic>Threshold Intensity Quantization</italic>, or TrIQ, addresses this issue by setting a new upper limit <inline-formula id="ieqn-13"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i013.jpg"/><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-13"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>; intensities above this threshold will be grouped within the highest bin. <inline-formula id="ieqn-14"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i014.jpg"/><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-14"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> computation involves the <italic>cumulative distributive function</italic>
<inline-formula id="ieqn-15"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i015.jpg"/><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}p(k)\end{document}</tex-math><mml:math id="mml-ieqn-15"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> (CDF), defined as</p>
      <p>
        <disp-formula id="eqn-4">
          <label>(4)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e004.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q \approx p(k) = \displaystyle{{\sum\limits_{i = 1}^k h(i)} \over N}\end{document}</tex-math>
            <mml:math id="mml-eqn-4">
              <mml:mi>q</mml:mi>
              <mml:mo>≈</mml:mo>
              <mml:mi>p</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>k</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mstyle scriptlevel="0" displaystyle="true">
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo movablelimits="false">∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munderover>
                      <mml:mi>h</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mstyle>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p><inline-formula id="ieqn-16"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i016.jpg"/><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}h(i)\end{document}</tex-math><mml:math id="mml-ieqn-16"><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> stands for the <inline-formula id="ieqn-17"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i017.jpg"/><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}i\end{document}</tex-math><mml:math id="mml-ieqn-17"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula> bin’s frequency within an image histogram, <inline-formula id="ieqn-18"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i018.jpg"/><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}N\end{document}</tex-math><mml:math id="mml-ieqn-18"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula> is the image’s pixel count. Given a target probability <inline-formula id="ieqn-19"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i019.jpg"/><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-19"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula> it is possible to find the bin <inline-formula id="ieqn-20"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i020.jpg"/><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-20"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> whose CDF closely resembles <inline-formula id="ieqn-21"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i021.jpg"/><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-21"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>. Then, the upper limit of the bin <inline-formula id="ieqn-22"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i022.jpg"/><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-22"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> in <inline-formula id="ieqn-23"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i023.jpg"/><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}h\end{document}</tex-math><mml:math id="mml-ieqn-23"><mml:mi>h</mml:mi></mml:math></alternatives></inline-formula> will be used as the threshold value <inline-formula id="ieqn-24"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i024.jpg"/><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-24"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>. The new transition levels can be defined as:</p>
      <p>
        <disp-formula id="eqn-5">
          <label>(5)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e005.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}w = \left[ {\displaystyle{{T - min(f)} \over {n - 1}}} \right]\end{document}</tex-math>
            <mml:math id="mml-eqn-5">
              <mml:mi>w</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mrow>
                  <mml:mstyle scriptlevel="0" displaystyle="true">
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>T</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:mi>n</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo>]</mml:mo>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="eqn-6">
          <label>(6)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e006.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}{t_k} = w + min(f),2w + min(f), \ldots ,(n - 1)w + min(f)\end{document}</tex-math>
            <mml:math id="mml-eqn-6">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo>…</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>n</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>Therefore, <inline-formula id="ieqn-25"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i025.jpg"/><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q\end{document}</tex-math><mml:math id="mml-ieqn-25"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula> mapping will be</p>
      <p>
        <disp-formula id="eqn-7">
          <label>(7)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e007.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q(f(x,y)) = \left\{ {\matrix{  \hskip-1.5pc{0,} \hskip-2pc  {f(x,y) \le {t_1}} \cr\hskip-1.5pc {k,}   {{t_k} \lt f(x,y) \le {t_{k + 1}}} \cr  {n - 1,} \hskip-1.35pc  {f(x,y) \gt {t_{n - 1}}} } } \right.\end{document}</tex-math>
            <mml:math id="mml-eqn-7">
              <mml:mi>Q</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mtable columnspacing="1em" rowspacing="4pt">
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>&lt;</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>&gt;</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
                <mml:mo stretchy="true" symmetric="true" fence="true"/>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>with <inline-formula id="ieqn-26"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i026.jpg"/><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-26"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> running from 1 to <inline-formula id="ieqn-27"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i027.jpg"/><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}n - 1\end{document}</tex-math><mml:math id="mml-ieqn-27"><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>. From <xref ref-type="disp-formula" rid="eqn-7">Eq. (7)</xref> follows that a higher <inline-formula id="ieqn-28"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i028.jpg"/><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-28"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> leads to a better approximation of <inline-formula id="ieqn-29"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i029.jpg"/><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-29"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>. Default values for <inline-formula id="ieqn-30"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i030.jpg"/><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-30"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="ieqn-31"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i031.jpg"/><tex-math id="M38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-31"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula> in RmsiGUI are 100 and 98%, respectively.</p>
      <p>Using the default values of the TrIQ, 98% (= <inline-formula id="ieqn-32"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i032.jpg"/><tex-math id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-32"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>) of the image’s total intensity are visualized. Pixel intensities above the calculated threshold value <italic>T</italic> are limited to a maximum value. Therefore, the rescaled 100 (= <inline-formula id="ieqn-33"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i033.jpg"/><tex-math id="M40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-33"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>) bins visualize the dataset’s intensity levels with more detail.</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>Several programs and workflows for MSI data analysis employ the statistical language R (<xref rid="ref-24" ref-type="bibr">R Core Team, 2018</xref>), such as MSI.R (<xref rid="ref-8" ref-type="bibr">Gamboa-Becerra et al., 2015</xref>), Cardinal (<xref rid="ref-40" ref-type="bibr">Bemis et al., 2015</xref>), and the Galaxy MSI module (<xref rid="ref-7" ref-type="bibr">Föll et al., 2019</xref>). The Otsu segmentation method (<xref rid="ref-21" ref-type="bibr">Otsu, 1979</xref>) tested in this work comes with the R package EBImage (<xref rid="ref-23" ref-type="bibr">Pau et al., 2010</xref>). Recently, we published an R-based platform for MSI data processing with a graphical user interface, RmsiGUI, which provides modules for the control of an open hardware imaging robot (<italic>Open LabBot</italic>), the processing of raw data, and the analysis of MSI data (<xref rid="ref-31" ref-type="bibr">Rosas-Román et al., 2020</xref>). We integrated the TrIQ algorithm into RmsiGUI and provide the R code snippets for facilitating its adoption into other programs. The source code is freely available from the project repository <uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>.</p>
      <p>We use the viridis color map, which is optimized for human perception and people with color vision deficiencies (<xref rid="ref-19" ref-type="bibr">Nuñez, Anderton &amp; Renslow, 2018</xref>; <xref rid="ref-9" ref-type="bibr">Garnier et al., 2018</xref>). Reading and processing MSI data in imzML format are done with the MALDIquantForeign and MALDIquant libraries (<xref rid="ref-11" ref-type="bibr">Gibb &amp; Strimmer, 2012</xref>; <xref rid="ref-10" ref-type="bibr">Gibb &amp; Franceschi, 2019</xref>).</p>
      <p><xref ref-type="fig" rid="fig-1">Figure 1</xref> shows the graphical user interface of RmsiGUI with the TrIQ option selector.</p>
      <fig id="fig-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-1</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Implementation of the Threshold Intensity Quantization (TrIQ) in the graphical user interface of RmsiGUI (dataset and image from <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>).</title>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g001"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="results|discussion">
    <title>Results and discussion</title>
    <p>The contrast of digital images can be enhanced with additional operations, such as global or local histogram equalization algorithms; however, such image processing tools do not preserve the original gray level scale’s linearity. In contrast, our <italic>Threshold Intensity Quantization</italic> (TrIQ) approach finds an intensity threshold <inline-formula id="ieqn-34"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i034.jpg"/><tex-math id="M41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-34"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> for saturating the images’ last gray level. Importantly, the linearity of the experimentally determined intensity scale is preserved.</p>
    <p>In the next sections, we demonstrate the application of the TrIQ for the processing of mass spectrometry imaging (MSI) datasets. The term <italic>raw image</italic> is used in this paper for denoting images rendered with the default quantization method of R.</p>
    <sec>
      <title>Contrast optimization</title>
      <p><xref ref-type="fig" rid="fig-2">Figure 2</xref> shows the mass spectrometry image of a human colorectal adenocarcinoma sample, acquired with DESI and 100 <inline-formula id="ieqn-35"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i035.jpg"/><tex-math id="M42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-35"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m spatial resolution (<xref rid="ref-20" ref-type="bibr">Oetjen et al., 2015</xref>). The imaged signal of 885.55 <italic>m/z</italic> corresponds to de-protonated phosphatidylinositol (18:0/20:4), [C<inline-formula id="ieqn-36"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i036.jpg"/><tex-math id="M43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{47}\end{document}</tex-math><mml:math id="mml-ieqn-36"><mml:msub><mml:mi/><mml:mrow><mml:mn>47</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-37"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i037.jpg"/><tex-math id="M44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{83}\end{document}</tex-math><mml:math id="mml-ieqn-37"><mml:msub><mml:mi/><mml:mrow><mml:mn>83</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-38"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i038.jpg"/><tex-math id="M45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{13}\end{document}</tex-math><mml:math id="mml-ieqn-38"><mml:msub><mml:mi/><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>P-H]<inline-formula id="ieqn-39"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i039.jpg"/><tex-math id="M46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-39"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula> (<xref rid="ref-35" ref-type="bibr">Tillner et al., 2017</xref>).</p>
      <fig id="fig-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-2</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Contrast enhancement by Threshold Intensity Quantization (TrIQ).</title>
          <p>The mass trace 885.55 <italic>m/z</italic> of DESI MSI data of a human colorectal adenocarcinoma sample was visualized with different quantization methods. (A) Raw data, rendered with 256 gray levels. (B) Plotting with applying the natural logarithm to the intensity values. (C) Image contrast improvement after zero-memory quantization and linear histogram equalization (D) Image contrast improvement using TrIQ with 95 percent and 32 gray levels. Histograms A, B and D were computed with 32 bins; histogram C has 256 bins. (E) Histological staining of a tissue slice (dataset and image E) from <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>.</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g002"/>
      </fig>
      <p>The direct plotting of the extracted <italic>m/z</italic> slice results in the image shown in <xref ref-type="fig" rid="fig-2">Fig. 2A</xref>. The image contains pixels with intensity values of up to 70,280 arbitrary units. Such extreme and infrequent intensity values are called <italic>outliers</italic> and drastically reduce image contrast. The histogram below reveals the reason for the low contrast of the image: Most of the pixels fall into the first four bins after the default R quantization.</p>
      <p>A typical data transformation for imaging is the use of a logarithmic intensity scale. <xref ref-type="fig" rid="fig-2">Figure 2B</xref> shows the image after applying the natural logarithm to the MSI signal intensities and default quantization. The contrast is improved. However, further operations would be necessary, such as the subtraction of the background level. Besides, the interpretation of the non-linear color scale is not intuitive.</p>
      <p>The conventional sequence for improving the contrast of an MSI image is applying the zero-memory quantization of MSI data and a transformation function on the quantized pixels. <xref ref-type="fig" rid="fig-2">Figure 2C</xref> shows the result of this process. Although improved contrast is gained with linear equalization, the corresponding histogram shows that many gray levels were lost in the transformation process. Only eighteen remaining gray levels contain data. This information loss is irreversible and may have adverse effects on the performance of standard segmentation algorithms. To make TrIQ and equalized images comparable, we selected an intensity threshold for saturating the equalized image near to the <inline-formula id="ieqn-40"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i040.jpg"/><tex-math id="M47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-40"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> threshold provided by the TrIQ algorithm. The shown linear equalization histogram has 256 bins.</p>
      <p>Applying the TrIQ algorithm with <inline-formula id="ieqn-41"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i041.jpg"/><tex-math id="M48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}P = 0.95\end{document}</tex-math><mml:math id="mml-ieqn-41"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:math></alternatives></inline-formula> resulted in <xref ref-type="fig" rid="fig-2">Fig. 2D</xref>. Pixels with intensities above <inline-formula id="ieqn-42"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i042.jpg"/><tex-math id="M49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T = 4,244\end{document}</tex-math><mml:math id="mml-ieqn-42"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>244</mml:mn></mml:math></alternatives></inline-formula> were binned within the highest gray level. The corresponding histogram shows an almost flat frequency over a wide intensity range. Compared to the unprocessed image, the contrast of the image was drastically improved, and the linear intensity scale of the color representation was preserved. <xref ref-type="fig" rid="fig-2">Figure 2E</xref> shows the histological staining of the tissue section analyzed. The mass image processed with the TrIQ algorithm reassembles best the anatomical details which are recognizable in the optical image.</p>
    </sec>
    <sec>
      <title>Background optimization</title>
      <p>Various causes can result in background noise, such as sample metabolites with low vapor pressure and matrix compounds. <xref ref-type="fig" rid="fig-3">Figure 3A</xref> shows the rendering of signals from an <italic>Arabidopsis thaliana</italic> leaf, analyzed by LAESI MSI with a lateral resolution of 200 <inline-formula id="ieqn-43"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i043.jpg"/><tex-math id="M50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-43"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m (<xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš, 2020</xref>). The images correspond to the putative negative ions of 4-hydroxymethyl-3-methoxyphenoxyacetic acid ([C<inline-formula id="ieqn-44"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i044.jpg"/><tex-math id="M51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{10}\end{document}</tex-math><mml:math id="mml-ieqn-44"><mml:msub><mml:mi/><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-45"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i045.jpg"/><tex-math id="M52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{12}\end{document}</tex-math><mml:math id="mml-ieqn-45"><mml:msub><mml:mi/><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-46"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i046.jpg"/><tex-math id="M53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_5\end{document}</tex-math><mml:math id="mml-ieqn-46"><mml:msub><mml:mi/><mml:mn>5</mml:mn></mml:msub></mml:math></alternatives></inline-formula>-3H]<inline-formula id="ieqn-47"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i047.jpg"/><tex-math id="M54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-47"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, 209.0 <italic>m/z</italic>), 4-methylsulfonylbutyl glucosinolate ([C<inline-formula id="ieqn-48"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i048.jpg"/><tex-math id="M55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{12}\end{document}</tex-math><mml:math id="mml-ieqn-48"><mml:msub><mml:mi/><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-49"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i049.jpg"/><tex-math id="M56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{23}\end{document}</tex-math><mml:math id="mml-ieqn-49"><mml:msub><mml:mi/><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>NO<inline-formula id="ieqn-50"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i050.jpg"/><tex-math id="M57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{10}\end{document}</tex-math><mml:math id="mml-ieqn-50"><mml:msub><mml:mi/><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>S<inline-formula id="ieqn-51"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i051.jpg"/><tex-math id="M58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_3\end{document}</tex-math><mml:math id="mml-ieqn-51"><mml:msub><mml:mi/><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>-H]<inline-formula id="ieqn-52"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i052.jpg"/><tex-math id="M59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-52"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, 436.0 <italic>m/z</italic>), and indol-3-ylmethyl glucosinolate ([C<inline-formula id="ieqn-53"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i053.jpg"/><tex-math id="M60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{16}\end{document}</tex-math><mml:math id="mml-ieqn-53"><mml:msub><mml:mi/><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-54"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i054.jpg"/><tex-math id="M61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{20}\end{document}</tex-math><mml:math id="mml-ieqn-54"><mml:msub><mml:mi/><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>N<inline-formula id="ieqn-55"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i055.jpg"/><tex-math id="M62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_2\end{document}</tex-math><mml:math id="mml-ieqn-55"><mml:msub><mml:mi/><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-56"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i056.jpg"/><tex-math id="M63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_9\end{document}</tex-math><mml:math id="mml-ieqn-56"><mml:msub><mml:mi/><mml:mn>9</mml:mn></mml:msub></mml:math></alternatives></inline-formula>S<inline-formula id="ieqn-57"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i057.jpg"/><tex-math id="M64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_2\end{document}</tex-math><mml:math id="mml-ieqn-57"><mml:msub><mml:mi/><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>-H]<inline-formula id="ieqn-58"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i058.jpg"/><tex-math id="M65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-58"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, 447.1 <italic>m/z</italic>) (<xref rid="ref-38" ref-type="bibr">Wu et al., 2018</xref>).</p>
      <fig id="fig-3" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-3</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Background optimization with TrIQ.</title>
          <p>Three mass traces of LAESI MSI data from a <italic>A. thaliana</italic> leaf are plotted. (A) Raw data plotting with 256 gray levels. (B) TrIQ with 32 gray levels. (C) TrIQ with 9 gray levels. The background uniformity is improved by reducing the intensity and gray levels. (D) TrIQ with 32 gray levels and black level adjustment eliminates background noise without reducing color depth (dataset from <xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš (2020)</xref>). (E) Photograph of the sample.</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g003"/>
      </fig>
      <p>Removing outliers with TrIQ and reducing gray levels lead to improved image brightness (see <xref ref-type="fig" rid="fig-3">Figs. 3A</xref> and <xref ref-type="fig" rid="fig-3">3B</xref>). Nevertheless, background noise is also enhanced, and the sample shape is not well defined (see ion 209 <italic>m/z</italic> in <xref ref-type="fig" rid="fig-3">Fig. 3B</xref>). There are two possibilities for background correction with TrIQ. The first option is reducing the number of gray levels, thus grouping a wider range of values within a single bin. Reducing the gray levels from 32 to 9 produced an almost perfectly uniform background and a well-defined sample shape, as shown in <xref ref-type="fig" rid="fig-3">Fig. 3C</xref>. The second method finds a new <italic>black level threshold</italic> that substitutes the operator <inline-formula id="ieqn-59"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i059.jpg"/><tex-math id="M66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}min(f)\end{document}</tex-math><mml:math id="mml-ieqn-59"><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="eqn-5">Eq. (5)</xref>. As the color bars for this approach indicate, the black level thresholds depend on the individual image data (see <xref ref-type="fig" rid="fig-3">Fig. 3D</xref>). Both methods efficiently diminish the impact of background noise. But whereas reducing the gray levels is the simpler approach, defining a new black level threshold maintains the color depth.</p>
    </sec>
    <sec>
      <title>Normalization for comparable mass spectrometry images</title>
      <p>Comparing mass spectrometry images (MSI) is a challenge because standard quantization procedures create images with distinct intensity and color scales, even if they were measured under the same experimental conditions.</p>
      <p>Global TrIQ finds the highest <inline-formula id="ieqn-60"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i060.jpg"/><tex-math id="M67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-60"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> among a given MSI set. This threshold is used for computing the transition levels and mapping MSI intensities to discrete values on every image within the set.</p>
      <p><xref ref-type="fig" rid="fig-4">Figure 4</xref> shows human colorectal adenocarcinoma images. The samples come from the same tissue, cut into slices with a thickness of 10 <inline-formula id="ieqn-61"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i061.jpg"/><tex-math id="M68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-61"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m (<xref rid="ref-20" ref-type="bibr">Oetjen et al., 2015</xref>). All images visualize the abundance of the ion 885.55 <italic>m/z</italic>. The plotting of the raw data resulted in images of low contrast, which are difficult to interpret and to compare (see <xref ref-type="fig" rid="fig-4">Fig. 4A</xref>). Using the Global TrIQ algorithm, a maximum threshold <inline-formula id="ieqn-62"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i062.jpg"/><tex-math id="M69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-62"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> of 4,970 was calculated and applied for all twelve images; the accumulated probability was set to 0.91. The resulting color scale is the same for all images (see <xref ref-type="fig" rid="fig-4">Fig. 4B</xref>). Thus, the relative abundance and distribution of the ion in multiple images can be evaluated at a single glance.</p>
      <fig id="fig-4" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-4</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Global TrIQ applied to the ion 885.55 <italic>m/z</italic> of human colorectal adenocarcinoma DESI MSI slices, with <italic>P</italic> = 0.91 and 32 gray levels.</title>
          <p>Compared to the raw data visualization (A), the contrast is drastically enhanced by applying the TrIQ algorithm (B). The normalization also allows a direct comparison of the images (dataset from <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g004"/>
      </fig>
      <p><xref ref-type="fig" rid="fig-5">Figure 5</xref> provides another example of global TrIQ. The image compares the 62.1, 84.1, and 306.1 <italic>m/z</italic> ions of chili (<italic>Capsicum annuum)</italic> slices sampled at 1 mm lateral resolution with low-temperature plasma (LTP) MSI (<xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al., 2014</xref>). LTP MSI detects small, volatile compounds. Therefore, the images resulting from this ambient ionization technique are noisy. TrIQ with <inline-formula id="ieqn-63"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i063.jpg"/><tex-math id="M70">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}P = 0.98\end{document}</tex-math><mml:math id="mml-ieqn-63"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>0.98</mml:mn></mml:math></alternatives></inline-formula> and five gray levels improves the contrast. The remaining noise is efficiently removed with a <inline-formula id="ieqn-64"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i064.jpg"/><tex-math id="M71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}3 \times 3\end{document}</tex-math><mml:math id="mml-ieqn-64"><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:math></alternatives></inline-formula> median filter (see <xref ref-type="fig" rid="fig-5">Fig. 5</xref>). The signals with a mass-to-charge ratio of 62.1 and 84.1 display a defined localization at the seeds and at the center of the placenta. The signal with 306.1 <italic>m/z</italic> is enriched in placenta tissue and corresponds to the [C<inline-formula id="ieqn-65"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i065.jpg"/><tex-math id="M72">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{18}\end{document}</tex-math><mml:math id="mml-ieqn-65"><mml:msub><mml:mi/><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-66"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i066.jpg"/><tex-math id="M73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{27}\end{document}</tex-math><mml:math id="mml-ieqn-66"><mml:msub><mml:mi/><mml:mrow><mml:mn>27</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>NO<inline-formula id="ieqn-67"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i067.jpg"/><tex-math id="M74">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_3\end{document}</tex-math><mml:math id="mml-ieqn-67"><mml:msub><mml:mi/><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>+H]<inline-formula id="ieqn-68"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i068.jpg"/><tex-math id="M75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ +\end{document}</tex-math><mml:math id="mml-ieqn-68"><mml:msup><mml:mi/><mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> ion of capsaicin, the compound responsible for the hot taste of chili peppers (<xref rid="ref-2" ref-type="bibr">Aza-González, Núñez-Palenius &amp; Ochoa-Alejo, 2011</xref>; <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al., 2014</xref>; <xref rid="ref-8" ref-type="bibr">Gamboa-Becerra et al., 2015</xref>; <xref rid="ref-5" ref-type="bibr">Cervantes-Hernández et al., 2019</xref>).</p>
      <fig id="fig-5" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-5</object-id>
        <label>Figure 5</label>
        <caption>
          <title>LTP MSI of a chili <italic>C. annuum</italic> fruit with 1 mm lateral resolution.</title>
          <p>TrIQ with <italic>P</italic> = 0.98 and 5 gray levels improves the contrast; an additional median filter removes technical noise (dataset from <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al. (2014</xref>, <xref rid="ref-18" ref-type="bibr">2017)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g005"/>
      </fig>
      <p>Both examples demonstrate the usefulness of TrIQ to normalize MSI data for image comparison.</p>
    </sec>
    <sec>
      <title>Segmentation and visualization of regions of interest (ROI)</title>
      <p>Finding regions of interest (ROI) in MSI datasets is essential for biomarker discovery and physiological studies. High-contrast and low-noise images favor the automated segmentation. <xref ref-type="fig" rid="fig-6">Figure 6</xref> compares binary masks obtained using the standard Otsu algorithm and TrIQ. The input image was zero-memory quantized with 256 bins before applying the Otsu algorithm. The TrIQ binary masks were obtained by setting TRUE all non-zero values of the median filtered images of <xref ref-type="fig" rid="fig-5">Fig. 5</xref>.</p>
      <fig id="fig-6" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-6</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Image segmentation for <italic>C. annuum</italic> obtained with Otsu and TrIQ.</title>
          <p>For images with intensity outliers and noisy regions, TrIQ combined with median filtering gives larger and more uniform regions compared to the standard Otsu algorithm (dataset from <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al. (2014</xref>, <xref rid="ref-18" ref-type="bibr">2017)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g006"/>
      </fig>
      <p>TrIQ-median filtered images show more extensive and homogenous regions compared to the Otsu masks and fit well with the anatomical fruit sections of the optical image (see <xref ref-type="fig" rid="fig-6">Fig. 6</xref>).</p>
      <p><xref ref-type="fig" rid="fig-7">Figure 7</xref> shows the Global TrIQ segmentation of mouse urinary bladder data, scanned with AP-MALDI MSI at a lateral resolution of 10 <italic>μ</italic>m (<xref rid="ref-27" ref-type="bibr">Römpp et al., 2010</xref>; <xref rid="ref-28" ref-type="bibr">Römpp et al., 2014</xref>). The distribution of 741.53 <italic>m/z</italic>, identified as a sphingomyelin [C<inline-formula id="ieqn-69"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i069.jpg"/><tex-math id="M76">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{39}\end{document}</tex-math><mml:math id="mml-ieqn-69"><mml:msub><mml:mi/><mml:mrow><mml:mn>39</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-70"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i070.jpg"/><tex-math id="M77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{79}\end{document}</tex-math><mml:math id="mml-ieqn-70"><mml:msub><mml:mi/><mml:mrow><mml:mn>79</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>N<inline-formula id="ieqn-71"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i071.jpg"/><tex-math id="M78">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_2\end{document}</tex-math><mml:math id="mml-ieqn-71"><mml:msub><mml:mi/><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-72"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i072.jpg"/><tex-math id="M79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_6\end{document}</tex-math><mml:math id="mml-ieqn-72"><mml:msub><mml:mi/><mml:mn>6</mml:mn></mml:msub></mml:math></alternatives></inline-formula>P + K]<inline-formula id="ieqn-73"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i073.jpg"/><tex-math id="M80">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ +\end{document}</tex-math><mml:math id="mml-ieqn-73"><mml:msup><mml:mi/><mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> ion, is related to muscle tissue. 743.54 <italic>m/z</italic> is associated with the <italic>lamina propria</italic> structure, while 798.54 <italic>m/z</italic> is mainly found in the <italic>urothelium</italic> (<xref rid="ref-27" ref-type="bibr">Römpp et al., 2010</xref>). Global TrIQ was applied with <italic>P</italic> = 0.95 and 25 gray levels. TrIQ and median filtering allow clear discrimination between muscle tissue and <italic>lamina propria</italic> using the marker ions 741.53 and 743.54 <italic>m/z</italic>. For separating the <italic>urothelium</italic> structure from the muscular tissue, the binary image for 798.54 <italic>m/z</italic> was calculated by zeroing gray levels below nine. In contrast, if the Otsu method is applied to the 798.54 <italic>m/z</italic> ion, the <italic>urothelium</italic> region is isolated automatically. This result is expected since the Otsu method assumes an image histogram distribution with a deep sharp valley between two peaks. <xref ref-type="fig" rid="fig-8">Figure 8</xref> shows an overlay of the TrIQ processed ion images, representing correctly the anatomical structures of the mouse urinary bladder.</p>
      <fig id="fig-7" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-7</object-id>
        <label>Figure 7</label>
        <caption>
          <title>AP-MALDI MSI of a mouse urinary bladder imaged with a lateral resolution of 10 <italic>μ</italic>m.</title>
          <p>TrIQ was applied with <italic>P</italic> = 0.95 and 25 gray levels. Binary images serve for defining regions of interest (ROI) and segmentation: 741.53 <italic>m/z</italic>-muscle tissue, 743.54 <italic>m/z</italic>-lamina propria structure, 798.54 <italic>m/z</italic>-urothelium (dataset from <xref rid="ref-27" ref-type="bibr">Römpp et al. (2010</xref>, <xref rid="ref-28" ref-type="bibr">2014)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g007"/>
      </fig>
      <fig id="fig-8" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-8</object-id>
        <label>Figure 8</label>
        <caption>
          <title>Overlay image, representing the anatomical structures in mouse urinary bladder.</title>
          <p>Blue: 741.53 <italic>m/z</italic>-muscle tissue, red: 743.54 <italic>m/z</italic>-lamina propria, yellow: 798.54 <italic>m/z</italic>-urothelium (dataset from <xref rid="ref-27" ref-type="bibr">Römpp et al. (2010</xref>, <xref rid="ref-28" ref-type="bibr">2014)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g008"/>
      </fig>
    </sec>
    <sec>
      <title>Computational performance of the algorithm</title>
      <p>For estimating the computational performance of the TrIQ algorithm, we reprocessed selected ion traces presented in this paper (DESI 885.55 <italic>m/z</italic>, LAESI 209 <italic>m/z</italic>, LTP 62.1 <italic>m/z</italic>, and AP-MALDI 741.53 <italic>m/z</italic>) and measured the time for applying the TrIQ. To test the suitability of the TrIQ algorithm for large images, we built synthetic slices by sequentially doubling the DESI data. Time calculation was executed 25 times to account for variations in system processes of the operating system. <xref ref-type="fig" rid="fig-9">Figure 9</xref> demonstrates the results from running the R script Timing. R (provided as supplemental code) on a standard Linux laptop (Intel(R) Core(TM) i7-7700HQ CPU with 2.80 GHz, 16 Gb RAM, Peppermint OS 10). On average, more than 1,000 pixels were processed per millisecond. In the tested range, i.e., up to &gt;500,000 pixels, the execution speed was proportional to the image’s size. Thus, the TrIQ algorithm is computationally efficient and scalable.</p>
      <fig id="fig-9" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-9</object-id>
        <label>Figure 9</label>
        <caption>
          <title>Execution speed of the TrIQ algorithm, implemented in R, using a standard laptop (experimental and synthetic data).</title>
          <p>About 1,000 pixels were processed per millisecond. The TrIQ algorithm scales linearly.</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g009"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>Threshold Intensity Optimization (TrIQ) improves the visualization of mass spectrometry imaging (MSI) data by augmenting the contrast and homogenizing the background. Contrary to histogram equalization algorithms, TrIQ preserves the linearity of measured ion intensities.</p>
    <p>The processing with TrIQ facilitates the recognition of regions of interest (ROI) in MSI data sets, either by visual inspection of by automated segmentation algorithms, supporting the interpretation of MSI data in biology and medicine.</p>
    <p>As with any data filtering method, TrIQ could remove or alter valuable information. Therefore, it is recommendable to compare raw and processed images and carefully adjust the target probability and the number of gray levels. MSI technology itself causes further sources of errors. Fixation agents, solvents, and matrix compounds can lead to background signals. To some extent, such off-sample ions can be removed manually, or using MSI software (<xref rid="ref-22" ref-type="bibr">Ovchinnikova et al., 2020</xref>). Technical variations caused by the sample topology or unstable ionization add additional inaccuracies (<xref rid="ref-3" ref-type="bibr">Bartels et al., 2017</xref>). Further, the ion count is not strictly proportional to the abundance of a molecule but depends on the local sample structure and composition, and the desorption/ionization principle. Thus, complementary MSI, optical and histological methods should be used on the same sample (<xref rid="ref-34" ref-type="bibr">Swales et al., 2019</xref>).</p>
    <p>Applying TrIQ to a set of images equalizes their intensity scales and makes them comparable. We demonstrated the implementation of the TrIQ algorithms in R to process MSI data in the community format imzML. The algorithm is computationally fast and only requires basic operations, and thus can be quickly adapted to any programming language. TrIQ can be applied to improve any scientific data plotting with extreme values, respecting the original intensity levels of raw data.</p>
  </sec>
  <sec>
    <title>Code availability</title>
    <p>RmsiGUI is freely available from <uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>. We released TrIQ R scripts and the R package RmsiGUI under the terms of the GNU General Public License, GPL V3 (<uri xlink:href="http://gplv3.fsf.org/">http://gplv3.fsf.org/</uri>).</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Dr. Abigail Moreno Pedraza, Dr. Teresa Maria Teresa Carrillo Rayas, Maria Isabel Cristina Elizarraraz Anaya, and Thermo Mexico for technical support and the research groups that made their code and MSI datasets public.</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn fn-type="COI-statement" id="conflict-1">
        <p>Robert Winkler is an Academic Editor for PeerJ, co-inventor of the patent application “Non-thermal plasma jet device as source of spatial ionisation for ambient mass spectrometry and method of application” (WO 2014/057409) and a shareholder of the company Kuturabi SA. de CV.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn fn-type="con" id="contribution-1">
        <p><xref ref-type="contrib" rid="author-1">Ignacio Rosas-Román</xref> conceived and designed the experiments, performed the experiments, analyzed the data, performed the computation work, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
      <fn fn-type="con" id="contribution-2">
        <p><xref ref-type="contrib" rid="author-2">Robert Winkler</xref> conceived and designed the experiments, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Patent Disclosures</title>
      <fn id="addinfo-1">
        <p>The following patent dependencies were disclosed by the authors:</p>
        <p>Robert Winkler is a co-inventor of the patent application “Non-thermal plasma jet device as source of spatial ionisation for ambient mass spectrometry and method of application” (WO 2014/057409).</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-2">
        <p>The following information was supplied regarding data availability:</p>
        <p>The software RmsiGUI is freely available from <uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Abdullah-Al-Wadud et al. (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdullah-Al-Wadud</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kabir</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Akber Dewan</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Chae</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A dynamic histogram equalization for image contrast enhancement</article-title>
        <source>IEEE Transactions on Consumer Electronics</source>
        <year>2007</year>
        <volume>53</volume>
        <issue>2</issue>
        <fpage>593</fpage>
        <lpage>600</lpage>
        <pub-id pub-id-type="doi">10.1109/TCE.2007.381734</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Aza-González, Núñez-Palenius &amp; Ochoa-Alejo (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aza-González</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Núñez-Palenius</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Ochoa-Alejo</surname>
            <given-names>Ní</given-names>
          </name>
        </person-group>
        <article-title>Molecular biology of capsaicinoid biosynthesis in chili pepper (Capsicum spp.)</article-title>
        <source>Plant cell reports</source>
        <year>2011</year>
        <volume>30</volume>
        <issue>5</issue>
        <fpage>695</fpage>
        <lpage>706</lpage>
        <pub-id pub-id-type="doi">10.1007/s00299-010-0968-8</pub-id>
        <pub-id pub-id-type="pmid">21161234</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Bartels et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartels</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kulkarni</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Danz</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Böcker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Saluz</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Svatoš</surname>
            <given-names>Aš</given-names>
          </name>
        </person-group>
        <article-title>Mapping metabolites from rough terrain: laser ablation electrospray ionization on non-flat samples</article-title>
        <source>RSC Advances</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>15</issue>
        <fpage>9045</fpage>
        <lpage>9050</lpage>
        <pub-id pub-id-type="doi">10.1039/C6RA26854D</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-40">
      <label>Bemis et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bemis</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Harry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eberlin</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>van de Ven</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stolowitz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vitek</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Cardinal: an R package for statistical analysis of mass spectrometry based imaging experiments</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>14</issue>
        <fpage>2418</fpage>
        <lpage>2420</lpage>
        <pub-id pub-id-type="pmid">25777525</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Borland &amp; Taylor li (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Borland</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Taylor li</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Rainbow color map (still) considered harmful</article-title>
        <source>IEEE Computer Graphics and Applications</source>
        <year>2007</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>14</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1109/MCG.2007.323435</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Cervantes-Hernández et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cervantes-Hernández</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Alcalá-González</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Martínez</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ordaz-Ortiz</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Placenta, pericarp, and seeds of tabasco chili pepper fruits show a contrasting diversity of bioactive metabolites</article-title>
        <source>Metabolites</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>206</fpage>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Doi (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doi</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Diagnostic imaging over the last 50 years: research and development in medical imaging science and technology</article-title>
        <source>Physics in Medicine and Biology</source>
        <year>2006</year>
        <volume>51</volume>
        <issue>13</issue>
        <fpage>R5</fpage>
        <lpage>R27</lpage>
        <pub-id pub-id-type="pmid">16790920</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Föll et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Föll</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Moritz</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wollmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stillger</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Vockert</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Werner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bronsert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rohr</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Grüning</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Schilling</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Accessible and reproducible mass spectrometry imaging data analysis in Galaxy</article-title>
        <source>GigaScience</source>
        <year>2019</year>
        <volume>8</volume>
        <issue>12</issue>
        <fpage>143</fpage>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Gamboa-Becerra et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gamboa-Becerra</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ramírez-Chávez</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Molina-Torres</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>MSI.R scripts reveal volatile and semi-volatile features in low-temperature plasma mass spectrometry imaging (LTP-MSI) of chilli (Capsicum annuum)</article-title>
        <source>Analytical and Bioanalytical Chemistry</source>
        <year>2015</year>
        <volume>407</volume>
        <issue>19</issue>
        <fpage>5673</fpage>
        <lpage>5684</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-015-8744-9</pub-id>
        <pub-id pub-id-type="pmid">26007697</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Garnier et al. (2018)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Garnier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rudis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sciaini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Viridis: default Color Maps from ‘matplotlib’</article-title>
        <year>2018</year>
        <uri xlink:href="https://CRAN.R-project.org/package=viridis">https://CRAN.R-project.org/package=viridis</uri>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Gibb &amp; Franceschi (2019)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Gibb</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Franceschi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>MALDIquantForeign: import/export routines for ‘MALDIquant’</article-title>
        <year>2019</year>
        <uri xlink:href="https://CRAN.R-project.org/package=MALDIquantForeign">https://CRAN.R-project.org/package=MALDIquantForeign</uri>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Gibb &amp; Strimmer (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibb</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>MALDIquant: a versatile R package for the analysis of mass spectrometry data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>17</issue>
        <fpage>2270</fpage>
        <lpage>2271</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts447</pub-id>
        <pub-id pub-id-type="pmid">22796955</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Gomès, Assy &amp; Chapuis (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gomès</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Assy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chapuis</surname>
            <given-names>P-O</given-names>
          </name>
        </person-group>
        <article-title>Scanning thermal microscopy: a review</article-title>
        <source>Physica Status Solidi (A)</source>
        <year>2015</year>
        <volume>212</volume>
        <issue>3</issue>
        <fpage>477</fpage>
        <lpage>494</lpage>
        <pub-id pub-id-type="doi">10.1002/pssa.201400360</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Gormanns et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gormanns</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Reckow</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Poczatek</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Turck</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Lechene</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Segmentation of multi-isotope imaging mass spectrometry data for semi-automatic detection of regions of interest</article-title>
        <source>PLOS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>2</issue>
        <elocation-id>e30576</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0030576</pub-id>
        <pub-id pub-id-type="pmid">22347386</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Kimpe &amp; Tuytschaever (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimpe</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tuytschaever</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Increasing the number of gray shades in medical display systems 2014 how much is enough?</article-title>
        <source>Journal of Digital Imaging</source>
        <year>2007</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>422</fpage>
        <lpage>432</lpage>
        <pub-id pub-id-type="doi">10.1007/s10278-006-1052-3</pub-id>
        <pub-id pub-id-type="pmid">17195900</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>López-Fernández et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>López-Fernández</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Santos</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Capelo</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Fdez-Riverola</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Glez-Peña</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reboiro-Jato</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Mass-up: an all-in-one open software application for MALDI-TOF mass spectrometry knowledge discovery</article-title>
        <source>BMC Bioinformatics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>318</fpage>
        <pub-id pub-id-type="pmid">26437641</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Lu et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chingin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Ambient mass spectrometry for food science and industry</article-title>
        <source>TrAC Trends in Analytical Chemistry</source>
        <year>2018</year>
        <volume>107</volume>
        <fpage>99</fpage>
        <lpage>115</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trac.2018.07.017</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Maldonado-Torres et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maldonado-Torres</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>López-Hernández</surname>
            <given-names>Jé F</given-names>
          </name>
          <name>
            <surname>Jiménez-Sandoval</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Plug and play’ assembly of a low-temperature plasma ionization mass spectrometry imaging (LTP-MSI) system</article-title>
        <source>Journal of Proteomics</source>
        <year>2014</year>
        <volume>102C</volume>
        <fpage>60</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jprot.2014.03.003</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Maldonado-Torres et al. (2017)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Maldonado-Torres</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>López-Hernández</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Jiménez-Sandoval</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Low-temperature plasma mass spectrometry imaging (LTP-MSI) of Chili pepper. type: dataset</article-title>
        <year>2017</year>
        <uri xlink:href="https://zenodo.org/record/484496">https://zenodo.org/record/484496</uri>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Nuñez, Anderton &amp; Renslow (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nuñez</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Anderton</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Renslow</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>Optimizing colormaps with consideration for color vision deficiency to enable accurate interpretation of scientific data</article-title>
        <source>PLOS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <issue>7</issue>
        <elocation-id>e0199239</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0199239</pub-id>
        <pub-id pub-id-type="pmid">30067751</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Oetjen et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oetjen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Veselkov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Watrous</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McKenzie</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hauberg-Lotte</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kobarg</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Strittmatter</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>MrÃ3z</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Trede</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Palmer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schiffler</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Steinhorst</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Aichler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goldin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Guntinas-Lichius</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>von Eggeling</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Thiele</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Maedler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Walch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Maass</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dorrestein</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Benchmark datasets for 3D MALDI-and DESI-imaging mass spectrometry</article-title>
        <source>GigaScience</source>
        <year>2015</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>2105</fpage>
        <pub-id pub-id-type="doi">10.1186/s13742-015-0059-4</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Otsu (1979)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Otsu</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A threshold selection method from gray-level histograms</article-title>
        <source>IEEE Transactions on Systems, Man, and Cybernetics</source>
        <year>1979</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>62</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1109/TSMC.1979.4310076</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Ovchinnikova et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ovchinnikova</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kovalev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Stuart</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>OffsampleAI: artificial intelligence approach to recognize off-sample mass spectrometry images</article-title>
        <source>BMC Bioinformatics</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>129</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-020-3425-x</pub-id>
        <pub-id pub-id-type="pmid">32245392</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Pau et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pau</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fuchs</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sklyar</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>EBImage–an R package for image processing with applications to cellular phenotypes</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>7</issue>
        <fpage>979</fpage>
        <lpage>981</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq046</pub-id>
        <pub-id pub-id-type="pmid">20338898</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>R Core Team (2018)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>
            <institution>R Core Team</institution>
          </collab>
        </person-group>
        <source>R: A Language and Environment for Statistical Computing</source>
        <year>2018</year>
        <publisher-loc>Vienna, Austria</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Race &amp; Bunch (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Race</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Bunch</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Optimisation of colour schemes to accurately display mass spectrometry imaging data based on human colour perception</article-title>
        <source>Analytical and Bioanalytical Chemistry</source>
        <year>2015</year>
        <volume>407</volume>
        <issue>8</issue>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-014-8404-5</pub-id>
        <pub-id pub-id-type="pmid">25552319</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Rae Buchberger et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rae Buchberger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>DeLaney</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Mass spectrometry imaging: a review of emerging advancements and future insights</article-title>
        <source>Analytical Chemistry</source>
        <year>2018</year>
        <volume>90</volume>
        <issue>1</issue>
        <fpage>240</fpage>
        <lpage>265</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.7b04733</pub-id>
        <pub-id pub-id-type="pmid">29155564</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Römpp et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guenther</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schober</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kummer</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Histology by mass spectrometry: label-free tissue characterization obtained from high-accuracy bioanalytical imaging</article-title>
        <source>Angewandte Chemie International Edition</source>
        <year>2010</year>
        <volume>49</volume>
        <issue>22</issue>
        <fpage>3834</fpage>
        <lpage>3838</lpage>
        <pub-id pub-id-type="doi">10.1002/anie.200905559</pub-id>
        <pub-id pub-id-type="pmid">20397170</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Römpp et al. (2014)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guenther</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schober</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kummer</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>ProteomeXchange dataset PXD001283</article-title>
        <year>2014</year>
        <uri xlink:href="http://proteomecentral.proteomexchange.org/cgi/GetDataset?ID=PXD001283">http://proteomecentral.proteomexchange.org/cgi/GetDataset?ID=PXD001283</uri>
      </element-citation>
    </ref>
    <ref id="ref-29">
      <label>Römpp et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schramm</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klinkert</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Both</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Heeren</surname>
            <given-names>RMA</given-names>
          </name>
          <name>
            <surname>Stöckli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>imzML: imaging mass spectrometry markup language: a common data format for mass spectrometry imaging</article-title>
        <source>Methods in Molecular Biology</source>
        <year>2011</year>
        <volume>696</volume>
        <fpage>205</fpage>
        <lpage>224</lpage>
        <pub-id pub-id-type="pmid">21063949</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-30">
      <label>Rogowitz, Treinish &amp; Bryson (1996)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogowitz</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Treinish</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Bryson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>How not to lie with visualization</article-title>
        <source>Computers in Physics</source>
        <year>1996</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>268</fpage>
        <pub-id pub-id-type="doi">10.1063/1.4822401</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-31">
      <label>Rosas-Román et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosas-Román</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ovando-Vázquez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Moreno-Pedraza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guillén-Alonso</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Open LabBot and RmsiGUI: community development kit for sampling automation and ambient imaging</article-title>
        <source>Microchemical Journal</source>
        <year>2020</year>
        <volume>152</volume>
        <fpage>104343</fpage>
      </element-citation>
    </ref>
    <ref id="ref-32">
      <label>Schramm et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schramm</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Klinkert</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Both</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Heeren</surname>
            <given-names>RMA</given-names>
          </name>
          <name>
            <surname>Brunelle</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laprévote</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Desbenoit</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Robbe</surname>
            <given-names>M-F</given-names>
          </name>
          <name>
            <surname>Stoeckli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>imzML—a common data format for the flexible exchange and processing of mass spectrometry imaging data</article-title>
        <source>Journal of Proteomics</source>
        <year>2012</year>
        <volume>75</volume>
        <issue>16</issue>
        <fpage>5106</fpage>
        <lpage>5110</lpage>
        <pub-id pub-id-type="pmid">22842151</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-41">
      <label>Stauffer et al. (2015)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Stauffer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Dabernig</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zeileis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Somewhere over the rainbow: howtomake effective use of colors inmeteorological visualizations</article-title>
        <source>Bulletin of the American Meteorological Society</source>
        <year>2015</year>
        <volume>96</volume>
        <publisher-loc>Boston MA, USA Publisher</publisher-loc>
        <publisher-name>Place</publisher-name>
        <fpage>203</fpage>
        <lpage>216</lpage>
      </element-citation>
    </ref>
    <ref id="ref-33">
      <label>Stockham (1972)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stockham</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Image processing in the context of a visual model</article-title>
        <source>Proceedings of the IEEE</source>
        <year>1972</year>
        <volume>60</volume>
        <issue>7</issue>
        <fpage>828</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="doi">10.1109/PROC.1972.8782</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-34">
      <label>Swales et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swales</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Hamm</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Clench</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Goodwin</surname>
            <given-names>RJA</given-names>
          </name>
        </person-group>
        <article-title>Mass spectrometry imaging and its application in pharmaceutical research and development: a concise review</article-title>
        <source>International Journal of Mass Spectrometry</source>
        <year>2019</year>
        <volume>437</volume>
        <fpage>99</fpage>
        <lpage>112</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijms.2018.02.007</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-35">
      <label>Tillner et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tillner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Karancsi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dannhorn</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Veselkov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>McKenzie</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Faster, more reproducible desi-ms for biological tissue imaging</article-title>
        <source>Journal of the American Society for Mass Spectrometry</source>
        <year>2017</year>
        <volume>28</volume>
        <issue>10</issue>
        <fpage>2090</fpage>
        <lpage>2098</lpage>
        <pub-id pub-id-type="doi">10.1007/s13361-017-1714-z</pub-id>
        <pub-id pub-id-type="pmid">28620847</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-36">
      <label>Weiskirchen et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiskirchen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weiskirchen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Software solutions for evaluation and visualization of laser ablation inductively coupled plasma mass spectrometry imaging (LA-ICP-MSI) data: a short overview</article-title>
        <source>Journal of Cheminformatics</source>
        <year>2019</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>16</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-019-0338-7</pub-id>
        <pub-id pub-id-type="pmid">30778692</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-37">
      <label>Winkler (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>An evolving computational platform for biological mass spectrometry: workflows, statistics and data mining with MASSyPup64</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <issue>e1401</issue>
        <fpage>1</fpage>
        <lpage>34</lpage>
      </element-citation>
    </ref>
    <ref id="ref-38">
      <label>Wu et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tohge</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cuadros-Inostroza</surname>
            <given-names>l</given-names>
          </name>
          <name>
            <surname>Tong</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tenenboim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kooke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>MÃ©ret</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Keurentjes</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Nikoloski</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Fernie</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Willmitzer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Brotman</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Mapping the arabidopsis metabolic landscape by untargeted metabolomics at different environmental conditions</article-title>
        <source>Molecular Plant</source>
        <year>2018</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>118</fpage>
        <lpage>134</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molp.2017.08.012</pub-id>
        <pub-id pub-id-type="pmid">28866081</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-39">
      <label>Zeileis, Hornik &amp; Murrell (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeileis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hornik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Murrell</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Escaping RGBland: selecting colors for statistical graphics</article-title>
        <source>Computational Statistics &amp; Data Analysis</source>
        <year>2009</year>
        <volume>53</volume>
        <issue>9</issue>
        <fpage>3259</fpage>
        <lpage>3270</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csda.2008.11.033</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-42">
      <label>Zheng, Bartels &amp; Svatoš (2020)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bartels</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Svatoš</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Laser ablation electrospray ionization mass spectrometry imaging (LAESI MSI) of Arabidopsis thaliana leaf</article-title>
        <year>2020</year>
        <uri xlink:href="https://zenodo.org/record/3678473">https://zenodo.org/record/3678473</uri>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="pmc">peerj-cs</journal-id>
    <journal-id journal-id-type="publisher-id">peerj-cs</journal-id>
    <journal-title-group>
      <journal-title>PeerJ Computer Science</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2376-5992</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8205298</article-id>
    <article-id pub-id-type="publisher-id">cs-585</article-id>
    <article-id pub-id-type="doi">10.7717/peerj-cs.585</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Algorithms and Analysis of Algorithms</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Graphics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Spatial and Geographic Information Systems</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Visual Analytics</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Contrast optimization of mass spectrometry imaging (MSI) data visualization by threshold intensity quantization (TrIQ)</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author">
        <name>
          <surname>Rosas-Román</surname>
          <given-names>Ignacio</given-names>
        </name>
      </contrib>
      <contrib id="author-2" contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-6732-1958</contrib-id>
        <name>
          <surname>Winkler</surname>
          <given-names>Robert</given-names>
        </name>
        <email>robert.winkler@cinvestav.mx</email>
      </contrib>
      <aff><institution>Biotechnology and Biochemistry, CINVESTAV Unidad Irapuato</institution>, <addr-line>Irapuato, Guanajuato</addr-line>, <country>Mexico</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhang</surname>
          <given-names>Li</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2021-06-09">
      <day>9</day>
      <month>6</month>
      <year iso-8601-date="2021">2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>7</volume>
    <elocation-id>e585</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2020-10-09">
        <day>9</day>
        <month>10</month>
        <year iso-8601-date="2020">2020</year>
      </date>
      <date date-type="accepted" iso-8601-date="2021-05-18">
        <day>18</day>
        <month>5</month>
        <year iso-8601-date="2021">2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2021 Rosas-Román and Winkler</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Rosas-Román and Winkler</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ Computer Science) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/cs-585"/>
    <abstract>
      <p>Mass spectrometry imaging (MSI) enables the unbiased characterization of surfaces with respect to their chemical composition. In biological MSI, zones with differential mass profiles hint towards localized physiological processes, such as the tissue-specific accumulation of secondary metabolites, or diseases, such as cancer. Thus, the efficient discovery of ‘regions of interest’ (ROI) is of utmost importance in MSI. However, often the discovery of ROIs is hampered by high background noise and artifact signals. Especially in ambient ionization MSI, unmasking biologically relevant information from crude data sets is challenging. Therefore, we implemented a Threshold Intensity Quantization (TrIQ) algorithm for augmenting the contrast in MSI data visualizations. The simple algorithm reduces the impact of extreme values (‘outliers’) and rescales the dynamic range of mass signals. We provide an R script for post-processing MSI data in the imzML community format (<uri xlink:href="https://bitbucket.org/lababi/msi.r">https://bitbucket.org/lababi/msi.r</uri>) and implemented the TrIQ in our open-source imaging software RmsiGUI (<uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>). Applying these programs to different biological MSI data sets demonstrated the universal applicability of TrIQ for improving the contrast in the MSI data visualization. We show that TrIQ improves a subsequent detection of ROIs by sectioning. In addition, the adjustment of the dynamic signal intensity range makes MSI data sets comparable.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Ambient ionization</kwd>
      <kwd>Mass spectrometry imaging</kwd>
      <kwd>Image processing</kwd>
      <kwd>Data normalization</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>CONACyT bilateral grant</funding-source>
        <award-id>CONACyT-DFG 2016/277850</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source>CONACyT PostDoc scholarship</funding-source>
      </award-group>
      <funding-statement>The project was funded by the CONACyT bilateral grant CONACyT-DFG 2016/277850. Ignacio Rosas-Román received a CONACyT PostDoc scholarship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Imaging methods such as microscopy, infrared thermography, and magnetic resonance tomography play a central role in science, technology, and medicine (<xref rid="ref-12" ref-type="bibr">Gomès, Assy &amp; Chapuis, 2015</xref>; <xref rid="ref-6" ref-type="bibr">Doi, 2006</xref>).</p>
    <p>Mass spectrometry imaging (MSI) datasets contain spatially resolved spectral information. The parallel detection of multiple compounds with high sensitivity established mass spectrometry (MS) as the first-choice tool for exploratory studies, particularly in combination with data mining methods (<xref rid="ref-15" ref-type="bibr">López-Fernández et al., 2015</xref>; <xref rid="ref-37" ref-type="bibr">Winkler, 2015</xref>). Numerous MSI technologies have been reported; the most commonly used MSI platform is based on matrix-assisted laser desorption/ionization (MALDI), suitable for a wide range of molecules (<xref rid="ref-26" ref-type="bibr">Rae Buchberger et al., 2018</xref>). However, conventional MSI usually requires significant sample preparation and physical conditions, which are incompatible with life. Therefore, there is a keen interest in developing ambient ionization MSI (AIMSI) methods because they enable the direct analysis of delicate materials and biological tissues with no or minimal sample preparation (<xref rid="ref-16" ref-type="bibr">Lu et al., 2018</xref>).</p>
    <p>Unlike digital image acquisition equipment where the luminous intensity is digitalized, MSI signal intensities must be converted to discrete values by a process termed quantization. Each discrete intensity level is known as gray level; intensity quantized images are called grayscale images. Zones in MSI spectra with distinct intensities indicate localized biochemical activity, such as the biosynthesis of natural products or physiological processes. Such <italic>regions of interest</italic> (ROI) can be identified by visual inspection or automated segmentation (<xref rid="ref-13" ref-type="bibr">Gormanns et al., 2012</xref>; <xref rid="ref-40" ref-type="bibr">Bemis et al., 2015</xref>).</p>
    <p>The human vision is limited to the perception of only 700 to 900 shades of gray (<xref rid="ref-14" ref-type="bibr">Kimpe &amp; Tuytschaever, 2007</xref>). With the mapping of gray levels to colors, the visualization of features in an image can be improved. However, color perception is a subjective experience affected by illumination and the individual response of rod and cone photoreceptors located in our eyes. Thus, the used color schemes significantly affect the human perception of scientific data (<xref rid="ref-30" ref-type="bibr">Rogowitz, Treinish &amp; Bryson, 1996</xref>; <xref rid="ref-25" ref-type="bibr">Race &amp; Bunch, 2015</xref>). The frequently used rainbow color map generates colorful images that accentuate differences in signal intensities. However, the resulting images do not comply with ‘perceptual ordering,’ i.e., the spectators of a rainbow-colored MSI visualization cannot intuitively assign the different colors according to the signal intensities. Thus, rainbow color schemes are confusing and even might actively mislead viewers (<xref rid="ref-4" ref-type="bibr">Borland &amp; Taylor li, 2007</xref>). The online tool hclwizard (<uri xlink:href="http://hclwizard.org">http://hclwizard.org</uri>) helps in the generation of custom color maps, which follow the hue-chroma-luminance (HCL) concept and are suitable for different types of scientific data visualizations (<xref rid="ref-39" ref-type="bibr">Zeileis, Hornik &amp; Murrell, 2009</xref>; <xref rid="ref-41" ref-type="bibr">Stauffer et al., 2015</xref>; <xref rid="ref-8" ref-type="bibr">Gamboa-Becerra et al., 2015</xref>). The current gold standard for plotting scientific data is the color map Viridis, which provides linear perception and considers viewers with color vision deficiencies (CVD) (<xref rid="ref-19" ref-type="bibr">Nuñez, Anderton &amp; Renslow, 2018</xref>).</p>
    <p>Another critical aspect of image processing is the adaption of quantitative data to the human vision, i.e., an adjustment of physical data to the biological receiver (<xref rid="ref-33" ref-type="bibr">Stockham, 1972</xref>). Histogram equalization is widely used for enhancing the contrast in images and therefore supporting the recognition of patterns. The application of histogram equalization is simple and computationally fast. In the global histogram equalization (GHE), the entire image data are used to remap the representation levels (<xref rid="ref-1" ref-type="bibr">Abdullah-Al-Wadud et al., 2007</xref>). But the original intensity levels of the pixels are lost, and the fidelity of the data visualization is infringed.</p>
    <p>Thus, we introduce the use of <italic>Threshold Intensity Quantization</italic> (TrIQ) for the processing of conventional and ambient ionization mass spectrometry imaging (MSI/AIMSI) datasets.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and Methods</title>
    <sec>
      <title>Data sets and formats</title>
      <p>We analyzed publicly available mass spectrometry imaging data sets from different MSI acquisition techniques, lateral resolutions, and sample types. The datasets used in this work are listed in <xref rid="table-1" ref-type="table">Table 1</xref>.</p>
      <table-wrap id="table-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/table-1</object-id>
        <label>Table 1</label>
        <caption>
          <title>Mass spectrometry imaging data sets. AP-MALDI-Atmospheric pressure matrix assisted laser desorption/ionization, DESI-Desorption electrospray ionization, LAESI-Laser ablation/electrospray ionization, LTP-Low-temperature plasma, Res.-lateral resolution, Tol.-mass tolerance. References: <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>, <xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš (2020)</xref>, <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al. (2014)</xref>, <xref rid="ref-18" ref-type="bibr">Maldonado-Torres et al. (2017)</xref>, <xref rid="ref-27" ref-type="bibr">Römpp et al. (2010)</xref>, <xref rid="ref-28" ref-type="bibr">Römpp et al. (2014)</xref>.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-cs-07-585-g010"/>
          <table frame="hsides" rules="groups" content-type="text">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Organism, tissue, ref.</th>
                <th rowspan="1" colspan="1">Method</th>
                <th rowspan="1" colspan="1">Res. [<inline-formula id="ieqn-1"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i001.jpg"/><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-1"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m]</th>
                <th rowspan="1" colspan="1">Tol. [ <italic>m/z</italic>]</th>
                <th rowspan="1" colspan="1">Size [pix.]</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Human, colorectal cancer (<xref rid="ref-20" ref-type="bibr">Oetjen et al., 2015</xref>)</td>
                <td rowspan="1" colspan="1">DESI (−)</td>
                <td rowspan="1" colspan="1">100</td>
                <td rowspan="1" colspan="1">±0.3</td>
                <td rowspan="1" colspan="1">67 × 64</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"><italic>A. thaliana</italic>, leaf (<xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš, 2020</xref>)</td>
                <td rowspan="1" colspan="1">LAESI (−)</td>
                <td rowspan="1" colspan="1">200</td>
                <td rowspan="1" colspan="1">±0.3</td>
                <td rowspan="1" colspan="1">46 × 26</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Chili, fruit (<xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al., 2014</xref>; <xref rid="ref-18" ref-type="bibr">Maldonado-Torres et al., 2017</xref>)</td>
                <td rowspan="1" colspan="1">LTP (+)</td>
                <td rowspan="1" colspan="1">1,000</td>
                <td rowspan="1" colspan="1">±0.3</td>
                <td rowspan="1" colspan="1">85 × 50</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Mouse, urinary bladder (<xref rid="ref-27" ref-type="bibr">Römpp et al., 2010</xref>; <xref rid="ref-28" ref-type="bibr">Römpp et al., 2014</xref>)</td>
                <td rowspan="1" colspan="1">AP-MALDI (+)</td>
                <td rowspan="1" colspan="1">10</td>
                <td rowspan="1" colspan="1">±0.1</td>
                <td rowspan="1" colspan="1">260 × 134</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The original DESI data set consists of four samples per image, which we separated for further processing.</p>
      <p>All datasets comply with the imzML data format community standard (<xref rid="ref-32" ref-type="bibr">Schramm et al., 2012</xref>; <xref rid="ref-29" ref-type="bibr">Römpp et al., 2011</xref>), implemented in many proprietary and open source programs for MSI data processing (<xref rid="ref-36" ref-type="bibr">Weiskirchen et al., 2019</xref>).</p>
    </sec>
    <sec>
      <title>Threshold intensity quantization (TrIQ) algorithm</title>
      <p>An image is a function <inline-formula id="ieqn-2"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i002.jpg"/><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}f(x,y)\end{document}</tex-math><mml:math id="mml-ieqn-2"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> that assigns an intensity level for each point <inline-formula id="ieqn-3"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i003.jpg"/><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}x,y\end{document}</tex-math><mml:math id="mml-ieqn-3"><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:math></alternatives></inline-formula> in a two-dimension space. For visualizing <inline-formula id="ieqn-4"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i004.jpg"/><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}f(x,y)\end{document}</tex-math><mml:math id="mml-ieqn-4"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> on a computer screen or printer, the image must be digitized for both intensity and spatial coordinates. As MSI is a scanning technique, spatial coordinates <inline-formula id="ieqn-5"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i005.jpg"/><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}x\end{document}</tex-math><mml:math id="mml-ieqn-5"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="ieqn-6"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i006.jpg"/><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}y\end{document}</tex-math><mml:math id="mml-ieqn-6"><mml:mi>y</mml:mi></mml:math></alternatives></inline-formula> are already discrete values related to the lateral resolution of the scanning device. The intensity values provided by the MS ion detector are analog quantities that must be transformed into discrete ones. Quantization is a process for mapping a range of analog intensity values to a single discrete value, known as a <italic>gray level</italic>. <italic>Zero-memory</italic> is a widely used quantization method. The zero-memory quantizer computes equally spaced intensity bins of width <inline-formula id="ieqn-7"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i007.jpg"/><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}w\end{document}</tex-math><mml:math id="mml-ieqn-7"><mml:mi>w</mml:mi></mml:math></alternatives></inline-formula>:</p>
      <p>
        <disp-formula id="eqn-1">
          <label>(1)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e001.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}w = \left[ {\displaystyle{{max(f) - min(f)} \over n}} \right]\end{document}</tex-math>
            <mml:math id="mml-eqn-1">
              <mml:mi>w</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mrow>
                  <mml:mstyle scriptlevel="0" displaystyle="true">
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>a</mml:mi>
                          <mml:mi>x</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>−</mml:mo>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:mi>n</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo>]</mml:mo>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>where <inline-formula id="ieqn-8"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i008.jpg"/><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}n\end{document}</tex-math><mml:math id="mml-ieqn-8"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula> represents the number of discrete values, usually 256; <inline-formula id="ieqn-9"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i009.jpg"/><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}min(f)\end{document}</tex-math><mml:math id="mml-ieqn-9"><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> and <inline-formula id="ieqn-10"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i010.jpg"/><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}max(f)\end{document}</tex-math><mml:math id="mml-ieqn-10"><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> operators provide minimum and maximum intensity values. Quantization is based on a comparison with the <italic>transition levels</italic>
<inline-formula id="ieqn-11"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i011.jpg"/><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}{t_k}\end{document}</tex-math><mml:math id="mml-ieqn-11"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>:</p>
      <p>
        <disp-formula id="eqn-2">
          <label>(2)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e002.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}{t_k} = w + min(f),2w + min(f), \ldots ,nw + min(f)\end{document}</tex-math>
            <mml:math id="mml-eqn-2">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo>…</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mi>n</mml:mi>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>Finally, the discrete mapped value <inline-formula id="ieqn-12"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i012.jpg"/><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q\end{document}</tex-math><mml:math id="mml-ieqn-12"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula> is obtained:</p>
      <p>
        <disp-formula id="eqn-3">
          <label>(3)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e003.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q(f(x,y)) = \left\{ {\matrix{  {0,}  {f(x,y) \le {t_1}} \cr  {k,}   {{t_k} &lt; f(x,y) \le {t_{k + 1}}}   } } \right.\end{document}</tex-math>
            <mml:math id="mml-eqn-3">
              <mml:mi>Q</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mtable columnspacing="1em" rowspacing="4pt">
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>&lt;</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
                <mml:mo stretchy="true" symmetric="true" fence="true"/>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>(AI)MSI methods often produce <italic>outliers</italic>, i.e., infrequent extreme intensity values, which drastically reduce image contrast. The <italic>Threshold Intensity Quantization</italic>, or TrIQ, addresses this issue by setting a new upper limit <inline-formula id="ieqn-13"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i013.jpg"/><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-13"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>; intensities above this threshold will be grouped within the highest bin. <inline-formula id="ieqn-14"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i014.jpg"/><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-14"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> computation involves the <italic>cumulative distributive function</italic>
<inline-formula id="ieqn-15"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i015.jpg"/><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}p(k)\end{document}</tex-math><mml:math id="mml-ieqn-15"><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> (CDF), defined as</p>
      <p>
        <disp-formula id="eqn-4">
          <label>(4)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e004.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q \approx p(k) = \displaystyle{{\sum\limits_{i = 1}^k h(i)} \over N}\end{document}</tex-math>
            <mml:math id="mml-eqn-4">
              <mml:mi>q</mml:mi>
              <mml:mo>≈</mml:mo>
              <mml:mi>p</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>k</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mstyle scriptlevel="0" displaystyle="true">
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo movablelimits="false">∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munderover>
                      <mml:mi>h</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mstyle>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p><inline-formula id="ieqn-16"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i016.jpg"/><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}h(i)\end{document}</tex-math><mml:math id="mml-ieqn-16"><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> stands for the <inline-formula id="ieqn-17"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i017.jpg"/><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}i\end{document}</tex-math><mml:math id="mml-ieqn-17"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula> bin’s frequency within an image histogram, <inline-formula id="ieqn-18"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i018.jpg"/><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}N\end{document}</tex-math><mml:math id="mml-ieqn-18"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula> is the image’s pixel count. Given a target probability <inline-formula id="ieqn-19"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i019.jpg"/><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-19"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula> it is possible to find the bin <inline-formula id="ieqn-20"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i020.jpg"/><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-20"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> whose CDF closely resembles <inline-formula id="ieqn-21"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i021.jpg"/><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-21"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>. Then, the upper limit of the bin <inline-formula id="ieqn-22"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i022.jpg"/><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-22"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> in <inline-formula id="ieqn-23"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i023.jpg"/><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}h\end{document}</tex-math><mml:math id="mml-ieqn-23"><mml:mi>h</mml:mi></mml:math></alternatives></inline-formula> will be used as the threshold value <inline-formula id="ieqn-24"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i024.jpg"/><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-24"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>. The new transition levels can be defined as:</p>
      <p>
        <disp-formula id="eqn-5">
          <label>(5)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e005.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}w = \left[ {\displaystyle{{T - min(f)} \over {n - 1}}} \right]\end{document}</tex-math>
            <mml:math id="mml-eqn-5">
              <mml:mi>w</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mrow>
                  <mml:mstyle scriptlevel="0" displaystyle="true">
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>T</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                          <mml:mi>n</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo>]</mml:mo>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="eqn-6">
          <label>(6)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e006.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}{t_k} = w + min(f),2w + min(f), \ldots ,(n - 1)w + min(f)\end{document}</tex-math>
            <mml:math id="mml-eqn-6">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo>…</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>n</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mi>w</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>Therefore, <inline-formula id="ieqn-25"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i025.jpg"/><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q\end{document}</tex-math><mml:math id="mml-ieqn-25"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula> mapping will be</p>
      <p>
        <disp-formula id="eqn-7">
          <label>(7)</label>
          <alternatives>
            <graphic xlink:href="peerj-cs-07-585-e007.jpg" mimetype="image" mime-subtype="png" position="float" orientation="portrait"/>
            <tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}Q(f(x,y)) = \left\{ {\matrix{  \hskip-1.5pc{0,} \hskip-2pc  {f(x,y) \le {t_1}} \cr\hskip-1.5pc {k,}   {{t_k} \lt f(x,y) \le {t_{k + 1}}} \cr  {n - 1,} \hskip-1.35pc  {f(x,y) \gt {t_{n - 1}}} } } \right.\end{document}</tex-math>
            <mml:math id="mml-eqn-7">
              <mml:mi>Q</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>x</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>y</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mtable columnspacing="1em" rowspacing="4pt">
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>&lt;</mml:mo>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>≤</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd columnalign="left">
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>y</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo>&gt;</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
                <mml:mo stretchy="true" symmetric="true" fence="true"/>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>with <inline-formula id="ieqn-26"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i026.jpg"/><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-26"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> running from 1 to <inline-formula id="ieqn-27"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i027.jpg"/><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}n - 1\end{document}</tex-math><mml:math id="mml-ieqn-27"><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>. From <xref ref-type="disp-formula" rid="eqn-7">Eq. (7)</xref> follows that a higher <inline-formula id="ieqn-28"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i028.jpg"/><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-28"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> leads to a better approximation of <inline-formula id="ieqn-29"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i029.jpg"/><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-29"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>. Default values for <inline-formula id="ieqn-30"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i030.jpg"/><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-30"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="ieqn-31"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i031.jpg"/><tex-math id="M38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-31"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula> in RmsiGUI are 100 and 98%, respectively.</p>
      <p>Using the default values of the TrIQ, 98% (= <inline-formula id="ieqn-32"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i032.jpg"/><tex-math id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}q\end{document}</tex-math><mml:math id="mml-ieqn-32"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>) of the image’s total intensity are visualized. Pixel intensities above the calculated threshold value <italic>T</italic> are limited to a maximum value. Therefore, the rescaled 100 (= <inline-formula id="ieqn-33"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i033.jpg"/><tex-math id="M40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}k\end{document}</tex-math><mml:math id="mml-ieqn-33"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>) bins visualize the dataset’s intensity levels with more detail.</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>Several programs and workflows for MSI data analysis employ the statistical language R (<xref rid="ref-24" ref-type="bibr">R Core Team, 2018</xref>), such as MSI.R (<xref rid="ref-8" ref-type="bibr">Gamboa-Becerra et al., 2015</xref>), Cardinal (<xref rid="ref-40" ref-type="bibr">Bemis et al., 2015</xref>), and the Galaxy MSI module (<xref rid="ref-7" ref-type="bibr">Föll et al., 2019</xref>). The Otsu segmentation method (<xref rid="ref-21" ref-type="bibr">Otsu, 1979</xref>) tested in this work comes with the R package EBImage (<xref rid="ref-23" ref-type="bibr">Pau et al., 2010</xref>). Recently, we published an R-based platform for MSI data processing with a graphical user interface, RmsiGUI, which provides modules for the control of an open hardware imaging robot (<italic>Open LabBot</italic>), the processing of raw data, and the analysis of MSI data (<xref rid="ref-31" ref-type="bibr">Rosas-Román et al., 2020</xref>). We integrated the TrIQ algorithm into RmsiGUI and provide the R code snippets for facilitating its adoption into other programs. The source code is freely available from the project repository <uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>.</p>
      <p>We use the viridis color map, which is optimized for human perception and people with color vision deficiencies (<xref rid="ref-19" ref-type="bibr">Nuñez, Anderton &amp; Renslow, 2018</xref>; <xref rid="ref-9" ref-type="bibr">Garnier et al., 2018</xref>). Reading and processing MSI data in imzML format are done with the MALDIquantForeign and MALDIquant libraries (<xref rid="ref-11" ref-type="bibr">Gibb &amp; Strimmer, 2012</xref>; <xref rid="ref-10" ref-type="bibr">Gibb &amp; Franceschi, 2019</xref>).</p>
      <p><xref ref-type="fig" rid="fig-1">Figure 1</xref> shows the graphical user interface of RmsiGUI with the TrIQ option selector.</p>
      <fig id="fig-1" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-1</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Implementation of the Threshold Intensity Quantization (TrIQ) in the graphical user interface of RmsiGUI (dataset and image from <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>).</title>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g001"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="results|discussion">
    <title>Results and discussion</title>
    <p>The contrast of digital images can be enhanced with additional operations, such as global or local histogram equalization algorithms; however, such image processing tools do not preserve the original gray level scale’s linearity. In contrast, our <italic>Threshold Intensity Quantization</italic> (TrIQ) approach finds an intensity threshold <inline-formula id="ieqn-34"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i034.jpg"/><tex-math id="M41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-34"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> for saturating the images’ last gray level. Importantly, the linearity of the experimentally determined intensity scale is preserved.</p>
    <p>In the next sections, we demonstrate the application of the TrIQ for the processing of mass spectrometry imaging (MSI) datasets. The term <italic>raw image</italic> is used in this paper for denoting images rendered with the default quantization method of R.</p>
    <sec>
      <title>Contrast optimization</title>
      <p><xref ref-type="fig" rid="fig-2">Figure 2</xref> shows the mass spectrometry image of a human colorectal adenocarcinoma sample, acquired with DESI and 100 <inline-formula id="ieqn-35"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i035.jpg"/><tex-math id="M42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-35"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m spatial resolution (<xref rid="ref-20" ref-type="bibr">Oetjen et al., 2015</xref>). The imaged signal of 885.55 <italic>m/z</italic> corresponds to de-protonated phosphatidylinositol (18:0/20:4), [C<inline-formula id="ieqn-36"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i036.jpg"/><tex-math id="M43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{47}\end{document}</tex-math><mml:math id="mml-ieqn-36"><mml:msub><mml:mi/><mml:mrow><mml:mn>47</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-37"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i037.jpg"/><tex-math id="M44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{83}\end{document}</tex-math><mml:math id="mml-ieqn-37"><mml:msub><mml:mi/><mml:mrow><mml:mn>83</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-38"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i038.jpg"/><tex-math id="M45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{13}\end{document}</tex-math><mml:math id="mml-ieqn-38"><mml:msub><mml:mi/><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>P-H]<inline-formula id="ieqn-39"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i039.jpg"/><tex-math id="M46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-39"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula> (<xref rid="ref-35" ref-type="bibr">Tillner et al., 2017</xref>).</p>
      <fig id="fig-2" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-2</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Contrast enhancement by Threshold Intensity Quantization (TrIQ).</title>
          <p>The mass trace 885.55 <italic>m/z</italic> of DESI MSI data of a human colorectal adenocarcinoma sample was visualized with different quantization methods. (A) Raw data, rendered with 256 gray levels. (B) Plotting with applying the natural logarithm to the intensity values. (C) Image contrast improvement after zero-memory quantization and linear histogram equalization (D) Image contrast improvement using TrIQ with 95 percent and 32 gray levels. Histograms A, B and D were computed with 32 bins; histogram C has 256 bins. (E) Histological staining of a tissue slice (dataset and image E) from <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>.</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g002"/>
      </fig>
      <p>The direct plotting of the extracted <italic>m/z</italic> slice results in the image shown in <xref ref-type="fig" rid="fig-2">Fig. 2A</xref>. The image contains pixels with intensity values of up to 70,280 arbitrary units. Such extreme and infrequent intensity values are called <italic>outliers</italic> and drastically reduce image contrast. The histogram below reveals the reason for the low contrast of the image: Most of the pixels fall into the first four bins after the default R quantization.</p>
      <p>A typical data transformation for imaging is the use of a logarithmic intensity scale. <xref ref-type="fig" rid="fig-2">Figure 2B</xref> shows the image after applying the natural logarithm to the MSI signal intensities and default quantization. The contrast is improved. However, further operations would be necessary, such as the subtraction of the background level. Besides, the interpretation of the non-linear color scale is not intuitive.</p>
      <p>The conventional sequence for improving the contrast of an MSI image is applying the zero-memory quantization of MSI data and a transformation function on the quantized pixels. <xref ref-type="fig" rid="fig-2">Figure 2C</xref> shows the result of this process. Although improved contrast is gained with linear equalization, the corresponding histogram shows that many gray levels were lost in the transformation process. Only eighteen remaining gray levels contain data. This information loss is irreversible and may have adverse effects on the performance of standard segmentation algorithms. To make TrIQ and equalized images comparable, we selected an intensity threshold for saturating the equalized image near to the <inline-formula id="ieqn-40"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i040.jpg"/><tex-math id="M47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-40"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> threshold provided by the TrIQ algorithm. The shown linear equalization histogram has 256 bins.</p>
      <p>Applying the TrIQ algorithm with <inline-formula id="ieqn-41"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i041.jpg"/><tex-math id="M48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}P = 0.95\end{document}</tex-math><mml:math id="mml-ieqn-41"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:math></alternatives></inline-formula> resulted in <xref ref-type="fig" rid="fig-2">Fig. 2D</xref>. Pixels with intensities above <inline-formula id="ieqn-42"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i042.jpg"/><tex-math id="M49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T = 4,244\end{document}</tex-math><mml:math id="mml-ieqn-42"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>244</mml:mn></mml:math></alternatives></inline-formula> were binned within the highest gray level. The corresponding histogram shows an almost flat frequency over a wide intensity range. Compared to the unprocessed image, the contrast of the image was drastically improved, and the linear intensity scale of the color representation was preserved. <xref ref-type="fig" rid="fig-2">Figure 2E</xref> shows the histological staining of the tissue section analyzed. The mass image processed with the TrIQ algorithm reassembles best the anatomical details which are recognizable in the optical image.</p>
    </sec>
    <sec>
      <title>Background optimization</title>
      <p>Various causes can result in background noise, such as sample metabolites with low vapor pressure and matrix compounds. <xref ref-type="fig" rid="fig-3">Figure 3A</xref> shows the rendering of signals from an <italic>Arabidopsis thaliana</italic> leaf, analyzed by LAESI MSI with a lateral resolution of 200 <inline-formula id="ieqn-43"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i043.jpg"/><tex-math id="M50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-43"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m (<xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš, 2020</xref>). The images correspond to the putative negative ions of 4-hydroxymethyl-3-methoxyphenoxyacetic acid ([C<inline-formula id="ieqn-44"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i044.jpg"/><tex-math id="M51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{10}\end{document}</tex-math><mml:math id="mml-ieqn-44"><mml:msub><mml:mi/><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-45"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i045.jpg"/><tex-math id="M52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{12}\end{document}</tex-math><mml:math id="mml-ieqn-45"><mml:msub><mml:mi/><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-46"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i046.jpg"/><tex-math id="M53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_5\end{document}</tex-math><mml:math id="mml-ieqn-46"><mml:msub><mml:mi/><mml:mn>5</mml:mn></mml:msub></mml:math></alternatives></inline-formula>-3H]<inline-formula id="ieqn-47"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i047.jpg"/><tex-math id="M54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-47"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, 209.0 <italic>m/z</italic>), 4-methylsulfonylbutyl glucosinolate ([C<inline-formula id="ieqn-48"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i048.jpg"/><tex-math id="M55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{12}\end{document}</tex-math><mml:math id="mml-ieqn-48"><mml:msub><mml:mi/><mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-49"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i049.jpg"/><tex-math id="M56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{23}\end{document}</tex-math><mml:math id="mml-ieqn-49"><mml:msub><mml:mi/><mml:mrow><mml:mn>23</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>NO<inline-formula id="ieqn-50"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i050.jpg"/><tex-math id="M57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{10}\end{document}</tex-math><mml:math id="mml-ieqn-50"><mml:msub><mml:mi/><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>S<inline-formula id="ieqn-51"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i051.jpg"/><tex-math id="M58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_3\end{document}</tex-math><mml:math id="mml-ieqn-51"><mml:msub><mml:mi/><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>-H]<inline-formula id="ieqn-52"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i052.jpg"/><tex-math id="M59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-52"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, 436.0 <italic>m/z</italic>), and indol-3-ylmethyl glucosinolate ([C<inline-formula id="ieqn-53"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i053.jpg"/><tex-math id="M60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{16}\end{document}</tex-math><mml:math id="mml-ieqn-53"><mml:msub><mml:mi/><mml:mrow><mml:mn>16</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-54"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i054.jpg"/><tex-math id="M61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{20}\end{document}</tex-math><mml:math id="mml-ieqn-54"><mml:msub><mml:mi/><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>N<inline-formula id="ieqn-55"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i055.jpg"/><tex-math id="M62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_2\end{document}</tex-math><mml:math id="mml-ieqn-55"><mml:msub><mml:mi/><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-56"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i056.jpg"/><tex-math id="M63">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_9\end{document}</tex-math><mml:math id="mml-ieqn-56"><mml:msub><mml:mi/><mml:mn>9</mml:mn></mml:msub></mml:math></alternatives></inline-formula>S<inline-formula id="ieqn-57"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i057.jpg"/><tex-math id="M64">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_2\end{document}</tex-math><mml:math id="mml-ieqn-57"><mml:msub><mml:mi/><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>-H]<inline-formula id="ieqn-58"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i058.jpg"/><tex-math id="M65">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ -\end{document}</tex-math><mml:math id="mml-ieqn-58"><mml:msup><mml:mi/><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula>, 447.1 <italic>m/z</italic>) (<xref rid="ref-38" ref-type="bibr">Wu et al., 2018</xref>).</p>
      <fig id="fig-3" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-3</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Background optimization with TrIQ.</title>
          <p>Three mass traces of LAESI MSI data from a <italic>A. thaliana</italic> leaf are plotted. (A) Raw data plotting with 256 gray levels. (B) TrIQ with 32 gray levels. (C) TrIQ with 9 gray levels. The background uniformity is improved by reducing the intensity and gray levels. (D) TrIQ with 32 gray levels and black level adjustment eliminates background noise without reducing color depth (dataset from <xref rid="ref-42" ref-type="bibr">Zheng, Bartels &amp; Svatoš (2020)</xref>). (E) Photograph of the sample.</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g003"/>
      </fig>
      <p>Removing outliers with TrIQ and reducing gray levels lead to improved image brightness (see <xref ref-type="fig" rid="fig-3">Figs. 3A</xref> and <xref ref-type="fig" rid="fig-3">3B</xref>). Nevertheless, background noise is also enhanced, and the sample shape is not well defined (see ion 209 <italic>m/z</italic> in <xref ref-type="fig" rid="fig-3">Fig. 3B</xref>). There are two possibilities for background correction with TrIQ. The first option is reducing the number of gray levels, thus grouping a wider range of values within a single bin. Reducing the gray levels from 32 to 9 produced an almost perfectly uniform background and a well-defined sample shape, as shown in <xref ref-type="fig" rid="fig-3">Fig. 3C</xref>. The second method finds a new <italic>black level threshold</italic> that substitutes the operator <inline-formula id="ieqn-59"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i059.jpg"/><tex-math id="M66">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}min(f)\end{document}</tex-math><mml:math id="mml-ieqn-59"><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="eqn-5">Eq. (5)</xref>. As the color bars for this approach indicate, the black level thresholds depend on the individual image data (see <xref ref-type="fig" rid="fig-3">Fig. 3D</xref>). Both methods efficiently diminish the impact of background noise. But whereas reducing the gray levels is the simpler approach, defining a new black level threshold maintains the color depth.</p>
    </sec>
    <sec>
      <title>Normalization for comparable mass spectrometry images</title>
      <p>Comparing mass spectrometry images (MSI) is a challenge because standard quantization procedures create images with distinct intensity and color scales, even if they were measured under the same experimental conditions.</p>
      <p>Global TrIQ finds the highest <inline-formula id="ieqn-60"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i060.jpg"/><tex-math id="M67">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-60"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> among a given MSI set. This threshold is used for computing the transition levels and mapping MSI intensities to discrete values on every image within the set.</p>
      <p><xref ref-type="fig" rid="fig-4">Figure 4</xref> shows human colorectal adenocarcinoma images. The samples come from the same tissue, cut into slices with a thickness of 10 <inline-formula id="ieqn-61"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i061.jpg"/><tex-math id="M68">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\mu\end{document}</tex-math><mml:math id="mml-ieqn-61"><mml:mi>μ</mml:mi></mml:math></alternatives></inline-formula>m (<xref rid="ref-20" ref-type="bibr">Oetjen et al., 2015</xref>). All images visualize the abundance of the ion 885.55 <italic>m/z</italic>. The plotting of the raw data resulted in images of low contrast, which are difficult to interpret and to compare (see <xref ref-type="fig" rid="fig-4">Fig. 4A</xref>). Using the Global TrIQ algorithm, a maximum threshold <inline-formula id="ieqn-62"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i062.jpg"/><tex-math id="M69">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}T\end{document}</tex-math><mml:math id="mml-ieqn-62"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula> of 4,970 was calculated and applied for all twelve images; the accumulated probability was set to 0.91. The resulting color scale is the same for all images (see <xref ref-type="fig" rid="fig-4">Fig. 4B</xref>). Thus, the relative abundance and distribution of the ion in multiple images can be evaluated at a single glance.</p>
      <fig id="fig-4" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-4</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Global TrIQ applied to the ion 885.55 <italic>m/z</italic> of human colorectal adenocarcinoma DESI MSI slices, with <italic>P</italic> = 0.91 and 32 gray levels.</title>
          <p>Compared to the raw data visualization (A), the contrast is drastically enhanced by applying the TrIQ algorithm (B). The normalization also allows a direct comparison of the images (dataset from <xref rid="ref-20" ref-type="bibr">Oetjen et al. (2015)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g004"/>
      </fig>
      <p><xref ref-type="fig" rid="fig-5">Figure 5</xref> provides another example of global TrIQ. The image compares the 62.1, 84.1, and 306.1 <italic>m/z</italic> ions of chili (<italic>Capsicum annuum)</italic> slices sampled at 1 mm lateral resolution with low-temperature plasma (LTP) MSI (<xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al., 2014</xref>). LTP MSI detects small, volatile compounds. Therefore, the images resulting from this ambient ionization technique are noisy. TrIQ with <inline-formula id="ieqn-63"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i063.jpg"/><tex-math id="M70">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}P = 0.98\end{document}</tex-math><mml:math id="mml-ieqn-63"><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>0.98</mml:mn></mml:math></alternatives></inline-formula> and five gray levels improves the contrast. The remaining noise is efficiently removed with a <inline-formula id="ieqn-64"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i064.jpg"/><tex-math id="M71">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}3 \times 3\end{document}</tex-math><mml:math id="mml-ieqn-64"><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:math></alternatives></inline-formula> median filter (see <xref ref-type="fig" rid="fig-5">Fig. 5</xref>). The signals with a mass-to-charge ratio of 62.1 and 84.1 display a defined localization at the seeds and at the center of the placenta. The signal with 306.1 <italic>m/z</italic> is enriched in placenta tissue and corresponds to the [C<inline-formula id="ieqn-65"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i065.jpg"/><tex-math id="M72">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{18}\end{document}</tex-math><mml:math id="mml-ieqn-65"><mml:msub><mml:mi/><mml:mrow><mml:mn>18</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-66"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i066.jpg"/><tex-math id="M73">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{27}\end{document}</tex-math><mml:math id="mml-ieqn-66"><mml:msub><mml:mi/><mml:mrow><mml:mn>27</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>NO<inline-formula id="ieqn-67"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i067.jpg"/><tex-math id="M74">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_3\end{document}</tex-math><mml:math id="mml-ieqn-67"><mml:msub><mml:mi/><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>+H]<inline-formula id="ieqn-68"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i068.jpg"/><tex-math id="M75">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ +\end{document}</tex-math><mml:math id="mml-ieqn-68"><mml:msup><mml:mi/><mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> ion of capsaicin, the compound responsible for the hot taste of chili peppers (<xref rid="ref-2" ref-type="bibr">Aza-González, Núñez-Palenius &amp; Ochoa-Alejo, 2011</xref>; <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al., 2014</xref>; <xref rid="ref-8" ref-type="bibr">Gamboa-Becerra et al., 2015</xref>; <xref rid="ref-5" ref-type="bibr">Cervantes-Hernández et al., 2019</xref>).</p>
      <fig id="fig-5" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-5</object-id>
        <label>Figure 5</label>
        <caption>
          <title>LTP MSI of a chili <italic>C. annuum</italic> fruit with 1 mm lateral resolution.</title>
          <p>TrIQ with <italic>P</italic> = 0.98 and 5 gray levels improves the contrast; an additional median filter removes technical noise (dataset from <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al. (2014</xref>, <xref rid="ref-18" ref-type="bibr">2017)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g005"/>
      </fig>
      <p>Both examples demonstrate the usefulness of TrIQ to normalize MSI data for image comparison.</p>
    </sec>
    <sec>
      <title>Segmentation and visualization of regions of interest (ROI)</title>
      <p>Finding regions of interest (ROI) in MSI datasets is essential for biomarker discovery and physiological studies. High-contrast and low-noise images favor the automated segmentation. <xref ref-type="fig" rid="fig-6">Figure 6</xref> compares binary masks obtained using the standard Otsu algorithm and TrIQ. The input image was zero-memory quantized with 256 bins before applying the Otsu algorithm. The TrIQ binary masks were obtained by setting TRUE all non-zero values of the median filtered images of <xref ref-type="fig" rid="fig-5">Fig. 5</xref>.</p>
      <fig id="fig-6" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-6</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Image segmentation for <italic>C. annuum</italic> obtained with Otsu and TrIQ.</title>
          <p>For images with intensity outliers and noisy regions, TrIQ combined with median filtering gives larger and more uniform regions compared to the standard Otsu algorithm (dataset from <xref rid="ref-17" ref-type="bibr">Maldonado-Torres et al. (2014</xref>, <xref rid="ref-18" ref-type="bibr">2017)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g006"/>
      </fig>
      <p>TrIQ-median filtered images show more extensive and homogenous regions compared to the Otsu masks and fit well with the anatomical fruit sections of the optical image (see <xref ref-type="fig" rid="fig-6">Fig. 6</xref>).</p>
      <p><xref ref-type="fig" rid="fig-7">Figure 7</xref> shows the Global TrIQ segmentation of mouse urinary bladder data, scanned with AP-MALDI MSI at a lateral resolution of 10 <italic>μ</italic>m (<xref rid="ref-27" ref-type="bibr">Römpp et al., 2010</xref>; <xref rid="ref-28" ref-type="bibr">Römpp et al., 2014</xref>). The distribution of 741.53 <italic>m/z</italic>, identified as a sphingomyelin [C<inline-formula id="ieqn-69"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i069.jpg"/><tex-math id="M76">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{39}\end{document}</tex-math><mml:math id="mml-ieqn-69"><mml:msub><mml:mi/><mml:mrow><mml:mn>39</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>H<inline-formula id="ieqn-70"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i070.jpg"/><tex-math id="M77">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_{79}\end{document}</tex-math><mml:math id="mml-ieqn-70"><mml:msub><mml:mi/><mml:mrow><mml:mn>79</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>N<inline-formula id="ieqn-71"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i071.jpg"/><tex-math id="M78">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_2\end{document}</tex-math><mml:math id="mml-ieqn-71"><mml:msub><mml:mi/><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>O<inline-formula id="ieqn-72"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i072.jpg"/><tex-math id="M79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}_6\end{document}</tex-math><mml:math id="mml-ieqn-72"><mml:msub><mml:mi/><mml:mn>6</mml:mn></mml:msub></mml:math></alternatives></inline-formula>P + K]<inline-formula id="ieqn-73"><alternatives><inline-graphic xlink:href="peerj-cs-07-585-i073.jpg"/><tex-math id="M80">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}^ +\end{document}</tex-math><mml:math id="mml-ieqn-73"><mml:msup><mml:mi/><mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula> ion, is related to muscle tissue. 743.54 <italic>m/z</italic> is associated with the <italic>lamina propria</italic> structure, while 798.54 <italic>m/z</italic> is mainly found in the <italic>urothelium</italic> (<xref rid="ref-27" ref-type="bibr">Römpp et al., 2010</xref>). Global TrIQ was applied with <italic>P</italic> = 0.95 and 25 gray levels. TrIQ and median filtering allow clear discrimination between muscle tissue and <italic>lamina propria</italic> using the marker ions 741.53 and 743.54 <italic>m/z</italic>. For separating the <italic>urothelium</italic> structure from the muscular tissue, the binary image for 798.54 <italic>m/z</italic> was calculated by zeroing gray levels below nine. In contrast, if the Otsu method is applied to the 798.54 <italic>m/z</italic> ion, the <italic>urothelium</italic> region is isolated automatically. This result is expected since the Otsu method assumes an image histogram distribution with a deep sharp valley between two peaks. <xref ref-type="fig" rid="fig-8">Figure 8</xref> shows an overlay of the TrIQ processed ion images, representing correctly the anatomical structures of the mouse urinary bladder.</p>
      <fig id="fig-7" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-7</object-id>
        <label>Figure 7</label>
        <caption>
          <title>AP-MALDI MSI of a mouse urinary bladder imaged with a lateral resolution of 10 <italic>μ</italic>m.</title>
          <p>TrIQ was applied with <italic>P</italic> = 0.95 and 25 gray levels. Binary images serve for defining regions of interest (ROI) and segmentation: 741.53 <italic>m/z</italic>-muscle tissue, 743.54 <italic>m/z</italic>-lamina propria structure, 798.54 <italic>m/z</italic>-urothelium (dataset from <xref rid="ref-27" ref-type="bibr">Römpp et al. (2010</xref>, <xref rid="ref-28" ref-type="bibr">2014)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g007"/>
      </fig>
      <fig id="fig-8" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-8</object-id>
        <label>Figure 8</label>
        <caption>
          <title>Overlay image, representing the anatomical structures in mouse urinary bladder.</title>
          <p>Blue: 741.53 <italic>m/z</italic>-muscle tissue, red: 743.54 <italic>m/z</italic>-lamina propria, yellow: 798.54 <italic>m/z</italic>-urothelium (dataset from <xref rid="ref-27" ref-type="bibr">Römpp et al. (2010</xref>, <xref rid="ref-28" ref-type="bibr">2014)</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g008"/>
      </fig>
    </sec>
    <sec>
      <title>Computational performance of the algorithm</title>
      <p>For estimating the computational performance of the TrIQ algorithm, we reprocessed selected ion traces presented in this paper (DESI 885.55 <italic>m/z</italic>, LAESI 209 <italic>m/z</italic>, LTP 62.1 <italic>m/z</italic>, and AP-MALDI 741.53 <italic>m/z</italic>) and measured the time for applying the TrIQ. To test the suitability of the TrIQ algorithm for large images, we built synthetic slices by sequentially doubling the DESI data. Time calculation was executed 25 times to account for variations in system processes of the operating system. <xref ref-type="fig" rid="fig-9">Figure 9</xref> demonstrates the results from running the R script Timing. R (provided as supplemental code) on a standard Linux laptop (Intel(R) Core(TM) i7-7700HQ CPU with 2.80 GHz, 16 Gb RAM, Peppermint OS 10). On average, more than 1,000 pixels were processed per millisecond. In the tested range, i.e., up to &gt;500,000 pixels, the execution speed was proportional to the image’s size. Thus, the TrIQ algorithm is computationally efficient and scalable.</p>
      <fig id="fig-9" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.7717/peerj-cs.585/fig-9</object-id>
        <label>Figure 9</label>
        <caption>
          <title>Execution speed of the TrIQ algorithm, implemented in R, using a standard laptop (experimental and synthetic data).</title>
          <p>About 1,000 pixels were processed per millisecond. The TrIQ algorithm scales linearly.</p>
        </caption>
        <graphic xlink:href="peerj-cs-07-585-g009"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>Threshold Intensity Optimization (TrIQ) improves the visualization of mass spectrometry imaging (MSI) data by augmenting the contrast and homogenizing the background. Contrary to histogram equalization algorithms, TrIQ preserves the linearity of measured ion intensities.</p>
    <p>The processing with TrIQ facilitates the recognition of regions of interest (ROI) in MSI data sets, either by visual inspection of by automated segmentation algorithms, supporting the interpretation of MSI data in biology and medicine.</p>
    <p>As with any data filtering method, TrIQ could remove or alter valuable information. Therefore, it is recommendable to compare raw and processed images and carefully adjust the target probability and the number of gray levels. MSI technology itself causes further sources of errors. Fixation agents, solvents, and matrix compounds can lead to background signals. To some extent, such off-sample ions can be removed manually, or using MSI software (<xref rid="ref-22" ref-type="bibr">Ovchinnikova et al., 2020</xref>). Technical variations caused by the sample topology or unstable ionization add additional inaccuracies (<xref rid="ref-3" ref-type="bibr">Bartels et al., 2017</xref>). Further, the ion count is not strictly proportional to the abundance of a molecule but depends on the local sample structure and composition, and the desorption/ionization principle. Thus, complementary MSI, optical and histological methods should be used on the same sample (<xref rid="ref-34" ref-type="bibr">Swales et al., 2019</xref>).</p>
    <p>Applying TrIQ to a set of images equalizes their intensity scales and makes them comparable. We demonstrated the implementation of the TrIQ algorithms in R to process MSI data in the community format imzML. The algorithm is computationally fast and only requires basic operations, and thus can be quickly adapted to any programming language. TrIQ can be applied to improve any scientific data plotting with extreme values, respecting the original intensity levels of raw data.</p>
  </sec>
  <sec>
    <title>Code availability</title>
    <p>RmsiGUI is freely available from <uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>. We released TrIQ R scripts and the R package RmsiGUI under the terms of the GNU General Public License, GPL V3 (<uri xlink:href="http://gplv3.fsf.org/">http://gplv3.fsf.org/</uri>).</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Dr. Abigail Moreno Pedraza, Dr. Teresa Maria Teresa Carrillo Rayas, Maria Isabel Cristina Elizarraraz Anaya, and Thermo Mexico for technical support and the research groups that made their code and MSI datasets public.</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn fn-type="COI-statement" id="conflict-1">
        <p>Robert Winkler is an Academic Editor for PeerJ, co-inventor of the patent application “Non-thermal plasma jet device as source of spatial ionisation for ambient mass spectrometry and method of application” (WO 2014/057409) and a shareholder of the company Kuturabi SA. de CV.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn fn-type="con" id="contribution-1">
        <p><xref ref-type="contrib" rid="author-1">Ignacio Rosas-Román</xref> conceived and designed the experiments, performed the experiments, analyzed the data, performed the computation work, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
      <fn fn-type="con" id="contribution-2">
        <p><xref ref-type="contrib" rid="author-2">Robert Winkler</xref> conceived and designed the experiments, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Patent Disclosures</title>
      <fn id="addinfo-1">
        <p>The following patent dependencies were disclosed by the authors:</p>
        <p>Robert Winkler is a co-inventor of the patent application “Non-thermal plasma jet device as source of spatial ionisation for ambient mass spectrometry and method of application” (WO 2014/057409).</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-2">
        <p>The following information was supplied regarding data availability:</p>
        <p>The software RmsiGUI is freely available from <uri xlink:href="https://bitbucket.org/lababi/rmsigui/">https://bitbucket.org/lababi/rmsigui/</uri>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Abdullah-Al-Wadud et al. (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Abdullah-Al-Wadud</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kabir</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Akber Dewan</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Chae</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A dynamic histogram equalization for image contrast enhancement</article-title>
        <source>IEEE Transactions on Consumer Electronics</source>
        <year>2007</year>
        <volume>53</volume>
        <issue>2</issue>
        <fpage>593</fpage>
        <lpage>600</lpage>
        <pub-id pub-id-type="doi">10.1109/TCE.2007.381734</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Aza-González, Núñez-Palenius &amp; Ochoa-Alejo (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aza-González</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Núñez-Palenius</surname>
            <given-names>HG</given-names>
          </name>
          <name>
            <surname>Ochoa-Alejo</surname>
            <given-names>Ní</given-names>
          </name>
        </person-group>
        <article-title>Molecular biology of capsaicinoid biosynthesis in chili pepper (Capsicum spp.)</article-title>
        <source>Plant cell reports</source>
        <year>2011</year>
        <volume>30</volume>
        <issue>5</issue>
        <fpage>695</fpage>
        <lpage>706</lpage>
        <pub-id pub-id-type="doi">10.1007/s00299-010-0968-8</pub-id>
        <pub-id pub-id-type="pmid">21161234</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Bartels et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bartels</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kulkarni</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Danz</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Böcker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Saluz</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Svatoš</surname>
            <given-names>Aš</given-names>
          </name>
        </person-group>
        <article-title>Mapping metabolites from rough terrain: laser ablation electrospray ionization on non-flat samples</article-title>
        <source>RSC Advances</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>15</issue>
        <fpage>9045</fpage>
        <lpage>9050</lpage>
        <pub-id pub-id-type="doi">10.1039/C6RA26854D</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-40">
      <label>Bemis et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bemis</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Harry</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eberlin</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Ferreira</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>van de Ven</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Mallick</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stolowitz</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vitek</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Cardinal: an R package for statistical analysis of mass spectrometry based imaging experiments</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>14</issue>
        <fpage>2418</fpage>
        <lpage>2420</lpage>
        <pub-id pub-id-type="pmid">25777525</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Borland &amp; Taylor li (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Borland</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Taylor li</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <article-title>Rainbow color map (still) considered harmful</article-title>
        <source>IEEE Computer Graphics and Applications</source>
        <year>2007</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>14</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1109/MCG.2007.323435</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Cervantes-Hernández et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cervantes-Hernández</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Alcalá-González</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Martínez</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ordaz-Ortiz</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Placenta, pericarp, and seeds of tabasco chili pepper fruits show a contrasting diversity of bioactive metabolites</article-title>
        <source>Metabolites</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>206</fpage>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Doi (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doi</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Diagnostic imaging over the last 50 years: research and development in medical imaging science and technology</article-title>
        <source>Physics in Medicine and Biology</source>
        <year>2006</year>
        <volume>51</volume>
        <issue>13</issue>
        <fpage>R5</fpage>
        <lpage>R27</lpage>
        <pub-id pub-id-type="pmid">16790920</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>Föll et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Föll</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Moritz</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wollmann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Stillger</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Vockert</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Werner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bronsert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rohr</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Grüning</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Schilling</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Accessible and reproducible mass spectrometry imaging data analysis in Galaxy</article-title>
        <source>GigaScience</source>
        <year>2019</year>
        <volume>8</volume>
        <issue>12</issue>
        <fpage>143</fpage>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Gamboa-Becerra et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gamboa-Becerra</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ramírez-Chávez</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Molina-Torres</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>MSI.R scripts reveal volatile and semi-volatile features in low-temperature plasma mass spectrometry imaging (LTP-MSI) of chilli (Capsicum annuum)</article-title>
        <source>Analytical and Bioanalytical Chemistry</source>
        <year>2015</year>
        <volume>407</volume>
        <issue>19</issue>
        <fpage>5673</fpage>
        <lpage>5684</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-015-8744-9</pub-id>
        <pub-id pub-id-type="pmid">26007697</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Garnier et al. (2018)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Garnier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rudis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sciaini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Scherer</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Viridis: default Color Maps from ‘matplotlib’</article-title>
        <year>2018</year>
        <uri xlink:href="https://CRAN.R-project.org/package=viridis">https://CRAN.R-project.org/package=viridis</uri>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Gibb &amp; Franceschi (2019)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Gibb</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Franceschi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>MALDIquantForeign: import/export routines for ‘MALDIquant’</article-title>
        <year>2019</year>
        <uri xlink:href="https://CRAN.R-project.org/package=MALDIquantForeign">https://CRAN.R-project.org/package=MALDIquantForeign</uri>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Gibb &amp; Strimmer (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gibb</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>MALDIquant: a versatile R package for the analysis of mass spectrometry data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>17</issue>
        <fpage>2270</fpage>
        <lpage>2271</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts447</pub-id>
        <pub-id pub-id-type="pmid">22796955</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Gomès, Assy &amp; Chapuis (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gomès</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Assy</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Chapuis</surname>
            <given-names>P-O</given-names>
          </name>
        </person-group>
        <article-title>Scanning thermal microscopy: a review</article-title>
        <source>Physica Status Solidi (A)</source>
        <year>2015</year>
        <volume>212</volume>
        <issue>3</issue>
        <fpage>477</fpage>
        <lpage>494</lpage>
        <pub-id pub-id-type="doi">10.1002/pssa.201400360</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Gormanns et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gormanns</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Reckow</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Poczatek</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Turck</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Lechene</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Segmentation of multi-isotope imaging mass spectrometry data for semi-automatic detection of regions of interest</article-title>
        <source>PLOS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>2</issue>
        <elocation-id>e30576</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0030576</pub-id>
        <pub-id pub-id-type="pmid">22347386</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Kimpe &amp; Tuytschaever (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimpe</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Tuytschaever</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Increasing the number of gray shades in medical display systems 2014 how much is enough?</article-title>
        <source>Journal of Digital Imaging</source>
        <year>2007</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>422</fpage>
        <lpage>432</lpage>
        <pub-id pub-id-type="doi">10.1007/s10278-006-1052-3</pub-id>
        <pub-id pub-id-type="pmid">17195900</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>López-Fernández et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>López-Fernández</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Santos</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Capelo</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Fdez-Riverola</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Glez-Peña</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reboiro-Jato</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Mass-up: an all-in-one open software application for MALDI-TOF mass spectrometry knowledge discovery</article-title>
        <source>BMC Bioinformatics</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>318</fpage>
        <pub-id pub-id-type="pmid">26437641</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Lu et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chingin</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Xiong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Ambient mass spectrometry for food science and industry</article-title>
        <source>TrAC Trends in Analytical Chemistry</source>
        <year>2018</year>
        <volume>107</volume>
        <fpage>99</fpage>
        <lpage>115</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trac.2018.07.017</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Maldonado-Torres et al. (2014)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maldonado-Torres</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>López-Hernández</surname>
            <given-names>Jé F</given-names>
          </name>
          <name>
            <surname>Jiménez-Sandoval</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Plug and play’ assembly of a low-temperature plasma ionization mass spectrometry imaging (LTP-MSI) system</article-title>
        <source>Journal of Proteomics</source>
        <year>2014</year>
        <volume>102C</volume>
        <fpage>60</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jprot.2014.03.003</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Maldonado-Torres et al. (2017)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Maldonado-Torres</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>López-Hernández</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Jiménez-Sandoval</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Low-temperature plasma mass spectrometry imaging (LTP-MSI) of Chili pepper. type: dataset</article-title>
        <year>2017</year>
        <uri xlink:href="https://zenodo.org/record/484496">https://zenodo.org/record/484496</uri>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Nuñez, Anderton &amp; Renslow (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nuñez</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Anderton</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Renslow</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <article-title>Optimizing colormaps with consideration for color vision deficiency to enable accurate interpretation of scientific data</article-title>
        <source>PLOS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <issue>7</issue>
        <elocation-id>e0199239</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0199239</pub-id>
        <pub-id pub-id-type="pmid">30067751</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Oetjen et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oetjen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Veselkov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Watrous</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McKenzie</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Becker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hauberg-Lotte</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kobarg</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Strittmatter</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>MrÃ3z</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Trede</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Palmer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schiffler</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Steinhorst</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Aichler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goldin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Guntinas-Lichius</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>von Eggeling</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Thiele</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Maedler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Walch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Maass</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Dorrestein</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Benchmark datasets for 3D MALDI-and DESI-imaging mass spectrometry</article-title>
        <source>GigaScience</source>
        <year>2015</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>2105</fpage>
        <pub-id pub-id-type="doi">10.1186/s13742-015-0059-4</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Otsu (1979)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Otsu</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>A threshold selection method from gray-level histograms</article-title>
        <source>IEEE Transactions on Systems, Man, and Cybernetics</source>
        <year>1979</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>62</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1109/TSMC.1979.4310076</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Ovchinnikova et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ovchinnikova</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kovalev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Stuart</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>OffsampleAI: artificial intelligence approach to recognize off-sample mass spectrometry images</article-title>
        <source>BMC Bioinformatics</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>129</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-020-3425-x</pub-id>
        <pub-id pub-id-type="pmid">32245392</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Pau et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pau</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fuchs</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sklyar</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>EBImage–an R package for image processing with applications to cellular phenotypes</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>7</issue>
        <fpage>979</fpage>
        <lpage>981</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq046</pub-id>
        <pub-id pub-id-type="pmid">20338898</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>R Core Team (2018)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>
            <institution>R Core Team</institution>
          </collab>
        </person-group>
        <source>R: A Language and Environment for Statistical Computing</source>
        <year>2018</year>
        <publisher-loc>Vienna, Austria</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Race &amp; Bunch (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Race</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Bunch</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Optimisation of colour schemes to accurately display mass spectrometry imaging data based on human colour perception</article-title>
        <source>Analytical and Bioanalytical Chemistry</source>
        <year>2015</year>
        <volume>407</volume>
        <issue>8</issue>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1007/s00216-014-8404-5</pub-id>
        <pub-id pub-id-type="pmid">25552319</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Rae Buchberger et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rae Buchberger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>DeLaney</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Mass spectrometry imaging: a review of emerging advancements and future insights</article-title>
        <source>Analytical Chemistry</source>
        <year>2018</year>
        <volume>90</volume>
        <issue>1</issue>
        <fpage>240</fpage>
        <lpage>265</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.7b04733</pub-id>
        <pub-id pub-id-type="pmid">29155564</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Römpp et al. (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guenther</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schober</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kummer</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Histology by mass spectrometry: label-free tissue characterization obtained from high-accuracy bioanalytical imaging</article-title>
        <source>Angewandte Chemie International Edition</source>
        <year>2010</year>
        <volume>49</volume>
        <issue>22</issue>
        <fpage>3834</fpage>
        <lpage>3838</lpage>
        <pub-id pub-id-type="doi">10.1002/anie.200905559</pub-id>
        <pub-id pub-id-type="pmid">20397170</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Römpp et al. (2014)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guenther</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schober</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Schulz</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kummer</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>ProteomeXchange dataset PXD001283</article-title>
        <year>2014</year>
        <uri xlink:href="http://proteomecentral.proteomexchange.org/cgi/GetDataset?ID=PXD001283">http://proteomecentral.proteomexchange.org/cgi/GetDataset?ID=PXD001283</uri>
      </element-citation>
    </ref>
    <ref id="ref-29">
      <label>Römpp et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schramm</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Klinkert</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Both</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Heeren</surname>
            <given-names>RMA</given-names>
          </name>
          <name>
            <surname>Stöckli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>imzML: imaging mass spectrometry markup language: a common data format for mass spectrometry imaging</article-title>
        <source>Methods in Molecular Biology</source>
        <year>2011</year>
        <volume>696</volume>
        <fpage>205</fpage>
        <lpage>224</lpage>
        <pub-id pub-id-type="pmid">21063949</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-30">
      <label>Rogowitz, Treinish &amp; Bryson (1996)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rogowitz</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Treinish</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Bryson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>How not to lie with visualization</article-title>
        <source>Computers in Physics</source>
        <year>1996</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>268</fpage>
        <pub-id pub-id-type="doi">10.1063/1.4822401</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-31">
      <label>Rosas-Román et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rosas-Román</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ovando-Vázquez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Moreno-Pedraza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guillén-Alonso</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Open LabBot and RmsiGUI: community development kit for sampling automation and ambient imaging</article-title>
        <source>Microchemical Journal</source>
        <year>2020</year>
        <volume>152</volume>
        <fpage>104343</fpage>
      </element-citation>
    </ref>
    <ref id="ref-32">
      <label>Schramm et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schramm</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hester</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Klinkert</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Both</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Heeren</surname>
            <given-names>RMA</given-names>
          </name>
          <name>
            <surname>Brunelle</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laprévote</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Desbenoit</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Robbe</surname>
            <given-names>M-F</given-names>
          </name>
          <name>
            <surname>Stoeckli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Spengler</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Römpp</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>imzML—a common data format for the flexible exchange and processing of mass spectrometry imaging data</article-title>
        <source>Journal of Proteomics</source>
        <year>2012</year>
        <volume>75</volume>
        <issue>16</issue>
        <fpage>5106</fpage>
        <lpage>5110</lpage>
        <pub-id pub-id-type="pmid">22842151</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-41">
      <label>Stauffer et al. (2015)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Stauffer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Mayr</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Dabernig</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zeileis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Somewhere over the rainbow: howtomake effective use of colors inmeteorological visualizations</article-title>
        <source>Bulletin of the American Meteorological Society</source>
        <year>2015</year>
        <volume>96</volume>
        <publisher-loc>Boston MA, USA Publisher</publisher-loc>
        <publisher-name>Place</publisher-name>
        <fpage>203</fpage>
        <lpage>216</lpage>
      </element-citation>
    </ref>
    <ref id="ref-33">
      <label>Stockham (1972)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stockham</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Image processing in the context of a visual model</article-title>
        <source>Proceedings of the IEEE</source>
        <year>1972</year>
        <volume>60</volume>
        <issue>7</issue>
        <fpage>828</fpage>
        <lpage>842</lpage>
        <pub-id pub-id-type="doi">10.1109/PROC.1972.8782</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-34">
      <label>Swales et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swales</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Hamm</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Clench</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Goodwin</surname>
            <given-names>RJA</given-names>
          </name>
        </person-group>
        <article-title>Mass spectrometry imaging and its application in pharmaceutical research and development: a concise review</article-title>
        <source>International Journal of Mass Spectrometry</source>
        <year>2019</year>
        <volume>437</volume>
        <fpage>99</fpage>
        <lpage>112</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ijms.2018.02.007</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-35">
      <label>Tillner et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tillner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Karancsi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dannhorn</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Veselkov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>McKenzie</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Takats</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Faster, more reproducible desi-ms for biological tissue imaging</article-title>
        <source>Journal of the American Society for Mass Spectrometry</source>
        <year>2017</year>
        <volume>28</volume>
        <issue>10</issue>
        <fpage>2090</fpage>
        <lpage>2098</lpage>
        <pub-id pub-id-type="doi">10.1007/s13361-017-1714-z</pub-id>
        <pub-id pub-id-type="pmid">28620847</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-36">
      <label>Weiskirchen et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiskirchen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Weiskirchen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Software solutions for evaluation and visualization of laser ablation inductively coupled plasma mass spectrometry imaging (LA-ICP-MSI) data: a short overview</article-title>
        <source>Journal of Cheminformatics</source>
        <year>2019</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>16</fpage>
        <pub-id pub-id-type="doi">10.1186/s13321-019-0338-7</pub-id>
        <pub-id pub-id-type="pmid">30778692</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-37">
      <label>Winkler (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Winkler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>An evolving computational platform for biological mass spectrometry: workflows, statistics and data mining with MASSyPup64</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <issue>e1401</issue>
        <fpage>1</fpage>
        <lpage>34</lpage>
      </element-citation>
    </ref>
    <ref id="ref-38">
      <label>Wu et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tohge</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cuadros-Inostroza</surname>
            <given-names>l</given-names>
          </name>
          <name>
            <surname>Tong</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tenenboim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kooke</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>MÃ©ret</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Keurentjes</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Nikoloski</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Fernie</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Willmitzer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Brotman</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Mapping the arabidopsis metabolic landscape by untargeted metabolomics at different environmental conditions</article-title>
        <source>Molecular Plant</source>
        <year>2018</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>118</fpage>
        <lpage>134</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molp.2017.08.012</pub-id>
        <pub-id pub-id-type="pmid">28866081</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-39">
      <label>Zeileis, Hornik &amp; Murrell (2009)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeileis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hornik</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Murrell</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Escaping RGBland: selecting colors for statistical graphics</article-title>
        <source>Computational Statistics &amp; Data Analysis</source>
        <year>2009</year>
        <volume>53</volume>
        <issue>9</issue>
        <fpage>3259</fpage>
        <lpage>3270</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csda.2008.11.033</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-42">
      <label>Zheng, Bartels &amp; Svatoš (2020)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bartels</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Svatoš</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Laser ablation electrospray ionization mass spectrometry imaging (LAESI MSI) of Arabidopsis thaliana leaf</article-title>
        <year>2020</year>
        <uri xlink:href="https://zenodo.org/record/3678473">https://zenodo.org/record/3678473</uri>
      </element-citation>
    </ref>
  </ref-list>
</back>
