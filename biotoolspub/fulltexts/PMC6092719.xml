<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6092719</article-id>
    <article-id pub-id-type="pmid">29855322</article-id>
    <article-id pub-id-type="publisher-id">2209</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-018-2209-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Core Hunter 3: flexible core subset selection</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3968-7386</contrib-id>
        <name>
          <surname>De Beukelaer</surname>
          <given-names>Herman</given-names>
        </name>
        <address>
          <email>herman.debeukelaer@ugent.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Davenport</surname>
          <given-names>Guy F</given-names>
        </name>
        <address>
          <email>guy.davenport@plantandfood.co.nz</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fack</surname>
          <given-names>Veerle</given-names>
        </name>
        <address>
          <email>veerle.fack@ugent.be</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2069 7798</institution-id><institution-id institution-id-type="GRID">grid.5342.0</institution-id><institution>Department of Applied Mathematics, Computer Science and Statistics, Ghent University, </institution></institution-wrap>Krijgslaan 281 S9, Gent, 9000 Belgium </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.27859.31</institution-id><institution>New Zealand Institute for Plant &amp; Food Research Limited, </institution></institution-wrap>412 No1 Rd RD2, Te Puke, New Zealand </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>19</volume>
    <elocation-id>203</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>10</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>5</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>Core collections provide genebank curators and plant breeders a way to reduce size of their collections and populations, while minimizing impact on genetic diversity and allele frequency. Many methods have been proposed to generate core collections, often using distance metrics to quantify the similarity of two accessions, based on genetic marker data or phenotypic traits. Core Hunter is a multi-purpose core subset selection tool that uses local search algorithms to generate subsets relying on one or more metrics, including several distance metrics and allelic richness.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>In version 3 of Core Hunter (CH3) we have incorporated two new, improved methods for summarizing distances to quantify diversity or representativeness of the core collection. A comparison of CH3 and Core Hunter 2 (CH2) showed that these new metrics can be effectively optimized with less complex algorithms, as compared to those used in CH2. CH3 is more effective at maximizing the improved diversity metric than CH2, still ensures a high average and minimum distance, and is faster for large datasets. Using CH3, a simple stochastic hill-climber is able to find highly diverse core collections, and the more advanced parallel tempering algorithm further increases the quality of the core and further reduces variability across independent samples. We also evaluate the ability of CH3 to simultaneously maximize diversity, and either representativeness or allelic richness, and compare the results with those of the GDOpt and SimEli methods. CH3 can sample equally representative cores as GDOpt, which was specifically designed for this purpose, and is able to construct cores that are simultaneously more diverse, and either are more representative or have higher allelic richness, than those obtained by SimEli.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>In version 3, Core Hunter has been updated to include two new core subset selection metrics that construct cores for representativeness or diversity, with improved performance. It combines and outperforms the strengths of other methods, as it (simultaneously) optimizes a variety of metrics. In addition, CH3 is an improvement over CH2, with the option to use genetic marker data or phenotypic traits, or both, and improved speed. Core Hunter 3 is freely available on <ext-link ext-link-type="uri" xlink:href="http://www.corehunter.org">http://www.corehunter.org</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Core collections</kwd>
      <kwd>Multi-objective</kwd>
      <kwd>Local search heuristics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100003130</institution-id>
            <institution>Fonds Wetenschappelijk Onderzoek</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Genebanks were established by national or international breeding, or conservation programs with the goal to safeguard genetic diversity for future use. Many breeding programs have established genebanks as a resource for new variation in the crops they breed, allowing them to react to changing environments and emerging biotic and abiotic stresses. Accessions are often divided between active (or working) and base collections. Examples of active collections include seed stores or live plants that can be accessed quickly by plant breeders and researchers through germination or clonal propagation. In contrast, accessions in base collections are held in long-term storage, such as cryopreservation, and require some time for regeneration and propagation before being made available.</p>
    <p>During the last few decades the collections stored in genebanks have grown enormously, and cost of maintaining viable germplasm within genebanks has increased. Genebank curators must make decisions about which accessions to maintain in the active collection versus the base collection, and may even consider not maintaining an accession at all. The concept of a core collection was introduced to help with these decisions, and is defined as subset of the complete collection which most represents the diversity of the entire collection with minimum redundancy [<xref ref-type="bibr" rid="CR1">1</xref>]. Genebank curators can use core collections to define the active collection over the base collection. Core collections can also be used to aid researchers and plant breeders in the choice of starting material. For example, the potential for use of core collections has been shown for association studies [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p>A variety of measures have been used to evaluate core collections based on genetic marker data or phenotypic traits, including pairwise distances and allelic richness. The choice of the most appropriate evaluation measure depends on the purpose of the core collection [<xref ref-type="bibr" rid="CR4">4</xref>]. Sometimes core collections are sampled based on a combination of both genotypes and phenotypes [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Many methods have been proposed to sample high quality core collections according to the measure(s) of interest. The first methods were stratified sampling techniques that cluster the accessions, based on distance matrices calculated from their allele scores or phenotypic trait values, and then select several accessions from each cluster using a certain allocation method. Brown suggested to randomly select either a constant (C) number of accessions per cluster, or a number proportional (P) to the size or logarithm (L) of the size of the cluster, and argued that the L-method is preferred [<xref ref-type="bibr" rid="CR8">8</xref>]. It was later shown that more diverse cores are obtained when the number of included accessions is proportional to the within-cluster diversity [<xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p>Another allocation method, the M-method, maximizes the probability to retain all observed alleles in order to construct cores with high allelic richness [<xref ref-type="bibr" rid="CR10">10</xref>]. This idea led to the development of the MSTRAT software, which implements a generalized M-method that directly samples from the entire collection to maximize allelic richness with a simple hill-climbing algorithm [<xref ref-type="bibr" rid="CR11">11</xref>]. Other heuristics work by repeatedly removing one of the two most similar accessions from the collection until the desired core size is obtained, either randomly (least distance stepwise sampling [<xref ref-type="bibr" rid="CR12">12</xref>]), or using a specific elimination criterion maximizing the distance to the remaining accessions or expected heterozygosity of the reduced collection (SimEli) [<xref ref-type="bibr" rid="CR13">13</xref>]. The genetic distance optimization strategy (GDOpt) was designed to construct highly representative cores, in which each accession from the entire collection is represented by a similar core entry [<xref ref-type="bibr" rid="CR14">14</xref>]. GDOpt partitions the data around a number of identified medoids, which are then selected as the core entries. Methods for variable size core sampling have also been developed. PowerCore minimizes the size of the core, while covering all observed marker alleles and/or trait values [<xref ref-type="bibr" rid="CR15">15</xref>]. GenoCore was developed for the same purpose, and specifically tailored to high-density marker datasets [<xref ref-type="bibr" rid="CR16">16</xref>]. The genetic distance sampling strategy constructs cores with a given minimum distance between selected accessions by repeatedly including a random accession and removing all others within a certain sampling radius [<xref ref-type="bibr" rid="CR17">17</xref>].</p>
    <p>Core Hunter was designed to meet the variety of criteria used to evaluate core collections for different purposes, and supports optimization of several of these metrics, using flexible local search algorithms [<xref ref-type="bibr" rid="CR18">18</xref>]. Core Hunter can construct core collections for specific applications, and combines multiple objectives to bring the different perspectives closer together, for example by simultaneously maximizing genetic dissimilarity and allelic richness. Although Core Hunter is mainly focused at fixed size core subset selection, version 1 and 2 allowed to specify a minimum and maximum size and preferred smaller cores with the same value. Core Hunter was shown to outperform stratified sampling strategies, MSTRAT and PowerCore.</p>
    <p>It has been assumed that, to obtain a diverse core, the average distance between its entries should be maximized [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. However, a high entry-to-entry distance does not guarantee that selected accessions are sufficiently different, and it is known that maximizing this criterion overrepresents extreme values [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. Core Hunter 2 (CH2) deals with this issue by also maximizing the minimum distance between selected accessions [<xref ref-type="bibr" rid="CR19">19</xref>]. Although average distance and allelic richness can be effectively optimized using simple and fast local search algorithms, such as a stochastic hill-climber, a more complex and slower <italic>mixed replica search</italic> (MixRep) was required to maximize minimum distance in the Core Hunter framework. The MixRep algorithm runs multiple types of stochastic local searches in parallel, as well as a constructive algorithm (LR) that starts from an empty selection that is iteratively extended. In case an active search is unable to find any further improvements, it is terminated and replaced with a new local search engine starting from a selection that is obtained by combining two previously found high-quality selections, in an attempt to further explore other interesting regions of the search space, as in a genetic algorithm [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p>Another approach to maximize diversity, while at the same time avoiding inclusion of too similar accessions at the extremes of the collection, is to maximize the average distance between each entry and the closest other entry in the core, as proposed by Odong et al. [<xref ref-type="bibr" rid="CR4">4</xref>]. The SimEli algorithm was shown to outperform Core Hunter 2 in terms of this new entry-to-nearest-entry (E-NE) metric. Alternatively, one may desire to optimally represent the individual accessions, instead of the whole range of diversity. In such case, Odong et al. reccomend to minimize the average distance between each accession in the full collection and the most similar accession contained in the core. The GDOpt strategy was specifically developed to minimize this accession-to-nearest-entry (A-NE) metric, and shown to outperform both Core Hunter 2 and SimEli for this purpose [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p>We introduce Core Hunter 3 (CH3), which incorporates the two improved methods for summarizing distances, entry-to-nearest-entry (E-NE) and accession-to-nearest-entry (A-NE), proposed by Odong et al. [<xref ref-type="bibr" rid="CR4">4</xref>]. CH3 attempts to find the maximum entry-to-nearest-entry distance to obtain diverse cores, whereas accession-to-nearest-entry distance is minimized to represent as much as possible all accessions from the entire collection. More specifically, CH3 can sample fixed size cores based on molecular marker data, phenotypic traits, a precomputed distance matrix, or a combination of these. The distance matrix can be generated using an appropriate measure, such as Modified Roger’s distance for genotypes [<xref ref-type="bibr" rid="CR21">21</xref>] or Gower’s distance for phenotypes [<xref ref-type="bibr" rid="CR22">22</xref>]. As in previous versions, Core Hunter 3 can also maximize allelic richness, as well as a combination of multiple metrics. In particular, we assess whether the new distance-based E-NE and A-NE metrics can be effectively optimized using fast local search algorithms, and whether maximizing E-NE indirectly also yields a high minimum distance, without the need for a more complex algorithm. Furthermore, we assess the ability of Core Hunter 3 to simultaneously maximize E-NE and A-NE, or E-NE and allelic richness, and compare the results with those obtained with Core Hunter 2, GDOpt, and SimEli, for three marker datasets with different allelic composition and varying size, and one phenotypic trait dataset. Core Hunter 3 is available as an R package <italic>corehunter</italic> on CRAN and as an open source project on GitHub. A prototype graphical user interface is also available. See <ext-link ext-link-type="uri" xlink:href="http://www.corehunter.org">http://www.corehunter.org</ext-link> for more information.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Core selection problem</title>
      <p>Given a collection <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {A}$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="script">A</mml:mi></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq1.gif"/></alternatives></inline-formula> that contains <italic>n</italic> accessions, and a desired core size 1&lt;<italic>k</italic>&lt;<italic>n</italic>, the feasible solution space of possible core subsets is defined as 
<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \Omega = \left\{ \mathcal{C} \mid \mathcal{C} \subset \mathcal{A} \land \left\vert\mathcal{C}\right\vert = k \right\} $$ \end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>⊂</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>∧</mml:mo><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2018_2209_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \vert \mathcal {C}\right \vert $\end{document}</tex-math><mml:math id="M6"><mml:mfenced close="|" open="|" separators=""><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq2.gif"/></alternatives></inline-formula> denotes the size of the subset. The core selection problem then consists of finding an optimal subset <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {C^{*}} \in \Omega $\end{document}</tex-math><mml:math id="M8"><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:mi>Ω</mml:mi></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq3.gif"/></alternatives></inline-formula> that maximizes a certain evaluation measure <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$F(\mathcal {C}): \Omega \rightarrow \mathbb {R}$\end{document}</tex-math><mml:math id="M10"><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mi>Ω</mml:mi><mml:mo>→</mml:mo><mml:mi>ℝ</mml:mi></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq4.gif"/></alternatives></inline-formula>, i.e. 
<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \mathcal{C^{*}} = \underset{\mathcal{C} \in \Omega}{\text{argmax}}\,F(\mathcal{C}). $$ \end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="script">C</mml:mi><mml:mo>∈</mml:mo><mml:mi>Ω</mml:mi></mml:mrow></mml:munder><mml:mspace width="0.3em"/><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2018_2209_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>In case the evaluation measure <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$F(\mathcal {C})$\end{document}</tex-math><mml:math id="M14"><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq5.gif"/></alternatives></inline-formula> is intended to be minimized, this can be achieved by maximizing <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$-F(\mathcal {C})$\end{document}</tex-math><mml:math id="M16"><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq6.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec4">
      <title>Evaluation measures</title>
      <p>Core Hunter 3 includes various evaluation measures that can be selected as optimization objectives, including but not limited to those described below. We refer to the website <ext-link ext-link-type="uri" xlink:href="http://www.corehunter.org">http://www.corehunter.org</ext-link> for an overview of all provided measures.</p>
      <sec id="Sec5">
        <title>Distance measures</title>
        <p>We used the Modified Roger’s distance [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR21">21</xref>] to assess the dissimilarity of accessions based on genetic marker data. For phenotypic traits we used Gower’s distance [<xref ref-type="bibr" rid="CR22">22</xref>] which simultaneously takes into account qualitative and quantitative traits. Pairwise distances are aggregated as follows to evaluate the diversity or representativeness of the core [<xref ref-type="bibr" rid="CR4">4</xref>]: 
<list list-type="bullet"><list-item><p>Entry-to-nearest-entry (E-NE): the average distance between each selected accession and the closest other core entry. This criterion can be maximized to construct highly diverse cores in which all accessions are maximally different.</p></list-item><list-item><p>Accession-to-nearest-entry (A-NE): the mean distance between each accession from the entire collection and the most similar core entry, including itself in case the accession has been selected. Minimizing this criterion yields cores that maximally represent all individual accessions.</p></list-item></list></p>
        <p>When comparing CH3 with CH2 we also evaluated the minimum distance (DMIN) between selected accessions, but this is not an objective that can be directly optimized by CH3, for reasons explained in the discussion. A detailed description and comparison of the E-NE and A-NE metrics are provided in [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
      </sec>
      <sec id="Sec6">
        <title>Allelic richness</title>
        <p>To evaluate the allelic richness of cores sampled based on genetic marker data, we used the average expected heterozygosity (HE) per locus [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR23">23</xref>], calculated as 
<disp-formula id="Equc"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ 0 \le HE = \frac{1}{L}\sum_{l=1}^{L}{\left(1 - \sum_{a=1}^{n_{l}}{\hat{p}^{2}_{la}}\right)} \le 1 $$ \end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mtext mathvariant="italic">HE</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">la</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><graphic xlink:href="12859_2018_2209_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> where <italic>L</italic> is the number of markers (loci), <italic>n</italic><sub><italic>l</italic></sub> is the number of observed alleles at the <italic>l</italic>th locus, and <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {p}^{2}_{la}$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">la</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq7.gif"/></alternatives></inline-formula> is the frequency of the <italic>a</italic>th allele at the <italic>l</italic>th locus in the selected core collection.</p>
      </sec>
      <sec id="Sec7">
        <title>Weighted index and normalization</title>
        <p>As in previous versions, Core Hunter can simultaneously optimize <italic>k</italic> measures by maximizing a weighted index 
<disp-formula id="Equd"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ F(c) = \sum_{i=1}^{k}{\alpha_{i} F_{i}(c)} $$ \end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2018_2209_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> where <italic>F</italic><sub><italic>i</italic></sub> is the <italic>i</italic>th included evaluation measure and 0&lt;<italic>α</italic><sub><italic>i</italic></sub>&lt;1 is the weight assigned to this objective, with <inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum _{i=1}^{k} \alpha _{i} = 1$\end{document}</tex-math><mml:math id="M24"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq8.gif"/></alternatives></inline-formula>. In case of a measure <italic>F</italic><sub><italic>i</italic></sub> that is to be minimized, such as A-NE, it is transformed into a maximization objective <inline-formula id="IEq9"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$F^{\prime }_{i} = -F_{i}$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq9.gif"/></alternatives></inline-formula> when it is included in the weighted index. The individual measures are automatically normalized to [0,1], following the Pareto minimum based upper-lower-bound approach as described in [<xref ref-type="bibr" rid="CR24">24</xref>], to ensure a fair balance between the included objectives, independent of their original range. More information about this normalization is provided in the documentation of the R package.</p>
      </sec>
    </sec>
    <sec id="Sec8">
      <title>Core sampling algorithms</title>
      <p>We evaluate the performance of three general purpose selection heuristics to optimize the chosen evaluation measure or weighted index for a fixed core size: random descent, parallel tempering, and a genetic algorithm. Based on the findings in this study, only the former two were included in Core Hunter 3, which defaults to the parallel tempering algorithm, but also provides a fast mode in which the random descent algorithm is applied. Note that these two stochastic local search algorithms were also available in CH2, although they were not used by default. The search algorithms are executed until either an absolute runtime limit has been exceeded, or no further improvements were obtained during a certain amount of time.</p>
      <sec id="Sec9">
        <title>Random descent</title>
        <p>This basic local search outlined in Algorithm 1 starts with a random selection of the desired size and then iteratively tries to improve its quality by slightly modifying the core. The obtained similar selection, referred to as a <italic>neighbour</italic> of the current selection, is accepted if and only if it has a higher objective function value according to the chosen evaluation measure. Otherwise, another move is tried from the current selection. Core Hunter uses a <italic>single-swap neighbourhood</italic>, i.e. considers all neighbours that can be obtained from the current selection by replacing one selected accession with a currently unselected accession.</p>
        <p>
          <graphic position="anchor" xlink:href="12859_2018_2209_Figa_HTML" id="MO1"/>
        </p>
      </sec>
      <sec id="Sec10">
        <title>Parallel tempering</title>
        <p>Algorithm 2 describes the more advanced <italic>parallel tempering</italic> method [<xref ref-type="bibr" rid="CR18">18</xref>], also referred to as replica exchange Monte Carlo (REMC), which consists of multiple cooperating local searches that are executed in parallel. Each search performs the same procedure as random descent, but may also accept inferior modifications to be able to escape from local optima, i.e. to further improve the current selection even if none of the considered neighbours has a better score. For this purpose, the search replicates are assigned fixed, increasing temperatures, equally spread in a given range. A higher temperature leads to a higher probability to accept inferior modifications, similar to the frequently used <italic>simulated annealing</italic> algorithm [<xref ref-type="bibr" rid="CR25">25</xref>]. The acceptance function is commonly defined as 
<disp-formula id="Eque"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$p(\Delta,t) = \left\{ \begin{array}{ll} 1 &amp; \text{if } \Delta &gt; 0 \\ e^{\Delta/t} &amp; \text{else} \end{array}\right. $$ \end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>Δ</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mi>Δ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mo>/</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext>else</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2018_2209_Article_Eque.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq10"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta = F(\mathcal {C}^{\prime }_{i}) - F(\mathcal {C}_{i})$\end{document}</tex-math><mml:math id="M30"><mml:mi>Δ</mml:mi><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq10.gif"/></alternatives></inline-formula> and <italic>t</italic> is the temperature of the replica. This acceptance function ensures that neighbours with a better score are always accepted, whereas inferior neighbours are accepted at a probability that exponentially decreases as the solution gets poorer or as the temperature is decreased. In addition, searches with similar temperature periodically exchange their current selection, which has the effect to push the most promising solutions towards the coolest searches to promote convergence towards a common solution, and the worst solutions towards the hottest searches allowing them to escape from local optima. The probability that replica <italic>r</italic> and <italic>r</italic>+1 will swap their current selection is commonly defined as 
<disp-formula id="Equf"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$q\left(\Delta_{r}, t_{r}, t_{r+1}\right) = \left\{ \begin{array}{ll} 1 &amp; \text{if }\Delta &gt; 0 \\ e^{\left(\frac{1}{t_{r}} - \frac{1}{t_{r+1}}\right)\Delta} &amp; \text{else} \end{array}\right. $$ \end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>q</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mi>Δ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>Δ</mml:mi></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext>else</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2018_2209_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> with <inline-formula id="IEq11"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\Delta _{r} = F\left (\mathcal {C}_{r+1}\right) - F(\mathcal {C}_{r})$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq11.gif"/></alternatives></inline-formula>. As such, if the current selection of replica <italic>r</italic>+1 has a better objective function value than that of the <italic>r</italic>th replica, these are always swapped. In addition, similar to the probabilistic acceptance of inferior neighbours, swaps that push solutions in the opposite direction may also be performed—yet with a probability that decreases for a larger difference in objective function value and replica temperature. The parallel tempering algorithm implemented in Core Hunter 3 consists of <italic>p</italic>=10 searches with a temperature range of [10<sup>−8</sup>,10<sup>−4</sup>], and uses the same single-swap neighbourhood as the random descent method described above. The number of replica steps per iteration is fixed to <italic>q</italic>=500, and the default acceptance and swap functions are applied.</p>
        <p>
          <graphic position="anchor" xlink:href="12859_2018_2209_Figb_HTML" id="MO2"/>
        </p>
      </sec>
      <sec id="Sec11">
        <title>Genetic algorithm</title>
        <p>To assess the potential improvement of a global optimization engine over a local search we also applied the genetic algorithm [<xref ref-type="bibr" rid="CR20">20</xref>] outlined in Algorithm 3. Here, a population of initially randomly generated solutions (cores) is maintained. In every step, new <italic>child</italic> solutions are produced by combining two randomly chosen <italic>parent</italic> solutions (crossover), followed by one or more swaps of accessions (mutation) between the unselected and the selected subset. These children are added to the population, and certain solutions are discarded to simulate survival of the fittest individuals in natural evolution. For our experiments we used a population size of <italic>p</italic> = 25 and generated <italic>c</italic> = 5 children in each step (in parallel). We applied the following operators: 
<list list-type="bullet"><list-item><p><bold>Selection</bold> (<sc>Select</sc>).We randomly picked five candidates from the current population, from which the one with the highest objective function value was chosen as a parent (tournament selection).</p></list-item><list-item><p><bold>Crossover</bold> (<sc>Cross</sc>). A child was created from two parents by repeatedly adding an arbitrary accession that is selected in either parent solution (at random with equal probability) until the desired core size was obtained.</p></list-item><list-item><p><bold>Mutation</bold> (<sc>Mutate</sc>). As mutation operator we applied the random descent heuristic described above, starting from the given solution, until no improvement was found in the last 5000 steps.</p></list-item><list-item><p><bold>Survival</bold> (<sc>Survive</sc>). We applied a roulette selection to discard five solutions in each step, so that the population size remained fixed over all generations. A solution <inline-formula id="IEq12"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {C}$\end{document}</tex-math><mml:math id="M36"><mml:mi mathvariant="script">C</mml:mi></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq12.gif"/></alternatives></inline-formula> was assigned a weight of <inline-formula id="IEq13"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$1/F(\mathcal {C})$\end{document}</tex-math><mml:math id="M38"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>F</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="script">C</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2018_2209_Article_IEq13.gif"/></alternatives></inline-formula> meaning that the probability that it is discarded is inversely proportional to its fitness.</p></list-item></list></p>
        <p>
          <graphic position="anchor" xlink:href="12859_2018_2209_Figc_HTML" id="MO3"/>
        </p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Comparison with GDOpt and SimEli</title>
      <p>For the GDOpt selection strategy [<xref ref-type="bibr" rid="CR14">14</xref>], we used the k-medoids algorithm of Kaufman and Rousseuw [<xref ref-type="bibr" rid="CR26">26</xref>] through the R function pam, to identify a representative core collection. The number of clusters was chosen equal to the desired core size and the returned medoids were selected as core accessions. We also implemented SimEli in R, considering both elimination criteria suggested in [<xref ref-type="bibr" rid="CR13">13</xref>]. In each step, one of the two most similar accessions was eliminated, maximizing either the average distance to the remaining accessions (SimEli-A-RA) or the expected heterozygosity of the reduced collection (SimEli-HE), until the desired core size was obtained. The source code for these implementations is available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/corehunter/corehunter3-paper">https://github.com/corehunter/corehunter3-paper</ext-link>corehunter/corehunter3-paper).</p>
    </sec>
    <sec id="Sec13">
      <title>Datasets</title>
      <p>We used four datasets of varying size and composition to compare the performance of different core sampling algorithms: 
<list list-type="order"><list-item><p><italic>Rice data</italic>: 1000 accessions for which 39 phenotypic traits were recorded, including 28 qualitative and 11 quantitative traits. Available from the PowerCore project [<xref ref-type="bibr" rid="CR15">15</xref>] and previously used to assess the performance of several other core sampling algorithms, including SimEli [<xref ref-type="bibr" rid="CR13">13</xref>].</p></list-item><list-item><p><italic>Coconut data</italic>: 1014 accessions characterized using 30 crop-specific SSR markers. Used in multiple previous core selection studies [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>].</p></list-item><list-item><p><italic>Maize data</italic>: 1250 accessions characterized with 1117 SNP markers. Distributed as part of the R package <italic>synbreedData</italic> [<xref ref-type="bibr" rid="CR27">27</xref>].</p></list-item><list-item><p><italic>Pea data</italic>: 4428 accessions characterized by 17 RBIP markers [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. Previously used to compare the performance of Core Hunter 2 with other core sampling algorithms for large datasets [<xref ref-type="bibr" rid="CR19">19</xref>].</p></list-item></list></p>
      <p>All cores sampled in the performed experiments comprised 20% of the entire collection for the rice, coconut and maize datasets, and 10% for the large pea dataset.</p>
    </sec>
    <sec id="Sec14">
      <title>Implementation and hardware</title>
      <p>Core Hunter 3 has been reimplemented in Java 8, using the JAMES framework (v1.2) for discrete optimization with local search metaheuristics [<xref ref-type="bibr" rid="CR30">30</xref>] and was executed from R through the package <italic>corehunter</italic> (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=corehunter">https://cran.r-project.org/package=corehunter</ext-link>). GDOpt, SimEli, and all computational experiments were implemented in R v3.3.1 [<xref ref-type="bibr" rid="CR31">31</xref>]. Note that the R function pam used in GDOpt calls a C function which performs the actual partitioning. Experiments were executed on a computing server with two 10-core Intel E5-2660v3 (2.6 GHz) CPUs and 128 GB RAM.</p>
    </sec>
  </sec>
  <sec id="Sec15" sec-type="results">
    <title>Results</title>
    <sec id="Sec16">
      <title>Optimizing E-NE and A-NE with local searches</title>
      <p>We sampled 10 cores from each dataset using random descent, parallel tempering, and the described genetic algorithm, configured to maximize E-NE with a runtime limit of 30 min. Table <xref rid="Tab1" ref-type="table">1</xref> shows mean values and standard deviations of the obtained cores. The results indicate that parallel tempering yields the highest E-NE values, with the lowest variability across independent samples. Variability in solution quality is always at least one order of magnitude below that observed for random descent and the genetic algorithm. Still, variability is already quite low when using the basic random descent heuristic. Although the genetic algorithm also outperforms random descent, it is not as effective as parallel tempering. We performed a pairwise comparison of the results obtained with the three applied methods, for the four considered datasets, using a Wilcoxon rank-sum test [<xref ref-type="bibr" rid="CR32">32</xref>]. The twelve resulting <italic>p</italic>-values were adjusted for multiple testing to control the family-wise error rate (FWER) using Holm’s method [<xref ref-type="bibr" rid="CR33">33</xref>]. All differences were statistically significant at the <italic>α</italic>=0.05 confidence level, with adjusted <italic>p</italic>-values ranging from 0.00013 to 0.00049. Figure <xref rid="Fig1" ref-type="fig">1</xref> displays convergence curves of the three applied algorithms, again averaged over 10 runs, for the large pea dataset. These plots confirm that all algorithms are able to iteratively improve an arbitrarily bad random selection to reach a high E-NE value. Again we see that parallel tempering yields the highest-quality cores (left). Moreover, this algorithm is almost as fast as the basic random descent heuristic (right). Both methods very quickly improve the initial random selection, and after less than 10 s, parallel tempering found a better solution than random descent, after which it keeps improving the quality of the core. In contrast, the genetic algorithm takes a slower start, catches up with random descent after 20 s, and then also further improves the selection—but not as effectively as parallel tempering. We performed these experiments only for the E-NE measure but assume that our findings also hold for A-NE due to the very similar composition of both criteria. All following CH3 results were obtained with the parallel tempering algorithm.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Convergence curves for pea dataset. These curves show the E-NE value of the best found solution at each point in time during execution of random descent, parallel tempering, and the genetic algorithm, averaged over 10 independent runs, for the large pea dataset. The left plot reports the progress during the entire run with a runtime of 30 min while the right plot is zoomed in on the first 40 s</p></caption><graphic xlink:href="12859_2018_2209_Fig1_HTML" id="MO4"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of random descent, parallel tempering, and a genetic algorithm, when maximizing the entry-to-nearest-entry criterion (E-NE). Mean values and standard deviations are reported for 10 independently sampled core collections</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Rice</th><th align="left">Coconut</th><th align="left">Maize</th><th align="left">Pea</th></tr></thead><tbody><tr><td align="left">Random descent</td><td align="left">0.1500 ± 1.83e-04</td><td align="left">0.5748 ± 5.22e-04</td><td align="left">0.4332 ± 2.73e-04</td><td align="left">0.3337 ± 1.70e-03</td></tr><tr><td align="left">Parallel tempering</td><td align="left">0.1508 ± 1.40e-15</td><td align="left">0.5759 ± 2.12e-06</td><td align="left">0.4359 ± 8.56e-05</td><td align="left">0.3412 ± 1.46e-04</td></tr><tr><td align="left">Genetic algorithm</td><td align="left">0.1506 ± 1.12e-04</td><td align="left">0.5755 ± 1.04e-04</td><td align="left">0.4346 ± 3.45e-04</td><td align="left">0.3386 ± 8.00e-04</td></tr></tbody></table></table-wrap>
</p>
    </sec>
    <sec id="Sec17">
      <title>Comparison with Core Hunter 2</title>
      <p>To assess whether maximizing E-NE indirectly also yields a high minimum distance (DMIN) between selected accessions, we compared the results of CH3 and CH2. We configured CH2 to maximize a weighted index including both average and minimum pairwise distance, with equal weight, and CH3 to maximize E-NE. Both algorithms were terminated when no improvement was found during the last 10 s. Table <xref rid="Tab2" ref-type="table">2</xref> reports average E-NE, DMIN, and execution time for 10 independent samples, obtained with both methods, and for each dataset except the rice collection, because CH2 cannot sample cores based on phenotypic traits. For all three datasets, CH3 yields higher E-NE and DMIN than CH2. However, a detailed inspection of the output generated by CH2 (not shown) revealed that the LR replica—one of the search replicas in the MixRep algorithm used by CH2—did not always complete before CH2 was terminated. This LR search is a constructive heuristic that starts with an empty selection and iteratively adds the two best accessions, i.e. those yielding the best possible score when added to the current selection. After each two additions, one accession is removed from the selection, again chosen to optimize the score of the remaining selection. This procedure is repeated until the desired core size has been reached. The LR replica was specifically included in CH2 to construct cores with high minimum distance [<xref ref-type="bibr" rid="CR19">19</xref>]. Therefore, we repeated the CH2 experiments with an absolute runtime limit that was empirically determined per dataset to ensure that the LR replica terminated in each run (CH2L). Especially for the large pea dataset, significantly more time was needed in this configuration. Table <xref rid="Tab2" ref-type="table">2</xref> shows that CH2L is indeed able to construct cores with a much higher minimum distance than CH2, and also outperforms CH3 in terms of this measure. Although differences in minimum distance obtained with CH2L and CH3 are not larger than 4%, they are statistically significant for the coconut and maize datasets (<italic>p</italic>=0.000097), but not for the pea dataset (<italic>p</italic>=0.3064). Moreover, CH3 still yields significantly higher-quality core collections in terms of the E-NE criterion (<italic>p</italic>=0.000097), and is faster for large datasets.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of Core Hunter 2 and 3</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">E-NE</th><th align="left">DMIN</th><th align="left">Time (s)</th></tr></thead><tbody><tr><td align="left" colspan="4"><italic>Coconut</italic></td></tr><tr><td align="left">CH2</td><td align="left">0.552 ± 3.53e-2</td><td align="left">0.501 ± 9.76e-2</td><td align="left">27.6 ± 06.0</td></tr><tr><td align="left">CH3</td><td align="left"><bold>0.576</bold> ± 9.35e-5</td><td align="left">0.540 ± 0.00e-0</td><td align="left">37.5 ± 07.9</td></tr><tr><td align="left">CH2L</td><td align="left">0.569 ± 5.91e-4</td><td align="left"><bold>0.548</bold> ± 0.00e-0</td><td align="left">31.0 ± 00.1</td></tr><tr><td align="left" colspan="4"><italic>Maize</italic></td></tr><tr><td align="left">CH2</td><td align="left">0.416 ± 1.52e-2</td><td align="left">0.396 ± 2.46e-2</td><td align="left">78.3 ± 10.6</td></tr><tr><td align="left">CH3</td><td align="left"><bold>0.435</bold> ± 2.70e-4</td><td align="left">0.409 ± 3.05e-3</td><td align="left">74.3 ± 26.5</td></tr><tr><td align="left">CH2L</td><td align="left">0.429 ± 5.00e-4</td><td align="left"><bold>0.415</bold> ± 1.11e-3</td><td align="left">78.6 ± 02.0</td></tr><tr><td align="left" colspan="4"><italic>Pea</italic></td></tr><tr><td align="left">CH2</td><td align="left">0.219 ± 1.49e-3</td><td align="left">0.000 ± 0.00e-0</td><td align="left">85.6 ± 04.5</td></tr><tr><td align="left">CH3</td><td align="left"><bold>0.338</bold> ± 1.04e-3</td><td align="left">0.287 ± 1.34e-2</td><td align="left">154.1 ± 49.7</td></tr><tr><td align="left">CH2L</td><td align="left">0.325 ± 8.21e-4</td><td align="left"><bold>0.297</bold> ± 0.00e-0</td><td align="left">802.3 ± 00.8</td></tr></tbody></table><table-wrap-foot><p>CH2 maximizes a weighted index including average and minimum pairwise distance, with equal weight, while CH3 maximizes E-NE. Mean E-NE, DMIN, runtime and corresponding standard deviations are reported for 10 independent executions. The highest obtained E-NE and DMIN value per dataset is shown in bold. CH3 was terminated when no improvements were found during 10 s. For CH2, two alternatives were considered: (a) the same stop condition as for CH3 (CH2); and (b) an absolute runtime limit that was empirically determined per dataset to ensure that the LR replica of MixRep terminated in each run (CH2L)</p></table-wrap-foot></table-wrap>
</p>
    </sec>
    <sec id="Sec18">
      <title>Comparison with GDOpt and SimEli</title>
      <p>We approximated the Pareto front obtained by Core Hunter 3 when simultaneously optimizing E-NE, and either A-NE or HE, with varying weights <italic>α</italic><sub>1</sub>∈[ 0,1] and <italic>α</italic><sub>2</sub>=1−<italic>α</italic><sub>1</sub>, respectively, and compared the results with those obtained by GDOpt and SimEli. Note that A-NE is minimized, while E-NE and HE are maximized. As before, CH3 was terminated when no improvement was found during 10 s. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows that GDOpt and CH3 are able to construct representative cores with low A-NE, which is not the case for SimEli. In fact, all cores sampled by SimEli have a worse A-NE value than those obtained by GDOpt and CH3, even when the latter is configured to maximize E-NE only. On the other hand, SimEli scores much better than GDOpt in terms of diversity (high E-NE). Still, Core Hunter 3 is able to find cores which simultaneously have a higher diversity and are more representative than those obtained with SimEli. For the maize dataset, SimEli-A-RA and SimEli-HE found cores of similar quality, while for the coconut and pea dataset SimEli-A-RA showed to be preferred in terms of both E-NE and A-NE. For the rice dataset, SimEli-HE was not included because expected heterozygosity can only be evaluated for genotypic data. Figure <xref rid="Fig3" ref-type="fig">3</xref> shows that GDOpt yields cores with significantly lower HE than any of the other methods. SimEli performs better in this respect, especially SimEli-HE, but as before Core Hunter 3 is able to simultaneously improve over SimEli in terms of both objectives (E-NE and HE value).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Simultaneous optimization of entry-to-nearest-entry (E-NE) and accession-to-nearest-entry (A-NE) distance. These Pareto front approximations for Core Hunter 3 were obtained by sampling cores with varying weights <italic>α</italic><sub>1</sub>∈[ 0,1] and <italic>α</italic><sub>2</sub>=1−<italic>α</italic><sub>1</sub> assigned to the E-NE and A-NE measures, respectively, with a step size of 0.05. The quality of the cores constructed by CH3 is compared with those obtained by GDOpt and SimEli, in terms of both objective functions. All reported values are averages of 10 independently sampled cores with the same settings</p></caption><graphic xlink:href="12859_2018_2209_Fig2_HTML" id="MO5"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Simultaneous maximization of entry-to-nearest-entry distance (E-NE) and expected heterozygosity (HE). These Pareto front approximations for Core Hunter 3 were obtained by sampling cores with varying weights <italic>α</italic><sub>1</sub>∈[ 0,1] and <italic>α</italic><sub>2</sub>=1−<italic>α</italic><sub>1</sub> assigned to the E-NE and HE measures, respectively, with a step size of 0.05. The quality of the cores constructed by CH3 is compared with those obtained by GDOpt and SimEli, in terms of both objective functions. All reported values are averages of 10 independently sampled cores with the same settings. The rice dataset is excluded here because expected heterozygosity can only be evaluated for genotypic data</p></caption><graphic xlink:href="12859_2018_2209_Fig3_HTML" id="MO6"/></fig>
</p>
      <p>Average execution times of GDOpt, SimEli and CH3 (configured to optimize E-NE, A-NE or HE) are reported in Table <xref rid="Tab3" ref-type="table">3</xref>. Core Hunter 3 was slower than GDOpt and SimEli for the rice and coconut datasets. For the maize dataset CH3 was faster than GDOpt and SimEli-HE when maximizing HE or E-NE but slower when minimizing A-NE and always slower than SimEli-A-RA. Finally, for the pea dataset, CH3 was faster than both GDOpt and SimEli. Core Hunter 3 was also consistently faster when maximizing HE as compared to the configurations where E-NE or A-NE were optimized.
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Average execution times (seconds) of GDOpt, both SimEli implementations and CH3 for 10 independent samples from each dataset. Three configurations are considered for CH3: (a) maximize E-NE; (b) minimize A-NE; and (c) maximize HE</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Rice</th><th align="left">Coconut</th><th align="left">Maize</th><th align="left">Pea</th></tr></thead><tbody><tr><td align="left">GDOpt</td><td align="right">14.9</td><td align="right">7.1</td><td align="right">91.2</td><td align="right">350.1</td></tr><tr><td align="left">SimEli-A-RA</td><td align="right">7.6</td><td align="right">7.5</td><td align="right">11.5</td><td align="right">514.7</td></tr><tr><td align="left">SimEli-HE</td><td align="right">-</td><td align="right">15.9</td><td align="right">78.0</td><td align="right">502.3</td></tr><tr><td align="left">CH3 E-NE</td><td align="right">45.8</td><td align="right">37.5</td><td align="right">74.3</td><td align="right">154.1</td></tr><tr><td align="left">CH3 A-NE</td><td align="right">74.6</td><td align="right">55.7</td><td align="right">133.1</td><td align="right">86.7</td></tr><tr><td align="left">CH3 HE</td><td align="right">-</td><td align="right">16.6</td><td align="right">40.2</td><td align="right">62.8</td></tr></tbody></table></table-wrap>
</p>
    </sec>
  </sec>
  <sec id="Sec19" sec-type="discussion">
    <title>Discussion</title>
    <p>Depending on the purpose of a core collection, a variety of metrics is used to evaluate its quality. Distance-based measures are attractive because they are intuitive to understand and can capture both diversity within the core as well as representativeness of the accessions from the full collection, computed from either genetic markers or phenotypes. However, pairwise distances need to be aggregated in an appropriate way to evaluate the selected core. Although many studies and methods have used average pairwise distance to assess the diversity in the core, it is known that a high average does not guarantee that all accessions in the core are sufficiently different from each other [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. Maximizing this criterion tends to overrepresent the extremes of the distribution in the full collection.</p>
    <p>Core Hunter 2 addressed this issue by maximizing minimum distance in addition to average distance, using a complex mixed replica search (MixRep) consisting of different cooperating strategies [<xref ref-type="bibr" rid="CR19">19</xref>]. The original Core Hunter software used a local search algorithm to optimize the chosen evaluation measure, but such local searches are not well suited to optimize minimum distance because this measure is very sensitive to the precise selection. Similar cores may have very different values, while at the same time very different cores may have a similar or even the same minimum distance. This makes it difficult for a local search to find its way from a randomly generated selection to a high-quality core. In particular, for a given current solution, many possible modifications may not affect the minimum distance, meaning that the search has no clue as to whether these modifications may eventually lead to an improved solution. To smooth out the objective function, CH2 maximized a combination of average and minimum distance. Also, the applied MixRep algorithm includes a constructive LR heuristic (see “<xref rid="Sec15" ref-type="sec">Results</xref>”), which is much better suited to maintain a high minimum distance as it iteratively adds accessions to an initially empty selection. Unfortunately, the LR algorithm becomes slow for large datasets, because it builds the core bottom-up, instead of iteratively refining a randomly chosen initial selection.</p>
    <p>Two new distance-based metrics, entry-to-nearest-entry (E-NE) and accession-to-nearest-entry (A-NE), introduced by [<xref ref-type="bibr" rid="CR4">4</xref>], were shown to generate improved cores for specific goals. The E-NE criterion takes all accessions into account and can therefore presumably be more effectively optimized with local searches as compared to minimum distance, but still focuses on maintaining a high distance between each pair of closest accessions which, in contrast to average pairwise distance, avoids overrepresentation of extreme values. Therefore, in Core Hunter 3, the minimum distance measure was replaced with the newly proposed E-NE criterion. The A-NE metric was also included to sample cores that maximally represent all individual accessions from the full collection.</p>
    <p>We assessed whether the new E-NE metric can indeed be effectively optimized with local search algorithms, in an attempt to avoid the complexity of the MixRep algorithm used by CH2, and in particular the slowness of the LR replica. We showed that even a very basic stochastic hill-climber (random descent) can already construct cores with high E-NE value and quite little variability in quality across independent samples. Still, the value of the core is further improved, and variability further reduced, when using the more advanced parallel tempering algorithm. Since parallel tempering takes advantage of modern multi-core CPUs, the associated computational overhead is very limited. In our experiments, even for the large pea dataset with over 4000 accessions, parallel tempering was only marginally slower than random descent. We also assessed whether a genetic algorithm could further improve these results. Such global optimization strategy iteratively combines currently known high-quality solutions (crossover) in an attempt to explore other interesting regions of the solution space. The obtained solutions are then exploited by applying local modifications (mutation). We used the random descent heuristic as a mutation operator, since it showed to be able to effectively improve the E-NE value of a given selection. Although the genetic algorithm outperformed random descent, it showed to be slower and produced cores with slightly lower E-NE values as compared to parallel tempering. These results indicate that the intelligent exploitation of parallel tempering is more effective to optimize E-NE than the more global exploration of the evaluated genetic algorithm. We thus conclude that parallel tempering is preferred, and that more complex algorithms are not needed to optimize E-NE, since a basic stochastic hill-climber (random descent) already yields high-quality cores and a global optimization engine (genetic algorithm) did not provide any further advantage. Moreover, parallel tempering does not yield a significant computational overhead—it is almost as fast as random descent. We assume that the same conclusion holds for A-NE due to the very similar composition of both metrics. Therefore, Core Hunter 3 uses parallel tempering by default, which is also known to effectively optimize the other measures that were already included in CH2, such as allelic richness [<xref ref-type="bibr" rid="CR19">19</xref>]. A fast mode is also provided in which the basic random descent algorithm is applied, in case execution time is critical, but it was not used in this study.</p>
    <p>To validate the effectiveness of the new E-NE measure, we assessed whether maximizing E-NE indirectly also yields a high minimum distance. A comparison with Core Hunter 2, configured to sample cores with high average and minimum distance, revealed that this is indeed the case. The minimum distance obtained with CH3 is slightly lower as compared to CH2, but more importantly CH3 yields higher E-NE values because it actively optimizes this criterion. As the minimum distance captures less information about the core than E-NE, we believe that the latter criterion better reflects within-core diversity. As expected, CH3 was faster than CH2 for large datasets, due to the quadratic time complexity of the LR replica. Because of its constructive nature, LR only produces useful results if given enough time to complete. Therefore, a potential additional issue of CH2 is that the user is responsible to set an appropriate time limit that allows the LR replica to complete, when aiming at a high minimum distance. It is not possible to affect the execution time of the LR replica and therefore this method does not provide a quality-runtime tradeoff to the user. Also, it may be confusing that there is a possibly large time gap between the last improvement found by the other replicas and that obtained when the LR replica has finished. In this respect, CH3 is more user-friendly because it uses a well-known local search algorithm that gradually improves the E-NE value of the core. Large gaps between significant improvements are not expected, which makes it easier to determine an appropriate time limit and even more so to use a convenient adaptive stop condition such as a maximum time without finding an improvement, in which case the execution time is automatically adjusted—to some extent—to the size of the collection.</p>
    <p>One of the main advantages of Core Hunter 3 and previous versions is its flexibility. While other methods are often developed for a specific purpose such as maximizing diversity, representativeness, or allelic richness, Core Hunter is suited for each of these as it includes a variety of evaluation measures that can directly be optimized, and if desired combined in a weighted index. We compared CH3 with GDOpt, designed to maximize representativeness, and SimEli, where the elimination criterion was chosen either to maximize diversity (SimEli-A-RA) or expected heterozygosity (SimEli-HE). Core Hunter was configured to optimize a weighted index including E-NE and either A-NE (Fig. <xref rid="Fig2" ref-type="fig">2</xref>) or HE (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), with varying weights, in order to approximate the corresponding Pareto front. The results showed that, as expected, GDOpt is especially suited to construct cores that optimally represent all accessions from the entire collection (low A-NE), as it was specifically developed for this purpose. On the other hand, in terms of diversity (E-NE) and allelic richness (HE), SimEli scores much better than GDOpt. From the two considered elimination criteria, SimEli-HE resulted in the highest allelic richness, while SimEli-A-RA showed to be most suited to maximize diversity (E-NE). Again, this was expected and confirms that the SimEli method can be adjusted to some extent, by using an appropriate elimination criterion depending on the purpose of the core collection. However, Core Hunter 3 found cores that simultaneously have higher E-NE (more diverse), and lower A-NE (more representative) or higher HE values (higher allelic richness), than those obtained by SimEli. In addition, CH3 was able to construct equally representative cores as GDOpt, and thus combines and improves over the advantages of both other methods.</p>
    <p>A comparison of execution times showed that CH3 needs less time to optimize HE as compared to E-NE and A-NE. This is not surprising, as it is known that allelic richness can also be effectively maximized with a basic stochastic hill-climber [<xref ref-type="bibr" rid="CR19">19</xref>]. As we showed that the more advanced parallel tempering algorithm is preferred to optimize E-NE and A-NE, it is clearly more difficult to find cores with high E-NE and low A-NE than to maximize allelic richness. In our experiments CH3 was slower than GDOpt and SimEli for smaller datasets but faster for the large pea dataset. Note that although these methods were implemented in different programming languages, which affects their absolute execution times, the latter does not affect the observed trend in their execution times when sampling from increasingly large collections. Here, the main advantage of Core Hunter is again its flexibility. For example, the runtime of SimEli is determined by the size of the dataset and the sampled core. When sampling a small core from a large collection, many accessions need to be eliminated, and finding the two most similar accessions in each step as well as deciding which one to eliminate requires many computations. In contrast, the runtime of Core Hunter can be adjusted by using an appropriate stop condition. It is possible to limit the total runtime, but we used an adaptive condition that terminated the search when no more improvement was found during 10 s.</p>
    <p>There is of course a tradeoff between execution time and solution quality, and we may be able to further increase the quality of the core collections sampled from any of our datasets by allowing a longer runtime. For the large pea dataset for example, we indeed see that allowing no more than 10 s without finding further improvements (Table <xref rid="Tab2" ref-type="table">2</xref>) yields a slightly lower E-NE value as compared to a configuration with an absolute runtime limit of 30 min (Table <xref rid="Tab1" ref-type="table">1</xref>). Since each of the tested methods was able to sample cores from collections with up to multiple thousands of accessions in at most a few minutes, we do not expect that the execution time of any of these algorithms will be limiting for most practical applications. Still, Core Hunter is the only one whose runtime can be controlled by the user in various ways, which yields an interesting quality-runtime tradeoff that can be used to either reduce the execution time for large datasets when needed, or to more thoroughly explore the solution space when more time is available, neither of which is possible with the other methods. Note that although we did not experiment with genotypic datasets with tens or hundreds of thousands of markers, these can easily be dealt with by precomputing a distance matrix, if necessary, so that only the number of accessions affects the performance of Core Hunter.</p>
    <sec id="Sec20">
      <title>Variable size core sampling</title>
      <p>Previous versions of Core Hunter also supported variable size core sampling. We decided to remove this functionality from Core Hunter 3, and to focus on fixed size core sampling for the provided evaluation measures, because these measures are not generally applicable to compare cores of different sizes. For example, reducing the core size artificially increases dissimilarity between selected accessions, while adding more accessions always yields a more representative core. Also, while CH1 and CH2 preferred the smallest of two cores with the same objective function value, minimizing the core size may not always be desired, depending on the purpose of the core. We are therefore convinced that fixed and variable size core sampling should be treated as separate problems, using specific evaluation measures and optimization strategies.</p>
    </sec>
  </sec>
  <sec id="Sec21" sec-type="conclusion">
    <title>Conclusions</title>
    <p>We introduced Core Hunter 3 (CH3) and showed that it constructs core collections with high diversity (high entry-to-nearest-entry distance; E-NE) and which maximally represent the individual accessions from the entire collection (low accession-to-nearest-entry distance; A-NE) using flexible and fast local search algorithms. By default, the parallel tempering algorithm is used. Version 3 improves over Core Hunter 2 (CH2) in multiple ways. CH3 is able to find cores with higher E-NE, within less time for large datasets, which also have a high minimum distance, without the need for a more complex algorithm like the mixed replica search from CH2. In addition, CH3 finds similar and often better cores than GDOpt and SimEli, which were reported to outperform CH2 in terms of E-NE and A-NE. In particular, CH3 can create equally representative cores as GDOpt, which was designed for this purpose, while at the same time being able to construct cores that are simultaneously more diverse, and either are more representative or have a higher allelic richness, than cores obtained with SimEli. As in previous versions, one of the main strengths of Core Hunter is its flexibility. The applied local search algorithms are not confined to a specific evaluation measure and new criteria can easily be introduced and optimized without the need to alter the underlying algorithms. Moreover, multiple criteria can be simultaneously optimized and the execution time is controlled by the user through various stop conditions, which offers a convenient quality-runtime tradeoff. We therefore believe that Core Hunter is a very broadly applicable core subset selection tool with a lot of opportunities to be further extended. For example, we may explore the ability of Core Hunter 3 to sample cores based on a combination of genotypes and phenotypes, or extend Core Hunter to properly incorporate variable size core sampling such as a method to construct covering cores of minimum size.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>A-NE</term>
        <def>
          <p>Average accession-to-nearest-entry distance</p>
        </def>
      </def-item>
      <def-item>
        <term>CH2</term>
        <def>
          <p>Core Hunter 2</p>
        </def>
      </def-item>
      <def-item>
        <term>CH3</term>
        <def>
          <p>Core Hunter 3</p>
        </def>
      </def-item>
      <def-item>
        <term>DMIN</term>
        <def>
          <p>Minimum distance</p>
        </def>
      </def-item>
      <def-item>
        <term>E-NE</term>
        <def>
          <p>Average entry-to-nearest-entry distance</p>
        </def>
      </def-item>
      <def-item>
        <term>GDOpt</term>
        <def>
          <p>Genetic distance optimization</p>
        </def>
      </def-item>
      <def-item>
        <term>HE</term>
        <def>
          <p>Expected heterozygosity</p>
        </def>
      </def-item>
      <def-item>
        <term>MixRep</term>
        <def>
          <p>Mixed replica search</p>
        </def>
      </def-item>
      <def-item>
        <term>REMC</term>
        <def>
          <p>Replica exchange Monte Carlo search</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Nathan Sinnesael who performed preliminary experiments that supported the development of Core Hunter 3. The computational resources (Stevin Supercomputer Infrastructure) and services used in this work were provided by the VSC (Flemish Supercomputer Center), funded by Ghent University, the Hercules Foundation and the Flemish Government - department EWI.</p>
    <sec id="d29e2048">
      <title>Funding</title>
      <p>Herman De Beukelaer is supported by a Ph.D. grant from the Research Foundation - Flanders (FWO).</p>
    </sec>
    <sec id="d29e2053">
      <title>Availability of data and materials</title>
      <p>The raw rice, coconut and maize datasets are available from the cited references [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR27">27</xref>] or on request. The raw pea dataset and computed distance matrices are also available on request.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>HDB and GD implemented the Core Hunter 3 library in Java. HDB was responsible for the R package while GD developed the graphical interface. HDB performed all experiments, under the supervision of VF. HDB wrote the initial manuscript with all authors contributing to the final version. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec>
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
    <sec>
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec>
      <title>Publisher’s Note</title>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Frankel</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Genetic perspectives of germplasm conservation. Genetic manipulation: impact on man and society</source>
        <year>1984</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>El Bakkali</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Haouane</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Moukhli</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Costes</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Van Damme</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Khadari</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Construction of core collections suitable for association mapping to optimize use of mediterranean olive (olea europaea l.) genetic resources</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>5</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0061265</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muñoz-Amatriaín</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cuesta-Marcos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Endelman</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Comadran</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bonman</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Bockelman</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Chao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Russell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Waugh</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Muehlbauer</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>The usda barley core collection: Genetic diversity, population structure, and potential for genome-wide association studies</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0094688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Odong</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Van Eeuwijk</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>van Hintum</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>Quality of core collections for effective utilisation of genetic resources review, discussion and interpretation</article-title>
        <source>Theor Appl Genet</source>
        <year>2013</year>
        <volume>126</volume>
        <issue>2</issue>
        <fpage>289</fpage>
        <lpage>305</lpage>
        <pub-id pub-id-type="doi">10.1007/s00122-012-1971-y</pub-id>
        <?supplied-pmid 22983567?>
        <pub-id pub-id-type="pmid">22983567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J-C</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>N-N</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>H-M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Investigation of combining plant genotypic values and molecular marker information for constructing core subsets</article-title>
        <source>J Integr Plant Biol</source>
        <year>2006</year>
        <volume>48</volume>
        <issue>11</issue>
        <fpage>1371</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1744-7909.2006.00348.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Franco</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Crossa</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Desphande</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical multiple-factor analysis for classifying genotypes based on phenotypic and genetic data</article-title>
        <source>Crop Sci</source>
        <year>2010</year>
        <volume>50</volume>
        <issue>1</issue>
        <fpage>105</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.2135/cropsci2009.01.0053</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Borrayo</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Machida-Hirano</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Takeya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kawase</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Watanabe</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Principal components analysis-k-means transposon element based foxtail millet core collection selection method</article-title>
        <source>BMC Genet</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/s12863-016-0343-z</pub-id>
        <pub-id pub-id-type="pmid">26866367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Core collections: a practical approach to genetic resources management</article-title>
        <source>Genome</source>
        <year>1989</year>
        <volume>31</volume>
        <issue>2</issue>
        <fpage>818</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1139/g89-144</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Franco</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Crossa</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Taba</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shands</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A sampling strategy for conserving genetic diversity when forming core subsets</article-title>
        <source>Crop Sci</source>
        <year>2005</year>
        <volume>45</volume>
        <issue>3</issue>
        <fpage>1035</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.2135/cropsci2004.0292</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schoen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Conservation of allelic richness in wild crop relatives is aided by assessment of genetic markers</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1993</year>
        <volume>90</volume>
        <issue>22</issue>
        <fpage>10623</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.90.22.10623</pub-id>
        <?supplied-pmid 8248153?>
        <pub-id pub-id-type="pmid">8248153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gouesnard</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bataillon</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Decoux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rozale</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Schoen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>MSTRAT: An algorithm for building germ plasm core collections by maximizing allelic or phenotypic richness</article-title>
        <source>J Hered</source>
        <year>2001</year>
        <volume>92</volume>
        <issue>1</issue>
        <fpage>93</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1093/jhered/92.1.93</pub-id>
        <?supplied-pmid 11336240?>
        <pub-id pub-id-type="pmid">11336240</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A strategy on constructing core collections by least distance stepwise sampling</article-title>
        <source>Theor Appl Genet</source>
        <year>2007</year>
        <volume>115</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1007/s00122-007-0533-1</pub-id>
        <?supplied-pmid 17404701?>
        <pub-id pub-id-type="pmid">17404701</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krishnan</surname>
            <given-names>RR</given-names>
          </name>
          <name>
            <surname>Sumathy</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ramesh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bindroo</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Naik</surname>
            <given-names>GV</given-names>
          </name>
        </person-group>
        <article-title>SimEli: Similarity elimination method for sampling distant entries in development of core collections</article-title>
        <source>Crop Sci</source>
        <year>2014</year>
        <volume>54</volume>
        <issue>3</issue>
        <fpage>1070</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.2135/cropsci2013.09.0600</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Odong</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>van Heerwaarden</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>van Hintum</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>van Eeuwijk</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Statistical techniques for defining reference sets of accessions and microsatellite markers</article-title>
        <source>Crop Sci</source>
        <year>2011</year>
        <volume>51</volume>
        <issue>6</issue>
        <fpage>2401</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.2135/cropsci2011.02.0095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>K-W</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>H-K</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>G-T</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>K-H</given-names>
          </name>
          <name>
            <surname>Chandrabalan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gwag</surname>
            <given-names>J-G</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>T-S</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>E-G</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>Y-J</given-names>
          </name>
        </person-group>
        <article-title>PowerCore: a program applying the advanced m strategy with a heuristic search for establishing core sets</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <issue>16</issue>
        <fpage>2155</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm313</pub-id>
        <?supplied-pmid 17586551?>
        <pub-id pub-id-type="pmid">17586551</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeong</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J-Y</given-names>
          </name>
          <name>
            <surname>Jeong</surname>
            <given-names>S-C</given-names>
          </name>
          <name>
            <surname>Kang</surname>
            <given-names>S-T</given-names>
          </name>
          <name>
            <surname>Moon</surname>
            <given-names>J-K</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Genocore: A simple and fast algorithm for core subset selection from large genotype datasets</article-title>
        <source>PLoS ONE</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>7</issue>
        <fpage>0181420</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0181420</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jansen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Van Hintum</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Genetic distance sampling: a novel sampling method for obtaining core collections using genetic distances with an application to cultivated lettuce</article-title>
        <source>Theor Appl Genet</source>
        <year>2007</year>
        <volume>114</volume>
        <issue>3</issue>
        <fpage>421</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1007/s00122-006-0433-9</pub-id>
        <?supplied-pmid 17180377?>
        <pub-id pub-id-type="pmid">17180377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thachuk</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Crossa</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Franco</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dreisigacker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Warburton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Davenport</surname>
            <given-names>GF</given-names>
          </name>
        </person-group>
        <article-title>Core Hunter: an algorithm for sampling genetic resources based on multiple genetic measures</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-243</pub-id>
        <pub-id pub-id-type="pmid">19118496</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Beukelaer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Smỳkal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Davenport</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>Fack</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Core Hunter II: fast core subset selection based on multiple genetic diversity measures using mixed replica search</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-312</pub-id>
        <pub-id pub-id-type="pmid">22214541</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Holland</surname>
            <given-names>JH</given-names>
          </name>
        </person-group>
        <source>Adaptation in Natural and Artificial Systems: an Introductory Analysis with Applications to Biology, Control, and Artificial Intelligence</source>
        <year>1975</year>
        <publisher-loc>Ann Arbor</publisher-loc>
        <publisher-name>U Michigan Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wright</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <source>Evolution and genetics of populations. vol IV</source>
        <year>1978</year>
        <publisher-loc>Chicago</publisher-loc>
        <publisher-name>The University of Chicago Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gower</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>A general coefficient of similarity and some of its properties</article-title>
        <source>J C Gower Biometrics</source>
        <year>1971</year>
        <volume>27</volume>
        <issue>4</issue>
        <fpage>857</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.2307/2528823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berg</surname>
            <given-names>EE</given-names>
          </name>
          <name>
            <surname>Hamrick</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Quantification of genetic diversity at allozyme loci</article-title>
        <source>Can J For Res</source>
        <year>1997</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>415</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1139/x96-195</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marler</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Arora</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Function-transformation methods for multi-objective optimization</article-title>
        <source>Eng Optim</source>
        <year>2005</year>
        <volume>37</volume>
        <issue>6</issue>
        <fpage>551</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1080/03052150500114289</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kirkpatrick</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gelatt</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Vecchi</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Optimization by simulated annealing</article-title>
        <source>Science</source>
        <year>1983</year>
        <volume>220</volume>
        <issue>4598</issue>
        <fpage>671</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1126/science.220.4598.671</pub-id>
        <?supplied-pmid 17813860?>
        <pub-id pub-id-type="pmid">17813860</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kaufman</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <source>Chapter 2 Partitioning Around Medoids (Program PAM) in Finding groups in data: an introduction to cluster analysis</source>
        <year>1990</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <mixed-citation publication-type="other">Wimmer V, Albrecht T, Auinger H-J, Schoen C-C. synbreedData: Data for the Synbreed Package. 2015. R package version 1.5. <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=synbreedData">https://CRAN.R-project.org/package=synbreedData</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jing</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vershinin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grzebyta</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Smỳkal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ambrose</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Flavell</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>The genetic diversity and evolution of field pea (pisum) studied by high throughput retrotransposon based insertion polymorphism (rbip) marker analysis</article-title>
        <source>BMC Evol Biol</source>
        <year>2010</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2148-10-44</pub-id>
        <pub-id pub-id-type="pmid">20044934</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smỳkal</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Kenicer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Flavell</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Corander</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kosterin</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Redden</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Ford</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Coyne</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Maxted</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ambrose</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phylogeny, phylogeography and genetic diversity of the pisum genus</article-title>
        <source>Plant Genet Resour</source>
        <year>2011</year>
        <volume>9</volume>
        <issue>01</issue>
        <fpage>4</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1017/S147926211000033X</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Beukelaer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Davenport</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>De Meyer</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fack</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>JAMES: An object-oriented java framework for discrete optimization using local search metaheuristics</article-title>
        <source>Softw Pract Experience</source>
        <year>2017</year>
        <volume>47</volume>
        <issue>6</issue>
        <fpage>921</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1002/spe.2459</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>R Core Team</collab>
        </person-group>
        <source>R: A Language and Environment for Statistical Computing</source>
        <year>2016</year>
        <publisher-loc>Vienna, Austria</publisher-loc>
        <publisher-name>R Foundation for Statistical Computing</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hollander</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wolfe</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Chicken</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <source>Nonparametric Statistical Methods</source>
        <year>2013</year>
        <publisher-loc>Chichester</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <mixed-citation publication-type="other">Holm S. A simple sequentially rejective multiple test procedure. Scand J Stat. 1979;:65–70.</mixed-citation>
    </ref>
  </ref-list>
</back>
