<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9012043</article-id>
    <article-id pub-id-type="publisher-id">2655</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-022-02655-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LinDA: linear models for differential abundance analysis of microbiome compositional data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Huijuan</given-names>
        </name>
        <address>
          <email>zhouhuijuan@mail.shufe.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>He</surname>
          <given-names>Kejun</given-names>
        </name>
        <address>
          <email>kejunhe@ruc.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Chen</surname>
          <given-names>Jun</given-names>
        </name>
        <address>
          <email>chen.jun2@mayo.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Xianyang</given-names>
        </name>
        <address>
          <email>zhangxiany@stat.tamu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.443531.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2105 4508</institution-id><institution>Shanghai University of Finance and Economics, </institution></institution-wrap>Shanghai, 200437 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.264756.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 4687 2082</institution-id><institution>Texas A&amp;M University, </institution></institution-wrap>College Station, 77843 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.24539.39</institution-id><institution-id institution-id-type="ISNI">0000 0004 0368 8103</institution-id><institution>Renmin University of China, </institution></institution-wrap>Beijing, 100872 China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.66875.3a</institution-id><institution-id institution-id-type="ISNI">0000 0004 0459 167X</institution-id><institution>Mayo Clinic, </institution></institution-wrap>Rochester, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>14</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>95</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>3</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Differential abundance analysis is at the core of statistical analysis of microbiome data. The compositional nature of microbiome sequencing data makes false positive control challenging. Here, we show that the compositional effects can be addressed by a simple, yet highly flexible and scalable, approach. The proposed method, LinDA, only requires fitting linear regression models on the centered log-ratio transformed data, and correcting the bias due to compositional effects. We show that LinDA enjoys asymptotic FDR control and can be extended to mixed-effect models for correlated microbiome data. Using simulations and real examples, we demonstrate the effectiveness of LinDA.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at (10.1186/s13059-022-02655-5).</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Compositional effect</kwd>
      <kwd>Differential abundance analysis</kwd>
      <kwd>False discovery rate</kwd>
      <kwd>Multiple testing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>national science foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS-1830392</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100008982</institution-id>
            <institution>national science foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS1811747</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM144351</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS2113360</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000057</institution-id>
            <institution>National Institute of General Medical Sciences</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM144351</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS2113359</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>The role of the human microbiome in health and disease has been intensively studied over the past few years, see, e.g., [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], for several reviews. Potentially pathogenic or probiotic microorganisms can be identified by analyzing their abundances in a microbial ecosystem (e.g., the human gut) with respect to some covariate of interest such as disease status. Current prevailing technologies for studying the human microbiome use metagenomic sequencing, where either the DNA of a taxonomically informative gene (e.g., 16S rRNA) or all the genomic DNA in the microbial genome is sequenced. After obtaining the raw sequencing reads, the reads can be clustered into operational taxonomic units (OTUs), denoised into amplicon sequence variants (ASVs), or mapped to a microbial reference database (taxa) using existing bioinformatics pipelines such as UPARSE, DADA2, and MetaPhlAn [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. For simplicity, we use the term taxon (pl. taxa) to represent any taxonomic unit (OTU/ASV/taxon) from a bioinformatics pipeline. Therefore, after bioinformatics processing, we have an abundance table recording the frequencies of detected taxa in the samples, together with a meta data table capturing the sample-level information. Differential abundance analysis is then carried out based on the abundance and meta data table.</p>
    <p>Ideally, we want to measure the absolute abundance of the microorganisms, i.e., the number of microorganisms per unit area/volume at the microbial ecosystem, and differential abundance analysis is performed on the absolute abundance data. However, the data from a sequencing experiment only captures the relative abundance (compositional) information since the total sequence read count, also known as sequencing depth or library size, does not reflect the total microbial load in the specimen due to the complex chemistry involved in sequencing [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Although there are several experimental techniques such as qPCR, spike-in and flow cytometry that can be used to achieve absolute abundance measurement, the severe limitations of these techniques prevent their wide adoption [<xref ref-type="bibr" rid="CR8">8</xref>]. Therefore, the prevailing sequencing protocol is still only able to measure the relative abundances. Drawing inferences about the changes on the unknown absolute abundance based on the measured relative abundance data is challenging due to missing the total microbial load information. The increase or decrease in the abundance of some taxa with respect to a covariate of interest automatically results in changes in the relative abundances of all other taxa, a statistical phenomenon known as compositional effects. Therefore, using the standard statistical techniques such as two-sample <italic>t</italic>-test, Wilcoxon rank sum test, and linear regression analysis ignoring the compositional nature of the data could lead to a large number of false discoveries.</p>
    <p>For the differential abundance problem to be well defined, one has to make assumptions. One major assumption is that the differential signal is sparse, i.e., only a small proportion of taxa are associated with the covariate of interest. Although many studies have supported the sparse signal assumption, there are also studies support dense signal hypotheses, where a large number of taxa are differential with small effect sizes [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Therefore, the validity of a method and the definition of true or false positive depends on the specific assumption one is willing to accept. Here our goal is to provide a statistical tool that could be potentially useful for pinpointing top candidate taxa for further biological validation.</p>
    <p>To address compositional effects in differential analysis, one popular approach is robust normalization. It involves calculating a normalizing factor (scale factor), which is robust to a small number of differential taxa and could well capture the sequencing effort for the non-differential part. Therefore, dividing by such a normalizing factor will bring the abundance of the non-differential taxa to the same scale while retaining the differences for those differential ones. Assuming the number of differential taxa is small, different strategies have been used to calculate a robust normalizing factor including TMM, RLE, CSS, and GMPR [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR14">14</xref>]. We list these methods in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. In contrast, the naive total sum scaling (TSS) normalization, which divides the counts by the library size, is not a robust normalization method [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p>These normalization techniques can be combined with different statistical procedures in differential abundance analysis. For example, we can divide the counts by the normalizing factor from the normalization techniques in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1 and then apply standard statistical tools based on the normalized data. The normalizing factor could also be included as an offset in regression models such as edgeR [<xref ref-type="bibr" rid="CR15">15</xref>], DESeq2 [<xref ref-type="bibr" rid="CR16">16</xref>], MicrobiomeDDA [<xref ref-type="bibr" rid="CR17">17</xref>], and metagenomeSeq [<xref ref-type="bibr" rid="CR13">13</xref>], where the TMM, RLE, GMPR, and CSS normalization are the accompanying normalization methods. The recently developed MaAsLin2 [<xref ref-type="bibr" rid="CR18">18</xref>] uses log linear models on the normalized abundance data. Different normalization approaches including TSS, TMM, CSS, and CLR are options in MaAsLin2. A variant to the robust normalization approach is to find a reference taxon or a set of reference taxa, which are assumed to be non-differential with respect to the covariate of interest. The data are then normalized by the count of the reference taxon (or the sum of the counts of the reference taxa). This strategy was used in RAIDA [<xref ref-type="bibr" rid="CR19">19</xref>] and DACOMP [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p>Another line of methods to tackle the compositional effect uses (log) ratio approach since only ratios are well defined for compositional data [<xref ref-type="bibr" rid="CR21">21</xref>]. The ALDEx2 method by [<xref ref-type="bibr" rid="CR22">22</xref>] uses the centered log-ratio (CLR) transformation, where the counts of a sample are divided by their geometric mean before taking logarithms. Differential abundance analysis is then performed using Wilcoxon rank sum test or <italic>t</italic>-test based on the CLR transformed data. In the CLR approach, the geometric mean can also be regarded as a robust normalizing factor. The ANCOM proposed by [<xref ref-type="bibr" rid="CR23">23</xref>] computes the pairwise ratios of the relative abundances and identifies the taxa with the most differential ratios. This is based on the observation that the abundance ratios for those differential taxa to other taxa are all differential assuming distinct effect sizes while the ratios for those non-differential taxa are mostly non-differential. Therefore, by analyzing the pattern of the pairwise ratios, one could distinguish the differential taxa from a background of non-differential taxa with high accuracy. Recently, a bias-corrected version of ANCOM (called ANCOM-BC) has been proposed [<xref ref-type="bibr" rid="CR24">24</xref>], which uses a linear regression framework based on log-transformed taxa count and estimates the unknown bias term due to the compositional effect through an EM algorithm.</p>
    <p>In the work of [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>], the authors evaluated several popular methods in differential abundance analysis (ANCOM-BC/MaAsLin2 not included) and showed that the inflation of the false discovery rate (FDR) is still a ubiquitous problem, and no method is satisfactory in all aspects. A method that is computationally efficient, relatively robust and powerful, and flexible enough to allow covariate adjustment and application to correlated microbiome data is still lacking in the field. In this paper, we propose a linear regression framework for differential abundance analysis (LinDA) to fill the methodological gap. LinDA involves three simple steps that can be carried out efficiently. First, it runs linear regressions using the CLR-transformed abundance data as the response. Then it identifies a bias term due to the compositional effect and corrects for the bias using the mode of the regression coefficients across different taxa. Finally, it computes the <italic>p</italic> values based on the bias-corrected regression coefficients and applies the Benjamini-Hochberg (BH) procedure to control the FDR. We rigorously prove the asymptotic FDR control of the proposed method, making it the first procedure that enjoys a theoretical FDR control guarantee. Our approach is related to ANCOM-BC but differs in several aspects. (i) Our derivation provides a clear interpretation of the bias term and suggests a simple way to correct it. (ii) Our procedure does not involve the EM algorithm and can be 100–1000 times faster than ANCOM-BC in our numerical studies. (iii) Our method can be directly extended to the mixed-effect models. Longitudinal and repeated measurement-based microbiome studies have been increasingly common [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>] but statistical tools for correlated microbiome data analysis remain scarce. LinDA can analyze the correlated microbiome data using the classic linear mixed-effects models. Through extensive simulation studies and real data analyses, we show that the new method outperforms the state-of-the-art approaches in terms of FDR control and power.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title>Numerical studies</title>
      <sec id="Sec4">
        <title>Setups</title>
        <p>We conducted comprehensive simulations to evaluate the performance of the proposed method under different setups. We set <italic>m</italic>=500 as the baseline for the number of taxa, which is similar to the number of tests at the species level for a typical microbiome study. We investigated the sample size <italic>n</italic>=50, 200 representing small and large sample sizes, respectively. More combinations of <italic>m</italic> and <italic>n</italic> were studied in additional settings. We generated the absolute abundances from the log normal distribution and considered three cases for the covariate of interest and confounders: the covariate of interest follows the Bernoulli distribution and no confounder (denoted as C0), the covariate of interest follows the standard normal distribution and no confounder (C1), and the covariate of interest follows the Bernoulli distribution and two confounders (C2). In addition to the basic setting (log normal abundance distribution, denoted as S0), we investigated other settings to study the robustness of the proposed method including zero-inflated absolute abundances (S1), correlated absolute abundances (S2), gamma abundance distribution (S3), smaller <italic>m</italic> (S4), smaller <italic>n</italic> (S5), 10-fold difference in library size (S6), negative binomial abundance distribution (S7) and correlated microbiome data generated by mixed-effect model (S8). See the “<xref rid="Sec18" ref-type="sec">Detailed setups for numerical studies</xref>” section for more details.</p>
      </sec>
      <sec id="Sec5">
        <title>Competing methods</title>
        <p>We compared our method with ANCOM-BC, ALDEx2, DESeq2, edgeR, metagenomeSeq and MaAsLin2. For DESeq2 and edgeR, we replaced their native normalization methods with GMPR normalization, which was shown to improve the power and false positive control in differential abundance analysis [<xref ref-type="bibr" rid="CR14">14</xref>]. For metagenomeSeq, there are two implementations, fitZig and fitFeatureModel, in the R Bioconductor package metagenomeSeq. Currently, fitFeatureModel is only applicable to binary covariate case (C0). We use metagenomeSeq2 and metagenomeSeq to denote the fitFeatureModel and fitZig procedures, respectively. We also compared with the standard non-parametric methods: Wilcoxon rank sum test for case C0 (a binary covariate) and Spearman correlation test for case C1 (a continuous covariate), both with the GMPR normalized data.</p>
        <p>For the proposed method, we considered two zero-handling approaches. The first approach adds a pseudo-count of 0.5 to all the counts, which is widely used in microbiome data analysis on the log scale. However, it has been shown to be problematic under certain situations [<xref ref-type="bibr" rid="CR20">20</xref>]. We thus designed a new imputation-based approach, where the zeros were imputed by <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N_{s}/(\max _{k:Y_{ik}=0}N_{k})$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq1.gif"/></alternatives></inline-formula> for <italic>i</italic>th taxon in <italic>s</italic>th sample, where <italic>N</italic><sub><italic>s</italic></sub> denotes the library size (sequencing depth) of <italic>s</italic>th sample and <italic>Y</italic><sub><italic>ik</italic></sub> denotes the read count of <italic>i</italic>th taxon in <italic>k</italic>th sample. In other words, zeros were imputed differently according to the library size of the sample, and zeros in the sample with a larger library size were replaced with larger fractions. In this imputation approach, we treat zeros as left-censored missing data. Suppose we only know the library sizes, then a natural strategy is to impute zeros in proportion to the library size with the sample of the largest library size receiving a fractional count close to 1 (in our approach, we simply set it as 1). The purpose of the imputation strategy is to reduce false positives when the library size is correlated with the covariate of interest. As shown in the simulation studies, the pseudo-count approach worked sufficiently well in most settings except the setting S6, where the library size between the groups differed by 10-folds. In contrast, the imputation approach reduced the false positive rate extensively for the setting S6 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1). However, it was slightly less powerful than the pseudo-count approach when the library size was a not confounder (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2). Thus, in the implementation, we used an adaptive approach: we first tested the association between the covariate of interest and the library size. If the <italic>p</italic> value was smaller than 0.1, we used the imputation approach conservatively; otherwise, we used the pseudo-count approach. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1 and S2 show that the adaptive method controls the false positives when the library sizes are very different among groups while retaining the power when the library sizes are similar.</p>
        <p>The proposed LinDA method can be viewed as a three-step procedure: CLR-OLS-BC (OLS stands for ordinary least squares and BC stands for bias correction), which can be easily extended to the linear mixed-effects model using CLR-LMM-BC (LMM stands for linear mixed-effect model). In the setting S8 (correlated microbiome data), we compared CLR-LMM-BC to CLR-OLS-BC, CLR-OLS, and CLR-LMM to demonstrate the utility of LinDA for correlated microbiome data analysis.</p>
      </sec>
      <sec id="Sec6">
        <title>Results</title>
        <p>We use S0C0 (log normal abundance distribution, a binary covariate) to denote the setting S0 (log normal abundance distribution) with the covariate design C0 (a binary covariate) and likewise for other setups. For S0, we studied all the three covariate designs (C0–C2), and for S1–S8, we only performed C0 for demonstration. We found that DESeq2, edgeR and metagenomeSeq had severe FDR inflation under most settings. To increase the readability of the results (presented in figures), we did not include them in the main comparison and focused on the comparison between LinDA, ANCOM-BC, ALDEx2, metagenomeSeq2, MaAsLin2 and Wilcoxon (Figs. <xref rid="Fig1" ref-type="fig">1</xref> and <xref rid="Fig2" ref-type="fig">2</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1–S15). Full results of all methods are presented in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S20–S30.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Performance comparison (S0C0: log normal abundance distribution, a binary covariate). Empirical false discovery rate (<bold>A</bold>) and true positive rates (<bold>B</bold>) were averaged over 100 simulation runs. Error bars (<bold>A</bold>) represent the 95% confidence intervals (CIs) of the method LinDA and the dashed horizontal line indicates the target FDR level of 0.05</p></caption><graphic xlink:href="13059_2022_2655_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>Performance comparison (S3C0: gamma abundance distribution, a binary covariate). Empirical false discovery rate (<bold>A</bold>) and true positive rates (<bold>B</bold>) were averaged over 100 simulation runs. Error bars (<bold>A</bold>) represent the 95% CIs of the method LinDA and the dashed horizontal line indicates the target FDR level of 0.05</p></caption><graphic xlink:href="13059_2022_2655_Fig2_HTML" id="MO2"/></fig></p>
        <p>We first point out that MaAsLin2 with CLR normalization is essentially the same as the CLR-OLS procedure we described earlier. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S3 compares LinDA, CLR-OLS, MaAsLin2-TSS, MaAsLin2-TMM, MaAsLin2-CSS and MaAsLin2-CLR under the setting S0C0 (log normal abundance distribution, a binary covariate). We can see that MaAsLin2-CLR is close to CLR-OLS, both of which suffer from FDR inflation. We included MaAsLin2 with its default configuration (i.e., TSS normalization) in our comparisons below.</p>
        <p>Figure <xref rid="Fig1" ref-type="fig">1</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4 and S5 show the results of the competing methods under the log normal abundance distribution with three covariate designs: a binary covariate (S0C0), a continuous covariate (S0C1), and a binary variable of interest with confounders (S0C2), respectively. Generally speaking, LinDA and ANCOM-BC have the best FDR and power trade-off. Under C0 and C2 (Fig. <xref rid="Fig1" ref-type="fig">1</xref> and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S5), both methods control the FDR around the target level, and ANCOM-BC is slightly more powerful than LinDA when the sample size is small. However, under C1 (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4), LinDA controls FDR at the target level at both sample sizes while ANCOM-BC has slight FDR inflation when the sample size is small. LinDA is also slightly more powerful than ANCOM-BC at a small sample size. The Wilcoxon rank sum test based on GMPR normalized data and MaAsLin2 perform well under C0 (a binary covariate, Fig. <xref rid="Fig1" ref-type="fig">1</xref>) with slightly inflated FDR at larger effect sizes and reasonable power across settings. In contrast, for a continuous covariate (C1, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S4), the Spearman rank correlation test and MaAsLin2 have large FDR inflation when the signal is dense. When there are confounders (C2, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S5), Wilcoxon has severe FDR inflation when the sample size is large due to its inability to adjust for confounders, while MaAsLin2 provides acceptable results as under C0. ALDEx2 is a conservative method, which offers the strongest FDR control but is much less powerful. metagenomeSeq2 performs well when the signal is sparse but fails to control the FDR when the signal is dense. We also studied the effect of zero inflation and the correlations among taxa (S1C0 and S2C0, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S6 and S7), where we observed similar patterns such that LinDA and ANCOM-BC had overall the best performance among the compared methods.</p>
        <p>Since LinDA assumes a log normal distribution of the absolute abundance, it is interesting to evaluate its performance when the log normal assumption is violated. We thus simulated the absolute abundance data using a gamma distribution (S3C0), and the results are depicted in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. It shows that LinDA controls the FDR close to the target level and has the highest power. When the signal is dense (20%), ANCOM-BC has a noticeable FDR inflation while ALDEx2, metagenomeSeq2, MaAsLin2 and Wilcoxon have severe FDR inflation when the signal is dense.</p>
        <p>With a smaller number of taxa (<italic>m</italic>=50, S4C0, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S8), ANCOM-BC controls the FDR and the power is also high. LinDA is the most powerful but it has slight FDR inflation. metagenomeSeq2, MaAsLin2, and Wilcoxon control the FDR but are less powerful in the case of sparse signal. However, when the signal is dense, they could not control the FDR properly. When the sample size is very small (<italic>n</italic>=20 or 30, S5C0), LinDA controls the FDR around the target level and maintains high power (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S9). ANCOM-BC and metagenomeSeq2 have large FDR inflation and the inflation seems to increase as the sample size gets smaller. MaAsLin2 and Wilcoxon are much less powerful and ALDEx2 has virtually no power. Under the setting S6C0, where the sequencing depth differs by 10-folds, only ALDEx2 and our proposed method with adaptive zero-handling approach are able to control the FDR (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S10). LinDA achieves a better performance in both the FDR control and power than ALDEx2. It is interesting that ALDEx2 performs better under S6C0 than under other settings. We point out here that when we implemented ANCOM-BC, we disabled its zero treatment. To further investigate whether its zero treatment option improves its performance, we also run the procedure enabling its zero treatment (zero_cut = 0.9, lib_cut = 1000, struc_zero = TRUE), and found the results were very similar (S6C0, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S11).</p>
        <p>Under the previous simulation settings, we found that DESeq2 and edgeR had the worst false positive control (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S20–S28). As the two methods assume negative binomial distribution for the counts, it is interesting to see their performance when the data are generated by their assumed model (S7C0). Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S29 shows that DESeq2 and edgeR (and metagenomeSeq) remain to have serious FDR inflation, indicating that the normalization approach to address the compositional effect is not sufficient. In contrast, LinDA and ANCOM-BC perform the best among competitors as in other settings, and ANCOM-BC achieves higher power than LinDA (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S12).</p>
        <p>Finally, we applied LinDA to correlated microbiome data (S8C0), where the other competing methods except MaAsLin2 are not applicable to correlated samples. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S13 and S14 compare the methods CLR-LMM-BC (LinDA-LMM), CLR-OLS-BC (LinDA-OLS), CLR-LMM, CLR-OLS, and MaAsLin2 for correlated data. In the scenario of comparing the pre-treatment and post-treatment samples (S8.1, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S13), we could clearly see that ignoring the bias tremendously increases the FDR level especially under dense signals (LinDA-LMM vs CLR-LMM). In addition, LinDA-LMM is more powerful than LinDA-OLS due to its ability to exploit the correlation between pre- and post-treatment samples. Under the replicate sampling setting (S8.2, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S14), we see that the LinDA-OLS has significant FDR inflation by treating the replicate samples as independent ones. In contrast, LinDA-LMM controls the FDR at the target level. MaAsLin2 control the FDR under both settings but is less powerful than LinDA-LMM.</p>
        <p>Based on the presented simulation settings, we summarize that LinDA and ANCOM-BC have overall the most robust performance among the methods evaluated. However, ANCOM-BC is computationally intensive. As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, LinDA could be 100–1000 times faster than ANCOM-BC, making LinDA a highly scalable method in practice. In addition, the extension of LinDA to the mixed-effect models is easily carried out and performs well.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Runtime (in second) comparison under different settings (R version 4.0.3 (2020-10-10); Platform: x86_64-pc-linux-gnu (64-bit); CPU: E5-2670 v2 @ 2.50GHz; Memory: 67.7 GB). The result is based on one simulation run. The“elapsed” from the R command system.time() was used</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"/><th align="left" colspan="2">S0C0</th><th align="left" colspan="2">S0C1</th><th align="left" colspan="2">S0C2</th></tr><tr><th align="left"/><th align="left"/><th align="left">LinDA</th><th align="left">ANCOM-BC</th><th align="left">LinDA</th><th align="left">ANCOM-BC</th><th align="left">LinDA</th><th align="left">ANCOM-BC</th></tr></thead><tbody><tr><td align="left"><italic>m</italic>=500</td><td align="left"><italic>n</italic>=200</td><td align="left"><bold>0</bold><bold>.</bold><bold>4</bold><bold>5</bold><bold>4</bold></td><td align="left">21.835</td><td align="left"><bold>0</bold><bold>.</bold><bold>2</bold><bold>1</bold><bold>8</bold></td><td align="left">22.057</td><td align="left"><bold>0</bold><bold>.</bold><bold>2</bold><bold>0</bold><bold>6</bold></td><td align="left">64.519</td></tr><tr><td align="left"/><td align="left"><italic>n</italic>=10,000</td><td align="left"><bold>6</bold><bold>.</bold><bold>8</bold><bold>4</bold><bold>4</bold></td><td align="left">162.218</td><td align="left"><bold>4</bold><bold>.</bold><bold>0</bold><bold>4</bold><bold>3</bold></td><td align="left">163.552</td><td align="left"><bold>5</bold><bold>.</bold><bold>0</bold><bold>7</bold><bold>3</bold></td><td align="left">216.564</td></tr><tr><td align="left"><italic>m</italic>=5000</td><td align="left"><italic>n</italic>=200</td><td align="left"><bold>1</bold><bold>.</bold><bold>5</bold><bold>9</bold><bold>8</bold></td><td align="left">184.972</td><td align="left"><bold>1</bold><bold>.</bold><bold>6</bold><bold>0</bold><bold>7</bold></td><td align="left">162.611</td><td align="left"><bold>1</bold><bold>.</bold><bold>6</bold><bold>1</bold><bold>5</bold></td><td align="left">599.985</td></tr><tr><td align="left"/><td align="left"><italic>n</italic>=10,000</td><td align="left"><bold>2</bold><bold>8</bold><bold>.</bold><bold>2</bold><bold>5</bold><bold>3</bold></td><td align="left">5135.393</td><td align="left"><bold>1</bold><bold>5</bold><bold>.</bold><bold>3</bold><bold>1</bold><bold>4</bold></td><td align="left">5157.148</td><td align="left"><bold>1</bold><bold>5</bold><bold>.</bold><bold>4</bold><bold>9</bold><bold>4</bold></td><td align="left">5506.353</td></tr></tbody></table></table-wrap></p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Real data applications</title>
      <sec id="Sec8">
        <title>Datasets</title>
        <p>We applied LinDA and the competing methods to three real datasets with independent samples from the studies of<italic>C. difficile</italic> infection (CDI, [<xref ref-type="bibr" rid="CR29">29</xref>]), inflammatory bowel disease (IBD, [<xref ref-type="bibr" rid="CR30">30</xref>]), and rheumatoid arthritis (RA, [<xref ref-type="bibr" rid="CR31">31</xref>]). To demonstrate the use of LinDA on correlated microbiome samples, we applied LinDA to a dataset from the study of the smoking effect on the human upper respiratory tract (SMOKE, [<xref ref-type="bibr" rid="CR32">32</xref>]). We used the microbiome samples from the throat for illustration, where each subject has two samples from the left and right sides of the throat. The CDI and RA datasets were provided by the authors while the IBD and the SMOKE datasets were downloaded from the Qiita database [<xref ref-type="bibr" rid="CR33">33</xref>] with the study ID 1460 and 524. All the datasets have binary phenotypes. Antibiotics use is the confounder for the IBD dataset (<italic>p</italic>=0.03 and OR = 0) while sex is the confounder for the SMOKE dataset (<italic>p</italic>=0.02 and OR= 2.26). They will be adjusted in methods that are capable of covariate adjustment. We excluded samples with less than 1000 read counts and taxa which appear in less than 10% of the samples. The basic characteristics for the four filtered datasets are summarized in Table <xref rid="Tab2" ref-type="table">2</xref>. We compared the detection power as well as their overlap patterns for LinDA, ANCOM-BC, ALDEx2, metagenomeSeq2, MaAsLin2, and Wilcoxon. Specifically, we compared the number of discoveries at different FDR levels (0.01–0.25) and used UpSet plot [<xref ref-type="bibr" rid="CR34">34</xref>] to show the overlap at the target FDR of 0.1. We used winsorization at quantile 0.97 to reduce the impact of potential outliers as recommended in [<xref ref-type="bibr" rid="CR17">17</xref>].
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Characteristics of four real microbiome datasets. NORA represents new-onset untreated rheumatoid arthritis. The second and the third columns respectively list the number of taxa and sample size of each filtered dataset (prevalence ≥10%, library size ≥1000)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"><italic>m</italic></th><th align="left"><italic>n</italic></th><th align="left"><italic>u</italic></th><th align="left"><italic>c</italic></th></tr></thead><tbody><tr><td align="left">CDI</td><td align="left">123</td><td align="left">183</td><td align="left">CDI/Diarrhea control (94 v.s. 89)</td><td align="left"/></tr><tr><td align="left">IBD</td><td align="left">579</td><td align="left">81</td><td align="left">Crohn’s disease/Healthy (62 v.s. 19)</td><td align="left">Antibiotic use (n/y, 48 + 19 v.s. 14 + 0)</td></tr><tr><td align="left">RA</td><td align="left">438</td><td align="left">72</td><td align="left">NORA/Healthy (44 v.s. 28)</td><td align="left"/></tr><tr><td align="left">SMOKE</td><td align="left">209</td><td align="left">132</td><td align="left">Smoke (n/y, 67 v.s. 65)</td><td align="left">Female/Male (31 + 16 v.s. 36 + 49)</td></tr></tbody></table></table-wrap></p>
      </sec>
      <sec id="Sec9">
        <title>Results</title>
        <p>For the CDI dataset, LinDA or MaAsLin2 made the most discoveries at different FDR levels (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). At 10% FDR, LinDA discovered eight and MaAsLin2 discovered six taxa associated with CDI. In contrast, ANCOM-BC, ALDEx2, and Wilcoxon discovered three while metagenomeSeq2 discovered two. As discussed in [<xref ref-type="bibr" rid="CR29">29</xref>], subjects with CDI were more likely to have the bacterial family Lachnospiraceae and Erysipelotrichaceae. LinDA found one more taxon belonging to Lachnospiraceae than other methods (blue bars in Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Besides, LinDA, MaAsLin2, and Wilcoxon found one differential taxon belonging to Erysipelotrichaceae while the other three methods did not identify any (orange bar in Fig. <xref rid="Fig4" ref-type="fig">4</xref>). For the IBD dataset, LinDA detected a similar number of taxa as ANCOM-BC and MaAsLin2. Wilcoxon rank sum test detected a large number of taxa associated with the disease status, but this could be due to the confounding effects of antibiotics use since it could not adjust for covariates. From Fig. <xref rid="Fig4" ref-type="fig">4</xref>, we observe that most discoveries by LinDA are shared by ANCOM-BC, MaAsLin2, or Wilcoxon. For the RA dataset, LinDA detected a similar number of taxa as ANCOM-BC and more taxa than other methods. The differential taxa detected by LinDA and ANCOM-BC largely overlapped. Overall, the results are consistent with the simulation studies.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Number of discoveries v.s. target FDR level (0.01–0.25) for the three real datasets</p></caption><graphic xlink:href="13059_2022_2655_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>Overlaps of differential taxa with target FDR level of 0.1 for the four real datasets</p></caption><graphic xlink:href="13059_2022_2655_Fig4_HTML" id="MO4"/></fig></p>
        <p>Finally, we applied LinDA-LMM and MaAsLin2 to the SMOKE dataset, where each subject has two replicate samples from the throat. The aim is to identify smoking-associated taxa adjusting for the sex. To account for the correlation between the replicate samples, we included a subject-level random intercept in LinDA-LMM. As a comparison, we also applied LinDA-OLS and MaAsLin2 to the right and left throat samples separately. LinDA-OLS based on the left or right throat samples alone discovered 12 and 15 differential taxa at 10% FDR. When both left and right samples were used in LinDA-LMM, 21 differential taxa were identified, covering the majority of the taxa identified based on the left or right throat samples alone (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). In addition, LinDA-LMM detected five taxa that were missed by analyzing the left or right samples separately. Compared to MaAsLin2, LinDA-LMM discovered seven more differential taxa. Therefore, LinDA-LMM provides a convenient way to analyze correlated microbiome datasets and enjoys the power improvement by analyzing all samples together.</p>
        <p>To visualize the results, LinDA provides a function to generate the effect size plot and volcano plot for differential taxa. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S16–S19 display the effect size plots of differential taxa at FDR level of 0.1 and volcano plots for the four datasets, respectively. In the effect size plots (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S16A–S19A), the taxa in black are detected by LinDA and taxa in red are detected solely by LinDA. In Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S16A (CDI), the taxa in blue are missed by LinDA but detected by one or more other methods. In Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S17A (IBD) and S18A (RA), the taxa in blue are missed by LinDA but detected by two or more other methods. No taxa are detected by MaAsLin2 but missed by LinDA-LMM for the SMOKE dataset. Based on the effect size plots for the CDI, IBD and RA datasets, we can see that, for the taxa solely detected by LinDA, the effect sizes tend to be underestimated without bias correction and bias correction improves the power in these cases. On the contrary, for the taxa missed by LinDA, the effect sizes tend to be overestimated without bias correction. In addition, we observe that the differential taxa for the IBD, CDI, and RA datasets are more unbalanced (i.e., more negative or positive associations) while the differential taxa for the SMOKE dataset are relatively balanced (i.e., similar numbers of negative and positive associations). Indeed, the effect size plots, where we plot both the debiased and un-debiased coefficients, revealed larger biases for the IBD, CDI, and RA datasets.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec10" sec-type="discussion">
    <title>Discussion</title>
    <p>Differential abundance analysis is at the core of the statistical analysis of microbiome data. Microbiome data are compositional in nature and all we know are the relative abundances, making the identification of differentially abundant taxa at the ecological site particularly challenging [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. Numerous differential abundance analysis methods have been proposed focusing on addressing the compositional effects [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR22">22</xref>–<xref ref-type="bibr" rid="CR24">24</xref>]. Among all the competing methods, ANCOM-BC is the state-of-the-art method, it has been demonstrated to be more robust and powerful than the competing methods. However, there are two drawbacks of ANCOM-BC. First, it is computationally intensive for large-scale microbiome datasets such as the AmericanGut dataset. Due to the huge inter-subject variation, large-scale microbiome studies have been increasingly popular, resulting in larger sample sizes. On the other hand, metagenomic sequencing has become increasingly deeper to have a high-resolution view of the microbiome, leading to an unprecedented number of new microbial features. To meet the analysis need for such large-scale datasets, a computationally efficient tool is much needed. Secondly, ANCOM-BC is not applicable to correlated/clustered microbiome datasets such as those from family/longitudinal microbiome studies or studies with paired and repeated measurements [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. Longitudinal microbiome analysis, which enables the study of the trajectory of the microbiome as well as controls for potential confounders, has been increasingly employed in human microbiome studies. Unfortunately, statistical tools for longitudinal microbiome studies are scarce. In contrast, LinDA is computationally efficient since it only involves fitting regular linear regression models and could be easily scaled to hundreds of thousands of taxa. Moreover, the extension of LinDA to linear mixed-effects models (LMM) is straightforward and we have highly efficient tools such as the R lme4 package [<xref ref-type="bibr" rid="CR35">35</xref>] for fitting LMM. Therefore, differential abundance analysis of correlated/clustered microbiome datasets could be easily performed using LinDA. Our framework also gives more insights into the CLR-based approach, which has been widely used in compositional data analysis [<xref ref-type="bibr" rid="CR21">21</xref>]. However, the bias of CLR regression models has not been formally recognized to our best knowledge. Our framework justifies the use of CLR regression and provides a solution to correct the bias associated with CLR regression.</p>
    <p>In the simulation, we found that Wilcoxon rank sum test and MaAsLin2 showed similar FDR/power curves and performed fairly well in most settings. As we mentioned earlier, MaAsLin2 is based on log linear models on the normalized count data, and it is essentially a two-sample <italic>t</italic>-test when no confounders are included, which explains why MaAsLin2 is close to Wilcoxon rank sum test. However, when we simulated an even stronger compositional effect by drawing the differential taxa from the top 25% most abundant taxa, we found that Wilcoxon rank sum test and MaAsLin2 began to break down (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S15). ANCOM-BC was overall robust and powerful, but it had inflated type I error at small sample sizes. metagenomeSeq2 did not perform well when the signal was dense and was generally less powerful than ANCOM-BC and LinDA. ALDEx2 was the most conservative method: its strong FDR control was at the expense of statistical power. LinDA was as competitive as ANCOM-BC in most settings. It had better FDR control than ANCOM-BC when the sample size was small or the covariate of interest was continuous. However, LinDA had some FDR inflation when the number of taxa was small. Under a very strong compositional effect (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S15), LinDA also showed some FDR inflation but overall it had the best FDR and power trade-off.</p>
    <p>When the library size was associated with the covariate of interest, all existing methods had severe type I error inflation. Fortunately, such association is detectable and if we see a significant association, rarefaction should be used for those methods. Although rarefaction controls the effect of uneven library sizes, it discards a significant portion of the reads and thus loses much information in the data. When there are many samples with small library sizes, the users have to decide whether to retain more reads or more samples. In LinDA, we implemented a heuristic imputation method, where the imputed values are proportional to the library sizes. This procedure makes the imputed data after CLR transformation independent of the library size and substantially reduces the inflated type I error due to library size confounding.</p>
    <p>Although the presented simulation settings could give basic insights into the performance of various methods, such model-based simulations might not be able to capture the full characteristics of the real microbiome data. It is very likely that the performance of the compared methods will change using a different simulation framework. Moreover, our simulation strategy purposely creates strong compositional effects, where all differential taxa show the same direction of change. Such setting is used to test the limit of the various methods in addressing the compositional effects. However, in real data, the compositional effects may not be always strong, and the FDR inflation of many methods could be very moderate. Therefore, a future benchmarking study, which uses real data-based simulation strategy and investigates all biologically plausible differential settings, is much needed to have a comprehensive and objective evaluation of existing differential abundance analysis methods.</p>
    <p>As for all model-based approaches, LinDA has several assumptions and limitations. First, LinDA relies on the assumption that there is a mode at 0 for the regression coefficients (Condition (vi) in Theorem 1). This assumption is easy to be met if the signal is sparse. In the simulation, we show that when the signal density is around 20%, LinDA is still very robust. However, when the signal is extremely dense, LinDA could fail. Second, LinDA assumes a log linear model on the absolute abundance. Although this is a reasonable assumption, which has been widely adopted in the analysis of abundance data, the interaction between the host and the microbiome could be more complex than the simple log linear relationship. Analysis of the residuals from the CLR regression could provide evidence about whether the assumption is reasonable. If the model assumption is violated, a permutation test or transformation of the variables may be performed. Finally, although LinDA provides asymptotic FDR control, its finite-sample FDR control is not guaranteed. Based on numerical simulations, we found that LinDA performed well under small sample sizes. However, we did observe some FDR inflation under a small feature size due to inefficiency in mode estimation with few features. Therefore, we do not recommend applying LinDA to datasets with small feature sizes (e.g., <italic>m</italic> &lt;50) such as phylum-level abundance data.</p>
    <p>LinDA uses the relative abundance data and does not model the sampling variability of the read counts. This could reduce the statistical power for those less abundant taxa, whose sampling variability is larger than those abundant taxa. To remedy the power loss, another multinomial sampling layer could be imposed on top of LinDA. However, the computational complexity will be increased significantly, breaking the simplicity of LinDA. Another approach is to perform posterior inference of the underlying proportions based on a Bayes approach. Once we obtain the posterior samples, LinDA can be applied to the posterior samples and results are then aggregated, similar in the spirit to the multiple imputation method [<xref ref-type="bibr" rid="CR36">36</xref>].</p>
    <p>Besides microbiome data, LinDA could be applied to other sequencing data such as RNA-Seq data since all sequencing data are compositional in nature [<xref ref-type="bibr" rid="CR37">37</xref>]. Thus, LinDA could be an alternative for differential expression analysis if there are strong compositional effects, for example, when the highly abundant genes are differential with the same direction of change.</p>
    <p>Finally, we comment that addressing compostionality is more relevant when analyzing individual microbial features such as differential abundance analysis, since the major interest to biomedical investigators is to find those truly differential features (“driver”) instead of those driven by the compositional effect (“passenger”). However, for community-wide analysis such as distance-based analysis [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>], addressing the compositionality may not be necessary in order to control the type I error. This is because that compositional effect is only relevant under the alternative hypotheses. Considering compositionality in the community-wide analysis has also been found to have small effects on the statistical power [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR40">40</xref>]. Additionally, in microbiome-based predictive models [<xref ref-type="bibr" rid="CR41">41</xref>], the relative abundances and/or their ratios could already be informative features for prediction and addressing compositionality may not necessarily increase the prediction accuracy significantly. Therefore, whether to address compositionality depends on the specific problems.</p>
  </sec>
  <sec id="Sec11" sec-type="conclusion">
    <title>Conclusions</title>
    <p>In summary, we proposed LinDA for differential abundance analysis of microbiome compositional data. LinDA identified a bias associated with traditional linear regression models based on CLR-transformed abundance data and proposed a strategy to estimate and correct the bias. LinDA can be extended to linear mixed-effects model for analysis of correlated microbiome data. As a general methodology, LinDA can be applied to differential abundance analysis of other high-dimensional compositional data.</p>
  </sec>
  <sec id="Sec12">
    <title>Methods</title>
    <sec id="Sec13">
      <title>Setup</title>
      <p>We use <italic>C</italic>, <italic>C</italic><sub>1</sub>, and <italic>C</italic><sub>2</sub> to denote positive constants, which can be different from line to line. As summarized in the background, there are two ways to tackle the compositional effects in differential abundance analysis, namely normalization and log-ratio transformation. In this paper, we adopt the CLR transformation and develop a bias-correction procedure to address the compositional effects. Denote the absolute abundance and the observed read count of the <italic>i</italic>th taxon in the <italic>s</italic>th sample by <italic>X</italic><sub><italic>is</italic></sub> and <italic>Y</italic><sub><italic>is</italic></sub>, respectively. For the <italic>s</italic>th sample, the total read count of all taxa, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N_{s}=\sum ^{m}_{i=1}Y_{is}$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq2.gif"/></alternatives></inline-formula>, is determined by the sequencing depth and DNA materials. Given <italic>N</italic><sub><italic>s</italic></sub>, it is natural to model the stratified count data over <italic>m</italic> taxa through a multinomial distribution as 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} P(Y_{1s}=y_{1s},\dots,Y_{ms}=y_{ms})=\frac{N_{s}!}{\prod^{m}_{i=1}y_{is}!} \prod^{m}_{j=1}\left(\frac{X_{js}}{\sum_{i=1}^{m} X_{is}}\right)^{y_{js}} \end{array} $$ \end{document}</tex-math><mml:math id="M6"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ms</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ms</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">js</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">js</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Under (<xref rid="Equ1" ref-type="">1</xref>), we have 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \log\left(\frac{Y_{is}}{\sum^{m}_{j=1}Y_{js}}\right)=\log\left(\frac{X_{is}}{\sum^{m}_{j=1}X_{js}}\right)+e_{is}, \end{array} $$ \end{document}</tex-math><mml:math id="M8"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">js</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">js</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>e</italic><sub><italic>is</italic></sub> denotes the estimation error, which is expected to diminish as <italic>N</italic><sub><italic>s</italic></sub> gets large.</p>
    </sec>
    <sec id="Sec14">
      <title>OLS estimation</title>
      <p>We consider the log linear model on the absolute abundance 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \log\left(X_{is}\right)=u_{s}\alpha_{i}+(1,\mathbf{c}_{s}^{\top})\boldsymbol{\beta}_{i}+\epsilon_{is}, \end{array} $$ \end{document}</tex-math><mml:math id="M10"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <bold>c</bold><sub><italic>s</italic></sub>=(<italic>c</italic><sub><italic>s</italic>1</sub>,...,<italic>c</italic><sub><italic>sd</italic></sub>)<sup>⊤</sup> is the <italic>d</italic>-dimensional covariates to be adjusted, <italic>u</italic><sub><italic>s</italic></sub> is the covariate of interest, and <italic>ε</italic><sub><italic>is</italic></sub> is the error term. Our goal is to discover taxa that are differentially abundant with respect to <italic>u</italic><sub><italic>s</italic></sub>. Statistically, we want to simultaneously test the following <italic>m</italic> hypotheses 
<disp-formula id="Equa"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$H_{0,i}: \alpha_{i}=0\ \text{vs.}\ H_{a,i}: \alpha_{i}\neq 0. $$ \end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="1em"/><mml:mtext>vs.</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2022_2655_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Set <italic>ε</italic><sub><italic>is</italic></sub>=<italic>ε</italic><sub><italic>is</italic></sub>+<italic>e</italic><sub><italic>is</italic></sub>. Under (<xref rid="Equ2" ref-type="">2</xref>) and (<xref rid="Equ3" ref-type="">3</xref>), the CLR-transformed data satisfies the following linear model 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} W_{is}:&amp;=\log\left\{\frac{Y_{is}}{(\prod^{m}_{j=1} Y_{js})^{1/m}}\right\}=\log\left(\frac{Y_{is}}{\sum^{m}_{k=1}Y_{ks}}\right)-\frac{1}{m}\sum_{j=1}^{m}\log\left(\frac{Y_{js}}{\sum^{m}_{k=1}Y_{ks}}\right)\\ &amp;=\log(X_{is})-\frac{1}{m}\sum_{j=1}^{m}\log(X_{js})+e_{is}-\frac{1}{m}\sum_{j=1}^{m}e_{js}\\ &amp;=u_{s}\left(\alpha_{i}-\bar{\alpha}\right)+(1,\mathbf{c}^{\top}_{s})\left(\boldsymbol{\beta}_{i}-\bar{\boldsymbol{\beta}}\right)+\varepsilon_{is}-\bar{\varepsilon}_{s}, \end{array} $$ \end{document}</tex-math><mml:math id="M14"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>:</mml:mo></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">js</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ks</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">js</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ks</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">js</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">js</mml:mtext></mml:mrow></mml:msub><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq3"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\alpha }=m^{-1}\sum _{i=1}^{m}\alpha _{i}, \bar {\boldsymbol {\beta }}=m^{-1}\sum _{i=1}^{m}\boldsymbol {\beta }_{i}$\end{document}</tex-math><mml:math id="M16"><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq3.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq4"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\varepsilon }_{s}=m^{-1}\sum _{i=1}^{m}\varepsilon _{is}$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq4.gif"/></alternatives></inline-formula>. From (<xref rid="Equ4" ref-type="">4</xref>), we can see that the OLS estimator for <italic>α</italic> based on the CLR-transformed data is biased with the bias term being <inline-formula id="IEq5"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\alpha }$\end{document}</tex-math><mml:math id="M20"><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq5.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq6"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\alpha }_{i}=\alpha _{i}-\bar {\alpha }, \bar {\boldsymbol {\beta }}_{i}=\boldsymbol {\beta }_{i}-\bar {\boldsymbol {\beta }}, \bar {\varepsilon }_{is}=\varepsilon _{is}-\bar {\varepsilon }_{s}$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq6.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq7"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\sigma }_{i}^{2}=\text {var}(\bar {\varepsilon }_{is})$\end{document}</tex-math><mml:math id="M24"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>var</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq7.gif"/></alternatives></inline-formula>. Denote by <inline-formula id="IEq8"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\alpha }_{i}, \tilde {\boldsymbol {\beta }}_{i}$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq8.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq9"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\sigma }_{i}^{2}$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq9.gif"/></alternatives></inline-formula> the OLS estimators of <inline-formula id="IEq10"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\alpha }_{i}, \bar {\boldsymbol {\beta }}_{i}$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq10.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\sigma }_{i}^{2}$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq11.gif"/></alternatives></inline-formula>, respectively. We then have 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp;(\tilde{\alpha}_{i},\tilde{\boldsymbol{\beta}}_{i}^{\top})^{\top}\!=\left(\sum_{s=1}^{n}\mathbf{z}_{s}\mathbf{z}_{s}^{\top}\right)^{-1}\left(\sum_{s=1}^{n}\mathbf{z}_{s} W_{is}\right),\ \hat{\sigma}_{i}^{2}=\frac{1}{n-d-2}\sum_{s=1}^{n}\left\{W_{is}-\left(\tilde{\alpha}_{i},\tilde{\boldsymbol{\beta}}_{i}^{\top}\right)\mathbf{z}_{s}\right\}^{2}, \end{array} $$ \end{document}</tex-math><mml:math id="M34"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq12"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbf {z}_{s}=(u_{s},1,\mathbf {c}_{s}^{\top })^{\top }$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq12.gif"/></alternatives></inline-formula>. We respectively let var<sub><bold>z</bold></sub>(·) and cov<sub><bold>z</bold></sub>(·,·) denote the variance and covariance computed conditional on <bold>z</bold><sub>1</sub>,...,<bold>z</bold><sub><italic>n</italic></sub>. It can be shown that 
<disp-formula id="Equb"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} &amp;\text{var}_{\mathbf{z}}(\tilde{\alpha}_{i})=\hat{\rho} n^{-1}\bar{\sigma}_{i}^{2}=\hat{\rho} n^{-1}m^{-1}\left\{(m-2)\sigma_{i}^{2}+m^{-1}\sum_{i=1}^{m}\sigma_{i}^{2}\right\},\\ &amp;\text{cov}_{\mathbf{z}}(\tilde{\alpha}_{i},\tilde{\alpha}_{j})=\hat{\rho} n^{-1}m^{-1}\left\{-(\sigma_{i}^{2}+\sigma_{j}^{2})+m^{-1}\sum_{i=1}^{m}\sigma_{i}^{2}\right\},\quad\text{for }i\neq j, \end{array} $$ \end{document}</tex-math><mml:math id="M38"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:msub><mml:mrow><mml:mtext>var</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close="}" open="{"><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:msub><mml:mrow><mml:mtext>cov</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close="}" open="{"><mml:mrow><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq13"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\rho }$\end{document}</tex-math><mml:math id="M40"><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq13.gif"/></alternatives></inline-formula> is the (1,1)th element of <inline-formula id="IEq14"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$(n^{-1}\sum _{s=1}^{n}\mathbf {z}_{s}\mathbf {z}_{s}^{\top })^{-1}$\end{document}</tex-math><mml:math id="M42"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq14.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec15">
      <title>Bias correction</title>
      <p>In many applications, it is reasonable to assume that there is only a small portion of differential taxa, i.e., most <italic>α</italic><sub><italic>i</italic></sub>’s are equal to 0. Under this assumption, as <inline-formula id="IEq15"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\alpha }_{i}$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq15.gif"/></alternatives></inline-formula> is an unbiased estimator for <inline-formula id="IEq16"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\alpha }_{i}=\alpha _{i}-\bar {\alpha }$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq16.gif"/></alternatives></inline-formula>, the mode of <inline-formula id="IEq17"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\alpha }_{i}$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq17.gif"/></alternatives></inline-formula> is expected to be close to <inline-formula id="IEq18"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$-\bar {\alpha }$\end{document}</tex-math><mml:math id="M50"><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq18.gif"/></alternatives></inline-formula>. This observation motivates us to estimate <inline-formula id="IEq19"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$-\bar {\alpha }$\end{document}</tex-math><mml:math id="M52"><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq19.gif"/></alternatives></inline-formula> by 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} -\tilde{\alpha}=\!\frac{\widehat{\text{mode}}(\{\sqrt{n}\tilde{\alpha}_{i}\}^{m}_{i=1})}{\sqrt{n}},\ \text{where}\ \widehat{\text{mode}}(\{\sqrt{n}\tilde{\alpha}_{i}\}^{m}_{i=1})\!= \underset{x\in\mathbb{R}}{\text{argmax}} \frac{1}{mh}\sum_{i=1}^{m}K\left(\frac{x-\sqrt{n}\tilde{\alpha}_{i}}{h}\right). \end{array} $$ \end{document}</tex-math><mml:math id="M54"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mspace width="-5.0pt"/><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mfrac><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mtext>mode</mml:mtext></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>where</mml:mtext><mml:mspace width="1em"/><mml:mover accent="false"><mml:mrow><mml:mtext>mode</mml:mtext></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>ℝ</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">mh</mml:mtext></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi>K</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>In (<xref rid="Equ6" ref-type="">6</xref>), <italic>K</italic> is a non-negative even function with <inline-formula id="IEq20"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\int _{-\infty }^{\infty }K(y)dy=1$\end{document}</tex-math><mml:math id="M56"><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:mi>K</mml:mi><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo><mml:mtext mathvariant="italic">dy</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq20.gif"/></alternatives></inline-formula>, and <italic>h</italic> is the bandwidth parameter. Under some regular conditions, we have 
<disp-formula id="Equc"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\sqrt{n}(\tilde{\alpha}-\bar{\alpha})=o_{\mathbb{P}}(1) $$ \end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>ℙ</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2022_2655_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> as <italic>m</italic>,<italic>n</italic>→<italic>∞</italic> (see the supplementary material for the proof). Therefore, one can estimate <italic>α</italic><sub><italic>i</italic></sub> by the bias-corrected estimator <inline-formula id="IEq21"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }_{i}=\tilde {\alpha }_{i}+\tilde {\alpha }$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq21.gif"/></alternatives></inline-formula>.</p>
    </sec>
    <sec id="Sec16">
      <title>Testing procedure</title>
      <p>To construct a statistic for testing <italic>H</italic><sub>0,<italic>i</italic></sub>, we need to find a proper estimator for the variance of <inline-formula id="IEq22"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }_{i}$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq22.gif"/></alternatives></inline-formula>. To this end, we note that 
<disp-formula id="Equd"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{var}_{\mathbf{z}}(\hat{\alpha}_{i})=\text{var}_{\mathbf{z}}(\tilde{\alpha}_{i})+\text{var}_{\mathbf{z}}(\tilde{\alpha})+2\text{cov}_{\mathbf{z}}(\tilde{\alpha}_{i},\tilde{\alpha}). \end{array} $$ \end{document}</tex-math><mml:math id="M64"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mtext>var</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtext>var</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>var</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mtext>cov</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Since <inline-formula id="IEq23"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {var}_{\mathbf {z}}(\tilde {\alpha }_{i})$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mtext>var</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq23.gif"/></alternatives></inline-formula> is <inline-formula id="IEq24"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\rho } \bar {\sigma }_{i}^{2}/n$\end{document}</tex-math><mml:math id="M68"><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq24.gif"/></alternatives></inline-formula>, it dominates <inline-formula id="IEq25"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {var}_{\mathbf {z}}(\tilde {\alpha })$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mtext>var</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {cov}_{\mathbf {z}}(\tilde {\alpha }_{i},\tilde {\alpha })$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mrow><mml:mtext>cov</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq26.gif"/></alternatives></inline-formula> as <italic>n</italic>,<italic>m</italic>→<italic>∞</italic> under mild conditions. Thus, we estimate the variance of <inline-formula id="IEq27"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }_{i}$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq27.gif"/></alternatives></inline-formula> by <inline-formula id="IEq28"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\rho }\hat {\sigma }_{i}^{2}/n$\end{document}</tex-math><mml:math id="M76"><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq28.gif"/></alternatives></inline-formula>. As shown in the next section, the studentized statistic <inline-formula id="IEq29"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{i}:=\sqrt {n}\hat {\alpha }_{i}/\sqrt {\hat {\rho }\hat {\sigma }_{i}^{2}}$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq29.gif"/></alternatives></inline-formula> is asymptotically normal. However, for small sample, we found that <italic>t</italic>-distribution provides a better approximation to the sampling distribution of <italic>T</italic><sub><italic>i</italic></sub>. We define the <italic>p</italic> value for testing <italic>H</italic><sub>0,<italic>i</italic></sub> as 
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} p_{i}=2F_{n-d-2}\left(-|T_{i}|\right), \end{array} $$ \end{document}</tex-math><mml:math id="M80"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>F</italic><sub><italic>n</italic>−<italic>d</italic>−2</sub>(·) denotes the cumulative distribution function of <italic>t</italic>-distribution with <italic>n</italic>−<italic>d</italic>−2 degrees of freedom. Based on the <italic>p</italic> values in (<xref rid="Equ7" ref-type="">7</xref>), we can use the BH procedure to control the FDR. The above discussion leads to the following Algorithm 1.</p>
      <p>
        <graphic position="anchor" xlink:href="13059_2022_2655_Figa_HTML" id="MO6"/>
      </p>
      <sec id="d32e4273">
        <title>
          <bold>Remark 1</bold>
        </title>
        <p>Built upon the linear regression framework, our method could be easily extended to the mixed-effect model: 
<disp-formula id="Eque"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \log(X_{is})=u_{s}\alpha_{i}+(1,\mathbf{c}_{s}^{\top})\boldsymbol{\beta}_{i}+\mathbf{r}_{s}^{\top}\boldsymbol{\gamma}_{i}+\varepsilon_{is}, \end{array} $$ \end{document}</tex-math><mml:math id="M82"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <bold><italic>γ</italic></bold><sub><italic>i</italic></sub> is the random effect and <bold>r</bold><sub><italic>s</italic></sub> is the corresponding design. Mixed-effects can be used to analyze correlated microbiome data from studies involving replicates or spatial sampling as well as family-based and longitudinal microbiome studies. We suggest using the R function lmer to estimate the parameters for the CLR-transformed data. Denote by <inline-formula id="IEq30"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\alpha }_{i,\text {lmer}}, \hat {\sigma }_{i,\text {lmer}}^{2}$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq30.gif"/></alternatives></inline-formula>, and df<sub><italic>i</italic>,lmer</sub> the estimations for <inline-formula id="IEq31"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {\alpha }_{i}$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq31.gif"/></alternatives></inline-formula>, the variance of <inline-formula id="IEq32"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\alpha }_{i,\text {lmer}}$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq32.gif"/></alternatives></inline-formula>, and the degrees of freedom of <inline-formula id="IEq33"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\alpha }_{i,\text {lmer}}$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq33.gif"/></alternatives></inline-formula> from the lmer function. We compute the bias-corrected estimates <inline-formula id="IEq34"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {\alpha }_{i,\text {lmer}}=\tilde {\alpha }_{i,\text {lmer}}+\tilde {\alpha }_{\text {lmer}}$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq34.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq35"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tilde {\alpha }_{\text {lmer}}$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq35.gif"/></alternatives></inline-formula> is obtained as the same procedure used in (<xref rid="Equ6" ref-type="">6</xref>). Similarly, we let <inline-formula id="IEq36"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$T_{i,\text {lmer}}=\hat {\alpha }_{i,\text {lmer}}/\hat {\sigma }_{i,\text {lmer}}$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq37"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\phantom {\dot {i}\!}p_{i,\text {lmer}}=2F_{\text {df}_{i,\text {lmer}}}(-|T_{i,\text {lmer}}|)$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mtext>df</mml:mtext></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext>lmer</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq37.gif"/></alternatives></inline-formula>. The BH procedure on <italic>p</italic><sub><italic>i</italic>,lmer</sub> is finally used to control the FDR.</p>
      </sec>
      <sec id="d32e4706">
        <title>
          <bold>Remark 2</bold>
        </title>
        <p>Compared to the existing methods based on either normalization or CLR transformation, our method is computationally much more efficient and can be easily scaled to problems with tens of thousands of taxa. Table <xref rid="Tab1" ref-type="table">1</xref> compares the computation time of LinDA and ANCOM-BC based on simulated datasets. We observe that our method is 100–1000 times faster than ANCOM-BC. We also tested on a massive dataset of the similar scale of the AmericanGut project [<xref ref-type="bibr" rid="CR42">42</xref>] (<italic>m</italic>=5000 and <italic>n</italic>=10,000). ANCOM-BC completed the analysis in 85 min compared to 28 s for our method (see the column of S0C0 in Table <xref rid="Tab1" ref-type="table">1</xref>). Large-scale microbiome studies have been increasingly common to overcome the large inter-subject variability, making our method practically useful for the analysis of big microbiome datasets.</p>
      </sec>
    </sec>
    <sec id="Sec17">
      <title>Asymptotic FDR control</title>
      <p>Suppose the target FDR controlling level is <italic>q</italic>. The BH procedure is equivalent to finding the smallest <italic>t</italic><sup>∗</sup> such that <inline-formula id="IEq38"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\widehat {\text {FDP}}(t^{*})\le q$\end{document}</tex-math><mml:math id="M100"><mml:mover accent="false"><mml:mrow><mml:mtext>FDP</mml:mtext></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:mi>q</mml:mi></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq38.gif"/></alternatives></inline-formula>, where 
<disp-formula id="Equf"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \widehat{\text{FDP}}(t)=\frac{2mF_{n-d-2}(-t)}{\sum_{i=1}^{m}\mathbb{I}\left(\sqrt{n}|\hat{\alpha}_{i}|/\sqrt{\hat{\rho}\hat{\sigma}_{i}^{2}}&gt;t\right)}. \end{array} $$ \end{document}</tex-math><mml:math id="M102"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mover accent="false"><mml:mrow><mml:mtext>FDP</mml:mtext></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi mathvariant="double-struck">𝕀</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Here <inline-formula id="IEq39"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbb {I}$\end{document}</tex-math><mml:math id="M104"><mml:mi mathvariant="double-struck">𝕀</mml:mi></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq39.gif"/></alternatives></inline-formula> denotes the indicator function. To show the asymptotic FDR control as <italic>m</italic>,<italic>n</italic>→<italic>∞</italic>, we take a Bayesian perspective by assuming that the parameters <italic>α</italic><sub><italic>i</italic></sub>’s are independently generated from a common distribution. The key result is summarized in the following theorem and technical details can be found in the supplementary note.</p>
      <sec id="d32e4917">
        <title>
          <bold>Theorem 1</bold>
        </title>
        <p>Let <italic>ρ</italic>be the (1,1)th element of <inline-formula id="IEq40"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\{\mathbb {E}(\mathbf {z}_{s}\mathbf {z}_{s}^{\top })\}^{-1}$\end{document}</tex-math><mml:math id="M106"><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="double-struck">𝔼</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq40.gif"/></alternatives></inline-formula>. Suppose the following conditions are satisfied:(i) <bold>z</bold><sub><italic>s</italic></sub>’s are i.i.d.; <italic>u</italic><sub><italic>s</italic></sub> and <italic>c</italic><sub><italic>sa</italic></sub>,<italic>a</italic>=1,...,<italic>d</italic>, are sub-Gaussian; <inline-formula id="IEq41"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{\text {min}}\{\mathbb {E}(\mathbf {z}_{s}\mathbf {z}_{s}^{\top })\}&gt;C$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub><mml:mo>{</mml:mo><mml:mi mathvariant="double-struck">𝔼</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">z</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>}</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq41.gif"/></alternatives></inline-formula>, where <italic>σ</italic><sub>min</sub>(<bold>A</bold>) represents the minimum eigenvalue of a matrix <bold>A</bold>.(ii) <italic>σ</italic><sub><italic>i</italic></sub>’s are i.i.d. and <inline-formula id="IEq42"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbb {P}(C_{1}&lt;\sigma _{i}&lt;C_{2})=1$\end{document}</tex-math><mml:math id="M110"><mml:mi>ℙ</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq42.gif"/></alternatives></inline-formula>.(iii) <inline-formula id="IEq43"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\varepsilon _{is}/\sigma _{i}\sim ^{\text {i.i.d.}}\mathcal {E}=^{d} N(0,1)$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mtext>i.i.d.</mml:mtext></mml:mrow></mml:msup><mml:mi mathvariant="script">E</mml:mi><mml:msup><mml:mrow><mml:mo>=</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msup><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq43.gif"/></alternatives></inline-formula> for <italic>i</italic>=1,...,<italic>m</italic> and <italic>s</italic>=1,...,<italic>n</italic>.(iv) <italic>α</italic><sub><italic>i</italic></sub>’s are i.i.d.(v) <bold>z</bold><sub><italic>s</italic></sub>,<italic>σ</italic><sub><italic>i</italic></sub>,<italic>ε</italic><sub><italic>is</italic></sub>/<italic>σ</italic><sub><italic>i</italic></sub>, and <italic>α</italic><sub><italic>i</italic></sub> for <italic>i</italic>=1,...,<italic>m</italic> and <italic>s</italic>=1,...,<italic>n</italic> are mutually independent.(vi) Denote by <italic>f</italic><sub><italic>n</italic></sub>(·;<italic>a</italic>)the density function of <inline-formula id="IEq44"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sqrt {n}\alpha _{i}+\sqrt {a}\varepsilon _{is}$\end{document}</tex-math><mml:math id="M114"><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq44.gif"/></alternatives></inline-formula> for any <italic>a</italic>&gt;0. For large enough <italic>n</italic>, the density <italic>f</italic><sub><italic>n</italic></sub>(·;<italic>ρ</italic>)has a unique mode at 0, i.e., <inline-formula id="IEq45"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\arg \max _{x\in \mathbb {R}} f_{n}(x;\rho)=0$\end{document}</tex-math><mml:math id="M116"><mml:mo>arg</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>ℝ</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq45.gif"/></alternatives></inline-formula>; for any <italic>ε</italic>&gt;0, there exists a <italic>δ</italic>&gt;0 such that min<italic>n</italic> inf|<italic>x</italic>|&gt;<italic>ε</italic>|<italic>f</italic><sub><italic>n</italic></sub>(<italic>x</italic>;<italic>ρ</italic>)−<italic>f</italic><sub><italic>n</italic></sub>(0;<italic>ρ</italic>)|&gt;<italic>δ</italic>.(vii) The Fourier transform <inline-formula id="IEq46"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$k(u)=\int _{-\infty }^{\infty }e^{-\imath uy}K(y)dy$\end{document}</tex-math><mml:math id="M118"><mml:mi>k</mml:mi><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>ıuy</mml:mi></mml:mrow></mml:msup><mml:mi>K</mml:mi><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo><mml:mtext mathvariant="italic">dy</mml:mtext></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq46.gif"/></alternatives></inline-formula> is absolutely integrable, where <inline-formula id="IEq47"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\imath =\sqrt {-1}$\end{document}</tex-math><mml:math id="M120"><mml:mi>ı</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq47.gif"/></alternatives></inline-formula> is the imaginary unit. (viii) <italic>h</italic>=<italic>o</italic>(1) and 1/(<italic>m</italic><italic>h</italic><sup>2</sup>)=<italic>o</italic>(1). (ix) <italic>m</italic>=<italic>o</italic>(<italic>e</italic><sup><italic>C</italic><italic>n</italic></sup>). (x) Let <inline-formula id="IEq48"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$S_{\infty,n}(t) =\mathbb {P}(|\mathcal {E}+\sqrt {n}\alpha _{i}/\sqrt {\rho \sigma _{i}^{2}}|&gt;t)$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>ℙ</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mi>ρ</mml:mi><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq48.gif"/></alternatives></inline-formula>. There exists <italic>t</italic><sub>0</sub> such that for large enough <italic>n</italic>, 2<italic>F</italic><sub><italic>n</italic>−<italic>d</italic>−2</sub>(−<italic>t</italic><sub>0</sub>)/<italic>S</italic><sub><italic>∞</italic>,<italic>n</italic></sub>(<italic>t</italic><sub>0</sub>)≤<italic>q</italic>.Let 
<disp-formula id="Equg"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \text{FDR}_{m,n}(t)=\mathbb{E}\left\{\frac{\sum_{i:\alpha_{i}=0}\mathbb{I}\left(|\sqrt{n}\hat{\alpha}_{i}|/\sqrt{\hat{\rho}\hat{\sigma}_{i}^{2}}&gt;t\right)}{1\vee\sum_{i=1}^{m}\mathbb{I}\left(|\sqrt{n}\hat{\alpha}_{i}|/\sqrt{\hat{\rho}\hat{\sigma}_{i}^{2}}&gt;t\right)}\right\}. \end{array} $$ \end{document}</tex-math><mml:math id="M124"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mtext>FDR</mml:mtext></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">𝔼</mml:mi><mml:mfenced close="}" open="{"><mml:mrow><mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mi mathvariant="double-struck">𝕀</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>|</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>∨</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi mathvariant="double-struck">𝕀</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>|</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt><mml:mo>&gt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Under the above conditions, we have 
<disp-formula id="Equh"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \limsup_{m\to\infty,n\to\infty}\text{FDR}_{m,n}(t^{*})\le q. \end{array} $$ \end{document}</tex-math><mml:math id="M126"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:munder><mml:mrow><mml:mo>limsup</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext>FDR</mml:mtext></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:mi>q.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equh.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Conditions (i)–(v) help prove the consistency of the variance estimators and the mode of the regression coefficients. By assuming that the errors follow the normal distributions (Condition (iii)), we can integrate all the relevant covariate information in a single parameter <inline-formula id="IEq49"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat \rho $\end{document}</tex-math><mml:math id="M128"><mml:mover accent="true"><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq49.gif"/></alternatives></inline-formula>, which facilitates the establishment of the consistency of the kernel density estimation and hence the estimator of mode. In the simulation studies, we also investigated the scenario of non-normal distribution. We use an example to illustrate Condition (vi). In particular, we assume that <inline-formula id="IEq50"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sqrt {n}\alpha _{i}$\end{document}</tex-math><mml:math id="M130"><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq50.gif"/></alternatives></inline-formula> follows a discrete distribution with <inline-formula id="IEq51"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbb {P}(\sqrt {n}\alpha _{i}=a_{n,l})=\pi _{l}$\end{document}</tex-math><mml:math id="M132"><mml:mi>ℙ</mml:mi><mml:mo>(</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq51.gif"/></alternatives></inline-formula> for <italic>l</italic>=0,1, where <italic>a</italic><sub><italic>n</italic>,0</sub>=0,<italic>a</italic><sub><italic>n</italic>,1</sub>≠0,<italic>π</italic><sub><italic>l</italic></sub>&gt;0, and <italic>π</italic><sub>0</sub>+<italic>π</italic><sub>1</sub>=1. To reflect the sparsity, <italic>π</italic><sub>0</sub> is set to be 0.8. We choose <italic>a</italic><sub><italic>n</italic>,1</sub>=2 and 5 representing weak and strong signals, respectively. We consider two cases for the error variance: (i) <italic>σ</italic><sub><italic>i</italic></sub>=1; (ii) <italic>σ</italic><sub><italic>i</italic></sub>∼IG(<italic>a</italic>,<italic>b</italic>), i.e., <italic>σ</italic><sub><italic>i</italic></sub> follows the inverse-gamma distribution with the shape parameter <italic>a</italic> and scale parameter <italic>b</italic>. As seen from Fig. <xref rid="Fig5" ref-type="fig">5</xref>, when the signal strength is weak, the mode of <inline-formula id="IEq52"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sqrt {n}\alpha _{i}+\sqrt {\rho }\varepsilon _{is}$\end{document}</tex-math><mml:math id="M134"><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq52.gif"/></alternatives></inline-formula> slightly deviates from 0 as the blue curve in the left panel indicates. For strong signals, the mode is exactly equal to zero. As shown in [<xref ref-type="bibr" rid="CR43">43</xref>], Condition (vii) is fulfilled by many commonly used kernels such as the Gaussian kernel and the uniform kernel on [−1,1]. Condition (ix) allows the number of taxa to be exponentially larger than the sample size. Condition (x) ensures the existence of a cut-off value to control the FDR at level <italic>q</italic>. A similar assumption was imposed in Theorem 4 of [<xref ref-type="bibr" rid="CR44">44</xref>].
<fig id="Fig5"><label>Fig. 5</label><caption><p>Density of <inline-formula id="IEq53"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sqrt {n}\alpha _{i}+\varepsilon _{is}$\end{document}</tex-math><mml:math id="M136"><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq53.gif"/></alternatives></inline-formula>. The panels on the left and right correspond to <italic>σ</italic><sub><italic>i</italic></sub>=1 and <italic>σ</italic><sub><italic>i</italic></sub>∼IG(2,1) respectively, where IG denotes the inverse-gamma distribution. The red curve is the density of the standard normal distribution. The blue and green curves are the densities of <inline-formula id="IEq54"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sqrt {n}\alpha _{i}+\varepsilon _{is}$\end{document}</tex-math><mml:math id="M138"><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq54.gif"/></alternatives></inline-formula> with <inline-formula id="IEq55"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbb {P}(\sqrt {n}\alpha _{i}=0)=0.8$\end{document}</tex-math><mml:math id="M140"><mml:mi>ℙ</mml:mi><mml:mo>(</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq55.gif"/></alternatives></inline-formula> and <inline-formula id="IEq56"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbb {P}(\sqrt {n}\alpha _{i}=2)=0.2$\end{document}</tex-math><mml:math id="M142"><mml:mi>ℙ</mml:mi><mml:mo>(</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq56.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq57"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbb {P}(\sqrt {n}\alpha _{i}=0)=0.8$\end{document}</tex-math><mml:math id="M144"><mml:mi>ℙ</mml:mi><mml:mo>(</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq57.gif"/></alternatives></inline-formula> and <inline-formula id="IEq58"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathbb {P}(\sqrt {n}\alpha _{i}=5)=0.2$\end{document}</tex-math><mml:math id="M146"><mml:mi>ℙ</mml:mi><mml:mo>(</mml:mo><mml:msqrt><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msqrt><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq58.gif"/></alternatives></inline-formula>, respectively</p></caption><graphic xlink:href="13059_2022_2655_Fig5_HTML" id="MO5"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec18">
      <title>Detailed setups for numerical studies</title>
      <p>The differential taxa were randomly drawn from the entire set. In particular, let <italic>H</italic><sub><italic>i</italic></sub>=0 if the <italic>i</italic>th taxon is differentially abundant and <italic>H</italic><sub><italic>i</italic></sub>=1 otherwise. The underlying truth <italic>H</italic><sub><italic>i</italic></sub> was generated from 
<disp-formula id="Equi"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$H_{i}\sim^{\text{i.i.d.}}\text{Bernoulli}(\gamma). $$ \end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mtext>i.i.d.</mml:mtext></mml:mrow></mml:msup><mml:mtext>Bernoulli</mml:mtext><mml:mo>(</mml:mo><mml:mi>γ</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2022_2655_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>We simulated two levels of signal density (i.e., percentage of differential taxa) <italic>γ</italic> = 5%, 20%, roughly corresponding to sparse and dense signals. We assumed that the baseline absolute abundance <inline-formula id="IEq59"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{is}^{(0)}$\end{document}</tex-math><mml:math id="M150"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq59.gif"/></alternatives></inline-formula> follows 
<disp-formula id="Equj"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \log\left(X_{is}^{(0)}\right)\sim^{\text{i.i.d.}}N\left(\beta_{i}^{(0)},\sigma_{i}^{2}\right), \end{array} $$ \end{document}</tex-math><mml:math id="M152"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:munderover></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mtext>i.i.d.</mml:mtext></mml:mrow></mml:msup><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>and correspondingly the absolute abundance <italic>X</italic><sub><italic>is</italic></sub> were draw based on 
<disp-formula id="Equk"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \log(X_{is})\sim^{\text{i.i.d.}} N\left(\beta_{i}^{(0)}+u_{s}\alpha_{i}+\mathbf{c}_{s}^{\top}\boldsymbol{\beta}_{i}^{-(0)},\sigma_{i}^{2}\right), \end{array} $$ \end{document}</tex-math><mml:math id="M154"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mtext>i.i.d.</mml:mtext></mml:mrow></mml:msup><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equk.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <inline-formula id="IEq60"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{i}^{-(0)}$\end{document}</tex-math><mml:math id="M156"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq60.gif"/></alternatives></inline-formula> represents the coefficients of the confounders, <italic>i</italic>=1,…,<italic>m</italic>. Let 
<disp-formula id="Equl"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} \pi_{is}^{(0)} =\frac{X_{is}^{(0)}}{\sum_{j=1}^{m}X_{js}^{(0)}} \quad \text{and} \quad \pi_{is}=\frac{X_{is}}{\sum_{j=1}^{m}X_{js}}. \end{array} $$ \end{document}</tex-math><mml:math id="M158"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">js</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">js</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equl.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The observed OTUs data were simulated by 
<disp-formula id="Equm"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l} (Y_{1s},\dots,Y_{ms})\sim^{\text{i.i.d.}} \text{Multinomial}(N_{s},\pi_{1s},\dots,\pi_{ms}). \end{array} $$ \end{document}</tex-math><mml:math id="M160"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ms</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mtext>i.i.d.</mml:mtext></mml:mrow></mml:msup><mml:mtext>Multinomial</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ms</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2022_2655_Article_Equm.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>To create a power curve, we included six effect sizes labeled as {1,2,...,6} in the figures. We made the effect sizes have the same signs for differential taxa (i.e., the differential taxa have the same direction of change), creating a relatively strong compositional effect. Since low-abundance taxa have much less statistical power, we up-weighted their effects so that the power will not be dominated by those abundant ones. Specifically, for a randomly drawn differential taxon <italic>i</italic>, we set 
<disp-formula id="Equn"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{aligned} \alpha_{i}= \left\{\begin{array}{l} \log(2\mu)\mathbb{I}\left(\bar\pi^{(0)}_{i}&gt;0.005\right)+\log\left\{2\mu\left(0.005/\bar\pi_{i}^{(0)}\right)^{{1}/{3}}\right\}\mathbb{I}\left(\bar\pi^{(0)}_{i}\le 0.005\right)\text{ for }n=50,\\ \log(\mu)\mathbb{I}\left(\bar\pi^{(0)}_{i}&gt;0.005\right)+\log\left\{\mu\left(0.005/\bar\pi_{i}^{(0)}\right)^{{1}/{3}}\right\}\mathbb{I}\left(\bar\pi^{(0)}_{i}\le 0.005\right)\text{ for }n=200, \end{array}\right. \end{aligned} $$ \end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>μ</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="double-struck">𝕀</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo>&gt;</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mn>2</mml:mn><mml:mi>μ</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0.005</mml:mn><mml:mo>/</mml:mo><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:munderover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mi mathvariant="double-struck">𝕀</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo>≤</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:mfenced><mml:mtext>for</mml:mtext><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mi>μ</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="double-struck">𝕀</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo>&gt;</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:mi>μ</mml:mi><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0.005</mml:mn><mml:mo>/</mml:mo><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:munderover></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mi mathvariant="double-struck">𝕀</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:munderover><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo>≤</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:mfenced><mml:mtext>for</mml:mtext><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2022_2655_Article_Equn.gif" position="anchor"/></alternatives></disp-formula> where <italic>μ</italic> is equally spaced on [1.05,2] and <inline-formula id="IEq61"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar \pi _{i}^{(0)}=\sum _{s=1}^{n}\pi _{is}^{(0)} / n$\end{document}</tex-math><mml:math id="M164"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq61.gif"/></alternatives></inline-formula>. We considered three cases for the covariate and confounders: 
<list list-type="bullet"><list-item><p><italic>A binary covariate.</italic><italic>u</italic><sub><italic>s</italic></sub>∼<sup>i.i.d.</sup>Bernoulli(1/2) and no confounder.</p></list-item><list-item><p><italic>A continuous covariate.</italic><italic>u</italic><sub><italic>s</italic></sub>∼<sup>i.i.d.</sup><italic>N</italic>(0,1) and no confounder.</p></list-item><list-item><p><italic>A binary covariate of interest and two confounders.</italic><italic>u</italic><sub><italic>s</italic></sub>∼Bernoulli({1+ exp(−0.5<italic>c</italic><sub><italic>s</italic>1</sub>−0.5<italic>c</italic><sub><italic>s</italic>2</sub>)}<sup>−1</sup>) independently, where <italic>c</italic><sub><italic>s</italic>1</sub> and <italic>c</italic><sub><italic>s</italic>2</sub> are confounders (i.e., <bold>c</bold><sub><italic>s</italic></sub>=(<italic>c</italic><sub><italic>s</italic>1</sub>,<italic>c</italic><sub><italic>s</italic>2</sub>)<sup>⊤</sup>). In the above, <italic>c</italic><sub><italic>s</italic>1</sub> is specified to independently follow the Rademacher distribution and <italic>c</italic><sub><italic>s</italic>2</sub>∼<sup>i.i.d.</sup><italic>N</italic>(0,1). The corresponding coefficients of the confounders <inline-formula id="IEq62"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }_{i}^{-(0)}=(\beta ^{(1)}_{i}, \beta ^{(2)}_{i})^{\top }, i=1, \dots, m$\end{document}</tex-math><mml:math id="M166"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq62.gif"/></alternatives></inline-formula>, were independently generated from a 2-dimensional normal distribution with mean (1,2)<sup>⊤</sup> and variance <bold>I</bold><sub>2</sub>, where <bold>I</bold><sub>2</sub> denotes the 2 by 2 identity matrix.</p></list-item></list></p>
      <p>The parameters <inline-formula id="IEq63"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\beta _{i}^{(0)}, \sigma _{i}^{2}$\end{document}</tex-math><mml:math id="M168"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq63.gif"/></alternatives></inline-formula>, and <italic>N</italic><sub><italic>s</italic></sub> were generated based on the estimation for a real dataset (COMBO) from the study of the gut microbiota in a general population [<xref ref-type="bibr" rid="CR45">45</xref>], which consists of 98 samples and 6674 taxa. We only used its 500 most abundant taxa. Since <inline-formula id="IEq64"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\beta _{i}^{(0)}$\end{document}</tex-math><mml:math id="M170"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq64.gif"/></alternatives></inline-formula> and <inline-formula id="IEq65"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{i}^{2}$\end{document}</tex-math><mml:math id="M172"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq65.gif"/></alternatives></inline-formula> were not directly estimable using the relative abundance data, we estimated <inline-formula id="IEq66"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\beta _{i}^{(0)}-\beta _{j}^{(0)}$\end{document}</tex-math><mml:math id="M174"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq66.gif"/></alternatives></inline-formula> and <inline-formula id="IEq67"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{i}^{2}+\sigma _{j}^{2}$\end{document}</tex-math><mml:math id="M176"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq67.gif"/></alternatives></inline-formula> based on the pairwise log ratios, forced some <inline-formula id="IEq68"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\beta _{i}^{(0)}$\end{document}</tex-math><mml:math id="M178"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq68.gif"/></alternatives></inline-formula>’s to be zeros to obtain the estimators of <inline-formula id="IEq69"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\beta _{1}^{(0)},\dots, \beta _{m}^{(0)}$\end{document}</tex-math><mml:math id="M180"><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq69.gif"/></alternatives></inline-formula>, and derived <inline-formula id="IEq70"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sigma _{i}^{2}$\end{document}</tex-math><mml:math id="M182"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq70.gif"/></alternatives></inline-formula> from the values of <inline-formula id="IEq71"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\{\sigma _{i}^{2}+\sigma _{j}^{2}\}_{i,j}$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq71.gif"/></alternatives></inline-formula>. We assume that the library size for each sample follows the negative binomial distribution 
<disp-formula id="Equo"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$N_{s}\sim^{\text{i.i.d.}}\text{NB}(7645, 5.3),$$ \end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mtext>i.i.d.</mml:mtext></mml:mrow></mml:msup><mml:mtext>NB</mml:mtext><mml:mo>(</mml:mo><mml:mn>7645</mml:mn><mml:mo>,</mml:mo><mml:mn>5.3</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2022_2655_Article_Equo.gif" position="anchor"/></alternatives></disp-formula> where the mean and dispersion parameters were estimated based on the combo data. The resulting sparsity (percent of zeros) of the count matrix is around 65–75%.</p>
      <p>In addition to the basic setting (S0, log normal abundance distribution), we designed seven other settings to study the robustness of the proposed method. Specifically, on top of S0 and C0 (a binary covariate), we studied 
<list list-type="bullet"><list-item><p><italic>zero-inflated absolute abundances.</italic> The microbiome data contains excessive zeros and many zeros in the microbiome data can be explained by insufficient sampling [<xref ref-type="bibr" rid="CR46">46</xref>] since majority of the taxa are of low-abundance. However, it is also possible that zeros are due to physical absence of the taxa [<xref ref-type="bibr" rid="CR47">47</xref>]. To study the effect of zero inflation on differential abundance analysis, we randomly forced 30% of the absolute abundance data to be 0.</p></list-item><list-item><p><italic>Correlated absolute abundances.</italic> Existing differential abundance analysis methods assume independence among taxa. However, in practice, taxa are interconnected forming networks [<xref ref-type="bibr" rid="CR48">48</xref>]. It is interesting to see if the methods compared are robust to the correlations among the taxa. In this setting, we simulated block-correlation structure by dividing the 500 taxa into 25 equal-sized blocks. Within each block, we further divided the block into 2 by 2 sub-blocks and simulated equal positive correlations (0.5) within each sub-block and equal negative correlations (−0.5) between the two sub-blocks. This mimics the scenario that there are mutualistic relationships within the group and competitive relationships between groups.</p></list-item><list-item><p><italic>Gamma abundance distribution.</italic> Although the log normal distribution has been widely used for modeling species abundance data, other models such as gamma distribution are also possible [<xref ref-type="bibr" rid="CR49">49</xref>]. We thus did additional simulation studies using the gamma distribution. Let <inline-formula id="IEq72"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{is}^{(0)}\sim ^{\text {i.i.d.}}\text {Gamma}(\eta _{i}^{(0)},1)$\end{document}</tex-math><mml:math id="M188"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mtext>i.i.d.</mml:mtext></mml:mrow></mml:msup><mml:mtext>Gamma</mml:mtext><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq72.gif"/></alternatives></inline-formula> and <inline-formula id="IEq73"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{is}\sim ^{\text {i.i.d.}}\text {Gamma}(\eta _{i}^{(0)} \exp (u_{s}\alpha _{i}+\mathbf {c}_{s}^{\top }\boldsymbol {\beta }_{i}^{-(0)}),1)$\end{document}</tex-math><mml:math id="M190"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mtext>i.i.d.</mml:mtext></mml:mrow></mml:msup><mml:mtext>Gamma</mml:mtext><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq73.gif"/></alternatives></inline-formula>. Similarly, we estimated <inline-formula id="IEq74"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\eta _{i}^{(0)}$\end{document}</tex-math><mml:math id="M192"><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq74.gif"/></alternatives></inline-formula> from the COMBO data, where we first estimated the baseline proportion <inline-formula id="IEq75"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\pi _{i}^{(0)}$\end{document}</tex-math><mml:math id="M194"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq75.gif"/></alternatives></inline-formula> based on the Dirichlet-multinomial distribution using the R function dirmult and set the over-dispersion parameter <italic>θ</italic><sup>(0)</sup> to be 0.003, then let <inline-formula id="IEq76"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\eta _{i}^{(0)}=\pi ^{(0)}_{i}(1/\theta ^{(0)} - 1)$\end{document}</tex-math><mml:math id="M196"><mml:msubsup><mml:mrow><mml:mi>η</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq76.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p><italic>Smaller m.</italic> In microbiome data, each taxon can be assigned a taxonomic lineage and taxa abundances can be aggregated at different taxonomic ranks. Differential abundance analysis at higher ranks such as family and genus is also routinely performed. At the higher ranks, the number of taxa is much smaller. We thus studied a small number of taxa (<italic>m</italic>=50) to see if the proposed method is robust to a small <italic>m</italic>. In this setting, we randomly chose 50 elements from <inline-formula id="IEq77"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\beta }^{(0)}=(\beta _{1}^{(0)},...,\beta _{500}^{(0)})^{\top }$\end{document}</tex-math><mml:math id="M198"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>500</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq77.gif"/></alternatives></inline-formula> and <inline-formula id="IEq78"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\boldsymbol {\sigma }^{2}=(\sigma _{1}^{2},...,\sigma _{500}^{2})^{\top }$\end{document}</tex-math><mml:math id="M200"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>...</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>500</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq78.gif"/></alternatives></inline-formula> in each simulation run. We set <italic>N</italic><sub><italic>s</italic></sub>∼NB(1500,5.3).</p></list-item><list-item><p><italic>Smaller n.</italic> In pilot microbiome studies, the sample sizes are usually small. It is interesting to study the performance of the methods at a much smaller sample size. We studied <italic>n</italic>=20, 30, and used the same effect size as <italic>n</italic>=50.</p></list-item><list-item><p><italic>10-fold difference in library size.</italic> When the microbiome samples are not fully randomized in sequencing, it is likely that samples of the two groups end up in two separate sequencing runs leading to very different library sizes for the two groups. Since the presence/absence of a taxon strongly depends on the library size, the differential library size will confound the two-sample comparison, especially for those rare taxa [<xref ref-type="bibr" rid="CR25">25</xref>]. To create differential library sizes, we generated the library size from <italic>N</italic><sub><italic>s</italic></sub>∼NB(5000,5.3) and <italic>N</italic><sub><italic>s</italic></sub>∼NB(50000,5.3) for the two groups, respectively.</p></list-item><list-item><p><italic>Negative bionomial abundance distribution.</italic> DESeq2 and edgeR assume negative binomial distribution for the counts, thus we included one more simulation setting, where we generated the counts from the negative binomial distribution. Let <inline-formula id="IEq79"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X_{is}^{(0)}\sim ^{\text {i.i.d.}}\text {NB}(\text {exp}(7645\kappa _{i}^{(0)}), \theta _{i}^{(0)})$\end{document}</tex-math><mml:math id="M202"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mtext>i.i.d.</mml:mtext></mml:mrow></mml:msup><mml:mtext>NB</mml:mtext><mml:mo>(</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:mn>7645</mml:mn><mml:msubsup><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq79.gif"/></alternatives></inline-formula> and <inline-formula id="IEq80"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$Y_{is}\sim ^{\text {i.i.d.}}\text {NB}(\text {exp}(N_{s}\kappa _{i}^{(0)} + u_{s}\alpha _{i}+\mathbf {c}_{s}^{\top }\boldsymbol {\beta }_{i}^{-(0)}), \theta _{i}^{(0)})$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo>∼</mml:mo></mml:mrow><mml:mrow><mml:mtext>i.i.d.</mml:mtext></mml:mrow></mml:msup><mml:mtext>NB</mml:mtext><mml:mo>(</mml:mo><mml:mtext>exp</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq80.gif"/></alternatives></inline-formula>. Similarly, we estimated the <inline-formula id="IEq81"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\kappa _{i}^{(0)}$\end{document}</tex-math><mml:math id="M206"><mml:msubsup><mml:mrow><mml:mi>κ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq81.gif"/></alternatives></inline-formula> (regression coefficient for the library size with respect to the log of the count of <italic>i</italic>th taxon) and <inline-formula id="IEq82"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\theta _{i}^{(0)}$\end{document}</tex-math><mml:math id="M208"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq82.gif"/></alternatives></inline-formula> (dispersion parameter) from the COMBO data using the R function glm.nb.</p></list-item><list-item><p><italic>Mixed-effect model.</italic> We considered two scenarios: <italic>Pre-treatment and post-treatment comparison</italic> (S8.1) and <italic>Replicate sampling</italic> (S8.2). Under S8.1, for <italic>n</italic>=50 (or 200), we simulated 25 (or 100) subjects and each has paired pre-treatment and post-treatment samples. The aim is to detect taxa affected by treatment. Under S8.2, each subject has multiple measurements. For <italic>n</italic>=50 (or 200), we generated 25 (or 50) subjects with each having 2 (or 4) replicates. Specifically, we let 
<disp-formula id="Equp"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\log(X_{is})\sim \mathbf{r}_{s}^{\top}\boldsymbol{\gamma}_{i}+N(\beta_{i}^{(0)}+u_{s}\alpha_{i}+\mathbf{c}_{s}^{\top}\boldsymbol{\beta}_{i}^{-(0)},\sigma_{i}^{2}), $$ \end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">is</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>∼</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2022_2655_Article_Equp.gif" position="anchor"/></alternatives></disp-formula> where <bold>r</bold><sub><italic>s</italic></sub> has one element equal to 1 and all the others equal to 0 indicating the subject ID of sample <italic>s</italic>. Each element of <bold><italic>γ</italic></bold><sub><italic>i</italic></sub> follows <inline-formula id="IEq83"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N(0,\tau _{i}^{2})$\end{document}</tex-math><mml:math id="M212"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq83.gif"/></alternatives></inline-formula> independently, where we let <inline-formula id="IEq84"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\tau _{i}^{2}=a_{i}\sigma _{i}^{2}$\end{document}</tex-math><mml:math id="M214"><mml:msubsup><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2022_2655_Article_IEq84.gif"/></alternatives></inline-formula> with <italic>a</italic><sub><italic>i</italic></sub>∼Unif([0,1]).</p></list-item></list></p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2022_2655_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold> Supplementary notes. <bold>Table S1</bold> lists some robust normalization methods [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR14">14</xref>]. <bold>Lemmas S1 – S4</bold> present intermediate results for proving Theorem 1. The proof depends on some useful results from [<xref ref-type="bibr" rid="CR50">50</xref>–<xref ref-type="bibr" rid="CR53">53</xref>].</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2022_2655_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2</bold> Supplementary figures. <bold>Fig. S1</bold> and <bold>S2</bold> compare the proposed method LinDA with different zero-handling approaches under settings S6C0 and S0C0. <bold>Fig. S3</bold> depicts the results of LinDA, CLR-OLS and MaAsLin2 with different normalization approaches under setting S0C0. <bold>Fig. S4</bold>–<bold>S10</bold> and <bold>S12</bold>–<bold>S14</bold> show the results of settings S0C1, S0C2, S1C0, S2C0, S4C0, S5C0, S6C0, S7C0, S8.1C0, and S8.2C0, respectively. The comparison between disabling and enabling zero treatment of the ANCOM-BC method is depicted in <bold>Fig. S11</bold> under setting S6C0. <bold>Fig. S15</bold> shows the results of setting S0C0 with stronger compositional effects. <bold>Fig. S16</bold>–<bold>S19</bold> show the effect size plots and volcano plots for the four datasets (CDI, IBD, RA, and SMOKE) respectively. <bold>Fig. S20</bold>–<bold>S30</bold> present the full result of all methods under different simulation settings.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
      <p>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2022_2655_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
    <sec id="d32e8519">
      <title>Peer review information</title>
      <p>Kevin Pang was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="d32e8524">
      <title>Review history</title>
      <p>The review history is available as Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>J.C. and X.Z. conceived, designed and supervised the work together. X.Z. developed the method. X.Z., K.H., and H.Z. performed the theoretical analysis. H.Z. and J.C. performed the evaluation and developed the software. J.C., H.Z., X.Z., and K.H wrote and revised the manuscript together. The authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by National Institute of Health R01GM144351 (Chen &amp; Zhang), National Science Foundation DMS-1830392, DMS2113359, DMS1811747 (Zhang &amp; Zhou) and National Science Foundation DMS2113360 and Mayo Clinic Center for Individualized Medicine (Chen).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>LinDA is implemented as the linda function in the CRAN R package MicrobiomeStat (<ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=MicrobiomeStat">https://CRAN.R-project.org/package=MicrobiomeStat</ext-link>). The LinDA package is also available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/zhouhj1994/LinDA">https://github.com/zhouhj1994/LinDA</ext-link>) [<xref ref-type="bibr" rid="CR54">54</xref>]. The entire codes and data for generating the presented results are available at the repository Zenodo (10.5281/zenodo.6326019) and at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/zhouhj1994/LinDA-manuscript-result">https://github.com/zhouhj1994/LinDA-manuscript-result</ext-link>) under MIT License [<xref ref-type="bibr" rid="CR55">55</xref>]. The CDI, IBD, RA, SMOKE and COMBO datasets are from [<xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR45">45</xref>], respectively.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pedersen</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Gut microbiota in human metabolic health and disease</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2021</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>55</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="doi">10.1038/s41579-020-0433-9</pub-id>
        <pub-id pub-id-type="pmid">32887946</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Valdes</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Segal</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Spector</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>Role of the gut microbiota in nutrition and health</article-title>
        <source>Bmj</source>
        <year>2018</year>
        <volume>361</volume>
        <fpage>2179</fpage>
        <pub-id pub-id-type="doi">10.1136/bmj.k2179</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Edgar</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Uparse: highly accurate otu sequences from microbial amplicon reads</article-title>
        <source>Nature methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>10</issue>
        <fpage>996</fpage>
        <lpage>998</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2604</pub-id>
        <pub-id pub-id-type="pmid">23955772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Callahan</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>McMurdie</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Rosen</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>AJA</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Dada2: high-resolution sample inference from illumina amplicon data</article-title>
        <source>Nature methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>7</issue>
        <fpage>581</fpage>
        <lpage>583</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3869</pub-id>
        <pub-id pub-id-type="pmid">27214047</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Waldron</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ballarini</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Narasimhan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Jousson</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic microbial community profiling using unique clade-specific marker genes</article-title>
        <source>Nature methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>8</issue>
        <fpage>811</fpage>
        <lpage>814</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2066</pub-id>
        <pub-id pub-id-type="pmid">22688413</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gloor</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Macklaim</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Pawlowsky-Glahn</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Egozcue</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Microbiome datasets are compositional: and this is not optional</article-title>
        <source>Frontiers in microbiology</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>2224</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2017.02224</pub-id>
        <pub-id pub-id-type="pmid">29187837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tsilimigras</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Fodor</surname>
            <given-names>AA</given-names>
          </name>
        </person-group>
        <article-title>Compositional data analysis of the microbiome: fundamentals, tools, and challenges</article-title>
        <source>Annals of epidemiology</source>
        <year>2016</year>
        <volume>26</volume>
        <issue>5</issue>
        <fpage>330</fpage>
        <lpage>335</lpage>
        <pub-id pub-id-type="doi">10.1016/j.annepidem.2016.03.002</pub-id>
        <pub-id pub-id-type="pmid">27255738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morton</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Marotz</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Washburne</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zaramela</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Edlund</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zengler</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Establishing microbial composition measurement standards with reference frames</article-title>
        <source>Nature communications</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>2719</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-10656-5</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A phylogeny-regularized sparse regression model for predictive modeling of microbial community data</article-title>
        <source>Front Microbiol</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>3112</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2018.03112</pub-id>
        <pub-id pub-id-type="pmid">30619188</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Predictive modeling of microbiome data using a phylogeny-regularized generalized linear mixed model</article-title>
        <source>Front Microbiol</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>1391</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2018.01391</pub-id>
        <pub-id pub-id-type="pmid">29997602</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of rna-seq data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-3-r25</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>106</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
        <pub-id pub-id-type="pmid">20236492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paulson</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Stine</surname>
            <given-names>OC</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Differential abundance analysis for microbial marker-gene surveys</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>12</issue>
        <fpage>1200</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2658</pub-id>
        <pub-id pub-id-type="pmid">24076764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Reeve</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Gmpr: A robust normalization method for zero-inflated count data with application to microbiome sequencing data</article-title>
        <source>PeerJ</source>
        <year>2018</year>
        <volume>6</volume>
        <fpage>4600</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.4600</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edger: a bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for rna-seq data with deseq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Deek</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Grill</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ballman</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>An omnibus test for differential distribution analysis of microbiome sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>4</issue>
        <fpage>643</fpage>
        <lpage>51</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx650</pub-id>
        <pub-id pub-id-type="pmid">29040451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mallick</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Rahnavard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McIver</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nguyen</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>Tickle</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Weingart</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Schwager</surname>
            <given-names>EH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multivariable association discovery in population-scale meta-omics studies</article-title>
        <source>PLoS Comput Biol</source>
        <year>2021</year>
        <volume>17</volume>
        <issue>11</issue>
        <fpage>1009442</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sohn</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>A robust approach for identifying differentially abundant features in metagenomic samples</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>14</issue>
        <fpage>2269</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv165</pub-id>
        <pub-id pub-id-type="pmid">25792553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <mixed-citation publication-type="other">Brill B, Amir A, Heller R. Testing for differential abundance in compositional counts data, with application to microbiome studies. arXiv preprint arXiv:1904.08937. 2020.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Aitchison</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>The Statistical Analysis of Compositional Data</source>
        <year>1986</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Chapman and Hall</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fernandes</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Macklaim</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>McMurrough</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Edgell</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Gloor</surname>
            <given-names>GB</given-names>
          </name>
        </person-group>
        <article-title>Unifying the analysis of high-throughput sequencing datasets: characterizing rna-seq, 16s rrna gene sequencing and selective growth experiments by compositional data analysis</article-title>
        <source>Microbiome</source>
        <year>2014</year>
        <volume>2</volume>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/2049-2618-2-15</pub-id>
        <pub-id pub-id-type="pmid">24910773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mandal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Van Treuren</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Eggesbø</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>SD</given-names>
          </name>
        </person-group>
        <article-title>Analysis of composition of microbiomes: a novel method for studying microbial composition</article-title>
        <source>Microb Ecol Health Dis</source>
        <year>2015</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>27663</fpage>
        <pub-id pub-id-type="pmid">26028277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>SD</given-names>
          </name>
        </person-group>
        <article-title>Analysis of compositions of microbiomes with bias correction</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>3514</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-17041-7</pub-id>
        <pub-id pub-id-type="pmid">32665548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weiss</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>ZZ</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Amir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lozupone</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zaneveld</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Vázquez-Baeza</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Birmingham</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Normalization and microbial differential abundance strategies depend upon data characteristics</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>27</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0237-y</pub-id>
        <pub-id pub-id-type="pmid">28253908</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hawinkel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mattiello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bijnens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Thas</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A broken promise: microbiome differential abundance methods do not control the false discovery rate</article-title>
        <source>Brief Bioinforma</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>210</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx104</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Faust</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lahti</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gonze</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>De Vos</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Raes</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Metagenomics meets time series analysis: unraveling microbial community dynamics</article-title>
        <source>Curr Opin Microbiol</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>56</fpage>
        <lpage>66</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mib.2015.04.004</pub-id>
        <pub-id pub-id-type="pmid">26005845</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lewis</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Baldassano</surname>
            <given-names>RN</given-names>
          </name>
          <name>
            <surname>Otley</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Griffiths</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inflammation, antibiotics, and diet as environmental stressors of the gut microbiome in pediatric crohn’s disease</article-title>
        <source>Cell Host Microbe</source>
        <year>2015</year>
        <volume>18</volume>
        <issue>4</issue>
        <fpage>489</fpage>
        <lpage>500</lpage>
        <pub-id pub-id-type="doi">10.1016/j.chom.2015.09.008</pub-id>
        <pub-id pub-id-type="pmid">26468751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schubert</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Rogers</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Ring</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Mogle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Petrosino</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Aronoff</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Schloss</surname>
            <given-names>PD</given-names>
          </name>
        </person-group>
        <article-title>Microbiome data distinguish patients with clostridium difficile infection and non-c. difficile-associated diarrhea from healthy controls</article-title>
        <source>MBio</source>
        <year>2014</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>01021</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1128/mBio.01021-14</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgan</surname>
            <given-names>XC</given-names>
          </name>
          <name>
            <surname>Tickle</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Sokol</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Devaney</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Reyes</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>LeLeiko</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Snapper</surname>
            <given-names>SB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dysfunction of the intestinal microbiome in inflammatory bowel disease and treatment</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>79</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-9-r79</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scher</surname>
            <given-names>JU</given-names>
          </name>
          <name>
            <surname>Sczesnak</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Longman</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ubeda</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bielski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rostron</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cerundolo</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Pamer</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Abramson</surname>
            <given-names>SB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expansion of intestinal prevotella copri correlates with enhanced susceptibility to arthritis</article-title>
        <source>elife</source>
        <year>2013</year>
        <volume>2</volume>
        <fpage>01202</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.01202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Charlson</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Custers-Allen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sinha</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hwang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Collman</surname>
            <given-names>RG</given-names>
          </name>
        </person-group>
        <article-title>Disordered microbial communities in the upper respiratory tract of cigarette smokers</article-title>
        <source>PloS ONE</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>12</issue>
        <fpage>15216</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0015216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gonzalez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Navas-Molina</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Kosciolek</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vázquez-Baeza</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ackermann</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>DeReus</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Janssen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Swafford</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Orchanian</surname>
            <given-names>SB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Qiita: rapid, web-enabled microbiome meta-analysis</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>10</issue>
        <fpage>796</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0141-9</pub-id>
        <pub-id pub-id-type="pmid">30275573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lex</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gehlenborg</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Strobelt</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Vuillemot</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pfister</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Upset: visualization of intersecting sets</article-title>
        <source>IEEE Trans Vis Comput Graph</source>
        <year>2014</year>
        <volume>20</volume>
        <issue>12</issue>
        <fpage>1983</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="doi">10.1109/TVCG.2014.2346248</pub-id>
        <pub-id pub-id-type="pmid">26356912</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bates</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Mächler</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bolker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fitting linear mixed-effects models using lme4</article-title>
        <source>J Stat Softw</source>
        <year>2015</year>
        <volume>67</volume>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.18637/jss.v067.i01</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Carpenter</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kenward</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Multiple Imputation and Its Application</source>
        <year>2012</year>
        <publisher-loc>Hoboken</publisher-loc>
        <publisher-name>John Wiley &amp; Sons</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quinn</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Erb</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Crowley</surname>
            <given-names>TM</given-names>
          </name>
        </person-group>
        <article-title>Understanding sequencing data as compositions: an outlook and review</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>16</issue>
        <fpage>2870</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty175</pub-id>
        <pub-id pub-id-type="pmid">29608657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Charlson</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Collman</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Associating microbiome composition with environmental covariates using generalized unifrac distances</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>16</issue>
        <fpage>2106</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts342</pub-id>
        <pub-id pub-id-type="pmid">22711789</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>D-manova: fast distance-based multivariate analysis of variance for large-scale microbiome association studies</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>1</issue>
        <fpage>286</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btab498</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thorsen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brejnrod</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mortensen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rasmussen</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Stokholm</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Al-Soud</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Sørensen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bisgaard</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Waage</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Large-scale benchmarking reveals false discoveries and count transformation sensitivity in 16s rrna gene amplicon data analysis methods used in microbiome studies</article-title>
        <source>Microbiome</source>
        <year>2016</year>
        <volume>4</volume>
        <fpage>62</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-016-0208-8</pub-id>
        <pub-id pub-id-type="pmid">27884206</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y-H</given-names>
          </name>
          <name>
            <surname>Gallins</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A review and tutorial of machine learning methods for microbiome host trait prediction</article-title>
        <source>Front Genet</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>579</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2019.00579</pub-id>
        <pub-id pub-id-type="pmid">31293616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hyde</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Debelius</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Morton</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ackermann</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aksenov</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Behsaz</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Brennan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>American gut: an open platform for citizen science microbiome research</article-title>
        <source>Msystems</source>
        <year>2018</year>
        <volume>3</volume>
        <issue>3</issue>
        <fpage>00031</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1128/mSystems.00031-18</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parzen</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>On estimation of a probability density function and mode</article-title>
        <source>Ann Math Stat</source>
        <year>1962</year>
        <volume>33</volume>
        <issue>3</issue>
        <fpage>1065</fpage>
        <lpage>76</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177704472</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Siegmund</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Strong control, conservative point estimation and simultaneous conservative consistency of false discovery rates: a unified approach</article-title>
        <source>J R Stat Soc Ser B (Stat Methodol)</source>
        <year>2004</year>
        <volume>66</volume>
        <issue>1</issue>
        <fpage>187</fpage>
        <lpage>205</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2004.00439.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hoffmann</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y-Y</given-names>
          </name>
          <name>
            <surname>Keilbaugh</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Bewtra</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knights</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Linking long-term dietary patterns with gut microbial enterotypes</article-title>
        <source>Science</source>
        <year>2011</year>
        <volume>334</volume>
        <issue>6052</issue>
        <fpage>105</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1208344</pub-id>
        <pub-id pub-id-type="pmid">21885731</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Silverman</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Roche</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Naught all zeros in sequence count data are the same</article-title>
        <source>Comput Struct Biotechnol J</source>
        <year>2020</year>
        <volume>18</volume>
        <fpage>2789</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2020.09.014</pub-id>
        <pub-id pub-id-type="pmid">33101615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaul</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mandal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Davidov</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>SD</given-names>
          </name>
        </person-group>
        <article-title>Analysis of microbiome data in the presence of excess zeros</article-title>
        <source>Front Microbiol</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>2114</fpage>
        <pub-id pub-id-type="doi">10.3389/fmicb.2017.02114</pub-id>
        <pub-id pub-id-type="pmid">29163406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtz</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Miraldi</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Littman</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Bonneau</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Sparse and compositionally robust inference of microbial ecological networks</article-title>
        <source>PLoS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>5</issue>
        <fpage>1004226</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004226</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Connolly</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>MacNeil</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Caley</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Knowlton</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Cripps</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hisano</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thibaut</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Bhattacharya</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Benedetti-Cecchi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Brainard</surname>
            <given-names>RE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Commonness and rarity in the marine biosphere</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2014</year>
        <volume>111</volume>
        <issue>23</issue>
        <fpage>8524</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1406664111</pub-id>
        <pub-id pub-id-type="pmid">24912168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Covariate adaptive familywise error rate control for genome-wide association studies</article-title>
        <source>Biometrika</source>
        <year>2021</year>
        <volume>108</volume>
        <issue>4</issue>
        <fpage>915</fpage>
        <lpage>31</lpage>
        <pub-id pub-id-type="doi">10.1093/biomet/asaa098</pub-id>
        <pub-id pub-id-type="pmid">34803516</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Vershynin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>High-dimensional Probability: An Introduction with Applications in Data Science, vol 47</source>
        <year>2018</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wainwright</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <source>High-dimensional Statistics: A Non-asymptotic Viewpoint, vol 48</source>
        <year>2019</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Optimal false discovery rate control for large scale multiple testing with auxiliary information</article-title>
        <source>Annals Stat</source>
        <year>2022</year>
        <volume>50</volume>
        <issue>2</issue>
        <fpage>807</fpage>
        <lpage>857</lpage>
        <pub-id pub-id-type="doi">10.1214/21-AOS2128</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54</label>
      <mixed-citation publication-type="other">Zhou H, He K, Chen J, Zhang X. LinDA: Linear Models for Differential Abundance Analysis of Microbiome Compositional Data. Github. 2022. <ext-link ext-link-type="uri" xlink:href="https://github.com/zhouhj1994/LinDA">https://github.com/zhouhj1994/LinDA</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55</label>
      <mixed-citation publication-type="other">Zhou H, He K, Chen J, Zhang X. LinDA: Linear Models for Differential Abundance Analysis of Microbiome Compositional Data. Zenodo. 2022. 10.5281/zenodo.6326019.2022.</mixed-citation>
    </ref>
  </ref-list>
</back>
