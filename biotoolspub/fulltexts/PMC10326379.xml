<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_CRMETH100498 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEfx1 jpg ?>
<?FILEmmc1 pdf ?>
<?FILEmmc2 xlsx ?>
<?FILEmmc3 xlsx ?>
<?FILEmmc4 xlsx ?>
<?FILEmmc5 pdf ?>
<?FILEsi1 gif ?>
<?FILEsi2 gif ?>
<?FILEsi3 gif ?>
<?FILEsi4 gif ?>
<?FILEsi5 gif ?>
<?FILEsi6 gif ?>
<?FILEsi7 gif ?>
<?FILEsi8 gif ?>
<?FILEsi9 gif ?>
<?FILEsi10 gif ?>
<?FILEsi11 gif ?>
<?FILEsi12 gif ?>
<?FILEsi13 gif ?>
<?FILEsi14 gif ?>
<?FILEsi15 gif ?>
<?FILEsi16 gif ?>
<?FILEsi17 gif ?>
<?FILEsi18 gif ?>
<?FILEsi19 gif ?>
<?FILEsi20 gif ?>
<?FILEsi21 gif ?>
<?FILEsi22 gif ?>
<?FILEsi23 gif ?>
<?FILEsi24 gif ?>
<?FILEsi25 gif ?>
<?FILEsi26 gif ?>
<?FILEsi27 gif ?>
<?FILEsi28 gif ?>
<?FILEsi29 gif ?>
<?FILEsi30 gif ?>
<?FILEsi31 gif ?>
<?FILEsi32 gif ?>
<?FILEsi33 gif ?>
<?FILEsi34 gif ?>
<?FILEsi35 gif ?>
<?FILEsi36 gif ?>
<?FILEsi37 gif ?>
<?FILEsi38 gif ?>
<?FILEsi39 gif ?>
<?FILEsi40 gif ?>
<?FILEsi41 gif ?>
<?FILEsi42 gif ?>
<?FILEsi43 gif ?>
<?FILEsi44 gif ?>
<?FILEsi45 gif ?>
<?FILEsi46 gif ?>
<?FILEsi47 gif ?>
<?FILEsi48 gif ?>
<?FILEsi49 gif ?>
<?FILEsi50 gif ?>
<?FILEsi51 gif ?>
<?FILEsi52 gif ?>
<?FILEsi53 gif ?>
<?FILEsi54 gif ?>
<?FILEsi55 gif ?>
<?FILEsi56 gif ?>
<?FILEsi57 gif ?>
<?FILEsi58 gif ?>
<?FILEsi59 gif ?>
<?FILEsi60 gif ?>
<?FILEsi61 gif ?>
<?FILEsi62 gif ?>
<?FILEsi63 gif ?>
<?FILEsi64 gif ?>
<?FILEsi65 gif ?>
<?FILEsi66 gif ?>
<?FILEsi67 gif ?>
<?FILEsi68 gif ?>
<?FILEsi69 gif ?>
<?FILEsi70 gif ?>
<?FILEsi71 gif ?>
<?FILEsi72 gif ?>
<?FILEsi73 gif ?>
<?FILEsi74 gif ?>
<?FILEsi75 gif ?>
<?FILEsi76 gif ?>
<?FILEsi77 gif ?>
<?FILEsi78 gif ?>
<?FILEsi79 gif ?>
<?FILEsi80 gif ?>
<?FILEsi81 gif ?>
<?FILEsi82 gif ?>
<?FILEsi83 gif ?>
<?FILEsi84 gif ?>
<?FILEsi85 gif ?>
<?FILEsi86 gif ?>
<?FILEsi87 gif ?>
<?FILEsi88 gif ?>
<?FILEsi89 gif ?>
<?FILEsi90 gif ?>
<?FILEsi91 gif ?>
<?FILEsi92 gif ?>
<?FILEsi93 gif ?>
<?FILEsi94 gif ?>
<?FILEsi95 gif ?>
<?FILEsi96 gif ?>
<?FILEsi97 gif ?>
<?FILEsi98 gif ?>
<?FILEsi99 gif ?>
<?FILEsi100 gif ?>
<?FILEsi101 gif ?>
<?FILEsi102 gif ?>
<?FILEsi103 gif ?>
<?FILEsi104 gif ?>
<?FILEsi105 gif ?>
<?FILEsi106 gif ?>
<?FILEsi107 gif ?>
<?FILEsi108 gif ?>
<?FILEsi109 gif ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Cell Rep Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Cell Rep Methods</journal-id>
    <journal-title-group>
      <journal-title>Cell Reports Methods</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2667-2375</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10326379</article-id>
    <article-id pub-id-type="pii">S2667-2375(23)00127-3</article-id>
    <article-id pub-id-type="doi">10.1016/j.crmeth.2023.100498</article-id>
    <article-id pub-id-type="publisher-id">100498</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>hdWGCNA identifies co-expression networks in high-dimensional transcriptomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Morabito</surname>
          <given-names>Samuel</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Reese</surname>
          <given-names>Fairlie</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff4" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Rahimzadeh</surname>
          <given-names>Negin</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Miyoshi</surname>
          <given-names>Emily</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">3</xref>
        <xref rid="aff5" ref-type="aff">5</xref>
      </contrib>
      <contrib contrib-type="author" id="au5">
        <name>
          <surname>Swarup</surname>
          <given-names>Vivek</given-names>
        </name>
        <email>vswarup@uci.edu</email>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff3" ref-type="aff">3</xref>
        <xref rid="aff5" ref-type="aff">5</xref>
        <xref rid="fn1" ref-type="fn">6</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <aff id="aff1"><label>1</label>Mathematical, Computational, and Systems Biology (MCSB) Program, University of California, Irvine, Irvine, CA, USA</aff>
      <aff id="aff2"><label>2</label>Center for Complex Biological Systems (CCBS), University of California, Irvine, Irvine, CA, USA</aff>
      <aff id="aff3"><label>3</label>Institute for Memory Impairments and Neurological Disorders (MIND), University of California, Irvine, Irvine, CA, USA</aff>
      <aff id="aff4"><label>4</label>Department of Developmental and Cell Biology, University of California, Irvine, Irvine, CA, USA</aff>
      <aff id="aff5"><label>5</label>Department of Neurobiology and Behavior, University of California, Irvine, Irvine, CA, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>vswarup@uci.edu</email></corresp>
      <fn id="fn1">
        <label>6</label>
        <p id="ntpara0010">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>26</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>6</issue>
    <elocation-id>100498</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 The Author(s)</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>Biological systems are immensely complex, organized into a multi-scale hierarchy of functional units based on tightly regulated interactions between distinct molecules, cells, organs, and organisms. While experimental methods enable transcriptome-wide measurements across millions of cells, popular bioinformatic tools do not support systems-level analysis. Here we present hdWGCNA, a comprehensive framework for analyzing co-expression networks in high-dimensional transcriptomics data such as single-cell and spatial RNA sequencing (RNA-seq). hdWGCNA provides functions for network inference, gene module identification, gene enrichment analysis, statistical tests, and data visualization. Beyond conventional single-cell RNA-seq, hdWGCNA is capable of performing isoform-level network analysis using long-read single-cell data. We showcase hdWGCNA using data from autism spectrum disorder and Alzheimer’s disease brain samples, identifying disease-relevant co-expression network modules. hdWGCNA is directly compatible with Seurat, a widely used R package for single-cell and spatial transcriptomics analysis, and we demonstrate the scalability of hdWGCNA by analyzing a dataset containing nearly 1 million cells.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">hdWGCNA constructs co-expression networks in high-dimensional transcriptomics data</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">hdWGCNA provides tools for statistics, visualization, and downstream interpretation</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">hdWGCNA is an open-source R package that uses Seurat data structures</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">hdWGCNA in human diseases demonstrates real-world analysis in complex datasets</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="editor-highlights" id="abs0025">
      <title>Motivation</title>
      <p>Single-cell and spatial transcriptomics assays are commonly used to profile the molecular signatures of biological systems, yielding high-dimensional datasets that can be used to model gene regulation across cell types, cell states, and spatial niches. Many statistical tools for high-dimensional transcriptomics data analysis focus on individual features rather than the underlying network structure, ignoring potential interactions between transcripts or genes. Here, we introduce hdWGCNA, a comprehensive methodological framework for the inference, analysis, and interpretation of gene co-expression networks in high-dimensional transcriptomics data. hdWGCNA is implemented as an open-source R package that extends the Seurat ecosystem of data analysis tools.</p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0030">
      <p>Morabito et al. present hdWGCNA, an open-source R package for gene co-expression network analysis in single-cell and spatial transcriptomics data. hdWGCNA builds networks of genes using correlation information in specific cell subpopulations and spatial domains. Applications of hdWGCNA in autism spectrum disorder and Alzheimer’s disease revealed disease-associated gene networks.</p>
    </abstract>
    <kwd-group id="kwrds0110">
      <title>Keywords</title>
      <kwd>single-cell genomics</kwd>
      <kwd>single-cell RNA-seq</kwd>
      <kwd>spatial transcriptomics</kwd>
      <kwd>long-read RNA-seq</kwd>
      <kwd>gene network</kwd>
      <kwd>co-expression network</kwd>
      <kwd>Autism spectrum disorder</kwd>
      <kwd>Alzheimer's disease</kwd>
      <kwd>microglia</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="misc0010">Published: June 12, 2023</p>
  </notes>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p id="p0050">The development and widespread adoption of single-cell and spatial genomics approaches has led to routine generation of high-dimensional datasets in a variety of biological systems. These technologies are frequently used to study developmental stages, evolutionary trajectories, disease states, drug perturbations, and other experimental conditions. Despite the inherent complexity and interconnectedness of biological systems, studies leveraging single-cell and spatial genomics typically analyze individual features (genes, isoforms, proteins, etc.) one by one, greatly oversimplifying the underlying biology. These datasets provide an opportunity for investigating and quantifying the relationships between these features to further contextualize their roles across biological conditions of interest.</p>
    <p id="p0055">Here we developed hdWGCNA, a framework for co-expression network analysis<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref> in single-cell and spatial transcriptomics data. Co-expression networks are based on transformed pairwise correlations of input features, resulting in a quantitative measure of relatedness between genes.<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref><sup>,</sup><xref rid="bib2" ref-type="bibr"><sup>2</sup></xref> Hierarchical clustering on the network structure allows us to uncover functional modules of genes whose expression profiles are tightly intertwined,<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref><sup>,</sup><xref rid="bib4" ref-type="bibr"><sup>4</sup></xref> which typically correspond to specific biological processes and disease states. Considering that unique cell types and cell states have distinct gene expression programs, we designed hdWGCNA to facilitate multi-scale analysis of cellular and spatial hierarchies. hdWGCNA provides a rich suite of functions for data analysis and visualization, providing biological context for co-expression networks by leveraging a variety of biological knowledge databases. To maximize usability among the genomics community, the hdWGCNA R package extends the data structures and functionality of the widely used Seurat package,<xref rid="bib5" ref-type="bibr"><sup>5</sup></xref><sup>,</sup><xref rid="bib6" ref-type="bibr"><sup>6</sup></xref><sup>,</sup><xref rid="bib7" ref-type="bibr"><sup>7</sup></xref> and we developed an extensive documentation website for hdWGCNA demonstrating its use on new datasets. Further, we used hdWGCNA to analyze a single-cell RNA sequencing (scRNA-seq) dataset consisting of 1 million cells, showcasing the scalability of hdWGCNA in large datasets.</p>
    <p id="p0060">In this study, we applied hdWGCNA in a variety of high-dimensional transcriptomics datasets from different technologies and biological conditions. As a common use case, we first performed iterative network analysis of the major cell types in the human prefrontal cortex (PFC), identifying shared and specific network modules in each cell type. We constructed co-expression networks in anterior and posterior mouse brain sections profiled with <inline-formula><mml:math id="M1" altimg="si1.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> Genomics Visium spatial transcriptomics (ST), and found distinct spatial patterns of these gene expression programs. Using long-read scRNA-seq data from the mouse hippocampus,<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> we uncovered splicing isoform co-expression networks in the radial glia lineage involved in cell fate specification. Network analysis of inhibitory neurons from published single-nucleus RNA sequencing (snRNA-seq) in autism spectrum disorder (ASD) donors<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> revealed modules disrupted in ASD containing key genetic risk genes such as <italic>SCN2A</italic>, <italic>TSC1</italic>, and <italic>SHANK2</italic>. We performed consensus co-expression network analysis of microglia from three Alzheimer’s disease (AD) snRNA-seq studies,<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref><sup>,</sup><xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> yielding multiple gene modules corresponding to disease-associated microglia and polygenic risk of AD. Finally, we used hdWGCNA to project gene modules from two bulk RNA-seq studies of AD patients into an snRNA-seq dataset of the AD brain, showing that our approach allows for interrogation of gene modules and networks that have been previously identified.</p>
  </sec>
  <sec id="sec2">
    <title>Results</title>
    <sec id="sec2.1">
      <title>Constructing co-expression networks from high-dimensional transcriptomics data</title>
      <p id="p0065">Here we describe hdWGCNA, a comprehensive framework for constructing and analyzing co-expression networks in high-dimensional transcriptomic data (<xref rid="fig1" ref-type="fig">Figure 1</xref>A). Given a gene expression dataset as input, co-expression network analysis typically consists of the following analysis steps: computing pairwise correlations of input features, weighting correlations with a soft-power threshold <inline-formula><mml:math id="M2" altimg="si2.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, computing the topological overlap between features, and unsupervised clustering via the Dynamic Tree Cut algorithm<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> (<xref rid="mmc1" ref-type="supplementary-material">Figure S1</xref> and <xref rid="sec4" ref-type="sec">STAR Methods</xref>). The sparsity and noise inherent in single-cell data can lead to spurious gene-gene correlations, thereby complicating co-expression network analysis. Additionally, the correlation structure of single-cell or spatial transcriptomic data varies greatly for different subsets (cell types, cell states, anatomical regions). A typical hdWGCNA workflow in scRNA-seq data accounts for these considerations by collapsing highly similar cells into “metacells” to reduce sparsity while retaining cellular heterogeneity and by allowing for a modular design to perform separate network analyses in specified cell populations.<fig id="fig1"><label>Figure 1</label><caption><p>Overview of the hdWGCNA workflow and application in the human prefrontal cortex</p><p>(A) Schematic overview of the standard hdWGCNA workflow on a scRNA-seq dataset. UMAP plot shows 36,671 cells from 11 cognitively normal donors in the Zhou et al. human prefrontal cortex (PFC) dataset. ASC, astrocytes; EX, excitatory neurons; INH, inhibitory neurons; MG, microglia; ODC, oligodendrocytes; OPC, oligodendrocyte progenitor cells.</p><p>(B) Density plot showing the distribution of pairwise Pearson correlations between genes from the single-cell (sc) expression matrix and metacell expression matrices with varying values of the <inline-formula><mml:math id="M3" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>-nearest neighbors parameter <inline-formula><mml:math id="M4" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>(C) Expression matrix density (1, sparsity) for the sc, pseudo-bulk (pb), and metacell matrices with varying values of <inline-formula><mml:math id="M5" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> in each cell type.</p><p>(D) Heatmap of scaled gene expression for the top five hub genes by kME in INH-M6, EX-M2, ODC-M3, OPC-M2, ASC-M18, and MG-M14.</p><p>(E) snRNA-seq UMAP colored by module eigengene (ME) for selected modules as in (D).</p><p>(F) UMAP plot of the ODC co-expression network. Each node represents a single gene, and edges represent co-expression links between genes and module hub genes. Point size is scaled by kME. Nodes are colored by co-expression module assignment. The top two hub genes per module are labeled. Network edges were downsampled for visual clarity.</p><p>(G) snRNA-seq UMAP as in (A) colored by MEs for the 10 ODC co-expression modules as in (F).</p><p>(H) Module preservation analysis of the ODC modules in the Morabito et al.<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> human PFC dataset. The module’s size versus the preservation statistic (<inline-formula><mml:math id="M6" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> preservation) is shown for each module. <inline-formula><mml:math id="M7" altimg="si8.gif"><mml:mrow><mml:mi>Z</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, not preserved; <inline-formula><mml:math id="M8" altimg="si9.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mi>Z</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, moderately preserved; <inline-formula><mml:math id="M9" altimg="si10.gif"><mml:mrow><mml:mi>Z</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, highly preserved.</p></caption><graphic xlink:href="gr1"/></fig></p>
      <p id="p0070">Metacells are defined as small groups of transcriptomically similar cells representing distinctive cell states. There are several approaches to identify metacells from single-cell genomics data.<xref rid="bib13" ref-type="bibr"><sup>13</sup></xref><sup>,</sup><xref rid="bib14" ref-type="bibr"><sup>14</sup></xref><sup>,</sup><xref rid="bib15" ref-type="bibr"><sup>15</sup></xref><sup>,</sup><xref rid="bib16" ref-type="bibr"><sup>16</sup></xref> We leverage a bootstrapped aggregation (bagging) algorithm for constructing metacell transcriptomic profiles from single-cell datasets by applying K-nearest neighbors (KNN) to a dimensionality-reduced representation of the input dataset (<xref rid="sec4" ref-type="sec">STAR Methods</xref>, <xref rid="tbox1" ref-type="boxed-text">Algorithm 1</xref>). This approach can be performed for each biological replicate to ensure that critical information about each sample (age, sex, disease status, etc.) is retained for downstream analysis. We computed gene-gene correlations in the normalized gene expression matrix from the single-cell dataset and metacell expression matrices while varying the number of cells to collapse into a single metacell (the KNN <inline-formula><mml:math id="M10" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> parameter). The distribution of these gene-gene correlations displays a spike at zero for the single-cell expression matrix, with flattened distributions corresponding to more non-zero correlations in the metacell matrices, indicating that metacell expression profiles are less prone to noisy gene-gene correlations compared with the single-cell matrix (<xref rid="fig1" ref-type="fig">Figure 1</xref>B) (STAR Methods). We note that sparsity (defined in <xref rid="fd1" ref-type="disp-formula">Equation 1</xref>) is greatly reduced in the metacell matrices for each cell type compared with the single-cell matrices, with over a 10-fold reduction in some cases (<xref rid="fig1" ref-type="fig">Figure 1</xref>C). We applied hdWGCNA to a dataset of CD34<sup>+</sup> hematopoietic stem and progenitor stem cells<xref rid="bib16" ref-type="bibr"><sup>16</sup></xref> using two additional metacell approaches<xref rid="bib14" ref-type="bibr"><sup>14</sup></xref><sup>,</sup><xref rid="bib16" ref-type="bibr"><sup>16</sup></xref> and found that all approaches were suitable for downstream network analysis (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>). Metacell algorithms strive to retain biologically meaningful signals spanning a spectrum of cell states in a tissue of interest; therefore, it is necessary to carefully apply these approaches to avoid obscuring these cell states. For example, the hdWGCNA metacell algorithm requires a dimensional reduction of the input expression matrix, but these reductions often contain technical artifacts. The choice of dimensionality reduction method and handling of technical artifacts would then influence the effectiveness of metacell construction. Further, the optimal number of cells to merge together to form a single metacell may differ across cell types and tissues, attempting to balance between increasing information content of the aggregated group while avoiding merging of dissimilar cells. Aside from metacell approaches, pseudo-bulk aggregation of all cells in a given population have yielded favorable results in benchmarks of differential gene expression tests,<xref rid="bib17" ref-type="bibr"><sup>17</sup></xref> suggesting that, given a sufficient sample size, pseudo-bulk expression profiles are likely suitable for co-expression network analysis.</p>
      <p id="p0075">While co-expression modules consist of many genes, it is convenient to summarize the expression of the entire module into a single metric. Module eigengenes (MEs), defined as the first principal component of the module’s gene expression matrix (<xref rid="sec4" ref-type="sec">STAR Methods</xref>, <xref rid="tbox2" ref-type="boxed-text">Algorithm 2</xref>), describe the expression patterns of entire co-expression modules. hdWGCNA computes MEs using specific accommodations for high-dimensional data, allowing for batch correction and regression of continuous covariates (<xref rid="sec4" ref-type="sec">STAR Methods</xref>, <xref rid="tbox2" ref-type="boxed-text">Algorithm 2</xref>). Optionally, hdWGCNA can use alternative gene scoring methods such as or UCell<xref rid="bib18" ref-type="bibr"><sup>18</sup></xref> or Seurat’s AddModuleScore function, and we show that these scores are correlated with MEs (<xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref>).</p>
      <p id="p0080">We demonstrate hdWGCNA in single-cell transcriptomic data through an iterative network analysis of six major cell types in the Zhou et al. human PFC snRNA-seq dataset of 11 cognitively normal donors (<xref rid="fig1" ref-type="fig">Figure 1</xref>A).<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> We constructed metacells and performed co-expression network analysis for each major cell type in the human PFC dataset<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> using the standard hdWGCNA workflow, yielding distinct network structures and sets of gene modules (<xref rid="mmc3" ref-type="supplementary-material">Data S2</xref> and <xref rid="mmc4" ref-type="supplementary-material">S3</xref>). Networks were constructed using metacell expression matrices for each cell type separately, but we computed MEs for each module using the entire snRNA-seq dataset, allowing us to interrogate the cell-type specificity of these modules’ expression programs across all cell types. This iterative network analysis revealed 96 co-expression modules across the six major cell types. Through differential module eigengene (DME) analysis, we found shared and distinct module expression patterns across different cell types (<xref rid="mmc3" ref-type="supplementary-material">Data S2</xref>; <xref rid="sec4" ref-type="sec">STAR Methods</xref>), and we highlight specific modules from each cell type (<xref rid="fig1" ref-type="fig">Figures 1</xref>D and 1E). Further, we performed a pairwise gene set overlap analysis of the 96 co-expression modules, and, while we did find that some modules had significant overlaps across the different cell types, the gene sets comprising these modules were overall quite distinct, with a maximum Jaccard index between two modules of 0.297 and a median of 0.005 (<xref rid="sec4" ref-type="sec">STAR Methods</xref> and <xref rid="mmc1" ref-type="supplementary-material">Figure S4</xref>). The expression of module hub genes, which are highly connected members of the co-expression network ranked by eigengene-based connectivity (kME), tend to display cell-type-specific patterns, such as the myelination genes <italic>CNP</italic> and <italic>PLP1</italic> in oligodendrocyte (ODC) module ODC-M3 (<xref rid="fig1" ref-type="fig">Figure 1</xref>D). However, some co-expression modules may correspond to cellular processes common to multiple cell types, in which case the hub genes may be widely expressed. We inspected the MEs of selected cell-type-specific modules and found that the overall expression patterns were similar to that of their constituent hub genes (<xref rid="fig1" ref-type="fig">Figures 1</xref>D and 1E).</p>
      <p id="p0085">We showcase some of the downstream functionalities of hdWGCNA using the ODC co-expression network (<xref rid="fig1" ref-type="fig">Figures 1</xref>F–1H). For network visualization, we used Uniform Manifold Approximation and Projection (UMAP)<xref rid="bib19" ref-type="bibr"><sup>19</sup></xref> to embed the co-expression network topological overlap matrix (TOM) into a two-dimensional manifold, using the topological overlap of each gene with the top hub genes from each module as input features (<xref rid="sec4" ref-type="sec">STAR Methods</xref>; <xref rid="fig1" ref-type="fig">Figure 1</xref>F). We found that eight of the 10 ODC modules were specifically expressed in ODC cells based on their MEs (<xref rid="fig1" ref-type="fig">Figure 1</xref>G; Wilcoxon rank-sum test Bonferroni-adjusted p &lt;0.05). Finally, we performed module preservation analysis<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> to test the reproducibility of these modules in an independent dataset<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> and found that all of the ODC-specific modules were significantly preserved (<inline-formula><mml:math id="M11" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> summary preservation <inline-formula><mml:math id="M12" altimg="si5.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>). In sum, these network analyses in the human PFC dataset shows the core capabilities of the hdWGCNA workflow (<xref rid="mmc1" ref-type="supplementary-material">Figure S1</xref>). Finally, we performed a similar iterative network analysis on a peripheral blood mononuclear cell (PBMC) scRNA-seq dataset of nearly 1M cells, highlighting the scalability of hdWGCNA in large datasets (<xref rid="mmc1" ref-type="supplementary-material">Figure S5</xref>; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>).</p>
    </sec>
    <sec id="sec2.2">
      <title>Runtime, memory usage, and evaluation of hdWGCNA</title>
      <p id="p0090">We measured the runtime and memory usage of hdWGCNA as a function of the number of input cells. Using the 65,415 neuronal cells from the Velmeshev et al.<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> human PFC snRNA-seq dataset (54 samples), we ran hdWGCNA on different-sized subsets ranging from 1,000 to 50,000 cells to test the runtime and memory consumption of the main network analysis steps (<xref rid="fig2" ref-type="fig">Figures 2</xref>A and 2B). We report the memory upper bound in gigabytes measured throughout the duration of each function. The runtime of the MetacellsByGroups function increased steadily with the number of cells, but the memory usage plateaus. This function attempts to construct a target number of metacells within each biological replicate and each cell population, and the algorithm terminates early if this target is reached, thus explaining the plateau in the memory usage graph. While TestSoftPowers generally had a low memory footprint, it was the slowest individual function based on these tests. Importantly, TestSoftPowers can be sped up by using a subset of the data, or by testing fewer soft-power thresholds than the default. The efficiency of ConstructNetwork varies both with the number of input cells and features, where this calculation will slow down as more cells and features are included. ModuleEigengenes uses the implicitly restarted Lanczos bidiagonalization algorithm (IRLBA)<xref rid="bib21" ref-type="bibr"><sup>21</sup></xref> for fast singular value decomposition (SVD) of sparse matrices, and the runtime and memory usage of this function both linearly increase with the number of cells in the dataset. Optionally, ModuleEigengenes can employ the harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> algorithm following SVD, which increases runtime but not memory usage. Further, the efficiency of this function varies with the number of co-expression modules detected and with the number of features in each modules. Finally, ModuleConnectivity computes eigengene-based connectivity as product-moment correlation coefficients between the sparse gene expression matrix and the MEs matrix, which resulted in fast calculations with low memory usage.<fig id="fig2"><label>Figure 2</label><caption><p>Runtime, memory usage, and performance of hdWGCNA</p><p>(A and B) We ran the main co-expression network analysis functions of the hdWGCNA R package on 65,415 neuronal cells in a human brain dataset<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> from 54 samples, and tracked the runtime (A) and memory usage upper bound (B) for different-sized subsets of the data ranging from 1,000 through 50,000 cells.</p><p>(C) Violin plots showing distributions of EGAD<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref> neighbor-voting area under the receiver operating characteristic curve (AUC) scores in each of the cell-type-specific co-expression networks from the human PFC dataset.<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref></p><p>(D) Violin plots showing distributions of multifunctionality AUC scores in each of the cell-type-specific co-expression networks from the human PFC dataset. ASC, astrocytes; EX, excitatory neurons; INH, inhibitory neurons; MG, microglia; ODC, oligodendrocytes; OPC, oligodendrocyte progenitor cells.</p><p>(E) Performance of the XGBoost regularized regression models used to predict gene expression based on the expression of the top 10 module hub genes for all 96 co-expression modules from the Zhou et al.<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> human PFC dataset. Violin plots showing the test set root-mean-square error (RMSE) comparing the predicted expression with observed for each gene, split by each co-expression module. Modules are ordered within each cell type from lowest mean RMSE to highest.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0095">We next sought to evaluate the co-expression networks identified by hdWGCNA using a functional coherence analysis. We used the EGAD neighbor-voting algorithm<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref> to predict known biological pathway associations of genes based on the co-expression network structure using the cell-type-specific co-expression networks from the Zhou et al.<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> human PFC dataset. In principle, we expect that co-expressed genes are involved in similar biological processes, and therefore co-expression network structures should be predictive of biological pathway membership. Briefly, EGAD performs a 3-fold cross-validation classification by occluding the pathway labels of a subset of genes and then attempting to predict the pathway membership of those occluded genes based on their labeled neighbors in the network. We used EGAD to test the functional coherence of our hdWGCNA co-expression networks for a set of Gene Ontology (GO) terms, reporting area under the receiver operating characteristic curve (AUC) value for each term (<xref rid="fig2" ref-type="fig">Figure 2</xref>C). We report a similar level of functional coherence in these co-expression networks to a previous study that evaluated co-expression networks derived from scRNA-seq data with different measures of gene-gene association.<xref rid="bib24" ref-type="bibr"><sup>24</sup></xref> The inhibitory neuron network performed the best for functional coherence with a median neighbor-voting AUC of 0.592, while the lowest-performing network was from the oligodendrocytes with a median AUC of 0.549. We tested whether there was a bias toward genes that were multifunctional based on the frequency that they appeared in the annotated set of GO terms, and we found that multifunctional genes did not bias the co-expression functional coherence results (<xref rid="fig2" ref-type="fig">Figure 2</xref>D).</p>
      <p id="p0100">In principle, genes within the same co-expression modules derived from specific cell types should be functionally related or co-regulated. The expression of module hub genes, which exhibit the highest intramodular connectivity, may be predictive of the expression of other module member genes if the network is well defined and contains meaningful structures. For each of the 96 cell-type PFC co-expression modules, we sought to predict the expression of each gene using the top 10 module hub genes as the input features to a XGBoost<xref rid="bib25" ref-type="bibr"><sup>25</sup></xref> regularized regression model. In this analysis, we performed 5-fold cross-validation, and we report the performance as root-mean-square error (RMSE) of the test set averaged over each fold (<xref rid="fig2" ref-type="fig">Figure 2</xref>E). Overall, we found that module hub gene expression was generally predictive of module member gene expression across all modules in the six cell-type co-expression networks, where the module with the best performance had an average test set RMSE of 0.0159 and the module with the worst performance had an average test set RMSE of 0.209 (<xref rid="fig2" ref-type="fig">Figure 2</xref>E). This analysis and our functional coherence analysis provide support that hdWGCNA co-expression networks and gene modules capture biologically relevant information in specific cell types.</p>
    </sec>
    <sec id="sec2.3">
      <title>Spatial co-expression networks represent regional expression patterns in the mouse brain</title>
      <p id="p0105">ST enables the investigation of biological patterns that might otherwise be hidden in other -omics technologies, such as scRNA-seq or bulk RNA-seq.<xref rid="bib26" ref-type="bibr"><sup>26</sup></xref><sup>,</sup><xref rid="bib27" ref-type="bibr"><sup>27</sup></xref> We used hdWGCNA to identify spatial co-expression network modules in the murine brain using a publicly available Visium transcriptomics dataset from <inline-formula><mml:math id="M13" altimg="si1.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> Genomics (<xref rid="fig3" ref-type="fig">Figure 3</xref>A). This ST dataset consists of one posterior and one anterior slice originating from a sagittal brain section from a single male mouse at 8 weeks of age. Sequencing-based ST approaches such as Visium yield transcriptome-wide gene expression profiles localized to individual “spots” where a single spot likely contains multiple cells, and this dataset is composed of 2,696 spots in the anterior slice and 3,353 spots in the posterior slice. Data sparsity is also inherent to the current generation of these technologies, therefore we propose a metaspot aggregation approach prior to network analysis (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>). Evenly spaced spots throughout the input ST slide are used as principal spots, with at least one other spot in between two principal spots. The transcriptomes of the principal spots and their direct neighbors are aggregated into metaspot expression profiles, containing at most seven ST spots (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>A). Similar to metacells in scRNA-seq, the sparsity of the metaspot expression matrix was reduced compared with the original ST matrix (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>B), and the distribution of gene-gene correlations in the metaspot expression matrix was less concentrated at zero (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>C). hdWGCNA is capable of processing any number of ST samples in the same co-expression network analysis by constructing metaspots separately for each sample.<fig id="fig3"><label>Figure 3</label><caption><p>Spatial co-expression networks represent regional expression patterns in the mouse brain</p><p>(A) Visium spatial transcriptomics (ST) in anterior (left, 2,696 spots) and posterior (right, 3,353 spots) mouse brain sections, colored by Louvain clusters annotated by anatomical regions.</p><p>(B) UMAP plot of the mouse brain ST co-expression network. Each node represents a single gene, and edges represent co-expression links between genes and module hub genes. Point size is scaled by kME. Nodes are colored by co-expression module assignment. The top five hub genes per module are labeled. Network edges were downsampled for visual clarity.</p><p>(C) ST samples colored by MEs for the 12 spatial co-expression modules. Gray color indicates an ME value less than zero.</p></caption><graphic xlink:href="gr3"/></fig></p>
      <p id="p0110">We applied hdWGCNA in the mouse brain Visium dataset, identifying 12 spatial modules (SM1-12; <xref rid="mmc1" ref-type="supplementary-material">Figure S7</xref>; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>), and we embedded the co-expression network in two dimensions using UMAP (<xref rid="fig3" ref-type="fig">Figure 3</xref>B). DME analysis showed that spatial co-expression modules displayed distinct regional expression profiles based on their MEs (<xref rid="fig3" ref-type="fig">Figure 3</xref>C; <xref rid="mmc4" ref-type="supplementary-material">Data S3</xref>), encompassing a wide array of cellular processes such as the myelination module SM1 in the white matter tracts, and synaptic transmission modules SM7, SM9, SM11, and SM12 (<xref rid="mmc1" ref-type="supplementary-material">Figure S7</xref>C; <xref rid="mmc3" ref-type="supplementary-material">Data S2</xref>). For example, DME analysis showed that expression of SM4 was localized to the ventricles and cortical layer 1 near the blood-brain barrier (<xref rid="fig3" ref-type="fig">Figure 3</xref>C). Further, the hub genes of SM4 include hemoglobin subunits (<italic>Hba-a1</italic>, <italic>Hba-a2</italic>, <italic>Hbb-bt</italic>), and we show that SM4 was enriched for biological processes associated with brain vasculature (<xref rid="fig3" ref-type="fig">Figures 3</xref>B and <xref rid="mmc1" ref-type="supplementary-material">S7</xref>C). We compared these gene modules with cluster marker genes from a whole-mouse-brain snRNA-seq dataset<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref> and found significant correspondences, such as the striatum module SM7 and medium spiny neurons (Fisher’s exact test false discovery rate [FDR] &lt;0.05; <xref rid="mmc1" ref-type="supplementary-material">Figure S7</xref>D). Additionally, we performed network analysis on a subset of this dataset containing cortical layers 2–6 (<xref rid="mmc1" ref-type="supplementary-material">Figure S8</xref>), identifying additional fine-grained spatial co-expression modules localized to specific cortical layers (<xref rid="mmc2" ref-type="supplementary-material">Data S1</xref> and <xref rid="mmc3" ref-type="supplementary-material">S2</xref>).</p>
    </sec>
    <sec id="sec2.4">
      <title>Isoform-level co-expression networks reveal cell fate decisions in the radial glia developmental lineage</title>
      <p id="p0115">Different isoforms of the same gene are often involved in distinct biological processes.<xref rid="bib29" ref-type="bibr"><sup>29</sup></xref> Conventional single-cell transcriptomics assays capture information at the gene level, thereby missing much of the biological diversity and regulatory mechanisms that occurs at the isoform level.<xref rid="bib30" ref-type="bibr"><sup>30</sup></xref> Emerging long-read sequencing approaches enable us to profile cellular transcriptomes at isoform resolution,<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref><sup>,</sup><xref rid="bib31" ref-type="bibr"><sup>31</sup></xref><sup>,</sup><xref rid="bib32" ref-type="bibr"><sup>32</sup></xref><sup>,</sup><xref rid="bib33" ref-type="bibr"><sup>33</sup></xref> thus providing new opportunities to model the relationships between isoforms using co-expression network analysis.</p>
      <p id="p0120">We used hdWGCNA to perform isoform co-expression network analysis in radial glia lineage cells from the mouse hippocampus at postnatal day 7 (P7) profiled with single-cell isoform RNA sequencing (ScISOrSeq)<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> (<xref rid="fig4" ref-type="fig">Figure 4</xref>A; <xref rid="sec4" ref-type="sec">STAR Methods</xref>). This dataset contains isoform-level and gene-level expression data from 6,832 nuclei derived from a single mouse hippocampus sample. Radial glia, which share transcriptomic similarities with mature astrocytes, are progenitor cells that give rise to numerous distinct cell fates, including neuronal cells, astrocytes, oligodendrocytes, and ependymal cells.<xref rid="bib34" ref-type="bibr"><sup>34</sup></xref><sup>,</sup><xref rid="bib35" ref-type="bibr"><sup>35</sup></xref> To model this developmental process, we applied Monocle3<xref rid="bib36" ref-type="bibr"><sup>36</sup></xref> pseudotime to 2,190 radial glia lineage cells (<xref rid="fig4" ref-type="fig">Figure 4</xref>B). We identified three trajectories corresponding to distinct cell fates, termed the ependymal (EPD) trajectory, astrocyte (ASC) trajectory, and the neural intermediate progenitor cell (NPC) trajectory.<fig id="fig4"><label>Figure 4</label><caption><p>Isoform co-expression network analysis reveals fate-specific expression programs in the hippocampal radial glia lineage</p><p>(A) UMAP plot of cells from the mouse hippocampus ScISOrSeq dataset.<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> Major cell types are labeled and the cells used for co-expression network analysis are colored. This dataset contains expression information for 96,093 isoforms and 31,053 genes in 6,832 cells from one mouse brain sample. ASC, astrocytes; CPX, choroid plexus epithelial cells; EPD, ependymal cells; EX, excitatory neurons; GRN, granule neurons; INH, inhibitory neurons; MAC, macrophages; NPC, neuronal intermediate progenitor cells; MG, microglia; OPC, oligodendrocyte progenitor cells; RGL, radial glia; VASC, vasculature cells.</p><p>(B) UMAP plot of the radial glia lineage, colored by Monocle 3<xref rid="bib71" ref-type="bibr"><sup>37</sup></xref> pseudotime assignment. Top left, ependymal (EPD) trajectory; top right, astrocyte (ASC) trajectory; bottom left, neuronal intermediate progenitor cell (NPC) trajectory.</p><p>(C) UMAP plot of the radial glia lineage isoform co-expression network. Each node represents a single isoform, and edges represent co-expression links between isoforms and module hub isoforms. Point size is scaled by kMEiso. Nodes are colored by co-expression module assignment. Network edges were downsampled for visual clarity.</p><p>(D) Donut chart showing the percentage of genes with one isoform, with multiple isoforms that are all assigned to the same module, and with multiple isoforms that are spread across more than one module.</p><p>(E) Module eigenisoforms (MEiso) as a function of pseudotime for each co-expression module. For each module, a separate locally estimated scatterplot smoothing (LOESS) regression line is shown for each developmental trajectory.</p><p>(F) Dot plot showing selected GO term enrichment results for each co-expression module.</p><p>(G) Gene models for selected isoforms of <italic>Gfap</italic>, colored by co-expression module assignment.</p><p>(H) Gene models for selected isoforms of <italic>H3f3b</italic>, colored by co-expression module assignment.</p><p>(I) Top: gene models for selected isoforms of <italic>Cd9</italic>, colored by co-expression module assignment. Bottom: Swan<xref rid="bib39" ref-type="bibr"><sup>38</sup></xref> graphical representation of <italic>Cd9</italic> alternative splicing isoforms. Splice sites and transcript start/end sites are represented as nodes; introns and exons are represented as connections between nodes. These two isoforms are distinguished by alternative TSS usage. Gene models from the GENCODE VM23 comprehensive transcript set are shown below transcripts in panels (G)–(I).</p></caption><graphic xlink:href="gr4"/></fig></p>
      <p id="p0125">Isoform co-expression network analysis revealed 11 modules in the radial glia lineage (<xref rid="fig4" ref-type="fig">Figure 4</xref>C; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>). Of the genes retained for network analysis, 61.5% had a single isoform, 18.2% had multiple isoforms that were all assigned to the same module, and 20.4% had multiple isoforms spread across several modules (<xref rid="fig4" ref-type="fig">Figure 4</xref>D). Thus, these network modules capture information about the roles of different isoforms of the same gene in distinct biological processes. We inspected module eigenisoform (MEiso) patterns throughout the developmental lineage, thereby uncovering isoform modules critical for cell fate decisions (<xref rid="fig4" ref-type="fig">Figure 4</xref>E; <xref rid="mmc3" ref-type="supplementary-material">Data S2</xref> and <xref rid="mmc4" ref-type="supplementary-material">S3</xref>). Increased expression of modules RGL-M1 and RGL-M2, which were enriched cilium assembly genes (<xref rid="fig4" ref-type="fig">Figure 4</xref>F), was associated with the transition from a radial glia to an ependymal cell state. A steady expression level of module RGL-M5 (glial development, astrocyte differentiation) was found in the transition from radial glia to astrocytes, while a decreased expression of RGL-M5 led to alternative fates. Four modules (RGL-M3, RGL-M8, RGL-M9, and RGL-M11) displayed an increase in expression in the neuronal trajectory, containing genes associated with cellular processes such as non-canonical <italic>Wnt</italic> signaling, neuronal synaptic plasticity, and RNA splicing (<xref rid="fig4" ref-type="fig">Figure 4</xref>F).</p>
      <p id="p0130">We inspected the isoforms of three selected genes that had hub isoforms in different co-expression modules: <italic>Gfap</italic>, <italic>H3f3b</italic>, and <italic>Cd9</italic> (<xref rid="fig4" ref-type="fig">Figures 4</xref>G–4I). <italic>Gfap</italic> encodes a key intermediate filament protein in astrocytes that is involved in astrocytic reactivity during central nervous system (CNS) injuries or neurodegeneration,<xref rid="bib37" ref-type="bibr"><sup>39</sup></xref> and we found that modules RGL-M4 and RGL-M6 contained hub isoforms of <italic>Gfap</italic> featuring alternative splicing, alternative transcription start site (TSS) usage, and alternative transcription end site (TES) usage (<xref rid="fig4" ref-type="fig">Figure 4</xref>G). Different isoforms of the histone H3.3 subunit gene <italic>H3f3b</italic> were hubs for modules RGL-M1 and RGL-M11, which were associated with ependymal and neuronal cell fates respectively, suggesting that alternative TES usage in <italic>H3f3b</italic> plays a role in regulating epigenetic factors in murine hippocampal development (<xref rid="fig4" ref-type="fig">Figure 4</xref>F). <italic>Cd9</italic> encodes a transmembrane protein and is a known glioblastoma biomarker,<xref rid="bib38" ref-type="bibr"><sup>40</sup></xref> and we found subtle differences in the TSS between hub isoforms in modules RGL-M6 and RGL-M9 that we show as a splicing summary graph<xref rid="bib39" ref-type="bibr"><sup>38</sup></xref> (<xref rid="fig4" ref-type="fig">Figure 4</xref>I), supporting functional changes mediated by small isoform differences.</p>
    </sec>
    <sec id="sec2.5">
      <title>Co-expression network analysis of inhibitory neurons in ASD</title>
      <p id="p0135">Co-expression networks can be interrogated to further understand the molecular phenotypes of complex polygenic diseases in primary human tissue samples. We applied hdWGCNA to 20,249 inhibitory neurons (INHs) from an snRNA-seq dataset of the human PFC in 22 ASD patients, 24 age-matched controls, and eight epilepsy patients<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> (<xref rid="fig5" ref-type="fig">Figures 5</xref>A and <xref rid="mmc1" ref-type="supplementary-material">S10</xref>; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>). The INH network contained 14 modules, and we show hub genes that have a known association with ASD in the SFARI database on the co-expression UMAP (<xref rid="fig5" ref-type="fig">Figure 5</xref>B). The MEs showed that some modules were primarily confined to a single INH cluster (INH-M3, INH-M1) while others were spread across multiple neuronal groups (<xref rid="fig5" ref-type="fig">Figure 5</xref>C). Furthermore, DME analysis revealed significant differences between MEs in ASD and control samples for all modules except INH-M4 in at least one INH subpopulation (<xref rid="fig5" ref-type="fig">Figure 5</xref>D; <xref rid="mmc4" ref-type="supplementary-material">Data S3</xref>; Wilcoxon rank-sum test Bonferroni-adjusted p &lt;0.05). However, by focusing on the DME results with an absolute average <inline-formula><mml:math id="M14" altimg="si6.gif"><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (fold change) <inline-formula><mml:math id="M15" altimg="si7.gif"><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>, we note that many of the largest differences were found in the <italic>SST</italic><sup>+</sup> inhibitory neuron clusters. Furthermore, three co-expression modules (INH-M11, INH-M13, and INH-M3) were significantly enriched in ASD-associated genes from the SFARI database and the latest genome-wide association study (GWAS) of ASD<xref rid="bib40" ref-type="bibr"><sup>41</sup></xref> (<xref rid="fig5" ref-type="fig">Figure 5</xref>E), but we note that all of these modules contained several ASD-associated SFARI genes.<fig id="fig5"><label>Figure 5</label><caption><p>Co-expression network analysis of inhibitory neurons in Autism spectrum disorder</p><p>(A) UMAP plot of 121,451 nuclei from the cortex of 22 ASD donors, 24 controls, and eight epilepsy donors profiled with snRNA-seq. Inhibitory neuron subtypes are highlighted. ASC, astrocytes; EX, excitatory neurons; INH, inhibitory neurons; MG, microglia; ODC, oligodendrocytes; OPC, oligodendrocyte progenitor cells.</p><p>(B) Gene co-expression network derived from inhibitory neurons, represented as a two-dimensional UMAP embedding of the TOM. Nodes represent genes, colored by module assignment. Module hub genes with prior evidence of ASD association from SFARI are labeled. Edges represent co-expression relationships between genes and module hub genes. Network edges were downsampled for visual clarity.</p><p>(C) Gene overlap analysis comparing ASD-associated genes from SFARI and INH co-expression modules, using Fisher’s exact test. <inline-formula><mml:math id="M16" altimg="si11.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> indicates that the overlap was not significant (FDR <inline-formula><mml:math id="M17" altimg="si12.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>).</p><p>(D) snRNA-seq UMAP plots as in (A) colored by MEs for INH co-expression modules.</p><p>(E) Violin plots showing MEs in each INH cluster. Two-sided Wilcoxon test was used to compare ASD versus control samples. Nuclei from epilepsy donors were excluded in this comparison. Not significant (ns), p &gt; 0.05; <inline-formula><mml:math id="M18" altimg="si13.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>p<inline-formula><mml:math id="M19" altimg="si14.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>; ∗∗p<inline-formula><mml:math id="M20" altimg="si15.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>; ∗∗∗p<inline-formula><mml:math id="M21" altimg="si16.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>; ∗∗∗∗p<inline-formula><mml:math id="M22" altimg="si17.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>(F) Selected GO enrichment results for each co-expression module.</p></caption><graphic xlink:href="gr5"/></fig></p>
      <p id="p0140">INH-M11 was enriched for genes associated with synaptic transmission, ion transport, glutamate receptor signaling, and nervous system development (<xref rid="fig5" ref-type="fig">Figure 5</xref>F; <xref rid="mmc3" ref-type="supplementary-material">Data S2</xref>), and this module was downregulated in ASD for five of the six INH subtypes (<xref rid="fig5" ref-type="fig">Figure 5</xref>D). Similarly, INH-M13 was associated with RNA processing (<xref rid="fig5" ref-type="fig">Figure 5</xref>F) and was downregulated in ASD in all INH subtypes except <italic>PVALB</italic>+ neurons (<xref rid="fig5" ref-type="fig">Figure 5</xref>D). One of the INH-M13 hub genes is <italic>CHD2</italic>, whose <italic>de novo</italic> variants have been identified in individuals with ASD.<xref rid="bib41" ref-type="bibr"><sup>42</sup></xref><sup>,</sup><xref rid="bib42" ref-type="bibr"><sup>43</sup></xref> CHD2 is part of the CHD family of chromatin-modifying proteins and can alter gene expression by modification of chromatin structure. Similarly, rare loss-of-function mutations have been reported in the <italic>SCN2A</italic> gene, a hub gene of the INH-M11 module.<xref rid="bib43" ref-type="bibr"><sup>44</sup></xref> We also find enrichment of several ASD-associated genes such as <italic>TSC1</italic> (INH-M8), <italic>SMARCA4</italic> (INH-M8), <italic>SHANK2</italic> (INH-M4), and <italic>CPEB4</italic> (INH-M1), highlighting that these modules are functional and provide new insights into the role of inhibitory neurons in ASD. Finally, we tested for the preservation of these modules in 19,425 inhibitory neurons from an snRNA-seq dataset of the PFC from donors with major depressive disorder (MDD) and controls<xref rid="bib44" ref-type="bibr"><sup>45</sup></xref> (34 samples), and we found substantial evidence of preservation across all modules except INH-M1 (<xref rid="mmc1" ref-type="supplementary-material">Figures S10</xref>C–S10E).</p>
    </sec>
    <sec id="sec2.6">
      <title>Consensus network analysis of microglia in AD</title>
      <p id="p0145">Microglia, the resident immune cells of the brain, are implicated in the pathology and genetic risk of several CNS diseases, including AD.<xref rid="bib45" ref-type="bibr"><sup>46</sup></xref><sup>,</sup><xref rid="bib46" ref-type="bibr"><sup>47</sup></xref><sup>,</sup><xref rid="bib47" ref-type="bibr"><sup>48</sup></xref><sup>,</sup><xref rid="bib48" ref-type="bibr"><sup>49</sup></xref> Transcriptomic and epigenomic studies in human tissue and AD mouse models have identified multiple cell states of microglia, representing a spectrum between homeostatic and disease-associated microglia (DAMs).<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref><sup>,</sup><xref rid="bib49" ref-type="bibr"><sup>50</sup></xref><sup>,</sup><xref rid="bib50" ref-type="bibr"><sup>51</sup></xref> Our previous study defined a set of transcription factors, genes, and <italic>cis</italic>-regulatory elements involved in the shift between homeostatic and DAM cell states in human AD, identifying shared and distinct signatures compared with the DAM signature from 5xFAD mice.<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> Here we sought to expand on previous work by providing a systems-level analysis of gene expression throughout the spectrum of microglia cell states.</p>
      <p id="p0150">We modeled the cell-state continuum between homeostatic and DAM-like microglia by employing a pseudotime analysis of microglia from three human AD snRNA-seq datasets<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref><sup>,</sup><xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> (<xref rid="fig6" ref-type="fig">Figures 6</xref>A, 6B, and <xref rid="mmc1" ref-type="supplementary-material">S11</xref>). Next, we performed consensus co-expression network analysis using microglia integrated from three human AD snRNA-seq datasets,<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref><sup>,</sup><xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> identifying four consensus modules (<xref rid="fig6" ref-type="fig">Figure 6</xref>C; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>). Consensus network analysis is an approach that performs network analysis separately for each dataset, followed by a procedure to retain structures common across the individual networks, and thus it is well suited for analyzing microglia co-expression from these different sources (STAR Methods).<fig id="fig6"><label>Figure 6</label><caption><p>Consensus network analysis of microglia in AD</p><p>(A) Left: table showing the number of samples and the number of microglia nuclei from published AD snRNA-seq datasets used for co-expression network analysis. Right: integrated UMAP plot of nuclei from three snRNA-seq datasets.</p><p>(B) UMAP plot of microglia, colored by Monocle 3<xref rid="bib71" ref-type="bibr"><sup>37</sup></xref> pseudotime assignment.</p><p>(C) UMAP plot of the microglia co-expression network. Each node represents a single gene, and edges represent co-expression links between genes and module hub genes. Point size is scaled by kME. Nodes are colored by co-expression module assignment. The top 10 hub genes per module are labeled, as well as additional genes of interest. Network edges were downsampled for visual clarity.</p><p>(D) Selected Gene Ontology (GO) terms enriched in co-expression modules. Bar plots show the log-scaled enrichment of each term.</p><p>(E) MEs as a function of pseudotime; points are averaged MEs in 50 pseudotime bins of equal size. Line represents LOESS regression with a 95% confidence interval.</p><p>(F) Microglia UMAP colored by ME.</p><p>(G) Differential module eigengene (DME) results in 10 pseudotime bins of equal size. For each pseudotime bin, we performed DME analysis between cells from AD (positive fold change) and control samples. <inline-formula><mml:math id="M23" altimg="si11.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> symbol indicates that the test did not reach significance (Wilcoxon rank-sum test Bonferroni-adjusted p value &gt; 0.05).</p><p>(H) Top: microglia UMAP colored by AD single-cell disease relevance score (scDRS)<xref rid="bib54" ref-type="bibr"><sup>52</sup></xref><inline-formula><mml:math id="M24" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> score. Bottom: scDRS <inline-formula><mml:math id="M25" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> score as a function of pseudotime, points are averaged scDRS <inline-formula><mml:math id="M26" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> scores in 50 pseudotime bins of equal size. Line represents linear regression with a 95% confidence interval.</p><p>(I) Heatmap of Pearson correlations of MEs and scDRS <inline-formula><mml:math id="M27" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> scores, split by cells from AD and control samples.</p><p>(J) Abbreviations denote the following brain regions: SFG, superior frontal gyrus; EC, entorhinal cortex; OC, occipital cortex; OTC, occipitotemporal cortex. ∗∗Highly preserved (<italic>Z</italic><inline-formula><mml:math id="M28" altimg="si18.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>); <inline-formula><mml:math id="M29" altimg="si13.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>moderately preserved (<inline-formula><mml:math id="M30" altimg="si19.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo></mml:mrow></mml:math></inline-formula><italic>Z</italic><inline-formula><mml:math id="M31" altimg="si5.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>); x, not preserved (<italic>Z</italic><inline-formula><mml:math id="M32" altimg="si20.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>).</p></caption><graphic xlink:href="gr6"/></fig></p>
      <p id="p0155">Classical markers of homeostatic microglia, such as <italic>CSF1R</italic>, <italic>CX3CR1</italic>, and <italic>P2RY12</italic>, were members of MG-M2, while known DAM genes, including <italic>APOE</italic>, <italic>TYROBP</italic>, and <italic>B2M</italic>, were members of MG-M1. GO term enrichment analysis associated MG-M2 with homeostatic microglia functions such as cell migration, synapse organization, and response to colony-stimulating factor, contrasting disease-related processes enriched in MG-M1 including amyloid fibril formation, microglial activation, maintenance of blood-brain barrier, and cytokine production (<xref rid="fig6" ref-type="fig">Figure 6</xref>D; <xref rid="mmc3" ref-type="supplementary-material">Data S2</xref>). Together, this suggests that MG-M1 comprises the gene network underlying DAM activation in AD, while MG-M2 represents the network of homeostatic microglia genes. The MEs for MG-M1 and MG-M2 display opposing patterns throughout the microglia pseudotime trajectory, contextualizing this trajectory as the transcriptional shift from homeostatic microglia (start) to a DAM-like cell state (end) (<xref rid="fig6" ref-type="fig">Figures 6</xref>E and 6F). Furthermore, DME analysis revealed significant changes in these modules between AD and control brains in evenly spaced windows throughout the microglia trajectory (<xref rid="fig6" ref-type="fig">Figure 6</xref>G; Wilcoxon rank-sum test Bonferroni-adjusted p &lt;0.05; <xref rid="mmc4" ref-type="supplementary-material">Data S3</xref>). Co-expression networks behave as functional biological units; therefore, we reason that the hub genes and other members of MG-M1 represent candidates for an expanded set of human DAM genes including <italic>ACTB</italic>, <italic>TPT1</italic>, and <italic>EEF1A1</italic>.</p>
      <p id="p0160">Aside from modules MG-M1 and MG-M2, which contained well-known microglia gene signatures, we also identified modules MG-M3 and MG-M4 containing genes associated with key microglial processes such as axon guidance, phagocytosis, and myeloid cell differentiation (<xref rid="fig6" ref-type="fig">Figures 6</xref>C and 6D). <italic>CD163</italic>, a hub gene of MG-M4, is known to be involved in the breakdown of the blood-brain barrier.<xref rid="bib51" ref-type="bibr"><sup>53</sup></xref><sup>,</sup><xref rid="bib52" ref-type="bibr"><sup>54</sup></xref> The trajectory of MG-M4, containing <italic>CD163</italic> as a hub gene, was consistent with that of DAM-like module MG-M1, and was enriched for processes including phagocytosis, myeloid cell differentiation, and neutrophil activation (<xref rid="fig6" ref-type="fig">Figure 6</xref>D); therefore, it is possible that MG-M4 represents an alternative microglial activation module.<xref rid="bib53" ref-type="bibr"><sup>55</sup></xref> We performed single-cell polygenic risk enrichment for AD risk in the microglia trajectory,<xref rid="bib45" ref-type="bibr"><sup>46</sup></xref><sup>,</sup><xref rid="bib54" ref-type="bibr"><sup>52</sup></xref> and identified a significant increase throughout the trajectory, revealing an enrichment of AD genetic risk single-nucleotide polymorphisms (SNPs) in DAMs (<xref rid="fig6" ref-type="fig">Figure 6</xref>H; <xref rid="sec4" ref-type="sec">STAR Methods</xref>; <xref rid="mmc4" ref-type="supplementary-material">Data S3</xref>). We show that expression of these modules was significantly correlated with AD genetic risk (Pearson correlation p &lt;0.05), with the strongest correlation in alternative activation module MG-M4 (<xref rid="fig6" ref-type="fig">Figure 6</xref>I).</p>
      <p id="p0165">To ensure that these microglial modules were reproducible across other datasets and in mouse models of AD, we performed module preservation analysis<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> (<xref rid="sec4" ref-type="sec">STAR Methods</xref>; <xref rid="fig6" ref-type="fig">Figure 6</xref>J). We projected the microglial consensus modules into a dataset of the PFC in aged human samples,<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref> the superior frontal gyrus (SFG) and entorhinal cortex (EC) in AD samples,<xref rid="bib56" ref-type="bibr"><sup>57</sup></xref> the occipital cortex (OC) and the occipitotemporal cortex (OTC) in human AD samples,<xref rid="bib57" ref-type="bibr"><sup>58</sup></xref> the PFC from 5xFAD mice,<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> and whole-brain samples from 5xFAD mice<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref> (<xref rid="fig6" ref-type="fig">Figure 6</xref>H). Additionally, we projected these modules into an snATAC-seq dataset of the PFC in human AD,<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> using gene activity<xref rid="bib58" ref-type="bibr"><sup>59</sup></xref> as a proxy for gene expression from chromatin accessibility data. These module preservation tests showed the microglia consensus modules were broadly preserved and reproducible across brain regions and in mouse models of AD, providing further support that this network is relevant in AD biology and microglial activation.</p>
    </sec>
    <sec id="sec2.7">
      <title>Projecting network modules from bulk RNA-seq cohorts into relevant single-cell datasets</title>
      <p id="p0170">hdWGCNA allows for interrogating co-expression modules inferred from a given reference dataset in a query dataset. Modules can be projected across datasets by computing MEs in the query dataset, and preservation of the network structure can be assessed via statistical testing.<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> For example, modules can be projected between different species to link transcriptomic changes between mouse models and human disease patients, or modules can be projected across data modalities from single-cell to spatial transcriptomics to provide regional context to cellular niches.</p>
      <p id="p0175">To date, it remains cost-prohibitive for most researchers to perform high-dimensional -omics studies of large patient cohorts, but there are numerous large-scale disease-relevant bulk RNA-seq datasets containing thousands of samples from consortia such as the Encyclopedia of DNA Elements (ENCODE),<xref rid="bib59" ref-type="bibr"><sup>60</sup></xref> the Genotype-Tissue Expression (GTEx) project,<xref rid="bib60" ref-type="bibr"><sup>61</sup></xref> and The Cancer Genome Atlas (TCGA).<xref rid="bib61" ref-type="bibr"><sup>62</sup></xref> By projecting co-expression modules derived from bulk RNA-seq patient cohorts into single-cell datasets, we can layer disease-related information onto the single-cell dataset and attribute cell-state-specific expression patterns to the bulk RNA-seq data. We demonstrate projecting modules in this manner using co-expression modules from two bulk RNA-seq studies of AD<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref><sup>,</sup><xref rid="bib62" ref-type="bibr"><sup>63</sup></xref> as the references and a human AD snRNA-seq dataset<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> (57,950 nuclei from AD 11 samples and seven control samples of the PFC) as the query. These studies both used AD samples and controls from the same patient cohorts (Religious Orders Study and Memory and Aging Project, Mayo Clinic, Mount Sinai School of Medicine),<xref rid="bib63" ref-type="bibr"><sup>64</sup></xref><sup>,</sup><xref rid="bib64" ref-type="bibr"><sup>65</sup></xref><sup>,</sup><xref rid="bib65" ref-type="bibr"><sup>66</sup></xref> but they took unique approaches for co-expression network analysis. The AMP-AD study from Wan et al.<xref rid="bib62" ref-type="bibr"><sup>63</sup></xref> performed network analysis separately from each brain region, while, in our previous study,<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref> we performed consensus network analysis across the different brain regions. We projected these modules into a snRNA-seq dataset of AD and control samples from the PFC (<xref rid="fig7" ref-type="fig">Figure 7</xref>A), and we found distinct cell-type-specific expression patterns based on their MEs (<xref rid="fig7" ref-type="fig">Figures 7</xref>B and 7C). This analysis demonstrates hdWGCNA’s ability to transfer co-expression information across datasets to uncover otherwise unseen biological insights.<fig id="fig7"><label>Figure 7</label><caption><p>Projecting bulk RNA-seq co-expression modules into a single-cell dataset</p><p>(A) UMAP plot of 57,950 nuclei from an snRNA-seq dataset of the human PFC from AD (N = 11) and control (N = 7) PFC samples.<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> Cells are colored by major cell type assignment.</p><p>(B) Multi-region consensus co-expression modules from Morabito et al.<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref> bulk RNA-seq analysis projected into the snRNA-seq dataset as in (A).</p><p>(C) Co-expression modules from the AMP-AD bulk RNA-seq dataset<xref rid="bib62" ref-type="bibr"><sup>63</sup></xref> projected into the snRNA-seq dataset as in (A). CBE, cerebellum; DLPFC, dorsolateral PFC; FP, frontal pole; IFG, inferior frontal gyrus; PHG, parahippocampal gyrus; STG, superior temporal gyrus; TCX, temporal cortex; ASC, astrocytes; EX, excitatory neurons; INH, inhibitory neurons; MG, microglia; ODC, oligodendrocytes; OPC, oligodendrocyte progenitor cells; VASC, vascular cells.</p></caption><graphic xlink:href="gr7"/></fig></p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Discussion</title>
    <p id="p0180">Classical bioinformatic approaches for transcriptomics analysis such as differential gene expression are useful for finding individual genes that are altered in a particular disease or condition of interest, but they do not provide information about the broader context of these genes in specific pathways or regulatory regimes. For example, biological processes such as development or regeneration require coordination of distinct sets of genes in certain cell types with spatial specificity. Therefore, to understand these complex processes, we must look beyond individual genes. We developed hdWGCNA to provide a succinct methodology for investigating systems-level changes in the transcriptome in single-cell or ST datasets. We designed hdWGCNA to be highly modular, allowing for multi-scale analyses of different cellular or spatial hierarchies in a technology-agnostic manner.</p>
    <p id="p0185">In this study, we demonstrated that hdWGCNA is compatible with single-cell and ST datasets and can be easily adapted for novel transcriptomics approaches such as ScISOrSeq. Co-expression networks have been successful for analyzing bulk proteomics datasets in human disease samples,<xref rid="bib66" ref-type="bibr"><sup>67</sup></xref><sup>,</sup><xref rid="bib67" ref-type="bibr"><sup>68</sup></xref> and we expect that hdWGCNA could be swiftly adapted for single-cell and spatial proteomics datasets as the technology matures and becomes more widely available.<xref rid="bib68" ref-type="bibr"><sup>69</sup></xref> hdWGCNA includes built-in functions to leverage external biological knowledge sources to provide insight for co-expression networks, for example by comparing gene modules with functional gene sets such as disease-associated genes from GWAS expression quantitative trait loci (eQTLs), or transcription factor target genes. Unlike other network analysis pipelines such as single-cell regulatory network inference and clustering (SCENIC)<xref rid="bib69" ref-type="bibr"><sup>70</sup></xref> or CellChat,<xref rid="bib70" ref-type="bibr"><sup>71</sup></xref> hdWGCNA is a purely unsupervised approach and does not require prior knowledge or databases in the inference procedure. The co-expression information computed by hdWGCNA can be easily retrieved from the Seurat object to facilitate custom downstream analyses beyond the hdWGCNA package. hdWGCNA allows for comparisons between experimental groups via DME testing and module preservation analysis, which allowed us to identity inhibitory neuron modules that were dysregulated in ASD and enriched for ASD genetic risk genes, and microglial modules that were dysregulated in AD and enriched for DAM genes. Our network analyses of the ASD and AD datasets shows that hdWGCNA is capable of uncovering expanded disease-relevant gene sets via the interaction partners of known disease-associated genes such as the ASD SFARI genes or the AD DAM genes. We showed that the co-expression networks inferred by hdWGCNA were highly reproducible in unseen datasets, indicating that this is a robust methodology that reflects the underlying biology of the system of interest rather than picking up on technical artifacts. Further, hdWGCNA sheds new light on previously identified co-expression networks and gene modules by allowing modules to be projected from a reference dataset to a query dataset. The hdWGCNA R package directly extends the familiar Seurat pipeline and the SeuratObject data structure, enabling researchers to rapidly incorporate network analysis into their own workflows, going beyond cell clustering and differential gene expression analysis toward systems-level insights.</p>
    <sec id="sec3.1">
      <title>Limitations of the study</title>
      <p id="p0190">Transcriptomic measurements of single cells are generally noisy, imposing challenges and limitations in the analysis of these datasets. Technical noise may arise from dropout events or from various steps in the experimental protocols, potentially making downstream data analysis and interpretation more difficult. hdWGCNA explicitly tries to handle the issues of technical dropouts and data sparsity by constructing networks in metacell or metaspot transcriptomic profiles rather than directly using the single-cell data. Furthermore, we show that module preservation statistical testing can assess the reproducibility of a co-expression network in external validation datasets, giving additional confidence in the results from hdWGCNA.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>STAR★Methods</title>
    <sec id="sec4.1">
      <title>Key resources table</title>
      <p id="p0195">
        <table-wrap position="float" id="undtbl1">
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th>REAGENT or RESOURCE</th>
                <th>SOURCE</th>
                <th>IDENTIFIER</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="3">
                  <bold>Deposited data</bold>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease snRNA-seq 2019</td>
                <td>Mathys et al., 2019<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref></td>
                <td>syn18485175</td>
              </tr>
              <tr>
                <td>Human Autism spectrum disorder snRNA-seq</td>
                <td>Velmeshev et al., 2019<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref></td>
                <td>PRJNA434002</td>
              </tr>
              <tr>
                <td>Human aging cortex snRNA-seq</td>
                <td>authors</td>
                <td>See Morabito et al., 2020<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref></td>
              </tr>
              <tr>
                <td>Human Major depressive disorder snRNA-seq</td>
                <td>Nagy et al., 2020<xref rid="bib44" ref-type="bibr"><sup>45</sup></xref></td>
                <td>GSE144136</td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease snRNA-seq 2020</td>
                <td>Zhou et al., 2020<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref></td>
                <td>syn21670836</td>
              </tr>
              <tr>
                <td>Mouse 5XFAD snRNA-seq 2020</td>
                <td>Zhou et al., 2020<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref></td>
                <td>syn21670836</td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease Occipital Cortex snRNA-seq 2021</td>
                <td>Gerrits et al., 2021<xref rid="bib57" ref-type="bibr"><sup>58</sup></xref></td>
                <td>GSE148822</td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease Occipitotemporal Cortex snRNA-seq 2021</td>
                <td>Gerrits et al., 2021<xref rid="bib57" ref-type="bibr"><sup>58</sup></xref></td>
                <td>GSE148822</td>
              </tr>
              <tr>
                <td>Mouse hippocampus ScISOrSeq</td>
                <td>authors</td>
                <td>See Joglekar et al., 2021<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref></td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease Entorhinal Cortex snRNA-seq 2021</td>
                <td>Leng et al., 2021<xref rid="bib56" ref-type="bibr"><sup>57</sup></xref></td>
                <td>GSE147528</td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease Superior Frontal Gyrus snRNA-seq 2021</td>
                <td>Leng et al., 2021<xref rid="bib56" ref-type="bibr"><sup>57</sup></xref></td>
                <td>GSE147528</td>
              </tr>
              <tr>
                <td>Mouse 5XFAD snRNA-seq 2022</td>
                <td>authors</td>
                <td>See Kiani-Shabestari et al., 2022<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref></td>
              </tr>
              <tr>
                <td>10X Genomics mouse brain spatial transcriptomics</td>
                <td>SeuratData R package</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/satijalab/seurat-data" id="intref0020">https://github.com/satijalab/seurat-data</ext-link>
                </td>
              </tr>
              <tr>
                <td>Parse Biosciences PBMCs in Type 1 Diabetes</td>
                <td>Parse Biosciences</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://resources.parsebiosciences.com/dataset-wt-mega-one-million-pbmc-type-1-diabetes" id="intref0025">https://resources.parsebiosciences.com/dataset-wt-mega-one-million-pbmc-type-1-diabetes</ext-link>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <bold>Software and algorithms</bold>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td>hdWGCNA R package</td>
                <td>this paper</td>
                <td>
                  <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.6835227" id="intref0030">https://doi.org/10.5281/zenodo.6835227</ext-link>
                </td>
              </tr>
              <tr>
                <td>data analysis scripts</td>
                <td>this paper</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7851151" id="intref0035">https://doi.org/10.5281/zenodo.7851151</ext-link>
                </td>
              </tr>
              <tr>
                <td>WGCNA</td>
                <td>CRAN</td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_003302" id="intref0040">SCR_003302</ext-link></td>
              </tr>
              <tr>
                <td>Kallisto Bustools</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/pachterlab/kallistobustools" id="intref0045">https://github.com/pachterlab/kallistobustools</ext-link>
                </td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_018213" id="intref0050">SCR_018213</ext-link></td>
              </tr>
              <tr>
                <td>Scanpy</td>
                <td>Wolf et al., 2018<xref rid="bib78" ref-type="bibr"><sup>72</sup></xref></td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_018139" id="intref0055">SCR_018139</ext-link></td>
              </tr>
              <tr>
                <td>Seurat</td>
                <td>CRAN</td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_016341" id="intref0060">SCR_016341</ext-link></td>
              </tr>
              <tr>
                <td>Harmony</td>
                <td>CRAN</td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_022206" id="intref0065">SCR_022206</ext-link></td>
              </tr>
              <tr>
                <td>Scrublet</td>
                <td>Wolock et al., 2019<xref rid="bib81" ref-type="bibr"><sup>73</sup></xref></td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_018098" id="intref0070">SCR_018098</ext-link></td>
              </tr>
              <tr>
                <td>Cellbender</td>
                <td>Fleming et al., 2019<xref rid="bib80" ref-type="bibr"><sup>74</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/broadinstitute/CellBender" id="intref0075">https://github.com/broadinstitute/CellBender</ext-link>
                </td>
              </tr>
              <tr>
                <td>SEACells</td>
                <td>Persad et al., 2023<xref rid="bib16" ref-type="bibr"><sup>16</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/dpeerlab/SEACells" id="intref0080">https://github.com/dpeerlab/SEACells</ext-link>
                </td>
              </tr>
              <tr>
                <td>Metacell-2</td>
                <td>Ben-Kiki et al., 2022<xref rid="bib14" ref-type="bibr"><sup>14</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/tanaylab/metacells" id="intref0085">https://github.com/tanaylab/metacells</ext-link>
                </td>
              </tr>
              <tr>
                <td>EGAD</td>
                <td>Ballouz et al., 2016<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/sarbal/EGAD" id="intref0090">https://github.com/sarbal/EGAD</ext-link>
                </td>
              </tr>
              <tr>
                <td>Enrichr</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://maayanlab.cloud/Enrichr/" id="intref0095">https://maayanlab.cloud/Enrichr/</ext-link>
                </td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_001575" id="intref0100">SCR_001575</ext-link></td>
              </tr>
              <tr>
                <td>XGBoost</td>
                <td>Chen and Guestrin, 2016<xref rid="bib25" ref-type="bibr"><sup>25</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://xgboost.readthedocs.io/en/stable/" id="intref0105">https://xgboost.readthedocs.io/en/stable/</ext-link>
                </td>
              </tr>
              <tr>
                <td>Monocle3</td>
                <td>Cao et al., 2019<xref rid="bib36" ref-type="bibr"><sup>36</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://cole-trapnell-lab.github.io/monocle3/" id="intref0110">https://cole-trapnell-lab.github.io/monocle3/</ext-link>
                </td>
              </tr>
              <tr>
                <td>scDRS</td>
                <td>Zhang et al., 2022<xref rid="bib54" ref-type="bibr"><sup>52</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/martinjzhang/scDRS" id="intref0115">https://github.com/martinjzhang/scDRS</ext-link>
                </td>
              </tr>
              <tr>
                <td>SeuratData</td>
                <td>Satija Lab</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/satijalab/seurat-data" id="intref0120">https://github.com/satijalab/seurat-data</ext-link>
                </td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
    </sec>
    <sec id="sec4.2">
      <title>Resource availability</title>
      <sec id="sec4.2.1">
        <title>Lead contact</title>
        <p id="p0200">Requests for further information should be directed to the lead contact, Vivek Swarup (<ext-link ext-link-type="uri" xlink:href="mailto:vswarup@uci.edu" id="intref0125">vswarup@uci.edu</ext-link>).</p>
      </sec>
      <sec id="sec4.2.2">
        <title>Materials availability</title>
        <p id="p0205">This study did not generate new unique reagents.</p>
      </sec>
    </sec>
    <sec id="sec4.3">
      <title>Method details</title>
      <sec id="sec4.3.1">
        <title>Bootstrapped aggregation of single cell transcriptomes to form metacells</title>
        <p id="p0210">Single-cell gene expression datasets typically contain many more zero valued entries than non-zero valued entries, meaning that these datasets are sparse. We formally define the <bold>sparsity</bold> of a gene expression matrix in <xref rid="fd1" ref-type="disp-formula">Equation 1</xref>. Given an un-normalized counts matrix <inline-formula><mml:math id="M33" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> with genes and <inline-formula><mml:math id="M34" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> cells, sparsity is the sum of all zero valued elements.<disp-formula id="fd1"><label>(Equation 1)</label><mml:math id="M35" altimg="si23.gif"><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:msubsup><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mtext>else</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo linebreak="badbreak">×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
        <p id="p0215">Complementing sparsity, the density of a single gene expression matrix is the sum of all non-zero valued elements divided by the total number of matrix elements, such that <inline-formula><mml:math id="M36" altimg="si24.gif"><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula>. A matrix is considered sparse if <inline-formula><mml:math id="M37" altimg="si25.gif"><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>. Conventional single-cell gene expression assays yield sparse gene expression matrices. In general, correlations of sparse vectors may lead to downstream conclusions that are not robust or reproducible. Thus, as part of the hdWGCNA workflow, we propose a bootstrapped aggregation (bagging) algorithm to construct a gene expression matrix <inline-formula><mml:math id="M38" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> with considerably reduced sparsity prior to performing co-expression network analysis. Zero valued entries in a gene expression matrix have both biological and technical origins,<xref rid="bib72" ref-type="bibr"><sup>75</sup></xref> and it is important to prioritize preserving relevant biological signals while reducing technical noise. For example, a biological zero may be attributed to a gene that is only expressed in a given cell population, whereas a technical zero may arise from low sequencing depth.</p>
        <p id="p0220">We define the set of unique cell barcodes <inline-formula><mml:math id="M39" altimg="si27.gif"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> and the set of unique genes <inline-formula><mml:math id="M40" altimg="si28.gif"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M41" altimg="si29.gif"><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mi>C</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M42" altimg="si30.gif"><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mi>G</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Transcriptomically similar cells are identified in a dimensionally-reduced representation <inline-formula><mml:math id="M43" altimg="si31.gif"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> of the gene expression matrix <inline-formula><mml:math id="M44" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> using the <inline-formula><mml:math id="M45" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>-nearest neighbors (KNN) algorithm,<xref rid="bib73" ref-type="bibr"><sup>76</sup></xref> yielding <inline-formula><mml:math id="M46" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> sets of <inline-formula><mml:math id="M47" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> cells. Inherently, there is overlap between these <inline-formula><mml:math id="M48" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> sets of <inline-formula><mml:math id="M49" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> neighboring cells, and we include a parameter <inline-formula><mml:math id="M50" altimg="si33.gif"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> to control for the maximum allowable overlap. Cells are uniformly randomly sampled from <inline-formula><mml:math id="M51" altimg="si27.gif"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula>, and gene expression signatures from <inline-formula><mml:math id="M52" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> are aggregated (sum or average) with their <inline-formula><mml:math id="M53" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> nearest neighbors. A cell is skipped if its neighbors have too much overlap with the set of neighbors from previously selected cells, in order to reduce redundancy in the downstream metacell expression matrix. The cell sampling loop converges when there are no more cells that satisfy the <inline-formula><mml:math id="M54" altimg="si33.gif"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, or when the number of target metacells <inline-formula><mml:math id="M55" altimg="si34.gif"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> has been reached, yielding a metacell gene expression matrix <inline-formula><mml:math id="M56" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>. Sparsity of the input and output matrices <inline-formula><mml:math id="M57" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M58" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> are computed to check that sparsity is reduced throughout this process. This metacell bagging algorithm is implemented as part of the hdWGCNA R package in the ConstructMetacells function, and the pseudocode for this algorithm is defined in <xref rid="tbox1" ref-type="boxed-text">Algorithm 1</xref>. We denote a vector containing the elements of the <inline-formula><mml:math id="M59" altimg="si35.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th row of a matrix as <inline-formula><mml:math id="M60" altimg="si36.gif"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and a vector containing the elements of the <inline-formula><mml:math id="M61" altimg="si35.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th column as <inline-formula><mml:math id="M62" altimg="si37.gif"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.<boxed-text id="tbox1"><label>Algorithm 1</label><caption><title>ConstructMetacells</title></caption><p id="p0390">Require: <inline-formula><mml:math id="M63" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M64" altimg="si73.gif"><mml:mrow><mml:mi>dim</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> ⊳ gene expression matrix of <inline-formula><mml:math id="M65" altimg="si74.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> genes and <inline-formula><mml:math id="M66" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> cells</p><p id="p0395"><bold>Require:</bold><inline-formula><mml:math id="M67" altimg="si31.gif"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M68" altimg="si75.gif"><mml:mrow><mml:mi>dim</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> ⊳ dimensional reduction of <inline-formula><mml:math id="M69" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="M70" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> cells and <inline-formula><mml:math id="M71" altimg="si76.gif"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> dimensions</p><p id="p0400"><bold>Require:</bold><inline-formula><mml:math id="M72" altimg="si27.gif"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> ⊳ the set of unique cell barcodes</p><p id="p0405"><bold>Require:</bold><inline-formula><mml:math id="M73" altimg="si77.gif"><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula></p><p id="p0410"><bold>Require:</bold><inline-formula><mml:math id="M74" altimg="si78.gif"><mml:mrow><mml:mi>m</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></p><p id="p0415"><bold>Require:</bold><inline-formula><mml:math id="M75" altimg="si79.gif"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula></p><p id="p0420"><inline-formula><mml:math id="M76" altimg="si80.gif"><mml:mrow><mml:mi>K</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mtext>KNN</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> ⊳ <inline-formula><mml:math id="M77" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> is a matrix of <inline-formula><mml:math id="M78" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> rows and <inline-formula><mml:math id="M79" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> columns with the <inline-formula><mml:math id="M80" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> nearest neighbors of each cell</p><p id="p0425"><inline-formula><mml:math id="M81" altimg="si81.gif"><mml:mrow><mml:mi>S</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo linebreak="badbreak">∅</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> ⊳ list containing barcodes of cells selected for aggregation, initialized as empty</p><p id="p0430"><inline-formula><mml:math id="M82" altimg="si82.gif"><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></p><p id="p0435"><bold>while</bold><inline-formula><mml:math id="M83" altimg="si83.gif"><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&lt;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M84" altimg="si84.gif"><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mi>S</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold></p><p id="p0440"><inline-formula><mml:math id="M85" altimg="si85.gif"><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mi>i</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula></p><p id="p0445"><inline-formula><mml:math id="M86" altimg="si86.gif"><mml:mrow><mml:mi>c</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> ⊳ <inline-formula><mml:math id="M87" altimg="si87.gif"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> is randomly sampled from <inline-formula><mml:math id="M88" altimg="si27.gif"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula></p><p id="p0450"><inline-formula><mml:math id="M89" altimg="si88.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo linebreak="badbreak">∪</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo linebreak="badbreak">∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> ⊳ the maximum number of overlapping neighbors between</p><p id="p0455"><inline-formula><mml:math id="M90" altimg="si87.gif"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> and barcodes in</p><p id="p0460"><inline-formula><mml:math id="M91" altimg="si89.gif"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula></p><p id="p0465">if.</p><p id="p0470"><inline-formula><mml:math id="M92" altimg="si90.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">&lt;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula><bold>then</bold></p><p id="p0475"><inline-formula><mml:math id="M93" altimg="si91.gif"><mml:mrow><mml:mi>S</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></p><p id="p0480"><bold>end if</bold>.</p><p id="p0485"><inline-formula><mml:math id="M94" altimg="si92.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mi>C</mml:mi><mml:mo>∖</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula></p><p id="p0490"><bold>end while</bold>.</p><p id="p0495"><inline-formula><mml:math id="M95" altimg="si93.gif"><mml:mrow><mml:mi>J</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>∀</mml:mo><mml:mi>s</mml:mi><mml:mo linebreak="badbreak">∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> ⊳ subset of <inline-formula><mml:math id="M96" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> with the selected cells <inline-formula><mml:math id="M97" altimg="si89.gif"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula></p><p id="p0500"><inline-formula><mml:math id="M98" altimg="si94.gif"><mml:mrow><mml:mi>M</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mtext>where</mml:mtext><mml:mspace width="0.25em"/><mml:mi>s</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. ⊳ final metacell expression matrix</p></boxed-text></p>
      </sec>
      <sec id="sec4.3.2">
        <title>Aggregation of neighboring spatial transcriptomic spots to form metaspots</title>
        <p id="p0225">Sequencing-based ST approaches such as the <inline-formula><mml:math id="M99" altimg="si1.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> Genomics Visium platform also yield sparse transcriptomic profiles, thus introducing the same potential pitfalls as single-cell data for co-expression network analysis. To alleviate these issues, we sought to develop a data aggregation approach similar to our metacell algorithm. This approach leverages spatial coordinates rather than the dimensionality-reduced representation (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>). For each ST spot, we obtain a list of physically neighboring spots. We then devise a grid of ”principal spots”, which are evenly spaced spots throughout the input tissue which serve as anchor points for aggregating neighboring spots. Each principal spot and its neighbors are aggregated into one metaspot, with at most seven spots merging into one metaspot and at most two overlapping spots between metaspots. We implemented this procedure as part of the hdWGCNA R package in the MetaspotsByGroups function. Similar to the MetacellsByGroups function, the user may specify groups within the Seurat object to perform the aggregation, such that metacells would only be grouped within the same tissue slice, anatomical region, or other annotation. For all downstream analysis with hdWGCNA, the metaspot expression dataset can be used in place of the metacell expression matrix.</p>
      </sec>
      <sec id="sec4.3.3">
        <title>Computing co-expression networks</title>
        <p id="p0230">Following metacell or metaspot construction, hdWGCNA constructs co-expression networks and identifies gene modules, building off of the WGCNA workflow.<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref><sup>,</sup><xref rid="bib4" ref-type="bibr"><sup>4</sup></xref><sup>,</sup><xref rid="bib74" ref-type="bibr"><sup>77</sup></xref><sup>,</sup><xref rid="bib75" ref-type="bibr"><sup>78</sup></xref> The gene-gene adjacency matrix <inline-formula><mml:math id="M100" altimg="si38.gif"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula> is computed by taking the pairwise correlation of genes in <inline-formula><mml:math id="M101" altimg="si28.gif"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> in the metacell expression matrix <inline-formula><mml:math id="M102" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>, or in a subset of <inline-formula><mml:math id="M103" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> for a specified cell population. Consider the gene expression vectors <inline-formula><mml:math id="M104" altimg="si39.gif"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M105" altimg="si40.gif"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for an arbitrary pair of genes <inline-formula><mml:math id="M106" altimg="si41.gif"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula>, we compute the signed correlation as:<disp-formula id="fd2"><label>(Equation 2)</label><mml:math id="M107" altimg="si42.gif"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
        <p id="p0235">Note that <inline-formula><mml:math id="M108" altimg="si43.gif"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a linear transformation that retains the sign of the correlation while satisfying <inline-formula><mml:math id="M109" altimg="si44.gif"><mml:mrow><mml:mn>0</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. We define <inline-formula><mml:math id="M110" altimg="si38.gif"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula> as a symmetric adjacency matrix of size <inline-formula><mml:math id="M111" altimg="si45.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> containing the signed correlations <inline-formula><mml:math id="M112" altimg="si43.gif"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for all pairs <inline-formula><mml:math id="M113" altimg="si41.gif"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> as in <xref rid="fd2" ref-type="disp-formula">Equation 2</xref>. In order to emphasize strong correlations, we raise the elements of <inline-formula><mml:math id="M114" altimg="si38.gif"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula> to a power <inline-formula><mml:math id="M115" altimg="si46.gif"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula>, and we refer to this as soft power thresholding.<disp-formula id="fd3"><label>(Equation 3)</label><mml:math id="M116" altimg="si47.gif"><mml:mrow><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>β</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">×</mml:mo><mml:mtext>sign</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>cor</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
        <p id="p0240">Now we have the gene-gene correlation raised to a power <inline-formula><mml:math id="M117" altimg="si46.gif"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula>, and an alternative metric <inline-formula><mml:math id="M118" altimg="si48.gif"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> which also retains the sign of the correlation between these genes. The final co-expression network is then computed as a signed topological overlap matrix (TOM). The TOM describes shared neighbors between the a pair of genes <inline-formula><mml:math id="M119" altimg="si49.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. We define the signed TOM as<disp-formula id="fd4"><label>(Equation 4)</label><mml:math id="M120" altimg="si50.gif"><mml:mrow><mml:msubsup><mml:mtext>TOM</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>signed</mml:mtext></mml:msubsup><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo linebreak="badbreak">≠</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">−</mml:mo><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M121" altimg="si51.gif"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M122" altimg="si52.gif"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represent the connectivity between genes <inline-formula><mml:math id="M123" altimg="si35.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M124" altimg="si53.gif"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula><disp-formula id="fd5"><label>(Equation 5)</label><mml:math id="M125" altimg="si54.gif"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo linebreak="badbreak">≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>In the signed TOM, negative correlations serve to negatively reinforce the network connection, which is not the case in the unsigned TOM.<disp-formula id="fd6"><label>(Equation 6)</label><mml:math id="M126" altimg="si55.gif"><mml:mrow><mml:msubsup><mml:mtext>TOM</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>unsigned</mml:mtext></mml:msubsup><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mo linebreak="badbreak">+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo linebreak="badbreak">≠</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">−</mml:mo><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
        <p id="p0245">Genes are then grouped into modules based on the TOM network representation using the Dynamic Tree Cut algorithm,<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> such that co-expression modules consist of genes with high topological overlap. Dynamic Tree Cut hierarchically clusters genes based on their dissimilarity in the TOM, denoted as <inline-formula><mml:math id="M127" altimg="si56.gif"><mml:mrow><mml:mtext>DissTOM</mml:mtext><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mtext>TOM</mml:mtext></mml:mrow></mml:math></inline-formula>, thereby yielding a mapping between module assignments and gene names. The overall process transforming a metacell expression matrix <inline-formula><mml:math id="M128" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> to a signed TOM co-expression network is implemented as part of the hdWGCNA R package in the ConstructNetwork function. Here we described the recommended workflow, using a signed adjacency matrix and a signed TOM, but ConstructNetwork can optionally construct unsigned or signed hybrid networks as well.</p>
      </sec>
      <sec id="sec4.3.4">
        <title>Computing module eigengenes</title>
        <p id="p0250">Module eigengenes (MEs) are a convenient metric to summarize the gene expression of a given co-expression module. While the co-expression network was computed using the metacell expression matrix <inline-formula><mml:math id="M129" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>, we compute MEs in the single-cell expression matrix <inline-formula><mml:math id="M130" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, thus yielding information about the activity of each module in each cell. The expression matrix for the <inline-formula><mml:math id="M131" altimg="si57.gif"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>-th module consisting of genes <inline-formula><mml:math id="M132" altimg="si58.gif"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">⊂</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="M133" altimg="si59.gif"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The ME for module <inline-formula><mml:math id="M134" altimg="si57.gif"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> is then computed by performing singular value decomposition (SVD), such that <inline-formula><mml:math id="M135" altimg="si60.gif"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>U</mml:mi><mml:mi>D</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. Prior to running SVD, <inline-formula><mml:math id="M136" altimg="si61.gif"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> must be scaled and centered, and we accomplish this using the Seurat function ScaleData. Importantly, ScaleData enables us to optionally perform regression to diminish the effects of selected technical covariates prior to computing MEs. The first column of <inline-formula><mml:math id="M137" altimg="si62.gif"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>, containing the right-singular vectors <inline-formula><mml:math id="M138" altimg="si63.gif"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>3</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is the ME of module <inline-formula><mml:math id="M139" altimg="si57.gif"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>.<disp-formula id="fd7"><label>(Equation 7)</label><mml:math id="M140" altimg="si64.gif"><mml:mrow><mml:msup><mml:mtext>ME</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="badbreak">=</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p>
        <p id="p0255">While SVD or other dimensionality reductions on a single-cell gene expression matrix contains critical biological information, technical artifacts are also present in these representations. There are many computational methods aiming to reduce technical effects in a reduced dimensional space, and these methods are often referred to as “batch-correction” or “integration” approaches.<xref rid="bib76" ref-type="bibr"><sup>79</sup></xref> In particular, Harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> is an algorithm well suited for correcting batch effects that may be present in a dimensionality-reduced single-cell expression dataset,<xref rid="bib76" ref-type="bibr"><sup>79</sup></xref> and here we propose applying Harmony to MEs to maximize the biological information content of each ME. We implemented the ME computation algorithm, as defined in <xref rid="tbox2" ref-type="boxed-text">Algorithm 2</xref>, as part of the hdWGCNA R package in the function ModuleEigengenes.<boxed-text id="tbox2"><label>Algorithm 2</label><caption><title>ModuleEigengenes</title></caption><p id="p0505">Require: <inline-formula><mml:math id="M141" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M142" altimg="si73.gif"><mml:mrow><mml:mi>dim</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> ⊳ normalized gene expression matrix of <inline-formula><mml:math id="M143" altimg="si74.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> genes and <inline-formula><mml:math id="M144" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> cells</p><p id="p0510"><bold>Require:</bold> modules ⊳ the table containing mappings between genes and modules.</p><p id="p0515"><bold>Require:</bold> mods ⊳ list of modules.</p><p id="p0520"><bold>Require:</bold> covariates ⊳ covariates to regress.</p><p id="p0525"><bold>Require:</bold> batches ⊳ batch identity to correct with Harmony, or null to ignore.</p><p id="p0530">ME <inline-formula><mml:math id="M145" altimg="si95.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo linebreak="badbreak">∅</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></p><p id="p0535"><bold>for</bold><inline-formula><mml:math id="M146" altimg="si96.gif"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mspace width="0.25em"/><mml:mtext>in</mml:mtext><mml:mspace width="0.25em"/><mml:mtext>mods</mml:mtext></mml:mrow></mml:math></inline-formula><bold>do</bold></p><p id="p0540">modules <inline-formula><mml:math id="M147" altimg="si97.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> subset(modules, module = = <inline-formula><mml:math id="M148" altimg="si57.gif"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>)</p><p id="p0545"><inline-formula><mml:math id="M149" altimg="si98.gif"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> modules <inline-formula><mml:math id="M150" altimg="si99.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> [,gene]</p><p id="p0550"><inline-formula><mml:math id="M151" altimg="si100.gif"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p><p id="p0555"><inline-formula><mml:math id="M152" altimg="si101.gif"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> ScaleData(<inline-formula><mml:math id="M153" altimg="si61.gif"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, covariates)</p><p id="p0560"><inline-formula><mml:math id="M154" altimg="si102.gif"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> SVD <inline-formula><mml:math id="M155" altimg="si103.gif"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula></p><p id="p0565">ME <inline-formula><mml:math id="M156" altimg="si104.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></p><p id="p0570"><bold>if</bold><inline-formula><mml:math id="M157" altimg="si105.gif"><mml:mrow><mml:mtext>batches</mml:mtext><mml:mo linebreak="goodbreak" linebreakstyle="after">≠</mml:mo><mml:mi mathvariant="monospace">N</mml:mi><mml:mi mathvariant="monospace">U</mml:mi><mml:mi mathvariant="monospace">L</mml:mi><mml:mi mathvariant="monospace">L</mml:mi></mml:mrow></mml:math></inline-formula><bold>then</bold></p><p id="p0575"><inline-formula><mml:math id="M158" altimg="si106.gif"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> Harmony(<inline-formula><mml:math id="M159" altimg="si107.gif"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, batches)</p><p id="p0580">ME <inline-formula><mml:math id="M160" altimg="si108.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></p><p id="p0585"><bold>end if</bold>.</p><p id="p0590">ME <inline-formula><mml:math id="M161" altimg="si109.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> [ ME, ME <inline-formula><mml:math id="M162" altimg="si99.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>]</p><p id="p0595"><bold>end for</bold>.</p></boxed-text></p>
      </sec>
      <sec id="sec4.3.5">
        <title>Projecting co-expression modules in unseen data</title>
        <p id="p0260">In a typical hdWGCNA workflow, we perform metacell bagging, co-expression network analysis, module identification, and ME computation using the same single-cell gene expression dataset, starting from the expression matrix <inline-formula><mml:math id="M163" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>. Given the module-gene assignment table derived from a reference dataset <inline-formula><mml:math id="M164" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, we can run the ModuleEigengenes algorithm on a query dataset <inline-formula><mml:math id="M165" altimg="si65.gif"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:math></inline-formula> where the genes in <inline-formula><mml:math id="M166" altimg="si65.gif"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:math></inline-formula> must be contained in the set of genes in <inline-formula><mml:math id="M167" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M168" altimg="si66.gif"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">⊆</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. We implemented this process in the hdWGCNA R package as the ProjectModules function. Importantly, we designed ProjectModules to be agnostic towards the data modality or species used in the reference and query datasets, thereby allowing for a host of comparative analyses. ProjectModules can facilitate cross-species analysis leveraging a table that maps gene symbols between two genomes. Modules can be projected into epigenomic data modalities such as single-cell assay for transposase accessible chromatin with sequencing (scATAC-seq) provided a measure of gene expression estimated from chromatin accessibility, such as Signac<xref rid="bib58" ref-type="bibr"><sup>59</sup></xref> gene activity or ArchR<xref rid="bib77" ref-type="bibr"><sup>80</sup></xref> gene scores. This approach can also be used to project modules from bulk expression datasets into single-cell or spatial transcriptomics datasets.</p>
      </sec>
      <sec id="sec4.3.6">
        <title>Implementation of the hdWGCNA R package</title>
        <p id="p0265">hdWGCNA greatly extends upon scWGCNA,<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> our previous method for co-expression network analysis in single-cell transcriptomics data. scWGCNA was originally used to identify co-expression networks using bulk and single-cell RNA-seq together,<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> and in another study we showed that scWGCNA was suitable for network analysis using scRNA-seq alone.<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref> Contrasting the hdWGCNA package, the implementation of scWGCNA was an R package containing a single function for metacell construction, and a single tutorial to cover the basics of network analysis using the WGCNA package<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref> with the metacell matrix. We implemented hdWGCNA as an open-source object-oriented R package that leverages the widely used SeuratObject data structure. The hdWGCNA R package includes all necessary functions for network inference, data visualization, statistical testing, and downstream analysis such as pathway enrichment. Further, hdWGCNA includes functions to extract the network data from the SeuratObject to easily facilitate custom analysis with external Bioconductor or R packages. In order for hdWGCNA to be widely useful across the genomics community, we developed a detailed documentation website containing tutorials for network analysis in single-cell and spatial transcriptomics data, as well as tutorials for advanced analysis like consensus network analysis and network preservation testing. Unlike scWGCNA, the metacell construction algorithm (<xref rid="tbox1" ref-type="boxed-text">Algorithm 1</xref>) in hdWGCNA includes new parameters to avoid redundant metacells, the module eigengene algorithm in hdWGCNA (<xref rid="tbox2" ref-type="boxed-text">Algorithm 2</xref>) accounts for batch effects and additional covariates in the input dataset, and hdWGCNA contains functions to handle spatial transcriptomics datasets. Several key steps in co-expression network analysis, like calculating module eigengenes and eigengene-based connectivity, have been re-implemented to operate on sparse matrices, greatly decreasing runtime and memory usage. hdWGNCA is completely technology agnostic, and can be adapted to handle high dimensional counts matrices from any single-cell or spatial transcriptomics platform. Additionally, hdWGCNA includes a novel approach for visualizing genes and the underlying network in a two-dimensional manifold of co-expression space using UMAP.<xref rid="bib19" ref-type="bibr"><sup>19</sup></xref> As shown throughout this manuscript, hdWGCNA includes functions for projecting co-expression networks into a variety of external datasets. The widespread adoption of single-cell genomics has led to many biologists running their own computational analysis, and we designed the hdWGCNA R package with these individuals in mind through our various step-by-step tutorials and detailed documentation.</p>
      </sec>
    </sec>
    <sec id="sec4.4">
      <title>Quantification and statistical analysis</title>
      <sec id="sec4.4.1">
        <title>Reprocessing published datasets</title>
        <p id="p0270">The <xref rid="sec4.1" ref-type="sec">key resources table</xref> details the different datasets used throughout this manuscript. We used several published datasets generated by our own group,<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref><sup>,</sup><xref rid="bib28" ref-type="bibr"><sup>28</sup></xref><sup>,</sup><xref rid="bib55" ref-type="bibr"><sup>56</sup></xref> and sequencing data was not re-downloaded for these studies. For all human snRNA-seq datasets, we applied a uniform processing pipeline to process each dataset starting from the raw sequencing data and resulting in an anndata object<xref rid="bib78" ref-type="bibr"><sup>72</sup></xref> containing UMI counts, normalized gene expression, cluster identities, and cell type annotations. Parameters used throughout this processing pipeline vary slightly between different datasets, and all parameters are noted in the data processing scripts in our github repository. For each biological replicate, we used the kb count function from kallisto <inline-formula><mml:math id="M169" altimg="si67.gif"><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> bustools<xref rid="bib79" ref-type="bibr"><sup>81</sup></xref> to psuedoalign raw sequencing reads to the reference transcriptome and quantify gene expression attributed to each cell barcode. The human reference transcriptome (GRch38) was obtained from the <inline-formula><mml:math id="M170" altimg="si1.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> Genomics website (version 2020-A, July 2020), and was re-formatted for use with kallisto <inline-formula><mml:math id="M171" altimg="si67.gif"><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> bustools using the kb ref function. For each of the UMI counts matrices, we used the remove-background function from cellbender<xref rid="bib80" ref-type="bibr"><sup>74</sup></xref> to simultaneously identify which barcodes corresponded to cells and to remove counts attributed to ambient RNA. We then used scrublet<xref rid="bib81" ref-type="bibr"><sup>73</sup></xref> to compute ”doublet scores”, the likelihood of each barcode mapping to more than one cell. Counts matrices from each biological replicate in a given dataset are then merged into a single anndata object, and any relevant sample level meta-data (age, sex, disease status) was stored in the adata.obs table. We performed a percentile filtering of cells that were outliers from each dataset based on the number of UMI per cell the percentage of UMI attributed to mitochondrial genes per cell, and the doublet score. Filtering based on these criteria was performed in each sample, as well as dataset-wide. After filtering, downstream data processing steps were carried out with SCANPY.<xref rid="bib78" ref-type="bibr"><sup>72</sup></xref> The UMI counts matrix was normalized with <inline-formula><mml:math id="M172" altimg="si68.gif"><mml:mrow><mml:mi>ln</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mtext>CPM</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using the functions sc.pp.normalize_total and sc.pp.log1p. Highly variable genes were identified using the function sc.pp.highly_variable_genes, and these genes are used as the features for downstream analysis steps such as principal component analysis (PCA). The normalized expression matrix was then scaled to unit variance and centered at zero using the function sc.pp.scale. PCA was performed on the scaled expression matrix using the function sc.tl.pca. Harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> was used to correct the PCA matrix for batch effects using the function sc.external.pp.harmony_integrate. The harmonized PCA matrix was then used to construct a cell neighborhood graph using the function sc.pp.neighbors. The cell neighborhood graph was then used to compute a two-dimensional representation of the data with uniform manifold approximation and projection<xref rid="bib19" ref-type="bibr"><sup>19</sup></xref> using the function sc.tl.umap, and to group cells into clusters with Leiden clustering<xref rid="bib82" ref-type="bibr"><sup>82</sup></xref> using the function sc.tl.leiden. We inspected the gene expression signatures in each Leiden cluster for a panel of canonical cell-type marker genes in order to assign a cell-type label to each cluster, and to identify additional doublet clusters that may have escaped the previous filtering steps. The distribution of quality control metrics was inspected in each cluster. We filtered out cells belonging to clusters that displayed conflicting expression of cell-type marker genes, or were outliers in their quality control metrics. After filtering these low-quality clusters, we ran UMAP and Leiden clustering again, resulting in the final processed dataset. We used a custom script to convert the datasets from <italic>anndata</italic> to SeuratObject by saving the individual components (counts matrix, cell meta-data, gene meta-data, dimensionality reductions, etc.) in Python and then loading them back into R to create a SeuratObject.</p>
      </sec>
      <sec id="sec4.4.2">
        <title>Iterative network analysis of major cell types in the human cortex</title>
        <p id="p0275">We performed an iterative co-expression network analysis of the major cell types (ASC, EX, INH, MG, ODC, OPC) in the human PFC snRNA-seq dataset from Zhou et al.,<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> only including samples from control brains (36,671 cells and 36,601 genes). We retained genes that were expressed in at least 5% of cells for downstream analysis. Metacells were computed separately for each major cell type and each sample using the hdWGCNA function MetacellsByGroups, aggregating 25 cells per metacell. Further, we ran MetacellsByGroups while varying the <inline-formula><mml:math id="M173" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> parameter in order to asses the resulting metacell expression matrix sparsity. For each cell type, we applied the following hdWGCNA commands with default arguments to perform network analysis: TestSoftPowers, ConstructNetwork, ModuleEigengenes, ModuleConnectivity, and RunModuleUMAP. We performed module preservation analysis<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> of the ODC co-expression modules in an external snRNA-seq dataset of the human PFC.<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> Modules were projected from the reference to query dataset using the hdWGCNA function ProjectModules, and the module preservation test was performed using ModulePreservation with 100 permutations.</p>
      </sec>
      <sec id="sec4.4.3">
        <title>Comparison of hdWGCNA with alternative metacell approaches</title>
        <p id="p0280">For the purpose of co-expression network analysis, we compared our metacell aggregation approach (<xref rid="tbox1" ref-type="boxed-text">Algorithm 1</xref>) with two alternative approaches, namely Metacell2<xref rid="bib14" ref-type="bibr"><sup>14</sup></xref> and SEACells.<xref rid="bib16" ref-type="bibr"><sup>16</sup></xref> We ran the three metacell approaches using the recommended settings on the same dataset, and then ran hdWGCNA on each of the resulting metacell expression matrices. We used a scRNA-seq of 6,800 CD34<sup>+</sup> hematopoietic stem and progenitor stem cells included with the SEACells package, and we used the cluster annotations from the original study. Notably, SEACells and Metacell2 do not account for cell labels in their aggregation procedures, which may result in a number of metacells containing transcriptomes from differently labeled cells. For the hdWGCNA metacell algorithm, we aggregated 50 cells per metacell. For the three metacell expression matrices derived from the different algorithms, we performed co-expression network analysis with the standard hdWGCNA pipeline by sequentially running the following functions with default parameters: TestSoftPowers, ConstructNetwork, ModuleEigengenes, ModuleConnectivity, and RunModuleUMAP. With the same cluster settings, Dynamic Tree Cut recovered a different number of co-expression modules for the three methods (hdWGCNA: 16 modules; MC2: 13 modules; SEACells: 20 modules). We performed pairwise comparisons between the gene modules detected with each metacell approach using Fisher’s exact test to test module overlaps. Additionally, we performed rank-rank hypergeometric overlap<xref rid="bib83" ref-type="bibr"><sup>83</sup></xref> (RRHO) tests using the RRHO function from the R package RRHO (version 1.13.0) to compare the kME ranking between modules across methods. To compare MEs and Seurat module scores, we ran the AddModuleScore function, and computed Pearson correlations between each ME and each module score.</p>
      </sec>
      <sec id="sec4.4.4">
        <title>Application of hdWGCNA to a one million cell scRNA-seq dataset</title>
        <p id="p0285">We obtained a publicly available scRNA-seq dataset from Parse Biosciences of 1M peripheral blood mononuclear cells (PBMCs) from twelve healthy donors and twelve Type-1 diabetic donors generated using the Evercode Whole Transcriptome Mega protocol. This analysis was performed on a compute cluster with 200 GB of memory and eight CPU cores. The UMI counts matrix and sample meta data was downloaded from Parse Biosciences’ Website. We processed the counts matrix using SCANPY using a similar pipeline as described in the <xref rid="sec4.4.1" ref-type="sec">reprocessing published dataset</xref> section. For quality control, we excluded cells with greater than 25% mitochondrial reads, greater than 5,000 genes, and greater than 25,000 counts. After dimensionality reduction with PCA, Harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> batch correction, and Leiden clustering<xref rid="bib82" ref-type="bibr"><sup>82</sup></xref> (resolution = 1), we annotated cell populations using PBMC marker genes obtained from Azimuth.<xref rid="bib7" ref-type="bibr"><sup>7</sup></xref> We excluded clusters with conflicting cell-type markers as potential doublet populations, retaining a total of 965,363 cells and 26,862 genes for downstream analysis. The major cell compartments recovered in this analysis were similar to those reported by Parse Biosciences in their analysis, including as T-cells, B-cells, monocytes, dendritic cells, basophils, and plasmablasts. Following the SCANPY data processing, we wrote the individual components (counts matrix, cell meta-data, gene meta-data, dimensionality reductions, etc.) to disk so they could be loaded into R and assembled into a Seurat object.</p>
        <p id="p0290">We performed co-expression network analysis iteratively for the plasmablast, T-cell, B-cell, monocyte, and dendritic cell compartments using an hdWGCNA pipeline for each group (<xref rid="mmc1" ref-type="supplementary-material">Figure S5</xref>). Metacells were constructed separately for each sample and each cell cluster with the hdWGCNA function MetacellsByGroups, aggregating 50 cells per metacell. The metacell aggregation step had a runtime of 85 min and 59 s. For each cell population, we first subset the Seurat object for the cell population of interest and then performed the standard hdWGCNA pipeline by sequentially running the following functions with default parameters: TestSoftPowers, ConstructNetwork, ModuleEigengenes, ModuleConnectivity, and RunModuleUMAP. We note that for the largest cell population (T-cells, 555,417 cells), the runtime for the network construction step was 186 s.</p>
      </sec>
      <sec id="sec4.4.5">
        <title>Runtime and memory usage of hdWGCNA</title>
        <p id="p0295">We tested the runtime and memory usage of the primary co-expression network analysis functions in hdWGCNA using the Velmeshev et al. 2019<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> dataset. We selected the neuronal cell population from the dataset for network analysis, and downsampled the dataset at different sizes ranging from 1,000 to 50,000 cells to test the runtime and memory usage as a function of the number of cells in the input dataset. The following functions were tested: SetupForWGCNA, MetacellsByGroups, TestSoftPowers, ModuleEigengenes, and ModuleConnectivity. We tested ModuleEigengenes with and without Harmony correction. All of these tests were done using eight parallel threads, and hdWGCNA can be sped up further by increasing the number of parallel threads. Importantly, the number of input genes and other network analysis parameters also have an effect on runtime and memory usage.</p>
      </sec>
      <sec id="sec4.4.6">
        <title>Evaluating performance of hdWGCNA co-expression networks</title>
        <p id="p0300">We tested the functional coherence of hdWGCNA co-expression networks using the Extending ’Guilt-by-Association’ by Degree (EGAD)<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref> algorithm. Connected genes in biological networks are potentially involved in the same processes, and EGAD evaluates this network property given a set of gene-process annotations. We performed functional coherence testing with the EGAD R package (version 1.18.0) using the six cell-type-specific co-expression networks from the Zhou et al. 2020<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> human PFC dataset. We downloaded a table of gene ontology associations for each gene from ensembl biomart, and formatted this table using the EGAD function make_annotations. We then ran the functional coherence test with EGAD using the function run_GBA, using the TOM as the input network, and we report the distributions of area under the receiver operating characteristic curve (AUC) values for each tested biological process in the six co-expression networks.</p>
        <p id="p0305">We used the xgboost R package<xref rid="bib25" ref-type="bibr"><sup>25</sup></xref> (version 1.7.3.1) to perform XGBoost regularized regression analysis to predict a given gene’s expression based on the expression of the top ten module hub genes for the module each gene was assigned to. This analysis was done using the six cell-type-specific co-expression networks described in the <xref rid="sec4.4.2" ref-type="sec">iterative network analysis of major cell types in the human cortex</xref> section. We performed 5-fold cross validation, and measured the performance of the model as a test set root-mean-square error (RMSE) averaged across the 5-folds. We ran XGBoost for 100 iterations for each individual test, with a maximum tree depth of 3 and regularization alpha of 0.5.</p>
      </sec>
      <sec id="sec4.4.7">
        <title>Spatial co-expression network analysis in the mouse brain</title>
        <p id="p0310">We collected the publicly available <inline-formula><mml:math id="M174" altimg="si1.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> Genomics Visium mouse brain dataset using the SeuratData R package. This dataset consists of an anterior and a posterior slice from a sagittal brain section, which we merged into a single Seurat object comprising 6,049 ST spots and 31,053 genes. We processed this dataset using the standard Seurat pipeline by sequentially running the following commands: NormalizeData, FindVariableFeatures, ScaleData, RunPCA, FindNeighbors, FindClusters, and RunUMAP. The top thirty PCs were used for Louvain clustering<xref rid="bib84" ref-type="bibr"><sup>84</sup></xref> and UMAP. While ST spots were clustered based on transcriptomic information alone, we were able to annotate them based on anatomical features.</p>
        <p id="p0315">Neighboring ST spots were aggregated into metaspots in the anterior and posterior slices using the hdWGCNA function MetaspotsByGroups. We retained genes expressed in 5% of spots for downstream analysis, totaling 12,355 genes. We tested for the optimal soft-power threshold <inline-formula><mml:math id="M175" altimg="si46.gif"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> based on the the fit to a scale-free topology using the hdWGCNA function TestSoftPowers. The co-expression network was constructed using all ST spots spanning both the anterior and posterior slices using the hdWGCNA function ConstructNetwork with the following parameters: networkType = “signed”, TOMType = “signed”, soft_power = 5, deepSplit = 4, detectCutHeight = 0.995, minModuleSize = 50, mergeCutHeight = 0.2. Module eigengenes and eigengene-based connectivities were computed using the ModuleEigengenes and ModuleConnectivity functions respectively. This approach identified 12 spatial co-expression modules, and we visualized the spatial distributions of these modules by plotting their MEs directly onto the biological coordinates for each spot. The co-expression network was projected into two dimensions using UMAP with the hdWGCNA function RunModuleUMAP, and we used the top five hub genes (ranked by kMEs) as the input features for UMAP. We used the R package enrichR<xref rid="bib85" ref-type="bibr"><sup>85</sup></xref> (version 3.0) to perform enrichment analysis on the top 100 genes in each module ranked by kME using the following databases: GO_Biological_Process_2021, GO_Cellular_Component_2021, GO_Molecular_Function_2021, WikiPathway_2021_Mouse, and KEGG_2021_Mouse. We assessed the overlap between genes from these spatial co-expression modules and differentially expressed genes in each cluster from a recent snRNA-seq study of the whole mouse brain using Fisher’s exact test implemented in the R package GeneOverlap (version 1.26.0). Finally, we performed a separate network analysis on a subset of the ST dataset only containing the cortical layers 2–6, and we followed an identical hdWGCNA analysis pipeline to the full ST dataset for the cortical analysis.</p>
      </sec>
      <sec id="sec4.4.8">
        <title>Isoform co-expression network analysis in the mouse hippocampus</title>
        <p id="p0320">We performed isoform co-expression network analysis in radial glia lineage cells (radial glia, astrocytes, ependymal cells, and neural intermediate progenitor cells) from mouse hippocampus ScISOrSeq dataset from Joglekar et al.<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> using the hdWGCNA R package. The gene-level counts matrix for this dataset was obtained from the Gene Expression Omnibus database (GEO: GSE15845), and the isoform-level counts matrix was obtained directly from the authors of the original study. We formatted this dataset as a Seurat object with an isoform-level expression assay and a gene-level expression assay. The standard Seurat processing pipeline was used on the gene-level expression assay, where we sequentially ran the functions NormalizeData, FindVariableFeatures, ScaleData, and RunPCA with default parameters. The dataset was projected into two dimensions by running UMAP on the PCA matrix with 30 components using the RunUMAP function. For all downstream purposes, the cell-type annotations from the original study were used.</p>
        <p id="p0325">Radial glia cells were selected for network analysis, and isoforms expressed in fewer than 1% of these cells were excluded, yielding a set of 2,190 cells and 10,375 isoforms from 4,770 genes. We constructed metacells separately for each cell type on the isoform-level expression assay using the hdWGCNA function MetacellsByGroups with <inline-formula><mml:math id="M176" altimg="si69.gif"><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula>. We performed a parameter sweep for the soft-power threshold <inline-formula><mml:math id="M177" altimg="si46.gif"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> using the function TestSoftPowers. The isoform co-expression network was constructed using the ConstructNetwork function with the following parameters: networkType = “signed”, TOMType = “signed”, soft_power = 5, deepSplit = 4, detectCutHeight = 0.995, minModuleSize = 50, mergeCutHeight = 0.5. This approach identified 11 isoform co-expression modules. Isoform-level module eigenisoforms were computed using the ModuleEigengenes function, and eigenisoform-based connectivity was computed using the ModuleConnectivity function with default parameters. We computed a semi-supervised UMAP projection of the co-expression network using the hdWGCNA function RunModuleUMAP, with the module labels and the top six hub isoforms (by kMEiso) per module as the input features. We used the enrichR to identify enriched pathways in each module ranked by using the following databases: GO_Biological_Process_2021, GO_Cellular_Component_2021, GO_Molecular_Function_2021, WikiPathway_2021_Mouse, and KEGG_2021_Mouse.</p>
        <p id="p0330">To assess isoform co-expression network dynamics throughout the cellular trajectories within the radial glia lineage, we performed pseudotime analysis using Monocle 3<xref rid="bib36" ref-type="bibr"><sup>36</sup></xref> (version 1.0.0). We computed a UMAP of just radial glia lineage cells using the Monocle 3 function run_umap. A trajectory graph was built on this UMAP representation using the function learn_graph, and pseudotime was calculated with the function order_cells using the radial glia cells as the starting point. We split the pseudotime trajectory into three lineages based on the distinct cell fates (astrocyte, neuronal, and ependymal). We grouped cells into 50 evenly-sized bins throughout each trajectory, and we applied loess regression to the average module eigenisoform of each module in these bins to inspect the dynamics of each module throughout development. We wrote a custom script to generate a GTF of isoform models output from the ScISOrSeq pipeline. To visualize expressed isoforms, we plotted isoforms from this GTF on the UCSC genome browser as well as in Swan.<xref rid="bib39" ref-type="bibr"><sup>38</sup></xref></p>
      </sec>
      <sec id="sec4.4.9">
        <title>Co-expression analysis network of inhibitory neurons in autism spectrum disorder</title>
        <p id="p0335">We selected inhibitory neurons from the Velmeshev et al.<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> human autism spectrum disorder (ASD) snRNA-seq dataset for co-expression network analysis. Of the 121,451 cells in this dataset, 20,249 were labeled as inhibitory neurons based on marker gene expression profiles. We retained 11,194 genes which were expressed in at least 10% of cells from any cluster, and had non-zero variance in the inhibitory neuron population. Metacell transcriptomic profiles were constructed separately for each of the 54 samples and each cell type using the hdWGCNA function MetacellsByGroups, aggregating 50 cells into one metacell. We selected a soft-power threshold <inline-formula><mml:math id="M178" altimg="si70.gif"><mml:mrow><mml:mi>β</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> based on the parameter sweep performed with the TestSoftPowers function. The co-expression network was computed with the ConstructNetwork function with the following parameters: networkType = “signed”, TOMType = “signed”, soft_power = 9, deepSplit = 4, detectCutHeight = 0.995, minModuleSize = 50, mergeCutHeight = 0.2. Module eigengenes were computed using the ModuleEigengenes function, and we applied Harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> to correct MEs based on sequencing batch. Eigengene-based connectivity for each gene was computed using ModuleConnectivity. The co-expression network was embedded in two dimensions using UMAP with the RunModuleUMAP function with the top five genes (ranked by kMEs) per module as the input features. Distributions of MEs were compared between ASD and control samples for each inhibitory neuron subpopulation using a two-sided Wilcoxon rank-sum test with the R function wilcox.test. We used the enrichR<xref rid="bib85" ref-type="bibr"><sup>85</sup></xref> to perform enrichment analysis on the top 100 genes in each module ranked by kME using the following databases: GO_Biological_Process_2021, GO_Cellular_Component_2021, GO_Molecular_Function_2021, WikiPathway_2021_Human, and KEGG_2021_Human. Furthermore, we computed the overlap between co-expression modules and ASD-associated genes from the SFARI Gene database using the R package GeneOverlap, which calculates the overlap between sets of genes using Fisher’s exact test.</p>
      </sec>
      <sec id="sec4.4.10">
        <title>Consensus co-expression network analysis of microglia in Alzheimer’s disease</title>
        <p id="p0340">We performed consensus co-expression network analysis of microglia in Alzheimer’s disease (AD) using three published snRNA-seq datasets.<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref><sup>,</sup><xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> The individually processed datasets were merged into a single Seurat object comprising 189,127 nuclei, and the datasets were integrated into a common dimensionally-reduced space using PCA and Harmony.<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> We retained all nuclei labeled microglia for network analysis based on expression of canonical marker genes such as <italic>CSF1R</italic> (9,904 nuclei), and genes expressed in at least 5% of microglia from any of the three studies were retained (7,900 genes). Metacells were constructed in groups of cells based on AD diagnosis status and study of origin, aggregating 25 cells per metacell. Within hdWGCNA, we used the SetMultiExpr function to create a list of expression matrices containing the selected genes and metacells for the three studies. We performed a separate parameter sweep for the three expression matrices using the hdWGCNA function TestSoftPowerConsensus, ensuring that we used an appropriate <inline-formula><mml:math id="M179" altimg="si46.gif"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> value for each dataset (Mathys et al.: <inline-formula><mml:math id="M180" altimg="si71.gif"><mml:mrow><mml:mi>β</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>, Zhou et al.: <inline-formula><mml:math id="M181" altimg="si72.gif"><mml:mrow><mml:mi>β</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>, Morabito &amp; Miyoshi et al.: <inline-formula><mml:math id="M182" altimg="si71.gif"><mml:mrow><mml:mi>β</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>). The consensus co-expression network was contructed using the hdWGCNA function ConstructNetwork using the consensus = TRUE option. Individual TOMs were computed for each dataset, and they were scaled based on the 80th percentile in order to alleviate different statistical properties specific to each dataset rather than the underlying biology. A consensus TOM was computed by taking the element-wise minimum of the individual TOMs from each dataset. Therefore, large topological overlap values between two genes, which indicate a strong co-expression relationship, are supported across all three datasets in the consensus TOM. We performed hierarchical clustering on the consensus TOM, and we used the Dynamic Tree Cut algorithm<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> was used to identify consensus co-expression modules based on the hierarchy. Module eigengenes were computed using the ModuleEigengenes function, and we applied Harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> to correct MEs based on the dataset of origin. Eigengene-based connectivity for each gene was computed using ModuleConnectivity. We visualized the network using UMAP with the top ten hub genes (ranked by kMEs) per module as the input features, annotating the hub genes and known disease-associated microglia genes.<xref rid="bib49" ref-type="bibr"><sup>50</sup></xref> We used the enrichR<xref rid="bib85" ref-type="bibr"><sup>85</sup></xref> to perform enrichment analysis on the top 100 genes in each module ranked by kME using the following databases: GO_Biological_Process_2021, GO_Cellular_Component_2021, GO_Molecular_Function_2021, WikiPathway_2021_Human, and KEGG_2021_Human.</p>
        <p id="p0345">We sought to model the transcriptional dynamics governing the shift between homeostatic and activated microglia in AD, therefore we performed pseudotime analysis using Monocle 3<xref rid="bib36" ref-type="bibr"><sup>36</sup></xref> to build a continuous trajectory of microglia cell states. A trajectory graph was built on the microglia UMAP using the function learn_graph, and pseudotime was calculated with the function order_cells. We oriented the start of pseudotime based on the expression of homeostatic microglia marker genes, such as <italic>P2RY12</italic>, <italic>CX3CR1</italic>, and <italic>CSF1R</italic>. We grouped cells into 50 evenly-sized bins throughout each trajectory, and we applied loess regression to the average module eigengene of each module in these bins to inspect the dynamics of each module throughout the microglia trajectory.</p>
        <p id="p0350">To link the integrated microglia snRNA-seq dataset with polygenic risk of disease for individual cells, we used the scDRS python package (version 1.0.0).<xref rid="bib54" ref-type="bibr"><sup>52</sup></xref> This pipeline takes 1) a set of putative disease genes derived from GWAS summary statistics and 2) a scRNA-seq dataset as inputs, and outputs disease enrichment statistics for a given disease (raw and normalized disease scores, cell-level scDRS p value, and <inline-formula><mml:math id="M183" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula>-scores converted from the p values). GWAS summary statistics of 74 diseases and complex traits supplied by scDRS were utilized as gene sets, among which a gene set by Jansen et al.<xref rid="bib45" ref-type="bibr"><sup>46</sup></xref> provided the set of genes associated with AD. We then visualized the AD scDRS <inline-formula><mml:math id="M184" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula>-scores in the integrated AD microglia trajectory, and we correlated the scDRS score with the trajectory using a Pearson correlation.</p>
        <p id="p0355">We performed module preservation<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> analysis in a variety of external datasets from human and mouse<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref><sup>,</sup><xref rid="bib28" ref-type="bibr"><sup>28</sup></xref><sup>,</sup><xref rid="bib55" ref-type="bibr"><sup>56</sup></xref><sup>,</sup><xref rid="bib56" ref-type="bibr"><sup>57</sup></xref><sup>,</sup><xref rid="bib57" ref-type="bibr"><sup>58</sup></xref> to test for the reproducibility of the consensus AD microglia modules in the microglia population from each dataset. We used the hdWGCNA function ProjectModules to compute module eigengenes for the consensus AD microglia modules for each query dataset. The module preservation test was performed using the hdWGCNA function ModulePreservation with 100 permutations, and we reported the preservation <inline-formula><mml:math id="M185" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula>-summary statistics in a heatmap. For the Morabito &amp; Miyoshi et al. snATAC-seq dataset, we used the gene activity<xref rid="bib58" ref-type="bibr"><sup>59</sup></xref> representation as a gene-level summary of chromatin accessibility in order to assess the module preservation at the epigenomic level.</p>
      </sec>
      <sec id="sec4.4.11">
        <title>Analysis of bulk RNA-seq co-expression modules in single-cell data</title>
        <p id="p0360">We projected gene co-expression modules from two bulk RNA-seq studies of AD<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref><sup>,</sup><xref rid="bib62" ref-type="bibr"><sup>63</sup></xref> into a published snRNA-seq study of AD to assess their expression patterns within various cell populations. While both of these studies used the samples from the same bulk RNA-seq cohort, the set of modules from Morabito et al. 2020<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref> was based on a consensus network analysis across six brain regions while the other set of modules from the AMP-AD study<xref rid="bib62" ref-type="bibr"><sup>63</sup></xref> were constructed separately for seven different brain regions. Module eigengenes were computed for each of these bulk RNA-seq modules in the snRNA-seq dataset using the hdWGCNA function ProjectModules, using Harmony to correct MEs based on sequencing batch. We visualized the MEs of the projected modules in the snRNA-seq dataset using the Seurat function DotPlot.</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <label>1</label>
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>WGCNA: an R package for weighted correlation network analysis</article-title>
        <source>BMC Bioinf.</source>
        <volume>9</volume>
        <year>2008</year>
        <fpage>559</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-559</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <label>2</label>
      <element-citation publication-type="journal" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Yip</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Gene network interconnectedness and the generalized topological overlap measure</article-title>
        <source>BMC Bioinf.</source>
        <volume>8</volume>
        <year>2007</year>
        <fpage>22</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-22</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <label>3</label>
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Defining clusters from a hierarchical cluster tree: the Dynamic Tree Cut package for R</article-title>
        <source>Bioinformatics</source>
        <volume>24</volume>
        <year>2008</year>
        <fpage>719</fpage>
        <lpage>720</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm563</pub-id>
        <pub-id pub-id-type="pmid">18024473</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <label>4</label>
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Understanding network concepts in modules</article-title>
        <source>BMC Syst. Biol.</source>
        <volume>1</volume>
        <year>2007</year>
        <fpage>24</fpage>
        <pub-id pub-id-type="doi">10.1186/1752-0509-1-24</pub-id>
        <pub-id pub-id-type="pmid">17547772</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <label>5</label>
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>36</volume>
        <year>2018</year>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <label>6</label>
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>W.M.</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Stoeckius</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <volume>177</volume>
        <year>2019</year>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <label>7</label>
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Andersen-Nissen</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>W.M.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Wilk</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Darby</surname>
            <given-names>C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell</source>
        <volume>184</volume>
        <year>2021</year>
        <fpage>3573</fpage>
        <lpage>3587.e29</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <label>8</label>
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Joglekar</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Prjibelski</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Mahfouz</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Collier</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Schlusche</surname>
            <given-names>A.K.</given-names>
          </name>
          <name>
            <surname>Marrocco</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>S.R.</given-names>
          </name>
          <name>
            <surname>Haase</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A spatially resolved brain region- and cell type-specific isoform atlas of the postnatal mouse brain</article-title>
        <source>Nat. Commun.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>463</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-20343-5</pub-id>
        <pub-id pub-id-type="pmid">33469025</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <label>9</label>
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Velmeshev</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Schirmer</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Haeussler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Perez</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Mayer</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Bhaduri</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Goyal</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Rowitch</surname>
            <given-names>D.H.</given-names>
          </name>
          <name>
            <surname>Kriegstein</surname>
            <given-names>A.R.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell genomics identifies cell type–specific molecular changes in autism</article-title>
        <source>Science</source>
        <volume>364</volume>
        <year>2019</year>
        <fpage>685</fpage>
        <lpage>689</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aav8130</pub-id>
        <pub-id pub-id-type="pmid">31097668</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <label>10</label>
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Mathys</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Davila-Velderrain</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Mohammadi</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>J.Z.</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Abdurrob</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>X.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>
        <source>Nature</source>
        <volume>570</volume>
        <year>2019</year>
        <fpage>332</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1195-2</pub-id>
        <pub-id pub-id-type="pmid">31042697</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <label>11</label>
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>W.M.</given-names>
          </name>
          <name>
            <surname>Andhey</surname>
            <given-names>P.S.</given-names>
          </name>
          <name>
            <surname>Swain</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>K.R.</given-names>
          </name>
          <name>
            <surname>Poliani</surname>
            <given-names>P.L.</given-names>
          </name>
          <name>
            <surname>Cominelli</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Grover</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gilfillan</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human and mouse single-nucleus transcriptomics reveal TREM2-dependent and TREM2-independent cellular responses in Alzheimer’s disease</article-title>
        <source>Nat. Med.</source>
        <volume>26</volume>
        <year>2020</year>
        <fpage>131</fpage>
        <lpage>142</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-019-0695-9</pub-id>
        <pub-id pub-id-type="pmid">31932797</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <label>12</label>
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>Morabito</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Miyoshi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Michael</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Shahin</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Martini</surname>
            <given-names>A.C.</given-names>
          </name>
          <name>
            <surname>Head</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Leavy</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Perez-Rosendahl</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Swarup</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>Single-nucleus chromatin accessibility and transcriptomic characterization of Alzheimer’s disease</article-title>
        <source>Nat. Genet.</source>
        <volume>53</volume>
        <year>2021</year>
        <fpage>1143</fpage>
        <lpage>1155</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00894-z</pub-id>
        <pub-id pub-id-type="pmid">34239132</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <label>13</label>
      <element-citation publication-type="journal" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Baran</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Bercovich</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sebe-Pedros</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lubling</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Giladi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Chomsky</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Meir</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Hoichman</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lifshitz</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>MetaCell: analysis of single-cell RNA-seq data using K-nn graph partitions</article-title>
        <source>Genome Biol.</source>
        <volume>20</volume>
        <year>2019</year>
        <fpage>206</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1812-2</pub-id>
        <pub-id pub-id-type="pmid">31604482</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <label>14</label>
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Ben-Kiki</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Bercovich</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lifshitz</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Metacell-2: a divide-and-conquer metacell algorithm for scalable scRNA-seq analysis</article-title>
        <source>Genome Biol.</source>
        <volume>23</volume>
        <year>2022</year>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02667-1</pub-id>
        <pub-id pub-id-type="pmid">35440087</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <label>15</label>
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>H.A.</given-names>
          </name>
          <name>
            <surname>Packer</surname>
            <given-names>J.S.</given-names>
          </name>
          <name>
            <surname>McFaline-Figueroa</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Cusanovich</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>R.M.</given-names>
          </name>
          <name>
            <surname>Aghamirzaie</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Srivatsan</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Minkina</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cicero predicts cis-regulatory DNA interactions from single-cell chromatin accessibility data</article-title>
        <source>Mol. Cell</source>
        <volume>71</volume>
        <year>2018</year>
        <fpage>858</fpage>
        <lpage>871.e8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2018.06.044</pub-id>
        <pub-id pub-id-type="pmid">30078726</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <label>16</label>
      <element-citation publication-type="journal" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Persad</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Choo</surname>
            <given-names>Z.-N.</given-names>
          </name>
          <name>
            <surname>Dien</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Sohail</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Masilionis</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Chaligné</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Nawy</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>C.C.</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Pe’er</surname>
            <given-names>I.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SEACells infers transcriptional and epigenomic cellular states from single-cell genomics data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2023</year>
        <pub-id pub-id-type="doi">10.1038/s41587-023-01716-9</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <label>17</label>
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Squair</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kathe</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>N.D.</given-names>
          </name>
          <name>
            <surname>Hutson</surname>
            <given-names>T.H.</given-names>
          </name>
          <name>
            <surname>Hudelle</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Qaiser</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Matson</surname>
            <given-names>K.J.E.</given-names>
          </name>
          <name>
            <surname>Barraud</surname>
            <given-names>Q.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Confronting false discoveries in single-cell differential expression</article-title>
        <source>Nat. Commun.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>5692</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25960-2</pub-id>
        <pub-id pub-id-type="pmid">34584091</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <label>18</label>
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Andreatta</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Carmona</surname>
            <given-names>S.J.</given-names>
          </name>
        </person-group>
        <article-title>UCell: robust and scalable single-cell gene signature scoring</article-title>
        <source>Comput. Struct. Biotechnol. J.</source>
        <volume>19</volume>
        <year>2021</year>
        <fpage>3796</fpage>
        <lpage>3798</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2021.06.043</pub-id>
        <pub-id pub-id-type="pmid">34285779</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <label>19</label>
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>McInnes</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Melville</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>UMAP: uniform manifold approximation and projection for dimension reduction</article-title>
        <comment>Preprint at</comment>
        <source>arXiv</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.48550/arXiv.1802.03426</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <label>20</label>
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Oldham</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Is my network module preserved and reproducible?</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>7</volume>
        <year>2011</year>
        <object-id pub-id-type="publisher-id">e1001057</object-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1001057</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <label>21</label>
      <element-citation publication-type="journal" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Baglama</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Reichel</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Augmented implicitly restarted Lanczos bidiagonalization methods</article-title>
        <source>SIAM J. Sci. Comput.</source>
        <volume>27</volume>
        <year>2005</year>
        <fpage>19</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1137/04060593x</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <label>22</label>
      <element-citation publication-type="journal" id="sref22">
        <person-group person-group-type="author">
          <name>
            <surname>Korsunsky</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Millard</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Slowikowski</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Baglaenko</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Loh</surname>
            <given-names>P.-r.</given-names>
          </name>
          <name>
            <surname>Raychaudhuri</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title>
        <source>Nat. Methods</source>
        <volume>16</volume>
        <year>2019</year>
        <fpage>1289</fpage>
        <lpage>1296</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id>
        <pub-id pub-id-type="pmid">31740819</pub-id>
      </element-citation>
    </ref>
    <ref id="bib23">
      <label>23</label>
      <element-citation publication-type="journal" id="sref23">
        <person-group person-group-type="author">
          <name>
            <surname>Ballouz</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Pavlidis</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Gillis</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>EGAD: ultra-fast functional analysis of gene networks</article-title>
        <source>Bioinformatics</source>
        <volume>33</volume>
        <year>2017</year>
        <fpage>612</fpage>
        <lpage>614</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw695</pub-id>
        <pub-id pub-id-type="pmid">27993773</pub-id>
      </element-citation>
    </ref>
    <ref id="bib24">
      <label>24</label>
      <element-citation publication-type="journal" id="sref24">
        <person-group person-group-type="author">
          <name>
            <surname>Skinnider</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Squair</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Foster</surname>
            <given-names>L.J.</given-names>
          </name>
        </person-group>
        <article-title>Evaluating measures of association for single-cell transcriptomics</article-title>
        <source>Nat. Methods</source>
        <volume>16</volume>
        <year>2019</year>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0372-4</pub-id>
        <pub-id pub-id-type="pmid">30962620</pub-id>
      </element-citation>
    </ref>
    <ref id="bib25">
      <label>25</label>
      <element-citation publication-type="book" id="sref25">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Guestrin</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <part-title>XGBoost: A scalable tree boosting system</part-title>
        <source>Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</source>
        <year>2016</year>
        <publisher-name>KDD ’16</publisher-name>
        <fpage>785</fpage>
        <lpage>794</lpage>
        <pub-id pub-id-type="doi">10.1145/2939672.2939785</pub-id>
      </element-citation>
    </ref>
    <ref id="bib26">
      <label>26</label>
      <element-citation publication-type="journal" id="sref26">
        <person-group person-group-type="author">
          <name>
            <surname>Moses</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Museum of Spatial Transcriptomics</article-title>
        <comment>Preprint at</comment>
        <source>bioRxiv</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1101/2021.05.11.443152</pub-id>
      </element-citation>
    </ref>
    <ref id="bib27">
      <label>27</label>
      <element-citation publication-type="journal" id="sref27">
        <person-group person-group-type="author">
          <name>
            <surname>Moffitt</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Lundberg</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Heyn</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>The emerging landscape of spatial profiling technologies</article-title>
        <source>Nat. Rev. Genet.</source>
        <volume>23</volume>
        <year>2022</year>
        <fpage>741</fpage>
        <lpage>759</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-022-00515-3</pub-id>
        <pub-id pub-id-type="pmid">35859028</pub-id>
      </element-citation>
    </ref>
    <ref id="bib28">
      <label>28</label>
      <element-citation publication-type="journal" id="sref28">
        <person-group person-group-type="author">
          <name>
            <surname>Kiani Shabestari</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Morabito</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Danhash</surname>
            <given-names>E.P.</given-names>
          </name>
          <name>
            <surname>McQuade</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sanchez</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Miyoshi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Chadarevian</surname>
            <given-names>J.P.</given-names>
          </name>
          <name>
            <surname>Claes</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Coburn</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Hasselmann</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Absence of microglia promotes diverse pathologies and early lethality in Alzheimer’s disease mice</article-title>
        <source>Cell Rep.</source>
        <volume>39</volume>
        <year>2022</year>
        <object-id pub-id-type="publisher-id">110961</object-id>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2022.110961</pub-id>
      </element-citation>
    </ref>
    <ref id="bib29">
      <label>29</label>
      <element-citation publication-type="journal" id="sref29">
        <person-group person-group-type="author">
          <name>
            <surname>Wright</surname>
            <given-names>C.J.</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>C.W.J.</given-names>
          </name>
          <name>
            <surname>Jiggins</surname>
            <given-names>C.D.</given-names>
          </name>
        </person-group>
        <article-title>Alternative splicing as a source of phenotypic diversity</article-title>
        <source>Nat. Rev. Genet.</source>
        <volume>23</volume>
        <year>2022</year>
        <fpage>697</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-022-00514-4</pub-id>
        <pub-id pub-id-type="pmid">35821097</pub-id>
      </element-citation>
    </ref>
    <ref id="bib30">
      <label>30</label>
      <element-citation publication-type="journal" id="sref30">
        <person-group person-group-type="author">
          <name>
            <surname>Amarasinghe</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zappia</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Gouil</surname>
            <given-names>Q.</given-names>
          </name>
        </person-group>
        <article-title>Opportunities and challenges in long-read sequencing data analysis</article-title>
        <source>Genome Biol.</source>
        <volume>21</volume>
        <year>2020</year>
        <fpage>30</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-1935-5</pub-id>
        <pub-id pub-id-type="pmid">32033565</pub-id>
      </element-citation>
    </ref>
    <ref id="bib31">
      <label>31</label>
      <element-citation publication-type="journal" id="sref31">
        <person-group person-group-type="author">
          <name>
            <surname>Rebboah</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Reese</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Balderrama-Gutierrez</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>McGill</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Trout</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Rodriguez</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>B.J.</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Mapping and modeling the genomic basis of differential RNA isoform expression at single-cell resolution with LR-Split-seq</article-title>
        <source>Genome Biol.</source>
        <volume>22</volume>
        <year>2021</year>
        <fpage>286</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02505-w</pub-id>
        <pub-id pub-id-type="pmid">34620214</pub-id>
      </element-citation>
    </ref>
    <ref id="bib32">
      <label>32</label>
      <element-citation publication-type="journal" id="sref32">
        <person-group person-group-type="author">
          <name>
            <surname>Palmer</surname>
            <given-names>C.R.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C.S.</given-names>
          </name>
          <name>
            <surname>Romanow</surname>
            <given-names>W.J.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M.-H.</given-names>
          </name>
          <name>
            <surname>Chun</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Altered cell and RNA isoform diversity in aging Down syndrome brains</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <volume>118</volume>
        <year>2021</year>
        <object-id pub-id-type="publisher-id">e2114326118</object-id>
        <pub-id pub-id-type="doi">10.1073/pnas.2114326118</pub-id>
      </element-citation>
    </ref>
    <ref id="bib33">
      <label>33</label>
      <element-citation publication-type="journal" id="sref33">
        <person-group person-group-type="author">
          <name>
            <surname>Hardwick</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Joglekar</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Collier</surname>
            <given-names>P.G.</given-names>
          </name>
          <name>
            <surname>Foord</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Balacco</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lanjewar</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sampson</surname>
            <given-names>M.M.</given-names>
          </name>
          <name>
            <surname>Koopmans</surname>
            <given-names>F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-nuclei isoform RNA sequencing unlocks barcoded exon connectivity in frozen brain tissue</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>40</volume>
        <year>2022</year>
        <fpage>1082</fpage>
        <lpage>1092</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01231-3</pub-id>
        <pub-id pub-id-type="pmid">35256815</pub-id>
      </element-citation>
    </ref>
    <ref id="bib34">
      <label>34</label>
      <element-citation publication-type="journal" id="sref34">
        <person-group person-group-type="author">
          <name>
            <surname>Pollen</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Nowakowski</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Retallack</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Sandoval-Espinosa</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Nicholas</surname>
            <given-names>C.R.</given-names>
          </name>
          <name>
            <surname>Shuga</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Oldham</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Diaz</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular identity of human outer radial glia during cortical development</article-title>
        <source>Cell</source>
        <volume>163</volume>
        <year>2015</year>
        <fpage>55</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.09.004</pub-id>
        <pub-id pub-id-type="pmid">26406371</pub-id>
      </element-citation>
    </ref>
    <ref id="bib35">
      <label>35</label>
      <element-citation publication-type="journal" id="sref35">
        <person-group person-group-type="author">
          <name>
            <surname>Eze</surname>
            <given-names>U.C.</given-names>
          </name>
          <name>
            <surname>Bhaduri</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Haeussler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Nowakowski</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Kriegstein</surname>
            <given-names>A.R.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell atlas of early human brain development highlights heterogeneity of human neuroepithelial cells and early radial glia</article-title>
        <source>Nat. Neurosci.</source>
        <volume>24</volume>
        <year>2021</year>
        <fpage>584</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-020-00794-1</pub-id>
        <pub-id pub-id-type="pmid">33723434</pub-id>
      </element-citation>
    </ref>
    <ref id="bib36">
      <label>36</label>
      <element-citation publication-type="journal" id="sref36">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Spielmann</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Mundlos</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Christiansen</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Steemers</surname>
            <given-names>F.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>
        <source>Nature</source>
        <volume>566</volume>
        <year>2019</year>
        <fpage>496</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-0969-x</pub-id>
        <pub-id pub-id-type="pmid">30787437</pub-id>
      </element-citation>
    </ref>
    <ref id="bib71">
      <label>37</label>
      <element-citation publication-type="journal" id="sref71">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Cacchiarelli</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Grimsby</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Pokharel</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>N.J.</given-names>
          </name>
          <name>
            <surname>Livak</surname>
            <given-names>K.J.</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>J.L.</given-names>
          </name>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>32</volume>
        <year>2014</year>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="bib39">
      <label>38</label>
      <element-citation publication-type="journal" id="sref39">
        <person-group person-group-type="author">
          <name>
            <surname>Reese</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Swan: a library for the analysis and visualization of long-read transcriptomes</article-title>
        <source>Bioinformatics</source>
        <volume>37</volume>
        <year>2021</year>
        <fpage>1322</fpage>
        <lpage>1323</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa836</pub-id>
        <pub-id pub-id-type="pmid">32991665</pub-id>
      </element-citation>
    </ref>
    <ref id="bib37">
      <label>39</label>
      <element-citation publication-type="journal" id="sref37">
        <person-group person-group-type="author">
          <name>
            <surname>Hol</surname>
            <given-names>E.M.</given-names>
          </name>
          <name>
            <surname>Pekny</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Glial fibrillary acidic protein (GFAP) and the astrocyte intermediate filament system in diseases of the central nervous system</article-title>
        <source>Curr. Opin. Cell Biol.</source>
        <volume>32</volume>
        <year>2015</year>
        <fpage>121</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ceb.2015.02.004</pub-id>
        <pub-id pub-id-type="pmid">25726916</pub-id>
      </element-citation>
    </ref>
    <ref id="bib38">
      <label>40</label>
      <element-citation publication-type="journal" id="sref38">
        <person-group person-group-type="author">
          <name>
            <surname>Podergajs</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Motaln</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Rajčević</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Verbovšek</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Koršič</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Obad</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Espedal</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Vittori</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Herold-Mende</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Miletic</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transmembrane protein CD9 is glioblastoma biomarker, relevant for maintenance of glioblastoma stem cells</article-title>
        <source>Oncotarget</source>
        <volume>7</volume>
        <year>2016</year>
        <fpage>593</fpage>
        <lpage>609</lpage>
        <pub-id pub-id-type="doi">10.18632/oncotarget.5477</pub-id>
        <pub-id pub-id-type="pmid">26573230</pub-id>
      </element-citation>
    </ref>
    <ref id="bib40">
      <label>41</label>
      <element-citation publication-type="journal" id="sref40">
        <person-group person-group-type="author">
          <name>
            <surname>Grove</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Ripke</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Als</surname>
            <given-names>T.D.</given-names>
          </name>
          <name>
            <surname>Mattheisen</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>R.K.</given-names>
          </name>
          <name>
            <surname>Won</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Pallesen</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Agerbo</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Andreassen</surname>
            <given-names>O.A.</given-names>
          </name>
          <name>
            <surname>Anney</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Awashti</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of common genetic risk variants for autism spectrum disorder</article-title>
        <source>Nat. Genet.</source>
        <volume>51</volume>
        <year>2019</year>
        <fpage>431</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-019-0344-8</pub-id>
        <pub-id pub-id-type="pmid">30804558</pub-id>
      </element-citation>
    </ref>
    <ref id="bib41">
      <label>42</label>
      <element-citation publication-type="journal" id="sref41">
        <person-group person-group-type="author">
          <name>
            <surname>Carvill</surname>
            <given-names>G.L.</given-names>
          </name>
          <name>
            <surname>Heavin</surname>
            <given-names>S.B.</given-names>
          </name>
          <name>
            <surname>Yendle</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>McMahon</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>O’Roak</surname>
            <given-names>B.J.</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Dorschner</surname>
            <given-names>M.O.</given-names>
          </name>
          <name>
            <surname>Weaver</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Calvert</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Targeted resequencing in epileptic encephalopathies identifies de novo mutations in CHD2 and SYNGAP1</article-title>
        <source>Nat. Genet.</source>
        <volume>45</volume>
        <year>2013</year>
        <fpage>825</fpage>
        <lpage>830</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2646</pub-id>
        <pub-id pub-id-type="pmid">23708187</pub-id>
      </element-citation>
    </ref>
    <ref id="bib42">
      <label>43</label>
      <element-citation publication-type="journal" id="sref42">
        <person-group person-group-type="author">
          <name>
            <surname>Neale</surname>
            <given-names>B.M.</given-names>
          </name>
          <name>
            <surname>Kou</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Ma’ayan</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Samocha</surname>
            <given-names>K.E.</given-names>
          </name>
          <name>
            <surname>Sabo</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C.-F.</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L.-S.</given-names>
          </name>
          <name>
            <surname>Makarov</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Patterns and rates of exonic de novo mutations in autism spectrum disorders</article-title>
        <source>Nature</source>
        <volume>485</volume>
        <year>2012</year>
        <fpage>242</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11011</pub-id>
        <pub-id pub-id-type="pmid">22495311</pub-id>
      </element-citation>
    </ref>
    <ref id="bib43">
      <label>44</label>
      <element-citation publication-type="journal" id="sref43">
        <person-group person-group-type="author">
          <name>
            <surname>Carroll</surname>
            <given-names>L.S.</given-names>
          </name>
          <name>
            <surname>Woolf</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>H.J.</given-names>
          </name>
          <name>
            <surname>Dwyer</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kirov</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>O’Donovan</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Owen</surname>
            <given-names>M.J.</given-names>
          </name>
        </person-group>
        <article-title>Mutation screening of SCN2A in schizophrenia and identification of a novel loss-of-function mutation</article-title>
        <source>Psychiatr. Genet.</source>
        <volume>26</volume>
        <year>2016</year>
        <fpage>60</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1097/ypg.0000000000000110</pub-id>
        <pub-id pub-id-type="pmid">26555645</pub-id>
      </element-citation>
    </ref>
    <ref id="bib44">
      <label>45</label>
      <element-citation publication-type="journal" id="sref44">
        <person-group person-group-type="author">
          <name>
            <surname>Nagy</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Maitra</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Tanti</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Suderman</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Théroux</surname>
            <given-names>J.F.</given-names>
          </name>
          <name>
            <surname>Davoli</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Perlman</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Yerko</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y.C.</given-names>
          </name>
          <name>
            <surname>Tripathy</surname>
            <given-names>S.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-nucleus transcriptomics of the prefrontal cortex in major depressive disorder implicates oligodendrocyte precursor cells and excitatory neurons</article-title>
        <source>Nat. Neurosci.</source>
        <volume>23</volume>
        <year>2020</year>
        <fpage>771</fpage>
        <lpage>781</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-020-0621-y</pub-id>
        <pub-id pub-id-type="pmid">32341540</pub-id>
      </element-citation>
    </ref>
    <ref id="bib45">
      <label>46</label>
      <element-citation publication-type="journal" id="sref45">
        <person-group person-group-type="author">
          <name>
            <surname>Jansen</surname>
            <given-names>I.E.</given-names>
          </name>
          <name>
            <surname>Savage</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Watanabe</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Bryois</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Steinberg</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sealock</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Karlsson</surname>
            <given-names>I.K.</given-names>
          </name>
          <name>
            <surname>Hägg</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Athanasiu</surname>
            <given-names>L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide meta-analysis identifies new loci and functional pathways influencing Alzheimer’s disease risk</article-title>
        <source>Nat. Genet.</source>
        <volume>51</volume>
        <year>2019</year>
        <fpage>404</fpage>
        <lpage>413</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0311-9</pub-id>
        <pub-id pub-id-type="pmid">30617256</pub-id>
      </element-citation>
    </ref>
    <ref id="bib46">
      <label>47</label>
      <element-citation publication-type="journal" id="sref46">
        <person-group person-group-type="author">
          <name>
            <surname>Kunkle</surname>
            <given-names>B.W.</given-names>
          </name>
          <name>
            <surname>Grenier-Boley</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Sims</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Bis</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Damotte</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Naj</surname>
            <given-names>A.C.</given-names>
          </name>
          <name>
            <surname>Boland</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Vronskaya</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>van der Lee</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Amlie-Wolf</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic meta-analysis of diagnosed Alzheimer’s disease identifies new risk loci and implicates A, tau, immunity and lipid processing</article-title>
        <source>Nat. Genet.</source>
        <volume>51</volume>
        <year>2019</year>
        <fpage>414</fpage>
        <lpage>430</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-019-0358-2</pub-id>
        <pub-id pub-id-type="pmid">30820047</pub-id>
      </element-citation>
    </ref>
    <ref id="bib47">
      <label>48</label>
      <element-citation publication-type="journal" id="sref47">
        <person-group person-group-type="author">
          <name>
            <surname>Schwartzentruber</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J.Z.</given-names>
          </name>
          <name>
            <surname>Barrio-Hernandez</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Bello</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kumasaka</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>A.M.H.</given-names>
          </name>
          <name>
            <surname>Franklin</surname>
            <given-names>R.J.M.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Estrada</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide meta-analysis, fine-mapping and integrative prioritization implicate new Alzheimer’s disease risk genes</article-title>
        <source>Nat. Genet.</source>
        <volume>53</volume>
        <year>2021</year>
        <fpage>392</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-020-00776-w</pub-id>
        <pub-id pub-id-type="pmid">33589840</pub-id>
      </element-citation>
    </ref>
    <ref id="bib48">
      <label>49</label>
      <element-citation publication-type="journal" id="sref48">
        <person-group person-group-type="author">
          <name>
            <surname>Bellenguez</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Küçükali</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>I.E.</given-names>
          </name>
          <name>
            <surname>Kleineidam</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Moreno-Grau</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Amin</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Naj</surname>
            <given-names>A.C.</given-names>
          </name>
          <name>
            <surname>Campos-Martin</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Grenier-Boley</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Andrade</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>New insights into the genetic etiology of Alzheimer’s disease and related dementias</article-title>
        <source>Nat. Genet.</source>
        <volume>54</volume>
        <year>2022</year>
        <fpage>412</fpage>
        <lpage>436</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-022-01024-z</pub-id>
        <pub-id pub-id-type="pmid">35379992</pub-id>
      </element-citation>
    </ref>
    <ref id="bib49">
      <label>50</label>
      <element-citation publication-type="journal" id="sref49">
        <person-group person-group-type="author">
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Spinrad</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Matcovitch-Natan</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Dvir-Szternfeld</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ulland</surname>
            <given-names>T.K.</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Baruch</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Lara-Astaiso</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Toth</surname>
            <given-names>B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A unique microglia type associated with restricting development of Alzheimer’s disease</article-title>
        <source>Cell</source>
        <volume>169</volume>
        <year>2017</year>
        <fpage>1276</fpage>
        <lpage>1290.e17</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.05.018</pub-id>
        <pub-id pub-id-type="pmid">28602351</pub-id>
      </element-citation>
    </ref>
    <ref id="bib50">
      <label>51</label>
      <element-citation publication-type="journal" id="sref50">
        <person-group person-group-type="author">
          <name>
            <surname>Sala Frigerio</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Wolfs</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Fattorelli</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Thrupp</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Voytyuk</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Mancuso</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W.-T.</given-names>
          </name>
          <name>
            <surname>Woodbury</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The major risk factors for Alzheimer’s disease: age, sex, and genes modulate the microglia response to A plaques</article-title>
        <source>Cell Rep.</source>
        <volume>27</volume>
        <year>2019</year>
        <fpage>1293</fpage>
        <lpage>1306.e6</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2019.03.099</pub-id>
        <pub-id pub-id-type="pmid">31018141</pub-id>
      </element-citation>
    </ref>
    <ref id="bib54">
      <label>52</label>
      <element-citation publication-type="journal" id="sref54">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Dey</surname>
            <given-names>K.K.</given-names>
          </name>
          <name>
            <surname>Sakaue</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Jagadeesh</surname>
            <given-names>K.A.</given-names>
          </name>
          <name>
            <surname>Weinand</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Taychameekiatchai</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Pisco</surname>
            <given-names>A.O.</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Polygenic enrichment distinguishes disease associations of individual cells in single-cell RNA-seq data</article-title>
        <source>Nat. Genet.</source>
        <volume>54</volume>
        <year>2022</year>
        <fpage>1572</fpage>
        <lpage>1580</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-022-01167-z</pub-id>
        <pub-id pub-id-type="pmid">36050550</pub-id>
      </element-citation>
    </ref>
    <ref id="bib51">
      <label>53</label>
      <element-citation publication-type="journal" id="sref51">
        <person-group person-group-type="author">
          <name>
            <surname>Borda</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Mohan</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hasegawa</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bernardino</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Jean</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Aye</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Lackner</surname>
            <given-names>A.A.</given-names>
          </name>
        </person-group>
        <article-title>CD163, a marker of perivascular macrophages, is up-regulated by microglia in simian immunodeficiency virus encephalitis after haptoglobin-hemoglobin complex stimulation and is suggestive of breakdown of the blood-brain barrier</article-title>
        <source>Am. J. Pathol.</source>
        <volume>172</volume>
        <year>2008</year>
        <fpage>725</fpage>
        <lpage>737</lpage>
        <pub-id pub-id-type="doi">10.2353/ajpath.2008.070848</pub-id>
        <pub-id pub-id-type="pmid">18276779</pub-id>
      </element-citation>
    </ref>
    <ref id="bib52">
      <label>54</label>
      <element-citation publication-type="journal" id="sref52">
        <person-group person-group-type="author">
          <name>
            <surname>Pey</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Pearce</surname>
            <given-names>R.K.B.</given-names>
          </name>
          <name>
            <surname>Kalaitzakis</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Griffin</surname>
            <given-names>W.S.T.</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>S.M.</given-names>
          </name>
        </person-group>
        <article-title>Phenotypic profile of alternative activation marker CD163 is different in Alzheimer’s and Parkinson’s disease</article-title>
        <source>Acta Neuropathol. Commun.</source>
        <volume>2</volume>
        <year>2014</year>
        <fpage>21</fpage>
        <pub-id pub-id-type="doi">10.1186/2051-5960-2-21</pub-id>
        <pub-id pub-id-type="pmid">24528486</pub-id>
      </element-citation>
    </ref>
    <ref id="bib53">
      <label>55</label>
      <element-citation publication-type="journal" id="sref53">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>A.T.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Azevedo</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Suh</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Van Deerlin</surname>
            <given-names>V.M.</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Roeder</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>APOE and TREM2 regulate amyloid-responsive microglia in Alzheimer’s disease</article-title>
        <source>Acta Neuropathol.</source>
        <volume>140</volume>
        <year>2020</year>
        <fpage>477</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="doi">10.1007/s00401-020-02200-3</pub-id>
        <pub-id pub-id-type="pmid">32840654</pub-id>
      </element-citation>
    </ref>
    <ref id="bib55">
      <label>56</label>
      <element-citation publication-type="journal" id="sref55">
        <person-group person-group-type="author">
          <name>
            <surname>Morabito</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Miyoshi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Michael</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Swarup</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>Integrative genomics approach identifies conserved transcriptomic networks in Alzheimer’s disease</article-title>
        <source>Hum. Mol. Genet.</source>
        <volume>29</volume>
        <year>2020</year>
        <fpage>2899</fpage>
        <lpage>2919</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddaa182</pub-id>
        <pub-id pub-id-type="pmid">32803238</pub-id>
      </element-citation>
    </ref>
    <ref id="bib56">
      <label>57</label>
      <element-citation publication-type="journal" id="sref56">
        <person-group person-group-type="author">
          <name>
            <surname>Leng</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Eser</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Piergies</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sit</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.H.</given-names>
          </name>
          <name>
            <surname>Rodriguez</surname>
            <given-names>R.D.</given-names>
          </name>
          <name>
            <surname>Suemoto</surname>
            <given-names>C.K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular characterization of selectively vulnerable neurons in Alzheimer’s disease</article-title>
        <source>Nat. Neurosci.</source>
        <volume>24</volume>
        <year>2021</year>
        <fpage>276</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-020-00764-7</pub-id>
        <pub-id pub-id-type="pmid">33432193</pub-id>
      </element-citation>
    </ref>
    <ref id="bib57">
      <label>58</label>
      <element-citation publication-type="journal" id="sref57">
        <person-group person-group-type="author">
          <name>
            <surname>Gerrits</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Brouwer</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Kooistra</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Woodbury</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Vermeiren</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Lambourne</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Mulder</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kummer</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Möller</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Biber</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distinct amyloid- and tau-associated microglia profiles in Alzheimer’s disease</article-title>
        <source>Acta Neuropathol.</source>
        <volume>141</volume>
        <year>2021</year>
        <fpage>681</fpage>
        <lpage>696</lpage>
        <pub-id pub-id-type="doi">10.1007/s00401-021-02263-w</pub-id>
        <pub-id pub-id-type="pmid">33609158</pub-id>
      </element-citation>
    </ref>
    <ref id="bib58">
      <label>59</label>
      <element-citation publication-type="journal" id="sref58">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Madad</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Lareau</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell chromatin state analysis with Signac</article-title>
        <source>Nat. Methods</source>
        <volume>18</volume>
        <year>2021</year>
        <fpage>1333</fpage>
        <lpage>1341</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01282-5</pub-id>
        <pub-id pub-id-type="pmid">34725479</pub-id>
      </element-citation>
    </ref>
    <ref id="bib59">
      <label>60</label>
      <element-citation publication-type="journal" id="sref59">
        <person-group person-group-type="author">
          <collab>ENCODE Project Consortium</collab>
          <name>
            <surname>Moore</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Purcaro</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Pratt</surname>
            <given-names>H.E.</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>C.B.</given-names>
          </name>
          <name>
            <surname>Shoresh</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Adrian</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kawli</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Dobin</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expanded encyclopaedias of DNA elements in the human and mouse genomes</article-title>
        <source>Nature</source>
        <volume>583</volume>
        <year>2020</year>
        <fpage>699</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2493-4</pub-id>
        <pub-id pub-id-type="pmid">32728249</pub-id>
      </element-citation>
    </ref>
    <ref id="bib60">
      <label>61</label>
      <element-citation publication-type="journal" id="sref60">
        <person-group person-group-type="author">
          <collab>GTEx Consortium</collab>
        </person-group>
        <article-title>The GTEx Consortium atlas of genetic regulatory effects across human tissues</article-title>
        <source>Science</source>
        <volume>369</volume>
        <year>2020</year>
        <fpage>1318</fpage>
        <lpage>1330</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaz1776</pub-id>
        <pub-id pub-id-type="pmid">32913098</pub-id>
      </element-citation>
    </ref>
    <ref id="bib61">
      <label>62</label>
      <element-citation publication-type="journal" id="sref61">
        <person-group person-group-type="author">
          <name>
            <surname>Hoadley</surname>
            <given-names>K.A.</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Hinoue</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Lazar</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Drill</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Cherniack</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Thorsson</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell-of-Origin patterns dominate the molecular classification of 10,000 tumors from 33 types of cancer</article-title>
        <source>Cell</source>
        <volume>173</volume>
        <year>2018</year>
        <fpage>291</fpage>
        <lpage>304.e6</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.022</pub-id>
        <pub-id pub-id-type="pmid">29625048</pub-id>
      </element-citation>
    </ref>
    <ref id="bib62">
      <label>63</label>
      <element-citation publication-type="journal" id="sref62">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>Y.-W.</given-names>
          </name>
          <name>
            <surname>Al-Ouran</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Mangleburg</surname>
            <given-names>C.G.</given-names>
          </name>
          <name>
            <surname>Perumal</surname>
            <given-names>T.M.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>T.V.</given-names>
          </name>
          <name>
            <surname>Allison</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Swarup</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Funk</surname>
            <given-names>C.C.</given-names>
          </name>
          <name>
            <surname>Gaiteri</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Meta-analysis of the Alzheimer’s disease human brain transcriptome and functional dissection in mouse models</article-title>
        <source>Cell Rep.</source>
        <volume>32</volume>
        <year>2020</year>
        <object-id pub-id-type="publisher-id">107908</object-id>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2020.107908</pub-id>
      </element-citation>
    </ref>
    <ref id="bib63">
      <label>64</label>
      <element-citation publication-type="journal" id="sref63">
        <person-group person-group-type="author">
          <name>
            <surname>Mostafavi</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gaiteri</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>S.E.</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>C.C.</given-names>
          </name>
          <name>
            <surname>Tasaki</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Taga</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>H.-U.</given-names>
          </name>
          <name>
            <surname>Patrick</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Komashko</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A molecular network of the aging human brain provides insights into the pathology and cognitive decline of Alzheimer’s disease</article-title>
        <source>Nat. Neurosci.</source>
        <volume>21</volume>
        <year>2018</year>
        <fpage>811</fpage>
        <lpage>819</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-018-0154-9</pub-id>
        <pub-id pub-id-type="pmid">29802388</pub-id>
      </element-citation>
    </ref>
    <ref id="bib64">
      <label>65</label>
      <element-citation publication-type="journal" id="sref64">
        <person-group person-group-type="author">
          <name>
            <surname>Allen</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Carrasquillo</surname>
            <given-names>M.M.</given-names>
          </name>
          <name>
            <surname>Funk</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Heavner</surname>
            <given-names>B.D.</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Younkin</surname>
            <given-names>C.S.</given-names>
          </name>
          <name>
            <surname>Burgess</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Chai</surname>
            <given-names>H.-S.</given-names>
          </name>
          <name>
            <surname>Crook</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>J.A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human whole genome genotype and transcriptome data for Alzheimer’s and other neurodegenerative diseases</article-title>
        <source>Sci. Data</source>
        <volume>3</volume>
        <year>2016</year>
        <object-id pub-id-type="publisher-id">160089</object-id>
        <pub-id pub-id-type="doi">10.1038/sdata.2016.89</pub-id>
      </element-citation>
    </ref>
    <ref id="bib65">
      <label>66</label>
      <element-citation publication-type="journal" id="sref65">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Beckmann</surname>
            <given-names>N.D.</given-names>
          </name>
          <name>
            <surname>Roussos</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Ming</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Fullard</surname>
            <given-names>J.F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Mount Sinai cohort of large-scale genomic, transcriptomic and proteomic data in Alzheimer’s disease</article-title>
        <source>Sci. Data</source>
        <volume>5</volume>
        <year>2018</year>
        <object-id pub-id-type="publisher-id">180185</object-id>
        <pub-id pub-id-type="doi">10.1038/sdata.2018.185</pub-id>
      </element-citation>
    </ref>
    <ref id="bib66">
      <label>67</label>
      <element-citation publication-type="journal" id="sref66">
        <person-group person-group-type="author">
          <name>
            <surname>Swarup</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Duong</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Dammer</surname>
            <given-names>E.B.</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lah</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>E.C.B.</given-names>
          </name>
          <name>
            <surname>Seyfried</surname>
            <given-names>N.T.</given-names>
          </name>
          <name>
            <surname>Levey</surname>
            <given-names>A.I.</given-names>
          </name>
          <name>
            <surname>Geschwind</surname>
            <given-names>D.H.</given-names>
          </name>
        </person-group>
        <article-title>Identification of conserved proteomic networks in neurodegenerative dementia</article-title>
        <source>Cell Rep.</source>
        <volume>31</volume>
        <year>2020</year>
        <object-id pub-id-type="publisher-id">107807</object-id>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2020.107807</pub-id>
      </element-citation>
    </ref>
    <ref id="bib67">
      <label>68</label>
      <element-citation publication-type="journal" id="sref67">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>E.C.B.</given-names>
          </name>
          <name>
            <surname>Dammer</surname>
            <given-names>E.B.</given-names>
          </name>
          <name>
            <surname>Duong</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Ping</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Higginbotham</surname>
            <given-names>L.A.</given-names>
          </name>
          <name>
            <surname>Guajardo</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Troncoso</surname>
            <given-names>J.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale proteomic analysis of Alzheimer’s disease brain and cerebrospinal fluid reveals early changes in energy metabolism associated with microglia and astrocyte activation</article-title>
        <source>Nat. Med.</source>
        <volume>26</volume>
        <year>2020</year>
        <fpage>769</fpage>
        <lpage>780</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-020-0815-6</pub-id>
        <pub-id pub-id-type="pmid">32284590</pub-id>
      </element-citation>
    </ref>
    <ref id="bib68">
      <label>69</label>
      <element-citation publication-type="journal" id="sref68">
        <person-group person-group-type="author">
          <name>
            <surname>Kelly</surname>
            <given-names>R.T.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell proteomics: progress and prospects</article-title>
        <source>Mol. Cell. Proteomics</source>
        <volume>19</volume>
        <year>2020</year>
        <fpage>1739</fpage>
        <lpage>1748</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.r120.002234</pub-id>
        <pub-id pub-id-type="pmid">32847821</pub-id>
      </element-citation>
    </ref>
    <ref id="bib69">
      <label>70</label>
      <element-citation publication-type="journal" id="sref69">
        <person-group person-group-type="author">
          <name>
            <surname>Aibar</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>González-Blas</surname>
            <given-names>C.B.</given-names>
          </name>
          <name>
            <surname>Moerman</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Huynh-Thu</surname>
            <given-names>V.A.</given-names>
          </name>
          <name>
            <surname>Imrichova</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Hulselmans</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Rambow</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Marine</surname>
            <given-names>J.-C.</given-names>
          </name>
          <name>
            <surname>Geurts</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Aerts</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SCENIC: single-cell regulatory network inference and clustering</article-title>
        <source>Nat. Methods</source>
        <volume>14</volume>
        <year>2017</year>
        <fpage>1083</fpage>
        <lpage>1086</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4463</pub-id>
        <pub-id pub-id-type="pmid">28991892</pub-id>
      </element-citation>
    </ref>
    <ref id="bib70">
      <label>71</label>
      <element-citation publication-type="journal" id="sref70">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Guerrero-Juarez</surname>
            <given-names>C.F.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Ramos</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Kuan</surname>
            <given-names>C.-H.</given-names>
          </name>
          <name>
            <surname>Myung</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Plikus</surname>
            <given-names>M.V.</given-names>
          </name>
          <name>
            <surname>Nie</surname>
            <given-names>Q.</given-names>
          </name>
        </person-group>
        <article-title>Inference and analysis of cell-cell communication using CellChat</article-title>
        <source>Nat. Commun.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>1088</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-21246-9</pub-id>
        <pub-id pub-id-type="pmid">33597522</pub-id>
      </element-citation>
    </ref>
    <ref id="bib78">
      <label>72</label>
      <element-citation publication-type="journal" id="sref78">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>F.A.</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F.J.</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol.</source>
        <volume>19</volume>
        <year>2018</year>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="bib81">
      <label>73</label>
      <element-citation publication-type="journal" id="sref81">
        <person-group person-group-type="author">
          <name>
            <surname>Wolock</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>A.M.</given-names>
          </name>
        </person-group>
        <article-title>Scrublet: computational identification of cell doublets in single-cell transcriptomic data</article-title>
        <source>Cell Syst.</source>
        <volume>8</volume>
        <year>2019</year>
        <fpage>281</fpage>
        <lpage>291.e9</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2018.11.005</pub-id>
        <pub-id pub-id-type="pmid">30954476</pub-id>
      </element-citation>
    </ref>
    <ref id="bib80">
      <label>74</label>
      <element-citation publication-type="journal" id="sref80">
        <person-group person-group-type="author">
          <name>
            <surname>Fleming</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Babadi</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>CellBender remove-background: a deep generative model for unsupervised removal of background noise from scRNA-seq datasets</article-title>
        <comment>Preprint at</comment>
        <source>bioRxiv</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1101/791699</pub-id>
      </element-citation>
    </ref>
    <ref id="bib72">
      <label>75</label>
      <element-citation publication-type="journal" id="sref72">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.J.</given-names>
          </name>
        </person-group>
        <article-title>Statistics or biology: the zero-inflation controversy about scRNA-seq data</article-title>
        <source>Genome Biol.</source>
        <volume>23</volume>
        <year>2022</year>
        <fpage>31</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02601-5</pub-id>
        <pub-id pub-id-type="pmid">35063006</pub-id>
      </element-citation>
    </ref>
    <ref id="bib73">
      <label>76</label>
      <element-citation publication-type="journal" id="sref73">
        <person-group person-group-type="author">
          <name>
            <surname>Beygelzimer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kakadet</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Langford</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Arya</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Fnn: fast nearest neighbor search algorithms and applications</article-title>
        <source>R package version</source>
        <volume>1</volume>
        <year>2013</year>
        <fpage>1</fpage>
        <lpage>17</lpage>
      </element-citation>
    </ref>
    <ref id="bib74">
      <label>77</label>
      <element-citation publication-type="journal" id="sref74">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>A general framework for weighted gene Co-expression network analysis</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <volume>4</volume>
        <year>2005</year>
        <fpage>Article17</fpage>
        <pub-id pub-id-type="doi">10.2202/1544-6115.1128</pub-id>
        <pub-id pub-id-type="pmid">16646834</pub-id>
      </element-citation>
    </ref>
    <ref id="bib75">
      <label>78</label>
      <element-citation publication-type="journal" id="sref75">
        <person-group person-group-type="author">
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Geometric interpretation of gene coexpression network analysis</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>4</volume>
        <year>2008</year>
        <object-id pub-id-type="publisher-id">e1000117</object-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000117</pub-id>
      </element-citation>
    </ref>
    <ref id="bib76">
      <label>79</label>
      <element-citation publication-type="journal" id="sref76">
        <person-group person-group-type="author">
          <name>
            <surname>Luecken</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Büttner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Chaichoompu</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Danese</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Interlandi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>M.F.</given-names>
          </name>
          <name>
            <surname>Strobl</surname>
            <given-names>D.C.</given-names>
          </name>
          <name>
            <surname>Zappia</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Dugas</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Colomé-Tatché</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F.J.</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking atlas-level data integration in single-cell genomics</article-title>
        <source>Nat. Methods</source>
        <volume>19</volume>
        <year>2022</year>
        <fpage>41</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01336-8</pub-id>
        <pub-id pub-id-type="pmid">34949812</pub-id>
      </element-citation>
    </ref>
    <ref id="bib77">
      <label>80</label>
      <element-citation publication-type="journal" id="sref77">
        <person-group person-group-type="author">
          <name>
            <surname>Granja</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>S.E.</given-names>
          </name>
          <name>
            <surname>Bagdatli</surname>
            <given-names>S.T.</given-names>
          </name>
          <name>
            <surname>Choudhry</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>H.Y.</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>W.J.</given-names>
          </name>
        </person-group>
        <article-title>ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis</article-title>
        <source>Nat. Genet.</source>
        <volume>53</volume>
        <year>2021</year>
        <fpage>403</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00790-6</pub-id>
        <pub-id pub-id-type="pmid">33633365</pub-id>
      </element-citation>
    </ref>
    <ref id="bib79">
      <label>81</label>
      <element-citation publication-type="journal" id="sref79">
        <person-group person-group-type="author">
          <name>
            <surname>Melsted</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Booeshaghi</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Min</surname>
            <given-names>K.H.J.</given-names>
          </name>
          <name>
            <surname>da Veiga Beltrame</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Hjörleifsson</surname>
            <given-names>K.E.</given-names>
          </name>
          <name>
            <surname>Gehring</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Modular, efficient and constant-memory single-cell RNA-seq preprocessing</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>39</volume>
        <year>2021</year>
        <fpage>813</fpage>
        <lpage>818</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00870-2</pub-id>
        <pub-id pub-id-type="pmid">33795888</pub-id>
      </element-citation>
    </ref>
    <ref id="bib82">
      <label>82</label>
      <element-citation publication-type="journal" id="sref82">
        <person-group person-group-type="author">
          <name>
            <surname>Traag</surname>
            <given-names>V.A.</given-names>
          </name>
          <name>
            <surname>Waltman</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>van Eck</surname>
            <given-names>N.J.</given-names>
          </name>
        </person-group>
        <article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>
        <source>Sci. Rep.</source>
        <volume>9</volume>
        <year>2019</year>
        <fpage>5233</fpage>
        <pub-id pub-id-type="other">10.1038/s41598-019-41695-z. arXiv:1810.08473</pub-id>
        <pub-id pub-id-type="pmid">30914743</pub-id>
      </element-citation>
    </ref>
    <ref id="bib83">
      <label>83</label>
      <element-citation publication-type="journal" id="sref83">
        <person-group person-group-type="author">
          <name>
            <surname>Plaisier</surname>
            <given-names>S.B.</given-names>
          </name>
          <name>
            <surname>Taschereau</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Graeber</surname>
            <given-names>T.G.</given-names>
          </name>
        </person-group>
        <article-title>Rank–rank hypergeometric overlap: identification of statistically significant overlap between gene-expression signatures</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>38</volume>
        <year>2010</year>
        <fpage>e169</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq636</pub-id>
        <pub-id pub-id-type="pmid">20660011</pub-id>
      </element-citation>
    </ref>
    <ref id="bib84">
      <label>84</label>
      <element-citation publication-type="journal" id="sref84">
        <person-group person-group-type="author">
          <name>
            <surname>Blondel</surname>
            <given-names>V.D.</given-names>
          </name>
          <name>
            <surname>Guillaume</surname>
            <given-names>J.-L.</given-names>
          </name>
          <name>
            <surname>Lambiotte</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Lefebvre</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Fast unfolding of communities in large networks</article-title>
        <source>J. Stat. Mech.</source>
        <volume>2008</volume>
        <year>2008</year>
        <object-id pub-id-type="publisher-id">P10008</object-id>
        <pub-id pub-id-type="doi">10.1088/1742-5468/2008/10/p10008</pub-id>
      </element-citation>
    </ref>
    <ref id="bib85">
      <label>85</label>
      <element-citation publication-type="journal" id="sref85">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>E.Y.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>C.M.</given-names>
          </name>
          <name>
            <surname>Kou</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Meirelles</surname>
            <given-names>G.V.</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>N.R.</given-names>
          </name>
          <name>
            <surname>Ma’ayan</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Enrichr: interactive and collaborative HTML5 gene list enrichment analysis tool</article-title>
        <source>BMC Bioinf.</source>
        <volume>14</volume>
        <year>2013</year>
        <fpage>128</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-128</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="appsec2" sec-type="supplementary-material">
    <title>Supplemental information</title>
    <p id="p0385">
      <supplementary-material content-type="local-data" id="mmc1">
        <caption>
          <title>Document S1. Figures S1–S11</title>
        </caption>
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc2">
        <caption>
          <title>Data S1. Gene co-expression module assignments, related to Figures 1, 3, 4, 5, and 6</title>
        </caption>
        <media xlink:href="mmc2.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc3">
        <caption>
          <title>Data S2. Pathway enrichment results from gene co-expression modules, related to Figures 1, 3, 4, 5, and 6</title>
        </caption>
        <media xlink:href="mmc3.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc4">
        <caption>
          <title>Data S3. DME results, related to Figures 1, 3, 4, 5, and 6</title>
        </caption>
        <media xlink:href="mmc4.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc5">
        <caption>
          <title>Document S2. Article plus supplemental information</title>
        </caption>
        <media xlink:href="mmc5.pdf"/>
      </supplementary-material>
    </p>
  </sec>
  <sec sec-type="data-availability" id="da0010">
    <title>Data and code availability</title>
    <p id="p0030">
      <list list-type="simple" id="ulist0015">
        <list-item id="u0030">
          <label>•</label>
          <p id="p0035">All of the sequencing data used in this paper were obtained from publicly available sources, and are listed in the <xref rid="sec4.1" ref-type="sec">key resources table</xref>.</p>
        </list-item>
        <list-item id="u0035">
          <label>•</label>
          <p id="p0040">The hdWGCNA R package has been deposited at Zenodo (see <xref rid="sec4.1" ref-type="sec">key resources table</xref>). The R package code and full tutorials are available at <ext-link ext-link-type="uri" xlink:href="https://swaruplab.bio.uci.edu/hdWGCNA" id="intref0010">https://swaruplab.bio.uci.edu/hdWGCNA</ext-link>. The data processing and analysis code has been deposited at Zenodo (see <xref rid="sec4.1" ref-type="sec">key resources table</xref>) and is available on GitHub at this repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/smorabit/hdWGCNA_paper" id="intref0015">https://github.com/smorabit/hdWGCNA_paper</ext-link>.</p>
        </list-item>
        <list-item id="u0040">
          <label>•</label>
          <p id="p0045">Any additional information required to reanalyze the data reported in this paper is available from the <xref rid="sec4.2.1" ref-type="sec">lead contact</xref> upon request.</p>
        </list-item>
      </list>
    </p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0365">Funding for this work was provided by <funding-source id="gs1">National Institutes on Aging, Neurological Disorders and Stroke, and Drug Abuse</funding-source> grants 1RF1AG071683, P01NS084974- 06A1, 1U01DA053826, U54 AG054349-06 (MODEL-AD), and 3U19AG068054-02S, <funding-source id="gs2">Adelson Medical Research Foundation funds</funding-source> to V.S. This work utilized the infrastructure for high-performance and high-throughput computing, research data storage and analysis, and scientific software tool integration built, operated, and updated by the <funding-source id="gs3">Research Cyberinfrastructure Center</funding-source> (RCIC) at the <funding-source id="gs4"><institution-wrap><institution-id institution-id-type="doi">10.13039/100005595</institution-id><institution>University of California</institution></institution-wrap></funding-source>, Irvine (UCI). We thank Anoushka Joglekar for providing the ScISOrSeq dataset.</p>
    <sec id="sec5">
      <title>Author contributions</title>
      <p id="p0370">S.M. and V.S. conceptualized this study. The manuscript was written by S.M., F.R., and E.M. with assistance and approval from all authors. S.M. developed the hdWGCNA R package. S.M. and F.R. designed the structure of the hdWGCNA R package. S.M. collected, processed, and performed network analysis on publicly available sequencing datasets. F.R. performed bioinformatics analysis of the ScISOrSeq dataset. N.R. performed polygenic risk analysis of the integrated microglia snRNA-seq dataset.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec6">
      <title>Declaration of interests</title>
      <p id="p0375">The authors declare no competing interests.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="appsec1" fn-type="supplementary-material">
      <p id="p0380">Supplemental information can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.crmeth.2023.100498" id="intref0130">https://doi.org/10.1016/j.crmeth.2023.100498</ext-link>.</p>
    </fn>
  </fn-group>
</back>
<?DTDIdentifier.IdentifierValue -//ES//DTD journal article DTD version 5.6.0//EN//XML?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName art560.dtd?>
<?SourceDTD.Version 5.6.0?>
<?ConverterInfo.XSLTName elsevier2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<?origin publisher?>
<?FILEmeta_CRMETH100498 xml ?>
<?FILEmain xml ?>
<?FILEmain pdf ?>
<?FILEgr1 jpg ?>
<?FILEgr2 jpg ?>
<?FILEgr3 jpg ?>
<?FILEgr4 jpg ?>
<?FILEgr5 jpg ?>
<?FILEgr6 jpg ?>
<?FILEgr7 jpg ?>
<?FILEfx1 jpg ?>
<?FILEmmc1 pdf ?>
<?FILEmmc2 xlsx ?>
<?FILEmmc3 xlsx ?>
<?FILEmmc4 xlsx ?>
<?FILEmmc5 pdf ?>
<?FILEsi1 gif ?>
<?FILEsi2 gif ?>
<?FILEsi3 gif ?>
<?FILEsi4 gif ?>
<?FILEsi5 gif ?>
<?FILEsi6 gif ?>
<?FILEsi7 gif ?>
<?FILEsi8 gif ?>
<?FILEsi9 gif ?>
<?FILEsi10 gif ?>
<?FILEsi11 gif ?>
<?FILEsi12 gif ?>
<?FILEsi13 gif ?>
<?FILEsi14 gif ?>
<?FILEsi15 gif ?>
<?FILEsi16 gif ?>
<?FILEsi17 gif ?>
<?FILEsi18 gif ?>
<?FILEsi19 gif ?>
<?FILEsi20 gif ?>
<?FILEsi21 gif ?>
<?FILEsi22 gif ?>
<?FILEsi23 gif ?>
<?FILEsi24 gif ?>
<?FILEsi25 gif ?>
<?FILEsi26 gif ?>
<?FILEsi27 gif ?>
<?FILEsi28 gif ?>
<?FILEsi29 gif ?>
<?FILEsi30 gif ?>
<?FILEsi31 gif ?>
<?FILEsi32 gif ?>
<?FILEsi33 gif ?>
<?FILEsi34 gif ?>
<?FILEsi35 gif ?>
<?FILEsi36 gif ?>
<?FILEsi37 gif ?>
<?FILEsi38 gif ?>
<?FILEsi39 gif ?>
<?FILEsi40 gif ?>
<?FILEsi41 gif ?>
<?FILEsi42 gif ?>
<?FILEsi43 gif ?>
<?FILEsi44 gif ?>
<?FILEsi45 gif ?>
<?FILEsi46 gif ?>
<?FILEsi47 gif ?>
<?FILEsi48 gif ?>
<?FILEsi49 gif ?>
<?FILEsi50 gif ?>
<?FILEsi51 gif ?>
<?FILEsi52 gif ?>
<?FILEsi53 gif ?>
<?FILEsi54 gif ?>
<?FILEsi55 gif ?>
<?FILEsi56 gif ?>
<?FILEsi57 gif ?>
<?FILEsi58 gif ?>
<?FILEsi59 gif ?>
<?FILEsi60 gif ?>
<?FILEsi61 gif ?>
<?FILEsi62 gif ?>
<?FILEsi63 gif ?>
<?FILEsi64 gif ?>
<?FILEsi65 gif ?>
<?FILEsi66 gif ?>
<?FILEsi67 gif ?>
<?FILEsi68 gif ?>
<?FILEsi69 gif ?>
<?FILEsi70 gif ?>
<?FILEsi71 gif ?>
<?FILEsi72 gif ?>
<?FILEsi73 gif ?>
<?FILEsi74 gif ?>
<?FILEsi75 gif ?>
<?FILEsi76 gif ?>
<?FILEsi77 gif ?>
<?FILEsi78 gif ?>
<?FILEsi79 gif ?>
<?FILEsi80 gif ?>
<?FILEsi81 gif ?>
<?FILEsi82 gif ?>
<?FILEsi83 gif ?>
<?FILEsi84 gif ?>
<?FILEsi85 gif ?>
<?FILEsi86 gif ?>
<?FILEsi87 gif ?>
<?FILEsi88 gif ?>
<?FILEsi89 gif ?>
<?FILEsi90 gif ?>
<?FILEsi91 gif ?>
<?FILEsi92 gif ?>
<?FILEsi93 gif ?>
<?FILEsi94 gif ?>
<?FILEsi95 gif ?>
<?FILEsi96 gif ?>
<?FILEsi97 gif ?>
<?FILEsi98 gif ?>
<?FILEsi99 gif ?>
<?FILEsi100 gif ?>
<?FILEsi101 gif ?>
<?FILEsi102 gif ?>
<?FILEsi103 gif ?>
<?FILEsi104 gif ?>
<?FILEsi105 gif ?>
<?FILEsi106 gif ?>
<?FILEsi107 gif ?>
<?FILEsi108 gif ?>
<?FILEsi109 gif ?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Cell Rep Methods</journal-id>
    <journal-id journal-id-type="iso-abbrev">Cell Rep Methods</journal-id>
    <journal-title-group>
      <journal-title>Cell Reports Methods</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2667-2375</issn>
    <publisher>
      <publisher-name>Elsevier</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10326379</article-id>
    <article-id pub-id-type="pii">S2667-2375(23)00127-3</article-id>
    <article-id pub-id-type="doi">10.1016/j.crmeth.2023.100498</article-id>
    <article-id pub-id-type="publisher-id">100498</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>hdWGCNA identifies co-expression networks in high-dimensional transcriptomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="au1">
        <name>
          <surname>Morabito</surname>
          <given-names>Samuel</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author" id="au2">
        <name>
          <surname>Reese</surname>
          <given-names>Fairlie</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff4" ref-type="aff">4</xref>
      </contrib>
      <contrib contrib-type="author" id="au3">
        <name>
          <surname>Rahimzadeh</surname>
          <given-names>Negin</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">1</xref>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff3" ref-type="aff">3</xref>
      </contrib>
      <contrib contrib-type="author" id="au4">
        <name>
          <surname>Miyoshi</surname>
          <given-names>Emily</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">3</xref>
        <xref rid="aff5" ref-type="aff">5</xref>
      </contrib>
      <contrib contrib-type="author" id="au5">
        <name>
          <surname>Swarup</surname>
          <given-names>Vivek</given-names>
        </name>
        <email>vswarup@uci.edu</email>
        <xref rid="aff2" ref-type="aff">2</xref>
        <xref rid="aff3" ref-type="aff">3</xref>
        <xref rid="aff5" ref-type="aff">5</xref>
        <xref rid="fn1" ref-type="fn">6</xref>
        <xref rid="cor1" ref-type="corresp">∗</xref>
      </contrib>
      <aff id="aff1"><label>1</label>Mathematical, Computational, and Systems Biology (MCSB) Program, University of California, Irvine, Irvine, CA, USA</aff>
      <aff id="aff2"><label>2</label>Center for Complex Biological Systems (CCBS), University of California, Irvine, Irvine, CA, USA</aff>
      <aff id="aff3"><label>3</label>Institute for Memory Impairments and Neurological Disorders (MIND), University of California, Irvine, Irvine, CA, USA</aff>
      <aff id="aff4"><label>4</label>Department of Developmental and Cell Biology, University of California, Irvine, Irvine, CA, USA</aff>
      <aff id="aff5"><label>5</label>Department of Neurobiology and Behavior, University of California, Irvine, Irvine, CA, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><label>∗</label>Corresponding author <email>vswarup@uci.edu</email></corresp>
      <fn id="fn1">
        <label>6</label>
        <p id="ntpara0010">Lead contact</p>
      </fn>
    </author-notes>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.-->
    <pub-date pub-type="collection">
      <day>26</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>6</issue>
    <elocation-id>100498</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2023 The Author(s)</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
      </license>
    </permissions>
    <abstract id="abs0010">
      <title>Summary</title>
      <p>Biological systems are immensely complex, organized into a multi-scale hierarchy of functional units based on tightly regulated interactions between distinct molecules, cells, organs, and organisms. While experimental methods enable transcriptome-wide measurements across millions of cells, popular bioinformatic tools do not support systems-level analysis. Here we present hdWGCNA, a comprehensive framework for analyzing co-expression networks in high-dimensional transcriptomics data such as single-cell and spatial RNA sequencing (RNA-seq). hdWGCNA provides functions for network inference, gene module identification, gene enrichment analysis, statistical tests, and data visualization. Beyond conventional single-cell RNA-seq, hdWGCNA is capable of performing isoform-level network analysis using long-read single-cell data. We showcase hdWGCNA using data from autism spectrum disorder and Alzheimer’s disease brain samples, identifying disease-relevant co-expression network modules. hdWGCNA is directly compatible with Seurat, a widely used R package for single-cell and spatial transcriptomics analysis, and we demonstrate the scalability of hdWGCNA by analyzing a dataset containing nearly 1 million cells.</p>
    </abstract>
    <abstract abstract-type="graphical" id="abs0015">
      <title>Graphical abstract</title>
      <fig id="undfig1" position="anchor">
        <graphic xlink:href="fx1"/>
      </fig>
    </abstract>
    <abstract abstract-type="author-highlights" id="abs0020">
      <title>Highlights</title>
      <p>
        <list list-type="simple" id="ulist0010">
          <list-item id="u0010">
            <label>•</label>
            <p id="p0010">hdWGCNA constructs co-expression networks in high-dimensional transcriptomics data</p>
          </list-item>
          <list-item id="u0015">
            <label>•</label>
            <p id="p0015">hdWGCNA provides tools for statistics, visualization, and downstream interpretation</p>
          </list-item>
          <list-item id="u0020">
            <label>•</label>
            <p id="p0020">hdWGCNA is an open-source R package that uses Seurat data structures</p>
          </list-item>
          <list-item id="u0025">
            <label>•</label>
            <p id="p0025">hdWGCNA in human diseases demonstrates real-world analysis in complex datasets</p>
          </list-item>
        </list>
      </p>
    </abstract>
    <abstract abstract-type="editor-highlights" id="abs0025">
      <title>Motivation</title>
      <p>Single-cell and spatial transcriptomics assays are commonly used to profile the molecular signatures of biological systems, yielding high-dimensional datasets that can be used to model gene regulation across cell types, cell states, and spatial niches. Many statistical tools for high-dimensional transcriptomics data analysis focus on individual features rather than the underlying network structure, ignoring potential interactions between transcripts or genes. Here, we introduce hdWGCNA, a comprehensive methodological framework for the inference, analysis, and interpretation of gene co-expression networks in high-dimensional transcriptomics data. hdWGCNA is implemented as an open-source R package that extends the Seurat ecosystem of data analysis tools.</p>
    </abstract>
    <abstract abstract-type="teaser" id="abs0030">
      <p>Morabito et al. present hdWGCNA, an open-source R package for gene co-expression network analysis in single-cell and spatial transcriptomics data. hdWGCNA builds networks of genes using correlation information in specific cell subpopulations and spatial domains. Applications of hdWGCNA in autism spectrum disorder and Alzheimer’s disease revealed disease-associated gene networks.</p>
    </abstract>
    <kwd-group id="kwrds0110">
      <title>Keywords</title>
      <kwd>single-cell genomics</kwd>
      <kwd>single-cell RNA-seq</kwd>
      <kwd>spatial transcriptomics</kwd>
      <kwd>long-read RNA-seq</kwd>
      <kwd>gene network</kwd>
      <kwd>co-expression network</kwd>
      <kwd>Autism spectrum disorder</kwd>
      <kwd>Alzheimer's disease</kwd>
      <kwd>microglia</kwd>
    </kwd-group>
  </article-meta>
  <notes>
    <p id="misc0010">Published: June 12, 2023</p>
  </notes>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p id="p0050">The development and widespread adoption of single-cell and spatial genomics approaches has led to routine generation of high-dimensional datasets in a variety of biological systems. These technologies are frequently used to study developmental stages, evolutionary trajectories, disease states, drug perturbations, and other experimental conditions. Despite the inherent complexity and interconnectedness of biological systems, studies leveraging single-cell and spatial genomics typically analyze individual features (genes, isoforms, proteins, etc.) one by one, greatly oversimplifying the underlying biology. These datasets provide an opportunity for investigating and quantifying the relationships between these features to further contextualize their roles across biological conditions of interest.</p>
    <p id="p0055">Here we developed hdWGCNA, a framework for co-expression network analysis<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref> in single-cell and spatial transcriptomics data. Co-expression networks are based on transformed pairwise correlations of input features, resulting in a quantitative measure of relatedness between genes.<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref><sup>,</sup><xref rid="bib2" ref-type="bibr"><sup>2</sup></xref> Hierarchical clustering on the network structure allows us to uncover functional modules of genes whose expression profiles are tightly intertwined,<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref><sup>,</sup><xref rid="bib4" ref-type="bibr"><sup>4</sup></xref> which typically correspond to specific biological processes and disease states. Considering that unique cell types and cell states have distinct gene expression programs, we designed hdWGCNA to facilitate multi-scale analysis of cellular and spatial hierarchies. hdWGCNA provides a rich suite of functions for data analysis and visualization, providing biological context for co-expression networks by leveraging a variety of biological knowledge databases. To maximize usability among the genomics community, the hdWGCNA R package extends the data structures and functionality of the widely used Seurat package,<xref rid="bib5" ref-type="bibr"><sup>5</sup></xref><sup>,</sup><xref rid="bib6" ref-type="bibr"><sup>6</sup></xref><sup>,</sup><xref rid="bib7" ref-type="bibr"><sup>7</sup></xref> and we developed an extensive documentation website for hdWGCNA demonstrating its use on new datasets. Further, we used hdWGCNA to analyze a single-cell RNA sequencing (scRNA-seq) dataset consisting of 1 million cells, showcasing the scalability of hdWGCNA in large datasets.</p>
    <p id="p0060">In this study, we applied hdWGCNA in a variety of high-dimensional transcriptomics datasets from different technologies and biological conditions. As a common use case, we first performed iterative network analysis of the major cell types in the human prefrontal cortex (PFC), identifying shared and specific network modules in each cell type. We constructed co-expression networks in anterior and posterior mouse brain sections profiled with <inline-formula><mml:math id="M1" altimg="si1.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> Genomics Visium spatial transcriptomics (ST), and found distinct spatial patterns of these gene expression programs. Using long-read scRNA-seq data from the mouse hippocampus,<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> we uncovered splicing isoform co-expression networks in the radial glia lineage involved in cell fate specification. Network analysis of inhibitory neurons from published single-nucleus RNA sequencing (snRNA-seq) in autism spectrum disorder (ASD) donors<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> revealed modules disrupted in ASD containing key genetic risk genes such as <italic>SCN2A</italic>, <italic>TSC1</italic>, and <italic>SHANK2</italic>. We performed consensus co-expression network analysis of microglia from three Alzheimer’s disease (AD) snRNA-seq studies,<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref><sup>,</sup><xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> yielding multiple gene modules corresponding to disease-associated microglia and polygenic risk of AD. Finally, we used hdWGCNA to project gene modules from two bulk RNA-seq studies of AD patients into an snRNA-seq dataset of the AD brain, showing that our approach allows for interrogation of gene modules and networks that have been previously identified.</p>
  </sec>
  <sec id="sec2">
    <title>Results</title>
    <sec id="sec2.1">
      <title>Constructing co-expression networks from high-dimensional transcriptomics data</title>
      <p id="p0065">Here we describe hdWGCNA, a comprehensive framework for constructing and analyzing co-expression networks in high-dimensional transcriptomic data (<xref rid="fig1" ref-type="fig">Figure 1</xref>A). Given a gene expression dataset as input, co-expression network analysis typically consists of the following analysis steps: computing pairwise correlations of input features, weighting correlations with a soft-power threshold <inline-formula><mml:math id="M2" altimg="si2.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, computing the topological overlap between features, and unsupervised clustering via the Dynamic Tree Cut algorithm<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> (<xref rid="mmc1" ref-type="supplementary-material">Figure S1</xref> and <xref rid="sec4" ref-type="sec">STAR Methods</xref>). The sparsity and noise inherent in single-cell data can lead to spurious gene-gene correlations, thereby complicating co-expression network analysis. Additionally, the correlation structure of single-cell or spatial transcriptomic data varies greatly for different subsets (cell types, cell states, anatomical regions). A typical hdWGCNA workflow in scRNA-seq data accounts for these considerations by collapsing highly similar cells into “metacells” to reduce sparsity while retaining cellular heterogeneity and by allowing for a modular design to perform separate network analyses in specified cell populations.<fig id="fig1"><label>Figure 1</label><caption><p>Overview of the hdWGCNA workflow and application in the human prefrontal cortex</p><p>(A) Schematic overview of the standard hdWGCNA workflow on a scRNA-seq dataset. UMAP plot shows 36,671 cells from 11 cognitively normal donors in the Zhou et al. human prefrontal cortex (PFC) dataset. ASC, astrocytes; EX, excitatory neurons; INH, inhibitory neurons; MG, microglia; ODC, oligodendrocytes; OPC, oligodendrocyte progenitor cells.</p><p>(B) Density plot showing the distribution of pairwise Pearson correlations between genes from the single-cell (sc) expression matrix and metacell expression matrices with varying values of the <inline-formula><mml:math id="M3" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>-nearest neighbors parameter <inline-formula><mml:math id="M4" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>.</p><p>(C) Expression matrix density (1, sparsity) for the sc, pseudo-bulk (pb), and metacell matrices with varying values of <inline-formula><mml:math id="M5" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> in each cell type.</p><p>(D) Heatmap of scaled gene expression for the top five hub genes by kME in INH-M6, EX-M2, ODC-M3, OPC-M2, ASC-M18, and MG-M14.</p><p>(E) snRNA-seq UMAP colored by module eigengene (ME) for selected modules as in (D).</p><p>(F) UMAP plot of the ODC co-expression network. Each node represents a single gene, and edges represent co-expression links between genes and module hub genes. Point size is scaled by kME. Nodes are colored by co-expression module assignment. The top two hub genes per module are labeled. Network edges were downsampled for visual clarity.</p><p>(G) snRNA-seq UMAP as in (A) colored by MEs for the 10 ODC co-expression modules as in (F).</p><p>(H) Module preservation analysis of the ODC modules in the Morabito et al.<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> human PFC dataset. The module’s size versus the preservation statistic (<inline-formula><mml:math id="M6" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> preservation) is shown for each module. <inline-formula><mml:math id="M7" altimg="si8.gif"><mml:mrow><mml:mi>Z</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, not preserved; <inline-formula><mml:math id="M8" altimg="si9.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mi>Z</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>, moderately preserved; <inline-formula><mml:math id="M9" altimg="si10.gif"><mml:mrow><mml:mi>Z</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, highly preserved.</p></caption><graphic xlink:href="gr1"/></fig></p>
      <p id="p0070">Metacells are defined as small groups of transcriptomically similar cells representing distinctive cell states. There are several approaches to identify metacells from single-cell genomics data.<xref rid="bib13" ref-type="bibr"><sup>13</sup></xref><sup>,</sup><xref rid="bib14" ref-type="bibr"><sup>14</sup></xref><sup>,</sup><xref rid="bib15" ref-type="bibr"><sup>15</sup></xref><sup>,</sup><xref rid="bib16" ref-type="bibr"><sup>16</sup></xref> We leverage a bootstrapped aggregation (bagging) algorithm for constructing metacell transcriptomic profiles from single-cell datasets by applying K-nearest neighbors (KNN) to a dimensionality-reduced representation of the input dataset (<xref rid="sec4" ref-type="sec">STAR Methods</xref>, <xref rid="tbox1" ref-type="boxed-text">Algorithm 1</xref>). This approach can be performed for each biological replicate to ensure that critical information about each sample (age, sex, disease status, etc.) is retained for downstream analysis. We computed gene-gene correlations in the normalized gene expression matrix from the single-cell dataset and metacell expression matrices while varying the number of cells to collapse into a single metacell (the KNN <inline-formula><mml:math id="M10" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> parameter). The distribution of these gene-gene correlations displays a spike at zero for the single-cell expression matrix, with flattened distributions corresponding to more non-zero correlations in the metacell matrices, indicating that metacell expression profiles are less prone to noisy gene-gene correlations compared with the single-cell matrix (<xref rid="fig1" ref-type="fig">Figure 1</xref>B) (STAR Methods). We note that sparsity (defined in <xref rid="fd1" ref-type="disp-formula">Equation 1</xref>) is greatly reduced in the metacell matrices for each cell type compared with the single-cell matrices, with over a 10-fold reduction in some cases (<xref rid="fig1" ref-type="fig">Figure 1</xref>C). We applied hdWGCNA to a dataset of CD34<sup>+</sup> hematopoietic stem and progenitor stem cells<xref rid="bib16" ref-type="bibr"><sup>16</sup></xref> using two additional metacell approaches<xref rid="bib14" ref-type="bibr"><sup>14</sup></xref><sup>,</sup><xref rid="bib16" ref-type="bibr"><sup>16</sup></xref> and found that all approaches were suitable for downstream network analysis (<xref rid="mmc1" ref-type="supplementary-material">Figure S2</xref>; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>). Metacell algorithms strive to retain biologically meaningful signals spanning a spectrum of cell states in a tissue of interest; therefore, it is necessary to carefully apply these approaches to avoid obscuring these cell states. For example, the hdWGCNA metacell algorithm requires a dimensional reduction of the input expression matrix, but these reductions often contain technical artifacts. The choice of dimensionality reduction method and handling of technical artifacts would then influence the effectiveness of metacell construction. Further, the optimal number of cells to merge together to form a single metacell may differ across cell types and tissues, attempting to balance between increasing information content of the aggregated group while avoiding merging of dissimilar cells. Aside from metacell approaches, pseudo-bulk aggregation of all cells in a given population have yielded favorable results in benchmarks of differential gene expression tests,<xref rid="bib17" ref-type="bibr"><sup>17</sup></xref> suggesting that, given a sufficient sample size, pseudo-bulk expression profiles are likely suitable for co-expression network analysis.</p>
      <p id="p0075">While co-expression modules consist of many genes, it is convenient to summarize the expression of the entire module into a single metric. Module eigengenes (MEs), defined as the first principal component of the module’s gene expression matrix (<xref rid="sec4" ref-type="sec">STAR Methods</xref>, <xref rid="tbox2" ref-type="boxed-text">Algorithm 2</xref>), describe the expression patterns of entire co-expression modules. hdWGCNA computes MEs using specific accommodations for high-dimensional data, allowing for batch correction and regression of continuous covariates (<xref rid="sec4" ref-type="sec">STAR Methods</xref>, <xref rid="tbox2" ref-type="boxed-text">Algorithm 2</xref>). Optionally, hdWGCNA can use alternative gene scoring methods such as or UCell<xref rid="bib18" ref-type="bibr"><sup>18</sup></xref> or Seurat’s AddModuleScore function, and we show that these scores are correlated with MEs (<xref rid="mmc1" ref-type="supplementary-material">Figure S3</xref>).</p>
      <p id="p0080">We demonstrate hdWGCNA in single-cell transcriptomic data through an iterative network analysis of six major cell types in the Zhou et al. human PFC snRNA-seq dataset of 11 cognitively normal donors (<xref rid="fig1" ref-type="fig">Figure 1</xref>A).<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> We constructed metacells and performed co-expression network analysis for each major cell type in the human PFC dataset<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> using the standard hdWGCNA workflow, yielding distinct network structures and sets of gene modules (<xref rid="mmc3" ref-type="supplementary-material">Data S2</xref> and <xref rid="mmc4" ref-type="supplementary-material">S3</xref>). Networks were constructed using metacell expression matrices for each cell type separately, but we computed MEs for each module using the entire snRNA-seq dataset, allowing us to interrogate the cell-type specificity of these modules’ expression programs across all cell types. This iterative network analysis revealed 96 co-expression modules across the six major cell types. Through differential module eigengene (DME) analysis, we found shared and distinct module expression patterns across different cell types (<xref rid="mmc3" ref-type="supplementary-material">Data S2</xref>; <xref rid="sec4" ref-type="sec">STAR Methods</xref>), and we highlight specific modules from each cell type (<xref rid="fig1" ref-type="fig">Figures 1</xref>D and 1E). Further, we performed a pairwise gene set overlap analysis of the 96 co-expression modules, and, while we did find that some modules had significant overlaps across the different cell types, the gene sets comprising these modules were overall quite distinct, with a maximum Jaccard index between two modules of 0.297 and a median of 0.005 (<xref rid="sec4" ref-type="sec">STAR Methods</xref> and <xref rid="mmc1" ref-type="supplementary-material">Figure S4</xref>). The expression of module hub genes, which are highly connected members of the co-expression network ranked by eigengene-based connectivity (kME), tend to display cell-type-specific patterns, such as the myelination genes <italic>CNP</italic> and <italic>PLP1</italic> in oligodendrocyte (ODC) module ODC-M3 (<xref rid="fig1" ref-type="fig">Figure 1</xref>D). However, some co-expression modules may correspond to cellular processes common to multiple cell types, in which case the hub genes may be widely expressed. We inspected the MEs of selected cell-type-specific modules and found that the overall expression patterns were similar to that of their constituent hub genes (<xref rid="fig1" ref-type="fig">Figures 1</xref>D and 1E).</p>
      <p id="p0085">We showcase some of the downstream functionalities of hdWGCNA using the ODC co-expression network (<xref rid="fig1" ref-type="fig">Figures 1</xref>F–1H). For network visualization, we used Uniform Manifold Approximation and Projection (UMAP)<xref rid="bib19" ref-type="bibr"><sup>19</sup></xref> to embed the co-expression network topological overlap matrix (TOM) into a two-dimensional manifold, using the topological overlap of each gene with the top hub genes from each module as input features (<xref rid="sec4" ref-type="sec">STAR Methods</xref>; <xref rid="fig1" ref-type="fig">Figure 1</xref>F). We found that eight of the 10 ODC modules were specifically expressed in ODC cells based on their MEs (<xref rid="fig1" ref-type="fig">Figure 1</xref>G; Wilcoxon rank-sum test Bonferroni-adjusted p &lt;0.05). Finally, we performed module preservation analysis<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> to test the reproducibility of these modules in an independent dataset<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> and found that all of the ODC-specific modules were significantly preserved (<inline-formula><mml:math id="M11" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> summary preservation <inline-formula><mml:math id="M12" altimg="si5.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>). In sum, these network analyses in the human PFC dataset shows the core capabilities of the hdWGCNA workflow (<xref rid="mmc1" ref-type="supplementary-material">Figure S1</xref>). Finally, we performed a similar iterative network analysis on a peripheral blood mononuclear cell (PBMC) scRNA-seq dataset of nearly 1M cells, highlighting the scalability of hdWGCNA in large datasets (<xref rid="mmc1" ref-type="supplementary-material">Figure S5</xref>; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>).</p>
    </sec>
    <sec id="sec2.2">
      <title>Runtime, memory usage, and evaluation of hdWGCNA</title>
      <p id="p0090">We measured the runtime and memory usage of hdWGCNA as a function of the number of input cells. Using the 65,415 neuronal cells from the Velmeshev et al.<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> human PFC snRNA-seq dataset (54 samples), we ran hdWGCNA on different-sized subsets ranging from 1,000 to 50,000 cells to test the runtime and memory consumption of the main network analysis steps (<xref rid="fig2" ref-type="fig">Figures 2</xref>A and 2B). We report the memory upper bound in gigabytes measured throughout the duration of each function. The runtime of the MetacellsByGroups function increased steadily with the number of cells, but the memory usage plateaus. This function attempts to construct a target number of metacells within each biological replicate and each cell population, and the algorithm terminates early if this target is reached, thus explaining the plateau in the memory usage graph. While TestSoftPowers generally had a low memory footprint, it was the slowest individual function based on these tests. Importantly, TestSoftPowers can be sped up by using a subset of the data, or by testing fewer soft-power thresholds than the default. The efficiency of ConstructNetwork varies both with the number of input cells and features, where this calculation will slow down as more cells and features are included. ModuleEigengenes uses the implicitly restarted Lanczos bidiagonalization algorithm (IRLBA)<xref rid="bib21" ref-type="bibr"><sup>21</sup></xref> for fast singular value decomposition (SVD) of sparse matrices, and the runtime and memory usage of this function both linearly increase with the number of cells in the dataset. Optionally, ModuleEigengenes can employ the harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> algorithm following SVD, which increases runtime but not memory usage. Further, the efficiency of this function varies with the number of co-expression modules detected and with the number of features in each modules. Finally, ModuleConnectivity computes eigengene-based connectivity as product-moment correlation coefficients between the sparse gene expression matrix and the MEs matrix, which resulted in fast calculations with low memory usage.<fig id="fig2"><label>Figure 2</label><caption><p>Runtime, memory usage, and performance of hdWGCNA</p><p>(A and B) We ran the main co-expression network analysis functions of the hdWGCNA R package on 65,415 neuronal cells in a human brain dataset<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> from 54 samples, and tracked the runtime (A) and memory usage upper bound (B) for different-sized subsets of the data ranging from 1,000 through 50,000 cells.</p><p>(C) Violin plots showing distributions of EGAD<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref> neighbor-voting area under the receiver operating characteristic curve (AUC) scores in each of the cell-type-specific co-expression networks from the human PFC dataset.<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref></p><p>(D) Violin plots showing distributions of multifunctionality AUC scores in each of the cell-type-specific co-expression networks from the human PFC dataset. ASC, astrocytes; EX, excitatory neurons; INH, inhibitory neurons; MG, microglia; ODC, oligodendrocytes; OPC, oligodendrocyte progenitor cells.</p><p>(E) Performance of the XGBoost regularized regression models used to predict gene expression based on the expression of the top 10 module hub genes for all 96 co-expression modules from the Zhou et al.<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> human PFC dataset. Violin plots showing the test set root-mean-square error (RMSE) comparing the predicted expression with observed for each gene, split by each co-expression module. Modules are ordered within each cell type from lowest mean RMSE to highest.</p></caption><graphic xlink:href="gr2"/></fig></p>
      <p id="p0095">We next sought to evaluate the co-expression networks identified by hdWGCNA using a functional coherence analysis. We used the EGAD neighbor-voting algorithm<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref> to predict known biological pathway associations of genes based on the co-expression network structure using the cell-type-specific co-expression networks from the Zhou et al.<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> human PFC dataset. In principle, we expect that co-expressed genes are involved in similar biological processes, and therefore co-expression network structures should be predictive of biological pathway membership. Briefly, EGAD performs a 3-fold cross-validation classification by occluding the pathway labels of a subset of genes and then attempting to predict the pathway membership of those occluded genes based on their labeled neighbors in the network. We used EGAD to test the functional coherence of our hdWGCNA co-expression networks for a set of Gene Ontology (GO) terms, reporting area under the receiver operating characteristic curve (AUC) value for each term (<xref rid="fig2" ref-type="fig">Figure 2</xref>C). We report a similar level of functional coherence in these co-expression networks to a previous study that evaluated co-expression networks derived from scRNA-seq data with different measures of gene-gene association.<xref rid="bib24" ref-type="bibr"><sup>24</sup></xref> The inhibitory neuron network performed the best for functional coherence with a median neighbor-voting AUC of 0.592, while the lowest-performing network was from the oligodendrocytes with a median AUC of 0.549. We tested whether there was a bias toward genes that were multifunctional based on the frequency that they appeared in the annotated set of GO terms, and we found that multifunctional genes did not bias the co-expression functional coherence results (<xref rid="fig2" ref-type="fig">Figure 2</xref>D).</p>
      <p id="p0100">In principle, genes within the same co-expression modules derived from specific cell types should be functionally related or co-regulated. The expression of module hub genes, which exhibit the highest intramodular connectivity, may be predictive of the expression of other module member genes if the network is well defined and contains meaningful structures. For each of the 96 cell-type PFC co-expression modules, we sought to predict the expression of each gene using the top 10 module hub genes as the input features to a XGBoost<xref rid="bib25" ref-type="bibr"><sup>25</sup></xref> regularized regression model. In this analysis, we performed 5-fold cross-validation, and we report the performance as root-mean-square error (RMSE) of the test set averaged over each fold (<xref rid="fig2" ref-type="fig">Figure 2</xref>E). Overall, we found that module hub gene expression was generally predictive of module member gene expression across all modules in the six cell-type co-expression networks, where the module with the best performance had an average test set RMSE of 0.0159 and the module with the worst performance had an average test set RMSE of 0.209 (<xref rid="fig2" ref-type="fig">Figure 2</xref>E). This analysis and our functional coherence analysis provide support that hdWGCNA co-expression networks and gene modules capture biologically relevant information in specific cell types.</p>
    </sec>
    <sec id="sec2.3">
      <title>Spatial co-expression networks represent regional expression patterns in the mouse brain</title>
      <p id="p0105">ST enables the investigation of biological patterns that might otherwise be hidden in other -omics technologies, such as scRNA-seq or bulk RNA-seq.<xref rid="bib26" ref-type="bibr"><sup>26</sup></xref><sup>,</sup><xref rid="bib27" ref-type="bibr"><sup>27</sup></xref> We used hdWGCNA to identify spatial co-expression network modules in the murine brain using a publicly available Visium transcriptomics dataset from <inline-formula><mml:math id="M13" altimg="si1.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> Genomics (<xref rid="fig3" ref-type="fig">Figure 3</xref>A). This ST dataset consists of one posterior and one anterior slice originating from a sagittal brain section from a single male mouse at 8 weeks of age. Sequencing-based ST approaches such as Visium yield transcriptome-wide gene expression profiles localized to individual “spots” where a single spot likely contains multiple cells, and this dataset is composed of 2,696 spots in the anterior slice and 3,353 spots in the posterior slice. Data sparsity is also inherent to the current generation of these technologies, therefore we propose a metaspot aggregation approach prior to network analysis (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>). Evenly spaced spots throughout the input ST slide are used as principal spots, with at least one other spot in between two principal spots. The transcriptomes of the principal spots and their direct neighbors are aggregated into metaspot expression profiles, containing at most seven ST spots (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>A). Similar to metacells in scRNA-seq, the sparsity of the metaspot expression matrix was reduced compared with the original ST matrix (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>B), and the distribution of gene-gene correlations in the metaspot expression matrix was less concentrated at zero (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>C). hdWGCNA is capable of processing any number of ST samples in the same co-expression network analysis by constructing metaspots separately for each sample.<fig id="fig3"><label>Figure 3</label><caption><p>Spatial co-expression networks represent regional expression patterns in the mouse brain</p><p>(A) Visium spatial transcriptomics (ST) in anterior (left, 2,696 spots) and posterior (right, 3,353 spots) mouse brain sections, colored by Louvain clusters annotated by anatomical regions.</p><p>(B) UMAP plot of the mouse brain ST co-expression network. Each node represents a single gene, and edges represent co-expression links between genes and module hub genes. Point size is scaled by kME. Nodes are colored by co-expression module assignment. The top five hub genes per module are labeled. Network edges were downsampled for visual clarity.</p><p>(C) ST samples colored by MEs for the 12 spatial co-expression modules. Gray color indicates an ME value less than zero.</p></caption><graphic xlink:href="gr3"/></fig></p>
      <p id="p0110">We applied hdWGCNA in the mouse brain Visium dataset, identifying 12 spatial modules (SM1-12; <xref rid="mmc1" ref-type="supplementary-material">Figure S7</xref>; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>), and we embedded the co-expression network in two dimensions using UMAP (<xref rid="fig3" ref-type="fig">Figure 3</xref>B). DME analysis showed that spatial co-expression modules displayed distinct regional expression profiles based on their MEs (<xref rid="fig3" ref-type="fig">Figure 3</xref>C; <xref rid="mmc4" ref-type="supplementary-material">Data S3</xref>), encompassing a wide array of cellular processes such as the myelination module SM1 in the white matter tracts, and synaptic transmission modules SM7, SM9, SM11, and SM12 (<xref rid="mmc1" ref-type="supplementary-material">Figure S7</xref>C; <xref rid="mmc3" ref-type="supplementary-material">Data S2</xref>). For example, DME analysis showed that expression of SM4 was localized to the ventricles and cortical layer 1 near the blood-brain barrier (<xref rid="fig3" ref-type="fig">Figure 3</xref>C). Further, the hub genes of SM4 include hemoglobin subunits (<italic>Hba-a1</italic>, <italic>Hba-a2</italic>, <italic>Hbb-bt</italic>), and we show that SM4 was enriched for biological processes associated with brain vasculature (<xref rid="fig3" ref-type="fig">Figures 3</xref>B and <xref rid="mmc1" ref-type="supplementary-material">S7</xref>C). We compared these gene modules with cluster marker genes from a whole-mouse-brain snRNA-seq dataset<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref> and found significant correspondences, such as the striatum module SM7 and medium spiny neurons (Fisher’s exact test false discovery rate [FDR] &lt;0.05; <xref rid="mmc1" ref-type="supplementary-material">Figure S7</xref>D). Additionally, we performed network analysis on a subset of this dataset containing cortical layers 2–6 (<xref rid="mmc1" ref-type="supplementary-material">Figure S8</xref>), identifying additional fine-grained spatial co-expression modules localized to specific cortical layers (<xref rid="mmc2" ref-type="supplementary-material">Data S1</xref> and <xref rid="mmc3" ref-type="supplementary-material">S2</xref>).</p>
    </sec>
    <sec id="sec2.4">
      <title>Isoform-level co-expression networks reveal cell fate decisions in the radial glia developmental lineage</title>
      <p id="p0115">Different isoforms of the same gene are often involved in distinct biological processes.<xref rid="bib29" ref-type="bibr"><sup>29</sup></xref> Conventional single-cell transcriptomics assays capture information at the gene level, thereby missing much of the biological diversity and regulatory mechanisms that occurs at the isoform level.<xref rid="bib30" ref-type="bibr"><sup>30</sup></xref> Emerging long-read sequencing approaches enable us to profile cellular transcriptomes at isoform resolution,<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref><sup>,</sup><xref rid="bib31" ref-type="bibr"><sup>31</sup></xref><sup>,</sup><xref rid="bib32" ref-type="bibr"><sup>32</sup></xref><sup>,</sup><xref rid="bib33" ref-type="bibr"><sup>33</sup></xref> thus providing new opportunities to model the relationships between isoforms using co-expression network analysis.</p>
      <p id="p0120">We used hdWGCNA to perform isoform co-expression network analysis in radial glia lineage cells from the mouse hippocampus at postnatal day 7 (P7) profiled with single-cell isoform RNA sequencing (ScISOrSeq)<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> (<xref rid="fig4" ref-type="fig">Figure 4</xref>A; <xref rid="sec4" ref-type="sec">STAR Methods</xref>). This dataset contains isoform-level and gene-level expression data from 6,832 nuclei derived from a single mouse hippocampus sample. Radial glia, which share transcriptomic similarities with mature astrocytes, are progenitor cells that give rise to numerous distinct cell fates, including neuronal cells, astrocytes, oligodendrocytes, and ependymal cells.<xref rid="bib34" ref-type="bibr"><sup>34</sup></xref><sup>,</sup><xref rid="bib35" ref-type="bibr"><sup>35</sup></xref> To model this developmental process, we applied Monocle3<xref rid="bib36" ref-type="bibr"><sup>36</sup></xref> pseudotime to 2,190 radial glia lineage cells (<xref rid="fig4" ref-type="fig">Figure 4</xref>B). We identified three trajectories corresponding to distinct cell fates, termed the ependymal (EPD) trajectory, astrocyte (ASC) trajectory, and the neural intermediate progenitor cell (NPC) trajectory.<fig id="fig4"><label>Figure 4</label><caption><p>Isoform co-expression network analysis reveals fate-specific expression programs in the hippocampal radial glia lineage</p><p>(A) UMAP plot of cells from the mouse hippocampus ScISOrSeq dataset.<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> Major cell types are labeled and the cells used for co-expression network analysis are colored. This dataset contains expression information for 96,093 isoforms and 31,053 genes in 6,832 cells from one mouse brain sample. ASC, astrocytes; CPX, choroid plexus epithelial cells; EPD, ependymal cells; EX, excitatory neurons; GRN, granule neurons; INH, inhibitory neurons; MAC, macrophages; NPC, neuronal intermediate progenitor cells; MG, microglia; OPC, oligodendrocyte progenitor cells; RGL, radial glia; VASC, vasculature cells.</p><p>(B) UMAP plot of the radial glia lineage, colored by Monocle 3<xref rid="bib71" ref-type="bibr"><sup>37</sup></xref> pseudotime assignment. Top left, ependymal (EPD) trajectory; top right, astrocyte (ASC) trajectory; bottom left, neuronal intermediate progenitor cell (NPC) trajectory.</p><p>(C) UMAP plot of the radial glia lineage isoform co-expression network. Each node represents a single isoform, and edges represent co-expression links between isoforms and module hub isoforms. Point size is scaled by kMEiso. Nodes are colored by co-expression module assignment. Network edges were downsampled for visual clarity.</p><p>(D) Donut chart showing the percentage of genes with one isoform, with multiple isoforms that are all assigned to the same module, and with multiple isoforms that are spread across more than one module.</p><p>(E) Module eigenisoforms (MEiso) as a function of pseudotime for each co-expression module. For each module, a separate locally estimated scatterplot smoothing (LOESS) regression line is shown for each developmental trajectory.</p><p>(F) Dot plot showing selected GO term enrichment results for each co-expression module.</p><p>(G) Gene models for selected isoforms of <italic>Gfap</italic>, colored by co-expression module assignment.</p><p>(H) Gene models for selected isoforms of <italic>H3f3b</italic>, colored by co-expression module assignment.</p><p>(I) Top: gene models for selected isoforms of <italic>Cd9</italic>, colored by co-expression module assignment. Bottom: Swan<xref rid="bib39" ref-type="bibr"><sup>38</sup></xref> graphical representation of <italic>Cd9</italic> alternative splicing isoforms. Splice sites and transcript start/end sites are represented as nodes; introns and exons are represented as connections between nodes. These two isoforms are distinguished by alternative TSS usage. Gene models from the GENCODE VM23 comprehensive transcript set are shown below transcripts in panels (G)–(I).</p></caption><graphic xlink:href="gr4"/></fig></p>
      <p id="p0125">Isoform co-expression network analysis revealed 11 modules in the radial glia lineage (<xref rid="fig4" ref-type="fig">Figure 4</xref>C; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>). Of the genes retained for network analysis, 61.5% had a single isoform, 18.2% had multiple isoforms that were all assigned to the same module, and 20.4% had multiple isoforms spread across several modules (<xref rid="fig4" ref-type="fig">Figure 4</xref>D). Thus, these network modules capture information about the roles of different isoforms of the same gene in distinct biological processes. We inspected module eigenisoform (MEiso) patterns throughout the developmental lineage, thereby uncovering isoform modules critical for cell fate decisions (<xref rid="fig4" ref-type="fig">Figure 4</xref>E; <xref rid="mmc3" ref-type="supplementary-material">Data S2</xref> and <xref rid="mmc4" ref-type="supplementary-material">S3</xref>). Increased expression of modules RGL-M1 and RGL-M2, which were enriched cilium assembly genes (<xref rid="fig4" ref-type="fig">Figure 4</xref>F), was associated with the transition from a radial glia to an ependymal cell state. A steady expression level of module RGL-M5 (glial development, astrocyte differentiation) was found in the transition from radial glia to astrocytes, while a decreased expression of RGL-M5 led to alternative fates. Four modules (RGL-M3, RGL-M8, RGL-M9, and RGL-M11) displayed an increase in expression in the neuronal trajectory, containing genes associated with cellular processes such as non-canonical <italic>Wnt</italic> signaling, neuronal synaptic plasticity, and RNA splicing (<xref rid="fig4" ref-type="fig">Figure 4</xref>F).</p>
      <p id="p0130">We inspected the isoforms of three selected genes that had hub isoforms in different co-expression modules: <italic>Gfap</italic>, <italic>H3f3b</italic>, and <italic>Cd9</italic> (<xref rid="fig4" ref-type="fig">Figures 4</xref>G–4I). <italic>Gfap</italic> encodes a key intermediate filament protein in astrocytes that is involved in astrocytic reactivity during central nervous system (CNS) injuries or neurodegeneration,<xref rid="bib37" ref-type="bibr"><sup>39</sup></xref> and we found that modules RGL-M4 and RGL-M6 contained hub isoforms of <italic>Gfap</italic> featuring alternative splicing, alternative transcription start site (TSS) usage, and alternative transcription end site (TES) usage (<xref rid="fig4" ref-type="fig">Figure 4</xref>G). Different isoforms of the histone H3.3 subunit gene <italic>H3f3b</italic> were hubs for modules RGL-M1 and RGL-M11, which were associated with ependymal and neuronal cell fates respectively, suggesting that alternative TES usage in <italic>H3f3b</italic> plays a role in regulating epigenetic factors in murine hippocampal development (<xref rid="fig4" ref-type="fig">Figure 4</xref>F). <italic>Cd9</italic> encodes a transmembrane protein and is a known glioblastoma biomarker,<xref rid="bib38" ref-type="bibr"><sup>40</sup></xref> and we found subtle differences in the TSS between hub isoforms in modules RGL-M6 and RGL-M9 that we show as a splicing summary graph<xref rid="bib39" ref-type="bibr"><sup>38</sup></xref> (<xref rid="fig4" ref-type="fig">Figure 4</xref>I), supporting functional changes mediated by small isoform differences.</p>
    </sec>
    <sec id="sec2.5">
      <title>Co-expression network analysis of inhibitory neurons in ASD</title>
      <p id="p0135">Co-expression networks can be interrogated to further understand the molecular phenotypes of complex polygenic diseases in primary human tissue samples. We applied hdWGCNA to 20,249 inhibitory neurons (INHs) from an snRNA-seq dataset of the human PFC in 22 ASD patients, 24 age-matched controls, and eight epilepsy patients<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> (<xref rid="fig5" ref-type="fig">Figures 5</xref>A and <xref rid="mmc1" ref-type="supplementary-material">S10</xref>; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>). The INH network contained 14 modules, and we show hub genes that have a known association with ASD in the SFARI database on the co-expression UMAP (<xref rid="fig5" ref-type="fig">Figure 5</xref>B). The MEs showed that some modules were primarily confined to a single INH cluster (INH-M3, INH-M1) while others were spread across multiple neuronal groups (<xref rid="fig5" ref-type="fig">Figure 5</xref>C). Furthermore, DME analysis revealed significant differences between MEs in ASD and control samples for all modules except INH-M4 in at least one INH subpopulation (<xref rid="fig5" ref-type="fig">Figure 5</xref>D; <xref rid="mmc4" ref-type="supplementary-material">Data S3</xref>; Wilcoxon rank-sum test Bonferroni-adjusted p &lt;0.05). However, by focusing on the DME results with an absolute average <inline-formula><mml:math id="M14" altimg="si6.gif"><mml:mrow><mml:msub><mml:mi>log</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (fold change) <inline-formula><mml:math id="M15" altimg="si7.gif"><mml:mo>≥</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula>, we note that many of the largest differences were found in the <italic>SST</italic><sup>+</sup> inhibitory neuron clusters. Furthermore, three co-expression modules (INH-M11, INH-M13, and INH-M3) were significantly enriched in ASD-associated genes from the SFARI database and the latest genome-wide association study (GWAS) of ASD<xref rid="bib40" ref-type="bibr"><sup>41</sup></xref> (<xref rid="fig5" ref-type="fig">Figure 5</xref>E), but we note that all of these modules contained several ASD-associated SFARI genes.<fig id="fig5"><label>Figure 5</label><caption><p>Co-expression network analysis of inhibitory neurons in Autism spectrum disorder</p><p>(A) UMAP plot of 121,451 nuclei from the cortex of 22 ASD donors, 24 controls, and eight epilepsy donors profiled with snRNA-seq. Inhibitory neuron subtypes are highlighted. ASC, astrocytes; EX, excitatory neurons; INH, inhibitory neurons; MG, microglia; ODC, oligodendrocytes; OPC, oligodendrocyte progenitor cells.</p><p>(B) Gene co-expression network derived from inhibitory neurons, represented as a two-dimensional UMAP embedding of the TOM. Nodes represent genes, colored by module assignment. Module hub genes with prior evidence of ASD association from SFARI are labeled. Edges represent co-expression relationships between genes and module hub genes. Network edges were downsampled for visual clarity.</p><p>(C) Gene overlap analysis comparing ASD-associated genes from SFARI and INH co-expression modules, using Fisher’s exact test. <inline-formula><mml:math id="M16" altimg="si11.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> indicates that the overlap was not significant (FDR <inline-formula><mml:math id="M17" altimg="si12.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mspace width="0.25em"/><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>).</p><p>(D) snRNA-seq UMAP plots as in (A) colored by MEs for INH co-expression modules.</p><p>(E) Violin plots showing MEs in each INH cluster. Two-sided Wilcoxon test was used to compare ASD versus control samples. Nuclei from epilepsy donors were excluded in this comparison. Not significant (ns), p &gt; 0.05; <inline-formula><mml:math id="M18" altimg="si13.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>p<inline-formula><mml:math id="M19" altimg="si14.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>; ∗∗p<inline-formula><mml:math id="M20" altimg="si15.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula>; ∗∗∗p<inline-formula><mml:math id="M21" altimg="si16.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>; ∗∗∗∗p<inline-formula><mml:math id="M22" altimg="si17.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:mn>0.0001</mml:mn></mml:mrow></mml:math></inline-formula>.</p><p>(F) Selected GO enrichment results for each co-expression module.</p></caption><graphic xlink:href="gr5"/></fig></p>
      <p id="p0140">INH-M11 was enriched for genes associated with synaptic transmission, ion transport, glutamate receptor signaling, and nervous system development (<xref rid="fig5" ref-type="fig">Figure 5</xref>F; <xref rid="mmc3" ref-type="supplementary-material">Data S2</xref>), and this module was downregulated in ASD for five of the six INH subtypes (<xref rid="fig5" ref-type="fig">Figure 5</xref>D). Similarly, INH-M13 was associated with RNA processing (<xref rid="fig5" ref-type="fig">Figure 5</xref>F) and was downregulated in ASD in all INH subtypes except <italic>PVALB</italic>+ neurons (<xref rid="fig5" ref-type="fig">Figure 5</xref>D). One of the INH-M13 hub genes is <italic>CHD2</italic>, whose <italic>de novo</italic> variants have been identified in individuals with ASD.<xref rid="bib41" ref-type="bibr"><sup>42</sup></xref><sup>,</sup><xref rid="bib42" ref-type="bibr"><sup>43</sup></xref> CHD2 is part of the CHD family of chromatin-modifying proteins and can alter gene expression by modification of chromatin structure. Similarly, rare loss-of-function mutations have been reported in the <italic>SCN2A</italic> gene, a hub gene of the INH-M11 module.<xref rid="bib43" ref-type="bibr"><sup>44</sup></xref> We also find enrichment of several ASD-associated genes such as <italic>TSC1</italic> (INH-M8), <italic>SMARCA4</italic> (INH-M8), <italic>SHANK2</italic> (INH-M4), and <italic>CPEB4</italic> (INH-M1), highlighting that these modules are functional and provide new insights into the role of inhibitory neurons in ASD. Finally, we tested for the preservation of these modules in 19,425 inhibitory neurons from an snRNA-seq dataset of the PFC from donors with major depressive disorder (MDD) and controls<xref rid="bib44" ref-type="bibr"><sup>45</sup></xref> (34 samples), and we found substantial evidence of preservation across all modules except INH-M1 (<xref rid="mmc1" ref-type="supplementary-material">Figures S10</xref>C–S10E).</p>
    </sec>
    <sec id="sec2.6">
      <title>Consensus network analysis of microglia in AD</title>
      <p id="p0145">Microglia, the resident immune cells of the brain, are implicated in the pathology and genetic risk of several CNS diseases, including AD.<xref rid="bib45" ref-type="bibr"><sup>46</sup></xref><sup>,</sup><xref rid="bib46" ref-type="bibr"><sup>47</sup></xref><sup>,</sup><xref rid="bib47" ref-type="bibr"><sup>48</sup></xref><sup>,</sup><xref rid="bib48" ref-type="bibr"><sup>49</sup></xref> Transcriptomic and epigenomic studies in human tissue and AD mouse models have identified multiple cell states of microglia, representing a spectrum between homeostatic and disease-associated microglia (DAMs).<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref><sup>,</sup><xref rid="bib49" ref-type="bibr"><sup>50</sup></xref><sup>,</sup><xref rid="bib50" ref-type="bibr"><sup>51</sup></xref> Our previous study defined a set of transcription factors, genes, and <italic>cis</italic>-regulatory elements involved in the shift between homeostatic and DAM cell states in human AD, identifying shared and distinct signatures compared with the DAM signature from 5xFAD mice.<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> Here we sought to expand on previous work by providing a systems-level analysis of gene expression throughout the spectrum of microglia cell states.</p>
      <p id="p0150">We modeled the cell-state continuum between homeostatic and DAM-like microglia by employing a pseudotime analysis of microglia from three human AD snRNA-seq datasets<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref><sup>,</sup><xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> (<xref rid="fig6" ref-type="fig">Figures 6</xref>A, 6B, and <xref rid="mmc1" ref-type="supplementary-material">S11</xref>). Next, we performed consensus co-expression network analysis using microglia integrated from three human AD snRNA-seq datasets,<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref><sup>,</sup><xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> identifying four consensus modules (<xref rid="fig6" ref-type="fig">Figure 6</xref>C; <xref rid="mmc2" ref-type="supplementary-material">Data S1</xref>). Consensus network analysis is an approach that performs network analysis separately for each dataset, followed by a procedure to retain structures common across the individual networks, and thus it is well suited for analyzing microglia co-expression from these different sources (STAR Methods).<fig id="fig6"><label>Figure 6</label><caption><p>Consensus network analysis of microglia in AD</p><p>(A) Left: table showing the number of samples and the number of microglia nuclei from published AD snRNA-seq datasets used for co-expression network analysis. Right: integrated UMAP plot of nuclei from three snRNA-seq datasets.</p><p>(B) UMAP plot of microglia, colored by Monocle 3<xref rid="bib71" ref-type="bibr"><sup>37</sup></xref> pseudotime assignment.</p><p>(C) UMAP plot of the microglia co-expression network. Each node represents a single gene, and edges represent co-expression links between genes and module hub genes. Point size is scaled by kME. Nodes are colored by co-expression module assignment. The top 10 hub genes per module are labeled, as well as additional genes of interest. Network edges were downsampled for visual clarity.</p><p>(D) Selected Gene Ontology (GO) terms enriched in co-expression modules. Bar plots show the log-scaled enrichment of each term.</p><p>(E) MEs as a function of pseudotime; points are averaged MEs in 50 pseudotime bins of equal size. Line represents LOESS regression with a 95% confidence interval.</p><p>(F) Microglia UMAP colored by ME.</p><p>(G) Differential module eigengene (DME) results in 10 pseudotime bins of equal size. For each pseudotime bin, we performed DME analysis between cells from AD (positive fold change) and control samples. <inline-formula><mml:math id="M23" altimg="si11.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> symbol indicates that the test did not reach significance (Wilcoxon rank-sum test Bonferroni-adjusted p value &gt; 0.05).</p><p>(H) Top: microglia UMAP colored by AD single-cell disease relevance score (scDRS)<xref rid="bib54" ref-type="bibr"><sup>52</sup></xref><inline-formula><mml:math id="M24" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> score. Bottom: scDRS <inline-formula><mml:math id="M25" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> score as a function of pseudotime, points are averaged scDRS <inline-formula><mml:math id="M26" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> scores in 50 pseudotime bins of equal size. Line represents linear regression with a 95% confidence interval.</p><p>(I) Heatmap of Pearson correlations of MEs and scDRS <inline-formula><mml:math id="M27" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula> scores, split by cells from AD and control samples.</p><p>(J) Abbreviations denote the following brain regions: SFG, superior frontal gyrus; EC, entorhinal cortex; OC, occipital cortex; OTC, occipitotemporal cortex. ∗∗Highly preserved (<italic>Z</italic><inline-formula><mml:math id="M28" altimg="si18.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>); <inline-formula><mml:math id="M29" altimg="si13.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mo>∗</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>moderately preserved (<inline-formula><mml:math id="M30" altimg="si19.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo></mml:mrow></mml:math></inline-formula><italic>Z</italic><inline-formula><mml:math id="M31" altimg="si5.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>); x, not preserved (<italic>Z</italic><inline-formula><mml:math id="M32" altimg="si20.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>).</p></caption><graphic xlink:href="gr6"/></fig></p>
      <p id="p0155">Classical markers of homeostatic microglia, such as <italic>CSF1R</italic>, <italic>CX3CR1</italic>, and <italic>P2RY12</italic>, were members of MG-M2, while known DAM genes, including <italic>APOE</italic>, <italic>TYROBP</italic>, and <italic>B2M</italic>, were members of MG-M1. GO term enrichment analysis associated MG-M2 with homeostatic microglia functions such as cell migration, synapse organization, and response to colony-stimulating factor, contrasting disease-related processes enriched in MG-M1 including amyloid fibril formation, microglial activation, maintenance of blood-brain barrier, and cytokine production (<xref rid="fig6" ref-type="fig">Figure 6</xref>D; <xref rid="mmc3" ref-type="supplementary-material">Data S2</xref>). Together, this suggests that MG-M1 comprises the gene network underlying DAM activation in AD, while MG-M2 represents the network of homeostatic microglia genes. The MEs for MG-M1 and MG-M2 display opposing patterns throughout the microglia pseudotime trajectory, contextualizing this trajectory as the transcriptional shift from homeostatic microglia (start) to a DAM-like cell state (end) (<xref rid="fig6" ref-type="fig">Figures 6</xref>E and 6F). Furthermore, DME analysis revealed significant changes in these modules between AD and control brains in evenly spaced windows throughout the microglia trajectory (<xref rid="fig6" ref-type="fig">Figure 6</xref>G; Wilcoxon rank-sum test Bonferroni-adjusted p &lt;0.05; <xref rid="mmc4" ref-type="supplementary-material">Data S3</xref>). Co-expression networks behave as functional biological units; therefore, we reason that the hub genes and other members of MG-M1 represent candidates for an expanded set of human DAM genes including <italic>ACTB</italic>, <italic>TPT1</italic>, and <italic>EEF1A1</italic>.</p>
      <p id="p0160">Aside from modules MG-M1 and MG-M2, which contained well-known microglia gene signatures, we also identified modules MG-M3 and MG-M4 containing genes associated with key microglial processes such as axon guidance, phagocytosis, and myeloid cell differentiation (<xref rid="fig6" ref-type="fig">Figures 6</xref>C and 6D). <italic>CD163</italic>, a hub gene of MG-M4, is known to be involved in the breakdown of the blood-brain barrier.<xref rid="bib51" ref-type="bibr"><sup>53</sup></xref><sup>,</sup><xref rid="bib52" ref-type="bibr"><sup>54</sup></xref> The trajectory of MG-M4, containing <italic>CD163</italic> as a hub gene, was consistent with that of DAM-like module MG-M1, and was enriched for processes including phagocytosis, myeloid cell differentiation, and neutrophil activation (<xref rid="fig6" ref-type="fig">Figure 6</xref>D); therefore, it is possible that MG-M4 represents an alternative microglial activation module.<xref rid="bib53" ref-type="bibr"><sup>55</sup></xref> We performed single-cell polygenic risk enrichment for AD risk in the microglia trajectory,<xref rid="bib45" ref-type="bibr"><sup>46</sup></xref><sup>,</sup><xref rid="bib54" ref-type="bibr"><sup>52</sup></xref> and identified a significant increase throughout the trajectory, revealing an enrichment of AD genetic risk single-nucleotide polymorphisms (SNPs) in DAMs (<xref rid="fig6" ref-type="fig">Figure 6</xref>H; <xref rid="sec4" ref-type="sec">STAR Methods</xref>; <xref rid="mmc4" ref-type="supplementary-material">Data S3</xref>). We show that expression of these modules was significantly correlated with AD genetic risk (Pearson correlation p &lt;0.05), with the strongest correlation in alternative activation module MG-M4 (<xref rid="fig6" ref-type="fig">Figure 6</xref>I).</p>
      <p id="p0165">To ensure that these microglial modules were reproducible across other datasets and in mouse models of AD, we performed module preservation analysis<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> (<xref rid="sec4" ref-type="sec">STAR Methods</xref>; <xref rid="fig6" ref-type="fig">Figure 6</xref>J). We projected the microglial consensus modules into a dataset of the PFC in aged human samples,<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref> the superior frontal gyrus (SFG) and entorhinal cortex (EC) in AD samples,<xref rid="bib56" ref-type="bibr"><sup>57</sup></xref> the occipital cortex (OC) and the occipitotemporal cortex (OTC) in human AD samples,<xref rid="bib57" ref-type="bibr"><sup>58</sup></xref> the PFC from 5xFAD mice,<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> and whole-brain samples from 5xFAD mice<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref> (<xref rid="fig6" ref-type="fig">Figure 6</xref>H). Additionally, we projected these modules into an snATAC-seq dataset of the PFC in human AD,<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> using gene activity<xref rid="bib58" ref-type="bibr"><sup>59</sup></xref> as a proxy for gene expression from chromatin accessibility data. These module preservation tests showed the microglia consensus modules were broadly preserved and reproducible across brain regions and in mouse models of AD, providing further support that this network is relevant in AD biology and microglial activation.</p>
    </sec>
    <sec id="sec2.7">
      <title>Projecting network modules from bulk RNA-seq cohorts into relevant single-cell datasets</title>
      <p id="p0170">hdWGCNA allows for interrogating co-expression modules inferred from a given reference dataset in a query dataset. Modules can be projected across datasets by computing MEs in the query dataset, and preservation of the network structure can be assessed via statistical testing.<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> For example, modules can be projected between different species to link transcriptomic changes between mouse models and human disease patients, or modules can be projected across data modalities from single-cell to spatial transcriptomics to provide regional context to cellular niches.</p>
      <p id="p0175">To date, it remains cost-prohibitive for most researchers to perform high-dimensional -omics studies of large patient cohorts, but there are numerous large-scale disease-relevant bulk RNA-seq datasets containing thousands of samples from consortia such as the Encyclopedia of DNA Elements (ENCODE),<xref rid="bib59" ref-type="bibr"><sup>60</sup></xref> the Genotype-Tissue Expression (GTEx) project,<xref rid="bib60" ref-type="bibr"><sup>61</sup></xref> and The Cancer Genome Atlas (TCGA).<xref rid="bib61" ref-type="bibr"><sup>62</sup></xref> By projecting co-expression modules derived from bulk RNA-seq patient cohorts into single-cell datasets, we can layer disease-related information onto the single-cell dataset and attribute cell-state-specific expression patterns to the bulk RNA-seq data. We demonstrate projecting modules in this manner using co-expression modules from two bulk RNA-seq studies of AD<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref><sup>,</sup><xref rid="bib62" ref-type="bibr"><sup>63</sup></xref> as the references and a human AD snRNA-seq dataset<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> (57,950 nuclei from AD 11 samples and seven control samples of the PFC) as the query. These studies both used AD samples and controls from the same patient cohorts (Religious Orders Study and Memory and Aging Project, Mayo Clinic, Mount Sinai School of Medicine),<xref rid="bib63" ref-type="bibr"><sup>64</sup></xref><sup>,</sup><xref rid="bib64" ref-type="bibr"><sup>65</sup></xref><sup>,</sup><xref rid="bib65" ref-type="bibr"><sup>66</sup></xref> but they took unique approaches for co-expression network analysis. The AMP-AD study from Wan et al.<xref rid="bib62" ref-type="bibr"><sup>63</sup></xref> performed network analysis separately from each brain region, while, in our previous study,<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref> we performed consensus network analysis across the different brain regions. We projected these modules into a snRNA-seq dataset of AD and control samples from the PFC (<xref rid="fig7" ref-type="fig">Figure 7</xref>A), and we found distinct cell-type-specific expression patterns based on their MEs (<xref rid="fig7" ref-type="fig">Figures 7</xref>B and 7C). This analysis demonstrates hdWGCNA’s ability to transfer co-expression information across datasets to uncover otherwise unseen biological insights.<fig id="fig7"><label>Figure 7</label><caption><p>Projecting bulk RNA-seq co-expression modules into a single-cell dataset</p><p>(A) UMAP plot of 57,950 nuclei from an snRNA-seq dataset of the human PFC from AD (N = 11) and control (N = 7) PFC samples.<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> Cells are colored by major cell type assignment.</p><p>(B) Multi-region consensus co-expression modules from Morabito et al.<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref> bulk RNA-seq analysis projected into the snRNA-seq dataset as in (A).</p><p>(C) Co-expression modules from the AMP-AD bulk RNA-seq dataset<xref rid="bib62" ref-type="bibr"><sup>63</sup></xref> projected into the snRNA-seq dataset as in (A). CBE, cerebellum; DLPFC, dorsolateral PFC; FP, frontal pole; IFG, inferior frontal gyrus; PHG, parahippocampal gyrus; STG, superior temporal gyrus; TCX, temporal cortex; ASC, astrocytes; EX, excitatory neurons; INH, inhibitory neurons; MG, microglia; ODC, oligodendrocytes; OPC, oligodendrocyte progenitor cells; VASC, vascular cells.</p></caption><graphic xlink:href="gr7"/></fig></p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>Discussion</title>
    <p id="p0180">Classical bioinformatic approaches for transcriptomics analysis such as differential gene expression are useful for finding individual genes that are altered in a particular disease or condition of interest, but they do not provide information about the broader context of these genes in specific pathways or regulatory regimes. For example, biological processes such as development or regeneration require coordination of distinct sets of genes in certain cell types with spatial specificity. Therefore, to understand these complex processes, we must look beyond individual genes. We developed hdWGCNA to provide a succinct methodology for investigating systems-level changes in the transcriptome in single-cell or ST datasets. We designed hdWGCNA to be highly modular, allowing for multi-scale analyses of different cellular or spatial hierarchies in a technology-agnostic manner.</p>
    <p id="p0185">In this study, we demonstrated that hdWGCNA is compatible with single-cell and ST datasets and can be easily adapted for novel transcriptomics approaches such as ScISOrSeq. Co-expression networks have been successful for analyzing bulk proteomics datasets in human disease samples,<xref rid="bib66" ref-type="bibr"><sup>67</sup></xref><sup>,</sup><xref rid="bib67" ref-type="bibr"><sup>68</sup></xref> and we expect that hdWGCNA could be swiftly adapted for single-cell and spatial proteomics datasets as the technology matures and becomes more widely available.<xref rid="bib68" ref-type="bibr"><sup>69</sup></xref> hdWGCNA includes built-in functions to leverage external biological knowledge sources to provide insight for co-expression networks, for example by comparing gene modules with functional gene sets such as disease-associated genes from GWAS expression quantitative trait loci (eQTLs), or transcription factor target genes. Unlike other network analysis pipelines such as single-cell regulatory network inference and clustering (SCENIC)<xref rid="bib69" ref-type="bibr"><sup>70</sup></xref> or CellChat,<xref rid="bib70" ref-type="bibr"><sup>71</sup></xref> hdWGCNA is a purely unsupervised approach and does not require prior knowledge or databases in the inference procedure. The co-expression information computed by hdWGCNA can be easily retrieved from the Seurat object to facilitate custom downstream analyses beyond the hdWGCNA package. hdWGCNA allows for comparisons between experimental groups via DME testing and module preservation analysis, which allowed us to identity inhibitory neuron modules that were dysregulated in ASD and enriched for ASD genetic risk genes, and microglial modules that were dysregulated in AD and enriched for DAM genes. Our network analyses of the ASD and AD datasets shows that hdWGCNA is capable of uncovering expanded disease-relevant gene sets via the interaction partners of known disease-associated genes such as the ASD SFARI genes or the AD DAM genes. We showed that the co-expression networks inferred by hdWGCNA were highly reproducible in unseen datasets, indicating that this is a robust methodology that reflects the underlying biology of the system of interest rather than picking up on technical artifacts. Further, hdWGCNA sheds new light on previously identified co-expression networks and gene modules by allowing modules to be projected from a reference dataset to a query dataset. The hdWGCNA R package directly extends the familiar Seurat pipeline and the SeuratObject data structure, enabling researchers to rapidly incorporate network analysis into their own workflows, going beyond cell clustering and differential gene expression analysis toward systems-level insights.</p>
    <sec id="sec3.1">
      <title>Limitations of the study</title>
      <p id="p0190">Transcriptomic measurements of single cells are generally noisy, imposing challenges and limitations in the analysis of these datasets. Technical noise may arise from dropout events or from various steps in the experimental protocols, potentially making downstream data analysis and interpretation more difficult. hdWGCNA explicitly tries to handle the issues of technical dropouts and data sparsity by constructing networks in metacell or metaspot transcriptomic profiles rather than directly using the single-cell data. Furthermore, we show that module preservation statistical testing can assess the reproducibility of a co-expression network in external validation datasets, giving additional confidence in the results from hdWGCNA.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>STAR★Methods</title>
    <sec id="sec4.1">
      <title>Key resources table</title>
      <p id="p0195">
        <table-wrap position="float" id="undtbl1">
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th>REAGENT or RESOURCE</th>
                <th>SOURCE</th>
                <th>IDENTIFIER</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="3">
                  <bold>Deposited data</bold>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease snRNA-seq 2019</td>
                <td>Mathys et al., 2019<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref></td>
                <td>syn18485175</td>
              </tr>
              <tr>
                <td>Human Autism spectrum disorder snRNA-seq</td>
                <td>Velmeshev et al., 2019<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref></td>
                <td>PRJNA434002</td>
              </tr>
              <tr>
                <td>Human aging cortex snRNA-seq</td>
                <td>authors</td>
                <td>See Morabito et al., 2020<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref></td>
              </tr>
              <tr>
                <td>Human Major depressive disorder snRNA-seq</td>
                <td>Nagy et al., 2020<xref rid="bib44" ref-type="bibr"><sup>45</sup></xref></td>
                <td>GSE144136</td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease snRNA-seq 2020</td>
                <td>Zhou et al., 2020<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref></td>
                <td>syn21670836</td>
              </tr>
              <tr>
                <td>Mouse 5XFAD snRNA-seq 2020</td>
                <td>Zhou et al., 2020<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref></td>
                <td>syn21670836</td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease Occipital Cortex snRNA-seq 2021</td>
                <td>Gerrits et al., 2021<xref rid="bib57" ref-type="bibr"><sup>58</sup></xref></td>
                <td>GSE148822</td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease Occipitotemporal Cortex snRNA-seq 2021</td>
                <td>Gerrits et al., 2021<xref rid="bib57" ref-type="bibr"><sup>58</sup></xref></td>
                <td>GSE148822</td>
              </tr>
              <tr>
                <td>Mouse hippocampus ScISOrSeq</td>
                <td>authors</td>
                <td>See Joglekar et al., 2021<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref></td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease Entorhinal Cortex snRNA-seq 2021</td>
                <td>Leng et al., 2021<xref rid="bib56" ref-type="bibr"><sup>57</sup></xref></td>
                <td>GSE147528</td>
              </tr>
              <tr>
                <td>Human Alzheimer’s Disease Superior Frontal Gyrus snRNA-seq 2021</td>
                <td>Leng et al., 2021<xref rid="bib56" ref-type="bibr"><sup>57</sup></xref></td>
                <td>GSE147528</td>
              </tr>
              <tr>
                <td>Mouse 5XFAD snRNA-seq 2022</td>
                <td>authors</td>
                <td>See Kiani-Shabestari et al., 2022<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref></td>
              </tr>
              <tr>
                <td>10X Genomics mouse brain spatial transcriptomics</td>
                <td>SeuratData R package</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/satijalab/seurat-data" id="intref0020">https://github.com/satijalab/seurat-data</ext-link>
                </td>
              </tr>
              <tr>
                <td>Parse Biosciences PBMCs in Type 1 Diabetes</td>
                <td>Parse Biosciences</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://resources.parsebiosciences.com/dataset-wt-mega-one-million-pbmc-type-1-diabetes" id="intref0025">https://resources.parsebiosciences.com/dataset-wt-mega-one-million-pbmc-type-1-diabetes</ext-link>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <bold>Software and algorithms</bold>
                </td>
              </tr>
              <tr>
                <td colspan="3">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td>hdWGCNA R package</td>
                <td>this paper</td>
                <td>
                  <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.6835227" id="intref0030">https://doi.org/10.5281/zenodo.6835227</ext-link>
                </td>
              </tr>
              <tr>
                <td>data analysis scripts</td>
                <td>this paper</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7851151" id="intref0035">https://doi.org/10.5281/zenodo.7851151</ext-link>
                </td>
              </tr>
              <tr>
                <td>WGCNA</td>
                <td>CRAN</td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_003302" id="intref0040">SCR_003302</ext-link></td>
              </tr>
              <tr>
                <td>Kallisto Bustools</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/pachterlab/kallistobustools" id="intref0045">https://github.com/pachterlab/kallistobustools</ext-link>
                </td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_018213" id="intref0050">SCR_018213</ext-link></td>
              </tr>
              <tr>
                <td>Scanpy</td>
                <td>Wolf et al., 2018<xref rid="bib78" ref-type="bibr"><sup>72</sup></xref></td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_018139" id="intref0055">SCR_018139</ext-link></td>
              </tr>
              <tr>
                <td>Seurat</td>
                <td>CRAN</td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_016341" id="intref0060">SCR_016341</ext-link></td>
              </tr>
              <tr>
                <td>Harmony</td>
                <td>CRAN</td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_022206" id="intref0065">SCR_022206</ext-link></td>
              </tr>
              <tr>
                <td>Scrublet</td>
                <td>Wolock et al., 2019<xref rid="bib81" ref-type="bibr"><sup>73</sup></xref></td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_018098" id="intref0070">SCR_018098</ext-link></td>
              </tr>
              <tr>
                <td>Cellbender</td>
                <td>Fleming et al., 2019<xref rid="bib80" ref-type="bibr"><sup>74</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/broadinstitute/CellBender" id="intref0075">https://github.com/broadinstitute/CellBender</ext-link>
                </td>
              </tr>
              <tr>
                <td>SEACells</td>
                <td>Persad et al., 2023<xref rid="bib16" ref-type="bibr"><sup>16</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/dpeerlab/SEACells" id="intref0080">https://github.com/dpeerlab/SEACells</ext-link>
                </td>
              </tr>
              <tr>
                <td>Metacell-2</td>
                <td>Ben-Kiki et al., 2022<xref rid="bib14" ref-type="bibr"><sup>14</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/tanaylab/metacells" id="intref0085">https://github.com/tanaylab/metacells</ext-link>
                </td>
              </tr>
              <tr>
                <td>EGAD</td>
                <td>Ballouz et al., 2016<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/sarbal/EGAD" id="intref0090">https://github.com/sarbal/EGAD</ext-link>
                </td>
              </tr>
              <tr>
                <td>Enrichr</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://maayanlab.cloud/Enrichr/" id="intref0095">https://maayanlab.cloud/Enrichr/</ext-link>
                </td>
                <td>RRID:<ext-link ext-link-type="uri" xlink:href="rridsoftware:SCR_001575" id="intref0100">SCR_001575</ext-link></td>
              </tr>
              <tr>
                <td>XGBoost</td>
                <td>Chen and Guestrin, 2016<xref rid="bib25" ref-type="bibr"><sup>25</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://xgboost.readthedocs.io/en/stable/" id="intref0105">https://xgboost.readthedocs.io/en/stable/</ext-link>
                </td>
              </tr>
              <tr>
                <td>Monocle3</td>
                <td>Cao et al., 2019<xref rid="bib36" ref-type="bibr"><sup>36</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://cole-trapnell-lab.github.io/monocle3/" id="intref0110">https://cole-trapnell-lab.github.io/monocle3/</ext-link>
                </td>
              </tr>
              <tr>
                <td>scDRS</td>
                <td>Zhang et al., 2022<xref rid="bib54" ref-type="bibr"><sup>52</sup></xref></td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/martinjzhang/scDRS" id="intref0115">https://github.com/martinjzhang/scDRS</ext-link>
                </td>
              </tr>
              <tr>
                <td>SeuratData</td>
                <td>Satija Lab</td>
                <td>
                  <ext-link ext-link-type="uri" xlink:href="https://github.com/satijalab/seurat-data" id="intref0120">https://github.com/satijalab/seurat-data</ext-link>
                </td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </p>
    </sec>
    <sec id="sec4.2">
      <title>Resource availability</title>
      <sec id="sec4.2.1">
        <title>Lead contact</title>
        <p id="p0200">Requests for further information should be directed to the lead contact, Vivek Swarup (<ext-link ext-link-type="uri" xlink:href="mailto:vswarup@uci.edu" id="intref0125">vswarup@uci.edu</ext-link>).</p>
      </sec>
      <sec id="sec4.2.2">
        <title>Materials availability</title>
        <p id="p0205">This study did not generate new unique reagents.</p>
      </sec>
    </sec>
    <sec id="sec4.3">
      <title>Method details</title>
      <sec id="sec4.3.1">
        <title>Bootstrapped aggregation of single cell transcriptomes to form metacells</title>
        <p id="p0210">Single-cell gene expression datasets typically contain many more zero valued entries than non-zero valued entries, meaning that these datasets are sparse. We formally define the <bold>sparsity</bold> of a gene expression matrix in <xref rid="fd1" ref-type="disp-formula">Equation 1</xref>. Given an un-normalized counts matrix <inline-formula><mml:math id="M33" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> with genes and <inline-formula><mml:math id="M34" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> cells, sparsity is the sum of all zero valued elements.<disp-formula id="fd1"><label>(Equation 1)</label><mml:math id="M35" altimg="si23.gif"><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:msubsup><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mtext>else</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo linebreak="badbreak">×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
        <p id="p0215">Complementing sparsity, the density of a single gene expression matrix is the sum of all non-zero valued elements divided by the total number of matrix elements, such that <inline-formula><mml:math id="M36" altimg="si24.gif"><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula>. A matrix is considered sparse if <inline-formula><mml:math id="M37" altimg="si25.gif"><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>y</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></inline-formula>. Conventional single-cell gene expression assays yield sparse gene expression matrices. In general, correlations of sparse vectors may lead to downstream conclusions that are not robust or reproducible. Thus, as part of the hdWGCNA workflow, we propose a bootstrapped aggregation (bagging) algorithm to construct a gene expression matrix <inline-formula><mml:math id="M38" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> with considerably reduced sparsity prior to performing co-expression network analysis. Zero valued entries in a gene expression matrix have both biological and technical origins,<xref rid="bib72" ref-type="bibr"><sup>75</sup></xref> and it is important to prioritize preserving relevant biological signals while reducing technical noise. For example, a biological zero may be attributed to a gene that is only expressed in a given cell population, whereas a technical zero may arise from low sequencing depth.</p>
        <p id="p0220">We define the set of unique cell barcodes <inline-formula><mml:math id="M39" altimg="si27.gif"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> and the set of unique genes <inline-formula><mml:math id="M40" altimg="si28.gif"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M41" altimg="si29.gif"><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mi>C</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M42" altimg="si30.gif"><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mi>G</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Transcriptomically similar cells are identified in a dimensionally-reduced representation <inline-formula><mml:math id="M43" altimg="si31.gif"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> of the gene expression matrix <inline-formula><mml:math id="M44" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> using the <inline-formula><mml:math id="M45" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>-nearest neighbors (KNN) algorithm,<xref rid="bib73" ref-type="bibr"><sup>76</sup></xref> yielding <inline-formula><mml:math id="M46" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> sets of <inline-formula><mml:math id="M47" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> cells. Inherently, there is overlap between these <inline-formula><mml:math id="M48" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> sets of <inline-formula><mml:math id="M49" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> neighboring cells, and we include a parameter <inline-formula><mml:math id="M50" altimg="si33.gif"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> to control for the maximum allowable overlap. Cells are uniformly randomly sampled from <inline-formula><mml:math id="M51" altimg="si27.gif"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula>, and gene expression signatures from <inline-formula><mml:math id="M52" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> are aggregated (sum or average) with their <inline-formula><mml:math id="M53" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> nearest neighbors. A cell is skipped if its neighbors have too much overlap with the set of neighbors from previously selected cells, in order to reduce redundancy in the downstream metacell expression matrix. The cell sampling loop converges when there are no more cells that satisfy the <inline-formula><mml:math id="M54" altimg="si33.gif"><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, or when the number of target metacells <inline-formula><mml:math id="M55" altimg="si34.gif"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> has been reached, yielding a metacell gene expression matrix <inline-formula><mml:math id="M56" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>. Sparsity of the input and output matrices <inline-formula><mml:math id="M57" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M58" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> are computed to check that sparsity is reduced throughout this process. This metacell bagging algorithm is implemented as part of the hdWGCNA R package in the ConstructMetacells function, and the pseudocode for this algorithm is defined in <xref rid="tbox1" ref-type="boxed-text">Algorithm 1</xref>. We denote a vector containing the elements of the <inline-formula><mml:math id="M59" altimg="si35.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th row of a matrix as <inline-formula><mml:math id="M60" altimg="si36.gif"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and a vector containing the elements of the <inline-formula><mml:math id="M61" altimg="si35.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>-th column as <inline-formula><mml:math id="M62" altimg="si37.gif"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>.<boxed-text id="tbox1"><label>Algorithm 1</label><caption><title>ConstructMetacells</title></caption><p id="p0390">Require: <inline-formula><mml:math id="M63" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M64" altimg="si73.gif"><mml:mrow><mml:mi>dim</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> ⊳ gene expression matrix of <inline-formula><mml:math id="M65" altimg="si74.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> genes and <inline-formula><mml:math id="M66" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> cells</p><p id="p0395"><bold>Require:</bold><inline-formula><mml:math id="M67" altimg="si31.gif"><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M68" altimg="si75.gif"><mml:mrow><mml:mi>dim</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> ⊳ dimensional reduction of <inline-formula><mml:math id="M69" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="M70" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> cells and <inline-formula><mml:math id="M71" altimg="si76.gif"><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula> dimensions</p><p id="p0400"><bold>Require:</bold><inline-formula><mml:math id="M72" altimg="si27.gif"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> ⊳ the set of unique cell barcodes</p><p id="p0405"><bold>Require:</bold><inline-formula><mml:math id="M73" altimg="si77.gif"><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula></p><p id="p0410"><bold>Require:</bold><inline-formula><mml:math id="M74" altimg="si78.gif"><mml:mrow><mml:mi>m</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></p><p id="p0415"><bold>Require:</bold><inline-formula><mml:math id="M75" altimg="si79.gif"><mml:mrow><mml:mi>t</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula></p><p id="p0420"><inline-formula><mml:math id="M76" altimg="si80.gif"><mml:mrow><mml:mi>K</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mtext>KNN</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> ⊳ <inline-formula><mml:math id="M77" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> is a matrix of <inline-formula><mml:math id="M78" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> rows and <inline-formula><mml:math id="M79" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> columns with the <inline-formula><mml:math id="M80" altimg="si32.gif"><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> nearest neighbors of each cell</p><p id="p0425"><inline-formula><mml:math id="M81" altimg="si81.gif"><mml:mrow><mml:mi>S</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo linebreak="badbreak">∅</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> ⊳ list containing barcodes of cells selected for aggregation, initialized as empty</p><p id="p0430"><inline-formula><mml:math id="M82" altimg="si82.gif"><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></p><p id="p0435"><bold>while</bold><inline-formula><mml:math id="M83" altimg="si83.gif"><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">&lt;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M84" altimg="si84.gif"><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mi>S</mml:mi><mml:mo>‖</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula>
<bold>do</bold></p><p id="p0440"><inline-formula><mml:math id="M85" altimg="si85.gif"><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mi>i</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula></p><p id="p0445"><inline-formula><mml:math id="M86" altimg="si86.gif"><mml:mrow><mml:mi>c</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mi>c</mml:mi><mml:msub><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:msub><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula> ⊳ <inline-formula><mml:math id="M87" altimg="si87.gif"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> is randomly sampled from <inline-formula><mml:math id="M88" altimg="si27.gif"><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:math></inline-formula></p><p id="p0450"><inline-formula><mml:math id="M89" altimg="si88.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo linebreak="badbreak">∪</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo>‖</mml:mo></mml:mrow><mml:mo>∀</mml:mo><mml:mi>j</mml:mi><mml:mo linebreak="badbreak">∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> ⊳ the maximum number of overlapping neighbors between</p><p id="p0455"><inline-formula><mml:math id="M90" altimg="si87.gif"><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> and barcodes in</p><p id="p0460"><inline-formula><mml:math id="M91" altimg="si89.gif"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula></p><p id="p0465">if.</p><p id="p0470"><inline-formula><mml:math id="M92" altimg="si90.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">&lt;</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula><bold>then</bold></p><p id="p0475"><inline-formula><mml:math id="M93" altimg="si91.gif"><mml:mrow><mml:mi>S</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></p><p id="p0480"><bold>end if</bold>.</p><p id="p0485"><inline-formula><mml:math id="M94" altimg="si92.gif"><mml:mrow><mml:mi>C</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mi>C</mml:mi><mml:mo>∖</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula></p><p id="p0490"><bold>end while</bold>.</p><p id="p0495"><inline-formula><mml:math id="M95" altimg="si93.gif"><mml:mrow><mml:mi>J</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>∀</mml:mo><mml:mi>s</mml:mi><mml:mo linebreak="badbreak">∈</mml:mo><mml:mi>S</mml:mi></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> ⊳ subset of <inline-formula><mml:math id="M96" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> with the selected cells <inline-formula><mml:math id="M97" altimg="si89.gif"><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula></p><p id="p0500"><inline-formula><mml:math id="M98" altimg="si94.gif"><mml:mrow><mml:mi>M</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mtext>where</mml:mtext><mml:mspace width="0.25em"/><mml:mi>s</mml:mi><mml:mo linebreak="badbreak">=</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. ⊳ final metacell expression matrix</p></boxed-text></p>
      </sec>
      <sec id="sec4.3.2">
        <title>Aggregation of neighboring spatial transcriptomic spots to form metaspots</title>
        <p id="p0225">Sequencing-based ST approaches such as the <inline-formula><mml:math id="M99" altimg="si1.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> Genomics Visium platform also yield sparse transcriptomic profiles, thus introducing the same potential pitfalls as single-cell data for co-expression network analysis. To alleviate these issues, we sought to develop a data aggregation approach similar to our metacell algorithm. This approach leverages spatial coordinates rather than the dimensionality-reduced representation (<xref rid="mmc1" ref-type="supplementary-material">Figure S6</xref>). For each ST spot, we obtain a list of physically neighboring spots. We then devise a grid of ”principal spots”, which are evenly spaced spots throughout the input tissue which serve as anchor points for aggregating neighboring spots. Each principal spot and its neighbors are aggregated into one metaspot, with at most seven spots merging into one metaspot and at most two overlapping spots between metaspots. We implemented this procedure as part of the hdWGCNA R package in the MetaspotsByGroups function. Similar to the MetacellsByGroups function, the user may specify groups within the Seurat object to perform the aggregation, such that metacells would only be grouped within the same tissue slice, anatomical region, or other annotation. For all downstream analysis with hdWGCNA, the metaspot expression dataset can be used in place of the metacell expression matrix.</p>
      </sec>
      <sec id="sec4.3.3">
        <title>Computing co-expression networks</title>
        <p id="p0230">Following metacell or metaspot construction, hdWGCNA constructs co-expression networks and identifies gene modules, building off of the WGCNA workflow.<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref><sup>,</sup><xref rid="bib4" ref-type="bibr"><sup>4</sup></xref><sup>,</sup><xref rid="bib74" ref-type="bibr"><sup>77</sup></xref><sup>,</sup><xref rid="bib75" ref-type="bibr"><sup>78</sup></xref> The gene-gene adjacency matrix <inline-formula><mml:math id="M100" altimg="si38.gif"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula> is computed by taking the pairwise correlation of genes in <inline-formula><mml:math id="M101" altimg="si28.gif"><mml:mrow><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> in the metacell expression matrix <inline-formula><mml:math id="M102" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>, or in a subset of <inline-formula><mml:math id="M103" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> for a specified cell population. Consider the gene expression vectors <inline-formula><mml:math id="M104" altimg="si39.gif"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M105" altimg="si40.gif"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for an arbitrary pair of genes <inline-formula><mml:math id="M106" altimg="si41.gif"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula>, we compute the signed correlation as:<disp-formula id="fd2"><label>(Equation 2)</label><mml:math id="M107" altimg="si42.gif"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
        <p id="p0235">Note that <inline-formula><mml:math id="M108" altimg="si43.gif"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a linear transformation that retains the sign of the correlation while satisfying <inline-formula><mml:math id="M109" altimg="si44.gif"><mml:mrow><mml:mn>0</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. We define <inline-formula><mml:math id="M110" altimg="si38.gif"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula> as a symmetric adjacency matrix of size <inline-formula><mml:math id="M111" altimg="si45.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> containing the signed correlations <inline-formula><mml:math id="M112" altimg="si43.gif"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for all pairs <inline-formula><mml:math id="M113" altimg="si41.gif"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> as in <xref rid="fd2" ref-type="disp-formula">Equation 2</xref>. In order to emphasize strong correlations, we raise the elements of <inline-formula><mml:math id="M114" altimg="si38.gif"><mml:mrow><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula> to a power <inline-formula><mml:math id="M115" altimg="si46.gif"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula>, and we refer to this as soft power thresholding.<disp-formula id="fd3"><label>(Equation 3)</label><mml:math id="M116" altimg="si47.gif"><mml:mrow><mml:mtable columnalign="center"><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>β</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">×</mml:mo><mml:mtext>sign</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>cor</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
        <p id="p0240">Now we have the gene-gene correlation raised to a power <inline-formula><mml:math id="M117" altimg="si46.gif"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula>, and an alternative metric <inline-formula><mml:math id="M118" altimg="si48.gif"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> which also retains the sign of the correlation between these genes. The final co-expression network is then computed as a signed topological overlap matrix (TOM). The TOM describes shared neighbors between the a pair of genes <inline-formula><mml:math id="M119" altimg="si49.gif"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>. We define the signed TOM as<disp-formula id="fd4"><label>(Equation 4)</label><mml:math id="M120" altimg="si50.gif"><mml:mrow><mml:msubsup><mml:mtext>TOM</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>signed</mml:mtext></mml:msubsup><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="badbreak">+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo linebreak="badbreak">≠</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">−</mml:mo><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="M121" altimg="si51.gif"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M122" altimg="si52.gif"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represent the connectivity between genes <inline-formula><mml:math id="M123" altimg="si35.gif"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M124" altimg="si53.gif"><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula><disp-formula id="fd5"><label>(Equation 5)</label><mml:math id="M125" altimg="si54.gif"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo linebreak="badbreak">=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo linebreak="badbreak">≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>In the signed TOM, negative correlations serve to negatively reinforce the network connection, which is not the case in the unsigned TOM.<disp-formula id="fd6"><label>(Equation 6)</label><mml:math id="M126" altimg="si55.gif"><mml:mrow><mml:msubsup><mml:mtext>TOM</mml:mtext><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mtext>unsigned</mml:mtext></mml:msubsup><mml:mo linebreak="badbreak">=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mo linebreak="badbreak">+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo linebreak="badbreak">≠</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>min</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">+</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="badbreak">−</mml:mo><mml:mrow><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p>
        <p id="p0245">Genes are then grouped into modules based on the TOM network representation using the Dynamic Tree Cut algorithm,<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> such that co-expression modules consist of genes with high topological overlap. Dynamic Tree Cut hierarchically clusters genes based on their dissimilarity in the TOM, denoted as <inline-formula><mml:math id="M127" altimg="si56.gif"><mml:mrow><mml:mtext>DissTOM</mml:mtext><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>1</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">−</mml:mo><mml:mtext>TOM</mml:mtext></mml:mrow></mml:math></inline-formula>, thereby yielding a mapping between module assignments and gene names. The overall process transforming a metacell expression matrix <inline-formula><mml:math id="M128" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> to a signed TOM co-expression network is implemented as part of the hdWGCNA R package in the ConstructNetwork function. Here we described the recommended workflow, using a signed adjacency matrix and a signed TOM, but ConstructNetwork can optionally construct unsigned or signed hybrid networks as well.</p>
      </sec>
      <sec id="sec4.3.4">
        <title>Computing module eigengenes</title>
        <p id="p0250">Module eigengenes (MEs) are a convenient metric to summarize the gene expression of a given co-expression module. While the co-expression network was computed using the metacell expression matrix <inline-formula><mml:math id="M129" altimg="si26.gif"><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula>, we compute MEs in the single-cell expression matrix <inline-formula><mml:math id="M130" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, thus yielding information about the activity of each module in each cell. The expression matrix for the <inline-formula><mml:math id="M131" altimg="si57.gif"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>-th module consisting of genes <inline-formula><mml:math id="M132" altimg="si58.gif"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">⊂</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="M133" altimg="si59.gif"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The ME for module <inline-formula><mml:math id="M134" altimg="si57.gif"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula> is then computed by performing singular value decomposition (SVD), such that <inline-formula><mml:math id="M135" altimg="si60.gif"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mi>U</mml:mi><mml:mi>D</mml:mi><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. Prior to running SVD, <inline-formula><mml:math id="M136" altimg="si61.gif"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> must be scaled and centered, and we accomplish this using the Seurat function ScaleData. Importantly, ScaleData enables us to optionally perform regression to diminish the effects of selected technical covariates prior to computing MEs. The first column of <inline-formula><mml:math id="M137" altimg="si62.gif"><mml:mrow><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>, containing the right-singular vectors <inline-formula><mml:math id="M138" altimg="si63.gif"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>3</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, is the ME of module <inline-formula><mml:math id="M139" altimg="si57.gif"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>.<disp-formula id="fd7"><label>(Equation 7)</label><mml:math id="M140" altimg="si64.gif"><mml:mrow><mml:msup><mml:mtext>ME</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="badbreak">=</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p>
        <p id="p0255">While SVD or other dimensionality reductions on a single-cell gene expression matrix contains critical biological information, technical artifacts are also present in these representations. There are many computational methods aiming to reduce technical effects in a reduced dimensional space, and these methods are often referred to as “batch-correction” or “integration” approaches.<xref rid="bib76" ref-type="bibr"><sup>79</sup></xref> In particular, Harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> is an algorithm well suited for correcting batch effects that may be present in a dimensionality-reduced single-cell expression dataset,<xref rid="bib76" ref-type="bibr"><sup>79</sup></xref> and here we propose applying Harmony to MEs to maximize the biological information content of each ME. We implemented the ME computation algorithm, as defined in <xref rid="tbox2" ref-type="boxed-text">Algorithm 2</xref>, as part of the hdWGCNA R package in the function ModuleEigengenes.<boxed-text id="tbox2"><label>Algorithm 2</label><caption><title>ModuleEigengenes</title></caption><p id="p0505">Require: <inline-formula><mml:math id="M141" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M142" altimg="si73.gif"><mml:mrow><mml:mi>dim</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> ⊳ normalized gene expression matrix of <inline-formula><mml:math id="M143" altimg="si74.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> genes and <inline-formula><mml:math id="M144" altimg="si22.gif"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> cells</p><p id="p0510"><bold>Require:</bold> modules ⊳ the table containing mappings between genes and modules.</p><p id="p0515"><bold>Require:</bold> mods ⊳ list of modules.</p><p id="p0520"><bold>Require:</bold> covariates ⊳ covariates to regress.</p><p id="p0525"><bold>Require:</bold> batches ⊳ batch identity to correct with Harmony, or null to ignore.</p><p id="p0530">ME <inline-formula><mml:math id="M145" altimg="si95.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mo linebreak="badbreak">∅</mml:mo><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></p><p id="p0535"><bold>for</bold><inline-formula><mml:math id="M146" altimg="si96.gif"><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mspace width="0.25em"/><mml:mtext>in</mml:mtext><mml:mspace width="0.25em"/><mml:mtext>mods</mml:mtext></mml:mrow></mml:math></inline-formula><bold>do</bold></p><p id="p0540">modules <inline-formula><mml:math id="M147" altimg="si97.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> subset(modules, module = = <inline-formula><mml:math id="M148" altimg="si57.gif"><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>)</p><p id="p0545"><inline-formula><mml:math id="M149" altimg="si98.gif"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> modules <inline-formula><mml:math id="M150" altimg="si99.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> [,gene]</p><p id="p0550"><inline-formula><mml:math id="M151" altimg="si100.gif"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></p><p id="p0555"><inline-formula><mml:math id="M152" altimg="si101.gif"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> ScaleData(<inline-formula><mml:math id="M153" altimg="si61.gif"><mml:mrow><mml:msup><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, covariates)</p><p id="p0560"><inline-formula><mml:math id="M154" altimg="si102.gif"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> SVD <inline-formula><mml:math id="M155" altimg="si103.gif"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula></p><p id="p0565">ME <inline-formula><mml:math id="M156" altimg="si104.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></p><p id="p0570"><bold>if</bold><inline-formula><mml:math id="M157" altimg="si105.gif"><mml:mrow><mml:mtext>batches</mml:mtext><mml:mo linebreak="goodbreak" linebreakstyle="after">≠</mml:mo><mml:mi mathvariant="monospace">N</mml:mi><mml:mi mathvariant="monospace">U</mml:mi><mml:mi mathvariant="monospace">L</mml:mi><mml:mi mathvariant="monospace">L</mml:mi></mml:mrow></mml:math></inline-formula><bold>then</bold></p><p id="p0575"><inline-formula><mml:math id="M158" altimg="si106.gif"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> Harmony(<inline-formula><mml:math id="M159" altimg="si107.gif"><mml:mrow><mml:msup><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, batches)</p><p id="p0580">ME <inline-formula><mml:math id="M160" altimg="si108.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></p><p id="p0585"><bold>end if</bold>.</p><p id="p0590">ME <inline-formula><mml:math id="M161" altimg="si109.gif"><mml:mrow><mml:mo linebreak="goodbreak" linebreakstyle="after">←</mml:mo></mml:mrow></mml:math></inline-formula> [ ME, ME <inline-formula><mml:math id="M162" altimg="si99.gif"><mml:mrow><mml:msup><mml:mrow/><mml:mrow><mml:mo>(</mml:mo><mml:mi>I</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>]</p><p id="p0595"><bold>end for</bold>.</p></boxed-text></p>
      </sec>
      <sec id="sec4.3.5">
        <title>Projecting co-expression modules in unseen data</title>
        <p id="p0260">In a typical hdWGCNA workflow, we perform metacell bagging, co-expression network analysis, module identification, and ME computation using the same single-cell gene expression dataset, starting from the expression matrix <inline-formula><mml:math id="M163" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>. Given the module-gene assignment table derived from a reference dataset <inline-formula><mml:math id="M164" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula>, we can run the ModuleEigengenes algorithm on a query dataset <inline-formula><mml:math id="M165" altimg="si65.gif"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:math></inline-formula> where the genes in <inline-formula><mml:math id="M166" altimg="si65.gif"><mml:mrow><mml:mi>Y</mml:mi></mml:mrow></mml:math></inline-formula> must be contained in the set of genes in <inline-formula><mml:math id="M167" altimg="si21.gif"><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M168" altimg="si66.gif"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mo linebreak="goodbreak" linebreakstyle="after">⊆</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. We implemented this process in the hdWGCNA R package as the ProjectModules function. Importantly, we designed ProjectModules to be agnostic towards the data modality or species used in the reference and query datasets, thereby allowing for a host of comparative analyses. ProjectModules can facilitate cross-species analysis leveraging a table that maps gene symbols between two genomes. Modules can be projected into epigenomic data modalities such as single-cell assay for transposase accessible chromatin with sequencing (scATAC-seq) provided a measure of gene expression estimated from chromatin accessibility, such as Signac<xref rid="bib58" ref-type="bibr"><sup>59</sup></xref> gene activity or ArchR<xref rid="bib77" ref-type="bibr"><sup>80</sup></xref> gene scores. This approach can also be used to project modules from bulk expression datasets into single-cell or spatial transcriptomics datasets.</p>
      </sec>
      <sec id="sec4.3.6">
        <title>Implementation of the hdWGCNA R package</title>
        <p id="p0265">hdWGCNA greatly extends upon scWGCNA,<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> our previous method for co-expression network analysis in single-cell transcriptomics data. scWGCNA was originally used to identify co-expression networks using bulk and single-cell RNA-seq together,<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> and in another study we showed that scWGCNA was suitable for network analysis using scRNA-seq alone.<xref rid="bib28" ref-type="bibr"><sup>28</sup></xref> Contrasting the hdWGCNA package, the implementation of scWGCNA was an R package containing a single function for metacell construction, and a single tutorial to cover the basics of network analysis using the WGCNA package<xref rid="bib1" ref-type="bibr"><sup>1</sup></xref> with the metacell matrix. We implemented hdWGCNA as an open-source object-oriented R package that leverages the widely used SeuratObject data structure. The hdWGCNA R package includes all necessary functions for network inference, data visualization, statistical testing, and downstream analysis such as pathway enrichment. Further, hdWGCNA includes functions to extract the network data from the SeuratObject to easily facilitate custom analysis with external Bioconductor or R packages. In order for hdWGCNA to be widely useful across the genomics community, we developed a detailed documentation website containing tutorials for network analysis in single-cell and spatial transcriptomics data, as well as tutorials for advanced analysis like consensus network analysis and network preservation testing. Unlike scWGCNA, the metacell construction algorithm (<xref rid="tbox1" ref-type="boxed-text">Algorithm 1</xref>) in hdWGCNA includes new parameters to avoid redundant metacells, the module eigengene algorithm in hdWGCNA (<xref rid="tbox2" ref-type="boxed-text">Algorithm 2</xref>) accounts for batch effects and additional covariates in the input dataset, and hdWGCNA contains functions to handle spatial transcriptomics datasets. Several key steps in co-expression network analysis, like calculating module eigengenes and eigengene-based connectivity, have been re-implemented to operate on sparse matrices, greatly decreasing runtime and memory usage. hdWGNCA is completely technology agnostic, and can be adapted to handle high dimensional counts matrices from any single-cell or spatial transcriptomics platform. Additionally, hdWGCNA includes a novel approach for visualizing genes and the underlying network in a two-dimensional manifold of co-expression space using UMAP.<xref rid="bib19" ref-type="bibr"><sup>19</sup></xref> As shown throughout this manuscript, hdWGCNA includes functions for projecting co-expression networks into a variety of external datasets. The widespread adoption of single-cell genomics has led to many biologists running their own computational analysis, and we designed the hdWGCNA R package with these individuals in mind through our various step-by-step tutorials and detailed documentation.</p>
      </sec>
    </sec>
    <sec id="sec4.4">
      <title>Quantification and statistical analysis</title>
      <sec id="sec4.4.1">
        <title>Reprocessing published datasets</title>
        <p id="p0270">The <xref rid="sec4.1" ref-type="sec">key resources table</xref> details the different datasets used throughout this manuscript. We used several published datasets generated by our own group,<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref><sup>,</sup><xref rid="bib28" ref-type="bibr"><sup>28</sup></xref><sup>,</sup><xref rid="bib55" ref-type="bibr"><sup>56</sup></xref> and sequencing data was not re-downloaded for these studies. For all human snRNA-seq datasets, we applied a uniform processing pipeline to process each dataset starting from the raw sequencing data and resulting in an anndata object<xref rid="bib78" ref-type="bibr"><sup>72</sup></xref> containing UMI counts, normalized gene expression, cluster identities, and cell type annotations. Parameters used throughout this processing pipeline vary slightly between different datasets, and all parameters are noted in the data processing scripts in our github repository. For each biological replicate, we used the kb count function from kallisto <inline-formula><mml:math id="M169" altimg="si67.gif"><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> bustools<xref rid="bib79" ref-type="bibr"><sup>81</sup></xref> to psuedoalign raw sequencing reads to the reference transcriptome and quantify gene expression attributed to each cell barcode. The human reference transcriptome (GRch38) was obtained from the <inline-formula><mml:math id="M170" altimg="si1.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> Genomics website (version 2020-A, July 2020), and was re-formatted for use with kallisto <inline-formula><mml:math id="M171" altimg="si67.gif"><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> bustools using the kb ref function. For each of the UMI counts matrices, we used the remove-background function from cellbender<xref rid="bib80" ref-type="bibr"><sup>74</sup></xref> to simultaneously identify which barcodes corresponded to cells and to remove counts attributed to ambient RNA. We then used scrublet<xref rid="bib81" ref-type="bibr"><sup>73</sup></xref> to compute ”doublet scores”, the likelihood of each barcode mapping to more than one cell. Counts matrices from each biological replicate in a given dataset are then merged into a single anndata object, and any relevant sample level meta-data (age, sex, disease status) was stored in the adata.obs table. We performed a percentile filtering of cells that were outliers from each dataset based on the number of UMI per cell the percentage of UMI attributed to mitochondrial genes per cell, and the doublet score. Filtering based on these criteria was performed in each sample, as well as dataset-wide. After filtering, downstream data processing steps were carried out with SCANPY.<xref rid="bib78" ref-type="bibr"><sup>72</sup></xref> The UMI counts matrix was normalized with <inline-formula><mml:math id="M172" altimg="si68.gif"><mml:mrow><mml:mi>ln</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mtext>CPM</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> using the functions sc.pp.normalize_total and sc.pp.log1p. Highly variable genes were identified using the function sc.pp.highly_variable_genes, and these genes are used as the features for downstream analysis steps such as principal component analysis (PCA). The normalized expression matrix was then scaled to unit variance and centered at zero using the function sc.pp.scale. PCA was performed on the scaled expression matrix using the function sc.tl.pca. Harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> was used to correct the PCA matrix for batch effects using the function sc.external.pp.harmony_integrate. The harmonized PCA matrix was then used to construct a cell neighborhood graph using the function sc.pp.neighbors. The cell neighborhood graph was then used to compute a two-dimensional representation of the data with uniform manifold approximation and projection<xref rid="bib19" ref-type="bibr"><sup>19</sup></xref> using the function sc.tl.umap, and to group cells into clusters with Leiden clustering<xref rid="bib82" ref-type="bibr"><sup>82</sup></xref> using the function sc.tl.leiden. We inspected the gene expression signatures in each Leiden cluster for a panel of canonical cell-type marker genes in order to assign a cell-type label to each cluster, and to identify additional doublet clusters that may have escaped the previous filtering steps. The distribution of quality control metrics was inspected in each cluster. We filtered out cells belonging to clusters that displayed conflicting expression of cell-type marker genes, or were outliers in their quality control metrics. After filtering these low-quality clusters, we ran UMAP and Leiden clustering again, resulting in the final processed dataset. We used a custom script to convert the datasets from <italic>anndata</italic> to SeuratObject by saving the individual components (counts matrix, cell meta-data, gene meta-data, dimensionality reductions, etc.) in Python and then loading them back into R to create a SeuratObject.</p>
      </sec>
      <sec id="sec4.4.2">
        <title>Iterative network analysis of major cell types in the human cortex</title>
        <p id="p0275">We performed an iterative co-expression network analysis of the major cell types (ASC, EX, INH, MG, ODC, OPC) in the human PFC snRNA-seq dataset from Zhou et al.,<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> only including samples from control brains (36,671 cells and 36,601 genes). We retained genes that were expressed in at least 5% of cells for downstream analysis. Metacells were computed separately for each major cell type and each sample using the hdWGCNA function MetacellsByGroups, aggregating 25 cells per metacell. Further, we ran MetacellsByGroups while varying the <inline-formula><mml:math id="M173" altimg="si3.gif"><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> parameter in order to asses the resulting metacell expression matrix sparsity. For each cell type, we applied the following hdWGCNA commands with default arguments to perform network analysis: TestSoftPowers, ConstructNetwork, ModuleEigengenes, ModuleConnectivity, and RunModuleUMAP. We performed module preservation analysis<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> of the ODC co-expression modules in an external snRNA-seq dataset of the human PFC.<xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> Modules were projected from the reference to query dataset using the hdWGCNA function ProjectModules, and the module preservation test was performed using ModulePreservation with 100 permutations.</p>
      </sec>
      <sec id="sec4.4.3">
        <title>Comparison of hdWGCNA with alternative metacell approaches</title>
        <p id="p0280">For the purpose of co-expression network analysis, we compared our metacell aggregation approach (<xref rid="tbox1" ref-type="boxed-text">Algorithm 1</xref>) with two alternative approaches, namely Metacell2<xref rid="bib14" ref-type="bibr"><sup>14</sup></xref> and SEACells.<xref rid="bib16" ref-type="bibr"><sup>16</sup></xref> We ran the three metacell approaches using the recommended settings on the same dataset, and then ran hdWGCNA on each of the resulting metacell expression matrices. We used a scRNA-seq of 6,800 CD34<sup>+</sup> hematopoietic stem and progenitor stem cells included with the SEACells package, and we used the cluster annotations from the original study. Notably, SEACells and Metacell2 do not account for cell labels in their aggregation procedures, which may result in a number of metacells containing transcriptomes from differently labeled cells. For the hdWGCNA metacell algorithm, we aggregated 50 cells per metacell. For the three metacell expression matrices derived from the different algorithms, we performed co-expression network analysis with the standard hdWGCNA pipeline by sequentially running the following functions with default parameters: TestSoftPowers, ConstructNetwork, ModuleEigengenes, ModuleConnectivity, and RunModuleUMAP. With the same cluster settings, Dynamic Tree Cut recovered a different number of co-expression modules for the three methods (hdWGCNA: 16 modules; MC2: 13 modules; SEACells: 20 modules). We performed pairwise comparisons between the gene modules detected with each metacell approach using Fisher’s exact test to test module overlaps. Additionally, we performed rank-rank hypergeometric overlap<xref rid="bib83" ref-type="bibr"><sup>83</sup></xref> (RRHO) tests using the RRHO function from the R package RRHO (version 1.13.0) to compare the kME ranking between modules across methods. To compare MEs and Seurat module scores, we ran the AddModuleScore function, and computed Pearson correlations between each ME and each module score.</p>
      </sec>
      <sec id="sec4.4.4">
        <title>Application of hdWGCNA to a one million cell scRNA-seq dataset</title>
        <p id="p0285">We obtained a publicly available scRNA-seq dataset from Parse Biosciences of 1M peripheral blood mononuclear cells (PBMCs) from twelve healthy donors and twelve Type-1 diabetic donors generated using the Evercode Whole Transcriptome Mega protocol. This analysis was performed on a compute cluster with 200 GB of memory and eight CPU cores. The UMI counts matrix and sample meta data was downloaded from Parse Biosciences’ Website. We processed the counts matrix using SCANPY using a similar pipeline as described in the <xref rid="sec4.4.1" ref-type="sec">reprocessing published dataset</xref> section. For quality control, we excluded cells with greater than 25% mitochondrial reads, greater than 5,000 genes, and greater than 25,000 counts. After dimensionality reduction with PCA, Harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> batch correction, and Leiden clustering<xref rid="bib82" ref-type="bibr"><sup>82</sup></xref> (resolution = 1), we annotated cell populations using PBMC marker genes obtained from Azimuth.<xref rid="bib7" ref-type="bibr"><sup>7</sup></xref> We excluded clusters with conflicting cell-type markers as potential doublet populations, retaining a total of 965,363 cells and 26,862 genes for downstream analysis. The major cell compartments recovered in this analysis were similar to those reported by Parse Biosciences in their analysis, including as T-cells, B-cells, monocytes, dendritic cells, basophils, and plasmablasts. Following the SCANPY data processing, we wrote the individual components (counts matrix, cell meta-data, gene meta-data, dimensionality reductions, etc.) to disk so they could be loaded into R and assembled into a Seurat object.</p>
        <p id="p0290">We performed co-expression network analysis iteratively for the plasmablast, T-cell, B-cell, monocyte, and dendritic cell compartments using an hdWGCNA pipeline for each group (<xref rid="mmc1" ref-type="supplementary-material">Figure S5</xref>). Metacells were constructed separately for each sample and each cell cluster with the hdWGCNA function MetacellsByGroups, aggregating 50 cells per metacell. The metacell aggregation step had a runtime of 85 min and 59 s. For each cell population, we first subset the Seurat object for the cell population of interest and then performed the standard hdWGCNA pipeline by sequentially running the following functions with default parameters: TestSoftPowers, ConstructNetwork, ModuleEigengenes, ModuleConnectivity, and RunModuleUMAP. We note that for the largest cell population (T-cells, 555,417 cells), the runtime for the network construction step was 186 s.</p>
      </sec>
      <sec id="sec4.4.5">
        <title>Runtime and memory usage of hdWGCNA</title>
        <p id="p0295">We tested the runtime and memory usage of the primary co-expression network analysis functions in hdWGCNA using the Velmeshev et al. 2019<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> dataset. We selected the neuronal cell population from the dataset for network analysis, and downsampled the dataset at different sizes ranging from 1,000 to 50,000 cells to test the runtime and memory usage as a function of the number of cells in the input dataset. The following functions were tested: SetupForWGCNA, MetacellsByGroups, TestSoftPowers, ModuleEigengenes, and ModuleConnectivity. We tested ModuleEigengenes with and without Harmony correction. All of these tests were done using eight parallel threads, and hdWGCNA can be sped up further by increasing the number of parallel threads. Importantly, the number of input genes and other network analysis parameters also have an effect on runtime and memory usage.</p>
      </sec>
      <sec id="sec4.4.6">
        <title>Evaluating performance of hdWGCNA co-expression networks</title>
        <p id="p0300">We tested the functional coherence of hdWGCNA co-expression networks using the Extending ’Guilt-by-Association’ by Degree (EGAD)<xref rid="bib23" ref-type="bibr"><sup>23</sup></xref> algorithm. Connected genes in biological networks are potentially involved in the same processes, and EGAD evaluates this network property given a set of gene-process annotations. We performed functional coherence testing with the EGAD R package (version 1.18.0) using the six cell-type-specific co-expression networks from the Zhou et al. 2020<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref> human PFC dataset. We downloaded a table of gene ontology associations for each gene from ensembl biomart, and formatted this table using the EGAD function make_annotations. We then ran the functional coherence test with EGAD using the function run_GBA, using the TOM as the input network, and we report the distributions of area under the receiver operating characteristic curve (AUC) values for each tested biological process in the six co-expression networks.</p>
        <p id="p0305">We used the xgboost R package<xref rid="bib25" ref-type="bibr"><sup>25</sup></xref> (version 1.7.3.1) to perform XGBoost regularized regression analysis to predict a given gene’s expression based on the expression of the top ten module hub genes for the module each gene was assigned to. This analysis was done using the six cell-type-specific co-expression networks described in the <xref rid="sec4.4.2" ref-type="sec">iterative network analysis of major cell types in the human cortex</xref> section. We performed 5-fold cross validation, and measured the performance of the model as a test set root-mean-square error (RMSE) averaged across the 5-folds. We ran XGBoost for 100 iterations for each individual test, with a maximum tree depth of 3 and regularization alpha of 0.5.</p>
      </sec>
      <sec id="sec4.4.7">
        <title>Spatial co-expression network analysis in the mouse brain</title>
        <p id="p0310">We collected the publicly available <inline-formula><mml:math id="M174" altimg="si1.gif"><mml:mrow><mml:mn>10</mml:mn><mml:mo linebreak="goodbreak" linebreakstyle="after">×</mml:mo></mml:mrow></mml:math></inline-formula> Genomics Visium mouse brain dataset using the SeuratData R package. This dataset consists of an anterior and a posterior slice from a sagittal brain section, which we merged into a single Seurat object comprising 6,049 ST spots and 31,053 genes. We processed this dataset using the standard Seurat pipeline by sequentially running the following commands: NormalizeData, FindVariableFeatures, ScaleData, RunPCA, FindNeighbors, FindClusters, and RunUMAP. The top thirty PCs were used for Louvain clustering<xref rid="bib84" ref-type="bibr"><sup>84</sup></xref> and UMAP. While ST spots were clustered based on transcriptomic information alone, we were able to annotate them based on anatomical features.</p>
        <p id="p0315">Neighboring ST spots were aggregated into metaspots in the anterior and posterior slices using the hdWGCNA function MetaspotsByGroups. We retained genes expressed in 5% of spots for downstream analysis, totaling 12,355 genes. We tested for the optimal soft-power threshold <inline-formula><mml:math id="M175" altimg="si46.gif"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> based on the the fit to a scale-free topology using the hdWGCNA function TestSoftPowers. The co-expression network was constructed using all ST spots spanning both the anterior and posterior slices using the hdWGCNA function ConstructNetwork with the following parameters: networkType = “signed”, TOMType = “signed”, soft_power = 5, deepSplit = 4, detectCutHeight = 0.995, minModuleSize = 50, mergeCutHeight = 0.2. Module eigengenes and eigengene-based connectivities were computed using the ModuleEigengenes and ModuleConnectivity functions respectively. This approach identified 12 spatial co-expression modules, and we visualized the spatial distributions of these modules by plotting their MEs directly onto the biological coordinates for each spot. The co-expression network was projected into two dimensions using UMAP with the hdWGCNA function RunModuleUMAP, and we used the top five hub genes (ranked by kMEs) as the input features for UMAP. We used the R package enrichR<xref rid="bib85" ref-type="bibr"><sup>85</sup></xref> (version 3.0) to perform enrichment analysis on the top 100 genes in each module ranked by kME using the following databases: GO_Biological_Process_2021, GO_Cellular_Component_2021, GO_Molecular_Function_2021, WikiPathway_2021_Mouse, and KEGG_2021_Mouse. We assessed the overlap between genes from these spatial co-expression modules and differentially expressed genes in each cluster from a recent snRNA-seq study of the whole mouse brain using Fisher’s exact test implemented in the R package GeneOverlap (version 1.26.0). Finally, we performed a separate network analysis on a subset of the ST dataset only containing the cortical layers 2–6, and we followed an identical hdWGCNA analysis pipeline to the full ST dataset for the cortical analysis.</p>
      </sec>
      <sec id="sec4.4.8">
        <title>Isoform co-expression network analysis in the mouse hippocampus</title>
        <p id="p0320">We performed isoform co-expression network analysis in radial glia lineage cells (radial glia, astrocytes, ependymal cells, and neural intermediate progenitor cells) from mouse hippocampus ScISOrSeq dataset from Joglekar et al.<xref rid="bib8" ref-type="bibr"><sup>8</sup></xref> using the hdWGCNA R package. The gene-level counts matrix for this dataset was obtained from the Gene Expression Omnibus database (GEO: GSE15845), and the isoform-level counts matrix was obtained directly from the authors of the original study. We formatted this dataset as a Seurat object with an isoform-level expression assay and a gene-level expression assay. The standard Seurat processing pipeline was used on the gene-level expression assay, where we sequentially ran the functions NormalizeData, FindVariableFeatures, ScaleData, and RunPCA with default parameters. The dataset was projected into two dimensions by running UMAP on the PCA matrix with 30 components using the RunUMAP function. For all downstream purposes, the cell-type annotations from the original study were used.</p>
        <p id="p0325">Radial glia cells were selected for network analysis, and isoforms expressed in fewer than 1% of these cells were excluded, yielding a set of 2,190 cells and 10,375 isoforms from 4,770 genes. We constructed metacells separately for each cell type on the isoform-level expression assay using the hdWGCNA function MetacellsByGroups with <inline-formula><mml:math id="M176" altimg="si69.gif"><mml:mrow><mml:mi>k</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></inline-formula>. We performed a parameter sweep for the soft-power threshold <inline-formula><mml:math id="M177" altimg="si46.gif"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> using the function TestSoftPowers. The isoform co-expression network was constructed using the ConstructNetwork function with the following parameters: networkType = “signed”, TOMType = “signed”, soft_power = 5, deepSplit = 4, detectCutHeight = 0.995, minModuleSize = 50, mergeCutHeight = 0.5. This approach identified 11 isoform co-expression modules. Isoform-level module eigenisoforms were computed using the ModuleEigengenes function, and eigenisoform-based connectivity was computed using the ModuleConnectivity function with default parameters. We computed a semi-supervised UMAP projection of the co-expression network using the hdWGCNA function RunModuleUMAP, with the module labels and the top six hub isoforms (by kMEiso) per module as the input features. We used the enrichR to identify enriched pathways in each module ranked by using the following databases: GO_Biological_Process_2021, GO_Cellular_Component_2021, GO_Molecular_Function_2021, WikiPathway_2021_Mouse, and KEGG_2021_Mouse.</p>
        <p id="p0330">To assess isoform co-expression network dynamics throughout the cellular trajectories within the radial glia lineage, we performed pseudotime analysis using Monocle 3<xref rid="bib36" ref-type="bibr"><sup>36</sup></xref> (version 1.0.0). We computed a UMAP of just radial glia lineage cells using the Monocle 3 function run_umap. A trajectory graph was built on this UMAP representation using the function learn_graph, and pseudotime was calculated with the function order_cells using the radial glia cells as the starting point. We split the pseudotime trajectory into three lineages based on the distinct cell fates (astrocyte, neuronal, and ependymal). We grouped cells into 50 evenly-sized bins throughout each trajectory, and we applied loess regression to the average module eigenisoform of each module in these bins to inspect the dynamics of each module throughout development. We wrote a custom script to generate a GTF of isoform models output from the ScISOrSeq pipeline. To visualize expressed isoforms, we plotted isoforms from this GTF on the UCSC genome browser as well as in Swan.<xref rid="bib39" ref-type="bibr"><sup>38</sup></xref></p>
      </sec>
      <sec id="sec4.4.9">
        <title>Co-expression analysis network of inhibitory neurons in autism spectrum disorder</title>
        <p id="p0335">We selected inhibitory neurons from the Velmeshev et al.<xref rid="bib9" ref-type="bibr"><sup>9</sup></xref> human autism spectrum disorder (ASD) snRNA-seq dataset for co-expression network analysis. Of the 121,451 cells in this dataset, 20,249 were labeled as inhibitory neurons based on marker gene expression profiles. We retained 11,194 genes which were expressed in at least 10% of cells from any cluster, and had non-zero variance in the inhibitory neuron population. Metacell transcriptomic profiles were constructed separately for each of the 54 samples and each cell type using the hdWGCNA function MetacellsByGroups, aggregating 50 cells into one metacell. We selected a soft-power threshold <inline-formula><mml:math id="M178" altimg="si70.gif"><mml:mrow><mml:mi>β</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> based on the parameter sweep performed with the TestSoftPowers function. The co-expression network was computed with the ConstructNetwork function with the following parameters: networkType = “signed”, TOMType = “signed”, soft_power = 9, deepSplit = 4, detectCutHeight = 0.995, minModuleSize = 50, mergeCutHeight = 0.2. Module eigengenes were computed using the ModuleEigengenes function, and we applied Harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> to correct MEs based on sequencing batch. Eigengene-based connectivity for each gene was computed using ModuleConnectivity. The co-expression network was embedded in two dimensions using UMAP with the RunModuleUMAP function with the top five genes (ranked by kMEs) per module as the input features. Distributions of MEs were compared between ASD and control samples for each inhibitory neuron subpopulation using a two-sided Wilcoxon rank-sum test with the R function wilcox.test. We used the enrichR<xref rid="bib85" ref-type="bibr"><sup>85</sup></xref> to perform enrichment analysis on the top 100 genes in each module ranked by kME using the following databases: GO_Biological_Process_2021, GO_Cellular_Component_2021, GO_Molecular_Function_2021, WikiPathway_2021_Human, and KEGG_2021_Human. Furthermore, we computed the overlap between co-expression modules and ASD-associated genes from the SFARI Gene database using the R package GeneOverlap, which calculates the overlap between sets of genes using Fisher’s exact test.</p>
      </sec>
      <sec id="sec4.4.10">
        <title>Consensus co-expression network analysis of microglia in Alzheimer’s disease</title>
        <p id="p0340">We performed consensus co-expression network analysis of microglia in Alzheimer’s disease (AD) using three published snRNA-seq datasets.<xref rid="bib10" ref-type="bibr"><sup>10</sup></xref><sup>,</sup><xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref> The individually processed datasets were merged into a single Seurat object comprising 189,127 nuclei, and the datasets were integrated into a common dimensionally-reduced space using PCA and Harmony.<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> We retained all nuclei labeled microglia for network analysis based on expression of canonical marker genes such as <italic>CSF1R</italic> (9,904 nuclei), and genes expressed in at least 5% of microglia from any of the three studies were retained (7,900 genes). Metacells were constructed in groups of cells based on AD diagnosis status and study of origin, aggregating 25 cells per metacell. Within hdWGCNA, we used the SetMultiExpr function to create a list of expression matrices containing the selected genes and metacells for the three studies. We performed a separate parameter sweep for the three expression matrices using the hdWGCNA function TestSoftPowerConsensus, ensuring that we used an appropriate <inline-formula><mml:math id="M179" altimg="si46.gif"><mml:mrow><mml:mi>β</mml:mi></mml:mrow></mml:math></inline-formula> value for each dataset (Mathys et al.: <inline-formula><mml:math id="M180" altimg="si71.gif"><mml:mrow><mml:mi>β</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>, Zhou et al.: <inline-formula><mml:math id="M181" altimg="si72.gif"><mml:mrow><mml:mi>β</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></inline-formula>, Morabito &amp; Miyoshi et al.: <inline-formula><mml:math id="M182" altimg="si71.gif"><mml:mrow><mml:mi>β</mml:mi><mml:mo linebreak="goodbreak" linebreakstyle="after">=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></inline-formula>). The consensus co-expression network was contructed using the hdWGCNA function ConstructNetwork using the consensus = TRUE option. Individual TOMs were computed for each dataset, and they were scaled based on the 80th percentile in order to alleviate different statistical properties specific to each dataset rather than the underlying biology. A consensus TOM was computed by taking the element-wise minimum of the individual TOMs from each dataset. Therefore, large topological overlap values between two genes, which indicate a strong co-expression relationship, are supported across all three datasets in the consensus TOM. We performed hierarchical clustering on the consensus TOM, and we used the Dynamic Tree Cut algorithm<xref rid="bib3" ref-type="bibr"><sup>3</sup></xref> was used to identify consensus co-expression modules based on the hierarchy. Module eigengenes were computed using the ModuleEigengenes function, and we applied Harmony<xref rid="bib22" ref-type="bibr"><sup>22</sup></xref> to correct MEs based on the dataset of origin. Eigengene-based connectivity for each gene was computed using ModuleConnectivity. We visualized the network using UMAP with the top ten hub genes (ranked by kMEs) per module as the input features, annotating the hub genes and known disease-associated microglia genes.<xref rid="bib49" ref-type="bibr"><sup>50</sup></xref> We used the enrichR<xref rid="bib85" ref-type="bibr"><sup>85</sup></xref> to perform enrichment analysis on the top 100 genes in each module ranked by kME using the following databases: GO_Biological_Process_2021, GO_Cellular_Component_2021, GO_Molecular_Function_2021, WikiPathway_2021_Human, and KEGG_2021_Human.</p>
        <p id="p0345">We sought to model the transcriptional dynamics governing the shift between homeostatic and activated microglia in AD, therefore we performed pseudotime analysis using Monocle 3<xref rid="bib36" ref-type="bibr"><sup>36</sup></xref> to build a continuous trajectory of microglia cell states. A trajectory graph was built on the microglia UMAP using the function learn_graph, and pseudotime was calculated with the function order_cells. We oriented the start of pseudotime based on the expression of homeostatic microglia marker genes, such as <italic>P2RY12</italic>, <italic>CX3CR1</italic>, and <italic>CSF1R</italic>. We grouped cells into 50 evenly-sized bins throughout each trajectory, and we applied loess regression to the average module eigengene of each module in these bins to inspect the dynamics of each module throughout the microglia trajectory.</p>
        <p id="p0350">To link the integrated microglia snRNA-seq dataset with polygenic risk of disease for individual cells, we used the scDRS python package (version 1.0.0).<xref rid="bib54" ref-type="bibr"><sup>52</sup></xref> This pipeline takes 1) a set of putative disease genes derived from GWAS summary statistics and 2) a scRNA-seq dataset as inputs, and outputs disease enrichment statistics for a given disease (raw and normalized disease scores, cell-level scDRS p value, and <inline-formula><mml:math id="M183" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula>-scores converted from the p values). GWAS summary statistics of 74 diseases and complex traits supplied by scDRS were utilized as gene sets, among which a gene set by Jansen et al.<xref rid="bib45" ref-type="bibr"><sup>46</sup></xref> provided the set of genes associated with AD. We then visualized the AD scDRS <inline-formula><mml:math id="M184" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula>-scores in the integrated AD microglia trajectory, and we correlated the scDRS score with the trajectory using a Pearson correlation.</p>
        <p id="p0355">We performed module preservation<xref rid="bib20" ref-type="bibr"><sup>20</sup></xref> analysis in a variety of external datasets from human and mouse<xref rid="bib11" ref-type="bibr"><sup>11</sup></xref><sup>,</sup><xref rid="bib12" ref-type="bibr"><sup>12</sup></xref><sup>,</sup><xref rid="bib28" ref-type="bibr"><sup>28</sup></xref><sup>,</sup><xref rid="bib55" ref-type="bibr"><sup>56</sup></xref><sup>,</sup><xref rid="bib56" ref-type="bibr"><sup>57</sup></xref><sup>,</sup><xref rid="bib57" ref-type="bibr"><sup>58</sup></xref> to test for the reproducibility of the consensus AD microglia modules in the microglia population from each dataset. We used the hdWGCNA function ProjectModules to compute module eigengenes for the consensus AD microglia modules for each query dataset. The module preservation test was performed using the hdWGCNA function ModulePreservation with 100 permutations, and we reported the preservation <inline-formula><mml:math id="M185" altimg="si4.gif"><mml:mrow><mml:mi>Z</mml:mi></mml:mrow></mml:math></inline-formula>-summary statistics in a heatmap. For the Morabito &amp; Miyoshi et al. snATAC-seq dataset, we used the gene activity<xref rid="bib58" ref-type="bibr"><sup>59</sup></xref> representation as a gene-level summary of chromatin accessibility in order to assess the module preservation at the epigenomic level.</p>
      </sec>
      <sec id="sec4.4.11">
        <title>Analysis of bulk RNA-seq co-expression modules in single-cell data</title>
        <p id="p0360">We projected gene co-expression modules from two bulk RNA-seq studies of AD<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref><sup>,</sup><xref rid="bib62" ref-type="bibr"><sup>63</sup></xref> into a published snRNA-seq study of AD to assess their expression patterns within various cell populations. While both of these studies used the samples from the same bulk RNA-seq cohort, the set of modules from Morabito et al. 2020<xref rid="bib55" ref-type="bibr"><sup>56</sup></xref> was based on a consensus network analysis across six brain regions while the other set of modules from the AMP-AD study<xref rid="bib62" ref-type="bibr"><sup>63</sup></xref> were constructed separately for seven different brain regions. Module eigengenes were computed for each of these bulk RNA-seq modules in the snRNA-seq dataset using the hdWGCNA function ProjectModules, using Harmony to correct MEs based on sequencing batch. We visualized the MEs of the projected modules in the snRNA-seq dataset using the Seurat function DotPlot.</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <ref-list id="cebib0010">
    <title>References</title>
    <ref id="bib1">
      <label>1</label>
      <element-citation publication-type="journal" id="sref1">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>WGCNA: an R package for weighted correlation network analysis</article-title>
        <source>BMC Bioinf.</source>
        <volume>9</volume>
        <year>2008</year>
        <fpage>559</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-559</pub-id>
      </element-citation>
    </ref>
    <ref id="bib2">
      <label>2</label>
      <element-citation publication-type="journal" id="sref2">
        <person-group person-group-type="author">
          <name>
            <surname>Yip</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Gene network interconnectedness and the generalized topological overlap measure</article-title>
        <source>BMC Bioinf.</source>
        <volume>8</volume>
        <year>2007</year>
        <fpage>22</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-8-22</pub-id>
      </element-citation>
    </ref>
    <ref id="bib3">
      <label>3</label>
      <element-citation publication-type="journal" id="sref3">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Defining clusters from a hierarchical cluster tree: the Dynamic Tree Cut package for R</article-title>
        <source>Bioinformatics</source>
        <volume>24</volume>
        <year>2008</year>
        <fpage>719</fpage>
        <lpage>720</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm563</pub-id>
        <pub-id pub-id-type="pmid">18024473</pub-id>
      </element-citation>
    </ref>
    <ref id="bib4">
      <label>4</label>
      <element-citation publication-type="journal" id="sref4">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Understanding network concepts in modules</article-title>
        <source>BMC Syst. Biol.</source>
        <volume>1</volume>
        <year>2007</year>
        <fpage>24</fpage>
        <pub-id pub-id-type="doi">10.1186/1752-0509-1-24</pub-id>
        <pub-id pub-id-type="pmid">17547772</pub-id>
      </element-citation>
    </ref>
    <ref id="bib5">
      <label>5</label>
      <element-citation publication-type="journal" id="sref5">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>36</volume>
        <year>2018</year>
        <fpage>411</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id>
        <pub-id pub-id-type="pmid">29608179</pub-id>
      </element-citation>
    </ref>
    <ref id="bib6">
      <label>6</label>
      <element-citation publication-type="journal" id="sref6">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>W.M.</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Stoeckius</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <volume>177</volume>
        <year>2019</year>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="bib7">
      <label>7</label>
      <element-citation publication-type="journal" id="sref7">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Andersen-Nissen</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>W.M.</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Wilk</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Darby</surname>
            <given-names>C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell</source>
        <volume>184</volume>
        <year>2021</year>
        <fpage>3573</fpage>
        <lpage>3587.e29</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="bib8">
      <label>8</label>
      <element-citation publication-type="journal" id="sref8">
        <person-group person-group-type="author">
          <name>
            <surname>Joglekar</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Prjibelski</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Mahfouz</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Collier</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Schlusche</surname>
            <given-names>A.K.</given-names>
          </name>
          <name>
            <surname>Marrocco</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>S.R.</given-names>
          </name>
          <name>
            <surname>Haase</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A spatially resolved brain region- and cell type-specific isoform atlas of the postnatal mouse brain</article-title>
        <source>Nat. Commun.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>463</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-20343-5</pub-id>
        <pub-id pub-id-type="pmid">33469025</pub-id>
      </element-citation>
    </ref>
    <ref id="bib9">
      <label>9</label>
      <element-citation publication-type="journal" id="sref9">
        <person-group person-group-type="author">
          <name>
            <surname>Velmeshev</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Schirmer</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Haeussler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Perez</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Mayer</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Bhaduri</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Goyal</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Rowitch</surname>
            <given-names>D.H.</given-names>
          </name>
          <name>
            <surname>Kriegstein</surname>
            <given-names>A.R.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell genomics identifies cell type–specific molecular changes in autism</article-title>
        <source>Science</source>
        <volume>364</volume>
        <year>2019</year>
        <fpage>685</fpage>
        <lpage>689</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aav8130</pub-id>
        <pub-id pub-id-type="pmid">31097668</pub-id>
      </element-citation>
    </ref>
    <ref id="bib10">
      <label>10</label>
      <element-citation publication-type="journal" id="sref10">
        <person-group person-group-type="author">
          <name>
            <surname>Mathys</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Davila-Velderrain</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Mohammadi</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>J.Z.</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Abdurrob</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>X.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>
        <source>Nature</source>
        <volume>570</volume>
        <year>2019</year>
        <fpage>332</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1195-2</pub-id>
        <pub-id pub-id-type="pmid">31042697</pub-id>
      </element-citation>
    </ref>
    <ref id="bib11">
      <label>11</label>
      <element-citation publication-type="journal" id="sref11">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>W.M.</given-names>
          </name>
          <name>
            <surname>Andhey</surname>
            <given-names>P.S.</given-names>
          </name>
          <name>
            <surname>Swain</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>K.R.</given-names>
          </name>
          <name>
            <surname>Poliani</surname>
            <given-names>P.L.</given-names>
          </name>
          <name>
            <surname>Cominelli</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Grover</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gilfillan</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human and mouse single-nucleus transcriptomics reveal TREM2-dependent and TREM2-independent cellular responses in Alzheimer’s disease</article-title>
        <source>Nat. Med.</source>
        <volume>26</volume>
        <year>2020</year>
        <fpage>131</fpage>
        <lpage>142</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-019-0695-9</pub-id>
        <pub-id pub-id-type="pmid">31932797</pub-id>
      </element-citation>
    </ref>
    <ref id="bib12">
      <label>12</label>
      <element-citation publication-type="journal" id="sref12">
        <person-group person-group-type="author">
          <name>
            <surname>Morabito</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Miyoshi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Michael</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Shahin</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Martini</surname>
            <given-names>A.C.</given-names>
          </name>
          <name>
            <surname>Head</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Leavy</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Perez-Rosendahl</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Swarup</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>Single-nucleus chromatin accessibility and transcriptomic characterization of Alzheimer’s disease</article-title>
        <source>Nat. Genet.</source>
        <volume>53</volume>
        <year>2021</year>
        <fpage>1143</fpage>
        <lpage>1155</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00894-z</pub-id>
        <pub-id pub-id-type="pmid">34239132</pub-id>
      </element-citation>
    </ref>
    <ref id="bib13">
      <label>13</label>
      <element-citation publication-type="journal" id="sref13">
        <person-group person-group-type="author">
          <name>
            <surname>Baran</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Bercovich</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sebe-Pedros</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lubling</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Giladi</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Chomsky</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Meir</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Hoichman</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lifshitz</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>MetaCell: analysis of single-cell RNA-seq data using K-nn graph partitions</article-title>
        <source>Genome Biol.</source>
        <volume>20</volume>
        <year>2019</year>
        <fpage>206</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1812-2</pub-id>
        <pub-id pub-id-type="pmid">31604482</pub-id>
      </element-citation>
    </ref>
    <ref id="bib14">
      <label>14</label>
      <element-citation publication-type="journal" id="sref14">
        <person-group person-group-type="author">
          <name>
            <surname>Ben-Kiki</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Bercovich</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lifshitz</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Metacell-2: a divide-and-conquer metacell algorithm for scalable scRNA-seq analysis</article-title>
        <source>Genome Biol.</source>
        <volume>23</volume>
        <year>2022</year>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02667-1</pub-id>
        <pub-id pub-id-type="pmid">35440087</pub-id>
      </element-citation>
    </ref>
    <ref id="bib15">
      <label>15</label>
      <element-citation publication-type="journal" id="sref15">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>H.A.</given-names>
          </name>
          <name>
            <surname>Packer</surname>
            <given-names>J.S.</given-names>
          </name>
          <name>
            <surname>McFaline-Figueroa</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Cusanovich</surname>
            <given-names>D.A.</given-names>
          </name>
          <name>
            <surname>Daza</surname>
            <given-names>R.M.</given-names>
          </name>
          <name>
            <surname>Aghamirzaie</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Srivatsan</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Jackson</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Minkina</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cicero predicts cis-regulatory DNA interactions from single-cell chromatin accessibility data</article-title>
        <source>Mol. Cell</source>
        <volume>71</volume>
        <year>2018</year>
        <fpage>858</fpage>
        <lpage>871.e8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2018.06.044</pub-id>
        <pub-id pub-id-type="pmid">30078726</pub-id>
      </element-citation>
    </ref>
    <ref id="bib16">
      <label>16</label>
      <element-citation publication-type="journal" id="sref16">
        <person-group person-group-type="author">
          <name>
            <surname>Persad</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Choo</surname>
            <given-names>Z.-N.</given-names>
          </name>
          <name>
            <surname>Dien</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Sohail</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Masilionis</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Chaligné</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Nawy</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>C.C.</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Pe’er</surname>
            <given-names>I.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SEACells infers transcriptional and epigenomic cellular states from single-cell genomics data</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2023</year>
        <pub-id pub-id-type="doi">10.1038/s41587-023-01716-9</pub-id>
      </element-citation>
    </ref>
    <ref id="bib17">
      <label>17</label>
      <element-citation publication-type="journal" id="sref17">
        <person-group person-group-type="author">
          <name>
            <surname>Squair</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kathe</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>N.D.</given-names>
          </name>
          <name>
            <surname>Hutson</surname>
            <given-names>T.H.</given-names>
          </name>
          <name>
            <surname>Hudelle</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Qaiser</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Matson</surname>
            <given-names>K.J.E.</given-names>
          </name>
          <name>
            <surname>Barraud</surname>
            <given-names>Q.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Confronting false discoveries in single-cell differential expression</article-title>
        <source>Nat. Commun.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>5692</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25960-2</pub-id>
        <pub-id pub-id-type="pmid">34584091</pub-id>
      </element-citation>
    </ref>
    <ref id="bib18">
      <label>18</label>
      <element-citation publication-type="journal" id="sref18">
        <person-group person-group-type="author">
          <name>
            <surname>Andreatta</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Carmona</surname>
            <given-names>S.J.</given-names>
          </name>
        </person-group>
        <article-title>UCell: robust and scalable single-cell gene signature scoring</article-title>
        <source>Comput. Struct. Biotechnol. J.</source>
        <volume>19</volume>
        <year>2021</year>
        <fpage>3796</fpage>
        <lpage>3798</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2021.06.043</pub-id>
        <pub-id pub-id-type="pmid">34285779</pub-id>
      </element-citation>
    </ref>
    <ref id="bib19">
      <label>19</label>
      <element-citation publication-type="journal" id="sref19">
        <person-group person-group-type="author">
          <name>
            <surname>McInnes</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Melville</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>UMAP: uniform manifold approximation and projection for dimension reduction</article-title>
        <comment>Preprint at</comment>
        <source>arXiv</source>
        <year>2018</year>
        <pub-id pub-id-type="doi">10.48550/arXiv.1802.03426</pub-id>
      </element-citation>
    </ref>
    <ref id="bib20">
      <label>20</label>
      <element-citation publication-type="journal" id="sref20">
        <person-group person-group-type="author">
          <name>
            <surname>Langfelder</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Oldham</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Is my network module preserved and reproducible?</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>7</volume>
        <year>2011</year>
        <object-id pub-id-type="publisher-id">e1001057</object-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1001057</pub-id>
      </element-citation>
    </ref>
    <ref id="bib21">
      <label>21</label>
      <element-citation publication-type="journal" id="sref21">
        <person-group person-group-type="author">
          <name>
            <surname>Baglama</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Reichel</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Augmented implicitly restarted Lanczos bidiagonalization methods</article-title>
        <source>SIAM J. Sci. Comput.</source>
        <volume>27</volume>
        <year>2005</year>
        <fpage>19</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1137/04060593x</pub-id>
      </element-citation>
    </ref>
    <ref id="bib22">
      <label>22</label>
      <element-citation publication-type="journal" id="sref22">
        <person-group person-group-type="author">
          <name>
            <surname>Korsunsky</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Millard</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Slowikowski</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Baglaenko</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Loh</surname>
            <given-names>P.-r.</given-names>
          </name>
          <name>
            <surname>Raychaudhuri</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Fast, sensitive and accurate integration of single-cell data with Harmony</article-title>
        <source>Nat. Methods</source>
        <volume>16</volume>
        <year>2019</year>
        <fpage>1289</fpage>
        <lpage>1296</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0619-0</pub-id>
        <pub-id pub-id-type="pmid">31740819</pub-id>
      </element-citation>
    </ref>
    <ref id="bib23">
      <label>23</label>
      <element-citation publication-type="journal" id="sref23">
        <person-group person-group-type="author">
          <name>
            <surname>Ballouz</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Pavlidis</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Gillis</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>EGAD: ultra-fast functional analysis of gene networks</article-title>
        <source>Bioinformatics</source>
        <volume>33</volume>
        <year>2017</year>
        <fpage>612</fpage>
        <lpage>614</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw695</pub-id>
        <pub-id pub-id-type="pmid">27993773</pub-id>
      </element-citation>
    </ref>
    <ref id="bib24">
      <label>24</label>
      <element-citation publication-type="journal" id="sref24">
        <person-group person-group-type="author">
          <name>
            <surname>Skinnider</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Squair</surname>
            <given-names>J.W.</given-names>
          </name>
          <name>
            <surname>Foster</surname>
            <given-names>L.J.</given-names>
          </name>
        </person-group>
        <article-title>Evaluating measures of association for single-cell transcriptomics</article-title>
        <source>Nat. Methods</source>
        <volume>16</volume>
        <year>2019</year>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0372-4</pub-id>
        <pub-id pub-id-type="pmid">30962620</pub-id>
      </element-citation>
    </ref>
    <ref id="bib25">
      <label>25</label>
      <element-citation publication-type="book" id="sref25">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Guestrin</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <part-title>XGBoost: A scalable tree boosting system</part-title>
        <source>Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</source>
        <year>2016</year>
        <publisher-name>KDD ’16</publisher-name>
        <fpage>785</fpage>
        <lpage>794</lpage>
        <pub-id pub-id-type="doi">10.1145/2939672.2939785</pub-id>
      </element-citation>
    </ref>
    <ref id="bib26">
      <label>26</label>
      <element-citation publication-type="journal" id="sref26">
        <person-group person-group-type="author">
          <name>
            <surname>Moses</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Museum of Spatial Transcriptomics</article-title>
        <comment>Preprint at</comment>
        <source>bioRxiv</source>
        <year>2021</year>
        <pub-id pub-id-type="doi">10.1101/2021.05.11.443152</pub-id>
      </element-citation>
    </ref>
    <ref id="bib27">
      <label>27</label>
      <element-citation publication-type="journal" id="sref27">
        <person-group person-group-type="author">
          <name>
            <surname>Moffitt</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Lundberg</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Heyn</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>The emerging landscape of spatial profiling technologies</article-title>
        <source>Nat. Rev. Genet.</source>
        <volume>23</volume>
        <year>2022</year>
        <fpage>741</fpage>
        <lpage>759</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-022-00515-3</pub-id>
        <pub-id pub-id-type="pmid">35859028</pub-id>
      </element-citation>
    </ref>
    <ref id="bib28">
      <label>28</label>
      <element-citation publication-type="journal" id="sref28">
        <person-group person-group-type="author">
          <name>
            <surname>Kiani Shabestari</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Morabito</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Danhash</surname>
            <given-names>E.P.</given-names>
          </name>
          <name>
            <surname>McQuade</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sanchez</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Miyoshi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Chadarevian</surname>
            <given-names>J.P.</given-names>
          </name>
          <name>
            <surname>Claes</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Coburn</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Hasselmann</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Absence of microglia promotes diverse pathologies and early lethality in Alzheimer’s disease mice</article-title>
        <source>Cell Rep.</source>
        <volume>39</volume>
        <year>2022</year>
        <object-id pub-id-type="publisher-id">110961</object-id>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2022.110961</pub-id>
      </element-citation>
    </ref>
    <ref id="bib29">
      <label>29</label>
      <element-citation publication-type="journal" id="sref29">
        <person-group person-group-type="author">
          <name>
            <surname>Wright</surname>
            <given-names>C.J.</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>C.W.J.</given-names>
          </name>
          <name>
            <surname>Jiggins</surname>
            <given-names>C.D.</given-names>
          </name>
        </person-group>
        <article-title>Alternative splicing as a source of phenotypic diversity</article-title>
        <source>Nat. Rev. Genet.</source>
        <volume>23</volume>
        <year>2022</year>
        <fpage>697</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-022-00514-4</pub-id>
        <pub-id pub-id-type="pmid">35821097</pub-id>
      </element-citation>
    </ref>
    <ref id="bib30">
      <label>30</label>
      <element-citation publication-type="journal" id="sref30">
        <person-group person-group-type="author">
          <name>
            <surname>Amarasinghe</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Zappia</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Ritchie</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Gouil</surname>
            <given-names>Q.</given-names>
          </name>
        </person-group>
        <article-title>Opportunities and challenges in long-read sequencing data analysis</article-title>
        <source>Genome Biol.</source>
        <volume>21</volume>
        <year>2020</year>
        <fpage>30</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-1935-5</pub-id>
        <pub-id pub-id-type="pmid">32033565</pub-id>
      </element-citation>
    </ref>
    <ref id="bib31">
      <label>31</label>
      <element-citation publication-type="journal" id="sref31">
        <person-group person-group-type="author">
          <name>
            <surname>Rebboah</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Reese</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Balderrama-Gutierrez</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>McGill</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Trout</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Rodriguez</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>B.J.</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Mapping and modeling the genomic basis of differential RNA isoform expression at single-cell resolution with LR-Split-seq</article-title>
        <source>Genome Biol.</source>
        <volume>22</volume>
        <year>2021</year>
        <fpage>286</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02505-w</pub-id>
        <pub-id pub-id-type="pmid">34620214</pub-id>
      </element-citation>
    </ref>
    <ref id="bib32">
      <label>32</label>
      <element-citation publication-type="journal" id="sref32">
        <person-group person-group-type="author">
          <name>
            <surname>Palmer</surname>
            <given-names>C.R.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C.S.</given-names>
          </name>
          <name>
            <surname>Romanow</surname>
            <given-names>W.J.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M.-H.</given-names>
          </name>
          <name>
            <surname>Chun</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Altered cell and RNA isoform diversity in aging Down syndrome brains</article-title>
        <source>Proc. Natl. Acad. Sci. USA</source>
        <volume>118</volume>
        <year>2021</year>
        <object-id pub-id-type="publisher-id">e2114326118</object-id>
        <pub-id pub-id-type="doi">10.1073/pnas.2114326118</pub-id>
      </element-citation>
    </ref>
    <ref id="bib33">
      <label>33</label>
      <element-citation publication-type="journal" id="sref33">
        <person-group person-group-type="author">
          <name>
            <surname>Hardwick</surname>
            <given-names>S.A.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Joglekar</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Collier</surname>
            <given-names>P.G.</given-names>
          </name>
          <name>
            <surname>Foord</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Balacco</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lanjewar</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sampson</surname>
            <given-names>M.M.</given-names>
          </name>
          <name>
            <surname>Koopmans</surname>
            <given-names>F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-nuclei isoform RNA sequencing unlocks barcoded exon connectivity in frozen brain tissue</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>40</volume>
        <year>2022</year>
        <fpage>1082</fpage>
        <lpage>1092</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-022-01231-3</pub-id>
        <pub-id pub-id-type="pmid">35256815</pub-id>
      </element-citation>
    </ref>
    <ref id="bib34">
      <label>34</label>
      <element-citation publication-type="journal" id="sref34">
        <person-group person-group-type="author">
          <name>
            <surname>Pollen</surname>
            <given-names>A.A.</given-names>
          </name>
          <name>
            <surname>Nowakowski</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Retallack</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Sandoval-Espinosa</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Nicholas</surname>
            <given-names>C.R.</given-names>
          </name>
          <name>
            <surname>Shuga</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Oldham</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Diaz</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular identity of human outer radial glia during cortical development</article-title>
        <source>Cell</source>
        <volume>163</volume>
        <year>2015</year>
        <fpage>55</fpage>
        <lpage>67</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.09.004</pub-id>
        <pub-id pub-id-type="pmid">26406371</pub-id>
      </element-citation>
    </ref>
    <ref id="bib35">
      <label>35</label>
      <element-citation publication-type="journal" id="sref35">
        <person-group person-group-type="author">
          <name>
            <surname>Eze</surname>
            <given-names>U.C.</given-names>
          </name>
          <name>
            <surname>Bhaduri</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Haeussler</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Nowakowski</surname>
            <given-names>T.J.</given-names>
          </name>
          <name>
            <surname>Kriegstein</surname>
            <given-names>A.R.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell atlas of early human brain development highlights heterogeneity of human neuroepithelial cells and early radial glia</article-title>
        <source>Nat. Neurosci.</source>
        <volume>24</volume>
        <year>2021</year>
        <fpage>584</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-020-00794-1</pub-id>
        <pub-id pub-id-type="pmid">33723434</pub-id>
      </element-citation>
    </ref>
    <ref id="bib36">
      <label>36</label>
      <element-citation publication-type="journal" id="sref36">
        <person-group person-group-type="author">
          <name>
            <surname>Cao</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Spielmann</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Mundlos</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Christiansen</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Steemers</surname>
            <given-names>F.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>
        <source>Nature</source>
        <volume>566</volume>
        <year>2019</year>
        <fpage>496</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-0969-x</pub-id>
        <pub-id pub-id-type="pmid">30787437</pub-id>
      </element-citation>
    </ref>
    <ref id="bib71">
      <label>37</label>
      <element-citation publication-type="journal" id="sref71">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Cacchiarelli</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Grimsby</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Pokharel</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>N.J.</given-names>
          </name>
          <name>
            <surname>Livak</surname>
            <given-names>K.J.</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>J.L.</given-names>
          </name>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>32</volume>
        <year>2014</year>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="bib39">
      <label>38</label>
      <element-citation publication-type="journal" id="sref39">
        <person-group person-group-type="author">
          <name>
            <surname>Reese</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Swan: a library for the analysis and visualization of long-read transcriptomes</article-title>
        <source>Bioinformatics</source>
        <volume>37</volume>
        <year>2021</year>
        <fpage>1322</fpage>
        <lpage>1323</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa836</pub-id>
        <pub-id pub-id-type="pmid">32991665</pub-id>
      </element-citation>
    </ref>
    <ref id="bib37">
      <label>39</label>
      <element-citation publication-type="journal" id="sref37">
        <person-group person-group-type="author">
          <name>
            <surname>Hol</surname>
            <given-names>E.M.</given-names>
          </name>
          <name>
            <surname>Pekny</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>Glial fibrillary acidic protein (GFAP) and the astrocyte intermediate filament system in diseases of the central nervous system</article-title>
        <source>Curr. Opin. Cell Biol.</source>
        <volume>32</volume>
        <year>2015</year>
        <fpage>121</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ceb.2015.02.004</pub-id>
        <pub-id pub-id-type="pmid">25726916</pub-id>
      </element-citation>
    </ref>
    <ref id="bib38">
      <label>40</label>
      <element-citation publication-type="journal" id="sref38">
        <person-group person-group-type="author">
          <name>
            <surname>Podergajs</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Motaln</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Rajčević</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Verbovšek</surname>
            <given-names>U.</given-names>
          </name>
          <name>
            <surname>Koršič</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Obad</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Espedal</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Vittori</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Herold-Mende</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Miletic</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transmembrane protein CD9 is glioblastoma biomarker, relevant for maintenance of glioblastoma stem cells</article-title>
        <source>Oncotarget</source>
        <volume>7</volume>
        <year>2016</year>
        <fpage>593</fpage>
        <lpage>609</lpage>
        <pub-id pub-id-type="doi">10.18632/oncotarget.5477</pub-id>
        <pub-id pub-id-type="pmid">26573230</pub-id>
      </element-citation>
    </ref>
    <ref id="bib40">
      <label>41</label>
      <element-citation publication-type="journal" id="sref40">
        <person-group person-group-type="author">
          <name>
            <surname>Grove</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Ripke</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Als</surname>
            <given-names>T.D.</given-names>
          </name>
          <name>
            <surname>Mattheisen</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>R.K.</given-names>
          </name>
          <name>
            <surname>Won</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Pallesen</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Agerbo</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Andreassen</surname>
            <given-names>O.A.</given-names>
          </name>
          <name>
            <surname>Anney</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Awashti</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of common genetic risk variants for autism spectrum disorder</article-title>
        <source>Nat. Genet.</source>
        <volume>51</volume>
        <year>2019</year>
        <fpage>431</fpage>
        <lpage>444</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-019-0344-8</pub-id>
        <pub-id pub-id-type="pmid">30804558</pub-id>
      </element-citation>
    </ref>
    <ref id="bib41">
      <label>42</label>
      <element-citation publication-type="journal" id="sref41">
        <person-group person-group-type="author">
          <name>
            <surname>Carvill</surname>
            <given-names>G.L.</given-names>
          </name>
          <name>
            <surname>Heavin</surname>
            <given-names>S.B.</given-names>
          </name>
          <name>
            <surname>Yendle</surname>
            <given-names>S.C.</given-names>
          </name>
          <name>
            <surname>McMahon</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>O’Roak</surname>
            <given-names>B.J.</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Dorschner</surname>
            <given-names>M.O.</given-names>
          </name>
          <name>
            <surname>Weaver</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Calvert</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Targeted resequencing in epileptic encephalopathies identifies de novo mutations in CHD2 and SYNGAP1</article-title>
        <source>Nat. Genet.</source>
        <volume>45</volume>
        <year>2013</year>
        <fpage>825</fpage>
        <lpage>830</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.2646</pub-id>
        <pub-id pub-id-type="pmid">23708187</pub-id>
      </element-citation>
    </ref>
    <ref id="bib42">
      <label>43</label>
      <element-citation publication-type="journal" id="sref42">
        <person-group person-group-type="author">
          <name>
            <surname>Neale</surname>
            <given-names>B.M.</given-names>
          </name>
          <name>
            <surname>Kou</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Ma’ayan</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Samocha</surname>
            <given-names>K.E.</given-names>
          </name>
          <name>
            <surname>Sabo</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>C.-F.</given-names>
          </name>
          <name>
            <surname>Stevens</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L.-S.</given-names>
          </name>
          <name>
            <surname>Makarov</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Patterns and rates of exonic de novo mutations in autism spectrum disorders</article-title>
        <source>Nature</source>
        <volume>485</volume>
        <year>2012</year>
        <fpage>242</fpage>
        <lpage>245</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11011</pub-id>
        <pub-id pub-id-type="pmid">22495311</pub-id>
      </element-citation>
    </ref>
    <ref id="bib43">
      <label>44</label>
      <element-citation publication-type="journal" id="sref43">
        <person-group person-group-type="author">
          <name>
            <surname>Carroll</surname>
            <given-names>L.S.</given-names>
          </name>
          <name>
            <surname>Woolf</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ibrahim</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>H.J.</given-names>
          </name>
          <name>
            <surname>Dwyer</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kirov</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>O’Donovan</surname>
            <given-names>M.C.</given-names>
          </name>
          <name>
            <surname>Owen</surname>
            <given-names>M.J.</given-names>
          </name>
        </person-group>
        <article-title>Mutation screening of SCN2A in schizophrenia and identification of a novel loss-of-function mutation</article-title>
        <source>Psychiatr. Genet.</source>
        <volume>26</volume>
        <year>2016</year>
        <fpage>60</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1097/ypg.0000000000000110</pub-id>
        <pub-id pub-id-type="pmid">26555645</pub-id>
      </element-citation>
    </ref>
    <ref id="bib44">
      <label>45</label>
      <element-citation publication-type="journal" id="sref44">
        <person-group person-group-type="author">
          <name>
            <surname>Nagy</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Maitra</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Tanti</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Suderman</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Théroux</surname>
            <given-names>J.F.</given-names>
          </name>
          <name>
            <surname>Davoli</surname>
            <given-names>M.A.</given-names>
          </name>
          <name>
            <surname>Perlman</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Yerko</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y.C.</given-names>
          </name>
          <name>
            <surname>Tripathy</surname>
            <given-names>S.J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-nucleus transcriptomics of the prefrontal cortex in major depressive disorder implicates oligodendrocyte precursor cells and excitatory neurons</article-title>
        <source>Nat. Neurosci.</source>
        <volume>23</volume>
        <year>2020</year>
        <fpage>771</fpage>
        <lpage>781</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-020-0621-y</pub-id>
        <pub-id pub-id-type="pmid">32341540</pub-id>
      </element-citation>
    </ref>
    <ref id="bib45">
      <label>46</label>
      <element-citation publication-type="journal" id="sref45">
        <person-group person-group-type="author">
          <name>
            <surname>Jansen</surname>
            <given-names>I.E.</given-names>
          </name>
          <name>
            <surname>Savage</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Watanabe</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Bryois</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Steinberg</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Sealock</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Karlsson</surname>
            <given-names>I.K.</given-names>
          </name>
          <name>
            <surname>Hägg</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Athanasiu</surname>
            <given-names>L.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide meta-analysis identifies new loci and functional pathways influencing Alzheimer’s disease risk</article-title>
        <source>Nat. Genet.</source>
        <volume>51</volume>
        <year>2019</year>
        <fpage>404</fpage>
        <lpage>413</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0311-9</pub-id>
        <pub-id pub-id-type="pmid">30617256</pub-id>
      </element-citation>
    </ref>
    <ref id="bib46">
      <label>47</label>
      <element-citation publication-type="journal" id="sref46">
        <person-group person-group-type="author">
          <name>
            <surname>Kunkle</surname>
            <given-names>B.W.</given-names>
          </name>
          <name>
            <surname>Grenier-Boley</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Sims</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Bis</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Damotte</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Naj</surname>
            <given-names>A.C.</given-names>
          </name>
          <name>
            <surname>Boland</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Vronskaya</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>van der Lee</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Amlie-Wolf</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic meta-analysis of diagnosed Alzheimer’s disease identifies new risk loci and implicates A, tau, immunity and lipid processing</article-title>
        <source>Nat. Genet.</source>
        <volume>51</volume>
        <year>2019</year>
        <fpage>414</fpage>
        <lpage>430</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-019-0358-2</pub-id>
        <pub-id pub-id-type="pmid">30820047</pub-id>
      </element-citation>
    </ref>
    <ref id="bib47">
      <label>48</label>
      <element-citation publication-type="journal" id="sref47">
        <person-group person-group-type="author">
          <name>
            <surname>Schwartzentruber</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J.Z.</given-names>
          </name>
          <name>
            <surname>Barrio-Hernandez</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Bello</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Kumasaka</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>A.M.H.</given-names>
          </name>
          <name>
            <surname>Franklin</surname>
            <given-names>R.J.M.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Estrada</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide meta-analysis, fine-mapping and integrative prioritization implicate new Alzheimer’s disease risk genes</article-title>
        <source>Nat. Genet.</source>
        <volume>53</volume>
        <year>2021</year>
        <fpage>392</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-020-00776-w</pub-id>
        <pub-id pub-id-type="pmid">33589840</pub-id>
      </element-citation>
    </ref>
    <ref id="bib48">
      <label>49</label>
      <element-citation publication-type="journal" id="sref48">
        <person-group person-group-type="author">
          <name>
            <surname>Bellenguez</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Küçükali</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Jansen</surname>
            <given-names>I.E.</given-names>
          </name>
          <name>
            <surname>Kleineidam</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Moreno-Grau</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Amin</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Naj</surname>
            <given-names>A.C.</given-names>
          </name>
          <name>
            <surname>Campos-Martin</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Grenier-Boley</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Andrade</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>New insights into the genetic etiology of Alzheimer’s disease and related dementias</article-title>
        <source>Nat. Genet.</source>
        <volume>54</volume>
        <year>2022</year>
        <fpage>412</fpage>
        <lpage>436</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-022-01024-z</pub-id>
        <pub-id pub-id-type="pmid">35379992</pub-id>
      </element-citation>
    </ref>
    <ref id="bib49">
      <label>50</label>
      <element-citation publication-type="journal" id="sref49">
        <person-group person-group-type="author">
          <name>
            <surname>Keren-Shaul</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Spinrad</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Weiner</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Matcovitch-Natan</surname>
            <given-names>O.</given-names>
          </name>
          <name>
            <surname>Dvir-Szternfeld</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ulland</surname>
            <given-names>T.K.</given-names>
          </name>
          <name>
            <surname>David</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Baruch</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Lara-Astaiso</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Toth</surname>
            <given-names>B.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A unique microglia type associated with restricting development of Alzheimer’s disease</article-title>
        <source>Cell</source>
        <volume>169</volume>
        <year>2017</year>
        <fpage>1276</fpage>
        <lpage>1290.e17</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.05.018</pub-id>
        <pub-id pub-id-type="pmid">28602351</pub-id>
      </element-citation>
    </ref>
    <ref id="bib50">
      <label>51</label>
      <element-citation publication-type="journal" id="sref50">
        <person-group person-group-type="author">
          <name>
            <surname>Sala Frigerio</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Wolfs</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Fattorelli</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Thrupp</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Voytyuk</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Mancuso</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>W.-T.</given-names>
          </name>
          <name>
            <surname>Woodbury</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>G.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The major risk factors for Alzheimer’s disease: age, sex, and genes modulate the microglia response to A plaques</article-title>
        <source>Cell Rep.</source>
        <volume>27</volume>
        <year>2019</year>
        <fpage>1293</fpage>
        <lpage>1306.e6</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2019.03.099</pub-id>
        <pub-id pub-id-type="pmid">31018141</pub-id>
      </element-citation>
    </ref>
    <ref id="bib54">
      <label>52</label>
      <element-citation publication-type="journal" id="sref54">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Dey</surname>
            <given-names>K.K.</given-names>
          </name>
          <name>
            <surname>Sakaue</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Jagadeesh</surname>
            <given-names>K.A.</given-names>
          </name>
          <name>
            <surname>Weinand</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Taychameekiatchai</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Pisco</surname>
            <given-names>A.O.</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Polygenic enrichment distinguishes disease associations of individual cells in single-cell RNA-seq data</article-title>
        <source>Nat. Genet.</source>
        <volume>54</volume>
        <year>2022</year>
        <fpage>1572</fpage>
        <lpage>1580</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-022-01167-z</pub-id>
        <pub-id pub-id-type="pmid">36050550</pub-id>
      </element-citation>
    </ref>
    <ref id="bib51">
      <label>53</label>
      <element-citation publication-type="journal" id="sref51">
        <person-group person-group-type="author">
          <name>
            <surname>Borda</surname>
            <given-names>J.T.</given-names>
          </name>
          <name>
            <surname>Alvarez</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Mohan</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hasegawa</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Bernardino</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Jean</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Aye</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Lackner</surname>
            <given-names>A.A.</given-names>
          </name>
        </person-group>
        <article-title>CD163, a marker of perivascular macrophages, is up-regulated by microglia in simian immunodeficiency virus encephalitis after haptoglobin-hemoglobin complex stimulation and is suggestive of breakdown of the blood-brain barrier</article-title>
        <source>Am. J. Pathol.</source>
        <volume>172</volume>
        <year>2008</year>
        <fpage>725</fpage>
        <lpage>737</lpage>
        <pub-id pub-id-type="doi">10.2353/ajpath.2008.070848</pub-id>
        <pub-id pub-id-type="pmid">18276779</pub-id>
      </element-citation>
    </ref>
    <ref id="bib52">
      <label>54</label>
      <element-citation publication-type="journal" id="sref52">
        <person-group person-group-type="author">
          <name>
            <surname>Pey</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Pearce</surname>
            <given-names>R.K.B.</given-names>
          </name>
          <name>
            <surname>Kalaitzakis</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Griffin</surname>
            <given-names>W.S.T.</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>S.M.</given-names>
          </name>
        </person-group>
        <article-title>Phenotypic profile of alternative activation marker CD163 is different in Alzheimer’s and Parkinson’s disease</article-title>
        <source>Acta Neuropathol. Commun.</source>
        <volume>2</volume>
        <year>2014</year>
        <fpage>21</fpage>
        <pub-id pub-id-type="doi">10.1186/2051-5960-2-21</pub-id>
        <pub-id pub-id-type="pmid">24528486</pub-id>
      </element-citation>
    </ref>
    <ref id="bib53">
      <label>55</label>
      <element-citation publication-type="journal" id="sref53">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>A.T.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Miao</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Azevedo</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Suh</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Van Deerlin</surname>
            <given-names>V.M.</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Roeder</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>APOE and TREM2 regulate amyloid-responsive microglia in Alzheimer’s disease</article-title>
        <source>Acta Neuropathol.</source>
        <volume>140</volume>
        <year>2020</year>
        <fpage>477</fpage>
        <lpage>493</lpage>
        <pub-id pub-id-type="doi">10.1007/s00401-020-02200-3</pub-id>
        <pub-id pub-id-type="pmid">32840654</pub-id>
      </element-citation>
    </ref>
    <ref id="bib55">
      <label>56</label>
      <element-citation publication-type="journal" id="sref55">
        <person-group person-group-type="author">
          <name>
            <surname>Morabito</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Miyoshi</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Michael</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Swarup</surname>
            <given-names>V.</given-names>
          </name>
        </person-group>
        <article-title>Integrative genomics approach identifies conserved transcriptomic networks in Alzheimer’s disease</article-title>
        <source>Hum. Mol. Genet.</source>
        <volume>29</volume>
        <year>2020</year>
        <fpage>2899</fpage>
        <lpage>2919</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddaa182</pub-id>
        <pub-id pub-id-type="pmid">32803238</pub-id>
      </element-citation>
    </ref>
    <ref id="bib56">
      <label>57</label>
      <element-citation publication-type="journal" id="sref56">
        <person-group person-group-type="author">
          <name>
            <surname>Leng</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Eser</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Piergies</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Sit</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.H.</given-names>
          </name>
          <name>
            <surname>Rodriguez</surname>
            <given-names>R.D.</given-names>
          </name>
          <name>
            <surname>Suemoto</surname>
            <given-names>C.K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular characterization of selectively vulnerable neurons in Alzheimer’s disease</article-title>
        <source>Nat. Neurosci.</source>
        <volume>24</volume>
        <year>2021</year>
        <fpage>276</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-020-00764-7</pub-id>
        <pub-id pub-id-type="pmid">33432193</pub-id>
      </element-citation>
    </ref>
    <ref id="bib57">
      <label>58</label>
      <element-citation publication-type="journal" id="sref57">
        <person-group person-group-type="author">
          <name>
            <surname>Gerrits</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Brouwer</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Kooistra</surname>
            <given-names>S.M.</given-names>
          </name>
          <name>
            <surname>Woodbury</surname>
            <given-names>M.E.</given-names>
          </name>
          <name>
            <surname>Vermeiren</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Lambourne</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Mulder</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kummer</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Möller</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Biber</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distinct amyloid- and tau-associated microglia profiles in Alzheimer’s disease</article-title>
        <source>Acta Neuropathol.</source>
        <volume>141</volume>
        <year>2021</year>
        <fpage>681</fpage>
        <lpage>696</lpage>
        <pub-id pub-id-type="doi">10.1007/s00401-021-02263-w</pub-id>
        <pub-id pub-id-type="pmid">33609158</pub-id>
      </element-citation>
    </ref>
    <ref id="bib58">
      <label>59</label>
      <element-citation publication-type="journal" id="sref58">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Madad</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Lareau</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell chromatin state analysis with Signac</article-title>
        <source>Nat. Methods</source>
        <volume>18</volume>
        <year>2021</year>
        <fpage>1333</fpage>
        <lpage>1341</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01282-5</pub-id>
        <pub-id pub-id-type="pmid">34725479</pub-id>
      </element-citation>
    </ref>
    <ref id="bib59">
      <label>60</label>
      <element-citation publication-type="journal" id="sref59">
        <person-group person-group-type="author">
          <collab>ENCODE Project Consortium</collab>
          <name>
            <surname>Moore</surname>
            <given-names>J.E.</given-names>
          </name>
          <name>
            <surname>Purcaro</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Pratt</surname>
            <given-names>H.E.</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>C.B.</given-names>
          </name>
          <name>
            <surname>Shoresh</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Adrian</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Kawli</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>C.A.</given-names>
          </name>
          <name>
            <surname>Dobin</surname>
            <given-names>A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expanded encyclopaedias of DNA elements in the human and mouse genomes</article-title>
        <source>Nature</source>
        <volume>583</volume>
        <year>2020</year>
        <fpage>699</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2493-4</pub-id>
        <pub-id pub-id-type="pmid">32728249</pub-id>
      </element-citation>
    </ref>
    <ref id="bib60">
      <label>61</label>
      <element-citation publication-type="journal" id="sref60">
        <person-group person-group-type="author">
          <collab>GTEx Consortium</collab>
        </person-group>
        <article-title>The GTEx Consortium atlas of genetic regulatory effects across human tissues</article-title>
        <source>Science</source>
        <volume>369</volume>
        <year>2020</year>
        <fpage>1318</fpage>
        <lpage>1330</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aaz1776</pub-id>
        <pub-id pub-id-type="pmid">32913098</pub-id>
      </element-citation>
    </ref>
    <ref id="bib61">
      <label>62</label>
      <element-citation publication-type="journal" id="sref61">
        <person-group person-group-type="author">
          <name>
            <surname>Hoadley</surname>
            <given-names>K.A.</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Hinoue</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Lazar</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Drill</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>A.M.</given-names>
          </name>
          <name>
            <surname>Cherniack</surname>
            <given-names>A.D.</given-names>
          </name>
          <name>
            <surname>Thorsson</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell-of-Origin patterns dominate the molecular classification of 10,000 tumors from 33 types of cancer</article-title>
        <source>Cell</source>
        <volume>173</volume>
        <year>2018</year>
        <fpage>291</fpage>
        <lpage>304.e6</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.022</pub-id>
        <pub-id pub-id-type="pmid">29625048</pub-id>
      </element-citation>
    </ref>
    <ref id="bib62">
      <label>63</label>
      <element-citation publication-type="journal" id="sref62">
        <person-group person-group-type="author">
          <name>
            <surname>Wan</surname>
            <given-names>Y.-W.</given-names>
          </name>
          <name>
            <surname>Al-Ouran</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Mangleburg</surname>
            <given-names>C.G.</given-names>
          </name>
          <name>
            <surname>Perumal</surname>
            <given-names>T.M.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>T.V.</given-names>
          </name>
          <name>
            <surname>Allison</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Swarup</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Funk</surname>
            <given-names>C.C.</given-names>
          </name>
          <name>
            <surname>Gaiteri</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>M.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Meta-analysis of the Alzheimer’s disease human brain transcriptome and functional dissection in mouse models</article-title>
        <source>Cell Rep.</source>
        <volume>32</volume>
        <year>2020</year>
        <object-id pub-id-type="publisher-id">107908</object-id>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2020.107908</pub-id>
      </element-citation>
    </ref>
    <ref id="bib63">
      <label>64</label>
      <element-citation publication-type="journal" id="sref63">
        <person-group person-group-type="author">
          <name>
            <surname>Mostafavi</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Gaiteri</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>S.E.</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>C.C.</given-names>
          </name>
          <name>
            <surname>Tasaki</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Taga</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>H.-U.</given-names>
          </name>
          <name>
            <surname>Patrick</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Komashko</surname>
            <given-names>V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A molecular network of the aging human brain provides insights into the pathology and cognitive decline of Alzheimer’s disease</article-title>
        <source>Nat. Neurosci.</source>
        <volume>21</volume>
        <year>2018</year>
        <fpage>811</fpage>
        <lpage>819</lpage>
        <pub-id pub-id-type="doi">10.1038/s41593-018-0154-9</pub-id>
        <pub-id pub-id-type="pmid">29802388</pub-id>
      </element-citation>
    </ref>
    <ref id="bib64">
      <label>65</label>
      <element-citation publication-type="journal" id="sref64">
        <person-group person-group-type="author">
          <name>
            <surname>Allen</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Carrasquillo</surname>
            <given-names>M.M.</given-names>
          </name>
          <name>
            <surname>Funk</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Heavner</surname>
            <given-names>B.D.</given-names>
          </name>
          <name>
            <surname>Zou</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Younkin</surname>
            <given-names>C.S.</given-names>
          </name>
          <name>
            <surname>Burgess</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Chai</surname>
            <given-names>H.-S.</given-names>
          </name>
          <name>
            <surname>Crook</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>J.A.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human whole genome genotype and transcriptome data for Alzheimer’s and other neurodegenerative diseases</article-title>
        <source>Sci. Data</source>
        <volume>3</volume>
        <year>2016</year>
        <object-id pub-id-type="publisher-id">160089</object-id>
        <pub-id pub-id-type="doi">10.1038/sdata.2016.89</pub-id>
      </element-citation>
    </ref>
    <ref id="bib65">
      <label>66</label>
      <element-citation publication-type="journal" id="sref65">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Beckmann</surname>
            <given-names>N.D.</given-names>
          </name>
          <name>
            <surname>Roussos</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Ming</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Neff</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Fullard</surname>
            <given-names>J.F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Mount Sinai cohort of large-scale genomic, transcriptomic and proteomic data in Alzheimer’s disease</article-title>
        <source>Sci. Data</source>
        <volume>5</volume>
        <year>2018</year>
        <object-id pub-id-type="publisher-id">180185</object-id>
        <pub-id pub-id-type="doi">10.1038/sdata.2018.185</pub-id>
      </element-citation>
    </ref>
    <ref id="bib66">
      <label>67</label>
      <element-citation publication-type="journal" id="sref66">
        <person-group person-group-type="author">
          <name>
            <surname>Swarup</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>T.S.</given-names>
          </name>
          <name>
            <surname>Duong</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Dammer</surname>
            <given-names>E.B.</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Lah</surname>
            <given-names>J.J.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>E.C.B.</given-names>
          </name>
          <name>
            <surname>Seyfried</surname>
            <given-names>N.T.</given-names>
          </name>
          <name>
            <surname>Levey</surname>
            <given-names>A.I.</given-names>
          </name>
          <name>
            <surname>Geschwind</surname>
            <given-names>D.H.</given-names>
          </name>
        </person-group>
        <article-title>Identification of conserved proteomic networks in neurodegenerative dementia</article-title>
        <source>Cell Rep.</source>
        <volume>31</volume>
        <year>2020</year>
        <object-id pub-id-type="publisher-id">107807</object-id>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2020.107807</pub-id>
      </element-citation>
    </ref>
    <ref id="bib67">
      <label>68</label>
      <element-citation publication-type="journal" id="sref67">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>E.C.B.</given-names>
          </name>
          <name>
            <surname>Dammer</surname>
            <given-names>E.B.</given-names>
          </name>
          <name>
            <surname>Duong</surname>
            <given-names>D.M.</given-names>
          </name>
          <name>
            <surname>Ping</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Higginbotham</surname>
            <given-names>L.A.</given-names>
          </name>
          <name>
            <surname>Guajardo</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Troncoso</surname>
            <given-names>J.C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale proteomic analysis of Alzheimer’s disease brain and cerebrospinal fluid reveals early changes in energy metabolism associated with microglia and astrocyte activation</article-title>
        <source>Nat. Med.</source>
        <volume>26</volume>
        <year>2020</year>
        <fpage>769</fpage>
        <lpage>780</lpage>
        <pub-id pub-id-type="doi">10.1038/s41591-020-0815-6</pub-id>
        <pub-id pub-id-type="pmid">32284590</pub-id>
      </element-citation>
    </ref>
    <ref id="bib68">
      <label>69</label>
      <element-citation publication-type="journal" id="sref68">
        <person-group person-group-type="author">
          <name>
            <surname>Kelly</surname>
            <given-names>R.T.</given-names>
          </name>
        </person-group>
        <article-title>Single-cell proteomics: progress and prospects</article-title>
        <source>Mol. Cell. Proteomics</source>
        <volume>19</volume>
        <year>2020</year>
        <fpage>1739</fpage>
        <lpage>1748</lpage>
        <pub-id pub-id-type="doi">10.1074/mcp.r120.002234</pub-id>
        <pub-id pub-id-type="pmid">32847821</pub-id>
      </element-citation>
    </ref>
    <ref id="bib69">
      <label>70</label>
      <element-citation publication-type="journal" id="sref69">
        <person-group person-group-type="author">
          <name>
            <surname>Aibar</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>González-Blas</surname>
            <given-names>C.B.</given-names>
          </name>
          <name>
            <surname>Moerman</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Huynh-Thu</surname>
            <given-names>V.A.</given-names>
          </name>
          <name>
            <surname>Imrichova</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Hulselmans</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Rambow</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Marine</surname>
            <given-names>J.-C.</given-names>
          </name>
          <name>
            <surname>Geurts</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Aerts</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SCENIC: single-cell regulatory network inference and clustering</article-title>
        <source>Nat. Methods</source>
        <volume>14</volume>
        <year>2017</year>
        <fpage>1083</fpage>
        <lpage>1086</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4463</pub-id>
        <pub-id pub-id-type="pmid">28991892</pub-id>
      </element-citation>
    </ref>
    <ref id="bib70">
      <label>71</label>
      <element-citation publication-type="journal" id="sref70">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Guerrero-Juarez</surname>
            <given-names>C.F.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Ramos</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Kuan</surname>
            <given-names>C.-H.</given-names>
          </name>
          <name>
            <surname>Myung</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Plikus</surname>
            <given-names>M.V.</given-names>
          </name>
          <name>
            <surname>Nie</surname>
            <given-names>Q.</given-names>
          </name>
        </person-group>
        <article-title>Inference and analysis of cell-cell communication using CellChat</article-title>
        <source>Nat. Commun.</source>
        <volume>12</volume>
        <year>2021</year>
        <fpage>1088</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-21246-9</pub-id>
        <pub-id pub-id-type="pmid">33597522</pub-id>
      </element-citation>
    </ref>
    <ref id="bib78">
      <label>72</label>
      <element-citation publication-type="journal" id="sref78">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>F.A.</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F.J.</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol.</source>
        <volume>19</volume>
        <year>2018</year>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="bib81">
      <label>73</label>
      <element-citation publication-type="journal" id="sref81">
        <person-group person-group-type="author">
          <name>
            <surname>Wolock</surname>
            <given-names>S.L.</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>A.M.</given-names>
          </name>
        </person-group>
        <article-title>Scrublet: computational identification of cell doublets in single-cell transcriptomic data</article-title>
        <source>Cell Syst.</source>
        <volume>8</volume>
        <year>2019</year>
        <fpage>281</fpage>
        <lpage>291.e9</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2018.11.005</pub-id>
        <pub-id pub-id-type="pmid">30954476</pub-id>
      </element-citation>
    </ref>
    <ref id="bib80">
      <label>74</label>
      <element-citation publication-type="journal" id="sref80">
        <person-group person-group-type="author">
          <name>
            <surname>Fleming</surname>
            <given-names>S.J.</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>J.C.</given-names>
          </name>
          <name>
            <surname>Babadi</surname>
            <given-names>M.</given-names>
          </name>
        </person-group>
        <article-title>CellBender remove-background: a deep generative model for unsupervised removal of background noise from scRNA-seq datasets</article-title>
        <comment>Preprint at</comment>
        <source>bioRxiv</source>
        <year>2019</year>
        <pub-id pub-id-type="doi">10.1101/791699</pub-id>
      </element-citation>
    </ref>
    <ref id="bib72">
      <label>75</label>
      <element-citation publication-type="journal" id="sref72">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J.J.</given-names>
          </name>
        </person-group>
        <article-title>Statistics or biology: the zero-inflation controversy about scRNA-seq data</article-title>
        <source>Genome Biol.</source>
        <volume>23</volume>
        <year>2022</year>
        <fpage>31</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-022-02601-5</pub-id>
        <pub-id pub-id-type="pmid">35063006</pub-id>
      </element-citation>
    </ref>
    <ref id="bib73">
      <label>76</label>
      <element-citation publication-type="journal" id="sref73">
        <person-group person-group-type="author">
          <name>
            <surname>Beygelzimer</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Kakadet</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Langford</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Arya</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Mount</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>Fnn: fast nearest neighbor search algorithms and applications</article-title>
        <source>R package version</source>
        <volume>1</volume>
        <year>2013</year>
        <fpage>1</fpage>
        <lpage>17</lpage>
      </element-citation>
    </ref>
    <ref id="bib74">
      <label>77</label>
      <element-citation publication-type="journal" id="sref74">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>A general framework for weighted gene Co-expression network analysis</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <volume>4</volume>
        <year>2005</year>
        <fpage>Article17</fpage>
        <pub-id pub-id-type="doi">10.2202/1544-6115.1128</pub-id>
        <pub-id pub-id-type="pmid">16646834</pub-id>
      </element-citation>
    </ref>
    <ref id="bib75">
      <label>78</label>
      <element-citation publication-type="journal" id="sref75">
        <person-group person-group-type="author">
          <name>
            <surname>Horvath</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Geometric interpretation of gene coexpression network analysis</article-title>
        <source>PLoS Comput. Biol.</source>
        <volume>4</volume>
        <year>2008</year>
        <object-id pub-id-type="publisher-id">e1000117</object-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000117</pub-id>
      </element-citation>
    </ref>
    <ref id="bib76">
      <label>79</label>
      <element-citation publication-type="journal" id="sref76">
        <person-group person-group-type="author">
          <name>
            <surname>Luecken</surname>
            <given-names>M.D.</given-names>
          </name>
          <name>
            <surname>Büttner</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Chaichoompu</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Danese</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Interlandi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Mueller</surname>
            <given-names>M.F.</given-names>
          </name>
          <name>
            <surname>Strobl</surname>
            <given-names>D.C.</given-names>
          </name>
          <name>
            <surname>Zappia</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Dugas</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Colomé-Tatché</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>F.J.</given-names>
          </name>
        </person-group>
        <article-title>Benchmarking atlas-level data integration in single-cell genomics</article-title>
        <source>Nat. Methods</source>
        <volume>19</volume>
        <year>2022</year>
        <fpage>41</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-021-01336-8</pub-id>
        <pub-id pub-id-type="pmid">34949812</pub-id>
      </element-citation>
    </ref>
    <ref id="bib77">
      <label>80</label>
      <element-citation publication-type="journal" id="sref77">
        <person-group person-group-type="author">
          <name>
            <surname>Granja</surname>
            <given-names>J.M.</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>M.R.</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>S.E.</given-names>
          </name>
          <name>
            <surname>Bagdatli</surname>
            <given-names>S.T.</given-names>
          </name>
          <name>
            <surname>Choudhry</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>H.Y.</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>W.J.</given-names>
          </name>
        </person-group>
        <article-title>ArchR is a scalable software package for integrative single-cell chromatin accessibility analysis</article-title>
        <source>Nat. Genet.</source>
        <volume>53</volume>
        <year>2021</year>
        <fpage>403</fpage>
        <lpage>411</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-021-00790-6</pub-id>
        <pub-id pub-id-type="pmid">33633365</pub-id>
      </element-citation>
    </ref>
    <ref id="bib79">
      <label>81</label>
      <element-citation publication-type="journal" id="sref79">
        <person-group person-group-type="author">
          <name>
            <surname>Melsted</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Booeshaghi</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Min</surname>
            <given-names>K.H.J.</given-names>
          </name>
          <name>
            <surname>da Veiga Beltrame</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Hjörleifsson</surname>
            <given-names>K.E.</given-names>
          </name>
          <name>
            <surname>Gehring</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L.</given-names>
          </name>
        </person-group>
        <article-title>Modular, efficient and constant-memory single-cell RNA-seq preprocessing</article-title>
        <source>Nat. Biotechnol.</source>
        <volume>39</volume>
        <year>2021</year>
        <fpage>813</fpage>
        <lpage>818</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00870-2</pub-id>
        <pub-id pub-id-type="pmid">33795888</pub-id>
      </element-citation>
    </ref>
    <ref id="bib82">
      <label>82</label>
      <element-citation publication-type="journal" id="sref82">
        <person-group person-group-type="author">
          <name>
            <surname>Traag</surname>
            <given-names>V.A.</given-names>
          </name>
          <name>
            <surname>Waltman</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>van Eck</surname>
            <given-names>N.J.</given-names>
          </name>
        </person-group>
        <article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>
        <source>Sci. Rep.</source>
        <volume>9</volume>
        <year>2019</year>
        <fpage>5233</fpage>
        <pub-id pub-id-type="other">10.1038/s41598-019-41695-z. arXiv:1810.08473</pub-id>
        <pub-id pub-id-type="pmid">30914743</pub-id>
      </element-citation>
    </ref>
    <ref id="bib83">
      <label>83</label>
      <element-citation publication-type="journal" id="sref83">
        <person-group person-group-type="author">
          <name>
            <surname>Plaisier</surname>
            <given-names>S.B.</given-names>
          </name>
          <name>
            <surname>Taschereau</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>J.A.</given-names>
          </name>
          <name>
            <surname>Graeber</surname>
            <given-names>T.G.</given-names>
          </name>
        </person-group>
        <article-title>Rank–rank hypergeometric overlap: identification of statistically significant overlap between gene-expression signatures</article-title>
        <source>Nucleic Acids Res.</source>
        <volume>38</volume>
        <year>2010</year>
        <fpage>e169</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq636</pub-id>
        <pub-id pub-id-type="pmid">20660011</pub-id>
      </element-citation>
    </ref>
    <ref id="bib84">
      <label>84</label>
      <element-citation publication-type="journal" id="sref84">
        <person-group person-group-type="author">
          <name>
            <surname>Blondel</surname>
            <given-names>V.D.</given-names>
          </name>
          <name>
            <surname>Guillaume</surname>
            <given-names>J.-L.</given-names>
          </name>
          <name>
            <surname>Lambiotte</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Lefebvre</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Fast unfolding of communities in large networks</article-title>
        <source>J. Stat. Mech.</source>
        <volume>2008</volume>
        <year>2008</year>
        <object-id pub-id-type="publisher-id">P10008</object-id>
        <pub-id pub-id-type="doi">10.1088/1742-5468/2008/10/p10008</pub-id>
      </element-citation>
    </ref>
    <ref id="bib85">
      <label>85</label>
      <element-citation publication-type="journal" id="sref85">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>E.Y.</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>C.M.</given-names>
          </name>
          <name>
            <surname>Kou</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Meirelles</surname>
            <given-names>G.V.</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>N.R.</given-names>
          </name>
          <name>
            <surname>Ma’ayan</surname>
            <given-names>A.</given-names>
          </name>
        </person-group>
        <article-title>Enrichr: interactive and collaborative HTML5 gene list enrichment analysis tool</article-title>
        <source>BMC Bioinf.</source>
        <volume>14</volume>
        <year>2013</year>
        <fpage>128</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-14-128</pub-id>
      </element-citation>
    </ref>
  </ref-list>
  <sec id="appsec2" sec-type="supplementary-material">
    <title>Supplemental information</title>
    <p id="p0385">
      <supplementary-material content-type="local-data" id="mmc1">
        <caption>
          <title>Document S1. Figures S1–S11</title>
        </caption>
        <media xlink:href="mmc1.pdf"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc2">
        <caption>
          <title>Data S1. Gene co-expression module assignments, related to Figures 1, 3, 4, 5, and 6</title>
        </caption>
        <media xlink:href="mmc2.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc3">
        <caption>
          <title>Data S2. Pathway enrichment results from gene co-expression modules, related to Figures 1, 3, 4, 5, and 6</title>
        </caption>
        <media xlink:href="mmc3.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc4">
        <caption>
          <title>Data S3. DME results, related to Figures 1, 3, 4, 5, and 6</title>
        </caption>
        <media xlink:href="mmc4.xlsx"/>
      </supplementary-material>
      <supplementary-material content-type="local-data" id="mmc5">
        <caption>
          <title>Document S2. Article plus supplemental information</title>
        </caption>
        <media xlink:href="mmc5.pdf"/>
      </supplementary-material>
    </p>
  </sec>
  <sec sec-type="data-availability" id="da0010">
    <title>Data and code availability</title>
    <p id="p0030">
      <list list-type="simple" id="ulist0015">
        <list-item id="u0030">
          <label>•</label>
          <p id="p0035">All of the sequencing data used in this paper were obtained from publicly available sources, and are listed in the <xref rid="sec4.1" ref-type="sec">key resources table</xref>.</p>
        </list-item>
        <list-item id="u0035">
          <label>•</label>
          <p id="p0040">The hdWGCNA R package has been deposited at Zenodo (see <xref rid="sec4.1" ref-type="sec">key resources table</xref>). The R package code and full tutorials are available at <ext-link ext-link-type="uri" xlink:href="https://swaruplab.bio.uci.edu/hdWGCNA" id="intref0010">https://swaruplab.bio.uci.edu/hdWGCNA</ext-link>. The data processing and analysis code has been deposited at Zenodo (see <xref rid="sec4.1" ref-type="sec">key resources table</xref>) and is available on GitHub at this repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/smorabit/hdWGCNA_paper" id="intref0015">https://github.com/smorabit/hdWGCNA_paper</ext-link>.</p>
        </list-item>
        <list-item id="u0040">
          <label>•</label>
          <p id="p0045">Any additional information required to reanalyze the data reported in this paper is available from the <xref rid="sec4.2.1" ref-type="sec">lead contact</xref> upon request.</p>
        </list-item>
      </list>
    </p>
  </sec>
  <ack id="ack0010">
    <title>Acknowledgments</title>
    <p id="p0365">Funding for this work was provided by <funding-source id="gs1">National Institutes on Aging, Neurological Disorders and Stroke, and Drug Abuse</funding-source> grants 1RF1AG071683, P01NS084974- 06A1, 1U01DA053826, U54 AG054349-06 (MODEL-AD), and 3U19AG068054-02S, <funding-source id="gs2">Adelson Medical Research Foundation funds</funding-source> to V.S. This work utilized the infrastructure for high-performance and high-throughput computing, research data storage and analysis, and scientific software tool integration built, operated, and updated by the <funding-source id="gs3">Research Cyberinfrastructure Center</funding-source> (RCIC) at the <funding-source id="gs4"><institution-wrap><institution-id institution-id-type="doi">10.13039/100005595</institution-id><institution>University of California</institution></institution-wrap></funding-source>, Irvine (UCI). We thank Anoushka Joglekar for providing the ScISOrSeq dataset.</p>
    <sec id="sec5">
      <title>Author contributions</title>
      <p id="p0370">S.M. and V.S. conceptualized this study. The manuscript was written by S.M., F.R., and E.M. with assistance and approval from all authors. S.M. developed the hdWGCNA R package. S.M. and F.R. designed the structure of the hdWGCNA R package. S.M. collected, processed, and performed network analysis on publicly available sequencing datasets. F.R. performed bioinformatics analysis of the ScISOrSeq dataset. N.R. performed polygenic risk analysis of the integrated microglia snRNA-seq dataset.</p>
    </sec>
    <sec sec-type="COI-statement" id="sec6">
      <title>Declaration of interests</title>
      <p id="p0375">The authors declare no competing interests.</p>
    </sec>
  </ack>
  <fn-group>
    <fn id="appsec1" fn-type="supplementary-material">
      <p id="p0380">Supplemental information can be found online at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.crmeth.2023.100498" id="intref0130">https://doi.org/10.1016/j.crmeth.2023.100498</ext-link>.</p>
    </fn>
  </fn-group>
</back>
