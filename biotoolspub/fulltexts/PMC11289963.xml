<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11289963</article-id>
    <article-id pub-id-type="pmid">38566187</article-id>
    <article-id pub-id-type="publisher-id">3217</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-024-03217-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bento: a toolkit for subcellular analysis of spatial transcriptomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Mah</surname>
          <given-names>Clarence K.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Ahmed</surname>
          <given-names>Noorsher</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lopez</surname>
          <given-names>Nicole A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lam</surname>
          <given-names>Dylan C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pong</surname>
          <given-names>Avery</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Monell</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kern</surname>
          <given-names>Colin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Han</surname>
          <given-names>Yuanyuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Prasad</surname>
          <given-names>Gino</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cesnik</surname>
          <given-names>Anthony J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lundberg</surname>
          <given-names>Emma</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Quan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Carter</surname>
          <given-names>Hannah</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0799-6037</contrib-id>
        <name>
          <surname>Yeo</surname>
          <given-names>Gene W.</given-names>
        </name>
        <address>
          <email>geneyeo@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff10">10</xref>
        <xref ref-type="aff" rid="Aff11">11</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Division of Medical Genetics, Department of Medicine, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Department of Cellular and Molecular Medicine, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff3"><label>3</label>Sanford Stem Cell Institute Innovation Center, La Jolla, CA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Division of Biological Sciences, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Department of Bioengineering, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Center for Epigenomics, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f54p054</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8956</institution-id><institution>Department of Bioengineering, </institution><institution>Stanford University, </institution></institution-wrap>Stanford, CA USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f54p054</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8956</institution-id><institution>Department of Pathology, </institution><institution>Stanford University, </institution></institution-wrap>Stanford, CA USA </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00knt4f32</institution-id><institution-id institution-id-type="GRID">grid.499295.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 9234 0175</institution-id><institution>Chan-Zuckerberg Biohub, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Stem Cell Program, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff11"><label>11</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Institute for Genomic Medicine, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <elocation-id>82</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The spatial organization of molecules in a cell is essential for their functions. While current methods focus on discerning tissue architecture, cell–cell interactions, and spatial expression patterns, they are limited to the multicellular scale. We present Bento, a Python toolkit that takes advantage of single-molecule information to enable spatial analysis at the subcellular scale. Bento ingests molecular coordinates and segmentation boundaries to perform three analyses: defining subcellular domains, annotating localization patterns, and quantifying gene–gene colocalization. We demonstrate MERFISH, seqFISH + , Molecular Cartography, and Xenium datasets. Bento is part of the open-source Scverse ecosystem, enabling integration with other single-cell analysis tools.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-024-03217-7.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Institute of Health</institution>
        </funding-source>
        <award-id>NS103172</award-id>
        <award-id>AI132122</award-id>
        <award-id>AI123202</award-id>
        <award-id>AG069098</award-id>
        <award-id>HG004659</award-id>
        <award-id>HG009889</award-id>
        <award-id>GM008666</award-id>
        <award-id>T32GM139790</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ahmed</surname>
            <given-names>Noorsher</given-names>
          </name>
          <name>
            <surname>Pong</surname>
            <given-names>Avery</given-names>
          </name>
          <name>
            <surname>Yeo</surname>
            <given-names>Gene W.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Insitute of Health</institution>
        </funding-source>
        <award-id>MH107367</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yeo</surname>
            <given-names>Gene W.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DGE-2038238</award-id>
        <principal-award-recipient>
          <name>
            <surname>Mah</surname>
            <given-names>Clarence K.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014989</institution-id>
            <institution>Chan Zuckerberg Initiative</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CZF2019-002448</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lundberg</surname>
            <given-names>Emma</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004063</institution-id>
            <institution>Knut och Alice Wallenbergs Stiftelse</institution>
          </institution-wrap>
        </funding-source>
        <award-id>KAW 2021.0346</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lundberg</surname>
            <given-names>Emma</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">The spatial organization of molecules in a cell is essential for performing their functions. While protein localization [<xref ref-type="bibr" rid="CR1">1</xref>] and disease-associated mislocalization are well appreciated [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>], the same principles for RNA have begun to emerge. For instance, the spatial and temporal regulation of RNA play a crucial role in localized cellular processes such as cell migration and cell division [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], as well as specialized cell functionalities like synaptic plasticity [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. Mislocalization of RNA has been associated with diseases such as Huntington’s disease (HD), where defects in axonal mRNA transport and subsequent translation in human spiny neurons lead to cell death and neurodegeneration [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p id="Par3">The study of subcellular RNA localization necessitates single-molecule measurements. Since the development of single-molecule fluorescent in situ hybridization (smFISH), recent advances in multiplexed methods such as MERFISH [<xref ref-type="bibr" rid="CR13">13</xref>], seqFISH + [<xref ref-type="bibr" rid="CR14">14</xref>], HybISS [<xref ref-type="bibr" rid="CR15">15</xref>], and Ex-Seq [<xref ref-type="bibr" rid="CR16">16</xref>] have enabled RNA localization measurements at near transcriptome scales, while maintaining single-molecule resolution. A number of computational toolkits, such as Squidpy [<xref ref-type="bibr" rid="CR17">17</xref>], stLearn [<xref ref-type="bibr" rid="CR18">18</xref>], Giotto [<xref ref-type="bibr" rid="CR19">19</xref>], Seurat [<xref ref-type="bibr" rid="CR20">20</xref>], and Scanpy [<xref ref-type="bibr" rid="CR21">21</xref>] enabled the characterization of tissue architecture, cell–cell interactions, and spatial expression patterns. Despite the single-molecule measurements in spatial transcriptomics, these analytical approaches are limited to investigating spatial variation at the multicellular scale and lack the ability to investigate subcellular organization. To further our understanding of RNA localization and its function in normal and abnormal cell activity, we need to expand our analytical capacity to the subcellular scale.</p>
    <p id="Par4">Recent methods such as FISH-quant-v2 [<xref ref-type="bibr" rid="CR22">22</xref>] and FISHFactor [<xref ref-type="bibr" rid="CR23">23</xref>] identify subcellular patterns describing the spatial distribution of RNA species, but are unable to annotate more than a single gene per cell or are limited to analyze at most 20,000 molecules on accessible computing resources. In contrast, a single spatial transcriptomics experiment measures at least hundreds to thousands of genes across hundreds of thousands of cells. Additionally, methods such as ClusterMap [<xref ref-type="bibr" rid="CR24">24</xref>] and Baysor [<xref ref-type="bibr" rid="CR25">25</xref>] highlight the potential for transcript locations alone to inform meaningful domains such as cell and nuclear regions. Using spatial proteomics data, CAMPA [<xref ref-type="bibr" rid="CR26">26</xref>] and Pixie [<xref ref-type="bibr" rid="CR27">27</xref>] utilize subcellular spatial variation in protein abundance to identify subcellular regions and annotate pixel-level features.</p>
    <p id="Par5">Building on these promising approaches, we present Bento, an open-source Python toolkit for scalable analysis of spatial transcriptomics data at the subcellular resolution. Bento ingests single-molecule resolution data and segmentation masks, utilizing geospatial tools (GeoPandas [<xref ref-type="bibr" rid="CR28">28</xref>], Rasterio [<xref ref-type="bibr" rid="CR29">29</xref>]) for spatial analysis of molecular imaging data, and data science tools including SciPy [<xref ref-type="bibr" rid="CR30">30</xref>] and Tensorly [<xref ref-type="bibr" rid="CR31">31</xref>] for scalable analysis of high-dimensional feature matrices. Furthermore, Bento is a member of the Scverse ecosystem [<xref ref-type="bibr" rid="CR32">32</xref>], enabling integration with Scanpy [<xref ref-type="bibr" rid="CR21">21</xref>], Squidpy [<xref ref-type="bibr" rid="CR17">17</xref>], and more than 30 other single-cell omics analysis tools.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of Bento data infrastructure for subcellular analysis</title>
      <p id="Par6">In order to facilitate a flexible workflow, Bento is generally compatible with molecule-level resolution spatial transcriptomics data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A), such as datasets produced by MERFISH [<xref ref-type="bibr" rid="CR13">13</xref>], seqFISH + [<xref ref-type="bibr" rid="CR14">14</xref>], CosMx (NanoString) [<xref ref-type="bibr" rid="CR33">33</xref>], Xenium (10 × Genomics) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR34">34</xref>], and Molecular Cartography (Resolve Biosciences) [<xref ref-type="bibr" rid="CR35">35</xref>]. Bento’s workflow takes as input (1) 2D spatial coordinates of transcripts annotated by gene and (2) segmentation boundaries (e.g., cell membrane, nuclear membrane, and any other regions of interest) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). While 3D molecular coordinates are commonly included, 3D segmentation information is limited to z-stacked 2D segmentation, limiting its usability. If available, Bento can also handle arbitrary sets of segmentations for other subcellular structures or regions of interest. These inputs are stored in the AnnData data format [<xref ref-type="bibr" rid="CR36">36</xref>], which links cell and gene metadata to standard count matrices, providing compatibility with standard single-cell RNA-seq quality control and analysis tools in the Scverse ecosystem [<xref ref-type="bibr" rid="CR32">32</xref>]. With a data structure for segmentation boundaries and transcript coordinates in place, Bento can easily compute spatial statistics and measure spatial phenotypes to build flexible multidimensional feature sets for exploratory subcellular analysis and utilize these spatial metrics to augment quality control (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C).<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow and functionality of the Bento toolkit. <bold>A</bold> Single-molecule resolved spatial transcriptomics data from commercial or custom platforms are ingested into Bento where it is converted to the AnnData format (<bold>B</bold>), where it can be manipulated with Bento as well as a wide ecosystem of single-cell omics tools. <bold>C</bold> Geometric statistics are illustrated for the seqFISH + dataset, including metrics describing cell and nuclear geometries and cell density to assess overall data quality. <bold>D</bold> Bento has a standard interface to perform a wide variety of subcellular analyses</p></caption><graphic xlink:href="13059_2024_3217_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par7">Bento offers a precise yet flexible palette of novel complementary subcellular analyses (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). We introduce RNAforest, a multilabel approach for annotating RNA localization patterns adapted from FISH-quant v2 [<xref ref-type="bibr" rid="CR22">22</xref>]. We find that many RNAs are spatially distributed according to gene function. We then implement RNAcoloc, a context-specific approach to quantify colocalization to characterize how genes colocalize with each other in a compartment-specific manner. Having established systematic patterning and organization of RNA transcripts, we demonstrate RNAflux, an unsupervised method for semantic segmentation of subcellular domains. RNAflux first quantifies subcellular expression gradients at pixel resolution before identifying consistent subcellular domains via unsupervised clustering. We demonstrate the utility of Bento’s tools by applying them to identifying critical localization changes in human iPSC-derived cardiomyocytes upon drug treatment with doxorubicin, a widely used chemotherapeutic known to cause cardiotoxicity [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>RNAforest: utilizing subcellular landmarks to predict RNA subcellular localization</title>
      <p id="Par8">In computer vision, key points or landmarks are commonly used for tasks like facial recognition [<xref ref-type="bibr" rid="CR38">38</xref>] and object detection. Analogous to these classical applications, we derive spatial features using cell and nucleus boundaries as landmarks to predict RNA localization patterns from spatial summary statistics. Building on the summary statistics used for classifying smFISH data in FISH-quant v2 [<xref ref-type="bibr" rid="CR39">39</xref>], RNAforest consists of an ensemble of five binary random forest classifiers rather than a single multi-classifier model to assign one or more labels. These pattern labels, adapted from several high-throughput smFISH imaging experiments in HeLa cells [<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR43">43</xref>], are broadly applicable to eukaryotic cells: (i) nuclear (contained in the volume of the nucleus), (ii) cytoplasmic (diffuse throughout the cytoplasm), (iii) nuclear edge (near the inner/outer nuclear membrane), (iv) cell edge (near the cell membrane), and (v) none (complete spatial randomness). It is important to note, as was done previously in FISH-quant v2 [<xref ref-type="bibr" rid="CR39">39</xref>] that because of the 2D nature of the dataset, RNA that is in truth cytoplasmic but above or below the nucleus will still appear as though in the nucleus when collapsed in the <italic>z</italic>-dimension. As we use the FISH-quant v2 pattern simulation framework, this is accounted for in the training dataset.</p>
      <p id="Par9">We used the FISH-quant v2 simulation framework to generate realistic ground-truth data [<xref ref-type="bibr" rid="CR42">42</xref>]. Each sample is defined as a set of points with coordinates in two dimensions, representing the set of observed transcripts for a gene in a particular cell. In total, we simulated 2000 samples per class for a total of 10,000 samples (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). We used 80% of the simulated data for training and held out the remaining 20% for testing (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1A). Each sample is encoded by a set of 13 input features, describing characteristics of its spatial point distribution, including proximity to cellular compartments and extensions (features 1–3), measures of symmetry about a center of mass (features 4–6), and measures of dispersion and point density (features 7–13) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). These features are normalized to morphological properties of the cell to control for variability in cell shape. A detailed description of every feature is described in Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Table S1, and model architectures and hyperparameters are described in Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Table S2 (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section).<fig id="Fig2"><label>Fig. 2</label><caption><p>Subcellular localization pattern identification with RNAforest.<bold> A</bold> Thirteen spatial summary statistics are computed for every gene-cell pair describing the spatial arrangement of molecules and boundaries in relation to one another. The features (Supp. Table <xref rid="MOESM1" ref-type="media">1</xref>) are inputs for RNAforest, a multilabel ensemble classifier that assigns one or more subcellular localization labels: cell edge, cytoplasmic, nuclear, nuclear edge, and none. The colors for each label are used consistently throughout to figure. Top 10 genes for each label visualized for each label other than “none” in <bold>B</bold> U2-OS cells and <bold>C</bold> 3T3 cells. <bold>D</bold> and <bold>E</bold> are UpSet plots showing the proportion of measured transcripts assigned to each label. <bold>F</bold> and <bold>G</bold> show the relative label proportion across cells for each gene and are colored by the majority label (<bold>F</bold> and <bold>G</bold>). <bold>H</bold> Top 5 consistent genes for each label.<bold> I</bold> ssGEA identifies the enrichment of GO cellular component domains for each label in the 3T3 cell dataset. Stars denote <italic>p</italic>-values under thresholds defined in the legend. <italic>P</italic>-values are derived from ssGSEA permutation tests with Benjamini–Hochberg correction controlling for false discovery rate</p></caption><graphic xlink:href="13059_2024_3217_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">We applied RNAforest on two datasets from different spatial platforms, cell types, and gene panel sizes: a MERFISH dataset in U2-OS cells and a seqFISH + dataset in 3T3 cells. Validation performance on manual annotation of subsets of both datasets shows that RNAforest generalizes well despite biological and technical differences (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1B). The MERFISH dataset measured 130 genes (low plexity) with high detection efficiency per gene (111 molecules per gene per cell on average), while the seqFISH + dataset measured 10,000 genes (very high plexity) with lower detection efficiency (8 molecules per gene per cell on average) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B, C, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1C-F). In agreement with previous work characterizing RNA localization of 411 genes [<xref ref-type="bibr" rid="CR43">43</xref>], we find that genes commonly exhibit variability in localization across cells. This suggests that heterogeneity in localization likely generalizes to the entire transcriptome. Of the localization patterns besides “none,” “nuclear” was the most common (22.1%) in the U2-OS osteosarcoma cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D, F), while “cell edge” was the most common (15.9%) in the 3T3 fibroblast cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>E, G).</p>
      <p id="Par11">In the U2-OS cells, we found many genes to have preferential localization in different subcellular compartments (Fig. <xref rid="Fig2" ref-type="fig">2</xref>H). In agreement with our RNAflux findings, we find genes known to localize to the nucleus [<xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR45">45</xref>] to be frequently labeled “nucleus” (MALAT1, SOD2) and genes encoding secreted extracellular proteins [<xref ref-type="bibr" rid="CR13">13</xref>] to be frequently labeled “nuclear edge” (FBN1, FBN2). As expected, we find genes preferentially “nuclear” and “nuclear edge” localized to mirror nucleus and endoplasmic reticulum genes found in a 10 k genes MERFISH study of U2-OS cells that included ER staining [<xref ref-type="bibr" rid="CR46">46</xref>] (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Leveraging the 3T3 seqFISH + dataset’s higher plexity, we were able to ask whether genes with similar localization preferences are functionally related. We applied gene set enrichment analysis to gene localization frequencies to identify enriched gene ontology terms [<xref ref-type="bibr" rid="CR47">47</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref>I; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Secretory processes were enriched in the nucleus and nuclear edge, which may be linked to increased transcription of fibroblast-related functions. Cell edge enriched pathways consisted of those with the cell membrane as their site of function (e.g., endocytosis and tight junction suggesting local translation of these genes). Additionally, the term for cell cycle was significantly enriched in the cytoplasm only. Genes without strong localization preference (most frequently “none”) were not significantly associated with any pathways. These genes likely do not undergo active transport and are functionally independent of local translation.</p>
      <p id="Par12">In summary, RNAforest gives a user a facile method for annotating RNA localization patterns and quantifying heterogeneity in a transcriptome-wide manner independent of RNA abundance. Beyond known RNA localizations, we find that transcript location is generally associated with known gene function, alluding to the systematic spatial regulation of RNA transport. We foresee RNAforest will be a valuable addition to characterize RNA localization across diverse spatial transcriptomics datasets.</p>
    </sec>
    <sec id="Sec5">
      <title>RNAcoloc: an approach for context-specific RNA colocalization</title>
      <p id="Par13">In geospatial information processing, a fundamental feature that is often gleaned from large datasets is the colocation of objects (e.g., gleaning socialization metrics from cell phone colocation data in Singapore [<xref ref-type="bibr" rid="CR48">48</xref>]). Colocation is similarly valuable in understanding co-translation and interaction networks of genes in a biological context [<xref ref-type="bibr" rid="CR49">49</xref>]. Recent spatial transcriptomics approaches have used a number of colocalization metrics from the geographic information systems and ecology fields, e.g., the bivariate versions of Ripley’s K function (also known as cross-k-function) [<xref ref-type="bibr" rid="CR50">50</xref>], Moran’s <italic>I</italic> [<xref ref-type="bibr" rid="CR51">51</xref>], and the join count statistic [<xref ref-type="bibr" rid="CR52">52</xref>]. These metrics are designed to measure spatial associations between two populations, i.e., gene A transcripts and gene B transcripts. However, it is more appropriate to think of all transcripts in a single cell from a single population; after all, RNA transcription and localization are not completely stochastic. We have shown that the subcellular distribution of RNA is highly structured with RNAforest. As such, we developed RNAcoloc, an approach that combines the Colocation Quotient (CLQ) [<xref ref-type="bibr" rid="CR53">53</xref>] metric and tensor decomposition for context-specific RNA colocalization (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). The CLQ is a colocalization statistic that is capable of accounting for the biophysical properties of RNA spatial distributions. First, the CLQ considers how clustered the overall RNA population is in a cell and measures whether specific pairs of genes are more clustered than expected given the spatial pattern of the overall population. Second, the CLQ is inherently asymmetric and captures the direction of attraction, i.e., the attraction of gene A to gene B is not the same as the attraction of gene B to gene A. This is most common when gene A and gene B have very different expression levels, which is prevalent due to overdispersion in gene expression data.</p>
      <p id="Par14">RNAcoloc calculates CLQ scores for each gene per cell in a compartment-specific manner, such that each sample has 2 scores, a nucleus and cytoplasm CLQ score. An initial comparison in the U2-OS dataset of global colocalization between nuclear and cytoplasmic fractions unsurprisingly found that transcripts from the same gene tend to cluster more tightly with themselves than with transcripts from other genes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). Additionally, self-colocalization is significantly stronger in the cytoplasm than in the nucleus. In conjunction with our findings from RNAforest analysis that genes of the same localization pattern tend to have similar functions, this suggests that the RNAs are more tightly spatially regulated once exported from the nucleus.<fig id="Fig3"><label>Fig. 3</label><caption><p>Compartment-specific RNA colocalization with RNAcoloc. <bold>A</bold> Transcripts are separated by compartment (nucleus and cytoplasm) before CLQ scores are calculated for every gene pair across all cells. This yields a cell × gene pair × compartment tensor. <bold>B</bold> Pairwise comparison of log CLQ distributions for gene pairs and self-pairs, further categorized by compartment. The Mann–Whitney <italic>U</italic> test was used for comparisons. Stars denote <italic>p</italic>-values below the legend threshold with Benjamini–Hochberg correction controlling for false-discovery rate. From top to bottom, group sizes are 12,254,430 (cytoplasm gene pairs), 115,187 (nucleus gene pairs), 6,778,402 (cytoplasm self-pairs), and 86,474 (nucleus self-pairs). <bold>C</bold> Tensor decomposition yields 4 factors. From left to right, the three heatmaps show the loadings of each factor for each dimension—compartments, cells, and gene pairs. Only the top 5 associated gene pairs for each factor are shown. <bold>D</bold> Top examples of compartment-specific colocalized gene pairs. Black scale bars denote 10 μm</p></caption><graphic xlink:href="13059_2024_3217_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par15">By calculating CLQ scores for every gene–gene pair across compartments, RNAcoloc constructs a tensor of shape <italic>P</italic> × <italic>C</italic> × <italic>S</italic> where <italic>P</italic>, <italic>C</italic>, and <italic>S</italic> represent the number of gene–gene pairs, cells, and compartments, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section).</p>
      <p id="Par16">RNAcoloc then applies tensor decomposition — specifically, non-negative parallel factor analysis — a data-driven, unsupervised approach for discovering substructure in high-dimensional data [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR54">54</xref>] to decompose the tensor into <italic>k</italic> “factors”. The number of factors is determined using the elbow method heuristic, optimizing for the root mean squared error (RMSE) reconstruction loss (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Unlike matrix dimensionality reduction methods, such as PCA, the order of the components (factors) is unassociated with the amount of variance explained. Each factor is composed of 3 loading vectors, which correspond to the compartments, cells, and gene pairs. Higher values denote a stronger association with that factor. Crucially for interpretation, factors derived from tensor decomposition are not mutually exclusive and can share overlapping sets of associated compartments, cells, and gene pairs.</p>
      <p id="Par17">Applied to the U2-OS dataset, RNAcoloc decomposes RNA colocalization into 4 factors. Examining factor loadings indicates two distinct subpopulations of cells with compartment-specific colocalization behaviors; cluster 1 cells exhibit uniform (Factor 0) and cytoplasmic (Factor 3) colocalization, while cluster 2 cells show nuclear (Factor 1) and cytoplasmic colocalization (Factor 2) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>C, D). Factor 3 describes the colocalization of gene pairs in the cytoplasm of cluster 1 cells, especially a number of genes that attract PIK3CA transcripts While little is known about PIK3CA RNA interactions, the PI3K pathway regulates mitotic organization, including the regulation of dynein and dynactin motor proteins. DYNC1H1 is among the top genes attracting PI3KCA and specifically encodes cytoplasmic dynein, a motor protein critical for spindle formation and chromosomal segregation in mitosis [<xref ref-type="bibr" rid="CR55">55</xref>]. This hints that not only is compartmental localization of RNA linked to the cell cycle [<xref ref-type="bibr" rid="CR46">46</xref>], but RNA-RNA interactions may play a role as well. In cluster 2 cells, MALAT1 attracts CNR2 transcripts more than expected in the cytoplasm. Even though MALAT1 is canonically abundantly localized to the nucleus, this demonstrates that the CLQ score identifies gene pairs colocalizing more than expected despite the disproportionate expression of MALAT1 relative to CNR2, whereas other approaches seem confounded by large differences in expression [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
      <p id="Par18">We demonstrate the ability of RNAcoloc to quantify compartment-specific gene-pair colocation by exploring cytoplasmic vs. nuclear colocalization. As we found separately with RNAforest, RNAcoloc analysis finds evidence that RNA transport is spatially regulated, especially after nuclear export. We highlight several examples of colocalization suggesting how RNA localization allows the same gene to have multiple functions in a spatially dependent fashion, i.e., depending on its molecular neighbors and local environment [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR57">57</xref>]. We foresee RNAcoloc will be increasingly relevant as many spatial technologies are beginning to image proteins along with RNA, which can be used to delineate more granular compartments, such as cell organelles or distinct regions, e.g., neuron cell bodies vs dendrites.</p>
    </sec>
    <sec id="Sec6">
      <title>RNAflux: unsupervised semantic segmentation of subcellular domains in single cells</title>
      <p id="Par19">To build on RNAforest, we overcame the restricted number of localization patterns defined by the supervised method by framing RNA localization as an unsupervised embedding problem. RNAflux looks at local neighborhoods within the space of a cell and builds a normalized gene composition per neighborhood. Differences in neighborhood compositions can be leveraged to identify distinct subcellular domains in a manner that is entirely unsupervised and independent of cell geometry.</p>
      <p id="Par20">We applied this embedding procedure to compute a gene composition vector for every pixel in 2D coordinate space, generating a spatially coherent embedding across entire cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section).<fig id="Fig4"><label>Fig. 4</label><caption><p>RNAflux finds distinct subcellular domains with consistent spatial organization and local gene composition. <bold>A</bold> Flowchart of RNAflux and fluxmap computation. Local neighborhoods of a fixed radius are arrayed across a cell and a normalized gene composition is computed for each pixel coordinate, producing an RNAflux embedding. The first three principal components of the RNAflux embedding are visualized for U2-OS cells coloring RGB values by PC1, PC2, and PC3 values respectively for each pixel. Fluxmap domains are computed from each RNAflux embedding to create semantic segmentation masks of each subcellular domain.<bold> B</bold> The left panel shows a field of view of U2-OS cells, dots denoting individual molecules colored by gene species, nuclei, and cell boundaries outlined in white. For the same field of view of cells, the center panel shows RNAflux embeddings and the right panel shows fluxmap domains. <bold>C</bold> The scatter plot shows how the composition of each gene is distributed across fluxmap domains. The position of each point denotes the relative bias of a given gene’s composition across fluxmaps.<bold> D</bold> Heatmap showing the fraction of pixels with a positive enrichment value for each APEX-seq location for each fluxmap domain. <bold>E</bold>–<bold>I</bold> The most highly enriched location is shown for each fluxmap domain. Domain boundaries are denoted by white lines within each cell</p></caption><graphic xlink:href="13059_2024_3217_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par21">Applied to a MERFISH dataset with a target panel of 130 genes across over 1153 U2-OS cells, we demonstrate that RNAflux embeddings can detect transcriptionally distinct subcellular domains. Performing dimensional reduction of the embeddings showed that the top sources of variation spatially correspond to the nucleus, the nuclear periphery, and cytoplasmic regions consistently across cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section) confirming that RNAflux measures intracellular transcriptional variation, as opposed to intercellular variation. To delineate compositionally similar domains in a data-driven manner, we cluster pixel embeddings using self-organizing maps (SOMs), effectively performing unsupervised semantic segmentation (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). We denote the resulting clusters as “fluxmap domains.” We found that this assigned pixels to 5 fluxmap domains, consistently highlighting spatial regions across every cell (e.g., fluxmap 2 is always nuclear while the remaining domains constitute the cytoplasm) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). By considering the spatial distribution of molecules across fluxmap domains, we can quantify the composition of molecules for each gene across fluxmaps (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C), e.g., nuclear-localized MALAT1 [<xref ref-type="bibr" rid="CR44">44</xref>].</p>
      <p id="Par22">We sought to characterize the fluxmap domains with known information about RNA localization. We used data from a previous study that measured gene expression at “distinct subcellular locales” via APEX-seq, a technique for proximity labeling and sequencing of RNA [<xref ref-type="bibr" rid="CR58">58</xref>]. Of the 3288 genes differentially enriched to one or more locales, 63 overlapped with the 130 MERFISH genes. The location enrichment score for each pixel is calculated by taking the weighted sum of its RNAflux embedding and the measured relative enrichment, i.e., log fold change measured by APEX-seq loadings for a given organelle-specific geneset (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Visualizing each pixel’s location-specific enrichment scores from the APEX-seq dataset highlights the subcellular localization of these compartments, including the cytosol, nucleus, nucleolus, nuclear pore, nuclear lamina, endoplasmic reticulum lumen (ER lumen), ER membrane (ERM), and the outer mitochondrial membrane (OMM) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>D). We find the nuclear compartments have high scores in domain 2, while the cytoplasm scores rank highest in domains 4 and 5. Both the ERM and OMM scores are the strongest in domain 1 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E).</p>
      <p id="Par23">The most common application for spatial transcriptomics is in mapping heterogeneous cell types in large tissue samples. This presents several challenges. First, the panels for these experiments are weighted heavily towards cell type markers determined by single-nuclei RNA-seq, potentially reducing the intracellular variability in the expression on which Bento relies. Second, substantial intercellular heterogeneity can skew the low-rank embedding by introducing too much variance in requisite cell radii information. To explore the applicability of RNAflux on tissue, we applied it to a previously published breast cancer tissue dataset generated by 10 × Xenium [<xref ref-type="bibr" rid="CR59">59</xref>]. We successfully reproduced the identification of unique cell types that reflect canonical expression markers (Fig. S<xref rid="MOESM1" ref-type="media">4</xref>A and B). We apply RNAflux to cell type-disaggregated subsets of the full datasets in fields of view of interest with at least 100 cells of interest and find that fluxmaps 1–3 show different enrichment scores for Nucleus and Endoplasmic Reticulum (ER; combination of ERM and ER lumen). We note that despite the successful delineation of discrete regions in the form of fluxmaps when looking at different regions of tissue that are enriched for different cell types, nuclear and ER enrichment scores change for each fluxmap (Fig. S<xref rid="MOESM1" ref-type="media">4</xref>C).</p>
      <p id="Par24">In summary, RNAflux finds distinct subcellular domains with consistent spatial organization and local gene composition. As an unsupervised method, RNAflux can be applied to any cell type for inferring subcellular domains from transcript locations and functionally annotated with biological enrichment analysis. This process is best performed on cell type-separated data to guard low-rank embeddings from being generated by cells of vastly different morphologies. This disaggregation is important because, unlike uniform cell lines, heterogeneous tissue composed of functionally diverse stromal cells and leukocytes should indeed be expected to have different distributions and complements of subcellular domains.</p>
    </sec>
    <sec id="Sec7">
      <title>Doxorubicin-induced stress in cardiomyocytes depletes RNA from the endoplasmic reticulum</title>
      <p id="Par25">Having established Bento’s utility to characterize RNA localization in U2OS cells, we applied Bento to quantify changes in localization in the context of perturbations in cells. Specifically, we performed single-molecule spatial transcriptomics on doxorubicin-treated and untreated cardiomyocytes to identify RNA localization changes as a result of treatment.</p>
      <p id="Par26">Doxorubicin (DOX) was once one of the most effective broad-spectrum anti-cancer anthracycline antibiotics [<xref ref-type="bibr" rid="CR60">60</xref>, <xref ref-type="bibr" rid="CR61">61</xref>] with particular efficacy against solid malignancies such as lung and breast cancer, as well as hematologic neoplasia [<xref ref-type="bibr" rid="CR62">62</xref>, <xref ref-type="bibr" rid="CR63">63</xref>]. However, DOX’s propensity to cause cardiac damage in patients has led to significant limitations in its clinical use [<xref ref-type="bibr" rid="CR64">64</xref>]. The exact mechanism by which DOX induces heart failure is unclear, but significant evidence suggests cardiomyocyte injury driven by oxidative stress is a major factor [<xref ref-type="bibr" rid="CR62">62</xref>, <xref ref-type="bibr" rid="CR65">65</xref>–<xref ref-type="bibr" rid="CR68">68</xref>]. Specifically, DOX causes stress and dysfunction in multiple cellular compartments in cardiomyocytes such as mitochondria, Sarco/endoplasmic reticulum (SER), deficiencies in calcium signaling, and lipid degradation at the cellular membrane [<xref ref-type="bibr" rid="CR69">69</xref>]. We reasoned that by measuring the localization of the RNA transcripts of 100 genes crucial to cardiomyocyte health and function (Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Table S2) and leveraging the tools developed within Bento, we could recapitulate known dysfunction of subcellular domains in cardiomyocytes upon DOX stress and measure novel RNA localization phenotypes.</p>
      <p id="Par27">We utilized a chemically defined protocol to differentiate human induced pluripotent stem cells (iPSCs) into beating cardiomyocytes and treated them with either DMSO (vehicle) or 2.5 μM DOX for 12 h before fixation (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Single-molecule spatial transcriptomes were measured by Resolve Bioscience using Molecular Cartography. The resulting data was segmented using ClusterMap [<xref ref-type="bibr" rid="CR24">24</xref>] for cell boundaries and Cellpose [<xref ref-type="bibr" rid="CR70">70</xref>] for nuclei boundaries (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). Non-myocytes were filtered out using SLC8A1 as a canonical marker for cardiomyocytes (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3A). Comparing vehicle and DOX-treated cardiomyocytes, we found NPPA, a classic marker for cardiac stress [<xref ref-type="bibr" rid="CR71">71</xref>, <xref ref-type="bibr" rid="CR72">72</xref>], to be upregulated in DOX-treated cells (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). We identified subcellular domains in the vehicle and DOX-treated cardiomyocytes using RNAflux, clustering the domains into four fluxmap domains (Fig. <xref rid="Fig5" ref-type="fig">5</xref>C, D, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3B). Enrichment of location-specific gene expression aligned domains to the nucleus (nuclear pore, nucleolus, and nucleus), ERM and OMM, ER lumen, and cytosol respectively (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3C). Comparing the gene composition in each domain, we observe an overall localization bias towards both the nucleus and ERM/OMM in vehicle-treated cells (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E top), in agreement with prior poly(A) smFISH studies [<xref ref-type="bibr" rid="CR73">73</xref>]. However, RNA in the DOX-treated cardiomyocytes demonstrated a shift in average RNA localization away from the ERM/OMM and towards the nucleus (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E bottom). There was no correlation when comparing the logFC in expression and the difference in nuclear composition of genes after treatment, indicating that localization towards the nucleus is not driven by transcript abundance (Spearman <italic>r</italic> = 0.07, <italic>p</italic> = 0.4944). There is evidence that 90% of genes have a half-life of less than 260 min [<xref ref-type="bibr" rid="CR74">74</xref>], far less than the 12-h DOX treatment, indicating that the shift in RNA localization is likely due to reduced nuclear export of newly synthesized RNA from the nucleus to the ERM/OMM. Indeed, even low concentrations of DOX have been demonstrated to alter structural fibrous proteins as well as mitochondrial depolarization and fragmentation [<xref ref-type="bibr" rid="CR75">75</xref>]. Of particular note, the RNA binding protein RBM20—a critical regulator of mRNA splicing of genes encoding key structural proteins associated with cardiac development and function—had a pronounced depletion of RNA transcripts outside of the nucleus upon DOX treatment (Fig. <xref rid="Fig5" ref-type="fig">5</xref>G left). With further validation, this may indicate nuclear retention and or degradation of nuclear exported RBM20 mRNA as a potential mechanism of DOX-induced cardiomyopathy. Similarly, we found the mRNA of calcium voltage-gated channel subunit CACNB2 to also deplete outside of the nucleus (Fig. <xref rid="Fig5" ref-type="fig">5</xref>G middle). The loss of CACNB2 translation outside of the nucleus may impact calcium signaling crucial to cardiomyocyte function [<xref ref-type="bibr" rid="CR76">76</xref>]. Most genes only showed weak shifts in localization, similar to LAMP2 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>G right).<fig id="Fig5"><label>Fig. 5</label><caption><p>Subcellular RNA localization changes upon Doxorubicin treatment in iPSC-derived cardiomyocytes. <bold>A</bold> Cardiomyocytes derived from human iPSCs were treated with DMSO or 2.5 μM DOX for 12 h. The localizations of 100 genes relevant to cardiomyocyte health and function were measured using Molecular Cartography. Cell boundaries were determined using ClusterMap and nuclei were segmented using Cellpose. <bold>B</bold> Top 10 differentially upregulated and downregulated genes in vehicle versus treatment. <italic>T</italic>-test was used for comparisons. All genes shown are significant given an adjusted <italic>p</italic>-value threshold of<italic> p</italic> &lt; 0.01. Benjamini–Hochberg correction was used to control for the false discovery rate. Vehicle and treatment conditions have <italic>n</italic> = 7159 and 6260 cells respectively. <bold>C</bold> APEX-seq location-specific gene enrichment of fluxmap domains for the cytosol, endoplasmic reticulum membrane (ERM), endoplasmic reticulum lumen (ER Lumen), nuclear lamina, nucleus, nucleolus, nuclear pore, and outer mitochondrial matrix (OMM). <bold>D</bold> Fluxmap domains visualized for a representative field of view of cardiomyocytes for vehicle and treatment respectively highlighting cellular nuclei, ERM/OMM, ER Lumen, and cytosol. <bold>E</bold> RNAflux fluxmap enrichment of each gene averaged across vehicle and treatment cardiomyocytes captures changes in subcellular RNA localization. Top 10 genes are labeled and ranked by the largest shifts between compartment compositions. Shifts are quantified by Wasserstein distance. <bold>F</bold> Average gene enrichment in each fluxmap across vehicle and treatment conditions colored by log-fold expression demonstrates population-level shifts in transcript subcellular localization. <bold>G</bold> Visualization of RBM20, CACNB2, and LAMP2 transcripts confirms the depletion of transcripts from the perinuclear and cytosolic compartments of cardiomyocytes upon DOX treatment</p></caption><graphic xlink:href="13059_2024_3217_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par28">Bento seeks to interrogate biology via its “subcellular first” approach to spatial analysis, complementary to “cell-type or tissue first” spatial analysis methods. The toolkit enables quantitative, reproducible, and accessible analysis agnostic to spatial technology platforms in a standardized framework. We implement three novel methods to interrogate subcellular RNA organization: RNAforest for supervised annotation of localization patterns, RNAcoloc for compartment-aware colocalization analysis, and RNAflux for identifying transcriptionally distinct subcellular domains. We showed that with RNAflux, we were able to quantify RNA localization in a variety of contexts, including domain-specific gene localization, drug-induced changes in localization, and cell type-specific localization. With both RNAflux and RNAforest, we find that subcellular mRNA localization reflects gene function. With RNAcoloc, we explore the use of CLQ scores to quantify pairwise gene colocalization in the context of asymmetric associations.</p>
    <p id="Par29">From these results, we found three main factors to limit the effectiveness of subcellular-resolution analysis: molecule density, segmentation quality, and target panel composition. In particular, RNAflux becomes uninformative if too few molecules are detected per cell or if the number of molecules per gene is too sparse. We found that datasets with higher density, i.e., molecules per micrometer<sup>2</sup>, are less noisy and inform more coherent gradients and domains. Both the U2-OS dataset and cardiomyocyte datasets had high enough molecule density to identify consistent fluxmaps. Notably, RNAflux robustly highlights domains corresponding to the nucleus and ER despite some poor cell segmentation and partially unannotated nuclei in the cardiomyocytes dataset (Fig. <xref rid="Fig5" ref-type="fig">5</xref>D). As most commercial target panels are largely composed of marker genes for cell type identification, RNAflux embeddings should be interpreted carefully, especially if transcripts show little spatial variation in subcellular localization. In contrast, RNAforest performs reliably beyond a minimum of 5–10 molecules per sample but is sensitive to accurate segmentation for calculating cell morphology-dependent features (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. SE-F). The 3T3 cells were manually segmented and the U2-OS cells had relatively accurate segmentation and were therefore amenable to applying RNAforest. We found that the segmentation in the cardiomyocytes is accurate enough for single-cell gene expression analysis, but lacked the precision needed to apply RNAforest. In the case of RNAcoloc, the limiting factor to identifying relevant biology is the target panel composition. The current focus of most target panels typically includes cell type markers and highly expressed genes, whereas it would be more informative to identify colocalizing members of protein complexes, functional pathways, or ligand-receptor pairs. Our ability to characterize relevant pathways with our curated cardiomyocyte gene panel shows how gene panel design focused on function enables discovery. Ultimately, non-targeted transcriptome-scale technologies will be necessary to unlock the full potential of subcellular biology.</p>
    <p id="Par30">A dimensional limitation of Bento is its current inability to process three-dimensional spatial transcriptomic data. While some commercially available spatial transcriptomic methods yield RNA molecular coordinates in 3D, the nuclear and cell segmentation is inevitably still two-dimensional making it difficult to interpret z-dimensional positions lacking the context of cellular geometry in 3D. However, the algorithms behind RNAforest, RNAcoloc, RNAflux, and the plethora of feature calculation functions in Bento are inherently extensible to leveraging three-dimensionality. When three-dimensional cell segmentation improves, we intend to extend Bento to support three-dimensional analysis.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par31">Conventionally, RNA is treated as an intermediary vehicle encoding genomic information for protein synthesis. We began our investigation of RNA localization with the hope of understanding how the spatial organization of RNA functions as a mechanism for post-transcriptional regulation. However, RNAflux conceptually introduces using RNA molecular coordinates as a latent layer of information encoding cellular space–time. Here, we used that latent layer of information to identify subcellular domains. As spatial omic technologies improve to capture more and more information, the potential applications of such latent embeddings will grow as well. Indeed at the tissue level, this concept is already being leveraged with a recent tool, TensionMap, using RNA localization information to predict mechanical tension [<xref ref-type="bibr" rid="CR77">77</xref>]. As applications for spatial transcriptomics grow in popularity and complexity, we envision that Bento is a platform for the next generation of tools needed to quantify the complex molecular dynamics governing normal and abnormal cellular processes.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>MERFISH and seqFISH + data preprocessing</title>
      <p id="Par32">For the seqFISH + dataset, we limited the scope of our analysis to the set of genes for which at least 10 molecules were detected in at least one cell. This helped reduce sparsity in the data, resulting in 3726 genes remaining. Because pattern classification requires nuclear segmentation masks, we removed all cells lacking annotated nuclei for the remainder of 179 cells. Because the MERFISH data had a much higher number of molecules detected per gene, no gene needed to be removed. Again, cells without annotated nuclei were removed, leaving 1022 cells for downstream analysis.</p>
    </sec>
    <sec id="Sec12">
      <title>Preprocessing cardiomyocytes datasets</title>
      <p id="Par33">Single-cell expression matrices of both vehicle replicates and both DOX treatment samples were concatenated as a single expression matrix. Cells were projected into two dimensions with UMAP dimensional reduction. No significant batch effects were detected. Leiden clustering was performed at resolution = 0.5 to isolate and filter out a non-myocyte population depleted in SLC8A1 expression (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3A). All described preprocessing steps were performed in Scanpy [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>RNAforest: model selection and training</title>
      <p id="Par34">We evaluated 4 base models for the multilabel classifier including random forests (RF), support vector machines (SVM), feed-forward fully-connected neural networks (NN), and convolutional neural networks (CNN). While all other models use the 13 spatial features for input (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), the CNN takes 64 × 64 image representations of each sample as input. Each multilabel classifier consists of 5 binary classifiers with the same base model. We used the labeled 10,000 simulated samples for training, stratifying 80% of the simulated data for training and holding out the remaining 20% for testing. To select the best hyperparameters for each multilabel classifier, we sampled from a fixed hyperparameter space with the Tree-structured Parzen Estimator algorithm and evaluated performance with fivefold cross-validation (Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Table S2). We retrained the final model (random forest base model) on all training data with the best-performing set of hyperparameters (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1E). Exact steps can be found and reproduced in notebooks stored in the GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-manuscript">https://github.com/ckmah/bento-manuscript</ext-link>.</p>
    </sec>
    <sec id="Sec14">
      <title>RNAforest: image rasterization of molecules and segmentation masks for CNN</title>
      <p id="Par35">To generate an image for a given sample, point coordinates, the cell segmentation mask, and the nuclear segmentation mask are used. The area of the cell is tiled as a 64 × 64 grid, where each bin corresponds to a pixel in the final image. Values are stored in a single channel to render a grayscale image. Pixels inside the cell are encoded as 20 and inside the nucleus encoded as 40. Bins with molecules are encoded as (40 + 20 × <italic>n</italic>) where <italic>n</italic> is the number of molecules. Finally, values are divided by 255 and capped to be between 0 and 1.</p>
    </sec>
    <sec id="Sec15">
      <title>RNAforest: simulating training data</title>
      <p id="Par36">We trained a multilabel classifier to assign each gene in every cell labels from five categories: (i) nuclear (contained in the volume of the nucleus), (ii) cytoplasmic (diffuse throughout the cytoplasm), (iii) nuclear edge (near the inner/outer nuclear membrane), (iv) cell edge (near the cell membrane), and (v) none (complete spatial randomness). These categories are a consolidation of those observed in several high-throughput smFISH imaging experiments in HeLa cells [<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR43">43</xref>]. We used the FISH-quant simulation framework (<ext-link ext-link-type="uri" xlink:href="https://code.google.com/archive/p/fish-quant/">https://code.google.com/archive/p/fish-quant/</ext-link>) to generate realistic ground-truth images using empirically derived parameters from the mentioned high-throughput smFISH imaging experiments in HeLa cells [<xref ref-type="bibr" rid="CR42">42</xref>]. In total, we simulate 2000 samples per class for a total of 10,000 training samples.<list list-type="order"><list-item><p id="Par37"><italic>Cell shape</italic>: Cell morphology varies widely across cell types, and for classifier generalizability, it is important to include many different morphologies in the training set. We use a catalog of cell shapes for over 300 cells from smFISH images in HeLa cells that capture nucleus and cell membrane shape [<xref ref-type="bibr" rid="CR42">42</xref>]. Cell shapes were obtained by cell segmentation with CellMask and nuclear segmentation was obtained from DAPI staining.</p></list-item><list-item><p id="Par38">mRNA<italic> abundance</italic>: We simulated mRNA abundance at three different expression levels (40, 100, and 200 mRNA per average-sized cell) with a Poisson noise term. Consequently, total mRNA abundance per cell was between 5 and 300 transcripts.</p></list-item><list-item><p id="Par39">Localization<italic> pattern</italic>: We focused on 5 possible 2D localization patterns, including cell edge, cytoplasmic, none, nuclear, and nuclear edge. Each pattern was further evaluated at 3 different degrees—weak, moderate, and strong. Moderate corresponds to a pattern typically observed in a cell, whereas weak is close to spatially random. These 5 classes aim to capture biologically relevant behavior generalizable to most cell types; there is room for additional classes describing other biologically relevant localization patterns so long as they can be accurately modeled.</p></list-item></list></p>
    </sec>
    <sec id="Sec16">
      <title>RNAforest: manual annotation of true biological validation data</title>
      <p id="Par40">Using 3 individual annotators, we annotated the same 600 samples across both datasets, keeping samples with 2 or more annotator agreements as true annotations, resulting in 165 annotated seqFISH + samples and 238 annotated MERFISH samples (403 total). We used Cohen’s kappa coefficient [<xref ref-type="bibr" rid="CR78">78</xref>] to calculate agreement between pairs of annotators for each label yielding an overall coefficient of 0.602. We found that pairwise agreement between annotators across labels was fairly consistent ranging between 0.588 and 0.628, while label-specific agreement varied more, ranging between 0.45 and 0.72 (Additional File <xref rid="MOESM4" ref-type="media">4</xref>: Table S4).</p>
    </sec>
    <sec id="Sec17">
      <title>RNAforest: functional enrichment of gene pattern distributions</title>
      <p id="Par41">For enrichment of compartment-specific expression from Xia et al. [<xref ref-type="bibr" rid="CR46">46</xref>], scores are calculated by taking the weighted sum of gene pattern frequencies and published compartment log fold-change values (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). The Benjamini–Hochberg correction was used to correct <italic>p</italic>-values for multiple hypothesis testing.</p>
      <p id="Par42">For the seqFISH + dataset, we performed a single-sample Gene Set Enrichment Analysis [<xref ref-type="bibr" rid="CR79">79</xref>, <xref ref-type="bibr" rid="CR80">80</xref>] on gene pattern frequencies to compute enrichment scores (Fig. <xref rid="Fig3" ref-type="fig">3</xref>I). ssGSEA was performed with the GSEApy Python package and the “GO_Cellular_Component_2021” gene set library curated by Enrichr [<xref ref-type="bibr" rid="CR81">81</xref>]. Gene sets with a minimum size of 50 and a maximum size of 500 were analyzed.</p>
    </sec>
    <sec id="Sec18">
      <title>Colocation quotient for RNA colocalization analysis</title>
      <p id="Par43">Pairwise colocalization of genes was determined for each compartment of every cell separately. In this case, each cell was divided into compartments, cytoplasm, and nucleus. The colocation quotient (CLQ) was calculated for every pair of genes <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq2.gif"/></alternatives></inline-formula>. The CLQ is defined as an odds ratio of the observed to expected proportion of <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq3.gif"/></alternatives></inline-formula> transcripts among neighbors of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq4.gif"/></alternatives></inline-formula> for a fixed radius <italic>r</italic>; it is formulated as:<disp-formula id="Equa"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${CLQ}_{A\to B}=\frac{{C}_{A\to B}/{N}_{A}}{{N{\prime}}_{B}/(N-1)}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">CLQ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2024_3217_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par44">Here <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{C}}}_{{\varvec{A}}\to {\varvec{B}}}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq5.gif"/></alternatives></inline-formula> denotes the number of <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq6.gif"/></alternatives></inline-formula> transcripts of which <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq7.gif"/></alternatives></inline-formula> transcripts are considered a neighbor. <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{N}}}_{{\varvec{A}}}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq8.gif"/></alternatives></inline-formula> denotes the total number of <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq9.gif"/></alternatives></inline-formula> transcripts, while <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{N}}{\boldsymbol{^{\prime}}}_{{\varvec{B}}}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mrow/><mml:mrow/><mml:mo mathvariant="bold">′</mml:mo></mml:mmultiscripts></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow/></mml:mmultiscripts></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq10.gif"/></alternatives></inline-formula> stands for the total number of <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq11.gif"/></alternatives></inline-formula> transcripts. In the case that <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}={\varvec{B}}$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq12.gif"/></alternatives></inline-formula>, <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{N}}{\boldsymbol{^{\prime}}}_{{\varvec{B}}}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mrow/><mml:mrow/><mml:mo mathvariant="bold">′</mml:mo></mml:mmultiscripts></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow/></mml:mmultiscripts></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq13.gif"/></alternatives></inline-formula> equals the total number of <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq14.gif"/></alternatives></inline-formula> transcripts minus 1. <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{N}}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq15.gif"/></alternatives></inline-formula> denotes the total number of transcripts in the cell. Following statistical recommendations from the original formulation of the colocation quotient (CLQ), genes with fewer than 10 transcripts were not considered to reduce sparsity and improve testing power [<xref ref-type="bibr" rid="CR53">53</xref>].</p>
    </sec>
    <sec id="Sec19">
      <title>Tensor decomposition for compartment-specific colocalization</title>
      <p id="Par45">We begin by calculating the CLQ for every pair of genes within each compartment of every cell. We structure our data as follows:<list list-type="order"><list-item><p id="Par46">Cells set: Denote the set of cells as<inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{C}}\boldsymbol=\boldsymbol\{{{\varvec{c}}}_{1},{{\varvec{c}}}_{2},\boldsymbol...,{{\varvec{c}}}_{{\varvec{n}}}\}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">=</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">{</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo mathvariant="bold">.</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq16.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{c}}}_{{\varvec{i}}}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq17.gif"/></alternatives></inline-formula> represents the <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{i}}}^{{\varvec{t}}{\varvec{h}}}$$\end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq18.gif"/></alternatives></inline-formula> cell and <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{n}}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq19.gif"/></alternatives></inline-formula> is the total number of cells.</p></list-item><list-item><p id="Par47">Compartments set: Every cell has the same set of compartments, represented as<inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{K}}=\{{{\varvec{k}}}_{1},{{\varvec{k}}}_{2},\boldsymbol...,{{\varvec{k}}}_{{\varvec{m}}}\}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo mathvariant="bold">.</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq20.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{k}}}_{{\varvec{j}}}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq21.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{j}}}^{{\varvec{t}}{\varvec{h}}}$$\end{document}</tex-math><mml:math id="M46"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq22.gif"/></alternatives></inline-formula> compartment within a cell.</p></list-item><list-item><p id="Par48">Gene pairs set: The gene pairs are represented by <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{G}}=\{{{\varvec{g}}}_{1},{{\varvec{g}}}_{2},\boldsymbol...,\boldsymbol{{\varvec{g}}}_{{\varvec{p}}}\}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo mathvariant="bold">.</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq23.gif"/></alternatives></inline-formula> where <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{g}}}_{{\varvec{p}}}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq24.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{p}}}^{{\varvec{t}}{\varvec{h}}}$$\end{document}</tex-math><mml:math id="M52"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq25.gif"/></alternatives></inline-formula> gene pair.</p></list-item></list></p>
      <p id="Par49">By computing the CLQ for every combination of cells in <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{C}}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq26.gif"/></alternatives></inline-formula>, compartments in <inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{K}}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq27.gif"/></alternatives></inline-formula>, and gene pairs in <inline-formula id="IEq28"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{G}}$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq28.gif"/></alternatives></inline-formula>, we populate a three-dimensional tensor <inline-formula id="IEq29"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq29.gif"/></alternatives></inline-formula> with dimensions corresponding to these sets.</p>
      <p id="Par50">We then apply non-negative parallel factor analysis (PARAFAC) as implemented in Tensorly [<xref ref-type="bibr" rid="CR31">31</xref>] to reduce the dimensionality of our dataset and capture the underlying patterns. For tensor decomposition, we employed non-negative parallel factor analysis as implemented in Tensorly [<xref ref-type="bibr" rid="CR31">31</xref>]. The tensor <inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq30.gif"/></alternatives></inline-formula> is decomposed into the sum of <inline-formula id="IEq31"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{R}}$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq31.gif"/></alternatives></inline-formula> factors; each factor is a three-dimensional tensor expressed as the outer product of three vectors: <inline-formula id="IEq32"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{x}}}_{{\varvec{r}}}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq32.gif"/></alternatives></inline-formula> (compartment loadings), <inline-formula id="IEq33"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{y}}}_{{\varvec{r}}}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq33.gif"/></alternatives></inline-formula> (cell loadings), and <inline-formula id="IEq34"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{z}}}_{{\varvec{r}}}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq34.gif"/></alternatives></inline-formula> (gene pair loadings). This is denoted as follows:<disp-formula id="Equb"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\widehat{X}}_{R}}={\sum }_{r=1}^{R}{x}_{r}\otimes {y}_{r}\otimes {z}_{r}$$\end{document}</tex-math><mml:math id="M72" display="block"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2024_3217_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par51">The optimal rank-<inline-formula id="IEq35"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{R}}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq35.gif"/></alternatives></inline-formula> decomposition of <inline-formula id="IEq36"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq36.gif"/></alternatives></inline-formula> is determined by minimizing the error between <inline-formula id="IEq37"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq37.gif"/></alternatives></inline-formula> and the reconstructed tensor <inline-formula id="IEq38"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{X}}}$$\end{document}</tex-math><mml:math id="M80"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq38.gif"/></alternatives></inline-formula>. We use the elbow function heuristic to select the best-fit rank from a range of 2–12 factors. This approach seeks to balance the complexity of the model against the fidelity of reconstruction. Missing values in <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq39.gif"/></alternatives></inline-formula> are ignored when calculating the loss.</p>
    </sec>
    <sec id="Sec20">
      <title>RNAflux: unsupervised spatial embedding and subcellular domain quantization</title>
      <p id="Par52">To generate RNAflux embeddings, first, a set of query coordinates are generated tiling across the cell area on a uniform grid. This effectively downsamples the original data units (pixels) resulting in much fewer samples to compute embeddings. Let <inline-formula id="IEq40"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q = \{{q}_{1},{q}_{2},...,{q}_{n}\}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq40.gif"/></alternatives></inline-formula> be the set of query coordinates and <inline-formula id="IEq41"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${q}_{i}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq41.gif"/></alternatives></inline-formula> denote the <inline-formula id="IEq42"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}^{th}$$\end{document}</tex-math><mml:math id="M88"><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq42.gif"/></alternatives></inline-formula> query coordinate. For the MERFISH U2-OS dataset, a step size of 10 data units (pixels) was used to generate the uniform grid. For the iPSC-derived cardiomyocytes, a step size of 5 data units was used. Each query point is assigned an expression vector, counting the abundance of each gene within a fixed radius of 40 and 50 data units respectively. Each expression vector is normalized to sum to one, converting the expression vector to a composition vector, denoted as <inline-formula id="IEq43"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq43.gif"/></alternatives></inline-formula>. Similarly, the cell composition vector <inline-formula id="IEq44"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq44.gif"/></alternatives></inline-formula> for the <inline-formula id="IEq45"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j}^{th}$$\end{document}</tex-math><mml:math id="M94"><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq45.gif"/></alternatives></inline-formula> cell is calculated by normalizing the total cell expression to sum to one. The RNAflux embedding <inline-formula id="IEq46"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq46.gif"/></alternatives></inline-formula> at query coordinate <inline-formula id="IEq47"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${q}_{i}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq47.gif"/></alternatives></inline-formula> is defined as the difference between the <inline-formula id="IEq48"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq49.gif"/></alternatives></inline-formula> divided by <inline-formula id="IEq50"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{v}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>σ</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq50.gif"/></alternatives></inline-formula>, the vector of standard deviation of composition vectors <inline-formula id="IEq51"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v$$\end{document}</tex-math><mml:math id="M106"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq51.gif"/></alternatives></inline-formula>.<disp-formula id="Equc"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}=\frac{{v}_{i}-{x}_{j}}{{\sigma }_{v}}$$\end{document}</tex-math><mml:math id="M108" display="block"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2024_3217_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par53">The RNAflux embedding serves as an interpretable spatial gene embedding that quantifies highly local fluctuations in gene composition. Dimensional reduction of the embeddings is performed using truncated singular value decomposition (SVD). Truncated SVD was chosen over PCA to better handle large but sparse data. Embeddings were reduced to the top 10 components. To assign domains, self-organizing maps (SOM) as implemented in MiniSom [<xref ref-type="bibr" rid="CR82">82</xref>] were used for low-rank quantization of query embeddings. In an analysis of the MERFISH dataset, SOMs of size 1 × <italic>k</italic> were fit across a range of 2 to 12; the best model was determined using the elbow method heuristic to evaluate quantization error. Similarly, domains were determined for the cardiomyocyte spatial transcriptomics data by fitting the vehicle and treatment samples separately, for <italic>k</italic> across a range of 2 to 8. The elbow method heuristic determined an optimal <italic>k</italic> of 6; subsequently, a <italic>k</italic> of 4 was used for further analysis for ease of interpretation.</p>
    </sec>
    <sec id="Sec21">
      <title>RNAflux: visualizing spatial embeddings</title>
      <p id="Par54">The top 3 principal components of the RNAflux embeddings are transformed to map red, green, and blue values respectively. Embeddings are first quantile normalized and scaled to a minimum of 0.1 and 0.9 to avoid mapping extreme quantiles to white and black. These values are then used for red, green, and blue color channels. To map the downsampled grid back to the original data units, linear interpolation was used to rescale the computed color values and fill the space between the uniform grid points.</p>
    </sec>
    <sec id="Sec22">
      <title>RNAflux: enrichment of locale-specific transcriptomes derived by APEX-seq</title>
      <p id="Par55">The enrichment score for each pixel is calculated by first taking the weighted sum of its RNAflux embedding and locale-specific log fold-change values as implemented by the decoupler tool [<xref ref-type="bibr" rid="CR83">83</xref>]. Scores for pixels within a given cell are normalized against a null distribution constructed via random permutations of the input embeddings, to produce <italic>z</italic>-scaled enrichment scores. Fluxmap domain enrichment scores are simply obtained by taking the mean score of all pixels within the boundary of each domain. Fluxmap domain overlaps are computed by counting the fraction of pixels within the boundary of each domain with a positive enrichment score.</p>
    </sec>
    <sec id="Sec23">
      <title>MERFISH of U2-OS cells</title>
      <p id="Par56"><italic>MERFISH sample preparation.</italic> MERFISH measurements of 130 genes with five non-targeting blank controls were done as previously described, using the published encoding [<xref ref-type="bibr" rid="CR44">44</xref>] and readout probes [<xref ref-type="bibr" rid="CR84">84</xref>]. Briefly, U2-OS cells were cultured on 40 mm #1.5 coverslips that are silanized and poly-L-lysine coated [<xref ref-type="bibr" rid="CR44">44</xref>] and subsequently fixed in 4% (vol/vol) paraformaldehyde in 1 × PBS for 15 min at room temperature. Cells were then permeabilized in 0.5% Triton X-100 for 10 min at room temperature and washed in 1 × PBS containing Murine RNase Inhibitor (NEB M0314S). Cells were preincubated with hybridization wash buffer (30% (vol/vol) formamide in 2 × SSC) for 10 min at room temperature with gentle shaking. After preincubation, the coverslip was moved to a fresh 60-mm petri dish and residual hybridization wash buffer was removed with a Kimwipe lab tissue. In the new dish, 50 uL of encoding probe hybridization buffer (2 × SSC, 30% (vol/vol) formamide, 10% (wt/vol) dextran sulfate, 1 mg ml<sup>−1</sup> yeast tRNA, and a total concentration of 5 uM encoding probes and 1 μM of anchor probe: a 15-nt sequence of alternating dT and thymidine-locked nucleic acid (dT +) with a 5′-acrydite modification (Integrated DNA Technologies). The sample was placed in a humidified 37 °C oven for 36 to 48 h, then washed with 30% (vol/vol) formamide in 2 × SSC for 20 min at 37 °C, 20 min at room temperature. Samples were post-fixed with 4% (vol/vol) paraformaldehyde in 2 × SSC and washed with 2 × SSC with murine RNase inhibitor for 5 min. The samples were finally stained with an Alexa 488-conjugated anchor probe-readout oligo (Integrated DNA Technologies) and DAPI solution at 1 μg/ml.</p>
      <sec id="Sec24">
        <title>MERFISH imaging</title>
        <p id="Par57">MERFISH measurements were conducted on a home-built system as described in Huang et al. [<xref ref-type="bibr" rid="CR84">84</xref>].</p>
      </sec>
      <sec id="Sec25">
        <title>MERFISH spot detection</title>
        <p id="Par58">Individual RNA molecules were decoded in MERFISH images using MERlin v0.1.6 [<xref ref-type="bibr" rid="CR85">85</xref>]. Images were aligned across hybridization rounds by maximizing phase cross-correlation on the fiducial bead channel to adjust for drift in the position of the stage from round to round. Background was reduced by applying a high-pass filter and decoding was then performed per-pixel. For each pixel, a vector was constructed of the 16 brightness values from each of the 16 rounds of imaging. These vectors were then L2 normalized and their Euclidean distances to each of the L2 normalized barcodes from the MERFISH codebook were calculated. Pixels were assigned to the gene whose barcode they were closest to, unless the closest distance was greater than 0.512, in which case the pixel was not assigned a gene. Adjacent pixels assigned to the same gene were combined into a single RNA molecule. Molecules were filtered to remove potential false positives by comparing the mean brightness, pixel size, and distance to the closest barcode of molecules assigned to blank barcodes to those assigned to genes to achieve an estimated misidentification rate of 5%. The exact position of each molecule was calculated as the median position of all pixels consisting of the molecule.</p>
      </sec>
      <sec id="Sec26">
        <title>MERFISH image segmentation</title>
        <p id="Par59">Cellpose v1.0.2 [<xref ref-type="bibr" rid="CR70">70</xref>] was used to perform image segmentation to determine the boundaries of cells and nuclei. The nuclei boundaries were determined by running Cellpose with the “nuclei” model using default parameters on the DAPI stain channel of the pre-hybridization images. Cytoplasm boundaries were segmented with the “cyto” model and default parameters using the polyT stain channel. RNA molecules identified by MERlin were assigned to cells and nuclei by applying these segmentation masks to the positions of the molecules.</p>
      </sec>
    </sec>
    <sec id="Sec27">
      <title>iPSC cardiac differentiation and doxorubicin treatment</title>
      <p id="Par60">Matrigel (Corning, cat # 354,277)-coated plates were used to culture iPSCs with mTESR Plus human iPSC medium (StemCell Technologies, cat # 100–0276) in a humidified incubator at 37 °C with 5% CO<sub>2</sub>. iPSCs were dissociated with Gentle Cell Dissociation Reagent (StemCell Technologies, cat # 100–0485) and passaged with mTESR Plus medium and 10uM ROCK inhibitor (Tocris, cat #1254) at a ratio of 1:12. mTESR plus medium was replaced every other day until the cells reached 80% confluency for maintenance and replating, or 90% confluency for cardiac differentiation utilizing a chemically defined protocol [<xref ref-type="bibr" rid="CR86">86</xref>]. On day 0 of cardiac differentiation, cells were treated with 6 μM CHIR99021 (Selleck Chem, cat # S1263) in RPMI 1640 media (Gibco, cat # 11,875) and B27 minus insulin supplement (Thermo Fisher, cat # A1895601). On day 2, CHIR was removed, and cells were cultured with RPMI 1640 media and B27 minus insulin supplement (Thermo Fisher, cat # A18956). On day 3, media was replaced with RPMI media containing B27 minus insulin supplement and 5 μM Wnt-C59 (Cellagen Technologies, cat # C7641-2 s). On days 5, 7, and 9, media was replaced with RPMI media containing B27 insulin supplement (Thermo Fisher, cat # 17,504). On days 11 and 13, media was replaced with RPMI 1640 media without glucose (Thermo Fisher, cat # 11,879,020) containing B27 insulin supplement for purification of cardiomyocytes. From days 15 onward, the cells were cultured in RPMI 1640 media containing B27 supplement which was changed every other day until the cells reached day 30 for replating. For replating, cells were incubated in 10 × TrypLE (Thermo Fisher, cat # A1217701) for 12 min at 37 °C, neutralized with equal volumes of RPMI 1640 media containing B27 supplement with 20% FBS (Gibco, cat # 26,140–079), gently dissociated by pipetting, then spun down and resuspended for replating in RPMI 1640 media containing B27 supplement with 20% FBS. The next day, the cell media was replaced with RPMI 1640 media containing B27 supplement which was replaced with fresh media every other day. On day 48, the cells were replated onto chamber slides (Ibidi, cat # 80,826) as described above and recovered for 10 days before doxorubicin treatments began (MedChemExpress, cat # HY-15142). On day 60, doxorubicin treatments concluded, and the cells underwent methanol fixation.</p>
    </sec>
    <sec id="Sec28">
      <title>Molecular<italic> cartography</italic></title>
      <sec id="Sec29">
        <title>Cultured cell processing</title>
        <p id="Par61">After doxorubicin treatment, cardiomyocytes were washed with PBS (1 ×) twice and fixed in methanol (− 20 °C) for 10 min. After fixation, Methanol was aspirated and cells were dried and stored at − 80 °C until use. The samples were used for Molecular Cartography™ (100-plex combinatorial single-molecule fluorescence in-situ hybridization) according to the manufacturer’s instructions <italic>Day 1: Molecular Preparation Protocol</italic> for cells, starting with the addition of buffer DST1 followed by cell priming and hybridization. Briefly, cells were primed for 30 min at 37 °C followed by overnight hybridization of all probes specific for the target genes (see below for probe design details and target list). Samples were washed the next day to remove excess probes and fluorescently tagged in a two-step color development process. Regions of interest were imaged as described below and fluorescent signals removed during decolorization. Color development, imaging, and decolorization were repeated for multiple cycles to build a unique combinatorial code for every target gene that was derived from raw images as described below.</p>
      </sec>
      <sec id="Sec30">
        <title>Probe design</title>
        <p id="Par62">The probes for 100 genes were designed using Resolve’s proprietary design algorithm. Briefly, the probe design was performed at the gene level. For every targeted gene, all full-length protein-coding transcript sequences from the ENSEMBL database were used as design targets if the isoform had the GENCODE annotation tag “basic” [<xref ref-type="bibr" rid="CR87">87</xref>, <xref ref-type="bibr" rid="CR88">88</xref>]. To speed up the process, the calculation of computationally expensive parts, especially the off-target searches, the selection of probe sequences was not performed randomly, but limited to sequences with high success rates. To filter highly repetitive regions, the abundance of k-mers was obtained from the background transcriptome using Jellyfish [<xref ref-type="bibr" rid="CR89">89</xref>]. Every target sequence was scanned once for all k-mers, and those regions with rare k-mers were preferred as seeds for full probe design. A probe candidate was generated by extending a seed sequence until a certain target stability was reached. A set of simple rules was applied to discard sequences that were found experimentally to cause problems. After these fast screens, the remaining probe candidates were mapped to the background transcriptome using ThermonucleotideBLAST [<xref ref-type="bibr" rid="CR90">90</xref>] and probes with stable off-target hits were discarded. Specific probes were then scored based on the number of on-target matches (isoforms), which were weighted by their associated APPRIS level [<xref ref-type="bibr" rid="CR91">91</xref>], favoring principal isoforms over others. A bonus was added if the binding site was inside the protein-coding region. From the pool of accepted probes, the final set was composed by picking the highest-scoring probes. Probes with catalog numbers can be found in Additional File <xref rid="MOESM3" ref-type="media">3</xref>: Table S3.</p>
      </sec>
      <sec id="Sec31">
        <title>Imaging</title>
        <p id="Par63">Samples were imaged on a Zeiss Celldiscoverer 7, using the 50 × Plan Apochromat water immersion objective with an NA of 1.2 and the 0.5 × magnification changer, resulting in a 25 × final magnification. Standard CD7 LED excitation light source, filters, and dichroic mirrors were used together with customized emission filters optimized for detecting specific signals. Excitation time per image was 1000 ms for each channel (DAPI was 20 ms). A z-stack was taken at each region with a distance per z-slice according to the Nyquist-Shannon sampling theorem. The custom CD7 CMOS camera (Zeiss Axiocam Mono 712, 3.45 μm pixel size) was used. For each region, a z-stack per fluorescent color (two colors) was imaged per imaging round. A total of 8 imaging rounds were done for each position, resulting in 16 z-stacks per region. The completely automated imaging process per round was realized by a custom Python script using the scripting API of the Zeiss ZEN software (Open application development).</p>
      </sec>
      <sec id="Sec32">
        <title>Image processing and spot segmentation</title>
        <p id="Par64">As a first step, all images were corrected for background fluorescence. A target value for the allowed number of maxima was determined based on the area of the slice in μm<sup>2</sup> multiplied by the factor 0.5. This factor was empirically optimized. The brightest maxima per plane were determined, based upon an empirically optimized threshold. The number and location of the respective maxima were stored. This procedure was done for every image slice independently. Maxima that did not have a neighboring maximum in an adjacent slice (called z-group) were excluded. The resulting maxima list was further filtered in an iterative loop by adjusting the allowed thresholds for (Babs-Bback) and (Bperi-Bback) to reach a feature target value (Babs: absolute brightness, Bback: local background, Bperi: background of periphery within 1 pixel). These feature target values were based on the volume of the 3D image. Only maxima still in a group of at least 2 after filtering were passing the filter step. Each z-group was counted as one hit. The members of the z-groups with the highest absolute brightness were used as features and written to a file. They resemble a 3D-point cloud. To align the raw data images from different imaging rounds, images had to be registered. To do so, the extracted feature point clouds were used to find the transformation matrices. For this purpose, an iterative closest point cloud algorithm was used to minimize the error between two point clouds. The point clouds of each round were aligned to the point cloud of round one (reference point cloud). The corresponding point clouds were stored for downstream processes. Based upon the transformation matrices, the corresponding images were processed by a rigid transformation using trilinear interpolation. The aligned images were used to create a profile for each pixel consisting of 16 values (16 images from two color channels in 8 imaging rounds). The pixel profiles were filtered for variance from zero normalized by the total brightness of all pixels in the profile. Matched pixel profiles with the highest score were assigned as an ID to the pixel. Pixels with neighbors having the same ID were grouped. The pixel groups were filtered by group size, number of direct adjacent pixels in group, and number of dimensions with a size of two pixels. The local 3D-maxima of the groups were determined as potential final transcript locations. Maxima were filtered by the number of maxima in the raw data images where a maximum was expected. The remaining maxima were further evaluated by the fit to the corresponding code. The remaining maxima were written to the results file and considered to resemble transcripts of the corresponding gene. The ratio of signals matching to codes used in the experiment and signals matching to codes not used in the experiment were used as estimation for specificity (false positives). The algorithms for spot segmentation were written in Java and are based on the ImageJ library functionalities. Only the iterative closest point algorithm is written in C +  + based on the libpointmatcher library (<ext-link ext-link-type="uri" xlink:href="https://github.com/ethz-asl/libpointmatcher">https://github.com/ethz-asl/libpointmatcher</ext-link>).</p>
      </sec>
      <sec id="Sec33">
        <title>Image segmentation</title>
        <p id="Par65">Cellpose v1.0.2 [<xref ref-type="bibr" rid="CR70">70</xref>] was used to perform image segmentation to determine the boundaries of nuclei. The nuclei boundaries were determined by running Cellpose with the “nuclei” model using default parameters on the DAPI stain channel of the pre-hybridization images. Cytoplasm boundaries were determined with ClusterMap [<xref ref-type="bibr" rid="CR24">24</xref>] using spot coordinates.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec34">
    <title>Review history</title>
    <p id="Par66">The review history is available as Additional file <xref rid="MOESM5" ref-type="media">5</xref>.</p>
  </sec>
  <sec id="Sec35">
    <title>Peer review information</title>
    <p id="Par67">Kevin Pang was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec37">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2024_3217_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1:</bold> Supplementary Figures and Table S1. Supplementary figures and machine learning classifier feature descriptions.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2024_3217_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2:</bold><bold>Table S2.</bold> Hyperoptimization parameters and classifier architectures.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2024_3217_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3:</bold><bold>Table S3.</bold> Cardiomyocyte gene panel for Molecular Cartography experiment.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2024_3217_MOESM4_ESM.csv">
            <caption>
              <p><bold>Additional file 4:</bold><bold>Table S4.</bold> Manual annotation data for RNA localization patterns</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2024_3217_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5.</bold> Review history</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Clarence K. Mah and Noorsher Ahmed are co-first authors and contributed equally.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank members of the Yeo lab, Carter lab, Michelle Franc Ragsac, Erick Armingol, and Nate Lewis for helpful discussions and feedback on the manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p> C.K.M, N.A., and G.W.Y. conceptualized the project. C.K.M. and N.A. co-developed the software. C.K.M. and D.L. trained the classification model for subcellular localization. C.K.M., N.A., and D.L. manually annotated data for benchmarking model performance. C.K.M., N.A., and G.P. performed data preprocessing and analysis. A.M., C.K., Y.H., and Q.Z. generated the MERFISH experiment. N.L. designed the gene panel and cultured the cardiomyocytes. A.C. and E.L. aided multimodal spatial analyses. C.K.M., N.A., H.C., and G.W.Y. wrote the manuscript. H.C. and G.W.Y. supervised the project.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>C.K.M. is supported by the National Science Foundation Graduate Research Fellowship under Grant No. (DGE-2038238). N.A. was partially supported by NIH Training Grant T32 GM008666. This work was partially supported by National Institutes of Health grants NS103172, MH107367, AI132122, AI123202, AG069098, HG004659, and HG009889 to G.W.Y. G.W.Y. is also supported by an Allen Distinguished Investigator Award, a Paul G. Allen Frontiers Group advised grant of the Paul G. Allen Family Foundation. A.J.C. and E.L. acknowledge support from the Chan Zuckerberg Initiative (CZF2019-002448) and the Knut and Alice Wallenberg Foundation (KAW 2021.0346) to E.L.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets (seqFISH + , MERFISH, and Molecular Cartography datasets) supporting the conclusions of this article are available in the Figshare repository, 10.6084/m9.figshare.c.6564043.v1  [<xref ref-type="bibr" rid="CR92">92</xref>], and are also accessible through the Bento Python package.</p>
    <p>The source code for Bento is available on the GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-tools">https://github.com/ckmah/bento-tools</ext-link> [<xref ref-type="bibr" rid="CR93">93</xref>]. Analysis code for generating figures can be found at   <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-manuscript">https://github.com/ckmah/bento-manuscript</ext-link> [<xref ref-type="bibr" rid="CR94">94</xref>] and is archived at 10.5281/zenodo.10815484 [<xref ref-type="bibr" rid="CR95">95</xref>]. Documentation for Bento can be found here: <ext-link ext-link-type="uri" xlink:href="http://bento-tools.readthedocs.io">http://bento-tools.readthedocs.io</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par68">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par69">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par70">G.W.Y. is a co-founder, member of the board of directors, equity holder, and paid consultant for Locanabio (until 12/31/2023) and Eclipse Bioinnovations, and a Scientific Adviser and paid consultant to Jumpcode Genomics. G.W.Y. is a Distinguished Visiting Professor at the National University of Singapore. The terms of these arrangements have been reviewed and approved by the University of California, San Diego, in accordance with its conflict-of-interest policies. The authors declare no other competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Thul PJ, Åkesson L, Wiking M, Mahdessian D, Geladaki A, Ait Blal H, et al. A subcellular map of the human proteome. Science. 2017;356. Available from: 10.1126/science.aal3321.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <citation-alternatives>
        <element-citation id="ec-CR2" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Laurila</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Vihinen</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Prediction of disease-related mutations affecting protein localization</article-title>
          <source>BMC Genomics</source>
          <year>2009</year>
          <volume>10</volume>
          <fpage>122</fpage>
          <?supplied-pmid 19309509?>
          <pub-id pub-id-type="pmid">19309509</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR2" publication-type="journal">Laurila K, Vihinen M. Prediction of disease-related mutations affecting protein localization. BMC Genomics. 2009;10:122.<pub-id pub-id-type="pmid">19309509</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <citation-alternatives>
        <element-citation id="ec-CR3" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Park</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Yang</surname>
              <given-names>J-S</given-names>
            </name>
            <name>
              <surname>Shin</surname>
              <given-names>Y-E</given-names>
            </name>
            <name>
              <surname>Park</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Jang</surname>
              <given-names>SK</given-names>
            </name>
            <name>
              <surname>Kim</surname>
              <given-names>S</given-names>
            </name>
          </person-group>
          <article-title>Protein localization as a principal feature of the etiology and comorbidity of genetic diseases</article-title>
          <source>Mol Syst Biol</source>
          <year>2011</year>
          <volume>7</volume>
          <fpage>494</fpage>
          <?supplied-pmid 21613983?>
          <pub-id pub-id-type="pmid">21613983</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR3" publication-type="journal">Park S, Yang J-S, Shin Y-E, Park J, Jang SK, Kim S. Protein localization as a principal feature of the etiology and comorbidity of genetic diseases. Mol Syst Biol. 2011;7:494.<pub-id pub-id-type="pmid">21613983</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <citation-alternatives>
        <element-citation id="ec-CR4" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Chin</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Lécuyer</surname>
              <given-names>E</given-names>
            </name>
          </person-group>
          <article-title>RNA localization: Making its way to the center stage</article-title>
          <source>Biochim Biophys Acta Gen Subj</source>
          <year>2017</year>
          <volume>1861</volume>
          <fpage>2956</fpage>
          <lpage>2970</lpage>
          <?supplied-pmid 28630007?>
          <pub-id pub-id-type="pmid">28630007</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR4" publication-type="journal">Chin A, Lécuyer E. RNA localization: Making its way to the center stage. Biochim Biophys Acta Gen Subj. 2017;1861:2956–70.<pub-id pub-id-type="pmid">28630007</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Bovaird S, Patel D, Padilla J-CA, Lécuyer E. Biological functions, regulatory mechanisms, and disease relevance of RNA localization pathways. FEBS Lett. 2018;592:2948–72.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <citation-alternatives>
        <element-citation id="ec-CR6" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Das</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Singer</surname>
              <given-names>RH</given-names>
            </name>
            <name>
              <surname>Yoon</surname>
              <given-names>YJ</given-names>
            </name>
          </person-group>
          <article-title>The travels of mRNAs in neurons: do they know where they are going?</article-title>
          <source>Curr Opin Neurobiol</source>
          <year>2019</year>
          <volume>57</volume>
          <fpage>110</fpage>
          <lpage>116</lpage>
          <?supplied-pmid 30784978?>
          <pub-id pub-id-type="pmid">30784978</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR6" publication-type="journal">Das S, Singer RH, Yoon YJ. The travels of mRNAs in neurons: do they know where they are going? Curr Opin Neurobiol. 2019;57:110–6.<pub-id pub-id-type="pmid">30784978</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Sahoo PK, Smith DS, Perrone-Bizzozero N, Twiss JL. Axonal mRNA transport and translation at a glance. J Cell Sci. 2018;131. Available from: 10.1242/jcs.196808.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">von Kügelgen N, Chekulaeva M. Conservation of a core neurite transcriptome across neuronal types and species. Wiley Interdiscip Rev RNA. 2020;e1590.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <citation-alternatives>
        <element-citation id="ec-CR9" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Culver</surname>
              <given-names>BP</given-names>
            </name>
            <name>
              <surname>DeClercq</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Dolgalev</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Yu</surname>
              <given-names>MS</given-names>
            </name>
            <name>
              <surname>Ma</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Heguy</surname>
              <given-names>A</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Huntington’s disease protein huntingtin associates with its own mRNA</article-title>
          <source>J Huntingtons Dis</source>
          <year>2016</year>
          <volume>5</volume>
          <fpage>39</fpage>
          <lpage>51</lpage>
          <?supplied-pmid 26891106?>
          <pub-id pub-id-type="pmid">26891106</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR9" publication-type="journal">Culver BP, DeClercq J, Dolgalev I, Yu MS, Ma B, Heguy A, et al. Huntington’s disease protein huntingtin associates with its own mRNA. J Huntingtons Dis. 2016;5:39–51.<pub-id pub-id-type="pmid">26891106</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <citation-alternatives>
        <element-citation id="ec-CR10" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Romo</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Mohn</surname>
              <given-names>ES</given-names>
            </name>
            <name>
              <surname>Aronin</surname>
              <given-names>N</given-names>
            </name>
          </person-group>
          <article-title>A fresh look at huntingtin mRNA processing in Huntington’s disease</article-title>
          <source>J Huntingtons Dis</source>
          <year>2018</year>
          <volume>7</volume>
          <fpage>101</fpage>
          <lpage>108</lpage>
          <?supplied-pmid 29865084?>
          <pub-id pub-id-type="pmid">29865084</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR10" publication-type="journal">Romo L, Mohn ES, Aronin N. A fresh look at huntingtin mRNA processing in Huntington’s disease. J Huntingtons Dis. 2018;7:101–8.<pub-id pub-id-type="pmid">29865084</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <citation-alternatives>
        <element-citation id="ec-CR11" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>White</surname>
              <given-names>JA</given-names>
              <suffix>2nd</suffix>
            </name>
            <name>
              <surname>Anderson</surname>
              <given-names>E</given-names>
            </name>
            <name>
              <surname>Zimmerman</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Zheng</surname>
              <given-names>KH</given-names>
            </name>
            <name>
              <surname>Rouhani</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Gunawardena</surname>
              <given-names>S</given-names>
            </name>
          </person-group>
          <article-title>Huntingtin differentially regulates the axonal transport of a sub-set of Rab-containing vesicles in vivo</article-title>
          <source>Hum Mol Genet</source>
          <year>2015</year>
          <volume>24</volume>
          <fpage>7182</fpage>
          <lpage>7195</lpage>
          <?supplied-pmid 26450517?>
          <pub-id pub-id-type="pmid">26450517</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR11" publication-type="journal">White JA 2nd, Anderson E, Zimmerman K, Zheng KH, Rouhani R, Gunawardena S. Huntingtin differentially regulates the axonal transport of a sub-set of Rab-containing vesicles in vivo. Hum Mol Genet. 2015;24:7182–95.<pub-id pub-id-type="pmid">26450517</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Fernandopulle MS, Lippincott-Schwartz J, Ward ME. RNA transport and local translation in neurodevelopmental and neurodegenerative disease. Nat Neurosci. 2021; Available from: 10.1038/s41593-020-00785-2.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Chen KH, Boettiger AN, Moffitt JR, Wang S, Zhuang X. RNA imaging. Spatially resolved, highly multiplexed RNA profiling in single cells. Science. 2015;348:aaa6090.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Eng C-HL, Lawson M, Zhu Q, Dries R, Koulena N, Takei Y, et al. Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH. Nature. 2019;568:235–9.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Gyllborg D, Langseth CM, Qian X, Choi E, Salas SM, Hilscher MM, et al. Hybridization-based in situ sequencing (HybISS) for spatially resolved transcriptomics in human and mouse brain tissue. Nucleic Acids Res. 2020; Available from: 10.1093/nar/gkaa792.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Alon S, Goodwin DR, Sinha A, Wassie AT, Chen F, Daugharthy ER, et al. Expansion sequencing: spatially precise in situ transcriptomics in intact biological systems. Cold Spring Harbor Laboratory. 2020 [cited 2020 Nov 20]. p. 2020.05.13.094268. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.05.13.094268v1">https://www.biorxiv.org/content/10.1101/2020.05.13.094268v1</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Palla G, Spitzer H, Klein M, Fischer D, Schaar AC, Kuemmerle LB, et al. Squidpy: a scalable framework for spatial omics analysis. Nat Methods. 2022; Available from: 10.1038/s41592-021-01358-2.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Pham D, Tan X, Xu J, Grice LF, Lam PY, Raghubar A, et al. stLearn: integrating spatial location, tissue morphology and gene expression to find cell types, cell-cell interactions and spatial trajectories within undissociated tissues. bioRxiv. 2020 [cited 2022 Jun 8]. p. 2020.05.31.125658. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/biorxiv/early/2020/05/31/2020.05.31.125658">https://www.biorxiv.org/content/biorxiv/early/2020/05/31/2020.05.31.125658</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Dries R, Zhu Q, Dong R, Eng C-HL, Li H, Liu K, et al. Giotto: a toolbox for integrative analysis and visualization of spatial expression data. Genome Biol. 2021;22:78.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <citation-alternatives>
        <element-citation id="ec-CR20" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Butler</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Hoffman</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Smibert</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Papalexi</surname>
              <given-names>E</given-names>
            </name>
            <name>
              <surname>Satija</surname>
              <given-names>R</given-names>
            </name>
          </person-group>
          <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
          <source>Nat Biotechnol</source>
          <year>2018</year>
          <volume>36</volume>
          <fpage>411</fpage>
          <lpage>420</lpage>
          <?supplied-pmid 29608179?>
          <pub-id pub-id-type="pmid">29608179</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR20" publication-type="journal">Butler A, Hoffman P, Smibert P, Papalexi E, Satija R. Integrating single-cell transcriptomic data across different conditions, technologies, and species. Nat Biotechnol. 2018;36:411–20.<pub-id pub-id-type="pmid">29608179</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <citation-alternatives>
        <element-citation id="ec-CR21" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Wolf</surname>
              <given-names>FA</given-names>
            </name>
            <name>
              <surname>Angerer</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Theis</surname>
              <given-names>FJ</given-names>
            </name>
          </person-group>
          <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
          <source>Genome Biol</source>
          <year>2018</year>
          <volume>19</volume>
          <fpage>15</fpage>
          <lpage>15</lpage>
          <?supplied-pmid 29409532?>
          <pub-id pub-id-type="pmid">29409532</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR21" publication-type="journal">Wolf FA, Angerer P, Theis FJ. SCANPY: large-scale single-cell gene expression data analysis. Genome Biol. 2018;19:15–15.<pub-id pub-id-type="pmid">29409532</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <citation-alternatives>
        <element-citation id="ec-CR22" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Imbert</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Ouyang</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Safieddine</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Coleno</surname>
              <given-names>E</given-names>
            </name>
            <name>
              <surname>Zimmer</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Bertrand</surname>
              <given-names>E</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>FISH-quant v2: a scalable and modular tool for smFISH image analysis</article-title>
          <source>RNA</source>
          <year>2022</year>
          <volume>28</volume>
          <fpage>786</fpage>
          <lpage>795</lpage>
          <?supplied-pmid 35347070?>
          <pub-id pub-id-type="pmid">35347070</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR22" publication-type="journal">Imbert A, Ouyang W, Safieddine A, Coleno E, Zimmer C, Bertrand E, et al. FISH-quant v2: a scalable and modular tool for smFISH image analysis. RNA. 2022;28:786–95.<pub-id pub-id-type="pmid">35347070</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Walter FC, Stegle O, Velten B. FISHFactor: A probabilistic factor model for spatial transcriptomics data with subcellular resolution. bioRxiv. 2021. Available from: 10.1101/2021.11.04.467354.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <citation-alternatives>
        <element-citation id="ec-CR24" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>He</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Tang</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Huang</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Ren</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Zhou</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>K</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>ClusterMap for multi-scale clustering analysis of spatial gene expression</article-title>
          <source>Nat Commun</source>
          <year>2021</year>
          <volume>12</volume>
          <fpage>5909</fpage>
          <?supplied-pmid 34625546?>
          <pub-id pub-id-type="pmid">34625546</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR24" publication-type="journal">He Y, Tang X, Huang J, Ren J, Zhou H, Chen K, et al. ClusterMap for multi-scale clustering analysis of spatial gene expression. Nat Commun. 2021;12:5909.<pub-id pub-id-type="pmid">34625546</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <citation-alternatives>
        <element-citation id="ec-CR25" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Petukhov</surname>
              <given-names>V</given-names>
            </name>
            <name>
              <surname>Xu</surname>
              <given-names>RJ</given-names>
            </name>
            <name>
              <surname>Soldatov</surname>
              <given-names>RA</given-names>
            </name>
            <name>
              <surname>Cadinu</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Khodosevich</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Moffitt</surname>
              <given-names>JR</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Cell segmentation in imaging-based spatial transcriptomics</article-title>
          <source>Nat Biotechnol</source>
          <year>2022</year>
          <volume>40</volume>
          <fpage>345</fpage>
          <lpage>354</lpage>
          <?supplied-pmid 34650268?>
          <pub-id pub-id-type="pmid">34650268</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR25" publication-type="journal">Petukhov V, Xu RJ, Soldatov RA, Cadinu P, Khodosevich K, Moffitt JR, et al. Cell segmentation in imaging-based spatial transcriptomics. Nat Biotechnol. 2022;40:345–54.<pub-id pub-id-type="pmid">34650268</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Spitzer H, Berry S, Donoghoe M, Pelkmans L, Theis FJ. Learning consistent subcellular landmarks to quantify changes in multiplexed protein maps. bioRxiv. 2022 [cited 2022 May 11]. p. 2022.05.07.490900. Available from: https://www.biorxiv.org/content/10.1101/2022.05.07.490900v1.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Liu CC, Greenwald NF, Kong A, McCaffrey EF, Leow KX, Mrdjen D, et al. Robust phenotyping of highly multiplexed tissue imaging data using pixel-level clustering. bioRxiv. 2022 [cited 2022 Dec 22]. p. 2022.08.16.504171. Available from: https://www.biorxiv.org/content/10.1101/2022.08.16.504171v1.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Jordahl K, Van den Bossche J, Fleischmann M, McBride J, Wasserman J, Gerard J, et al. geopandas/geopandas: v0.9.0. 2021. Available from: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4569086">https://zenodo.org/record/4569086</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Gillies S, Ward B, Petersen AS. Rasterio: Geospatial raster I/O for Python programmers. URL<ext-link ext-link-type="uri" xlink:href="https://github.com/mapbox/rasterio">https://github.com/mapbox/rasterio</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <citation-alternatives>
        <element-citation id="ec-CR30" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Virtanen</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Gommers</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Oliphant</surname>
              <given-names>TE</given-names>
            </name>
            <name>
              <surname>Haberland</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Reddy</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Cournapeau</surname>
              <given-names>D</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>
          <source>Nat Methods</source>
          <year>2020</year>
          <volume>17</volume>
          <fpage>261</fpage>
          <lpage>72</lpage>
          <?supplied-pmid 32015543?>
          <pub-id pub-id-type="pmid">32015543</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR30" publication-type="journal">Virtanen P, Gommers R, Oliphant TE, Haberland M, Reddy T, Cournapeau D, et al. SciPy 1.0: fundamental algorithms for scientific computing in Python. Nat Methods. 2020;17:261–72.<pub-id pub-id-type="pmid">32015543</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <citation-alternatives>
        <element-citation id="ec-CR31" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kossaifi</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Panagakis</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Anandkumar</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Pantic</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>TensorLy: tensor learning in Python</article-title>
          <source>J Mach Learn Res</source>
          <year>2019</year>
          <volume>20</volume>
          <fpage>1</fpage>
          <lpage>6</lpage>
        </element-citation>
        <mixed-citation id="mc-CR31" publication-type="journal">Kossaifi J, Panagakis Y, Anandkumar A, Pantic M. TensorLy: tensor learning in Python. J Mach Learn Res. 2019;20:1–6.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <citation-alternatives>
        <element-citation id="ec-CR32" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Virshup</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Bredikhin</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Heumos</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Palla</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Sturm</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Gayoso</surname>
              <given-names>A</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>The scverse project provides a computational ecosystem for single-cell omics data analysis</article-title>
          <source>Nat Biotechnol</source>
          <year>2023</year>
          <volume>41</volume>
          <fpage>604</fpage>
          <lpage>606</lpage>
          <?supplied-pmid 37037904?>
          <pub-id pub-id-type="pmid">37037904</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR32" publication-type="journal">Virshup I, Bredikhin D, Heumos L, Palla G, Sturm G, Gayoso A, et al. The scverse project provides a computational ecosystem for single-cell omics data analysis. Nat Biotechnol. 2023;41:604–6.<pub-id pub-id-type="pmid">37037904</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">He S, Bhatt R, Brown C, Brown EA, Buhr DL, Chantranuvatana K, et al. High-plex multiomic analysis in FFPE at subcellular level by spatial molecular imaging. bioRxiv. 2021. Available from: http://biorxiv.org/lookup/doi/10.1101/2021.11.03.467020.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <citation-alternatives>
        <element-citation id="ec-CR34" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lee</surname>
              <given-names>JH</given-names>
            </name>
            <name>
              <surname>Daugharthy</surname>
              <given-names>ER</given-names>
            </name>
            <name>
              <surname>Scheiman</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Kalhor</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Ferrante</surname>
              <given-names>TC</given-names>
            </name>
            <name>
              <surname>Terry</surname>
              <given-names>R</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Fluorescent in situ sequencing (FISSEQ) of RNA for gene expression profiling in intact cells and tissues</article-title>
          <source>Nat Protoc</source>
          <year>2015</year>
          <volume>10</volume>
          <fpage>442</fpage>
          <lpage>458</lpage>
          <?supplied-pmid 25675209?>
          <pub-id pub-id-type="pmid">25675209</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR34" publication-type="journal">Lee JH, Daugharthy ER, Scheiman J, Kalhor R, Ferrante TC, Terry R, et al. Fluorescent in situ sequencing (FISSEQ) of RNA for gene expression profiling in intact cells and tissues. Nat Protoc. 2015;10:442–58.<pub-id pub-id-type="pmid">25675209</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Hu S, Liu S, Bian Y, Poddar M, Singh S, Cao C, et al. Dynamic control of metabolic zonation and liver repair by endothelial cell Wnt2 and Wnt9b revealed by single cell spatial transcriptomics using Molecular Cartography. bioRxiv. 2022 [cited 2022 Apr 19]. p. 2022.03.18.484868. Available from: https://www.biorxiv.org/content/10.1101/2022.03.18.484868.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Virshup I, Rybakov S, Theis FJ, Angerer P, Alexander Wolf F. anndata: annotated data. bioRxiv. 2021 [cited 2022 Apr 20]. p. 2021.12.16.473007. Available from: https://www.biorxiv.org/content/10.1101/2021.12.16.473007v1.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <citation-alternatives>
        <element-citation id="ec-CR37" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Volkova</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Russell</surname>
              <given-names>R</given-names>
              <suffix>3rd</suffix>
            </name>
          </person-group>
          <article-title>Anthracycline cardiotoxicity: prevalence, pathogenesis and treatment</article-title>
          <source>Curr Cardiol Rev</source>
          <year>2011</year>
          <volume>7</volume>
          <fpage>214</fpage>
          <lpage>220</lpage>
          <?supplied-pmid 22758622?>
          <pub-id pub-id-type="pmid">22758622</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR37" publication-type="journal">Volkova M, Russell R 3rd. Anthracycline cardiotoxicity: prevalence, pathogenesis and treatment. Curr Cardiol Rev. 2011;7:214–20.<pub-id pub-id-type="pmid">22758622</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Viola P, Jones M. Rapid object detection using a boosted cascade of simple features. Proceedings of the 2001 IEEE Computer Society Conference on Computer Vision and Pattern Recognition CVPR 2001. 2001. p. I – I.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Imbert A, Ouyang W, Safieddine A, Coleno E, Zimmer C, Bertrand E, et al. FISH-quant v2: a scalable and modular analysis tool for smFISH image analysis. bioRxiv. 2021 [cited 2022 Feb 19]. p. 2021.07.20.453024. Available from: https://www.biorxiv.org/content/10.1101/2021.07.20.453024v1.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <citation-alternatives>
        <element-citation id="ec-CR40" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Battich</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Stoeger</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Pelkmans</surname>
              <given-names>L</given-names>
            </name>
          </person-group>
          <article-title>Image-based transcriptomics in thousands of single human cells at single-molecule resolution</article-title>
          <source>Nat Methods</source>
          <year>2013</year>
          <volume>10</volume>
          <fpage>1127</fpage>
          <lpage>1133</lpage>
          <?supplied-pmid 24097269?>
          <pub-id pub-id-type="pmid">24097269</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR40" publication-type="journal">Battich N, Stoeger T, Pelkmans L. Image-based transcriptomics in thousands of single human cells at single-molecule resolution. Nat Methods. 2013;10:1127–33.<pub-id pub-id-type="pmid">24097269</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <citation-alternatives>
        <element-citation id="ec-CR41" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Stoeger</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Battich</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Herrmann</surname>
              <given-names>MD</given-names>
            </name>
            <name>
              <surname>Yakimovich</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Pelkmans</surname>
              <given-names>L</given-names>
            </name>
          </person-group>
          <article-title>Computer vision for image-based transcriptomics</article-title>
          <source>Methods</source>
          <year>2015</year>
          <volume>85</volume>
          <fpage>44</fpage>
          <lpage>53</lpage>
          <?supplied-pmid 26014038?>
          <pub-id pub-id-type="pmid">26014038</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR41" publication-type="journal">Stoeger T, Battich N, Herrmann MD, Yakimovich Y, Pelkmans L. Computer vision for image-based transcriptomics. Methods. 2015;85:44–53.<pub-id pub-id-type="pmid">26014038</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <citation-alternatives>
        <element-citation id="ec-CR42" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Samacoits</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Chouaib</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Safieddine</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Traboulsi</surname>
              <given-names>A-M</given-names>
            </name>
            <name>
              <surname>Ouyang</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Zimmer</surname>
              <given-names>C</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>A computational framework to study sub-cellular RNA localization</article-title>
          <source>Nat Commun</source>
          <year>2018</year>
          <volume>9</volume>
          <fpage>4584</fpage>
          <?supplied-pmid 30389932?>
          <pub-id pub-id-type="pmid">30389932</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR42" publication-type="journal">Samacoits A, Chouaib R, Safieddine A, Traboulsi A-M, Ouyang W, Zimmer C, et al. A computational framework to study sub-cellular RNA localization. Nat Commun. 2018;9:4584.<pub-id pub-id-type="pmid">30389932</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <citation-alternatives>
        <element-citation id="ec-CR43" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Chouaib</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Safieddine</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Pichon</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Imbert</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Kwon</surname>
              <given-names>OS</given-names>
            </name>
            <name>
              <surname>Samacoits</surname>
              <given-names>A</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>A dual protein-mRNA localization screen reveals compartmentalized translation and widespread co-translational RNA targeting</article-title>
          <source>Dev Cell</source>
          <year>2020</year>
          <volume>54</volume>
          <fpage>773</fpage>
          <lpage>91.e5</lpage>
          <?supplied-pmid 32783880?>
          <pub-id pub-id-type="pmid">32783880</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR43" publication-type="journal">Chouaib R, Safieddine A, Pichon X, Imbert A, Kwon OS, Samacoits A, et al. A dual protein-mRNA localization screen reveals compartmentalized translation and widespread co-translational RNA targeting. Dev Cell. 2020;54:773–91.e5.<pub-id pub-id-type="pmid">32783880</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <citation-alternatives>
        <element-citation id="ec-CR44" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Moffitt</surname>
              <given-names>JR</given-names>
            </name>
            <name>
              <surname>Hao</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>KH</given-names>
            </name>
            <name>
              <surname>Babcock</surname>
              <given-names>HP</given-names>
            </name>
            <name>
              <surname>Zhuang</surname>
              <given-names>X</given-names>
            </name>
          </person-group>
          <article-title>High-throughput single-cell gene-expression profiling with multiplexed error-robust fluorescence in situ hybridization</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2016</year>
          <volume>113</volume>
          <fpage>11046</fpage>
          <lpage>11051</lpage>
          <?supplied-pmid 27625426?>
          <pub-id pub-id-type="pmid">27625426</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR44" publication-type="journal">Moffitt JR, Hao J, Wang G, Chen KH, Babcock HP, Zhuang X. High-throughput single-cell gene-expression profiling with multiplexed error-robust fluorescence in situ hybridization. Proc Natl Acad Sci U S A. 2016;113:11046–51.<pub-id pub-id-type="pmid">27625426</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Kumar A, Schrader A, Boroojeny A, Asadian M, Lee J, Song Y, et al. Intracellular Spatial Transcriptomic Analysis Toolkit (InSTAnT). Research Square. 2023 [cited 2023 Jan 31]. Available from: <ext-link ext-link-type="uri" xlink:href="https://assets.researchsquare.com/files/rs-2481749/v1/f2ccb04e8b30b4bc00a8ea1e.pdf?c=1674833501">https://assets.researchsquare.com/files/rs-2481749/v1/f2ccb04e8b30b4bc00a8ea1e.pdf?c=1674833501</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <citation-alternatives>
        <element-citation id="ec-CR46" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xia</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Fan</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Emanuel</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Hao</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Zhuang</surname>
              <given-names>X</given-names>
            </name>
          </person-group>
          <article-title>Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2019</year>
          <volume>116</volume>
          <fpage>19490</fpage>
          <lpage>19499</lpage>
          <?supplied-pmid 31501331?>
          <pub-id pub-id-type="pmid">31501331</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR46" publication-type="journal">Xia C, Fan J, Emanuel G, Hao J, Zhuang X. Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression. Proc Natl Acad Sci U S A. 2019;116:19490–9.<pub-id pub-id-type="pmid">31501331</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <citation-alternatives>
        <element-citation id="ec-CR47" publication-type="journal">
          <person-group person-group-type="author">
            <collab>Gene Ontology Consortium</collab>
          </person-group>
          <article-title>The Gene Ontology resource: enriching a GOld mine</article-title>
          <source>Nucleic Acids Res</source>
          <year>2021</year>
          <volume>49</volume>
          <fpage>D325</fpage>
          <lpage>D334</lpage>
          <pub-id pub-id-type="pmid">33290552</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR47" publication-type="journal">Gene Ontology Consortium. The Gene Ontology resource: enriching a GOld mine. Nucleic Acids Res. 2021;49:D325–34.<pub-id pub-id-type="pmid">33290552</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <citation-alternatives>
        <element-citation id="ec-CR48" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xu</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Belyi</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Bojic</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Ratti</surname>
              <given-names>C</given-names>
            </name>
          </person-group>
          <article-title>How friends share urban space: an exploratory spatiotemporal analysis using mobile phone data</article-title>
          <source>Trans GIS</source>
          <year>2017</year>
          <volume>21</volume>
          <fpage>468</fpage>
          <lpage>487</lpage>
        </element-citation>
        <mixed-citation id="mc-CR48" publication-type="journal">Xu Y, Belyi A, Bojic I, Ratti C. How friends share urban space: an exploratory spatiotemporal analysis using mobile phone data. Trans GIS. 2017;21:468–87.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Zeng H, Huang J, Ren J, Wang CK, Tang Z, Zhou H, et al. Spatially resolved single-cell translatomics at molecular resolution. Science. 2023;380:eadd3067.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <citation-alternatives>
        <element-citation id="ec-CR50" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ripley</surname>
              <given-names>BD</given-names>
            </name>
          </person-group>
          <article-title>The second-order analysis of stationary point processes</article-title>
          <source>J Appl Probab</source>
          <year>1976</year>
          <volume>13</volume>
          <fpage>255</fpage>
          <lpage>266</lpage>
        </element-citation>
        <mixed-citation id="mc-CR50" publication-type="journal">Ripley BD. The second-order analysis of stationary point processes. J Appl Probab. 1976;13:255–66.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Tiefelsdorf M. Modelling spatial processes: the identification and analysis of spatial relationships in regression residuals by means of Moran’s I. Springer; 2006.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Cliff AD, Ord JK. Spatial processes: models &amp; applications. Pion; 1981.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Leslie TF, Kronenfeld BJ. The colocation quotient: a new measure of spatial association between categorical subsets of points. 协同区位商:点集分类子集间空间关联性的新度量标准: The colocation quotient. Geogr Anal. 2011;43:306–26.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Shashua A, Hazan T. Non-negative tensor factorization with applications to statistics and computer vision. Proceedings of the 22nd international conference on Machine learning. New York, NY, USA: Association for Computing Machinery; 2005. p. 792–9.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <mixed-citation publication-type="other">Gassmann R. Dynein at the kinetochore. J Cell Sci. 2023;136. Available from: 10.1242/jcs.220269.</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <citation-alternatives>
        <element-citation id="ec-CR56" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gupta</surname>
              <given-names>MN</given-names>
            </name>
            <name>
              <surname>Uversky</surname>
              <given-names>VN</given-names>
            </name>
          </person-group>
          <article-title>Moonlighting enzymes: when cellular context defines specificity</article-title>
          <source>Cell Mol Life Sci</source>
          <year>2023</year>
          <volume>80</volume>
          <fpage>130</fpage>
          <?supplied-pmid 37093283?>
          <pub-id pub-id-type="pmid">37093283</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR56" publication-type="journal">Gupta MN, Uversky VN. Moonlighting enzymes: when cellular context defines specificity. Cell Mol Life Sci. 2023;80:130.<pub-id pub-id-type="pmid">37093283</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <citation-alternatives>
        <element-citation id="ec-CR57" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gnann</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Cesnik</surname>
              <given-names>AJ</given-names>
            </name>
            <name>
              <surname>Lundberg</surname>
              <given-names>E</given-names>
            </name>
          </person-group>
          <article-title>Illuminating non-genetic cellular heterogeneity with imaging-based spatial proteomics</article-title>
          <source>Trends Cancer Res</source>
          <year>2021</year>
          <volume>7</volume>
          <fpage>278</fpage>
          <lpage>282</lpage>
        </element-citation>
        <mixed-citation id="mc-CR57" publication-type="journal">Gnann C, Cesnik AJ, Lundberg E. Illuminating non-genetic cellular heterogeneity with imaging-based spatial proteomics. Trends Cancer Res. 2021;7:278–82.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <citation-alternatives>
        <element-citation id="ec-CR58" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Fazal</surname>
              <given-names>FM</given-names>
            </name>
            <name>
              <surname>Han</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Parker</surname>
              <given-names>KR</given-names>
            </name>
            <name>
              <surname>Kaewsapsak</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Xu</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Boettiger</surname>
              <given-names>AN</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Atlas of subcellular RNA localization revealed by APEX-Seq</article-title>
          <source>Cell</source>
          <year>2019</year>
          <volume>178</volume>
          <fpage>473</fpage>
          <lpage>90.e26</lpage>
          <?supplied-pmid 31230715?>
          <pub-id pub-id-type="pmid">31230715</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR58" publication-type="journal">Fazal FM, Han S, Parker KR, Kaewsapsak P, Xu J, Boettiger AN, et al. Atlas of subcellular RNA localization revealed by APEX-Seq. Cell. 2019;178:473–90.e26.<pub-id pub-id-type="pmid">31230715</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <citation-alternatives>
        <element-citation id="ec-CR59" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Janesick</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Shelansky</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Gottscho</surname>
              <given-names>AD</given-names>
            </name>
            <name>
              <surname>Wagner</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Williams</surname>
              <given-names>SR</given-names>
            </name>
            <name>
              <surname>Rouault</surname>
              <given-names>M</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis</article-title>
          <source>Nat Commun</source>
          <year>2023</year>
          <volume>14</volume>
          <fpage>8353</fpage>
          <?supplied-pmid 38114474?>
          <pub-id pub-id-type="pmid">38114474</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR59" publication-type="journal">Janesick A, Shelansky R, Gottscho AD, Wagner F, Williams SR, Rouault M, et al. High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis. Nat Commun. 2023;14:8353.<pub-id pub-id-type="pmid">38114474</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <citation-alternatives>
        <element-citation id="ec-CR60" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Young</surname>
              <given-names>RC</given-names>
            </name>
            <name>
              <surname>Ozols</surname>
              <given-names>RF</given-names>
            </name>
            <name>
              <surname>Myers</surname>
              <given-names>CE</given-names>
            </name>
          </person-group>
          <article-title>The anthracycline antineoplastic drugs</article-title>
          <source>N Engl J Med</source>
          <year>1981</year>
          <volume>305</volume>
          <fpage>139</fpage>
          <lpage>153</lpage>
          <?supplied-pmid 7017406?>
          <pub-id pub-id-type="pmid">7017406</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR60" publication-type="journal">Young RC, Ozols RF, Myers CE. The anthracycline antineoplastic drugs. N Engl J Med. 1981;305:139–53.<pub-id pub-id-type="pmid">7017406</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <citation-alternatives>
        <element-citation id="ec-CR61" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kalyanaraman</surname>
              <given-names>B</given-names>
            </name>
          </person-group>
          <article-title>Teaching the basics of the mechanism of doxorubicin-induced cardiotoxicity: Have we been barking up the wrong tree?</article-title>
          <source>Redox Biol</source>
          <year>2020</year>
          <volume>29</volume>
          <fpage>101394</fpage>
          <?supplied-pmid 31790851?>
          <pub-id pub-id-type="pmid">31790851</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR61" publication-type="journal">Kalyanaraman B. Teaching the basics of the mechanism of doxorubicin-induced cardiotoxicity: Have we been barking up the wrong tree? Redox Biol. 2020;29: 101394.<pub-id pub-id-type="pmid">31790851</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <citation-alternatives>
        <element-citation id="ec-CR62" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sheibani</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Azizi</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Shayan</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Nezamoleslami</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Eslami</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Farjoo</surname>
              <given-names>MH</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Doxorubicin-induced cardiotoxicity: an overview on pre-clinical therapeutic approaches</article-title>
          <source>Cardiovasc Toxicol</source>
          <year>2022</year>
          <volume>22</volume>
          <fpage>292</fpage>
          <lpage>310</lpage>
          <?supplied-pmid 35061218?>
          <pub-id pub-id-type="pmid">35061218</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR62" publication-type="journal">Sheibani M, Azizi Y, Shayan M, Nezamoleslami S, Eslami F, Farjoo MH, et al. Doxorubicin-induced cardiotoxicity: an overview on pre-clinical therapeutic approaches. Cardiovasc Toxicol. 2022;22:292–310.<pub-id pub-id-type="pmid">35061218</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <citation-alternatives>
        <element-citation id="ec-CR63" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yu</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Kong</surname>
              <given-names>Q</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Lu</surname>
              <given-names>J-J</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>X</given-names>
            </name>
          </person-group>
          <article-title>Recent progress in doxorubicin-induced cardiotoxicity and protective potential of natural products</article-title>
          <source>Phytomedicine</source>
          <year>2018</year>
          <volume>40</volume>
          <fpage>125</fpage>
          <lpage>139</lpage>
          <?supplied-pmid 29496165?>
          <pub-id pub-id-type="pmid">29496165</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR63" publication-type="journal">Yu J, Wang C, Kong Q, Wu X, Lu J-J, Chen X. Recent progress in doxorubicin-induced cardiotoxicity and protective potential of natural products. Phytomedicine. 2018;40:125–39.<pub-id pub-id-type="pmid">29496165</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <citation-alternatives>
        <element-citation id="ec-CR64" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rahman</surname>
              <given-names>AM</given-names>
            </name>
            <name>
              <surname>Yusuf</surname>
              <given-names>SW</given-names>
            </name>
            <name>
              <surname>Ewer</surname>
              <given-names>MS</given-names>
            </name>
          </person-group>
          <article-title>Anthracycline-induced cardiotoxicity and the cardiac-sparing effect of liposomal formulation</article-title>
          <source>Int J Nanomedicine</source>
          <year>2007</year>
          <volume>2</volume>
          <fpage>567</fpage>
          <lpage>583</lpage>
          <?supplied-pmid 18203425?>
          <pub-id pub-id-type="pmid">18203425</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR64" publication-type="journal">Rahman AM, Yusuf SW, Ewer MS. Anthracycline-induced cardiotoxicity and the cardiac-sparing effect of liposomal formulation. Int J Nanomedicine. 2007;2:567–83.<pub-id pub-id-type="pmid">18203425</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <citation-alternatives>
        <element-citation id="ec-CR65" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xu</surname>
              <given-names>MF</given-names>
            </name>
            <name>
              <surname>Tang</surname>
              <given-names>PL</given-names>
            </name>
            <name>
              <surname>Qian</surname>
              <given-names>ZM</given-names>
            </name>
            <name>
              <surname>Ashraf</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Effects by doxorubicin on the myocardium are mediated by oxygen free radicals</article-title>
          <source>Life Sci</source>
          <year>2001</year>
          <volume>68</volume>
          <fpage>889</fpage>
          <lpage>901</lpage>
          <?supplied-pmid 11213359?>
          <pub-id pub-id-type="pmid">11213359</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR65" publication-type="journal">Xu MF, Tang PL, Qian ZM, Ashraf M. Effects by doxorubicin on the myocardium are mediated by oxygen free radicals. Life Sci. 2001;68:889–901.<pub-id pub-id-type="pmid">11213359</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <citation-alternatives>
        <element-citation id="ec-CR66" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Šimůnek</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Štěrba</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Popelová</surname>
              <given-names>O</given-names>
            </name>
            <name>
              <surname>Adamcová</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Hrdina</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Geršl</surname>
              <given-names>V</given-names>
            </name>
          </person-group>
          <article-title>Anthracycline-induced cardiotoxicity: overview of studies examining the roles of oxidative stress and free cellular iron</article-title>
          <source>Pharmacol Rep</source>
          <year>2009</year>
          <volume>61</volume>
          <fpage>154</fpage>
          <lpage>171</lpage>
          <?supplied-pmid 19307704?>
          <pub-id pub-id-type="pmid">19307704</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR66" publication-type="journal">Šimůnek T, Štěrba M, Popelová O, Adamcová M, Hrdina R, Geršl V. Anthracycline-induced cardiotoxicity: overview of studies examining the roles of oxidative stress and free cellular iron. Pharmacol Rep. 2009;61:154–71.<pub-id pub-id-type="pmid">19307704</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <citation-alternatives>
        <element-citation id="ec-CR67" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xiong</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>Y-Z</given-names>
            </name>
            <name>
              <surname>Zhang</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>Z-X</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>X-Y</given-names>
            </name>
            <name>
              <surname>Jiang</surname>
              <given-names>P</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Protective effect of berberine on acute cardiomyopathy associated with doxorubicin treatment</article-title>
          <source>Oncol Lett</source>
          <year>2018</year>
          <volume>15</volume>
          <fpage>5721</fpage>
          <lpage>5729</lpage>
          <?supplied-pmid 29552206?>
          <pub-id pub-id-type="pmid">29552206</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR67" publication-type="journal">Xiong C, Wu Y-Z, Zhang Y, Wu Z-X, Chen X-Y, Jiang P, et al. Protective effect of berberine on acute cardiomyopathy associated with doxorubicin treatment. Oncol Lett. 2018;15:5721–9.<pub-id pub-id-type="pmid">29552206</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <citation-alternatives>
        <element-citation id="ec-CR68" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Asensio-López</surname>
              <given-names>MC</given-names>
            </name>
            <name>
              <surname>Soler</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Pascual-Figal</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Fernández-Belda</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Lax</surname>
              <given-names>A</given-names>
            </name>
          </person-group>
          <article-title>Doxorubicin-induced oxidative stress: the protective effect of nicorandil on HL-1 cardiomyocytes</article-title>
          <source>PLoS ONE</source>
          <year>2017</year>
          <volume>12</volume>
          <fpage>e0172803</fpage>
          <?supplied-pmid 28245258?>
          <pub-id pub-id-type="pmid">28245258</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR68" publication-type="journal">Asensio-López MC, Soler F, Pascual-Figal D, Fernández-Belda F, Lax A. Doxorubicin-induced oxidative stress: the protective effect of nicorandil on HL-1 cardiomyocytes. PLoS ONE. 2017;12: e0172803.<pub-id pub-id-type="pmid">28245258</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <citation-alternatives>
        <element-citation id="ec-CR69" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rawat</surname>
              <given-names>PS</given-names>
            </name>
            <name>
              <surname>Jaiswal</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Khurana</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Bhatti</surname>
              <given-names>JS</given-names>
            </name>
            <name>
              <surname>Navik</surname>
              <given-names>U</given-names>
            </name>
          </person-group>
          <article-title>Doxorubicin-induced cardiotoxicity: an update on the molecular mechanism and novel therapeutic strategies for effective management</article-title>
          <source>Biomed Pharmacother</source>
          <year>2021</year>
          <volume>139</volume>
          <fpage>111708</fpage>
          <?supplied-pmid 34243633?>
          <pub-id pub-id-type="pmid">34243633</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR69" publication-type="journal">Rawat PS, Jaiswal A, Khurana A, Bhatti JS, Navik U. Doxorubicin-induced cardiotoxicity: an update on the molecular mechanism and novel therapeutic strategies for effective management. Biomed Pharmacother. 2021;139: 111708.<pub-id pub-id-type="pmid">34243633</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <citation-alternatives>
        <element-citation id="ec-CR70" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Stringer</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Michaelos</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Pachitariu</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Cellpose: a generalist algorithm for cellular segmentation</article-title>
          <source>Nat Methods</source>
          <year>2021</year>
          <volume>18</volume>
          <fpage>100</fpage>
          <lpage>106</lpage>
          <?supplied-pmid 33318659?>
          <pub-id pub-id-type="pmid">33318659</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR70" publication-type="journal">Stringer C, Wang T, Michaelos M, Pachitariu M. Cellpose: a generalist algorithm for cellular segmentation. Nat Methods. 2021;18:100–6.<pub-id pub-id-type="pmid">33318659</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <citation-alternatives>
        <element-citation id="ec-CR71" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Song</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>Q</given-names>
            </name>
          </person-group>
          <article-title>Atrial natriuretic peptide in cardiovascular biology and disease (NPPA)</article-title>
          <source>Gene</source>
          <year>2015</year>
          <volume>569</volume>
          <fpage>1</fpage>
          <lpage>6</lpage>
          <?supplied-pmid 26074089?>
          <pub-id pub-id-type="pmid">26074089</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR71" publication-type="journal">Song W, Wang H, Wu Q. Atrial natriuretic peptide in cardiovascular biology and disease (NPPA). Gene. 2015;569:1–6.<pub-id pub-id-type="pmid">26074089</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <citation-alternatives>
        <element-citation id="ec-CR72" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Man</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Barnett</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Christoffels</surname>
              <given-names>VM</given-names>
            </name>
          </person-group>
          <article-title>Structure and function of the Nppa-Nppb cluster locus during heart development and disease</article-title>
          <source>Cell Mol Life Sci</source>
          <year>2018</year>
          <volume>75</volume>
          <fpage>1435</fpage>
          <lpage>1444</lpage>
          <?supplied-pmid 29302701?>
          <pub-id pub-id-type="pmid">29302701</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR72" publication-type="journal">Man J, Barnett P, Christoffels VM. Structure and function of the Nppa-Nppb cluster locus during heart development and disease. Cell Mol Life Sci. 2018;75:1435–44.<pub-id pub-id-type="pmid">29302701</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <citation-alternatives>
        <element-citation id="ec-CR73" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lewis</surname>
              <given-names>YE</given-names>
            </name>
            <name>
              <surname>Moskovitz</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Mutlak</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Heineke</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Caspi</surname>
              <given-names>LH</given-names>
            </name>
            <name>
              <surname>Kehat</surname>
              <given-names>I</given-names>
            </name>
          </person-group>
          <article-title>Localization of transcripts, translation, and degradation for spatiotemporal sarcomere maintenance</article-title>
          <source>J Mol Cell Cardiol</source>
          <year>2018</year>
          <volume>116</volume>
          <fpage>16</fpage>
          <lpage>28</lpage>
          <?supplied-pmid 29371135?>
          <pub-id pub-id-type="pmid">29371135</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR73" publication-type="journal">Lewis YE, Moskovitz A, Mutlak M, Heineke J, Caspi LH, Kehat I. Localization of transcripts, translation, and degradation for spatiotemporal sarcomere maintenance. J Mol Cell Cardiol. 2018;116:16–28.<pub-id pub-id-type="pmid">29371135</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <mixed-citation publication-type="other">Smalec BM, Ietswaart R, Choquet K, McShane E, West ER, Churchman LS. Genome-wide quantification of RNA flow across subcellular compartments reveals determinants of the mammalian transcript life cycle. bioRxiv. 2022. p. 2022.08.21.504696. Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2022/08/21/2022.08.21.504696.abstract">http://biorxiv.org/content/early/2022/08/21/2022.08.21.504696.abstract</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <citation-alternatives>
        <element-citation id="ec-CR75" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sardão</surname>
              <given-names>VA</given-names>
            </name>
            <name>
              <surname>Oliveira</surname>
              <given-names>PJ</given-names>
            </name>
            <name>
              <surname>Holy</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Oliveira</surname>
              <given-names>CR</given-names>
            </name>
            <name>
              <surname>Wallace</surname>
              <given-names>KB</given-names>
            </name>
          </person-group>
          <article-title>Morphological alterations induced by doxorubicin on H9c2 myoblasts: nuclear, mitochondrial, and cytoskeletal targets</article-title>
          <source>Cell Biol Toxicol</source>
          <year>2009</year>
          <volume>25</volume>
          <fpage>227</fpage>
          <lpage>243</lpage>
          <?supplied-pmid 18386138?>
          <pub-id pub-id-type="pmid">18386138</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR75" publication-type="journal">Sardão VA, Oliveira PJ, Holy J, Oliveira CR, Wallace KB. Morphological alterations induced by doxorubicin on H9c2 myoblasts: nuclear, mitochondrial, and cytoskeletal targets. Cell Biol Toxicol. 2009;25:227–43.<pub-id pub-id-type="pmid">18386138</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <citation-alternatives>
        <element-citation id="ec-CR76" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Meissner</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Weissgerber</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Londoño</surname>
              <given-names>JEC</given-names>
            </name>
            <name>
              <surname>Prenen</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Link</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Ruppenthal</surname>
              <given-names>S</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Moderate calcium channel dysfunction in adult mice with inducible cardiomyocyte-specific excision of the cacnb2 gene</article-title>
          <source>J Biol Chem</source>
          <year>2011</year>
          <volume>286</volume>
          <fpage>15875</fpage>
          <lpage>15882</lpage>
          <?supplied-pmid 21357697?>
          <pub-id pub-id-type="pmid">21357697</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR76" publication-type="journal">Meissner M, Weissgerber P, Londoño JEC, Prenen J, Link S, Ruppenthal S, et al. Moderate calcium channel dysfunction in adult mice with inducible cardiomyocyte-specific excision of the cacnb2 gene. J Biol Chem. 2011;286:15875–82.<pub-id pub-id-type="pmid">21357697</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <mixed-citation publication-type="other">Hallou A, He R, Simons BD, Dumitrascu B. A computational pipeline for spatial mechano-transcriptomics. bioRxiv. 2023 [cited 2023 Aug 15]. p. 2023.08.03.551894. Available from: https://www.biorxiv.org/content/10.1101/2023.08.03.551894v1.</mixed-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <citation-alternatives>
        <element-citation id="ec-CR78" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Cohen</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>A coefficient of agreement for nominal scales</article-title>
          <source>Educ Psychol Meas</source>
          <year>1960</year>
          <volume>20</volume>
          <fpage>37</fpage>
          <lpage>46</lpage>
        </element-citation>
        <mixed-citation id="mc-CR78" publication-type="journal">Cohen J. A coefficient of agreement for nominal scales. Educ Psychol Meas. 1960;20:37–46.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <citation-alternatives>
        <element-citation id="ec-CR79" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Subramanian</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Tamayo</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Mootha</surname>
              <given-names>VK</given-names>
            </name>
            <name>
              <surname>Mukherjee</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Ebert</surname>
              <given-names>BL</given-names>
            </name>
            <name>
              <surname>Gillette</surname>
              <given-names>MA</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2005</year>
          <volume>102</volume>
          <fpage>15545</fpage>
          <lpage>15550</lpage>
          <?supplied-pmid 16199517?>
          <pub-id pub-id-type="pmid">16199517</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR79" publication-type="journal">Subramanian A, Tamayo P, Mootha VK, Mukherjee S, Ebert BL, Gillette MA, et al. Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles. Proc Natl Acad Sci U S A. 2005;102:15545–50.<pub-id pub-id-type="pmid">16199517</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <citation-alternatives>
        <element-citation id="ec-CR80" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Barbie</surname>
              <given-names>DA</given-names>
            </name>
            <name>
              <surname>Tamayo</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Boehm</surname>
              <given-names>JS</given-names>
            </name>
            <name>
              <surname>Kim</surname>
              <given-names>SY</given-names>
            </name>
            <name>
              <surname>Moody</surname>
              <given-names>SE</given-names>
            </name>
            <name>
              <surname>Dunn</surname>
              <given-names>IF</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Systematic RNA interference reveals that oncogenic KRAS-driven cancers require TBK1</article-title>
          <source>Nature</source>
          <year>2009</year>
          <volume>462</volume>
          <fpage>108</fpage>
          <lpage>112</lpage>
          <?supplied-pmid 19847166?>
          <pub-id pub-id-type="pmid">19847166</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR80" publication-type="journal">Barbie DA, Tamayo P, Boehm JS, Kim SY, Moody SE, Dunn IF, et al. Systematic RNA interference reveals that oncogenic KRAS-driven cancers require TBK1. Nature. 2009;462:108–12.<pub-id pub-id-type="pmid">19847166</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <citation-alternatives>
        <element-citation id="ec-CR81" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xie</surname>
              <given-names>Z</given-names>
            </name>
            <name>
              <surname>Bailey</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Kuleshov</surname>
              <given-names>MV</given-names>
            </name>
            <name>
              <surname>Clarke</surname>
              <given-names>DJB</given-names>
            </name>
            <name>
              <surname>Evangelista</surname>
              <given-names>JE</given-names>
            </name>
            <name>
              <surname>Jenkins</surname>
              <given-names>SL</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene set knowledge discovery with Enrichr</article-title>
          <source>Curr Protoc</source>
          <year>2021</year>
          <volume>1</volume>
          <fpage>e90</fpage>
          <?supplied-pmid 33780170?>
          <pub-id pub-id-type="pmid">33780170</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR81" publication-type="journal">Xie Z, Bailey A, Kuleshov MV, Clarke DJB, Evangelista JE, Jenkins SL, et al. Gene set knowledge discovery with Enrichr. Curr Protoc. 2021;1: e90.<pub-id pub-id-type="pmid">33780170</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <mixed-citation publication-type="other">Vettigli G. minisom: :red_circle: MiniSom is a minimalistic implementation of the Self Organizing Maps. Github; [cited 2024 Jan 17]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/JustGlowing/minisom">https://github.com/JustGlowing/minisom</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <mixed-citation publication-type="other">Badia-i-Mompel P, Vélez Santiago J, Braunger J, Geiss C, Dimitrov D, Müller-Dott S, et al. decoupleR: ensemble of computational methods to infer biological activities from omics data. Bioinformatics Advances. 2022;2:vbac016.</mixed-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <citation-alternatives>
        <element-citation id="ec-CR84" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Huang</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Zhu</surname>
              <given-names>Q</given-names>
            </name>
            <name>
              <surname>Jussila</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Han</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Bintu</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Kern</surname>
              <given-names>C</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>CTCF mediates dosage- and sequence-context-dependent transcriptional insulation by forming local chromatin domains</article-title>
          <source>Nat Genet</source>
          <year>2021</year>
          <volume>53</volume>
          <fpage>1064</fpage>
          <lpage>1074</lpage>
          <?supplied-pmid 34002095?>
          <pub-id pub-id-type="pmid">34002095</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR84" publication-type="journal">Huang H, Zhu Q, Jussila A, Han Y, Bintu B, Kern C, et al. CTCF mediates dosage- and sequence-context-dependent transcriptional insulation by forming local chromatin domains. Nat Genet. 2021;53:1064–74.<pub-id pub-id-type="pmid">34002095</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <mixed-citation publication-type="other">Emanuel G, seichhorn, Babcock H, leonardosepulveda, timblosser. ZhuangLab/MERlin: MERlin v0.1.6. 2020. Available from: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/3758540">https://zenodo.org/record/3758540</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <citation-alternatives>
        <element-citation id="ec-CR86" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lian</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Hsiao</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Wilson</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Zhu</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Hazeltine</surname>
              <given-names>LB</given-names>
            </name>
            <name>
              <surname>Azarin</surname>
              <given-names>SM</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Robust cardiomyocyte differentiation from human pluripotent stem cells via temporal modulation of canonical Wnt signaling</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2012</year>
          <volume>109</volume>
          <fpage>E1848</fpage>
          <lpage>E1857</lpage>
          <?supplied-pmid 22645348?>
          <pub-id pub-id-type="pmid">22645348</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR86" publication-type="journal">Lian X, Hsiao C, Wilson G, Zhu K, Hazeltine LB, Azarin SM, et al. Robust cardiomyocyte differentiation from human pluripotent stem cells via temporal modulation of canonical Wnt signaling. Proc Natl Acad Sci U S A. 2012;109:E1848–57.<pub-id pub-id-type="pmid">22645348</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <citation-alternatives>
        <element-citation id="ec-CR87" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Frankish</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Diekhans</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Ferreira</surname>
              <given-names>A-M</given-names>
            </name>
            <name>
              <surname>Johnson</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Jungreis</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Loveland</surname>
              <given-names>J</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>GENCODE reference annotation for the human and mouse genomes</article-title>
          <source>Nucleic Acids Res</source>
          <year>2019</year>
          <volume>47</volume>
          <fpage>D766</fpage>
          <lpage>D773</lpage>
          <?supplied-pmid 30357393?>
          <pub-id pub-id-type="pmid">30357393</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR87" publication-type="journal">Frankish A, Diekhans M, Ferreira A-M, Johnson R, Jungreis I, Loveland J, et al. GENCODE reference annotation for the human and mouse genomes. Nucleic Acids Res. 2019;47:D766–73.<pub-id pub-id-type="pmid">30357393</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <citation-alternatives>
        <element-citation id="ec-CR88" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yates</surname>
              <given-names>AD</given-names>
            </name>
            <name>
              <surname>Achuthan</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Akanni</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Allen</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Allen</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Alvarez-Jarreta</surname>
              <given-names>J</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Ensembl 2020</article-title>
          <source>Nucleic Acids Res</source>
          <year>2020</year>
          <volume>48</volume>
          <fpage>D682</fpage>
          <lpage>D688</lpage>
          <?supplied-pmid 31691826?>
          <pub-id pub-id-type="pmid">31691826</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR88" publication-type="journal">Yates AD, Achuthan P, Akanni W, Allen J, Allen J, Alvarez-Jarreta J, et al. Ensembl 2020. Nucleic Acids Res. 2020;48:D682–8.<pub-id pub-id-type="pmid">31691826</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <citation-alternatives>
        <element-citation id="ec-CR89" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Marçais</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Kingsford</surname>
              <given-names>C</given-names>
            </name>
          </person-group>
          <article-title>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</article-title>
          <source>Bioinformatics</source>
          <year>2011</year>
          <volume>27</volume>
          <fpage>764</fpage>
          <lpage>770</lpage>
          <?supplied-pmid 21217122?>
          <pub-id pub-id-type="pmid">21217122</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR89" publication-type="journal">Marçais G, Kingsford C. A fast, lock-free approach for efficient parallel counting of occurrences of k-mers. Bioinformatics. 2011;27:764–70.<pub-id pub-id-type="pmid">21217122</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <citation-alternatives>
        <element-citation id="ec-CR90" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gans</surname>
              <given-names>JD</given-names>
            </name>
            <name>
              <surname>Wolinsky</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Improved assay-dependent searching of nucleic acid sequence databases</article-title>
          <source>Nucleic Acids Res</source>
          <year>2008</year>
          <volume>36</volume>
          <fpage>e74</fpage>
          <?supplied-pmid 18515842?>
          <pub-id pub-id-type="pmid">18515842</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR90" publication-type="journal">Gans JD, Wolinsky M. Improved assay-dependent searching of nucleic acid sequence databases. Nucleic Acids Res. 2008;36: e74.<pub-id pub-id-type="pmid">18515842</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <citation-alternatives>
        <element-citation id="ec-CR91" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rodriguez</surname>
              <given-names>JM</given-names>
            </name>
            <name>
              <surname>Rodriguez-Rivas</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Di Domenico</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Vázquez</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Valencia</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Tress</surname>
              <given-names>ML</given-names>
            </name>
          </person-group>
          <article-title>APPRIS 2017: principal isoforms for multiple gene sets</article-title>
          <source>Nucleic Acids Res</source>
          <year>2018</year>
          <volume>46</volume>
          <fpage>D213</fpage>
          <lpage>D217</lpage>
          <?supplied-pmid 29069475?>
          <pub-id pub-id-type="pmid">29069475</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR91" publication-type="journal">Rodriguez JM, Rodriguez-Rivas J, Di Domenico T, Vázquez J, Valencia A, Tress ML. APPRIS 2017: principal isoforms for multiple gene sets. Nucleic Acids Res. 2018;46:D213–7.<pub-id pub-id-type="pmid">29069475</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <mixed-citation publication-type="other">Bento MC Manuscript Datasets 2023 figshare [10.6084/m9.figshare.c.6564043.v1.</mixed-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <mixed-citation publication-type="other">ckmah/bento-tools: a Python toolkit for subcellular analysis of spatial transcriptomics data. GitHub. [cited 2024 Mar 13]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-tools">https://github.com/ckmah/bento-tools</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <mixed-citation publication-type="other">Mah C. bento-manuscript: Analyses to reproduce figures in the Bento manuscript. Github; [cited 2024 Mar 13]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-manuscript">https://github.com/ckmah/bento-manuscript</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <mixed-citation publication-type="other">Mah C. Bento manuscript source code. Zenodo; 2024 [cited 2024 Mar 13]. Available from: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/10815484">https://zenodo.org/records/10815484</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11289963</article-id>
    <article-id pub-id-type="pmid">38566187</article-id>
    <article-id pub-id-type="publisher-id">3217</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-024-03217-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bento: a toolkit for subcellular analysis of spatial transcriptomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Mah</surname>
          <given-names>Clarence K.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Ahmed</surname>
          <given-names>Noorsher</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lopez</surname>
          <given-names>Nicole A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lam</surname>
          <given-names>Dylan C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pong</surname>
          <given-names>Avery</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Monell</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kern</surname>
          <given-names>Colin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Han</surname>
          <given-names>Yuanyuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Prasad</surname>
          <given-names>Gino</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cesnik</surname>
          <given-names>Anthony J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lundberg</surname>
          <given-names>Emma</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Quan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Carter</surname>
          <given-names>Hannah</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0799-6037</contrib-id>
        <name>
          <surname>Yeo</surname>
          <given-names>Gene W.</given-names>
        </name>
        <address>
          <email>geneyeo@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff10">10</xref>
        <xref ref-type="aff" rid="Aff11">11</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Division of Medical Genetics, Department of Medicine, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Department of Cellular and Molecular Medicine, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff3"><label>3</label>Sanford Stem Cell Institute Innovation Center, La Jolla, CA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Division of Biological Sciences, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Department of Bioengineering, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Center for Epigenomics, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f54p054</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8956</institution-id><institution>Department of Bioengineering, </institution><institution>Stanford University, </institution></institution-wrap>Stanford, CA USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f54p054</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8956</institution-id><institution>Department of Pathology, </institution><institution>Stanford University, </institution></institution-wrap>Stanford, CA USA </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00knt4f32</institution-id><institution-id institution-id-type="GRID">grid.499295.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 9234 0175</institution-id><institution>Chan-Zuckerberg Biohub, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Stem Cell Program, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff11"><label>11</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Institute for Genomic Medicine, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <elocation-id>82</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The spatial organization of molecules in a cell is essential for their functions. While current methods focus on discerning tissue architecture, cell–cell interactions, and spatial expression patterns, they are limited to the multicellular scale. We present Bento, a Python toolkit that takes advantage of single-molecule information to enable spatial analysis at the subcellular scale. Bento ingests molecular coordinates and segmentation boundaries to perform three analyses: defining subcellular domains, annotating localization patterns, and quantifying gene–gene colocalization. We demonstrate MERFISH, seqFISH + , Molecular Cartography, and Xenium datasets. Bento is part of the open-source Scverse ecosystem, enabling integration with other single-cell analysis tools.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-024-03217-7.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Institute of Health</institution>
        </funding-source>
        <award-id>NS103172</award-id>
        <award-id>AI132122</award-id>
        <award-id>AI123202</award-id>
        <award-id>AG069098</award-id>
        <award-id>HG004659</award-id>
        <award-id>HG009889</award-id>
        <award-id>GM008666</award-id>
        <award-id>T32GM139790</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ahmed</surname>
            <given-names>Noorsher</given-names>
          </name>
          <name>
            <surname>Pong</surname>
            <given-names>Avery</given-names>
          </name>
          <name>
            <surname>Yeo</surname>
            <given-names>Gene W.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Insitute of Health</institution>
        </funding-source>
        <award-id>MH107367</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yeo</surname>
            <given-names>Gene W.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DGE-2038238</award-id>
        <principal-award-recipient>
          <name>
            <surname>Mah</surname>
            <given-names>Clarence K.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014989</institution-id>
            <institution>Chan Zuckerberg Initiative</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CZF2019-002448</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lundberg</surname>
            <given-names>Emma</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004063</institution-id>
            <institution>Knut och Alice Wallenbergs Stiftelse</institution>
          </institution-wrap>
        </funding-source>
        <award-id>KAW 2021.0346</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lundberg</surname>
            <given-names>Emma</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">The spatial organization of molecules in a cell is essential for performing their functions. While protein localization [<xref ref-type="bibr" rid="CR1">1</xref>] and disease-associated mislocalization are well appreciated [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>], the same principles for RNA have begun to emerge. For instance, the spatial and temporal regulation of RNA play a crucial role in localized cellular processes such as cell migration and cell division [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], as well as specialized cell functionalities like synaptic plasticity [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. Mislocalization of RNA has been associated with diseases such as Huntington’s disease (HD), where defects in axonal mRNA transport and subsequent translation in human spiny neurons lead to cell death and neurodegeneration [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p id="Par3">The study of subcellular RNA localization necessitates single-molecule measurements. Since the development of single-molecule fluorescent in situ hybridization (smFISH), recent advances in multiplexed methods such as MERFISH [<xref ref-type="bibr" rid="CR13">13</xref>], seqFISH + [<xref ref-type="bibr" rid="CR14">14</xref>], HybISS [<xref ref-type="bibr" rid="CR15">15</xref>], and Ex-Seq [<xref ref-type="bibr" rid="CR16">16</xref>] have enabled RNA localization measurements at near transcriptome scales, while maintaining single-molecule resolution. A number of computational toolkits, such as Squidpy [<xref ref-type="bibr" rid="CR17">17</xref>], stLearn [<xref ref-type="bibr" rid="CR18">18</xref>], Giotto [<xref ref-type="bibr" rid="CR19">19</xref>], Seurat [<xref ref-type="bibr" rid="CR20">20</xref>], and Scanpy [<xref ref-type="bibr" rid="CR21">21</xref>] enabled the characterization of tissue architecture, cell–cell interactions, and spatial expression patterns. Despite the single-molecule measurements in spatial transcriptomics, these analytical approaches are limited to investigating spatial variation at the multicellular scale and lack the ability to investigate subcellular organization. To further our understanding of RNA localization and its function in normal and abnormal cell activity, we need to expand our analytical capacity to the subcellular scale.</p>
    <p id="Par4">Recent methods such as FISH-quant-v2 [<xref ref-type="bibr" rid="CR22">22</xref>] and FISHFactor [<xref ref-type="bibr" rid="CR23">23</xref>] identify subcellular patterns describing the spatial distribution of RNA species, but are unable to annotate more than a single gene per cell or are limited to analyze at most 20,000 molecules on accessible computing resources. In contrast, a single spatial transcriptomics experiment measures at least hundreds to thousands of genes across hundreds of thousands of cells. Additionally, methods such as ClusterMap [<xref ref-type="bibr" rid="CR24">24</xref>] and Baysor [<xref ref-type="bibr" rid="CR25">25</xref>] highlight the potential for transcript locations alone to inform meaningful domains such as cell and nuclear regions. Using spatial proteomics data, CAMPA [<xref ref-type="bibr" rid="CR26">26</xref>] and Pixie [<xref ref-type="bibr" rid="CR27">27</xref>] utilize subcellular spatial variation in protein abundance to identify subcellular regions and annotate pixel-level features.</p>
    <p id="Par5">Building on these promising approaches, we present Bento, an open-source Python toolkit for scalable analysis of spatial transcriptomics data at the subcellular resolution. Bento ingests single-molecule resolution data and segmentation masks, utilizing geospatial tools (GeoPandas [<xref ref-type="bibr" rid="CR28">28</xref>], Rasterio [<xref ref-type="bibr" rid="CR29">29</xref>]) for spatial analysis of molecular imaging data, and data science tools including SciPy [<xref ref-type="bibr" rid="CR30">30</xref>] and Tensorly [<xref ref-type="bibr" rid="CR31">31</xref>] for scalable analysis of high-dimensional feature matrices. Furthermore, Bento is a member of the Scverse ecosystem [<xref ref-type="bibr" rid="CR32">32</xref>], enabling integration with Scanpy [<xref ref-type="bibr" rid="CR21">21</xref>], Squidpy [<xref ref-type="bibr" rid="CR17">17</xref>], and more than 30 other single-cell omics analysis tools.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of Bento data infrastructure for subcellular analysis</title>
      <p id="Par6">In order to facilitate a flexible workflow, Bento is generally compatible with molecule-level resolution spatial transcriptomics data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A), such as datasets produced by MERFISH [<xref ref-type="bibr" rid="CR13">13</xref>], seqFISH + [<xref ref-type="bibr" rid="CR14">14</xref>], CosMx (NanoString) [<xref ref-type="bibr" rid="CR33">33</xref>], Xenium (10 × Genomics) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR34">34</xref>], and Molecular Cartography (Resolve Biosciences) [<xref ref-type="bibr" rid="CR35">35</xref>]. Bento’s workflow takes as input (1) 2D spatial coordinates of transcripts annotated by gene and (2) segmentation boundaries (e.g., cell membrane, nuclear membrane, and any other regions of interest) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). While 3D molecular coordinates are commonly included, 3D segmentation information is limited to z-stacked 2D segmentation, limiting its usability. If available, Bento can also handle arbitrary sets of segmentations for other subcellular structures or regions of interest. These inputs are stored in the AnnData data format [<xref ref-type="bibr" rid="CR36">36</xref>], which links cell and gene metadata to standard count matrices, providing compatibility with standard single-cell RNA-seq quality control and analysis tools in the Scverse ecosystem [<xref ref-type="bibr" rid="CR32">32</xref>]. With a data structure for segmentation boundaries and transcript coordinates in place, Bento can easily compute spatial statistics and measure spatial phenotypes to build flexible multidimensional feature sets for exploratory subcellular analysis and utilize these spatial metrics to augment quality control (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C).<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow and functionality of the Bento toolkit. <bold>A</bold> Single-molecule resolved spatial transcriptomics data from commercial or custom platforms are ingested into Bento where it is converted to the AnnData format (<bold>B</bold>), where it can be manipulated with Bento as well as a wide ecosystem of single-cell omics tools. <bold>C</bold> Geometric statistics are illustrated for the seqFISH + dataset, including metrics describing cell and nuclear geometries and cell density to assess overall data quality. <bold>D</bold> Bento has a standard interface to perform a wide variety of subcellular analyses</p></caption><graphic xlink:href="13059_2024_3217_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par7">Bento offers a precise yet flexible palette of novel complementary subcellular analyses (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). We introduce RNAforest, a multilabel approach for annotating RNA localization patterns adapted from FISH-quant v2 [<xref ref-type="bibr" rid="CR22">22</xref>]. We find that many RNAs are spatially distributed according to gene function. We then implement RNAcoloc, a context-specific approach to quantify colocalization to characterize how genes colocalize with each other in a compartment-specific manner. Having established systematic patterning and organization of RNA transcripts, we demonstrate RNAflux, an unsupervised method for semantic segmentation of subcellular domains. RNAflux first quantifies subcellular expression gradients at pixel resolution before identifying consistent subcellular domains via unsupervised clustering. We demonstrate the utility of Bento’s tools by applying them to identifying critical localization changes in human iPSC-derived cardiomyocytes upon drug treatment with doxorubicin, a widely used chemotherapeutic known to cause cardiotoxicity [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>RNAforest: utilizing subcellular landmarks to predict RNA subcellular localization</title>
      <p id="Par8">In computer vision, key points or landmarks are commonly used for tasks like facial recognition [<xref ref-type="bibr" rid="CR38">38</xref>] and object detection. Analogous to these classical applications, we derive spatial features using cell and nucleus boundaries as landmarks to predict RNA localization patterns from spatial summary statistics. Building on the summary statistics used for classifying smFISH data in FISH-quant v2 [<xref ref-type="bibr" rid="CR39">39</xref>], RNAforest consists of an ensemble of five binary random forest classifiers rather than a single multi-classifier model to assign one or more labels. These pattern labels, adapted from several high-throughput smFISH imaging experiments in HeLa cells [<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR43">43</xref>], are broadly applicable to eukaryotic cells: (i) nuclear (contained in the volume of the nucleus), (ii) cytoplasmic (diffuse throughout the cytoplasm), (iii) nuclear edge (near the inner/outer nuclear membrane), (iv) cell edge (near the cell membrane), and (v) none (complete spatial randomness). It is important to note, as was done previously in FISH-quant v2 [<xref ref-type="bibr" rid="CR39">39</xref>] that because of the 2D nature of the dataset, RNA that is in truth cytoplasmic but above or below the nucleus will still appear as though in the nucleus when collapsed in the <italic>z</italic>-dimension. As we use the FISH-quant v2 pattern simulation framework, this is accounted for in the training dataset.</p>
      <p id="Par9">We used the FISH-quant v2 simulation framework to generate realistic ground-truth data [<xref ref-type="bibr" rid="CR42">42</xref>]. Each sample is defined as a set of points with coordinates in two dimensions, representing the set of observed transcripts for a gene in a particular cell. In total, we simulated 2000 samples per class for a total of 10,000 samples (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). We used 80% of the simulated data for training and held out the remaining 20% for testing (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1A). Each sample is encoded by a set of 13 input features, describing characteristics of its spatial point distribution, including proximity to cellular compartments and extensions (features 1–3), measures of symmetry about a center of mass (features 4–6), and measures of dispersion and point density (features 7–13) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). These features are normalized to morphological properties of the cell to control for variability in cell shape. A detailed description of every feature is described in Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Table S1, and model architectures and hyperparameters are described in Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Table S2 (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section).<fig id="Fig2"><label>Fig. 2</label><caption><p>Subcellular localization pattern identification with RNAforest.<bold> A</bold> Thirteen spatial summary statistics are computed for every gene-cell pair describing the spatial arrangement of molecules and boundaries in relation to one another. The features (Supp. Table <xref rid="MOESM1" ref-type="media">1</xref>) are inputs for RNAforest, a multilabel ensemble classifier that assigns one or more subcellular localization labels: cell edge, cytoplasmic, nuclear, nuclear edge, and none. The colors for each label are used consistently throughout to figure. Top 10 genes for each label visualized for each label other than “none” in <bold>B</bold> U2-OS cells and <bold>C</bold> 3T3 cells. <bold>D</bold> and <bold>E</bold> are UpSet plots showing the proportion of measured transcripts assigned to each label. <bold>F</bold> and <bold>G</bold> show the relative label proportion across cells for each gene and are colored by the majority label (<bold>F</bold> and <bold>G</bold>). <bold>H</bold> Top 5 consistent genes for each label.<bold> I</bold> ssGEA identifies the enrichment of GO cellular component domains for each label in the 3T3 cell dataset. Stars denote <italic>p</italic>-values under thresholds defined in the legend. <italic>P</italic>-values are derived from ssGSEA permutation tests with Benjamini–Hochberg correction controlling for false discovery rate</p></caption><graphic xlink:href="13059_2024_3217_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">We applied RNAforest on two datasets from different spatial platforms, cell types, and gene panel sizes: a MERFISH dataset in U2-OS cells and a seqFISH + dataset in 3T3 cells. Validation performance on manual annotation of subsets of both datasets shows that RNAforest generalizes well despite biological and technical differences (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1B). The MERFISH dataset measured 130 genes (low plexity) with high detection efficiency per gene (111 molecules per gene per cell on average), while the seqFISH + dataset measured 10,000 genes (very high plexity) with lower detection efficiency (8 molecules per gene per cell on average) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B, C, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1C-F). In agreement with previous work characterizing RNA localization of 411 genes [<xref ref-type="bibr" rid="CR43">43</xref>], we find that genes commonly exhibit variability in localization across cells. This suggests that heterogeneity in localization likely generalizes to the entire transcriptome. Of the localization patterns besides “none,” “nuclear” was the most common (22.1%) in the U2-OS osteosarcoma cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D, F), while “cell edge” was the most common (15.9%) in the 3T3 fibroblast cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>E, G).</p>
      <p id="Par11">In the U2-OS cells, we found many genes to have preferential localization in different subcellular compartments (Fig. <xref rid="Fig2" ref-type="fig">2</xref>H). In agreement with our RNAflux findings, we find genes known to localize to the nucleus [<xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR45">45</xref>] to be frequently labeled “nucleus” (MALAT1, SOD2) and genes encoding secreted extracellular proteins [<xref ref-type="bibr" rid="CR13">13</xref>] to be frequently labeled “nuclear edge” (FBN1, FBN2). As expected, we find genes preferentially “nuclear” and “nuclear edge” localized to mirror nucleus and endoplasmic reticulum genes found in a 10 k genes MERFISH study of U2-OS cells that included ER staining [<xref ref-type="bibr" rid="CR46">46</xref>] (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Leveraging the 3T3 seqFISH + dataset’s higher plexity, we were able to ask whether genes with similar localization preferences are functionally related. We applied gene set enrichment analysis to gene localization frequencies to identify enriched gene ontology terms [<xref ref-type="bibr" rid="CR47">47</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref>I; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Secretory processes were enriched in the nucleus and nuclear edge, which may be linked to increased transcription of fibroblast-related functions. Cell edge enriched pathways consisted of those with the cell membrane as their site of function (e.g., endocytosis and tight junction suggesting local translation of these genes). Additionally, the term for cell cycle was significantly enriched in the cytoplasm only. Genes without strong localization preference (most frequently “none”) were not significantly associated with any pathways. These genes likely do not undergo active transport and are functionally independent of local translation.</p>
      <p id="Par12">In summary, RNAforest gives a user a facile method for annotating RNA localization patterns and quantifying heterogeneity in a transcriptome-wide manner independent of RNA abundance. Beyond known RNA localizations, we find that transcript location is generally associated with known gene function, alluding to the systematic spatial regulation of RNA transport. We foresee RNAforest will be a valuable addition to characterize RNA localization across diverse spatial transcriptomics datasets.</p>
    </sec>
    <sec id="Sec5">
      <title>RNAcoloc: an approach for context-specific RNA colocalization</title>
      <p id="Par13">In geospatial information processing, a fundamental feature that is often gleaned from large datasets is the colocation of objects (e.g., gleaning socialization metrics from cell phone colocation data in Singapore [<xref ref-type="bibr" rid="CR48">48</xref>]). Colocation is similarly valuable in understanding co-translation and interaction networks of genes in a biological context [<xref ref-type="bibr" rid="CR49">49</xref>]. Recent spatial transcriptomics approaches have used a number of colocalization metrics from the geographic information systems and ecology fields, e.g., the bivariate versions of Ripley’s K function (also known as cross-k-function) [<xref ref-type="bibr" rid="CR50">50</xref>], Moran’s <italic>I</italic> [<xref ref-type="bibr" rid="CR51">51</xref>], and the join count statistic [<xref ref-type="bibr" rid="CR52">52</xref>]. These metrics are designed to measure spatial associations between two populations, i.e., gene A transcripts and gene B transcripts. However, it is more appropriate to think of all transcripts in a single cell from a single population; after all, RNA transcription and localization are not completely stochastic. We have shown that the subcellular distribution of RNA is highly structured with RNAforest. As such, we developed RNAcoloc, an approach that combines the Colocation Quotient (CLQ) [<xref ref-type="bibr" rid="CR53">53</xref>] metric and tensor decomposition for context-specific RNA colocalization (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). The CLQ is a colocalization statistic that is capable of accounting for the biophysical properties of RNA spatial distributions. First, the CLQ considers how clustered the overall RNA population is in a cell and measures whether specific pairs of genes are more clustered than expected given the spatial pattern of the overall population. Second, the CLQ is inherently asymmetric and captures the direction of attraction, i.e., the attraction of gene A to gene B is not the same as the attraction of gene B to gene A. This is most common when gene A and gene B have very different expression levels, which is prevalent due to overdispersion in gene expression data.</p>
      <p id="Par14">RNAcoloc calculates CLQ scores for each gene per cell in a compartment-specific manner, such that each sample has 2 scores, a nucleus and cytoplasm CLQ score. An initial comparison in the U2-OS dataset of global colocalization between nuclear and cytoplasmic fractions unsurprisingly found that transcripts from the same gene tend to cluster more tightly with themselves than with transcripts from other genes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). Additionally, self-colocalization is significantly stronger in the cytoplasm than in the nucleus. In conjunction with our findings from RNAforest analysis that genes of the same localization pattern tend to have similar functions, this suggests that the RNAs are more tightly spatially regulated once exported from the nucleus.<fig id="Fig3"><label>Fig. 3</label><caption><p>Compartment-specific RNA colocalization with RNAcoloc. <bold>A</bold> Transcripts are separated by compartment (nucleus and cytoplasm) before CLQ scores are calculated for every gene pair across all cells. This yields a cell × gene pair × compartment tensor. <bold>B</bold> Pairwise comparison of log CLQ distributions for gene pairs and self-pairs, further categorized by compartment. The Mann–Whitney <italic>U</italic> test was used for comparisons. Stars denote <italic>p</italic>-values below the legend threshold with Benjamini–Hochberg correction controlling for false-discovery rate. From top to bottom, group sizes are 12,254,430 (cytoplasm gene pairs), 115,187 (nucleus gene pairs), 6,778,402 (cytoplasm self-pairs), and 86,474 (nucleus self-pairs). <bold>C</bold> Tensor decomposition yields 4 factors. From left to right, the three heatmaps show the loadings of each factor for each dimension—compartments, cells, and gene pairs. Only the top 5 associated gene pairs for each factor are shown. <bold>D</bold> Top examples of compartment-specific colocalized gene pairs. Black scale bars denote 10 μm</p></caption><graphic xlink:href="13059_2024_3217_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par15">By calculating CLQ scores for every gene–gene pair across compartments, RNAcoloc constructs a tensor of shape <italic>P</italic> × <italic>C</italic> × <italic>S</italic> where <italic>P</italic>, <italic>C</italic>, and <italic>S</italic> represent the number of gene–gene pairs, cells, and compartments, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section).</p>
      <p id="Par16">RNAcoloc then applies tensor decomposition — specifically, non-negative parallel factor analysis — a data-driven, unsupervised approach for discovering substructure in high-dimensional data [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR54">54</xref>] to decompose the tensor into <italic>k</italic> “factors”. The number of factors is determined using the elbow method heuristic, optimizing for the root mean squared error (RMSE) reconstruction loss (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Unlike matrix dimensionality reduction methods, such as PCA, the order of the components (factors) is unassociated with the amount of variance explained. Each factor is composed of 3 loading vectors, which correspond to the compartments, cells, and gene pairs. Higher values denote a stronger association with that factor. Crucially for interpretation, factors derived from tensor decomposition are not mutually exclusive and can share overlapping sets of associated compartments, cells, and gene pairs.</p>
      <p id="Par17">Applied to the U2-OS dataset, RNAcoloc decomposes RNA colocalization into 4 factors. Examining factor loadings indicates two distinct subpopulations of cells with compartment-specific colocalization behaviors; cluster 1 cells exhibit uniform (Factor 0) and cytoplasmic (Factor 3) colocalization, while cluster 2 cells show nuclear (Factor 1) and cytoplasmic colocalization (Factor 2) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>C, D). Factor 3 describes the colocalization of gene pairs in the cytoplasm of cluster 1 cells, especially a number of genes that attract PIK3CA transcripts While little is known about PIK3CA RNA interactions, the PI3K pathway regulates mitotic organization, including the regulation of dynein and dynactin motor proteins. DYNC1H1 is among the top genes attracting PI3KCA and specifically encodes cytoplasmic dynein, a motor protein critical for spindle formation and chromosomal segregation in mitosis [<xref ref-type="bibr" rid="CR55">55</xref>]. This hints that not only is compartmental localization of RNA linked to the cell cycle [<xref ref-type="bibr" rid="CR46">46</xref>], but RNA-RNA interactions may play a role as well. In cluster 2 cells, MALAT1 attracts CNR2 transcripts more than expected in the cytoplasm. Even though MALAT1 is canonically abundantly localized to the nucleus, this demonstrates that the CLQ score identifies gene pairs colocalizing more than expected despite the disproportionate expression of MALAT1 relative to CNR2, whereas other approaches seem confounded by large differences in expression [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
      <p id="Par18">We demonstrate the ability of RNAcoloc to quantify compartment-specific gene-pair colocation by exploring cytoplasmic vs. nuclear colocalization. As we found separately with RNAforest, RNAcoloc analysis finds evidence that RNA transport is spatially regulated, especially after nuclear export. We highlight several examples of colocalization suggesting how RNA localization allows the same gene to have multiple functions in a spatially dependent fashion, i.e., depending on its molecular neighbors and local environment [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR57">57</xref>]. We foresee RNAcoloc will be increasingly relevant as many spatial technologies are beginning to image proteins along with RNA, which can be used to delineate more granular compartments, such as cell organelles or distinct regions, e.g., neuron cell bodies vs dendrites.</p>
    </sec>
    <sec id="Sec6">
      <title>RNAflux: unsupervised semantic segmentation of subcellular domains in single cells</title>
      <p id="Par19">To build on RNAforest, we overcame the restricted number of localization patterns defined by the supervised method by framing RNA localization as an unsupervised embedding problem. RNAflux looks at local neighborhoods within the space of a cell and builds a normalized gene composition per neighborhood. Differences in neighborhood compositions can be leveraged to identify distinct subcellular domains in a manner that is entirely unsupervised and independent of cell geometry.</p>
      <p id="Par20">We applied this embedding procedure to compute a gene composition vector for every pixel in 2D coordinate space, generating a spatially coherent embedding across entire cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section).<fig id="Fig4"><label>Fig. 4</label><caption><p>RNAflux finds distinct subcellular domains with consistent spatial organization and local gene composition. <bold>A</bold> Flowchart of RNAflux and fluxmap computation. Local neighborhoods of a fixed radius are arrayed across a cell and a normalized gene composition is computed for each pixel coordinate, producing an RNAflux embedding. The first three principal components of the RNAflux embedding are visualized for U2-OS cells coloring RGB values by PC1, PC2, and PC3 values respectively for each pixel. Fluxmap domains are computed from each RNAflux embedding to create semantic segmentation masks of each subcellular domain.<bold> B</bold> The left panel shows a field of view of U2-OS cells, dots denoting individual molecules colored by gene species, nuclei, and cell boundaries outlined in white. For the same field of view of cells, the center panel shows RNAflux embeddings and the right panel shows fluxmap domains. <bold>C</bold> The scatter plot shows how the composition of each gene is distributed across fluxmap domains. The position of each point denotes the relative bias of a given gene’s composition across fluxmaps.<bold> D</bold> Heatmap showing the fraction of pixels with a positive enrichment value for each APEX-seq location for each fluxmap domain. <bold>E</bold>–<bold>I</bold> The most highly enriched location is shown for each fluxmap domain. Domain boundaries are denoted by white lines within each cell</p></caption><graphic xlink:href="13059_2024_3217_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par21">Applied to a MERFISH dataset with a target panel of 130 genes across over 1153 U2-OS cells, we demonstrate that RNAflux embeddings can detect transcriptionally distinct subcellular domains. Performing dimensional reduction of the embeddings showed that the top sources of variation spatially correspond to the nucleus, the nuclear periphery, and cytoplasmic regions consistently across cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section) confirming that RNAflux measures intracellular transcriptional variation, as opposed to intercellular variation. To delineate compositionally similar domains in a data-driven manner, we cluster pixel embeddings using self-organizing maps (SOMs), effectively performing unsupervised semantic segmentation (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). We denote the resulting clusters as “fluxmap domains.” We found that this assigned pixels to 5 fluxmap domains, consistently highlighting spatial regions across every cell (e.g., fluxmap 2 is always nuclear while the remaining domains constitute the cytoplasm) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). By considering the spatial distribution of molecules across fluxmap domains, we can quantify the composition of molecules for each gene across fluxmaps (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C), e.g., nuclear-localized MALAT1 [<xref ref-type="bibr" rid="CR44">44</xref>].</p>
      <p id="Par22">We sought to characterize the fluxmap domains with known information about RNA localization. We used data from a previous study that measured gene expression at “distinct subcellular locales” via APEX-seq, a technique for proximity labeling and sequencing of RNA [<xref ref-type="bibr" rid="CR58">58</xref>]. Of the 3288 genes differentially enriched to one or more locales, 63 overlapped with the 130 MERFISH genes. The location enrichment score for each pixel is calculated by taking the weighted sum of its RNAflux embedding and the measured relative enrichment, i.e., log fold change measured by APEX-seq loadings for a given organelle-specific geneset (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Visualizing each pixel’s location-specific enrichment scores from the APEX-seq dataset highlights the subcellular localization of these compartments, including the cytosol, nucleus, nucleolus, nuclear pore, nuclear lamina, endoplasmic reticulum lumen (ER lumen), ER membrane (ERM), and the outer mitochondrial membrane (OMM) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>D). We find the nuclear compartments have high scores in domain 2, while the cytoplasm scores rank highest in domains 4 and 5. Both the ERM and OMM scores are the strongest in domain 1 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E).</p>
      <p id="Par23">The most common application for spatial transcriptomics is in mapping heterogeneous cell types in large tissue samples. This presents several challenges. First, the panels for these experiments are weighted heavily towards cell type markers determined by single-nuclei RNA-seq, potentially reducing the intracellular variability in the expression on which Bento relies. Second, substantial intercellular heterogeneity can skew the low-rank embedding by introducing too much variance in requisite cell radii information. To explore the applicability of RNAflux on tissue, we applied it to a previously published breast cancer tissue dataset generated by 10 × Xenium [<xref ref-type="bibr" rid="CR59">59</xref>]. We successfully reproduced the identification of unique cell types that reflect canonical expression markers (Fig. S<xref rid="MOESM1" ref-type="media">4</xref>A and B). We apply RNAflux to cell type-disaggregated subsets of the full datasets in fields of view of interest with at least 100 cells of interest and find that fluxmaps 1–3 show different enrichment scores for Nucleus and Endoplasmic Reticulum (ER; combination of ERM and ER lumen). We note that despite the successful delineation of discrete regions in the form of fluxmaps when looking at different regions of tissue that are enriched for different cell types, nuclear and ER enrichment scores change for each fluxmap (Fig. S<xref rid="MOESM1" ref-type="media">4</xref>C).</p>
      <p id="Par24">In summary, RNAflux finds distinct subcellular domains with consistent spatial organization and local gene composition. As an unsupervised method, RNAflux can be applied to any cell type for inferring subcellular domains from transcript locations and functionally annotated with biological enrichment analysis. This process is best performed on cell type-separated data to guard low-rank embeddings from being generated by cells of vastly different morphologies. This disaggregation is important because, unlike uniform cell lines, heterogeneous tissue composed of functionally diverse stromal cells and leukocytes should indeed be expected to have different distributions and complements of subcellular domains.</p>
    </sec>
    <sec id="Sec7">
      <title>Doxorubicin-induced stress in cardiomyocytes depletes RNA from the endoplasmic reticulum</title>
      <p id="Par25">Having established Bento’s utility to characterize RNA localization in U2OS cells, we applied Bento to quantify changes in localization in the context of perturbations in cells. Specifically, we performed single-molecule spatial transcriptomics on doxorubicin-treated and untreated cardiomyocytes to identify RNA localization changes as a result of treatment.</p>
      <p id="Par26">Doxorubicin (DOX) was once one of the most effective broad-spectrum anti-cancer anthracycline antibiotics [<xref ref-type="bibr" rid="CR60">60</xref>, <xref ref-type="bibr" rid="CR61">61</xref>] with particular efficacy against solid malignancies such as lung and breast cancer, as well as hematologic neoplasia [<xref ref-type="bibr" rid="CR62">62</xref>, <xref ref-type="bibr" rid="CR63">63</xref>]. However, DOX’s propensity to cause cardiac damage in patients has led to significant limitations in its clinical use [<xref ref-type="bibr" rid="CR64">64</xref>]. The exact mechanism by which DOX induces heart failure is unclear, but significant evidence suggests cardiomyocyte injury driven by oxidative stress is a major factor [<xref ref-type="bibr" rid="CR62">62</xref>, <xref ref-type="bibr" rid="CR65">65</xref>–<xref ref-type="bibr" rid="CR68">68</xref>]. Specifically, DOX causes stress and dysfunction in multiple cellular compartments in cardiomyocytes such as mitochondria, Sarco/endoplasmic reticulum (SER), deficiencies in calcium signaling, and lipid degradation at the cellular membrane [<xref ref-type="bibr" rid="CR69">69</xref>]. We reasoned that by measuring the localization of the RNA transcripts of 100 genes crucial to cardiomyocyte health and function (Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Table S2) and leveraging the tools developed within Bento, we could recapitulate known dysfunction of subcellular domains in cardiomyocytes upon DOX stress and measure novel RNA localization phenotypes.</p>
      <p id="Par27">We utilized a chemically defined protocol to differentiate human induced pluripotent stem cells (iPSCs) into beating cardiomyocytes and treated them with either DMSO (vehicle) or 2.5 μM DOX for 12 h before fixation (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Single-molecule spatial transcriptomes were measured by Resolve Bioscience using Molecular Cartography. The resulting data was segmented using ClusterMap [<xref ref-type="bibr" rid="CR24">24</xref>] for cell boundaries and Cellpose [<xref ref-type="bibr" rid="CR70">70</xref>] for nuclei boundaries (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). Non-myocytes were filtered out using SLC8A1 as a canonical marker for cardiomyocytes (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3A). Comparing vehicle and DOX-treated cardiomyocytes, we found NPPA, a classic marker for cardiac stress [<xref ref-type="bibr" rid="CR71">71</xref>, <xref ref-type="bibr" rid="CR72">72</xref>], to be upregulated in DOX-treated cells (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). We identified subcellular domains in the vehicle and DOX-treated cardiomyocytes using RNAflux, clustering the domains into four fluxmap domains (Fig. <xref rid="Fig5" ref-type="fig">5</xref>C, D, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3B). Enrichment of location-specific gene expression aligned domains to the nucleus (nuclear pore, nucleolus, and nucleus), ERM and OMM, ER lumen, and cytosol respectively (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3C). Comparing the gene composition in each domain, we observe an overall localization bias towards both the nucleus and ERM/OMM in vehicle-treated cells (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E top), in agreement with prior poly(A) smFISH studies [<xref ref-type="bibr" rid="CR73">73</xref>]. However, RNA in the DOX-treated cardiomyocytes demonstrated a shift in average RNA localization away from the ERM/OMM and towards the nucleus (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E bottom). There was no correlation when comparing the logFC in expression and the difference in nuclear composition of genes after treatment, indicating that localization towards the nucleus is not driven by transcript abundance (Spearman <italic>r</italic> = 0.07, <italic>p</italic> = 0.4944). There is evidence that 90% of genes have a half-life of less than 260 min [<xref ref-type="bibr" rid="CR74">74</xref>], far less than the 12-h DOX treatment, indicating that the shift in RNA localization is likely due to reduced nuclear export of newly synthesized RNA from the nucleus to the ERM/OMM. Indeed, even low concentrations of DOX have been demonstrated to alter structural fibrous proteins as well as mitochondrial depolarization and fragmentation [<xref ref-type="bibr" rid="CR75">75</xref>]. Of particular note, the RNA binding protein RBM20—a critical regulator of mRNA splicing of genes encoding key structural proteins associated with cardiac development and function—had a pronounced depletion of RNA transcripts outside of the nucleus upon DOX treatment (Fig. <xref rid="Fig5" ref-type="fig">5</xref>G left). With further validation, this may indicate nuclear retention and or degradation of nuclear exported RBM20 mRNA as a potential mechanism of DOX-induced cardiomyopathy. Similarly, we found the mRNA of calcium voltage-gated channel subunit CACNB2 to also deplete outside of the nucleus (Fig. <xref rid="Fig5" ref-type="fig">5</xref>G middle). The loss of CACNB2 translation outside of the nucleus may impact calcium signaling crucial to cardiomyocyte function [<xref ref-type="bibr" rid="CR76">76</xref>]. Most genes only showed weak shifts in localization, similar to LAMP2 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>G right).<fig id="Fig5"><label>Fig. 5</label><caption><p>Subcellular RNA localization changes upon Doxorubicin treatment in iPSC-derived cardiomyocytes. <bold>A</bold> Cardiomyocytes derived from human iPSCs were treated with DMSO or 2.5 μM DOX for 12 h. The localizations of 100 genes relevant to cardiomyocyte health and function were measured using Molecular Cartography. Cell boundaries were determined using ClusterMap and nuclei were segmented using Cellpose. <bold>B</bold> Top 10 differentially upregulated and downregulated genes in vehicle versus treatment. <italic>T</italic>-test was used for comparisons. All genes shown are significant given an adjusted <italic>p</italic>-value threshold of<italic> p</italic> &lt; 0.01. Benjamini–Hochberg correction was used to control for the false discovery rate. Vehicle and treatment conditions have <italic>n</italic> = 7159 and 6260 cells respectively. <bold>C</bold> APEX-seq location-specific gene enrichment of fluxmap domains for the cytosol, endoplasmic reticulum membrane (ERM), endoplasmic reticulum lumen (ER Lumen), nuclear lamina, nucleus, nucleolus, nuclear pore, and outer mitochondrial matrix (OMM). <bold>D</bold> Fluxmap domains visualized for a representative field of view of cardiomyocytes for vehicle and treatment respectively highlighting cellular nuclei, ERM/OMM, ER Lumen, and cytosol. <bold>E</bold> RNAflux fluxmap enrichment of each gene averaged across vehicle and treatment cardiomyocytes captures changes in subcellular RNA localization. Top 10 genes are labeled and ranked by the largest shifts between compartment compositions. Shifts are quantified by Wasserstein distance. <bold>F</bold> Average gene enrichment in each fluxmap across vehicle and treatment conditions colored by log-fold expression demonstrates population-level shifts in transcript subcellular localization. <bold>G</bold> Visualization of RBM20, CACNB2, and LAMP2 transcripts confirms the depletion of transcripts from the perinuclear and cytosolic compartments of cardiomyocytes upon DOX treatment</p></caption><graphic xlink:href="13059_2024_3217_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par28">Bento seeks to interrogate biology via its “subcellular first” approach to spatial analysis, complementary to “cell-type or tissue first” spatial analysis methods. The toolkit enables quantitative, reproducible, and accessible analysis agnostic to spatial technology platforms in a standardized framework. We implement three novel methods to interrogate subcellular RNA organization: RNAforest for supervised annotation of localization patterns, RNAcoloc for compartment-aware colocalization analysis, and RNAflux for identifying transcriptionally distinct subcellular domains. We showed that with RNAflux, we were able to quantify RNA localization in a variety of contexts, including domain-specific gene localization, drug-induced changes in localization, and cell type-specific localization. With both RNAflux and RNAforest, we find that subcellular mRNA localization reflects gene function. With RNAcoloc, we explore the use of CLQ scores to quantify pairwise gene colocalization in the context of asymmetric associations.</p>
    <p id="Par29">From these results, we found three main factors to limit the effectiveness of subcellular-resolution analysis: molecule density, segmentation quality, and target panel composition. In particular, RNAflux becomes uninformative if too few molecules are detected per cell or if the number of molecules per gene is too sparse. We found that datasets with higher density, i.e., molecules per micrometer<sup>2</sup>, are less noisy and inform more coherent gradients and domains. Both the U2-OS dataset and cardiomyocyte datasets had high enough molecule density to identify consistent fluxmaps. Notably, RNAflux robustly highlights domains corresponding to the nucleus and ER despite some poor cell segmentation and partially unannotated nuclei in the cardiomyocytes dataset (Fig. <xref rid="Fig5" ref-type="fig">5</xref>D). As most commercial target panels are largely composed of marker genes for cell type identification, RNAflux embeddings should be interpreted carefully, especially if transcripts show little spatial variation in subcellular localization. In contrast, RNAforest performs reliably beyond a minimum of 5–10 molecules per sample but is sensitive to accurate segmentation for calculating cell morphology-dependent features (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. SE-F). The 3T3 cells were manually segmented and the U2-OS cells had relatively accurate segmentation and were therefore amenable to applying RNAforest. We found that the segmentation in the cardiomyocytes is accurate enough for single-cell gene expression analysis, but lacked the precision needed to apply RNAforest. In the case of RNAcoloc, the limiting factor to identifying relevant biology is the target panel composition. The current focus of most target panels typically includes cell type markers and highly expressed genes, whereas it would be more informative to identify colocalizing members of protein complexes, functional pathways, or ligand-receptor pairs. Our ability to characterize relevant pathways with our curated cardiomyocyte gene panel shows how gene panel design focused on function enables discovery. Ultimately, non-targeted transcriptome-scale technologies will be necessary to unlock the full potential of subcellular biology.</p>
    <p id="Par30">A dimensional limitation of Bento is its current inability to process three-dimensional spatial transcriptomic data. While some commercially available spatial transcriptomic methods yield RNA molecular coordinates in 3D, the nuclear and cell segmentation is inevitably still two-dimensional making it difficult to interpret z-dimensional positions lacking the context of cellular geometry in 3D. However, the algorithms behind RNAforest, RNAcoloc, RNAflux, and the plethora of feature calculation functions in Bento are inherently extensible to leveraging three-dimensionality. When three-dimensional cell segmentation improves, we intend to extend Bento to support three-dimensional analysis.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par31">Conventionally, RNA is treated as an intermediary vehicle encoding genomic information for protein synthesis. We began our investigation of RNA localization with the hope of understanding how the spatial organization of RNA functions as a mechanism for post-transcriptional regulation. However, RNAflux conceptually introduces using RNA molecular coordinates as a latent layer of information encoding cellular space–time. Here, we used that latent layer of information to identify subcellular domains. As spatial omic technologies improve to capture more and more information, the potential applications of such latent embeddings will grow as well. Indeed at the tissue level, this concept is already being leveraged with a recent tool, TensionMap, using RNA localization information to predict mechanical tension [<xref ref-type="bibr" rid="CR77">77</xref>]. As applications for spatial transcriptomics grow in popularity and complexity, we envision that Bento is a platform for the next generation of tools needed to quantify the complex molecular dynamics governing normal and abnormal cellular processes.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>MERFISH and seqFISH + data preprocessing</title>
      <p id="Par32">For the seqFISH + dataset, we limited the scope of our analysis to the set of genes for which at least 10 molecules were detected in at least one cell. This helped reduce sparsity in the data, resulting in 3726 genes remaining. Because pattern classification requires nuclear segmentation masks, we removed all cells lacking annotated nuclei for the remainder of 179 cells. Because the MERFISH data had a much higher number of molecules detected per gene, no gene needed to be removed. Again, cells without annotated nuclei were removed, leaving 1022 cells for downstream analysis.</p>
    </sec>
    <sec id="Sec12">
      <title>Preprocessing cardiomyocytes datasets</title>
      <p id="Par33">Single-cell expression matrices of both vehicle replicates and both DOX treatment samples were concatenated as a single expression matrix. Cells were projected into two dimensions with UMAP dimensional reduction. No significant batch effects were detected. Leiden clustering was performed at resolution = 0.5 to isolate and filter out a non-myocyte population depleted in SLC8A1 expression (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3A). All described preprocessing steps were performed in Scanpy [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>RNAforest: model selection and training</title>
      <p id="Par34">We evaluated 4 base models for the multilabel classifier including random forests (RF), support vector machines (SVM), feed-forward fully-connected neural networks (NN), and convolutional neural networks (CNN). While all other models use the 13 spatial features for input (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), the CNN takes 64 × 64 image representations of each sample as input. Each multilabel classifier consists of 5 binary classifiers with the same base model. We used the labeled 10,000 simulated samples for training, stratifying 80% of the simulated data for training and holding out the remaining 20% for testing. To select the best hyperparameters for each multilabel classifier, we sampled from a fixed hyperparameter space with the Tree-structured Parzen Estimator algorithm and evaluated performance with fivefold cross-validation (Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Table S2). We retrained the final model (random forest base model) on all training data with the best-performing set of hyperparameters (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1E). Exact steps can be found and reproduced in notebooks stored in the GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-manuscript">https://github.com/ckmah/bento-manuscript</ext-link>.</p>
    </sec>
    <sec id="Sec14">
      <title>RNAforest: image rasterization of molecules and segmentation masks for CNN</title>
      <p id="Par35">To generate an image for a given sample, point coordinates, the cell segmentation mask, and the nuclear segmentation mask are used. The area of the cell is tiled as a 64 × 64 grid, where each bin corresponds to a pixel in the final image. Values are stored in a single channel to render a grayscale image. Pixels inside the cell are encoded as 20 and inside the nucleus encoded as 40. Bins with molecules are encoded as (40 + 20 × <italic>n</italic>) where <italic>n</italic> is the number of molecules. Finally, values are divided by 255 and capped to be between 0 and 1.</p>
    </sec>
    <sec id="Sec15">
      <title>RNAforest: simulating training data</title>
      <p id="Par36">We trained a multilabel classifier to assign each gene in every cell labels from five categories: (i) nuclear (contained in the volume of the nucleus), (ii) cytoplasmic (diffuse throughout the cytoplasm), (iii) nuclear edge (near the inner/outer nuclear membrane), (iv) cell edge (near the cell membrane), and (v) none (complete spatial randomness). These categories are a consolidation of those observed in several high-throughput smFISH imaging experiments in HeLa cells [<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR43">43</xref>]. We used the FISH-quant simulation framework (<ext-link ext-link-type="uri" xlink:href="https://code.google.com/archive/p/fish-quant/">https://code.google.com/archive/p/fish-quant/</ext-link>) to generate realistic ground-truth images using empirically derived parameters from the mentioned high-throughput smFISH imaging experiments in HeLa cells [<xref ref-type="bibr" rid="CR42">42</xref>]. In total, we simulate 2000 samples per class for a total of 10,000 training samples.<list list-type="order"><list-item><p id="Par37"><italic>Cell shape</italic>: Cell morphology varies widely across cell types, and for classifier generalizability, it is important to include many different morphologies in the training set. We use a catalog of cell shapes for over 300 cells from smFISH images in HeLa cells that capture nucleus and cell membrane shape [<xref ref-type="bibr" rid="CR42">42</xref>]. Cell shapes were obtained by cell segmentation with CellMask and nuclear segmentation was obtained from DAPI staining.</p></list-item><list-item><p id="Par38">mRNA<italic> abundance</italic>: We simulated mRNA abundance at three different expression levels (40, 100, and 200 mRNA per average-sized cell) with a Poisson noise term. Consequently, total mRNA abundance per cell was between 5 and 300 transcripts.</p></list-item><list-item><p id="Par39">Localization<italic> pattern</italic>: We focused on 5 possible 2D localization patterns, including cell edge, cytoplasmic, none, nuclear, and nuclear edge. Each pattern was further evaluated at 3 different degrees—weak, moderate, and strong. Moderate corresponds to a pattern typically observed in a cell, whereas weak is close to spatially random. These 5 classes aim to capture biologically relevant behavior generalizable to most cell types; there is room for additional classes describing other biologically relevant localization patterns so long as they can be accurately modeled.</p></list-item></list></p>
    </sec>
    <sec id="Sec16">
      <title>RNAforest: manual annotation of true biological validation data</title>
      <p id="Par40">Using 3 individual annotators, we annotated the same 600 samples across both datasets, keeping samples with 2 or more annotator agreements as true annotations, resulting in 165 annotated seqFISH + samples and 238 annotated MERFISH samples (403 total). We used Cohen’s kappa coefficient [<xref ref-type="bibr" rid="CR78">78</xref>] to calculate agreement between pairs of annotators for each label yielding an overall coefficient of 0.602. We found that pairwise agreement between annotators across labels was fairly consistent ranging between 0.588 and 0.628, while label-specific agreement varied more, ranging between 0.45 and 0.72 (Additional File <xref rid="MOESM4" ref-type="media">4</xref>: Table S4).</p>
    </sec>
    <sec id="Sec17">
      <title>RNAforest: functional enrichment of gene pattern distributions</title>
      <p id="Par41">For enrichment of compartment-specific expression from Xia et al. [<xref ref-type="bibr" rid="CR46">46</xref>], scores are calculated by taking the weighted sum of gene pattern frequencies and published compartment log fold-change values (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). The Benjamini–Hochberg correction was used to correct <italic>p</italic>-values for multiple hypothesis testing.</p>
      <p id="Par42">For the seqFISH + dataset, we performed a single-sample Gene Set Enrichment Analysis [<xref ref-type="bibr" rid="CR79">79</xref>, <xref ref-type="bibr" rid="CR80">80</xref>] on gene pattern frequencies to compute enrichment scores (Fig. <xref rid="Fig3" ref-type="fig">3</xref>I). ssGSEA was performed with the GSEApy Python package and the “GO_Cellular_Component_2021” gene set library curated by Enrichr [<xref ref-type="bibr" rid="CR81">81</xref>]. Gene sets with a minimum size of 50 and a maximum size of 500 were analyzed.</p>
    </sec>
    <sec id="Sec18">
      <title>Colocation quotient for RNA colocalization analysis</title>
      <p id="Par43">Pairwise colocalization of genes was determined for each compartment of every cell separately. In this case, each cell was divided into compartments, cytoplasm, and nucleus. The colocation quotient (CLQ) was calculated for every pair of genes <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq2.gif"/></alternatives></inline-formula>. The CLQ is defined as an odds ratio of the observed to expected proportion of <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq3.gif"/></alternatives></inline-formula> transcripts among neighbors of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq4.gif"/></alternatives></inline-formula> for a fixed radius <italic>r</italic>; it is formulated as:<disp-formula id="Equa"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${CLQ}_{A\to B}=\frac{{C}_{A\to B}/{N}_{A}}{{N{\prime}}_{B}/(N-1)}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">CLQ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2024_3217_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par44">Here <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{C}}}_{{\varvec{A}}\to {\varvec{B}}}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq5.gif"/></alternatives></inline-formula> denotes the number of <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq6.gif"/></alternatives></inline-formula> transcripts of which <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq7.gif"/></alternatives></inline-formula> transcripts are considered a neighbor. <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{N}}}_{{\varvec{A}}}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq8.gif"/></alternatives></inline-formula> denotes the total number of <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq9.gif"/></alternatives></inline-formula> transcripts, while <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{N}}{\boldsymbol{^{\prime}}}_{{\varvec{B}}}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mrow/><mml:mrow/><mml:mo mathvariant="bold">′</mml:mo></mml:mmultiscripts></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow/></mml:mmultiscripts></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq10.gif"/></alternatives></inline-formula> stands for the total number of <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq11.gif"/></alternatives></inline-formula> transcripts. In the case that <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}={\varvec{B}}$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq12.gif"/></alternatives></inline-formula>, <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{N}}{\boldsymbol{^{\prime}}}_{{\varvec{B}}}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mrow/><mml:mrow/><mml:mo mathvariant="bold">′</mml:mo></mml:mmultiscripts></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow/></mml:mmultiscripts></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq13.gif"/></alternatives></inline-formula> equals the total number of <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq14.gif"/></alternatives></inline-formula> transcripts minus 1. <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{N}}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq15.gif"/></alternatives></inline-formula> denotes the total number of transcripts in the cell. Following statistical recommendations from the original formulation of the colocation quotient (CLQ), genes with fewer than 10 transcripts were not considered to reduce sparsity and improve testing power [<xref ref-type="bibr" rid="CR53">53</xref>].</p>
    </sec>
    <sec id="Sec19">
      <title>Tensor decomposition for compartment-specific colocalization</title>
      <p id="Par45">We begin by calculating the CLQ for every pair of genes within each compartment of every cell. We structure our data as follows:<list list-type="order"><list-item><p id="Par46">Cells set: Denote the set of cells as<inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{C}}\boldsymbol=\boldsymbol\{{{\varvec{c}}}_{1},{{\varvec{c}}}_{2},\boldsymbol...,{{\varvec{c}}}_{{\varvec{n}}}\}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">=</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">{</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo mathvariant="bold">.</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq16.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{c}}}_{{\varvec{i}}}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq17.gif"/></alternatives></inline-formula> represents the <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{i}}}^{{\varvec{t}}{\varvec{h}}}$$\end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq18.gif"/></alternatives></inline-formula> cell and <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{n}}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq19.gif"/></alternatives></inline-formula> is the total number of cells.</p></list-item><list-item><p id="Par47">Compartments set: Every cell has the same set of compartments, represented as<inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{K}}=\{{{\varvec{k}}}_{1},{{\varvec{k}}}_{2},\boldsymbol...,{{\varvec{k}}}_{{\varvec{m}}}\}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo mathvariant="bold">.</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq20.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{k}}}_{{\varvec{j}}}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq21.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{j}}}^{{\varvec{t}}{\varvec{h}}}$$\end{document}</tex-math><mml:math id="M46"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq22.gif"/></alternatives></inline-formula> compartment within a cell.</p></list-item><list-item><p id="Par48">Gene pairs set: The gene pairs are represented by <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{G}}=\{{{\varvec{g}}}_{1},{{\varvec{g}}}_{2},\boldsymbol...,\boldsymbol{{\varvec{g}}}_{{\varvec{p}}}\}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo mathvariant="bold">.</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq23.gif"/></alternatives></inline-formula> where <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{g}}}_{{\varvec{p}}}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq24.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{p}}}^{{\varvec{t}}{\varvec{h}}}$$\end{document}</tex-math><mml:math id="M52"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq25.gif"/></alternatives></inline-formula> gene pair.</p></list-item></list></p>
      <p id="Par49">By computing the CLQ for every combination of cells in <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{C}}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq26.gif"/></alternatives></inline-formula>, compartments in <inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{K}}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq27.gif"/></alternatives></inline-formula>, and gene pairs in <inline-formula id="IEq28"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{G}}$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq28.gif"/></alternatives></inline-formula>, we populate a three-dimensional tensor <inline-formula id="IEq29"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq29.gif"/></alternatives></inline-formula> with dimensions corresponding to these sets.</p>
      <p id="Par50">We then apply non-negative parallel factor analysis (PARAFAC) as implemented in Tensorly [<xref ref-type="bibr" rid="CR31">31</xref>] to reduce the dimensionality of our dataset and capture the underlying patterns. For tensor decomposition, we employed non-negative parallel factor analysis as implemented in Tensorly [<xref ref-type="bibr" rid="CR31">31</xref>]. The tensor <inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq30.gif"/></alternatives></inline-formula> is decomposed into the sum of <inline-formula id="IEq31"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{R}}$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq31.gif"/></alternatives></inline-formula> factors; each factor is a three-dimensional tensor expressed as the outer product of three vectors: <inline-formula id="IEq32"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{x}}}_{{\varvec{r}}}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq32.gif"/></alternatives></inline-formula> (compartment loadings), <inline-formula id="IEq33"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{y}}}_{{\varvec{r}}}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq33.gif"/></alternatives></inline-formula> (cell loadings), and <inline-formula id="IEq34"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{z}}}_{{\varvec{r}}}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq34.gif"/></alternatives></inline-formula> (gene pair loadings). This is denoted as follows:<disp-formula id="Equb"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\widehat{X}}_{R}}={\sum }_{r=1}^{R}{x}_{r}\otimes {y}_{r}\otimes {z}_{r}$$\end{document}</tex-math><mml:math id="M72" display="block"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2024_3217_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par51">The optimal rank-<inline-formula id="IEq35"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{R}}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq35.gif"/></alternatives></inline-formula> decomposition of <inline-formula id="IEq36"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq36.gif"/></alternatives></inline-formula> is determined by minimizing the error between <inline-formula id="IEq37"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq37.gif"/></alternatives></inline-formula> and the reconstructed tensor <inline-formula id="IEq38"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{X}}}$$\end{document}</tex-math><mml:math id="M80"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq38.gif"/></alternatives></inline-formula>. We use the elbow function heuristic to select the best-fit rank from a range of 2–12 factors. This approach seeks to balance the complexity of the model against the fidelity of reconstruction. Missing values in <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq39.gif"/></alternatives></inline-formula> are ignored when calculating the loss.</p>
    </sec>
    <sec id="Sec20">
      <title>RNAflux: unsupervised spatial embedding and subcellular domain quantization</title>
      <p id="Par52">To generate RNAflux embeddings, first, a set of query coordinates are generated tiling across the cell area on a uniform grid. This effectively downsamples the original data units (pixels) resulting in much fewer samples to compute embeddings. Let <inline-formula id="IEq40"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q = \{{q}_{1},{q}_{2},...,{q}_{n}\}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq40.gif"/></alternatives></inline-formula> be the set of query coordinates and <inline-formula id="IEq41"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${q}_{i}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq41.gif"/></alternatives></inline-formula> denote the <inline-formula id="IEq42"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}^{th}$$\end{document}</tex-math><mml:math id="M88"><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq42.gif"/></alternatives></inline-formula> query coordinate. For the MERFISH U2-OS dataset, a step size of 10 data units (pixels) was used to generate the uniform grid. For the iPSC-derived cardiomyocytes, a step size of 5 data units was used. Each query point is assigned an expression vector, counting the abundance of each gene within a fixed radius of 40 and 50 data units respectively. Each expression vector is normalized to sum to one, converting the expression vector to a composition vector, denoted as <inline-formula id="IEq43"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq43.gif"/></alternatives></inline-formula>. Similarly, the cell composition vector <inline-formula id="IEq44"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq44.gif"/></alternatives></inline-formula> for the <inline-formula id="IEq45"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j}^{th}$$\end{document}</tex-math><mml:math id="M94"><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq45.gif"/></alternatives></inline-formula> cell is calculated by normalizing the total cell expression to sum to one. The RNAflux embedding <inline-formula id="IEq46"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq46.gif"/></alternatives></inline-formula> at query coordinate <inline-formula id="IEq47"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${q}_{i}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq47.gif"/></alternatives></inline-formula> is defined as the difference between the <inline-formula id="IEq48"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq49.gif"/></alternatives></inline-formula> divided by <inline-formula id="IEq50"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{v}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>σ</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq50.gif"/></alternatives></inline-formula>, the vector of standard deviation of composition vectors <inline-formula id="IEq51"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v$$\end{document}</tex-math><mml:math id="M106"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq51.gif"/></alternatives></inline-formula>.<disp-formula id="Equc"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}=\frac{{v}_{i}-{x}_{j}}{{\sigma }_{v}}$$\end{document}</tex-math><mml:math id="M108" display="block"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2024_3217_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par53">The RNAflux embedding serves as an interpretable spatial gene embedding that quantifies highly local fluctuations in gene composition. Dimensional reduction of the embeddings is performed using truncated singular value decomposition (SVD). Truncated SVD was chosen over PCA to better handle large but sparse data. Embeddings were reduced to the top 10 components. To assign domains, self-organizing maps (SOM) as implemented in MiniSom [<xref ref-type="bibr" rid="CR82">82</xref>] were used for low-rank quantization of query embeddings. In an analysis of the MERFISH dataset, SOMs of size 1 × <italic>k</italic> were fit across a range of 2 to 12; the best model was determined using the elbow method heuristic to evaluate quantization error. Similarly, domains were determined for the cardiomyocyte spatial transcriptomics data by fitting the vehicle and treatment samples separately, for <italic>k</italic> across a range of 2 to 8. The elbow method heuristic determined an optimal <italic>k</italic> of 6; subsequently, a <italic>k</italic> of 4 was used for further analysis for ease of interpretation.</p>
    </sec>
    <sec id="Sec21">
      <title>RNAflux: visualizing spatial embeddings</title>
      <p id="Par54">The top 3 principal components of the RNAflux embeddings are transformed to map red, green, and blue values respectively. Embeddings are first quantile normalized and scaled to a minimum of 0.1 and 0.9 to avoid mapping extreme quantiles to white and black. These values are then used for red, green, and blue color channels. To map the downsampled grid back to the original data units, linear interpolation was used to rescale the computed color values and fill the space between the uniform grid points.</p>
    </sec>
    <sec id="Sec22">
      <title>RNAflux: enrichment of locale-specific transcriptomes derived by APEX-seq</title>
      <p id="Par55">The enrichment score for each pixel is calculated by first taking the weighted sum of its RNAflux embedding and locale-specific log fold-change values as implemented by the decoupler tool [<xref ref-type="bibr" rid="CR83">83</xref>]. Scores for pixels within a given cell are normalized against a null distribution constructed via random permutations of the input embeddings, to produce <italic>z</italic>-scaled enrichment scores. Fluxmap domain enrichment scores are simply obtained by taking the mean score of all pixels within the boundary of each domain. Fluxmap domain overlaps are computed by counting the fraction of pixels within the boundary of each domain with a positive enrichment score.</p>
    </sec>
    <sec id="Sec23">
      <title>MERFISH of U2-OS cells</title>
      <p id="Par56"><italic>MERFISH sample preparation.</italic> MERFISH measurements of 130 genes with five non-targeting blank controls were done as previously described, using the published encoding [<xref ref-type="bibr" rid="CR44">44</xref>] and readout probes [<xref ref-type="bibr" rid="CR84">84</xref>]. Briefly, U2-OS cells were cultured on 40 mm #1.5 coverslips that are silanized and poly-L-lysine coated [<xref ref-type="bibr" rid="CR44">44</xref>] and subsequently fixed in 4% (vol/vol) paraformaldehyde in 1 × PBS for 15 min at room temperature. Cells were then permeabilized in 0.5% Triton X-100 for 10 min at room temperature and washed in 1 × PBS containing Murine RNase Inhibitor (NEB M0314S). Cells were preincubated with hybridization wash buffer (30% (vol/vol) formamide in 2 × SSC) for 10 min at room temperature with gentle shaking. After preincubation, the coverslip was moved to a fresh 60-mm petri dish and residual hybridization wash buffer was removed with a Kimwipe lab tissue. In the new dish, 50 uL of encoding probe hybridization buffer (2 × SSC, 30% (vol/vol) formamide, 10% (wt/vol) dextran sulfate, 1 mg ml<sup>−1</sup> yeast tRNA, and a total concentration of 5 uM encoding probes and 1 μM of anchor probe: a 15-nt sequence of alternating dT and thymidine-locked nucleic acid (dT +) with a 5′-acrydite modification (Integrated DNA Technologies). The sample was placed in a humidified 37 °C oven for 36 to 48 h, then washed with 30% (vol/vol) formamide in 2 × SSC for 20 min at 37 °C, 20 min at room temperature. Samples were post-fixed with 4% (vol/vol) paraformaldehyde in 2 × SSC and washed with 2 × SSC with murine RNase inhibitor for 5 min. The samples were finally stained with an Alexa 488-conjugated anchor probe-readout oligo (Integrated DNA Technologies) and DAPI solution at 1 μg/ml.</p>
      <sec id="Sec24">
        <title>MERFISH imaging</title>
        <p id="Par57">MERFISH measurements were conducted on a home-built system as described in Huang et al. [<xref ref-type="bibr" rid="CR84">84</xref>].</p>
      </sec>
      <sec id="Sec25">
        <title>MERFISH spot detection</title>
        <p id="Par58">Individual RNA molecules were decoded in MERFISH images using MERlin v0.1.6 [<xref ref-type="bibr" rid="CR85">85</xref>]. Images were aligned across hybridization rounds by maximizing phase cross-correlation on the fiducial bead channel to adjust for drift in the position of the stage from round to round. Background was reduced by applying a high-pass filter and decoding was then performed per-pixel. For each pixel, a vector was constructed of the 16 brightness values from each of the 16 rounds of imaging. These vectors were then L2 normalized and their Euclidean distances to each of the L2 normalized barcodes from the MERFISH codebook were calculated. Pixels were assigned to the gene whose barcode they were closest to, unless the closest distance was greater than 0.512, in which case the pixel was not assigned a gene. Adjacent pixels assigned to the same gene were combined into a single RNA molecule. Molecules were filtered to remove potential false positives by comparing the mean brightness, pixel size, and distance to the closest barcode of molecules assigned to blank barcodes to those assigned to genes to achieve an estimated misidentification rate of 5%. The exact position of each molecule was calculated as the median position of all pixels consisting of the molecule.</p>
      </sec>
      <sec id="Sec26">
        <title>MERFISH image segmentation</title>
        <p id="Par59">Cellpose v1.0.2 [<xref ref-type="bibr" rid="CR70">70</xref>] was used to perform image segmentation to determine the boundaries of cells and nuclei. The nuclei boundaries were determined by running Cellpose with the “nuclei” model using default parameters on the DAPI stain channel of the pre-hybridization images. Cytoplasm boundaries were segmented with the “cyto” model and default parameters using the polyT stain channel. RNA molecules identified by MERlin were assigned to cells and nuclei by applying these segmentation masks to the positions of the molecules.</p>
      </sec>
    </sec>
    <sec id="Sec27">
      <title>iPSC cardiac differentiation and doxorubicin treatment</title>
      <p id="Par60">Matrigel (Corning, cat # 354,277)-coated plates were used to culture iPSCs with mTESR Plus human iPSC medium (StemCell Technologies, cat # 100–0276) in a humidified incubator at 37 °C with 5% CO<sub>2</sub>. iPSCs were dissociated with Gentle Cell Dissociation Reagent (StemCell Technologies, cat # 100–0485) and passaged with mTESR Plus medium and 10uM ROCK inhibitor (Tocris, cat #1254) at a ratio of 1:12. mTESR plus medium was replaced every other day until the cells reached 80% confluency for maintenance and replating, or 90% confluency for cardiac differentiation utilizing a chemically defined protocol [<xref ref-type="bibr" rid="CR86">86</xref>]. On day 0 of cardiac differentiation, cells were treated with 6 μM CHIR99021 (Selleck Chem, cat # S1263) in RPMI 1640 media (Gibco, cat # 11,875) and B27 minus insulin supplement (Thermo Fisher, cat # A1895601). On day 2, CHIR was removed, and cells were cultured with RPMI 1640 media and B27 minus insulin supplement (Thermo Fisher, cat # A18956). On day 3, media was replaced with RPMI media containing B27 minus insulin supplement and 5 μM Wnt-C59 (Cellagen Technologies, cat # C7641-2 s). On days 5, 7, and 9, media was replaced with RPMI media containing B27 insulin supplement (Thermo Fisher, cat # 17,504). On days 11 and 13, media was replaced with RPMI 1640 media without glucose (Thermo Fisher, cat # 11,879,020) containing B27 insulin supplement for purification of cardiomyocytes. From days 15 onward, the cells were cultured in RPMI 1640 media containing B27 supplement which was changed every other day until the cells reached day 30 for replating. For replating, cells were incubated in 10 × TrypLE (Thermo Fisher, cat # A1217701) for 12 min at 37 °C, neutralized with equal volumes of RPMI 1640 media containing B27 supplement with 20% FBS (Gibco, cat # 26,140–079), gently dissociated by pipetting, then spun down and resuspended for replating in RPMI 1640 media containing B27 supplement with 20% FBS. The next day, the cell media was replaced with RPMI 1640 media containing B27 supplement which was replaced with fresh media every other day. On day 48, the cells were replated onto chamber slides (Ibidi, cat # 80,826) as described above and recovered for 10 days before doxorubicin treatments began (MedChemExpress, cat # HY-15142). On day 60, doxorubicin treatments concluded, and the cells underwent methanol fixation.</p>
    </sec>
    <sec id="Sec28">
      <title>Molecular<italic> cartography</italic></title>
      <sec id="Sec29">
        <title>Cultured cell processing</title>
        <p id="Par61">After doxorubicin treatment, cardiomyocytes were washed with PBS (1 ×) twice and fixed in methanol (− 20 °C) for 10 min. After fixation, Methanol was aspirated and cells were dried and stored at − 80 °C until use. The samples were used for Molecular Cartography™ (100-plex combinatorial single-molecule fluorescence in-situ hybridization) according to the manufacturer’s instructions <italic>Day 1: Molecular Preparation Protocol</italic> for cells, starting with the addition of buffer DST1 followed by cell priming and hybridization. Briefly, cells were primed for 30 min at 37 °C followed by overnight hybridization of all probes specific for the target genes (see below for probe design details and target list). Samples were washed the next day to remove excess probes and fluorescently tagged in a two-step color development process. Regions of interest were imaged as described below and fluorescent signals removed during decolorization. Color development, imaging, and decolorization were repeated for multiple cycles to build a unique combinatorial code for every target gene that was derived from raw images as described below.</p>
      </sec>
      <sec id="Sec30">
        <title>Probe design</title>
        <p id="Par62">The probes for 100 genes were designed using Resolve’s proprietary design algorithm. Briefly, the probe design was performed at the gene level. For every targeted gene, all full-length protein-coding transcript sequences from the ENSEMBL database were used as design targets if the isoform had the GENCODE annotation tag “basic” [<xref ref-type="bibr" rid="CR87">87</xref>, <xref ref-type="bibr" rid="CR88">88</xref>]. To speed up the process, the calculation of computationally expensive parts, especially the off-target searches, the selection of probe sequences was not performed randomly, but limited to sequences with high success rates. To filter highly repetitive regions, the abundance of k-mers was obtained from the background transcriptome using Jellyfish [<xref ref-type="bibr" rid="CR89">89</xref>]. Every target sequence was scanned once for all k-mers, and those regions with rare k-mers were preferred as seeds for full probe design. A probe candidate was generated by extending a seed sequence until a certain target stability was reached. A set of simple rules was applied to discard sequences that were found experimentally to cause problems. After these fast screens, the remaining probe candidates were mapped to the background transcriptome using ThermonucleotideBLAST [<xref ref-type="bibr" rid="CR90">90</xref>] and probes with stable off-target hits were discarded. Specific probes were then scored based on the number of on-target matches (isoforms), which were weighted by their associated APPRIS level [<xref ref-type="bibr" rid="CR91">91</xref>], favoring principal isoforms over others. A bonus was added if the binding site was inside the protein-coding region. From the pool of accepted probes, the final set was composed by picking the highest-scoring probes. Probes with catalog numbers can be found in Additional File <xref rid="MOESM3" ref-type="media">3</xref>: Table S3.</p>
      </sec>
      <sec id="Sec31">
        <title>Imaging</title>
        <p id="Par63">Samples were imaged on a Zeiss Celldiscoverer 7, using the 50 × Plan Apochromat water immersion objective with an NA of 1.2 and the 0.5 × magnification changer, resulting in a 25 × final magnification. Standard CD7 LED excitation light source, filters, and dichroic mirrors were used together with customized emission filters optimized for detecting specific signals. Excitation time per image was 1000 ms for each channel (DAPI was 20 ms). A z-stack was taken at each region with a distance per z-slice according to the Nyquist-Shannon sampling theorem. The custom CD7 CMOS camera (Zeiss Axiocam Mono 712, 3.45 μm pixel size) was used. For each region, a z-stack per fluorescent color (two colors) was imaged per imaging round. A total of 8 imaging rounds were done for each position, resulting in 16 z-stacks per region. The completely automated imaging process per round was realized by a custom Python script using the scripting API of the Zeiss ZEN software (Open application development).</p>
      </sec>
      <sec id="Sec32">
        <title>Image processing and spot segmentation</title>
        <p id="Par64">As a first step, all images were corrected for background fluorescence. A target value for the allowed number of maxima was determined based on the area of the slice in μm<sup>2</sup> multiplied by the factor 0.5. This factor was empirically optimized. The brightest maxima per plane were determined, based upon an empirically optimized threshold. The number and location of the respective maxima were stored. This procedure was done for every image slice independently. Maxima that did not have a neighboring maximum in an adjacent slice (called z-group) were excluded. The resulting maxima list was further filtered in an iterative loop by adjusting the allowed thresholds for (Babs-Bback) and (Bperi-Bback) to reach a feature target value (Babs: absolute brightness, Bback: local background, Bperi: background of periphery within 1 pixel). These feature target values were based on the volume of the 3D image. Only maxima still in a group of at least 2 after filtering were passing the filter step. Each z-group was counted as one hit. The members of the z-groups with the highest absolute brightness were used as features and written to a file. They resemble a 3D-point cloud. To align the raw data images from different imaging rounds, images had to be registered. To do so, the extracted feature point clouds were used to find the transformation matrices. For this purpose, an iterative closest point cloud algorithm was used to minimize the error between two point clouds. The point clouds of each round were aligned to the point cloud of round one (reference point cloud). The corresponding point clouds were stored for downstream processes. Based upon the transformation matrices, the corresponding images were processed by a rigid transformation using trilinear interpolation. The aligned images were used to create a profile for each pixel consisting of 16 values (16 images from two color channels in 8 imaging rounds). The pixel profiles were filtered for variance from zero normalized by the total brightness of all pixels in the profile. Matched pixel profiles with the highest score were assigned as an ID to the pixel. Pixels with neighbors having the same ID were grouped. The pixel groups were filtered by group size, number of direct adjacent pixels in group, and number of dimensions with a size of two pixels. The local 3D-maxima of the groups were determined as potential final transcript locations. Maxima were filtered by the number of maxima in the raw data images where a maximum was expected. The remaining maxima were further evaluated by the fit to the corresponding code. The remaining maxima were written to the results file and considered to resemble transcripts of the corresponding gene. The ratio of signals matching to codes used in the experiment and signals matching to codes not used in the experiment were used as estimation for specificity (false positives). The algorithms for spot segmentation were written in Java and are based on the ImageJ library functionalities. Only the iterative closest point algorithm is written in C +  + based on the libpointmatcher library (<ext-link ext-link-type="uri" xlink:href="https://github.com/ethz-asl/libpointmatcher">https://github.com/ethz-asl/libpointmatcher</ext-link>).</p>
      </sec>
      <sec id="Sec33">
        <title>Image segmentation</title>
        <p id="Par65">Cellpose v1.0.2 [<xref ref-type="bibr" rid="CR70">70</xref>] was used to perform image segmentation to determine the boundaries of nuclei. The nuclei boundaries were determined by running Cellpose with the “nuclei” model using default parameters on the DAPI stain channel of the pre-hybridization images. Cytoplasm boundaries were determined with ClusterMap [<xref ref-type="bibr" rid="CR24">24</xref>] using spot coordinates.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec34">
    <title>Review history</title>
    <p id="Par66">The review history is available as Additional file <xref rid="MOESM5" ref-type="media">5</xref>.</p>
  </sec>
  <sec id="Sec35">
    <title>Peer review information</title>
    <p id="Par67">Kevin Pang was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec37">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2024_3217_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1:</bold> Supplementary Figures and Table S1. Supplementary figures and machine learning classifier feature descriptions.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2024_3217_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2:</bold><bold>Table S2.</bold> Hyperoptimization parameters and classifier architectures.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2024_3217_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3:</bold><bold>Table S3.</bold> Cardiomyocyte gene panel for Molecular Cartography experiment.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2024_3217_MOESM4_ESM.csv">
            <caption>
              <p><bold>Additional file 4:</bold><bold>Table S4.</bold> Manual annotation data for RNA localization patterns</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2024_3217_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5.</bold> Review history</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Clarence K. Mah and Noorsher Ahmed are co-first authors and contributed equally.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank members of the Yeo lab, Carter lab, Michelle Franc Ragsac, Erick Armingol, and Nate Lewis for helpful discussions and feedback on the manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p> C.K.M, N.A., and G.W.Y. conceptualized the project. C.K.M. and N.A. co-developed the software. C.K.M. and D.L. trained the classification model for subcellular localization. C.K.M., N.A., and D.L. manually annotated data for benchmarking model performance. C.K.M., N.A., and G.P. performed data preprocessing and analysis. A.M., C.K., Y.H., and Q.Z. generated the MERFISH experiment. N.L. designed the gene panel and cultured the cardiomyocytes. A.C. and E.L. aided multimodal spatial analyses. C.K.M., N.A., H.C., and G.W.Y. wrote the manuscript. H.C. and G.W.Y. supervised the project.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>C.K.M. is supported by the National Science Foundation Graduate Research Fellowship under Grant No. (DGE-2038238). N.A. was partially supported by NIH Training Grant T32 GM008666. This work was partially supported by National Institutes of Health grants NS103172, MH107367, AI132122, AI123202, AG069098, HG004659, and HG009889 to G.W.Y. G.W.Y. is also supported by an Allen Distinguished Investigator Award, a Paul G. Allen Frontiers Group advised grant of the Paul G. Allen Family Foundation. A.J.C. and E.L. acknowledge support from the Chan Zuckerberg Initiative (CZF2019-002448) and the Knut and Alice Wallenberg Foundation (KAW 2021.0346) to E.L.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets (seqFISH + , MERFISH, and Molecular Cartography datasets) supporting the conclusions of this article are available in the Figshare repository, 10.6084/m9.figshare.c.6564043.v1  [<xref ref-type="bibr" rid="CR92">92</xref>], and are also accessible through the Bento Python package.</p>
    <p>The source code for Bento is available on the GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-tools">https://github.com/ckmah/bento-tools</ext-link> [<xref ref-type="bibr" rid="CR93">93</xref>]. Analysis code for generating figures can be found at   <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-manuscript">https://github.com/ckmah/bento-manuscript</ext-link> [<xref ref-type="bibr" rid="CR94">94</xref>] and is archived at 10.5281/zenodo.10815484 [<xref ref-type="bibr" rid="CR95">95</xref>]. Documentation for Bento can be found here: <ext-link ext-link-type="uri" xlink:href="http://bento-tools.readthedocs.io">http://bento-tools.readthedocs.io</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par68">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par69">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par70">G.W.Y. is a co-founder, member of the board of directors, equity holder, and paid consultant for Locanabio (until 12/31/2023) and Eclipse Bioinnovations, and a Scientific Adviser and paid consultant to Jumpcode Genomics. G.W.Y. is a Distinguished Visiting Professor at the National University of Singapore. The terms of these arrangements have been reviewed and approved by the University of California, San Diego, in accordance with its conflict-of-interest policies. The authors declare no other competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Thul PJ, Åkesson L, Wiking M, Mahdessian D, Geladaki A, Ait Blal H, et al. A subcellular map of the human proteome. Science. 2017;356. Available from: 10.1126/science.aal3321.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <citation-alternatives>
        <element-citation id="ec-CR2" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Laurila</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Vihinen</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Prediction of disease-related mutations affecting protein localization</article-title>
          <source>BMC Genomics</source>
          <year>2009</year>
          <volume>10</volume>
          <fpage>122</fpage>
          <?supplied-pmid 19309509?>
          <pub-id pub-id-type="pmid">19309509</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR2" publication-type="journal">Laurila K, Vihinen M. Prediction of disease-related mutations affecting protein localization. BMC Genomics. 2009;10:122.<pub-id pub-id-type="pmid">19309509</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <citation-alternatives>
        <element-citation id="ec-CR3" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Park</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Yang</surname>
              <given-names>J-S</given-names>
            </name>
            <name>
              <surname>Shin</surname>
              <given-names>Y-E</given-names>
            </name>
            <name>
              <surname>Park</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Jang</surname>
              <given-names>SK</given-names>
            </name>
            <name>
              <surname>Kim</surname>
              <given-names>S</given-names>
            </name>
          </person-group>
          <article-title>Protein localization as a principal feature of the etiology and comorbidity of genetic diseases</article-title>
          <source>Mol Syst Biol</source>
          <year>2011</year>
          <volume>7</volume>
          <fpage>494</fpage>
          <?supplied-pmid 21613983?>
          <pub-id pub-id-type="pmid">21613983</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR3" publication-type="journal">Park S, Yang J-S, Shin Y-E, Park J, Jang SK, Kim S. Protein localization as a principal feature of the etiology and comorbidity of genetic diseases. Mol Syst Biol. 2011;7:494.<pub-id pub-id-type="pmid">21613983</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <citation-alternatives>
        <element-citation id="ec-CR4" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Chin</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Lécuyer</surname>
              <given-names>E</given-names>
            </name>
          </person-group>
          <article-title>RNA localization: Making its way to the center stage</article-title>
          <source>Biochim Biophys Acta Gen Subj</source>
          <year>2017</year>
          <volume>1861</volume>
          <fpage>2956</fpage>
          <lpage>2970</lpage>
          <?supplied-pmid 28630007?>
          <pub-id pub-id-type="pmid">28630007</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR4" publication-type="journal">Chin A, Lécuyer E. RNA localization: Making its way to the center stage. Biochim Biophys Acta Gen Subj. 2017;1861:2956–70.<pub-id pub-id-type="pmid">28630007</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Bovaird S, Patel D, Padilla J-CA, Lécuyer E. Biological functions, regulatory mechanisms, and disease relevance of RNA localization pathways. FEBS Lett. 2018;592:2948–72.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <citation-alternatives>
        <element-citation id="ec-CR6" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Das</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Singer</surname>
              <given-names>RH</given-names>
            </name>
            <name>
              <surname>Yoon</surname>
              <given-names>YJ</given-names>
            </name>
          </person-group>
          <article-title>The travels of mRNAs in neurons: do they know where they are going?</article-title>
          <source>Curr Opin Neurobiol</source>
          <year>2019</year>
          <volume>57</volume>
          <fpage>110</fpage>
          <lpage>116</lpage>
          <?supplied-pmid 30784978?>
          <pub-id pub-id-type="pmid">30784978</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR6" publication-type="journal">Das S, Singer RH, Yoon YJ. The travels of mRNAs in neurons: do they know where they are going? Curr Opin Neurobiol. 2019;57:110–6.<pub-id pub-id-type="pmid">30784978</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Sahoo PK, Smith DS, Perrone-Bizzozero N, Twiss JL. Axonal mRNA transport and translation at a glance. J Cell Sci. 2018;131. Available from: 10.1242/jcs.196808.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">von Kügelgen N, Chekulaeva M. Conservation of a core neurite transcriptome across neuronal types and species. Wiley Interdiscip Rev RNA. 2020;e1590.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <citation-alternatives>
        <element-citation id="ec-CR9" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Culver</surname>
              <given-names>BP</given-names>
            </name>
            <name>
              <surname>DeClercq</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Dolgalev</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Yu</surname>
              <given-names>MS</given-names>
            </name>
            <name>
              <surname>Ma</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Heguy</surname>
              <given-names>A</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Huntington’s disease protein huntingtin associates with its own mRNA</article-title>
          <source>J Huntingtons Dis</source>
          <year>2016</year>
          <volume>5</volume>
          <fpage>39</fpage>
          <lpage>51</lpage>
          <?supplied-pmid 26891106?>
          <pub-id pub-id-type="pmid">26891106</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR9" publication-type="journal">Culver BP, DeClercq J, Dolgalev I, Yu MS, Ma B, Heguy A, et al. Huntington’s disease protein huntingtin associates with its own mRNA. J Huntingtons Dis. 2016;5:39–51.<pub-id pub-id-type="pmid">26891106</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <citation-alternatives>
        <element-citation id="ec-CR10" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Romo</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Mohn</surname>
              <given-names>ES</given-names>
            </name>
            <name>
              <surname>Aronin</surname>
              <given-names>N</given-names>
            </name>
          </person-group>
          <article-title>A fresh look at huntingtin mRNA processing in Huntington’s disease</article-title>
          <source>J Huntingtons Dis</source>
          <year>2018</year>
          <volume>7</volume>
          <fpage>101</fpage>
          <lpage>108</lpage>
          <?supplied-pmid 29865084?>
          <pub-id pub-id-type="pmid">29865084</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR10" publication-type="journal">Romo L, Mohn ES, Aronin N. A fresh look at huntingtin mRNA processing in Huntington’s disease. J Huntingtons Dis. 2018;7:101–8.<pub-id pub-id-type="pmid">29865084</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <citation-alternatives>
        <element-citation id="ec-CR11" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>White</surname>
              <given-names>JA</given-names>
              <suffix>2nd</suffix>
            </name>
            <name>
              <surname>Anderson</surname>
              <given-names>E</given-names>
            </name>
            <name>
              <surname>Zimmerman</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Zheng</surname>
              <given-names>KH</given-names>
            </name>
            <name>
              <surname>Rouhani</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Gunawardena</surname>
              <given-names>S</given-names>
            </name>
          </person-group>
          <article-title>Huntingtin differentially regulates the axonal transport of a sub-set of Rab-containing vesicles in vivo</article-title>
          <source>Hum Mol Genet</source>
          <year>2015</year>
          <volume>24</volume>
          <fpage>7182</fpage>
          <lpage>7195</lpage>
          <?supplied-pmid 26450517?>
          <pub-id pub-id-type="pmid">26450517</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR11" publication-type="journal">White JA 2nd, Anderson E, Zimmerman K, Zheng KH, Rouhani R, Gunawardena S. Huntingtin differentially regulates the axonal transport of a sub-set of Rab-containing vesicles in vivo. Hum Mol Genet. 2015;24:7182–95.<pub-id pub-id-type="pmid">26450517</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Fernandopulle MS, Lippincott-Schwartz J, Ward ME. RNA transport and local translation in neurodevelopmental and neurodegenerative disease. Nat Neurosci. 2021; Available from: 10.1038/s41593-020-00785-2.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Chen KH, Boettiger AN, Moffitt JR, Wang S, Zhuang X. RNA imaging. Spatially resolved, highly multiplexed RNA profiling in single cells. Science. 2015;348:aaa6090.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Eng C-HL, Lawson M, Zhu Q, Dries R, Koulena N, Takei Y, et al. Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH. Nature. 2019;568:235–9.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Gyllborg D, Langseth CM, Qian X, Choi E, Salas SM, Hilscher MM, et al. Hybridization-based in situ sequencing (HybISS) for spatially resolved transcriptomics in human and mouse brain tissue. Nucleic Acids Res. 2020; Available from: 10.1093/nar/gkaa792.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Alon S, Goodwin DR, Sinha A, Wassie AT, Chen F, Daugharthy ER, et al. Expansion sequencing: spatially precise in situ transcriptomics in intact biological systems. Cold Spring Harbor Laboratory. 2020 [cited 2020 Nov 20]. p. 2020.05.13.094268. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.05.13.094268v1">https://www.biorxiv.org/content/10.1101/2020.05.13.094268v1</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Palla G, Spitzer H, Klein M, Fischer D, Schaar AC, Kuemmerle LB, et al. Squidpy: a scalable framework for spatial omics analysis. Nat Methods. 2022; Available from: 10.1038/s41592-021-01358-2.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Pham D, Tan X, Xu J, Grice LF, Lam PY, Raghubar A, et al. stLearn: integrating spatial location, tissue morphology and gene expression to find cell types, cell-cell interactions and spatial trajectories within undissociated tissues. bioRxiv. 2020 [cited 2022 Jun 8]. p. 2020.05.31.125658. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/biorxiv/early/2020/05/31/2020.05.31.125658">https://www.biorxiv.org/content/biorxiv/early/2020/05/31/2020.05.31.125658</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Dries R, Zhu Q, Dong R, Eng C-HL, Li H, Liu K, et al. Giotto: a toolbox for integrative analysis and visualization of spatial expression data. Genome Biol. 2021;22:78.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <citation-alternatives>
        <element-citation id="ec-CR20" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Butler</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Hoffman</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Smibert</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Papalexi</surname>
              <given-names>E</given-names>
            </name>
            <name>
              <surname>Satija</surname>
              <given-names>R</given-names>
            </name>
          </person-group>
          <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
          <source>Nat Biotechnol</source>
          <year>2018</year>
          <volume>36</volume>
          <fpage>411</fpage>
          <lpage>420</lpage>
          <?supplied-pmid 29608179?>
          <pub-id pub-id-type="pmid">29608179</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR20" publication-type="journal">Butler A, Hoffman P, Smibert P, Papalexi E, Satija R. Integrating single-cell transcriptomic data across different conditions, technologies, and species. Nat Biotechnol. 2018;36:411–20.<pub-id pub-id-type="pmid">29608179</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <citation-alternatives>
        <element-citation id="ec-CR21" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Wolf</surname>
              <given-names>FA</given-names>
            </name>
            <name>
              <surname>Angerer</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Theis</surname>
              <given-names>FJ</given-names>
            </name>
          </person-group>
          <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
          <source>Genome Biol</source>
          <year>2018</year>
          <volume>19</volume>
          <fpage>15</fpage>
          <lpage>15</lpage>
          <?supplied-pmid 29409532?>
          <pub-id pub-id-type="pmid">29409532</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR21" publication-type="journal">Wolf FA, Angerer P, Theis FJ. SCANPY: large-scale single-cell gene expression data analysis. Genome Biol. 2018;19:15–15.<pub-id pub-id-type="pmid">29409532</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <citation-alternatives>
        <element-citation id="ec-CR22" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Imbert</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Ouyang</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Safieddine</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Coleno</surname>
              <given-names>E</given-names>
            </name>
            <name>
              <surname>Zimmer</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Bertrand</surname>
              <given-names>E</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>FISH-quant v2: a scalable and modular tool for smFISH image analysis</article-title>
          <source>RNA</source>
          <year>2022</year>
          <volume>28</volume>
          <fpage>786</fpage>
          <lpage>795</lpage>
          <?supplied-pmid 35347070?>
          <pub-id pub-id-type="pmid">35347070</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR22" publication-type="journal">Imbert A, Ouyang W, Safieddine A, Coleno E, Zimmer C, Bertrand E, et al. FISH-quant v2: a scalable and modular tool for smFISH image analysis. RNA. 2022;28:786–95.<pub-id pub-id-type="pmid">35347070</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Walter FC, Stegle O, Velten B. FISHFactor: A probabilistic factor model for spatial transcriptomics data with subcellular resolution. bioRxiv. 2021. Available from: 10.1101/2021.11.04.467354.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <citation-alternatives>
        <element-citation id="ec-CR24" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>He</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Tang</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Huang</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Ren</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Zhou</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>K</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>ClusterMap for multi-scale clustering analysis of spatial gene expression</article-title>
          <source>Nat Commun</source>
          <year>2021</year>
          <volume>12</volume>
          <fpage>5909</fpage>
          <?supplied-pmid 34625546?>
          <pub-id pub-id-type="pmid">34625546</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR24" publication-type="journal">He Y, Tang X, Huang J, Ren J, Zhou H, Chen K, et al. ClusterMap for multi-scale clustering analysis of spatial gene expression. Nat Commun. 2021;12:5909.<pub-id pub-id-type="pmid">34625546</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <citation-alternatives>
        <element-citation id="ec-CR25" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Petukhov</surname>
              <given-names>V</given-names>
            </name>
            <name>
              <surname>Xu</surname>
              <given-names>RJ</given-names>
            </name>
            <name>
              <surname>Soldatov</surname>
              <given-names>RA</given-names>
            </name>
            <name>
              <surname>Cadinu</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Khodosevich</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Moffitt</surname>
              <given-names>JR</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Cell segmentation in imaging-based spatial transcriptomics</article-title>
          <source>Nat Biotechnol</source>
          <year>2022</year>
          <volume>40</volume>
          <fpage>345</fpage>
          <lpage>354</lpage>
          <?supplied-pmid 34650268?>
          <pub-id pub-id-type="pmid">34650268</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR25" publication-type="journal">Petukhov V, Xu RJ, Soldatov RA, Cadinu P, Khodosevich K, Moffitt JR, et al. Cell segmentation in imaging-based spatial transcriptomics. Nat Biotechnol. 2022;40:345–54.<pub-id pub-id-type="pmid">34650268</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Spitzer H, Berry S, Donoghoe M, Pelkmans L, Theis FJ. Learning consistent subcellular landmarks to quantify changes in multiplexed protein maps. bioRxiv. 2022 [cited 2022 May 11]. p. 2022.05.07.490900. Available from: https://www.biorxiv.org/content/10.1101/2022.05.07.490900v1.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Liu CC, Greenwald NF, Kong A, McCaffrey EF, Leow KX, Mrdjen D, et al. Robust phenotyping of highly multiplexed tissue imaging data using pixel-level clustering. bioRxiv. 2022 [cited 2022 Dec 22]. p. 2022.08.16.504171. Available from: https://www.biorxiv.org/content/10.1101/2022.08.16.504171v1.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Jordahl K, Van den Bossche J, Fleischmann M, McBride J, Wasserman J, Gerard J, et al. geopandas/geopandas: v0.9.0. 2021. Available from: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4569086">https://zenodo.org/record/4569086</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Gillies S, Ward B, Petersen AS. Rasterio: Geospatial raster I/O for Python programmers. URL<ext-link ext-link-type="uri" xlink:href="https://github.com/mapbox/rasterio">https://github.com/mapbox/rasterio</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <citation-alternatives>
        <element-citation id="ec-CR30" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Virtanen</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Gommers</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Oliphant</surname>
              <given-names>TE</given-names>
            </name>
            <name>
              <surname>Haberland</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Reddy</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Cournapeau</surname>
              <given-names>D</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>
          <source>Nat Methods</source>
          <year>2020</year>
          <volume>17</volume>
          <fpage>261</fpage>
          <lpage>72</lpage>
          <?supplied-pmid 32015543?>
          <pub-id pub-id-type="pmid">32015543</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR30" publication-type="journal">Virtanen P, Gommers R, Oliphant TE, Haberland M, Reddy T, Cournapeau D, et al. SciPy 1.0: fundamental algorithms for scientific computing in Python. Nat Methods. 2020;17:261–72.<pub-id pub-id-type="pmid">32015543</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <citation-alternatives>
        <element-citation id="ec-CR31" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kossaifi</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Panagakis</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Anandkumar</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Pantic</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>TensorLy: tensor learning in Python</article-title>
          <source>J Mach Learn Res</source>
          <year>2019</year>
          <volume>20</volume>
          <fpage>1</fpage>
          <lpage>6</lpage>
        </element-citation>
        <mixed-citation id="mc-CR31" publication-type="journal">Kossaifi J, Panagakis Y, Anandkumar A, Pantic M. TensorLy: tensor learning in Python. J Mach Learn Res. 2019;20:1–6.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <citation-alternatives>
        <element-citation id="ec-CR32" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Virshup</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Bredikhin</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Heumos</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Palla</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Sturm</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Gayoso</surname>
              <given-names>A</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>The scverse project provides a computational ecosystem for single-cell omics data analysis</article-title>
          <source>Nat Biotechnol</source>
          <year>2023</year>
          <volume>41</volume>
          <fpage>604</fpage>
          <lpage>606</lpage>
          <?supplied-pmid 37037904?>
          <pub-id pub-id-type="pmid">37037904</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR32" publication-type="journal">Virshup I, Bredikhin D, Heumos L, Palla G, Sturm G, Gayoso A, et al. The scverse project provides a computational ecosystem for single-cell omics data analysis. Nat Biotechnol. 2023;41:604–6.<pub-id pub-id-type="pmid">37037904</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">He S, Bhatt R, Brown C, Brown EA, Buhr DL, Chantranuvatana K, et al. High-plex multiomic analysis in FFPE at subcellular level by spatial molecular imaging. bioRxiv. 2021. Available from: http://biorxiv.org/lookup/doi/10.1101/2021.11.03.467020.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <citation-alternatives>
        <element-citation id="ec-CR34" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lee</surname>
              <given-names>JH</given-names>
            </name>
            <name>
              <surname>Daugharthy</surname>
              <given-names>ER</given-names>
            </name>
            <name>
              <surname>Scheiman</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Kalhor</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Ferrante</surname>
              <given-names>TC</given-names>
            </name>
            <name>
              <surname>Terry</surname>
              <given-names>R</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Fluorescent in situ sequencing (FISSEQ) of RNA for gene expression profiling in intact cells and tissues</article-title>
          <source>Nat Protoc</source>
          <year>2015</year>
          <volume>10</volume>
          <fpage>442</fpage>
          <lpage>458</lpage>
          <?supplied-pmid 25675209?>
          <pub-id pub-id-type="pmid">25675209</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR34" publication-type="journal">Lee JH, Daugharthy ER, Scheiman J, Kalhor R, Ferrante TC, Terry R, et al. Fluorescent in situ sequencing (FISSEQ) of RNA for gene expression profiling in intact cells and tissues. Nat Protoc. 2015;10:442–58.<pub-id pub-id-type="pmid">25675209</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Hu S, Liu S, Bian Y, Poddar M, Singh S, Cao C, et al. Dynamic control of metabolic zonation and liver repair by endothelial cell Wnt2 and Wnt9b revealed by single cell spatial transcriptomics using Molecular Cartography. bioRxiv. 2022 [cited 2022 Apr 19]. p. 2022.03.18.484868. Available from: https://www.biorxiv.org/content/10.1101/2022.03.18.484868.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Virshup I, Rybakov S, Theis FJ, Angerer P, Alexander Wolf F. anndata: annotated data. bioRxiv. 2021 [cited 2022 Apr 20]. p. 2021.12.16.473007. Available from: https://www.biorxiv.org/content/10.1101/2021.12.16.473007v1.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <citation-alternatives>
        <element-citation id="ec-CR37" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Volkova</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Russell</surname>
              <given-names>R</given-names>
              <suffix>3rd</suffix>
            </name>
          </person-group>
          <article-title>Anthracycline cardiotoxicity: prevalence, pathogenesis and treatment</article-title>
          <source>Curr Cardiol Rev</source>
          <year>2011</year>
          <volume>7</volume>
          <fpage>214</fpage>
          <lpage>220</lpage>
          <?supplied-pmid 22758622?>
          <pub-id pub-id-type="pmid">22758622</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR37" publication-type="journal">Volkova M, Russell R 3rd. Anthracycline cardiotoxicity: prevalence, pathogenesis and treatment. Curr Cardiol Rev. 2011;7:214–20.<pub-id pub-id-type="pmid">22758622</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Viola P, Jones M. Rapid object detection using a boosted cascade of simple features. Proceedings of the 2001 IEEE Computer Society Conference on Computer Vision and Pattern Recognition CVPR 2001. 2001. p. I – I.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Imbert A, Ouyang W, Safieddine A, Coleno E, Zimmer C, Bertrand E, et al. FISH-quant v2: a scalable and modular analysis tool for smFISH image analysis. bioRxiv. 2021 [cited 2022 Feb 19]. p. 2021.07.20.453024. Available from: https://www.biorxiv.org/content/10.1101/2021.07.20.453024v1.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <citation-alternatives>
        <element-citation id="ec-CR40" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Battich</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Stoeger</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Pelkmans</surname>
              <given-names>L</given-names>
            </name>
          </person-group>
          <article-title>Image-based transcriptomics in thousands of single human cells at single-molecule resolution</article-title>
          <source>Nat Methods</source>
          <year>2013</year>
          <volume>10</volume>
          <fpage>1127</fpage>
          <lpage>1133</lpage>
          <?supplied-pmid 24097269?>
          <pub-id pub-id-type="pmid">24097269</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR40" publication-type="journal">Battich N, Stoeger T, Pelkmans L. Image-based transcriptomics in thousands of single human cells at single-molecule resolution. Nat Methods. 2013;10:1127–33.<pub-id pub-id-type="pmid">24097269</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <citation-alternatives>
        <element-citation id="ec-CR41" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Stoeger</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Battich</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Herrmann</surname>
              <given-names>MD</given-names>
            </name>
            <name>
              <surname>Yakimovich</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Pelkmans</surname>
              <given-names>L</given-names>
            </name>
          </person-group>
          <article-title>Computer vision for image-based transcriptomics</article-title>
          <source>Methods</source>
          <year>2015</year>
          <volume>85</volume>
          <fpage>44</fpage>
          <lpage>53</lpage>
          <?supplied-pmid 26014038?>
          <pub-id pub-id-type="pmid">26014038</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR41" publication-type="journal">Stoeger T, Battich N, Herrmann MD, Yakimovich Y, Pelkmans L. Computer vision for image-based transcriptomics. Methods. 2015;85:44–53.<pub-id pub-id-type="pmid">26014038</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <citation-alternatives>
        <element-citation id="ec-CR42" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Samacoits</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Chouaib</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Safieddine</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Traboulsi</surname>
              <given-names>A-M</given-names>
            </name>
            <name>
              <surname>Ouyang</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Zimmer</surname>
              <given-names>C</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>A computational framework to study sub-cellular RNA localization</article-title>
          <source>Nat Commun</source>
          <year>2018</year>
          <volume>9</volume>
          <fpage>4584</fpage>
          <?supplied-pmid 30389932?>
          <pub-id pub-id-type="pmid">30389932</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR42" publication-type="journal">Samacoits A, Chouaib R, Safieddine A, Traboulsi A-M, Ouyang W, Zimmer C, et al. A computational framework to study sub-cellular RNA localization. Nat Commun. 2018;9:4584.<pub-id pub-id-type="pmid">30389932</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <citation-alternatives>
        <element-citation id="ec-CR43" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Chouaib</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Safieddine</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Pichon</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Imbert</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Kwon</surname>
              <given-names>OS</given-names>
            </name>
            <name>
              <surname>Samacoits</surname>
              <given-names>A</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>A dual protein-mRNA localization screen reveals compartmentalized translation and widespread co-translational RNA targeting</article-title>
          <source>Dev Cell</source>
          <year>2020</year>
          <volume>54</volume>
          <fpage>773</fpage>
          <lpage>91.e5</lpage>
          <?supplied-pmid 32783880?>
          <pub-id pub-id-type="pmid">32783880</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR43" publication-type="journal">Chouaib R, Safieddine A, Pichon X, Imbert A, Kwon OS, Samacoits A, et al. A dual protein-mRNA localization screen reveals compartmentalized translation and widespread co-translational RNA targeting. Dev Cell. 2020;54:773–91.e5.<pub-id pub-id-type="pmid">32783880</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <citation-alternatives>
        <element-citation id="ec-CR44" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Moffitt</surname>
              <given-names>JR</given-names>
            </name>
            <name>
              <surname>Hao</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>KH</given-names>
            </name>
            <name>
              <surname>Babcock</surname>
              <given-names>HP</given-names>
            </name>
            <name>
              <surname>Zhuang</surname>
              <given-names>X</given-names>
            </name>
          </person-group>
          <article-title>High-throughput single-cell gene-expression profiling with multiplexed error-robust fluorescence in situ hybridization</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2016</year>
          <volume>113</volume>
          <fpage>11046</fpage>
          <lpage>11051</lpage>
          <?supplied-pmid 27625426?>
          <pub-id pub-id-type="pmid">27625426</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR44" publication-type="journal">Moffitt JR, Hao J, Wang G, Chen KH, Babcock HP, Zhuang X. High-throughput single-cell gene-expression profiling with multiplexed error-robust fluorescence in situ hybridization. Proc Natl Acad Sci U S A. 2016;113:11046–51.<pub-id pub-id-type="pmid">27625426</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Kumar A, Schrader A, Boroojeny A, Asadian M, Lee J, Song Y, et al. Intracellular Spatial Transcriptomic Analysis Toolkit (InSTAnT). Research Square. 2023 [cited 2023 Jan 31]. Available from: <ext-link ext-link-type="uri" xlink:href="https://assets.researchsquare.com/files/rs-2481749/v1/f2ccb04e8b30b4bc00a8ea1e.pdf?c=1674833501">https://assets.researchsquare.com/files/rs-2481749/v1/f2ccb04e8b30b4bc00a8ea1e.pdf?c=1674833501</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <citation-alternatives>
        <element-citation id="ec-CR46" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xia</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Fan</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Emanuel</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Hao</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Zhuang</surname>
              <given-names>X</given-names>
            </name>
          </person-group>
          <article-title>Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2019</year>
          <volume>116</volume>
          <fpage>19490</fpage>
          <lpage>19499</lpage>
          <?supplied-pmid 31501331?>
          <pub-id pub-id-type="pmid">31501331</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR46" publication-type="journal">Xia C, Fan J, Emanuel G, Hao J, Zhuang X. Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression. Proc Natl Acad Sci U S A. 2019;116:19490–9.<pub-id pub-id-type="pmid">31501331</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <citation-alternatives>
        <element-citation id="ec-CR47" publication-type="journal">
          <person-group person-group-type="author">
            <collab>Gene Ontology Consortium</collab>
          </person-group>
          <article-title>The Gene Ontology resource: enriching a GOld mine</article-title>
          <source>Nucleic Acids Res</source>
          <year>2021</year>
          <volume>49</volume>
          <fpage>D325</fpage>
          <lpage>D334</lpage>
          <pub-id pub-id-type="pmid">33290552</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR47" publication-type="journal">Gene Ontology Consortium. The Gene Ontology resource: enriching a GOld mine. Nucleic Acids Res. 2021;49:D325–34.<pub-id pub-id-type="pmid">33290552</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <citation-alternatives>
        <element-citation id="ec-CR48" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xu</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Belyi</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Bojic</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Ratti</surname>
              <given-names>C</given-names>
            </name>
          </person-group>
          <article-title>How friends share urban space: an exploratory spatiotemporal analysis using mobile phone data</article-title>
          <source>Trans GIS</source>
          <year>2017</year>
          <volume>21</volume>
          <fpage>468</fpage>
          <lpage>487</lpage>
        </element-citation>
        <mixed-citation id="mc-CR48" publication-type="journal">Xu Y, Belyi A, Bojic I, Ratti C. How friends share urban space: an exploratory spatiotemporal analysis using mobile phone data. Trans GIS. 2017;21:468–87.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Zeng H, Huang J, Ren J, Wang CK, Tang Z, Zhou H, et al. Spatially resolved single-cell translatomics at molecular resolution. Science. 2023;380:eadd3067.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <citation-alternatives>
        <element-citation id="ec-CR50" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ripley</surname>
              <given-names>BD</given-names>
            </name>
          </person-group>
          <article-title>The second-order analysis of stationary point processes</article-title>
          <source>J Appl Probab</source>
          <year>1976</year>
          <volume>13</volume>
          <fpage>255</fpage>
          <lpage>266</lpage>
        </element-citation>
        <mixed-citation id="mc-CR50" publication-type="journal">Ripley BD. The second-order analysis of stationary point processes. J Appl Probab. 1976;13:255–66.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Tiefelsdorf M. Modelling spatial processes: the identification and analysis of spatial relationships in regression residuals by means of Moran’s I. Springer; 2006.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Cliff AD, Ord JK. Spatial processes: models &amp; applications. Pion; 1981.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Leslie TF, Kronenfeld BJ. The colocation quotient: a new measure of spatial association between categorical subsets of points. 协同区位商:点集分类子集间空间关联性的新度量标准: The colocation quotient. Geogr Anal. 2011;43:306–26.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Shashua A, Hazan T. Non-negative tensor factorization with applications to statistics and computer vision. Proceedings of the 22nd international conference on Machine learning. New York, NY, USA: Association for Computing Machinery; 2005. p. 792–9.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <mixed-citation publication-type="other">Gassmann R. Dynein at the kinetochore. J Cell Sci. 2023;136. Available from: 10.1242/jcs.220269.</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <citation-alternatives>
        <element-citation id="ec-CR56" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gupta</surname>
              <given-names>MN</given-names>
            </name>
            <name>
              <surname>Uversky</surname>
              <given-names>VN</given-names>
            </name>
          </person-group>
          <article-title>Moonlighting enzymes: when cellular context defines specificity</article-title>
          <source>Cell Mol Life Sci</source>
          <year>2023</year>
          <volume>80</volume>
          <fpage>130</fpage>
          <?supplied-pmid 37093283?>
          <pub-id pub-id-type="pmid">37093283</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR56" publication-type="journal">Gupta MN, Uversky VN. Moonlighting enzymes: when cellular context defines specificity. Cell Mol Life Sci. 2023;80:130.<pub-id pub-id-type="pmid">37093283</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <citation-alternatives>
        <element-citation id="ec-CR57" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gnann</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Cesnik</surname>
              <given-names>AJ</given-names>
            </name>
            <name>
              <surname>Lundberg</surname>
              <given-names>E</given-names>
            </name>
          </person-group>
          <article-title>Illuminating non-genetic cellular heterogeneity with imaging-based spatial proteomics</article-title>
          <source>Trends Cancer Res</source>
          <year>2021</year>
          <volume>7</volume>
          <fpage>278</fpage>
          <lpage>282</lpage>
        </element-citation>
        <mixed-citation id="mc-CR57" publication-type="journal">Gnann C, Cesnik AJ, Lundberg E. Illuminating non-genetic cellular heterogeneity with imaging-based spatial proteomics. Trends Cancer Res. 2021;7:278–82.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <citation-alternatives>
        <element-citation id="ec-CR58" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Fazal</surname>
              <given-names>FM</given-names>
            </name>
            <name>
              <surname>Han</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Parker</surname>
              <given-names>KR</given-names>
            </name>
            <name>
              <surname>Kaewsapsak</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Xu</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Boettiger</surname>
              <given-names>AN</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Atlas of subcellular RNA localization revealed by APEX-Seq</article-title>
          <source>Cell</source>
          <year>2019</year>
          <volume>178</volume>
          <fpage>473</fpage>
          <lpage>90.e26</lpage>
          <?supplied-pmid 31230715?>
          <pub-id pub-id-type="pmid">31230715</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR58" publication-type="journal">Fazal FM, Han S, Parker KR, Kaewsapsak P, Xu J, Boettiger AN, et al. Atlas of subcellular RNA localization revealed by APEX-Seq. Cell. 2019;178:473–90.e26.<pub-id pub-id-type="pmid">31230715</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <citation-alternatives>
        <element-citation id="ec-CR59" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Janesick</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Shelansky</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Gottscho</surname>
              <given-names>AD</given-names>
            </name>
            <name>
              <surname>Wagner</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Williams</surname>
              <given-names>SR</given-names>
            </name>
            <name>
              <surname>Rouault</surname>
              <given-names>M</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis</article-title>
          <source>Nat Commun</source>
          <year>2023</year>
          <volume>14</volume>
          <fpage>8353</fpage>
          <?supplied-pmid 38114474?>
          <pub-id pub-id-type="pmid">38114474</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR59" publication-type="journal">Janesick A, Shelansky R, Gottscho AD, Wagner F, Williams SR, Rouault M, et al. High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis. Nat Commun. 2023;14:8353.<pub-id pub-id-type="pmid">38114474</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <citation-alternatives>
        <element-citation id="ec-CR60" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Young</surname>
              <given-names>RC</given-names>
            </name>
            <name>
              <surname>Ozols</surname>
              <given-names>RF</given-names>
            </name>
            <name>
              <surname>Myers</surname>
              <given-names>CE</given-names>
            </name>
          </person-group>
          <article-title>The anthracycline antineoplastic drugs</article-title>
          <source>N Engl J Med</source>
          <year>1981</year>
          <volume>305</volume>
          <fpage>139</fpage>
          <lpage>153</lpage>
          <?supplied-pmid 7017406?>
          <pub-id pub-id-type="pmid">7017406</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR60" publication-type="journal">Young RC, Ozols RF, Myers CE. The anthracycline antineoplastic drugs. N Engl J Med. 1981;305:139–53.<pub-id pub-id-type="pmid">7017406</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <citation-alternatives>
        <element-citation id="ec-CR61" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kalyanaraman</surname>
              <given-names>B</given-names>
            </name>
          </person-group>
          <article-title>Teaching the basics of the mechanism of doxorubicin-induced cardiotoxicity: Have we been barking up the wrong tree?</article-title>
          <source>Redox Biol</source>
          <year>2020</year>
          <volume>29</volume>
          <fpage>101394</fpage>
          <?supplied-pmid 31790851?>
          <pub-id pub-id-type="pmid">31790851</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR61" publication-type="journal">Kalyanaraman B. Teaching the basics of the mechanism of doxorubicin-induced cardiotoxicity: Have we been barking up the wrong tree? Redox Biol. 2020;29: 101394.<pub-id pub-id-type="pmid">31790851</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <citation-alternatives>
        <element-citation id="ec-CR62" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sheibani</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Azizi</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Shayan</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Nezamoleslami</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Eslami</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Farjoo</surname>
              <given-names>MH</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Doxorubicin-induced cardiotoxicity: an overview on pre-clinical therapeutic approaches</article-title>
          <source>Cardiovasc Toxicol</source>
          <year>2022</year>
          <volume>22</volume>
          <fpage>292</fpage>
          <lpage>310</lpage>
          <?supplied-pmid 35061218?>
          <pub-id pub-id-type="pmid">35061218</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR62" publication-type="journal">Sheibani M, Azizi Y, Shayan M, Nezamoleslami S, Eslami F, Farjoo MH, et al. Doxorubicin-induced cardiotoxicity: an overview on pre-clinical therapeutic approaches. Cardiovasc Toxicol. 2022;22:292–310.<pub-id pub-id-type="pmid">35061218</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <citation-alternatives>
        <element-citation id="ec-CR63" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yu</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Kong</surname>
              <given-names>Q</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Lu</surname>
              <given-names>J-J</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>X</given-names>
            </name>
          </person-group>
          <article-title>Recent progress in doxorubicin-induced cardiotoxicity and protective potential of natural products</article-title>
          <source>Phytomedicine</source>
          <year>2018</year>
          <volume>40</volume>
          <fpage>125</fpage>
          <lpage>139</lpage>
          <?supplied-pmid 29496165?>
          <pub-id pub-id-type="pmid">29496165</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR63" publication-type="journal">Yu J, Wang C, Kong Q, Wu X, Lu J-J, Chen X. Recent progress in doxorubicin-induced cardiotoxicity and protective potential of natural products. Phytomedicine. 2018;40:125–39.<pub-id pub-id-type="pmid">29496165</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <citation-alternatives>
        <element-citation id="ec-CR64" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rahman</surname>
              <given-names>AM</given-names>
            </name>
            <name>
              <surname>Yusuf</surname>
              <given-names>SW</given-names>
            </name>
            <name>
              <surname>Ewer</surname>
              <given-names>MS</given-names>
            </name>
          </person-group>
          <article-title>Anthracycline-induced cardiotoxicity and the cardiac-sparing effect of liposomal formulation</article-title>
          <source>Int J Nanomedicine</source>
          <year>2007</year>
          <volume>2</volume>
          <fpage>567</fpage>
          <lpage>583</lpage>
          <?supplied-pmid 18203425?>
          <pub-id pub-id-type="pmid">18203425</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR64" publication-type="journal">Rahman AM, Yusuf SW, Ewer MS. Anthracycline-induced cardiotoxicity and the cardiac-sparing effect of liposomal formulation. Int J Nanomedicine. 2007;2:567–83.<pub-id pub-id-type="pmid">18203425</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <citation-alternatives>
        <element-citation id="ec-CR65" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xu</surname>
              <given-names>MF</given-names>
            </name>
            <name>
              <surname>Tang</surname>
              <given-names>PL</given-names>
            </name>
            <name>
              <surname>Qian</surname>
              <given-names>ZM</given-names>
            </name>
            <name>
              <surname>Ashraf</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Effects by doxorubicin on the myocardium are mediated by oxygen free radicals</article-title>
          <source>Life Sci</source>
          <year>2001</year>
          <volume>68</volume>
          <fpage>889</fpage>
          <lpage>901</lpage>
          <?supplied-pmid 11213359?>
          <pub-id pub-id-type="pmid">11213359</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR65" publication-type="journal">Xu MF, Tang PL, Qian ZM, Ashraf M. Effects by doxorubicin on the myocardium are mediated by oxygen free radicals. Life Sci. 2001;68:889–901.<pub-id pub-id-type="pmid">11213359</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <citation-alternatives>
        <element-citation id="ec-CR66" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Šimůnek</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Štěrba</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Popelová</surname>
              <given-names>O</given-names>
            </name>
            <name>
              <surname>Adamcová</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Hrdina</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Geršl</surname>
              <given-names>V</given-names>
            </name>
          </person-group>
          <article-title>Anthracycline-induced cardiotoxicity: overview of studies examining the roles of oxidative stress and free cellular iron</article-title>
          <source>Pharmacol Rep</source>
          <year>2009</year>
          <volume>61</volume>
          <fpage>154</fpage>
          <lpage>171</lpage>
          <?supplied-pmid 19307704?>
          <pub-id pub-id-type="pmid">19307704</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR66" publication-type="journal">Šimůnek T, Štěrba M, Popelová O, Adamcová M, Hrdina R, Geršl V. Anthracycline-induced cardiotoxicity: overview of studies examining the roles of oxidative stress and free cellular iron. Pharmacol Rep. 2009;61:154–71.<pub-id pub-id-type="pmid">19307704</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <citation-alternatives>
        <element-citation id="ec-CR67" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xiong</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>Y-Z</given-names>
            </name>
            <name>
              <surname>Zhang</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>Z-X</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>X-Y</given-names>
            </name>
            <name>
              <surname>Jiang</surname>
              <given-names>P</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Protective effect of berberine on acute cardiomyopathy associated with doxorubicin treatment</article-title>
          <source>Oncol Lett</source>
          <year>2018</year>
          <volume>15</volume>
          <fpage>5721</fpage>
          <lpage>5729</lpage>
          <?supplied-pmid 29552206?>
          <pub-id pub-id-type="pmid">29552206</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR67" publication-type="journal">Xiong C, Wu Y-Z, Zhang Y, Wu Z-X, Chen X-Y, Jiang P, et al. Protective effect of berberine on acute cardiomyopathy associated with doxorubicin treatment. Oncol Lett. 2018;15:5721–9.<pub-id pub-id-type="pmid">29552206</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <citation-alternatives>
        <element-citation id="ec-CR68" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Asensio-López</surname>
              <given-names>MC</given-names>
            </name>
            <name>
              <surname>Soler</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Pascual-Figal</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Fernández-Belda</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Lax</surname>
              <given-names>A</given-names>
            </name>
          </person-group>
          <article-title>Doxorubicin-induced oxidative stress: the protective effect of nicorandil on HL-1 cardiomyocytes</article-title>
          <source>PLoS ONE</source>
          <year>2017</year>
          <volume>12</volume>
          <fpage>e0172803</fpage>
          <?supplied-pmid 28245258?>
          <pub-id pub-id-type="pmid">28245258</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR68" publication-type="journal">Asensio-López MC, Soler F, Pascual-Figal D, Fernández-Belda F, Lax A. Doxorubicin-induced oxidative stress: the protective effect of nicorandil on HL-1 cardiomyocytes. PLoS ONE. 2017;12: e0172803.<pub-id pub-id-type="pmid">28245258</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <citation-alternatives>
        <element-citation id="ec-CR69" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rawat</surname>
              <given-names>PS</given-names>
            </name>
            <name>
              <surname>Jaiswal</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Khurana</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Bhatti</surname>
              <given-names>JS</given-names>
            </name>
            <name>
              <surname>Navik</surname>
              <given-names>U</given-names>
            </name>
          </person-group>
          <article-title>Doxorubicin-induced cardiotoxicity: an update on the molecular mechanism and novel therapeutic strategies for effective management</article-title>
          <source>Biomed Pharmacother</source>
          <year>2021</year>
          <volume>139</volume>
          <fpage>111708</fpage>
          <?supplied-pmid 34243633?>
          <pub-id pub-id-type="pmid">34243633</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR69" publication-type="journal">Rawat PS, Jaiswal A, Khurana A, Bhatti JS, Navik U. Doxorubicin-induced cardiotoxicity: an update on the molecular mechanism and novel therapeutic strategies for effective management. Biomed Pharmacother. 2021;139: 111708.<pub-id pub-id-type="pmid">34243633</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <citation-alternatives>
        <element-citation id="ec-CR70" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Stringer</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Michaelos</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Pachitariu</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Cellpose: a generalist algorithm for cellular segmentation</article-title>
          <source>Nat Methods</source>
          <year>2021</year>
          <volume>18</volume>
          <fpage>100</fpage>
          <lpage>106</lpage>
          <?supplied-pmid 33318659?>
          <pub-id pub-id-type="pmid">33318659</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR70" publication-type="journal">Stringer C, Wang T, Michaelos M, Pachitariu M. Cellpose: a generalist algorithm for cellular segmentation. Nat Methods. 2021;18:100–6.<pub-id pub-id-type="pmid">33318659</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <citation-alternatives>
        <element-citation id="ec-CR71" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Song</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>Q</given-names>
            </name>
          </person-group>
          <article-title>Atrial natriuretic peptide in cardiovascular biology and disease (NPPA)</article-title>
          <source>Gene</source>
          <year>2015</year>
          <volume>569</volume>
          <fpage>1</fpage>
          <lpage>6</lpage>
          <?supplied-pmid 26074089?>
          <pub-id pub-id-type="pmid">26074089</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR71" publication-type="journal">Song W, Wang H, Wu Q. Atrial natriuretic peptide in cardiovascular biology and disease (NPPA). Gene. 2015;569:1–6.<pub-id pub-id-type="pmid">26074089</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <citation-alternatives>
        <element-citation id="ec-CR72" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Man</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Barnett</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Christoffels</surname>
              <given-names>VM</given-names>
            </name>
          </person-group>
          <article-title>Structure and function of the Nppa-Nppb cluster locus during heart development and disease</article-title>
          <source>Cell Mol Life Sci</source>
          <year>2018</year>
          <volume>75</volume>
          <fpage>1435</fpage>
          <lpage>1444</lpage>
          <?supplied-pmid 29302701?>
          <pub-id pub-id-type="pmid">29302701</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR72" publication-type="journal">Man J, Barnett P, Christoffels VM. Structure and function of the Nppa-Nppb cluster locus during heart development and disease. Cell Mol Life Sci. 2018;75:1435–44.<pub-id pub-id-type="pmid">29302701</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <citation-alternatives>
        <element-citation id="ec-CR73" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lewis</surname>
              <given-names>YE</given-names>
            </name>
            <name>
              <surname>Moskovitz</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Mutlak</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Heineke</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Caspi</surname>
              <given-names>LH</given-names>
            </name>
            <name>
              <surname>Kehat</surname>
              <given-names>I</given-names>
            </name>
          </person-group>
          <article-title>Localization of transcripts, translation, and degradation for spatiotemporal sarcomere maintenance</article-title>
          <source>J Mol Cell Cardiol</source>
          <year>2018</year>
          <volume>116</volume>
          <fpage>16</fpage>
          <lpage>28</lpage>
          <?supplied-pmid 29371135?>
          <pub-id pub-id-type="pmid">29371135</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR73" publication-type="journal">Lewis YE, Moskovitz A, Mutlak M, Heineke J, Caspi LH, Kehat I. Localization of transcripts, translation, and degradation for spatiotemporal sarcomere maintenance. J Mol Cell Cardiol. 2018;116:16–28.<pub-id pub-id-type="pmid">29371135</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <mixed-citation publication-type="other">Smalec BM, Ietswaart R, Choquet K, McShane E, West ER, Churchman LS. Genome-wide quantification of RNA flow across subcellular compartments reveals determinants of the mammalian transcript life cycle. bioRxiv. 2022. p. 2022.08.21.504696. Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2022/08/21/2022.08.21.504696.abstract">http://biorxiv.org/content/early/2022/08/21/2022.08.21.504696.abstract</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <citation-alternatives>
        <element-citation id="ec-CR75" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sardão</surname>
              <given-names>VA</given-names>
            </name>
            <name>
              <surname>Oliveira</surname>
              <given-names>PJ</given-names>
            </name>
            <name>
              <surname>Holy</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Oliveira</surname>
              <given-names>CR</given-names>
            </name>
            <name>
              <surname>Wallace</surname>
              <given-names>KB</given-names>
            </name>
          </person-group>
          <article-title>Morphological alterations induced by doxorubicin on H9c2 myoblasts: nuclear, mitochondrial, and cytoskeletal targets</article-title>
          <source>Cell Biol Toxicol</source>
          <year>2009</year>
          <volume>25</volume>
          <fpage>227</fpage>
          <lpage>243</lpage>
          <?supplied-pmid 18386138?>
          <pub-id pub-id-type="pmid">18386138</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR75" publication-type="journal">Sardão VA, Oliveira PJ, Holy J, Oliveira CR, Wallace KB. Morphological alterations induced by doxorubicin on H9c2 myoblasts: nuclear, mitochondrial, and cytoskeletal targets. Cell Biol Toxicol. 2009;25:227–43.<pub-id pub-id-type="pmid">18386138</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <citation-alternatives>
        <element-citation id="ec-CR76" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Meissner</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Weissgerber</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Londoño</surname>
              <given-names>JEC</given-names>
            </name>
            <name>
              <surname>Prenen</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Link</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Ruppenthal</surname>
              <given-names>S</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Moderate calcium channel dysfunction in adult mice with inducible cardiomyocyte-specific excision of the cacnb2 gene</article-title>
          <source>J Biol Chem</source>
          <year>2011</year>
          <volume>286</volume>
          <fpage>15875</fpage>
          <lpage>15882</lpage>
          <?supplied-pmid 21357697?>
          <pub-id pub-id-type="pmid">21357697</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR76" publication-type="journal">Meissner M, Weissgerber P, Londoño JEC, Prenen J, Link S, Ruppenthal S, et al. Moderate calcium channel dysfunction in adult mice with inducible cardiomyocyte-specific excision of the cacnb2 gene. J Biol Chem. 2011;286:15875–82.<pub-id pub-id-type="pmid">21357697</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <mixed-citation publication-type="other">Hallou A, He R, Simons BD, Dumitrascu B. A computational pipeline for spatial mechano-transcriptomics. bioRxiv. 2023 [cited 2023 Aug 15]. p. 2023.08.03.551894. Available from: https://www.biorxiv.org/content/10.1101/2023.08.03.551894v1.</mixed-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <citation-alternatives>
        <element-citation id="ec-CR78" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Cohen</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>A coefficient of agreement for nominal scales</article-title>
          <source>Educ Psychol Meas</source>
          <year>1960</year>
          <volume>20</volume>
          <fpage>37</fpage>
          <lpage>46</lpage>
        </element-citation>
        <mixed-citation id="mc-CR78" publication-type="journal">Cohen J. A coefficient of agreement for nominal scales. Educ Psychol Meas. 1960;20:37–46.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <citation-alternatives>
        <element-citation id="ec-CR79" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Subramanian</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Tamayo</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Mootha</surname>
              <given-names>VK</given-names>
            </name>
            <name>
              <surname>Mukherjee</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Ebert</surname>
              <given-names>BL</given-names>
            </name>
            <name>
              <surname>Gillette</surname>
              <given-names>MA</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2005</year>
          <volume>102</volume>
          <fpage>15545</fpage>
          <lpage>15550</lpage>
          <?supplied-pmid 16199517?>
          <pub-id pub-id-type="pmid">16199517</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR79" publication-type="journal">Subramanian A, Tamayo P, Mootha VK, Mukherjee S, Ebert BL, Gillette MA, et al. Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles. Proc Natl Acad Sci U S A. 2005;102:15545–50.<pub-id pub-id-type="pmid">16199517</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <citation-alternatives>
        <element-citation id="ec-CR80" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Barbie</surname>
              <given-names>DA</given-names>
            </name>
            <name>
              <surname>Tamayo</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Boehm</surname>
              <given-names>JS</given-names>
            </name>
            <name>
              <surname>Kim</surname>
              <given-names>SY</given-names>
            </name>
            <name>
              <surname>Moody</surname>
              <given-names>SE</given-names>
            </name>
            <name>
              <surname>Dunn</surname>
              <given-names>IF</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Systematic RNA interference reveals that oncogenic KRAS-driven cancers require TBK1</article-title>
          <source>Nature</source>
          <year>2009</year>
          <volume>462</volume>
          <fpage>108</fpage>
          <lpage>112</lpage>
          <?supplied-pmid 19847166?>
          <pub-id pub-id-type="pmid">19847166</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR80" publication-type="journal">Barbie DA, Tamayo P, Boehm JS, Kim SY, Moody SE, Dunn IF, et al. Systematic RNA interference reveals that oncogenic KRAS-driven cancers require TBK1. Nature. 2009;462:108–12.<pub-id pub-id-type="pmid">19847166</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <citation-alternatives>
        <element-citation id="ec-CR81" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xie</surname>
              <given-names>Z</given-names>
            </name>
            <name>
              <surname>Bailey</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Kuleshov</surname>
              <given-names>MV</given-names>
            </name>
            <name>
              <surname>Clarke</surname>
              <given-names>DJB</given-names>
            </name>
            <name>
              <surname>Evangelista</surname>
              <given-names>JE</given-names>
            </name>
            <name>
              <surname>Jenkins</surname>
              <given-names>SL</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene set knowledge discovery with Enrichr</article-title>
          <source>Curr Protoc</source>
          <year>2021</year>
          <volume>1</volume>
          <fpage>e90</fpage>
          <?supplied-pmid 33780170?>
          <pub-id pub-id-type="pmid">33780170</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR81" publication-type="journal">Xie Z, Bailey A, Kuleshov MV, Clarke DJB, Evangelista JE, Jenkins SL, et al. Gene set knowledge discovery with Enrichr. Curr Protoc. 2021;1: e90.<pub-id pub-id-type="pmid">33780170</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <mixed-citation publication-type="other">Vettigli G. minisom: :red_circle: MiniSom is a minimalistic implementation of the Self Organizing Maps. Github; [cited 2024 Jan 17]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/JustGlowing/minisom">https://github.com/JustGlowing/minisom</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <mixed-citation publication-type="other">Badia-i-Mompel P, Vélez Santiago J, Braunger J, Geiss C, Dimitrov D, Müller-Dott S, et al. decoupleR: ensemble of computational methods to infer biological activities from omics data. Bioinformatics Advances. 2022;2:vbac016.</mixed-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <citation-alternatives>
        <element-citation id="ec-CR84" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Huang</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Zhu</surname>
              <given-names>Q</given-names>
            </name>
            <name>
              <surname>Jussila</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Han</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Bintu</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Kern</surname>
              <given-names>C</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>CTCF mediates dosage- and sequence-context-dependent transcriptional insulation by forming local chromatin domains</article-title>
          <source>Nat Genet</source>
          <year>2021</year>
          <volume>53</volume>
          <fpage>1064</fpage>
          <lpage>1074</lpage>
          <?supplied-pmid 34002095?>
          <pub-id pub-id-type="pmid">34002095</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR84" publication-type="journal">Huang H, Zhu Q, Jussila A, Han Y, Bintu B, Kern C, et al. CTCF mediates dosage- and sequence-context-dependent transcriptional insulation by forming local chromatin domains. Nat Genet. 2021;53:1064–74.<pub-id pub-id-type="pmid">34002095</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <mixed-citation publication-type="other">Emanuel G, seichhorn, Babcock H, leonardosepulveda, timblosser. ZhuangLab/MERlin: MERlin v0.1.6. 2020. Available from: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/3758540">https://zenodo.org/record/3758540</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <citation-alternatives>
        <element-citation id="ec-CR86" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lian</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Hsiao</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Wilson</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Zhu</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Hazeltine</surname>
              <given-names>LB</given-names>
            </name>
            <name>
              <surname>Azarin</surname>
              <given-names>SM</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Robust cardiomyocyte differentiation from human pluripotent stem cells via temporal modulation of canonical Wnt signaling</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2012</year>
          <volume>109</volume>
          <fpage>E1848</fpage>
          <lpage>E1857</lpage>
          <?supplied-pmid 22645348?>
          <pub-id pub-id-type="pmid">22645348</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR86" publication-type="journal">Lian X, Hsiao C, Wilson G, Zhu K, Hazeltine LB, Azarin SM, et al. Robust cardiomyocyte differentiation from human pluripotent stem cells via temporal modulation of canonical Wnt signaling. Proc Natl Acad Sci U S A. 2012;109:E1848–57.<pub-id pub-id-type="pmid">22645348</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <citation-alternatives>
        <element-citation id="ec-CR87" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Frankish</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Diekhans</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Ferreira</surname>
              <given-names>A-M</given-names>
            </name>
            <name>
              <surname>Johnson</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Jungreis</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Loveland</surname>
              <given-names>J</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>GENCODE reference annotation for the human and mouse genomes</article-title>
          <source>Nucleic Acids Res</source>
          <year>2019</year>
          <volume>47</volume>
          <fpage>D766</fpage>
          <lpage>D773</lpage>
          <?supplied-pmid 30357393?>
          <pub-id pub-id-type="pmid">30357393</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR87" publication-type="journal">Frankish A, Diekhans M, Ferreira A-M, Johnson R, Jungreis I, Loveland J, et al. GENCODE reference annotation for the human and mouse genomes. Nucleic Acids Res. 2019;47:D766–73.<pub-id pub-id-type="pmid">30357393</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <citation-alternatives>
        <element-citation id="ec-CR88" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yates</surname>
              <given-names>AD</given-names>
            </name>
            <name>
              <surname>Achuthan</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Akanni</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Allen</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Allen</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Alvarez-Jarreta</surname>
              <given-names>J</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Ensembl 2020</article-title>
          <source>Nucleic Acids Res</source>
          <year>2020</year>
          <volume>48</volume>
          <fpage>D682</fpage>
          <lpage>D688</lpage>
          <?supplied-pmid 31691826?>
          <pub-id pub-id-type="pmid">31691826</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR88" publication-type="journal">Yates AD, Achuthan P, Akanni W, Allen J, Allen J, Alvarez-Jarreta J, et al. Ensembl 2020. Nucleic Acids Res. 2020;48:D682–8.<pub-id pub-id-type="pmid">31691826</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <citation-alternatives>
        <element-citation id="ec-CR89" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Marçais</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Kingsford</surname>
              <given-names>C</given-names>
            </name>
          </person-group>
          <article-title>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</article-title>
          <source>Bioinformatics</source>
          <year>2011</year>
          <volume>27</volume>
          <fpage>764</fpage>
          <lpage>770</lpage>
          <?supplied-pmid 21217122?>
          <pub-id pub-id-type="pmid">21217122</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR89" publication-type="journal">Marçais G, Kingsford C. A fast, lock-free approach for efficient parallel counting of occurrences of k-mers. Bioinformatics. 2011;27:764–70.<pub-id pub-id-type="pmid">21217122</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <citation-alternatives>
        <element-citation id="ec-CR90" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gans</surname>
              <given-names>JD</given-names>
            </name>
            <name>
              <surname>Wolinsky</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Improved assay-dependent searching of nucleic acid sequence databases</article-title>
          <source>Nucleic Acids Res</source>
          <year>2008</year>
          <volume>36</volume>
          <fpage>e74</fpage>
          <?supplied-pmid 18515842?>
          <pub-id pub-id-type="pmid">18515842</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR90" publication-type="journal">Gans JD, Wolinsky M. Improved assay-dependent searching of nucleic acid sequence databases. Nucleic Acids Res. 2008;36: e74.<pub-id pub-id-type="pmid">18515842</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <citation-alternatives>
        <element-citation id="ec-CR91" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rodriguez</surname>
              <given-names>JM</given-names>
            </name>
            <name>
              <surname>Rodriguez-Rivas</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Di Domenico</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Vázquez</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Valencia</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Tress</surname>
              <given-names>ML</given-names>
            </name>
          </person-group>
          <article-title>APPRIS 2017: principal isoforms for multiple gene sets</article-title>
          <source>Nucleic Acids Res</source>
          <year>2018</year>
          <volume>46</volume>
          <fpage>D213</fpage>
          <lpage>D217</lpage>
          <?supplied-pmid 29069475?>
          <pub-id pub-id-type="pmid">29069475</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR91" publication-type="journal">Rodriguez JM, Rodriguez-Rivas J, Di Domenico T, Vázquez J, Valencia A, Tress ML. APPRIS 2017: principal isoforms for multiple gene sets. Nucleic Acids Res. 2018;46:D213–7.<pub-id pub-id-type="pmid">29069475</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <mixed-citation publication-type="other">Bento MC Manuscript Datasets 2023 figshare [10.6084/m9.figshare.c.6564043.v1.</mixed-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <mixed-citation publication-type="other">ckmah/bento-tools: a Python toolkit for subcellular analysis of spatial transcriptomics data. GitHub. [cited 2024 Mar 13]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-tools">https://github.com/ckmah/bento-tools</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <mixed-citation publication-type="other">Mah C. bento-manuscript: Analyses to reproduce figures in the Bento manuscript. Github; [cited 2024 Mar 13]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-manuscript">https://github.com/ckmah/bento-manuscript</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <mixed-citation publication-type="other">Mah C. Bento manuscript source code. Zenodo; 2024 [cited 2024 Mar 13]. Available from: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/10815484">https://zenodo.org/records/10815484</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">11289963</article-id>
    <article-id pub-id-type="pmid">38566187</article-id>
    <article-id pub-id-type="publisher-id">3217</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-024-03217-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bento: a toolkit for subcellular analysis of spatial transcriptomics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Mah</surname>
          <given-names>Clarence K.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Ahmed</surname>
          <given-names>Noorsher</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lopez</surname>
          <given-names>Nicole A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lam</surname>
          <given-names>Dylan C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pong</surname>
          <given-names>Avery</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Monell</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kern</surname>
          <given-names>Colin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Han</surname>
          <given-names>Yuanyuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Prasad</surname>
          <given-names>Gino</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cesnik</surname>
          <given-names>Anthony J.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lundberg</surname>
          <given-names>Emma</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Quan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Carter</surname>
          <given-names>Hannah</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0799-6037</contrib-id>
        <name>
          <surname>Yeo</surname>
          <given-names>Gene W.</given-names>
        </name>
        <address>
          <email>geneyeo@ucsd.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff10">10</xref>
        <xref ref-type="aff" rid="Aff11">11</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Division of Medical Genetics, Department of Medicine, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Department of Cellular and Molecular Medicine, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff3"><label>3</label>Sanford Stem Cell Institute Innovation Center, La Jolla, CA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Division of Biological Sciences, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Department of Bioengineering, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Center for Epigenomics, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f54p054</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8956</institution-id><institution>Department of Bioengineering, </institution><institution>Stanford University, </institution></institution-wrap>Stanford, CA USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00f54p054</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8956</institution-id><institution>Department of Pathology, </institution><institution>Stanford University, </institution></institution-wrap>Stanford, CA USA </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00knt4f32</institution-id><institution-id institution-id-type="GRID">grid.499295.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 9234 0175</institution-id><institution>Chan-Zuckerberg Biohub, </institution></institution-wrap>San Francisco, CA USA </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Stem Cell Program, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
      <aff id="Aff11"><label>11</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/0168r3w48</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>Institute for Genomic Medicine, </institution><institution>University of California San Diego, </institution></institution-wrap>La Jolla, CA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>4</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <elocation-id>82</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The spatial organization of molecules in a cell is essential for their functions. While current methods focus on discerning tissue architecture, cell–cell interactions, and spatial expression patterns, they are limited to the multicellular scale. We present Bento, a Python toolkit that takes advantage of single-molecule information to enable spatial analysis at the subcellular scale. Bento ingests molecular coordinates and segmentation boundaries to perform three analyses: defining subcellular domains, annotating localization patterns, and quantifying gene–gene colocalization. We demonstrate MERFISH, seqFISH + , Molecular Cartography, and Xenium datasets. Bento is part of the open-source Scverse ecosystem, enabling integration with other single-cell analysis tools.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-024-03217-7.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Institute of Health</institution>
        </funding-source>
        <award-id>NS103172</award-id>
        <award-id>AI132122</award-id>
        <award-id>AI123202</award-id>
        <award-id>AG069098</award-id>
        <award-id>HG004659</award-id>
        <award-id>HG009889</award-id>
        <award-id>GM008666</award-id>
        <award-id>T32GM139790</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ahmed</surname>
            <given-names>Noorsher</given-names>
          </name>
          <name>
            <surname>Pong</surname>
            <given-names>Avery</given-names>
          </name>
          <name>
            <surname>Yeo</surname>
            <given-names>Gene W.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Insitute of Health</institution>
        </funding-source>
        <award-id>MH107367</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yeo</surname>
            <given-names>Gene W.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DGE-2038238</award-id>
        <principal-award-recipient>
          <name>
            <surname>Mah</surname>
            <given-names>Clarence K.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014989</institution-id>
            <institution>Chan Zuckerberg Initiative</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CZF2019-002448</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lundberg</surname>
            <given-names>Emma</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004063</institution-id>
            <institution>Knut och Alice Wallenbergs Stiftelse</institution>
          </institution-wrap>
        </funding-source>
        <award-id>KAW 2021.0346</award-id>
        <principal-award-recipient>
          <name>
            <surname>Lundberg</surname>
            <given-names>Emma</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2024</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par2">The spatial organization of molecules in a cell is essential for performing their functions. While protein localization [<xref ref-type="bibr" rid="CR1">1</xref>] and disease-associated mislocalization are well appreciated [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>], the same principles for RNA have begun to emerge. For instance, the spatial and temporal regulation of RNA play a crucial role in localized cellular processes such as cell migration and cell division [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], as well as specialized cell functionalities like synaptic plasticity [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. Mislocalization of RNA has been associated with diseases such as Huntington’s disease (HD), where defects in axonal mRNA transport and subsequent translation in human spiny neurons lead to cell death and neurodegeneration [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p id="Par3">The study of subcellular RNA localization necessitates single-molecule measurements. Since the development of single-molecule fluorescent in situ hybridization (smFISH), recent advances in multiplexed methods such as MERFISH [<xref ref-type="bibr" rid="CR13">13</xref>], seqFISH + [<xref ref-type="bibr" rid="CR14">14</xref>], HybISS [<xref ref-type="bibr" rid="CR15">15</xref>], and Ex-Seq [<xref ref-type="bibr" rid="CR16">16</xref>] have enabled RNA localization measurements at near transcriptome scales, while maintaining single-molecule resolution. A number of computational toolkits, such as Squidpy [<xref ref-type="bibr" rid="CR17">17</xref>], stLearn [<xref ref-type="bibr" rid="CR18">18</xref>], Giotto [<xref ref-type="bibr" rid="CR19">19</xref>], Seurat [<xref ref-type="bibr" rid="CR20">20</xref>], and Scanpy [<xref ref-type="bibr" rid="CR21">21</xref>] enabled the characterization of tissue architecture, cell–cell interactions, and spatial expression patterns. Despite the single-molecule measurements in spatial transcriptomics, these analytical approaches are limited to investigating spatial variation at the multicellular scale and lack the ability to investigate subcellular organization. To further our understanding of RNA localization and its function in normal and abnormal cell activity, we need to expand our analytical capacity to the subcellular scale.</p>
    <p id="Par4">Recent methods such as FISH-quant-v2 [<xref ref-type="bibr" rid="CR22">22</xref>] and FISHFactor [<xref ref-type="bibr" rid="CR23">23</xref>] identify subcellular patterns describing the spatial distribution of RNA species, but are unable to annotate more than a single gene per cell or are limited to analyze at most 20,000 molecules on accessible computing resources. In contrast, a single spatial transcriptomics experiment measures at least hundreds to thousands of genes across hundreds of thousands of cells. Additionally, methods such as ClusterMap [<xref ref-type="bibr" rid="CR24">24</xref>] and Baysor [<xref ref-type="bibr" rid="CR25">25</xref>] highlight the potential for transcript locations alone to inform meaningful domains such as cell and nuclear regions. Using spatial proteomics data, CAMPA [<xref ref-type="bibr" rid="CR26">26</xref>] and Pixie [<xref ref-type="bibr" rid="CR27">27</xref>] utilize subcellular spatial variation in protein abundance to identify subcellular regions and annotate pixel-level features.</p>
    <p id="Par5">Building on these promising approaches, we present Bento, an open-source Python toolkit for scalable analysis of spatial transcriptomics data at the subcellular resolution. Bento ingests single-molecule resolution data and segmentation masks, utilizing geospatial tools (GeoPandas [<xref ref-type="bibr" rid="CR28">28</xref>], Rasterio [<xref ref-type="bibr" rid="CR29">29</xref>]) for spatial analysis of molecular imaging data, and data science tools including SciPy [<xref ref-type="bibr" rid="CR30">30</xref>] and Tensorly [<xref ref-type="bibr" rid="CR31">31</xref>] for scalable analysis of high-dimensional feature matrices. Furthermore, Bento is a member of the Scverse ecosystem [<xref ref-type="bibr" rid="CR32">32</xref>], enabling integration with Scanpy [<xref ref-type="bibr" rid="CR21">21</xref>], Squidpy [<xref ref-type="bibr" rid="CR17">17</xref>], and more than 30 other single-cell omics analysis tools.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of Bento data infrastructure for subcellular analysis</title>
      <p id="Par6">In order to facilitate a flexible workflow, Bento is generally compatible with molecule-level resolution spatial transcriptomics data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A), such as datasets produced by MERFISH [<xref ref-type="bibr" rid="CR13">13</xref>], seqFISH + [<xref ref-type="bibr" rid="CR14">14</xref>], CosMx (NanoString) [<xref ref-type="bibr" rid="CR33">33</xref>], Xenium (10 × Genomics) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR34">34</xref>], and Molecular Cartography (Resolve Biosciences) [<xref ref-type="bibr" rid="CR35">35</xref>]. Bento’s workflow takes as input (1) 2D spatial coordinates of transcripts annotated by gene and (2) segmentation boundaries (e.g., cell membrane, nuclear membrane, and any other regions of interest) (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). While 3D molecular coordinates are commonly included, 3D segmentation information is limited to z-stacked 2D segmentation, limiting its usability. If available, Bento can also handle arbitrary sets of segmentations for other subcellular structures or regions of interest. These inputs are stored in the AnnData data format [<xref ref-type="bibr" rid="CR36">36</xref>], which links cell and gene metadata to standard count matrices, providing compatibility with standard single-cell RNA-seq quality control and analysis tools in the Scverse ecosystem [<xref ref-type="bibr" rid="CR32">32</xref>]. With a data structure for segmentation boundaries and transcript coordinates in place, Bento can easily compute spatial statistics and measure spatial phenotypes to build flexible multidimensional feature sets for exploratory subcellular analysis and utilize these spatial metrics to augment quality control (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C).<fig id="Fig1"><label>Fig. 1</label><caption><p>Workflow and functionality of the Bento toolkit. <bold>A</bold> Single-molecule resolved spatial transcriptomics data from commercial or custom platforms are ingested into Bento where it is converted to the AnnData format (<bold>B</bold>), where it can be manipulated with Bento as well as a wide ecosystem of single-cell omics tools. <bold>C</bold> Geometric statistics are illustrated for the seqFISH + dataset, including metrics describing cell and nuclear geometries and cell density to assess overall data quality. <bold>D</bold> Bento has a standard interface to perform a wide variety of subcellular analyses</p></caption><graphic xlink:href="13059_2024_3217_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par7">Bento offers a precise yet flexible palette of novel complementary subcellular analyses (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). We introduce RNAforest, a multilabel approach for annotating RNA localization patterns adapted from FISH-quant v2 [<xref ref-type="bibr" rid="CR22">22</xref>]. We find that many RNAs are spatially distributed according to gene function. We then implement RNAcoloc, a context-specific approach to quantify colocalization to characterize how genes colocalize with each other in a compartment-specific manner. Having established systematic patterning and organization of RNA transcripts, we demonstrate RNAflux, an unsupervised method for semantic segmentation of subcellular domains. RNAflux first quantifies subcellular expression gradients at pixel resolution before identifying consistent subcellular domains via unsupervised clustering. We demonstrate the utility of Bento’s tools by applying them to identifying critical localization changes in human iPSC-derived cardiomyocytes upon drug treatment with doxorubicin, a widely used chemotherapeutic known to cause cardiotoxicity [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>RNAforest: utilizing subcellular landmarks to predict RNA subcellular localization</title>
      <p id="Par8">In computer vision, key points or landmarks are commonly used for tasks like facial recognition [<xref ref-type="bibr" rid="CR38">38</xref>] and object detection. Analogous to these classical applications, we derive spatial features using cell and nucleus boundaries as landmarks to predict RNA localization patterns from spatial summary statistics. Building on the summary statistics used for classifying smFISH data in FISH-quant v2 [<xref ref-type="bibr" rid="CR39">39</xref>], RNAforest consists of an ensemble of five binary random forest classifiers rather than a single multi-classifier model to assign one or more labels. These pattern labels, adapted from several high-throughput smFISH imaging experiments in HeLa cells [<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR43">43</xref>], are broadly applicable to eukaryotic cells: (i) nuclear (contained in the volume of the nucleus), (ii) cytoplasmic (diffuse throughout the cytoplasm), (iii) nuclear edge (near the inner/outer nuclear membrane), (iv) cell edge (near the cell membrane), and (v) none (complete spatial randomness). It is important to note, as was done previously in FISH-quant v2 [<xref ref-type="bibr" rid="CR39">39</xref>] that because of the 2D nature of the dataset, RNA that is in truth cytoplasmic but above or below the nucleus will still appear as though in the nucleus when collapsed in the <italic>z</italic>-dimension. As we use the FISH-quant v2 pattern simulation framework, this is accounted for in the training dataset.</p>
      <p id="Par9">We used the FISH-quant v2 simulation framework to generate realistic ground-truth data [<xref ref-type="bibr" rid="CR42">42</xref>]. Each sample is defined as a set of points with coordinates in two dimensions, representing the set of observed transcripts for a gene in a particular cell. In total, we simulated 2000 samples per class for a total of 10,000 samples (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). We used 80% of the simulated data for training and held out the remaining 20% for testing (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1A). Each sample is encoded by a set of 13 input features, describing characteristics of its spatial point distribution, including proximity to cellular compartments and extensions (features 1–3), measures of symmetry about a center of mass (features 4–6), and measures of dispersion and point density (features 7–13) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). These features are normalized to morphological properties of the cell to control for variability in cell shape. A detailed description of every feature is described in Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Table S1, and model architectures and hyperparameters are described in Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Table S2 (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section).<fig id="Fig2"><label>Fig. 2</label><caption><p>Subcellular localization pattern identification with RNAforest.<bold> A</bold> Thirteen spatial summary statistics are computed for every gene-cell pair describing the spatial arrangement of molecules and boundaries in relation to one another. The features (Supp. Table <xref rid="MOESM1" ref-type="media">1</xref>) are inputs for RNAforest, a multilabel ensemble classifier that assigns one or more subcellular localization labels: cell edge, cytoplasmic, nuclear, nuclear edge, and none. The colors for each label are used consistently throughout to figure. Top 10 genes for each label visualized for each label other than “none” in <bold>B</bold> U2-OS cells and <bold>C</bold> 3T3 cells. <bold>D</bold> and <bold>E</bold> are UpSet plots showing the proportion of measured transcripts assigned to each label. <bold>F</bold> and <bold>G</bold> show the relative label proportion across cells for each gene and are colored by the majority label (<bold>F</bold> and <bold>G</bold>). <bold>H</bold> Top 5 consistent genes for each label.<bold> I</bold> ssGEA identifies the enrichment of GO cellular component domains for each label in the 3T3 cell dataset. Stars denote <italic>p</italic>-values under thresholds defined in the legend. <italic>P</italic>-values are derived from ssGSEA permutation tests with Benjamini–Hochberg correction controlling for false discovery rate</p></caption><graphic xlink:href="13059_2024_3217_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par10">We applied RNAforest on two datasets from different spatial platforms, cell types, and gene panel sizes: a MERFISH dataset in U2-OS cells and a seqFISH + dataset in 3T3 cells. Validation performance on manual annotation of subsets of both datasets shows that RNAforest generalizes well despite biological and technical differences (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1B). The MERFISH dataset measured 130 genes (low plexity) with high detection efficiency per gene (111 molecules per gene per cell on average), while the seqFISH + dataset measured 10,000 genes (very high plexity) with lower detection efficiency (8 molecules per gene per cell on average) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B, C, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1C-F). In agreement with previous work characterizing RNA localization of 411 genes [<xref ref-type="bibr" rid="CR43">43</xref>], we find that genes commonly exhibit variability in localization across cells. This suggests that heterogeneity in localization likely generalizes to the entire transcriptome. Of the localization patterns besides “none,” “nuclear” was the most common (22.1%) in the U2-OS osteosarcoma cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D, F), while “cell edge” was the most common (15.9%) in the 3T3 fibroblast cells (Fig. <xref rid="Fig2" ref-type="fig">2</xref>E, G).</p>
      <p id="Par11">In the U2-OS cells, we found many genes to have preferential localization in different subcellular compartments (Fig. <xref rid="Fig2" ref-type="fig">2</xref>H). In agreement with our RNAflux findings, we find genes known to localize to the nucleus [<xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR45">45</xref>] to be frequently labeled “nucleus” (MALAT1, SOD2) and genes encoding secreted extracellular proteins [<xref ref-type="bibr" rid="CR13">13</xref>] to be frequently labeled “nuclear edge” (FBN1, FBN2). As expected, we find genes preferentially “nuclear” and “nuclear edge” localized to mirror nucleus and endoplasmic reticulum genes found in a 10 k genes MERFISH study of U2-OS cells that included ER staining [<xref ref-type="bibr" rid="CR46">46</xref>] (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Leveraging the 3T3 seqFISH + dataset’s higher plexity, we were able to ask whether genes with similar localization preferences are functionally related. We applied gene set enrichment analysis to gene localization frequencies to identify enriched gene ontology terms [<xref ref-type="bibr" rid="CR47">47</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref>I; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Secretory processes were enriched in the nucleus and nuclear edge, which may be linked to increased transcription of fibroblast-related functions. Cell edge enriched pathways consisted of those with the cell membrane as their site of function (e.g., endocytosis and tight junction suggesting local translation of these genes). Additionally, the term for cell cycle was significantly enriched in the cytoplasm only. Genes without strong localization preference (most frequently “none”) were not significantly associated with any pathways. These genes likely do not undergo active transport and are functionally independent of local translation.</p>
      <p id="Par12">In summary, RNAforest gives a user a facile method for annotating RNA localization patterns and quantifying heterogeneity in a transcriptome-wide manner independent of RNA abundance. Beyond known RNA localizations, we find that transcript location is generally associated with known gene function, alluding to the systematic spatial regulation of RNA transport. We foresee RNAforest will be a valuable addition to characterize RNA localization across diverse spatial transcriptomics datasets.</p>
    </sec>
    <sec id="Sec5">
      <title>RNAcoloc: an approach for context-specific RNA colocalization</title>
      <p id="Par13">In geospatial information processing, a fundamental feature that is often gleaned from large datasets is the colocation of objects (e.g., gleaning socialization metrics from cell phone colocation data in Singapore [<xref ref-type="bibr" rid="CR48">48</xref>]). Colocation is similarly valuable in understanding co-translation and interaction networks of genes in a biological context [<xref ref-type="bibr" rid="CR49">49</xref>]. Recent spatial transcriptomics approaches have used a number of colocalization metrics from the geographic information systems and ecology fields, e.g., the bivariate versions of Ripley’s K function (also known as cross-k-function) [<xref ref-type="bibr" rid="CR50">50</xref>], Moran’s <italic>I</italic> [<xref ref-type="bibr" rid="CR51">51</xref>], and the join count statistic [<xref ref-type="bibr" rid="CR52">52</xref>]. These metrics are designed to measure spatial associations between two populations, i.e., gene A transcripts and gene B transcripts. However, it is more appropriate to think of all transcripts in a single cell from a single population; after all, RNA transcription and localization are not completely stochastic. We have shown that the subcellular distribution of RNA is highly structured with RNAforest. As such, we developed RNAcoloc, an approach that combines the Colocation Quotient (CLQ) [<xref ref-type="bibr" rid="CR53">53</xref>] metric and tensor decomposition for context-specific RNA colocalization (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). The CLQ is a colocalization statistic that is capable of accounting for the biophysical properties of RNA spatial distributions. First, the CLQ considers how clustered the overall RNA population is in a cell and measures whether specific pairs of genes are more clustered than expected given the spatial pattern of the overall population. Second, the CLQ is inherently asymmetric and captures the direction of attraction, i.e., the attraction of gene A to gene B is not the same as the attraction of gene B to gene A. This is most common when gene A and gene B have very different expression levels, which is prevalent due to overdispersion in gene expression data.</p>
      <p id="Par14">RNAcoloc calculates CLQ scores for each gene per cell in a compartment-specific manner, such that each sample has 2 scores, a nucleus and cytoplasm CLQ score. An initial comparison in the U2-OS dataset of global colocalization between nuclear and cytoplasmic fractions unsurprisingly found that transcripts from the same gene tend to cluster more tightly with themselves than with transcripts from other genes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). Additionally, self-colocalization is significantly stronger in the cytoplasm than in the nucleus. In conjunction with our findings from RNAforest analysis that genes of the same localization pattern tend to have similar functions, this suggests that the RNAs are more tightly spatially regulated once exported from the nucleus.<fig id="Fig3"><label>Fig. 3</label><caption><p>Compartment-specific RNA colocalization with RNAcoloc. <bold>A</bold> Transcripts are separated by compartment (nucleus and cytoplasm) before CLQ scores are calculated for every gene pair across all cells. This yields a cell × gene pair × compartment tensor. <bold>B</bold> Pairwise comparison of log CLQ distributions for gene pairs and self-pairs, further categorized by compartment. The Mann–Whitney <italic>U</italic> test was used for comparisons. Stars denote <italic>p</italic>-values below the legend threshold with Benjamini–Hochberg correction controlling for false-discovery rate. From top to bottom, group sizes are 12,254,430 (cytoplasm gene pairs), 115,187 (nucleus gene pairs), 6,778,402 (cytoplasm self-pairs), and 86,474 (nucleus self-pairs). <bold>C</bold> Tensor decomposition yields 4 factors. From left to right, the three heatmaps show the loadings of each factor for each dimension—compartments, cells, and gene pairs. Only the top 5 associated gene pairs for each factor are shown. <bold>D</bold> Top examples of compartment-specific colocalized gene pairs. Black scale bars denote 10 μm</p></caption><graphic xlink:href="13059_2024_3217_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par15">By calculating CLQ scores for every gene–gene pair across compartments, RNAcoloc constructs a tensor of shape <italic>P</italic> × <italic>C</italic> × <italic>S</italic> where <italic>P</italic>, <italic>C</italic>, and <italic>S</italic> represent the number of gene–gene pairs, cells, and compartments, respectively (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section).</p>
      <p id="Par16">RNAcoloc then applies tensor decomposition — specifically, non-negative parallel factor analysis — a data-driven, unsupervised approach for discovering substructure in high-dimensional data [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR54">54</xref>] to decompose the tensor into <italic>k</italic> “factors”. The number of factors is determined using the elbow method heuristic, optimizing for the root mean squared error (RMSE) reconstruction loss (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Unlike matrix dimensionality reduction methods, such as PCA, the order of the components (factors) is unassociated with the amount of variance explained. Each factor is composed of 3 loading vectors, which correspond to the compartments, cells, and gene pairs. Higher values denote a stronger association with that factor. Crucially for interpretation, factors derived from tensor decomposition are not mutually exclusive and can share overlapping sets of associated compartments, cells, and gene pairs.</p>
      <p id="Par17">Applied to the U2-OS dataset, RNAcoloc decomposes RNA colocalization into 4 factors. Examining factor loadings indicates two distinct subpopulations of cells with compartment-specific colocalization behaviors; cluster 1 cells exhibit uniform (Factor 0) and cytoplasmic (Factor 3) colocalization, while cluster 2 cells show nuclear (Factor 1) and cytoplasmic colocalization (Factor 2) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>C, D). Factor 3 describes the colocalization of gene pairs in the cytoplasm of cluster 1 cells, especially a number of genes that attract PIK3CA transcripts While little is known about PIK3CA RNA interactions, the PI3K pathway regulates mitotic organization, including the regulation of dynein and dynactin motor proteins. DYNC1H1 is among the top genes attracting PI3KCA and specifically encodes cytoplasmic dynein, a motor protein critical for spindle formation and chromosomal segregation in mitosis [<xref ref-type="bibr" rid="CR55">55</xref>]. This hints that not only is compartmental localization of RNA linked to the cell cycle [<xref ref-type="bibr" rid="CR46">46</xref>], but RNA-RNA interactions may play a role as well. In cluster 2 cells, MALAT1 attracts CNR2 transcripts more than expected in the cytoplasm. Even though MALAT1 is canonically abundantly localized to the nucleus, this demonstrates that the CLQ score identifies gene pairs colocalizing more than expected despite the disproportionate expression of MALAT1 relative to CNR2, whereas other approaches seem confounded by large differences in expression [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
      <p id="Par18">We demonstrate the ability of RNAcoloc to quantify compartment-specific gene-pair colocation by exploring cytoplasmic vs. nuclear colocalization. As we found separately with RNAforest, RNAcoloc analysis finds evidence that RNA transport is spatially regulated, especially after nuclear export. We highlight several examples of colocalization suggesting how RNA localization allows the same gene to have multiple functions in a spatially dependent fashion, i.e., depending on its molecular neighbors and local environment [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR57">57</xref>]. We foresee RNAcoloc will be increasingly relevant as many spatial technologies are beginning to image proteins along with RNA, which can be used to delineate more granular compartments, such as cell organelles or distinct regions, e.g., neuron cell bodies vs dendrites.</p>
    </sec>
    <sec id="Sec6">
      <title>RNAflux: unsupervised semantic segmentation of subcellular domains in single cells</title>
      <p id="Par19">To build on RNAforest, we overcame the restricted number of localization patterns defined by the supervised method by framing RNA localization as an unsupervised embedding problem. RNAflux looks at local neighborhoods within the space of a cell and builds a normalized gene composition per neighborhood. Differences in neighborhood compositions can be leveraged to identify distinct subcellular domains in a manner that is entirely unsupervised and independent of cell geometry.</p>
      <p id="Par20">We applied this embedding procedure to compute a gene composition vector for every pixel in 2D coordinate space, generating a spatially coherent embedding across entire cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section).<fig id="Fig4"><label>Fig. 4</label><caption><p>RNAflux finds distinct subcellular domains with consistent spatial organization and local gene composition. <bold>A</bold> Flowchart of RNAflux and fluxmap computation. Local neighborhoods of a fixed radius are arrayed across a cell and a normalized gene composition is computed for each pixel coordinate, producing an RNAflux embedding. The first three principal components of the RNAflux embedding are visualized for U2-OS cells coloring RGB values by PC1, PC2, and PC3 values respectively for each pixel. Fluxmap domains are computed from each RNAflux embedding to create semantic segmentation masks of each subcellular domain.<bold> B</bold> The left panel shows a field of view of U2-OS cells, dots denoting individual molecules colored by gene species, nuclei, and cell boundaries outlined in white. For the same field of view of cells, the center panel shows RNAflux embeddings and the right panel shows fluxmap domains. <bold>C</bold> The scatter plot shows how the composition of each gene is distributed across fluxmap domains. The position of each point denotes the relative bias of a given gene’s composition across fluxmaps.<bold> D</bold> Heatmap showing the fraction of pixels with a positive enrichment value for each APEX-seq location for each fluxmap domain. <bold>E</bold>–<bold>I</bold> The most highly enriched location is shown for each fluxmap domain. Domain boundaries are denoted by white lines within each cell</p></caption><graphic xlink:href="13059_2024_3217_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par21">Applied to a MERFISH dataset with a target panel of 130 genes across over 1153 U2-OS cells, we demonstrate that RNAflux embeddings can detect transcriptionally distinct subcellular domains. Performing dimensional reduction of the embeddings showed that the top sources of variation spatially correspond to the nucleus, the nuclear periphery, and cytoplasmic regions consistently across cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B; see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section) confirming that RNAflux measures intracellular transcriptional variation, as opposed to intercellular variation. To delineate compositionally similar domains in a data-driven manner, we cluster pixel embeddings using self-organizing maps (SOMs), effectively performing unsupervised semantic segmentation (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). We denote the resulting clusters as “fluxmap domains.” We found that this assigned pixels to 5 fluxmap domains, consistently highlighting spatial regions across every cell (e.g., fluxmap 2 is always nuclear while the remaining domains constitute the cytoplasm) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). By considering the spatial distribution of molecules across fluxmap domains, we can quantify the composition of molecules for each gene across fluxmaps (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C), e.g., nuclear-localized MALAT1 [<xref ref-type="bibr" rid="CR44">44</xref>].</p>
      <p id="Par22">We sought to characterize the fluxmap domains with known information about RNA localization. We used data from a previous study that measured gene expression at “distinct subcellular locales” via APEX-seq, a technique for proximity labeling and sequencing of RNA [<xref ref-type="bibr" rid="CR58">58</xref>]. Of the 3288 genes differentially enriched to one or more locales, 63 overlapped with the 130 MERFISH genes. The location enrichment score for each pixel is calculated by taking the weighted sum of its RNAflux embedding and the measured relative enrichment, i.e., log fold change measured by APEX-seq loadings for a given organelle-specific geneset (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Visualizing each pixel’s location-specific enrichment scores from the APEX-seq dataset highlights the subcellular localization of these compartments, including the cytosol, nucleus, nucleolus, nuclear pore, nuclear lamina, endoplasmic reticulum lumen (ER lumen), ER membrane (ERM), and the outer mitochondrial membrane (OMM) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>D). We find the nuclear compartments have high scores in domain 2, while the cytoplasm scores rank highest in domains 4 and 5. Both the ERM and OMM scores are the strongest in domain 1 (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E).</p>
      <p id="Par23">The most common application for spatial transcriptomics is in mapping heterogeneous cell types in large tissue samples. This presents several challenges. First, the panels for these experiments are weighted heavily towards cell type markers determined by single-nuclei RNA-seq, potentially reducing the intracellular variability in the expression on which Bento relies. Second, substantial intercellular heterogeneity can skew the low-rank embedding by introducing too much variance in requisite cell radii information. To explore the applicability of RNAflux on tissue, we applied it to a previously published breast cancer tissue dataset generated by 10 × Xenium [<xref ref-type="bibr" rid="CR59">59</xref>]. We successfully reproduced the identification of unique cell types that reflect canonical expression markers (Fig. S<xref rid="MOESM1" ref-type="media">4</xref>A and B). We apply RNAflux to cell type-disaggregated subsets of the full datasets in fields of view of interest with at least 100 cells of interest and find that fluxmaps 1–3 show different enrichment scores for Nucleus and Endoplasmic Reticulum (ER; combination of ERM and ER lumen). We note that despite the successful delineation of discrete regions in the form of fluxmaps when looking at different regions of tissue that are enriched for different cell types, nuclear and ER enrichment scores change for each fluxmap (Fig. S<xref rid="MOESM1" ref-type="media">4</xref>C).</p>
      <p id="Par24">In summary, RNAflux finds distinct subcellular domains with consistent spatial organization and local gene composition. As an unsupervised method, RNAflux can be applied to any cell type for inferring subcellular domains from transcript locations and functionally annotated with biological enrichment analysis. This process is best performed on cell type-separated data to guard low-rank embeddings from being generated by cells of vastly different morphologies. This disaggregation is important because, unlike uniform cell lines, heterogeneous tissue composed of functionally diverse stromal cells and leukocytes should indeed be expected to have different distributions and complements of subcellular domains.</p>
    </sec>
    <sec id="Sec7">
      <title>Doxorubicin-induced stress in cardiomyocytes depletes RNA from the endoplasmic reticulum</title>
      <p id="Par25">Having established Bento’s utility to characterize RNA localization in U2OS cells, we applied Bento to quantify changes in localization in the context of perturbations in cells. Specifically, we performed single-molecule spatial transcriptomics on doxorubicin-treated and untreated cardiomyocytes to identify RNA localization changes as a result of treatment.</p>
      <p id="Par26">Doxorubicin (DOX) was once one of the most effective broad-spectrum anti-cancer anthracycline antibiotics [<xref ref-type="bibr" rid="CR60">60</xref>, <xref ref-type="bibr" rid="CR61">61</xref>] with particular efficacy against solid malignancies such as lung and breast cancer, as well as hematologic neoplasia [<xref ref-type="bibr" rid="CR62">62</xref>, <xref ref-type="bibr" rid="CR63">63</xref>]. However, DOX’s propensity to cause cardiac damage in patients has led to significant limitations in its clinical use [<xref ref-type="bibr" rid="CR64">64</xref>]. The exact mechanism by which DOX induces heart failure is unclear, but significant evidence suggests cardiomyocyte injury driven by oxidative stress is a major factor [<xref ref-type="bibr" rid="CR62">62</xref>, <xref ref-type="bibr" rid="CR65">65</xref>–<xref ref-type="bibr" rid="CR68">68</xref>]. Specifically, DOX causes stress and dysfunction in multiple cellular compartments in cardiomyocytes such as mitochondria, Sarco/endoplasmic reticulum (SER), deficiencies in calcium signaling, and lipid degradation at the cellular membrane [<xref ref-type="bibr" rid="CR69">69</xref>]. We reasoned that by measuring the localization of the RNA transcripts of 100 genes crucial to cardiomyocyte health and function (Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Table S2) and leveraging the tools developed within Bento, we could recapitulate known dysfunction of subcellular domains in cardiomyocytes upon DOX stress and measure novel RNA localization phenotypes.</p>
      <p id="Par27">We utilized a chemically defined protocol to differentiate human induced pluripotent stem cells (iPSCs) into beating cardiomyocytes and treated them with either DMSO (vehicle) or 2.5 μM DOX for 12 h before fixation (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section). Single-molecule spatial transcriptomes were measured by Resolve Bioscience using Molecular Cartography. The resulting data was segmented using ClusterMap [<xref ref-type="bibr" rid="CR24">24</xref>] for cell boundaries and Cellpose [<xref ref-type="bibr" rid="CR70">70</xref>] for nuclei boundaries (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A). Non-myocytes were filtered out using SLC8A1 as a canonical marker for cardiomyocytes (see the “ <xref rid="Sec10" ref-type="sec">Methods</xref>” section, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3A). Comparing vehicle and DOX-treated cardiomyocytes, we found NPPA, a classic marker for cardiac stress [<xref ref-type="bibr" rid="CR71">71</xref>, <xref ref-type="bibr" rid="CR72">72</xref>], to be upregulated in DOX-treated cells (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B). We identified subcellular domains in the vehicle and DOX-treated cardiomyocytes using RNAflux, clustering the domains into four fluxmap domains (Fig. <xref rid="Fig5" ref-type="fig">5</xref>C, D, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3B). Enrichment of location-specific gene expression aligned domains to the nucleus (nuclear pore, nucleolus, and nucleus), ERM and OMM, ER lumen, and cytosol respectively (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E, Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3C). Comparing the gene composition in each domain, we observe an overall localization bias towards both the nucleus and ERM/OMM in vehicle-treated cells (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E top), in agreement with prior poly(A) smFISH studies [<xref ref-type="bibr" rid="CR73">73</xref>]. However, RNA in the DOX-treated cardiomyocytes demonstrated a shift in average RNA localization away from the ERM/OMM and towards the nucleus (Fig. <xref rid="Fig5" ref-type="fig">5</xref>E bottom). There was no correlation when comparing the logFC in expression and the difference in nuclear composition of genes after treatment, indicating that localization towards the nucleus is not driven by transcript abundance (Spearman <italic>r</italic> = 0.07, <italic>p</italic> = 0.4944). There is evidence that 90% of genes have a half-life of less than 260 min [<xref ref-type="bibr" rid="CR74">74</xref>], far less than the 12-h DOX treatment, indicating that the shift in RNA localization is likely due to reduced nuclear export of newly synthesized RNA from the nucleus to the ERM/OMM. Indeed, even low concentrations of DOX have been demonstrated to alter structural fibrous proteins as well as mitochondrial depolarization and fragmentation [<xref ref-type="bibr" rid="CR75">75</xref>]. Of particular note, the RNA binding protein RBM20—a critical regulator of mRNA splicing of genes encoding key structural proteins associated with cardiac development and function—had a pronounced depletion of RNA transcripts outside of the nucleus upon DOX treatment (Fig. <xref rid="Fig5" ref-type="fig">5</xref>G left). With further validation, this may indicate nuclear retention and or degradation of nuclear exported RBM20 mRNA as a potential mechanism of DOX-induced cardiomyopathy. Similarly, we found the mRNA of calcium voltage-gated channel subunit CACNB2 to also deplete outside of the nucleus (Fig. <xref rid="Fig5" ref-type="fig">5</xref>G middle). The loss of CACNB2 translation outside of the nucleus may impact calcium signaling crucial to cardiomyocyte function [<xref ref-type="bibr" rid="CR76">76</xref>]. Most genes only showed weak shifts in localization, similar to LAMP2 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>G right).<fig id="Fig5"><label>Fig. 5</label><caption><p>Subcellular RNA localization changes upon Doxorubicin treatment in iPSC-derived cardiomyocytes. <bold>A</bold> Cardiomyocytes derived from human iPSCs were treated with DMSO or 2.5 μM DOX for 12 h. The localizations of 100 genes relevant to cardiomyocyte health and function were measured using Molecular Cartography. Cell boundaries were determined using ClusterMap and nuclei were segmented using Cellpose. <bold>B</bold> Top 10 differentially upregulated and downregulated genes in vehicle versus treatment. <italic>T</italic>-test was used for comparisons. All genes shown are significant given an adjusted <italic>p</italic>-value threshold of<italic> p</italic> &lt; 0.01. Benjamini–Hochberg correction was used to control for the false discovery rate. Vehicle and treatment conditions have <italic>n</italic> = 7159 and 6260 cells respectively. <bold>C</bold> APEX-seq location-specific gene enrichment of fluxmap domains for the cytosol, endoplasmic reticulum membrane (ERM), endoplasmic reticulum lumen (ER Lumen), nuclear lamina, nucleus, nucleolus, nuclear pore, and outer mitochondrial matrix (OMM). <bold>D</bold> Fluxmap domains visualized for a representative field of view of cardiomyocytes for vehicle and treatment respectively highlighting cellular nuclei, ERM/OMM, ER Lumen, and cytosol. <bold>E</bold> RNAflux fluxmap enrichment of each gene averaged across vehicle and treatment cardiomyocytes captures changes in subcellular RNA localization. Top 10 genes are labeled and ranked by the largest shifts between compartment compositions. Shifts are quantified by Wasserstein distance. <bold>F</bold> Average gene enrichment in each fluxmap across vehicle and treatment conditions colored by log-fold expression demonstrates population-level shifts in transcript subcellular localization. <bold>G</bold> Visualization of RBM20, CACNB2, and LAMP2 transcripts confirms the depletion of transcripts from the perinuclear and cytosolic compartments of cardiomyocytes upon DOX treatment</p></caption><graphic xlink:href="13059_2024_3217_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par28">Bento seeks to interrogate biology via its “subcellular first” approach to spatial analysis, complementary to “cell-type or tissue first” spatial analysis methods. The toolkit enables quantitative, reproducible, and accessible analysis agnostic to spatial technology platforms in a standardized framework. We implement three novel methods to interrogate subcellular RNA organization: RNAforest for supervised annotation of localization patterns, RNAcoloc for compartment-aware colocalization analysis, and RNAflux for identifying transcriptionally distinct subcellular domains. We showed that with RNAflux, we were able to quantify RNA localization in a variety of contexts, including domain-specific gene localization, drug-induced changes in localization, and cell type-specific localization. With both RNAflux and RNAforest, we find that subcellular mRNA localization reflects gene function. With RNAcoloc, we explore the use of CLQ scores to quantify pairwise gene colocalization in the context of asymmetric associations.</p>
    <p id="Par29">From these results, we found three main factors to limit the effectiveness of subcellular-resolution analysis: molecule density, segmentation quality, and target panel composition. In particular, RNAflux becomes uninformative if too few molecules are detected per cell or if the number of molecules per gene is too sparse. We found that datasets with higher density, i.e., molecules per micrometer<sup>2</sup>, are less noisy and inform more coherent gradients and domains. Both the U2-OS dataset and cardiomyocyte datasets had high enough molecule density to identify consistent fluxmaps. Notably, RNAflux robustly highlights domains corresponding to the nucleus and ER despite some poor cell segmentation and partially unannotated nuclei in the cardiomyocytes dataset (Fig. <xref rid="Fig5" ref-type="fig">5</xref>D). As most commercial target panels are largely composed of marker genes for cell type identification, RNAflux embeddings should be interpreted carefully, especially if transcripts show little spatial variation in subcellular localization. In contrast, RNAforest performs reliably beyond a minimum of 5–10 molecules per sample but is sensitive to accurate segmentation for calculating cell morphology-dependent features (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. SE-F). The 3T3 cells were manually segmented and the U2-OS cells had relatively accurate segmentation and were therefore amenable to applying RNAforest. We found that the segmentation in the cardiomyocytes is accurate enough for single-cell gene expression analysis, but lacked the precision needed to apply RNAforest. In the case of RNAcoloc, the limiting factor to identifying relevant biology is the target panel composition. The current focus of most target panels typically includes cell type markers and highly expressed genes, whereas it would be more informative to identify colocalizing members of protein complexes, functional pathways, or ligand-receptor pairs. Our ability to characterize relevant pathways with our curated cardiomyocyte gene panel shows how gene panel design focused on function enables discovery. Ultimately, non-targeted transcriptome-scale technologies will be necessary to unlock the full potential of subcellular biology.</p>
    <p id="Par30">A dimensional limitation of Bento is its current inability to process three-dimensional spatial transcriptomic data. While some commercially available spatial transcriptomic methods yield RNA molecular coordinates in 3D, the nuclear and cell segmentation is inevitably still two-dimensional making it difficult to interpret z-dimensional positions lacking the context of cellular geometry in 3D. However, the algorithms behind RNAforest, RNAcoloc, RNAflux, and the plethora of feature calculation functions in Bento are inherently extensible to leveraging three-dimensionality. When three-dimensional cell segmentation improves, we intend to extend Bento to support three-dimensional analysis.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par31">Conventionally, RNA is treated as an intermediary vehicle encoding genomic information for protein synthesis. We began our investigation of RNA localization with the hope of understanding how the spatial organization of RNA functions as a mechanism for post-transcriptional regulation. However, RNAflux conceptually introduces using RNA molecular coordinates as a latent layer of information encoding cellular space–time. Here, we used that latent layer of information to identify subcellular domains. As spatial omic technologies improve to capture more and more information, the potential applications of such latent embeddings will grow as well. Indeed at the tissue level, this concept is already being leveraged with a recent tool, TensionMap, using RNA localization information to predict mechanical tension [<xref ref-type="bibr" rid="CR77">77</xref>]. As applications for spatial transcriptomics grow in popularity and complexity, we envision that Bento is a platform for the next generation of tools needed to quantify the complex molecular dynamics governing normal and abnormal cellular processes.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>MERFISH and seqFISH + data preprocessing</title>
      <p id="Par32">For the seqFISH + dataset, we limited the scope of our analysis to the set of genes for which at least 10 molecules were detected in at least one cell. This helped reduce sparsity in the data, resulting in 3726 genes remaining. Because pattern classification requires nuclear segmentation masks, we removed all cells lacking annotated nuclei for the remainder of 179 cells. Because the MERFISH data had a much higher number of molecules detected per gene, no gene needed to be removed. Again, cells without annotated nuclei were removed, leaving 1022 cells for downstream analysis.</p>
    </sec>
    <sec id="Sec12">
      <title>Preprocessing cardiomyocytes datasets</title>
      <p id="Par33">Single-cell expression matrices of both vehicle replicates and both DOX treatment samples were concatenated as a single expression matrix. Cells were projected into two dimensions with UMAP dimensional reduction. No significant batch effects were detected. Leiden clustering was performed at resolution = 0.5 to isolate and filter out a non-myocyte population depleted in SLC8A1 expression (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3A). All described preprocessing steps were performed in Scanpy [<xref ref-type="bibr" rid="CR21">21</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>RNAforest: model selection and training</title>
      <p id="Par34">We evaluated 4 base models for the multilabel classifier including random forests (RF), support vector machines (SVM), feed-forward fully-connected neural networks (NN), and convolutional neural networks (CNN). While all other models use the 13 spatial features for input (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), the CNN takes 64 × 64 image representations of each sample as input. Each multilabel classifier consists of 5 binary classifiers with the same base model. We used the labeled 10,000 simulated samples for training, stratifying 80% of the simulated data for training and holding out the remaining 20% for testing. To select the best hyperparameters for each multilabel classifier, we sampled from a fixed hyperparameter space with the Tree-structured Parzen Estimator algorithm and evaluated performance with fivefold cross-validation (Additional File <xref rid="MOESM2" ref-type="media">2</xref>: Table S2). We retrained the final model (random forest base model) on all training data with the best-performing set of hyperparameters (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1E). Exact steps can be found and reproduced in notebooks stored in the GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-manuscript">https://github.com/ckmah/bento-manuscript</ext-link>.</p>
    </sec>
    <sec id="Sec14">
      <title>RNAforest: image rasterization of molecules and segmentation masks for CNN</title>
      <p id="Par35">To generate an image for a given sample, point coordinates, the cell segmentation mask, and the nuclear segmentation mask are used. The area of the cell is tiled as a 64 × 64 grid, where each bin corresponds to a pixel in the final image. Values are stored in a single channel to render a grayscale image. Pixels inside the cell are encoded as 20 and inside the nucleus encoded as 40. Bins with molecules are encoded as (40 + 20 × <italic>n</italic>) where <italic>n</italic> is the number of molecules. Finally, values are divided by 255 and capped to be between 0 and 1.</p>
    </sec>
    <sec id="Sec15">
      <title>RNAforest: simulating training data</title>
      <p id="Par36">We trained a multilabel classifier to assign each gene in every cell labels from five categories: (i) nuclear (contained in the volume of the nucleus), (ii) cytoplasmic (diffuse throughout the cytoplasm), (iii) nuclear edge (near the inner/outer nuclear membrane), (iv) cell edge (near the cell membrane), and (v) none (complete spatial randomness). These categories are a consolidation of those observed in several high-throughput smFISH imaging experiments in HeLa cells [<xref ref-type="bibr" rid="CR40">40</xref>–<xref ref-type="bibr" rid="CR43">43</xref>]. We used the FISH-quant simulation framework (<ext-link ext-link-type="uri" xlink:href="https://code.google.com/archive/p/fish-quant/">https://code.google.com/archive/p/fish-quant/</ext-link>) to generate realistic ground-truth images using empirically derived parameters from the mentioned high-throughput smFISH imaging experiments in HeLa cells [<xref ref-type="bibr" rid="CR42">42</xref>]. In total, we simulate 2000 samples per class for a total of 10,000 training samples.<list list-type="order"><list-item><p id="Par37"><italic>Cell shape</italic>: Cell morphology varies widely across cell types, and for classifier generalizability, it is important to include many different morphologies in the training set. We use a catalog of cell shapes for over 300 cells from smFISH images in HeLa cells that capture nucleus and cell membrane shape [<xref ref-type="bibr" rid="CR42">42</xref>]. Cell shapes were obtained by cell segmentation with CellMask and nuclear segmentation was obtained from DAPI staining.</p></list-item><list-item><p id="Par38">mRNA<italic> abundance</italic>: We simulated mRNA abundance at three different expression levels (40, 100, and 200 mRNA per average-sized cell) with a Poisson noise term. Consequently, total mRNA abundance per cell was between 5 and 300 transcripts.</p></list-item><list-item><p id="Par39">Localization<italic> pattern</italic>: We focused on 5 possible 2D localization patterns, including cell edge, cytoplasmic, none, nuclear, and nuclear edge. Each pattern was further evaluated at 3 different degrees—weak, moderate, and strong. Moderate corresponds to a pattern typically observed in a cell, whereas weak is close to spatially random. These 5 classes aim to capture biologically relevant behavior generalizable to most cell types; there is room for additional classes describing other biologically relevant localization patterns so long as they can be accurately modeled.</p></list-item></list></p>
    </sec>
    <sec id="Sec16">
      <title>RNAforest: manual annotation of true biological validation data</title>
      <p id="Par40">Using 3 individual annotators, we annotated the same 600 samples across both datasets, keeping samples with 2 or more annotator agreements as true annotations, resulting in 165 annotated seqFISH + samples and 238 annotated MERFISH samples (403 total). We used Cohen’s kappa coefficient [<xref ref-type="bibr" rid="CR78">78</xref>] to calculate agreement between pairs of annotators for each label yielding an overall coefficient of 0.602. We found that pairwise agreement between annotators across labels was fairly consistent ranging between 0.588 and 0.628, while label-specific agreement varied more, ranging between 0.45 and 0.72 (Additional File <xref rid="MOESM4" ref-type="media">4</xref>: Table S4).</p>
    </sec>
    <sec id="Sec17">
      <title>RNAforest: functional enrichment of gene pattern distributions</title>
      <p id="Par41">For enrichment of compartment-specific expression from Xia et al. [<xref ref-type="bibr" rid="CR46">46</xref>], scores are calculated by taking the weighted sum of gene pattern frequencies and published compartment log fold-change values (Additional File <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). The Benjamini–Hochberg correction was used to correct <italic>p</italic>-values for multiple hypothesis testing.</p>
      <p id="Par42">For the seqFISH + dataset, we performed a single-sample Gene Set Enrichment Analysis [<xref ref-type="bibr" rid="CR79">79</xref>, <xref ref-type="bibr" rid="CR80">80</xref>] on gene pattern frequencies to compute enrichment scores (Fig. <xref rid="Fig3" ref-type="fig">3</xref>I). ssGSEA was performed with the GSEApy Python package and the “GO_Cellular_Component_2021” gene set library curated by Enrichr [<xref ref-type="bibr" rid="CR81">81</xref>]. Gene sets with a minimum size of 50 and a maximum size of 500 were analyzed.</p>
    </sec>
    <sec id="Sec18">
      <title>Colocation quotient for RNA colocalization analysis</title>
      <p id="Par43">Pairwise colocalization of genes was determined for each compartment of every cell separately. In this case, each cell was divided into compartments, cytoplasm, and nucleus. The colocation quotient (CLQ) was calculated for every pair of genes <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq2.gif"/></alternatives></inline-formula>. The CLQ is defined as an odds ratio of the observed to expected proportion of <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq3.gif"/></alternatives></inline-formula> transcripts among neighbors of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq4.gif"/></alternatives></inline-formula> for a fixed radius <italic>r</italic>; it is formulated as:<disp-formula id="Equa"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${CLQ}_{A\to B}=\frac{{C}_{A\to B}/{N}_{A}}{{N{\prime}}_{B}/(N-1)}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">CLQ</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2024_3217_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par44">Here <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{C}}}_{{\varvec{A}}\to {\varvec{B}}}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq5.gif"/></alternatives></inline-formula> denotes the number of <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq6.gif"/></alternatives></inline-formula> transcripts of which <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq7.gif"/></alternatives></inline-formula> transcripts are considered a neighbor. <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{N}}}_{{\varvec{A}}}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq8.gif"/></alternatives></inline-formula> denotes the total number of <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq9.gif"/></alternatives></inline-formula> transcripts, while <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{N}}{\boldsymbol{^{\prime}}}_{{\varvec{B}}}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mrow/><mml:mrow/><mml:mo mathvariant="bold">′</mml:mo></mml:mmultiscripts></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow/></mml:mmultiscripts></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq10.gif"/></alternatives></inline-formula> stands for the total number of <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq11.gif"/></alternatives></inline-formula> transcripts. In the case that <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{A}}={\varvec{B}}$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq12.gif"/></alternatives></inline-formula>, <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{N}}{\boldsymbol{^{\prime}}}_{{\varvec{B}}}$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mrow/><mml:mrow/><mml:mo mathvariant="bold">′</mml:mo></mml:mmultiscripts></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow/></mml:mmultiscripts></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq13.gif"/></alternatives></inline-formula> equals the total number of <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{B}}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq14.gif"/></alternatives></inline-formula> transcripts minus 1. <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{N}}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq15.gif"/></alternatives></inline-formula> denotes the total number of transcripts in the cell. Following statistical recommendations from the original formulation of the colocation quotient (CLQ), genes with fewer than 10 transcripts were not considered to reduce sparsity and improve testing power [<xref ref-type="bibr" rid="CR53">53</xref>].</p>
    </sec>
    <sec id="Sec19">
      <title>Tensor decomposition for compartment-specific colocalization</title>
      <p id="Par45">We begin by calculating the CLQ for every pair of genes within each compartment of every cell. We structure our data as follows:<list list-type="order"><list-item><p id="Par46">Cells set: Denote the set of cells as<inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{C}}\boldsymbol=\boldsymbol\{{{\varvec{c}}}_{1},{{\varvec{c}}}_{2},\boldsymbol...,{{\varvec{c}}}_{{\varvec{n}}}\}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold">=</mml:mo></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">{</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo mathvariant="bold">.</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq16.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{c}}}_{{\varvec{i}}}$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq17.gif"/></alternatives></inline-formula> represents the <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{i}}}^{{\varvec{t}}{\varvec{h}}}$$\end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq18.gif"/></alternatives></inline-formula> cell and <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{n}}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq19.gif"/></alternatives></inline-formula> is the total number of cells.</p></list-item><list-item><p id="Par47">Compartments set: Every cell has the same set of compartments, represented as<inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{K}}=\{{{\varvec{k}}}_{1},{{\varvec{k}}}_{2},\boldsymbol...,{{\varvec{k}}}_{{\varvec{m}}}\}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo mathvariant="bold">.</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq20.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{k}}}_{{\varvec{j}}}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">k</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq21.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{j}}}^{{\varvec{t}}{\varvec{h}}}$$\end{document}</tex-math><mml:math id="M46"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq22.gif"/></alternatives></inline-formula> compartment within a cell.</p></list-item><list-item><p id="Par48">Gene pairs set: The gene pairs are represented by <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{G}}=\{{{\varvec{g}}}_{1},{{\varvec{g}}}_{2},\boldsymbol...,\boldsymbol{{\varvec{g}}}_{{\varvec{p}}}\}$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo mathvariant="bold">.</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq23.gif"/></alternatives></inline-formula> where <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{g}}}_{{\varvec{p}}}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq24.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{p}}}^{{\varvec{t}}{\varvec{h}}}$$\end{document}</tex-math><mml:math id="M52"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq25.gif"/></alternatives></inline-formula> gene pair.</p></list-item></list></p>
      <p id="Par49">By computing the CLQ for every combination of cells in <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{C}}$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq26.gif"/></alternatives></inline-formula>, compartments in <inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{K}}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq27.gif"/></alternatives></inline-formula>, and gene pairs in <inline-formula id="IEq28"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{G}}$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mi mathvariant="bold-italic">G</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq28.gif"/></alternatives></inline-formula>, we populate a three-dimensional tensor <inline-formula id="IEq29"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq29.gif"/></alternatives></inline-formula> with dimensions corresponding to these sets.</p>
      <p id="Par50">We then apply non-negative parallel factor analysis (PARAFAC) as implemented in Tensorly [<xref ref-type="bibr" rid="CR31">31</xref>] to reduce the dimensionality of our dataset and capture the underlying patterns. For tensor decomposition, we employed non-negative parallel factor analysis as implemented in Tensorly [<xref ref-type="bibr" rid="CR31">31</xref>]. The tensor <inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq30.gif"/></alternatives></inline-formula> is decomposed into the sum of <inline-formula id="IEq31"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{R}}$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq31.gif"/></alternatives></inline-formula> factors; each factor is a three-dimensional tensor expressed as the outer product of three vectors: <inline-formula id="IEq32"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{x}}}_{{\varvec{r}}}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq32.gif"/></alternatives></inline-formula> (compartment loadings), <inline-formula id="IEq33"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{y}}}_{{\varvec{r}}}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq33.gif"/></alternatives></inline-formula> (cell loadings), and <inline-formula id="IEq34"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{z}}}_{{\varvec{r}}}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq34.gif"/></alternatives></inline-formula> (gene pair loadings). This is denoted as follows:<disp-formula id="Equb"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\widehat{X}}_{R}}={\sum }_{r=1}^{R}{x}_{r}\otimes {y}_{r}\otimes {z}_{r}$$\end{document}</tex-math><mml:math id="M72" display="block"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math><graphic xlink:href="13059_2024_3217_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par51">The optimal rank-<inline-formula id="IEq35"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{R}}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq35.gif"/></alternatives></inline-formula> decomposition of <inline-formula id="IEq36"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq36.gif"/></alternatives></inline-formula> is determined by minimizing the error between <inline-formula id="IEq37"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq37.gif"/></alternatives></inline-formula> and the reconstructed tensor <inline-formula id="IEq38"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{X}}}$$\end{document}</tex-math><mml:math id="M80"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq38.gif"/></alternatives></inline-formula>. We use the elbow function heuristic to select the best-fit rank from a range of 2–12 factors. This approach seeks to balance the complexity of the model against the fidelity of reconstruction. Missing values in <inline-formula id="IEq39"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq39.gif"/></alternatives></inline-formula> are ignored when calculating the loss.</p>
    </sec>
    <sec id="Sec20">
      <title>RNAflux: unsupervised spatial embedding and subcellular domain quantization</title>
      <p id="Par52">To generate RNAflux embeddings, first, a set of query coordinates are generated tiling across the cell area on a uniform grid. This effectively downsamples the original data units (pixels) resulting in much fewer samples to compute embeddings. Let <inline-formula id="IEq40"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q = \{{q}_{1},{q}_{2},...,{q}_{n}\}$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq40.gif"/></alternatives></inline-formula> be the set of query coordinates and <inline-formula id="IEq41"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${q}_{i}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq41.gif"/></alternatives></inline-formula> denote the <inline-formula id="IEq42"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}^{th}$$\end{document}</tex-math><mml:math id="M88"><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq42.gif"/></alternatives></inline-formula> query coordinate. For the MERFISH U2-OS dataset, a step size of 10 data units (pixels) was used to generate the uniform grid. For the iPSC-derived cardiomyocytes, a step size of 5 data units was used. Each query point is assigned an expression vector, counting the abundance of each gene within a fixed radius of 40 and 50 data units respectively. Each expression vector is normalized to sum to one, converting the expression vector to a composition vector, denoted as <inline-formula id="IEq43"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq43.gif"/></alternatives></inline-formula>. Similarly, the cell composition vector <inline-formula id="IEq44"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq44.gif"/></alternatives></inline-formula> for the <inline-formula id="IEq45"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j}^{th}$$\end{document}</tex-math><mml:math id="M94"><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq45.gif"/></alternatives></inline-formula> cell is calculated by normalizing the total cell expression to sum to one. The RNAflux embedding <inline-formula id="IEq46"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq46.gif"/></alternatives></inline-formula> at query coordinate <inline-formula id="IEq47"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${q}_{i}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq47.gif"/></alternatives></inline-formula> is defined as the difference between the <inline-formula id="IEq48"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{j}$$\end{document}</tex-math><mml:math id="M102"><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq49.gif"/></alternatives></inline-formula> divided by <inline-formula id="IEq50"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{v}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>σ</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq50.gif"/></alternatives></inline-formula>, the vector of standard deviation of composition vectors <inline-formula id="IEq51"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v$$\end{document}</tex-math><mml:math id="M106"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="13059_2024_3217_Article_IEq51.gif"/></alternatives></inline-formula>.<disp-formula id="Equc"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}=\frac{{v}_{i}-{x}_{j}}{{\sigma }_{v}}$$\end{document}</tex-math><mml:math id="M108" display="block"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2024_3217_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par53">The RNAflux embedding serves as an interpretable spatial gene embedding that quantifies highly local fluctuations in gene composition. Dimensional reduction of the embeddings is performed using truncated singular value decomposition (SVD). Truncated SVD was chosen over PCA to better handle large but sparse data. Embeddings were reduced to the top 10 components. To assign domains, self-organizing maps (SOM) as implemented in MiniSom [<xref ref-type="bibr" rid="CR82">82</xref>] were used for low-rank quantization of query embeddings. In an analysis of the MERFISH dataset, SOMs of size 1 × <italic>k</italic> were fit across a range of 2 to 12; the best model was determined using the elbow method heuristic to evaluate quantization error. Similarly, domains were determined for the cardiomyocyte spatial transcriptomics data by fitting the vehicle and treatment samples separately, for <italic>k</italic> across a range of 2 to 8. The elbow method heuristic determined an optimal <italic>k</italic> of 6; subsequently, a <italic>k</italic> of 4 was used for further analysis for ease of interpretation.</p>
    </sec>
    <sec id="Sec21">
      <title>RNAflux: visualizing spatial embeddings</title>
      <p id="Par54">The top 3 principal components of the RNAflux embeddings are transformed to map red, green, and blue values respectively. Embeddings are first quantile normalized and scaled to a minimum of 0.1 and 0.9 to avoid mapping extreme quantiles to white and black. These values are then used for red, green, and blue color channels. To map the downsampled grid back to the original data units, linear interpolation was used to rescale the computed color values and fill the space between the uniform grid points.</p>
    </sec>
    <sec id="Sec22">
      <title>RNAflux: enrichment of locale-specific transcriptomes derived by APEX-seq</title>
      <p id="Par55">The enrichment score for each pixel is calculated by first taking the weighted sum of its RNAflux embedding and locale-specific log fold-change values as implemented by the decoupler tool [<xref ref-type="bibr" rid="CR83">83</xref>]. Scores for pixels within a given cell are normalized against a null distribution constructed via random permutations of the input embeddings, to produce <italic>z</italic>-scaled enrichment scores. Fluxmap domain enrichment scores are simply obtained by taking the mean score of all pixels within the boundary of each domain. Fluxmap domain overlaps are computed by counting the fraction of pixels within the boundary of each domain with a positive enrichment score.</p>
    </sec>
    <sec id="Sec23">
      <title>MERFISH of U2-OS cells</title>
      <p id="Par56"><italic>MERFISH sample preparation.</italic> MERFISH measurements of 130 genes with five non-targeting blank controls were done as previously described, using the published encoding [<xref ref-type="bibr" rid="CR44">44</xref>] and readout probes [<xref ref-type="bibr" rid="CR84">84</xref>]. Briefly, U2-OS cells were cultured on 40 mm #1.5 coverslips that are silanized and poly-L-lysine coated [<xref ref-type="bibr" rid="CR44">44</xref>] and subsequently fixed in 4% (vol/vol) paraformaldehyde in 1 × PBS for 15 min at room temperature. Cells were then permeabilized in 0.5% Triton X-100 for 10 min at room temperature and washed in 1 × PBS containing Murine RNase Inhibitor (NEB M0314S). Cells were preincubated with hybridization wash buffer (30% (vol/vol) formamide in 2 × SSC) for 10 min at room temperature with gentle shaking. After preincubation, the coverslip was moved to a fresh 60-mm petri dish and residual hybridization wash buffer was removed with a Kimwipe lab tissue. In the new dish, 50 uL of encoding probe hybridization buffer (2 × SSC, 30% (vol/vol) formamide, 10% (wt/vol) dextran sulfate, 1 mg ml<sup>−1</sup> yeast tRNA, and a total concentration of 5 uM encoding probes and 1 μM of anchor probe: a 15-nt sequence of alternating dT and thymidine-locked nucleic acid (dT +) with a 5′-acrydite modification (Integrated DNA Technologies). The sample was placed in a humidified 37 °C oven for 36 to 48 h, then washed with 30% (vol/vol) formamide in 2 × SSC for 20 min at 37 °C, 20 min at room temperature. Samples were post-fixed with 4% (vol/vol) paraformaldehyde in 2 × SSC and washed with 2 × SSC with murine RNase inhibitor for 5 min. The samples were finally stained with an Alexa 488-conjugated anchor probe-readout oligo (Integrated DNA Technologies) and DAPI solution at 1 μg/ml.</p>
      <sec id="Sec24">
        <title>MERFISH imaging</title>
        <p id="Par57">MERFISH measurements were conducted on a home-built system as described in Huang et al. [<xref ref-type="bibr" rid="CR84">84</xref>].</p>
      </sec>
      <sec id="Sec25">
        <title>MERFISH spot detection</title>
        <p id="Par58">Individual RNA molecules were decoded in MERFISH images using MERlin v0.1.6 [<xref ref-type="bibr" rid="CR85">85</xref>]. Images were aligned across hybridization rounds by maximizing phase cross-correlation on the fiducial bead channel to adjust for drift in the position of the stage from round to round. Background was reduced by applying a high-pass filter and decoding was then performed per-pixel. For each pixel, a vector was constructed of the 16 brightness values from each of the 16 rounds of imaging. These vectors were then L2 normalized and their Euclidean distances to each of the L2 normalized barcodes from the MERFISH codebook were calculated. Pixels were assigned to the gene whose barcode they were closest to, unless the closest distance was greater than 0.512, in which case the pixel was not assigned a gene. Adjacent pixels assigned to the same gene were combined into a single RNA molecule. Molecules were filtered to remove potential false positives by comparing the mean brightness, pixel size, and distance to the closest barcode of molecules assigned to blank barcodes to those assigned to genes to achieve an estimated misidentification rate of 5%. The exact position of each molecule was calculated as the median position of all pixels consisting of the molecule.</p>
      </sec>
      <sec id="Sec26">
        <title>MERFISH image segmentation</title>
        <p id="Par59">Cellpose v1.0.2 [<xref ref-type="bibr" rid="CR70">70</xref>] was used to perform image segmentation to determine the boundaries of cells and nuclei. The nuclei boundaries were determined by running Cellpose with the “nuclei” model using default parameters on the DAPI stain channel of the pre-hybridization images. Cytoplasm boundaries were segmented with the “cyto” model and default parameters using the polyT stain channel. RNA molecules identified by MERlin were assigned to cells and nuclei by applying these segmentation masks to the positions of the molecules.</p>
      </sec>
    </sec>
    <sec id="Sec27">
      <title>iPSC cardiac differentiation and doxorubicin treatment</title>
      <p id="Par60">Matrigel (Corning, cat # 354,277)-coated plates were used to culture iPSCs with mTESR Plus human iPSC medium (StemCell Technologies, cat # 100–0276) in a humidified incubator at 37 °C with 5% CO<sub>2</sub>. iPSCs were dissociated with Gentle Cell Dissociation Reagent (StemCell Technologies, cat # 100–0485) and passaged with mTESR Plus medium and 10uM ROCK inhibitor (Tocris, cat #1254) at a ratio of 1:12. mTESR plus medium was replaced every other day until the cells reached 80% confluency for maintenance and replating, or 90% confluency for cardiac differentiation utilizing a chemically defined protocol [<xref ref-type="bibr" rid="CR86">86</xref>]. On day 0 of cardiac differentiation, cells were treated with 6 μM CHIR99021 (Selleck Chem, cat # S1263) in RPMI 1640 media (Gibco, cat # 11,875) and B27 minus insulin supplement (Thermo Fisher, cat # A1895601). On day 2, CHIR was removed, and cells were cultured with RPMI 1640 media and B27 minus insulin supplement (Thermo Fisher, cat # A18956). On day 3, media was replaced with RPMI media containing B27 minus insulin supplement and 5 μM Wnt-C59 (Cellagen Technologies, cat # C7641-2 s). On days 5, 7, and 9, media was replaced with RPMI media containing B27 insulin supplement (Thermo Fisher, cat # 17,504). On days 11 and 13, media was replaced with RPMI 1640 media without glucose (Thermo Fisher, cat # 11,879,020) containing B27 insulin supplement for purification of cardiomyocytes. From days 15 onward, the cells were cultured in RPMI 1640 media containing B27 supplement which was changed every other day until the cells reached day 30 for replating. For replating, cells were incubated in 10 × TrypLE (Thermo Fisher, cat # A1217701) for 12 min at 37 °C, neutralized with equal volumes of RPMI 1640 media containing B27 supplement with 20% FBS (Gibco, cat # 26,140–079), gently dissociated by pipetting, then spun down and resuspended for replating in RPMI 1640 media containing B27 supplement with 20% FBS. The next day, the cell media was replaced with RPMI 1640 media containing B27 supplement which was replaced with fresh media every other day. On day 48, the cells were replated onto chamber slides (Ibidi, cat # 80,826) as described above and recovered for 10 days before doxorubicin treatments began (MedChemExpress, cat # HY-15142). On day 60, doxorubicin treatments concluded, and the cells underwent methanol fixation.</p>
    </sec>
    <sec id="Sec28">
      <title>Molecular<italic> cartography</italic></title>
      <sec id="Sec29">
        <title>Cultured cell processing</title>
        <p id="Par61">After doxorubicin treatment, cardiomyocytes were washed with PBS (1 ×) twice and fixed in methanol (− 20 °C) for 10 min. After fixation, Methanol was aspirated and cells were dried and stored at − 80 °C until use. The samples were used for Molecular Cartography™ (100-plex combinatorial single-molecule fluorescence in-situ hybridization) according to the manufacturer’s instructions <italic>Day 1: Molecular Preparation Protocol</italic> for cells, starting with the addition of buffer DST1 followed by cell priming and hybridization. Briefly, cells were primed for 30 min at 37 °C followed by overnight hybridization of all probes specific for the target genes (see below for probe design details and target list). Samples were washed the next day to remove excess probes and fluorescently tagged in a two-step color development process. Regions of interest were imaged as described below and fluorescent signals removed during decolorization. Color development, imaging, and decolorization were repeated for multiple cycles to build a unique combinatorial code for every target gene that was derived from raw images as described below.</p>
      </sec>
      <sec id="Sec30">
        <title>Probe design</title>
        <p id="Par62">The probes for 100 genes were designed using Resolve’s proprietary design algorithm. Briefly, the probe design was performed at the gene level. For every targeted gene, all full-length protein-coding transcript sequences from the ENSEMBL database were used as design targets if the isoform had the GENCODE annotation tag “basic” [<xref ref-type="bibr" rid="CR87">87</xref>, <xref ref-type="bibr" rid="CR88">88</xref>]. To speed up the process, the calculation of computationally expensive parts, especially the off-target searches, the selection of probe sequences was not performed randomly, but limited to sequences with high success rates. To filter highly repetitive regions, the abundance of k-mers was obtained from the background transcriptome using Jellyfish [<xref ref-type="bibr" rid="CR89">89</xref>]. Every target sequence was scanned once for all k-mers, and those regions with rare k-mers were preferred as seeds for full probe design. A probe candidate was generated by extending a seed sequence until a certain target stability was reached. A set of simple rules was applied to discard sequences that were found experimentally to cause problems. After these fast screens, the remaining probe candidates were mapped to the background transcriptome using ThermonucleotideBLAST [<xref ref-type="bibr" rid="CR90">90</xref>] and probes with stable off-target hits were discarded. Specific probes were then scored based on the number of on-target matches (isoforms), which were weighted by their associated APPRIS level [<xref ref-type="bibr" rid="CR91">91</xref>], favoring principal isoforms over others. A bonus was added if the binding site was inside the protein-coding region. From the pool of accepted probes, the final set was composed by picking the highest-scoring probes. Probes with catalog numbers can be found in Additional File <xref rid="MOESM3" ref-type="media">3</xref>: Table S3.</p>
      </sec>
      <sec id="Sec31">
        <title>Imaging</title>
        <p id="Par63">Samples were imaged on a Zeiss Celldiscoverer 7, using the 50 × Plan Apochromat water immersion objective with an NA of 1.2 and the 0.5 × magnification changer, resulting in a 25 × final magnification. Standard CD7 LED excitation light source, filters, and dichroic mirrors were used together with customized emission filters optimized for detecting specific signals. Excitation time per image was 1000 ms for each channel (DAPI was 20 ms). A z-stack was taken at each region with a distance per z-slice according to the Nyquist-Shannon sampling theorem. The custom CD7 CMOS camera (Zeiss Axiocam Mono 712, 3.45 μm pixel size) was used. For each region, a z-stack per fluorescent color (two colors) was imaged per imaging round. A total of 8 imaging rounds were done for each position, resulting in 16 z-stacks per region. The completely automated imaging process per round was realized by a custom Python script using the scripting API of the Zeiss ZEN software (Open application development).</p>
      </sec>
      <sec id="Sec32">
        <title>Image processing and spot segmentation</title>
        <p id="Par64">As a first step, all images were corrected for background fluorescence. A target value for the allowed number of maxima was determined based on the area of the slice in μm<sup>2</sup> multiplied by the factor 0.5. This factor was empirically optimized. The brightest maxima per plane were determined, based upon an empirically optimized threshold. The number and location of the respective maxima were stored. This procedure was done for every image slice independently. Maxima that did not have a neighboring maximum in an adjacent slice (called z-group) were excluded. The resulting maxima list was further filtered in an iterative loop by adjusting the allowed thresholds for (Babs-Bback) and (Bperi-Bback) to reach a feature target value (Babs: absolute brightness, Bback: local background, Bperi: background of periphery within 1 pixel). These feature target values were based on the volume of the 3D image. Only maxima still in a group of at least 2 after filtering were passing the filter step. Each z-group was counted as one hit. The members of the z-groups with the highest absolute brightness were used as features and written to a file. They resemble a 3D-point cloud. To align the raw data images from different imaging rounds, images had to be registered. To do so, the extracted feature point clouds were used to find the transformation matrices. For this purpose, an iterative closest point cloud algorithm was used to minimize the error between two point clouds. The point clouds of each round were aligned to the point cloud of round one (reference point cloud). The corresponding point clouds were stored for downstream processes. Based upon the transformation matrices, the corresponding images were processed by a rigid transformation using trilinear interpolation. The aligned images were used to create a profile for each pixel consisting of 16 values (16 images from two color channels in 8 imaging rounds). The pixel profiles were filtered for variance from zero normalized by the total brightness of all pixels in the profile. Matched pixel profiles with the highest score were assigned as an ID to the pixel. Pixels with neighbors having the same ID were grouped. The pixel groups were filtered by group size, number of direct adjacent pixels in group, and number of dimensions with a size of two pixels. The local 3D-maxima of the groups were determined as potential final transcript locations. Maxima were filtered by the number of maxima in the raw data images where a maximum was expected. The remaining maxima were further evaluated by the fit to the corresponding code. The remaining maxima were written to the results file and considered to resemble transcripts of the corresponding gene. The ratio of signals matching to codes used in the experiment and signals matching to codes not used in the experiment were used as estimation for specificity (false positives). The algorithms for spot segmentation were written in Java and are based on the ImageJ library functionalities. Only the iterative closest point algorithm is written in C +  + based on the libpointmatcher library (<ext-link ext-link-type="uri" xlink:href="https://github.com/ethz-asl/libpointmatcher">https://github.com/ethz-asl/libpointmatcher</ext-link>).</p>
      </sec>
      <sec id="Sec33">
        <title>Image segmentation</title>
        <p id="Par65">Cellpose v1.0.2 [<xref ref-type="bibr" rid="CR70">70</xref>] was used to perform image segmentation to determine the boundaries of nuclei. The nuclei boundaries were determined by running Cellpose with the “nuclei” model using default parameters on the DAPI stain channel of the pre-hybridization images. Cytoplasm boundaries were determined with ClusterMap [<xref ref-type="bibr" rid="CR24">24</xref>] using spot coordinates.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec34">
    <title>Review history</title>
    <p id="Par66">The review history is available as Additional file <xref rid="MOESM5" ref-type="media">5</xref>.</p>
  </sec>
  <sec id="Sec35">
    <title>Peer review information</title>
    <p id="Par67">Kevin Pang was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec37">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2024_3217_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1:</bold> Supplementary Figures and Table S1. Supplementary figures and machine learning classifier feature descriptions.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2024_3217_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2:</bold><bold>Table S2.</bold> Hyperoptimization parameters and classifier architectures.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2024_3217_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3:</bold><bold>Table S3.</bold> Cardiomyocyte gene panel for Molecular Cartography experiment.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2024_3217_MOESM4_ESM.csv">
            <caption>
              <p><bold>Additional file 4:</bold><bold>Table S4.</bold> Manual annotation data for RNA localization patterns</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2024_3217_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5.</bold> Review history</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Clarence K. Mah and Noorsher Ahmed are co-first authors and contributed equally.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank members of the Yeo lab, Carter lab, Michelle Franc Ragsac, Erick Armingol, and Nate Lewis for helpful discussions and feedback on the manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p> C.K.M, N.A., and G.W.Y. conceptualized the project. C.K.M. and N.A. co-developed the software. C.K.M. and D.L. trained the classification model for subcellular localization. C.K.M., N.A., and D.L. manually annotated data for benchmarking model performance. C.K.M., N.A., and G.P. performed data preprocessing and analysis. A.M., C.K., Y.H., and Q.Z. generated the MERFISH experiment. N.L. designed the gene panel and cultured the cardiomyocytes. A.C. and E.L. aided multimodal spatial analyses. C.K.M., N.A., H.C., and G.W.Y. wrote the manuscript. H.C. and G.W.Y. supervised the project.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>C.K.M. is supported by the National Science Foundation Graduate Research Fellowship under Grant No. (DGE-2038238). N.A. was partially supported by NIH Training Grant T32 GM008666. This work was partially supported by National Institutes of Health grants NS103172, MH107367, AI132122, AI123202, AG069098, HG004659, and HG009889 to G.W.Y. G.W.Y. is also supported by an Allen Distinguished Investigator Award, a Paul G. Allen Frontiers Group advised grant of the Paul G. Allen Family Foundation. A.J.C. and E.L. acknowledge support from the Chan Zuckerberg Initiative (CZF2019-002448) and the Knut and Alice Wallenberg Foundation (KAW 2021.0346) to E.L.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets (seqFISH + , MERFISH, and Molecular Cartography datasets) supporting the conclusions of this article are available in the Figshare repository, 10.6084/m9.figshare.c.6564043.v1  [<xref ref-type="bibr" rid="CR92">92</xref>], and are also accessible through the Bento Python package.</p>
    <p>The source code for Bento is available on the GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-tools">https://github.com/ckmah/bento-tools</ext-link> [<xref ref-type="bibr" rid="CR93">93</xref>]. Analysis code for generating figures can be found at   <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-manuscript">https://github.com/ckmah/bento-manuscript</ext-link> [<xref ref-type="bibr" rid="CR94">94</xref>] and is archived at 10.5281/zenodo.10815484 [<xref ref-type="bibr" rid="CR95">95</xref>]. Documentation for Bento can be found here: <ext-link ext-link-type="uri" xlink:href="http://bento-tools.readthedocs.io">http://bento-tools.readthedocs.io</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par68">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par69">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par70">G.W.Y. is a co-founder, member of the board of directors, equity holder, and paid consultant for Locanabio (until 12/31/2023) and Eclipse Bioinnovations, and a Scientific Adviser and paid consultant to Jumpcode Genomics. G.W.Y. is a Distinguished Visiting Professor at the National University of Singapore. The terms of these arrangements have been reviewed and approved by the University of California, San Diego, in accordance with its conflict-of-interest policies. The authors declare no other competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Thul PJ, Åkesson L, Wiking M, Mahdessian D, Geladaki A, Ait Blal H, et al. A subcellular map of the human proteome. Science. 2017;356. Available from: 10.1126/science.aal3321.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <citation-alternatives>
        <element-citation id="ec-CR2" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Laurila</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Vihinen</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Prediction of disease-related mutations affecting protein localization</article-title>
          <source>BMC Genomics</source>
          <year>2009</year>
          <volume>10</volume>
          <fpage>122</fpage>
          <?supplied-pmid 19309509?>
          <pub-id pub-id-type="pmid">19309509</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR2" publication-type="journal">Laurila K, Vihinen M. Prediction of disease-related mutations affecting protein localization. BMC Genomics. 2009;10:122.<pub-id pub-id-type="pmid">19309509</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <citation-alternatives>
        <element-citation id="ec-CR3" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Park</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Yang</surname>
              <given-names>J-S</given-names>
            </name>
            <name>
              <surname>Shin</surname>
              <given-names>Y-E</given-names>
            </name>
            <name>
              <surname>Park</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Jang</surname>
              <given-names>SK</given-names>
            </name>
            <name>
              <surname>Kim</surname>
              <given-names>S</given-names>
            </name>
          </person-group>
          <article-title>Protein localization as a principal feature of the etiology and comorbidity of genetic diseases</article-title>
          <source>Mol Syst Biol</source>
          <year>2011</year>
          <volume>7</volume>
          <fpage>494</fpage>
          <?supplied-pmid 21613983?>
          <pub-id pub-id-type="pmid">21613983</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR3" publication-type="journal">Park S, Yang J-S, Shin Y-E, Park J, Jang SK, Kim S. Protein localization as a principal feature of the etiology and comorbidity of genetic diseases. Mol Syst Biol. 2011;7:494.<pub-id pub-id-type="pmid">21613983</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <citation-alternatives>
        <element-citation id="ec-CR4" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Chin</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Lécuyer</surname>
              <given-names>E</given-names>
            </name>
          </person-group>
          <article-title>RNA localization: Making its way to the center stage</article-title>
          <source>Biochim Biophys Acta Gen Subj</source>
          <year>2017</year>
          <volume>1861</volume>
          <fpage>2956</fpage>
          <lpage>2970</lpage>
          <?supplied-pmid 28630007?>
          <pub-id pub-id-type="pmid">28630007</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR4" publication-type="journal">Chin A, Lécuyer E. RNA localization: Making its way to the center stage. Biochim Biophys Acta Gen Subj. 2017;1861:2956–70.<pub-id pub-id-type="pmid">28630007</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">Bovaird S, Patel D, Padilla J-CA, Lécuyer E. Biological functions, regulatory mechanisms, and disease relevance of RNA localization pathways. FEBS Lett. 2018;592:2948–72.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <citation-alternatives>
        <element-citation id="ec-CR6" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Das</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Singer</surname>
              <given-names>RH</given-names>
            </name>
            <name>
              <surname>Yoon</surname>
              <given-names>YJ</given-names>
            </name>
          </person-group>
          <article-title>The travels of mRNAs in neurons: do they know where they are going?</article-title>
          <source>Curr Opin Neurobiol</source>
          <year>2019</year>
          <volume>57</volume>
          <fpage>110</fpage>
          <lpage>116</lpage>
          <?supplied-pmid 30784978?>
          <pub-id pub-id-type="pmid">30784978</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR6" publication-type="journal">Das S, Singer RH, Yoon YJ. The travels of mRNAs in neurons: do they know where they are going? Curr Opin Neurobiol. 2019;57:110–6.<pub-id pub-id-type="pmid">30784978</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Sahoo PK, Smith DS, Perrone-Bizzozero N, Twiss JL. Axonal mRNA transport and translation at a glance. J Cell Sci. 2018;131. Available from: 10.1242/jcs.196808.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">von Kügelgen N, Chekulaeva M. Conservation of a core neurite transcriptome across neuronal types and species. Wiley Interdiscip Rev RNA. 2020;e1590.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <citation-alternatives>
        <element-citation id="ec-CR9" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Culver</surname>
              <given-names>BP</given-names>
            </name>
            <name>
              <surname>DeClercq</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Dolgalev</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Yu</surname>
              <given-names>MS</given-names>
            </name>
            <name>
              <surname>Ma</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Heguy</surname>
              <given-names>A</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Huntington’s disease protein huntingtin associates with its own mRNA</article-title>
          <source>J Huntingtons Dis</source>
          <year>2016</year>
          <volume>5</volume>
          <fpage>39</fpage>
          <lpage>51</lpage>
          <?supplied-pmid 26891106?>
          <pub-id pub-id-type="pmid">26891106</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR9" publication-type="journal">Culver BP, DeClercq J, Dolgalev I, Yu MS, Ma B, Heguy A, et al. Huntington’s disease protein huntingtin associates with its own mRNA. J Huntingtons Dis. 2016;5:39–51.<pub-id pub-id-type="pmid">26891106</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <citation-alternatives>
        <element-citation id="ec-CR10" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Romo</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Mohn</surname>
              <given-names>ES</given-names>
            </name>
            <name>
              <surname>Aronin</surname>
              <given-names>N</given-names>
            </name>
          </person-group>
          <article-title>A fresh look at huntingtin mRNA processing in Huntington’s disease</article-title>
          <source>J Huntingtons Dis</source>
          <year>2018</year>
          <volume>7</volume>
          <fpage>101</fpage>
          <lpage>108</lpage>
          <?supplied-pmid 29865084?>
          <pub-id pub-id-type="pmid">29865084</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR10" publication-type="journal">Romo L, Mohn ES, Aronin N. A fresh look at huntingtin mRNA processing in Huntington’s disease. J Huntingtons Dis. 2018;7:101–8.<pub-id pub-id-type="pmid">29865084</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <citation-alternatives>
        <element-citation id="ec-CR11" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>White</surname>
              <given-names>JA</given-names>
              <suffix>2nd</suffix>
            </name>
            <name>
              <surname>Anderson</surname>
              <given-names>E</given-names>
            </name>
            <name>
              <surname>Zimmerman</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Zheng</surname>
              <given-names>KH</given-names>
            </name>
            <name>
              <surname>Rouhani</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Gunawardena</surname>
              <given-names>S</given-names>
            </name>
          </person-group>
          <article-title>Huntingtin differentially regulates the axonal transport of a sub-set of Rab-containing vesicles in vivo</article-title>
          <source>Hum Mol Genet</source>
          <year>2015</year>
          <volume>24</volume>
          <fpage>7182</fpage>
          <lpage>7195</lpage>
          <?supplied-pmid 26450517?>
          <pub-id pub-id-type="pmid">26450517</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR11" publication-type="journal">White JA 2nd, Anderson E, Zimmerman K, Zheng KH, Rouhani R, Gunawardena S. Huntingtin differentially regulates the axonal transport of a sub-set of Rab-containing vesicles in vivo. Hum Mol Genet. 2015;24:7182–95.<pub-id pub-id-type="pmid">26450517</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Fernandopulle MS, Lippincott-Schwartz J, Ward ME. RNA transport and local translation in neurodevelopmental and neurodegenerative disease. Nat Neurosci. 2021; Available from: 10.1038/s41593-020-00785-2.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Chen KH, Boettiger AN, Moffitt JR, Wang S, Zhuang X. RNA imaging. Spatially resolved, highly multiplexed RNA profiling in single cells. Science. 2015;348:aaa6090.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Eng C-HL, Lawson M, Zhu Q, Dries R, Koulena N, Takei Y, et al. Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH. Nature. 2019;568:235–9.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Gyllborg D, Langseth CM, Qian X, Choi E, Salas SM, Hilscher MM, et al. Hybridization-based in situ sequencing (HybISS) for spatially resolved transcriptomics in human and mouse brain tissue. Nucleic Acids Res. 2020; Available from: 10.1093/nar/gkaa792.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Alon S, Goodwin DR, Sinha A, Wassie AT, Chen F, Daugharthy ER, et al. Expansion sequencing: spatially precise in situ transcriptomics in intact biological systems. Cold Spring Harbor Laboratory. 2020 [cited 2020 Nov 20]. p. 2020.05.13.094268. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.05.13.094268v1">https://www.biorxiv.org/content/10.1101/2020.05.13.094268v1</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Palla G, Spitzer H, Klein M, Fischer D, Schaar AC, Kuemmerle LB, et al. Squidpy: a scalable framework for spatial omics analysis. Nat Methods. 2022; Available from: 10.1038/s41592-021-01358-2.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Pham D, Tan X, Xu J, Grice LF, Lam PY, Raghubar A, et al. stLearn: integrating spatial location, tissue morphology and gene expression to find cell types, cell-cell interactions and spatial trajectories within undissociated tissues. bioRxiv. 2020 [cited 2022 Jun 8]. p. 2020.05.31.125658. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/biorxiv/early/2020/05/31/2020.05.31.125658">https://www.biorxiv.org/content/biorxiv/early/2020/05/31/2020.05.31.125658</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Dries R, Zhu Q, Dong R, Eng C-HL, Li H, Liu K, et al. Giotto: a toolbox for integrative analysis and visualization of spatial expression data. Genome Biol. 2021;22:78.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <citation-alternatives>
        <element-citation id="ec-CR20" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Butler</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Hoffman</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Smibert</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Papalexi</surname>
              <given-names>E</given-names>
            </name>
            <name>
              <surname>Satija</surname>
              <given-names>R</given-names>
            </name>
          </person-group>
          <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>
          <source>Nat Biotechnol</source>
          <year>2018</year>
          <volume>36</volume>
          <fpage>411</fpage>
          <lpage>420</lpage>
          <?supplied-pmid 29608179?>
          <pub-id pub-id-type="pmid">29608179</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR20" publication-type="journal">Butler A, Hoffman P, Smibert P, Papalexi E, Satija R. Integrating single-cell transcriptomic data across different conditions, technologies, and species. Nat Biotechnol. 2018;36:411–20.<pub-id pub-id-type="pmid">29608179</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <citation-alternatives>
        <element-citation id="ec-CR21" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Wolf</surname>
              <given-names>FA</given-names>
            </name>
            <name>
              <surname>Angerer</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Theis</surname>
              <given-names>FJ</given-names>
            </name>
          </person-group>
          <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
          <source>Genome Biol</source>
          <year>2018</year>
          <volume>19</volume>
          <fpage>15</fpage>
          <lpage>15</lpage>
          <?supplied-pmid 29409532?>
          <pub-id pub-id-type="pmid">29409532</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR21" publication-type="journal">Wolf FA, Angerer P, Theis FJ. SCANPY: large-scale single-cell gene expression data analysis. Genome Biol. 2018;19:15–15.<pub-id pub-id-type="pmid">29409532</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <citation-alternatives>
        <element-citation id="ec-CR22" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Imbert</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Ouyang</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Safieddine</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Coleno</surname>
              <given-names>E</given-names>
            </name>
            <name>
              <surname>Zimmer</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Bertrand</surname>
              <given-names>E</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>FISH-quant v2: a scalable and modular tool for smFISH image analysis</article-title>
          <source>RNA</source>
          <year>2022</year>
          <volume>28</volume>
          <fpage>786</fpage>
          <lpage>795</lpage>
          <?supplied-pmid 35347070?>
          <pub-id pub-id-type="pmid">35347070</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR22" publication-type="journal">Imbert A, Ouyang W, Safieddine A, Coleno E, Zimmer C, Bertrand E, et al. FISH-quant v2: a scalable and modular tool for smFISH image analysis. RNA. 2022;28:786–95.<pub-id pub-id-type="pmid">35347070</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Walter FC, Stegle O, Velten B. FISHFactor: A probabilistic factor model for spatial transcriptomics data with subcellular resolution. bioRxiv. 2021. Available from: 10.1101/2021.11.04.467354.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <citation-alternatives>
        <element-citation id="ec-CR24" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>He</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Tang</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Huang</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Ren</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Zhou</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>K</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>ClusterMap for multi-scale clustering analysis of spatial gene expression</article-title>
          <source>Nat Commun</source>
          <year>2021</year>
          <volume>12</volume>
          <fpage>5909</fpage>
          <?supplied-pmid 34625546?>
          <pub-id pub-id-type="pmid">34625546</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR24" publication-type="journal">He Y, Tang X, Huang J, Ren J, Zhou H, Chen K, et al. ClusterMap for multi-scale clustering analysis of spatial gene expression. Nat Commun. 2021;12:5909.<pub-id pub-id-type="pmid">34625546</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <citation-alternatives>
        <element-citation id="ec-CR25" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Petukhov</surname>
              <given-names>V</given-names>
            </name>
            <name>
              <surname>Xu</surname>
              <given-names>RJ</given-names>
            </name>
            <name>
              <surname>Soldatov</surname>
              <given-names>RA</given-names>
            </name>
            <name>
              <surname>Cadinu</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Khodosevich</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Moffitt</surname>
              <given-names>JR</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Cell segmentation in imaging-based spatial transcriptomics</article-title>
          <source>Nat Biotechnol</source>
          <year>2022</year>
          <volume>40</volume>
          <fpage>345</fpage>
          <lpage>354</lpage>
          <?supplied-pmid 34650268?>
          <pub-id pub-id-type="pmid">34650268</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR25" publication-type="journal">Petukhov V, Xu RJ, Soldatov RA, Cadinu P, Khodosevich K, Moffitt JR, et al. Cell segmentation in imaging-based spatial transcriptomics. Nat Biotechnol. 2022;40:345–54.<pub-id pub-id-type="pmid">34650268</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Spitzer H, Berry S, Donoghoe M, Pelkmans L, Theis FJ. Learning consistent subcellular landmarks to quantify changes in multiplexed protein maps. bioRxiv. 2022 [cited 2022 May 11]. p. 2022.05.07.490900. Available from: https://www.biorxiv.org/content/10.1101/2022.05.07.490900v1.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Liu CC, Greenwald NF, Kong A, McCaffrey EF, Leow KX, Mrdjen D, et al. Robust phenotyping of highly multiplexed tissue imaging data using pixel-level clustering. bioRxiv. 2022 [cited 2022 Dec 22]. p. 2022.08.16.504171. Available from: https://www.biorxiv.org/content/10.1101/2022.08.16.504171v1.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Jordahl K, Van den Bossche J, Fleischmann M, McBride J, Wasserman J, Gerard J, et al. geopandas/geopandas: v0.9.0. 2021. Available from: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/4569086">https://zenodo.org/record/4569086</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Gillies S, Ward B, Petersen AS. Rasterio: Geospatial raster I/O for Python programmers. URL<ext-link ext-link-type="uri" xlink:href="https://github.com/mapbox/rasterio">https://github.com/mapbox/rasterio</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <citation-alternatives>
        <element-citation id="ec-CR30" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Virtanen</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Gommers</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Oliphant</surname>
              <given-names>TE</given-names>
            </name>
            <name>
              <surname>Haberland</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Reddy</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Cournapeau</surname>
              <given-names>D</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>
          <source>Nat Methods</source>
          <year>2020</year>
          <volume>17</volume>
          <fpage>261</fpage>
          <lpage>72</lpage>
          <?supplied-pmid 32015543?>
          <pub-id pub-id-type="pmid">32015543</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR30" publication-type="journal">Virtanen P, Gommers R, Oliphant TE, Haberland M, Reddy T, Cournapeau D, et al. SciPy 1.0: fundamental algorithms for scientific computing in Python. Nat Methods. 2020;17:261–72.<pub-id pub-id-type="pmid">32015543</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <citation-alternatives>
        <element-citation id="ec-CR31" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kossaifi</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Panagakis</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Anandkumar</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Pantic</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>TensorLy: tensor learning in Python</article-title>
          <source>J Mach Learn Res</source>
          <year>2019</year>
          <volume>20</volume>
          <fpage>1</fpage>
          <lpage>6</lpage>
        </element-citation>
        <mixed-citation id="mc-CR31" publication-type="journal">Kossaifi J, Panagakis Y, Anandkumar A, Pantic M. TensorLy: tensor learning in Python. J Mach Learn Res. 2019;20:1–6.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <citation-alternatives>
        <element-citation id="ec-CR32" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Virshup</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Bredikhin</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Heumos</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Palla</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Sturm</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Gayoso</surname>
              <given-names>A</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>The scverse project provides a computational ecosystem for single-cell omics data analysis</article-title>
          <source>Nat Biotechnol</source>
          <year>2023</year>
          <volume>41</volume>
          <fpage>604</fpage>
          <lpage>606</lpage>
          <?supplied-pmid 37037904?>
          <pub-id pub-id-type="pmid">37037904</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR32" publication-type="journal">Virshup I, Bredikhin D, Heumos L, Palla G, Sturm G, Gayoso A, et al. The scverse project provides a computational ecosystem for single-cell omics data analysis. Nat Biotechnol. 2023;41:604–6.<pub-id pub-id-type="pmid">37037904</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">He S, Bhatt R, Brown C, Brown EA, Buhr DL, Chantranuvatana K, et al. High-plex multiomic analysis in FFPE at subcellular level by spatial molecular imaging. bioRxiv. 2021. Available from: http://biorxiv.org/lookup/doi/10.1101/2021.11.03.467020.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <citation-alternatives>
        <element-citation id="ec-CR34" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lee</surname>
              <given-names>JH</given-names>
            </name>
            <name>
              <surname>Daugharthy</surname>
              <given-names>ER</given-names>
            </name>
            <name>
              <surname>Scheiman</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Kalhor</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Ferrante</surname>
              <given-names>TC</given-names>
            </name>
            <name>
              <surname>Terry</surname>
              <given-names>R</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Fluorescent in situ sequencing (FISSEQ) of RNA for gene expression profiling in intact cells and tissues</article-title>
          <source>Nat Protoc</source>
          <year>2015</year>
          <volume>10</volume>
          <fpage>442</fpage>
          <lpage>458</lpage>
          <?supplied-pmid 25675209?>
          <pub-id pub-id-type="pmid">25675209</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR34" publication-type="journal">Lee JH, Daugharthy ER, Scheiman J, Kalhor R, Ferrante TC, Terry R, et al. Fluorescent in situ sequencing (FISSEQ) of RNA for gene expression profiling in intact cells and tissues. Nat Protoc. 2015;10:442–58.<pub-id pub-id-type="pmid">25675209</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Hu S, Liu S, Bian Y, Poddar M, Singh S, Cao C, et al. Dynamic control of metabolic zonation and liver repair by endothelial cell Wnt2 and Wnt9b revealed by single cell spatial transcriptomics using Molecular Cartography. bioRxiv. 2022 [cited 2022 Apr 19]. p. 2022.03.18.484868. Available from: https://www.biorxiv.org/content/10.1101/2022.03.18.484868.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <mixed-citation publication-type="other">Virshup I, Rybakov S, Theis FJ, Angerer P, Alexander Wolf F. anndata: annotated data. bioRxiv. 2021 [cited 2022 Apr 20]. p. 2021.12.16.473007. Available from: https://www.biorxiv.org/content/10.1101/2021.12.16.473007v1.</mixed-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <citation-alternatives>
        <element-citation id="ec-CR37" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Volkova</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Russell</surname>
              <given-names>R</given-names>
              <suffix>3rd</suffix>
            </name>
          </person-group>
          <article-title>Anthracycline cardiotoxicity: prevalence, pathogenesis and treatment</article-title>
          <source>Curr Cardiol Rev</source>
          <year>2011</year>
          <volume>7</volume>
          <fpage>214</fpage>
          <lpage>220</lpage>
          <?supplied-pmid 22758622?>
          <pub-id pub-id-type="pmid">22758622</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR37" publication-type="journal">Volkova M, Russell R 3rd. Anthracycline cardiotoxicity: prevalence, pathogenesis and treatment. Curr Cardiol Rev. 2011;7:214–20.<pub-id pub-id-type="pmid">22758622</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Viola P, Jones M. Rapid object detection using a boosted cascade of simple features. Proceedings of the 2001 IEEE Computer Society Conference on Computer Vision and Pattern Recognition CVPR 2001. 2001. p. I – I.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Imbert A, Ouyang W, Safieddine A, Coleno E, Zimmer C, Bertrand E, et al. FISH-quant v2: a scalable and modular analysis tool for smFISH image analysis. bioRxiv. 2021 [cited 2022 Feb 19]. p. 2021.07.20.453024. Available from: https://www.biorxiv.org/content/10.1101/2021.07.20.453024v1.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <citation-alternatives>
        <element-citation id="ec-CR40" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Battich</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Stoeger</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Pelkmans</surname>
              <given-names>L</given-names>
            </name>
          </person-group>
          <article-title>Image-based transcriptomics in thousands of single human cells at single-molecule resolution</article-title>
          <source>Nat Methods</source>
          <year>2013</year>
          <volume>10</volume>
          <fpage>1127</fpage>
          <lpage>1133</lpage>
          <?supplied-pmid 24097269?>
          <pub-id pub-id-type="pmid">24097269</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR40" publication-type="journal">Battich N, Stoeger T, Pelkmans L. Image-based transcriptomics in thousands of single human cells at single-molecule resolution. Nat Methods. 2013;10:1127–33.<pub-id pub-id-type="pmid">24097269</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <citation-alternatives>
        <element-citation id="ec-CR41" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Stoeger</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Battich</surname>
              <given-names>N</given-names>
            </name>
            <name>
              <surname>Herrmann</surname>
              <given-names>MD</given-names>
            </name>
            <name>
              <surname>Yakimovich</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Pelkmans</surname>
              <given-names>L</given-names>
            </name>
          </person-group>
          <article-title>Computer vision for image-based transcriptomics</article-title>
          <source>Methods</source>
          <year>2015</year>
          <volume>85</volume>
          <fpage>44</fpage>
          <lpage>53</lpage>
          <?supplied-pmid 26014038?>
          <pub-id pub-id-type="pmid">26014038</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR41" publication-type="journal">Stoeger T, Battich N, Herrmann MD, Yakimovich Y, Pelkmans L. Computer vision for image-based transcriptomics. Methods. 2015;85:44–53.<pub-id pub-id-type="pmid">26014038</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <citation-alternatives>
        <element-citation id="ec-CR42" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Samacoits</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Chouaib</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Safieddine</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Traboulsi</surname>
              <given-names>A-M</given-names>
            </name>
            <name>
              <surname>Ouyang</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Zimmer</surname>
              <given-names>C</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>A computational framework to study sub-cellular RNA localization</article-title>
          <source>Nat Commun</source>
          <year>2018</year>
          <volume>9</volume>
          <fpage>4584</fpage>
          <?supplied-pmid 30389932?>
          <pub-id pub-id-type="pmid">30389932</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR42" publication-type="journal">Samacoits A, Chouaib R, Safieddine A, Traboulsi A-M, Ouyang W, Zimmer C, et al. A computational framework to study sub-cellular RNA localization. Nat Commun. 2018;9:4584.<pub-id pub-id-type="pmid">30389932</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <citation-alternatives>
        <element-citation id="ec-CR43" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Chouaib</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Safieddine</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Pichon</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Imbert</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Kwon</surname>
              <given-names>OS</given-names>
            </name>
            <name>
              <surname>Samacoits</surname>
              <given-names>A</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>A dual protein-mRNA localization screen reveals compartmentalized translation and widespread co-translational RNA targeting</article-title>
          <source>Dev Cell</source>
          <year>2020</year>
          <volume>54</volume>
          <fpage>773</fpage>
          <lpage>91.e5</lpage>
          <?supplied-pmid 32783880?>
          <pub-id pub-id-type="pmid">32783880</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR43" publication-type="journal">Chouaib R, Safieddine A, Pichon X, Imbert A, Kwon OS, Samacoits A, et al. A dual protein-mRNA localization screen reveals compartmentalized translation and widespread co-translational RNA targeting. Dev Cell. 2020;54:773–91.e5.<pub-id pub-id-type="pmid">32783880</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <citation-alternatives>
        <element-citation id="ec-CR44" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Moffitt</surname>
              <given-names>JR</given-names>
            </name>
            <name>
              <surname>Hao</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>KH</given-names>
            </name>
            <name>
              <surname>Babcock</surname>
              <given-names>HP</given-names>
            </name>
            <name>
              <surname>Zhuang</surname>
              <given-names>X</given-names>
            </name>
          </person-group>
          <article-title>High-throughput single-cell gene-expression profiling with multiplexed error-robust fluorescence in situ hybridization</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2016</year>
          <volume>113</volume>
          <fpage>11046</fpage>
          <lpage>11051</lpage>
          <?supplied-pmid 27625426?>
          <pub-id pub-id-type="pmid">27625426</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR44" publication-type="journal">Moffitt JR, Hao J, Wang G, Chen KH, Babcock HP, Zhuang X. High-throughput single-cell gene-expression profiling with multiplexed error-robust fluorescence in situ hybridization. Proc Natl Acad Sci U S A. 2016;113:11046–51.<pub-id pub-id-type="pmid">27625426</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">Kumar A, Schrader A, Boroojeny A, Asadian M, Lee J, Song Y, et al. Intracellular Spatial Transcriptomic Analysis Toolkit (InSTAnT). Research Square. 2023 [cited 2023 Jan 31]. Available from: <ext-link ext-link-type="uri" xlink:href="https://assets.researchsquare.com/files/rs-2481749/v1/f2ccb04e8b30b4bc00a8ea1e.pdf?c=1674833501">https://assets.researchsquare.com/files/rs-2481749/v1/f2ccb04e8b30b4bc00a8ea1e.pdf?c=1674833501</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <citation-alternatives>
        <element-citation id="ec-CR46" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xia</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Fan</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Emanuel</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Hao</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Zhuang</surname>
              <given-names>X</given-names>
            </name>
          </person-group>
          <article-title>Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2019</year>
          <volume>116</volume>
          <fpage>19490</fpage>
          <lpage>19499</lpage>
          <?supplied-pmid 31501331?>
          <pub-id pub-id-type="pmid">31501331</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR46" publication-type="journal">Xia C, Fan J, Emanuel G, Hao J, Zhuang X. Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression. Proc Natl Acad Sci U S A. 2019;116:19490–9.<pub-id pub-id-type="pmid">31501331</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <citation-alternatives>
        <element-citation id="ec-CR47" publication-type="journal">
          <person-group person-group-type="author">
            <collab>Gene Ontology Consortium</collab>
          </person-group>
          <article-title>The Gene Ontology resource: enriching a GOld mine</article-title>
          <source>Nucleic Acids Res</source>
          <year>2021</year>
          <volume>49</volume>
          <fpage>D325</fpage>
          <lpage>D334</lpage>
          <pub-id pub-id-type="pmid">33290552</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR47" publication-type="journal">Gene Ontology Consortium. The Gene Ontology resource: enriching a GOld mine. Nucleic Acids Res. 2021;49:D325–34.<pub-id pub-id-type="pmid">33290552</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <citation-alternatives>
        <element-citation id="ec-CR48" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xu</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Belyi</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Bojic</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Ratti</surname>
              <given-names>C</given-names>
            </name>
          </person-group>
          <article-title>How friends share urban space: an exploratory spatiotemporal analysis using mobile phone data</article-title>
          <source>Trans GIS</source>
          <year>2017</year>
          <volume>21</volume>
          <fpage>468</fpage>
          <lpage>487</lpage>
        </element-citation>
        <mixed-citation id="mc-CR48" publication-type="journal">Xu Y, Belyi A, Bojic I, Ratti C. How friends share urban space: an exploratory spatiotemporal analysis using mobile phone data. Trans GIS. 2017;21:468–87.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Zeng H, Huang J, Ren J, Wang CK, Tang Z, Zhou H, et al. Spatially resolved single-cell translatomics at molecular resolution. Science. 2023;380:eadd3067.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <citation-alternatives>
        <element-citation id="ec-CR50" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ripley</surname>
              <given-names>BD</given-names>
            </name>
          </person-group>
          <article-title>The second-order analysis of stationary point processes</article-title>
          <source>J Appl Probab</source>
          <year>1976</year>
          <volume>13</volume>
          <fpage>255</fpage>
          <lpage>266</lpage>
        </element-citation>
        <mixed-citation id="mc-CR50" publication-type="journal">Ripley BD. The second-order analysis of stationary point processes. J Appl Probab. 1976;13:255–66.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Tiefelsdorf M. Modelling spatial processes: the identification and analysis of spatial relationships in regression residuals by means of Moran’s I. Springer; 2006.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Cliff AD, Ord JK. Spatial processes: models &amp; applications. Pion; 1981.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">Leslie TF, Kronenfeld BJ. The colocation quotient: a new measure of spatial association between categorical subsets of points. 协同区位商:点集分类子集间空间关联性的新度量标准: The colocation quotient. Geogr Anal. 2011;43:306–26.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Shashua A, Hazan T. Non-negative tensor factorization with applications to statistics and computer vision. Proceedings of the 22nd international conference on Machine learning. New York, NY, USA: Association for Computing Machinery; 2005. p. 792–9.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <mixed-citation publication-type="other">Gassmann R. Dynein at the kinetochore. J Cell Sci. 2023;136. Available from: 10.1242/jcs.220269.</mixed-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <citation-alternatives>
        <element-citation id="ec-CR56" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gupta</surname>
              <given-names>MN</given-names>
            </name>
            <name>
              <surname>Uversky</surname>
              <given-names>VN</given-names>
            </name>
          </person-group>
          <article-title>Moonlighting enzymes: when cellular context defines specificity</article-title>
          <source>Cell Mol Life Sci</source>
          <year>2023</year>
          <volume>80</volume>
          <fpage>130</fpage>
          <?supplied-pmid 37093283?>
          <pub-id pub-id-type="pmid">37093283</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR56" publication-type="journal">Gupta MN, Uversky VN. Moonlighting enzymes: when cellular context defines specificity. Cell Mol Life Sci. 2023;80:130.<pub-id pub-id-type="pmid">37093283</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <citation-alternatives>
        <element-citation id="ec-CR57" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gnann</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Cesnik</surname>
              <given-names>AJ</given-names>
            </name>
            <name>
              <surname>Lundberg</surname>
              <given-names>E</given-names>
            </name>
          </person-group>
          <article-title>Illuminating non-genetic cellular heterogeneity with imaging-based spatial proteomics</article-title>
          <source>Trends Cancer Res</source>
          <year>2021</year>
          <volume>7</volume>
          <fpage>278</fpage>
          <lpage>282</lpage>
        </element-citation>
        <mixed-citation id="mc-CR57" publication-type="journal">Gnann C, Cesnik AJ, Lundberg E. Illuminating non-genetic cellular heterogeneity with imaging-based spatial proteomics. Trends Cancer Res. 2021;7:278–82.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <citation-alternatives>
        <element-citation id="ec-CR58" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Fazal</surname>
              <given-names>FM</given-names>
            </name>
            <name>
              <surname>Han</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Parker</surname>
              <given-names>KR</given-names>
            </name>
            <name>
              <surname>Kaewsapsak</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Xu</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Boettiger</surname>
              <given-names>AN</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Atlas of subcellular RNA localization revealed by APEX-Seq</article-title>
          <source>Cell</source>
          <year>2019</year>
          <volume>178</volume>
          <fpage>473</fpage>
          <lpage>90.e26</lpage>
          <?supplied-pmid 31230715?>
          <pub-id pub-id-type="pmid">31230715</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR58" publication-type="journal">Fazal FM, Han S, Parker KR, Kaewsapsak P, Xu J, Boettiger AN, et al. Atlas of subcellular RNA localization revealed by APEX-Seq. Cell. 2019;178:473–90.e26.<pub-id pub-id-type="pmid">31230715</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <citation-alternatives>
        <element-citation id="ec-CR59" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Janesick</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Shelansky</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Gottscho</surname>
              <given-names>AD</given-names>
            </name>
            <name>
              <surname>Wagner</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Williams</surname>
              <given-names>SR</given-names>
            </name>
            <name>
              <surname>Rouault</surname>
              <given-names>M</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis</article-title>
          <source>Nat Commun</source>
          <year>2023</year>
          <volume>14</volume>
          <fpage>8353</fpage>
          <?supplied-pmid 38114474?>
          <pub-id pub-id-type="pmid">38114474</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR59" publication-type="journal">Janesick A, Shelansky R, Gottscho AD, Wagner F, Williams SR, Rouault M, et al. High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis. Nat Commun. 2023;14:8353.<pub-id pub-id-type="pmid">38114474</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <citation-alternatives>
        <element-citation id="ec-CR60" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Young</surname>
              <given-names>RC</given-names>
            </name>
            <name>
              <surname>Ozols</surname>
              <given-names>RF</given-names>
            </name>
            <name>
              <surname>Myers</surname>
              <given-names>CE</given-names>
            </name>
          </person-group>
          <article-title>The anthracycline antineoplastic drugs</article-title>
          <source>N Engl J Med</source>
          <year>1981</year>
          <volume>305</volume>
          <fpage>139</fpage>
          <lpage>153</lpage>
          <?supplied-pmid 7017406?>
          <pub-id pub-id-type="pmid">7017406</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR60" publication-type="journal">Young RC, Ozols RF, Myers CE. The anthracycline antineoplastic drugs. N Engl J Med. 1981;305:139–53.<pub-id pub-id-type="pmid">7017406</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <citation-alternatives>
        <element-citation id="ec-CR61" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Kalyanaraman</surname>
              <given-names>B</given-names>
            </name>
          </person-group>
          <article-title>Teaching the basics of the mechanism of doxorubicin-induced cardiotoxicity: Have we been barking up the wrong tree?</article-title>
          <source>Redox Biol</source>
          <year>2020</year>
          <volume>29</volume>
          <fpage>101394</fpage>
          <?supplied-pmid 31790851?>
          <pub-id pub-id-type="pmid">31790851</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR61" publication-type="journal">Kalyanaraman B. Teaching the basics of the mechanism of doxorubicin-induced cardiotoxicity: Have we been barking up the wrong tree? Redox Biol. 2020;29: 101394.<pub-id pub-id-type="pmid">31790851</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <citation-alternatives>
        <element-citation id="ec-CR62" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sheibani</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Azizi</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Shayan</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Nezamoleslami</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Eslami</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Farjoo</surname>
              <given-names>MH</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Doxorubicin-induced cardiotoxicity: an overview on pre-clinical therapeutic approaches</article-title>
          <source>Cardiovasc Toxicol</source>
          <year>2022</year>
          <volume>22</volume>
          <fpage>292</fpage>
          <lpage>310</lpage>
          <?supplied-pmid 35061218?>
          <pub-id pub-id-type="pmid">35061218</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR62" publication-type="journal">Sheibani M, Azizi Y, Shayan M, Nezamoleslami S, Eslami F, Farjoo MH, et al. Doxorubicin-induced cardiotoxicity: an overview on pre-clinical therapeutic approaches. Cardiovasc Toxicol. 2022;22:292–310.<pub-id pub-id-type="pmid">35061218</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <citation-alternatives>
        <element-citation id="ec-CR63" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yu</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Kong</surname>
              <given-names>Q</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Lu</surname>
              <given-names>J-J</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>X</given-names>
            </name>
          </person-group>
          <article-title>Recent progress in doxorubicin-induced cardiotoxicity and protective potential of natural products</article-title>
          <source>Phytomedicine</source>
          <year>2018</year>
          <volume>40</volume>
          <fpage>125</fpage>
          <lpage>139</lpage>
          <?supplied-pmid 29496165?>
          <pub-id pub-id-type="pmid">29496165</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR63" publication-type="journal">Yu J, Wang C, Kong Q, Wu X, Lu J-J, Chen X. Recent progress in doxorubicin-induced cardiotoxicity and protective potential of natural products. Phytomedicine. 2018;40:125–39.<pub-id pub-id-type="pmid">29496165</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <citation-alternatives>
        <element-citation id="ec-CR64" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rahman</surname>
              <given-names>AM</given-names>
            </name>
            <name>
              <surname>Yusuf</surname>
              <given-names>SW</given-names>
            </name>
            <name>
              <surname>Ewer</surname>
              <given-names>MS</given-names>
            </name>
          </person-group>
          <article-title>Anthracycline-induced cardiotoxicity and the cardiac-sparing effect of liposomal formulation</article-title>
          <source>Int J Nanomedicine</source>
          <year>2007</year>
          <volume>2</volume>
          <fpage>567</fpage>
          <lpage>583</lpage>
          <?supplied-pmid 18203425?>
          <pub-id pub-id-type="pmid">18203425</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR64" publication-type="journal">Rahman AM, Yusuf SW, Ewer MS. Anthracycline-induced cardiotoxicity and the cardiac-sparing effect of liposomal formulation. Int J Nanomedicine. 2007;2:567–83.<pub-id pub-id-type="pmid">18203425</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <citation-alternatives>
        <element-citation id="ec-CR65" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xu</surname>
              <given-names>MF</given-names>
            </name>
            <name>
              <surname>Tang</surname>
              <given-names>PL</given-names>
            </name>
            <name>
              <surname>Qian</surname>
              <given-names>ZM</given-names>
            </name>
            <name>
              <surname>Ashraf</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Effects by doxorubicin on the myocardium are mediated by oxygen free radicals</article-title>
          <source>Life Sci</source>
          <year>2001</year>
          <volume>68</volume>
          <fpage>889</fpage>
          <lpage>901</lpage>
          <?supplied-pmid 11213359?>
          <pub-id pub-id-type="pmid">11213359</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR65" publication-type="journal">Xu MF, Tang PL, Qian ZM, Ashraf M. Effects by doxorubicin on the myocardium are mediated by oxygen free radicals. Life Sci. 2001;68:889–901.<pub-id pub-id-type="pmid">11213359</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <citation-alternatives>
        <element-citation id="ec-CR66" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Šimůnek</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Štěrba</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Popelová</surname>
              <given-names>O</given-names>
            </name>
            <name>
              <surname>Adamcová</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Hrdina</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Geršl</surname>
              <given-names>V</given-names>
            </name>
          </person-group>
          <article-title>Anthracycline-induced cardiotoxicity: overview of studies examining the roles of oxidative stress and free cellular iron</article-title>
          <source>Pharmacol Rep</source>
          <year>2009</year>
          <volume>61</volume>
          <fpage>154</fpage>
          <lpage>171</lpage>
          <?supplied-pmid 19307704?>
          <pub-id pub-id-type="pmid">19307704</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR66" publication-type="journal">Šimůnek T, Štěrba M, Popelová O, Adamcová M, Hrdina R, Geršl V. Anthracycline-induced cardiotoxicity: overview of studies examining the roles of oxidative stress and free cellular iron. Pharmacol Rep. 2009;61:154–71.<pub-id pub-id-type="pmid">19307704</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <citation-alternatives>
        <element-citation id="ec-CR67" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xiong</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>Y-Z</given-names>
            </name>
            <name>
              <surname>Zhang</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>Z-X</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>X-Y</given-names>
            </name>
            <name>
              <surname>Jiang</surname>
              <given-names>P</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Protective effect of berberine on acute cardiomyopathy associated with doxorubicin treatment</article-title>
          <source>Oncol Lett</source>
          <year>2018</year>
          <volume>15</volume>
          <fpage>5721</fpage>
          <lpage>5729</lpage>
          <?supplied-pmid 29552206?>
          <pub-id pub-id-type="pmid">29552206</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR67" publication-type="journal">Xiong C, Wu Y-Z, Zhang Y, Wu Z-X, Chen X-Y, Jiang P, et al. Protective effect of berberine on acute cardiomyopathy associated with doxorubicin treatment. Oncol Lett. 2018;15:5721–9.<pub-id pub-id-type="pmid">29552206</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <citation-alternatives>
        <element-citation id="ec-CR68" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Asensio-López</surname>
              <given-names>MC</given-names>
            </name>
            <name>
              <surname>Soler</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Pascual-Figal</surname>
              <given-names>D</given-names>
            </name>
            <name>
              <surname>Fernández-Belda</surname>
              <given-names>F</given-names>
            </name>
            <name>
              <surname>Lax</surname>
              <given-names>A</given-names>
            </name>
          </person-group>
          <article-title>Doxorubicin-induced oxidative stress: the protective effect of nicorandil on HL-1 cardiomyocytes</article-title>
          <source>PLoS ONE</source>
          <year>2017</year>
          <volume>12</volume>
          <fpage>e0172803</fpage>
          <?supplied-pmid 28245258?>
          <pub-id pub-id-type="pmid">28245258</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR68" publication-type="journal">Asensio-López MC, Soler F, Pascual-Figal D, Fernández-Belda F, Lax A. Doxorubicin-induced oxidative stress: the protective effect of nicorandil on HL-1 cardiomyocytes. PLoS ONE. 2017;12: e0172803.<pub-id pub-id-type="pmid">28245258</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <citation-alternatives>
        <element-citation id="ec-CR69" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rawat</surname>
              <given-names>PS</given-names>
            </name>
            <name>
              <surname>Jaiswal</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Khurana</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Bhatti</surname>
              <given-names>JS</given-names>
            </name>
            <name>
              <surname>Navik</surname>
              <given-names>U</given-names>
            </name>
          </person-group>
          <article-title>Doxorubicin-induced cardiotoxicity: an update on the molecular mechanism and novel therapeutic strategies for effective management</article-title>
          <source>Biomed Pharmacother</source>
          <year>2021</year>
          <volume>139</volume>
          <fpage>111708</fpage>
          <?supplied-pmid 34243633?>
          <pub-id pub-id-type="pmid">34243633</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR69" publication-type="journal">Rawat PS, Jaiswal A, Khurana A, Bhatti JS, Navik U. Doxorubicin-induced cardiotoxicity: an update on the molecular mechanism and novel therapeutic strategies for effective management. Biomed Pharmacother. 2021;139: 111708.<pub-id pub-id-type="pmid">34243633</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <citation-alternatives>
        <element-citation id="ec-CR70" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Stringer</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Michaelos</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Pachitariu</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Cellpose: a generalist algorithm for cellular segmentation</article-title>
          <source>Nat Methods</source>
          <year>2021</year>
          <volume>18</volume>
          <fpage>100</fpage>
          <lpage>106</lpage>
          <?supplied-pmid 33318659?>
          <pub-id pub-id-type="pmid">33318659</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR70" publication-type="journal">Stringer C, Wang T, Michaelos M, Pachitariu M. Cellpose: a generalist algorithm for cellular segmentation. Nat Methods. 2021;18:100–6.<pub-id pub-id-type="pmid">33318659</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <citation-alternatives>
        <element-citation id="ec-CR71" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Song</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>Q</given-names>
            </name>
          </person-group>
          <article-title>Atrial natriuretic peptide in cardiovascular biology and disease (NPPA)</article-title>
          <source>Gene</source>
          <year>2015</year>
          <volume>569</volume>
          <fpage>1</fpage>
          <lpage>6</lpage>
          <?supplied-pmid 26074089?>
          <pub-id pub-id-type="pmid">26074089</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR71" publication-type="journal">Song W, Wang H, Wu Q. Atrial natriuretic peptide in cardiovascular biology and disease (NPPA). Gene. 2015;569:1–6.<pub-id pub-id-type="pmid">26074089</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <citation-alternatives>
        <element-citation id="ec-CR72" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Man</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Barnett</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Christoffels</surname>
              <given-names>VM</given-names>
            </name>
          </person-group>
          <article-title>Structure and function of the Nppa-Nppb cluster locus during heart development and disease</article-title>
          <source>Cell Mol Life Sci</source>
          <year>2018</year>
          <volume>75</volume>
          <fpage>1435</fpage>
          <lpage>1444</lpage>
          <?supplied-pmid 29302701?>
          <pub-id pub-id-type="pmid">29302701</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR72" publication-type="journal">Man J, Barnett P, Christoffels VM. Structure and function of the Nppa-Nppb cluster locus during heart development and disease. Cell Mol Life Sci. 2018;75:1435–44.<pub-id pub-id-type="pmid">29302701</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <citation-alternatives>
        <element-citation id="ec-CR73" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lewis</surname>
              <given-names>YE</given-names>
            </name>
            <name>
              <surname>Moskovitz</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Mutlak</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Heineke</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Caspi</surname>
              <given-names>LH</given-names>
            </name>
            <name>
              <surname>Kehat</surname>
              <given-names>I</given-names>
            </name>
          </person-group>
          <article-title>Localization of transcripts, translation, and degradation for spatiotemporal sarcomere maintenance</article-title>
          <source>J Mol Cell Cardiol</source>
          <year>2018</year>
          <volume>116</volume>
          <fpage>16</fpage>
          <lpage>28</lpage>
          <?supplied-pmid 29371135?>
          <pub-id pub-id-type="pmid">29371135</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR73" publication-type="journal">Lewis YE, Moskovitz A, Mutlak M, Heineke J, Caspi LH, Kehat I. Localization of transcripts, translation, and degradation for spatiotemporal sarcomere maintenance. J Mol Cell Cardiol. 2018;116:16–28.<pub-id pub-id-type="pmid">29371135</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <mixed-citation publication-type="other">Smalec BM, Ietswaart R, Choquet K, McShane E, West ER, Churchman LS. Genome-wide quantification of RNA flow across subcellular compartments reveals determinants of the mammalian transcript life cycle. bioRxiv. 2022. p. 2022.08.21.504696. Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/content/early/2022/08/21/2022.08.21.504696.abstract">http://biorxiv.org/content/early/2022/08/21/2022.08.21.504696.abstract</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <citation-alternatives>
        <element-citation id="ec-CR75" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Sardão</surname>
              <given-names>VA</given-names>
            </name>
            <name>
              <surname>Oliveira</surname>
              <given-names>PJ</given-names>
            </name>
            <name>
              <surname>Holy</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Oliveira</surname>
              <given-names>CR</given-names>
            </name>
            <name>
              <surname>Wallace</surname>
              <given-names>KB</given-names>
            </name>
          </person-group>
          <article-title>Morphological alterations induced by doxorubicin on H9c2 myoblasts: nuclear, mitochondrial, and cytoskeletal targets</article-title>
          <source>Cell Biol Toxicol</source>
          <year>2009</year>
          <volume>25</volume>
          <fpage>227</fpage>
          <lpage>243</lpage>
          <?supplied-pmid 18386138?>
          <pub-id pub-id-type="pmid">18386138</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR75" publication-type="journal">Sardão VA, Oliveira PJ, Holy J, Oliveira CR, Wallace KB. Morphological alterations induced by doxorubicin on H9c2 myoblasts: nuclear, mitochondrial, and cytoskeletal targets. Cell Biol Toxicol. 2009;25:227–43.<pub-id pub-id-type="pmid">18386138</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <citation-alternatives>
        <element-citation id="ec-CR76" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Meissner</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Weissgerber</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Londoño</surname>
              <given-names>JEC</given-names>
            </name>
            <name>
              <surname>Prenen</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Link</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Ruppenthal</surname>
              <given-names>S</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Moderate calcium channel dysfunction in adult mice with inducible cardiomyocyte-specific excision of the cacnb2 gene</article-title>
          <source>J Biol Chem</source>
          <year>2011</year>
          <volume>286</volume>
          <fpage>15875</fpage>
          <lpage>15882</lpage>
          <?supplied-pmid 21357697?>
          <pub-id pub-id-type="pmid">21357697</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR76" publication-type="journal">Meissner M, Weissgerber P, Londoño JEC, Prenen J, Link S, Ruppenthal S, et al. Moderate calcium channel dysfunction in adult mice with inducible cardiomyocyte-specific excision of the cacnb2 gene. J Biol Chem. 2011;286:15875–82.<pub-id pub-id-type="pmid">21357697</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <mixed-citation publication-type="other">Hallou A, He R, Simons BD, Dumitrascu B. A computational pipeline for spatial mechano-transcriptomics. bioRxiv. 2023 [cited 2023 Aug 15]. p. 2023.08.03.551894. Available from: https://www.biorxiv.org/content/10.1101/2023.08.03.551894v1.</mixed-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <citation-alternatives>
        <element-citation id="ec-CR78" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Cohen</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>A coefficient of agreement for nominal scales</article-title>
          <source>Educ Psychol Meas</source>
          <year>1960</year>
          <volume>20</volume>
          <fpage>37</fpage>
          <lpage>46</lpage>
        </element-citation>
        <mixed-citation id="mc-CR78" publication-type="journal">Cohen J. A coefficient of agreement for nominal scales. Educ Psychol Meas. 1960;20:37–46.</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <citation-alternatives>
        <element-citation id="ec-CR79" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Subramanian</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Tamayo</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Mootha</surname>
              <given-names>VK</given-names>
            </name>
            <name>
              <surname>Mukherjee</surname>
              <given-names>S</given-names>
            </name>
            <name>
              <surname>Ebert</surname>
              <given-names>BL</given-names>
            </name>
            <name>
              <surname>Gillette</surname>
              <given-names>MA</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2005</year>
          <volume>102</volume>
          <fpage>15545</fpage>
          <lpage>15550</lpage>
          <?supplied-pmid 16199517?>
          <pub-id pub-id-type="pmid">16199517</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR79" publication-type="journal">Subramanian A, Tamayo P, Mootha VK, Mukherjee S, Ebert BL, Gillette MA, et al. Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles. Proc Natl Acad Sci U S A. 2005;102:15545–50.<pub-id pub-id-type="pmid">16199517</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <citation-alternatives>
        <element-citation id="ec-CR80" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Barbie</surname>
              <given-names>DA</given-names>
            </name>
            <name>
              <surname>Tamayo</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Boehm</surname>
              <given-names>JS</given-names>
            </name>
            <name>
              <surname>Kim</surname>
              <given-names>SY</given-names>
            </name>
            <name>
              <surname>Moody</surname>
              <given-names>SE</given-names>
            </name>
            <name>
              <surname>Dunn</surname>
              <given-names>IF</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Systematic RNA interference reveals that oncogenic KRAS-driven cancers require TBK1</article-title>
          <source>Nature</source>
          <year>2009</year>
          <volume>462</volume>
          <fpage>108</fpage>
          <lpage>112</lpage>
          <?supplied-pmid 19847166?>
          <pub-id pub-id-type="pmid">19847166</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR80" publication-type="journal">Barbie DA, Tamayo P, Boehm JS, Kim SY, Moody SE, Dunn IF, et al. Systematic RNA interference reveals that oncogenic KRAS-driven cancers require TBK1. Nature. 2009;462:108–12.<pub-id pub-id-type="pmid">19847166</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <citation-alternatives>
        <element-citation id="ec-CR81" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Xie</surname>
              <given-names>Z</given-names>
            </name>
            <name>
              <surname>Bailey</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Kuleshov</surname>
              <given-names>MV</given-names>
            </name>
            <name>
              <surname>Clarke</surname>
              <given-names>DJB</given-names>
            </name>
            <name>
              <surname>Evangelista</surname>
              <given-names>JE</given-names>
            </name>
            <name>
              <surname>Jenkins</surname>
              <given-names>SL</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene set knowledge discovery with Enrichr</article-title>
          <source>Curr Protoc</source>
          <year>2021</year>
          <volume>1</volume>
          <fpage>e90</fpage>
          <?supplied-pmid 33780170?>
          <pub-id pub-id-type="pmid">33780170</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR81" publication-type="journal">Xie Z, Bailey A, Kuleshov MV, Clarke DJB, Evangelista JE, Jenkins SL, et al. Gene set knowledge discovery with Enrichr. Curr Protoc. 2021;1: e90.<pub-id pub-id-type="pmid">33780170</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <mixed-citation publication-type="other">Vettigli G. minisom: :red_circle: MiniSom is a minimalistic implementation of the Self Organizing Maps. Github; [cited 2024 Jan 17]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/JustGlowing/minisom">https://github.com/JustGlowing/minisom</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <mixed-citation publication-type="other">Badia-i-Mompel P, Vélez Santiago J, Braunger J, Geiss C, Dimitrov D, Müller-Dott S, et al. decoupleR: ensemble of computational methods to infer biological activities from omics data. Bioinformatics Advances. 2022;2:vbac016.</mixed-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <citation-alternatives>
        <element-citation id="ec-CR84" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Huang</surname>
              <given-names>H</given-names>
            </name>
            <name>
              <surname>Zhu</surname>
              <given-names>Q</given-names>
            </name>
            <name>
              <surname>Jussila</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Han</surname>
              <given-names>Y</given-names>
            </name>
            <name>
              <surname>Bintu</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Kern</surname>
              <given-names>C</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>CTCF mediates dosage- and sequence-context-dependent transcriptional insulation by forming local chromatin domains</article-title>
          <source>Nat Genet</source>
          <year>2021</year>
          <volume>53</volume>
          <fpage>1064</fpage>
          <lpage>1074</lpage>
          <?supplied-pmid 34002095?>
          <pub-id pub-id-type="pmid">34002095</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR84" publication-type="journal">Huang H, Zhu Q, Jussila A, Han Y, Bintu B, Kern C, et al. CTCF mediates dosage- and sequence-context-dependent transcriptional insulation by forming local chromatin domains. Nat Genet. 2021;53:1064–74.<pub-id pub-id-type="pmid">34002095</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <mixed-citation publication-type="other">Emanuel G, seichhorn, Babcock H, leonardosepulveda, timblosser. ZhuangLab/MERlin: MERlin v0.1.6. 2020. Available from: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/3758540">https://zenodo.org/record/3758540</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <citation-alternatives>
        <element-citation id="ec-CR86" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Lian</surname>
              <given-names>X</given-names>
            </name>
            <name>
              <surname>Hsiao</surname>
              <given-names>C</given-names>
            </name>
            <name>
              <surname>Wilson</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Zhu</surname>
              <given-names>K</given-names>
            </name>
            <name>
              <surname>Hazeltine</surname>
              <given-names>LB</given-names>
            </name>
            <name>
              <surname>Azarin</surname>
              <given-names>SM</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Robust cardiomyocyte differentiation from human pluripotent stem cells via temporal modulation of canonical Wnt signaling</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2012</year>
          <volume>109</volume>
          <fpage>E1848</fpage>
          <lpage>E1857</lpage>
          <?supplied-pmid 22645348?>
          <pub-id pub-id-type="pmid">22645348</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR86" publication-type="journal">Lian X, Hsiao C, Wilson G, Zhu K, Hazeltine LB, Azarin SM, et al. Robust cardiomyocyte differentiation from human pluripotent stem cells via temporal modulation of canonical Wnt signaling. Proc Natl Acad Sci U S A. 2012;109:E1848–57.<pub-id pub-id-type="pmid">22645348</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <citation-alternatives>
        <element-citation id="ec-CR87" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Frankish</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Diekhans</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Ferreira</surname>
              <given-names>A-M</given-names>
            </name>
            <name>
              <surname>Johnson</surname>
              <given-names>R</given-names>
            </name>
            <name>
              <surname>Jungreis</surname>
              <given-names>I</given-names>
            </name>
            <name>
              <surname>Loveland</surname>
              <given-names>J</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>GENCODE reference annotation for the human and mouse genomes</article-title>
          <source>Nucleic Acids Res</source>
          <year>2019</year>
          <volume>47</volume>
          <fpage>D766</fpage>
          <lpage>D773</lpage>
          <?supplied-pmid 30357393?>
          <pub-id pub-id-type="pmid">30357393</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR87" publication-type="journal">Frankish A, Diekhans M, Ferreira A-M, Johnson R, Jungreis I, Loveland J, et al. GENCODE reference annotation for the human and mouse genomes. Nucleic Acids Res. 2019;47:D766–73.<pub-id pub-id-type="pmid">30357393</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <citation-alternatives>
        <element-citation id="ec-CR88" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Yates</surname>
              <given-names>AD</given-names>
            </name>
            <name>
              <surname>Achuthan</surname>
              <given-names>P</given-names>
            </name>
            <name>
              <surname>Akanni</surname>
              <given-names>W</given-names>
            </name>
            <name>
              <surname>Allen</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Allen</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Alvarez-Jarreta</surname>
              <given-names>J</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Ensembl 2020</article-title>
          <source>Nucleic Acids Res</source>
          <year>2020</year>
          <volume>48</volume>
          <fpage>D682</fpage>
          <lpage>D688</lpage>
          <?supplied-pmid 31691826?>
          <pub-id pub-id-type="pmid">31691826</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR88" publication-type="journal">Yates AD, Achuthan P, Akanni W, Allen J, Allen J, Alvarez-Jarreta J, et al. Ensembl 2020. Nucleic Acids Res. 2020;48:D682–8.<pub-id pub-id-type="pmid">31691826</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <citation-alternatives>
        <element-citation id="ec-CR89" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Marçais</surname>
              <given-names>G</given-names>
            </name>
            <name>
              <surname>Kingsford</surname>
              <given-names>C</given-names>
            </name>
          </person-group>
          <article-title>A fast, lock-free approach for efficient parallel counting of occurrences of k-mers</article-title>
          <source>Bioinformatics</source>
          <year>2011</year>
          <volume>27</volume>
          <fpage>764</fpage>
          <lpage>770</lpage>
          <?supplied-pmid 21217122?>
          <pub-id pub-id-type="pmid">21217122</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR89" publication-type="journal">Marçais G, Kingsford C. A fast, lock-free approach for efficient parallel counting of occurrences of k-mers. Bioinformatics. 2011;27:764–70.<pub-id pub-id-type="pmid">21217122</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <citation-alternatives>
        <element-citation id="ec-CR90" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Gans</surname>
              <given-names>JD</given-names>
            </name>
            <name>
              <surname>Wolinsky</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Improved assay-dependent searching of nucleic acid sequence databases</article-title>
          <source>Nucleic Acids Res</source>
          <year>2008</year>
          <volume>36</volume>
          <fpage>e74</fpage>
          <?supplied-pmid 18515842?>
          <pub-id pub-id-type="pmid">18515842</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR90" publication-type="journal">Gans JD, Wolinsky M. Improved assay-dependent searching of nucleic acid sequence databases. Nucleic Acids Res. 2008;36: e74.<pub-id pub-id-type="pmid">18515842</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <citation-alternatives>
        <element-citation id="ec-CR91" publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rodriguez</surname>
              <given-names>JM</given-names>
            </name>
            <name>
              <surname>Rodriguez-Rivas</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Di Domenico</surname>
              <given-names>T</given-names>
            </name>
            <name>
              <surname>Vázquez</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Valencia</surname>
              <given-names>A</given-names>
            </name>
            <name>
              <surname>Tress</surname>
              <given-names>ML</given-names>
            </name>
          </person-group>
          <article-title>APPRIS 2017: principal isoforms for multiple gene sets</article-title>
          <source>Nucleic Acids Res</source>
          <year>2018</year>
          <volume>46</volume>
          <fpage>D213</fpage>
          <lpage>D217</lpage>
          <?supplied-pmid 29069475?>
          <pub-id pub-id-type="pmid">29069475</pub-id>
        </element-citation>
        <mixed-citation id="mc-CR91" publication-type="journal">Rodriguez JM, Rodriguez-Rivas J, Di Domenico T, Vázquez J, Valencia A, Tress ML. APPRIS 2017: principal isoforms for multiple gene sets. Nucleic Acids Res. 2018;46:D213–7.<pub-id pub-id-type="pmid">29069475</pub-id>
</mixed-citation>
      </citation-alternatives>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <mixed-citation publication-type="other">Bento MC Manuscript Datasets 2023 figshare [10.6084/m9.figshare.c.6564043.v1.</mixed-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <mixed-citation publication-type="other">ckmah/bento-tools: a Python toolkit for subcellular analysis of spatial transcriptomics data. GitHub. [cited 2024 Mar 13]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-tools">https://github.com/ckmah/bento-tools</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <mixed-citation publication-type="other">Mah C. bento-manuscript: Analyses to reproduce figures in the Bento manuscript. Github; [cited 2024 Mar 13]. Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/ckmah/bento-manuscript">https://github.com/ckmah/bento-manuscript</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <mixed-citation publication-type="other">Mah C. Bento manuscript source code. Zenodo; 2024 [cited 2024 Mar 13]. Available from: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/10815484">https://zenodo.org/records/10815484</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
