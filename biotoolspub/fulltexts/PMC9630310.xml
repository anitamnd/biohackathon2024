<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
    <journal-title-group>
      <journal-title>Nature Communications</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2041-1723</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9630310</article-id>
    <article-id pub-id-type="publisher-id">34320</article-id>
    <article-id pub-id-type="doi">10.1038/s41467-022-34320-7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A comprehensive Bioconductor ecosystem for the design of CRISPR guide RNAs across nucleases and technologies</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9231-8977</contrib-id>
        <name>
          <surname>Hoberecht</surname>
          <given-names>Luke</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Perampalam</surname>
          <given-names>Pirunthan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lun</surname>
          <given-names>Aaron</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9328-3852</contrib-id>
        <name>
          <surname>Fortin</surname>
          <given-names>Jean-Philippe</given-names>
        </name>
        <address>
          <email>fortin946@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.418158.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 0534 4718</institution-id><institution>Genentech Research and Early Development, Genentech, Inc., </institution></institution-wrap>1 DNA Way, South San Francisco, CA 94080 USA </aff>
      <aff id="Aff2"><label>2</label>ProCogia Inc. under contract to Hoffmann-La Roche Limited, Toronto, Canada </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>6568</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The success of CRISPR-mediated gene perturbation studies is highly dependent on the quality of gRNAs, and several tools have been developed to enable optimal gRNA design. However, these tools are not all adaptable to the latest CRISPR modalities or nucleases, nor do they offer comprehensive annotation methods for advanced CRISPR applications. Here, we present a new ecosystem of R packages, called <italic>crisprVerse</italic>, that enables efficient gRNA design and annotation for a multitude of CRISPR technologies. This includes CRISPR knockout (CRISPRko), CRISPR activation (CRISPRa), CRISPR interference (CRISPRi), CRISPR base editing (CRISPRbe) and CRISPR knockdown (CRISPRkd). The core package, <italic>crisprDesign</italic>, offers a user-friendly and unified interface to add off-target annotations, rich gene and SNP annotations, and on- and off-target activity scores. These functionalities are enabled for any RNA- or DNA-targeting nucleases, including Cas9, Cas12, and Cas13. The <italic>crisprVerse</italic> ecosystem is open-source and deployed through the Bioconductor project (<ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse">https://github.com/crisprVerse</ext-link>).</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">The success of CRISPR experiments relies on the choice of gRNA. Here the authors report crisprVerse, which enables efficient gRNA design and annotation for methods including CRISPRko, CRISPRa, CRISPRi, CRISPRbe and CRISPRkd, enabled for RNA- and DNA-targeting nucleases, including Cas9, Cas12 and Cas13.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Software</kwd>
      <kwd>CRISPR-Cas systems</kwd>
      <kwd>CRISPR-Cas9 genome editing</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1" sec-type="introduction">
    <title>Introduction</title>
    <p id="Par3">The performance of CRISPR-based experiments depends critically on the choice of the guide RNAs (gRNAs) used to guide the CRISPR nuclease to the target site. Variable gRNA on-target activity, as well as unintended off-targeting effects, can lead to inconsistent phenotypic readouts in screening experiments. For the purpose of analyzing pooled screens, many approaches attempt to model gRNA quality in the generation of gene-level scores to improve statistical inference<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref></sup>. However, suboptimal gRNA design is only partially mitigated by analysis strategies that sacrifice statistical power for robustness to suboptimal guides. One way to increase the signal-to-noise ratio in screening experiments is to enrich gRNA libraries for gRNAs that have high predicted on-target activity. Predicting on-target activity from the spacer sequence is an extensive area of research, and several algorithms leveraging experimental data have been developed for different nucleases and contexts<sup><xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR13">13</xref></sup>.</p>
    <p id="Par4">In addition to its sequence, the genomic context of the on- and off-target sites for each gRNA is another important consideration for gRNA design. For example, designing gRNAs that uniquely map to the genome can be challenging, especially for genes sharing high homology with other genomic loci, either in coding or non-coding regions<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. Furthermore, knowing whether or not an off-target is located in the coding region of another gene can rule out the use of a given gRNA. Finally, genetic variation, such as single-nucleotide polymorphisms (SNPs) and small indels, can have a direct impact on gRNA binding activity and on-target specificity by altering complementarity between spacer sequences and the host cell genomic DNA<sup><xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref></sup>.</p>
    <p id="Par5">The rapid increase of CRISPR-based applications and technologies poses another challenge to gRNA library design. A large variety of nucleases are now available and routinely used, including engineered nucleases that recognize a larger set of PAM sequences<sup><xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR22">22</xref></sup> and novel classes of nucleases such as the RNA-targeting Cas13 family<sup><xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref></sup>. Each nuclease comes with its own set of gRNA design rules and constraints. In addition, these nucleases can also be mixed and matched with different types of CRISPR applications, increasing the complexity of gRNA design. As an example, CRISPR base editing (CRISPRbe)<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>, which requires additional gRNA design functionalities to capture the editing window and prediction of editing outcomes, can be combined with the Cas13 family to perform RNA editing<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Finally, emerging screening modalities, such as optical pooled CRISPR screening<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> and gRNA pairing, require additional specialized gRNA design considerations.</p>
    <p id="Par6">Given the complexity, heterogeneity, and fast growth of the aforementioned CRISPR modalities and applications, it is paramount to develop and maintain adaptable, modular, and robust software for gRNA design. This ensures that the scientific community can efficiently design first-class CRISPR reagents in a timely manner for both well-established and emerging technologies. An ideal gRNA design framework has the following qualities: (1) it offers multiple cutting-edge methods for on-target scoring and off-target prediction based on gRNA sequences, (2) it provides comprehensive gRNA annotation to enable consideration of the genomic context for all gRNA on-target and off-target sites, (3) it already supports (or can be easily extended to) newer CRISPR technologies, including an arbitrary combination of nucleases and modalities, and (4) it easily scales for designing large-scale gRNA libraries for different screening platforms. While a multitude of web applications and command line interfaces has been developed to enable gene- or other target-specific gRNA design<sup><xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR30">30</xref>–<xref ref-type="bibr" rid="CR39">39</xref></sup>, none of the existing tools completely satisfies the requirements listed above.</p>
    <p id="Par7">In this work, we describe a modular ecosystem of R packages, called <italic>crisprVerse</italic>, that enable the design of CRISPR gRNAs across a variety of nucleases, genomes, and applications. The <italic>crisprBowtie</italic> and <italic>crisprBwa</italic> packages provide comprehensive on-target and off-target search for reference genomes, transcriptomes, or any custom sequences. The <italic>crisprScore</italic> package provides a harmonized framework to access a large array of R- and Python-based gRNA scoring algorithms developed by the CRISPR community, for both on-target and off-target scoring. The <italic>crisprBase</italic> package implements functionalities to describe and represent DNA- and RNA-targeting CRISPR nucleases, nickases and base editors, as well as genomic arithmetic rules that are specific to CRISPR design. The package <italic>crisprDesign</italic> provides a user-friendly package to design and annotate gRNAs in one place, including gene and TSS annotation, search for SNP overlap, addition of evolutionary conservation scores, characterization of edited alleles for base editors, sequence-based design rules, and library design functionalities such as ranking and platform-specific considerations. Finally, the package <italic>crisprViz</italic> allows users to visualize gRNAs within genomic tracks, with the option of embedding additional genomic annotations such as SNPs, repeat elements, or chromatin accessibility data. The <italic>crisprVerse</italic> ecosystem currently supports five different CRISPR modalities: CRISPR knockout (CRISPRko), CRISPR activation (CRISPRa), CRISPR interference (CRISPRi), CRISPR base editing (CRISPRbe) and CRISPR knockdown (CRISPRkd) using Cas13.</p>
    <p id="Par8">We illustrate the rich functionalities of our ecosystem through three case studies: designing gRNAs to edit <italic>BRCA1</italic> using the base editor BE4max, designing gRNAs to knock down <italic>CD55</italic> and <italic>CD46</italic> using CasRx, and designing optimal gRNAs to activate <italic>MMP7</italic> through CRISPRa for different wildtype and engineered nucleases. We also show that our default gRNA ranking criteria yield optimal gRNAs by reanalyzing five genome-wide fitness screening datasets. Our R packages are open-source and deployed through the Bioconductor project<sup><xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR41">41</xref></sup>. This makes our tools fully interoperable with other packages, and facilitates long-term development and maintenance of our ecosystem. Source code, tutorials, and extensive documentation are provided on our website: <ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse">https://github.com/crisprVerse</ext-link>.</p>
  </sec>
  <sec id="Sec2" sec-type="results">
    <title>Results</title>
    <sec id="Sec3">
      <title><italic>crisprBase</italic> as a core infrastructure package to represent CRISPR nucleases and base editors</title>
      <p id="Par9">The <italic>crisprBase</italic> package implements a common framework in the <italic>crisprVerse</italic> ecosystem for representing and manipulating nucleases and base editors through a set of classes and CRISPR-specific genome arithmetic functions. The <italic>CrisprNuclease</italic> class provides a general representation of a CRISPR nuclease, encoding all of the information necessary to perform gRNA design and other analyses involving CRISPR technologies. This includes the PAM side with respect to the protospacer sequence, recognized PAM sequences with optional tolerance weights, and the relative cut site. Specific <italic>CrisprNuclease</italic> instances can be easily created to represent a diversity of wild-type and engineered CRISPR nucleases (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). We also implement a <italic>BaseEditor</italic> subclass that provides additional base editing information such as the editing strand and a matrix of editing probabilities for possible nucleotide substitutions.<fig id="Fig1"><label>Fig. 1</label><caption><title>Examples of DNA- and RNA-targeting nucleases represented in <italic>crisprBase</italic>.</title><p>gRNA spacer sequences are shown in yellow. Target DNA/RNA protospacer sequences are shown in blue. Protospacer adjacent motifs (PAMs) and protospacer flanking sequences (PFSs) are shown in orange. Nuclease-specific cutting sites are represented by black triangles. For the C to T base editor BE4max, on-target editing happens on the DNA strand containing the protospacer sequence. The editing window varies by base editor. The first nucleotide of the PAM/PFS is used as the representative coordinate of a given target sequence.</p></caption><graphic xlink:href="41467_2022_34320_Fig1_HTML" id="d32e402"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title><italic>crisprDesign</italic>: a comprehensive tool to perform complex gRNA design</title>
      <p id="Par10"><italic>crisprDesign</italic> offers a comprehensive suite of methods to design and annotate gRNAs (see Table <xref rid="Tab1" ref-type="table">1</xref>) and represents the core package of the <italic>crisprVerse</italic> ecosystem. For users, the package provides a centralized and streamlined end-to-end workflow for gRNA design, alleviating the burden of using different tools at different stages of the design process. For developers, <italic>crisprDesign</italic> is built on top of a modular package ecosystem that implements the gRNA design tasks (see Table <xref rid="Tab2" ref-type="table">2</xref> in the Methods section), allowing the same code to be easily re-used outside of CRISPR applications and gRNA design.<table-wrap id="Tab1"><label>Table 1</label><caption><p>gRNA design functionalities implemented in <italic>crisprVerse</italic> and commonly-used gRNA design tools</p></caption><table frame="hsides" rules="groups"><thead><tr><th/><th/><th><italic>crisprDesign</italic></th><th><italic>multicrispr</italic></th><th><italic>CRISPRseek</italic></th><th><italic>CHOPCHOP</italic></th><th><italic>CRISPOR</italic></th><th><italic>CCTop</italic></th><th><italic>GUIDES</italic></th><th><italic>Cas-Designer</italic></th><th><italic>FlashFry</italic></th><th><italic>E-CRISP</italic></th><th><italic>CRISPick</italic></th></tr></thead><tbody><tr><td>Nuclease</td><td>DNA-targeting: Cas9</td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td></tr><tr><td/><td>DNA-targeting: Cas12</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td></tr><tr><td/><td>DNA-targeting: Custom</td><td><italic>✓</italic></td><td>Limited</td><td><italic>✓</italic></td><td>Limited</td><td>Limited</td><td>Limited</td><td/><td><italic>✓</italic></td><td>Limited</td><td/><td>Limited</td></tr><tr><td/><td>RNA-targeting: Cas13</td><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>Nickase</td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/></tr><tr><td>Modalities</td><td>CRISPRko</td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td></tr><tr><td/><td>CRISPRbe</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td/><td/></tr><tr><td/><td>CRISPRa</td><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td><italic>✓</italic></td><td><italic>✓</italic></td></tr><tr><td/><td>CRISPRi</td><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td/><td/><td/><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td></tr><tr><td/><td>RNA editing (CRISPRkd)</td><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>Optical Pooled Screening</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>Prime editing</td><td>*</td><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td/><td/><td/><td><italic>✓</italic></td><td/><td/><td/></tr><tr><td>Target space</td><td>Reference genomes</td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td>Limited</td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td></tr><tr><td/><td>Custom sequences</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td></tr><tr><td>Off-target aligner</td><td>Bowtie</td><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td/></tr><tr><td/><td>BWA</td><td><italic>✓</italic></td><td/><td/><td/><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>Other</td><td>Biostrings</td><td>Biostrings</td><td>Biostrings</td><td/><td/><td/><td/><td>Cas-OFFinder</td><td>FlashFry</td><td/><td>†</td></tr><tr><td>Off-target options</td><td>Genomic coordinates</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td/></tr><tr><td/><td>Custom sequences</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>Cross-reactivity</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>Minor/major alleles</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td>On-target scoring</td><td>Rule Set 1</td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td/><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td/></tr><tr><td/><td>Azimuth</td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td></tr><tr><td/><td>Rule Set 3</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td><italic>✓</italic></td></tr><tr><td/><td>CRISPRscan</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td/><td/><td><italic>✓</italic></td><td/><td/></tr><tr><td/><td>CRISPRater</td><td><italic>✓</italic></td><td/><td/><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td/><td/><td/><td/></tr><tr><td/><td>DeepCpf1</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td><italic>✓</italic></td></tr><tr><td/><td>DeepSpCas9</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>DeepHF</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>Lindel</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>CRISPRai</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>EnPAM+GB</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td><italic>✓</italic></td></tr><tr><td/><td>CasRx-RF</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>PAM scoring</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td>Off-target scoring</td><td>MIT</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td/><td/><td><italic>✓</italic></td><td/><td/></tr><tr><td/><td>CFD</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td></tr><tr><td/><td>CasRx</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td>Annotations</td><td>Off-target annotation</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td/><td/><td/><td/></tr><tr><td/><td>Isoform specification</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td><italic>✓</italic></td><td/></tr><tr><td/><td>Reinitiation sites</td><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>Pfam domains</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td><italic>✓</italic></td><td/><td/><td/><td/></tr><tr><td/><td>SNP annotation</td><td><italic>✓</italic></td><td/><td/><td/><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>TSS annotation</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td><italic>✓</italic></td><td><italic>✓</italic></td></tr><tr><td/><td>Conservation</td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/><td/><td/><td/></tr><tr><td>Library design</td><td>Restriction sites</td><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td/><td/><td/><td><italic>✓</italic></td><td/></tr><tr><td/><td>PolyT signal</td><td><italic>✓</italic></td><td/><td/><td/><td><italic>✓</italic></td><td/><td/><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td/></tr><tr><td/><td>GC content</td><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td/></tr><tr><td/><td>Hairpin loops</td><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td/><td/></tr><tr><td/><td>Paired gRNAs</td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td><italic>✓</italic></td><td/><td/><td/><td/><td/><td><italic>✓</italic></td><td/></tr><tr><td/><td>Ranking</td><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td><td/><td/><td><italic>✓</italic></td><td/><td><italic>✓</italic></td></tr></tbody></table><table-wrap-foot><p>Check marks indicate which functionalities are present in each tool at time of publication. * In progress. † Information could not be found. See the Methods section for a detailed description of the criteria used for assessing feature availability.</p></table-wrap-foot></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>R packages in the crisprVerse ecosystem</p></caption><table frame="hsides" rules="groups"><thead><tr><th>R package</th><th>Description</th></tr></thead><tbody><tr><td><ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/crisprVerse">crisprVerse</ext-link></td><td>Easy install of the crisprVerse ecosystem</td></tr><tr><td><ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/crisprDesign">crisprDesign</ext-link></td><td>Core package for gRNA design</td></tr><tr><td><ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/crisprBase">crisprBase</ext-link></td><td>Nuclease specification and gRNA arithmetics</td></tr><tr><td><ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/crisprBowtie">crisprBowtie</ext-link></td><td>gRNA spacer alignment with <italic>Bowtie</italic></td></tr><tr><td><ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/crisprBwa">crisprBwa</ext-link></td><td>gRNA spacer alignment with <italic>BWA</italic></td></tr><tr><td><ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/crisprScore">crisprScore</ext-link></td><td>On- and off-target scoring algorithms for gRNAs</td></tr><tr><td><ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/crisprViz">crisprViz</ext-link></td><td>Visualization of gRNAs using genomic tracks</td></tr><tr><td><ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/Rbwa">Rbwa</ext-link></td><td>R wrapper for <italic>BWA</italic> aligner</td></tr><tr><td><ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/crisprScoreData">crisprScoreData</ext-link></td><td>Pre-trained machine learning models for <italic>crisprScore</italic></td></tr><tr><td><ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/crisprDesignData">crisprDesignData</ext-link></td><td>Pre-computed data for the crisprVerse ecosystem</td></tr></tbody></table></table-wrap></p>
      <p id="Par11">Table <xref rid="Tab1" ref-type="table">1</xref> includes a comparison to ten commonly-used gRNA design softwares: <italic>multicrispr</italic><sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, <italic>CRISPRseek</italic><sup><xref ref-type="bibr" rid="CR39">39</xref></sup>, <italic>CHOPCHOP</italic><sup><xref ref-type="bibr" rid="CR33">33</xref></sup>, <italic>CRISPOR</italic><sup><xref ref-type="bibr" rid="CR34">34</xref></sup>, <italic>CCTop</italic><sup><xref ref-type="bibr" rid="CR35">35</xref></sup>, <italic>GUIDES</italic><sup><xref ref-type="bibr" rid="CR42">42</xref></sup>, <italic>Cas-Designer</italic><sup><xref ref-type="bibr" rid="CR43">43</xref></sup>, <italic>FlashFry</italic><sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, <italic>E-CRISP</italic><sup><xref ref-type="bibr" rid="CR30">30</xref></sup> and <ext-link ext-link-type="uri" xlink:href="https://portals.broadinstitute.org/gppx/crispick/public">CRISPick</ext-link>; see the Methods section for a detailed description of the criteria used for benchmarking. While several of the features implemented in <italic>crisprDesign</italic> are also available in other tools, <italic>crisprDesign</italic> provides the most complete gRNA design solution across nucleases and modalities. Unlike <italic>crisprDesign</italic>, many of the other tools do not provide informative on- and off-target annotations, limiting their use for optimal gRNA selection. In the following sections, we describe each of the gRNA design components and functionalities that are available in <italic>crisprDesign</italic>.</p>
    </sec>
    <sec id="Sec5">
      <title>Representation of gRNAs using the <italic>GuideSet</italic> container</title>
      <p id="Par12">The genomic coordinates of gRNA protospacer sequences in a target genome can be represented using genomic ranges. The Bioconductor project<sup><xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR41">41</xref></sup> provides a robust and well-developed core data structure, called <italic>GRanges</italic><sup><xref ref-type="bibr" rid="CR44">44</xref></sup>), to efficiently represent genomic intervals. We provide in <italic>crisprDesign</italic> an extension of the <italic>GRanges</italic> class to represent and annotate gRNA sequences: the <italic>GuideSet</italic> container. Briefly, the container extends the <italic>GRanges</italic> object to store additional project-specific metadata information, such as the CRISPR nuclease employed and target mRNA or DNA sequences (if different from a reference genome), as well as rich gRNA-level annotation columns such as on- and off-target alignments tables and gene context annotations. In Fig. <xref rid="Fig2" ref-type="fig">2</xref>, we show an example of a <italic>GuideSet</italic> storing information about gRNAs targeting the coding sequence of <italic>KRAS</italic> using SpCas9.<fig id="Fig2"><label>Fig. 2</label><caption><title>Example of a GuideSet container for gRNAs targeting <italic>KRAS</italic> using SpCas9.</title><p><bold>a</bold> The blue box stores the genomic coordinates in GRCh38 to represent the target protospacer sequences using a GRanges object. By convention, we use the first nucleotide of the PAM sequence (in the 5<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{\prime}$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq1.gif"/></alternatives></inline-formula> to 3<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{\prime}$$\end{document}</tex-math><mml:math id="M4"><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq2.gif"/></alternatives></inline-formula> direction) as the representative genomic coordinate of protospacer sequences. The pink box stores sequence information of the protospacers and PAMs. The yellow box represents global metadata used for creating the GuideSet, including a formal <italic>CrisprNuclease</italic> object, the reference genome of the target protospacers, and gene model used for annotation. The gray boxes are examples of optional gRNA-level metadata columns that store information about enzyme restriction sites, spacer sequence features such as GC content, and on- and off-target scores. The green boxes represent optional per-gRNA annotations for SNP overlap, on- and off-target alignments, and gene context; each annotation stores a detailed table (<xref rid="Tab2" ref-type="table">2</xref>) dimensions) for each gRNA (3rd dimension). <bold>b</bold> Selected annotations for gRNA 1 corresponding to the row highlighted in the green boxes of (<bold>a</bold>). <bold>c</bold> The first genomic track represents the four annotated protein-coding isoforms of human gene <italic>KRAS</italic> in GRCh38 coordinates. The second track shows the 4 gRNAs shown in the blue box of (<bold>a</bold>).</p></caption><graphic xlink:href="41467_2022_34320_Fig2_HTML" id="d32e2277"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title><italic>crisprScore</italic> implements state-of-the-art scoring methods</title>
      <p id="Par13">Predicting on-target binding and cutting efficiency of gRNAs is an extensive area of research. Many algorithms have been developed to tackle this problem, basing their prediction on a variety of features: sequence composition of the spacer sequence and flanking regions, including nucleotide content and melting temperature, cell type-specific chromatin accessibility data, and distance to transcription starting site (TSS). Unfortunately, the heterogeneity in the algorithm implementations hinders the practical use of those algorithms: some methods are implemented in Python 2<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR10">10</xref>,<xref ref-type="bibr" rid="CR13">13</xref>,<xref ref-type="bibr" rid="CR45">45</xref></sup>, in Python 3<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR46">46</xref></sup>, or in R<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR12">12</xref>,<xref ref-type="bibr" rid="CR47">47</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup>. In addition, the required inputs, data structures, and terminology are not consistent across software and algorithms, increasing the likelihood of user error. Finally, several of the algorithms are currently not bundled up into easy-to-use packages, limiting their accessibility and therefore their usage.</p>
      <p id="Par14">To resolve this, we created a general and harmonized framework for on-target and off-target prediction of gRNAs, implemented in our R package <italic>crisprScore</italic>. The philosophy behind <italic>crisprScore</italic> is to abstract away from the user the language, implementation, and complexity of the different algorithms used for prediction. It uses the Bioconductor package <italic>basilisk</italic><sup><xref ref-type="bibr" rid="CR49">49</xref></sup> to seamlessly integrate and manage incompatible Python modules in one user session. This enables <italic>crisprScore</italic> to centralize all Python-based scoring algorithms together with R-based prediction algorithms, reporting all scores in a single data frame for convenient inspection. By providing a harmonized user interface, our framework facilitates methods comparison.</p>
      <p id="Par15">We note that while the package provides a harmonized framework from a user perspective, it also allows each scoring algorithm to be implemented with its own sets of parameters and inputs. We have included as many methods as possible (Table <xref rid="Tab3" ref-type="table">3</xref>), with the goal of democratizing the use of different scoring algorithms in an unbiased manner. Developers can easily contribute new methods to the <italic>crisprScore</italic> package as they become available.<table-wrap id="Tab3"><label>Table 3</label><caption><p>On-target and off-target scoring methods currently available in <italic>crisprScore</italic></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Nuclease</th><th>Variant</th><th>Method</th><th>Type</th><th>Reference</th></tr></thead><tbody><tr><td>SpCas9</td><td>WT</td><td>Rule Set 1</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR7">7</xref></sup></td></tr><tr><td/><td>WT</td><td>Azimuth</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR8">8</xref></sup></td></tr><tr><td/><td>WT</td><td>Rule Set 3</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR74">74</xref></sup></td></tr><tr><td/><td>WT</td><td>CRISPRscan</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR12">12</xref></sup></td></tr><tr><td/><td>WT</td><td>CRISPRai</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR13">13</xref></sup></td></tr><tr><td/><td>WT</td><td>DeepHF</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR9">9</xref></sup></td></tr><tr><td/><td>HiFi</td><td>DeepHF</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR9">9</xref></sup></td></tr><tr><td/><td>WT</td><td>Lindel</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR46">46</xref></sup></td></tr><tr><td/><td>WT</td><td>DeepSpCas9</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR45">45</xref></sup></td></tr><tr><td/><td>WT</td><td>CRISPRater</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR48">48</xref></sup></td></tr><tr><td/><td>WT</td><td>MIT</td><td>Off-target cutting</td><td><sup><xref ref-type="bibr" rid="CR57">57</xref></sup></td></tr><tr><td/><td>WT</td><td>CFD</td><td>Off-target cutting</td><td><sup><xref ref-type="bibr" rid="CR6">6</xref></sup></td></tr><tr><td>AsCas12a</td><td>WT</td><td>DeepCpf1</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR10">10</xref></sup></td></tr><tr><td/><td>Enhanced</td><td>enPAM+GB</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR22">22</xref></sup></td></tr><tr><td>RfxCas13d</td><td>WT</td><td>CasRx-RF</td><td>On-target efficiency</td><td><sup><xref ref-type="bibr" rid="CR47">47</xref></sup></td></tr><tr><td/><td>WT</td><td>CasRx-CFD</td><td>Off-target cutting</td><td><sup><xref ref-type="bibr" rid="CR104">104</xref></sup></td></tr></tbody></table></table-wrap></p>
    </sec>
    <sec id="Sec7">
      <title><italic>crisprDesign</italic> enables fast characterization and annotation of off-targets</title>
      <p id="Par16">Off-targeting effects can occur when a spacer sequence maps with perfect or imperfect complementarity to a genomic locus other than the primary on-target. Given that nucleases can still bind and cut in the presence of nucleotide mismatches between spacer sequences and target DNA sequences<sup><xref ref-type="bibr" rid="CR50">50</xref>–<xref ref-type="bibr" rid="CR52">52</xref></sup>, it is paramount to obtain and characterize all putative mismatch-mediated off-targets.</p>
      <p id="Par17">The off-target functionalities in <italic>crisprDesign</italic> are divided into two parts: off-target search (alignment) and off-target characterization (genomic context and scoring). For the off-target search, we offer three different alignment methods: <italic>Bowtie</italic><sup><xref ref-type="bibr" rid="CR53">53</xref></sup>, the BWA-backtrack algorithm in <italic>BWA</italic><sup><xref ref-type="bibr" rid="CR54">54</xref></sup> and the Aho-Corasick exact string matching method implemented in <italic>Biostrings</italic><sup><xref ref-type="bibr" rid="CR55">55</xref>,<xref ref-type="bibr" rid="CR56">56</xref></sup>. We developed two independent R packages to implement the <italic>Bowtie</italic> and <italic>BWA</italic> alignment methods: <italic>crisprBowtie</italic> and <italic>crisprBwa</italic>. Notably, the packages were developed to work with any nucleases, and for both DNA and RNA target spaces (reference genomes and transcriptomes, respectively). While the maximum number of mismatches for <italic>Bowtie</italic> is limited to 3, there is no limit for <italic>BWA</italic>.</p>
      <p id="Par18">Given the short nature of gRNA spacer sequences, both <italic>Bowtie</italic> and <italic>BWA</italic> are ideal tools for off-target search and provide ultrafast results. On the other hand, the alignment method based on the Bioconductor package <italic>Biostrings</italic> does not need the creation of a genome index, and is particularly useful for off-target search in short custom sequences. All methods can be invoked via the <italic>addSpacerAlignments</italic> function, which returns the on- and off-target alignments as a <italic>GRanges</italic> object in the <italic>GuideSet</italic> metadata.</p>
      <p id="Par19">To add genomic context to the on- and off-targets, a <italic>TxDb</italic> object can be provided to the <italic>addSpacerAlignments</italic> function. The <italic>TxDb</italic> object is a standard Bioconductor object to store information about a gene model, and can easily be made from transcript annotations available as GFF3 or GTF files. Gene annotation columns are added to the off-target table for different contexts: 5’ UTRs, 3’ UTRs, CDS, exons, and introns. Finally, users can add the MIT and CDF off-target specificity scores<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR57">57</xref></sup> implemented in <italic>crisprScore</italic> to characterize the likelihood of nuclease cleavage at the off-targets.</p>
    </sec>
    <sec id="Sec8">
      <title>Comparison of the off-target alignment methods</title>
      <p id="Par20">We first compared the accuracy of the three alignment methods implemented in <italic>crisprDesign</italic>. It was previously reported using 10 spacer sequences that <italic>Bowtie</italic> misses a large number of double-mismatch and triple-mismatch off-targets in comparison to the gold-standard complete string matching algorithm<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>. To investigate this, we repeated the PAM-agnostic on- and off-target alignment of the 10 spacer sequences to the GRCh38 reference genome using all three alignment methods. All three alignment methods implemented in <italic>crisprDesign</italic> return an identical list of off-targets (see Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>). This indicates that, contrary to previous reports, both <italic>BWA</italic> and <italic>Bowtie</italic> provide a complete on- and off-target search. It appears that the previously-reported missing off-targets are located on unlocalized and unplaced GRCh38 sequences.</p>
      <p id="Par21">Next, we evaluated the run times of four configurations offered in <italic>crisprDesign</italic> for alignment: <italic>Bowtie</italic>, <italic>BWA</italic>, an iterative version of <italic>Bowtie</italic> (bowtie-int) and an iterative version of <italic>BWA</italic> (bwa-int). We developed iterative versions of the <italic>Bowtie</italic> and <italic>BWA</italic> alignments to avoid situations where gRNAs are mapping to hundreds of loci in the genome, considerably slowing down the off-target search when a higher number of mismatches is allowed. The iterative strategy starts by aligning spacer sequences with no mismatches allowed. Then, it sequentially performs the alignment with a higher number of mismatches only for sequences that have a low number of off-targets at the previous step, thus avoiding the cost of extra searches for low-quality sequences that already have many off-targets. We performed the evaluation on three sets of gRNAs targeting the human genome, each with a different size (see Methods). For all three sets, the <italic>Bowtie</italic> and BWA gRNA alignments have comparable run times. (Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). For <italic>ZNF101</italic>, which contains several non-specific gRNAs overlapping a repeat element, our iterative versions of the alignment methods shows substantial gain in speed.</p>
      <p id="Par22">Finally, we compared run times for designing SpCas9 gRNAs and performing a genome-wide off-target search for the following tools: <italic>CCTop</italic>, <italic>CHOPCHOP</italic>, <italic>multicrispr</italic>, <italic>FlashFry</italic>, and <italic>crisprDesign</italic>. Other tools were not included for reasons discussed in the Methods section. To perform the evaluation, we generated six random subsets of protein-coding exons located on chromosome 1 with the following sizes: 100, 200, 400, 800, 1600, and 3200 exons. For each tool and each subset, we ran the off-target alignment against the human reference genome (GRCh38 build) using a maximum of 2 mismatches. We included the alignment parameters used for each tool in the Methods section. Both <italic>FlashFry</italic> and the iterative <italic>Bowtie</italic> alignment implemented in <italic>crisprDesign</italic> show a substantial speed gain in comparison to other methods (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>).</p>
    </sec>
    <sec id="Sec9">
      <title>Accounting for human genetic variation by adding SNP annotation</title>
      <p id="Par23">Genetic variation, such as SNPs and small indels, can have a direct impact on gRNA binding productivity and on-target specificity by altering complementarity between spacer sequences and the target DNA or RNA<sup><xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref></sup>. In <italic>crisprDesign</italic>, users can apply the function <italic>addSNPAnnotation</italic> to annotate gRNAs for which the target protospacer sequence overlaps a SNP. This enables users to discard or flag undesirable gRNAs that are likely to have variable activity across different human genomes.</p>
      <p id="Par24">Given that the current human reference genome was built using only a small number of individuals, the allele represented in the human reference genome at a particular locus does not always correspond to the major allele in a population of interest. Inspired by the major-allele reference genome indices provided by the <italic>Bowtie</italic> team (see <ext-link ext-link-type="uri" xlink:href="https://github.com/BenLangmead/bowtie-majref">https://github.com/BenLangmead/bowtie-majref</ext-link>), we created two new human genomes to be used throughout our ecosystem that represent the major allele and the minor allele using dbSNP151 (see Methods). Both genomes are available in Bioconductor as <italic>BSgenome</italic> packages. Both packages can be used in our ecosystem to improve gRNA design by designing gRNAs against either the minor or major allele genome, and searching for off-targets in both the major and minor allele genomes.</p>
    </sec>
    <sec id="Sec10">
      <title>Comprehensive gene and functional annotations</title>
      <p id="Par25">The genomic context of the on-target sites is paramount for optimally selecting gRNAs in most, if not all, CRISPR applications. <italic>crisprDesign</italic> includes the <italic>addGeneAnnotation</italic> and <italic>addTssAnnotation</italic> functions, which report comprehensive transcript- and promoter-specific context for each gRNA target site, respectively. Users simply need to provide a standard Bioconductor <italic>TxDb</italic> object to specify which gene model should be used to annotate on- and off-targets.</p>
      <p id="Par26">For CRISPRko applications, <italic>addGeneAnnotation</italic> annotates which isoforms of a given gene are targeted. It also adds spatial information about the relative cut site within the coding sequence of each isoform, which has been shown to contribute to gRNA activity<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. Since translation reinitiation can result in residual protein expression<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>, <italic>addGeneAnnotation</italic> reports whether or not the gRNA cut site precedes any downstream in-frame ATG sequences using a set of published rules<sup><xref ref-type="bibr" rid="CR59">59</xref></sup>. Additionally, to maximize gene knockout based on protein domains<sup><xref ref-type="bibr" rid="CR60">60</xref></sup>, we include Pfam domain annotation<sup><xref ref-type="bibr" rid="CR61">61</xref></sup> via the <italic>biomarRt</italic> package<sup><xref ref-type="bibr" rid="CR62">62</xref></sup>. For CRISPRa and CRISPRi applications, <italic>addTssAnnotation</italic> indicates which promoter regions are targeted by each gRNA, as well as the location of the target cut site relative to the TSS. This allows the user to easily select guides in the optimal targeting window.</p>
      <p id="Par27">To further put the gRNA targets into biological context, users can access thousands of genomic annotation datasets through the Bioconductor <italic>AnnotationHub</italic> resource. The resource includes common sources such as Ensembl, ENCODE, dbSNP and UCSC. Where appropriate, those annotations are in the <italic>GenomicRanges</italic> format, which make them directly compatible with the <italic>GuideSet</italic> object used to represent gRNAs in our ecosystem. By leveraging overlap operations on <italic>GenomicRanges</italic>, users can identify which gRNAs are present or absent in a given set of annotated features by using a few lines of code. For example, users can ask <italic>AnnotationHub</italic> whether a gRNA is targeting repeat elements to avoid cutting-induced toxicity, or whether a gRNA targets the region upstream of an annotated Cap Analysis of Gene Expression (CAGE) peak for CRISPRa applications. Additionally, the <italic>rtracklayer</italic> Bioconductor package<sup><xref ref-type="bibr" rid="CR63">63</xref></sup> provides functionalities to easily read genome annotations that are stored in the commonly-used WIG, BED, bigWig and bedGraph formats. Utilizing <italic>rtracklayer</italic>, <italic>crisprDesign</italic> provides the function <italic>addConservationScores</italic> to annotate gRNAs with evolutionary conservation scores obtained from the UCSC genome browser (see Methods).</p>
    </sec>
    <sec id="Sec11">
      <title>Advanced functionalities for designing screening libraries</title>
      <p id="Par28">Efficient cleavage can be disrupted by certain features of the gRNA sequence, such as very low or high percent GC content<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR64">64</xref>,<xref ref-type="bibr" rid="CR65">65</xref></sup>, homopolymers of four nucleotides or longer<sup><xref ref-type="bibr" rid="CR66">66</xref>,<xref ref-type="bibr" rid="CR67">67</xref></sup>, and self-complementarity conducive to hairpin formation<sup><xref ref-type="bibr" rid="CR68">68</xref>,<xref ref-type="bibr" rid="CR69">69</xref></sup>. When gRNAs are expressed from a U6 promoter, thymine homopolymers (TTTT) are particularly undesirable as they signal transcription termination. The <italic>addSequenceFeatures</italic> function flags all gRNAs that contain such undesirable sequence features. Another consideration in designing gRNA libraries is to exclude spacer sequences that are not compatible with the oligonucleotide cloning strategy. gRNAs that contain restriction sites of the enzymes used to clone the spacer sequences into a lentiviral vector should be excluded. The <italic>addRestrictionEnzymes</italic> function flags all gRNAs that contain restriction enzyme recognition motifs.</p>
      <p id="Par29">Optical pooled screening (OPS) is a promising screening modality that combines image-based in situ sequencing of gRNAs and optical phenotyping on the same physical wells<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. This enables linking genomic perturbations with high-content imaging at large scale. In such experiments, gRNA spacer sequences are partially sequenced. This translates to additional gRNA design constraints to ensure sufficient dissimilarity of the truncated spacer sequences. <italic>crisprDesign</italic> contains a suite of design functions that take into account OPS constraints, while ensuring that the final OPS library is enriched for gRNAs with best predicted activity.</p>
      <p id="Par30">To assist with the design of complex libraries, we developed the package <italic>crisprViz</italic> to visualize gRNAs. The package uses the Bioconductor package <italic>Gviz</italic><sup><xref ref-type="bibr" rid="CR70">70</xref></sup> to offer a flexible and integrated visualization of gRNAs along genomic coordinates. Users can visually inspect gRNAs within a genomic track with the option of adding annotation tracks such as transcript models, SNP annotations, repeat elements, and nucleotide sequences.</p>
    </sec>
    <sec id="Sec12">
      <title>Functional annotations in <italic>crisprDesign</italic> improve gRNA selection</title>
      <p id="Par31">We illustrate how functional annotations implemented in <italic>crisprDesign</italic> can improve gRNA selection by focusing on two functionalities: <italic>addConservationScores</italic> and <italic>addGeneAnnotation</italic>. We assessed the <italic>addConservationScores</italic> function using the large-scale CRISPRko fitness screening dataset from Project Achilles<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. We obtained normalized log fold changes (LFCs) measuring gRNA dropout over time (see Methods). In fitness screens, gRNAs targeting essential genes should deplete over time, and are therefore expected to have negative LFCs. Therefore, gRNAs targeting essential genes can be used to investigate determinants of gRNA activity. We downloaded basewise phyloP scores<sup><xref ref-type="bibr" rid="CR71">71</xref></sup> from the UCSC genome browser. Scores were calculated from a phylogenic alignment of 30 vertebrate species (see Methods). Positive and negative scores represent evolutionary conservation and acceleration, respectively. In Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>a, we show the correlation between LFCs and conservation scores obtained using different window sizes, for gRNAs targeting a reference set of essential genes<sup><xref ref-type="bibr" rid="CR72">72</xref></sup>. The data suggest an optimal window of 18 nucleotides around the cut site, which is our recommended window size in <italic>crisprDesign</italic>. In Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>b, we present LFC distributions of gRNAs targeting essential genes, split by the sign of the gRNA conservation score. gRNAs targeting conserved regions (positive score, red line) show greater activity than less conserved regions (negative score, black line) as observed by greater gRNA dropout. This is in line with previous results<sup><xref ref-type="bibr" rid="CR67">67</xref>,<xref ref-type="bibr" rid="CR73">73</xref>,<xref ref-type="bibr" rid="CR74">74</xref></sup>. gRNAs targeting non-essential genes serve as negative controls and show no dropout, irrespective of the conservation scores, as expected (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>c).</p>
      <p id="Par32">Next, we sought to understand how gRNA position within the CDS of the target gene impacts gRNA activity. Given that most gRNAs in Project Achilles were located in the first 50% of the target CDS by design, we obtained a different screening dataset; we downloaded data from a genome-wide fitness screen performed in HCT116 cells (Hart2015 dataset, see Methods). We used the <italic>addGeneAnnotation</italic> function in <italic>crisprDesign</italic> to annotate gRNAs with a position percentage of the target CDS. We used the Ensembl canonical transcript of the target gene as the representative CDS. In Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>d, we show the relationship between LFCs and % CDS for gRNAs targeting essential genes. gRNAs located beyond the first 85% of the CDS (to the right of the vertical line) show a progressive decline in activity. The results agree with the litterature<sup><xref ref-type="bibr" rid="CR8">8</xref></sup>. gRNAs targeting non-essential genes serve as negative controls and behave as expected (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>e).</p>
      <p id="Par33">Based on these results, both functional annotations help selecting more active gRNAs; we recommend in <italic>crisprDesign</italic> to prioritize gRNAs with positive conservation scores, and located in the first 85% of the target CDS. Those recommended parameters are implemented as the default parameters in the <italic>crisprDesign</italic> gRNA ranking procedure discussed next.</p>
    </sec>
    <sec id="Sec13">
      <title>gRNA ranking from crisprDesign returns optimized gRNAs</title>
      <p id="Par34">To complement gRNA annotation and assist in library design, <italic>crisprDesign</italic> provides a gRNA ranking function called <italic>rankSpacers</italic>. The function implements our recommended ranking parameters for the nucleases SpCas9, enCas12a, and CasRx, effectively enabling library design automation across targets. It is designed to optimize both on-target activity and minimize off-targeting effects, and includes the functional annotations described in the previous section. Details are provided in the Methods section.</p>
      <p id="Par35">We compared our default gRNA ranking procedure to other tools listed in Table <xref rid="Tab1" ref-type="table">1</xref> that provide gRNA rankings: <italic>CHOPCHOP</italic>, <italic>CCTop</italic>, <italic>FlashFry</italic> and <italic>CRISPick</italic>. To perform the evaluation, we designed and ranked SpCas9 gRNAs for all human protein-coding genes (Ensembl release 104) using each tool separately (see Methods). Next, we obtained and processed 5 human genome-wide fitness screen datasets from published studies (Table <xref rid="Tab4" ref-type="table">4</xref>), each performed using a different gRNA library. For each dataset and gRNA, a LFC between later and earlier time point samples was calculated to quantify gRNA dropout over time.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Genome-wide human CRISPRko screen datasets used for comparing SpCas9 gRNA rankings</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Dataset</th><th>gRNA library</th><th>Cell Line</th><th>Number of gRNAs</th><th>Reference</th></tr></thead><tbody><tr><td>Achilles</td><td>Avana</td><td>(many)</td><td>67,816</td><td><sup><xref ref-type="bibr" rid="CR1">1</xref></sup></td></tr><tr><td>Hart2015</td><td>TKOv1</td><td>HCT116</td><td>164,576</td><td><sup><xref ref-type="bibr" rid="CR99">99</xref></sup></td></tr><tr><td>Hart2017</td><td>TKOv3</td><td>HAP1</td><td>81,967</td><td><sup><xref ref-type="bibr" rid="CR100">100</xref></sup></td></tr><tr><td>Wang2015</td><td>Sabatini</td><td>K562</td><td>166, 855</td><td><sup><xref ref-type="bibr" rid="CR101">101</xref></sup></td></tr><tr><td>Tzelepis2016</td><td>Yusa</td><td>HL60</td><td>85,192</td><td><sup><xref ref-type="bibr" rid="CR102">102</xref></sup></td></tr></tbody></table></table-wrap></p>
      <p id="Par36">gRNAs targeting essential genes are expected to drop out and can be used for benchmarking purposes. To investigate the relationship between gRNA activity and gRNA ranking, we considered for each gRNA library the subset of gRNAs targeting a common reference set of essential genes<sup><xref ref-type="bibr" rid="CR72">72</xref></sup>. For each gene and tool, we identified the top 15 ranked gRNAs based on the tool-specific in silico ranking. In Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, we show the distributions of LFCs in the Hart2015 dataset based on two groups: red lines show the distributions of the top 15 ranked gRNAs across genes, and green lines show the distributions of remaining gRNAs. Top ranked gRNAs from <italic>CRISPick</italic> and <italic>crisprDesign</italic> show greater activity than lower ranked gRNAs, as indicated by a negative shift in the red distributions with respect to the green distributions.<fig id="Fig3"><label>Fig. 3</label><caption><title>Comparison of CRISPRko Cas9 gRNA rankings for protein-coding human genes.</title><p>We designed and ranked gRNAs targeting all protein-coding human genes (Ensembl release 104) using tools that provide gRNA rankings: <italic>CCTop</italic>, <italic>CHOPCHOP</italic>, <italic>FlashFry</italic>, <italic>CRISPick</italic> and <italic>crisprDesign</italic>. To compare gRNA ranking performance across tools, we obtained gRNA LFCs from 5 genome-wide CRISPRko fitness screening datasets, listed in Table <xref rid="Tab3" ref-type="table">3</xref>. In these fitness screens, active gRNAs targeting essential genes are expected to drop out and show negative LFCs. To investigate the relationship between gRNA activity and gRNA ranking, we considered for each gRNA library the subset of gRNAs targeting a common reference set of essential genes<sup><xref ref-type="bibr" rid="CR72">72</xref></sup>. For each gene and tool, we identified the top 15 ranked gRNAs based on the tool-specific in silico ranking. <bold>a</bold> LFC distributions in the Hart2015 dataset for gRNAs targeting essential genes (solid lines) and gRNAs targeting non-essential genes (dotted lines). Red lines show the distributions of the top 15 ranked gRNAs across genes, and green lines show the distributions of remaining gRNAs. For essential genes, top ranked gRNAs from <italic>CRISPick</italic> and <italic>crisprDesign</italic> show greater activity than lower ranked gRNAs (red distributions are negatively skewed). As expected, there are no differences for gRNAs targeting non-essential genes. <bold>b</bold> We repeated the analysis described in (<bold>a</bold>) for each dataset. We summarized the performance of the top ranked gRNAs by calculating the difference in means between the green and red distributions (Δ LFC), for essential genes only. A higher Δ LFC indicates better performance. For each method and dataset, a two-sided t-test was performed to quantify the difference in LFCs between the top ranked gRNAs and the remaining gRNAs. Corresponding p-values are reported above the bars (*<italic>p</italic>-value &lt; 0.05; **<italic>p</italic>-value &lt; 0.01; ***<italic>p</italic>-value &lt; 0.001). Exact p-values are provided in the source data. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2022_34320_Fig3_HTML" id="d32e3319"/></fig></p>
      <p id="Par37">We repeated the analysis for each dataset, and summarized the performance of the top ranked gRNAs at discriminating active gRNAs by calculating the difference in means between the green and red distributions (Δ LFC). Results are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>b. Higher Δ LFCs indicate better performance, and results indicate that both <italic>CRISPick</italic> and <italic>crisprDesign</italic> perform well across all datasets.</p>
    </sec>
    <sec id="Sec14">
      <title>Case study 1: Designing gRNAs targeting <italic>BRCA1</italic> for the base editor BE4max</title>
      <p id="Par38">CRISPR base editors are deaminases fused to CRISPR nickases to introduce mutations at loci targeted by the gRNAs without introducing double-stranded breaks (DSBs)<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>. A recent study showed high heterogeneity and complexity of the editing outcomes across eight popular base editors, motivating the need of robust but flexible software to design gRNAs for base editing applications<sup><xref ref-type="bibr" rid="CR75">75</xref></sup>. In particular, this includes functionalities for listing and characterizing potential edited alleles introduced by gRNAs to inform the phenotypic readouts created by those gRNAs.</p>
      <p id="Par39">To illustrate the functionalities of our ecosystem for designing base editor gRNAs, we designed and characterized all possible gRNAs targeting the coding sequence of <italic>BRCA1</italic> for the cytidine base editor BE4max<sup><xref ref-type="bibr" rid="CR76">76</xref></sup>. The design workflow is shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><title><italic>crisprDesign</italic> workflow to design gRNAs tiling <italic>BRCA1</italic> using the base editor BE4max.</title><p>On the left: schematic showing the major steps involved in designing BE4max gRNAs targeting <italic>BRCA1</italic>. Two inputs are required: DNA sequences of <italic>BRCA1</italic> exons and a <italic>BaseEditor</italic> object from <italic>crisprBase</italic>. <bold>a</bold> Editing weights for the BE4max base editor from <italic>crisprBase</italic>. <bold>b</bold> 10 top predicted edited alleles for one selected gRNA as returned by <italic>crisprDesign</italic>. The wildtype allele and the protospacer sequence are positioned at the top of the first column, with the PAM sequence highlighted in bold. Edited nucleotides are highlighted in red (C to T) and blue (C to G). Editing scores, variant annotations, and protein product of the edited alleles are also shown. <bold>c</bold> On the left, gRNA-level nonsense mutation score as calculated by <italic>crisprDesign</italic>. Colors represent variant classification: nonsense in red, missense in blue, silent in gray. The size of the dot is proportional to the on-target efficiency <italic>DeepHF</italic> score. On the right, ROC curves for classifying gRNA mutation type (nonsense or not) based on gRNA dropout from the <italic>BRCA1</italic> BE4max dataset (see Methods). Different thresholds of the nonsense score were used to label a gRNA as nonsense or not. <bold>d</bold> Relationships between gRNA dropout from the <italic>BRCA1</italic> BE4max dataset and several on-target activity scores. gRNAs that are not predicted to induce a nonsense mutation are colored in gray, and the size of the dots is proportional to the magnitude of the mutation score. The horizontal dotted lines at -0.5 represent a cutoff to classify a gRNA as active or not. For each method, a score cutoff was determined to classify active versus non-active gRNAs (vertical dotted line). Red and blue dots correspond to gRNAs that are correctly and incorrectly classified, respectively. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2022_34320_Fig4_HTML" id="d32e3421"/></fig></p>
      <p id="Par40">The first step consisted of designing all possible guides targeting <italic>BRCA1</italic> using the <italic>findSpacers</italic> function in <italic>crisprDesign</italic>. The BE4max <italic>BaseEditor</italic> object from <italic>crisprBase</italic> was used to store nucleotide- and position-specific editing probabilities (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>a), which inform the editing window of interest for each of the gRNA targets. Next, using the function <italic>getEditedAlleles</italic>, we generated and stored all possible editing events at each gRNA (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). The function also adds a score for each edited allele that quantifies the likelihood of editing to occur based on the editing probabilities stored in the <italic>BaseEditor</italic> object (see Methods). In addition, each edited allele is annotated for its predicted functional consequence: silent, missense, or nonsense mutation. In case several mutations occur in a given edited allele, the most consequential mutation is used to label the allele (nonsense over missense, and missense over silent). For each gRNA, and for each mutation type, we then generated a gRNA-level score by aggregating the likelihood scores across all possible alleles (see Methods). The score represents the likelihood of a gRNA to induce a given mutation type (see Fig. <xref rid="Fig4" ref-type="fig">4</xref>c, left plot).</p>
      <p id="Par41">To show how our gRNA annotations can be used to understand the phenotypic effects observed in screening data, we obtained data from a negative selection pooled screen performed in MelJuSo using a base editing library tiling the <italic>BRCA1</italic> gene<sup><xref ref-type="bibr" rid="CR77">77</xref></sup>. Given that loss-of-function mutations in <italic>BRCA1</italic> reduce cell fitness<sup><xref ref-type="bibr" rid="CR78">78</xref></sup>, gRNAs introducing nonsense mutations are expected to drop out. We created Receiver Operating Characteristic (ROC) curves to measure how well gRNA dropout can separate positive controls from other gRNAs. We used LFCs in gRNA abundance between the later time point and the plasmid DNA (pDNA) library as a measure of gRNA dropout (see Methods). We used several thresholds of the nonsense mutation score to label gRNAs as positive controls or not. We observed that gRNA dropout in the screen can separate positive controls well from all other gRNAs, and that performance is improved when using positive controls defined by higher nonsense mutation scores (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c).</p>
      <p id="Par42">We also characterized gRNAs for off-targeting effects using <italic>crisprBowtie</italic>, added sequence features using <italic>crisprDesign</italic>, and added on-target scores using <italic>crisprScore</italic>. We asked whether or not the magnitude of gRNA dropout in the screen associates with predicted on-target activity for the SpCas9 nuclease. In Fig. <xref rid="Fig4" ref-type="fig">4</xref>d, we show gRNA dropout as a function of different predicted gRNA efficacy scores: Rule Set 1, Azimuth, and DeepHF. gRNAs predicted to induce nonsense mutations are shown in red, and gray otherwise. Despite the fact that each algorithm was trained on data using a SpCas9 nuclease with intact endonuclease activity, gRNA dropout and predicted gRNA efficacy correlate for all methods (<italic>r</italic> = − 0.30 for Rule Set 1, <italic>r</italic> = − 0.20 for Azimuth, and <italic>r</italic> = − 0.17 for DeepHF). Overall, the different functionalities implemented in our ecosystem provides a set of informative annotations for base editor gRNAs and facilitate the interpretation of experimental data obtained from base editor screens.</p>
    </sec>
    <sec id="Sec15">
      <title>Case study 2: Annotating and scoring gRNAs for gene knockdown using CasRx</title>
      <p id="Par43">One of the challenges in designing gRNAs specific to RNA-targeting nucleases is to enable on-target and off-target characterization to be performed in a transcriptome space, as opposed to a reference genome. This requires strand-specific functionalities, transcriptome-specific alignment indexes, as well as additional gene annotation functionalities to capture isoform-specific targeting.</p>
      <p id="Par44">Here, we describe a workflow for designing gRNAs targeting <italic>CD46</italic> and <italic>CD55</italic> using the RNA-targeting nuclease CasRx (RfxCas13d)<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). The workflow takes into consideration the aforementioned issues. To validate our design process, we obtained CasRx pooled screening data performed in HEK 293 cells with gRNA libraries tiling the human genes <italic>CD46</italic> and <italic>CD55</italic><sup><xref ref-type="bibr" rid="CR47">47</xref></sup>. Since both genes encode for cell-surface proteins, the authors used fluorescence-activated cell sorting (FACS) to sort cells with high and low expression. Their data can be used to investigate gRNA knockdown efficacy based on the change in relative abundance of high- and low-expressing cells for each targeted gene (see Methods).<fig id="Fig5"><label>Fig. 5</label><caption><title><italic>crisprDesign</italic> workflow to design gRNAs tiling <italic>CD55</italic> and <italic>CD46</italic> using CasRx.</title><p>On the left: schematic showing the major steps involved in designing CasRx gRNAs targeting <italic>CD55</italic> and <italic>CD46</italic>. Two inputs are required: mRNA sequences of <italic>CD55</italic> and <italic>CD46</italic> and a <italic>CrisprNuclease</italic> object from <italic>crisprBase</italic>. <bold>a</bold> Relationship between on-target CasRx-RF score calculated in <italic>crisprScore</italic> and LFCs from the pooled FACS tiling CasRx screening data (see Methods). A higher LFC indicates higher gRNA activity. <bold>b</bold> Relationship between LFCs from the CasRx screening data and gRNA context for <italic>CD46</italic> and <italic>CD55</italic>: gRNAs targeting 5<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{\prime}$$\end{document}</tex-math><mml:math id="M6"><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq3.gif"/></alternatives></inline-formula> UTR and 3<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{\prime}$$\end{document}</tex-math><mml:math id="M8"><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq4.gif"/></alternatives></inline-formula> UTR for the canonical transcript, and guides targeting a low and high number of isoforms for each of the genes. gRNAs targeting more isoforms show higher enrichment in the screening data. The boxes represent the 25−75% interquartile ranges (IQR), and the central lines represent the median values. The whiskers extend 1.5 times the IQR from the median value. The number of data points for each boxplot is specified above the whiskers. The full isoform annotation is stored in the <italic>GuideSet</italic> objects. <bold>c</bold> Left: relationship between observed LFCs of on-target gRNAs in the <italic>CD55</italic> screen and predicted LFCs of single-mismatch gRNAs using the off-target CFD-CasRx score implemented in <italic>crisprScore</italic> (see Methods). Right: same as left, but for double-mismatch gRNAs. <bold>d</bold> gRNAs selected in the <italic>CD46</italic> screen for high on-target activity (CasRx-RF score) and targeting a common exon across all protein-coding isoforms enrich for high gRNA activity. Source data are provided as a Source Data file.</p></caption><graphic xlink:href="41467_2022_34320_Fig5_HTML" id="d32e3626"/></fig></p>
      <p id="Par45">We first extracted mRNA sequences of both genes using the function <italic>getMrnaSequence</italic> from <italic>crisprDesign</italic>. The mRNA sequences, together with the <italic>CrisprNuclease</italic> object CasRx from <italic>crisprBase</italic>, served as inputs to create a <italic>Guideset</italic>. Next, we predicted on-target activity of the gRNAs using our implementation of the CasRx-RF method<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> available in <italic>crisprScore</italic> (see “Methods”). The normalized LFCs in the screen correlate well with the CasRx-RF score (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). We then added a transcript annotation to each gRNA using an Ensembl <italic>TxDb</italic> object as input. This adds a list of targeted isoforms to each gRNA, as well as transcript context (CDS, <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${5}^{\prime}$$\end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq5.gif"/></alternatives></inline-formula>UTR, or <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${3}^{\prime}$$\end{document}</tex-math><mml:math id="M12"><mml:msup><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq6.gif"/></alternatives></inline-formula>UTR). We observed in the screen that gRNAs targeting a higher number of isoforms, and gRNAs located in CDS, lead to higher activity (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b and Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>).</p>
      <p id="Par46">We performed an off-target search using <italic>crisprBowtie</italic> to the human transcriptome by providing a <italic>Bowtie</italic> index built on mRNA sequences. We extended the CFD off-target scoring algorithm implemented in <italic>crisprScore</italic> to work with CasRx by estimating mismatch tolerance weights on published GFP tiling screen data<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> (see “Methods”). The off-target CFD-CasRx score performs well at predicting gRNA activity of single-mismatch and double-mismatch gRNAs in the <italic>CD55</italic> screen (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c and see “Methods”).</p>
      <p id="Par47">Finally, we added sequence features, and ranked gRNAs for targeting <italic>CD55</italic> and <italic>CD46</italic> based on (1) high on-target score, (2) low number of off-targets, and (3) high number of targeted isoforms. If we select gRNAs that target a common exon and that have high on-target score, we enrich for highly active gRNAs in the screening data (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d).</p>
    </sec>
    <sec id="Sec16">
      <title>Case study 3: Designing optimal gRNAs to activate <italic>MMP7</italic> using CRISPRa using different nucleases</title>
      <p id="Par48">Designing gRNAs for either CRISPRa and CRISPRi applications requires additional considerations. This includes choosing an optimal target region based on chromatin accessibility data and TSS data, and selecting gRNAs based on their positioning with respect to the TSS.</p>
      <p id="Par49">To demonstrate the utility of our ecosystem functionalities for CRISPRa and CRISPRi, we designed gRNAs for CRISPRa using the human gene <italic>MMP7</italic> as an example target (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). CRISPRi is discussed at the end of this section. One CRISPRa-specific design consideration is the limited number of candidate gRNAs available for a given gene due to the narrow window of optimal activation. Engineered nucleases with less constrained PAM sequences can improve CRISPRa applicability by expanding the set of candidate gRNAs. To investigate this, we designed gRNAs for the promoter region of <italic>MMP7</italic> using four nucleases in parallel: SpCas9, AsCas12a, and the more PAM-flexible versions SpGCas9<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and enAsCas12a<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>.<fig id="Fig6"><label>Fig. 6</label><caption><title>Design of CRISPRa gRNAs for human gene <italic>MMP7</italic> for different CRISPR nucleases.</title><p><bold>a</bold> Schematic showing the steps involved in designing CRISPRa gRNAs targeting the promoter region of <italic>MMP7</italic>. A gene model and a list of CAGE peaks are used to define the optimal window for gene activation. A <italic>GuideSet</italic> is created separately for each CRISPR nuclease. DNase I hypersensitive site (DHS) information is obtained from <italic>AnnotationHub</italic> and added to the gRNA annotation. <bold>b</bold> The top track shows the promoter region of human gene <italic>MMP7</italic> on chromosome 11, including part of the 5<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{\prime}$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq7.gif"/></alternatives></inline-formula> UTR of <italic>MMP7</italic> (yellow). The DHS and CAGE peak gray boxes were obtained using <italic>AnnotationHub</italic> (see Methods). The light pink region corresponds to the optimal region of activation, corresponding to a region [75,150]bp upstream of the <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${5}^{\prime}$$\end{document}</tex-math><mml:math id="M16"><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq8.gif"/></alternatives></inline-formula> end of the CAGE peak. For each of the four selected nucleases, all canonical PAM sites located within the optimal region are shown. PAM sites are colored by their on-target score: DeepHF for SpCas9, DeepCpf1 for AsCas12a, and enPAM+GB for enAsCas12a. No on-target scoring algorithm was available at time of publication for SpGCas9. The last track corresponds to common SNPs obtained from dbSNP151.</p></caption><graphic xlink:href="41467_2022_34320_Fig6_HTML" id="d32e3821"/></fig></p>
      <p id="Par50">The first step of the gRNA design was to specify the target region for <italic>MMP7</italic>. We used <italic>AnnotationHub</italic> to find CAGE peaks in the promoter region of <italic>MMP7</italic> to specify the TSS position. We used the CAGE data to identify TSSs instead of RefSeq or Ensembl as the former provides more accurate annotations for designing CRISPRi and CRISPRa gRNAs<sup><xref ref-type="bibr" rid="CR79">79</xref></sup>. The 5<inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${}^{\prime}$$\end{document}</tex-math><mml:math id="M18"><mml:msup><mml:mrow/><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq9.gif"/></alternatives></inline-formula> end of the CAGE peak was used as the TSS to define the coordinates of the optimal window of activation. Based on a previous study<sup><xref ref-type="bibr" rid="CR80">80</xref></sup>, we defined the optimal window of activation to be between 75 and 150 nucleotides upstream of the TSS.</p>
      <p id="Par51">Next, we designed all possible gRNAs for the four nucleases using the <italic>findSpacers</italic> function in <italic>crisprDesign</italic>, and stored the gRNAs in four separate <italic>GuideSet</italic> containers. We annotated each <italic>GuideSet</italic> for overlap with DNase I hypersensitivity sites (DHS) from consolidated epigenomes from the Roadmap Epigenomics Project<sup><xref ref-type="bibr" rid="CR81">81</xref></sup> using <italic>AnnotationHub</italic>. Open-chromatin regions are favorable for the binding of the catalytically inactive Cas9 (dCas9) used in both CRISPRa and CRISPRi<sup><xref ref-type="bibr" rid="CR82">82</xref>,<xref ref-type="bibr" rid="CR83">83</xref></sup>. We then added sequence features using <italic>crisprDesign</italic>, on-target scores using <italic>crisprScore</italic>, and off-target sites using <italic>crisprBowtie</italic> for each nuclease. Finally, we added overlapping SNPs information using the <italic>addSNPAnnotation</italic> function and using dbSNP151. The end-to-end workflow is presented in Fig. <xref rid="Fig6" ref-type="fig">6</xref>a.</p>
      <p id="Par52">The designed gRNAs are presented in Fig. <xref rid="Fig6" ref-type="fig">6</xref>b. With <italic>crisprDesign</italic>, it is straightforward to select candidate gRNAs in the most promising genomic regions - in this case, lying inside both the annotated DHS and the optimal activation window for MMP7. One can immediately appreciate that both nuclease variants (SpGCas9 and enAsCas12a) yield substantially more available gRNAs in the optimal window activation. In particular, enAsCas12a offers several gRNAs with high predicted on-target activity, making it a better candidate for gene activation of <italic>MMP7</italic>. One SNP was also found in the region of interest, and overlapping one gRNA for enAsCas12a that should be avoided. Altogether, our ecosystem provides an easy and comprehensive workflow to enable users to design optimal gRNAs for CRISPRa across nucleases.</p>
      <p id="Par53">Designing gRNAs for CRISPRi applications using <italic>crisprDesign</italic> is nearly identical, with the exception that the preferred target region for interference is located downstream of the TSS. The CRISPRai scoring algorithm<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, available through <italic>crisprScore</italic>, can be used to select optimal gRNAs for each TSS separately, taking into account both gRNA positioning and sequence content to maximize on-target inhibition. For both CRISPRa and CRISPRi, our gRNA design workflow is also applicable to non-coding regulatory elements, for instance long non-coding RNAs (lncRNAs)<sup><xref ref-type="bibr" rid="CR84">84</xref></sup>. Overall, <italic>crisprDesign</italic> provides end-to-end functionalities that are well-suited for a large array CRISPRa and CRISPRi applications.</p>
    </sec>
  </sec>
  <sec id="Sec17" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par54">In this work, we introduced a suite of R packages to perform comprehensive end-to-end gRNA design for a multitude of CRISPR technologies and applications. Our ecosystem, named the <italic>crisprVerse</italic>, enables users to perform gRNA design for diverse nucleases such as PAM-free nucleases and RNA-targeting nucleases, and for several applications beyond CRISPRko such as RNA and DNA base editing and CRISPRa/i. All design functionalities are available from a core package, <italic>crisprDesign</italic>. This eliminates the need to use multiple tools to obtain the necessary information for selecting optimal gRNAs, which is both time consuming and error prone. We demonstrated the diversity of our framework by applying it in three case studies involving different CRISPR technologies with their own specific design considerations.</p>
    <p id="Par55">We were able to show that creating rich gRNA annotations can help investigate gRNA variability and biases observed in experimental data generated from newer CRISPR technologies. To do so, we obtained public pooled screening data from two published studies, a tiling base editor screen of <italic>BRCA1</italic>, and a tiling CasRx screen of <italic>CD46</italic> and <italic>CD55</italic>, and show how some of the gRNA features derived from <italic>crisprDesign</italic> can explain some of the variability in gRNA activity observed in both screens. We also showed that our default gRNA ranking criteria implemented in <italic>crisprDesign</italic> yield optimal gRNAs by reanalyzing five genome-wide fitness screening datasets.</p>
    <p id="Par56">The modular architecture of the <italic>crisprVerse</italic> enables nucleases, base editors, scoring methods and annotations to be combined depending on the needs of the user. As a result, our design framework can easily adapt to new CRISPR technologies by swapping out the necessary components. For instance, a recent study has shown that the resolution of base editor screens can be greatly increased by combining existing base editors with PAM-extended Cas9 variants<sup><xref ref-type="bibr" rid="CR85">85</xref></sup>, while another study shows that RNA-targeting Cas13 nucleases can be combined with deaminases to form RNA base editors<sup><xref ref-type="bibr" rid="CR28">28</xref></sup>. Both applications can be readily supported by our ecosystem without the need for further development.</p>
    <p id="Par57">Our ecosystem is completely implemented within the Bioconductor project, which provides robust and feature-rich data structures, high-quality documentation and workflows, and seamless interoperability between packages. Data structures defined in <italic>crisprBase</italic> can be reused to facilitate the analysis of CRISPR-based editing events in other packages, such as <italic>ampliCan</italic><sup><xref ref-type="bibr" rid="CR86">86</xref></sup>, <italic>GUIDEseq</italic><sup><xref ref-type="bibr" rid="CR87">87</xref></sup> and <italic>CrisprRVariants</italic><sup><xref ref-type="bibr" rid="CR88">88</xref></sup>. <italic>GuideSet</italic> gRNA containers can be integrated with packages that provide analysis workflows for pooled screening data<sup><xref ref-type="bibr" rid="CR89">89</xref>–<xref ref-type="bibr" rid="CR91">91</xref></sup> to investigate biases and filter out undesirable gRNAs. Finally, the <italic>crisprBowtie</italic> and <italic>crisprBwa</italic> packages provide general functions that can be used to map any short sequences, including small-hairpin RNAs and short-interfering RNAs. We are continuously extending our suite of tools to make available the latest developments for gRNA design, such as prime editing<sup><xref ref-type="bibr" rid="CR92">92</xref></sup> and combinatorial libraries<sup><xref ref-type="bibr" rid="CR93">93</xref></sup>.</p>
  </sec>
  <sec id="Sec18">
    <title>Methods</title>
    <sec id="Sec19">
      <title>Reference genomes, gene models, and genome indexes</title>
      <p id="Par58">The FASTA file for the human reference genome (GRCh38.p13 assembly) was obtained from UCSC to build <italic>Bowtie</italic> and <italic>BWA</italic> indexes via the <italic>Rbowtie</italic> (v1.37)<sup><xref ref-type="bibr" rid="CR94">94</xref></sup> and <italic>Rbwa</italic> (v1.1) R packages, respectively. The packages use Bowtie v1.3 and BWA Release 0.7.17, respectively. The gene model used throughout the manuscript was obtained from Ensembl (release 104) using the R package <italic>GenomicFeatures</italic> (v1.49.6). Common SNPs were obtained from NCBI dbSNP build 151 (<ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/snp/">https://ftp.ncbi.nlm.nih.gov/snp/</ext-link>).</p>
    </sec>
    <sec id="Sec20">
      <title>CAGE peak and DNAse I hypersensitivity data</title>
      <p id="Par59">RIKEN/ENCODE CAGE peaks were obtained from <italic>AnnotationHub</italic> (v3.5) using accession number AH5084<sup><xref ref-type="bibr" rid="CR95">95</xref></sup>. Genomic coordinates were lifted over from hg19 to hg38 using the R package <italic>rtracklayer</italic> (v1.57). DNAse I hypersensitive sites were obtained from <italic>AnnotationHub</italic> using accession number AH30743. The narrow DNase peaks were obtained using MACS2 on consolidated epigenomes from the Roadmap Epigenomics Project (E116-DNase.macs2.narrowPeak.gz)<sup><xref ref-type="bibr" rid="CR81">81</xref></sup>. Genomic coordinates were lifted over from hg19 to hg38 using the R package <italic>rtracklayer</italic>.</p>
    </sec>
    <sec id="Sec21">
      <title>On-target scoring</title>
      <p id="Par60">We implemented several commonly-used algorithms for Cas9, Cas12 and Cas13 nucleases in <italic>crisprScore</italic>. For predicting on-target activity of the wildtype SpCas9 nuclease, we implemented the popular Rule Set 1<sup><xref ref-type="bibr" rid="CR7">7</xref></sup> and <italic>Azimuth</italic> algorithms<sup><xref ref-type="bibr" rid="CR8">8</xref></sup> (iteration of the popular Rule Set 2 algorithm by the same authors), and the sequence-only Rule Set 3<sup><xref ref-type="bibr" rid="CR74">74</xref></sup>. The package also provides the deep learning-based algorithms <italic>DeepWT</italic> and <italic>DeepHF</italic>, developed to predict cutting efficiency of the wildtype SpCas9 and SpCas9-High Fidelity (SpCas9-HF1) nucleases, respectively<sup><xref ref-type="bibr" rid="CR9">9</xref></sup>, and the <italic>DeepSpCas9</italic> algorithm<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>. We also included the <italic>CRISPRscan</italic> algorithm<sup><xref ref-type="bibr" rid="CR12">12</xref></sup> for predicting on-target activity of SpCas9 gRNAs expressed from a T7 promoter, as well as the <italic>CRISPRater</italic> algorithm<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. For the wildtype AsCas12a, <italic>crisprScore</italic> offers the deep-learning based prediction method DeepCpf1<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>. For the enhanced AsCas12a (enAsCas12a), <italic>crisprScore</italic> offers the <italic>enPAM+GB</italic> algorithm<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. For CasRx (RfxCas13d), we adapted the code from a published random forest model<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>; we referred to the method as <italic>CasRx-RF</italic>.</p>
      <p id="Par61">For predicting gRNA activity for CRISPRa and CRISPRi, we implemented the prediction method used to design the commonly-used Weissman CRISPRa and CRISPRi v2 genome-wide libraries for human and mouse<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. This method predicts CRISPRa (or CRISPRi) gRNA activity based on the distance to the transcription starting site (TSS), spacer sequence-derived features, as well as chromatin accessibility data and nucleosome positioning using DNase-Seq, MNase-Seq, and FAIRE-Seq data. The chromatin data in hg38 coordinates are available on Zenodo (10.5281/zenodo.6716721).</p>
      <p id="Par62">The function <italic>addCompositeScores</italic> from <italic>crisprDesign</italic> creates an aggregate score from a specified list of on-target scoring methods. It takes the average of the specified scores after performing a rank transformation. More specifically, consider <italic>s</italic><sub><italic>i</italic><italic>j</italic></sub> to be the score value for gRNA <italic>i</italic> and method <italic>j</italic>. The composite score <italic>S</italic><sub><italic>i</italic></sub> for gRNA <italic>i</italic> is<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{i}=\frac{\mathop{\sum }\nolimits_{j=1}^{N}{{{{{{{\rm{rank}}}}}}}}({s}_{ij})}{N}$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mi mathvariant="normal">rank</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2022_34320_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>N</italic> is the total number of user-specified on-target scoring methods, and rank(<italic>s</italic><sub><italic>i</italic><italic>j</italic></sub>) is the ranked score within method <italic>j</italic>. Importantly, if the number of missing values varies across on-target scoring methods, we ensure that the scale of the rank-transformed values are comparable across methods by simply scaling the ranks so that highest ranked value is equal across all methods. Missing values are uncommon but can happen when designing gRNAs targeting custom sequences. Indeed, several scoring algorithms require nucleotide context around the protospacer sequences, and this is not possible for gRNAs located near the end of the user-provided custom sequences.</p>
      <sec id="Sec22">
        <title>On-target prediction of frameshift-causing indels using <italic>Lindel</italic></title>
        <p id="Par63">In <italic>crisprScore</italic>, we implemented <italic>Lindel</italic><sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, a logistic regression model that was trained to use local sequence context to predict the distribution of mutational outcomes for CRISPR/Cas9. The <italic>Lindel</italic> final score reported in <italic>crisprScore</italic> is the proportion of "frameshifting" indels, that is the frequency of indels predicted to introduce frameshift mutations. By chance, assuming a random distribution of indel lengths, gRNAs should have a frameshifting proportion of 0.66. A <italic>Lindel</italic> score higher than 0.66 indicates that a given gRNA is more likely to cause a frameshift mutation than by chance.</p>
      </sec>
    </sec>
    <sec id="Sec23">
      <title>Off-target scoring of individual off-targets</title>
      <p id="Par64">The exact formula that we use to calculate the CFD score in <italic>crisprScore</italic> is<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\rm{CFD}}}}}}}}=\mathop{\prod}\limits_{p\in M}{w}_{p}({x}_{{{{{{{{\rm{RNA}}}}}}}}},{x}_{{{{{{{{\rm{DNA}}}}}}}}})$$\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="normal">CFD</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">RNA</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">DNA</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2022_34320_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>M</italic> is the set of positions for which there is a mismatch between the gRNA spacer sequence and the off-target sequence. <italic>w</italic><sub><italic>p</italic></sub>(<italic>x</italic><sub>RNA</sub>, <italic>x</italic><sub>DNA</sub>) is an experimentally-derived mismatch tolerance weight at position <italic>p</italic> depending on the RNA nucleotide <italic>x</italic><sub>RNA</sub> and the DNA nucleotide <italic>x</italic><sub>DNA</sub><sup><xref ref-type="bibr" rid="CR6">6</xref></sup>.</p>
      <p id="Par65">The exact formula that we use to calculate the MIT score in <italic>crisprScore</italic> was obtained from the MIT design website (<ext-link ext-link-type="uri" xlink:href="http://crispr.mit.edu">crispr.mit.edu</ext-link>):<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\rm{MIT}}}}}}}}=\left(\mathop{\prod}\limits_{p\in M}{c}_{p}\right)\times \frac{1}{\frac{L-d}{L}\times 4+1}\times \frac{1}{{m}^{2}}$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="normal">MIT</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mn>4</mml:mn><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2022_34320_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where <italic>M</italic> is the set of positions for which there is a mismatch between the gRNA spacer sequence and the off-target sequence, <italic>c</italic><sub><italic>p</italic></sub> is an experimentally-derived mismatch tolerance weight at position <italic>p</italic>, <italic>d</italic> is the average distance between mismatches, <italic>m</italic> is the total number of mismatches, and <italic>L</italic> is the spacer length. The spacer length used in the original publication is 19<sup><xref ref-type="bibr" rid="CR57">57</xref></sup>. As the number of mismatches increases, the cutting likelihood decreases.</p>
    </sec>
    <sec id="Sec24">
      <title>Composite off-target score for gRNA specificity</title>
      <p id="Par66">To create a gRNA-level composite specificity score, individual off-target cutting scores are aggregated using the following inverse summation formula:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{{{{{{\rm{Specificity}}}}}}}}=\frac{1}{1+\mathop{\sum }\nolimits_{i=1}^{n}{{{{{{{{\rm{C}}}}}}}}}_{i}}$$\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="normal">Specificity</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="41467_2022_34320_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where C<sub><italic>i</italic></sub> is the cutting likelihood score (either using the MIT or the CFD method) for the <italic>i</italic><sup>th</sup> putative off-target. A higher composite score indicates higher specificity, which decreases with more off-targets and/or a greater likelihood of cleavage at each off-target. A gRNA with no putative off-targets have a composite score of 1. A gRNA with 2 on-targets, that is a gRNA targeting two genomic loci with perfect complementarity, will have a composite score of 0.5.</p>
    </sec>
    <sec id="Sec25">
      <title>Evolutionary conservation scores</title>
      <p id="Par67">The function <italic>addConservationScores</italic> in <italic>crisprDesign</italic> annotates gRNAs with evolutionary conservation scores. It requires bigWig files containing basewise conservation scores, which can be easily obtained from the UCSC genome browser database<sup><xref ref-type="bibr" rid="CR96">96</xref></sup> at the following link: <ext-link ext-link-type="uri" xlink:href="https://hgdownload.soe.ucsc.edu/downloads.html">https://hgdownload.soe.ucsc.edu/downloads.html</ext-link>. The gRNA score is calculated as the average conservation score of a region centered around the predicted cut site of the gRNA. By default, the width of the region is 18 nucleotides, but can be changed by users. For our analysis of human protein-coding genes, we used the phyloP score from an alignment of 29 genome sequences to the human genome available at <ext-link ext-link-type="uri" xlink:href="https://hgdownload.soe.ucsc.edu/goldenPath/hg38/phyloP30way/">https://hgdownload.soe.ucsc.edu/goldenPath/hg38/phyloP30way/</ext-link>. Positive phyloP scores indicate conserved regions, while negative scores indicate evolution faster than expected under neutral drift.</p>
    </sec>
    <sec id="Sec26">
      <title>Base editing scoring</title>
      <p id="Par68">The behavior of a base editor can be quantified in a 3-dimensional array of editing probabilities. Let <italic>p</italic> be the genomic position relative to the PAM site; let <italic>n</italic><italic>u</italic><italic>c</italic><sub><italic>u</italic></sub> be the original nucleotide; and let <italic>n</italic><italic>u</italic><italic>c</italic><sub><italic>e</italic></sub> be the edited nucleotide. Denote <italic>q</italic>(<italic>p</italic>, <italic>n</italic><italic>u</italic><italic>c</italic><sub><italic>u</italic></sub>, <italic>n</italic><italic>u</italic><italic>c</italic><sub><italic>e</italic></sub>) as the probability that <italic>n</italic><italic>u</italic><italic>c</italic><sub><italic>u</italic></sub> is edited to <italic>n</italic><italic>u</italic><italic>c</italic><sub><italic>e</italic></sub> at position <italic>p</italic>. Experimental editing weights can be used, possibly after some adequate transformation, to obtain those probabilities.</p>
      <p id="Par69">To score the likelihood of each edited allele, we assume independence of editing events with respect to nucleotide position. Specifically, consider a wildtype allele <inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U=({u}_{{p}_{1}},{u}_{{p}_{2}},...,{u}_{{p}_{n}})$$\end{document}</tex-math><mml:math id="M28"><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq10.gif"/></alternatives></inline-formula> and an edited allele <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V=({v}_{{p}_{1}},{v}_{{p}_{2}},...,{v}_{{p}_{n}})$$\end{document}</tex-math><mml:math id="M30"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq11.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${u}_{{p}_{i}}$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{{p}_{i}}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2022_34320_Article_IEq13.gif"/></alternatives></inline-formula> are the nucleotides at position <sub><italic>pi</italic></sub> relative to the PAM site for the wildtype and edited allele, respectively. The parameter <italic>n</italic> is chosen by the user, and should be large enough so that all nucleotides within the editing window of the chosen base editor are represented. We calculate the editing score for the edited allele <italic>V</italic> (with respect to the wildtype allele <italic>U</italic>) as follows:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S(U,V)=\mathop{\prod }\limits_{i=1}^{n}q({p}_{i},{u}_{{p}_{i}},{v}_{{p}_{j}})$$\end{document}</tex-math><mml:math id="M36"><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi>q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2022_34320_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>For a given edited allele <italic>V</italic>, we classify the functional consequence of editing as either a silent, missense, or nonsense mutation. We use <italic>f</italic>(<italic>V</italic>) to label the mutation. In case an edited allele results in more than one mutation, we choose the most consequential mutation as the label (nonsense over missense, and missense over silent). For a given gRNA targeting the wildtype allele <italic>U</italic>, and the set of all possible edited alleles <italic>V</italic><sub><italic>j</italic></sub>, we calculate an aggregated score for each mutation type by summing the editing scores across alleles for each mutation type. For instance, the aggregated score for silent mutations is calculated as follows:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{silent}(U)=\mathop{\sum }\limits_{j=1}^{N}S(U,{V}_{j}){{{{{{{\bf{1}}}}}}}}(\,\,f({V}_{j})={{{{{{{\rm{silent}}}}}}}})$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mi>S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="bold">1</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mspace width="0.25em"/><mml:mspace width="0.25em"/><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal">silent</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="41467_2022_34320_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <italic>N</italic> is the total number of possible edited alleles <italic>V</italic><sub><italic>j</italic></sub>.</p>
      <sec id="Sec27">
        <title>Creation of major and minor allele human genomes</title>
        <p id="Par70">We built major and minor allele genomes for the hg38 build using common SNPs from the dbSNP151 RefSNP database. The "common" category is based on germline origin and a minor allele frequency (MAF) of &gt; = 0.01 in at least one major population, with at least two unrelated individuals having the minor allele. See the dbSNP website <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/variation/docs/human_variation_vcf/">https://www.ncbi.nlm.nih.gov/variation/docs/human_variation_vcf/</ext-link>for more information. We excluded indels, and only considered SNPs that have MAF greater than 1% in the 1000 Genomes Project population. We then injected major alleles and minor alleles into the reference genome hg38 sequence to create "major allele" and "minor allele" genomes, respectively. Both resulting genomes are provided as standard FASTA files. We generated <italic>Bowtie</italic> and <italic>BWA</italic> indexes for the two genomes. All results files are available on Zenodo (10.5281/zenodo.6862556). The two allele genomes are also available from Bioconductor via their respective packages:<list list-type="bullet"><list-item><p id="Par71">BSgenome.Hsapiens.UCSC.hg38.dbSNP151.major<sup><xref ref-type="bibr" rid="CR97">97</xref></sup></p></list-item><list-item><p id="Par72">BSgenome.Hsapiens.UCSC.hg38.dbSNP151.minor<sup><xref ref-type="bibr" rid="CR98">98</xref></sup></p></list-item></list></p>
      </sec>
    </sec>
    <sec id="Sec28">
      <title>Base editing pooled screen data analysis</title>
      <p id="Par73">Fitness screen data in the MelJuSo cell line using a gRNA library tiling <italic>BRCA1</italic> were obtained from the supplementary material of the original publication<sup><xref ref-type="bibr" rid="CR77">77</xref></sup>. We normalized the raw counts by scaling by the total number of reads, and log<sub>2</sub>-transformed the data. We filtered out low-abundance gRNAs that were further than 3 standard deviations below the mean in the plasmid (pDNA) sample. From the later timepoint samples, we subtracted from the pDNA sample log counts to obtain LFCs, and averaged the LFCs across replicates. We filtered out gRNAs targeting multiple loci, and gRNAs with off-targets (with up to 2 mismatches) located in genes other than <italic>BRCA1</italic>.</p>
    </sec>
    <sec id="Sec29">
      <title>CasRx pooled screen data analysis</title>
      <p id="Par74">CasRx FACS pooled screening data tiling <italic>CD55</italic>, <italic>CD46</italic> and <italic>GFP</italic><sup><xref ref-type="bibr" rid="CR47">47</xref></sup>, including processed and normalized LFCs for each gRNA <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/sanjanalab/cas13">https://gitlab.com/sanjanalab/cas13</ext-link>. We redesigned all possible gRNAs targeting any of the isoforms of <italic>CD55</italic> and <italic>CD46</italic> using <italic>crisprDesign</italic>, and considered only gRNAs also present in the pooled screening data for downstream analyses. We annotated all gRNAs with gene information (Ensembl release 104) and obtained off-targets with up to 3 mismatches for all gRNAs using <italic>crisprBowtie</italic>. We obtained CasRx-RF on-target activity scores using <italic>crisprScore</italic>. The transcripts annotated as canonical by Ensembl (ENST00000367042 for <italic>CD46</italic>, and ENST00000367064 for <italic>CD55</italic>) were used to visualize LFCs.</p>
      <p id="Par75">For each gRNA, we quantified the abundance of its target gene by summing transcript per million (TPM) counts in HEK-293 cells for all transcripts targeted by the gRNA. Transcript-level RNA quantification for HEK-293 cells was obtained from the Protein Atlas web portal <ext-link ext-link-type="uri" xlink:href="https://www.proteinatlas.org">https://www.proteinatlas.org</ext-link>, on March 5 2022. Data are based on The Human Protein Atlas version 21.0 and Ensembl version 103 . We averaged TPM counts across the two replicates.</p>
      <p id="Par76">We used the single-mismatch (SM) gRNA constructs from the GFP tiling screen to estimate position-dependent probabilities of mismatch tolerance by the CasRx nuclease. To do so, we first calculated differences in LFC (ΔLFC) between SM gRNAs and their corresponding perfect-match (PM) gRNAs. We then fitted a LOESS curve with respect to the nucleotide position to obtain an average ΔLFC at each spacer position (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>a). We transformed the LOESS fitted values to a scale between 0 and 1 to represent them as percentages of activity with respect to the median activity of the PM gRNAs tiling GFP (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>b). Given the sparsity of the data, specifying a nucleotide-specific weight at each position was not possible. We adapted in <italic>crisprScore</italic> the CFD off-targeting scoring method to CasRx by using those probabilities as scoring weights. The corresponding scoring algorithm is named CFD-CasRx.</p>
      <p id="Par77">To evaluate the performance of the CFD-CasRx score on an independent dataset, we calculated CFD-CasRx off-target scores on all SM and double-mismatch (DM) gRNAs included in the <italic>CD55</italic> tiling screen. To predict LFCs of the DM gRNAs, we multiplied their respective PM gRNA LFCs with the CFD-CasRx on-target scores.</p>
    </sec>
    <sec id="Sec30">
      <title>Evaluation of the off-target alignment methods within <italic>crisprDesign</italic></title>
      <p id="Par78">For comparing runtimes of the off-target alignment methods, the following sets of gRNAs were chosen: (1) gRNAs targeting the coding sequence of <italic>KRAS</italic>, for a total of 52 gRNAs; (2) gRNAs targeting the coding sequence of <italic>EGFR</italic>, for a total of 645 gRNAs, and (3) gRNAs targeting the coding sequence of <italic>ZNF101</italic>, for a total of 152 gRNAs. The <italic>KRAS</italic> and <italic>EGFR</italic> cases represent small- and medium-sized sets of gRNAs. For <italic>ZNF101</italic>, a few gRNAs overlap a repeat element, and therefore have a high number of on- and off-targets. Alignment was performed to the GRCh38.p13 genome. The <italic>Bowtie</italic> and <italic>Biostrings</italic> alignment methods were evaluated using 0 to 3 mismatches, and the BWA alignment methods were evaluated using 0 to 5 mismatches. Run times were collected on a Macbook Pro with an Intel Core i7 CPU (2.6GHz, 6 cores, 16 GB memory).</p>
    </sec>
    <sec id="Sec31">
      <title>Comparison of off-target alignments across tools</title>
      <p id="Par79">We compared computing times for designing SpCas9 gRNAs and performing a genome-wide off-target search for the following tools: <italic>CCTop</italic>, <italic>CHOPCHOP</italic>, <italic>multicrispr</italic>, <italic>FlashFry</italic>, and <italic>crisprDesign</italic>. The following tools were excluded from the comparison: <italic>CRISPick</italic> as it does not provide a standalone software; <italic>CRISPRseek</italic> as we were not able to complete the search within a reasonable time; <italic>Cas-Designer</italic> due to its requirement for specialized software that we were not able to install on our machines; <italic>E-CRISP</italic> as it was not possible to run their command line interface on customs DNA sequences or exons.</p>
      <p id="Par80">To perform the comparison, we generated six random subsets of protein-coding exons located on chr1 with the following sizes:100, 200, 400, 800, 1600 and 3200 exons. Off-target alignment was performed against the human reference genome (GRCh38 build) using a maximum of 2 mismatches for all methods. Run times were collected on a Macbook Pro with an Intel Core i7 CPU (2.6GHz, 6 cores, 16 GB memory). For each tool, parameters optimized for speed were chosen based on available documentation. In particular, the following parameters were used. For <italic>CCTop</italic>, we used –totalMM 2 –coreMM 2 –maxOT 100000. For <italic>CHOPCHOP</italic>, we used: –fasta -G HG38 -t WHOLE -v 2. For <italic>FlashFry</italic>, we used: –maximumOffTargets 100000 –forceLinear –maxMismatch 2. For <italic>multicrispr</italic>, we used Bowtie with 2 mismatches, with no on-target scoring. For <italic>crisprDesign</italic>, we used the function <italic>addSpacerAlignmentsIterative</italic> with the <italic>Bowtie</italic> and <italic>BWA</italic> aligners with 2 mismatches.</p>
    </sec>
    <sec id="Sec32">
      <title>Processing of genome-wide screen datasets</title>
      <sec id="Sec33">
        <title>Achilles dataset</title>
        <p id="Par81">CRISPRko fitness screening gRNA-level LFCs from Project Achilles (22Q2 release) were downloaded from the DepMap portal <ext-link ext-link-type="uri" xlink:href="https://depmap.org/portal/download/all/">https://depmap.org/portal/download/all/</ext-link>. Processed LFCs representing changes in gRNA abundances between the last time point of the fitness screen and the plasmid DNA were available for 957 human cell lines. We used previously-published reference lists of essential and non-essential genes for normalization<sup><xref ref-type="bibr" rid="CR72">72</xref></sup>. In particular, for each cell line, we first centered LFCs using the median value of the set of non-essential genes, and then scaled LFCs using the median value of the set of essential genes. This enables normalized LFCs to be comparable across cell lines. For each gRNA, we then summarized gRNA activity by averaging LFCs across cell lines.</p>
      </sec>
      <sec id="Sec34">
        <title>Hart2015 dataset</title>
        <p id="Par82">Processed data from a genome-wide screen performed in HCT116 cells using the Toronto Knockout v1 (TKOv1) library<sup><xref ref-type="bibr" rid="CR99">99</xref></sup> were downloaded from <ext-link ext-link-type="uri" xlink:href="http://tko.ccbr.utoronto.ca/">http://tko.ccbr.utoronto.ca/</ext-link>. We computed LFCs between Day 18 and Day 0.</p>
      </sec>
      <sec id="Sec35">
        <title>Hart2017 dataset</title>
        <p id="Par83">Processed data from a genome-wide screen performed in HAP1 cells using the Toronto Knockout v3 (TKOv3) library<sup><xref ref-type="bibr" rid="CR100">100</xref></sup> were downloaded from <ext-link ext-link-type="uri" xlink:href="http://tko.ccbr.utoronto.ca/">http://tko.ccbr.utoronto.ca/</ext-link>. We obtained available LFCs between Day 18 and Day 0.</p>
      </sec>
      <sec id="Sec36">
        <title>Wang2015 dataset</title>
        <p id="Par84">Processed data from a genome-wide screen performed in K562 cells<sup><xref ref-type="bibr" rid="CR101">101</xref></sup> were obtained from the supplementary material of the original publication. LFCs were calculated between the final and initial timepoints.</p>
      </sec>
      <sec id="Sec37">
        <title>Tzelepis2016 dataset</title>
        <p id="Par85">Processed LFCs from a genome-wide screen performed in HL60 cells<sup><xref ref-type="bibr" rid="CR102">102</xref></sup> were obtained from the supplementary material of the original publication</p>
        <p id="Par86">LFCs for the Hart2015, Hart2017, Wang2015 and Tzelepis2016 were further standardized using the approach used for the Achilles dataset, with the same sets of non-essential and essential genes. For each dataset, gRNAs were mapped to the set of human protein-coding genes found in the Ensembl release 104, and unmapped gRNAs were filtered out. Given that gRNAs with multiple on- and off-targets can confound the analysis of fitness screens<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, we removed gRNAs that map to multiple loci in the GRCh38 genome, as well as gRNAs with 1- and 2-mismatch off-targets located in coding regions other than the intended target. The final numbers of gRNAs further considered for analysis are presented in Table <xref rid="Tab4" ref-type="table">4</xref>.</p>
      </sec>
    </sec>
    <sec id="Sec38">
      <title>Default gRNA rankings implemented in <italic>crisprDesign</italic></title>
      <p id="Par87">For each nuclease, we rank gRNAs based on several rounds of priority. For SpCas9, gRNAs with unique target sequences and without one- or two-mismatch off-targets located in coding regions are placed into the first round. Then, gRNAs with a small number of one- or two-mismatch off-targets (less than 5) are placed into the second round. Remaining gRNAs are placed into the third round. Finally, any gRNAs overlapping a common SNP (human only), containing a polyT stretch, or with extreme GC content (below 20% or above 80%) are placed into the fourth round. For CRISPRko applications, within each round of selection, gRNAs targeting the first 85% of the coding sequence of the canonical Ensembl isoform, as well as gRNAs targeting conserved regions (phyloP conservation score greater than 0), are prioritized first. gRNAs with the same priority are then ranked by a composite on-target activity rank to further prioritize active gRNAs. Based on the consistently reliable performance performance and generalization of the methods <italic>DeepHF</italic> and <italic>DeepSpCas9</italic><sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR45">45</xref>,<xref ref-type="bibr" rid="CR103">103</xref></sup>, the composite on-target activity rank is calculated by taking the average rank across the <italic>DeepHF</italic> and <italic>DeepSpCas9</italic> scores. For CRISPRa and CRISPRi applications, the CRISPRai on-target score is used instead of the composite score.</p>
      <p id="Par88">The process is identical for enAsCas12a, with the exception that the <italic>enPAM+GB</italic> method is used as the composite score given that it is the only method available for the enAsCas12a nuclease. For CasRx, gRNAs targeting at least 75% of the isoforms of a given gene, with no one- or two-mismatch off-targets, are placed into the first round. gRNAs targeting at least 50% of the isoforms of a given gene, with no one- or two-mismatch off-targets, are placed into the second round, and remaining gRNAs are placed into the third round. Finally, any gRNAs containing a polyT stretch, or with extreme GC content (below 20% or above 80%) are placed into the fourth round. Within each round of selection, gRNAs are further ranked by the <italic>CasRxRF</italic> on-target score, using the canonical Ensembl isoform for scoring.</p>
    </sec>
    <sec id="Sec39">
      <title>Generation of gRNA rankings from other tools</title>
      <p id="Par89">In addition to <italic>crisprDesign</italic>, we designed and ranked SpCas9 gRNAs for all human protein-coding (Ensembl release 104) using four additional tools. For <italic>CHOPCHOP</italic> (v3), we used the command line interface (CLI) available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/valenlab/chopchop">https://bitbucket.org/valenlab/chopchop</ext-link>with default parameters. For <italic>CCTop</italic> (v1.0.0), we used the CLI available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/juanlmateo/cctop_standalone">https://bitbucket.org/juanlmateo/cctop_standalone</ext-link>with default parameters. For <italic>FlashFry</italic> (v1.15), we used the CLI available at <ext-link ext-link-type="uri" xlink:href="https://github.com/mckennalab/FlashFry">https://github.com/mckennalab/FlashFry</ext-link>with default parameters. For <italic>CRISPick</italic>, due to the lack of a CLI, we submitted batch query jobs through the portal <ext-link ext-link-type="uri" xlink:href="https://portals.broadinstitute.org/gppx/crispick/public">https://portals.broadinstitute.org/gppx/crispick/public</ext-link>(accessed on July 27 2022) with default parameters for the Hsu (2013) tracrRNA sequence using the Rule Set 3.</p>
    </sec>
    <sec id="Sec40">
      <title>Criteria used to compare feature availability across gRNA design tools</title>
      <p id="Par90">The following gRNA design tools were used for comparison in Table <xref rid="Tab1" ref-type="table">1</xref>: <italic>multicrispr</italic> (v1.7.0), <italic>CRISPRseek</italic> (v1.37.2), <italic>CHOPCHOP</italic> (v3), <italic>CRISPOR</italic> (website v5.01), <italic>CCTop</italic> (v1.0.0), <italic>Guides</italic> (v1.0), <italic>Cas-Designer</italic> (v3.0), <italic>FlashFry</italic> (v1.15), <italic>E-CRISP</italic> (v5.4) and <italic>CRISPick</italic> (no version, accessed on July 27 2022). The criteria listed below were used for assessing feature availability.</p>
      <p id="Par91"><italic>Nuclease section</italic>: a check mark indicates support for the corresponding nuclease, and <italic>Limited</italic> indicates that only a subset of custom nucleases are available. <italic>Modalities</italic> section: a check mark indicates that the software offers at least one specific functionality for that modality. <italic>Target space section</italic>: for the <italic>Reference genomes</italic> row, a check mark indicates that the software supports gRNA design against reference genomes; for this row, <italic>Limited</italic> indicates that the versions of the reference genomes are outdated. For the <italic>Custom sequences</italic> row, a check mark indicates that the software supports the design of gRNAs targeting custom DNA sequences.</p>
      <p id="Par92">The <italic>Off-target aligner</italic> section indicates which alignment methods are available in each tool. The <italic>Off-target options</italic> section describes which off-target alignment functionalities are implemented: genomic coordinates of the off-targets are available to the user (<italic>Genomic coordinates</italic> row), off-target alignment to custom sequences (<italic>Custom sequences</italic> row), concurrent off-target alignment to multiple organisms (<italic>cross-reactivity</italic> row), and alignment to major or minor allele genomes (<italic>Minor/major alleles</italic> row). The <italic>On-target</italic> and <italic>Off-target</italic> scoring sections indicate which scoring methods are implemented in the software.</p>
      <p id="Par93">The <italic>Annotations</italic> section indicates whether or not users have access to several annotations in the gRNA outputs. <italic>Off-target annotation</italic> refers to gene context annotation of the off-targets; <italic>Isoform specification</italic> refers to information about which gene isoforms are targeted by a given gRNA; <italic>Reinitiation sites</italic> refers to gRNAs annotated as being upstream of potential reinitiation sites; <italic>Pfam domains</italic> refers to information about which Pfam domains are targeted by a given gRNA; <italic>SNP annotation</italic> refers to an annotation of gRNAs overlapping common SNPs; <italic>TSS annotation</italic> refers to whether or not gRNAs are annotated to fall into the promoter region of knows TSSs; <italic>Conservation</italic> refers to evolutionary conservation annotation.</p>
      <p id="Par94">The <italic>Library design</italic> section indicates which library design features are available in each of the tools. <italic>Restriction sites</italic> indicates whether or not gRNAs can be filtered for restriction sites of common enzymes. <italic>PolyT signal</italic> indicates if PolyT stretch filtering is available. <italic>GC content</italic> indicates filtering based on percentage GC content. <italic>Hairpin loops</italic> indicates filtering based on potential self-complementarity. <italic>Paired gRNAs</italic> indicates whether or not design of paired gRNAs is enabled. <italic>Ranking</italic> indicates if the software returns a gRNA rank for user selection.</p>
    </sec>
    <sec id="Sec41">
      <title>Figure generation</title>
      <p id="Par95">All figures were made in R (4.2.1), with the exception of the following figures that were made in Microsoft PowerPoint (v16.64): Fig. <xref rid="Fig1" ref-type="fig">1</xref>, Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, b, and the workflow diagrams of Figs. <xref rid="Fig4" ref-type="fig">4</xref>–<xref rid="Fig6" ref-type="fig">6</xref>. Figures <xref rid="Fig2" ref-type="fig">2</xref>c, <xref rid="Fig6" ref-type="fig">6</xref>b were made using the R package <italic>Gviz</italic> (v1.41.1). Figures <xref rid="Fig3" ref-type="fig">3</xref>–<xref rid="Fig5" ref-type="fig">5</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref> and Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref> were made using base plotting functions in R. Reproducible code to generate all figures can be found in our <ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/crisprVersePaper">GitHub manuscript repository</ext-link>.</p>
    </sec>
    <sec id="Sec42">
      <title>Reporting summary</title>
      <p id="Par96">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this article.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec43">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41467_2022_34320_MOESM1_ESM.pdf">
            <caption>
              <p>Supplementary Information</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41467_2022_34320_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41467_2022_34320_MOESM3_ESM.pdf">
            <caption>
              <p>Description of Additional Supplementary Files</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41467_2022_34320_MOESM4_ESM.pdf">
            <caption>
              <p>Peer Review File</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41467_2022_34320_MOESM5_ESM.zip">
            <caption>
              <p>Supplementary Software</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec44">
        <title>Source data</title>
        <p id="Par100">
          <media position="anchor" xlink:href="41467_2022_34320_MOESM6_ESM.xlsx" id="MOESM6">
            <caption>
              <p>Source Data</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p>The online version contains supplementary material available at 10.1038/s41467-022-34320-7.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Benjamin Haley, Mike Costa, Amy Heidersbach, Kristel Dorighi, Scott Martin, Rena Yang, Allison Vuong, Oleg Mayba, Sandra Melo Carlos, and Russell Xie for sharing their expertise with us and guiding the development of our software ecosystem. We also thank William Forrest, Maggie Crow, Hector Corrada Bravo, Michael Lawrence, and Benjamin Haley for providing invaluable feedback on the manuscript and software. We thank Nitesh Turaga, Lori Shepherd, Marcel Ramos, Helena Crowell and Kayla Morrell who kindly and thoroughly reviewed our R packages as part of the Bioconductor submission process.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.P.F. led the software development and supervised the work. J.P.F. conceptualized and wrote the manuscript, with contributions and input from all authors. L.H. and J.P.F. developed the R packages, with contributions from P.P. and A.L. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="peer-review">
    <title>Peer review</title>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par97"><italic>Nature Communications</italic> thanks Mario Looso and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. <xref rid="MOESM4" ref-type="media">Peer reviewer reports</xref> are available.</p>
    </sec>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>We deposited reprocessed chromatin accessibility data in K562 cells<sup><xref ref-type="bibr" rid="CR13">13</xref></sup> used by the CRISPRai on-target algorithm on Zenodo (10.5281/zenodo.6716721). We deposited fasta files, <italic>Bowtie</italic> indexes and <italic>BWA</italic> indexes for the major and minor alleles of hg38 using dbSNP151 on Zenodo (10.5281/zenodo.6862556). We precomputed and fully annotated gRNAs for human and mouse protein-coding genes using <italic>crisprDesign</italic> for the following nucleases: SpCas9, enAsCas12a, and CasRx. Ensembl release 104 and Ensembl release 102 were used to define genes for human and mouse, respectively. Separate datasets were generated for the CRISPRko, CRISPRa, CRISPRi, and CRISPRkd modalities. All files are available on Zenodo (10.5281/zenodo.7042164). CasRx FACS pooled screening data tiling CD55, CD46 and GFP<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> were obtained from <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/sanjanalab/cas13">https://gitlab.com/sanjanalab/cas13</ext-link>. Dropout screen data in the MelJuSo cell line using a gRNA library tiling BRCA1<sup><xref ref-type="bibr" rid="CR77">77</xref></sup> were obtained from <ext-link ext-link-type="uri" xlink:href="https://www.cell.com/cms/10.1016/j.cell.2021.01.012/attachment/98851720-ecfa-49fb-947b-6f4c8976cbc5/mmc2.xlsx">https://www.cell.com/cms/10.1016/j.cell.2021.01.012/attachment/98851720-ecfa-49fb-947b-6f4c8976cbc5/mmc2.xlsx</ext-link>. Common SNPs were obtained from NCBI dbSNP build 151 (<ext-link ext-link-type="uri" xlink:href="https://ftp.ncbi.nlm.nih.gov/snp/">https://ftp.ncbi.nlm.nih.gov/snp/</ext-link>). RIKEN/ENCODE CAGE peaks were obtained from AnnotationHub using accession number AH5084<sup><xref ref-type="bibr" rid="CR95">95</xref></sup>. DNAse I hypersensitive sites were obtained from AnnotationHub using accession number AH30743<sup><xref ref-type="bibr" rid="CR81">81</xref></sup>. Achilles screening data<sup><xref ref-type="bibr" rid="CR1">1</xref></sup> was obtained from the DepMap portal (<ext-link ext-link-type="uri" xlink:href="https://depmap.org/portal/download/all">https://depmap.org/portal/download/all</ext-link>). Hart2015<sup><xref ref-type="bibr" rid="CR99">99</xref></sup> and Hart2017<sup><xref ref-type="bibr" rid="CR100">100</xref></sup> datasets were obtained from <ext-link ext-link-type="uri" xlink:href="http://tko.ccbr.utoronto.ca/">http://tko.ccbr.utoronto.ca/</ext-link>. Wang2015 dataset<sup><xref ref-type="bibr" rid="CR101">101</xref></sup> was obtained from <ext-link ext-link-type="uri" xlink:href="https://www.science.org/doi/10.1126/science.aac7041">https://www.science.org/doi/10.1126/science.aac7041</ext-link>. Tzelepis2016 dataset<sup><xref ref-type="bibr" rid="CR102">102</xref></sup> was obtained from <ext-link ext-link-type="uri" xlink:href="https://pubmed.ncbi.nlm.nih.gov/27760321/">https://pubmed.ncbi.nlm.nih.gov/27760321/</ext-link>. <xref rid="Sec44" ref-type="sec">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>All crisprVerse packages are open-source and available on GitHub (Table <xref rid="Tab2" ref-type="table">2</xref>). At time of publication, all packages were accepted at Bioconductor and available on the development branch of Bioconductor. Because of its size, the data package <italic>crisprDesignData</italic> is hosted on GitHub only. Reproducible code of all analyses can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/crisprVersePaper">https://github.com/crisprVerse/crisprVersePaper</ext-link> and are archived on Zenodo (10.5281/zenodo.7217670). A list of extensive tutorials can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/Tutorials">https://github.com/crisprVerse/Tutorials</ext-link> and are archived on Zenodo (10.5281/zenodo.7212557). They can also be found in the <xref rid="MOESM5" ref-type="media">Supplementary Software file</xref>.</p>
    <p>The analyses included in this paper were produced using the following package versions:</p>
    <p><italic>crisprDesign</italic> (v0.99.178, 10.5281/zenodo.7217534) <italic>crisprScore</italic> (v1.1.17, 10.5281/zenodo.7217539) <italic>crisprScoreData</italic> (v1.1.4), 10.5281/zenodo.7212547) <italic>crisprBowtie</italic> (v1.1.2, 10.5281/zenodo.7217536) <italic>crisprBase</italic> (v1.1.8, 10.5281/zenodo.7217535) <italic>crisprVerse</italic> (v0.99.11, 10.5281/zenodo.7217532) <italic>crisprBwa</italic> (v1.1.5, 10.5281/zenodo.7217555) <italic>Rbwa</italic> (v1.1.1, 10.5281/zenodo.7212545) <italic>crisprDesignData</italic> (v0.99.24, 10.5281/zenodo.7212549) <italic>crisprViz</italic> (v0.99.23, 10.5281/zenodo.7217540</p>
    <p>We also offer a Docker container encapsulating the latest crisprVerse ecosystem on our DockerHub page (<ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/repository/docker/fortin946/crisprverse">https://hub.docker.com/repository/docker/fortin946/crisprverse</ext-link>. Documentation about the installation and usage of the container can be found at the following link: <ext-link ext-link-type="uri" xlink:href="https://github.com/crisprVerse/Docker">https://github.com/crisprVerse/Docker</ext-link>.</p>
  </notes>
  <notes id="FPar2" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par98">J.P.F. and A.L. declare that they are Genentech/Roche employees and declare that they hold Roche stocks. The remaining authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyers</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational correction of copy number effect improves specificity of CRISPR-Cas9 essentiality screens in cancer cells</article-title>
        <source>Nat. Genet.</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>1779</fpage>
        <lpage>1784</lpage>
        <?supplied-pmid 29083409?>
        <pub-id pub-id-type="pmid">29083409</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hart</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Improved analysis of CRISPR fitness screens and reduced off-target effects with the BAGEL2 gene essentiality classifier</article-title>
        <source>Genome Med.</source>
        <year>2021</year>
        <volume>13</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="pmid">33397400</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Chronos: a cell population dynamics model of CRISPR experiments that improves inference of gene fitness effects</article-title>
        <source>Genome Biol.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>1</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="pmid">33397451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allen</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Jacks: joint analysis of CRISPR/Cas9 knockout screens</article-title>
        <source>Genome Res.</source>
        <year>2019</year>
        <volume>29</volume>
        <fpage>464</fpage>
        <lpage>471</lpage>
        <?supplied-pmid 30674557?>
        <pub-id pub-id-type="pmid">30674557</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quality control, modeling, and visualization of CRISPR screens with MAGeCK-VISPR</article-title>
        <source>Genome Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="pmid">25583448</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doench</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimized SGRNA design to maximize activity and minimize off-target effects of CRISPR-Cas9</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>184</fpage>
        <?supplied-pmid 26780180?>
        <pub-id pub-id-type="pmid">26780180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doench</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Rational design of highly active sgrnas for CRISPR-Cas9–mediated gene inactivation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>1262</fpage>
        <?supplied-pmid 25184501?>
        <pub-id pub-id-type="pmid">25184501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doench</surname>
            <given-names>JG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimized sgrna design to maximize activity and minimize off-target effects of CRISPR-Cas9</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>184</fpage>
        <?supplied-pmid 26780180?>
        <pub-id pub-id-type="pmid">26780180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimized CRISPR guide RNA design for two high-fidelity Cas9 variants by deep learning</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>HK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep learning improves prediction of CRISPR–Cpf1 guide rna activity</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>239</fpage>
        <?supplied-pmid 29431740?>
        <pub-id pub-id-type="pmid">29431740</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation and design of genome-wide CRISPR/SpCas9 knockout screens</article-title>
        <source>G3: Genes Genomes Genet.</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>2719</fpage>
        <lpage>2727</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moreno-Mateos</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CRISPRscan: designing highly efficient sgRNAs for crispr-cas9 targeting in vivo</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>982</fpage>
        <lpage>988</lpage>
        <?supplied-pmid 26322839?>
        <pub-id pub-id-type="pmid">26322839</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Horlbeck</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Compact and highly active next-generation libraries for CRISPR-mediated gene repression and activation</article-title>
        <source>Elife</source>
        <year>2016</year>
        <volume>5</volume>
        <fpage>e19760</fpage>
        <?supplied-pmid 27661255?>
        <pub-id pub-id-type="pmid">27661255</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fortin</surname>
            <given-names>J-P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiple-gene targeting and mismatch tolerance can confound analysis of genome-wide pooled CRISPR screens</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>21</fpage>
        <?supplied-pmid 30683138?>
        <pub-id pub-id-type="pmid">30683138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scott</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Implications of human genetic variation in CRISPR-based therapeutic genome editing</article-title>
        <source>Nat. Med.</source>
        <year>2017</year>
        <volume>23</volume>
        <fpage>1095</fpage>
        <?supplied-pmid 28759051?>
        <pub-id pub-id-type="pmid">28759051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Lessard, S. et al. Human genetic variation alters CRISPR-Cas9 on-and off-targeting specificity at therapeutically implicated loci. <italic>Proc. Natl Acad. Sci.</italic><bold>114</bold>, E11257–66 (2017).</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Canver</surname>
            <given-names>MC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variant-aware saturating mutagenesis using multiple Cas9 nucleases identifies regulatory elements at trait-associated loci</article-title>
        <source>Nat. Genet.</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>625</fpage>
        <?supplied-pmid 28218758?>
        <pub-id pub-id-type="pmid">28218758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>TF</given-names>
          </name>
        </person-group>
        <article-title>Genetic variation may confound analysis of CRISPR-Cas9 off-target mutations</article-title>
        <source>Cell Discov.</source>
        <year>2018</year>
        <volume>4</volume>
        <fpage>18</fpage>
        <?supplied-pmid 29675267?>
        <pub-id pub-id-type="pmid">29675267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>JH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolved Cas9 variants with broad PAM compatibility and high DNA specificity</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>556</volume>
        <fpage>57</fpage>
        <lpage>63</lpage>
        <?supplied-pmid 29512652?>
        <pub-id pub-id-type="pmid">29512652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nishimasu</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Engineered CRISPR-Cas9 nuclease with expanded targeting space</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>361</volume>
        <fpage>1259</fpage>
        <lpage>1262</lpage>
        <?supplied-pmid 30166441?>
        <pub-id pub-id-type="pmid">30166441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walton</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Christie</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Whittaker</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Kleinstiver</surname>
            <given-names>BP</given-names>
          </name>
        </person-group>
        <article-title>Unconstrained genome targeting with near-pamless engineered CRISPR-Cas9 variants</article-title>
        <source>Science</source>
        <year>2020</year>
        <volume>368</volume>
        <fpage>290</fpage>
        <lpage>296</lpage>
        <?supplied-pmid 32217751?>
        <pub-id pub-id-type="pmid">32217751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">DeWeirdt, P. C. et al. Optimization of AsCas12a for combinatorial genetic screens in human cells. <italic>Nat. Biotechnol.</italic><bold>39</bold><italic>,</italic> 94–104 (2020).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shmakov</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Discovery and functional characterization of diverse class 2 CRISPR-Cas systems</article-title>
        <source>Mol. Cell</source>
        <year>2015</year>
        <volume>60</volume>
        <fpage>385</fpage>
        <lpage>397</lpage>
        <?supplied-pmid 26593719?>
        <pub-id pub-id-type="pmid">26593719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Abudayyeh, O. O. et al. C2c2 is a single-component programmable RNA-guided RNA-targeting CRISPR effector. <italic>Science</italic><bold>353</bold>, aaf5573 (2016).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Konermann</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome engineering with RNA-targeting type VI-D CRISPR effectors</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <fpage>665</fpage>
        <lpage>676</lpage>
        <?supplied-pmid 29551272?>
        <pub-id pub-id-type="pmid">29551272</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaudelli</surname>
            <given-names>NM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Programmable base editing of a* t to g* c in genomic dna without dna cleavage</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>551</volume>
        <fpage>464</fpage>
        <lpage>471</lpage>
        <?supplied-pmid 29160308?>
        <pub-id pub-id-type="pmid">29160308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Komor</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>YB</given-names>
          </name>
          <name>
            <surname>Packer</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Zuris</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Programmable editing of a target base in genomic DNA without double-stranded DNA cleavage</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>533</volume>
        <fpage>420</fpage>
        <lpage>424</lpage>
        <?supplied-pmid 27096365?>
        <pub-id pub-id-type="pmid">27096365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>DB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RNA editing with CRISPR-Cas13</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>358</volume>
        <fpage>1019</fpage>
        <lpage>1027</lpage>
        <?supplied-pmid 29070703?>
        <pub-id pub-id-type="pmid">29070703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feldman</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optical pooled screens in human cells</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>179</volume>
        <fpage>787</fpage>
        <lpage>799</lpage>
        <?supplied-pmid 31626775?>
        <pub-id pub-id-type="pmid">31626775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heigwer</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kerr</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>E-crisp: fast CRISPR target site identification</article-title>
        <source>Nat. Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>122</fpage>
        <lpage>123</lpage>
        <?supplied-pmid 24481216?>
        <pub-id pub-id-type="pmid">24481216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perez</surname>
            <given-names>AR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Guidescan software for improved single and paired CRISPR guide RNA design</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>347</fpage>
        <lpage>349</lpage>
        <?supplied-pmid 28263296?>
        <pub-id pub-id-type="pmid">28263296</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bae</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J-S</given-names>
          </name>
        </person-group>
        <article-title>Cas-offinder: a fast and versatile algorithm that searches for potential off-target sites of Cas9 RNA-guided endonucleases</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1473</fpage>
        <lpage>1475</lpage>
        <?supplied-pmid 24463181?>
        <pub-id pub-id-type="pmid">24463181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Montague</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Cruz</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Gagnon</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Valen</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Chopchop: a CRISPR/Cas9 and talen web tool for genome editing</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2014</year>
        <volume>42</volume>
        <fpage>W401</fpage>
        <lpage>W407</lpage>
        <?supplied-pmid 24861617?>
        <pub-id pub-id-type="pmid">24861617</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Concordet</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Haeussler</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Crispor: intuitive guide selection for CRISPR/Cas9 genome editing experiments and screens</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>W242</fpage>
        <lpage>W245</lpage>
        <?supplied-pmid 29762716?>
        <pub-id pub-id-type="pmid">29762716</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stemmer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thumberger</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>del Sol Keyer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wittbrodt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mateo</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>Cctop: an intuitive, flexible and reliable crispr/cas9 target prediction tool</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <fpage>e0124633</fpage>
        <?supplied-pmid 25909470?>
        <pub-id pub-id-type="pmid">25909470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shendure</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Flashfry: a fast and flexible tool for large-scale CRISPR target design</article-title>
        <source>BMC Biol.</source>
        <year>2018</year>
        <volume>16</volume>
        <fpage>1</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="pmid">29325545</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heigwer</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Crispr library designer (CLD): software for multispecies design of single guide rna libraries</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Bhagwat, A. M. et al. multicrispr: gRNA design for prime editing and parallel targeting of thousands of targets. <italic>Life Sci. Alliance</italic><bold>3</bold>, e202000757 (2020).</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Aronin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Brodsky</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Crisprseek: a bioconductor package to identify target-specific guide rnas for CRISPR-Cas9 genome-editing systems</article-title>
        <source>PLoS ONE</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>e108424</fpage>
        <?supplied-pmid 25247697?>
        <pub-id pub-id-type="pmid">25247697</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Orchestrating high-throughput genomic analysis with bioconductor</article-title>
        <source>Nat. Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>115</fpage>
        <lpage>121</lpage>
        <?supplied-pmid 25633503?>
        <pub-id pub-id-type="pmid">25633503</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meier</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sanjana</surname>
            <given-names>NE</given-names>
          </name>
        </person-group>
        <article-title>Guides: sgRNA design for loss-of-function screens</article-title>
        <source>Nat. Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>831</fpage>
        <lpage>832</lpage>
        <?supplied-pmid 28858339?>
        <pub-id pub-id-type="pmid">28858339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bae</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J-S</given-names>
          </name>
        </person-group>
        <article-title>Cas-designer: a web-based tool for choice of CRISPR-Cas9 target sites</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>4014</fpage>
        <lpage>4016</lpage>
        <?supplied-pmid 26358729?>
        <pub-id pub-id-type="pmid">26358729</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Software for computing and annotating genomic ranges</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003118</fpage>
        <?supplied-pmid 23950696?>
        <pub-id pub-id-type="pmid">23950696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>HK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spcas9 activity prediction by deepspcas9, a deep learning–based model with high generalization performance</article-title>
        <source>Sci. Adv.</source>
        <year>2019</year>
        <volume>5</volume>
        <fpage>eaax9249</fpage>
        <?supplied-pmid 31723604?>
        <pub-id pub-id-type="pmid">31723604</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel profiling and predictive modeling of the outcomes of crispr/cas9-mediated double-strand break repair</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>7989</fpage>
        <lpage>8003</lpage>
        <?supplied-pmid 31165867?>
        <pub-id pub-id-type="pmid">31165867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wessels</surname>
            <given-names>H-H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel Cas13 screens reveal principles for guide RNA design</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>722</fpage>
        <lpage>727</lpage>
        <?supplied-pmid 32518401?>
        <pub-id pub-id-type="pmid">32518401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Labuhn</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Refined sgRNA efficacy prediction improves large-and small-scale CRISPR-Cas9 applications</article-title>
        <source>Nucleic acids Res.</source>
        <year>2018</year>
        <volume>46</volume>
        <fpage>1375</fpage>
        <lpage>1385</lpage>
        <?supplied-pmid 29267886?>
        <pub-id pub-id-type="pmid">29267886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Lun, A. basilisk: Freezing Python dependencies inside bioconductor packages, R package version 1.3.5 (2021).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-frequency off-target mutagenesis induced by CRISPR-Cas nucleases in human cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>822</fpage>
        <lpage>826</lpage>
        <?supplied-pmid 23792628?>
        <pub-id pub-id-type="pmid">23792628</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsu</surname>
            <given-names>PD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dna targeting specificity of RNA-guided Cas9 nucleases</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>827</fpage>
        <lpage>832</lpage>
        <?supplied-pmid 23873081?>
        <pub-id pub-id-type="pmid">23873081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pattanayak</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-throughput profiling of off-target DNA cleavage reveals RNA-programmed cas9 nuclease specificity</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>839</fpage>
        <lpage>843</lpage>
        <?supplied-pmid 23934178?>
        <pub-id pub-id-type="pmid">23934178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Ultrafast and memory-efficient alignment of short dna sequences to the human genome</article-title>
        <source>Genome Biol.</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <?supplied-pmid 19261174?>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with burrows–wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aho</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Corasick</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Efficient string matching: an aid to bibliographic search</article-title>
        <source>Commun. ACM</source>
        <year>1975</year>
        <volume>18</volume>
        <fpage>333</fpage>
        <lpage>340</lpage>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pages</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aboyoun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>DebRoy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Biostrings: string objects representing biological sequences, and matching algorithms</article-title>
        <source>R. package version</source>
        <year>2016</year>
        <volume>2</volume>
        <fpage>10</fpage>
        <lpage>18129</lpage>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsu</surname>
            <given-names>PD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dna targeting specificity of RNA-guided cas9 nucleases</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>827</fpage>
        <?supplied-pmid 23873081?>
        <pub-id pub-id-type="pmid">23873081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smits</surname>
            <given-names>AH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biological plasticity rescues target activity in CRISPR knock outs</article-title>
        <source>Nat. Methods</source>
        <year>2019</year>
        <volume>16</volume>
        <fpage>1087</fpage>
        <lpage>1093</lpage>
        <?supplied-pmid 31659326?>
        <pub-id pub-id-type="pmid">31659326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cohen</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nonsense mutation-dependent reinitiation of translation in mammalian cells</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>6330</fpage>
        <lpage>6338</lpage>
        <?supplied-pmid 31045216?>
        <pub-id pub-id-type="pmid">31045216</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>De novo identification of essential protein domains from CRISPR-Cas9 tiling-sgrna knockout screens</article-title>
        <source>Nat. Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Pfam protein families database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>D138</fpage>
        <lpage>D141</lpage>
        <?supplied-pmid 14681378?>
        <pub-id pub-id-type="pmid">14681378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durinck</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Biomart and bioconductor: a powerful link between biological databases and microarray data analysis</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3439</fpage>
        <lpage>3440</lpage>
        <?supplied-pmid 16082012?>
        <pub-id pub-id-type="pmid">16082012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>rtracklayer: an r package for interfacing with genome browsers</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1841</fpage>
        <lpage>1842</lpage>
        <?supplied-pmid 19468054?>
        <pub-id pub-id-type="pmid">19468054</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <mixed-citation publication-type="other">Chen, C.-H. et al. Improved design and analysis of crispr knockout screens. <italic>Bioinformatics</italic><bold>34</bold>, 4095–4101 (2018).</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Sabatini</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Genetic screens in human cells using the CRISPR/Cas9 system</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>343</volume>
        <fpage>80</fpage>
        <lpage>84</lpage>
        <?supplied-pmid 24336569?>
        <pub-id pub-id-type="pmid">24336569</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gilbert</surname>
            <given-names>LA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-scale crispr-mediated control of gene repression and activation</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <fpage>647</fpage>
        <lpage>661</lpage>
        <?supplied-pmid 25307932?>
        <pub-id pub-id-type="pmid">25307932</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Veeneman</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Pincer: improved CRISPR/Cas9 screening by efficient cleavage at conserved residues</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2020</year>
        <volume>48</volume>
        <fpage>9462</fpage>
        <lpage>9477</lpage>
        <?supplied-pmid 32821942?>
        <pub-id pub-id-type="pmid">32821942</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thyme</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Akhmetova</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Montague</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Valen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
        </person-group>
        <article-title>Internal guide rna interactions interfere with cas9-mediated cleavage</article-title>
        <source>Nat. Commun.</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>11750</fpage>
        <?supplied-pmid 27282953?>
        <pub-id pub-id-type="pmid">27282953</pub-id>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Labun</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Montague</surname>
            <given-names>TG</given-names>
          </name>
          <name>
            <surname>Gagnon</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Thyme</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Valen</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Chopchop v2: a web tool for the next generation of CRISPR genome engineering</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>W272</fpage>
        <lpage>W276</lpage>
        <?supplied-pmid 27185894?>
        <pub-id pub-id-type="pmid">27185894</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <mixed-citation publication-type="other">Hahne, F. &amp; Ivanek, R. Visualizing genomic data using Gviz and bioconductor (Springer, 2016).</mixed-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Hubisz</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Rosenbloom</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Siepel</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Detection of nonneutral substitution rates on mammalian phylogenies</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>110</fpage>
        <lpage>121</lpage>
        <?supplied-pmid 19858363?>
        <pub-id pub-id-type="pmid">19858363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Sircoulomb</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Rottapel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Moffat</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Measuring error rates in genomic perturbation screens: gold standards for human functional genomics</article-title>
        <source>Mol. Syst. Biol.</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>733</fpage>
        <?supplied-pmid 24987113?>
        <pub-id pub-id-type="pmid">24987113</pub-id>
      </element-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schoonenberg</surname>
            <given-names>VA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Crispro: identification of functional protein coding sequences based on genome editing dense mutagenesis</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="pmid">29301551</pub-id>
      </element-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeWeirdt</surname>
            <given-names>PC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accounting for small variations in the tracrrna sequence improves sgrna activity predictions for crispr screening</article-title>
        <source>Nat. Commun.</source>
        <year>2022</year>
        <volume>13</volume>
        <fpage>5255</fpage>
        <?supplied-pmid 36068235?>
        <pub-id pub-id-type="pmid">36068235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arbab</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Determinants of base editing outcomes from target library analysis and machine learning</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>182</volume>
        <fpage>463</fpage>
        <lpage>480</lpage>
        <?supplied-pmid 32533916?>
        <pub-id pub-id-type="pmid">32533916</pub-id>
      </element-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koblan</surname>
            <given-names>LW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improving cytidine and adenine base editors by expression optimization and ancestral reconstruction</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>843</fpage>
        <lpage>846</lpage>
        <?supplied-pmid 29813047?>
        <pub-id pub-id-type="pmid">29813047</pub-id>
      </element-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hanna</surname>
            <given-names>RE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel assessment of human variants with base editor screens</article-title>
        <source>Cell</source>
        <year>2021</year>
        <volume>184</volume>
        <fpage>1064</fpage>
        <lpage>1080</lpage>
        <?supplied-pmid 33606977?>
        <pub-id pub-id-type="pmid">33606977</pub-id>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Findlay</surname>
            <given-names>GM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate classification of brca1 variants with saturation genome editing</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <fpage>217</fpage>
        <lpage>222</lpage>
        <?supplied-pmid 30209399?>
        <pub-id pub-id-type="pmid">30209399</pub-id>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Radzisheuskaya</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shlyueva</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Helin</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Optimizing sgrna position markedly improves the efficiency of crispr/dcas9-mediated transcriptional repression</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>e141</fpage>
        <lpage>e141</lpage>
        <?supplied-pmid 27353328?>
        <pub-id pub-id-type="pmid">27353328</pub-id>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanson</surname>
            <given-names>KR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Optimized libraries for CRISPR-Cas9 genetic screens with multiple modalities</article-title>
        <source>Nat. Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="pmid">29317637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kundaje</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative analysis of 111 reference human epigenomes</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>518</volume>
        <fpage>317</fpage>
        <lpage>330</lpage>
        <?supplied-pmid 25693563?>
        <pub-id pub-id-type="pmid">25693563</pub-id>
      </element-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuscu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Arslan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Thorpe</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Adli</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide analysis reveals characteristics of off-target sites bound by the Cas9 endonuclease</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>677</fpage>
        <lpage>683</lpage>
        <?supplied-pmid 24837660?>
        <pub-id pub-id-type="pmid">24837660</pub-id>
      </element-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide binding of the CRISPR endonuclease Cas9 in mammalian cells</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2014</year>
        <volume>32</volume>
        <fpage>670</fpage>
        <lpage>676</lpage>
        <?supplied-pmid 24752079?>
        <pub-id pub-id-type="pmid">24752079</pub-id>
      </element-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>SJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Crispri-based genome-scale identification of functional long noncoding RNA loci in human cells</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>355</volume>
        <fpage>eaah7111</fpage>
      </element-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <mixed-citation publication-type="other">Sangree, A. K. et al. Benchmarking of SpCas9 variants enables deeper base editor screens of BRCA1 and BCL2. <italic>Nat. Commun.</italic> 13, 1318 (2021).</mixed-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Labun</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate analysis of genuine CRISPR editing events with amplican</article-title>
        <source>Genome Res.</source>
        <year>2019</year>
        <volume>29</volume>
        <fpage>843</fpage>
        <lpage>847</lpage>
        <?supplied-pmid 30850374?>
        <pub-id pub-id-type="pmid">30850374</pub-id>
      </element-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>LJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Guideseq: a bioconductor package to analyze guide-seq datasets for CRISPR-Cas nucleases</article-title>
        <source>BMC Genomics</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="pmid">28049423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lindsay</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Crisprvariants charts the mutation spectrum of genome engineering experiments</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2016</year>
        <volume>34</volume>
        <fpage>701</fpage>
        <lpage>702</lpage>
        <?supplied-pmid 27404876?>
        <pub-id pub-id-type="pmid">27404876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrative analysis of pooled crispr genetic screens using MAGeCKFlute</article-title>
        <source>Nat. Protoc.</source>
        <year>2019</year>
        <volume>14</volume>
        <fpage>756</fpage>
        <lpage>780</lpage>
        <?supplied-pmid 30710114?>
        <pub-id pub-id-type="pmid">30710114</pub-id>
      </element-citation>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imkeller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ambrosi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Boutros</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>gscreend: modelling asymmetric count ratios in CRISPR screens to decrease experiment size and improve phenotype detection</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>1</fpage>
        <lpage>13</lpage>
      </element-citation>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <mixed-citation publication-type="other">Bainer, R., Ratman, D., Haverty, P. &amp; Lianoglou, S. gCrisprTools: suite of functions for pooled Crispr screen QC and analysis. R package version 2.0.0 (2021).</mixed-citation>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anzalone</surname>
            <given-names>AV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Search-and-replace genome editing without double-strand breaks or donor DNA</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>576</volume>
        <fpage>149</fpage>
        <lpage>157</lpage>
        <?supplied-pmid 31634902?>
        <pub-id pub-id-type="pmid">31634902</pub-id>
      </element-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Replogle</surname>
            <given-names>JM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Combinatorial single-cell CRISPR screens by direct guide RNA capture and targeted sequencing</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>954</fpage>
        <lpage>961</lpage>
        <?supplied-pmid 32231336?>
        <pub-id pub-id-type="pmid">32231336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <mixed-citation publication-type="other">Hahne, F., Lerch, A. &amp; Stadler, Rbowtie M.: A r wrapper for bowtie and splicemap short read aligners. URL <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/Rbowtie.html">http://bioconductor.org/packages/release/bioc/html/Rbowtie.html</ext-link> (2012).</mixed-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Djebali</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Landscape of transcription in human cells</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>101</fpage>
        <lpage>108</lpage>
        <?supplied-pmid 22955620?>
        <pub-id pub-id-type="pmid">22955620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR96">
      <label>96.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karolchik</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UCSC genome browser database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>51</fpage>
        <lpage>54</lpage>
        <?supplied-pmid 12519945?>
        <pub-id pub-id-type="pmid">12519945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR97">
      <label>97.</label>
      <mixed-citation publication-type="other">Fortin, J.-P. BSgenome.Hsapiens.UCSC.hg38.dbSNP151.major: Full genome sequences for Homo sapiens (UCSC version hg38, based on GRCh38.p12) with injected major alleles (dbSNP151). R package version 0.0.9999 (2021).</mixed-citation>
    </ref>
    <ref id="CR98">
      <label>98.</label>
      <mixed-citation publication-type="other">Fortin, J.-P. BSgenome.Hsapiens.UCSC.hg38.dbSNP151.minor: Full genome sequences for Homo sapiens (UCSC version hg38, based on GRCh38.p12) with injected minor alleles (dbSNP151). R package version 0.0.9999 (2021).</mixed-citation>
    </ref>
    <ref id="CR99">
      <label>99.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution crispr screens reveal fitness genes and genotype-specific cancer liabilities</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <fpage>1515</fpage>
        <lpage>1526</lpage>
        <?supplied-pmid 26627737?>
        <pub-id pub-id-type="pmid">26627737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR100">
      <label>100.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evaluation and design of genome-wide crispr/spcas9 knockout screens</article-title>
        <source>G3: Genes Genomes Genet.</source>
        <year>2017</year>
        <volume>7</volume>
        <fpage>2719</fpage>
        <lpage>2727</lpage>
      </element-citation>
    </ref>
    <ref id="CR101">
      <label>101.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification and characterization of essential genes in the human genome</article-title>
        <source>Science</source>
        <year>2015</year>
        <volume>350</volume>
        <fpage>1096</fpage>
        <lpage>1101</lpage>
        <?supplied-pmid 26472758?>
        <pub-id pub-id-type="pmid">26472758</pub-id>
      </element-citation>
    </ref>
    <ref id="CR102">
      <label>102.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tzelepis</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A crispr dropout screen identifies genetic vulnerabilities and therapeutic targets in acute myeloid leukemia</article-title>
        <source>Cell Rep.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>1193</fpage>
        <lpage>1205</lpage>
        <?supplied-pmid 27760321?>
        <pub-id pub-id-type="pmid">27760321</pub-id>
      </element-citation>
    </ref>
    <ref id="CR103">
      <label>103.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Konstantakos</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Nentidis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Krithara</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Paliouras</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Crispr–cas9 grna efficiency prediction: an overview of predictive tools and the role of deep learning</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2022</year>
        <volume>50</volume>
        <fpage>3616</fpage>
        <lpage>3637</lpage>
        <?supplied-pmid 35349718?>
        <pub-id pub-id-type="pmid">35349718</pub-id>
      </element-citation>
    </ref>
    <ref id="CR104">
      <label>104.</label>
      <mixed-citation publication-type="other">Fortin, J.-P. &amp; Lun, A. crisprScore: On-Target and Off-Target Scoring Algorithms for CRISPR gRNAs R package version 0.99.16. <ext-link ext-link-type="uri" xlink:href="https://github.com/Jfortin1/crisprScore/issues">https://github.com/Jfortin1/crisprScore/issues</ext-link> (2022).</mixed-citation>
    </ref>
  </ref-list>
</back>
