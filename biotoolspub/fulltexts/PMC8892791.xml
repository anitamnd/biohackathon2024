<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8892791</article-id>
    <article-id pub-id-type="publisher-id">4614</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-022-04614-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TADreg: a versatile regression framework for TAD identification, differential analysis and rearranged 3D genome prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Mourad</surname>
          <given-names>Raphaël</given-names>
        </name>
        <address>
          <email>raphael.mourad@univ-tlse3.fr</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.508721.9</institution-id><institution>CNRS, UPS, MCD, Centre de Biologie Intégrative (CBI), </institution><institution>University of Toulouse, </institution></institution-wrap>31062 Toulouse, France </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>2</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>82</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>2</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background/Aim</title>
        <p id="Par1">In higher eukaryotes, the three-dimensional (3D) organization of the genome is intimately related to numerous key biological functions including gene expression, DNA repair and DNA replication regulations. Alteration of 3D organization, in particular topologically associating domains (TADs), is detrimental to the organism and can give rise to a broad range of diseases such as cancers.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">Here, we propose a versatile regression framework which not only identifies TADs in a fast and accurate manner, but also detects differential TAD borders across conditions for which few methods exist, and predicts 3D genome reorganization after chromosomal rearrangement. Moreover, the framework is biologically meaningful, has an intuitive interpretation and is easy to visualize.</p>
      </sec>
      <sec>
        <title>Result and conclusion</title>
        <p id="Par3">The novel regression ranks among top TAD callers. Moreover, it identifies new features of the genome we called TAD facilitators, and that are enriched with specific transcription factors. It also unveils the importance of cell-type specific transcription factors in establishing novel TAD borders during neuronal differentiation. Lastly, it compares favorably with the state-of-the-art method for predicting rearranged 3D genome.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-022-04614-0.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Chromatin interaction</kwd>
      <kwd>Hi-C</kwd>
      <kwd>ChIP-seq</kwd>
      <kwd>Insulator binding protein</kwd>
      <kwd>Generalized linear model</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Introduction</title>
    <p id="Par4">In higher eukaryotes, chromosomes are packed into three dimensions (3Ds) and form complex structures [<xref ref-type="bibr" rid="CR1">1</xref>]. Such 3D structure of chromosomes has recently been investigated by chromosome conformation capture combined with high-throughput sequencing technique (Hi-C) at an unprecedented resolution [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. Hi-C experiments revealed multiple levels of genome organization including compartments A/B [<xref ref-type="bibr" rid="CR5">5</xref>] and topologically associating domains (TADs) [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. Most notably, TADs are relatively constant between different cell types and are highly conserved across species. Those TADs play central roles in key cell processes such as for the long-range regulation of genes by enhancers [<xref ref-type="bibr" rid="CR4">4</xref>] or for the replication-timing regulation [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
    <p id="Par5">Over the past years, tremendous efforts have been made to develop methods for TAD identification from Hi-C data [<xref ref-type="bibr" rid="CR7">7</xref>]. The methods can be broadly classified into 4 categories: linear score, statistical model, clustering and network features [<xref ref-type="bibr" rid="CR7">7</xref>]. The first methods split the genome into bins and define a linear score (insulation score) associated to each bin [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>]. The second methods rely on statistical models of the interaction distributions [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]. The third methods cluster regions of the genome [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>]. The fourth methods consider the Hi-C data as a graph adjacency matrix and TADs as communities to detect [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>]. However, very few methods were developed to detect differential TADs between experiments [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR22">22</xref>]. Moreover, few methods were also proposed to predict the impact of chromosomal rearrangement in reshaping TADs, and more generally the 3D genome [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR26">26</xref>].</p>
    <p id="Par6">We propose a versatile regression framework that generalizes the insulation score by estimating a relative score and adding a sparsity constrain (“Sparse Insulation Model”, SIM), but also allows differential TAD analysis (“Differential Insulation Model”, DIM) and Hi-C data prediction after chromosomal rearrangement (“Prediction Insulation Model”, PIM). The proposed model provides a rigorous statistical framework for modeling the interaction distribution, where model parameters represent sparse insulation scores that have an intuitive interpretation and are easy to visualize. Our model assumes additivity of insulation parameters as previously proposed by [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. By adding interaction terms into the model, the regression framework can naturally be used for differential TAD border identification between two different Hi-C experiments. Moreover, the regression can predict Hi-C data in the case of chromosomal rearrangements such as deletion and inversion, thereby allowing to explore the deleterious impact of de novo enhancer-promoter interactions on genetic diseases and cancers.</p>
    <p id="Par7">Using recent high resolution human and mouse Hi-C data, we found that our approach ranked among the top TAD callers, when evaluated using external assessment designed not to favor any tool. Moreover, it identified new features of the genome we called TAD facilitators, which were demonstrated to be biologically relevant. Our approach could also identify numerous novel TAD borders emerging during cortical neuron differentiation. Such borders were depleted in CTCF compared to embryonic stem cells and enriched in a large number of known neuronal transcription factors including NFATC1/3, NEUROD2, HiC1 and Dmbx1. Lastly, our approach outperformed state-of-the-art algorithm PRISMR to predict Hi-C data after chromosomal rearrangement.</p>
  </sec>
  <sec id="Sec2">
    <title>Materials and methods</title>
    <sec id="Sec3">
      <title>Hi-C data</title>
      <p id="Par8">We used publicly available Hi-C data of lymphoblastoid GM12878 and lung IMR90 cells from Gene Expression Omnibus (GEO) accession GSE63525 [<xref ref-type="bibr" rid="CR9">9</xref>]. We also used publicly available Hi-C data of mouse embryonic stem (ES) and cortical neuron (CN) cells from GEO accession GSE96107 [<xref ref-type="bibr" rid="CR29">29</xref>]. Hi-C data were binned at 25 and 50 kb resolutions and normalized by matrix balancing [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>Capture Hi-C data</title>
      <p id="Par9">We used publicly available capture Hi-C data of wild-type (WT) and mutant distal limb buds of E11.5 mice from Gene Expression Omnibus (GEO) accession GSE92294 [<xref ref-type="bibr" rid="CR23">23</xref>]. Hi-C data were binned at 10 kb resolution and normalized by matrix balancing [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    </sec>
    <sec id="Sec5">
      <title>ChIP-seq data</title>
      <p id="Par10">We used publicly available binding peaks of 73 chromatin proteins (Rad21, CTCF, YY1, ZBTB33, MAZ, JUND, ZNF143, EZH2, ATF2, ATF3, BATF, BCL11A, BCL3, BCLAF1, BHLHE40, BRCA1, CEBPB, CFOS, CHD1, CHD2, CMYC, COREST, E2F4, EBF1, EGR1, ELF1, ELK1, FOXM1, GABP, IKZF1, IRF4, MAX, MEF2C, MTA3, MXI1, NFATC1, NFE2, NFIC, NFKB, NFYA, NFYB, NRF1, NRSF, P300, PAX5, PBX3, PML, POL2, POL3, POU2F2, RFX5, RUNX3, RXRA, SIN3A, SIX5, SMC3, SP1, SPI1, SRF, STAT1, STAT3, STAT5, TBLR1, TBP, TCF12, TCF3, TR4, USF1, USF2, WHIP, ZEB1, ZNF274, ZZZ3) of GM12878 cells from ENCODE [<xref ref-type="bibr" rid="CR31">31</xref>]. We downloaded peaks that were uniformly processed (Uniform Peaks).</p>
      <p id="Par11">We also used publicly available CTCF ChIP-seq data of mouse embryonic stem (ES) and cortical neuron (CN) cells from GEO accession GSE96107 [<xref ref-type="bibr" rid="CR29">29</xref>].</p>
    </sec>
    <sec id="Sec6">
      <title>JASPAR motifs</title>
      <p id="Par12">To scan the mouse genome for motif occurrences, we used FIMO with default parameters (meme-suite.org). The motif position weight matrices were downloaded from JASPAR database (http://jaspar.genereg.net/).</p>
    </sec>
    <sec id="Sec7">
      <title>TAD manual annotation</title>
      <p id="Par13">We used manual annotation of GM12878 TADs at 50 kb from Dali and Blanchette [<xref ref-type="bibr" rid="CR32">32</xref>]. As previously described by Dali and Blanchette, TADs were manually traced on GM12878 Hi-C maps from the full data set at 50 kb resolution for regions 40-45 mb of 10 different, randomly chosen, chromosomes (chr2, chr3, chr4, chr5, chr6, chr7, chr12, chr18, chr20 and chr22). Briefly, interaction maps of the regions of interest were plotted using HiCplotter. In Adobe Illustrator, dotted squares were manually traced around visually identifiable TADs on the interaction map plots. Regions annotated as TADs had the following properties: (i) sharp visual contrast between within and across TAD interaction frequencies, over the entire TAD region; (ii) minimum size of 250 kb. To give all tools an equal chance, Dali and Blanchette created a dense set of TAD annotations that included any identifiable TAD structure. For example, if two potential TADs were overlapping, both were retained, irrespective of whether one had stronger visual support than the other. TAD boundaries were allowed to overlap or be nested, as long as there is a clearly traceable square along the diagonal. Bed files with TAD ranges were manually created and used for tool comparison.</p>
      <p id="Par14">Since <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$29\%$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mn>29</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq1.gif"/></alternatives></inline-formula> of genomic bins could be considered as relevant TAD borders using this annotation, we considered as TAD borders those supported by at least two TADs that were manually identified.</p>
    </sec>
    <sec id="Sec8">
      <title>Insulation score</title>
      <p id="Par15">For a bin <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \{1,...,p \}$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq2.gif"/></alternatives></inline-formula>, the insulation score was defined as [<xref ref-type="bibr" rid="CR8">8</xref>]:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} IS_i = \log _2 \left( \frac{M_i}{\frac{1}{p}\sum _{i=1}^p M_i} \right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>I</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>log</mml:mo><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4614_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M_i$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq3.gif"/></alternatives></inline-formula> was the number of Hi-C counts that occurred across bin <italic>i</italic> (up to some distance) on the same chromosome.</p>
    </sec>
    <sec id="Sec9">
      <title>Sparse insulation model (SIM)</title>
      <p id="Par16">We first removed the distance effect (polymer effect) from the normalized Hi-C counts using a generalized additive model with a negative binomial distribution:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \log \big ( \rm{E} \big [ \mathbf{y } | \mathbf{d } \big ] \big ) = \beta _0 + f(\mathbf{d }) \end{aligned}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="normal">f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4614_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Variable <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{y }$$\end{document}</tex-math><mml:math id="M12"><mml:mi mathvariant="bold">y</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq4.gif"/></alternatives></inline-formula> denoted normalized Hi-C count for any pair of bins on the same chromosome. The log-distance variable <bold>d</bold> accounted for the background polymer effect. The local power law decay relation between distance and Hi-C count was modeled by regression spline [<xref ref-type="bibr" rid="CR33">33</xref>]. We noted that if bias variables such as GC content, mappability and fragment length were added to the model [<xref ref-type="bibr" rid="CR34">34</xref>], then the model could also handle unnormalized Hi-C data. Regression residuals (noted <bold>z</bold>) were then used as input for a linear model. Using residuals allowed us to then use best subset selection (L0 penalty) for which there is only linear model implementation in R (see as follows).</p>
      <p id="Par17">Then, a linear model called the “sparse insulation model” (SIM) was proposed to estimate the insulating effects of genomic loci on long-range interactions:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \rm{E} \big [ \mathbf{z } | \mathbf{X } \big ] = \beta _0 + \mathbf{X } \varvec{\beta }_X \end{aligned}$$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4614_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>Variable set <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{X }=\{\mathbf{x }_1,...,\mathbf{x }_p \}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq5.gif"/></alternatives></inline-formula> represented the <italic>p</italic> insulation variables, one for each bin of the chromosome. For a bin <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \{1,...,p \}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq6.gif"/></alternatives></inline-formula>, the insulation variable <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{x }_i$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq7.gif"/></alternatives></inline-formula> was set to one when the bin lied in-between the two bins whose interaction counts were measured by Hi-C, and was set to zero otherwise. The corresponding <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{x_i}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>β</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq8.gif"/></alternatives></inline-formula> parameter value reflected the effect of the bin <italic>i</italic> on Hi-C counts. A negative beta value (<inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{x_i}&lt;0$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq9.gif"/></alternatives></inline-formula>) revealed an insulation effect on long-range contacts. Conversely, a positive beta value (<inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{x_i}&gt;0$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq10.gif"/></alternatives></inline-formula>) showed a facilitating effect on contacts. A null beta value (<inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{x_i}=0$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq11.gif"/></alternatives></inline-formula>) meant that the bin had no effect on contacts.</p>
      <p id="Par18">Best subset selection was used to select the best insulation variables when estimating the <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }_X$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>X</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq12.gif"/></alternatives></inline-formula> parameters by adding an L0 penalty:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \min _{\beta _0,\varvec{\beta }_X} \frac{1}{N} \sum _{j=1}^N l(z_j,\beta _0 + X_j \varvec{\beta }_X) + \uplambda ||\varvec{\beta }_X||_0 \end{aligned}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>l</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>X</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>X</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4614_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>as done using the L0Learn R package (https://cran.r-project.org/web/packages/L0Learn). Parameter <inline-formula id="IEq13"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uplambda$$\end{document}</tex-math><mml:math id="M34"><mml:mi mathvariant="normal">λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq13.gif"/></alternatives></inline-formula> was obtained by 10 fold cross-validation of the mean square error (L0Learn.cvfit function with default parameters).</p>
      <p id="Par19">Often the number of insulation variables was too big for L0Learn R package (&gt;5000) and we had to prefilter the variables. For this purpose, we used lasso regression (glmnet R package, https://cran.r-project.org/web/packages/glmnet/) and kept variables with <inline-formula id="IEq14"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\hat{\beta }}_{x_i}|&gt;0.2$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq14.gif"/></alternatives></inline-formula>. This allowed to reduce the number of variables to few thousands for L0Learn to work, while still keeping most relevant variables. We found that prefiltering yielded betas that were similar to the ones obtained without prefiltering (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1).</p>
    </sec>
    <sec id="Sec10">
      <title>Differential insulation model (DIM)</title>
      <p id="Par20">The model could be extended to identify differential TAD borders between two different Hi-C experiment matrices (<italic>e.g.</italic> between two conditions). For this purpose, we first ran SIM for each Hi-C experiment matrix independently. Only the union of bins with <inline-formula id="IEq15"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\hat{\beta }}_{x_i}|&gt;0$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq15.gif"/></alternatives></inline-formula> from both SIMs were kept for differential analysis (we noted the new bin set <inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{S }=\{\mathbf{s }_1,...,\mathbf{s }_q \}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi mathvariant="bold">s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">s</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq16.gif"/></alternatives></inline-formula>). To prevent bin uncertainty between experiments, only one bin was kept among two consecutive bins. Bins from <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{S }$$\end{document}</tex-math><mml:math id="M42"><mml:mi mathvariant="bold">S</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq17.gif"/></alternatives></inline-formula> were then used to build a novel model for differential analysis called the “differential insulation model” (DIM).</p>
      <p id="Par21">The differential insulation model was written as follows:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \rm{E} \big [ \mathbf{z } | \mathbf{S },\mathbf{e } \big ] = \beta _0 + \mathbf{S } \varvec{\beta }_S + \beta _e\mathbf{e } + \sum _{j=1}^q \beta _{s_{j}e}\mathbf{s }_j \mathbf{e } \end{aligned}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:mi mathvariant="bold">z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">e</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mi mathvariant="bold">e</mml:mi><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="normal">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">q</mml:mi></mml:munderover><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="bold">s</mml:mi><mml:mi mathvariant="normal">j</mml:mi></mml:msub><mml:mi mathvariant="bold">e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4614_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>Variable <inline-formula id="IEq18"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{e }$$\end{document}</tex-math><mml:math id="M46"><mml:mi mathvariant="bold">e</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq18.gif"/></alternatives></inline-formula> denoted the experiment from which the Hi-C count is measured. Variable <inline-formula id="IEq19"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{s }_j \mathbf{e }$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi mathvariant="bold">s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi mathvariant="bold">e</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq19.gif"/></alternatives></inline-formula> was the interaction term between the insulation variable <inline-formula id="IEq20"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{s }_j$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi mathvariant="bold">s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq20.gif"/></alternatives></inline-formula> and the experiment variable <inline-formula id="IEq21"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{e }$$\end{document}</tex-math><mml:math id="M52"><mml:mi mathvariant="bold">e</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq21.gif"/></alternatives></inline-formula>, computed as the product between both variables. For a bin <italic>j</italic>, a negative beta value (<inline-formula id="IEq22"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{s_{j}e}&lt;0$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq22.gif"/></alternatives></inline-formula>) revealed higher insulation effect on long-range contacts for the 2nd experiment compared to the 1st experiment, while a positive value (<inline-formula id="IEq23"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{s_{j}e}&gt;0$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq23.gif"/></alternatives></inline-formula>) meant lower insulation effect. A null value (<inline-formula id="IEq24"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{s_{j}e}=0$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq24.gif"/></alternatives></inline-formula>) showed no differential effect. Because the model used as input only bins previously identified by the sparse insulation model, there was no need to use any penalty for parameter estimation. Moreover, the absence of a penalty term allowed to estimate differential effects without bias.</p>
    </sec>
    <sec id="Sec11">
      <title>Prediction insulation model (PIM)</title>
      <p id="Par22">The model could be modified to predict Hi-C data, which we called the “prediction insulation model” (PIM). For this purpose, we modeled the Hi-C count by a generalized linear model (Poisson regression):<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \log \big ( \rm{E} \big [ \mathbf{y } | \mathbf{d },\mathbf{X } \big ] \big ) = \beta _0 + \beta _d\mathbf{d } + \mathbf{X } \varvec{\beta }_X \end{aligned}$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">[</mml:mo></mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">d</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">]</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:msub><mml:mi mathvariant="bold">d</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2022_4614_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>Here, since we didn’t need to identify sharply the borders with L0 penalty, we could use directly the Poisson regression. PIM could be used to predict Hi-C data after chromosomal rearrangement. For this purpose, PIM was first trained using wild-type Hi-C data (no rearrangement). Then, the distance variable (<inline-formula id="IEq25"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{d }$$\end{document}</tex-math><mml:math id="M62"><mml:mi mathvariant="bold">d</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq25.gif"/></alternatives></inline-formula>) and the insulation variables (<inline-formula id="IEq26"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{X }$$\end{document}</tex-math><mml:math id="M64"><mml:mi mathvariant="bold">X</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq26.gif"/></alternatives></inline-formula>) were modified in a way to account for the chromosomal rearrangement. In the case of a deletion, the distance variable values were shrunk by the length of the deletion (producing a new distance variable noted <inline-formula id="IEq27"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{d }'$$\end{document}</tex-math><mml:math id="M66"><mml:msup><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq27.gif"/></alternatives></inline-formula>), and all insulation variables spanning the deletion were set to zero (producing new insulation variables <inline-formula id="IEq28"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{X }'$$\end{document}</tex-math><mml:math id="M68"><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq28.gif"/></alternatives></inline-formula>). In the case of an inversion, bins spanning the inversion were flipped and the distance variable and insulation variables were recomputed accordingly. The new variables (<inline-formula id="IEq29"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{d }'$$\end{document}</tex-math><mml:math id="M70"><mml:msup><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{X }'$$\end{document}</tex-math><mml:math id="M72"><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq30.gif"/></alternatives></inline-formula>) together with the trained PIM model (with parameters <inline-formula id="IEq31"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }}_0$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq31.gif"/></alternatives></inline-formula>, <inline-formula id="IEq32"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }}_d$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq32.gif"/></alternatives></inline-formula> and <inline-formula id="IEq33"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\beta }}_X$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>X</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq33.gif"/></alternatives></inline-formula>) were used to predict Hi-C data after rearrangement:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log ({\text{E}}[{\mathbf{y}}{\text{|}}{\mathbf{d^{\prime}}},{\mathbf{X^{\prime}}}]) = \hat{\beta }_{{\text{0}}} {\text{ + }}\hat{\beta }_{{\text{d}}} {\mathbf{d^{\prime}}} + {\mathbf{X^{\prime}}} \hat{\varvec{\beta }}_X$$\end{document}</tex-math><mml:math id="M80" display="block"><mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>E</mml:mtext><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mtext>|</mml:mtext><mml:msup><mml:mi mathvariant="bold">d</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>0</mml:mtext></mml:msub><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>+</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mtext>d</mml:mtext></mml:msub><mml:msup><mml:mi mathvariant="bold">d</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:math><graphic xlink:href="12859_2022_4614_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Results and discussion</title>
    <sec id="Sec13">
      <title>Identification of TAD borders and facilitators</title>
      <p id="Par23">
        <fig id="Fig1">
          <label>Fig. 1</label>
          <caption>
            <p>Illustration of the sparse insulation model (SIM) and identification of TAD borders and facilitators. <bold>A</bold> Schema representing the insulation effects modeled by SIM on long-range contacts between two bins (two loci), such as between an enhancer and a promoter. <bold>B</bold> Hi-C heatmap from IMR90 cells at 25 kb resolution. <bold>C</bold> Insulation score. <bold>D</bold> SIM beta (no penalty). <bold>E</bold> SIM beta (L0 penalty). <bold>F</bold> CTCF enrichment profile depending on border strength (beta). <bold>G</bold> DNA binding protein enrichment compared to background for several proteins at TAD borders identified by our model (negative betas) depending on protein abundance. <bold>H</bold> DNA binding protein enrichment compared to background for several proteins at TAD facilitators identified by our model (positive betas) depending on protein abundance</p>
          </caption>
          <graphic xlink:href="12859_2022_4614_Fig1_HTML" id="MO8"/>
        </fig>
      </p>
      <p id="Par24">We proposed the sparse insulation model (SIM) to estimate the insulating/facilitating effects of genomic loci on long-range interactions (Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). SIM required only one parameter, the maximal distance between two bins from the Hi-C matrix, which we set here to bin size <inline-formula id="IEq34"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\times 10$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mo>×</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq34.gif"/></alternatives></inline-formula> in order to reduce computational burden. We illustrated the model with high-depth Hi-C data at 25 kb resolution from human IMR90 lung cells, whose TADs could be easily visualized. We plotted the example of a 10-Mb-long genomic region of chromosome 1 (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). We first computed the insulation score (IS) to identify loci of high insulation. The insulation score is a standard measure reflecting the aggregate of interactions occurring across each interval. It is often used by experimentalists because of its simple and quantitative interpretation: the lower, the higher the insulation effect of the loci on overlapping contacts [<xref ref-type="bibr" rid="CR8">8</xref>]. We observed peaks of negative IS, reflecting the presence of TAD borders with varying strengths (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C). Alternatively, IS also revealed regions facilitating long-range contacts (score above zero).</p>
      <p id="Par25">Using SIM, we estimated instead sparse insulation scores (beta parameters). For a bin <italic>i</italic>, the <inline-formula id="IEq35"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{x_i}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mi>β</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq35.gif"/></alternatives></inline-formula> parameter has a nice and intuitive interpretation: it is the insulation score, after accounting for the insulating/facilitating effects of the other bins. If no penalty is used to learn beta parameters, the betas correspond to a relative score (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). Using this relative score, we observed sharp peaks instead of wide valleys with the standard IS which prevented accurate location of TAD borders. Moreover, if an L0 penalty is used, then the regression leads to a sparse estimation of the insulation score. This helped to identify the exact location of bins with insulating/facilitating effects (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E), in contrast to IS. In SIM, a negative beta value (<inline-formula id="IEq36"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{x_i}&lt;0$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq36.gif"/></alternatives></inline-formula>) reveals an insulation effect on long-range contacts (the bin is an insulator). Conversely, a positive beta value (<inline-formula id="IEq37"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{x_i}&gt;0$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq37.gif"/></alternatives></inline-formula>) shows a facilitating effect on contacts (the bin is a facilitator). A null beta value (<inline-formula id="IEq38"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta _{x_i}=0$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq38.gif"/></alternatives></inline-formula>) means that the bin has no effect on contacts.</p>
      <p id="Par26">In the genomic region, SIM could detect ten TAD borders (<inline-formula id="IEq39"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }}&lt;0$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq39.gif"/></alternatives></inline-formula>). Using SIM, TADs could be simply defined as regions in-between two consecutive TAD borders. Visual inspection of the Hi-C matrix clearly revealed that our TAD identification was relevant (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). Moreover, SIM could identify TAD borders with varying strengths. We found three strong TAD borders (<inline-formula id="IEq40"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }} &lt; -2$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>&lt;</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq40.gif"/></alternatives></inline-formula>; red arrows), five moderate TAD borders (<inline-formula id="IEq41"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1.2&lt; {\hat{\beta }} &lt; -2$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1.2</mml:mn><mml:mo>&lt;</mml:mo><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>&lt;</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq41.gif"/></alternatives></inline-formula>; orange arrows) and two weak TAD borders (<inline-formula id="IEq42"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }} \approx -1.1$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>≈</mml:mo><mml:mo>-</mml:mo><mml:mn>1.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq42.gif"/></alternatives></inline-formula>; yellow arrows). Moreover, the model uncovered one region with facilitating effects (<inline-formula id="IEq43"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }}&gt;0$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq43.gif"/></alternatives></inline-formula>; blue arrow).</p>
      <p id="Par27">We then looked at the enrichment of the CTCF protein, a major 3D genome organizer, at TAD borders over the whole genome depending on the beta value. Here, we used GM12878 Hi-C data for which there are ChIP-seq data for a very large number of proteins, which helped us to comprehensively assess the role of DNA-binding proteins (see bellow). Overall, we found a strong two-fold enrichment of CTCF at TAD borders (Fig. <xref rid="Fig1" ref-type="fig">1</xref>F). Moreover, we observed that stronger TAD borders presented higher CTCF enrichment (2-fold for <inline-formula id="IEq44"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }} &lt; -0.5$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>&lt;</mml:mo><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq44.gif"/></alternatives></inline-formula>; 2.2-fold for <inline-formula id="IEq45"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }} &lt; -1.5$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>&lt;</mml:mo><mml:mo>-</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq45.gif"/></alternatives></inline-formula>), meaning that border strength estimated by SIM scaled accordingly with CTCF presence. Then, we evaluated enrichment for all available protein binding ChIP-seq data, and observed as previously shown the highest enrichments for CTCF, RAD21, SMC3, ZNF143, YY1 and POL2 (Fig. <xref rid="Fig1" ref-type="fig">1</xref>G) [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR36">36</xref>]. SIM could also identify regions facilitating contacts <italic>e.g.</italic> regions with <inline-formula id="IEq46"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }}&gt;0$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq46.gif"/></alternatives></inline-formula> (we called “TAD facilitators”), unlike most TAD detection tools. IS could also detect facilitators, but without accurate location, thereby preventing enrichment analysis. Using SIM, we found that lymphocyte transcription factors (TFs) BATF, EBF1, NFIC, RUNX3 and SPI1 were enriched at such facilitator regions (Fig. <xref rid="Fig1" ref-type="fig">1</xref>H). Such high enrichment revealed that TAD facilitators were indeed biologically meaningful regions.</p>
      <p id="Par28">Thus, we could conclude that SIM had an intuitive interpretation in terms of insulating/facilitating quantitative effects, which could also sharply identify TAD borders unlike the insulation score. Moreover, our model could accurately identify a novel class of 3D elements that we called TAD facilitators, which were highly enriched in cell specific TFs.</p>
    </sec>
    <sec id="Sec14">
      <title>Performance and comparison with state-of-the-art tools</title>
      <p id="Par29">
        <fig id="Fig2">
          <label>Fig. 2</label>
          <caption>
            <p>Comparison with existing TAD calling methods using GM12878 Hi-C dataset. <bold>A</bold> Number of TAD borders called by each method (50 kb resolution). <bold>B</bold> TAD border prediction concordance with manual annotation from [<xref ref-type="bibr" rid="CR32">32</xref>] (50 kb). <bold>C</bold> TAD border prediction concordance between methods (50 kb). <bold>D</bold> TAD border prediction concordance between methods (25 kb)</p>
          </caption>
          <graphic xlink:href="12859_2022_4614_Fig2_HTML" id="MO9"/>
        </fig>
      </p>
      <p id="Par30">SIM was very accurate to identify TAD borders. We compared it to 7 other algorithms including Armatus, Arrowhead, DomainCaller, TADbit, TADtree, TopDom, HiCseg using human GM12878 Hi-C data as from [<xref ref-type="bibr" rid="CR32">32</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). At both 25 kb and 50 kb, SIM identified a small number of TAD borders (2691 and 2711, respectively), such as HiCSeg (2835 and 2835, respectively) and TopDom (2738 and 2568, respectively) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). Conversely, Armatus identified much more TAD borders (7567 and 4265, respectively) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). Overall, we found that the number of borders identified by SIM (as well as HiCseg and TopDom) was only slightly impacted by Hi-C data resolution, unlike for the other algorithms. We also compared the TAD borders identified by SIM for different normalizations of the Hi-C data (Knight-Ruiz (KR) [<xref ref-type="bibr" rid="CR30">30</xref>], iterative correction and eigenvector decomposition (ICE) [<xref ref-type="bibr" rid="CR37">37</xref>] and square root vanilla coverage (VC SQRT) [<xref ref-type="bibr" rid="CR38">38</xref>]), and globally found similar results at 50 kb resolution (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). We then compared TAD border prediction concordance with manual annotation of TADs at 50 kb from [<xref ref-type="bibr" rid="CR32">32</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). These manually annotated TADs represented an external assessment which was designed not to favor any tool. We found that <inline-formula id="IEq47"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$58.5\%$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mn>58.5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq47.gif"/></alternatives></inline-formula> of borders predicted by SIM were also found by manual annotation, which ranked first SIM. Moreover, SIM was able to detect <inline-formula id="IEq48"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$24.2\%$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mn>24.2</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq48.gif"/></alternatives></inline-formula> of manually annotated borders. In comparison, the large numbers of TAD borders detected by Armatus (&gt;4000 at 50 kb) or TADbit (&gt;3500 at 50 kb) were proportionally less confirmed by manual annotation (<inline-formula id="IEq49"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$34.6\%$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mn>34.6</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq49.gif"/></alternatives></inline-formula> and <inline-formula id="IEq50"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$46.9\%$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mn>46.9</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq50.gif"/></alternatives></inline-formula>, respectively).</p>
      <p id="Par31">We then assessed TAD border prediction concordance between the different tools. At 50 kb, <inline-formula id="IEq51"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$82.8\%$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mn>82.8</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq51.gif"/></alternatives></inline-formula> of borders detected by SIM were also identified by the other tools, and <inline-formula id="IEq52"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$35.2\%$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mn>35.2</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq52.gif"/></alternatives></inline-formula> of other tools’ borders were called by SIM, which was similar to the top tools, HiCSeg and TopDom (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C). At 25 kb, <inline-formula id="IEq53"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$76.5\%$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mn>76.5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq53.gif"/></alternatives></inline-formula> of borders detected by SIM were also identified by the other tools, and <inline-formula id="IEq54"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$21.4\%$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mn>21.4</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq54.gif"/></alternatives></inline-formula> of other tools’ borders were called by SIM, which was similar to HiCSeg, TopDom and DomainCaller (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D). Thus, SIM ranked among the best tools to predict TAD border. Meanwhile, SIM was relatively fast and memory efficient. For chromosome 1 with 25 kb resolution and considering a maximal distance of 250 kb, SIM ran in only 151 seconds for one core and around 6.9 Gb.</p>
    </sec>
    <sec id="Sec15">
      <title>Identification of novel borders during cell differentiation</title>
      <p id="Par32">The 3D genome is dynamic, especially during the developmental process, and global reorganization was previously reported during differentiation [<xref ref-type="bibr" rid="CR29">29</xref>]. However, very few methods were developed for differential analysis of TADs [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. Using our versatile regression framework, we could easily implement differential TAD analysis in order to identify novel TAD borders, or alternatively depleted TAD borders, during cell differentiation. For this purpose, interaction terms were added in the model to account for differential insulation effects depending on the cell type. We called this model the differential insulation model (DIM). The corresponding interaction betas were then used to assess differential TAD border strength.</p>
      <p id="Par33">To illustrate differential analysis, we studied mouse embryonic stem cells (ESs) differentiation into cortical neurons (CNs) using ultra-deep coverage Hi-C, where novel TAD borders were shown to colocalize with developmental genes that were activated [<xref ref-type="bibr" rid="CR29">29</xref>]. We first focused on a 5-Mb-long genomic region of chromosome 18 around the developmental gene <italic>Zfp608</italic>. In ES cells, we observed a big TAD in the middle of the Hi-C map (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A, C). In CN cells, this big TAD was split into two new TADs separated by a novel border located at 55 Mb overlapping the gene <italic>Zfp608</italic> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B, D). Using the two Hi-C maps, DIM accordingly identified a strong and significant differential TAD border at 55 Mb (<inline-formula id="IEq55"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }} \approx -1.8$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>≈</mml:mo><mml:mo>-</mml:mo><mml:mn>1.8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq55.gif"/></alternatives></inline-formula>, <inline-formula id="IEq56"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p&lt;10^{-70}$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq56.gif"/></alternatives></inline-formula>; blue arrow; Fig. <xref rid="Fig3" ref-type="fig">3</xref>E), reflecting TAD split during differentiation. Moreover, DIM could also reveal less obvious differences in border strength. In particular, DIM detected two smaller differential TAD borders (<inline-formula id="IEq57"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }}&lt;1.2$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>&lt;</mml:mo><mml:mn>1.2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq57.gif"/></alternatives></inline-formula>, <inline-formula id="IEq58"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p&lt;10^{-8}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq58.gif"/></alternatives></inline-formula>; red arrows), which corresponded to borders present in ES cells and lost in CN cells.<fig id="Fig3"><label>Fig. 3</label><caption><p>Differential analysis of TAD borders with the Differential Insulation Model (DIM). <bold>A</bold> Hi-C heatmap in mouse embryonic stem (ES) cells. <bold>B</bold> Corresponding Hi-C heatmap in cortical neuron (CN) cells. <bold>C</bold> Identification of TAD borders in ES cells (spase insulation model beta is plotted). <bold>D</bold> Identification of TAD borders in CN cells (spase insulation model beta is plotted). <bold>E</bold> Identification of differential TAD borders (DIM beta is plotted). For each beta, an adjusted <italic>p</italic>-value is plotted to show significance. <bold>F</bold> Number of cell-type specific borders, for varying differential border strengths. <bold>G</bold> Absolute value of beta between CN specific borders and ES specific borders. <bold>H</bold> CTCF enrichment at CN specific borders compared to ES specific borders. <bold>I</bold> DNA-binding protein motif enrichment (fold-change) at CN specific borders. <bold>J</bold> DNA-binding protein motif enrichment (fold-change) at ES specific borders</p></caption><graphic xlink:href="12859_2022_4614_Fig3_HTML" id="MO10"/></fig></p>
      <p id="Par34">We then ran differential analysis by DIM genome-wide. We observed a higher number of TAD borders after differentiation (fold-change = 1.1; Fig. <xref rid="Fig3" ref-type="fig">3</xref>F, left), meaning that new TADs were created after differentiation. If we only considered strong TAD borders, we observed an even larger number of TAD borders after differentiation (fold-change = 1.51 for abs(beta)<inline-formula id="IEq59"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;1$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq59.gif"/></alternatives></inline-formula>; fold-change = 2.82 for abs(beta) <inline-formula id="IEq60"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;1.5$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq60.gif"/></alternatives></inline-formula>). Moreover, the absolute values of DIM betas in CN were significantly higher than in ES (fold-change = 1.11, <italic>p</italic>-value = 0.01; Fig. <xref rid="Fig3" ref-type="fig">3</xref>G), suggesting that those new TADs were particularly strong and insulated. We then compared CTCF enrichment at CN-specific borders and ES-specific borders (Fig. <xref rid="Fig3" ref-type="fig">3</xref>H). We found that although CTCF was very enriched at ES borders (fold-change = 1.64), it was far less enriched at CN borders (fold-change = 1.07), suggesting that the novel TAD borders were maintained by other factors than CTCF. It was previously showed that novel TAD borders located to neural transcription factors Pax6, NeuroD2, and Tbr1 [<xref ref-type="bibr" rid="CR29">29</xref>]. However, their analysis was limited by available ChIP-seq data. Here, instead, we systematically assessed the enrichment of 579 protein binding DNA motifs at novel CN borders (Fig. <xref rid="Fig3" ref-type="fig">3</xref>I). We found a tremendous amount of motifs enriched at novel borders. All enriched motifs were known neural TFs, including Foxd3, NFATC3, NEUROD2, HiC1, Dmbx1, Hmx2 and NFATC1. This result suggested that chromatin was reorganized due to not only Pax6, NeuroD2, and Tbr1, but also to numerous other TFs involved in neural differentiation. In comparison, ES borders were strongly enriched in known stem cell TFs, such as Hoxb5, EMX2, PAX4. Thus, we could conclude that cell type specific TFs played a major role in reshaping the genome in 3D during differentiation.</p>
    </sec>
    <sec id="Sec16">
      <title>Predictions of Hi-C data after chromosomal rearrangements</title>
      <p id="Par35">Our versatile regression framework could also be used to faithfully model the 3D genome and predict Hi-C data. In particular, predicting the effects of chromosomal rearrangement on 3D genome is an important challenge, since 3D genome alteration can impact essential cellular processes such as enhancer-promoter transcriptional regulation. However, until now, only few methods were developed for this task. Hence, we assessed the ability of the model to predict Hi-C data after chromosomal rearrangement. In this case, we called this model the prediction insulation model (PIM). For this purpose, PIM was trained on wild-type (WT) Hi-C data, producing a model with parameters <inline-formula id="IEq61"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }}_0$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq61.gif"/></alternatives></inline-formula>, <inline-formula id="IEq62"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }}_d$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq62.gif"/></alternatives></inline-formula> and <inline-formula id="IEq63"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\varvec{\beta }}_X$$\end{document}</tex-math><mml:math id="M140"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>X</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq63.gif"/></alternatives></inline-formula>. Then, in the PIM model, the distance variable (<inline-formula id="IEq64"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{d }$$\end{document}</tex-math><mml:math id="M142"><mml:mi mathvariant="bold">d</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq64.gif"/></alternatives></inline-formula>) and the insulation variables (<inline-formula id="IEq65"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{X }$$\end{document}</tex-math><mml:math id="M144"><mml:mi mathvariant="bold">X</mml:mi></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq65.gif"/></alternatives></inline-formula>) were modified in a way to account for the chromosomal rearrangement. For instance, in the case of a deletion, the distance variable values were shrunk by the length of the deletion (producing a new distance variable noted <inline-formula id="IEq66"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{d }'$$\end{document}</tex-math><mml:math id="M146"><mml:msup><mml:mrow><mml:mi mathvariant="bold">d</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq66.gif"/></alternatives></inline-formula>), and all insulation variables spanning the deletion were set to zero (producing new insulation variables <inline-formula id="IEq67"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{X }'$$\end{document}</tex-math><mml:math id="M148"><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq67.gif"/></alternatives></inline-formula>). The new variables together with the trained PIM model were used to predict Hi-C after deletion.<fig id="Fig4"><label>Fig. 4</label><caption><p>Prediction insulation model (PIM) predicts rearranged 3D genome with high accurary and comparison with PRISMR using mouse data from [<xref ref-type="bibr" rid="CR23">23</xref>]. Models were trained using wild-type Hi-C data to predict rearranged Hi-C data (for PRISMR, we used predictions provided by the authors). <bold>A</bold> PIM prediction for DelB/DelB genotype and comparison with observed data. <bold>B</bold> PRISMR prediction for DelB/DelB genotype. <bold>C</bold> PIM prediction for DelBs/DelBs genotype and comparison with observed data. <bold>D</bold> PRISMR prediction for DelBs/DelBs genotype. <bold>E</bold> PIM prediction for InvF/InvF genotype and comparison with observed data. <bold>F</bold> PRISMR prediction for InvF/InvF genotype</p></caption><graphic xlink:href="12859_2022_4614_Fig4_HTML" id="MO11"/></fig></p>
      <p id="Par36">PIM prediction accuracy was assessed using 10 kb resolution capture Hi-C experiments performed in E11.5 limb buds from WT and mutant mouses with a deletion or an inversion [<xref ref-type="bibr" rid="CR23">23</xref>]. For the DelB/DelB mutant (homozygous deletion), we found very accurate Hi-C data predictions as compared to observed data in the mutation mouse (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). Most notably, PIM was able to finely model the distance effect, the numerous TADs, but also the complex hierarchies of TADs. Prediction accuracy was very high as measured by Pearson correlation between log-counts <inline-formula id="IEq68"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=0.882$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.882</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq68.gif"/></alternatives></inline-formula> and Spearman correlation between counts <inline-formula id="IEq69"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_s=0.879$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.879</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq69.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A). In comparison, the state-of-the-art model PRIMSR achieved comparable performance in terms of Pearson and Spearson correlations (<inline-formula id="IEq70"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=0.821$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.821</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq70.gif"/></alternatives></inline-formula>, <inline-formula id="IEq71"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_s=0.895$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.895</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq71.gif"/></alternatives></inline-formula>; Fig. <xref rid="Fig4" ref-type="fig">4</xref>B). But, when distance effect was removed using stratum adjusted correlation in order to only capture the biological variability, PIM performed better than PRISMR (PIM: <inline-formula id="IEq72"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r'=0.883$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0.883</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq72.gif"/></alternatives></inline-formula> and PRISMR: <inline-formula id="IEq73"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r' = 0.582$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0.582</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq73.gif"/></alternatives></inline-formula>; Fig. <xref rid="Fig4" ref-type="fig">4</xref>A, B), reflecting its better ability to model biological variability underlying TADs and sub-TADs. We next compared PIM and PRIMSR using other mouse mutants. For the DelBs/DelBs mutant, we also found that PIM and PRISMR achieved similar performance in term of <italic>r</italic> and <inline-formula id="IEq74"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_s$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq74.gif"/></alternatives></inline-formula> (PIM: <inline-formula id="IEq75"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=0.857$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.857</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq75.gif"/></alternatives></inline-formula>, <inline-formula id="IEq76"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_s=0.842$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.842</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq76.gif"/></alternatives></inline-formula>; PRISMR: <inline-formula id="IEq77"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=0.832$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.832</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq77.gif"/></alternatives></inline-formula>, <inline-formula id="IEq78"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_s=0.897$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.897</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq78.gif"/></alternatives></inline-formula>; Fig. <xref rid="Fig4" ref-type="fig">4</xref>C, D), but PIM predictions compared favorably in term of biological variability with <inline-formula id="IEq79"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r'$$\end{document}</tex-math><mml:math id="M172"><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq79.gif"/></alternatives></inline-formula> (PIM: <inline-formula id="IEq80"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=0.845$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.845</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq80.gif"/></alternatives></inline-formula>; PRISMR: <inline-formula id="IEq81"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r=0.671$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.671</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq81.gif"/></alternatives></inline-formula>; Fig. <xref rid="Fig4" ref-type="fig">4</xref>C, D). Lastly, we predicted data for an inversion (InvF/InvF). As for deletions, we found that PIM yielded better predictions than PRISMR in term of biological variability with <inline-formula id="IEq82"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r'$$\end{document}</tex-math><mml:math id="M178"><mml:msup><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq82.gif"/></alternatives></inline-formula>.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Conclusion</title>
    <p id="Par37">In this article, we propose a versatile regression framework for Hi-C data analyses. Our framework was designed for TAD identification (SIM model), but also differential analysis (DIM model) and Hi-C data predictions after chromosomal rearrangement (PIM model). First, SIM accurately detected TAD borders in a quantitative manner, and was ranked among the top TAD callers when comparing with state-of-the-art methods on an unbiased dataset. Moreover, SIM also identified a novel class of elements we called facilitators which facilitated long-range contacts as opposed to borders, and were shown to be associated with specific transcription factors. Second, DIM identified novel borders during neuronal differentiation. Such novel borders were particularly enriched for other factors than CTCF, in particular, numerous transcriptional factors specific to neurons including Foxd3, NFATC3, NEUROD2, HiC1, Dmbx1, Hmx2 and NFATC1. In comparison, ES specific borders were enriched in stem cell TFs. Third, PIM accurately predicted rearranged 3D genome in mouse mutants, when trained with wild-type Hi-C data. Such approach is very promising to assess the impact of chromosomal rearrangements on the 3D genome. Moreover, PIM compared favorably with state-of-the-art PRISMR in terms of biological variability captured by Hi-C data.</p>
    <p id="Par38">There are several limitations of the proposed framework. First, the proposed framework is designed for the analysis of bulk Hi-C data, <italic>i.e.</italic> data from a population of cells. However, single-cell experiments are getting widely used in 3D genome studies, and necessitate the development of new tools. The proposed framework must be further extended for data that are too sparse, which is the case for single cell data. The use of an empirical Bayes approach to estimate regression betas across cells might be a elegant solution for this purpose. Second, the same framework can be further extended for other Hi-C data analysis tasks. For instance, the regression can be used to infer frequently interacting regions (FIREs) and differential FIREs from Hi-C data [<xref ref-type="bibr" rid="CR39">39</xref>]. Third, variable selection for the SIM model is based on best subset selection using L0Learn R package. However, one problem is that L0Learn cannot work with more than 5000 variables on a standard computer, and for the largest chromosomes, prefiltering is done using lasso regression and a threshold of <inline-formula id="IEq83"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\hat{\beta }}_{x_i}|&gt;0.2$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2022_4614_Article_IEq83.gif"/></alternatives></inline-formula> to sufficiently reduce the number of variables for processing. However, this prefiltering might affect best subset selection. Other prefiltering approaches not relying on an arbitrary thresholding can be used instead. For instance, knockoff can be used for removing unnecessary variables while controlling the false discovery rate (FDR) [<xref ref-type="bibr" rid="CR40">40</xref>]. Alternatively, bootstrap stability investigation can be used [<xref ref-type="bibr" rid="CR41">41</xref>]. Fourth, SIM is methodologically similar to other TAD callers based on the computation of a linear score such as TopDom [<xref ref-type="bibr" rid="CR10">10</xref>] or those based on statistical models of the interaction distributions such as HiCseg [<xref ref-type="bibr" rid="CR11">11</xref>]. We thus expect SIM to call similar TAD borders (performances between SIM, TopDom and HiCseg were similar, Fig. <xref rid="Fig2" ref-type="fig">2</xref>). But SIM is very different from other TAD callers based on clustering [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR16">16</xref>] or graphs [<xref ref-type="bibr" rid="CR17">17</xref>–<xref ref-type="bibr" rid="CR19">19</xref>], and thus SIM is more likely to miss those TADs. Fifth, compared to other TAD callers, SIM is conservative for the detection of TAD borders, meaning that fewer but correct TADs were called rather than many TADs including a few false positives. This stringency is related to the use of best subset selection. The use of other variable selection procedures could be investigated to assess if more TAD borders could be identified.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec18">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2022_4614_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1</bold>.<bold> Figure S1</bold>. Comparison of betas between SIM with prefiltering by lasso regression and SIM without prefiltering.<bold> Figure S2</bold>. Comparison of TAD borders identified by SIM for different normalizations of the Hi-C data (Knight-Ruiz (KR)), iterative correction and eigenvector decomposition (ICE) and square root vanilla coverage (VC SQRT) at 50 kb resolution.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The author is grateful to Nicodemi’s lab (INFN Sezione di Napoli, Italy) for Hi-C capture data and for providing PRISMR predictions. The author is also thankful to all the other labs that generated Hi-C and ChIP-seq data used in this article.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>RM conceived and designed the project. RM implemented the model and analyzed the data. RM wrote the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the University of Toulouse and the CNRS.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>An R package called “TADreg” was developed and is available at: https://github.com/raphaelmourad/TADreg.</p>
  </notes>
  <notes>
    <title>Declaration</title>
    <notes id="FPar2">
      <title>Abbreviations</title>
      <p id="Par39">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par40">Not applicable.</p>
    </notes>
    <notes id="FPar4">
      <title>Consent for publication</title>
      <p id="Par41">Not applicable.</p>
    </notes>
    <notes id="FPar5" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par42">I declare that the authors have no competing interests as defined by BMC, or other interests that might be perceived to influence the results and/or discussion reported in this paper.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halverson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Smrek</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kremer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Grosberg</surname>
            <given-names>AY</given-names>
          </name>
        </person-group>
        <article-title>From a melt of rings to chromosome territories: the role of topological constraints in genome folding</article-title>
        <source>Rep Progress Phys</source>
        <year>2014</year>
        <volume>77</volume>
        <issue>2</issue>
        <fpage>022601</fpage>
        <pub-id pub-id-type="doi">10.1088/0034-4885/77/2/022601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <issue>7398</issue>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11082</pub-id>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sexton</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Yaffe</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kenigsberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bantignies</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Leblanc</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hoichman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Parrinello</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cavalli</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Three-dimensional folding and functional organization principles of the Drosophila genome</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>148</volume>
        <issue>3</issue>
        <fpage>458</fpage>
        <lpage>472</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.01.010</pub-id>
        <pub-id pub-id-type="pmid">22265598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dixon</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Yen</surname>
            <given-names>C-A</given-names>
          </name>
          <name>
            <surname>Schmitt</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Espinoza</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A high-resolution map of the three-dimensional chromatin interactome in human cells</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>503</volume>
        <issue>7475</issue>
        <fpage>290</fpage>
        <lpage>294</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12644</pub-id>
        <pub-id pub-id-type="pmid">24141950</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Telling</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Sabo</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Dorschner</surname>
            <given-names>MO</given-names>
          </name>
          <name>
            <surname>Sandstrom</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Groudine</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mirny</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <issue>5950</issue>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pope</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Ryba</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dileep</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Denas</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Vera</surname>
            <given-names>DL</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Canfield</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Thurman</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gulsoy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dennis</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Kahveci</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Topologically associating domains are stable units of replication-timing regulation</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>515</volume>
        <issue>7527</issue>
        <fpage>402</fpage>
        <lpage>405</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13986</pub-id>
        <pub-id pub-id-type="pmid">25409831</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zufferey</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tavernari</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Oricchio</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ciriello</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Comparison of computational methods for the identification of topologically associating domains</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>217</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-018-1596-9</pub-id>
        <pub-id pub-id-type="pmid">30526631</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crane</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bian</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>McCord</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Ralston</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Uzawa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Condensin-driven remodelling of X chromosome topology during dosage compensation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>523</volume>
        <fpage>240</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14450</pub-id>
        <pub-id pub-id-type="pmid">26030525</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>SSP</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Stamenova</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Sanborn</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Omer</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <issue>7</issue>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shin</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tjong</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Alber</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>XJ</given-names>
          </name>
        </person-group>
        <article-title>TopDom: an efficient and deterministic method for identifying topological domains in genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>7</issue>
        <fpage>e70</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1505</pub-id>
        <pub-id pub-id-type="pmid">26704975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levy-Leduc</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Delattre</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mary-Huard</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Robin</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Two-dimensional segmentation for analyzing Hi-C data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>17</issue>
        <fpage>i386</fpage>
        <lpage>i392</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu443</pub-id>
        <pub-id pub-id-type="pmid">25161224</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weinreb</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Identification of hierarchical chromatin domains</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>32</volume>
        <issue>11</issue>
        <fpage>1601</fpage>
        <lpage>1609</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv485</pub-id>
        <pub-id pub-id-type="pmid">26315910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Serra</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bau</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Goodstadt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Castillo</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Filion</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Marti-Renom</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Automatic analysis and 3D-modelling of Hi-C data using TADbit reveals structural features of the fly chromatin colors</article-title>
        <source>PLoS Comput Biol</source>
        <year>2017</year>
        <volume>13</volume>
        <issue>7</issue>
        <fpage>1</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oluwadare</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>ClusterTAD: an unsupervised machine learning approach to detecting topologically associated domains of chromosomes from Hi-C data</article-title>
        <source>BMC Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>480</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1931-2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haddad</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Vaillant</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jost</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>IC-finder: inferring robustly the hierarchical organization of chromatin folding</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>10</issue>
        <fpage>e81</fpage>
        <lpage>e81</lpage>
        <?supplied-pmid 28130423?>
        <pub-id pub-id-type="pmid">28130423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Randriamihamison N, Vialaneix N, Neuvial P. Applicability and interpretability of Ward’s hierarchical agglomerative clustering with or without contiguity constraints. J Classif. 2020.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hero</surname>
            <given-names>AOI</given-names>
          </name>
          <name>
            <surname>Rajapakse</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Spectral identification of topological domains</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>14</issue>
        <fpage>2151</fpage>
        <lpage>2158</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw221</pub-id>
        <pub-id pub-id-type="pmid">27153657</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yan</surname>
            <given-names>K-K</given-names>
          </name>
          <name>
            <surname>Lou</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>MrTADFinder: a network modularity based approach to identify topologically associating domains in multiple resolutions</article-title>
        <source>PLoS Comput Biol</source>
        <year>2017</year>
        <volume>13</volume>
        <issue>7</issue>
        <fpage>1</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005647</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Norton</surname>
            <given-names>HK</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Titus</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bassett</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Detecting hierarchical genome folding with network modularity</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>119</fpage>
        <lpage>122</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4560</pub-id>
        <pub-id pub-id-type="pmid">29334377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Zaborowski R, Wilczynski B. DiffTAD: detecting Differential contact frequency in topologically associating domains Hi-C experiments between conditions. bioRxiv. 2016.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sadowski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kraft</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Szalaj</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wlasnowolski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Plewczynski</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Spatial chromatin architecture alteration by structural variations in human genomes at the population scale</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>148</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1728-x</pub-id>
        <pub-id pub-id-type="pmid">31362752</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cresswell</surname>
            <given-names>KG</given-names>
          </name>
          <name>
            <surname>Dozmorov</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>TADCompare: an R package for differential and temporal analysis of topologically associated domains</article-title>
        <source>Front Genet</source>
        <year>2020</year>
        <volume>11</volume>
        <fpage>158</fpage>
        <pub-id pub-id-type="doi">10.3389/fgene.2020.00158</pub-id>
        <pub-id pub-id-type="pmid">32211023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bianco</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lupiáñez</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Chiariello</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Annunziatella</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kraft</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schöpflin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wittler</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Andrey</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pombo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mundlos</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nicodemi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Polymer physics predicts the effects of structural variants on chromatin architecture</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>5</issue>
        <fpage>662</fpage>
        <lpage>667</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0098-8</pub-id>
        <pub-id pub-id-type="pmid">29662163</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huynh</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hormozdiari</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>TAD fusion score: discovery and ranking the contribution of deletions to genome structure</article-title>
        <source>Genome Biol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>60</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-019-1666-7</pub-id>
        <pub-id pub-id-type="pmid">30898144</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Kaplan N. Explicit probabilistic models for exploiting and explaining the 3D genome. In: Proceedings of statistics for post genomic data (SMPGD 2019); 2019.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Belokopytova</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Nuriddinov</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Mozheiko</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Fishman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fishman</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Quantitative prediction of enhancer-promoter interactions</article-title>
        <source>Genome Res</source>
        <year>2020</year>
        <volume>30</volume>
        <issue>1</issue>
        <fpage>72</fpage>
        <lpage>84</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.249367.119</pub-id>
        <pub-id pub-id-type="pmid">31804952</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rowley</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Lyu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ando-Kuri</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rivera</surname>
            <given-names>ISM</given-names>
          </name>
          <name>
            <surname>Hermetz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>VG</given-names>
          </name>
        </person-group>
        <article-title>Evolutionarily conserved principles predict 3D chromatin organization</article-title>
        <source>Mol Cell</source>
        <year>2017</year>
        <volume>67</volume>
        <issue>5</issue>
        <fpage>837</fpage>
        <lpage>852.e7</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.07.022</pub-id>
        <pub-id pub-id-type="pmid">28826674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mourad</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cuvier</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>TAD-free analysis of architectural proteins and insulators</article-title>
        <source>Nucleic Acids Res</source>
        <year>2018</year>
        <volume>46</volume>
        <issue>5</issue>
        <fpage>e27</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx1246</pub-id>
        <pub-id pub-id-type="pmid">29272504</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bonev</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>MendelsonCohen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Szabo</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Fritsch</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Papadopoulos</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Lubling</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lv</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Hugnot</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Tanay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cavalli</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Multiscale 3D genome rewiring during mouse neural development</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <issue>3</issue>
        <fpage>557</fpage>
        <lpage>572</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.043</pub-id>
        <pub-id pub-id-type="pmid">29053968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Knight PA, Ruiz D. A fast algorithm for matrix balancing. IMA J Numer Anal. 2012.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">The ENCODE Consortium. An integrated encyclopedia of DNA elements in the human genome. Nature. 2012;489(7414):57–74.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dali</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Blanchette</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A critical assessment of topologically associating domain prediction tools</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>6</issue>
        <fpage>2994</fpage>
        <lpage>3005</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkx145</pub-id>
        <pub-id pub-id-type="pmid">28334773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marti-Renom</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Mirny</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Exploring the three-dimensional organization of genomes: interpreting chromatin interaction data</article-title>
        <source>Nat Rev Genet</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>390</fpage>
        <lpage>403</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3454</pub-id>
        <pub-id pub-id-type="pmid">23657480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>HiCNorm: removing biases in Hi-C data via Poisson regression</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>23</issue>
        <fpage>3131</fpage>
        <lpage>3133</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts570</pub-id>
        <pub-id pub-id-type="pmid">23023982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moore</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Aitken</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Semple</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Integrative modeling reveals the principles of multi-scale chromatin boundary formation in human nuclear organization</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>110</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0661-x</pub-id>
        <pub-id pub-id-type="pmid">26013771</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mourad</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cuvier</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Computational identification of genomic features that influence 3D chromatin domain formation</article-title>
        <source>PLoS Comput Biol</source>
        <year>2016</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>e1004908</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004908</pub-id>
        <pub-id pub-id-type="pmid">27203237</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imakaev</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fudenberg</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McCord</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Naumova</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Goloborodko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Mirny</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>999</fpage>
        <lpage>1003</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2148</pub-id>
        <pub-id pub-id-type="pmid">22941365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durand</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Shamim</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>95</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.07.002</pub-id>
        <pub-id pub-id-type="pmid">27467249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crowley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Abnousi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lipiński</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Plewczyński</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Won</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>FIREcaller: detecting frequently interacting regions from Hi-C data</article-title>
        <source>Comput Struct Biotechnol J</source>
        <year>2021</year>
        <volume>19</volume>
        <fpage>355</fpage>
        <lpage>362</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2020.12.026</pub-id>
        <pub-id pub-id-type="pmid">33489005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barber</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Candès</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate via knockoffs.</article-title>
        <source>Ann Stat</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>5</issue>
        <fpage>2055</fpage>
        <lpage>2085</lpage>
        <pub-id pub-id-type="doi">10.1214/15-AOS1337</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Royston</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sauerbrei</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Bootstrap assessment of the stability of multivariable models</article-title>
        <source>Stand Genom Sci</source>
        <year>2009</year>
        <volume>9</volume>
        <issue>4</issue>
        <fpage>547</fpage>
        <lpage>570</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
