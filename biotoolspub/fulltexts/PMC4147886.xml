<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4147886</article-id>
    <article-id pub-id-type="pmid">24813214</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu317</article-id>
    <article-id pub-id-type="publisher-id">btu317</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Efficient RNA isoform identification and quantification from RNA-Seq data with network flows</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bernard</surname>
          <given-names>Elsa</given-names>
        </name>
        <xref ref-type="aff" rid="btu317-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu317-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu317-AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jacob</surname>
          <given-names>Laurent</given-names>
        </name>
        <xref ref-type="aff" rid="btu317-AFF1">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mairal</surname>
          <given-names>Julien</given-names>
        </name>
        <xref ref-type="aff" rid="btu317-AFF1">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vert</surname>
          <given-names>Jean-Philippe</given-names>
        </name>
        <xref ref-type="aff" rid="btu317-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu317-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btu317-AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="btu317-COR1">*</xref>
      </contrib>
      <aff id="btu317-AFF1"><sup>1</sup>Mines ParisTech, Centre for Computational Biology, 77300 Fontainebleau, <sup>2</sup>Institut Curie, 26 rue d'Ulm, 75248 Paris Cedex 05, <sup>3</sup>INSERM U900, Paris F-75248, France, <sup>4</sup>Laboratoire Biométrie et Biologie Evolutive, Université de Lyon, Université Lyon 1, CNRS, INRA, UMR5558, Villeurbanne, France and <sup>5</sup>LEAR Project-Team, INRIA Grenoble Rhône Alpes, 38330 Montbonnot, France</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu317-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Janet Kelso</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>9</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>09</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>5</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>30</volume>
    <issue>17</issue>
    <fpage>2447</fpage>
    <lpage>2455</lpage>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>3</month>
        <year>2013</year>
      </date>
      <date date-type="rev-recd">
        <day>16</day>
        <month>4</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>4</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/3.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Several state-of-the-art methods for isoform identification and quantification are based on <inline-formula><mml:math id="I1"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-regularized regression, such as the Lasso. However, explicitly listing the—possibly exponentially—large set of candidate transcripts is intractable for genes with many exons. For this reason, existing approaches using the <inline-formula><mml:math id="I2"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-penalty are either restricted to genes with few exons or only run the regression algorithm on a small set of preselected isoforms.</p>
      <p><bold>Results:</bold> We introduce a new technique called FlipFlop, which can efficiently tackle the sparse estimation problem on the full set of candidate isoforms by using network flow optimization. Our technique removes the need of a preselection step, leading to better isoform identification while keeping a low computational cost. Experiments with synthetic and real RNA-Seq data confirm that our approach is more accurate than alternative methods and one of the fastest available.</p>
      <p><bold>Availability and implementation:</bold> Source code is freely available as an R package from the Bioconductor Web site (<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/">http://www.bioconductor.org/</ext-link>), and more information is available at <ext-link ext-link-type="uri" xlink:href="http://cbio.ensmp.fr/flipflop">http://cbio.ensmp.fr/flipflop</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>Jean-Philippe.Vert@mines.org</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu317/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Over the past decade, quantitation of mRNA molecules in a cell population has become a popular approach to study the effect of several factors on cellular activity. Typical applications include the detection of genes whose expression varies between two or more populations of samples (differential analysis), classification of samples based on gene expression (<xref rid="btu317-B27" ref-type="bibr">van’t Veer <italic>et al.</italic>, 2002</xref>) and clustering, which consists of identifying a grouping structure in a sample set (<xref rid="btu317-B20" ref-type="bibr">Perou <italic>et al.</italic>, 2000</xref>). While probe-based DNA microarray technologies only allow quantitating mRNA molecules whose sequence is known in advance, the recent development of deep sequencing has removed this restriction. More precisely, RNA-Seq technologies (<xref rid="btu317-B17" ref-type="bibr">Mortazavi <italic>et al.</italic>, 2008</xref>) allow the sequencing of cDNA molecules obtained by reverse transcription of RNA molecules present in the cell. Consequently, any transcript can be sequenced and therefore quantitated, even though its sequence might not be available a priori for designing a specific probe. In addition to facilitating the study of non-coding parts of known genomes and organisms whose genome has not been sequenced (<xref rid="btu317-B18" ref-type="bibr">Mortazavi <italic>et al.</italic>, 2010</xref>), RNA-Seq technologies facilitate the quantitation of alternatively spliced genes. Genes in eukaryote cells contain a succession of exon and intron sequences. Transcription results in a pre-mRNA molecule from which most introns are removed, and some exons are retained during a processing step called RNA splicing. It is estimated that &gt;95% of multiexonic genes are subject to alternative splicing (<xref rid="btu317-B19" ref-type="bibr">Pan <italic>et al.</italic>, 2008</xref>): the set of exons retained during splicing can vary, resulting for the same gene in different versions of the mRNA, referred to as transcripts or isoforms. Identification and quantification of isoforms present in a sample is of outmost interest because different isoforms can later be translated as different proteins. Detection of isoforms whose presence or quantity varies between samples may lead to new biomarkers and highlight novel biological processes invisible at the gene level.</p>
    <p>Sequencing technologies are well suited to transcript quantitation as the read density observed along the different exons of a gene provide information on which alternatively spliced mRNAs were expressed in the sample, and in which proportions. Because the read length is typically smaller than the mRNA molecule of a transcript, identifying and quantifying the transcripts is, however, difficult: an observed read mapping to a particular exon may come from an mRNA molecule of any transcript containing this exon. Some methods consider that the set of expressed isoforms (<xref rid="btu317-B9" ref-type="bibr">Jiang and Wong, 2009</xref>) or a candidate superset (<xref rid="btu317-B8" ref-type="bibr">Huang <italic>et al.</italic>, 2013</xref>; <xref rid="btu317-B29" ref-type="bibr">Xing <italic>et al.</italic>, 2006</xref>) is known in advance, in which case the only problem is to estimate their expression. However, little is known in practice about the possible isoforms of genes, and restricting oneself to isoforms that have been described in the literature may lead to missing new ones.</p>
    <p>Two main paradigms have been used so far to estimate expression at the transcript level while allowing <italic>de novo</italic> transcript discovery. On the one hand, the Cufflinks software package (<xref rid="btu317-B26" ref-type="bibr">Trapnell <italic>et al.</italic>, 2010</xref>) proceeds in two separate steps to identify expressed isoforms and estimate their abundance. It first estimates the list of alternatively spliced transcripts by building a small set of isoforms containing all observed exons and exon junctions. In a second step, the expression of each transcript is quantified by likelihood maximization given the list of transcripts. Identification and quantification are therefore done independently. On the other hand, a second family of methods (<xref rid="btu317-B2" ref-type="bibr">Behr <italic>et al.</italic>, 2013</xref>; <xref rid="btu317-B4" ref-type="bibr">Bohnert and Rätsch, 2010</xref>; <xref rid="btu317-B10" ref-type="bibr">Li <italic>et al.</italic>, 2011a</xref>, <xref rid="btu317-B11" ref-type="bibr">b</xref>; <xref rid="btu317-B15" ref-type="bibr">Mezlini <italic>et al.</italic>, 2013</xref>; <xref rid="btu317-B28" ref-type="bibr">Xia <italic>et al.</italic>, 2011</xref>) jointly estimates the set of transcripts and their expression using a penalized likelihood approach. These methods model the likelihood of the expression of all possible transcripts, possibly after some preselection, and the penalty encourages sparse solutions that have a few expressed transcripts.</p>
    <p>The two-step approach of Cufflinks (<xref rid="btu317-B26" ref-type="bibr">Trapnell <italic>et al.</italic>, 2010</xref>) is reasonably fast, but does not exploit the observed read density along the gene, which can be a valuable information to identify the set of transcripts. This is a conclusion drawn experimentally using methods from the second paradigm (see <xref rid="btu317-B4" ref-type="bibr">Bohnert and Rätsch, 2010</xref>; <xref rid="btu317-B10" ref-type="bibr">Li <italic>et al.</italic>, 2011a</xref>, <xref rid="btu317-B11" ref-type="bibr">b</xref>; <xref rid="btu317-B15" ref-type="bibr">Mezlini <italic>et al.</italic>, 2013</xref>; <xref rid="btu317-B28" ref-type="bibr">Xia <italic>et al.</italic>, 2011</xref>). To summarize, the first paradigm is fast but can be statistically less powerful than the second one in some cases, whereas the second paradigm suffers from the exponential number of candidate isoforms and becomes intractable for genes with many exons. The contribution of this article is to allow <inline-formula><mml:math id="I3"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-penalized regression methods from the second family to run efficiently without prefiltering the set of isoform candidates, although they solve a non-smooth optimization problem over an exponential number of variables. To do so, we show that the penalized likelihood maximization can be reformulated as a convex cost network flow problem, which can be solved efficiently (<xref rid="btu317-B1" ref-type="bibr">Ahuja <italic>et al.</italic>, 1993</xref>; <xref rid="btu317-B3" ref-type="bibr">Bertsekas, 1998</xref>; <xref rid="btu317-B12" ref-type="bibr">Mairal and Yu, 2012</xref>). Note that a significantly different approach was adopted by <xref rid="btu317-B2" ref-type="bibr">Behr <italic>et al.</italic> (2013)</xref> for non-convex <inline-formula><mml:math id="I4"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-penalty. Even though the problem they address is NP-hard, they perform simultaneous isoform identification and quantification, without explicitly enumerating all possible transcripts, by using mixed integer programming techniques.</p>
    <p>The article is organized as follows: Section 2 introduces the statistical model (Section 2.1) and the penalized likelihood approach (Section 2.2) we follow. Our model is similar to the one used by <xref rid="btu317-B28" ref-type="bibr">Xia <italic>et al.</italic> (2011)</xref>, but properly models reads that cover more than two exons, effectively taking advantage of longer reads. We then reformulate the model as a path selection problem over a particular graph (Section 2.3), and present our method in Sections 2.4–2.6 called FlipFlop (Fast Lasso-based Isoform Prediction as a FLOw Problem) for solving it efficiently. Section 3 empirically compares our approach with the state of the art on simulated and real sequencing data. Our experiments show that our approach has higher accuracy in isoform discovery than methods that treat discovery and abundance estimation as two separate steps and that it runs significantly faster than methods explicitly listing the candidate isoforms. We discuss the implications of our results in Section 4.</p>
  </sec>
  <sec id="SEC2">
    <title>2 METHOD</title>
    <p>Our approach to isoform deconvolution from RNA-Seq data consists of fitting a sparse probabilistic model, like several existing methods including rQuant (<xref rid="btu317-B4" ref-type="bibr">Bohnert and Rätsch, 2010</xref>), NSMAP (<xref rid="btu317-B28" ref-type="bibr">Xia <italic>et al.</italic>, 2011</xref>), IsoLasso (<xref rid="btu317-B11" ref-type="bibr">Li <italic>et al.</italic>, 2011b</xref>), SLIDE (<xref rid="btu317-B10" ref-type="bibr">Li <italic>et al.</italic>, 2011a</xref>) or iReckon (<xref rid="btu317-B15" ref-type="bibr">Mezlini <italic>et al.</italic>, 2013</xref>). The reads from RNA-Seq data are modeled as a linear combination of isoforms expressions that are estimated by using the maximum likelihood principle. Because the number of candidate isoforms grows exponentially with the number of exons, the above methods are either computationally expensive for genes with many exons (such as NSMAP or SLIDE) or include a preselection step to reduce the number of candidates, which may alter the method accuracy.</p>
    <p>The main novelty of our article is to tackle the sparse estimation problem efficiently <italic>without pre</italic><italic>filtering</italic>. In the methodological section, we show that the corresponding penalized maximum likelihood estimator can be computed in polynomial time with the number of exons, despite the exponential number of candidate transcripts. The key is the use of a non-trivial optimization technique based on the concept of flow in a graph (<xref rid="btu317-B1" ref-type="bibr">Ahuja <italic>et al.</italic>, 1993</xref>; <xref rid="btu317-B12" ref-type="bibr">Mairal and Yu, 2012</xref>).</p>
    <sec id="SEC2.1">
      <title>2.1 Statistical model</title>
      <p>We consider an extension of the model originally introduced by <xref rid="btu317-B9" ref-type="bibr">Jiang and Wong (2009)</xref> and used in NSMAP for estimating isoform expression for a known set of expressed transcripts. Given a gene of interest, we assume that the list of its <italic>n</italic> exons is known, and that the reads of the RNA-Seq experiments have been mapped to a reference genome. For the purpose of our work, an exon can either be defined by read alignment software as a cluster of reads or from a predefined annotation such as the one provided by the UCSC genome browser (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/">http://genome.ucsc.edu/</ext-link>). In the latter case, exons with alternative 5′-donor and 3′-acceptor sites are considered as two separate exons. For alternative 5′-donor sites, the exon is broken down as one exon ending at the first 5′-donor site, and another one starting at this same point and ending at the second 5′-donor site (similarly for exons with 3′-acceptor sites).</p>
      <p>We define a <italic>bin</italic> to be an ordered set of exons. Each read is assigned to a unique bin, corresponding to the exact set of exons that it overlaps. Our model can involve bins with more than two exons. It is thus more general than the one of NSMAP, where bins are simply exons and exon–exon junctions. This extension of NSMAP is particularly useful for long reads, which often cover more than two exons. We summarize the read information by the counts <inline-formula><mml:math id="I6"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of reads falling in <italic>q</italic> different bins.</p>
      <p>We consider in our model all <italic>m</italic> possible candidate isoforms consisting of an ordered sequence of exons. Each candidate isoform corresponds to a unique sequence of bins. This sequence can be generated by virtually moving a read along the candidate isoform, and recording the sets of exons that it successively overlaps.</p>
      <p>The <italic>effective length l<sub>i</sub></italic> of a bin <italic>i</italic> is defined as the number of positions in the candidate isoform where reads can start and be assigned to the bin. A simple computation shows that for a bin involving a single exon of length <italic>l<sub>e</sub></italic>, we have <inline-formula><mml:math id="I8"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, where <italic>L</italic> is the read length, whereas for bins involving several exons, <inline-formula><mml:math id="I9"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>left</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>int</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>right</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>int</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>int</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="I10"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>left</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="I11"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>right</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are the lengths of the leftmost and rightmost exons of the bin, and <inline-formula><mml:math id="I12"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>int</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the total length of the internal exons of the bin. Interestingly, we note that the effective length of a bin does not depend on the candidate isoform it is associated with. A figure illustrating the computation of the effective length is given in Section 1 of the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu317/-/DC1">Supplementary Material</ext-link>.</p>
      <p>We model read counts as independent Poisson random variables whose means are proportional to the bins’ effective lengths and to the total abundances of isoforms associated with each bin. More formally, let us denote by <italic>U</italic> the <inline-formula><mml:math id="I14"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math></inline-formula> binary matrix defined as <inline-formula><mml:math id="I15"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if bin <italic>i</italic> is associated to isoform <italic>j</italic> and 0 otherwise, and by <inline-formula><mml:math id="I18"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>ℝ</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:math></inline-formula> the expression of isoform <italic>j</italic> (the expected number of reads per base in isoform <italic>j</italic>). Thus, <inline-formula><mml:math id="I21"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represents the sum of expressions of all isoforms involving bin <italic>i</italic>. We expect the observed count for bin <italic>i</italic> to be distributed around this value times the effective length of the bin <italic>l<sub>i</sub></italic>, and therefore model the read count <inline-formula><mml:math id="I24"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> as a Poisson random variable with parameter <inline-formula><mml:math id="I25"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. For a vector <inline-formula><mml:math id="I26"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> in <inline-formula><mml:math id="I27"><mml:mrow><mml:msubsup><mml:mi>ℝ</mml:mi><mml:mo>+</mml:mo><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, this yields the log-likelihood
<disp-formula id="btu317-M1"><label>(1)</label><mml:math id="MM1"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>!</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula>
where the scalars <inline-formula><mml:math id="I28"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> depend linearly on θ.</p>
      <p>Maximizing the likelihood (1) allows quantifying the relative abundance of each transcript when the model only includes the list of ‘true’ isoforms present in the sample (<xref rid="btu317-B9" ref-type="bibr">Jiang and Wong, 2009</xref>). Because this list is unknown a priori, we present in the next section the sparse estimation approach that can jointly quantify and identify the transcripts using all candidate isoforms, following <xref rid="btu317-B28" ref-type="bibr">Xia <italic>et al.</italic> (2011)</xref>.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Isoform detection by sparse estimation</title>
      <p>Because we do not assume that the list of expressed isoforms—i.e. such that <inline-formula><mml:math id="I29"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>—is known in advance, we endow θ with an exponential prior <inline-formula><mml:math id="I30"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mstyle displaystyle="true"><mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>iid</mml:mtext></mml:mrow></mml:mover></mml:mstyle><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and maximize over all candidate isoforms the resulting posterior likelihood, leading to the estimator
<disp-formula id="btu317-M2"><label>(2)</label><graphic xlink:href="btu317m2.jpg" position="float"/></disp-formula>
where λ is a regularization parameter, and the <inline-formula><mml:math id="I31"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-norm is defined as <inline-formula><mml:math id="I32"><mml:mrow><mml:mtext>
</mml:mtext><mml:msub><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>θ</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="false"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">|</mml:mo></mml:mstyle><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math></inline-formula>. It is well-known that the <inline-formula><mml:math id="I33"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-norm penalty and the non-negativity constraint have a sparsity-inducing effect—that is, lead to estimators <inline-formula><mml:math id="I34"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>λ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> that contain many zeroes (<xref rid="btu317-B23" ref-type="bibr">Tibshirani, 1996</xref>). The parameter λ controls the number of non-zero elements in the solution <inline-formula><mml:math id="I35"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>λ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, i.e. of selected isoforms, with larger λ corresponding to fewer isoforms.</p>
      <p><xref rid="btu317-B15" ref-type="bibr">Mezlini <italic>et al.</italic> (2013)</xref> claim that the <inline-formula><mml:math id="I36"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-penalty is inappropriate for isoform selection, a claim we disagree with. As they note, the sum of true abundances in RPKM weighted by isoform lengths is by definition the true proportion of reads coming from the gene times 10<sup>9</sup>. They conclude that penalizing by <inline-formula><mml:math id="I37"><mml:mrow><mml:mstyle displaystyle="false"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> has little effect on the estimate. However, the sum of the <italic>estimator</italic>
<inline-formula><mml:math id="I38"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>λ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> weighted by isoform lengths has no reason to be equal to the <italic>observed</italic> number of reads mapping to the gene. There are several causes for that: model inadequacy, various noise sources, finite sample size and bias of the estimator. Penalizing this sum therefore modifies the sparsity level of <inline-formula><mml:math id="I39"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>λ</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> as observed in our and other’s experiments (<xref rid="btu317-B4" ref-type="bibr">Bohnert and Rätsch, 2010</xref>; <xref rid="btu317-B10" ref-type="bibr">Li <italic>et al.</italic>, 2011a</xref>, <xref rid="btu317-B11" ref-type="bibr">b</xref>; <xref rid="btu317-B28" ref-type="bibr">Xia <italic>et al.</italic>, 2011</xref>).</p>
      <p>Note also that (2) is better adapted to long reads than the original formulation of NSMAP (<xref rid="btu317-B28" ref-type="bibr">Xia <italic>et al.</italic>, 2011</xref>), thanks to the use of general bins. rQuant (<xref rid="btu317-B4" ref-type="bibr">Bohnert and Rätsch, 2010</xref>), IsoLasso (<xref rid="btu317-B11" ref-type="bibr">Li <italic>et al.</italic>, 2011b</xref>) and SLIDE (<xref rid="btu317-B10" ref-type="bibr">Li <italic>et al.</italic>, 2011a</xref>) solve a similar problem where the likelihood is a simpler quadratic function, corresponding to a Gaussian model for the read counts. A difficulty with these approaches is that the dimension <italic>m</italic> grows exponentially in <italic>n</italic>, making (2) intractable when <italic>n</italic> is large. For example, <xref rid="btu317-B10" ref-type="bibr">Li <italic>et al.</italic> (2011a)</xref> restrict themselves to experiments involving genes with &lt;10 exons, because of the high computational cost for larger genes. <xref rid="btu317-B28" ref-type="bibr">Xia <italic>et al.</italic> (2011)</xref> restrict themselves to genes with &lt;80 exons, but only consider candidates with transcription start/polyadenylation sites (TSS/PAS) pairs already observed in annotations, and which involve more than half of the exons of the gene. Other approaches such as IsoLasso include a filtering step to reduce the number of isoforms, similarly as Cufflinks does—in the case of single-end reads, their set of candidates is the set of isoforms returned by Cufflinks. As pointed out in Section 1, this filtering may lead to a loss of power in isoform detection because it disregards the read density information when constructing the set of candidates. In the next section, we show that, surprisingly, problem (2) can be solved efficiently without prefiltering the isoforms by using network flow algorithms.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Isoform detection as a path selection problem</title>
      <p>In this section, we reformulate the isoform detection problem as a path selection problem over a particular graph. Remember that a graph <inline-formula><mml:math id="I43"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is composed of a finite set of vertices <italic>V</italic> and edges <inline-formula><mml:math id="I44"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⊆</mml:mo><mml:mi>V</mml:mi><mml:mo>×</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>. A path is a sequence of vertices <inline-formula><mml:math id="I45"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="I46"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is an arc in <italic>E</italic> for all indices <inline-formula><mml:math id="I47"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>. A graph is a directed acyclic graph (DAG) if it contains no path <inline-formula><mml:math id="I48"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="I49"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. In other words, the graph does not contain any cycle.</p>
      <p>We construct an oriented graph <inline-formula><mml:math id="I50"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> whose vertices are the bins with positive effective length defined in Section 2.1—each corresponding to an ordered set of exons. An edge connects bin <italic>v<sub>i</sub></italic> to <italic>v<sub>j</sub></italic> if they can be associated to two reads starting at successive positions in a candidate isoform. In general, <italic>v<sub>j</sub></italic> is obtained from <italic>v<sub>i</sub></italic> by removing the first exon of its ordered set or by adding one extra exon at the end of the ordered set, depending on the lengths of the exons composing the bin (<xref ref-type="fig" rid="btu317-F1">Fig. 1</xref>). We call <italic>starting bins</italic> (respectively <italic>stopping bins</italic>) the bins that can contain a read at the left-most (respectively right-most) position of an isoform. The resulting graph is a DAG generalizing the splicing graph (<xref rid="btu317-B7" ref-type="bibr">Heber <italic>et al.</italic>, 2002</xref>), whose vertices are single exons and edges are exon–exon junctions.
<fig id="btu317-F1" position="float"><label>Fig. 1.</label><caption><p>Illustration of the graph construction for a gene with 5 exons. The original splicing graph is represented in (<bold>a</bold>). The 5 exons are represented as vertices and an arrow between two vertices indicates a junction. The nodes of graph <inline-formula><mml:math id="I51"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> in (<bold>b</bold>) and (<bold>c</bold>) are bins with positive effective length denoted by gray square, as well as source <italic>s</italic> and sink <italic>t</italic> represented as circles. <inline-formula><mml:math id="I52"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> in (b) is the resulting graph when all exons are bigger than the read length. In that case, each bin either corresponds to a unique exon, or to a junction between two exons. <inline-formula><mml:math id="I53"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> in (c) is the resulting graph when the length of exon 3 is smaller than the read length. Some bins involve then more than two exons, here bins <inline-formula><mml:math id="I54"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mtext>-</mml:mtext><mml:mn>3</mml:mn><mml:mtext>-</mml:mtext><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="I55"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mtext>-</mml:mtext><mml:mn>3</mml:mn><mml:mtext>-</mml:mtext><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The source links all possible starting bins, and conversely all possible stopping bins are linked to the sink. There is a one-to-one correspondence between (<italic>s</italic>, <italic>t</italic>)-paths in <inline-formula><mml:math id="I56"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> (paths starting at <italic>s</italic> and ending at <italic>t</italic>) and isoform candidates. For example, the path <inline-formula><mml:math id="I57"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mtext>-</mml:mtext><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mtext>-</mml:mtext><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> corresponds to isoform 1-4-5</p></caption><graphic xlink:href="btu317f1p"/></fig></p>
      <p>We also consider two new vertices <italic>s</italic> and <italic>t</italic>, respectively, dubbed <italic>source</italic> and <italic>sink</italic>, and connected to all starting and stopping bins, respectively. We do not impose any restriction on the set of TSS/PAS sites and each exon can potentially start or end an isoform. Consequently, the source is connected to all bins modeling an exon start, and the sink to all bins modeling an exon end. This leads to the definition of an extended graph <inline-formula><mml:math id="I58"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="I59"><mml:mrow><mml:mi>V</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mo>∪</mml:mo><mml:mo>{</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="I60"><mml:mrow><mml:mi>E</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> is obtained by adding to <italic>E</italic> all edges of the form (<italic>s</italic>, <italic>v</italic>) where <inline-formula><mml:math id="I61"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> is a starting bin, and (<italic>v</italic>, <italic>t</italic>) where <inline-formula><mml:math id="I62"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula> is a stopping bin. This graph construction is illustrated in <xref ref-type="fig" rid="btu317-F1">Figure 1</xref>. <xref rid="btu317-B16" ref-type="bibr">Montgomery <italic>et al.</italic> (2010)</xref> use a similar graph structure in the context of estimating the expression of a set of known annotated transcripts.</p>
      <p>Let us denote by <inline-formula><mml:math id="I63"><mml:mi mathvariant="script" class="calligraphy">P</mml:mi></mml:math></inline-formula> the set of paths in <inline-formula><mml:math id="I64"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> starting from <italic>s</italic> and ending at <italic>t</italic>, which are called (<italic>s</italic>, <italic>t</italic>)-paths. By construction, one easily checks that <inline-formula><mml:math id="I65"><mml:mi mathvariant="script" class="calligraphy">P</mml:mi></mml:math></inline-formula> is in bijection with the set of candidate isoforms, the path in <inline-formula><mml:math id="I66"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> corresponding to a candidate isoform being the set of bins that reads generated from the isoform can produce. Based on this one-to-one mapping, we can reformulate the penalized maximum likelihood problem (1)–(2) as follows: we want to find non-negative weights <inline-formula><mml:math id="I67"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for each path <inline-formula><mml:math id="I68"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">P</mml:mi></mml:mrow></mml:math></inline-formula> which minimize:
<disp-formula id="btu317-M3"><label>(3)</label><graphic xlink:href="btu317m3.jpg" position="float"/></disp-formula>
where the sum <inline-formula><inline-graphic xlink:href="btu317i1.jpg"/></inline-formula> is equal to the <inline-formula><mml:math id="I70"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-norm <inline-formula><mml:math id="I71"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> because the entries of θ are non-negative. Note that we have removed the constant term <inline-formula><mml:math id="I72"><mml:mrow><mml:mi>log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>!</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from the log likelihood because it does not play a role in the optimization. This reformulation is therefore a path selection (finding which <inline-formula><mml:math id="I73"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are non-zero) and quantification problem over <inline-formula><mml:math id="I74"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>. The next section shows how (3) can further be written as a flow problem, i.e. technically a constrained optimization problem over the edges of the graph rather than the set of paths in <inline-formula><mml:math id="I75"><mml:mi mathvariant="script" class="calligraphy">P</mml:mi></mml:math></inline-formula>. A computationally feasible approach can then be devised to solve (3) efficiently, following <xref rid="btu317-B12" ref-type="bibr">Mairal and Yu (2012)</xref>.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Optimization with network flows</title>
      <p>A <italic>flow f</italic> on <inline-formula><mml:math id="I76"><mml:mrow><mml:mi>G</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> is defined as a non-negative function on arcs <inline-formula><mml:math id="I77"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> that satisfies conservation constraints: the sum of incoming flow at a vertex is equal to the sum of outgoing flow except for the source <italic>s</italic> and the sink <italic>t</italic>. Such conservation property leads to a physical interpretation about flows as quantities circulating in the network, for instance, water in a pipe network or electrons in a circuit board. The source node <italic>s</italic> injects into the network some units of flow, which move along the arcs before reaching the sink <italic>t</italic>.</p>
      <p>For example, given a path <inline-formula><mml:math id="I78"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script" class="calligraphy">P</mml:mi></mml:mrow></mml:math></inline-formula> and a non-negative number <inline-formula><mml:math id="I79"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we can make a flow by setting <inline-formula><mml:math id="I80"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> when <italic>u</italic> and <italic>v</italic> are two consecutive vertices along the path <italic>p</italic>, and <italic>f<sub>uv</sub></italic> = 0 otherwise. This construction corresponds to sending <inline-formula><mml:math id="I81"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> units of flows from <italic>s</italic> to <italic>t</italic> along the path <italic>p</italic>. Such simple flows are called (<italic>s</italic>, <italic>t</italic>)<italic>-path flows</italic>. More interestingly, if we have a set of non-negative weights <inline-formula><mml:math id="I82"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>ℝ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> associated to all paths in <inline-formula><mml:math id="I83"><mml:mi mathvariant="script" class="calligraphy">P</mml:mi></mml:math></inline-formula>, then we can form a more complex flow by superimposing all (<italic>s</italic>, <italic>t</italic>)-path flows according to
<disp-formula id="btu317-M4"><label>(4)</label><graphic xlink:href="btu317m4.jpg" position="float"/></disp-formula>
where <inline-formula><mml:math id="I84"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula> means that <italic>u</italic> and <italic>v</italic> are consecutive nodes on <italic>p</italic>.</p>
      <p>While (4) shows how to make a complex flow from simple ones, a converse exists, known as the <italic>flow decomposition theorem</italic> (see, e.g. <xref rid="btu317-B1" ref-type="bibr">Ahuja <italic>et al.</italic>, 1993</xref>). It says that for any DAG, every flow vector can always be decomposed into a sum of (<italic>s</italic>, <italic>t</italic>)-path flows. In other words, given a flow <inline-formula><mml:math id="I85"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>E</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, there exists a vector θ in <inline-formula><mml:math id="I86"><mml:mrow><mml:msubsup><mml:mi>ℝ</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="script" class="calligraphy">P</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> such that (4) holds. Moreover, there exist linear-time algorithms to perform this decomposition (<xref rid="btu317-B1" ref-type="bibr">Ahuja <italic>et al.</italic>, 1993</xref>). As illustrated in <xref ref-type="fig" rid="btu317-F2">Figure 2</xref>, this leads to a flow interpretation for isoforms.
<fig id="btu317-F2" position="float"><label>Fig. 2.</label><caption><p>Flow interpretation of isoforms using the same graph as in <xref ref-type="fig" rid="btu317-F1">Figure 1</xref>b. For the sake of clarity, some edges connecting <italic>s</italic> and <italic>t</italic> to internal nodes are not represented, and the length of the different bins is assumed to be equal. In (<bold>a</bold>), one unit of flow is carried along the path in red, corresponding to an isoform with abundance 1. In (<bold>b</bold>), another isoform with abundance 3 is added, yielding additional read counts at every node</p></caption><graphic xlink:href="btu317f2p"/></fig></p>
      <p>We now have all the tools in hand to turn (3) into a flow problem by following <xref rid="btu317-B12" ref-type="bibr">Mairal and Yu (2012)</xref>. Given a flow <inline-formula><inline-graphic xlink:href="btu317i2.jpg"/></inline-formula>, let us define the amount of flow incoming to a node <italic>v</italic> in <italic>V</italic>′ as <inline-formula><inline-graphic xlink:href="btu317i3.jpg"/></inline-formula> Given a vector <inline-formula><inline-graphic xlink:href="btu317i4.jpg"/></inline-formula> associated to <italic>f</italic> by the flow decomposition theorem, i.e<italic>.</italic> such that (4) holds, we remark that <inline-formula><inline-graphic xlink:href="btu317i5.jpg"/></inline-formula> and that <inline-formula><inline-graphic xlink:href="btu317i6.jpg"/></inline-formula>. Therefore, problem (3) can be equivalently rewritten as
<disp-formula id="btu317-M5"><label>(5)</label><graphic xlink:href="btu317m5.jpg" position="float"/></disp-formula>
where <inline-formula><mml:math id="I93"><mml:mi mathvariant="script" class="calligraphy">F</mml:mi></mml:math></inline-formula> denotes the set of possible flows. Once a solution <italic>f</italic>* of (5) is found, a solution θ* of (3) can be recovered by decomposing <italic>f</italic>* into (<italic>s</italic>, <italic>t</italic>)-path flows, as discussed in the next section.</p>
      <p>The use of network flows has two consequences. First, (5) involves a polynomial number of variables, as many as arcs in the graph, whereas this number was exponential in (3). Second, problem (5) falls into the class of <italic>convex cost flow</italic> problems (<xref rid="btu317-B1" ref-type="bibr">Ahuja <italic>et al.</italic>, 1993</xref>), for which efficient algorithms exist [The function (5) can be decomposed into costs <inline-formula><mml:math id="I97"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> over vertices <italic>v</italic>. The general convex cost flow objective function is usually presented as a sum of costs <inline-formula><mml:math id="I98"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> over arcs (<italic>u</italic>, <italic>v</italic>). It is however easy to show that costs over vertices can be reduced to costs over arcs by a simple network transformation (see <xref rid="btu317-B1" ref-type="bibr">Ahuja <italic>et al.</italic>, 1993</xref>, Section 2.4). Note that all arcs have zero lower capacities and infinite upper capacities.]. In our experiments, we implemented a variant of the scaling push-relabel algorithm (<xref rid="btu317-B5" ref-type="bibr">Goldberg, 1997</xref>), which also appears under the name of ε-relaxation method (<xref rid="btu317-B3" ref-type="bibr">Bertsekas, 1998</xref>). Note that the approach can be generalized to any concave likelihood function, including the Gaussian model used by IsoLasso and SLIDE.</p>
      <p>Network flows have been used in several occasions in bioinformatics. <xref rid="btu317-B13" ref-type="bibr">Medvedev and Brudno (2009)</xref> solve a convex cost flow problem on a bidirected de Bruijn graph for maximum likelihood whole genome shotgun assembly. <xref rid="btu317-B16" ref-type="bibr">Montgomery <italic>et al.</italic> (2010)</xref> introduced the formalism of flows for RNA-Seq data; however, they did not perform isoform discovery but quantification from a set of known transcripts. Their formulation is a linear program, the dimension of which is the number of candidate transcripts considered, which is not a network flow problem. <xref rid="btu317-B22" ref-type="bibr">Singh <italic>et al.</italic> (2011)</xref> uses the terminology of flows for RNA-Seq data in the context of testing differential transcription without reconstructing transcripts. Finally, while this article was under revision, <xref rid="btu317-B24" ref-type="bibr">Tomescu <italic>et al.</italic> (2013)</xref> published a similar method, which also uses minimum cost flow techniques for isoform recovery. However, their method only involves bins corresponding to exons and exon–exon junction and, more importantly, does not solve the <italic>penalized</italic> likelihood approach. They have therefore no principle way to balance the sparsity of the solution with its likelihood, and even mention that this leads to a NP-hard problem. To our knowledge, our work is the first to show that the sparsity-inducing <inline-formula><mml:math id="I99"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> penalty can be integrated with the likelihood term in the language of network flow, to estimate a flow with large likelihood that can be easily decomposed in a number of paths as small as we wish.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Flow decomposition</title>
      <p>We have seen that after solving (5) we need to decompose <italic>f</italic>* into (<italic>s</italic>, <italic>t</italic>)-path flows to obtain a solution θ* of (2). As illustrated in <xref ref-type="fig" rid="btu317-F2">Figure 2</xref>, this corresponds to finding the two isoforms from 2(b). Although the decomposition might not be ambiguous when <italic>f</italic>* is a sum of few (<italic>s</italic>, <italic>t</italic>)-path flows, it is not unique in general. Our approach to flow decomposition consists of finding an (<italic>s</italic>, <italic>t</italic>)-path carrying the maximum amount of flow (equivalently finding an isoform with maximum expression), removing its contribution from the flow and repeating until convergence. We remark that finding (<italic>s</italic>, <italic>t</italic>)-path flows according to this criterion can be done efficiently using dynamic programming, similarly as for finding a shortest path in a directed acyclic graph (<xref rid="btu317-B1" ref-type="bibr">Ahuja <italic>et al.</italic>, 1993</xref>). We insist on the fact that the flow decomposition returns one solution of the ℓ<sub>1</sub>-penalized estimator given by problem 3. This problem can have several solutions yielding the same objective value, and which are typically sparse in the number of transcripts (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu317/-/DC1">Supplementary Fig. S2</ext-link>). The non-uniqueness of the solution is not an artifact of our network flow approach, but a property of the ℓ<sub>1</sub>-penalized estimator. Algorithms such as SLIDE, NSMAP or others that explicitly enumerate the candidates and minimize the parameter in the candidate space also return one of several solutions. In parallel, the stability of the estimator is investigated in Section 4 of the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu317/-/DC1">Supplementary Material</ext-link>.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Model selection</title>
      <p>The last problem we need to solve is model selection: even if we know how to solve (2) efficiently, we need to choose a regularization parameter λ. For large values of λ, (2) yields solutions involving few expressed isoforms. As we decrease λ, more isoforms have a non-zero estimated expression <inline-formula><mml:math id="I105"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, leading to a better data fit but also leading to a more complex model. A classical way of balancing fit and model complexity is to use likelihood ratio tests. <xref rid="btu317-B28" ref-type="bibr">Xia <italic>et al.</italic> (2011)</xref> chose this approach, but we found the log likelihood ratio statistics to be empirically poorly calibrated because of the typically small number of samples units—exons—and the non-independence of the observed read counts. We choose a related approach, which we found better behaved, and select the model having the largest bayesian information criterion (BIC) (<xref rid="btu317-B21" ref-type="bibr">Schwarz, 1978</xref>). An alternative approach taken by <xref rid="btu317-B10" ref-type="bibr">Li <italic>et al.</italic> (2011a)</xref> would be to use stability selection (<xref rid="btu317-B14" ref-type="bibr">Meinshausen and Bühlmann, 2010</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 RESULTS</title>
    <p>We now compare our proposed method FlipFlop to Cufflinks (<xref rid="btu317-B26" ref-type="bibr">Trapnell <italic>et al.</italic>, 2010</xref>) version 2.0.0, IsoLasso (<xref rid="btu317-B11" ref-type="bibr">Li <italic>et al.</italic>, 2011b</xref>) version 2.6.1 and NSMAP (<xref rid="btu317-B28" ref-type="bibr">Xia <italic>et al.</italic>, 2011</xref>) on both simulated and real data. All experiments were run on a desktop computer on a single core of an Intel Xeon CPU X5460 3.16 Ghz with 16 GB of RAM. Reads are aligned to a reference genome by using TopHat (<xref rid="btu317-B25" ref-type="bibr">Trapnell <italic>et al.</italic>, 2009</xref>) version 2.0.6, and the constructed alignment files are used as input to the methods we compare. IsoLasso, Cufflinks and FlipFlop only use these aligned reads as input, and estimate their exon boundaries and TSS/PAS from read density. NSMAP additionally requires exon boundaries and known TSS/PAS as input. For paired-end experiments, we extended our initial model designed for single-end: a pair of reads is considered as a long single-end read. When the two reads of a pair span bins potentially separated by some exons, we use heuristics based on genomic distances to decide whether these exons are spliced. All software programs are used with default parameters, except that for paired-end experiments, we provide fragment length mean and standard deviation to IsoLasso, Cufflinks and FlipFlop. Note that all results can be easily reproduced by following the tutorials available at <ext-link ext-link-type="uri" xlink:href="http://cbio.ensmp.fr/flipflop/experiments.html">http://cbio.ensmp.fr/flipflop/experiments.html</ext-link>.</p>
    <sec id="SEC3.1">
      <title>3.1 Simulated human RNA-Seq data</title>
      <p>Because little is known about the true set of isoforms expressed in real data, we start our experimental validation with a set of simulations. We use the RNASeqReadSimulator software (<ext-link ext-link-type="uri" xlink:href="http://alumni.cs.ucr.edu/~liw/rnaseqreadsimulator.html">http://alumni.cs.ucr.edu/∼liw/rnaseqreadsimulator.html</ext-link>) to generate single-end and paired-end reads from the annotated human transcripts available in the UCSC genome browser (hg19). We restrict ourselves to the 1137 multi-exons genes on the positive strand for chromosome 1, corresponding to 3709 expressed transcripts.</p>
      <p>We follow the protocol of Isolasso (<xref rid="btu317-B11" ref-type="bibr">Li <italic>et al.</italic>, 2011b</xref>) and consider that a transcript from the annotation has been detected by a method if it predicts a transcript that (i) includes the same set of exons, and such that (ii) all internal boundary coordinates (i.e. all the exon coordinates except the beginning of the first exon and the end of the last exon) are identical. The objective for each method is to recover a large proportion of transcripts that were used for read generation—high recall—without detecting too many transcripts that were not used to generate the reads—high precision.</p>
      <p><xref ref-type="fig" rid="btu317-F3">Figure 3</xref> shows the precision and recall of the compared methods on single-end and paired-end simulations. Because we expect the difficulty of the deconvolution problem to increase with the number of transcripts of the gene, we stratify the result by this number: each dot represents the precision and recall of one method for genes with a particular number of transcripts in the UCSC annotation. As expected, genes with more transcripts lead to more difficult estimation problems and decreased performances for all methods. <xref ref-type="fig" rid="btu317-F3">Figure 3</xref>a shows single-end results for different read lengths from 100 to 300 bp and a fixed number of 1 million reads per experiment. FlipFlop clearly takes advantage of longer reads: the longer the read the better the accuracy for all transcript levels. For 100 bp long reads, FlipFlop and Cufflinks show similar results, while NSMAP gives slightly better precision and recall for two transcript level and degraded results compared with FlipFlop for more than four expressed transcripts. These differences might arise from the fact that NSMAP restricts its search to the TSS and PAS observed in the annotation, whereas FlipFlop estimates them from reads, and the fact that the two methods use different graphs and model selection techniques. For 300 bp long reads, FlipFlop outperforms all other methods as soon as there is more than one expressed transcript. For instance, for the three to four transcripts levels, FlipFlop achieves 75% of precision and 67% of recall, while Cufflinks reaches 74 and 52% and IsoLasso reaches 64 and 51%. This demonstrates that an adapted model for long reads is critical for isoform recovery. NSMAP optimizes a similar Poisson objective function as FlipFlop but only models reads at the exon or exon–exon junction levels; it looses statistical power when the read length increases. <xref ref-type="fig" rid="btu317-F3">Figure 3</xref>b shows paired-end results for 400 bp fragment length, 20 bp SD, 1 million read pairs and read lengths from 100 to 175 bp. Although our model is designed for single-end reads and is particularly adapted to long reads, it shows competitive or better accuracy for paired-end reads. Once again, when the read length increases, FlipFlop performance improves proportionally more than other methods. In <xref ref-type="fig" rid="btu317-F3">Figure 3</xref>c, the read length is set to 150 bp and the number of simulated reads varies from 1 million to 10 million. Increasing the coverage clearly helps FlipFlop, whereas it does not change much for Cufflinks and IsoLasso. Cufflinks constructs its set of transcripts and estimates their abundances in two separate steps, and the construction of the set of returned transcripts does not take read density into account: it intends to find the smallest set of isoforms covering all the observed reads. IsoLasso is based on penalized likelihood maximization like FlipFlop and NSMAP, but starts from a restricted set of isoforms—the same set returned by Cufflinks for single-end data. Consequently, this family of methods discards some information that can help identifying the set of expressed isoforms.
<fig id="btu317-F3" position="float"><label>Fig. 3.</label><caption><p>Precision and recall of compared methods on simulated reads from the UCSC annotated human transcripts. (a) Single-end reads with different lengths (100, 200, 300 bp). (b) Paired-end reads with different lengths (100, 125, 150, 175 bp). (c) Single-end reads with a fixed 150 bp length and an increasing amout of material (1, 5, 10 million)</p></caption><graphic xlink:href="btu317f3p"/></fig></p>
      <p>While results in <xref ref-type="fig" rid="btu317-F3">Figure 3</xref> are obtained with default parameters for all methods, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu317/-/DC1">Supplementary Figure S6</ext-link> of the supplementary shows performances when parameters are first tuned on an independent training set; in that case, results are not significantly different. Note that the number of exons of a gene significantly affects the difficulty of isoform reconstruction. We show in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu317/-/DC1">Supplementary Material</ext-link> (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu317/-/DC1">Supplementary Fig. S3</ext-link>) similar results to the ones presented in <xref ref-type="fig" rid="btu317-F3">Figure 3</xref> with stratification by number of exons instead of number of transcripts. We also detail in Section 6 of the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu317/-/DC1">Supplementary Material</ext-link> more realistic simulations that include typical library preparation and sequencing biases using another simulator—the Flux-Simulator (<xref rid="btu317-B6" ref-type="bibr">Griebel <italic>et al.</italic>, 2012</xref>), which aims at modeling RNA-Seq experiments <italic>in silico</italic>—and we show results that are consistent with the ones of <xref ref-type="fig" rid="btu317-F3">Figure 3</xref>.</p>
      <p><xref ref-type="fig" rid="btu317-F4">Figure 4</xref> shows the mean CPU time taken by each method to perform the deconvolution of genes with different sizes. Genes with more exons tend to have more candidate isoforms and experiments involving such genes are expected to take more time. Therefore, we stratify the observed times by exon number of the genes: each barplot represents the mean time taken by each method for finding the transcripts of genes having a particular number of exons. As expected, FlipFlop is always faster than NSMAP, more than a hundred times faster for genes with &gt;20 exons. FlipFlop speed is comparable with Cufflinks, and about four times slower than IsoLasso. This is because IsoLasso maximizes its objective over a very restricted set of candidates—in these simulations never more than nine and around two to three on an average. Overall, FlipFlop estimates the set of expressed isoforms for 1137 genes in &lt;9 min, i.e. about two genes per second. Note also that the time for data pre-preprocessing (finding exon boundaries and read counts for exons and junctions) is taken into account for all methods except NSMAP.
<fig id="btu317-F4" position="float"><label>Fig. 4.</label><caption><p>Average CPU times in milliseconds (logarithmic scale) for the compared methods with process a gene from human simulated 100 bp single-end reads</p></caption><graphic xlink:href="btu317f4p"/></fig></p>
      <p>These simulations confirm several facts. First, methods that identify and quantify transcripts as a single penalized maximum likelihood problem show good performances and take clear advantage of an increase in coverage. Second, correctly modeling long reads allows to greatly improve the accuracy of isoform reconstruction. Third, the proposed network flow strategy allows to solve the penalized likelihood approach quickly even when the set of candidate isoforms is extremely large.</p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Real RNA-Seq data</title>
      <p>Our second round of experiments involves two independent real human embryonic stem cell datasets. They both contain about 50 million 75 bp reads, either paired-end or single-end, with respectively NCBI SRA accession number SRR065504 and ERR361241.</p>
      <p>In the experiments of Section 3.1, we generated the reads based on a known set of transcripts. In the present case, the reads come from actual human tissues, and we do not have access to the true set of expressed transcripts. Following <xref rid="btu317-B28" ref-type="bibr">Xia <italic>et al.</italic> (2011)</xref> and <xref rid="btu317-B10" ref-type="bibr">Li <italic>et al.</italic> (2011a)</xref>, we choose to use the UCSC annotation as ground truth in the evaluation. Admittedly, this is not perfect as some expressed transcripts may be missing from the annotation, and some annotated transcripts may not be expressed in this particular experiment. However, agreement of the prediction with the set of known transcripts could be a good sign.</p>
      <p><xref ref-type="fig" rid="btu317-F5">Figure 5</xref> shows precision and recall of each method for different FPKM (Fragments Per Kilobase of exon per Million fragments mapped) levels. When considering all transcripts with predicted abundances higher than 1 FPKM, FlipFlop has a higher precision for both the paired-end and single-end datasets, while Cufflinks has a better recall. For transcripts with more than 5 FPKM abundance, all methods have a similar recall, with a slight advantage to Cufflinks, while FlipFlop shows a much better precision. Section 7 of the supplementary gives additional details on the real RNA-Seq data experiments: <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu317/-/DC1">Supplementary Figure S8</ext-link> shows the running time of the compared methods and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu317/-/DC1">Supplementary Figure S9</ext-link> corresponds to the precision-recall curves obtained for FlipFop when varying the model selection rule.
<fig id="btu317-F5" position="float"><label>Fig. 5.</label><caption><p>Precision and recall of compared methods on human embryonic stem cells data</p></caption><graphic xlink:href="btu317f5p"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>4 DISCUSSION</title>
    <p>Simultaneously tackling identification and quantitation using penalized likelihood maximization is known to be a powerful approach to estimate the set of expressed transcripts. However, existing <inline-formula><mml:math id="I106"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-regularized regression techniques cannot deal with genes that contain too many exons, as the set of candidate isoforms grows exponentially with the number <italic>n</italic> of exons. By leveraging network flow optimization algorithms, we discover a few expressed transcripts among the exponential number of candidates by solving a problem with a number of variables polynomial in <italic>n</italic>.</p>
    <p>We compared our approach to existing <inline-formula><mml:math id="I109"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-penalized likelihood maximization methods as well as methods that define expressed isoforms as the smallest set of transcripts covering all observed reads; the latter methods perform abundance estimation in a separate step. We observed on simulation data—where the true set of expressed transcripts is known—that, unlike the second set of methods, penalized likelihood maximization methods take advantage of an increase in read coverage. Moreover, we show that correctly modeling long reads is of primary importance for isoform recovery. Our approach, which models reads covering any number of exons, outperforms other methods for 300 bp long reads. We believe this is an important improvement as RNA-Seq technologies are moving forward longer reads. Our FlipFlop method has also shown to be competitive with state-of-the-art methods on real single-end and paired-end human stem cells data, especially for transcripts whose abundance was significant. In addition, the runtime of our method was comparable with the runtime of the second set of methods, and orders of magnitude faster than existing software for penalized likelihood maximization.</p>
    <p>We believe these results have important practical implications. In addition to the obvious gain in time when estimating the expression of transcripts for a single gene and a single sample, our approach makes the task amenable in a reasonable amount of time for all genes in a large number of samples. This is a necessary step for high-throughput differential expression studies at the transcript level, a direction we are planning to explore in future work. Differential expression studies were until now restricted to gene level studies, i.e. ignoring the transcript level information, to cases where the set of expressed transcripts was known in advance or to methods which were not using the read density to estimate the set of expressed transcripts—a less efficient approach as illustrated in our experiments. Furthermore, accurately estimating the transcript-level expression for all genes of all samples in a study may lead to improvements in molecular based diagnosis or prognosis tools, as well as in clustering of samples, e.g for cancer subtype discovery. The ability of our approach to deal with splicing graphs with potentially hundreds of nodes also paves the way to efficient <italic>de novo</italic> transcript identification, where we do not restrict ourselves to annotated exons within a single gene.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_30_17_2447__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu317_Bernard_Supp_IsoformFlows.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGMENTS</title>
    <p>The authors thank Wei Li for sharing the source code of IsoLasso for preprocessing RNA-Seq reads, and Matahi Moarii and Edouard Pauwels for insightful discussions.</p>
    <p><italic>Funding</italic>: This work was supported by the <funding-source>European Research Council</funding-source> (<award-id>SMAC-ERC-280032</award-id> to J-P.V., E.B.); the <funding-source>European Commission</funding-source> (<award-id>HEALTH-F5-2012-305626</award-id> to J-P.V., E.B.); the <funding-source>French National Research Agency</funding-source> (<award-id>ANR-09-BLAN-0051-04</award-id> and <award-id>ANR-11-BINF-0001</award-id> to J-P.V., E.B.); the Stand Up to Cancer grant (<funding-source>SU2C-AACR-DT0409</funding-source> to L.J.); the <funding-source>National Science Foundation</funding-source> (<award-id>SES-0835531</award-id>, <award-id>CCF-0939370</award-id> to J.M.); and the <funding-source>CNRS</funding-source> (project FlipFlop, under program PEPS-BMI).</p>
    <p><italic>Conflict of Interest:</italic> none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu317-B1">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ahuja</surname>
            <given-names>RK</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Network Flows: Theory, Algorithms, and Applications</source>
        <year>1993</year>
        <publisher-loc>Englewood Cliffs, New Jersey</publisher-loc>
        <publisher-name>Prentice Hall</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu317-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Behr</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mitie: simultaneous RNA-Seq based transcript identification and quantification in multiple samples</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>2529</fpage>
        <lpage>2538</lpage>
        <pub-id pub-id-type="pmid">23980025</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B3">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bertsekas</surname>
            <given-names>DP</given-names>
          </name>
        </person-group>
        <source>Network Optimization: Continuous and Discrete Models</source>
        <year>1998</year>
        <publisher-loc>Athena Scientific, Belmont, Massachusetts</publisher-loc>
        <publisher-name>Athena Scientific</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu317-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bohnert</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rätsch</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>rQuant.web: a tool for RNA-Seq-based transcript quantitation</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>W348</fpage>
        <lpage>W351</lpage>
        <pub-id pub-id-type="pmid">20551130</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldberg</surname>
            <given-names>AV</given-names>
          </name>
        </person-group>
        <article-title>An efficient implementation of a scaling minimum-cost flow algorithm</article-title>
        <source>J. Algorithm</source>
        <year>1997</year>
        <volume>22</volume>
        <fpage>1</fpage>
        <lpage>29</lpage>
      </element-citation>
    </ref>
    <ref id="btu317-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griebel</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Modelling and simulating generic rna-seq experiments with the flux simulator</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2012</year>
        <volume>40</volume>
        <fpage>10073</fpage>
        <lpage>10083</lpage>
        <pub-id pub-id-type="pmid">22962361</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heber</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Splicing graphs and EST assembly problem</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <issue>Suppl. 1</issue>
        <fpage>S181</fpage>
        <lpage>S188</lpage>
        <pub-id pub-id-type="pmid">12169546</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A robust method for transcript quantification with RNA-Seq data</article-title>
        <source>J. Comput. Biol.</source>
        <year>2013</year>
        <volume>20</volume>
        <fpage>167</fpage>
        <lpage>187</lpage>
        <pub-id pub-id-type="pmid">23461570</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>WH</given-names>
          </name>
        </person-group>
        <article-title>Statistical inferences for isoform expression in RNA-Seq</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1026</fpage>
        <lpage>1032</lpage>
        <pub-id pub-id-type="pmid">19244387</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sparse linear modeling of next-generation mRNA sequencing (RNA-Seq) data for isoform discovery and abundance estimation</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2011a</year>
        <volume>108</volume>
        <fpage>19867</fpage>
        <lpage>19872</lpage>
        <pub-id pub-id-type="pmid">22135461</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IsoLasso: a LASSO regression approach to RNA-Seq based transcriptome assembly</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011b</year>
        <volume>18</volume>
        <fpage>1693</fpage>
        <lpage>1707</lpage>
        <pub-id pub-id-type="pmid">21951053</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mairal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Supervised feature selection in graphs with path coding penalties and network flows</article-title>
        <source>JMLR</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>2449</fpage>
        <lpage>2485</lpage>
      </element-citation>
    </ref>
    <ref id="btu317-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medvedev</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brudno</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood genome assembly</article-title>
        <source>J. Comput. Biol.</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>1101</fpage>
        <lpage>1116</lpage>
        <pub-id pub-id-type="pmid">19645596</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meinshausen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bühlmann</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Stability selection</article-title>
        <source>J. Roy. Stat. Soc. B</source>
        <year>2010</year>
        <volume>72</volume>
        <fpage>417</fpage>
        <lpage>473</lpage>
      </element-citation>
    </ref>
    <ref id="btu317-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mezlini</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>iReckon: Simultaneous isoform discovery and abundance estimation from RNA-seq data</article-title>
        <source>Genome Res.</source>
        <year>2013</year>
        <volume>23</volume>
        <fpage>519</fpage>
        <lpage>529</lpage>
        <pub-id pub-id-type="pmid">23204306</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Montgomery</surname>
            <given-names>SB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptome genetics using second generation sequencing in a Caucasian population</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>464</volume>
        <fpage>773</fpage>
        <lpage>777</lpage>
        <pub-id pub-id-type="pmid">20220756</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="pmid">18516045</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scaffolding a caenorhabditis nematode genome with RNA-Seq</article-title>
        <source>Genome Res.</source>
        <year>2010</year>
        <volume>20</volume>
        <fpage>1740</fpage>
        <lpage>1747</lpage>
        <pub-id pub-id-type="pmid">20980554</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep surveying of alternative splicing complexity in the human transcriptome by high-throughput sequencing</article-title>
        <source>Nat. Genet.</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>1413</fpage>
        <lpage>1415</lpage>
        <pub-id pub-id-type="pmid">18978789</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular portraits of human breast tumours</article-title>
        <source>Nature</source>
        <year>2000</year>
        <volume>406</volume>
        <fpage>747</fpage>
        <lpage>752</lpage>
        <pub-id pub-id-type="pmid">10963602</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Estimating the dimension of a model</article-title>
        <source>Ann. Stat.</source>
        <year>1978</year>
        <volume>6</volume>
        <fpage>461</fpage>
        <lpage>464</lpage>
      </element-citation>
    </ref>
    <ref id="btu317-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singh</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>FDM: a graph-based statistical method to detect differential transcription using RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2633</fpage>
        <lpage>2640</lpage>
        <pub-id pub-id-type="pmid">21824971</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Regression shrinkage and selection via the Lasso</article-title>
        <source>J. R. Stat. Soc. B</source>
        <year>1996</year>
        <volume>58</volume>
        <fpage>267</fpage>
        <lpage>288</lpage>
      </element-citation>
    </ref>
    <ref id="btu317-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomescu</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A novel min-cost flow method for estimating transcript expression with rna-seq</article-title>
        <source>BMC Bioinformatics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>Suppl, 5</issue>
        <fpage>S15</fpage>
        <pub-id pub-id-type="pmid">23734627</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TopHat: discovering splice junctions with RNA-Seq</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1105</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="pmid">19289445</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>511</fpage>
        <lpage>515</lpage>
        <pub-id pub-id-type="pmid">20436464</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van’t Veer</surname>
            <given-names>LJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene expression profiling predicts clinical outcome of breast cancers</article-title>
        <source>Nature</source>
        <year>2002</year>
        <volume>415</volume>
        <fpage>530</fpage>
        <lpage>536</lpage>
        <pub-id pub-id-type="pmid">11823860</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NSMAP: a method for spliced isoforms identification and quantification from RNA-Seq</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>162</fpage>
        <pub-id pub-id-type="pmid">21575225</pub-id>
      </element-citation>
    </ref>
    <ref id="btu317-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xing</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An expectation-maximization algorithm for probabilistic reconstructions of full-length isoforms from splice graphs</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>3150</fpage>
        <lpage>3160</lpage>
        <pub-id pub-id-type="pmid">16757580</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
