<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4995760</article-id>
    <article-id pub-id-type="publisher-id">1176</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-016-1176-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FastProject: a tool for low-dimensional analysis of single-cell RNA-Seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>DeTomaso</surname>
          <given-names>David</given-names>
        </name>
        <address>
          <email>David.DeTomaso@berkeley.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Yosef</surname>
          <given-names>Nir</given-names>
        </name>
        <address>
          <email>niryosef@berkeley.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Department of Electrical Engineering and Computer Science and Center for Computational Biology, University of California, Berkeley, 97420 CA USA </aff>
      <aff id="Aff2"><label>2</label>Ragon Institute of Massachusetts General Hospital, Massachusetts Institute of Technology, and Harvard University, Boston, 02139 Massachusetts USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>8</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>8</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <issue>1</issue>
    <elocation-id>315</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>3</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>8</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver(<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p>A key challenge in the emerging field of single-cell RNA-Seq is to characterize phenotypic diversity between cells and visualize this information in an informative manner. A common technique when dealing with high-dimensional data is to project the data to 2 or 3 dimensions for visualization. However, there are a variety of methods to achieve this result and once projected, it can be difficult to ascribe biological significance to the observed features. Additionally, when analyzing single-cell data, the relationship between cells can be obscured by technical confounders such as variable gene capture rates.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>To aid in the analysis and interpretation of single-cell RNA-Seq data, we have developed FastProject, a software tool which analyzes a gene expression matrix and produces a dynamic output report in which two-dimensional projections of the data can be explored. Annotated gene sets (referred to as gene ‘signatures’) are incorporated so that features in the projections can be understood in relation to the biological processes they might represent. FastProject provides a novel method of scoring each cell against a gene signature so as to minimize the effect of missed transcripts as well as a method to rank signature-projection pairings so that meaningful associations can be quickly identified. Additionally, FastProject is written with a modular architecture and designed to serve as a platform for incorporating and comparing new projection methods and gene selection algorithms.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Here we present FastProject, a software package for two-dimensional visualization of single cell data, which utilizes a plethora of projection methods and provides a way to systematically investigate the biological relevance of these low dimensional representations by incorporating domain knowledge.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s12859-016-1176-5) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-Cell</kwd>
      <kwd>RNA-Seq</kwd>
      <kwd>Dimensionality reduction</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U01MH105979</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yosef</surname>
            <given-names>Nir</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U01HG007910</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yosef</surname>
            <given-names>Nir</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>T32</award-id>
        <principal-award-recipient>
          <name>
            <surname>DeTomaso</surname>
            <given-names>David</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007487</institution-id>
            <institution>BASF Corporation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CARA</award-id>
        <principal-award-recipient>
          <name>
            <surname>DeTomaso</surname>
            <given-names>David</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>In an analogous manner to the maturation of RNA-Seq methodologies, single-cell RNA-Seq (scRNA-Seq) is now in its infancy and requires new computational tools to realize its full potential for dissecting and understanding the functional meaning of cell-to-cell heterogeneity [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Visualization methods provide an effective strategy for inspecting and characterizing the phenotypic diversity between cells. In a typical scenario, the analysis begins with a matrix of expression levels of thousands of genes in hundreds of cells. An appealing way to make sense out of this immense data is to project it into a two dimensional scatter-plot, where each cell is represented by a single point. While such representations provide an easy way to see obvious stratification of cells into a taxonomy of discrete types, they can also provide more nuanced views of gradual transitions, reflecting for instance, developmental processes [<xref ref-type="bibr" rid="CR3">3</xref>], physical locations [<xref ref-type="bibr" rid="CR4">4</xref>], or the cell cycle [<xref ref-type="bibr" rid="CR5">5</xref>]. Indeed, supplementing these two-dimensional views with additional, phenotypical information (e.g. the expression level of marker genes) can be used to provide the correct context, and make the observed diversity between cells interpretable [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]).</p>
    <p>There are three main challenges in making effective use of such visualizations for scRNA-Seq data. The first challenge is selecting an appropriate method for dimensionality reduction (projection) among candidates such as principal component analysis (PCA) [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], independent component analysis (ICA) [<xref ref-type="bibr" rid="CR3">3</xref>] or various non-linear methods such as t-distributed stochastic neighbor embedding (t-SNE) [<xref ref-type="bibr" rid="CR8">8</xref>], each of which may highlight different aspects of the data. Once a projection is created, a second challenge is to interpret its biological significance, namely which cellular phenotypes [<xref ref-type="bibr" rid="CR7">7</xref>] or processes [<xref ref-type="bibr" rid="CR9">9</xref>] are most responsible for the resulting arrangement of cells. Lastly, scRNA-Seq can be difficult to correctly interpret due to technical confounders such as differences in gene capture rates [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. Performing functional interpretation on the input data without accounting for this effect may lead to incorrect interpretation of the biological meaning of cell-to-cell heterogeneity.</p>
    <sec id="Sec2">
      <title>Introducing FastProject</title>
      <p>To address these issues, we have developed FastProject, a software tool for the visualization and interpretation of scRNA-Seq data. FastProject allows the user to explore a gene expression matrix using a plethora of two-dimensional visualization methods. To interpret these two-dimensional plots, we use the concept of biological signatures - sets of genes that represent either a collection of genes with a common associated function (e.g. Glycolysis) or a dichotomy between two cellular states of interest (e.g. naïve vs. memory CD8 T-cells)[<xref ref-type="bibr" rid="CR7">7</xref>]. We evaluate the extent to which these phenotypic dichotomies are reflected in the projections (i.e. to what extent do neighboring cells in the projection have similar values for the genes included in the signature), and highlight the significant projection-signature pairs. This analysis is made possible in single cells by modeling the probability that a missed transcript was actually expressed in the cell, and using these probabilities when evaluating signature scores on samples to minimize the effect of variable capture rates between cells. As a source for biological signatures, we use publicly available datasets that consist of comparative information from hundreds of studies (e.g. MSigDB [<xref ref-type="bibr" rid="CR12">12</xref>]), which can be supplemented by the user to include any other gene signatures of interest. Through this automated analysis, FastProject therefore provides a systematic view of the main axes of variation in the data, along with their possible biological meaning.</p>
      <p>Compared with currently-available software, FastProject is unique in the combination of methods it employs. Visualization software such as viSNE [<xref ref-type="bibr" rid="CR6">6</xref>], although designed for cytometry data, allows for the integrated visualization of transcript levels overlaid on a two-dimensional tSNE projection. However, viSNE does not incorporate the use of gene sets or provide a method to systematically search for biological variation within a two-dimensional projection. Another method, PAGODA [<xref ref-type="bibr" rid="CR13">13</xref>], makes use of gene sets, but does so in the context of a clustered heatmap of expression data, not a 2-dimensional embedding.</p>
      <p>It is important to clarify up-front that FastProject is not a normalization tool. Indeed, it has been observed by us and others that without proper normalization scRNA-Seq data can be heavily confounded by technical factors such as library depth and complexity [<xref ref-type="bibr" rid="CR7">7</xref>]. We strongly advocate the use of scRNA-Seq normalization tools (e.g. based on [<xref ref-type="bibr" rid="CR5">5</xref>] or [<xref ref-type="bibr" rid="CR7">7</xref>]) prior to any downstream analysis, and we assume that the data has been normalized prior to input to FastProject. Nevertheless, since scRNA-Seq measurements tend to be characterized by strong zero-inflation, we conduct our biological signature analysis while aiming to minimize the effect of gene dropout events (i.e. false negatives, described in [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]).</p>
      <p>When running FastProject, processing is done upfront, producing dozens of projection maps (using different algorithms and parameterizations) and their functional annotation, which can be inspected through an interactive HTML report. On a typical data set, consisting of around 1000 cells, processing time is typically between 10 and 30 min (see Additional file <xref rid="MOESM1" ref-type="media">1</xref> for benchmarking results). Because processing is performed upfront, the user can quickly switch between different projection maps in the output report as well as share the results with colleagues who would not themselves need to install FastProject. Importantly, FastProject has been written to be easily extensible so that it may serve as a general platform for deploying and evaluating new gene filtering schemes, false-negative estimation methods, or projection techniques. Instructions for developers on how to augment FastProject are detailed in the FastProject wiki hosted at <ext-link ext-link-type="uri" xlink:href="https://github.com/YosefLab/FastProject/wiki">https://github.com/YosefLab/FastProject/wiki</ext-link>.</p>
    </sec>
  </sec>
  <sec id="Sec3">
    <title>Implementation</title>
    <sec id="Sec4">
      <title>Overview</title>
      <p>The steps involved in the FastProject processing pipeline are depicted in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.
<fig id="Fig1"><label>Fig. 1</label><caption><p>The FastProject pipeline. <bold>a</bold> Diagram describing the FastProject pipeline. A gene expression matrix is taken as input (<italic>left</italic>), and the resulting output report (<italic>right</italic>) combines low dimensional-representations of the input with gene signatures to highlight signatures which best explain features in the data. <bold>b</bold> Configurations for the projection that can be selected among in the output report</p></caption><graphic xlink:href="12859_2016_1176_Fig1_HTML" id="MO1"/></fig></p>
      <p>The software starts with an evaluation of false negative rates, later used to down-weight the effect of drop-outs on the biological signature analysis. It then selects sufficiently variable genes for further analysis using increasingly stringent criteria. With these genes in hand, FastProject uses 11 different projection methods (summarized below) to calculate two dimensional coordinate for each cell. Based on a user-provided database of gene signatures it then computes a score for every cell/signature pair and uses a randomization test to identify statistically significant projection-signature associations. Importantly, the confounding effect of missed transcripts is mitigated by estimating the probability that each undetected gene was actually expressed in the cell, and down-weighting the contributions of these measurements in downstream analysis (similar to [<xref ref-type="bibr" rid="CR7">7</xref>]). Altogether, FastProject outputs 76 possible projections (a combination of choosing different gene filtering criteria, whether or not the data was reduced to significant PCs prior to projection, and the final projection method) along with their functional annotations, which can be interactively inspected through a user-friendly HTML report (Figs. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">b</xref> and <xref rid="Fig3" ref-type="fig">3</xref>). The results are also provided in the form of text files (including signature scores, projection coordinates etc.), which can be used for downstream analysis.
</p>
    </sec>
    <sec id="Sec5">
      <title>False-negative estimates</title>
      <p>To account for expressed transcripts that are not detected (false negatives) due to the limitations in sensitivity [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR15">15</xref>], an initial step in the processing pipeline is to evaluate these detection rates so that the subsequent analysis can down-weight the contribution of less reliably measured transcripts. More specifically, it has been observed that the detection probability for a transcript varies with the transcripts relative abundance measurement as well as the total amount of RNA in the sample [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR14">14</xref>]. To characterize this, we calculate a false negative rate curve which estimates the probability of detection based on a gene’s abundance. A separate curve is estimated for each cell individually so that varying levels of library quality and cell integrity can be accounted for.</p>
      <p>To perform this estimate, our procedure utilizes a set of human housekeeping genes [<xref ref-type="bibr" rid="CR16">16</xref>] under the assumption that these housekeeping genes are constitutively expressed in all cells and only missed due to technical errors. Importantly, as the appropriate set of constitutively expressed genes may differ from study to study and between organisms, FastProject can accept a user-defined housekeeping list.</p>
      <p>Our estimation of false negative rates is built on and extends upon our previous work [<xref ref-type="bibr" rid="CR7">7</xref>]. For each housekeeping gene, we estimate its mean expression level by taking the average of non-zero measurements for the gene. We then use the estimated means to group the genes into 30 quantiles, and denote the mean of genes in quantile 1≤<italic>q</italic>≤30 as <italic>μ</italic><sub><italic>q</italic></sub>. For each cell <italic>j</italic> and quantile <italic>q</italic>, we then compute <italic>F</italic><sub><italic>jq</italic></sub> as the proportion of genes from <italic>q</italic> that are not detected by <italic>j</italic>. Based on our assumption of constitutive expression, we treat <italic>F</italic><sub><italic>jq</italic></sub> as an empirical estimate to the dropout rates (i.e. probability that a gene is not detected, given that it is expressed). We use the <italic>F</italic><sub><italic>jq</italic></sub> values to fit a sigmoid function <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {F}_{j}(\cdot)$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq1.gif"/></alternatives></inline-formula> that describes the observed dropout rates as a function the genes’ average expression when detected (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">a</xref>): 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \hat{F}_{j}(x)=1/(1+\exp(\alpha_{j} \cdot (x-\beta_{j})))  $$ \end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where the estimated parameters <italic>α</italic><sub><italic>j</italic></sub> and <italic>β</italic><sub><italic>j</italic></sub> minimize the residual sum of squares (RSS) term: 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \sum\limits_{q=1}^{30}(\hat{F}_{j} (\mu_{q}) - F_{jq})^{2}  $$ \end{document}</tex-math><mml:math id="M6"><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>30</mml:mn></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jq</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Applying the fitted function globally for all genes, we estimate the conditional probability for a dropout event for gene <italic>i</italic> in cell <italic>j</italic> as: <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P(\text {Gene i is not detected in cell j} \mid \text {Gene i is expressed by cell j})=\hat {F}_{j}(\mu _{i})$\end{document}</tex-math><mml:math id="M8"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mtext>Gene i is not detected in cell j</mml:mtext><mml:mo>∣</mml:mo><mml:mtext>Gene i is expressed by cell j</mml:mtext><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq2.gif"/></alternatives></inline-formula> where <italic>μ</italic><sub><italic>i</italic></sub> is the average of gene <italic>i</italic>’s expression level when detected. Finally, we estimate the prior probabilities for detection and expression of each gene in order to evaluate weights for the missed transcripts, <italic>P</italic>(Gene i is not expressed by cell j∣Gene i isnot detected in cell j), as described in the <xref rid="Sec17" ref-type="sec">Methods</xref> section. These probability estimates are used further in the pipeline to reduce the effect of missed transcripts when evaluating signature scores and generating projections. As a first step in validating the efficacy of this approach, a set of simulations were performed (Additional file <xref rid="MOESM2" ref-type="media">2</xref>, procedure detailed in the “<xref rid="Sec17" ref-type="sec">Methods</xref>” section) in which FastProject’s weighting procedure was able to distinguish between true negatives (representing unexpressed genes) and false negatives (representing technical drop-outs).</p>
      <p>The fitted sigmoids <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {F}_{j}(\cdot)$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq3.gif"/></alternatives></inline-formula> can also be used to provide an overall evaluation of the abundance of false negatives in each cell <italic>j</italic> by taking the area under the curve. This in turn provides a way to identify and exclude poor quality samples, assuming that such samples have higher dropout rates. Such quality control filter (on cells) is available in FastProject and can be enabled when running the pipeline (it is turned off by default). With this option enabled, samples that score 1.6 median absolute deviation (MAD) units worse than the median quality score are removed prior to calculating signatures and low-dimensional projections.</p>
    </sec>
    <sec id="Sec6">
      <title>Generating 2-dimensional projections</title>
      <sec id="Sec7">
        <title>Gene filtering</title>
        <p>Selecting an informative set of genes is necessary for obtaining biologically meaningful patterns of variability between cells. To this end, FastProject applies a strict pre-filtering step that discards genes detected in less than a threshold number of cells. The default threshold is 20 % of the input cells, however this is configurable as an input option. Subsequently, FastProject produces projections that derive from all pre-filtered genes as well as subsets thereof, calculated using either of two filtering schemes. The first filter option selects bimodal genes, a characteristic which in the past has been useful in isolating biological variation (e.g. cytokines related to Th17 differentiation [<xref ref-type="bibr" rid="CR7">7</xref>] or antiviral and inflammatory response genes in stimulated dendritic cells [<xref ref-type="bibr" rid="CR17">17</xref>]). In FastProject bimodal genes are selected using the Hartigan’s Dip Test (<italic>p</italic>&lt;0.05). The second filter option selects highly-variable genes, based on their Fano-factor (<italic>σ</italic><sup>2</sup>/<italic>μ</italic> where <italic>μ</italic> is the average expression and <italic>σ</italic> the standard deviation across all cells). An increase in the Fano factor past a value of 1 indicates a departure from a Poisson statistic, which is the steady state distribution expected of constitutively expressed genes [<xref ref-type="bibr" rid="CR18">18</xref>]. To select candidates with high Fano-factor, similar to the procedure in [<xref ref-type="bibr" rid="CR19">19</xref>], genes are first stratified into 30 quantiles according to <italic>μ</italic>, and within each quantile genes are retained if their Fano-factor is more than 2 MAD above the quantile’s median Fano-factor.</p>
      </sec>
      <sec id="Sec8">
        <title>Projection methods</title>
        <p>The variety of methods available for the task of dimensionality reduction each come with strengths and weaknesses. For instance, projections of scRNA-Seq data based on PCA [<xref ref-type="bibr" rid="CR7">7</xref>], provide an appealing guarantee about the preservation of variation, and makes the contribution of individual genes readily interpretable [<xref ref-type="bibr" rid="CR6">6</xref>]. However, the underlying assumptions of PCA may not necessarily be supported by single cell data. In particular, PCA is a linear transformation, which may not be able to accurately capture non-linear relationships in the data (i.e. if the data is embedded within a non-linear low-dimensional manifold). Additionally, PCA posits that the projection axes should be uncorrelated, which again may not necessarily result in the most informative representation. The same criticisms apply for other linear methods such as ICA [<xref ref-type="bibr" rid="CR3">3</xref>]. A complementary, and commonly used approach (t-SNE [<xref ref-type="bibr" rid="CR8">8</xref>]) uses a non-linear projection that aims to preserve the structure in the data locally. However, while this method aims to ensure that points that are close in the high dimensional space will be close (with high probability) in the low dimensionality embedding, more global relations are not directly interpretable from the results. To avoid the issue of choosing up-front between these different options, FastProject uses these methods plus additional non-linear projection methods, including: ISOMAP [<xref ref-type="bibr" rid="CR20">20</xref>] (using four nearest neighbors when defining the adjacency graph), PCA with a radial basis function (RBF) kernel (with kernel coefficient of <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\frac {1}{\text {Number of genes}}$\end{document}</tex-math><mml:math id="M12"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>Number of genes</mml:mtext></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq4.gif"/></alternatives></inline-formula>), Multi-Dimensional Scaling (MDS), and Spectral Embedding [<xref ref-type="bibr" rid="CR21">21</xref>] (with Graph laplacian formed using k-nearest neighbors with <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$k=\frac {\text {Number of cells}}{10}$\end{document}</tex-math><mml:math id="M14"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext>Number of cells</mml:mtext></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq5.gif"/></alternatives></inline-formula>). For the linear PCA we consider three combinations of principal components (1st and 2nd, 1st and 3rd, 2nd and 3rd); and for tSNE we use two perplexity values (10 and 30), totaling in 11 projection methods overall. All methods are run as implemented in the Scikit-Learn package for Python [<xref ref-type="bibr" rid="CR22">22</xref>]. After each projection, the resulting sets of 2-dimensional coordinates are mean-centered and scaled such that the average <italic>r</italic><sup>2</sup>=[<italic>x</italic><italic>c</italic><italic>o</italic><italic>o</italic><italic>r</italic><italic>d</italic><italic>i</italic><italic>n</italic><italic>a</italic><italic>t</italic><italic>e</italic>]<sup>2</sup>+[<italic>y</italic><italic>c</italic><italic>o</italic><italic>o</italic><italic>r</italic><italic>d</italic><italic>i</italic><italic>n</italic><italic>a</italic><italic>t</italic><italic>e</italic>]<sup>2</sup> equals 1. This standardization is performed so that signature-projection scores (defined below) are more comparable between projections.</p>
      </sec>
      <sec id="Sec9">
        <title>Incorporating false-negative estimates into projections</title>
        <p>Non-linear methods such as t-SNE have been shown to effectively combine with PCA. In this approach, PCA is performed first to reduce high-dimensional data to an intermediate number of dimensions, and this intermediate representation is further reduced to 2 or 3 dimensions by the non-linear method. The procedure is effective, assuming that the initial PCA operation preserves the main structure of the data while discarding unnecessary components.</p>
        <p>FastProject makes use of this procedure to allow for a general method of incorporating weights (derived from false-negative estimates) into nonlinear projections. Prior to a non-linear projection, a weighted-PCA is performed by using a weighted covariance matrix (similar to [<xref ref-type="bibr" rid="CR7">7</xref>]). Entries in the weighted covariance matrix are calculated as: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ cov(X_{a}, X_{b}) = \frac{ {\sum\nolimits}_{j}(X_{aj} - \overline{X}_{a})(X_{bj} - \overline{X}_{b})w_{aj}w_{bj}}{ {\sum\nolimits}_{j}w_{aj}w_{bj}}  $$ \end{document}</tex-math><mml:math id="M16"><mml:mtext mathvariant="italic">cov</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">aj</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bj</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">aj</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bj</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">aj</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bj</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>X</italic><sub><italic>ij</italic></sub> is the log-transformed expression of gene <italic>i</italic> in cell <italic>j</italic> and <italic>w</italic> represents the matrix of weights of equivalent size, defined as: 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {}\begin{aligned} w_{ij} = \left\{ \begin{array}{cc} P(\text{i not expressed in j} \mid \text{i not detected in j}) &amp; X_{ij}=0 \\ 1 &amp; X_{ij} \ne 0 \end{array}\right. \end{aligned}  $$ \end{document}</tex-math><mml:math id="M18"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mtext>i not expressed in j</mml:mtext><mml:mo>∣</mml:mo><mml:mtext>i not detected in j</mml:mtext><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>To select the number of components to retain, following weighted-PCA, the software employs a randomization scheme, as described in [<xref ref-type="bibr" rid="CR23">23</xref>], to select the top principal components with statistically significant (<italic>p</italic>&lt;0.05) contribution to the overall variance (retaining at least 5 components when less than 5 are significant). All the subsequent non-linear projections are evaluated on this reduced-dimension matrix. To provide a way for evaluating the effects of this reduction, FastProject also runs each non-linear projection method on the original, non-reduced matrix, allowing the user to switch between these representations in the output report.</p>
      </sec>
    </sec>
    <sec id="Sec10">
      <title>Signature-based analysis</title>
      <p>To interpret the biological meaning of the organization of cells in the resulting two dimensional maps, FastProject incorporates domain knowledge through the input of gene “signatures” [<xref ref-type="bibr" rid="CR7">7</xref>]. The signatures can reflect a comparative analysis between two conditions of interest and consist of a set of genes, each of which is labeled as either “up-regulated” or “down-regulated” in that comparison. Signatures, such as these, are based off of annotations of cell states obtained from public databases (e.g. the Immsig collection [<xref ref-type="bibr" rid="CR12">12</xref>]), or provided by the user. For each signature, a score is computed against each cell by aggregating over the weighted expression level of its genes. Specifically, for signature <italic>S</italic> and cell <italic>j</italic>, the respective signature score <italic>R</italic><sub><italic>s</italic></sub>(<italic>j</italic>) is calculated as: 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ R_{s}(j) = \sum\limits_{i \in S} {sign}_{S}(i) \cdot X'_{ij} \cdot w_{ij} / \sum\limits_{i \in S} w_{ij}  $$ \end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mtext mathvariant="italic">sign</mml:mtext></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Where <inline-formula id="IEq6"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$X^{\prime }_{ij}$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq6.gif"/></alternatives></inline-formula> is the standardized (Z-normalized across all cells) log expression level of gene <italic>i</italic> in cell <italic>j</italic>,<italic>w</italic><sub><italic>ij</italic></sub> is the estimated False-Negative weight (defined above), and <italic>s</italic><italic>i</italic><italic>g</italic><italic>n</italic><sub><italic>S</italic></sub>(<italic>i</italic>)=−1 for genes in the "down-regulated" set and +1 otherwise. Notably, signatures can also be undirected, in which case the sign value is set to +1 for all member genes.</p>
    </sec>
    <sec id="Sec11">
      <title>Projections vs. signatures</title>
      <p>A signature-projection consistency score is calculated to evaluate how well each projection reflects the phenotypic variation that is captured by each signature. To this end, for each pair of signature, <italic>s</italic>, and projection, <italic>p</italic>, we compute a signature consistency score representing the extent to which neighboring points in the projection have similar signature scores. This is done by calculating for each cell <italic>j</italic>, an estimated signature rank <inline-formula id="IEq7"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {r}_{sp}(j)$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sp</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq7.gif"/></alternatives></inline-formula> based on its location in the two dimensional plot: 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \hat{r}_{sp}(j) = \frac{ {\sum\nolimits}_{k \ne j} r_{s}(k) e^{\Delta^{2}_{jk}/\alpha^{2}}}{ {\sum\nolimits}_{k \ne j} e^{\Delta^{2}_{jk}/\alpha^{2}}}  $$ \end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sp</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>Δ</italic><sub><italic>jk</italic></sub> is the Euclidean distance between cells <italic>j</italic> and <italic>k</italic> in the projection, <italic>α</italic> defines an effective neighborhood size (set to 0.33 by default), and <italic>r</italic><sub><italic>s</italic></sub>(<italic>j</italic>) is the rank of the signature score for cell <italic>j</italic> (i.e. a rank transformation of the quantitative signature scores <italic>R</italic><sub><italic>S</italic></sub>). The signature-projection consistency is then determined by the respective goodness of fit: 
<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ Consistency(s,p)=1-\frac{median(| \hat{r}_{sp} - r_{s} |)}{Total\ Cell\ Count}  $$ \end{document}</tex-math><mml:math id="M28"><mml:mtext mathvariant="italic">Consistency</mml:mtext><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mtext mathvariant="italic">median</mml:mtext><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sp</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Total</mml:mtext><mml:mspace width="1em"/><mml:mtext mathvariant="italic">Cell</mml:mtext><mml:mspace width="1em"/><mml:mtext mathvariant="italic">Count</mml:mtext></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>In this way, each signature/projection pairing is scored based on how similar signature scores are for samples located nearby in the projection space. To identify significantly consistent signature/projection pairs, we use signatures of randomly selected genes to create empirical background distributions of signature scores. We compare the consistency scores computed for the original signatures with those of the random ones (for example, see Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">a</xref>), obtaining <italic>P</italic>-values using a Z-test and correcting for multiple hypothesis testing using the Benjamini Hochberg procedure. We observed that the distribution parameters of scores generated by random signatures varied with the number of genes in the signature. To account for this, separate distributions are generated for different signature sizes (10, 20, 50, 100, and 200 genes) and when assessing the significance of a signature score, the score is compared against the background distribution with the most similar number of genes. In the output, we report all the signatures that had a significant match (<italic>F</italic><italic>D</italic><italic>R</italic>&lt;0.05) with at least one projection.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Behavior of Signature Scores. Behavior of signature scores calculated on the human glioblastoma scRNA-seq data from Patel et al., 2014 [<xref ref-type="bibr" rid="CR2">2</xref>]. <bold>a</bold> Distribution of Signature/Projection consistency scores across four different types of signatures, Signed (signed immunological signatures from MSigDB), Unsigned (various unsigned hallmark and pathway signatures from MSigDB), Random Signed (signed signatures with randomly selected genes), and Random Unsigned (unsigned signatures with randomly selected genes). Lower panel shows distributions from the same signatures, run on data in which gene expression levels have been shuffled within each cell. Comparing these, it can be seen that biological signatures tend to have higher consistency scores than random signatures and this distinction disappears using shuffled data. <bold>b</bold> Distribution of the Pearson’s correlation coefficient between signature scores and a confounding variable - the proportion of undetected genes in a sample. Upper plot shows correlations when signature are calculated by simply taking the unweighted average of log expression level for genes in the signature. Lower panel shows the effect of using the weighted method presented here</p></caption><graphic xlink:href="12859_2016_1176_Fig2_HTML" id="MO3"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec12" sec-type="results">
    <title>Results</title>
    <sec id="Sec13">
      <title>Software</title>
      <p>FastProject has been implemented as a command line Python package. As an input the software receives: (1) an expression matrix in a tab-delimited format (genes in rows, cells in columns). (2) a set of gene signatures, using the standard GMT format. Such sets of directed signatures are publicly available from various databases, such as MsigDB [<xref ref-type="bibr" rid="CR12">12</xref>] (e.g. including signaling effects of genetic and chemical perturbations, cell cycle signatures, and comparison of cell types) and NetPath [<xref ref-type="bibr" rid="CR24">24</xref>] (transcriptional effects of signaling cascades). Un-directed gene sets are naturally more abundant, and can be drawn from resources such as Gene Ontology [<xref ref-type="bibr" rid="CR25">25</xref>], KEGG [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>], and MSigDB [<xref ref-type="bibr" rid="CR12">12</xref>] (note that the latter includes much of the information in the former two). Importantly, the user can also upload his/her own signatures that reflect a phenotype of interest. For instance, in the example below, we study glioblastoma cells, and use signatures derived from microarray experiments, which define different tumor sub-types. FastProject also accepts pre-computed signatures, namely, an association of cells with pre-computed values. These can be categorical (e.g. annotations of clusters, computed by a different tool); or numerical (e.g. additional meta data associated with cells; e.g. levels of a handful of proteins, or technical factors such as library complexity; see <xref rid="Sec17" ref-type="sec">Methods</xref> section for description of how pre-computed signatures are analyzed).</p>
      <p>FastProject will calculate projections, signature scores, and their associations, covering all the options above (totaling in 76 different projections; Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">b</xref>). To examine the extent to which the projections are affected by zero values, FastProject treats the sample quality score (defined above), and the percentage of genes with zero expression as pre-computed signatures and evaluates their association with each projection method. The output is provided as an HTML file (Fig. <xref rid="Fig3" ref-type="fig">3</xref>), where projections, signatures and their associations can be inspected interactively. Additionally, a data export feature embedded in the HTML report allows the generation of tab-delimited text files that depict the output projection coordinates, signature scores, and other relevant information. The source code, running, examples and user manual are bundled with this manuscript submission and also hosted at <ext-link ext-link-type="uri" xlink:href="https://github.com/YosefLab/FastProject">https://github.com/YosefLab/FastProject</ext-link>.
<fig id="Fig3"><label>Fig. 3</label><caption><p>FastProject Output Report. <bold>a</bold> Screenshot of FastProject interactive output report. 1) Controls for changing which genes were used when generating the projection and whether or not PCA was applied first. 2) Table displaying significance of the consistency score for each signature/projection pairing. Each row represents a signature and each column, a projection method. Clicking a cell in the table selects a signature and projection. 3) Scatter plot showing the selected projection annotated (color) with signature scores from the selected signature. 4) Heatmap showing average expression level of genes within each cluster. The clustering method can be changed through the dropdown menu in the same panel. <bold>b</bold> Corresponding scatterplot when selecting projection tSNE30 and the Patient signature. <bold>c</bold> Scatterplot for a signature representing response to the PPAR <italic>γ</italic> agonist rosiglitazone</p></caption><graphic xlink:href="12859_2016_1176_Fig3_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Extending FastProject</title>
      <p>FastProject has been designed using a modular architecture so that new projection methods or criteria to filter genes can easily be added to the pipeline. Since dimensionality reduction is still an active research area, this allows new methods to easily be compared against more traditional approaches. For example, the recently proposed ZIFA algorithm [<xref ref-type="bibr" rid="CR28">28</xref>] can be added by appending the following lines to Projections.py:</p>
      <p>
        <graphic xlink:href="12859_2016_1176_Figa_HTML.gif" id="MO4"/>
      </p>
      <p>This is documented in the software wiki, hosted with the project repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/YosefLab/FastProject/wiki">https://github.com/YosefLab/FastProject/wiki</ext-link>.</p>
    </sec>
    <sec id="Sec15">
      <title>Proof of concept</title>
      <p>We applied FastProject to a recently published data sets of tumor cells from five glioblastoma patients [<xref ref-type="bibr" rid="CR2">2</xref>]. The analyzed data, consisting of 430 single cells with mRNA abundance in units of transcripts per million (TPM) and normalized as described in [<xref ref-type="bibr" rid="CR2">2</xref>], was downloaded from the Gene Expression Omnibus, accession number GSE57872. We applied FastProject on this data, using a large collection of both “signed” (i.e. up- and down- regulated genes) and “unsigned” signatures from MSig DB (the C2 (curated), H (Hallmark), and C7 (Immune signatures) collections) and NetPath [<xref ref-type="bibr" rid="CR24">24</xref>].</p>
      <p>As a first check, we explored the distributions of signature consistency scores obtained for the original vs. random signatures, and compared the results to an application of FastProject on randomized datasets, where the entries in each column (Cell) were shuffled (i.e. maintaining the percentage of zeroes in every cell; Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">a</xref>). As expected, we see pronounced differences between the original input signatures and the randomized ones when FastProject is applied on the non-shuffled data, and these differences disappear when we apply FastProject on the randomized data. As a second test, we evaluated the extent by which the signature consistency scores are biased by the abundance of zero-values in the analyzed cells. As expected, when we do not down-weigh the potential false negative entries, the signature consistency scores highly correlate with the amount of zeroes in each cell; namely the analysis primarily reflect what might be a result of technical dropouts. Conversely, down-weighing the false negatives reduces this bias (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">b</xref>). We repeated this procedure using a second dataset of scRNA-Seq data from mouse dendritic cells responding to antigen stimulation [<xref ref-type="bibr" rid="CR1">1</xref>], obtaining similar results (Additional files <xref rid="MOESM3" ref-type="media">3</xref> and <xref rid="MOESM4" ref-type="media">4</xref>).</p>
      <p>Examining the output report of FastProject (Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">a</xref>), we first observe that the various projection methods correctly stratify the cells according to their respective donors (Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">b</xref>). More importantly, FastProject automatically picks up on several of the most important features in this data, providing a proof of concept for its utility as an unbiased analysis tool. Specifically, the two dimensional position of the cells is highly consistent with their scoring according to an epithelial to mesenchymal transition signature, which is a strong marker of poor prognosis [<xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR30">30</xref>]. The two dimensional positions are also associated with signatures of other key pathways altered in cancer, including immune and hypoxic responses as detailed below. While these observations were made using a general database of signatures (MSigDB), we supplemented our analysis with case-specific signatures - in this case gene signatures from TCGA that are predictive of Glioblastoma subtypes [<xref ref-type="bibr" rid="CR30">30</xref>] to provide further support. As expected we see high level of concordance between the TCGA-derived scores of the Mesenchymal tumor sub-type and the epithelial to mesenchymal transition signatures from MSigDB. We also see the mirror image of the cell ranking when we consider the TCGA-derived signature of the Proneural tumor subtype of glioblastoma.</p>
      <p>In addition to the HTML report, FastProject outputs all the cell-signature scores in textual format. Taking advantage of this feature, we were able to more closely inspect the relationship between the different pathways that were highly correlated with the two dimensional positions and reveal new associations in the data. Considering the top ranked signatures (<italic>p</italic>&lt;10<sup>−15</sup> for at least one projection method), and filtering overlapping signatures (Jaccard coefficient &gt;30 <italic>%</italic>; 63 signatures remaining), we observe a clear pattern of signature clusters (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Interestingly, the mesenchymal signature is positively correlated with the expression of coagulation/complement genes (whose expression in the glioblastoma cells studied here was already verified by [<xref ref-type="bibr" rid="CR2">2</xref>]). Both signatures are also correlated with the TNF <italic>α</italic> signaling, which supports previous findings concerning the role of this pathway in mesenchymal emergence [<xref ref-type="bibr" rid="CR31">31</xref>]. On the other hand, the mesenchymal signature is negatively correlated with a hypoxia signature. While hypoxic regions are characteristic in solid tumors [<xref ref-type="bibr" rid="CR32">32</xref>], this inverse correlation is surprising and possibly aligned with the up-regulation of angiogenetic markers in mesenchymal glioblastoma tumors [<xref ref-type="bibr" rid="CR29">29</xref>]. Finally, we see a strong negative correlation with a signature of response to the PPAR <italic>γ</italic> agonist rosiglitazone, which aligns with previous observations of beneficial effects PPAR <italic>γ</italic> agonists have in glioblastoma [<xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR35">35</xref>]. In addition to the inter-donor variation, FastProject’s visualization also highlights potentially important variation within a tumor. Indeed, the cells from patient MGH31 (Fig. <xref rid="Fig3" ref-type="fig">3</xref><xref rid="Fig3" ref-type="fig">b</xref>, purple) are clearly divided in accordance to the two programs mentioned above - with cells with low mesenchymal and high hypoxic score on one side and the mirror image on the other.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Discovering Correlations between Signatures. FastProject makes its data amenable to further analysis by outputting signature scores and projection coordinates in text format. Shown here is a covariance matrix between top-ranked signatures (<italic>p</italic>&lt;10<sup>−15</sup> for at least one projection method) after removing overlapping signatures (<italic>J</italic>
<italic>a</italic>
<italic>c</italic>
<italic>c</italic>
<italic>a</italic>
<italic>r</italic>
<italic>d</italic>
<italic>c</italic>
<italic>o</italic>
<italic>e</italic>
<italic>f</italic>
<italic>f</italic>
<italic>i</italic>
<italic>c</italic>
<italic>i</italic>
<italic>e</italic>
<italic>n</italic>
<italic>t</italic>&gt;30 <italic>%</italic>) revealing signatures with similar patterns of expression</p></caption><graphic xlink:href="12859_2016_1176_Fig4_HTML" id="MO5"/></fig></p>
      <p>The glioblastoma case study underscores the utility of FastPtroject as a tool for scRNA-Seq data exploration. Starting from a normalized input matrix of gene expression in single cells, and a generic set of signatures, it clearly highlighted some of the main sources for phenotypic variation between cells, and the relation between these sources. Such insights provide an important first step in working with data sets an immense and as complex as the one presented here.</p>
    </sec>
  </sec>
  <sec id="Sec16" sec-type="conclusion">
    <title>Conclusions</title>
    <p>FastProject is a flexible, comprehensive, and automated pipeline that combines multiple techniques for the analysis of scRNA-Seq. It provides a first glance on the main axes of variation in the data (captured by projections of interest) and their biological meaning (the biological signatures that may explain the organization of cells within the projections). The tool was designed with a flexible API in mind, with the aim of establishing a general platform that will be used by the scRNA-Seq research community for deployment and evaluation of future methods, such as normalization, batch correction, removal of undesired effects (cell cycle, drop-outs), gene/cell filtering, and dimensionality reduction.</p>
  </sec>
  <sec id="Sec17">
    <title>Methods</title>
    <sec id="Sec18">
      <title>False-negative estimates</title>
      <p>Let <italic>P</italic>(<italic>E</italic><sub><italic>ij</italic></sub>∣<italic>N</italic><italic>o</italic><italic>t</italic><italic>D</italic><sub><italic>ij</italic></sub>) denote the probability that a gene <italic>i</italic> is expressed in cell <italic>j</italic> conditioned that it is not detected (i.e. probability for a false negative). To estimate this probability we first estimate the priors for the detection, <italic>P</italic>(<italic>D</italic><sub><italic>ij</italic></sub>), and expression, <italic>P</italic>(<italic>E</italic><sub><italic>ij</italic></sub>), events:</p>
      <p>For <italic>P</italic>(<italic>D</italic><sub><italic>ij</italic></sub>) we use the percentage of cells that detect gene <italic>i</italic> (<italic>e</italic><italic>x</italic><italic>p</italic><italic>r</italic><italic>e</italic><italic>s</italic><italic>s</italic><italic>i</italic><italic>o</italic><italic>n</italic>&gt;0), which we denote as <inline-formula id="IEq8"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\bar {D_{i}}$\end{document}</tex-math><mml:math id="M30"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq8.gif"/></alternatives></inline-formula>. For <italic>P</italic>(<italic>E</italic><sub><italic>ij</italic></sub>), one approach would be to use: 
<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\small{\begin{aligned} P(E_{ij}) &amp; = \frac{P(E_{ij}\ and\ D_{ij})}{P(D_{ij} \mid E_{ij})} \\ &amp; = \frac{P(D_{ij})}{P(D_{ij} \mid E_{ij})} \\ &amp; \approx \frac{P(D_{ij})}{1-\hat{F}_{j}(\mu_{i})} \\ &amp; \approx \frac{\bar{D_{i}}}{1 - 1/(1+\exp(\alpha_{j} \cdot (\mu_{i} - \beta_{j})))} \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M32"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mtext mathvariant="italic">and</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>μ</italic><sub><italic>i</italic></sub> is the average of gene <italic>i</italic>’s log expression when detected and <inline-formula id="IEq9"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {F}_{j}(\mu _{i})$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq9.gif"/></alternatives></inline-formula> (defined in Eq. <xref rid="Equ1" ref-type="">1</xref>) represents <italic>P</italic>(<italic>N</italic><italic>o</italic><italic>t</italic><italic>D</italic><sub><italic>ij</italic></sub>∣<italic>E</italic><sub><italic>ij</italic></sub>) for each cell. However, in order to get a more robust estimation, we use the population mean of the conditional probability, taking: <inline-formula id="IEq10"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P(E_{ij}) \approx \frac {\bar {D_{i}}}{\frac {1}{N} {\sum \nolimits }_{k=1}^{N} P(D_{ik} \mid E_{ik})}$\end{document}</tex-math><mml:math id="M36"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq10.gif"/></alternatives></inline-formula> where N is the number of cells in the dataset. Combining these terms, the full expression is: 
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \begin{aligned} P(E_{ij} \mid Not\ D_{ij}) &amp; = \frac{P(Not\ D_{ij} \mid E_{ij})P(E_{ij})}{P(Not\ D_{ij})} \\ &amp; = \frac{P(Not\ D_{ij} \mid E_{ij})\frac{\bar{D_{i}}}{\frac{1}{N} {\sum\nolimits}_{k=1}^{N} P(D_{ik} \mid E_{ik})}}{1 - \bar{D_{i}}} \\ &amp; = \frac{\hat{F}_{j}(\mu_{i})\frac{\bar{D_{i}}}{\frac{1}{N} {\sum\nolimits}_{k=1}^{N}1-\hat{F}_{k}(\mu_{i})}}{1 - \bar{D_{i}}} \\ \end{aligned}  $$ \end{document}</tex-math><mml:math id="M38"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mtext mathvariant="italic">Not</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">Not</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">Not</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="italic">Not</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msubsup><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>This value is then complemented to obtain <italic>P</italic>(<italic>N</italic><italic>o</italic><italic>t</italic><italic>E</italic><sub><italic>ij</italic></sub>|<italic>N</italic><italic>o</italic><italic>t</italic><italic>D</italic><sub><italic>ij</italic></sub>) (the true negative probability), which is used to weight missed transcripts. Notably, on occasions where the detection rate in a cell is higher than the prior estimate, this formulation results in a negative value. We therefore restrict the estimate to the range [ 0,1] by applying a clipping operation.</p>
    </sec>
    <sec id="Sec19">
      <title>Simulating false-negatives</title>
      <p>To evaluate our approach, we first applied it on simulated data. Count values for each gene were either set to zero (with probability <italic>P</italic><sub><italic>i</italic></sub>) or drawn from a negative binomial distribution parameterized by the mean, <italic>μ</italic><sub><italic>i</italic></sub>, and the dispersion, <inline-formula id="IEq11"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\gamma _{i} = ({\sigma ^{2}_{i}} - \mu _{i})/{\mu _{i}^{2}}$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq11.gif"/></alternatives></inline-formula>. <italic>P</italic><sub><italic>i</italic></sub> was set to 1.0 for the first 500 genes (considered to be housekeeping genes, and therefore constitutively active) and varied uniformly from 0 to 1 for the remaining genes. <italic>μ</italic><sub><italic>i</italic></sub> was generated from an exponential distribution with <italic>m</italic><italic>e</italic><italic>a</italic><italic>n</italic>=75 and <italic>γ</italic> was generated using a uniform distribution from 0 to 4 (reasonable distributions and ranges for <italic>μ</italic> and <italic>γ</italic> found by measuring these parameters using non-zero values from the Shalek et al. [<xref ref-type="bibr" rid="CR1">1</xref>] single-cell data). The generated counts were transformed using <italic>l</italic><italic>o</italic><italic>g</italic>(<italic>x</italic>+1). In this way, an expression matrix of 3000 genes across 2000 cells was simulated.</p>
      <p>After generating ‘true’ expression data, sigmoidal drop-out curves (as defined in Eq. <xref rid="Equ1" ref-type="">1</xref>) were generated for each cell by drawing <italic>α</italic> and <italic>β</italic> from uniform distributions (<italic>α</italic>∈[ 2,6];<italic>β</italic>∈[ 1,3]). Using these curves, ‘measured’ expression data was generated by dropping-out non-zero measurements using each cell’s drop-out characteristic and each gene’s non-zero mean. Using FastProject’s weight-estimation procedure, weights were estimated using the ‘measured’ data matrix. For comparison purposes, weights were also generated using the likelihood, <italic>P</italic>(<italic>D</italic><italic>e</italic><italic>t</italic><italic>e</italic><italic>c</italic><italic>t</italic><italic>i</italic><italic>o</italic><italic>n</italic>∣<italic>E</italic><italic>x</italic><italic>p</italic><italic>r</italic><italic>e</italic><italic>s</italic><italic>s</italic><italic>i</italic><italic>o</italic><italic>n</italic>), as described in Gaublomme et al. [<xref ref-type="bibr" rid="CR7">7</xref>]. The results, detailed in Additional file <xref rid="MOESM2" ref-type="media">2</xref>, demonstrate that FastProject’s weighting system produces different weight distributions for true negatives (un-expressed genes) as opposed to false negatives (dropped-out genes), assigning higher weights to the true negatives, as would be expected in an effective weighting procedure.</p>
    </sec>
    <sec id="Sec20">
      <title>Clustering</title>
      <p>For each of the projections, the FastProject HTML report includes a simple clustering analysis using the cells’ positioning in the respective two dimensional map. Specifically, samples are clustered based on Euclidean distance in the two-dimensional space using k-means with different <italic>k</italic> values. These clusters are used when rendering a heat-map below the projection showing the (per cluster) average z-score of expression for each gene in the signature.</p>
    </sec>
    <sec id="Sec21">
      <title>Evaluating the consistency of projections and categorical pre-computed signatures</title>
      <p>A different method is used to evaluate the significance of signature/projection pairings when operating on pre-computed signatures. For numerical pre-computed signatures, the assigned values are shuffled among cells and for each iteration of this procedure, the signature/projection consistency score is evaluated. <italic>P</italic>-values are then assessed by comparing the unshuffled score against this distribution using a Z-test as above. For factor signatures, it is necessary to calculated the consistency score in a different manner. To this end, for each pair of signature <italic>s</italic> and projection <italic>p</italic> we compute a signature consistency score representing the extent to which neighboring points in the projection are assigned to the same category. First, we evaluate a neighborhood-consistency score for every cell: 
<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\small{\begin{aligned} \hat{L}_{sp}(j) = \frac{ {\sum\nolimits}_{k \ne j} \delta_{s}(j,k) e^{- \frac{\Delta^{2}_{jk} }{\alpha^{2}}}}{ {\sum\nolimits}_{k \ne j} e^{- \frac{\Delta^{2}_{jk} }{\alpha^{2}}}} \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M42"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sp</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where 
<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\small{\begin{aligned} \delta_{s}(j,k) = \left\{ \begin{array}{cc} 1 &amp; \text{samples k and j have the same label} \\ 0 &amp; otherwise \end{array}\right. \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M44"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mtext>samples k and j have the same label</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mtext mathvariant="italic">otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>In this way, <inline-formula id="IEq12"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {L}_{sp}(i)$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sp</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2016_1176_Article_IEq12.gif"/></alternatives></inline-formula> is closer to 1 if most of sample <italic>i</italic>’s neighbors have the same label. The signature-projection consistency is then determined by a measure of the overall consistency: 
<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ Consistency(s,p)=median(\hat{L}_{sp}(j))  $$ \end{document}</tex-math><mml:math id="M48"><mml:mtext mathvariant="italic">Consistency</mml:mtext><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">median</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">sp</mml:mtext></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math><graphic xlink:href="12859_2016_1176_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>These consistency scores are compared against a distribution of scores calculated from shuffled label assignments to assess significance using a Z-test as above.</p>
    </sec>
  </sec>
  <sec id="Sec22">
    <title>Availability and requirements</title>
    <p><bold>Project Name:</bold> FastProject.<bold>Software Repository:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/yoseflab/fastproject">https://github.com/yoseflab/fastproject</ext-link>.<bold>Software Manual:</bold><ext-link ext-link-type="uri" xlink:href="https://github.com/YosefLab/FastProject/wiki">https://github.com/YosefLab/FastProject/wiki</ext-link>.<bold>Archived Versions:</bold><ext-link ext-link-type="uri" xlink:href="https://pypi.python.org/pypi/FastProject">https://pypi.python.org/pypi/FastProject</ext-link>.<bold>Operating Systems:</bold> Platform-Independent.<bold>Programming language:</bold> Python.<bold>License:</bold> Free for Educational, Research, and Not-For-Profit purposes. Results from the analysis in this article can by found at <ext-link ext-link-type="uri" xlink:href="https://github.com/YosefLab/FastProject/wiki/Example-Output-Reports">https://github.com/YosefLab/FastProject/wiki/Example-Output-Reports</ext-link>.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec23">
        <title>Additional files</title>
        <p>
          <media position="anchor" xlink:href="12859_2016_1176_MOESM1_ESM.png" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p>Benchmarking FastProject. Memory and run-time are measured as the number of genes and cells vary. When varying the number of genes, 200 cells were used, and when varying the number of cells, an input matrix of 2000 genes was used. “Lean” mode is an option that may be selected at run-time which disables some projection methods that were found to scale poorly with the number of samples (MDS, Spectral Embedding) as well as removing extra filter steps (HDT, Fano Factor). Trials run using a compute cluster with 40 Intel Xeon E5-2690 processors at 3 GHz, but intentionally limited to either 4 or 20 threads during the run-time tests. (PNG 188 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2016_1176_MOESM2_ESM.png" id="MOESM2">
            <label>Additional file 2</label>
            <caption>
              <p>Simulation of False-Negative Weight Estimation Procedure. A) A simulation to test FastProject’s ability to distinguish genes that are biologically inactive (True Negatives) from genes dropped out due to technical artifacts (False Negatives). B) The Kolmogorov-Smirnov (KS) statistic is used to distinguish between distributions of true and false negatives. Here it can be seen that the true negatives tend to be assigned higher weights. This is contrasted with the weighting scheme used in a previous study (Gaublomme et al. 2015 [<xref ref-type="bibr" rid="CR7">7</xref>]) in which the true and false negatives are not as differentiated. C-E) The KS statistic’s for either scheme, as in (B), as simulation parameters are varied. C) Tests varying the parameter which controls the mean of the exponential distribution from which <italic>μ</italic> is drawn. D) False-negative curves are estimated using a mixture of housekeeping genes and non-housekeeping genes. It can be seen that the choice of good housekeeping genes is beneficial, but not critical. E) The steepness of the generated false-negative curves, <italic>α</italic>, is varied. (PNG 258 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2016_1176_MOESM3_ESM.png" id="MOESM3">
            <label>Additional file 3</label>
            <caption>
              <p>Behavior of Signature Scores: Alternate Data Set. Behavior of signature scores calculated from the LPS-stimulated dendritic cells of Shalek et al. 2014 [<xref ref-type="bibr" rid="CR1">1</xref>]. A) Distribution of Signature/Projection consistency scores across four different types of signatures, Signed (signed immunological signatures from MSigDB), Unsigned (various unsigned hallmark and pathway signatures from MSigDB), Random Signed (signed signatures with randomly selected genes), and Random Unsigned (unsigned signatures with randomly selected genes). Lower panel shows distributions from the same signatures, run on data in which gene expression levels have been shuffled within each cell. B) Distribution of the Pearson’s correlation coefficient between signature scores and a confounding variable - the proportion of undetected genes in a sample. Upper plot shows correlations when signature are calculated by simply taking the unweighted average of log expression level for genes in the signature. Lower panel shows the effect of using the weighted method presented here. (PNG 152 kb)</p>
            </caption>
          </media>
        </p>
        <p>
          <media position="anchor" xlink:href="12859_2016_1176_MOESM4_ESM.png" id="MOESM4">
            <label>Additional file 4</label>
            <caption>
              <p>Signature-Projection Pairings. An example of signature/projection pairings from FastProject run on a subset of cells from Shalek et al. 2014 [<xref ref-type="bibr" rid="CR1">1</xref>]. Analysis was run on bone marrow dendritic cells, stimulated with LPS and sequenced after 1–6 h. For comparison purposes, the same projection (ISOMAP on genes selected by the Fano Factor filter) is used for each plot. A) The arrangement of cells in the ISOMAP projection can be seen to largely agree with the time of sequencing, post stimulation. B) Cells at later times score higher on the HALLMARK_INFLAMMATORY signature from the MSIGDB collection. C-E) Temporal signatures generated from Amit et al. 2009 [<xref ref-type="bibr" rid="CR36">36</xref>]. Signatures generated by taking the top 200 up and down-regulated genes, between adjacent time points, and removing genes with less than a 2-fold difference. Changes in these signature scores can be seen to largely correspond with the temporal labels in (A). All signature/projection pairings, A-E, were found to be significant by FastProject (<italic>p</italic>≤0.05). (PNG 339 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>EM</term>
        <def>
          <p>Expectation maximization</p>
        </def>
      </def-item>
      <def-item>
        <term>FNC</term>
        <def>
          <p>False-negative curve</p>
        </def>
      </def-item>
      <def-item>
        <term>HTML</term>
        <def>
          <p>Hypertext markup language</p>
        </def>
      </def-item>
      <def-item>
        <term>ICA</term>
        <def>
          <p>Independent component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>LPS</term>
        <def>
          <p>Lipopolysaccharide</p>
        </def>
      </def-item>
      <def-item>
        <term>MAD</term>
        <def>
          <p>Median absolute deviation</p>
        </def>
      </def-item>
      <def-item>
        <term>MDS</term>
        <def>
          <p>Multidimensional scaling</p>
        </def>
      </def-item>
      <def-item>
        <term>MsigDB</term>
        <def>
          <p>Molecular signatures database</p>
        </def>
      </def-item>
      <def-item>
        <term>PCA</term>
        <def>
          <p>Principal component analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>RBF</term>
        <def>
          <p>Radial basis function</p>
        </def>
      </def-item>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p>Single cell RNA-seq</p>
        </def>
      </def-item>
      <def-item>
        <term>TPM</term>
        <def>
          <p>Transcripts per million</p>
        </def>
      </def-item>
      <def-item>
        <term>t-SNE</term>
        <def>
          <p>t-Distributed stochastic neighbor embedding</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <ack>
    <p>Not applicable.</p>
    <sec id="d30e3306">
      <title>Funding</title>
      <p>DD was funded by a National Institutes of Health NRSA Trainee appointment on grant number T32 and by the California Research Alliance by BASF (CARA). NY was supported by NIH grants U01MH105979 and U01HG007910.</p>
    </sec>
    <sec id="d30e3311">
      <title>Authors’ contributions</title>
      <p>NY and DD conceived and wrote the manuscript. DD implemented the software and analyzed the data. Both authors read and approved the final manuscript.</p>
    </sec>
    <sec id="d30e3316">
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="d30e3321">
      <title>Consent for publication</title>
      <p>Not applicable.</p>
    </sec>
    <sec id="d30e3326">
      <title>Ethics approval and consent to participate</title>
      <p>Not applicable.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shuga</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gertner</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Gaublomme</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fowler</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Weaver</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Raychowdhury</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hacohen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>May</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq reveals dynamic paracrine control of cellular variation</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>509</volume>
        <issue>7505</issue>
        <fpage>363</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">24919153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Gillespie</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wakimoto</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cahill</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Nahed</surname>
            <given-names>BV</given-names>
          </name>
          <name>
            <surname>Curry</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Martuza</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Louis</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Rozenblatt-Rosen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Suvà</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>
        <source>Science (New York)</source>
        <year>2014</year>
        <volume>344</volume>
        <issue>6190</issue>
        <fpage>1396</fpage>
        <lpage>401</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1254257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cacchiarelli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grimsby</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pokharel</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Morse</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lennon</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Livak</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Mikkelsen</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>381</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id>
        <?supplied-pmid 24658644?>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id>
        <?supplied-pmid 25867923?>
        <pub-id pub-id-type="pmid">25867923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Casale</surname>
            <given-names>FP</given-names>
          </name>
          <name>
            <surname>Proserpio</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Scialdone</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>2</issue>
        <fpage>155</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3102</pub-id>
        <?supplied-pmid 25599176?>
        <pub-id pub-id-type="pmid">25599176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amir</surname>
            <given-names>E-aD</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Tadmor</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Simonds</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Bendall</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Shenfeld</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Krishnaswamy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Pe’er</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>31</volume>
        <issue>6</issue>
        <fpage>545</fpage>
        <lpage>2</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2594</pub-id>
        <pub-id pub-id-type="pmid">23685480</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaublomme</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gertner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Pandolfi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mak</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kuchroo</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Single-Cell Genomics Unveils Critical Regulators of Th17 Cell Pathogenicity</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>163</volume>
        <issue>6</issue>
        <fpage>1400</fpage>
        <lpage>1412</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.11.009</pub-id>
        <?supplied-pmid 26607794?>
        <pub-id pub-id-type="pmid">26607794</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Maaten</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hinton</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Visualizing Data using t-SNE</article-title>
        <source>J Mach Learn Res</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>2579</fpage>
        <lpage>605</lpage>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kafri</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ginzberg</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Oh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lahav</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Kirschner</surname>
            <given-names>MW</given-names>
          </name>
        </person-group>
        <article-title>Dynamics extracted from fixed cells reveal feedback linking cell growth to cell cycle</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>494</volume>
        <issue>7438</issue>
        <fpage>480</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11897</pub-id>
        <?supplied-pmid 23446419?>
        <pub-id pub-id-type="pmid">23446419</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramsköld</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Faridani</surname>
            <given-names>OR</given-names>
          </name>
          <name>
            <surname>Daniels</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Loring</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Laurent</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Full-length mRNA-Seq from single-cell levels of RNA and individual circulating tumor cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <issue>8</issue>
        <fpage>777</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2282</pub-id>
        <?supplied-pmid 22820318?>
        <pub-id pub-id-type="pmid">22820318</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brennecke</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Kołodziejczyk</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Proserpio</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Baying</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Benes</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Heisler</surname>
            <given-names>MG</given-names>
          </name>
        </person-group>
        <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>11</issue>
        <fpage>1093</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2645</pub-id>
        <?supplied-pmid 24056876?>
        <pub-id pub-id-type="pmid">24056876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Paulovich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pomeroy</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>43</issue>
        <fpage>15545</fpage>
        <lpage>50</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Salathia</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kaeser</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Herman</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Kaper</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Chun</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
        </person-group>
        <article-title>Characterizing transcriptional heterogeneity through pathway and gene set overdispersion analysis</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>3</issue>
        <fpage>241</fpage>
        <lpage>4</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3734</pub-id>
        <?supplied-pmid 26780092?>
        <pub-id pub-id-type="pmid">26780092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marinov</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>McCue</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Schroth</surname>
            <given-names>GP</given-names>
          </name>
          <name>
            <surname>Gertz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Wold</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>From single-cell to cell-pool transcriptomes: stochasticity in gene expression and RNA splicing</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <issue>3</issue>
        <fpage>496</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.161034.113</pub-id>
        <?supplied-pmid 24299736?>
        <pub-id pub-id-type="pmid">24299736</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Ramsköld</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reinius</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sandberg</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-seq reveals dynamic, random monoallelic gene expression in mammalian cells</article-title>
        <source>Science (New York)</source>
        <year>2014</year>
        <volume>343</volume>
        <issue>6167</issue>
        <fpage>193</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1245316</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisenberg</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Levanon</surname>
            <given-names>EY</given-names>
          </name>
        </person-group>
        <article-title>Human housekeeping genes are compact</article-title>
        <source>Trends Genet (TIG)</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>7</issue>
        <fpage>362</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1016/S0168-9525(03)00140-9</pub-id>
        <pub-id pub-id-type="pmid">12850439</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Gertner</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Gaublomme</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Raychowdhury</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yosef</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Malboeuf</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hacohen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptomics reveals bimodality in expression and splicing in immune cells</article-title>
        <source>Nature</source>
        <year>2013</year>
        <volume>498</volume>
        <issue>7453</issue>
        <fpage>236</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1038/nature12172</pub-id>
        <?supplied-pmid 23685454?>
        <pub-id pub-id-type="pmid">23685454</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Munsky</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Neuert</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Using gene expression noise to understand gene regulation</article-title>
        <source>Science (New York)</source>
        <year>2012</year>
        <volume>336</volume>
        <issue>6078</issue>
        <fpage>183</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1216379</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Bialas</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kamitaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Martersteck</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weitz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sanes</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McCarroll</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1202</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tenenbaum</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>de Silva</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Langford</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>A global geometric framework for nonlinear dimensionality reduction</article-title>
        <source>Science (New York)</source>
        <year>2000</year>
        <volume>290</volume>
        <issue>5500</issue>
        <fpage>2319</fpage>
        <lpage>323</lpage>
        <pub-id pub-id-type="doi">10.1126/science.290.5500.2319</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <mixed-citation publication-type="other">Campbell K, Ponting CP, Webber C. Laplacian eigenmaps and principal curves for high resolution pseudotemporal ordering of single-cell RNA-seq profiles. Technical report. 2015. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/027219">10.1101/027219</ext-link>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/027219">http://dx.doi.org/10.1101/027219</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Blondel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Prettenhofer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dubourg</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vanderplas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Passos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cournapeau</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Brucher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Perrot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Duchesnay</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Scikit-learn: Machine Learning in {P}ython</article-title>
        <source>J Mach Learn Res</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>2825</fpage>
        <lpage>830</lpage>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eyuboglu</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Remarks on Parallel Analysis</article-title>
        <source>Multivar Behav Res</source>
        <year>1992</year>
        <volume>27</volume>
        <issue>4</issue>
        <fpage>509</fpage>
        <lpage>40</lpage>
        <pub-id pub-id-type="doi">10.1207/s15327906mbr2704_2</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kandasamy</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Mohan</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Raju</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Keerthikumar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>GSS</given-names>
          </name>
          <name>
            <surname>Venugopal</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Telikicherla</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Navarro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Mathivanan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pecquet</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gollapudi</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>Tattikota</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Mohan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Padhukasahasram</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Subbannayya</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Goel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jacob</surname>
            <given-names>HKC</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sekhar</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nanjappa</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Balakrishnan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Subbaiah</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ramachandra</surname>
            <given-names>YL</given-names>
          </name>
          <name>
            <surname>Rahiman</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Prasad</surname>
            <given-names>TSK</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>JX</given-names>
          </name>
          <name>
            <surname>Houtman</surname>
            <given-names>JCD</given-names>
          </name>
          <name>
            <surname>Desiderio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Renauld</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Constantinescu</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Ohara</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Hirano</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kubo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Draghici</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bader</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Leonard</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Pandey</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>NetPath: a public resource of curated signal transduction pathways</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-1-r3</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashburner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ball</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cherry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Dolinski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dwight</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Eppig</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Issel-Tarver</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kasarskis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Matese</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Ringwald</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Sherlock</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium</article-title>
        <source>Nat Genet</source>
        <year>2000</year>
        <volume>25</volume>
        <issue>1</issue>
        <fpage>25</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/75556</pub-id>
        <?supplied-pmid 10802651?>
        <pub-id pub-id-type="pmid">10802651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>
        <source>Nucleic Acids Res</source>
        <year>2000</year>
        <volume>28</volume>
        <issue>1</issue>
        <fpage>27</fpage>
        <lpage>30</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id>
        <?supplied-pmid 10592173?>
        <pub-id pub-id-type="pmid">10592173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kawashima</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Furumichi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tanabe</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Data, information, knowledge and principle: back to metabolism in KEGG</article-title>
        <source>Nucleic Acids Res</source>
        <year>2014</year>
        <volume>42</volume>
        <issue>Database issue</issue>
        <fpage>199</fpage>
        <lpage>205</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt1076</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pierson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>ZIFA: Dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>241</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0805-z</pub-id>
        <?supplied-pmid 26527291?>
        <pub-id pub-id-type="pmid">26527291</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Phillips</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Kharbanda</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Forrest</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Soriano</surname>
            <given-names>RH</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Misra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nigro</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Colman</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Soroceanu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Modrusan</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Feuerstein</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>Aldape</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Molecular subclasses of high-grade glioma predict prognosis, delineate a pattern of disease progression, and resemble stages in neurogenesis</article-title>
        <source>Cancer Cell</source>
        <year>2006</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>157</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccr.2006.02.019</pub-id>
        <?supplied-pmid 16530701?>
        <pub-id pub-id-type="pmid">16530701</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Verhaak</surname>
            <given-names>RGW</given-names>
          </name>
          <name>
            <surname>Hoadley</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Purdom</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Qi</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wilkerson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Alexe</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>O’Kelly</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weir</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Gabriel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Winckler</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jakkula</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Feiler</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Hodgson</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Sarkaria</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Brennan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kahn</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Spellman</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Meyerson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Getz</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>DN</given-names>
          </name>
        </person-group>
        <article-title>Integrated genomic analysis identifies clinically relevant subtypes of glioblastoma characterized by abnormalities in PDGFRA, IDH1, EGFR, and NF1</article-title>
        <source>Cancer Cell</source>
        <year>2010</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>98</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccr.2009.12.020</pub-id>
        <?supplied-pmid 20129251?>
        <pub-id pub-id-type="pmid">20129251</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bhat</surname>
            <given-names>KPL</given-names>
          </name>
          <name>
            <surname>Balasubramaniyan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vaillant</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ezhilarasan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hummelink</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hollingsworth</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wani</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Heathcock</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Goodman</surname>
            <given-names>LD</given-names>
          </name>
          <name>
            <surname>Conroy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lelic</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gumin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Raj</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kodama</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Raghunathan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Olar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joshi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pelloski</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Heimberger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Cahill</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Den Dunnen</surname>
            <given-names>WFA</given-names>
          </name>
          <name>
            <surname>Boddeke</surname>
            <given-names>HWGM</given-names>
          </name>
          <name>
            <surname>Phillips</surname>
            <given-names>HS</given-names>
          </name>
          <name>
            <surname>Nakano</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lang</surname>
            <given-names>FF</given-names>
          </name>
          <name>
            <surname>Colman</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sulman</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Aldape</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Mesenchymal differentiation mediated by NF- <italic>κ</italic>B promotes radiation resistance in glioblastoma</article-title>
        <source>Cancer Cell</source>
        <year>2013</year>
        <volume>24</volume>
        <issue>3</issue>
        <fpage>331</fpage>
        <lpage>46</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccr.2013.08.001</pub-id>
        <?supplied-pmid 23993863?>
        <pub-id pub-id-type="pmid">23993863</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brown</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>WR</given-names>
          </name>
        </person-group>
        <article-title>Exploiting tumour hypoxia in cancer treatment</article-title>
        <source>Nat Rev Cancer</source>
        <year>2004</year>
        <volume>4</volume>
        <issue>6</issue>
        <fpage>437</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1038/nrc1367</pub-id>
        <?supplied-pmid 15170446?>
        <pub-id pub-id-type="pmid">15170446</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Panigrahy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>LQ</given-names>
          </name>
          <name>
            <surname>Butterfield</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Freedman</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Moses</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Kilroy</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Duensing</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fletcher</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fletcher</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Hlatky</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hahnfeldt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Folkman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kaipainen</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>PPARgamma ligands inhibit primary tumor growth and metastasis by inhibiting angiogenesis</article-title>
        <source>J Clin Investig</source>
        <year>2002</year>
        <volume>110</volume>
        <issue>7</issue>
        <fpage>923</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.1172/JCI0215634</pub-id>
        <?supplied-pmid 12370270?>
        <pub-id pub-id-type="pmid">12370270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ellis</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Kurian</surname>
            <given-names>KM</given-names>
          </name>
        </person-group>
        <article-title>Biological Rationale for the Use of PPAR <italic>γ</italic> Agonists in Glioblastoma</article-title>
        <source>Front Oncol</source>
        <year>2014</year>
        <volume>4</volume>
        <fpage>52</fpage>
        <pub-id pub-id-type="doi">10.3389/fonc.2014.00052</pub-id>
        <?supplied-pmid 24672773?>
        <pub-id pub-id-type="pmid">24672773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grommes</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Conway</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Alshekhlee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barnholtz-Sloan</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Inverse association of PPAR <italic>γ</italic> agonists use and high grade glioma development</article-title>
        <source>J Neuro-Oncol</source>
        <year>2010</year>
        <volume>100</volume>
        <issue>2</issue>
        <fpage>233</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1007/s11060-010-0185-x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Amit</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Garber</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chevrier</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Leite</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Donner</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Eisenhaure</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Guttman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Grenier</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zuk</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Schubert</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Birditt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shay</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Goren</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Deering</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Cabili</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Meissner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Root</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Hacohen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Unbiased reconstruction of a mammalian transcriptional network mediating pathogen responses</article-title>
        <source>Science (New York)</source>
        <year>2009</year>
        <volume>326</volume>
        <issue>5950</issue>
        <fpage>257</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1179050</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
