<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Res</journal-id>
    <journal-id journal-id-type="hwp">genome</journal-id>
    <journal-id journal-id-type="pmc">genome</journal-id>
    <journal-id journal-id-type="publisher-id">GENOME</journal-id>
    <journal-title-group>
      <journal-title>Genome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1088-9051</issn>
    <issn pub-type="epub">1549-5469</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4561497</article-id>
    <article-id pub-id-type="pmid">26163319</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="doi">10.1101/gr.189894.115</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Saturation analysis of ChIP-seq data for reproducible identification of binding peaks</article-title>
      <alt-title alt-title-type="left-running">Hansen et al.</alt-title>
      <alt-title alt-title-type="right-running">Saturation analysis of ChIP-seq data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hansen</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hecht</surname>
          <given-names>Jochen</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af2">2</xref>
        <xref ref-type="aff" rid="af3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ibrahim</surname>
          <given-names>Daniel M.</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krannich</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="af4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Truss</surname>
          <given-names>Matthias</given-names>
        </name>
        <xref ref-type="aff" rid="af5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter N.</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af2">2</xref>
        <xref ref-type="aff" rid="af3">3</xref>
        <xref ref-type="aff" rid="af6">6</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Institute for Medical and Human Genetics, Charité–Universitätsmedizin Berlin, 13353 Berlin, Germany;</aff>
    <aff id="af2"><label>2</label>Berlin Brandenburg Center for Regenerative Therapies (BCRT), Charité–Universitätsmedizin Berlin, 13353 Berlin, Germany;</aff>
    <aff id="af3"><label>3</label>Max Planck Institute for Molecular Genetics, 14195 Berlin, Germany;</aff>
    <aff id="af4"><label>4</label>Department of Biostatistics, Clinical Research Unit, Berlin Institute of Health, Charité–Universitätsmedizin Berlin, 13353 Berlin, Germany;</aff>
    <aff id="af5"><label>5</label>Labor für Pädiatrische Molekularbiologie, Charité–Universitätsmedizin Berlin, 10117, Berlin, Germany;</aff>
    <aff id="af6"><label>6</label>Institute for Bioinformatics, Department of Mathematics and Computer Science, Freie Universität Berlin, 14195 Berlin, Germany</aff>
    <author-notes>
      <corresp>Corresponding author: <email>peter.robinson@charite.de</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>9</month>
      <year>2015</year>
    </pub-date>
    <volume>25</volume>
    <issue>9</issue>
    <fpage>1391</fpage>
    <lpage>1400</lpage>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>1</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>7</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml">© 2015 Hansen et al.; Published by Cold Spring Harbor Laboratory Press</ext-link>
      </copyright-statement>
      <copyright-year>2015</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This article is distributed exclusively by Cold Spring Harbor Laboratory Press for the first six months after the full-issue publication date (see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml">http://genome.cshlp.org/site/misc/terms.xhtml</ext-link>). After six months, it is available under a Creative Commons License (Attribution-NonCommercial 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="1391.pdf"/>
    <abstract>
      <p>Chromatin immunoprecipitation coupled with next-generation sequencing (ChIP-seq) is a powerful technology to identify the genome-wide locations of transcription factors and other DNA binding proteins. Computational ChIP-seq peak calling infers the location of protein–DNA interactions based on various measures of enrichment of sequence reads. In this work, we introduce an algorithm, Q, that uses an assessment of the quadratic enrichment of reads to center candidate peaks followed by statistical analysis of saturation of candidate peaks by 5′ ends of reads. We show that our method not only is substantially faster than several competing methods but also demonstrates statistically significant advantages with respect to reproducibility of results and in its ability to identify peaks with reproducible binding site motifs. We show that Q has superior performance in the delineation of double RNAPII and H3K4me3 peaks surrounding transcription start sites related to a better ability to resolve individual peaks. The method is implemented in C+l+ and is freely available under an open source license.</p>
    </abstract>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>Bundesministerium für Bildung und Forschung <named-content content-type="funder-id">http://dx.doi.org/10.13039/501100002347</named-content></funding-source>
        <award-id>1315848A</award-id>
      </award-group>
      <award-group id="funding-2">
        <funding-source>European Commission's Seventh Framework Programme <named-content content-type="funder-id">http://dx.doi.org/10.13039/501100000780</named-content></funding-source>
        <award-id>602300</award-id>
      </award-group>
      <award-group id="funding-3">
        <funding-source>Deutsche Forschungsgemeinschaft <named-content content-type="funder-id">http://dx.doi.org/10.13039/501100001659</named-content></funding-source>
        <award-id>Mu 880/11-1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Chromatin immunoprecipitation (ChIP) followed by massively parallel sequencing (ChIP-seq) is designed to detect genome-wide protein–DNA interaction. ChIP-seq can identify both sharp peaks typically associated with sequence-specific transcription factors, as well as broad histone-modification signals (<xref rid="HANSENGR189894C20" ref-type="bibr">Park 2009</xref>; <xref rid="HANSENGR189894C21" ref-type="bibr">Peng and Zhao 2011</xref>), and has become a central technology for the investigation of gene regulation. The ChIP-seq procedure involves formaldehyde-mediated crosslinking of chromatin followed by fragmentation of protein–DNA complexes into short fragments, which are then subjected to immunoprecipitation using an antibody directed against a protein of interest (e.g., a transcription factor or a modified histone), thereby enriching genomic segments that are bound by the protein of interest prior to sequencing (<xref rid="HANSENGR189894C14" ref-type="bibr">Laajala et al. 2009</xref>).</p>
  <p>A crucial challenge in the computational analysis of ChIP-seq data pertains to finding peaks in ChIP-seq data that correspond to protein–DNA binding sites. Numerous peak calling algorithms have been presented, most of which address the same basic analytical tasks with methods to estimate the mean DNA fragment length from the data, to shift or extend the reads toward the center of the binding peak, to identify candidate peak regions, and to evaluate the statistical significance of the read depth of the candidate peaks. The sequence reads represent only the 5′ ends of the coprecipitated DNA fragments, which are generally 100- to 500-bp in length. Around true binding sites of the target protein, this results in a characteristic bimodal distribution of reads on the forward and reverse strands, which depends on the distribution of fragment lengths in the library and can be exploited for signal detection and evaluation. Therefore, an initial step in many algorithms is the estimation of the actual fragment-length distribution. Following fragment-length estimation, in order to better represent the original DNA fragment rather than just the 5′ sequence read, most peak calling algorithms either shift the read in the 3′ direction toward the peak center or computationally extend tags to the estimated length of the original fragments. Regions for hypothesis testing are chosen with a sliding window, or alternatively, some programs generate a continuous coverage and specify a minimum height criterion in order to report peaks. Finally, a variety of statistical tests are applied to identify peaks as regions with significantly increased read density. Most commonly, read distribution is modeled by a Poisson or negative binomial distribution (<xref rid="HANSENGR189894C22" ref-type="bibr">Pepke et al. 2009</xref>).</p>
  <p>Numerous peak calling algorithms have been systematically compared in many studies (<xref rid="HANSENGR189894C14" ref-type="bibr">Laajala et al. 2009</xref>; <xref rid="HANSENGR189894C22" ref-type="bibr">Pepke et al. 2009</xref>; <xref rid="HANSENGR189894C31" ref-type="bibr">Wilbanks and Facciotti 2010</xref>; <xref rid="HANSENGR189894C13" ref-type="bibr">Kim et al. 2011</xref>; <xref rid="HANSENGR189894C27" ref-type="bibr">Rye et al. 2011</xref>). However, only a small number of data sets were used in these studies. Nevertheless, one recurrent conclusion is that the performance of different peak callers depends on the particular data set examined (<xref rid="HANSENGR189894C14" ref-type="bibr">Laajala et al. 2009</xref>; <xref rid="HANSENGR189894C31" ref-type="bibr">Wilbanks and Facciotti 2010</xref>), as well as on manual “fine-tuning” of the parameters required by the various algorithms (<xref rid="HANSENGR189894C31" ref-type="bibr">Wilbanks and Facciotti 2010</xref>; <xref rid="HANSENGR189894C30" ref-type="bibr">Szalkowski and Schmid 2011</xref>). In this work, we present an approach to ChIP-seq peak calling that is based on saturation analysis of positions within candidate peaks. Our method estimates the fragment length from the data and does not require fine-tuning of parameters for typical runs. If a control data set is used, the statistical model we use does not require down-sampling of the control reads. We present efficient and accurate algorithms for each of the major steps of computational ChIP-seq analysis and show, using ENCODE data for 38 experiments, that they outperform previous methodologies based on irreproducible discovery rate (IDR) analysis (<xref rid="HANSENGR189894C17" ref-type="bibr">Li et al. 2011</xref>; <xref rid="HANSENGR189894C15" ref-type="bibr">Landt et al. 2012</xref>), motif identification, resolution, and running time.</p>
  <sec sec-type="results" id="s1">
    <title>Results</title>
    <p>In this work, we present a ChIP-seq peak caller called Q, which exploits a <italic>quadratic</italic> measure of coverage to identify candidates followed by a statistical saturation analysis to call significant peaks. The Q workflow can be divided into four main phases: (1) estimation of fragment length (<xref ref-type="fig" rid="HANSENGR189894F1">Fig. 1</xref>), (2) preprocessing of reads (transformation to “qfrags”) (<xref ref-type="fig" rid="HANSENGR189894F2">Fig. 2</xref>A), (3) analysis of qfrag depth to identify summits at the center of candidate peaks (<xref ref-type="fig" rid="HANSENGR189894F2">Fig. 2</xref>B), and (4) statistical hypothesis testing of candidate peaks with respect to saturation (<xref ref-type="fig" rid="HANSENGR189894F2">Fig. 2</xref>C).</p>
    <fig id="HANSENGR189894F1" orientation="portrait" position="float">
      <label>Figure 1.</label>
      <caption>
        <p>Fragment-length estimation. (<italic>A</italic>) Cross-correlation plot produced by SPP (<xref rid="HANSENGR189894C12" ref-type="bibr">Kharchenko et al. 2008</xref>) for GM12878-BATF-REP1. (<italic>B</italic>) Hamming distance plot produced by Q for the same data set.</p>
      </caption>
      <graphic xlink:href="1391f01"/>
    </fig>
    <fig id="HANSENGR189894F2" orientation="portrait" position="float">
      <label>Figure 2.</label>
      <caption>
        <p>Q workflow. (<italic>A</italic>) A preprocessing step identifies “qfrags” as pairs of reads on opposite strands located within ℓ±<italic>x</italic> nucleotides from one another. In regions of true signal, this has the effect of approximately quadratically amplifying the signal, whence the name of the algorithm. The qfrags are shown as black lines connecting the 5′ ends of compatible reads. For instance, the red (forward strand) read at the <italic>left</italic> edge of the gray box can form a qfrag with any blue (reverse strand) read that is located in the light gray portion of the box (≥<italic>q</italic><sub>min</sub> and ≤<italic>q</italic><sub>max</sub> nucleotides). qfrags are symbolized by black lines between 5′ ends of red and blue reads. (<italic>B</italic>) The qfrag depth is calculated for each position along the genome. Candidate regions for hypothesis testing are identified as local qfrag height maxima (summits, or predicted binding sites). (<italic>C</italic>) Candidate regions are defined as the regions comprising the <italic>q</italic><sub>max</sub> nucleotides upstream of and downstream from the predicted binding site, and statistical testing is performed on each candidate peak based on the saturation analysis in a window defined by 2 · <italic>q</italic><sub>max</sub>.</p>
      </caption>
      <graphic xlink:href="1391f02"/>
    </fig>
    <sec id="s1a">
      <title>Estimation of fragment length by Hamming distance</title>
      <p>The estimated fragment length is an essential parameter for nearly all published peak callers. A commonly used method involves the calculation of cross-correlation between reads mapped to the forward and reverse strands, thereby taking advantage of the bimodal peak distribution characteristic of ChIP-seq peaks. The implementation of this procedure in SPP (<xref rid="HANSENGR189894C12" ref-type="bibr">Kharchenko et al. 2008</xref>) calculates the shift at which the highest Pearson correlation between the forward and reverse strand is noted. If this procedure is performed after removal of duplicates, the comparison is based on values of zero (no read starting at some position) and one (at least one read). We reasoned that a comparable operation could be performed using bit operations to calculate the Hamming distance. The position with the smallest distance corresponds to the position with the maximum Pearson correlation (<xref ref-type="fig" rid="HANSENGR189894F1">Fig. 1</xref>; Supplemental Fig. S1). Therefore, an equivalent result is obtained, but the computation can be performed three to four times faster on average, based on an evaluation of the 38 data sets examined in this work (Supplemental Tables S1, S2).</p>
    </sec>
    <sec id="s1b">
      <title>qfrags: identification of candidate ChIP-seq peaks</title>
      <p>Our method replaces the read shifting or extension step of most other ChIP-seq peak callers with an approach that is intended to better capture signal from true peaks and to center the called peak at the middle of bimodal accumulations of reads. We reasoned that if a read is located within a true peak, then it is likely that there will be multiple reads on the opposite strand located within a window centered at one mean fragment length away from the read. To capture this intuition, we define <italic>q</italic><sub>min</sub> = ℓ−<italic>x</italic> and <italic>q</italic><sub>max</sub> = ℓ + <italic>x</italic>, where ℓ denotes the estimated mean fragment length, and <italic>x</italic>, which reflects deviations from the mean fragment length, determines the size of the window.</p>
      <p>We define a qfrag to be the segment of genomic positions between any pair of 5′ end positions on the forward and reverse strand with a distance of at least <italic>q</italic><sub>min</sub> and at most <italic>q</italic><sub>max</sub> (<xref ref-type="fig" rid="HANSENGR189894F2">Fig. 2</xref>A). The qfrag depth at any one position is the total number of qfrags that cover the position. The center of the local maximum of qfrag depth is then defined to be a predicted binding site or “summit” (<xref ref-type="fig" rid="HANSENGR189894F2">Fig. 2</xref>B). The region comprising the <italic>q</italic><sub>max</sub> nucleotides upstream of and downstream from the summit then represents a candidate peak that will be statistically tested as described below (<xref ref-type="fig" rid="HANSENGR189894F2">Fig. 2</xref>C).</p>
      <p>We note that a critical point of ChIP-seq peak calling algorithms is the identification and centering of candidate peaks for statistical testing. Intuitively, our method will tend to yield a “quadratic” signal around true peaks but only a linear one elsewhere in the genome. Consider the situation where there are <italic>n</italic> reads on the forward strand and <italic>n</italic> reads on the reverse strand that are located at a distance of ℓ±<italic>x</italic> nucleotides to one another. Our method would then define <italic>n</italic><sup>2</sup> qfrags, whereas methods that involve read extension or shifting would identify 2<italic>n</italic> reads. Approximately speaking, our method would characterize a “quadratic” number of qfrags surrounding a true peak while identifying only a linear number of qfrags for nonpeak regions (<xref ref-type="fig" rid="HANSENGR189894F2">Fig. 2</xref>A). The qfrag method therefore leads to a different depth distribution than that of the raw reads, the shifted reads, or the extended reads (Supplemental Fig. S2).</p>
    </sec>
    <sec id="s1c">
      <title>Statistical analysis of peak saturation</title>
      <p>To model the signal for a single true binding site, we made the following two assumptions: First, each fragment end is sequenced with equal probability from the forward or reverse strand. Second, there is no preference for fragment positions to which the target protein is bound; i.e., given a fragment of certain length, the target protein is bound to each fragment position with equal probability. The first assumption implies that the 5′ ends of fragments should accumulate before a true binding site on the forward strand and on the reverse strand behind it. The second assumption implies that the 5′ ends of fragments should be evenly distributed in a radius of <italic>q</italic><sub>min</sub> nucleotides around true binding sites, and at a distance of more than <italic>q</italic><sub>max</sub> nucleotides from the true binding site, the signal should resemble that of the background level. We validated our model empirically and found a distribution largely consistent with our model (Supplemental Fig. S3).</p>
      <p>With this distribution in mind, we reasoned that a saturation score might be a good measurement for enrichment. By “saturation” we mean that many individual positions surrounding the true peak center tend to be occupied by the 5′ end of one or more mapped reads that belong to qfrags. Our procedure for identifying qfrags assigns candidate peaks with high saturation better scores than peaks with the same number of overall reads, which are distributed to a lower number of positions. The qfrag methodology thus intends to identify well-saturated candidate peaks.</p>
      <p>We therefore defined saturation as the number of positions within the tested peak region that are covered by at least one 5′ end position of a qfrag (<xref ref-type="fig" rid="HANSENGR189894F2">Fig. 2</xref>C). We implemented a statistical test that is formulated as a binomial test for the number of saturated positions and derived the binomial parameter <italic>p</italic> (probability for any given position to be covered) based on the classical occupancy problem (<xref rid="HANSENGR189894C8" ref-type="bibr">Feller 1968</xref>).</p>
      <p>Although it is possible to call ChIP-seq peaks based only on the expected number of reads, assuming a uniform background distribution (<xref rid="HANSENGR189894C24" ref-type="bibr">Robertson et al. 2007</xref>), a number of factors such as GC content, read mappability, DNA repeats, copy number variations, and local chromatin structure can influence read depth (<xref rid="HANSENGR189894C9" ref-type="bibr">Feng et al. 2012</xref>). For this reason, ChIP-seq experiments are often accompanied by a control experiment in which generic (nonspecific) IgG is used in place of the specific antibody. A comparison of the treatment and control experiments can then be performed to reduce background biases in order to be able to reliably identify read-enriched regions obtained from ChIP-seq. In general, a similar number of reads are derived for the control sample as for the treatment sample, although the exact number may be higher or lower. We therefore developed an implementation of this test for ChIP-seq experiments performed with a control experiment. In this case, we test the difference of saturation between ChIP and the control experiment for statistical significance. Our method does not require down-sampling of reads from the control experiment (Supplemental Fig. S4).</p>
    </sec>
    <sec id="s1d">
      <title>Reproducibility analysis</title>
      <p>To evaluate our method, we developed a test framework based on the IDR procedure (<xref rid="HANSENGR189894C17" ref-type="bibr">Li et al. 2011</xref>; <xref rid="HANSENGR189894C15" ref-type="bibr">Landt et al. 2012</xref>), which provides a measure of the reproducibility of the ChIP-seq experiments and is described in detail in the Supplemental Methods. We compared the performance of Q to that of the three widely used peak callers MACS2 (<xref rid="HANSENGR189894C33" ref-type="bibr">Zhang et al. 2008</xref>; <xref rid="HANSENGR189894C9" ref-type="bibr">Feng et al. 2012</xref>), SPP (<xref rid="HANSENGR189894C12" ref-type="bibr">Kharchenko et al. 2008</xref>), and PeakSeq (<xref rid="HANSENGR189894C26" ref-type="bibr">Rozowsky et al. 2009</xref>) using 38 published ChIP-seq data sets from the ENCODE Project Consortium (Supplemental Table S1). We measured reproducibility of the methods using pseudoreplicates generated from these data sets.</p>
      <p><xref ref-type="fig" rid="HANSENGR189894F3">Figure 3</xref> shows an example of our analysis for RNA polymerase II (RNAPII). Q identifies a larger overall number of overlaps between the top 100,000 peaks of each pseudoreplicate (60,450 compared with 45,022–46,976 for the other three peak callers) with a higher correlation coefficient between pseudoreplicates (<xref ref-type="fig" rid="HANSENGR189894F3">Fig. 3</xref>A–D). We then applied the change of correspondence method (Supplemental Methods) to the data, which estimates the rate of change of reproducibility for the top <italic>n</italic> peaks as <italic>n</italic> ranges from zero to the total number of overlapping peaks (which was 60,450 for Q). High reproducibility is reflected in a late transition (i.e., at large <italic>n</italic>) to a segment with a positive slope (<xref rid="HANSENGR189894C17" ref-type="bibr">Li et al. 2011</xref>). In this example, the transition occurs at around 15,000 peaks for SPP, 20,000 for MACS2 and PeakSeq, and over 35,000 for Q (<xref ref-type="fig" rid="HANSENGR189894F3">Fig. 3</xref>E). We also assessed the overall reproducibility of the replicates using the IDR. For all numbers of selected peaks, Q identifies fewer irreproducible peaks (<xref ref-type="fig" rid="HANSENGR189894F3">Fig. 3</xref>F; Supplemental Methods).</p>
      <fig id="HANSENGR189894F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Reproducibility analysis for RNA polymerase II (RNAPII). The ENCODE data set HeLa-S3-POL2-REP1 is shown as an example. The alignment data were split randomly into two pseudoreplicates, and peaks were called using Q, MACS2, SPP, and PeakSeq. (<italic>A</italic>–<italic>D</italic>) The scatterplots show the negative decadic logarithm of <italic>P</italic>-values of Q (<italic>A</italic>), MACS2 (<italic>B</italic>), and PeakSeq (<italic>D</italic>), and signal values of SPP (<italic>C</italic>) for overlapping signals of the two pseudo replicates. Compared with the overlaps for MACS2 (46,976), SPP (45,759), and PeakSeq (45,022), Q shows a considerably larger overlap (60,450). In addition, Q shows the highest Pearson correlation coefficient (0.97) compared with three other methods. (<italic>E</italic>) Change of correspondence curve (Ψ′ plot) (<xref rid="HANSENGR189894C17" ref-type="bibr">Li et al. 2011</xref>). The peak set derived from Q remains consistent for about 15,000 peaks more than those of the other peak callers. (<italic>F</italic>) The plot shows the IDR at different numbers of selected peaks. For all peak counts, Q displays a considerably smaller proportion of irreproducible signals.</p>
        </caption>
        <graphic xlink:href="1391f03"/>
      </fig>
      <p>We performed the same analysis for all 38 data sets. The mean number of peaks identified by the four peak callers for any specific experiment ranged from 5991 to 70,663 (Supplemental Table S3). In 31 cases, Q displayed the highest number of overlapping peaks among the top 100,000 peaks (<xref ref-type="fig" rid="HANSENGR189894F4">Fig. 4</xref>A–C) and, in 33 cases, the highest Pearson correlation coefficient (<xref ref-type="fig" rid="HANSENGR189894F3">Fig. 3</xref>A–D; Supplemental Table S4). To highlight the differences between the four peak callers, we visualized the results by subtracting the mean number of overlapped peaks for each experiment from the count of peaks called by each individual peak caller. Overall, the mean normalized peak overlaps for Q are significantly larger than for MACS2, SPP, and PeakSeq (<xref ref-type="fig" rid="HANSENGR189894F4">Fig. 4</xref>A–C).</p>
      <fig id="HANSENGR189894F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Reproducibility analysis for the 38 data sets. (<italic>A</italic>) Overlapping peak counts for the four peak callers (Q, black; MACS2, red; SPP, green; PeakSeq, blue). The numbers around the radar plots indicate the individual samples (Supplemental Table S1). (<italic>B</italic>) Mean normalized numbers for the data shown in <italic>A</italic>; the row mean (data from all four peak callers) was subtracted from each value. (<italic>C</italic>) Distribution of the mean normalized numbers for the overlapping peaks. <italic>P</italic>-values relative to Q were calculated using two-sample, two-sided Wilcoxon tests. (<italic>D</italic>–<italic>F</italic>) Panels are analogous to panels <italic>A</italic> through <italic>C</italic> except that the analysis is restricted to peaks with IDR ≤ 0.01. Data sets for which incompatibility with the IDR procedure was observed were excluded from the analysis (Supplemental Methods, Supplemental Figs. S5–S7; Supplemental Table S5).</p>
        </caption>
        <graphic xlink:href="1391f04"/>
      </fig>
      <p>For some data sets, we observed a proportion of overlapping peaks with very weak signal scores for both replicates that are classified as reproducible, given a threshold of IDR ≤ 0.01. This observation contradicts the basic concept of the IDR procedure whereby strong signals are more reproducible than weak signals. We systematically investigated this phenomenon. In our analysis, Q demonstrated the best overall compatibility with the IDR procedure (Supplemental Methods; Supplemental Fig. S5; Supplemental Table S5).</p>
      <p>We then repeated the analysis shown in <xref ref-type="fig" rid="HANSENGR189894F4">Figure 4</xref>A–C for data sets that exhibited good overall compatibility with the IDR procedure. For these 21 data sets, we restricted the analysis on reproducible peaks with IDR ≤ 0.01. As with the previous analysis, we found that for Q the number of mean-normalized, reproducible peak overlaps is significantly higher than for the other methods (<xref ref-type="fig" rid="HANSENGR189894F4">Fig. 4</xref>D–F; Supplemental Table S6).</p>
    </sec>
    <sec id="s1e">
      <title>Motif content analysis</title>
      <p>One of the major applications of ChIP-seq analysis is to characterize transcription factor binding sites (TFBSs) for ab initio motif discovery or motif enrichment analysis (<xref rid="HANSENGR189894C33" ref-type="bibr">Zhang et al. 2008</xref>; <xref rid="HANSENGR189894C18" ref-type="bibr">Machanick and Bailey 2011</xref>; <xref rid="HANSENGR189894C19" ref-type="bibr">Newkirk et al. 2011</xref>; <xref rid="HANSENGR189894C32" ref-type="bibr">Xing et al. 2012</xref>; <xref rid="HANSENGR189894C3" ref-type="bibr">Bardet et al. 2013</xref>). We reasoned that true binding sites are more likely to contain a sequence-binding motif of the corresponding transcription factor than other sequences. We called initial peak sets using Q, MACS2, SPP, and PeakSeq and took the four-way intersection of the top 50,000 peaks of each caller as a reference peak set. We conducted de novo motif analysis on these peak sets using the motif finder DREME (<xref rid="HANSENGR189894C2" ref-type="bibr">Bailey 2011</xref>) and defined the 10 most significant DREME motifs as the reference motifs. We then asked what proportion of the 50,000 peaks of the individual peak callers contained at least one of the reference motifs. This approach relies on two assumptions. First, the four-way intersection of the original peak calls is enriched in true peaks, and second, the overall proportion of peaks that contain at least one of the reference motifs is a reflection of the accuracy of the individual peak callers.</p>
      <p>We extracted genomic sequences of one estimated fragment length around the center of the peaks called by each caller, and masked repetitive regions. All high-scoring occurrences of the reference motifs (<italic>P</italic> ≤ 0.0001) were determined using FIMO (<xref rid="HANSENGR189894C10" ref-type="bibr">Grant et al. 2011</xref>). Subsequently, the number of peaks that contain at least one high-scoring motif occurrence was determined for the top 50,000 peaks of the individual peak callers.</p>
      <p>We applied the motif content analysis to the 38 data sets. In 33 of 38 cases, the top 50,000 peaks of Q include the highest number of peaks with at least one reference motif (Supplemental Table S7). On average, the top 50,000 peaks of Q include 4.1% (2063) more peaks containing at least one reference motif compared with MACS2, 2.6% (1323) compared with SPP, and 5.7% (2840) compared with PeakSeq. The mean difference was statistically significant (<xref ref-type="fig" rid="HANSENGR189894F5">Fig. 5</xref>).</p>
      <fig id="HANSENGR189894F5" orientation="portrait" position="float">
        <label>Figure 5.</label>
        <caption>
          <p>Motif content analysis for 38 ENCODE data sets. We counted the number of peaks among the top 50,000 called peaks that contained at least one occurrence of the corresponding transcription factor binding motifs. (<italic>A</italic>) Radar plot of the raw peak counts (Supplemental Table S7). Q called the most peaks containing at least one reference motif in 33 of the 38 experiments. The colors of the lines in the radar plot are the same as those shown in the legend of Figure 4. (<italic>B</italic>) Radar plot of the mean-normalized peak counts. (<italic>C</italic>) <italic>P</italic>-values relative to Q were calculated using two-sample, two-sided, Wilcoxon tests comparing mean-normalized peak counts.</p>
        </caption>
        <graphic xlink:href="1391f05"/>
      </fig>
    </sec>
    <sec id="s1f">
      <title>Q identifies TSS flanking double summits for RNAPII and H3K4me3</title>
      <p>We next focused on the four RNAPII data sets, for which our method had shown the greatest advantage (<xref ref-type="fig" rid="HANSENGR189894F3">Figs. 3</xref>–<xref ref-type="fig" rid="HANSENGR189894F5">5</xref>). Pausing RNAPII is characterized by two separate ChIP-seq peaks located directly upstream of and downstream from the transcription start site (TSS) (<xref rid="HANSENGR189894C28" ref-type="bibr">Stadelmayer et al. 2014</xref>). Visual inspection revealed that Q often identified TSS flanking double summits (TFDSs) at promoters where the other peak callers identified a single summit. We therefore tested the ability of Q to identify this biologically relevant signature of pausing RNAPII. Q did indeed detect TFDSs at 39.5%–48.4% of all RNAPII bound promoters, while other methods, mainly reporting single summits, identified a substantially smaller number of TFDSs (10.4%–23.5%) (Supplemental Table S8). Plotting of the distribution of TFDSs identified by Q showed two clearly defined peaks with one sharp peak 50–100 nt downstream from and a second, less pronounced peak 150–250 nt upstream of the TSS separated by a median distance of 375–426 nt. Plotting of the results of the other peak callers failed to produce similar results (<xref ref-type="fig" rid="HANSENGR189894F6">Fig. 6</xref>A; Supplemental Figs. S8, S9).</p>
      <fig id="HANSENGR189894F6" orientation="portrait" position="float">
        <label>Figure 6.</label>
        <caption>
          <p>Distribution of TSS flanking double summits (TFDSs). Each TFDS consists of two summits directly upstream of and downstream from the TSS. The TFDSs of Q for HCT-116 RNAPII (<italic>A</italic>) and HCT-116 H3K4me3 (<italic>B</italic>) were integrated over all non-overlapping promoters (TSS ± 1500 nt).</p>
        </caption>
        <graphic xlink:href="1391f06"/>
      </fig>
      <p>Nucleosome-depleted regions (NDRs) at TSS are often flanked by histones marked by H3K4me3 (<xref rid="HANSENGR189894C5" ref-type="bibr">Cairns 2009</xref>; <xref rid="HANSENGR189894C1" ref-type="bibr">Arya et al. 2010</xref>). We therefore applied the same analysis to the H3K4me3 data sets for the same two cell types as for RNAPII (Supplemental Table S1). Q identified TFDSs at 59.2%–70.6% of H3K4me3 bound promoters, compared with only 12.5%–36.5% for the other peak callers (Supplemental Table S9). The distribution of H3K4me3 again showed two clearly defined peaks upstream of and downstream from the TSS (<xref ref-type="fig" rid="HANSENGR189894F6">Fig. 6</xref>B; Supplemental Fig. S10). For Q, the upstream peak at 250–300 nt is slightly sharper than the downstream peak at 300–400 nt. Peaks are separated by at least 400 nt and by a median distance between summits from 710–778 nt (Supplemental Fig. S11).</p>
      <p>The overlap of promoters with TFDS ranges for biological replicates from 78.1%–90.6%, which suggests that TFDSs are reproducibly identified by Q (Supplemental Table S10). Promoters that have a TFDS for RNAPII overlap by 77.1%–87.0% with promoters that have also a TFDS for H3K4me3. For 63.5%–68.7% of those overlapping promoters, we observed a pattern in which the region between the TFDS of RNAPII is completely contained in the region between the TFDS for H3K4me3, which is significantly more than expected by chance. For our simulation study (Methods) (Supplemental Table S11), we observed this pattern in 51.3%–58.7% of promoters (empirical <italic>P</italic>-value &lt;10<sup>−4</sup>). The results of these downstream analyses of TFDSs identified by Q are in perfect agreement with the architecture of paused open promoters that are characterized by a large NDR flanked by H3K4me3 modified histones with interspersed RNAPII (<xref rid="HANSENGR189894C5" ref-type="bibr">Cairns 2009</xref>).</p>
    </sec>
    <sec id="s1g">
      <title>Runtime analysis</title>
      <p>Q is implemented in C++ using functionality of SeqAn, a library of efficient data types and algorithms for sequence analysis (<xref rid="HANSENGR189894C6" ref-type="bibr">Doring et al. 2008</xref>). As mentioned above, the fragment length estimation implemented in Q was at least threefold faster than the method as implemented by SPP (Supplemental Table S2). We also compared the runtime of all four algorithms for all steps following fragment length estimation by examining the average runtime across all 38 data sets. Q displayed a threefold to 19-fold improvement in runtime (Supplemental Table S12).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s2">
    <title>Discussion</title>
    <p>Although ChIP-seq is being used in an ever-increasing range of genomics experiments, the computational analysis of the data is not trivial. The called peak regions form the basis of downstream analysis of transcription factor binding motifs, correlation with gene expression, transcriptional regulation, histone modifications, and the correlation of binding profiles of transcription factors with their biological effects (<xref rid="HANSENGR189894C22" ref-type="bibr">Pepke et al. 2009</xref>; <xref rid="HANSENGR189894C11" ref-type="bibr">Ibrahim et al. 2013</xref>). The accuracy and reproducibility of peak calling are thus key issues in the computational analysis of ChIP-seq data and have a major influence on downstream biological analysis.</p>
    <p>In this work, we compared Q against three of the most highly used general purpose peak callers—MACS2 (<xref rid="HANSENGR189894C9" ref-type="bibr">Feng et al. 2012</xref>), PeakSeq (<xref rid="HANSENGR189894C26" ref-type="bibr">Rozowsky et al. 2009</xref>), and SPP (<xref rid="HANSENGR189894C12" ref-type="bibr">Kharchenko et al. 2008</xref>)—because these programs have been extensively tested in the ENCODE Project Consortium (<xref rid="HANSENGR189894C7" ref-type="bibr">The ENCODE Project Consortium 2012</xref>). We demonstrated that Q shows advantages over previous methods with respect to reproducibility of the called peaks, consistency of motifs inferred from peak sequences, and runtime.</p>
    <p>The Q algorithm leads to a depth distribution distinct from that of the other peak callers (Supplemental Fig. S2); this in turn can have a substantial effect on downstream biological analysis. For example, we analyzed in detail the distribution of RNAPII and H3K4me3 TFDSs in HCT-116 and HeLa-S3 cells. We found substantially more RNAPII TFDSs using Q, which show an overlap of 77.1%–87.0% with the H3K4me3 TFDSs. Thus, Q demonstrates a superior resolution that consistently identifies TFDSs in promoters. This pattern has previously been associated with RNAPII stalling and nucleosome depletion. Q opens up the possibility of investigating this data with higher reproducibility and higher resolution.</p>
    <p>Our method is based on an algorithm that shifts the focus from an analysis of peak height on the basis of a Poisson or negative binomial distribution to the identification and assessment of peaks that are highly saturated with respect to the start positions of mapped reads. The concentration on saturation also allows us to perform an estimation of the fragment length using fast Boolean operations, resulting in a runtime that is over three times faster than previous methods that use Pearson correlation. Furthermore, the runtime for peak calling with Q was 3.5 to 18.5 times faster than MACS2, PeakSeq, and SPP. We have additionally shown that our statistical analysis does not require down-sampling of reads from the control experiment, which is commonly used in other tools to enable testing of candidate peaks for enrichment in the test data set. Q is intended to be used without any parameter tuning, although if desired the estimated fragment length can be set as an argument. Therefore, Q is easy to use and fast. Q is available under a BSD2 license together with a detailed tutorial at <uri xlink:href="https://github.com/charite/Q">https://github.com/charite/Q</uri>.</p>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <sec id="s3a">
      <title>Mapping and ChIP-seq</title>
      <p>Our procedure starts with aligned reads from a ChIP-seq experiment performed with a specific antibody and optionally with a control experiment in which the specific antibody is replaced by generic immunoglobulins. The reads are aligned against the forward or reverse strand of a target sequence with <italic>l</italic> positions. BAM files were downloaded from ENCODE, and duplicate reads were removed by rmdup from the SAMtools package (<xref rid="HANSENGR189894C16" ref-type="bibr">Li et al. 2009</xref>).</p>
    </sec>
    <sec id="s3b">
      <title>Fragment-length estimation</title>
      <p>The Hamming distance <italic>d</italic><sub><italic>H</italic></sub>(<italic>x</italic>,<italic>y</italic>) between the bit strings <bold><italic>x</italic></bold> = <italic>x</italic><sub>1</sub><italic>x</italic><sub>2</sub>…<italic>x</italic><sub><italic>n</italic></sub> and <bold><italic>y</italic></bold> = <italic>y</italic><sub>1</sub><italic>y</italic><sub>2</sub>…<italic>y</italic><sub><italic>n</italic></sub> is defined as the number of positions in which the strings differ; i.e., <italic>x</italic><sub><italic>i</italic></sub> ≠ <italic>y</italic><sub><italic>i</italic></sub>. The Hamming distance between two strings can be efficiently calculated in C/C++ using the bitwise XOR operator and summing the number of ones in the result.
<disp-formula><mml:math id="UM1"><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:mrow><mml:mo>[</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>]</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>The value of δ is varied from one to 1000, and the shift corresponding to the minimum value of <italic>H</italic>(δ) is taken as the estimated fragment length ℓ.
<disp-formula><mml:math id="UM2"><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="normal">argmi</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:mrow><mml:mrow><mml:mi>δ</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
    </sec>
    <sec id="s3c">
      <title>Summit detection</title>
      <p>We define a hit <italic>h</italic> to refer to the 5′ end of each mapped read that is assigned to a specific position (pos) and strand of the target sequence with <italic>l</italic> positions, i.e., <italic>h</italic> = (pos, strand). The outcome of a ChIP-seq experiment is modeled as a set of hits:
<disp-formula><mml:math id="UM3"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">pos</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="normal">strand</mml:mi></mml:mrow><mml:mo>)</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="normal">pos</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo><mml:mo>∧</mml:mo><mml:mrow><mml:mi mathvariant="normal">strand</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo stretchy="false">}</mml:mo><mml:mo stretchy="false">}</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>If a control experiment (<italic>C</italic>) is included in the analysis, the hits for <italic>C</italic> are defined analogously. Each set of hits is subdivided into hits on the forward and reverse strand (<italic>T</italic><sub><italic>f</italic></sub> and <italic>T</italic><sub><italic>r</italic></sub> for treatment; <italic>C</italic><sub><italic>f</italic></sub> and <italic>C</italic><sub><italic>r</italic></sub> for the control data set). Due to the experimental design of ChIP-seq experiments, we expect that the number of hits on each strand is approximately equal; i.e., <inline-formula><mml:math id="il1"><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>≈</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="il2"><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>≈</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:math></inline-formula>. According to our null model, the hits of <italic>T</italic> and <italic>C</italic> are evenly distributed across the positions 1,…,<italic>l</italic> of the target sequence, and the hits for the two strands are independently distributed.</p>
      <p>In order to form qfrags, we first estimate the mean fragment length ℓ as described above. We define <italic>q</italic><sub>min</sub> = ℓ−<italic>x</italic> and <italic>q</italic><sub>max</sub> = ℓ + <italic>x</italic>. We have chosen <italic>x</italic> = 50 nt for the experiments described here. A qfrag is then defined as an ordered pair of hits (<italic>h</italic><sub><italic>i</italic></sub>,<italic>h</italic><sub><italic>j</italic></sub>), such that <italic>h</italic><sub><italic>i</italic></sub> is on the forward strand, <italic>h</italic><sub><italic>j</italic></sub> is on the reverse strand, and the distance between the two hits is at least <italic>q</italic><sub>min</sub> but not more than <italic>q</italic><sub>max</sub> nucleotides, <italic>q</italic><sub>min</sub> ≤ <italic>h</italic><sub><italic>j</italic></sub>.pos − <italic>h</italic><sub><italic>i</italic></sub>.pos ≤ <italic>q</italic><sub>max</sub>.</p>
      <p>Once the qfrags have been identified, our method searches for local maxima of the qfrag depth profile that exceeds a given threshold and is greater than at all other positions within a distance of <italic>q</italic><sub>max</sub> nucleotides (<xref ref-type="fig" rid="HANSENGR189894F2">Fig. 2</xref>B). Each local maximum at position <italic>i</italic> represents a candidate summit; the region <italic>i</italic> ± <italic>q</italic><sub>max</sub>, the candidate peak that is subjected to statistical evaluation (<xref ref-type="fig" rid="HANSENGR189894F2">Fig. 2</xref>C), as described in the following section.</p>
    </sec>
    <sec id="s3d">
      <title>Saturation score</title>
      <p>For each candidate peak centered at position <italic>i</italic> (i.e., a qfrag depth profile local maximum at position <italic>i</italic>), we consider the nucleotide positions <italic>i</italic> − <italic>q</italic><sub>max</sub>,…,<italic>i</italic> + <italic>q</italic><sub>max</sub>. For didactic purposes, we will first describe the saturation score for ChIP-seq experiments that are performed without a control and then describe the full algorithm.</p>
    </sec>
    <sec id="s3e">
      <title>Saturation score: without control experiment</title>
      <p>We define the random variable <italic>Q</italic><sub><italic>t</italic></sub> on the sample space Ω = {0,…,2 · <italic>q</italic><sub>max</sub>}, where each possible outcome corresponds to the number of positions that are covered by the 5′ end of at least one qfrag within a window of length 2 · <italic>q</italic><sub>max</sub> centered at position <italic>i</italic>.</p>
      <p>Note that a qfrag is constructed for a given hit <italic>h</italic> at position <italic>i</italic> of the forward strand for each reverse strand hit at positions <italic>i</italic> + <italic>q</italic><sub>min</sub>,…,<italic>i</italic> + <italic>q</italic><sub>max</sub>. Position <italic>i</italic> is covered if there is at least one such qfrag. Given that there are |<italic>T</italic><sub><italic>r</italic></sub>| reverse strand hits and that the target region has a length of <italic>l</italic>, we expect |<italic>T</italic><sub><italic>r</italic></sub>|/<italic>l</italic> hits at any given position of the target sequence. Because of linearity of expectation, we can estimate the number of reverse strand hits at positions <italic>i</italic> + <italic>q</italic><sub>min</sub>,…,<italic>i</italic> + <italic>q</italic><sub>max</sub> as
<disp-formula><mml:math id="UM4"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:mstyle></mml:math></disp-formula>
</p>
      <p>The subscript <italic>t</italic> stands for treatment. We can now calculate the probability for a given hit on the forward strand to be part of a <italic>qfrag</italic> using the Poisson distribution Pois(<italic>k</italic>,λ<sub><italic>t</italic></sub>) in order to calculate the probability of finding at least one reverse strand hit at positions <italic>i</italic> + <italic>q</italic><sub>min</sub>,…,<italic>i</italic> + <italic>q</italic><sub>max</sub> (which is the same as saying that the forward strand hit at position <italic>i</italic> forms part of a qfrag):
<disp-formula><mml:math id="UM5"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mspace width="0.4em"/><mml:mrow><mml:mi mathvariant="normal">is</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:mrow><mml:mi mathvariant="normal">part</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:mrow><mml:mi mathvariant="normal">of</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:mrow><mml:mi mathvariant="normal">qfrag</mml:mi><mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>.</mml:mo><mml:mrow><mml:mi mathvariant="normal">strand</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi mathvariant="normal">Pois</mml:mi></mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>Since we expect to find |<italic>T</italic><sub><italic>f</italic></sub>|/<italic>l</italic> hits on the forward strand at position <italic>i</italic>, the expected rate of qfrag starting positions at any given position <italic>i</italic> is
<disp-formula><mml:math id="UM6"><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>Pois</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:math></disp-formula>
</p>
      <p>For hits on the reverse strand, the rate is approximately equal, because we expect the number of hits on each strand is nearly the same. If we do not distinguish between strands, we calculate the expected rate <italic>r</italic><sub><italic>t</italic></sub> of qfrag start and end positions as
<disp-formula><mml:math id="UM7"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>Pois</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:math></disp-formula>
</p>
      <p>Our method models the saturation of positions in the framework of the occupancy problem (<xref rid="HANSENGR189894C8" ref-type="bibr">Feller 1968</xref>). That is, if we place <italic>m</italic> balls randomly into <italic>n</italic> bins, how many bins remain empty? The probability that one particular ball lands in a certain bin is 1/<italic>n</italic>. Then the probability that the ball does not land in the bin is (1 − 1/<italic>n</italic>), and the probability that the bin is missed by all <italic>m</italic> balls is
<disp-formula><mml:math id="UM8"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>bin remains empty</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>≅</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>In our model, we can thus estimate the probability that a given position <italic>i</italic> is not covered by the start or end position of a qfrag as <inline-formula><mml:math id="il3"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Then the probability that a given position is covered by at least one qfrag start or end position is
<disp-formula><mml:math id="UM9"><mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>In the null model, we assume that each of the 2 · <italic>q</italic><sub>max</sub> positions can be represented as an independent and identically distributed Bernoulli trial. Therefore, <italic>Q</italic><sub><italic>t</italic></sub> has the following binomial distribution:
<disp-formula><mml:math id="UM10"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Bin</mml:mtext><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>The probability that exactly <italic>k</italic> positions in a window of length 2 · <italic>q</italic><sub>max</sub> are covered by at least one qfrag start or end position is then
<disp-formula><mml:math id="UM11"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mspace width="0.4em"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>Similarly, the probability that at least <italic>k</italic> positions in a window of length 2 · <italic>q</italic><sub>max</sub> are covered by at least one qfrag start or end position is
<disp-formula><mml:math id="UM12"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>≤</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mspace width="0.4em"/><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>⋅</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>p</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>We take <italic>P</italic>(<italic>k</italic> ≤ <italic>Q</italic><sub><italic>t</italic></sub> ≤ <italic>q</italic><sub>max</sub>) as the nominal probability of there being a ChIP-seq peak surrounding the local maximum at position <italic>i</italic>.</p>
    </sec>
    <sec id="s3f">
      <title>Saturation score: with control experiment</title>
      <p>We define the random variable <italic>Q</italic><sub><italic>c</italic></sub> on the sample space Ω = {0,…,2 · <italic>q</italic><sub>max</sub>}, which is analogous to <italic>Q</italic><sub><italic>t</italic></sub>. Then we define a third random variable <italic>Q</italic><sub><italic>d</italic></sub> = <italic>Q</italic><sub><italic>t</italic></sub> − <italic>Q</italic><sub><italic>c</italic></sub>, which describes the difference between the treatment and control samples. <italic>Q</italic><sub><italic>d</italic></sub> can take on values in the sample space Ω = {−2 · <italic>q</italic><sub>max</sub>,…,0,…,2 · <italic>q</italic><sub>max</sub>}. Thus, if more positions are covered by at least one qfrag start or end position in the control set than in the treatment set, <italic>Q</italic><sub><italic>d</italic></sub> &lt; 0, and if more positions are covered in the treatment set than in the control set, <italic>Q</italic><sub><italic>d</italic></sub> &gt; 0. The distribution of <italic>Q</italic><sub><italic>c</italic></sub> is completely analogous to that of <italic>Q</italic><sub><italic>t</italic></sub>:
<disp-formula><mml:math id="UM13"><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
<disp-formula><mml:math id="UM14"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow><mml:mo>⋅</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mtext>Pois</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
<disp-formula><mml:math id="UM15"><mml:mrow><mml:mspace width="thinmathspace"/><mml:msub><mml:mi>p</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>According our null model, we note that <italic>Q</italic><sub><italic>t</italic></sub> and <italic>Q</italic><sub><italic>c</italic></sub> are independent according to the null model. Calculating the distribution of <italic>Q</italic><sub><italic>d</italic></sub> then involves the analysis of the convolution of two independent binomial distributions. To gain intuition, imagine we draw two random numbers, one from <italic>Q</italic><sub><italic>t</italic></sub> and one from <italic>Q</italic><sub><italic>c</italic></sub>. What is the probability to observe a difference of <italic>d</italic>? Let us assume for a moment that <italic>d</italic> ≥ 0. There are 2 · <italic>q</italic><sub>max</sub> − <italic>d</italic> + 1 different ways to observe a difference of <italic>d</italic>. For instance, there can be zero saturated positions in the control experiments (<italic>Q</italic><sub><italic>c</italic></sub> = 0) and <italic>d</italic> saturated positions in the treatment experiments (<italic>Q</italic><sub><italic>t</italic></sub> = <italic>d</italic>), or one saturated position in the control experiments (<italic>Q</italic><sub><italic>c</italic></sub> = 1) and <italic>d</italic> + 1 saturated positions in the treatment experiments (<italic>Q</italic><sub><italic>t</italic></sub> = <italic>d + 1</italic>), and so on up to a maximum of 2 · <italic>q</italic><sub>max</sub> − <italic>d</italic> saturated positions in the control experiments (<italic>Q</italic><sub><italic>c</italic></sub> = 2 · <italic>q</italic><sub>max</sub> − <italic>d</italic>) and 2 · <italic>q</italic><sub>max</sub> such positions in the treatment experiments (<italic>Q</italic><sub><italic>t</italic></sub> = 2 · <italic>q</italic><sub>max</sub>). To calculate the probability of observing <italic>Q</italic><sub><italic>d</italic></sub> = <italic>d</italic>, we have to sum up the 2 · <italic>q</italic><sub>max</sub> − <italic>d</italic> + 1 products for each possible combination.
<disp-formula><mml:math id="UM16"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>In general, however, if <italic>Q</italic><sub><italic>c</italic></sub> &gt; <italic>Q</italic><sub><italic>t</italic></sub>, there will be terms where <italic>i</italic> + <italic>d</italic> &lt; 0 and terms where <italic>i</italic> + <italic>d</italic> &gt; 2 · <italic>q</italic><sub>max</sub>. Furthermore, there are terms where <italic>i</italic> becomes larger than 2 · <italic>q</italic><sub>max</sub>. Therefore, we use the preceding equation for <italic>d</italic> ≥ 0 and the following equation for <italic>d</italic> &lt; 0:
<disp-formula><mml:math id="UM17"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⋅</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>It is useful to allow for negative differences, which may be observed if the sequencing depth for the control sample is much higher than that for the treatment sample. This definition therefore allows us to use control sample data without necessarily having to down-sample the reads to a level comparable to that of the test samples (Supplemental Fig. S4). Finally, the probability that a candidate region represents a ChIP-seq peak with a difference in saturated positions of <italic>Q</italic><sub><italic>d</italic></sub> = <italic>d</italic> between treatment and control is
<disp-formula><mml:math id="UM18"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mspace width="0.4em"/><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:munderover><mml:mo>⁡</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
    </sec>
    <sec id="s3g">
      <title>Multiple testing correction</title>
      <p>All regions covered by at least one qfrag are tested. <italic>P</italic>-values are corrected for multiple testing using the Benjamini–Hochberg procedure (<xref rid="HANSENGR189894C4" ref-type="bibr">Benjamini and Hochberg 1995</xref>).</p>
    </sec>
    <sec id="s3h">
      <title>Data preparation</title>
      <p>We evaluated the performance of our method based on the analysis of 38 ChIP-seq experiments of the ENCODE Project Consortium. These experiments correspond to 19 biological replicates, seven cell types, and 17 target proteins (Supplemental Table S1). Data sets were downloaded from UCSC (<xref rid="HANSENGR189894C25" ref-type="bibr">Rosenbloom et al. 2013</xref>) in BAM format. Unmapped reads, duplicates, and reads mapping to chromosomes other than Chromosomes 1–22, X and Y were removed.</p>
    </sec>
    <sec id="s3i">
      <title>Peak calling</title>
      <p>We compared our method to the peak callers MACS2 (version 2.0.10.20120913), SPP (version 1.11), and PeakSeq (version 1.1). We determined an average fragment length ℓ and a window half size <italic>whs</italic> using the cross-correlation analysis of SPP. To ensure a standardized comparison, we used ℓ as input for all peak callers; <italic>whs</italic> was also used as an input parameter for SPP. For the experiments described here, we performed down-sampling for the treatment or control data sets to an equal number of mapped reads as for the treatment data sets. We performed low stringency analyses for all peak callers by setting the thresholds appropriately. Peak lists were sorted by significance and truncated at 100,000 for reproducibility analysis and at 50,000 for motif content analysis. The parameters used for peak calling are shown in the Supplemental Methods.</p>
    </sec>
    <sec id="s3j">
      <title>Reproducibility analysis</title>
      <p>The IDR procedure is intended to assess the reproducibility of peaks called in ChIP-seq experiments (<xref rid="HANSENGR189894C17" ref-type="bibr">Li et al. 2011</xref>). We performed IDR analysis as detailed in Supplemental Methods. Two pseudoreplicates (<xref rid="HANSENGR189894C17" ref-type="bibr">Li et al. 2011</xref>; <xref rid="HANSENGR189894C15" ref-type="bibr">Landt et al. 2012</xref>) were created for each data set by dividing the treatment and control data randomly into two halves. For each of the four peak callers, we set up a workflow for IDR analysis using the recommended parameters. For Q, MACS2, and PeakSeq, the peaks were sorted by <italic>P</italic>-value and for SPP by signal value. The top 100,000 peaks were used as input for the IDR analysis and for the calculation of the counts of overlapping peaks.</p>
    </sec>
    <sec id="s3k">
      <title>Motif content analysis</title>
      <p>For the peak callers Q, MACS2, SPP, and PeakSeq peaks were called using the prepared data sets (Supplemental Table S1) and parameters as described above. Peak lists were sorted as for reproducibility analysis. Summits were extended upstream and downstream by one estimated fragment length ℓ.</p>
      <p>To get the reference peak set, the top 50,000 peaks were iteratively and pairwise intersected using intersectBed of BEDTools (<xref rid="HANSENGR189894C23" ref-type="bibr">Quinlan and Hall 2010</xref>), requiring an overlap of at least 50%. At first, the top 50,000 peaks for Q and MACS2 were intersected, the resulting peak list was then intersected with the top 50,000 peaks of SPP, and the resulting peak list was finally intersected with the top 50,000 peaks of PeakSeq. In this way, two summits in a combined peak are separated by a distance of at most 3·ℓ, and there is no peak broader than 5·ℓ.</p>
      <p>The genomic sequences of reference peaks were cut out, and repeats were masked by replacing lowercase letters with Ns. These sequences were used as input for DREME (<xref rid="HANSENGR189894C2" ref-type="bibr">Bailey 2011</xref>) to derive the top 10 most significant motifs. For the summits of the top 50,000 peaks, the genomic sequences ℓ/2 upstream and downstream were extracted. These sequences were scanned for occurrences of the 10 reference motifs using FIMO (<xref rid="HANSENGR189894C10" ref-type="bibr">Grant et al. 2011</xref>) with a <italic>P</italic>-value cutoff of 0.0001. For each of the initial top 50,000 peaks of the different peak callers, the number of peaks that contain at least one motif occurrence was determined.</p>
    </sec>
    <sec id="s3l">
      <title>TSS flanking double summits</title>
      <p>We analyzed the H3K4me3 data sets (Supplemental Table 1) in the same way as we did for the reproducibility analysis of other data sets. We took the overlap of the top 100,000 peaks as input for the TFDS analysis. We used the transcript annotation from NCBI (build 37.2; NCBI <italic>Homo sapiens</italic> annotation release 104). Promoters were defined as TSS ± 1500 nt. The total of 29,692 promoters were filtered for 19,722 non-overlapping promoters.</p>
      <p>In order to assess whether the observed number of cases in which for a given promoter the TFDS for RNAPII is completely contained between the TFDS for H3K4me3 occurs by chance, we generated data simulations as follows: For each promoter that had been assigned a TFDS for both RNAPII and H3K4me3, we obtained the distances of the upstream and downstream summit for H3K4me3 and for RNAPII. We shuffled the observed intervals for the H3K4me3 TFDSs among these promoters and then examined the number that show the pattern where the RNAPII TFDS is completely contained in the H3K4me3 TFDS. In 10,000 simulations, we did not observe even a single case in which the number of promoters showing this pattern was as high as in the observed data (empirical <italic>P</italic>-value &lt;10<sup>−4</sup>) (Supplemental Table S11).</p>
    </sec>
    <sec id="s3m">
      <title>Software availability</title>
      <p>The Q algorithm was implemented in C++, and the source code is available in the Supplemental Material and under an open-source BSD2 license at <uri xlink:href="https://github.com/charite/Q">https://github.com/charite/Q</uri>. The GitHub site has a link to a detailed tutorial.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_25_9_1391__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.189894.115_Supplemental_Material.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>This study was supported by a grant from the Bundesministerium für Bildung und Forschung (Förderkennziffer FKZ 1315848A). P.N.R. received additional support from the European Commission's Seventh Framework Programme (SYBIL, 602300). J.H. and P.N.R. received additional support from the Deutsche Forschungsgemeinschaft (Mu 880/11-1).</p>
    <p><italic>Author Contributions:</italic> P.H. conceived and developed the Q algorithm, analyzed the data presented in the paper, and wrote the manuscript. D.I., M.T., and J.H. assisted with the analysis in the paper and provided biological insights into the ChIP-seq procedure. A.K. assisted with the statistical analysis. P.N.R. helped develop the algorithm, supervised the analysis, and wrote the manuscript.</p>
  </ack>
  <fn-group>
    <fn fn-type="supplementary-material">
      <p>[Supplemental material is available for this article.]</p>
    </fn>
    <fn>
      <p>Article published online before print. Article, supplemental material, and publication date are at <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/doi/10.1101/gr.189894.115">http://www.genome.org/cgi/doi/10.1101/gr.189894.115</ext-link>.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="HANSENGR189894C1">
      <mixed-citation publication-type="journal"><string-name><surname>Arya</surname><given-names>G</given-names></string-name>, <string-name><surname>Maitra</surname><given-names>A</given-names></string-name>, <string-name><surname>Grigoryev</surname><given-names>SA</given-names></string-name>. <year>2010</year><article-title>A structural perspective on the where, how, why, and what of nucleosome positioning</article-title>. <source>J Biomol Struct Dyn</source><volume>27</volume>: <fpage>803</fpage>–<lpage>820</lpage>.<pub-id pub-id-type="pmid">20232935</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C2">
      <mixed-citation publication-type="journal"><string-name><surname>Bailey</surname><given-names>TL</given-names></string-name>. <year>2011</year><article-title>DREME: motif discovery in transcription factor ChIP-seq data</article-title>. <source>Bioinformatics</source><volume>27</volume>: <fpage>1653</fpage>–<lpage>1659</lpage>.<pub-id pub-id-type="pmid">21543442</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C3">
      <mixed-citation publication-type="journal"><string-name><surname>Bardet</surname><given-names>AF</given-names></string-name>, <string-name><surname>Steinmann</surname><given-names>J</given-names></string-name>, <string-name><surname>Bafna</surname><given-names>S</given-names></string-name>, <string-name><surname>Knoblich</surname><given-names>JA</given-names></string-name>, <string-name><surname>Zeitlinger</surname><given-names>J</given-names></string-name>, <string-name><surname>Stark</surname><given-names>A</given-names></string-name>. <year>2013</year><article-title>Identification of transcription factor binding sites from ChIP-seq data at high resolution</article-title>. <source>Bioinformatics</source><volume>29</volume>: <fpage>2705</fpage>–<lpage>2713</lpage>.<pub-id pub-id-type="pmid">23980024</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C4">
      <mixed-citation publication-type="journal"><string-name><surname>Benjamini</surname><given-names>Y</given-names></string-name>, <string-name><surname>Hochberg</surname><given-names>Y</given-names></string-name>. <year>1995</year><article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J R Stat Soc Series B (Methodol)</source><volume>57</volume>: <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="HANSENGR189894C5">
      <mixed-citation publication-type="journal"><string-name><surname>Cairns</surname><given-names>BR</given-names></string-name>. <year>2009</year><article-title>The logic of chromatin architecture and remodelling at promoters</article-title>. <source>Nature</source><volume>461</volume>: <fpage>193</fpage>–<lpage>198</lpage>.<pub-id pub-id-type="pmid">19741699</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C6">
      <mixed-citation publication-type="journal"><string-name><surname>Doring</surname><given-names>A</given-names></string-name>, <string-name><surname>Weese</surname><given-names>D</given-names></string-name>, <string-name><surname>Rausch</surname><given-names>T</given-names></string-name>, <string-name><surname>Reinert</surname><given-names>K</given-names></string-name>. <year>2008</year><article-title>SeqAn: an efficient, generic C++ library for sequence analysis</article-title>. <source>BMC Bioinformatics</source><volume>9</volume>: <fpage>11</fpage>.<pub-id pub-id-type="pmid">18184432</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C7">
      <mixed-citation publication-type="journal"><collab>The ENCODE Consortium</collab>. <year>2012</year><article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source><volume>489</volume>: <fpage>57</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C8">
      <mixed-citation publication-type="book"><string-name><surname>Feller</surname><given-names>W</given-names></string-name>. <year>1968</year><source>An introduction to probability theory and its applications</source>, <volume>Vol. I</volume>, <edition>3rd ed.</edition><publisher-name>John Wiley &amp; Sons, Inc</publisher-name>, <publisher-loc>New York</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="HANSENGR189894C9">
      <mixed-citation publication-type="journal"><string-name><surname>Feng</surname><given-names>J</given-names></string-name>, <string-name><surname>Liu</surname><given-names>T</given-names></string-name>, <string-name><surname>Qin</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Liu</surname><given-names>XS</given-names></string-name>. <year>2012</year><article-title>Identifying ChIP-seq enrichment using MACS</article-title>. <source>Nat Protoc</source><volume>7</volume>: <fpage>1728</fpage>–<lpage>1740</lpage>.<pub-id pub-id-type="pmid">22936215</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C10">
      <mixed-citation publication-type="journal"><string-name><surname>Grant</surname><given-names>CE</given-names></string-name>, <string-name><surname>Bailey</surname><given-names>TL</given-names></string-name>, <string-name><surname>Noble</surname><given-names>WS</given-names></string-name>. <year>2011</year><article-title>FIMO: scanning for occurrences of a given motif</article-title>. <source>Bioinformatics</source><volume>27</volume>: <fpage>1017</fpage>–<lpage>1018</lpage>.<pub-id pub-id-type="pmid">21330290</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C11">
      <mixed-citation publication-type="journal"><string-name><surname>Ibrahim</surname><given-names>DM</given-names></string-name>, <string-name><surname>Hansen</surname><given-names>P</given-names></string-name>, <string-name><surname>Rodelsperger</surname><given-names>C</given-names></string-name>, <string-name><surname>Stiege</surname><given-names>AC</given-names></string-name>, <string-name><surname>Doelken</surname><given-names>SC</given-names></string-name>, <string-name><surname>Horn</surname><given-names>D</given-names></string-name>, <string-name><surname>Jager</surname><given-names>M</given-names></string-name>, <string-name><surname>Janetzki</surname><given-names>C</given-names></string-name>, <string-name><surname>Krawitz</surname><given-names>P</given-names></string-name>, <string-name><surname>Leschik</surname><given-names>G</given-names></string-name>, <etal/><year>2013</year><article-title>Distinct global shifts in genomic binding profiles of limb malformation-associated <italic>HOXD13</italic> mutations</article-title>. <source>Genome Res</source><volume>23</volume>: <fpage>2091</fpage>–<lpage>2102</lpage>.<pub-id pub-id-type="pmid">23995701</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C12">
      <mixed-citation publication-type="journal"><string-name><surname>Kharchenko</surname><given-names>PV</given-names></string-name>, <string-name><surname>Tolstorukov</surname><given-names>MY</given-names></string-name>, <string-name><surname>Park</surname><given-names>PJ</given-names></string-name>. <year>2008</year><article-title>Design and analysis of ChIP-seq experiments for DNA-binding proteins</article-title>. <source>Nat Biotechnol</source><volume>26</volume>: <fpage>1351</fpage>–<lpage>1359</lpage>.<pub-id pub-id-type="pmid">19029915</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C13">
      <mixed-citation publication-type="journal"><string-name><surname>Kim</surname><given-names>H</given-names></string-name>, <string-name><surname>Kim</surname><given-names>J</given-names></string-name>, <string-name><surname>Selby</surname><given-names>H</given-names></string-name>, <string-name><surname>Gao</surname><given-names>D</given-names></string-name>, <string-name><surname>Tong</surname><given-names>T</given-names></string-name>, <string-name><surname>Phang</surname><given-names>TL</given-names></string-name>, <string-name><surname>Tan</surname><given-names>AC</given-names></string-name>. <year>2011</year><article-title>A short survey of computational analysis methods in analysing ChIP-seq data</article-title>. <source>Hum Genomics</source><volume>5</volume>: <fpage>117</fpage>–<lpage>123</lpage>.<pub-id pub-id-type="pmid">21296745</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C14">
      <mixed-citation publication-type="journal"><string-name><surname>Laajala</surname><given-names>TD</given-names></string-name>, <string-name><surname>Raghav</surname><given-names>S</given-names></string-name>, <string-name><surname>Tuomela</surname><given-names>S</given-names></string-name>, <string-name><surname>Lahesmaa</surname><given-names>R</given-names></string-name>, <string-name><surname>Aittokallio</surname><given-names>T</given-names></string-name>, <string-name><surname>Elo</surname><given-names>LL</given-names></string-name>. <year>2009</year><article-title>A practical comparison of methods for detecting transcription factor binding sites in ChIP-seq experiments</article-title>. <source>BMC Genomics</source><volume>10</volume>: <fpage>618</fpage>.<pub-id pub-id-type="pmid">20017957</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C15">
      <mixed-citation publication-type="journal"><string-name><surname>Landt</surname><given-names>SG</given-names></string-name>, <string-name><surname>Marinov</surname><given-names>GK</given-names></string-name>, <string-name><surname>Kundaje</surname><given-names>A</given-names></string-name>, <string-name><surname>Kheradpour</surname><given-names>P</given-names></string-name>, <string-name><surname>Pauli</surname><given-names>F</given-names></string-name>, <string-name><surname>Batzoglou</surname><given-names>S</given-names></string-name>, <string-name><surname>Bernstein</surname><given-names>BE</given-names></string-name>, <string-name><surname>Bickel</surname><given-names>P</given-names></string-name>, <string-name><surname>Brown</surname><given-names>JB</given-names></string-name>, <string-name><surname>Cayting</surname><given-names>P</given-names></string-name>, <etal/><year>2012</year><article-title>ChIP-seq guidelines and practices of the ENCODE and modENCODE consortia</article-title>. <source>Genome Res</source><volume>22</volume>: <fpage>1813</fpage>–<lpage>1831</lpage>.<pub-id pub-id-type="pmid">22955991</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C16">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname><given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname><given-names>A</given-names></string-name>, <string-name><surname>Fennell</surname><given-names>T</given-names></string-name>, <string-name><surname>Ruan</surname><given-names>J</given-names></string-name>, <string-name><surname>Homer</surname><given-names>N</given-names></string-name>, <string-name><surname>Marth</surname><given-names>G</given-names></string-name>, <string-name><surname>Abecasis</surname><given-names>G</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R</given-names></string-name>. <year>2009</year><article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source><volume>25</volume>: <fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C17">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>Q</given-names></string-name>, <string-name><surname>Brown</surname><given-names>J</given-names></string-name>, <string-name><surname>Huang</surname><given-names>H</given-names></string-name>, <string-name><surname>Bickel</surname><given-names>P</given-names></string-name>. <year>2011</year><article-title>Measuring reproducibility of high-throughput experiments</article-title>. <source>Ann Appl Stat</source><volume>5</volume>: <fpage>1752</fpage>–<lpage>1779</lpage>.</mixed-citation>
    </ref>
    <ref id="HANSENGR189894C18">
      <mixed-citation publication-type="journal"><string-name><surname>Machanick</surname><given-names>P</given-names></string-name>, <string-name><surname>Bailey</surname><given-names>TL</given-names></string-name>. <year>2011</year><article-title>MEME-ChIP: motif analysis of large DNA datasets</article-title>. <source>Bioinformatics</source><volume>27</volume>: <fpage>1696</fpage>–<lpage>1697</lpage>.<pub-id pub-id-type="pmid">21486936</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C19">
      <mixed-citation publication-type="journal"><string-name><surname>Newkirk</surname><given-names>D</given-names></string-name>, <string-name><surname>Biesinger</surname><given-names>J</given-names></string-name>, <string-name><surname>Chon</surname><given-names>A</given-names></string-name>, <string-name><surname>Yokomori</surname><given-names>K</given-names></string-name>, <string-name><surname>Xie</surname><given-names>X</given-names></string-name>. <year>2011</year><article-title>AREM: aligning short reads from ChIP-sequencing by expectation maximization</article-title>. <source>J Comput Biol</source><volume>18</volume>: <fpage>1495</fpage>–<lpage>1505</lpage>.<pub-id pub-id-type="pmid">22035330</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C20">
      <mixed-citation publication-type="journal"><string-name><surname>Park</surname><given-names>PJ</given-names></string-name>. <year>2009</year><article-title>ChIP-seq: advantages and challenges of a maturing technology</article-title>. <source>Nat Rev Genet</source><volume>10</volume>: <fpage>669</fpage>–<lpage>680</lpage>.<pub-id pub-id-type="pmid">19736561</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C21">
      <mixed-citation publication-type="journal"><string-name><surname>Peng</surname><given-names>W</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>K</given-names></string-name>. <year>2011</year><article-title>An integrated strategy for identification of both sharp and broad peaks from next-generation sequencing data</article-title>. <source>Genome Biol</source><volume>12</volume>: <fpage>120</fpage>.<pub-id pub-id-type="pmid">21787381</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C22">
      <mixed-citation publication-type="journal"><string-name><surname>Pepke</surname><given-names>S</given-names></string-name>, <string-name><surname>Wold</surname><given-names>B</given-names></string-name>, <string-name><surname>Mortazavi</surname><given-names>A</given-names></string-name>. <year>2009</year><article-title>Computation for ChIP-seq and RNA-seq studies</article-title>. <source>Nat Methods</source><volume>6</volume>(<issue><bold>11 Suppl</bold><bold>:</bold></issue><fpage>S22</fpage>–<lpage>S32</lpage>.<pub-id pub-id-type="pmid">19844228</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C23">
      <mixed-citation publication-type="journal"><string-name><surname>Quinlan</surname><given-names>AR</given-names></string-name>, <string-name><surname>Hall</surname><given-names>IM</given-names></string-name>. <year>2010</year><article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>. <source>Bioinformatics</source><volume>26</volume>: <fpage>841</fpage>–<lpage>842</lpage>.<pub-id pub-id-type="pmid">20110278</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C24">
      <mixed-citation publication-type="journal"><string-name><surname>Robertson</surname><given-names>G</given-names></string-name>, <string-name><surname>Hirst</surname><given-names>M</given-names></string-name>, <string-name><surname>Bainbridge</surname><given-names>M</given-names></string-name>, <string-name><surname>Bilenky</surname><given-names>M</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zeng</surname><given-names>T</given-names></string-name>, <string-name><surname>Euskirchen</surname><given-names>G</given-names></string-name>, <string-name><surname>Bernier</surname><given-names>B</given-names></string-name>, <string-name><surname>Varhol</surname><given-names>R</given-names></string-name>, <string-name><surname>Delaney</surname><given-names>A</given-names></string-name>, <etal/><year>2007</year><article-title>Genome-wide profiles of STAT1 DNA association using chromatin immunoprecipitation and massively parallel sequencing</article-title>. <source>Nat Methods</source><volume>4</volume>: <fpage>651</fpage>–<lpage>657</lpage>.<pub-id pub-id-type="pmid">17558387</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C25">
      <mixed-citation publication-type="journal"><string-name><surname>Rosenbloom</surname><given-names>KR</given-names></string-name>, <string-name><surname>Sloan</surname><given-names>CA</given-names></string-name>, <string-name><surname>Malladi</surname><given-names>VS</given-names></string-name>, <string-name><surname>Dreszer</surname><given-names>TR</given-names></string-name>, <string-name><surname>Learned</surname><given-names>K</given-names></string-name>, <string-name><surname>Kirkup</surname><given-names>VM</given-names></string-name>, <string-name><surname>Wong</surname><given-names>MC</given-names></string-name>, <string-name><surname>Maddren</surname><given-names>M</given-names></string-name>, <string-name><surname>Fang</surname><given-names>R</given-names></string-name>, <string-name><surname>Heitner</surname><given-names>SG</given-names></string-name>, <etal/><year>2013</year><article-title>ENCODE data in the UCSC Genome Browser: year 5 update</article-title>. <source>Nucleic Acids Res</source><volume>41</volume>(<comment>Database issue</comment>): <fpage>D56</fpage>–<lpage>D63</lpage>.<pub-id pub-id-type="pmid">23193274</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C26">
      <mixed-citation publication-type="journal"><string-name><surname>Rozowsky</surname><given-names>J</given-names></string-name>, <string-name><surname>Euskirchen</surname><given-names>G</given-names></string-name>, <string-name><surname>Auerbach</surname><given-names>RK</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>ZD</given-names></string-name>, <string-name><surname>Gibson</surname><given-names>T</given-names></string-name>, <string-name><surname>Bjornson</surname><given-names>R</given-names></string-name>, <string-name><surname>Carriero</surname><given-names>N</given-names></string-name>, <string-name><surname>Snyder</surname><given-names>M</given-names></string-name>, <string-name><surname>Gerstein</surname><given-names>MB</given-names></string-name>. <year>2009</year><article-title>PeakSeq enables systematic scoring of ChIP-seq experiments relative to controls</article-title>. <source>Nat Biotechnol</source><volume>27</volume>: <fpage>66</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">19122651</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C27">
      <mixed-citation publication-type="journal"><string-name><surname>Rye</surname><given-names>MB</given-names></string-name>, <string-name><surname>Saetrom</surname><given-names>P</given-names></string-name>, <string-name><surname>Drablos</surname><given-names>F</given-names></string-name>. <year>2011</year><article-title>A manually curated ChIP-seq benchmark demonstrates room for improvement in current peak-finder programs</article-title>. <source>Nucleic Acids Res</source><volume>39</volume>: <fpage>e25</fpage>.<pub-id pub-id-type="pmid">21113027</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C28">
      <mixed-citation publication-type="journal"><string-name><surname>Stadelmayer</surname><given-names>B</given-names></string-name>, <string-name><surname>Micas</surname><given-names>G</given-names></string-name>, <string-name><surname>Gamot</surname><given-names>A</given-names></string-name>, <string-name><surname>Martin</surname><given-names>P</given-names></string-name>, <string-name><surname>Malirat</surname><given-names>N</given-names></string-name>, <string-name><surname>Koval</surname><given-names>S</given-names></string-name>, <string-name><surname>Raffel</surname><given-names>R</given-names></string-name>, <string-name><surname>Sobhian</surname><given-names>B</given-names></string-name>, <string-name><surname>Severac</surname><given-names>D</given-names></string-name>, <string-name><surname>Rialle</surname><given-names>S</given-names></string-name>, <etal/><year>2014</year><article-title>Integrator complex regulates NELF-mediated RNA polymerase II pause/release and processivity at coding genes</article-title>. <source>Nat Commun</source><volume>5</volume>: <fpage>5531</fpage>.<pub-id pub-id-type="pmid">25410209</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C30">
      <mixed-citation publication-type="journal"><string-name><surname>Szalkowski</surname><given-names>AM</given-names></string-name>, <string-name><surname>Schmid</surname><given-names>CD</given-names></string-name>. <year>2011</year><article-title>Rapid innovation in ChIP-seq peak-calling algorithms is outdistancing benchmarking efforts</article-title>. <source>Brief Bioinform</source><volume>12</volume>: <fpage>626</fpage>–<lpage>633</lpage>.<pub-id pub-id-type="pmid">21059603</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C31">
      <mixed-citation publication-type="journal"><string-name><surname>Wilbanks</surname><given-names>EG</given-names></string-name>, <string-name><surname>Facciotti</surname><given-names>MT</given-names></string-name>. <year>2010</year><article-title>Evaluation of algorithm performance in ChIP-seq peak detection</article-title>. <source>PLoS One</source><volume>5</volume>: <fpage>e11471</fpage>.<pub-id pub-id-type="pmid">20628599</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C32">
      <mixed-citation publication-type="journal"><string-name><surname>Xing</surname><given-names>H</given-names></string-name>, <string-name><surname>Mo</surname><given-names>Y</given-names></string-name>, <string-name><surname>Liao</surname><given-names>W</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>MQ</given-names></string-name>. <year>2012</year><article-title>Genome-wide localization of protein-DNA binding and histone modification by a Bayesian change-point method with ChIP-seq data</article-title>. <source>PLoS Comput Biol</source><volume>8</volume>: <fpage>e1002613</fpage>.<pub-id pub-id-type="pmid">22844240</pub-id></mixed-citation>
    </ref>
    <ref id="HANSENGR189894C33">
      <mixed-citation publication-type="journal"><string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Liu</surname><given-names>T</given-names></string-name>, <string-name><surname>Meyer</surname><given-names>CA</given-names></string-name>, <string-name><surname>Eeckhoute</surname><given-names>J</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>DS</given-names></string-name>, <string-name><surname>Bernstein</surname><given-names>BE</given-names></string-name>, <string-name><surname>Nusbaum</surname><given-names>C</given-names></string-name>, <string-name><surname>Myers</surname><given-names>RM</given-names></string-name>, <string-name><surname>Brown</surname><given-names>M</given-names></string-name>, <string-name><surname>Li</surname><given-names>W</given-names></string-name>, <etal/><year>2008</year><article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>. <source>Genome Biol</source><volume>9</volume>: <fpage>R137</fpage>.<pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
