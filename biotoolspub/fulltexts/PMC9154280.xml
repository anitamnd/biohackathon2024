<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9154280</article-id>
    <article-id pub-id-type="pmid">35485743</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac303</article-id>
    <article-id pub-id-type="publisher-id">btac303</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Bioimage Informatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ATHENA: analysis of tumor heterogeneity from spatial omics measurements</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Martinelli</surname>
          <given-names>Adriano Luca</given-names>
        </name>
        <aff><institution>IBM Research Europe</institution>, Zurich, 8803 Rüschlikon, <country country="CH">Switzerland</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3883-4871</contrib-id>
        <name>
          <surname>Rapsomaniki</surname>
          <given-names>Maria Anna</given-names>
        </name>
        <xref rid="btac303-cor1" ref-type="corresp"/>
        <aff><institution>IBM Research Europe</institution>, Zurich, 8803 Rüschlikon, <country country="CH">Switzerland</country></aff>
        <!--aap@zurich.ibm.com-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Peng</surname>
          <given-names>Hanchuan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac303-cor1">To whom correspondence should be addressed. <email>aap@zurich.ibm.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-04-29">
      <day>29</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>11</issue>
    <fpage>3151</fpage>
    <lpage>3153</lpage>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>1</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>23</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>5</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac303.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Tumor heterogeneity has emerged as a fundamental property of most human cancers, with broad implications for diagnosis and treatment. Recently, spatial omics have enabled spatial tumor profiling, however computational resources that exploit the measurements to quantify tumor heterogeneity in a spatially aware manner are largely missing. We present ATHENA (Analysis of Tumor HEterogeNeity from spAtial omics measurements), a computational framework that facilitates the visualization, processing and analysis of tumor heterogeneity from spatial omics measurements. ATHENA uses graph representations of tumors and bundles together a large collection of established and novel heterogeneity scores that quantify different aspects of the complexity of tumor ecosystems.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>ATHENA is available as a Python package under an open-source license at: <ext-link xlink:href="https://github.com/AI4SCR/ATHENA" ext-link-type="uri">https://github.com/AI4SCR/ATHENA</ext-link>. Detailed documentation and step-by-step tutorials with example datasets are also available at: <ext-link xlink:href="https://ai4scr.github.io/ATHENA/" ext-link-type="uri">https://ai4scr.github.io/ATHENA/</ext-link>. The data presented in this article are publicly available on Figshare at <ext-link xlink:href="https://figshare.com/articles/dataset/zurich_pkl/19617642/2" ext-link-type="uri">https://figshare.com/articles/dataset/zurich_pkl/19617642/2</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Swiss National Science Foundation (SNSF)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CRSII5_202297</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Tumor ecosystems exhibit a considerable degree of inter- and intra-tumor phenotypic heterogeneity, arising from both intrinsic and extrinsic sources (<xref rid="btac303-B6" ref-type="bibr">Marusyk <italic toggle="yes">et al.</italic>, 2012</xref>). Within these ecosystems, a number of phenotypically diverse cancer cell subpopulations coexist alongside other cell types of the tumor microenvironment, notably immune and stromal cells. However, their synergistic or antagonistic interactions are not fully understood. Growing evidence suggests that tumor heterogeneity is clinically relevant and not only determines disease progression, but also affects therapeutic response (<xref rid="btac303-B10" ref-type="bibr">Tabassum and Polyak, 2015</xref>). Accurate and biologically meaningful quantification of tumor heterogeneity at diagnosis or during treatment has the potential to translate biological complexity into actionable insight, enabling precise and personalized therapy approaches.</p>
    <p>To achieve this goal, several heterogeneity quantification scores have been devised, largely based on spatial statistics and information theory, that, when applied to different omics or tissue imaging data showed prognostic capabilities in various cancer types (<xref rid="btac303-B5" ref-type="bibr">Kashyap <italic toggle="yes">et al.</italic>, 2021</xref>). At the same time, the advancement of spatial omics [e.g. imaging mass cytometry (<xref rid="btac303-B3" ref-type="bibr">Giesen <italic toggle="yes">et al.</italic>, 2014</xref>), multiplexed ion beam imaging (<xref rid="btac303-B1" ref-type="bibr">Angelo <italic toggle="yes">et al.</italic>, 2014</xref>) and spatial transcriptomics (<xref rid="btac303-B9" ref-type="bibr">Ståhl <italic toggle="yes">et al.</italic>, 2016</xref>)] is revolutionizing cancer biology, enabling the simultaneous quantification of dozens of proteins or thousands of transcripts in millions of cells while preserving the architecture of the tumor ecosystem. Although a number of useful data analysis platforms have emerged [e.g. Squidpy (<xref rid="btac303-B7" ref-type="bibr">Palla <italic toggle="yes">et al.</italic>, 2022</xref>), Giotto (<xref rid="btac303-B2" ref-type="bibr">Dries <italic toggle="yes">et al.</italic>, 2021</xref>) and MISTy (<xref rid="btac303-B11" ref-type="bibr">Tanevski <italic toggle="yes">et al.</italic>, 2022</xref>)], there is a need for a dedicated resource that facilitates tumor heterogeneity quantification. Here, we introduce ATHENA (Analysis of Tumor HEterogeNeity from spAtial omics measurements), an open-source computational framework that brings together established and novel scores able to capture the heterogeneity of the tumor ecosystem, with a strong focus on visualization at each step of the analysis.</p>
  </sec>
  <sec>
    <title>2 Overview of ATHENA</title>
    <p>Starting with raw multiplexed images, cell segmentation masks and cell phenotypes, ATHENA first constructs a cell–cell graph encoding the tumor topology and then applies a number of heterogeneity scores that quantify the complexity of the tumor architecture (<xref rid="btac303-F1" ref-type="fig">Fig. 1A</xref>). ATHENA supports any spatial omic data modality [e.g. imaging mass cytometry (IMC), multiplexed ion beam imaging (MIBI), seqFISH, Visium], as well as standard tissue imaging data [e.g. multiplexed immunohistochemisty (mIHC) or immunofluorescence (mIF)]. ATHENA is implemented in a highly modular, extendable and scalable fashion, based on two main components: <monospace>SpatialOmics</monospace>, a new data structure inspired by AnnData (<xref rid="btac303-B12" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic>, 2018</xref>) that accommodates storing spatial omics data in a technology-agnostic way, and <monospace>SpatialHeterogeneity</monospace>, a module that implements all processing, analysis and visualization steps integral to ATHENA’s functionalities (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.1–S1.2</xref>). At the core of ATHENA resides a graph representation of the tissue, based on three different biologically inspired graph builders that model different levels of cell–cell interactions: (i) a <italic toggle="yes">radius</italic> graph, where cells within a given radius <italic toggle="yes">r</italic> are connected, modeling paracrine signaling, (ii) a <italic toggle="yes">contact</italic> graph, where only cells that are in physical contact are connected, modeling juxtacrine signaling and (iii) a <italic toggle="yes">kNN</italic> graph, where <italic toggle="yes">k</italic> nearest neighboring cells are connected, a popular graph choice in digital pathology (<xref rid="btac303-B8" ref-type="bibr">Pati <italic toggle="yes">et al.</italic>, 2022</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.3</xref>). Next, ATHENA computes a number of established and novel heterogeneity scores, broadly classified into the following categories depending on their underlying mathematical foundations: (i) <italic toggle="yes">spatial statistics</italic> scores that quantify the degree of clustering or dispersion of each phenotype individually, (ii) <italic toggle="yes">graph-theoretic</italic> scores that examine structural properties of the tumor graph, (iii) <italic toggle="yes">information-theoretic</italic> scores that quantify how diverse the tumor is with respect to different phenotypes present and their relative proportions and (iv) <italic toggle="yes">cell interaction</italic> scores that assess the pairwise relationships between different phenotypes in the tumor ecosystem (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods S1.4</xref>). This large collection of scores includes established approaches previously used in multiple tumor heterogeneity studies [see <xref rid="btac303-B5" ref-type="bibr">Kashyap <italic toggle="yes">et al.</italic> (2021)</xref> for a thorough review], as well as novel scores introduced in ATHENA (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). Specifically, ATHENA implements a new concept of <italic toggle="yes">local</italic> heterogeneity scores, computed at a single-cell level using the graph topology that capture spatial heterogeneity and highlight local variations of tumor diversity or cell interactions (<xref rid="btac303-F1" ref-type="fig">Fig. 1D and G</xref>). Finally, ATHENA simplifies interoperability with other spatial omics analysis platforms such as Squipdy (<xref rid="btac303-B7" ref-type="bibr">Palla <italic toggle="yes">et al.</italic>, 2022</xref>), and allows exporting the resulting scores for downstream analysis using any statistics or machine learning platform.</p>
    <fig position="float" id="btac303-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Tumor heterogeneity quantification with ATHENA. (<bold>A</bold>) Schematic overview of ATHENA. (<bold>B–G</bold>) Results from applying ATHENA to a breast cancer imaging mass cytometry sample from <xref rid="btac303-B4" ref-type="bibr">Jackson <italic toggle="yes">et al.</italic> (2020)</xref>. ATHENA exploits the spatial phenotypic distribution (B) and constructs a graph representation of the tumor using a radius or a contact graph topology (C). Different heterogeneity scores highlight local tissue diversity (D), degree of spatial clustering or dispersion (E), cell interactions between the 10 most abundance cell types (F) and local immune infiltration (G)</p>
      </caption>
      <graphic xlink:href="btac303f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We tested ATHENA on a publicly available IMC dataset that contains a number of breast cancer tissue microarray images (<xref rid="btac303-B4" ref-type="bibr">Jackson <italic toggle="yes">et al.</italic>, 2020</xref>), annotated by the authors in a number of phenotypes (<xref rid="btac303-F1" ref-type="fig">Fig. 1B</xref>). Depending on the preferred choice of graph topology, the tumor can be represented as a radius or contact graph (<xref rid="btac303-F1" ref-type="fig">Fig. 1C</xref>), connecting cells within a certain distance, or cells in contact, respectively. Quantification of local Rao’s quadratic entropy highlights tumor regions with high diversity of interactions between phenotypically distant cells (<xref rid="btac303-F1" ref-type="fig">Fig. 1D</xref>). Spatial cluster analysis scores quantify the degree of spatial clustering or dispersion of different phenotypes as a function of distance, revealing a strong clustering of the three most abundant cancer cell phenotypes at a medium distance (peaks in the three curves of <xref rid="btac303-F1" ref-type="fig">Fig. 1E</xref>—top), and random distribution of the three most abundant immune and stromal cell types (curves falling on the zero axis in <xref rid="btac303-F1" ref-type="fig">Fig. 1E</xref>—bottom). Neighborhood analysis scores quantify cell type interactions, suggesting avoidance of cells high for Hormone Receptors (HR<sup>hi</sup>) and positive for Cytokeratins (CK<sup>+</sup>) by most immune and stromal cell types and attraction by most other cancer cell phenotypes (last column indicated by arrow in <xref rid="btac303-F1" ref-type="fig">Fig. 1F</xref>), and self-attraction of Basal CK<sup>+</sup> cells (heatmap entry indicated by arrow in <xref rid="btac303-F1" ref-type="fig">Fig. 1F</xref>). Last, infiltration maps (<xref rid="btac303-F1" ref-type="fig">Fig. 1G</xref>) point to immune-tumor ‘hotspots’, i.e. tumor regions locally penetrated by few immune cells.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>We developed ATHENA to offer to the research community a modular computational framework that allows the quantification of custom heterogeneity scores from spatial omic datasets. ATHENA is highly interoperable with popular single-cell analysis platforms [e.g. Scanpy (<xref rid="btac303-B12" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic>, 2018</xref>), Squidpy (<xref rid="btac303-B7" ref-type="bibr">Palla <italic toggle="yes">et al.</italic>, 2022</xref>)] and can be easily extended to accommodate tailored heterogeneity scores. As spatial omics datasets become increasingly available, we hope that ATHENA will be a valuable resource for accurate tumor heterogeneity analyses.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac303_Supplementary_Data</label>
      <media xlink:href="btac303_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank all members of the computational pathology team at IBM Research Zurich and Prof. Mark Robinson, University of Zurich, for fruitful discussions and feedback.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Swiss National Science Foundation (SNSF) Sinergia Grant [CRSII5_202297].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac303-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Angelo</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Multiplexed ion beam imaging of human breast tumors</article-title>. <source>Nat. Med</source>., <volume>20</volume>, <fpage>436</fpage>–<lpage>442</lpage>.<pub-id pub-id-type="pmid">24584119</pub-id></mixed-citation>
    </ref>
    <ref id="btac303-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dries</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Giotto: a toolbox for integrative analysis and visualization of spatial expression data</article-title>. <source>Genome Biol</source>., <volume>22</volume>, <fpage>78</fpage>.<pub-id pub-id-type="pmid">33685491</pub-id></mixed-citation>
    </ref>
    <ref id="btac303-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giesen</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Highly multiplexed imaging of tumor tissues with subcellular resolution by mass cytometry</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>417</fpage>–<lpage>422</lpage>.<pub-id pub-id-type="pmid">24584193</pub-id></mixed-citation>
    </ref>
    <ref id="btac303-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jackson</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>The single-cell pathology landscape of breast cancer</article-title>. <source>Nature</source>, <volume>578</volume>, <fpage>615</fpage>–<lpage>620</lpage>.<pub-id pub-id-type="pmid">31959985</pub-id></mixed-citation>
    </ref>
    <ref id="btac303-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kashyap</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Quantification of tumor heterogeneity: from data acquisition to metric generation</article-title>. <source>Trends Biotechnol</source>., <pub-id pub-id-type="doi">10.1016/j.tibtech.2021.11.006</pub-id>.</mixed-citation>
    </ref>
    <ref id="btac303-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marusyk</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Intra-tumour heterogeneity: a looking glass for cancer?</article-title>  <source>Nat. Rev. Cancer</source>, <volume>12</volume>, <fpage>323</fpage>–<lpage>334</lpage>.<pub-id pub-id-type="pmid">22513401</pub-id></mixed-citation>
    </ref>
    <ref id="btac303-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Palla</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2022</year>) <article-title>Squidpy: a scalable framework for spatial single cell analysis</article-title>. <source>Nat. Methods</source>, <volume>19</volume>, <fpage>171</fpage>–<lpage>178</lpage>.<pub-id pub-id-type="pmid">35102346</pub-id></mixed-citation>
    </ref>
    <ref id="btac303-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pati</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2022</year>) <article-title>Hierarchical graph representations in digital pathology</article-title>. <source>Med. Image Anal</source>., <volume>75</volume>, <fpage>102264</fpage>.<pub-id pub-id-type="pmid">34781160</pub-id></mixed-citation>
    </ref>
    <ref id="btac303-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ståhl</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>. <source>Science</source>, <volume>353</volume>, <fpage>78</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">27365449</pub-id></mixed-citation>
    </ref>
    <ref id="btac303-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tabassum</surname><given-names>D.P.</given-names></string-name>, <string-name><surname>Polyak</surname><given-names>K.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Tumorigenesis: it takes a village</article-title>. <source>Nat. Rev. Cancer</source>, <volume>15</volume>, <fpage>473</fpage>–<lpage>483</lpage>.<pub-id pub-id-type="pmid">26156638</pub-id></mixed-citation>
    </ref>
    <ref id="btac303-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tanevski</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2022</year>) Explainable multi-view framework for dissecting inter-cellular signaling from highly multiplexed spatial data, <source>Genome Biol</source>., <volume>23</volume>, 97.</mixed-citation>
    </ref>
    <ref id="btac303-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>F.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
