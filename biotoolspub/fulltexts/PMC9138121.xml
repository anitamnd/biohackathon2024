<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ Comput Sci</journal-id>
    <journal-id journal-id-type="publisher-id">peerj-cs</journal-id>
    <journal-title-group>
      <journal-title>PeerJ Computer Science</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2376-5992</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9138121</article-id>
    <article-id pub-id-type="publisher-id">cs-977</article-id>
    <article-id pub-id-type="doi">10.7717/peerj-cs.977</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Computer Vision</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>IRimage: open source software for processing images from infrared thermal cameras</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author" corresp="yes">
        <name>
          <surname>Pereyra Irujo</surname>
          <given-names>Gustavo</given-names>
        </name>
        <email>pereyrairujo.gustavo@conicet.gov.ar</email>
        <xref rid="aff-1" ref-type="aff"/>
      </contrib>
      <aff id="aff-1"><institution>Instituto Nacional de Tecnología Agropecuaria (INTA), Consejo Nacional de Investigaciones Científicas y Técnicas (CONICET)</institution>, <city>Balcarce</city>, <state>Buenos Aires</state>, <country>Argentina</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>James</surname>
          <given-names>Alex</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2022-05-10">
      <day>10</day>
      <month>5</month>
      <year iso-8601-date="2022">2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>e977</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2021-11-18">
        <day>18</day>
        <month>11</month>
        <year iso-8601-date="2021">2021</year>
      </date>
      <date date-type="accepted" iso-8601-date="2022-04-19">
        <day>19</day>
        <month>4</month>
        <year iso-8601-date="2022">2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>©2022 Pereyra Irujo</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Pereyra Irujo</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ Computer Science) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/cs-977"/>
    <abstract>
      <p>IRimage aims at increasing throughput, accuracy and reproducibility of results obtained from thermal images, especially those produced with affordable, consumer-oriented cameras. IRimage processes thermal images, extracting raw data and calculating temperature values with an open and fully documented algorithm, making this data available for further processing using image analysis software. It also allows the making of reproducible measurements of the temperature of objects in a series of images, and produce visual outputs (images and videos) suitable for scientific reporting. IRimage is implemented in a scripting language of the scientific image analysis software ImageJ, allowing its use through a graphical user interface and also allowing for an easy modification or expansion of its functionality. IRimage’s results were consistent with those of standard software for 15 camera models of the most widely used brand. An example use case is also presented, in which IRimage was used to efficiently process hundreds of thermal images to reveal subtle differences in the daily pattern of leaf temperature of plants subjected to different soil water contents. IRimage’s functionalities make it better suited for research purposes than many currently available alternatives, and could contribute to making affordable consumer-grade thermal cameras useful for reproducible research.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Thermography</kwd>
      <kwd>Infrared</kwd>
      <kwd>Thermal</kwd>
      <kwd>Temperature</kwd>
      <kwd>Image processing</kwd>
      <kwd>ImageJ</kwd>
      <kwd>FIJI</kwd>
      <kwd>Open source</kwd>
      <kwd>Reproducibility</kwd>
      <kwd>Consumer thermal cameras</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>Instituto Nacional de Tecnología Agropecuaria</funding-source>
        <award-id>PNCYO-1124072</award-id>
        <award-id>2019-PD-E3-I060</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source>Universidad Nacional de Mar del Plata</funding-source>
        <award-id>AGR572/19</award-id>
        <award-id>AGR637/21</award-id>
      </award-group>
      <award-group id="fund-3">
        <funding-source>Agencia Nacional de Promoción Científica y Técnológica</funding-source>
        <award-id>PICT 2010-0006</award-id>
      </award-group>
      <funding-statement>This work was supported by Instituto Nacional de Tecnología Agropecuaria (PNCYO-1124072, 2019-PD-E3-I060), Universidad Nacional de Mar del Plata (AGR572/19, AGR637/21) and Agencia Nacional de Promoción Científica y Técnológica (PICT 2010-0006). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Thermal imaging has many uses in biological, medical and environmental research (<xref rid="ref-16" ref-type="bibr">Kastberger &amp; Stachl, 2003</xref>). In recent years, thermal cameras have lowered their price, and affordable consumer cameras are now available for as little as 300USD, either as stand-alone devices or smartphone attachments (<xref rid="ref-13" ref-type="bibr">Haglund &amp; Schönborn, 2019</xref>). These cameras, in spite of being marketed as consumer devices, have been proven to be suitable as scientific instruments for research (<xref rid="ref-25" ref-type="bibr">Pereyra Irujo et al., 2015</xref>; <xref rid="ref-17" ref-type="bibr">Klaessens, Veen &amp; Verdaasdonk, 2017</xref>; <xref rid="ref-28" ref-type="bibr">Razani, Parkhimchyk &amp; Tabatabaei, 2018</xref>; <xref rid="ref-27" ref-type="bibr">Petrie et al., 2019</xref>; <xref rid="ref-35" ref-type="bibr">Van Doremalen et al., 2019</xref>; <xref rid="ref-22" ref-type="bibr">Nosrati et al., 2020</xref>) and have the potential to greatly improve access to thermography in many scientific fields, especially for budget-limited scientists.</p>
    <p>Thermal cameras do not measure temperature directly. Temperature is estimated from measured infrared radiation captured by the sensor in the camera, through a series of equations and using a set of parameters, some provided by the user through the camera interface, and others which are set during calibration. The software coupled to these cameras is usually closed-source, which does not allow the user to know the exact algorithms used to obtain the temperature measurements and the final image. For a thermal camera (or any sensor) to be useful for research, the user should be able to have control over (or at least information about) the processing steps between the raw sensor data and the final measurement (<xref rid="ref-5" ref-type="bibr">Dryden et al., 2017</xref>).</p>
    <p>Software provided with low-cost infrared cameras, besides being closed-source, has usually limited functionality, since it is aimed at non-scientific users. This kind of software only allows for temperature measurements of manually selected points or areas in the image (<italic toggle="yes">e.g.</italic>, <xref rid="ref-22" ref-type="bibr">Nosrati et al., 2020</xref>), which is impractical with a large quantity of images, and hinders reproducibility of results. Parameters used for temperature calculations, also required for reproducibility, are generally under-reported (<xref rid="ref-14" ref-type="bibr">Harrap et al., 2018</xref>), a problem which can be made worse with consumer-oriented analysis software (especially smartphone apps) that hide the real values of parameters behind simple user options. Besides obtaining and analyzing temperature data in numerical form, false-color images representing the temperature values are usually necessary for visualizing and reporting. Similarly to scientific plots of data, it is important that this representation of temperature data is quantitatively accurate. In spite of this, some of the default color palettes used in consumer-oriented software are selected for aesthetic reasons and do not meet the necessary criteria for scientific reporting (<xref rid="ref-4" ref-type="bibr">Crameri, Shephard &amp; Heron, 2020</xref>).</p>
    <p>IRimage was developed with the aim of overcoming those problems and allowing researchers to increase throughput, accuracy and reproducibility of results obtained from thermal images, especially those produced with affordable, consumer-oriented cameras. It allows researchers to extract raw data from thermal images and calculate temperature values with an open and fully documented algorithm, making this data available for further processing using standard image analysis or statistical software. It also allows the making of reproducible measurements of the temperature of objects in image sequences, along with other outputs that are useful for further analysis and reporting, such as image timestamps, parameters used for temperature estimations, and customized false-color images and videos that use a scientifically accurate color palette. IRimage was initially developed as an in-house simple tool which was used to benchmark a low-cost thermal camera (the “FLIR One” smartphone attachment, <xref rid="ref-25" ref-type="bibr">Pereyra Irujo et al., 2015</xref>) and to analyse thermal images of wheat varieties (<xref rid="ref-2" ref-type="bibr">Cacciabue, 2016</xref>), and was later developed further in order to make it suitable for a wider range of scientific applications. In this article, IRimage implementation and usage is described, along with its comparison against standard software, and an example use case that highlights the utility of some of its functions.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials &amp; Methods</title>
    <sec>
      <title>Theoretical background for temperature calculations</title>
      <p>One of the main objectives of IRimage is to provide an implementation of an algorithm which is open not only from a software point of view (as in the definition of open source software), but also open in the sense of being transparent and understandable to the end user, and thus available for scientific scrutiny, customization or extension. To this end, a detailed explanation of the theoretical background of the algorithm used in IRimage is presented here.</p>
      <sec>
        <title>Relationship between temperature and infrared radiation</title>
        <p>Thermal cameras are based on the detection of infrared radiation emitted from objects by means of an array of sensors. Each of these sensors generates a digital signal (<italic toggle="yes">S</italic>), which is a function of radiance (<italic toggle="yes">L</italic>). Radiance is the radiant flux (<italic toggle="yes">i.e.,</italic> amount of energy emitted, reflected, transmitted or received per unit time, usually measured in Watts, W) per unit surface and solid angle (in W sr<sup>−1</sup> m<sup>−2</sup>). The relationship between the signal (<italic toggle="yes">S</italic>) resulting from the voltage/current generated by the sensor and the associated electronics (usually quantified as Digital Numbers; DN) and <italic toggle="yes">L</italic> is usually linear, and gain (<italic toggle="yes">G</italic>) and offset (<italic toggle="yes">O</italic>) factors can be calibrated: <disp-formula id="eqn-1"><label>(1)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e001.jpg" position="float"/><tex-math id="tex-eqn-1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}S=G\cdot L+O.\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-1" overflow="scroll"><mml:mstyle displaystyle="true"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo>⋅</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
        <p>Measuring radiance can be used to estimate temperature because the total amount of energy emitted by an object is a function of absolute temperature to the fourth power (according to the Stefan–Boltzmann law). The emission is, however, not equal at different wavelengths (even for a perfect emitter, <italic toggle="yes">i.e.,</italic> a black body): according to Wien’s displacement law, the wavelength corresponding to the peak of emission also depends on temperature. For instance, the peak emission of the sun is around 500nm (in the visible portion of the spectrum), while that of a body at 25 °C is around 10µm (in the far infrared). Since detectors are only sensitive to part of the spectrum, it is necessary to take into account only the spectral radiance (<italic toggle="yes">L</italic><sub><italic toggle="yes">λ</italic></sub>) for a given wavelength (according to the Lambert’s cosine law and the Planck’s law) which is equal to: <disp-formula id="eqn-2"><label>(2)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e002.jpg" position="float"/><tex-math id="tex-eqn-2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{L}_{\lambda }=\cdot \frac{2h{c}^{2}}{{\lambda }^{5}} \cdot \frac{1}{{e}^{ \frac{hc}{\lambda kT} }-1} ,\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-2" overflow="scroll"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ɛ</mml:mi><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>h</mml:mi><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
        <p>where <italic toggle="yes">ɛ</italic> is the emissivity of the surface, <italic toggle="yes">h</italic> is the Planck constant, <italic toggle="yes">c</italic> is the speed of light in the medium, <italic toggle="yes">λ</italic> is the wavelength, <italic toggle="yes">k</italic> is the Boltzmann constant, and <italic toggle="yes">T</italic> is the absolute temperature of that surface (in kelvins). This equation needs to be integrated over the spectral band corresponding to the detector sensitivity (short-wavelength: 1.4–3 µm, mid-wavelength: 3–8 µm, or long-wavelength: 8–15 µm, depending on the type of sensor) or, for simplicity, be multiplied by the spectral sensitivity range (<xref rid="ref-11" ref-type="bibr">Gaussorgues, 1994</xref>). For a given camera (<italic toggle="yes">i.e.,</italic> combination of electronics, sensors and lenses) this equation can be simplified as: <disp-formula id="eqn-3"><label>(3)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e003.jpg" position="float"/><tex-math id="tex-eqn-3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{L}_{\lambda }=\cdot \frac{1}{R\cdot ({e}^{ \frac{B}{T} }-1)} ,\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-3" overflow="scroll"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>ɛ</mml:mi><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
        <p>where <italic toggle="yes">B</italic> and <italic toggle="yes">R</italic> are camera calibration parameters (together with <italic toggle="yes">G</italic> and <italic toggle="yes">O</italic>). In some cases, the constant 1 is also stored as calibration parameter <italic toggle="yes">F</italic>.</p>
        <p>By combining <xref rid="eqn-1" ref-type="disp-formula">Eqs. (1)</xref> and <xref rid="eqn-3" ref-type="disp-formula">(3)</xref>, it is possible to obtain an equation that represents the relationship between <italic toggle="yes">S</italic> and <italic toggle="yes">T</italic> for a given sensor, and can be used for its calibration: <disp-formula id="eqn-4"><label>(4)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e004.jpg" position="float"/><tex-math id="tex-eqn-4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}S=G\cdot \cdot \frac{1}{R\cdot ({e}^{ \frac{B}{T} }-1)} +O.\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-4" overflow="scroll"><mml:mstyle displaystyle="true"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo>⋅</mml:mo><mml:mi>ɛ</mml:mi><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      </sec>
      <sec>
        <title>Sources of radiation</title>
        <p>The radiation received by the camera sensor is not equal to the radiation emitted by the object(s) in its field of view. Depending on the emissivity of the object’s surface, radiation reflected by the object’s surface can contribute significantly to the radiation received by the sensor. Furthermore, this radiation is then attenuated by the atmosphere (mainly by water molecules) even at short distances (<xref rid="ref-19" ref-type="bibr">Minkina &amp; Klecha, 2016</xref>). Taking this into account, the signal detected by the sensor (<italic toggle="yes">S</italic>) can be considered to be composed of three terms: <disp-formula id="eqn-5"><label>(5)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e005.jpg" position="float"/><tex-math id="tex-eqn-5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}S=\tau \cdot {S}_{obj}+\tau \cdot {S}_{refl}+{S}_{atm},\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-5" overflow="scroll"><mml:mstyle displaystyle="true"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mi>τ</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>τ</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
        <p>where the first term is the equivalent digital signal originating from the target object (<italic toggle="yes">S</italic><sub><italic toggle="yes">obj</italic></sub>), attenuated by the atmosphere, which is represented by the atmospheric transmissivity factor tau (<italic toggle="yes">τ</italic>); the second term is the equivalent digital signal from the reflected radiation originating from the target object’s surroundings (<italic toggle="yes">S</italic><sub><italic toggle="yes">refl</italic></sub>), also attenuated by the atmosphere; and the last term is the equivalent digital signal originated from the atmosphere itself in the path between the object and the sensor (<italic toggle="yes">S</italic><sub><italic toggle="yes">atm</italic></sub>).</p>
      </sec>
      <sec>
        <title>Estimation of atmospheric transmissivity</title>
        <p>There are many different models available to estimate atmospheric transmissivity. For short distances, simple models that take into account the amount of water in the air can provide adequate estimates. For long distances (<italic toggle="yes">e.g.</italic>, for infrared cameras used in satellites), more sophisticated models which take into account not only water but also carbon dioxide, ozone, and other molecules, and other atmospheric factors such as scattering are used (<xref rid="ref-11" ref-type="bibr">Gaussorgues, 1994</xref>; <xref rid="ref-37" ref-type="bibr">Zhang et al., 2016</xref>). In this article, the method used in FLIR Systems’ cameras was adopted (<xref rid="ref-7" ref-type="bibr">FLIR Systems, 2001</xref>), which estimates atmospheric transmissivity(<italic toggle="yes">τ</italic>) based on air water content (<italic toggle="yes">H</italic>), calculated from air temperature (<italic toggle="yes">t</italic>) and relative humidity (<italic toggle="yes">RH</italic>), and the distance between the object and the sensor (<italic toggle="yes">d</italic>): <disp-formula id="eqn-6"><label>(6)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e006.jpg" position="float"/><tex-math id="tex-eqn-6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}H=RH\cdot {e}^{(1.5587 + 6.939\cdot 1{0}^{-2}\cdot t - 2.7816\cdot 1{0}^{-4}\cdot {t}^{2} + 6.8455\cdot 1{0}^{-7}\cdot {t}^{3})},\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-6" overflow="scroll"><mml:mstyle displaystyle="true"><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>H</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>5587</mml:mn><mml:mspace width="2.22198pt"/><mml:mo>+</mml:mo><mml:mspace width="2.22198pt"/><mml:mn>6</mml:mn><mml:mo>.</mml:mo><mml:mn>939</mml:mn><mml:mo>⋅</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:mi>t</mml:mi><mml:mspace width="2.22198pt"/><mml:mo>−</mml:mo><mml:mspace width="2.22198pt"/><mml:mn>2</mml:mn><mml:mo>.</mml:mo><mml:mn>7816</mml:mn><mml:mo>⋅</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mspace width="2.22198pt"/><mml:mo>+</mml:mo><mml:mspace width="2.22198pt"/><mml:mn>6</mml:mn><mml:mo>.</mml:mo><mml:mn>8455</mml:mn><mml:mo>⋅</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mfenced></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
<disp-formula id="eqn-7"><label>(7)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e007.jpg" position="float"/><tex-math id="tex-eqn-7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}\tau =X\cdot {e}^{[-\sqrt{d}\cdot ({\alpha }_{1}+{\beta }_{1}\cdot \sqrt{H})]}+(1-X)\cdot {e}^{[-\sqrt{d}\cdot ({\alpha }_{2}+{\beta }_{2}\cdot \sqrt{H})]}.\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-7" overflow="scroll"><mml:mstyle displaystyle="true"><mml:mi>τ</mml:mi><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mfenced separators="" open="[" close="]"><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msqrt><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msqrt><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msqrt></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>X</mml:mi></mml:mfenced></mml:mrow><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mfenced separators="" open="[" close="]"><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msqrt><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msqrt><mml:mrow><mml:mi>H</mml:mi></mml:mrow></mml:msqrt></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      </sec>
      <sec>
        <title>Estimation of digital signal values for different radiation sources</title>
        <p>Assuming all temperatures and emissivities are known, the signal values originating from the different radiation sources, which contribute to the total signal produced by the sensor, can be estimated using <xref rid="eqn-4" ref-type="disp-formula">Eq. (4)</xref>. For the target object, the signal (<italic toggle="yes">S</italic><sub><italic toggle="yes">obj</italic></sub>) can be calculated based on the object temperature (<italic toggle="yes">T</italic><sub><italic toggle="yes">obj</italic></sub>) and its emissivity (<italic toggle="yes">ɛ</italic>): <disp-formula id="eqn-8"><label>(8)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e008.jpg" position="float"/><tex-math id="tex-eqn-8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{S}_{obj}=G\cdot \cdot \frac{1}{R\cdot ({e}^{ \frac{B}{{T}_{obj}} }-1)} +O.\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-8" overflow="scroll"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo>⋅</mml:mo><mml:mi>ɛ</mml:mi><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
        <p>The signal originated from the atmosphere between the object and the sensor (<italic toggle="yes">S</italic><sub><italic toggle="yes">atm</italic></sub>) can be calculated based on air temperature (<italic toggle="yes">T</italic><sub><italic toggle="yes">atm</italic></sub>) and its emissivity, which is equal to 1 − <italic toggle="yes">τ</italic>: <disp-formula id="eqn-9"><label>(9)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e009.jpg" position="float"/><tex-math id="tex-eqn-9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{S}_{atm}=G\cdot (1-\tau )\cdot \frac{1}{R\cdot ({e}^{ \frac{B}{{T}_{atm}} }-1)} +O.\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-9" overflow="scroll"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>τ</mml:mi></mml:mfenced></mml:mrow><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
        <p>For estimating the signal from radiation reflected by the target object (<italic toggle="yes">S</italic><sub><italic toggle="yes">refl</italic></sub>), one must take into account the reflectivity of the object, which is equal to 1 − <italic toggle="yes">ɛ</italic>. Also, it should be necessary to know the temperature of the surrounding objects (<italic toggle="yes">T</italic><sub><italic toggle="yes">refl</italic></sub>) and their emissivity (<italic toggle="yes">ɛ</italic><sub><italic toggle="yes">refl</italic></sub>): <disp-formula id="eqn-10"><label>(10)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e010.jpg" position="float"/><tex-math id="tex-eqn-10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{S}_{refl}=G\cdot (1-)\cdot ({}_{refl})\cdot \frac{1}{R\cdot ({e}^{ \frac{B}{{T}_{refl}} }-1)} +O.\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-10" overflow="scroll"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ɛ</mml:mi></mml:mfenced></mml:mrow><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mi>ɛ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
        <p>Since in most cases it would be difficult to determine the temperature and emissivity of all the surrounding objects, the usual procedure is to estimate an aparent reflected temperature (<italic toggle="yes">T</italic><sub><italic toggle="yes">app</italic>.<italic toggle="yes">refl</italic></sub>), by measuring the apparent temperature of a reflective material with <italic toggle="yes">ɛ</italic> ≈ 0 (usually aluminium foil). Using this procedure, <xref rid="eqn-10" ref-type="disp-formula">Eq. (10)</xref> would be replaced by: <disp-formula id="eqn-11"><label>(11)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e011.jpg" position="float"/><tex-math id="tex-eqn-11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{S}_{refl}=G\cdot (1-)\cdot \frac{1}{R\cdot ({e}^{ \frac{B}{{T}_{app.refl}} }-1)} +O.\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-11" overflow="scroll"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>G</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ɛ</mml:mi></mml:mfenced></mml:mrow><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>p</mml:mi><mml:mi>p</mml:mi><mml:mo>.</mml:mo><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      </sec>
      <sec>
        <title>Object temperature calculation</title>
        <p>In order to calculate object temperature (<italic toggle="yes">T</italic><sub><italic toggle="yes">obj</italic></sub>), it is necessary to first obtain the signal originating from the object by solving <xref rid="eqn-5" ref-type="disp-formula">Eq. (5)</xref> by <italic toggle="yes">S</italic><sub><italic toggle="yes">obj</italic></sub>, and usign the total signal <italic toggle="yes">S</italic> and the results from <xref rid="eqn-7" ref-type="disp-formula">Eqs. 7</xref>, <xref rid="eqn-9" ref-type="disp-formula">9</xref>, and <xref rid="eqn-11" ref-type="disp-formula">11</xref>: <disp-formula id="eqn-12"><label>(12)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e012.jpg" position="float"/><tex-math id="tex-eqn-12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{S}_{obj}= \frac{S}{\tau } -{S}_{refl}- \frac{{S}_{atm}}{\tau } .\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-12" overflow="scroll"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>τ</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
        <p>Finally, by solving <xref rid="eqn-8" ref-type="disp-formula">Eq. (8)</xref> by <italic toggle="yes">T</italic><sub><italic toggle="yes">obj</italic></sub> and using the result of <xref rid="eqn-12" ref-type="disp-formula">Eq. (12)</xref> and the sensor’s gain, offset and calibration parameters (<italic toggle="yes">G</italic>, <italic toggle="yes">O</italic>, <italic toggle="yes">B</italic>, and <italic toggle="yes">R</italic>), it is possible to calculate the object temperature as follows: <disp-formula id="eqn-13"><label>(13)</label><alternatives><graphic xlink:href="peerj-cs-08-977-e013.jpg" position="float"/><tex-math id="tex-eqn-13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{eqnarray*}{T}_{obj}= \frac{B}{\text{log}( \frac{G\cdot }{R\cdot ({S}_{obj}-O)} +1)} .\end{eqnarray*}\end{document}</tex-math><mml:math id="mml-eqn-13" overflow="scroll"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mtext>log</mml:mtext><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:mfrac><mml:mrow><mml:mi>G</mml:mi><mml:mo>⋅</mml:mo><mml:mi>ɛ</mml:mi></mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mo>⋅</mml:mo><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>O</mml:mi></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
</p>
      </sec>
    </sec>
    <sec>
      <title>Implementation of the temperature calculation algorithm</title>
      <p>IRimage was implemented in the macro language of the widely used, open source, scientific image analysis software ImageJ (<xref rid="ref-29" ref-type="bibr">Rueden et al., 2017</xref>) or its distribution FIJI (<xref rid="ref-31" ref-type="bibr">Schindelin et al., 2012</xref>), and also uses the open source software ExifTool (<xref rid="ref-15" ref-type="bibr">Harvey, 2003</xref>) to extract raw values from the thermal images. It was implemented and tested using FLIR brand cameras (FLIR Systems Inc., USA), which is one of the most widely used brands in research (<xref rid="ref-14" ref-type="bibr">Harrap et al., 2018</xref>).</p>
      <sec>
        <title>Extraction of parameters from JPEG files.</title>
        <p>The temperature calculation method relies on having access to the raw sensor data obtained by the camera. In the case of FLIR cameras, this data is stored in the radiometric JPG files (the standard file format for these cameras) as metadata tags in “EXIF” format. This metadata also includes camera-specific and user-set parameters which are also used to calculate temperature. All the parameters that are extracted from the JPG files, and the corresponding variables used in IRimage are detailed in <xref rid="table-1" ref-type="table">Table 1</xref>. First, IRimage uses the ExifTool software (<xref rid="ref-15" ref-type="bibr">Harvey, 2003</xref>) to processes all images in JPG format within the user-selected folder in order to extract the raw sensor data, which is stored as a PNG image. Next, all camera-specific, atmospheric and user-set parameters are extracted.</p>
        <table-wrap position="float" id="table-1">
          <object-id pub-id-type="doi">10.7717/peerjcs.977/table-1</object-id>
          <label>Table 1</label>
          <caption>
            <title>Data and parameters extracted from FLIR radiometric JPEG images.</title>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-cs-08-977-g006" position="float"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">
                    <bold>Parameter / Variable (Units)</bold>
                  </th>
                  <th rowspan="1" colspan="1">
                    <bold>Variable name in IRimage</bold>
                  </th>
                  <th rowspan="1" colspan="1">
                    <bold>Symbol used in equations</bold>
                  </th>
                  <th rowspan="1" colspan="1">
                    <bold>EXIF tag name in FLIR JPG file</bold>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="4" rowspan="1">
                    <italic toggle="yes">Sensor data</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Raw sensor signal (DN)</td>
                  <td rowspan="1" colspan="1">
                    <monospace>rawSignal_DN</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">S</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Raw Thermal Image</monospace>
                  </td>
                </tr>
                <tr>
                  <td colspan="4" rowspan="1">
                    <italic toggle="yes">Calibration / camera-specific parameters</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Raw Thermal Image Type (PNG or TIFF)</td>
                  <td rowspan="1" colspan="1">
                    <monospace>imageType</monospace>
                  </td>
                  <td rowspan="1" colspan="1"/>
                  <td rowspan="1" colspan="1">
                    <monospace>Raw Thermal Image Type</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Camera Model</td>
                  <td rowspan="1" colspan="1">
                    <monospace>cameraModel</monospace>
                  </td>
                  <td rowspan="1" colspan="1"/>
                  <td rowspan="1" colspan="1">
                    <monospace>Camera Model</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Sensor gain</td>
                  <td rowspan="1" colspan="1">
                    <monospace>sensorG</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">G</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Planck R1</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Sensor offset</td>
                  <td rowspan="1" colspan="1">
                    <monospace>sensorO</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">O</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Planck O</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Sensor calibration parameter B</td>
                  <td rowspan="1" colspan="1">
                    <monospace>sensorB</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">B</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Planck B</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Sensor calibration parameter F *</td>
                  <td rowspan="1" colspan="1">
                    <monospace>sensorF</monospace>
                  </td>
                  <td rowspan="1" colspan="1"/>
                  <td rowspan="1" colspan="1">
                    <monospace>Planck F</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Sensor calibration parameter R</td>
                  <td rowspan="1" colspan="1">
                    <monospace>sensorR</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">R</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Planck R2</monospace>
                  </td>
                </tr>
                <tr>
                  <td colspan="4" rowspan="1">
                    <italic toggle="yes">Atmospheric parameters</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Atmospheric transmissivity parameter 1</td>
                  <td rowspan="1" colspan="1">
                    <monospace>atmAlpha1</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">α</italic>
                    <sub>1</sub>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Atmospheric Trans Alpha 1</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Atmospheric transmissivity parameter 2</td>
                  <td rowspan="1" colspan="1">
                    <monospace>atmAlpha2</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">α</italic>
                    <sub>2</sub>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Atmospheric Trans Alpha 2</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Atmospheric transmissivity parameter 1</td>
                  <td rowspan="1" colspan="1">
                    <monospace>atmBeta1</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">β</italic>
                    <sub>1</sub>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Atmospheric Trans Beta 1</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Atmospheric transmissivity parameter 2</td>
                  <td rowspan="1" colspan="1">
                    <monospace>atmBeta2</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">β</italic>
                    <sub>2</sub>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Atmospheric Trans Beta 2</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Atmospheric transmissivity parameter X</td>
                  <td rowspan="1" colspan="1">
                    <monospace>atmX</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">X</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Atmospheric Trans X</monospace>
                  </td>
                </tr>
                <tr>
                  <td colspan="4" rowspan="1">
                    <italic toggle="yes">User-selected parameters</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Apparent reflected temperature (° C)</td>
                  <td rowspan="1" colspan="1">
                    <monospace>appReflTemp_C</monospace>
                  </td>
                  <td rowspan="1" colspan="1"/>
                  <td rowspan="1" colspan="1">
                    <monospace>Reflected Apparent Temperature</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Air temperature (° C)</td>
                  <td rowspan="1" colspan="1">
                    <monospace>airTemp_C</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">t</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Atmospheric Temperature</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Object emissivity</td>
                  <td rowspan="1" colspan="1">
                    <monospace>objEmissivity</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">ɛ</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Emissivity</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Air relative humidity</td>
                  <td rowspan="1" colspan="1">
                    <monospace>airRelHumidity_perc</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">RH</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Relative Humidity</monospace>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Object distance from camera</td>
                  <td rowspan="1" colspan="1">
                    <monospace>objDistance_m</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">d</italic>
                  </td>
                  <td rowspan="1" colspan="1">
                    <monospace>Object Distance</monospace>
                  </td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="table-1fn">
              <p>
                <bold>Notes.</bold>
              </p>
            </fn>
            <fn id="table-1fn1">
              <label>*</label>
              <p>This parameter is included in the JPG EXIF tags but it is (usually) equal to 1, and is equivalent to the value of 1 in the term <inline-formula><alternatives><inline-graphic xlink:href="peerj-cs-08-977-i001.jpg"/><tex-math id="tex-ieqn-79">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$({e}^{ \frac{B}{T} }-1)$\end{document}</tex-math><mml:math id="mml-ieqn-79" overflow="scroll"><mml:mrow><mml:mfenced separators="" open="(" close=")"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:math></alternatives></inline-formula> in <xref rid="eqn-4" ref-type="disp-formula">Eq. (4)</xref>.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>Calculation of derived variables</title>
        <p>The next step is the calculation of variables derived from these parameters (detailed in <xref rid="table-2" ref-type="table">Table 2</xref>), including the calculation of atmospheric transmissivity (using <xref rid="eqn-6" ref-type="disp-formula">Eqs. (6)</xref>–<xref rid="eqn-7" ref-type="disp-formula">(7)</xref>) and the estimated signal from reflected objects and the atmosphere (using <xref rid="eqn-9" ref-type="disp-formula">Eqs. (9)</xref>–<xref rid="eqn-11" ref-type="disp-formula">(11)</xref>). The byte order (endianness) of the raw image is determined from the image type (PNG or TIFF). This works in almost all cases, but it has been found that this rule does not hold for some (at least three) camera models. In those cases, an exception to this rule is included in the code.</p>
        <table-wrap position="float" id="table-2">
          <object-id pub-id-type="doi">10.7717/peerjcs.977/table-2</object-id>
          <label>Table 2</label>
          <caption>
            <title>Variables derived from parameters.</title>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-cs-08-977-g007" position="float"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">
                    <bold>Parameter/Variable (Units)</bold>
                  </th>
                  <th rowspan="1" colspan="1">
                    <bold>Variable name in IRimage</bold>
                  </th>
                  <th rowspan="1" colspan="1">
                    <bold>Symbol used in equations</bold>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">Raw image byte order/endianness</td>
                  <td rowspan="1" colspan="1">
                    <monospace>byteOrderLittleEndian</monospace>
                  </td>
                  <td rowspan="1" colspan="1"/>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Aparent reflected temperature (K)</td>
                  <td rowspan="1" colspan="1">
                    <monospace>appReflTemp_K</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">T</italic>
                    <sub><italic toggle="yes">app</italic>.<italic toggle="yes">refl</italic></sub>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Air temperature (K)</td>
                  <td rowspan="1" colspan="1">
                    <monospace>airTemp_K</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">T</italic>
                    <sub>
                      <italic toggle="yes">atm</italic>
                    </sub>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Air water content</td>
                  <td rowspan="1" colspan="1">
                    <monospace>airWaterContent</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">H</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Atmospheric transmissivity</td>
                  <td rowspan="1" colspan="1">
                    <monospace>atmTau</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">τ</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Raw signal from atmosphere (DN)</td>
                  <td rowspan="1" colspan="1">
                    <monospace>atmRawSignal_DN</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">S</italic>
                    <sub>
                      <italic toggle="yes">atm</italic>
                    </sub>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Raw signal from reflected radiation (DN)</td>
                  <td rowspan="1" colspan="1">
                    <monospace>reflRawSignal_DN</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">S</italic>
                    <sub>
                      <italic toggle="yes">refl</italic>
                    </sub>
                  </td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <p>Depending on the option selected by the user, both the extraction of parameters and the calculation of these variables are either performed for each file or only for the first file in the folder (when the user wants to apply the same set of parameters to all files). In the latter case, the user can also modify the “user-selected” parameters.</p>
      </sec>
      <sec>
        <title>Temperature calculation</title>
        <p>The variables used for the final temperature calculation are detailed in <xref rid="table-3" ref-type="table">Table 3</xref>. The PNG image containing the raw sensor data is opened, and each pixel containing the digital signal from the sensor is processed sequentially. First, the object signal is estimated using <xref rid="eqn-12" ref-type="disp-formula">Eq. (12)</xref>, and then the temperature value is calculated using <xref rid="eqn-13" ref-type="disp-formula">Eq. (13)</xref>.</p>
        <table-wrap position="float" id="table-3">
          <object-id pub-id-type="doi">10.7717/peerjcs.977/table-3</object-id>
          <label>Table 3</label>
          <caption>
            <title>Variables used for temperature calculation.</title>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-cs-08-977-g008" position="float"/>
            <table frame="hsides" rules="groups">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">
                    <bold>Parameter/Variable (Units</bold>
                  </th>
                  <th rowspan="1" colspan="1">
                    <bold>Variable name in IRimage</bold>
                  </th>
                  <th rowspan="1" colspan="1">
                    <bold>Symbol used in equations</bold>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">Raw sensor signal (DN)</td>
                  <td rowspan="1" colspan="1">
                    <monospace>rawSignal_DN</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">S</italic>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Raw signal from object (DN)</td>
                  <td rowspan="1" colspan="1">
                    <monospace>objRawSignal_DN</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">S</italic>
                    <sub>
                      <italic toggle="yes">obj</italic>
                    </sub>
                  </td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">Object temperature (°C)</td>
                  <td rowspan="1" colspan="1">
                    <monospace>objTemp_C</monospace>
                  </td>
                  <td rowspan="1" colspan="1">
                    <italic toggle="yes">T</italic>
                    <sub>
                      <italic toggle="yes">obj</italic>
                    </sub>
                  </td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
      </sec>
    </sec>
    <sec>
      <title>Software usage</title>
      <p>IRimage is run as a plugin of the scientific image analysis software ImageJ (<xref rid="ref-29" ref-type="bibr">Rueden et al., 2017</xref>) or its FIJI distribution (<xref rid="ref-31" ref-type="bibr">Schindelin et al., 2012</xref>), and also uses the open-source software ExifTool (<xref rid="ref-15" ref-type="bibr">Harvey, 2003</xref>) to extract raw values from the thermal images. IRimage is available for download at <ext-link xlink:href="https://github.com/gpereyrairujo/IRimage" ext-link-type="uri">https://github.com/gpereyrairujo/IRimage</ext-link>. When IRimage is installed, an “IRimage” sub-menu is added to the “Plugins” menu of ImageJ/FIJI, which allows the user to access the available functions (<xref rid="fig-1" ref-type="fig">Fig. 1</xref>). The four functions included in IRimage are: (1) “Process”, which processes the original thermal images to extract raw data and estimate temperature; (2) “Measure”, which allows the user to measure the temperature of different objects in complete sets of images; (3) “Color”, to create false-color images and videos for reporting; and (4) “Test”, to compare IRimage results against other software.</p>
      <fig position="float" id="fig-1">
        <object-id pub-id-type="doi">10.7717/peerjcs.977/fig-1</object-id>
        <label>Figure 1</label>
        <caption>
          <title>IRimage’s functions.</title>
          <p>The ImageJ/FIJI “Plugins” menu containing the “IRimage” sub-menu and functions, and the main windows and dialog boxes that are shown to the user. In any of the functions, the user is first promted to select the folder containing the original thermal images to be processed (not shown). In the “Process” function, the user is first asked to indicate how parameters for temperature calculation will be determined for each image and, if the user chooses to enter a set of values manually, a second dialog box is shown for the user to do so. In the “Measure” function, the user is first asked to choose whether to manually select the areas to be measured, or to use a previously saved mask.If the first option is selected, the user first enters the number of areas to measure (not shown) and then a window with the first image of the set is opened so that user can indicate the areas to be measured using any of the available selection tools. In the “Color” function the user can select the color palette, the contrast level, how to calculate the displayed temperature range, whether to include a temperature scale bar, and whether to produce a video file as output. The “Test” function does not require additional user input.</p>
        </caption>
        <graphic xlink:href="peerj-cs-08-977-g001" position="float"/>
      </fig>
      <sec>
        <title>Processing thermal images</title>
        <p>IRimage was implemented and tested using FLIR brand cameras (FLIR Systems Inc., USA), which is one of the most widely used brands in research (<xref rid="ref-14" ref-type="bibr">Harrap et al., 2018</xref>), and is able to process FLIR’s radiometric JPG thermal image format.</p>
        <p>The “Process” function of IRimage processes complete folders of thermal images, since this is usually the case in research uses. The radiometric JPG image format includes user-set parameters (<italic toggle="yes">i.e.,</italic> emissivity, air temperature and humidity, reflected temperature, and object distance) within individual images, but it is also possible to use different parameter values to calculate temperature from raw data. IRimage can process the images using either of three options (<xref rid="fig-1" ref-type="fig">Fig. 1</xref>): (1) process each file using the stored parameters (<italic toggle="yes">e.g.</italic>, when the user has manually set these parameters in the camera according to specific conditions for each image); (2) use a set of global parameters for all images, which is useful when all images were captured under the same conditions, or if parameters need to be modified globally (in this case a dialog box is shown where parameters can be set, <xref rid="fig-1" ref-type="fig">Fig. 1</xref>); or (3) use parameters stored in a text file, in which specific parameters can be defined for each image.</p>
        <p>IRimage processes all images in JPG format within the user-selected folder. Raw data containing the digital signal from the sensor is extracted and temperature is estimated for each pixel using the algorithm detailed in the “Theoretical background for temperature calculations” section. After processing, three images are stored for each input file, corresponding to the raw data, the estimated temperature, and a false-color image. The estimated temperature pixel values are also stored as text, in a .csv (comma-separated values) file that can be opened in a spreadsheet or statistical software. Also, irrespective of the processing option selected, the parameters used are stored in a .csv text file which can be later used to reproduce the same results (with the “Use parameters from file” option, <xref rid="fig-1" ref-type="fig">Fig. 1</xref>). Each of these output file types are stored in different subfolders within the user-selected folder.</p>
      </sec>
      <sec>
        <title>Measuring the temperature of objects</title>
        <p>A third function is included to perform reproducible measurements of the temperature of objects in the images. With the “Measure” function (<xref rid="fig-1" ref-type="fig">Fig. 1</xref>), the user can select up to 255 different objects (rectangular, oval, or free-form areas, lines or points) and obtain temperature measurements (mean, minimum, maximum and standard deviation) for each of them, for each of the images in a folder. The selected objects are stored in a “mask” image, which can be later used to reproduce the same measurements. A mask image can also be modified or created using other methods and used in IRimage.</p>
      </sec>
      <sec>
        <title>Creating customized false-color images and videos</title>
        <p>The “Color” function allows the user to produce false-color images representing the temperature values, which are useful for visualizing and reporting (<xref rid="fig-1" ref-type="fig">Fig. 1</xref>).</p>
        <p>The default palette used in IRimage is “mpl-inferno”, one of the default palettes in the popular data visualization Python package Matplotlib (<xref rid="ref-34" ref-type="bibr">Van der Walt &amp; Smith, 2015</xref>), which is also included in FIJI. It is a typical “thermal” palette that represents colder values in dark blue, and transitions through red and yellow for warmer values (emulating the color of hot liquid metal, or the radiation emitted by a black body). It was selected because it is both perceptually uniform and suitable for color-blind viewers. Alternatively, the classic greyscale palette, representing colder values as black and warmer values as white, is supported as well. Another important aspect is selecting the appropriate temperature scale, in order to efficiently represent the temperature values in the images using the full color palette. IRimage allows the user to select the contrast level, by automatically adjusting the minimum and maximum displayed values through a “histogram stretching” algorithm (<xref rid="ref-6" ref-type="bibr">Fisher et al., 2003</xref>). It operates by setting an amount of pixels with extreme values (the “tails” of the histogram) that are excluded (0, 0.3 and 3% for the low, normal and high contrast options, respectively). There are also two ways to calculate the temperature range for a set of images: either use the same scale for all of them (based on the range of temperatures in the full image set, which allows for a better comparison between images), or adjust the scale to the temperature range in each image (which allows for a better visualization of temperature differences within each image). It is also possible to add a scale bar to the images, showing the temperature scale and the color palette, with two different sizes for the scale bar and the font. Lastly, the user can choose whether to produce a video file for the complete set of images as a sequence.</p>
      </sec>
      <sec>
        <title>Testing the temperature estimations against other software</title>
        <p>The Test function provides a way of testing the algorithm, by comparing the results obtained with the Process function of IRimage against data exported using another software (<italic toggle="yes">e.g.</italic>, that provided by the camera manufacturer). Since IRimage is an open-source software and therefore its modification and customization is possible (and encouraged), this function can be used to check if the calculations have not been altered by any change in the code made by the user (for that purpose, a test image is included with IRimage, along with the temperature data exported using FLIR Tools). Also, it can be used to check whether IRimage functions correctly for a given camera when it is used for the first time. After the function is run, a scatter plot is drawn for each image for which there is reference data available, comparing temperature values of all the pixels, and a text file indicating the mean and maximum temperature differences.</p>
      </sec>
    </sec>
    <sec>
      <title>Comparison to existing tools</title>
      <p>IRimage was evaluated by comparing the resulting temperature values with those exported manually using the FLIR Tools software (FLIR Systems, Inc., USA, version 5.13.18031.2002). A wide set of 26 images taken with 15 different camera models was used for this comparison. Images were downloaded from <xref rid="ref-36" ref-type="bibr">Wikimedia Commons (2019)</xref>, and are listed in <xref rid="supp-1" ref-type="supplementary-material">Table S1</xref>. All the images were first processed using IRimage using the user-defined parameters stored in the image file. After that, each file was opened using FLIR Tools and the temperature values were manually exported in csv format. Finally, the temperature values for each image were compared using the Test function in IRimage.</p>
    </sec>
    <sec>
      <title>Example use case</title>
      <p>Two <italic toggle="yes">Pittosporum tenuifolium</italic> (Banks &amp; Sol. ex Gaertn) plants, grown in soil-filled, 3.5L pots, were placed inside a greenhouse and imaged with an infrared thermal camera (FLIR E40bx, FLIR Systems, USA) every ≈6 min. during 24 h., from a distance of 4 m. The camera was triggered automatically by means of a custom-built device (<xref rid="ref-24" ref-type="bibr">Pereyra Irujo, 2019</xref>). Air temperature, relative humidity, and incident photosynthetically active radiation were measured every 1 min. with a datalogger (Decagon Em50, Decagon, Pullman, WA, USA). Plants were not watered during the previous 4 days, and before the onset of measurements, 0.5 L water was added to one of them, so that soil water content was raised from ≈0.2 to ≈0.4 m<sup>3</sup>/m<sup>3</sup>.</p>
      <p>Images were captured with a fixed set of user-defined parameters (since capture was automated) but then processed using IRimage using unique values for each image. Reflected temperature was estimated for each image similarly to the usual procedure (<xref rid="ref-8" ref-type="bibr">FLIR Systems, 2016</xref>), as the mean temperature of a piece of aluminium foil placed in the camera’s field of view measured in the images processed using an emissivity value of 1. Air temperature and relative humidity used were those measured by the weather sensor at the time each image was captured. These values were entered in a .csv text file which was then selected through the “Use parameters from file” option of the “Process” function.</p>
      <p>After processing, the leaf temperature of each of the two plants was measured in all the images. Due to the intricate shape of the plants, a mask image containing the leaf pixels to be measured was created using ImageJ, using a combination of a thresholding algorithm and manual selection. For these measurements, the images were processed using an emissivity parameter of 0.95 (<xref rid="ref-30" ref-type="bibr">Salisbury &amp; Milton, 1988</xref>), and a distance between the camera and the objects of 4 m.</p>
      <p>Leaf temperature was used in combination with sensor data for air temperature to calculate the leaf-to-air temperature difference (Δ<italic toggle="yes">T</italic>), a key variable for analyzing the energy balance of the plant (<xref rid="ref-10" ref-type="bibr">Gates, 1964</xref>). The temperature of the air sensor enclosure (also placed in the camera’s field of view) was measured in the images as well, using a similar approach and an emissivity value of 0.84 (<xref rid="ref-8" ref-type="bibr">FLIR Systems, 2016</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>Comparison to existing tools</title>
      <p><xref rid="fig-2" ref-type="fig">Figure 2</xref> shows a sample of the images used, either in their original form (<xref rid="fig-2" ref-type="fig">Figs. 2A</xref>–<xref rid="fig-2" ref-type="fig">2C</xref>) or processed with IRimage (<xref rid="fig-2" ref-type="fig">Figs. 2D</xref>–<xref rid="fig-2" ref-type="fig">2F</xref>), and scatter plots comparing the temperature values for all pixels obtained with IRimage <italic toggle="yes">vs.</italic> FLIR Tools, either showing the full range of temperatures in the image (<xref rid="fig-2" ref-type="fig">Figs. 2G</xref>–<xref rid="fig-2" ref-type="fig">2I</xref>) or a “zoomed-in” version showing a small range of temperatures in detail (<xref rid="fig-2" ref-type="fig">Figs. 2J</xref>–<xref rid="fig-2" ref-type="fig">2L</xref>). The comparison between IRimage and the manufacturer’s software showed an average difference of 0.0002 °C, and in all cases below 0.01 °C, but only when temperature was above −40 °C. When temperature was below that value, temperature obtained using FLIR Tools was always equal to −40 °C, irrespective of the initial raw values, whereas IRimage showed values that could reach −70 °C, as can be noted in <xref rid="fig-2" ref-type="fig">Fig. 2I</xref>. Out of the 26 images analyzed, in only one case the comparison was not possible because the temperature data could not be extracted using FLIR Tools (although it was possible to process it with IRimage). The comparison between IRimage and FLIR Tools for the 25 images that could be analyzed is presented in <xref rid="supp-4" ref-type="supplementary-material">Fig. S1</xref>.</p>
      <fig position="float" id="fig-2">
        <object-id pub-id-type="doi">10.7717/peerjcs.977/fig-2</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Results of the comparison between IRimage and FLIR Tools in a subset of the 26 images used.</title>
          <p>(A–C) Original images used. (D–F) Images produced by IRimage with its perceptually uniform color palette. (G–I) Scatter plots comparing the temperature values of all the pixels in each image obtained using IRimage <italic toggle="yes">vs.</italic> the reference temperature values obtained from the original images using the manufacturer’s software. (J-L) Scatter plots showing in detail a subset of the same data around the mean temperature of the image ±0.1 °C. Original images downloaded from <xref rid="ref-36" ref-type="bibr">Wikimedia Commons (2019)</xref>: (A) <ext-link xlink:href="https://commons.wikimedia.org/wiki/File:Aqua_Tower_thermal_imaging.jpg" ext-link-type="uri">https://commons.wikimedia.org/wiki/File:Aqua_Tower_thermal_imaging.jpg</ext-link> (CC0 license), (B) <ext-link xlink:href="https://commons.wikimedia.org/wiki/File:200_deg_neutral.jpg" ext-link-type="uri">https://commons.wikimedia.org/wiki/File:200_deg_neutral.jpg</ext-link> (CC0 license), (C) <ext-link xlink:href="https://commons.wikimedia.org/wiki/File:Thermal_image_of_four_ducks_swimming.jpg" ext-link-type="uri">https://commons.wikimedia.org/wiki/File:Thermal_image_of_four_ducks_swimming.jpg</ext-link> (CC0 license).</p>
        </caption>
        <graphic xlink:href="peerj-cs-08-977-g002" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>Example use case</title>
      <p>Air temperature within the greenhouse ranged from 20 °C early in the morning to 43 °C at around noon, and air relative humidity from 13% during the day to 78% in the night (<xref rid="fig-3" ref-type="fig">Fig. 3</xref>). Reflected temperature (measured in the images as indicated previously) ranged from 21 to 46 °C. Incident solar radiation reached 1,868 µmol m<sup>−2</sup> s<sup>−1</sup>, totalling 25.5 mol m<sup>−2</sup> d<sup>−1</sup>. Measuring the temperature of the sensor enclosure using the thermal images yielded temperature values similar to those measured with the sensor, as shown in <xref rid="fig-3" ref-type="fig">Fig. 3B</xref>.</p>
      <fig position="float" id="fig-3">
        <object-id pub-id-type="doi">10.7717/peerjcs.977/fig-3</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Environmental conditions in the greenhouse during the experiment.</title>
          <p>(A) Incident photosynthetically active radiation (PAR). (B) Air temperature, measured either with the weather sensor (continuous line) or by measuring the sensor enclosure with the thermal camera (dotted line). (C) Air relative humidity. The gray shaded area indicates the night.</p>
        </caption>
        <graphic xlink:href="peerj-cs-08-977-g003" position="float"/>
      </fig>
      <p>Leaf temperature, as measured with the thermal camera, seemed to follow air temperature closely, as shown in <xref rid="fig-4" ref-type="fig">Fig. 4A</xref>. Nevertheless, Δ<italic toggle="yes">T</italic> curves revealed temperature differences between leaves and air, especially during the day (<xref rid="fig-4" ref-type="fig">Fig. 4B</xref>). A heating effect of solar radiation incident on the leaves could be seen early in the morning (reaching 2 °C above air temperature), followed by a cooling effect of transpiration in the following hours (reaching 1 to 2 °C below air temperature), with fluctuations that follow the changes in the amount of incident solar radiation. Plants also showed differences in leaf temperature between them, but mainly during the day, indicating a restricted transpiration (and therefore less evaporative cooling) in the water-stressed plant (<xref rid="fig-4" ref-type="fig">Fig. 4B</xref>). A Supplementary Figure (<xref rid="supp-5" ref-type="supplementary-material">Fig. S2</xref>) is included showing the difference between these results and those that are obtained using fixed values for user-defined parameters (the normal procedure with standard software), that yield leaf temperatures values almost 1 °C higher or lower when environmental conditions deviate from average values.</p>
      <fig position="float" id="fig-4">
        <object-id pub-id-type="doi">10.7717/peerjcs.977/fig-4</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Leaf temperature of well-watered and water-stressed plants.</title>
          <p>(A) Absolute air temperature (grey solid line) and absolute leaf temperature of the well-watered (blue dashed line) and water-stressed (red dashed-dotted line) plants. (B) Leaf-to-air temperature difference (Δ<italic toggle="yes">T</italic>) of the well-watered (blue dashed line) and water-stressed (red dashed-dotted line) plants. The gray shaded area indicates the night.</p>
        </caption>
        <graphic xlink:href="peerj-cs-08-977-g004" position="float"/>
      </fig>
      <p><xref rid="fig-5" ref-type="fig">Figure 5</xref> shows a small sample of the 247 thermal images captured during the experiment, from selected moments of the day. In <xref rid="fig-5" ref-type="fig">Fig. 5A</xref>, the color palette represents the same temperature range in all three images, which aids in visualizing the differences in absolute temperature between the night (00 h), the early morning (08 h), and the afternoon (14 h). <xref rid="fig-5" ref-type="fig">Figure 5B</xref> shows the same images, but the color palette was set according to the temperature range in each image, which makes the comparison between them more difficult (or even misleading), but allows for a better perception of temperature differences within each image. For instance, the image taken in the afternoon (at 14 h) shows the moment in which leaf temperature differs the most between the well-watered (in the left) and water-stressed (in the right) plants; that difference is much more discernible in the image shown in <xref rid="fig-5" ref-type="fig">Fig. 5B</xref>. Two videos are included as supplementary material, showing the complete sequence of 247 images, either using a fixed scale according to the full temperature range (<xref rid="supp-2" ref-type="supplementary-material">Video S1</xref>) or a variable scale according to the individual temperature range in each image (<xref rid="supp-3" ref-type="supplementary-material">Video S2</xref>).</p>
      <fig position="float" id="fig-5">
        <object-id pub-id-type="doi">10.7717/peerjcs.977/fig-5</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Example thermal images of well-watered (left) and water-stressed (right) plants in different moments of the day.</title>
          <p>(A) Images taken in the night (00 h), the early morning (08 h), and the afternoon (14 h), and shown using a temperature scale (19–48 °C) set according to the global temperature range of the full set of images. (B) The same three images, shown using individually set temperature scales, according to the temperature range in each of them.</p>
        </caption>
        <graphic xlink:href="peerj-cs-08-977-g005" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>Open source software is ideal for scientific research because it can be freely inspected, modified, and redistributed (<xref rid="ref-32" ref-type="bibr">Schindelin et al., 2015</xref>). IRimage is itself open source, and it was also implemented as a plugin of the open source software ImageJ, a widely used scientific image analysis tool which has been considered among the top “computer codes that transformed science” (<xref rid="ref-26" ref-type="bibr">Perkel, 2021</xref>). This not only provides a clear way of knowing the exact steps taken to estimate temperature from raw sensor data, but also allows the researcher to either use the tool through ImageJ’s graphical user interface (without requiring any programming knowledge) or to modify, adapt or expand the functionality of the tool using ImageJ’s powerful scripting languages (<xref rid="ref-3" ref-type="bibr">Cacciabue, Currá &amp; Gismondi, 2019</xref>). ImageJ (especially its FIJI distribution) provides a large ecosystem of tools with which IRimage can interact, for example, by assembling different processing steps into pipelines using scripting languages: plugins for image transformation, registration, annotation, enhancement, segmentation, visualization, as well as tools for interoperability with other software (<xref rid="ref-31" ref-type="bibr">Schindelin et al., 2012</xref>). Also, IRimage has been developed using the simple ImageJ macro language with the explicit aim of encouraging users to modify and contribute to improving the software.</p>
    <p>IRimage provides tools for extracting and analyzing temperature data which are compatible with reproducible image handling recommendations (<xref rid="ref-20" ref-type="bibr">Miura &amp; Nørrelykke, 2021</xref>), allowing researchers to avoid difficulties which are common when dealing with thermal images obtained with consumer-grade cameras. Software provided with these cameras has functions usually limited to temperature measurements of manually selected points or areas in the image (<italic toggle="yes">e.g.</italic>, <xref rid="ref-9" ref-type="bibr">García-Tejero et al., 2018</xref>; <xref rid="ref-22" ref-type="bibr">Nosrati et al., 2020</xref>). When the number of images is large, researchers resort to building custom <italic toggle="yes">ad hoc</italic> software, which is frequently not available for other researchers to reuse (<italic toggle="yes">e.g.</italic>, <xref rid="ref-28" ref-type="bibr">Razani, Parkhimchyk &amp; Tabatabaei, 2018</xref>; <xref rid="ref-35" ref-type="bibr">Van Doremalen et al., 2019</xref>; <xref rid="ref-12" ref-type="bibr">Goel et al., 2020</xref>; <xref rid="ref-21" ref-type="bibr">Mul Fedele et al., 2020</xref>) or using elaborate methods to extract temperature values from color data in false-color images (<italic toggle="yes">e.g.</italic>, <xref rid="ref-1" ref-type="bibr">Alpar &amp; Krejcar, 2017</xref>; <xref rid="ref-27" ref-type="bibr">Petrie et al., 2019</xref>). Moreover, in some cases these custom methods use “optimized” images produced by many consumer-grade cameras, which are meant for visualization and are a result of blending visible and thermal images for improved resolution, making the resulting data prone to errors.</p>
    <p>One important aspect to consider when reporting temperature data as thermal images is choosing the right color palette (<xref rid="ref-4" ref-type="bibr">Crameri, Shephard &amp; Heron, 2020</xref>). Some color palettes used for scientific visualization, such as the popular “rainbow” palettes, have a non-linear or unintuitive relationship between intensity and the represented value, and are not suitable for color-blind people (<xref rid="ref-33" ref-type="bibr">Thyng et al., 2016</xref>; <xref rid="ref-23" ref-type="bibr">Nuñez, Anderton &amp; Renslow, 2018</xref>). Another problem of non-linear palettes is that they are not suitable for conversion to black and white, which can be important in journals that publish images in color online but not in its print version, or when the reader prints a journal article in black and white. The default palette (“mlp-inferno”) used in IRimage was chosen so as to avoid those pitfalls, and therefore aid in accurate data interpretation and communication. Other similar palettes exist, also suitable for scientifically representing thermal data, such as “mpl-magma”, “mpl-plasma” (<xref rid="ref-34" ref-type="bibr">Van der Walt &amp; Smith, 2015</xref>), “CET L-03”, “CET L-08” (<xref rid="ref-18" ref-type="bibr">Kovesi, 2015</xref>), or “cmocean-thermal” (<xref rid="ref-33" ref-type="bibr">Thyng et al., 2016</xref>).</p>
    <p>The example use case presented in this paper highlights the utility of some of IRimage’s functions, obtaining data that revealed subtle differences in the daily pattern of leaf temperature of two plants that had received more or less irrigation water. Obtaining this data required analyzing 247 thermal images, each of them with different parameters for temperature estimation. This task would have been extremely impractical with standard software, in which each image has to be manually processed. Also, measurement of leaf temperature of the irregular-shaped plants should have probably had to be simplified to square or oval shapes, and these areas selected manually for each image, which would have increased measurement error (by including background pixels) and prevented later reproduction of those results (if the selected areas are not repeated exactly). Also, the presented example highlights how the usual procedure of setting camera parameters (air temperature, relative humidity and reflected temperature) before capturing a large set of images (especially in fluctuating environmental conditions) can lead to potentially large measurement errors, even when these parameters represent the true average conditions. IRimage allows to efficiently and reproducibly process images using unique parameters for each image, thus obtaining more accurate results.</p>
    <p>One of the main drawbacks of IRimage is that it is now limited to only one brand of thermal cameras, since it has been implemented and tested for FLIR brand cameras. Its utility is, however, large enough, since this brand is, by far, the most widely used in biological research: in a systematic literature review of thermography in biology, 61% of papers reported using FLIR cameras (FLIR Systems Inc., USA), followed by NEC (NEC Ltd., Japan) and Fluke (Fluke Corporation, USA), with 7% each, and InfraTec (InfraTec GmbH, Germany) with 4% (<xref rid="ref-14" ref-type="bibr">Harrap et al., 2018</xref>). The algorithms are, nevertheless, potentially adaptable for other cameras for which raw sensor data could be obtained. Among the cameras from this brand, IRimage was able to process all the tested models (15), yielding individual pixel values that did not differ from those obtained with the manufacturer’s software by more than 0.01 °C, and being able to process raw data that was below of the manufacturer’s software limit of −40 °C. It should be noted that this value only represents the minimal discrepancy between different processing methods, but not the actual measurement error. Measurement errors can arise due to the hardware itself (the specified sensitivity of a thermal camera can be around 0.07 °C, with an accuracy of ±2 °C, <italic toggle="yes">e.g.</italic>, <xref rid="ref-8" ref-type="bibr">FLIR Systems, 2016</xref>) or the measurement technique, and so a periodic factory calibration or testing against a target of known temperature is advised (<italic toggle="yes">e.g.</italic>, <xref rid="ref-17" ref-type="bibr">Klaessens, Veen &amp; Verdaasdonk, 2017</xref>).</p>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>Affordable infrared thermal cameras have proven to be suitable for research, especially in low-resource settings, but the use of closed-source, consumer-oriented or custom software for image analysis can limit the throughput, accuracy and reproducibility of the results. IRimage provides open-source, flexible and documented tools for processing, measurement and reporting of thermal imaging data for research purposes in biological and environmental sciences. This tool includes functionalities that make it better suited for research purposes than many currently available alternatives, and could contribute to making affordable consumer-grade thermal cameras useful for reproducible research.</p>
  </sec>
  <sec sec-type="supplementary-material" id="supplemental-information">
    <title>Supplemental Information</title>
    <supplementary-material id="supp-1" position="float" content-type="local-data">
      <object-id pub-id-type="doi">10.7717/peerj-cs.977/supp-1</object-id>
      <label>Supplemental Information 1</label>
      <caption>
        <title>List of images used for the comparison between IRimage and FLIR Tools</title>
        <p>Images were all those found in Wikimedia Commons taken with FLIR cameras and available as unmodified JPG files. Images were downloaded on 16 Jun 2019 from https://commons.wikimedia.org/wiki/Category:Photos_taken_with_FLIR_Systems.</p>
      </caption>
      <media xlink:href="peerj-cs-08-977-s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="supp-2" position="float" content-type="local-data">
      <object-id pub-id-type="doi">10.7717/peerj-cs.977/supp-2</object-id>
      <label>Supplemental Information 2</label>
      <caption>
        <title>Video output of IRimage showing a well-watered plant (left) and a water-stressed plant (right) during a 24-hour period, using a fixed temperature scale</title>
      </caption>
      <media xlink:href="peerj-cs-08-977-s002.avi" mimetype="video" mime-subtype="x-msvideo">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="supp-3" position="float" content-type="local-data">
      <object-id pub-id-type="doi">10.7717/peerj-cs.977/supp-3</object-id>
      <label>Supplemental Information 3</label>
      <caption>
        <title>Video output of IRimage showing a well-watered plant (left) and a water-stressed plant (right) during a 24-hour period, using a variable temperature scale</title>
      </caption>
      <media xlink:href="peerj-cs-08-977-s003.avi" mimetype="video" mime-subtype="x-msvideo">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="supp-4" position="float" content-type="local-data">
      <object-id pub-id-type="doi">10.7717/peerj-cs.977/supp-4</object-id>
      <label>Supplemental Information 4</label>
      <caption>
        <title>Results of the comparison between IRimage and FLIR Tools</title>
        <p>Scatter plots comparing the temperature values of all the pixels in each image obtained using IRimage vs. the reference temperature values obtained from the original images using the manufacturer’s software FLIR Tools. Data is shown for 25 out of the 26 tested images; comparison was not possible for image #4 because it could not be opened with FLIR Tools. Information about the images used is available in Table S2.</p>
      </caption>
      <media xlink:href="peerj-cs-08-977-s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="supp-5" position="float" content-type="local-data">
      <object-id pub-id-type="doi">10.7717/peerj-cs.977/supp-5</object-id>
      <label>Supplemental Information 5</label>
      <caption>
        <title>Comparison of leaf temperature values obtained with either fixed parameters or variable parameters</title>
        <p>Normally, the values of user-defined parameters are set in the camera before the images are captured, and these values are either kept fixed or are updated manually as conditions change. IRimage allows the user to set these parameters individually for each image, which can be necessary under fluctuating conditions. This Figure compares the results processing a set of images using either fixed parameters (i.e., using mean values for air temperature and relative humidity and reflected temperature) or variable parameters (i.e., using values measured or estimated for each image, as shown in Fig. 5 in the main text). (A-B) Absolute air temperature (grey solid line), absolute leaf temperature obtained with fixed parameters (dotted red/blue lines), and absolute leaf temperature obtained with variable parameters (solid red/blue lines), in the well-watered (A) and water-stressed (B) plants. (C-D) Leaf-to-air temperature difference (DeltaT) obtained with fixed parameters (dotted red/blue lines), and DeltaT obtained with variable parameters (solid red/blue lines), in the well-watered (C) and water-stressed (D) plants. The gray shaded area indicates the night. While temperature values obtained with these two methods seem quite similar in absolute values (A-B), DeltaT curves reveal the effect of parameter selection on the resulting values (C-D): when air temperature and humidity within the greenhouse were close to the mean values, both methods returned similar results, but using fixed parameters yielded leaf temperatures values almost 1° C higher or lower when environmental conditions deviated from the average values.</p>
      </caption>
      <media xlink:href="peerj-cs-08-977-s005.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn id="conflict-1" fn-type="COI-statement">
        <p>The author declares there are no competing interests.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn id="contribution-1" fn-type="con">
        <p><xref rid="author-1" ref-type="contrib">Gustavo Pereyra Irujo</xref> conceived and designed the experiments, performed the experiments, analyzed the data, performed the computation work, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-1">
        <p>The following information was supplied regarding data availability:</p>
        <p>The software source code is available at GitHub: <ext-link xlink:href="https://github.com/gpereyrairujo/IRimage" ext-link-type="uri">https://github.com/gpereyrairujo/IRimage</ext-link>.</p>
        <p>The raw data, images, and code for data analysis is available at Github: <ext-link xlink:href="https://github.com/gpereyrairujo/IRimage_paper" ext-link-type="uri">https://github.com/gpereyrairujo/IRimage_paper</ext-link>.</p>
        <p>Third party data was downloaded from Wikimedia Commons: <ext-link xlink:href="https://commons.wikimedia.org" ext-link-type="uri">https://commons.wikimedia.org</ext-link>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Alpar &amp; Krejcar (2017)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Alpar</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Krejcar</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2017">2017</year>
        <article-title>Quantization and equalization of pseudocolor images in hand thermography</article-title>
        <series>Lecture notes in computer science</series>
        <source>Bioinformatics and biomedical engineering</source>
        <publisher-name>Springer International Publishing</publisher-name>
        <publisher-loc>Cham</publisher-loc>
        <person-group person-group-type="editor">
          <name>
            <surname>Rojas</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Ortuo</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <fpage>397</fpage>
        <lpage>407</lpage>
        <pub-id pub-id-type="doi">10.1007/978-3-319-56148-6_35</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-2">
      <label>Cacciabue (2016)</label>
      <element-citation publication-type="thesis">
        <person-group person-group-type="author">
          <name>
            <surname>Cacciabue</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2016">2016</year>
        <source>Protocolos de medicin de temperatura de canopeo y su relacin con el rendimiento potencial de cultivares de trigo</source>
        <institution>Agricultural Engineering Thesis, Facultad de Ciencias Agrarias, Universidad Nacional de Mar del Plata, Mar del Plata, Argentina</institution>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Cacciabue, Currá &amp; Gismondi (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cacciabue</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Currá</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gismondi</surname>
            <given-names>MI</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2019">2019</year>
        <article-title>ViralPlaque: a Fiji macro for automated assessment of viral plaque statistics</article-title>
        <source>PeerJ</source>
        <volume>7</volume>
        <elocation-id>e7729</elocation-id>
        <pub-id pub-id-type="doi">10.7717/peerj.7729</pub-id>
        <pub-id pub-id-type="pmid">31579606</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Crameri, Shephard &amp; Heron (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crameri</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Shephard</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Heron</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2020">2020</year>
        <article-title>The misuse of colour in science communication</article-title>
        <source>Nature Communications</source>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>5444</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-19160-7</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Dryden et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dryden</surname>
            <given-names>MDM</given-names>
          </name>
          <name>
            <surname>Fobel</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fobel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2017">2017</year>
        <article-title>Upon the shoulders of giants: open-source hardware and software in analytical chemistry</article-title>
        <source>Analytical Chemistry</source>
        <volume>89</volume>
        <issue>8</issue>
        <fpage>4330</fpage>
        <lpage>4338</lpage>
        <pub-id pub-id-type="doi">10.1021/acs.analchem.7b00485</pub-id>
        <pub-id pub-id-type="pmid">28379683</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Fisher et al. (2003)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Fisher</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Perkins</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Walker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wolfart</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2003">2003</year>
        <article-title>Contrast stretching</article-title>
        <uri xlink:href="https://homepages.inf.ed.ac.uk/rbf/HIPR2/stretch.htm">https://homepages.inf.ed.ac.uk/rbf/HIPR2/stretch.htm</uri>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>FLIR Systems (2001)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <collab>FLIR Systems</collab>
        </person-group>
        <year iso-8601-date="2001">2001</year>
        <article-title>Toolkit IC2 Dig16 Developers Guide 1.01 AGEMA 550/570, ThermaCAM PM5X5 and the ThermoVision family (en US). FLIR Publication number 557344 version B</article-title>
        <comment><uri xlink:href="http://flir.custhelp.com/app/account/fl_download_manuals">http://flir.custhelp.com/app/account/fl_download_manuals</uri> (http://support.flir.com/DocDownload/Assets/dl/557344$b.pdf)</comment>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>FLIR Systems (2016)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <collab>FLIR Systems</collab>
        </person-group>
        <year iso-8601-date="2016">2016</year>
        <source>User’s manual FLIR Exx series</source>
        <uri xlink:href="http://flir.custhelp.com/app/account/fl_download_manuals">http://flir.custhelp.com/app/account/fl_download_manuals</uri>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>García-Tejero et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>García-Tejero</surname>
            <given-names>IF</given-names>
          </name>
          <name>
            <surname>Ortega-Arévalo</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Iglesias-Contreras</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Moreno</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Souza</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tavira</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Durán-Zuazo</surname>
            <given-names>VH</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2018">2018</year>
        <article-title>Assessing the crop-water status in almond (Prunus dulcis Mill.) trees via thermal imaging camera connected to smartphone</article-title>
        <source>Sensors</source>
        <volume>18</volume>
        <issue>4</issue>
        <fpage>1050</fpage>
        <pub-id pub-id-type="doi">10.3390/s18041050</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Gates (1964)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gates</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <year iso-8601-date="1964">1964</year>
        <article-title>Leaf temperature and transpiration 1</article-title>
        <source>Agronomy Journal</source>
        <volume>56</volume>
        <issue>3</issue>
        <fpage>273</fpage>
        <lpage>277</lpage>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Gaussorgues (1994)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gaussorgues</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year iso-8601-date="1994">1994</year>
        <source>Infrared thermography</source>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Chapman &amp; Hall</publisher-name>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Goel et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nizamoglu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gerrish</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cranmer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>El-Muttardi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Barnes</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dziewulski</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2020">2020</year>
        <article-title>A prospective study comparing the FLIR ONE with laser Doppler imaging in the assessment of burn depth by a tertiary burns unit in the United Kingdom</article-title>
        <source>Scars, Burns &amp; Healing</source>
        <volume>6</volume>
        <fpage>2059513120974261</fpage>
        <pub-id pub-id-type="doi">10.1177/2059513120974261</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Haglund &amp; Schönborn (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haglund</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schönborn</surname>
            <given-names>KJ</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2019">2019</year>
        <article-title>The pedagogical potential of infrared cameras in biology education</article-title>
        <source>The American Biology Teacher</source>
        <volume>81</volume>
        <issue>7</issue>
        <fpage>520</fpage>
        <lpage>523</lpage>
        <pub-id pub-id-type="doi">10.1525/abt.2019.81.7.520</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Harrap et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrap</surname>
            <given-names>MJM</given-names>
          </name>
          <name>
            <surname>Hempel de Ibarra</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Whitney</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Rands</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2018">2018</year>
        <article-title>Reporting of thermography parameters in biology: a systematic review of thermal imaging literature</article-title>
        <source>Royal Society Open Science</source>
        <volume>5</volume>
        <issue>12</issue>
        <elocation-id>181281</elocation-id>
        <pub-id pub-id-type="doi">10.1098/rsos.181281</pub-id>
        <pub-id pub-id-type="pmid">30662737</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Harvey (2003)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Harvey</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2003">2003</year>
        <article-title>ExifTool: read, write and edit meta information</article-title>
        <uri xlink:href="http://owl.phy.queensu.ca/phil/exiftool/">http://owl.phy.queensu.ca/ phil/exiftool/</uri>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Kastberger &amp; Stachl (2003)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kastberger</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Stachl</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2003">2003</year>
        <article-title>Infrared imaging technology and biological applications</article-title>
        <source>Behavior Research Methods, Instruments, &amp; Computers</source>
        <volume>35</volume>
        <issue>3</issue>
        <fpage>429</fpage>
        <lpage>439</lpage>
        <pub-id pub-id-type="doi">10.3758/BF03195520</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Klaessens, Veen &amp; Verdaasdonk (2017)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Klaessens</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Veen</surname>
            <given-names>Avd</given-names>
          </name>
          <name>
            <surname>Verdaasdonk</surname>
            <given-names>RM</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2017">2017</year>
        <article-title>Comparison of the temperature accuracy between smart phone based and high-end thermal cameras using a temperature gradient phantom</article-title>
        <volume>vol. 10056</volume>
        <source>Design and quality for biomedical technologies X</source>
        <publisher-name>International Society for Optics and Photonics</publisher-name>
        <fpage>100560D</fpage>
        <pub-id pub-id-type="doi">10.1117/12.2252898</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-18">
      <label>Kovesi (2015)</label>
      <element-citation publication-type="workingpaper">
        <person-group person-group-type="author">
          <name>
            <surname>Kovesi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2015">2015</year>
        <article-title>Good colour maps: how to design them</article-title>
        <pub-id pub-id-type="arxiv">1509.03700</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Minkina &amp; Klecha (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minkina</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Klecha</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2016">2016</year>
        <article-title>Atmospheric transmission coefficient modelling in the infrared for thermovision measurements</article-title>
        <source>Journal of Sensors and Sensor Systems</source>
        <volume>5</volume>
        <issue>1</issue>
        <fpage>17</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.5194/jsss-5-17-2016</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Miura &amp; Nørrelykke (2021)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miura</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nørrelykke</surname>
            <given-names>SF</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2021">2021</year>
        <article-title>Reproducible image handling and analysis</article-title>
        <source>The EMBO Journal</source>
        <volume>40</volume>
        <issue>3</issue>
        <elocation-id>e105889</elocation-id>
        <pub-id pub-id-type="doi">10.15252/embj.2020105889</pub-id>
        <pub-id pub-id-type="pmid">33480052</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-21">
      <label>Mul Fedele et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mul Fedele</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Aiello</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Caldart</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Golombek</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Marpegan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Paladino</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2020">2020</year>
        <article-title>Differential thermoregulatory and inflammatory patterns in the circadian response to lps-induced septic shock</article-title>
        <source>Frontiers in Cellular and Infection Microbiology</source>
        <volume>10</volume>
        <fpage>100</fpage>
        <pub-id pub-id-type="doi">10.3389/fcimb.2020.00100</pub-id>
        <pub-id pub-id-type="pmid">32226779</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Nosrati et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nosrati</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bergamo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rodríguez-Rodríguez</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Saatchi</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Häfeli</surname>
            <given-names>UO</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2020">2020</year>
        <article-title>Refinement and validation of infrared thermal imaging (IRT): a non-invasive technique to measure disease activity in a mouse model of rheumatoid arthritis</article-title>
        <source>Arthritis Research &amp; Therapy</source>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>281</fpage>
        <pub-id pub-id-type="doi">10.1186/s13075-020-02367-w</pub-id>
        <pub-id pub-id-type="pmid">33256854</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Nuñez, Anderton &amp; Renslow (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nuñez</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Anderton</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Renslow</surname>
            <given-names>RS</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2018">2018</year>
        <article-title>Optimizing colormaps with consideration for color vision deficiency to enable accurate interpretation of scientific data</article-title>
        <source>PLOS ONE</source>
        <volume>13</volume>
        <issue>7</issue>
        <elocation-id>e0199239</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0199239</pub-id>
        <pub-id pub-id-type="pmid">30067751</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>Pereyra Irujo (2019)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Pereyra Irujo</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2019">2019</year>
        <article-title>Automatic servo</article-title>
        <uri xlink:href="https://github.com/gpereyrairujo/automatic_servo">https://github.com/gpereyrairujo/automatic_servo</uri>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Pereyra Irujo et al. (2015)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pereyra Irujo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aguirrezábal</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Fiorani</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pieruschka</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2015">2015</year>
        <article-title>Benchmarking of an affordable thermal camera for plant phenotyping</article-title>
        <source>EPPN Plant Phenotyping Symposium, Barcelona, Spain. Book of Abstracts</source>
        <uri xlink:href="https://www.plant-phenotyping.org/lw_resource/datapool/_items/item_321/book_of_abstracts_web.pdf">https://www.plant-phenotyping.org/lw_resource/datapool/_items/item_321/book_of_abstracts_web.pdf</uri>
        <fpage>31</fpage>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Perkel (2021)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perkel</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2021">2021</year>
        <article-title>Ten computer codes that transformed science</article-title>
        <source>Nature</source>
        <volume>589</volume>
        <fpage>344</fpage>
        <lpage>348</lpage>
        <pub-id pub-id-type="pmid">33473232</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Petrie et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Petrie</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Whitty</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Skewes</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2019">2019</year>
        <article-title>The accuracy and utility of a low cost thermal camera and smartphone-based system to assess grapevine water status</article-title>
        <source>Biosystems Engineering</source>
        <volume>179</volume>
        <fpage>126</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="doi">10.1016/j.biosystemseng.2019.01.002</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Razani, Parkhimchyk &amp; Tabatabaei (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Razani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Parkhimchyk</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tabatabaei</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2018">2018</year>
        <article-title>Lock-in thermography using a cellphone attachment infrared camera</article-title>
        <source>AIP Advances</source>
        <volume>8</volume>
        <issue>3</issue>
        <fpage>035305</fpage>
        <pub-id pub-id-type="doi">10.1063/1.5021601</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-29">
      <label>Rueden et al. (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rueden</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Schindelin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hiner</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>DeZonia</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Walter</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Arena</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Eliceiri</surname>
            <given-names>KW</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2017">2017</year>
        <article-title>ImageJ2: ImageJ for the next generation of scientific image data</article-title>
        <source>BMC Bioinformatics</source>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>529</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1934-z</pub-id>
        <pub-id pub-id-type="pmid">29187165</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-30">
      <label>Salisbury &amp; Milton (1988)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salisbury</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Milton</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <year iso-8601-date="1988">1988</year>
        <article-title>Thermal infrared (2.5-to 13.5-m) directional hemispherical reflectance of leaves</article-title>
        <source>Photogrammetric Engineering and Remote Sensing</source>
        <volume>54</volume>
        <issue>9</issue>
        <fpage>1301</fpage>
        <lpage>1304</lpage>
      </element-citation>
    </ref>
    <ref id="ref-31">
      <label>Schindelin et al. (2012)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schindelin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Arganda-Carreras</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Frise</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kaynig</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Longair</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pietzsch</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Preibisch</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rueden</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Saalfeld</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tinevez</surname>
            <given-names>JY</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Hartenstein</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Eliceiri</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Tomancak</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cardona</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2012">2012</year>
        <article-title>Fiji: an open-source platform for biological-image analysis</article-title>
        <source>Nature Methods</source>
        <volume>9</volume>
        <issue>7</issue>
        <fpage>676</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2019</pub-id>
        <pub-id pub-id-type="pmid">22743772</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-32">
      <label>Schindelin et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schindelin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rueden</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Hiner</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Eliceiri</surname>
            <given-names>KW</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2015">2015</year>
        <article-title>The ImageJ ecosystem: an open platform for biomedical image analysis</article-title>
        <source>Molecular Reproduction and Development</source>
        <volume>82</volume>
        <issue>7–8</issue>
        <fpage>518</fpage>
        <lpage>529</lpage>
        <pub-id pub-id-type="doi">10.1002/mrd.22489</pub-id>
        <pub-id pub-id-type="pmid">26153368</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-33">
      <label>Thyng et al. (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thyng</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Greene</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Hetland</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Zimmerle</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>DiMarco</surname>
            <given-names>SF</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2016">2016</year>
        <article-title>True Colors of Oceanography</article-title>
        <source>Oceanography</source>
        <volume>29</volume>
        <issue>3</issue>
        <fpage>9</fpage>
        <lpage>13</lpage>
      </element-citation>
    </ref>
    <ref id="ref-34">
      <label>Van der Walt &amp; Smith (2015)</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Van der Walt</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2015">2015</year>
        <article-title>A better default colormap for Matplotlib</article-title>
        <conf-name>Proceedings of the python in science (SciPy) conference, Austin, TX, USA</conf-name>
      </element-citation>
    </ref>
    <ref id="ref-35">
      <label>Van Doremalen et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Doremalen</surname>
            <given-names>RFM</given-names>
          </name>
          <name>
            <surname>Van Netten</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Van Baal</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Vollenbroek-Hutten</surname>
            <given-names>MMR</given-names>
          </name>
          <name>
            <surname>van der Heijden</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2019">2019</year>
        <article-title>Validation of low-cost smartphone-based thermal camera for diabetic foot assessment</article-title>
        <source>Diabetes Research and Clinical Practice</source>
        <volume>149</volume>
        <fpage>132</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="doi">10.1016/j.diabres.2019.01.032</pub-id>
        <pub-id pub-id-type="pmid">30738090</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-36">
      <label>Wikimedia Commons (2019)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <collab>Wikimedia Commons</collab>
        </person-group>
        <year iso-8601-date="2019">2019</year>
        <article-title>Category: photos taken with FLIR systems</article-title>
        <uri xlink:href="https://commons.wikimedia.org/wiki/Category:Photos_taken_with_FLIR_Systems">https://commons.wikimedia.org/wiki/Category:Photos_taken_with_FLIR_Systems</uri>
        <date-in-citation content-type="access-date" iso-8601-date="2019-06-16">16 June 2019</date-in-citation>
      </element-citation>
    </ref>
    <ref id="ref-37">
      <label>Zhang et al. (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y-c</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y-m</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>X-b</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <year iso-8601-date="2016">2016</year>
        <article-title>The research on the effect of atmospheric transmittance for the measuring accuracy of infrared thermal imager</article-title>
        <source>Infrared Physics &amp; Technology</source>
        <volume>77</volume>
        <fpage>375</fpage>
        <lpage>381</lpage>
        <pub-id pub-id-type="doi">10.1016/j.infrared.2016.06.025</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
