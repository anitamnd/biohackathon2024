<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4858868</article-id>
    <article-id pub-id-type="publisher-id">936</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-016-0936-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Tree inference for single-cell data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Jahn</surname>
          <given-names>Katharina</given-names>
        </name>
        <address>
          <email>jane.e.doe@cambridge.co.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kuipers</surname>
          <given-names>Jack</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Beerenwinkel</surname>
          <given-names>Niko</given-names>
        </name>
        <address>
          <email>niko.beerenwinkel@bsse.ethz.ch</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
        <xref ref-type="aff" rid="Aff2"/>
      </contrib>
      <aff id="Aff1"><label/>Department of Biosystems Science and Engineering, ETH Zurich, Basel, Switzerland </aff>
      <aff id="Aff2"><label/>SIB, Swiss Institute of Bioinformatics, Basel, Switzerland </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>5</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>5</day>
      <month>5</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2016</year>
    </pub-date>
    <volume>17</volume>
    <elocation-id>86</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>11</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>4</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© Jahn et al. 2016</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p>Understanding the mutational heterogeneity within tumors is a keystone for the development of efficient cancer therapies. Here, we present SCITE, a stochastic search algorithm to identify the evolutionary history of a tumor from noisy and incomplete mutation profiles of single cells. SCITE comprises a flexible Markov chain Monte Carlo sampling scheme that allows the user to compute the maximum-likelihood mutation history, to sample from the posterior probability distribution, and to estimate the error rates of the underlying sequencing experiments. Evaluation on real cancer data and on simulation studies shows the scalability of SCITE to present-day single-cell sequencing data and improved reconstruction accuracy compared to existing approaches.</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (doi:10.1186/s13059-016-0936-x) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001711</institution-id>
            <institution>Schweizerischer Nationalfonds zur Förderung der Wissenschaftlichen Forschung</institution>
          </institution-wrap>
        </funding-source>
        <award-id>SystemsX.ch RTD Grant 2013/150</award-id>
        <principal-award-recipient>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>Niko</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id>
            <institution>European Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ERC Synergy Grant 609883</award-id>
        <principal-award-recipient>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>Niko</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2016</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p>Tumor progression can be described as a dynamic evolutionary process acting at the level of individual cells [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. A tumor typically arises from a single founder cell whose distinct set of genetic (and epigenetic) lesions gives it a growth advantage over the surrounding cells and helps it to evade the patient’s immune response. As a consequence, the clone arising from this cell expands and, over the course of time, the descendant cells develop further into subclones by acquiring additional somatic mutations [<xref ref-type="bibr" rid="CR4">4</xref>]. The subclones compete against each other for resources in the tumor environment and the more successful ones will replace others until eventually they themselves are out-competed by new subclones [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]; see also Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">a</xref>.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Tumor evolution and cell phylogeny. <bold>a</bold> Schematic representation of tumor evolution with time progressing downwards. <italic>Stars</italic> denote new mutations leading to subclone expansion. The <italic>quadrangles</italic> belong to minor extinct subclones with no traces in the present-day populations. The mutations founding these clones may not have induced a sufficient growth advantage to have surviving descendant cells or may have been lost by chance. The <italic>gray discs</italic> on the bottom denote single cells sequenced after tumor removal. The <italic>stars</italic> they contain indicate the mutations observed in the cell. <bold>b</bold> Binary genealogical tree of the sequenced cells. An <italic>empty disc</italic> represents a normal somatic cell, which is an outgroup for the tumor cells. <bold>c</bold> Binary mutation matrix representing the mutation status of the sequenced tumor cells. A <italic>zero</italic> entry denotes the absence of a mutation in the respective cell, while a <italic>one</italic> denotes its presence. <bold>d</bold> The perfect phylogeny represented as a mutation tree, the partial (temporal) order of the mutation events. Mutations are summarized in a single node when their order is unidentifiable from the sampled cells, as is the case here for the two top-most mutations with the matrix from (<bold>c</bold>). <bold>e</bold> Hierarchical subclone structure. Cells with identical mutation profiles cluster into subclones, which serve as taxa in this phylogenetic tree. <bold>f</bold> Mutation tree with single-cell samples attached. <bold>g</bold> Noisy mutation matrix with missing values. The <italic>red numbers</italic> indicate flipped mutation states with respect to the true mutation matrix in (<bold>c</bold>). For 0→ 1, a false positive, the mutation is called but not present in the cell. For 1→ 0, a false negative, the mutation is not called but present in the cell, most likely due to allelic dropout during the DNA amplification. The <italic>red dash</italic> indicates a missing value; it is unknown whether the site is mutated or in the normal state in this cell</p></caption><graphic xlink:href="13059_2016_936_Fig1_HTML" id="MO1"/></fig></p>
    <p>The genetic diversity arising from this process, referred to as intra-tumor heterogeneity, is believed to be a major cause of relapse after cancer treatment [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. The common explanation is that drug therapy often targets the dominant subclone at the time of diagnosis, and upon its remission, either an expansion of previously suppressed subclones, non-susceptible to the treatment, or an emergence of new resistant subclones is likely to happen [<xref ref-type="bibr" rid="CR8">8</xref>]. For monoclonal tumor progression, the temporal order in which specific mutations have occurred has been shown to be informative for disease progression and susceptibility to drug therapy [<xref ref-type="bibr" rid="CR9">9</xref>]. Therefore, a more comprehensive understanding of the genetic diversity of individual tumors and their evolutionary history is likely to be a key component in the design of personalized cancer therapies that are more effective [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>].</p>
    <p>All cells in a tumor are related via a binary genealogical tree (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">b</xref>). To reconstruct their evolutionary history based on single-nucleotide variants (SNVs), the infinite sites assumption is typically made, which implies that the mutation profiles of the cells (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">c</xref>) form a perfect phylogeny. A perfect phylogeny exists if for all pairs of mutations <italic>i</italic><sub>1</sub>, <italic>i</italic><sub>2</sub>, the set of cells having mutation <italic>i</italic><sub>1</sub> and the set of cells having mutation <italic>i</italic><sub>2</sub> are either disjoint or one is a subset of the other [<xref ref-type="bibr" rid="CR12">12</xref>]. Most approaches to reconstructing tumor phylogenies focus on the partial (temporal) order among the mutation events (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">d</xref>). This tree type implicitly defines the set of possible subclones via the mutation profiles that can be read from the tree by collecting the mutations on the path from the root to any other node in the tree. Not all possible subclones, in particular those at inner nodes, need to have surviving cells. Also, by chance, cells from surviving subclones may not be sampled.</p>
    <p>The main challenge in obtaining knowledge on intra-tumor heterogeneity is that common bulk high-throughput sequencing admixes the DNA of millions of cells in a sample before sequencing. The mutation profiles obtained from the mixture constitute an average of an unknown number of unknown subclones each making up an unknown fraction of the mixture [<xref ref-type="bibr" rid="CR13">13</xref>]. Therefore, tree reconstruction needs to be completed by a deconvolution of the mixed signal to identify the subclones, the taxa of the tree. In the past years, an abundance of tools has been developed to study subclone composition in mixed samples [<xref ref-type="bibr" rid="CR14">14</xref>–<xref ref-type="bibr" rid="CR19">19</xref>]. Among the approaches that additionally reconstruct the evolutionary relationships, the majority separates subclone estimation and tree reconstruction [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR24">24</xref>], while others combine both tasks into a single step [<xref ref-type="bibr" rid="CR25">25</xref>–<xref ref-type="bibr" rid="CR27">27</xref>]. The typical output of these tools would be one or several trees as in Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">d</xref>, augmented with the estimated prevalence of the different subclones in the tumor. Signals from multiple samples from different locations in the tumor increase the statistical power [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR27">27</xref>]. Samples taken from different time points are useful as well [<xref ref-type="bibr" rid="CR28">28</xref>] but are usually not available for solid tumors, as biopsies are typically taken only once, at the point when the tumor is removed from the patient.</p>
    <p>Approaches using mixed samples provide valuable insights into intra-tumor heterogeneity. However, their resolution is inherently limited and inference of both complex subclone structures and low-frequency subclones remains difficult [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. The advent of single-nucleus sequencing techniques has started to change the situation. Here, the taxa are known in the form of the individual cells sequenced from a tumor. However, the data we obtain from single-cell sequencing experiments are notoriously error-prone, in particular the false negative rate can be extremely high (≥10 <italic>%</italic>) due to the high allelic dropout rate in the DNA amplification process. The false positive rate is also elevated in comparison to bulk sequencing. Lastly, unobserved sites can be a problem. For example, 58 % of the data points are reported as missing due to low quality in an early single-nucleus sequencing data set [<xref ref-type="bibr" rid="CR30">30</xref>] thus giving no information on whether the site is mutated or not in the respective cell. This combination of error types prohibits the application of standard perfect phylogeny reconstruction approaches. While generalizations of the perfect phylogeny problem to deal with imperfect data exist, they are typically NP-hard, and modify the input data in the binary mutation matrix, either by finding the minimum number of entries that need to be changed to remove all inconsistencies [<xref ref-type="bibr" rid="CR31">31</xref>], or by removing the minimum number of samples (taxa) to remove all the inconsistencies [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
    <p>Probabilistic approaches are an alternative to make use of all information contained in the (inconsistent) data. In addition, using a Bayesian scheme, the whole posterior tree distribution instead of just a single tree can be obtained and model parameters such as the error rates of the sequencing experiments can be learned. Bayesian approaches typically use polynomial-time Markov chain Monte Carlo (MCMC) sampling heuristics to explore a (super-)exponential search space.</p>
    <p>A fully Bayesian approach is BitPhylogeny [<xref ref-type="bibr" rid="CR33">33</xref>], which uses non-parametric clustering in combination with a tree-structured stick-breaking process to identify subclones and their evolutionary relationships. Unlike tree-based approaches for mixed samples, BitPhylogeny clusters samples into subclones and sets these in a phylogenetic relation (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">e</xref>).</p>
    <p>Kim and Simon [<xref ref-type="bibr" rid="CR34">34</xref>] introduced a pairwise ordering test for mutations in an attempt to find the best fitting tree from noisy and incomplete single-cell data [<xref ref-type="bibr" rid="CR30">30</xref>]. Their approach reconstructs a mutation history as in Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">d</xref>, also referred to as <italic>mutation tree</italic>. The restriction to pairwise tests results in an efficient polynomial-time algorithm but comes at the cost of a potential loss in reconstruction quality, as all information from more complex relations than pairwise order is discarded. Instead of using pairwise orders, one could consider testing the ordering of triplets of nodes and then higher groupings.</p>
    <p>Here we propose a likelihood-based approach to test the entire mutation tree at once and perform a stochastic search to find the best fitting tree. We introduce SCITE (Single Cell Inference of Tumor Evolution), a flexible MCMC sampling scheme that allows us to compute the maximum likelihood (ML) tree plus attachment points of the samples, sample from their posterior, or treat mutation trees with the attachment points marginalized out. These can be combined with learning the error rates of the sequencing experiments. We evaluate SCITE on real cancer data, showing its scalability to present-day single-cell sequencing data and its improved results over BitPhylogeny [<xref ref-type="bibr" rid="CR33">33</xref>], the approach of [<xref ref-type="bibr" rid="CR34">34</xref>], classic perfect phylogeny reconstruction, and methods designed for bulk-sequencing data. In addition, we estimate from simulation studies the number of cells necessary for reliable mutation tree reconstruction, which could inform the design of future single-cell sequencing projects.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Tree inference from single-cell mutation profiles</title>
      <p>We first provide a brief description of our approach to tree inference from single-cell mutation profiles. We start with a model for representing single-cell mutation histories and the likelihood-based approach to deal with sequencing errors. Then we give an overview on the different variants of the MCMC sampling scheme implemented in SCITE. A more technical description of SCITE is in the “<xref rid="Sec31" ref-type="sec">Methods</xref>” section.</p>
      <sec id="Sec4">
        <title>Model of tumor evolution and tree representation</title>
        <p>We restrict the evolutionary model to point mutations in this work and make the infinite sites assumption, which states that every genome position mutates at most once in the evolutionary history of a tumor. No further constraints are necessary, in particular no assumption on a monoclonal origin of the tumor is made, a core assumption in tree reconstruction from mixed samples.</p>
        <p>We represent the mutation status of <italic>m</italic> single cells at <italic>n</italic> different loci in a binary <italic>n</italic>×<italic>m mutation matrix E</italic> where a 1, respectively a 0, at entry (<italic>i</italic>,<italic>j</italic>) denotes the presence, respectively the absence, of mutation <italic>i</italic> in cell <italic>j</italic> (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">c</xref>). With the exclusion of convergent evolution due to the infinite sites assumption, this matrix defines a perfect phylogeny of the single cells. This means that there exists a rooted binary tree with the cells as leaves in which every mutation can be placed on one edge such that the mutation status of every leaf equals the set of mutations on its path to the root (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">b</xref>). Mutations present in all cells can be removed from the data as their location in the tree is known. The same is true for mutations observed only in a single cell. These are directly associated with the cell and non-informative in the tree reconstruction. For example, the mutation matrix from Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">c</xref> reduces to: 
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \begin{aligned} &amp;\qquad \qquad \quad s_{1} \quad s_{2} \quad s_{3} \quad s_{4} \quad \ s_{5} \quad s_{6} \quad s_{7}\\ &amp;E= \begin{array}{c} M_{1}\\ M_{2}\\ M_{3} \end{array} \left(\begin{array}{ccccccc} 1 &amp; \quad 1 &amp; \quad 1 &amp; \quad 0 &amp; \quad 0 &amp; \quad 0 &amp; \quad 0 \\ 0 &amp; \quad 0 &amp; \quad 0 &amp; \quad 0 &amp; \quad 1 &amp; \quad 1 &amp; \quad 1 \\ 0 &amp; \quad 0 &amp; \quad 0 &amp; \quad 0 &amp; \quad 1 &amp; \quad 1 &amp; \quad 0 \end{array}\right), \end{aligned}  $$ \end{document}</tex-math><mml:math id="M2"><mml:mtable><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_936_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where we now represent the remaining three mutations as <italic>M</italic><sub>1</sub>, <italic>M</italic><sub>2</sub>, and <italic>M</italic><sub>3</sub>. In general, the binary tree defined by the matrix <italic>E</italic> will not be unique. In the example in Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">b</xref>, since the three left-most leaves all have the same mutation status, their branching order in the tree is, therefore, arbitrary. Also the correct placement of the fourth leaf is not unique, as it has no mutation other than the ones shared by all samples. It could equally well branch off in the left subtree after the two ubiquitous mutations instead of the right one. A more compact tree representation of <italic>E</italic> is a <italic>mutation tree</italic><italic>T</italic>, which represents the mutations as nodes and connects the nodes according to their order in the evolutionary history. An empty node is used to indicate the root (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">d</xref>). The mutation tree can be seen as the perfect phylogeny tree, where instead of placing the mutations along the edges we encapsulate them inside internal nodes. This slight change in representation facilitates our inference later. The mutation tree can be augmented with the sequenced cells by attaching them to the node that matches their mutation state (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">f</xref>). The order of mutations shared by the exact same set of cells is unidentifiable in the mutation tree, as is the case for the two top-most mutations in Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">f</xref>. Such subsets of mutations are summarized in a single node, here highlighted as a shaded box.</p>
      </sec>
      <sec id="Sec5">
        <title>Observational errors</title>
        <p>In real data, we do not observe a perfect mutation matrix (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">c</xref>) but a noisy version of it (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">g</xref>), which we denote by <italic>D</italic> in the following. If the true mutation value is 0, we may observe a 1 with probability <italic>α</italic> (false positive), and if the true mutation value is 1, we may observe a 0 with probability <italic>β</italic> (false negative) such that 
<disp-formula id="Equ2"><label>(2)</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${} \begin{aligned} P(D_{ij}=0 | E_{ij} = 0) &amp;= 1-\alpha, &amp; P(D_{ij}=0 | E_{ij} = 1) &amp;= \beta,\\ P(D_{ij}=1 | E_{ij} = 0) &amp;=\alpha, &amp; P(D_{ij}=1 | E_{ij} = 1) &amp;= 1-\beta. \end{aligned}  $$ \end{document}</tex-math><mml:math id="M4"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_936_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Assuming the observational errors are independent of each other, the likelihood of the data given a mutation tree <italic>T</italic>, knowledge of the attachment of the samples <bold><italic>σ</italic></bold>, and the error rates <bold><italic>θ</italic></bold>=(<italic>α</italic>,<italic>β</italic>) is then 
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  P(D| T,\boldsymbol{\sigma},\boldsymbol{\theta}) =\prod_{i=1}^{n}\prod_{j=1}^{m} P(D_{ij} | E_{ij}),  $$ \end{document}</tex-math><mml:math id="M6"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2016_936_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>where <italic>E</italic> is the mutation matrix defined by <italic>T</italic> and <bold><italic>σ</italic></bold>.</p>
        <p>For the posterior, 
<disp-formula id="Equ4"><label>(4)</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  P(T,\boldsymbol{\sigma},\boldsymbol{\theta} | D) \propto P(D| T,\boldsymbol{\sigma},\boldsymbol{\theta}) P(T,\boldsymbol{\sigma},\boldsymbol{\theta}),  $$ \end{document}</tex-math><mml:math id="M8"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2016_936_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>we can factorize the prior, <italic>P</italic>(<italic>T</italic>,<bold><italic>σ</italic></bold>,<bold><italic>θ</italic></bold>)=<italic>P</italic>(<bold><italic>σ</italic></bold>|<italic>T</italic>,<bold><italic>θ</italic></bold>)<italic>P</italic>(<italic>T</italic>,<bold><italic>θ</italic></bold>), and we assume independence of the error rates to set <italic>P</italic>(<italic>T</italic>,<bold><italic>σ</italic></bold>,<bold><italic>θ</italic></bold>)=<italic>P</italic>(<bold><italic>σ</italic></bold>|<italic>T</italic>)<italic>P</italic>(<italic>T</italic>)<italic>P</italic>(<bold><italic>θ</italic></bold>) so that the attachment prior <italic>P</italic>(<bold><italic>σ</italic></bold>|<italic>T</italic>) depends on <italic>T</italic>. Such a prior might be useful if one suspects that cells are more likely to be sampled from later stages in tumor development and lower down in the tree. Here though we use a uniform attachment prior.</p>
      </sec>
      <sec id="Sec6">
        <title>MCMC sampling</title>
        <p>Our model for learning mutation histories from single-cell mutation profiles consists of three parts: the mutation tree <italic>T</italic>, the sample attachment vector <bold><italic>σ</italic></bold>, and the error rates of the sequencing experiment <bold><italic>θ</italic></bold>. The resulting search space has a continuous component for <bold><italic>θ</italic></bold> and a discrete component of size (<italic>n</italic>+1)<sup>(<italic>n</italic>−1)</sup>(<italic>n</italic>+1)<sup><italic>m</italic></sup> for (<italic>T</italic>,<bold><italic>σ</italic></bold>), which prohibits an exhaustive search. Instead, with Eqs. <xref rid="Equ3" ref-type="">3</xref> and <xref rid="Equ4" ref-type="">4</xref> we built SCITE, a MCMC scheme to sample from the joint posterior given the data. From the current state (<italic>T</italic>,<bold><italic>σ</italic></bold>,<bold><italic>θ</italic></bold>), we propose a new state (<italic>T</italic><sup>′</sup>,<bold><italic>σ</italic></bold><sup>′</sup>,<bold><italic>θ</italic></bold><sup>′</sup>) with an ergodic mixture of moves where we change one component at a time. With properly defined transition probabilities and acceptance ratio, our chain converges to the posterior. In practice, we marginalize out the sample attachments in our model not only to speed up convergence but to focus on the mutation tree <italic>T</italic> as the informative part for understanding the mutation history. Thus, 
<disp-formula id="Equ5"><label>(5)</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  P(T,\boldsymbol{\theta} | D) = \sum_{\boldsymbol{\sigma}} P(T,\boldsymbol{\sigma},\boldsymbol{\theta} | D).  $$ \end{document}</tex-math><mml:math id="M10"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2016_936_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>We then only need to consider moves in the joint (<italic>T</italic>,<bold><italic>θ</italic></bold>) space, thereby reducing the search space by a factor of (<italic>n</italic>+1)<sup><italic>m</italic></sup>. It is still possible to augment the tree with the samples in a post-processing step by sampling them conditionally on the tree.</p>
        <p>After convergence, the MCMC chain can be used to sample trees and error rates proportionally to the joint posterior distribution in Eq. <xref rid="Equ4" ref-type="">4</xref>. In addition, it is possible to obtain a single best fitting combination of mutation tree and error rates via point estimates of the model parameters. One way of doing this is via maximum a posteriori (MAP) estimates: 
<disp-formula id="Equ6"><label>(6)</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  (T,\boldsymbol{\theta})_{\text{MAP}} = \text{arg} \max_{(T,\boldsymbol{\theta})} P(T,\boldsymbol{\theta} | D).  $$ \end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2016_936_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Another possibility is to use ML estimates. Since the likelihood depends on the full set of model parameters (<italic>T</italic>,<bold><italic>σ</italic></bold>,<bold><italic>θ</italic></bold>), it is more natural to optimize them all jointly rather than marginalizing out the sample attachment: 
<disp-formula id="Equ7"><label>(7)</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  (T,\boldsymbol{\sigma},\boldsymbol{\theta})_{\text{ML}} = \text{arg} \max_{(T,\boldsymbol{\sigma},\boldsymbol{\theta})} P(D | T,\boldsymbol{\sigma}, \boldsymbol{\theta}).  $$ \end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mtext>ML</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2016_936_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>In the ML framework, SCITE includes a parameter <italic>γ</italic> that amplifies the likelihood and which can speed up discovery of the ML tree.</p>
        <p>Finally, SCITE provides an option to skip the learning of error rates when fixed error rates are provided. Since these are often available for sequencing data, they can be used instead to reduce the search space size.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Reconstructing mutation histories from real tumor data</title>
      <p>For a first evaluation of SCITE, we applied it to three real single-cell tumor data sets of different data quality.</p>
      <sec id="Sec8">
        <title>JAK2-negative myeloproliferative neoplasm</title>
        <p>The first tumor data is single-cell exome sequencing data from a JAK2-negative myeloproliferative neoplasm (essential thrombocythemia) [<xref ref-type="bibr" rid="CR30">30</xref>]. It originally consists of 712 SNVs detected in the exomes of 58 tumor cells. In our evaluation, we focus on the 18 mutation sites selected as cancer-related by [<xref ref-type="bibr" rid="CR30">30</xref>]. The error rates of the sequencing were estimated as <italic>α</italic>=6.04×10<sup>−6</sup> (false positives) and <italic>β</italic>=0.4309 (false negatives, allelic dropout). In addition, the reduced set has 45 % missing data points (compared to 58 % in the full data set). The mutation matrix (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1a) is taken from [<xref ref-type="bibr" rid="CR34">34</xref>]. It distinguishes three observed states: normal, heterozygous, and homozygous mutation. This means only that a homozygous mutation is observed, not that it is actually present in the data. The latter would contradict the infinite sites model that each site mutates at most once. Explanations consistent with infinite sites are that we either have a false negative for the normal copy of a heterozygous site, or less likely, a combination of a false positive and an allelic dropout for a site whose true state is homozygous normal. Another explanation for observing a homozygous mutation could be a loss of heterozygosity. We adapted our approach to integrate the third mutation state by using the same error probabilities as [<xref ref-type="bibr" rid="CR34">34</xref>]. They assume that an allelic dropout is equally likely to cause a heterozygous mutation to be recorded as a normal state or as homozygous. Denoting heterozygous sites by 1 and homozygous sites by 2, this assumption results in the error probabilities: 
<disp-formula id="Equ8"><label>(8)</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $${} {\small{\begin{aligned} P(D_{ij}=0 | E_{ij} = 0) &amp;= 1-\alpha -\frac{\alpha\beta}{2}, &amp;\!\!\!\!\! P(D_{ij}=0 | E_{ij} = 1) &amp;= \frac{\beta}{2}, \\ P(D_{ij}=1 | E_{ij} = 0) &amp;=\alpha, &amp;\!\!\!\!\! P(D_{ij}=1 | E_{ij} = 1) &amp;= 1-\beta, \\ P(D_{ij}=2 | E_{ij} = 0) &amp;= \frac{\alpha\beta}{2}, &amp;\!\!\!\!\! P(D_{ij}=2 | E_{ij} = 1) &amp;= \frac{\beta}{2}. \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M16"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>αβ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>αβ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_936_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
        <sec id="Sec9">
          <title>Mutation tree reconstruction</title>
          <p>We computed the ML tree for the 18 mutation sites with SCITE. When optimizing tree and sample attachment, we obtain a mostly linear mutation tree with a single branching in the lower part of the tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2a) with a ML log score of −378.4.</p>
          <p>We observe that quite a few samples are placed at nodes high up in the tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3), though many of these placements are uncertain, as indicated by the multiple co-optimal attachments. Taking into account the uncertainties due to the high error rates and the large number of missing values (45 %), it is not unexpected that many cells fit equally well to several neighboring nodes. The linear nature of the tree matches a sequential monoclonal development. The subclone expansion starting towards the bottom of the tree indicates the co-existence of multiple subclones at the point of sampling. However, from the single time point data, it is not possible to decide whether the more recent subclones are on the verge of replacing the more ancestral clones, or will coexist for longer.</p>
          <p>Along with finding the ML tree with attachments, we performed a fully Bayesian sampling of trees and attachments from the posterior. To summarize such a sample, we consider as an example the number of branches the trees possess. The distribution for the data from [<xref ref-type="bibr" rid="CR30">30</xref>] (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">a</xref>) shows that the trees mostly have a single branching point (with two branches) like the ML tree and often occur as a simple linear chain with a single branch.
<fig id="Fig2"><label>Fig. 2</label><caption><p>The posterior tree branch and error distributions. The posterior distribution for the number of tree branches for the data from [<xref ref-type="bibr" rid="CR30">30</xref>] in (<bold>a</bold>), for the data from [<xref ref-type="bibr" rid="CR35">35</xref>] in (<bold>c</bold>), and for the data from [<xref ref-type="bibr" rid="CR36">36</xref>] in (<bold>e</bold>), all with fixed false negative error rate <italic>β</italic>. The prior distributions from uniformly sampled trees are in <italic>light purple</italic>. The posterior distributions for <italic>β</italic> for the same data sets are given in (<bold>b</bold>), (<bold>d</bold>), and (<bold>f</bold>) with the priors included as <italic>light purple lines</italic>. When <italic>β</italic> is learned, the posterior distribution of the number of tree branches shifts slightly as indicated by the <italic>black crosses</italic> in (<bold>a</bold>), (<bold>c</bold>), and (<bold>e</bold>). <italic>SD</italic> standard deviation</p></caption><graphic xlink:href="13059_2016_936_Fig2_HTML" id="MO2"/></fig></p>
        </sec>
        <sec id="Sec10">
          <title>Comparison to trees found with other approaches</title>
          <p>The same data have previously been analyzed with two competing methods [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>].</p>
          <p>Kim and Simon [<xref ref-type="bibr" rid="CR34">34</xref>] employ the same underlying likelihood with errors as in Eq. <xref rid="Equ8" ref-type="">8</xref> but they use the data to learn ancestral relations between each pair of mutation nodes instead of the whole tree at once. They also use the data to learn a parameter representing how quickly the mutation tree branches. This parameter is then used to calculate the prior probability of ancestral relations, which is fed into their pairwise test and subsequent tree reconstruction.</p>
          <p>With the data from [<xref ref-type="bibr" rid="CR30">30</xref>] (on the same 18 selected mutations), [<xref ref-type="bibr" rid="CR34">34</xref>] estimate that 92 % of the evolutionary time of the phylogenetic tree should be before the first binary split. In their model, this translates into expecting over 80 % of the mutations to occur before any branching in the mutation tree. Despite this very linear tree estimate, their algorithm to turn the pairwise ancestral relations into a mutation tree leads to the very branched tree in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2c, which has a much lower log-likelihood of −1059.7 than the ML tree found with SCITE (with a log-likelihood of −378.4). This may be due to the use of the minimum spanning tree algorithm by Kim and Simon. The method effectively needs to turn ancestral relations into strict parent–child relations and thereby, it essentially discounts the deeper history embedded in their pairwise tests.</p>
          <p>We cannot compare directly to the tree found by BitPhylogeny [<xref ref-type="bibr" rid="CR33">33</xref>] since their algorithm aims to find the phylogenetic connection between the samples themselves rather than the mutation tree. Furthermore, the algorithm groups samples into clones according to the data and a stick-breaking prior. For example, using all the mutation data from [<xref ref-type="bibr" rid="CR30">30</xref>], as well as a bulk normal and bulk cancer sequence, and with a particular stick-breaking tree prior they find one large clone accounting for over half the samples and eight further smaller clones arranged in a tree structure [<xref ref-type="bibr" rid="CR33">33</xref>]. However, we can view their result as a mutation tree with attachments where the mutations themselves have been censored. This leaves just the sample attachment information as well as the global tree structure between their groupings.</p>
          <p>To build a complete mutation tree we allow each mutation to be placed before any one of the clonal groupings of samples (or completely afterwards). For each mutation, we find its ML position and hence find the ML tree (with attachments), which respects the result of [<xref ref-type="bibr" rid="CR33">33</xref>]. The resulting tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2b) is a mostly linear chain like the ML tree SCITE finds and involves some of the same genes at the branches although one of our branches is lost. The log-likelihood of −642.3 for this tree is substantially better than the tree of [<xref ref-type="bibr" rid="CR34">34</xref>] but worse than the tree SCITE finds (with a log-likelihood of −378.4). With single-cell sequencing we can, as we do here, simply treat each cell as its own clone and discover the phylogeny directly. BitPhylogeny [<xref ref-type="bibr" rid="CR33">33</xref>] instead focuses on clustering samples into subclones during tree inference thereby reducing the resolution of the reconstruction.</p>
        </sec>
        <sec id="Sec11">
          <title>Error rate learning</title>
          <p>Within our Bayesian MCMC approach, we can also sample error rates from the posterior. Focusing on the false negative error rate <italic>β</italic> while keeping the false positive <italic>α</italic> fixed, for the beta prior on <italic>β</italic> with mean 0.4309, we chose a large standard deviation of 0.1. In the MCMC chain, with probability 10 % a new <italic>β</italic><sup>′</sup> is proposed following a Gaussian random walk with standard deviation equal to one third of the prior’s. Running the chain for 10 million steps, throwing away the first quarter, and plotting the resulting posterior of <italic>β</italic> we arrive at Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">b</xref>. The posterior mean is 0.455 with standard deviation 0.027 so that the data indicates that the measured value of 0.4309 is a little underestimated but well within tolerances.</p>
          <p>More interesting for our purposes is how these error rates affect the tree inference. The MAP <italic>β</italic> is 0.455 while the MAP tree (with attachments marginalized out) is a simple chain (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). The mutation order is similar to the ML tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2a) up to the branching point suggesting a monoclonal tumor development. Keeping the error rate fixed at 0.4309 instead, we find an identical MAP tree giving us confidence that the inference is robust against minor differences in the error rates.</p>
        </sec>
        <sec id="Sec12">
          <title>Mutation tree inference for a larger set of mutations</title>
          <p>We also considered a larger set of mutations comprising all 78 non-synonymous mutations from the full data set. For this number of mutations, with only 58 sampled cells and high levels of missing data (48 %), the posterior is rather flat making discovering a global optimum rather than a local optimum more difficult. Increasing the parameter <italic>γ</italic> to 2–3 to amplify the likelihood landscape helped in discovering high-scoring trees. We also tested that the alternative tree representation (see “<xref rid="Sec31" ref-type="sec">Methods</xref>”) designed for instances with more mutations than samples aided in finding the ML tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5). The ML tree is again highly linear but the order especially of some of the 18 mutations varies compared to the ML tree inferred for that subset of the data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). With missing data, the mutations may fit equally well along several edges and they were placed in their earliest position, which may explain some of the variation. More generally though, the high levels of missing data allow mutations and samples to move without affecting the likelihood while high error rates allow further rearrangements with only a small effect. For example, the mutation in the gene <sc>PDE4DIP</sc> that changes most between the two data sets has 59 % missing data. Also the order is essentially determined by the smaller number of samples that attach higher up the trees. This smaller number is effectively reduced further by the missing data, limiting the accuracy of any tree reconstruction, as explored later with the simulations.</p>
        </sec>
      </sec>
      <sec id="Sec13">
        <title>Clear-cell renal-cell carcinoma</title>
        <p>The second data set is from single-cell exome sequencing data of a clear-cell renal-cell carcinoma [<xref ref-type="bibr" rid="CR35">35</xref>]. The mutation statuses of 50 sites in 17 tumor cells are detailed in the supplementary material of [<xref ref-type="bibr" rid="CR35">35</xref>]. We marked the presence of an SNV when the call was different from the consensus of five normal tissue cells (in line with the totals provided in their supplementary material). As for the data from [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR35">35</xref>] distinguish between heterozygous and homozygous mutations so we again use Eq. <xref rid="Equ8" ref-type="">8</xref>. Of the 50 sites, only 35 were not mutated in at least one cell. Only those were selected since the remaining 15 would simply be placed at the top of the mutation tree. The error rates were estimated by [<xref ref-type="bibr" rid="CR35">35</xref>] as <italic>α</italic>=2.67×10<sup>−5</sup> (false positives) and <italic>β</italic>=0.1643 (false negatives) and the data also has 22 % missing entries (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1b).</p>
        <sec id="Sec14">
          <title>Mutation tree reconstruction</title>
          <p>The ML and MAP trees both possess a completely linear accumulation of mutations (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figures S6 and S7a), which is consistent with a series of monoclonal expansions and the conclusions of [<xref ref-type="bibr" rid="CR35">35</xref>]. The linearity is confirmed in the full posterior distribution of trees with a linear chain being dominant (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">c</xref>). In addition, we observe that almost all of the samples are placed towards the end of the tree. Again a larger value of the parameter <italic>γ</italic> and the alternative tree representation sped up discovery of ML trees.</p>
        </sec>
        <sec id="Sec15">
          <title>Error rate learning</title>
          <p>Fixing a beta prior for <italic>β</italic> with mean 0.1643 and standard deviation of 0.06 the posterior distribution of <italic>β</italic> was obtained by averaging over ten runs of 10 million steps (with a quarter as burn-in) (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">d</xref>). The posterior mean is a little larger at 0.207 with a standard deviation of 0.019 so the stated value is just within the uncertainties. The MAP value of <italic>β</italic> instead is a little closer at 0.198 while the MAP tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7b) is essentially identical to that with a fixed value of <italic>β</italic>=0.1643 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7a). The order of some of the higher mutations varies, however, since their exact placement hardly affects the posterior probability.</p>
        </sec>
      </sec>
      <sec id="Sec16">
        <title>Estrogen-receptor positive (ER <sup>+</sup>) breast cancer</title>
        <p>The third data set is from single-nucleus exome sequencing of 47 tumor cells from an estrogen-receptor positive (ER <sup>+</sup>) breast cancer [<xref ref-type="bibr" rid="CR36">36</xref>]. Only two states are called for each site: the presence or absence of a SNV. Estimated error rates from [<xref ref-type="bibr" rid="CR36">36</xref>] are 9.72 % for allelic dropout, and 1.24×10<sup>−6</sup> for false discovery. In our analysis, we use the 40 mutations present in at least two tumor cells (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1c).</p>
        <sec id="Sec17">
          <title>Mutation tree reconstruction</title>
          <p>The MAP tree computed for this data set is shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. In the Supplement, we additionally show the ML tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8) and a version of the MAP tree with attached samples (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9a). In both the MAP and the ML trees, we observe a linear accumulation of mutations in the early stages of the tumor, suggesting that the development was through a sequential replacement of subclones with no surviving side branches and only a few cells with ancestral states surviving until present. In the later stages of the tumor, we observe a complex branching into co-existing subclones. This branching is exhibited more generally in the full posterior distribution of trees as summarized in Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">e</xref>.
<fig id="Fig3"><label>Fig. 3</label><caption><p>MAP tree for the (ER <sup>+</sup>) breast cancer for the [<xref ref-type="bibr" rid="CR36">36</xref>] data. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9a for a version with samples attached. <italic>Yellow</italic> genes indicate non-synonymous mutations in known cancer genes [<xref ref-type="bibr" rid="CR36">36</xref>]</p></caption><graphic xlink:href="13059_2016_936_Fig3_HTML" id="MO3"/></fig></p>
          <p>From the single time point data available for this tumor, it cannot be inferred whether there will be a long-term coexistence of subclones, or if we observe a transient state that will eventually lead to a single surviving subclone. For initial cancer treatment, however, the status quo, whatever mutations co-occur in cells, is already informative for jointly targeting the present subclones and therefore, minimizing the risk of further differentiation into therapy-resistant subclones.</p>
        </sec>
        <sec id="Sec18">
          <title>Error rate learning</title>
          <p>Using a beta prior for <italic>β</italic> with mean 0.0972 and standard deviation of 0.04, we averaged over 20 runs of 10 million steps (with a quarter as burn-in) to obtain the posterior distribution of <italic>β</italic> (Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">f</xref>). The posterior mean is more than double at 0.228 (with a standard deviation of 0.015), which disagrees with the stated value. This result is in contrast to our later simulations on learning the error rate (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) that show that the MAP value is close to the true one. A possible explanation for the discrepancy is that allelic dropout only comprises one part of the false negative rate. Other contributing factors could include inaccuracies in calling heterozygous mutations at low coverage.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Learning error rates. Comparison of the MAP false negative rate <italic>β</italic> learned using SCITE for <italic>n</italic>=20 against the <italic>β</italic> used to generate the data. The <italic>solid blocks</italic> are one and two standard deviations of inferring <italic>β</italic> if the tree was known. <italic>MAP</italic> maximum a posteriori probability</p></caption><graphic xlink:href="13059_2016_936_Fig4_HTML" id="MO4"/></fig></p>
          <p>The MAP value of <italic>β</italic> is 0.226 with a MAP tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9b), which shares many feature with the MAP tree at fixed <italic>β</italic>=0.0972 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9a) but has some rearrangements of the branches lower down and some reordering of the mutations higher up. Learning the error rate also leads to slightly fewer branches in the posterior distribution, as indicated by the black crosses in Fig. <xref rid="Fig2" ref-type="fig">2</xref><xref rid="Fig2" ref-type="fig">e</xref>.</p>
        </sec>
      </sec>
    </sec>
    <sec id="Sec19">
      <title>Systematic evaluation of SCITE on simulated data</title>
      <p>With the limited availability of single-cell sequencing data at this point and the lack of the ground truth in real data, we performed a more systematic evaluation of SCITE on simulated data sets. Our analysis focuses on the accuracy of tree inference and error rate learning, the effect of data quality, and the practical run times of SCITE.</p>
      <sec id="Sec20">
        <title>Accuracy of tree inference</title>
        <p>To check the consistency of our approach, we simulated random mutation trees with attachments uniformly, which allows for poly-clonal tree topologies. First, for <italic>n</italic>=20 and <italic>α</italic>=10<sup>−5</sup>, we generated 100 such trees with up to 100 attachments. For error rates 100<italic>β</italic>∈{5,15,25}, for each tree we sampled from a lognormal with standard deviation 0.1 and multiplied it by <italic>β</italic> to obtain <italic>β</italic><sup>∗</sup>. Then we added noise to the perfect data with rates (<italic>α</italic>,<italic>β</italic><sup>∗</sup>) and removed 1 % of the data. Taking subsets of the data of size <italic>m</italic>, we learned the ML and MAP trees for the error rates <italic>β</italic>. This gives us a random misspecification of around 10 % compared to <italic>β</italic><sup>∗</sup>.</p>
        <p>We quantified the difference between the inferred trees and the true tree by counting how often a node has the wrong parent (Fig. <xref rid="Fig5" ref-type="fig">5</xref> and the top row of Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10). In the ML setting, if no samples are attached to a chain of mutations, then any ordering of those mutations has the same likelihood. Here, in the score we do not penalize this non-identifiability and take the ordering that minimizes the distance to the generating tree. The non-identifiability will, however, tend to decrease as the number of samples <italic>m</italic> increases. The MAP tree does select an ordering (roughly following the frequencies) and hence has higher distances than the ML tree. In general, MAP inference should be more robust and less prone to overfitting, but can have a higher bias. To compare the ML and MAP inference fairly, we chose a random ordering of the mutations in non-identifiable regions in the ML trees and recomputed the distances to the generating tree. We do observe a marginal improvement in the tree reconstruction with the MAP tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11).
<fig id="Fig5"><label>Fig. 5</label><caption><p>Comparison of different methods. Comparison of the tree learning for <italic>n</italic>=20 using SCITE for the ML tree (<italic>dashed</italic>) and MAP tree (<italic>dotted</italic>) against results from [<xref ref-type="bibr" rid="CR34">34</xref>] (<italic>solid lines</italic>). The ML tree distances do not include non-identifiable regions. <italic>K&amp;S</italic> Kim and Simon [<xref ref-type="bibr" rid="CR34">34</xref>], <italic>MAP</italic> maximum a posteriori, <italic>ML</italic> maximum likelihood</p></caption><graphic xlink:href="13059_2016_936_Fig5_HTML" id="MO5"/></fig></p>
        <p>The errors, however, are not a result of the inference method, since SCITE indeed finds the ML tree (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12). Instead these errors are inherent in noisy data where another tree might happen to fit the data better than the generating tree. The discrepancy can only be resolved by reducing errors or increasing the sample size and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10 gives an indication of how this occurs. To put the errors in scale, a value of two would refer to adjacent mutations in a chain being swapped. Since samples contain the mutations along their entire history in the mutation tree, we have a greater consensus about the mutation structure higher up the tree than lower down. The exact placement of mutations near the bottom of the tree may be determined by only a couple of samples so that the errors we typically see with larger <italic>m</italic> are mutations near the bottom of the tree being shifted, or two adjacent mutations being swapped. With this in mind, we obtain very good trees with about 60 samples, depending on the error rate.</p>
        <p>We repeated the simulations for <italic>n</italic>=40 and up to 200 attachments as depicted along the bottom row of Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10 and again find good reconstruction when we have several samples per mutation.</p>
      </sec>
      <sec id="Sec21">
        <title>Learning the error rates</title>
        <p>Since SCITE can also perform fully Bayesian tree inference, we examined its ability to infer the false negative rate from data. For 2000 random trees with 60 attachments, we generated data with a range of <italic>β</italic> from 5 to 25 %, <italic>α</italic>=10<sup>−5</sup>, and 1 % missing data. We further fixed a uniform prior for learning <italic>β</italic> so that no information is passed to SCITE apart from the noisy and incomplete mutation matrix.</p>
        <p>There is very high correlation between the generating <italic>β</italic> and the MAP value learned (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). To put this in context, we consider the theoretical distribution if the tree was known. From the random trees and attachments, around 22 % of the entries in the perfect mutation matrix are ones. They are randomly changed with the rate <italic>β</italic>, leading to a binomial distribution and a standard deviation of 
<disp-formula id="Equa"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\sqrt{\frac{100\beta(1-\beta)}{22mn}} $$ \end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>100</mml:mn><mml:mi>β</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>22</mml:mn><mml:mtext mathvariant="italic">mn</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:math><graphic xlink:href="13059_2016_936_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> when inferring <italic>β</italic> from the result. One and two standard deviation intervals are included in Fig. <xref rid="Fig4" ref-type="fig">4</xref>, showing again that SCITE performs very well as it must also infer the tree structure and handle the missing data.</p>
        <p>Similar plots for <italic>m</italic>=40 and <italic>m</italic>=80 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S13) show also a tightening of the <italic>β</italic> inference as <italic>m</italic> increases.</p>
      </sec>
      <sec id="Sec22">
        <title>The effect of missing data</title>
        <p>High rates of missing data points due to unobserved mutation states are typical for present-day single-cell sequencing data. We performed simulation experiments to test how this feature affects the accuracy of mutation tree reconstruction. With an error rate of <italic>β</italic>=10 % and the same misspecification as before, we generated up to 400 random trees with up to 80 attachments. Keeping <italic>α</italic>=10<sup>−5</sup>, we varied the amount of missing data from 1 to 20 % to see the effect on the tree reconstruction for <italic>m</italic>={40,60,80}. We see a very weak increase in reconstruction errors as the missing data rate increases (top row of Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14). Since SCITE treats the inference probabilistically, missing data is akin to effectively reducing the number of samples <italic>m</italic>, so the behavior in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14 is in line with changing <italic>m</italic> slightly in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10. The behavior also shows that SCITE is robust even against high missing data rates.</p>
        <p>Looking back to the even higher missing data rates in the earliest data sets, we simulated up to 60 % missing data with 400 trees and the same settings as before. The reconstruction progressively gets worse with increasing missing data (bottom row of Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S14). At around 30–40 % missing data with 80 attachments, we have similar performance as for 40 cells attached with no missing data, and so have effectively halved our sample size. With 60 % missing data, the reconstruction is notably poorer again, although SCITE does find about half the parents correctly for the MAP solution and a large majority with the ML approach. This difference is because the optimal order is chosen for the ML solutions in case of non-identifiability.</p>
      </sec>
      <sec id="Sec23">
        <title>Doublet samples</title>
        <p>Rarely, instead of isolating a single cell for sequencing, a pair of cells is captured instead. We checked how robust SCITE is to these sorts of perturbations by again simulating data from 400 random trees with 20 nodes and up to 100 attachments. To represent the sequences of doublet samples, we took up to 20 pairs of attached samples and combined them by recording a mutation whenever it was present in either of the original single cells. Errors were added with a rate of <italic>β</italic>=10 <italic>%</italic> (misspecified as previously), <italic>α</italic>=10<sup>−5</sup>, and 1 % missing data. We ran SCITE with <italic>m</italic>={40,60,80} total samples, including up to 20 doublets, to see their effect on the tree reconstruction.</p>
        <p>We observe a linear increase in reconstruction errors as the number of doublets increases (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S15) with decreasing gradient as <italic>m</italic> increases since then the doublets represent a smaller proportion of the total sample. Unlike missing data, which reduces the effective sample size, doublets add confounding mutations, which could disagree with the tree topology. However, since SCITE employs probabilistic inference, and at the level of the mutation tree rather than the sample tree, the consensus of the single-cell samples moderates the negative effects of the doublets. Even at high rates of doublet sampling, like 10 or 20 %, the tree reconstruction, therefore, performs well.</p>
      </sec>
      <sec id="Sec24">
        <title>Run times</title>
        <p>To uncover the complexity of the stochastic search and MCMC scheme, we simulated data from 400 uniformly sampled trees with up to 100 nodes and 400 attached samples. We set <italic>α</italic>=10<sup>−5</sup> and <italic>β</italic>=0.1 (with the same misspecification as before), included 1 % missing data and set the parameter <italic>γ</italic>=1 as for the MCMC case. For each tree, we ran SCITE 100 times and recorded how many steps the algorithm took to first hit the highest likelihood tree uncovered by that run, as well as the time of the run. The lengths of the chains were chosen so that nearly all of the runs would share the same highest likelihood. The average number of steps needed to first find the consensus ML tree can then be calculated (for those runs with a lower likelihood, we add the length of the chain and then assumed they would find the ML tree in an additional average number of steps). This can then be multiplied by the average time per step to give a measure of how long SCITE takes to find a ML tree on average, and repeated for all 400 trees to provide Fig. <xref rid="Fig6" ref-type="fig">6</xref>.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Scaling behavior. The average time taken for SCITE to first find a ML tree as the number of mutations <italic>n</italic> in the tree is varied along with the number of attached samples <italic>m</italic>={<italic>n</italic>,2<italic>n</italic>,4<italic>n</italic>}</p></caption><graphic xlink:href="13059_2016_936_Fig6_HTML" id="MO6"/></fig></p>
        <p>On the theoretical side, arguments analogous to those in [<xref ref-type="bibr" rid="CR37">37</xref>] indicate that the MCMC chain requires <italic>O</italic>(<italic>n</italic><sup>2</sup> ln(<italic>n</italic>)) steps to converge or find ML trees. The likelihood landscape may also depend on <italic>n</italic> and <italic>m</italic> in non-trivial ways, which can further affect the convergence. With each MCMC step taking <italic>O</italic>(<italic>mn</italic>) to score the tree, we get an overall estimate of <italic>O</italic>(<italic>mn</italic><sup>3</sup> ln(<italic>n</italic>)) for convergence.</p>
        <p>Compared to the numerical results in Fig. <xref rid="Fig6" ref-type="fig">6</xref>, the gradients in the log–log plots are 4.5, 4.5, and 4.2 for <italic>m</italic>={<italic>n</italic>,2<italic>n</italic>,4<italic>n</italic>} respectively. Since <italic>m</italic>∼<italic>n</italic> in the simulations, these are a little higher than the power of 4 suggested by the estimate, but roughly in line with it. To check the linear scaling with <italic>m</italic>, we take the fit lines at <italic>n</italic>=60 in the middle of the simulation and we find that doubling <italic>m</italic> from <italic>n</italic> to 2<italic>n</italic> and then 4<italic>n</italic> increases the time by a factor of 1.9 and then 1.95, slightly less than double and in line with linear scaling. With linear scaling in <italic>m</italic>, and for a reasonable number of mutations, SCITE will, therefore, be able to handle large numbers of sampled cells efficiently.</p>
        <p>Further parameters with influence on the practical performance of SCITE are the move probabilities and for ML tree discovery, additionally the parameter <italic>γ</italic>. We performed a systematic search for the optimal parameters, which is described in Additional file <xref rid="MOESM1" ref-type="media">1</xref>. Our observation is that an optimal choice of move probabilities gives a constant factor speed-up compared to default values. Similar results were observed for <italic>γ</italic>, for which the optimum for finding a ML tree quickly is just below 1, the value required for the MCMC sampling.</p>
      </sec>
    </sec>
    <sec id="Sec25">
      <title>Comparison with competing approaches</title>
      <p>To assess further the performance of SCITE, we compared it to a simple perfect phylogeny approach, two methods designed for single-cell data, and two recent methods for tree inference from bulk-sequencing data.</p>
      <sec id="Sec26">
        <title>Perfect phylogeny</title>
        <p>We first compared SCITE against a simple algorithm for solving the perfect phylogeny problem (i.e. testing whether the data defines a phylogeny, and if it does to construct one [<xref ref-type="bibr" rid="CR12">12</xref>]). A mutation matrix has a perfect phylogeny if a tree can be constructed such that the leaves are the samples and the mutations are each placed at exactly one edge, such that for every leaf the mutations on the path leading to it from the root reflect its mutation status. Such a tree exists only if there are no contradictions in the data due to noise or recurring mutations. But if it exists, it can be represented as a mutation tree by labeling nodes instead of edges. To test for perfect phylogeny, we use a version of the data with no missing values. From our simulated trees and data, only very few are free of contradictions, which limits the tree comparison to a few instances. The perfect phylogenies on average deviate more from the true tree than both ML and MAP trees and none is found for instances with more than 45 samples. The differences between the perfect phylogeny and the true tree are due to both the errors introduced and insufficient information to fully reconstruct the tree. Details of the comparison are given in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1.</p>
      </sec>
      <sec id="Sec27">
        <title>The approach of Kim and Simon [<xref ref-type="bibr" rid="CR34">34</xref>]</title>
        <p>The method in [<xref ref-type="bibr" rid="CR34">34</xref>] reconstructs the same type of mutation trees as our approach. However, in their approach, a parameter representing how quickly the mutation tree branches is first learned from the data. This parameter is then used to calculate the prior probability of ancestral relations, which informs a pairwise ordering test and subsequent tree reconstruction. Instead of learning the parameter from the data, we give their method the exact value from the tree that was actually used to generate the data since this simplifies running the simulation test. Of course, in practice, this piece of information would not be available so the results from their algorithm are over optimistic. Nevertheless, the pairwise approximation performs comparatively poorly (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). In particular, there is little improvement as the number of samples increases. Although the pairwise ancestral tests will become more accurate, this additional information appears to have little impact on the conversion to a mutation tree.</p>
      </sec>
      <sec id="Sec28">
        <title>Comparison with BitPhylogeny</title>
        <p>More advanced probabilistic inference is provided by BitPhylogeny [<xref ref-type="bibr" rid="CR33">33</xref>]. This method, however, reconstructs a hierarchical subclone structure rather than a mutation tree thereby precluding a direct comparison to SCITE and the approach of [<xref ref-type="bibr" rid="CR34">34</xref>]. Therefore, we convert the outcome of each method into a complete mutation tree with samples attached. For SCITE, this means finding the ML tree with attachments. For the approach of [<xref ref-type="bibr" rid="CR34">34</xref>], we place the samples at their best fitting position on the tree found. For BitPhylogeny instead, we place the mutations along the branches of their clonal tree in the position that maximizes the likelihood. Since the mutations and samples may be grouped together, as a measure of fit we use the consensus node-based shortest path distance (as defined in [<xref ref-type="bibr" rid="CR33">33</xref>]) between the (completed) inferred tree and the generating tree. In particular, for each tree, the pairwise shortest distance between any two samples is their number of differing mutations. We then normalize by averaging over the absolute differences between the pairwise distances in the inferred and generating trees, rather than taking the sum.</p>
        <p>For <italic>n</italic>=20, <italic>α</italic>=10<sup>−5</sup>, and <italic>β</italic>=0.1 (with the same misspecification as before), we generated 400 such trees with 1 % missing data. For simplicity and giving BitPhylogeny a slight advantage, we passed it the complete data. The results for <italic>m</italic>∈{40,60,80} are presented in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. The methods compared perform significantly more poorly than SCITE, with BitPhylogeny [<xref ref-type="bibr" rid="CR33">33</xref>] performing better than the algorithm of [<xref ref-type="bibr" rid="CR34">34</xref>], but with neither approaching the performance of SCITE.
<fig id="Fig7"><label>Fig. 7</label><caption><p>Comparison of additional methods. Comparison of the tree inference of SCITE, the algorithm of [<xref ref-type="bibr" rid="CR34">34</xref>], BitPhylogeny [<xref ref-type="bibr" rid="CR33">33</xref>], PhyloWGS [<xref ref-type="bibr" rid="CR24">24</xref>], and AncesTree [<xref ref-type="bibr" rid="CR22">22</xref>]. The quantity <italic>Δd</italic> is the normalized consensus node-based shortest path distance (as defined in [<xref ref-type="bibr" rid="CR33">33</xref>]) between the inferred and generating trees. <italic>AT</italic> AncesTree, <italic>BP</italic> BitPhylogeny, <italic>KS</italic> Kim and Simon [<xref ref-type="bibr" rid="CR34">34</xref>], <italic>PW</italic> PhyloWGS</p></caption><graphic xlink:href="13059_2016_936_Fig7_HTML" id="MO7"/></fig></p>
        <p>We can also compare the performance of the different methods in terms of the difference in log-likelihoods between the inferred and generating trees, normalized by dividing by the number of data matrix elements (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12). This shows similar behavior to Fig. <xref rid="Fig7" ref-type="fig">7</xref> and we observe that SCITE always provides a non-negative difference. SCITE, therefore, always found either the generating tree or one with a slightly higher likelihood than the generating tree.</p>
      </sec>
      <sec id="Sec29">
        <title>Comparison with bulk-sequencing methods</title>
        <p>Finally, we compared SCITE to methods designed for deconvolution and tree reconstruction from mixed bulk sequences. We chose PhyloWGS [<xref ref-type="bibr" rid="CR24">24</xref>] and AncesTree [<xref ref-type="bibr" rid="CR22">22</xref>] as two recent high-performing methods that allow samples to be treated separately as well as combined. PhyloWGS employs a stick-breaking tree prior (like BitPhylogeny) while AncesTree solves the deconvolution and ancestry as a matrix factorization. When passing the simulated single-cell mutations as individual samples to both methods, neither returned anything other than a single grouping of mutations. A possible explanation for this result is that the two methods interpret the binary mutation states as cellular prevalence in mixed samples, which likely causes trouble in the deconvolution step. Better performance was obtained when combining the single cells into a bulk mixture, with both methods returning mutation trees with the mutations possibly grouped together at the nodes. To compare with the other methods, we again placed the samples at their best positions in the inferred trees to obtain the results in Fig. <xref rid="Fig7" ref-type="fig">7</xref>. AncesTree performs slightly worse than PhyloWGS and both are notably worse than BitPhylogeny and SCITE. This is not unexpected, as only the latter two are designed to handle single-cell data. The main conclusion here is that specialized methods are necessary for single-cell data as approaches for mixed samples are not readily applicable.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec30" sec-type="conclusion">
    <title>Conclusions</title>
    <p>Single-cell sequencing data is giving unprecedented insights into intra-tumor heterogeneity, a major obstacle to permanent remission in cancer treatment. In this paper, we introduced SCITE, a likelihood-based reconstruction of tumor genealogies from noisy and incomplete mutation profiles of single cells. The approach provides a flexible MCMC sampling scheme that allows us to either find the best fitting tree or sample from the posterior distribution, and it can be combined with learning the error rates of the sequencing experiments. We have shown that the probability model underlying SCITE is highly adaptable. It performs well in the presence of various types of noise, including types that were not explicitly modeled, such as doublet samples (the inadvertent sequencing of two instead of a single cell). The model also lends itself to some straightforward extensions, such as the incorporation of position-specific error rates, or the introduction of further mutation and error types that would maintain the independence of genome positions. Besides its flexibility, the key advantage of SCITE is its linear scaling with the number of samples. While this feature is negligible for present data sets, it will become essential as soon as hundreds or even thousands of cells of a tumor are routinely sequenced.</p>
    <p>Using SCITE, we reconstructed the monoclonal origin of an ET tumor and a clear-cell renal-cell carcinoma, as well as a complex subclonal structure in an ER <sup>+</sup> breast cancer. The consistency of SCITE is shown in simulation studies, which we also used to estimate the number of cells necessary to obtain reliable tree reconstructions, a piece of information that could be useful in the design of future sequencing experiments.</p>
    <p>SCITE differs from earlier approaches, in particular BitPhylogeny [<xref ref-type="bibr" rid="CR33">33</xref>], in its use of single cells as taxonomic units, giving it the highest possible resolution in the tree reconstruction. Because each cell provides information about all the mutations, and all this detail is used, this approach allows a more robust reconstruction of the mutation tree. This in turn aids the identification of driver mutations. The placement of the individual cells is, however, less certain. Clustering cells into clones instead, as done in BitPhylogeny [<xref ref-type="bibr" rid="CR33">33</xref>], and placing these as the taxa means we can use the consensus of single-cell information in each clone to deduce more robustly the ancestral relationships between the clones themselves, but at the expense of reduced accuracy in the reconstruction of the mutational history.</p>
    <p>Further improvements in tree reconstruction could be achieved by considering copy number alterations along with point mutations. For one, copy number information could be used to understand point mutations states better, e.g. a seemingly homozygous mutation may in fact be loss of heterozygosity, but more importantly it can be used as a feature in tree reconstruction itself, as has been done previously for bulk-sequencing data [<xref ref-type="bibr" rid="CR24">24</xref>]. The main challenges here will be that for large-scale copy number events, the independence of mutation sites is no longer given, and that the infinite sites assumption would no longer hold.</p>
    <p>The knowledge of individual mutation histories is a promising source of information for personalized cancer treatment. Once single-cell sequencing has become more prevalent, the unprecedented resolution of mutation histories reconstructed from single cells will likely be valuable in many more respects. One direction is the identification of recurrent mutation patterns by comparing high-resolution mutation trees from patients with the same and/or different tumor types. Another direction could be to combine single-cell data from different time points and different locations in the tumor to obtain a better understanding of the temporal and spatial organization of subclonal populations of tumor cells, again at a higher resolution than would be possible with bulk-sequencing data. When sampling cells from the primary tumor and metastasis, the attachment point of metastatic cells to the mutation tree could help to answer the open question of whether subclones with the potential to metastasize arise early or late in tumor development.</p>
  </sec>
  <sec id="Sec31">
    <title>Methods</title>
    <sec id="Sec32">
      <title>Mutation trees</title>
      <p>In SCITE, we represent a rooted mutation tree <italic>T</italic> over <italic>n</italic> mutations as an augmented ancestor matrix <italic>A</italic>(<italic>T</italic>) where every node is considered an ancestor of itself: 
<disp-formula id="Equ9"><label>(9)</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ A_{ik} = \left\{\begin{array}{ll} 1, &amp;\text{if \(i=k\) or \textit{i} is an ancestor of \textit{k}}, \\ 0, &amp;\text{elsewise}. \end{array}\right.  $$ \end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mtext>or</mml:mtext><mml:mtext mathvariant="italic">i</mml:mtext><mml:mtext>is an ancestor of</mml:mtext><mml:mtext mathvariant="italic">k</mml:mtext><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext>elsewise</mml:mtext><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2016_936_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>For example, the augmented ancestor matrix for the tree in Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">d</xref>, reduced to the mutation matrix given in <xref rid="Equ1" ref-type="">1</xref> is 
<disp-formula id="Equ10"><label>(10)</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \begin{aligned} &amp;\qquad \qquad \quad M_{1} \quad M_{2} \quad M_{3} \quad R \\ &amp;A= \begin{array}{c} M_{1}\\ M_{2}\\ M_{3} \end{array} \left(\begin{array}{cccc} \,\, 1 &amp; \,\, \quad 0 &amp; \,\, \quad 0 &amp; \,\, \quad 0 \\ \,\, 0 &amp; \,\, \quad 1 &amp; \,\, \quad 1 &amp; \,\, \quad 0 \\ \,\, 0 &amp; \,\, \quad 0 &amp; \,\, \quad 1 &amp; \,\, \quad 0 \end{array}\right), \end{aligned}  $$ \end{document}</tex-math><mml:math id="M22"><mml:mtable><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mspace width="1em"/><mml:mi>R</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="1em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="1em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="1em"/><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mspace width="0.3em"/><mml:mspace width="0.3em"/><mml:mspace width="1em"/><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_936_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>where <italic>R</italic> represents the root of the mutation tree. The cells are attached to <italic>T</italic> such that the path to the root spells out their mutation status. This placement is denoted by a vector <bold><italic>σ</italic></bold>, which records at the <italic>j</italic>th position the attachment point of sample <italic>j</italic>. Carrying on the example from Eq. <xref rid="Equ1" ref-type="">1</xref> and Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">d</xref>, we have <bold><italic>σ</italic></bold>=(1,1,1,4,3,3,2) where 4 represents the root. The connection between the mutation matrix and the mutation tree is 
<disp-formula id="Equ11"><label>(11)</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ (E_{ij} | T,\boldsymbol{\sigma}) = A(T)_{i\boldsymbol{\sigma}_{j}}.  $$ \end{document}</tex-math><mml:math id="M24"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2016_936_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>This simply means that for a given tree and sample attachment, the mutation status of a sample is identical to the one observed in the node where the sample attaches to the tree. Therefore, the likelihood in Eq. <xref rid="Equ3" ref-type="">3</xref> can be rewritten as 
<disp-formula id="Equ12"><label>(12)</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  P(D| T,\boldsymbol{\sigma},\boldsymbol{\theta}) =\prod_{i=1}^{n}\prod_{j=1}^{m} P(D_{ij} | A(T)_{i\boldsymbol{\sigma}_{j}})  $$ \end{document}</tex-math><mml:math id="M26"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math><graphic xlink:href="13059_2016_936_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>and thereby computed directly from <italic>T</italic> and <bold><italic>σ</italic></bold>.</p>
    </sec>
    <sec id="Sec33">
      <title>MCMC sampling</title>
      <p>In principle, the MCMC of SCITE needs three types of moves to separately alter the tree <italic>T</italic>, the attachment vector <bold><italic>σ</italic></bold>, and the error rates. In fact, it is possible to marginalize out the <bold><italic>σ</italic></bold> component, such that we only need to consider moves in the joint (<italic>T</italic>,<bold><italic>θ</italic></bold>) space. We first focus on the marginalization and then describe the remaining move types.</p>
      <sec id="Sec34">
        <title>Marginalization of the sample attachment</title>
        <p>A move where we pick a sample and a new parent for it uniformly would satisfy the necessary properties for the MCMC chain on <bold><italic>σ</italic></bold> to converge, but we can achieve convergence much faster. This is because the likelihood in Eq. <xref rid="Equ12" ref-type="">12</xref> factorizes into a product for each sample to be attached. As long as the prior <italic>P</italic>(<bold><italic>σ</italic></bold>|<italic>T</italic>,<bold><italic>θ</italic></bold>) can also be factorized (so that the attachment for each sample is independent of the others), we can include the priors as in Eq. <xref rid="Equ4" ref-type="">4</xref> and efficiently sum Eq. <xref rid="Equ12" ref-type="">12</xref> over <bold><italic>σ</italic></bold> to marginalize it out: 
<disp-formula id="Equ13"><label>(13)</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{*{20}l}  \frac{P(T,\boldsymbol{\theta} | D)}{P(T,\boldsymbol{\theta})} &amp;\propto \sum_{\boldsymbol{\sigma}} \prod_{j=1}^{m} \left[\prod_{i=1}^{n} P(D_{ij} | A(T)_{i\boldsymbol{\sigma}_{j}})\right] P(\boldsymbol{\sigma}_{j} | T,\boldsymbol{\theta}) \\ &amp;= \prod_{j=1}^{m} \sum_{\boldsymbol{\sigma}_{j} =1}^{n+1} \left[\prod_{i=1}^{n} P(D_{ij} | A(T)_{i\boldsymbol{\sigma}_{j}})\right] P(\boldsymbol{\sigma}_{j} | T,\boldsymbol{\theta}).  \end{array} $$ \end{document}</tex-math><mml:math id="M28"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mtd><mml:mtd class="align-2"><mml:mo>∝</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:munder><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2016_936_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>Computation of Eq. <xref rid="Equ13" ref-type="">13</xref> is in <italic>O</italic>(<italic>mn</italic>) time due to the tree structure underlying <italic>A</italic>(<italic>T</italic>). Along with efficient computation of Eq. <xref rid="Equ13" ref-type="">13</xref>, we now need only search over the (<italic>n</italic>+1)<sup><italic>m</italic></sup> times smaller space of trees <italic>T</italic> and error rates <bold><italic>θ</italic></bold> leading to much faster MCMC convergence. This marginalization is equivalent to grouping all attachments to the same tree into a single object, which is responsible for the similarly large speed-up for sampling Bayesian networks in order MCMC [<xref ref-type="bibr" rid="CR38">38</xref>] and more recently partition MCMC [<xref ref-type="bibr" rid="CR39">39</xref>]. Analogously, nested effect models average over all effects with uniform prior [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
        <p>With the attachments marginalized out, we need to consider only moves in the joint (<italic>T</italic>,<bold><italic>θ</italic></bold>) space. We can change one component at a time to propose a new pair (<italic>T</italic><sup>′</sup>,<bold><italic>θ</italic></bold><sup>′</sup>) with transition probabilities <italic>q</italic>(<italic>T</italic><sup>′</sup>,<bold><italic>θ</italic></bold><sup>′</sup>|<italic>T</italic>,<bold><italic>θ</italic></bold>) and accepting moves with the ratio 
<disp-formula id="Equ14"><label>(14)</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \rho = \min \left \{ 1, \frac{q(T,\boldsymbol{\theta} | T',\boldsymbol{\theta}') P(T',\boldsymbol{\theta}' | D)}{q(T',\boldsymbol{\theta}'| T,\boldsymbol{\theta}) P(T,\boldsymbol{\theta} | D)} \right \}  $$ \end{document}</tex-math><mml:math id="M30"><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mo>min</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2016_936_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula></p>
        <p>to sample proportionally to <italic>P</italic>(<italic>T</italic>,<bold><italic>θ</italic></bold>|<italic>D</italic>). Once we have sampled a tree, we can easily sample each attachment independently following Eq. <xref rid="Equ13" ref-type="">13</xref>.</p>
      </sec>
      <sec id="Sec35">
        <title>Tree moves</title>
        <p>Akin to standard MCMC approaches on graphical structures [<xref ref-type="bibr" rid="CR41">41</xref>], we build a scheme on rooted mutation trees for fixed errors <bold><italic>θ</italic></bold> as follows. Given the current tree <italic>T</italic>, we find the neighborhood of all trees reachable with the MCMC move from <italic>T</italic>. One then samples a tree <italic>T</italic><sup>′</sup> from this neighborhood with some proposal probability <italic>q</italic>(<italic>T</italic><sup>′</sup>,<bold><italic>θ</italic></bold>|<italic>T</italic>,<bold><italic>θ</italic></bold>) and accepts the move with the probability in Eq. <xref rid="Equ14" ref-type="">14</xref>.</p>
        <p>As long as the moves satisfy reversibility (that is, if the move from <italic>T</italic> to <italic>T</italic><sup>′</sup> can be proposed with a non-zero probability, the reverse move from <italic>T</italic><sup>′</sup> to <italic>T</italic> also has non-zero probability to be proposed), irreducibility (that is, a sequence of moves exists that leads from any tree to any other), and aperiodicity (which can be ensured by including the tree <italic>T</italic> in its neighborhood or adding a non-zero probability not to move), once the chain converges this scheme would allow us to sample trees proportionally to <italic>P</italic>(<italic>T</italic>,<bold><italic>θ</italic></bold>|<italic>D</italic>).</p>
        <p>The basic MCMC move we use is <italic>prune and reattach</italic>. We sample a node <italic>i</italic> uniformly from the <italic>n</italic> available and cut the edge leading to this node to remove the subtree from the tree. Then we sample one of the remaining nodes (including the root) uniformly and attach the subtree there instead. An example is illustrated in Fig. <xref rid="Fig8" ref-type="fig">8</xref>.
<fig id="Fig8"><label>Fig. 8</label><caption><p>Prune and reattach MCMC move. <bold>a</bold> From our starting tree <italic>T</italic>, we first select a node uniformly, here <italic>M</italic>
<sub>5</sub>, and detach it from the rest of the tree. <bold>b</bold> Then we sample one of the remaining nodes in the rooted tree; here <italic>M</italic>
<sub>2</sub> is chosen. <bold>c</bold> Finally, we attach the detached subtree formed of <italic>M</italic>
<sub>5</sub> and its descendants to the newly selected node <italic>M</italic>
<sub>2</sub>
</p></caption><graphic xlink:href="13059_2016_936_Fig8_HTML" id="MO8"/></fig></p>
        <p>The reverse move, where we again sample <italic>i</italic> first but then pick its old parent, has the same proposal probability <italic>q</italic>(<italic>T</italic>,<bold><italic>θ</italic></bold>|<italic>T</italic><sup>′</sup>,<bold><italic>θ</italic></bold>)=<italic>q</italic>(<italic>T</italic><sup>′</sup>,<bold><italic>θ</italic></bold>|<italic>T</italic>,<bold><italic>θ</italic></bold>) since the non-descendant set has the same size each time <italic>i</italic> is removed. This term then drops from Eq. <xref rid="Equ14" ref-type="">14</xref> and need not be calculated. Since we can also choose the old parent when sampling a new one, this move has a non-zero probability of proposing the same tree <italic>T</italic>, ensuring aperiodicity. There is also a path from any tree to a tree with all nodes attached to the root, by moving each node to the root step by step. Via reversibility, we can likewise move from there to any other tree ensuring irreducibility. The <italic>prune and reattach</italic> move, therefore, suffices to sample trees according to their posterior. To speed up the convergence of the chain, we use two additional moves in our MCMC scheme: <italic>swap nodes</italic> to swap the labels of two nodes and <italic>swap subtrees</italic> to swap two subtrees. (See Additional file <xref rid="MOESM1" ref-type="media">1</xref> for more details.) One of the three moves is picked at each step of the chain with a fixed probability.</p>
      </sec>
      <sec id="Sec36">
        <title>Error learning</title>
        <p>Where estimates of the error rates are known, we can input this information into the prior <italic>P</italic>(<bold><italic>θ</italic></bold>). Since <bold><italic>θ</italic></bold> is between 0 and 1, we choose a beta prior with mean equal to the known estimates and a large standard deviation to be weakly informative. Although for a given (<italic>T</italic>,<bold><italic>σ</italic></bold>) we can marginalize out <bold><italic>θ</italic></bold> analytically, this interferes with the speed-up in Eq. <xref rid="Equ13" ref-type="">13</xref>. Instead, to move in the error space, we choose a simple Gaussian random walk with fixed standard deviations in each direction and centered on the current value <bold><italic>θ</italic></bold>.</p>
      </sec>
    </sec>
    <sec id="Sec37">
      <title>Maximum likelihood tree</title>
      <p>Along with utilizing our MCMC scheme to perform fully Bayesian tree inference, we can adapt the method to search for the ML tree as well. In the ML framework, we consider the full space of trees with attachments (<italic>T</italic>,<bold><italic>σ</italic></bold>) and find the best scoring pair, rather than summing over the attachment points. Keeping the error rates <bold><italic>θ</italic></bold> fixed for simplicity, when we wish to search for the ML tree with attachments, after maximizing over all possible placements, we can define the following score for each tree: 
<disp-formula id="Equ15"><label>(15)</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ S(T) = P(D| T,\boldsymbol{\sigma}^{*}) \,, \qquad \boldsymbol{\sigma}^{*} = \text{arg} \max_{\boldsymbol{\sigma}} P(D| T,\boldsymbol{\sigma}).  $$ \end{document}</tex-math><mml:math id="M32"><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>)</mml:mo><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2016_936_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>Since the likelihood in Eq. <xref rid="Equ12" ref-type="">12</xref> factorizes, we can find the best attachment for each sample independently of the others, 
<disp-formula id="Equ16"><label>(16)</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \boldsymbol{\sigma}^{*}_{j} =\text{arg} \max_{k} \prod_{i=1}^{n} P(D_{ij} | A(T)_{ik}),  $$ \end{document}</tex-math><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2016_936_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>by running over the columns of <italic>A</italic>(<italic>T</italic>) and comparing to the observed data with the error rates as in Eq. <xref rid="Equ2" ref-type="">2</xref>. If several placements provide the same maximum, any may be selected for calculating <italic>S</italic>(<italic>T</italic>), which is then 
<disp-formula id="Equ17"><label>(17)</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  S(T) = \max_{\boldsymbol{\sigma}} P(D| T,\boldsymbol{\sigma})  $$ \end{document}</tex-math><mml:math id="M36"><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>)</mml:mo></mml:math><graphic xlink:href="13059_2016_936_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>and which again involves only <italic>O</italic>(<italic>mn</italic>) simple operations.</p>
      <p>Now we can turn our attention to finding the ML tree: 
<disp-formula id="Equ18"><label>(18)</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ T^{*} = \text{arg} \max_{T} S(T),  $$ \end{document}</tex-math><mml:math id="M38"><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2016_936_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>which because of Eq. <xref rid="Equ17" ref-type="">17</xref> is the tree that maximizes the likelihood in Eq. <xref rid="Equ12" ref-type="">12</xref>. The number of rooted trees with (<italic>n</italic>+1) nodes (including the root) grows factorially so an exhaustive search becomes infeasible for more than ten nodes or so.</p>
      <p>Instead we can reuse our MCMC scheme on the space of rooted mutation trees where given the current tree <italic>T</italic> we propose a tree <italic>T</italic><sup>′</sup> according to one of the three move types with the same proposal probability <italic>q</italic>(<italic>T</italic><sup>′</sup>|<italic>T</italic>) but now accept the move with probability 
<disp-formula id="Equ19"><label>(19)</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  \rho = \min \left \{ 1, \frac{q(T | T') S(T')^{\gamma} }{q(T'| T) S(T)^{\gamma}} \right \}.  $$ \end{document}</tex-math><mml:math id="M40"><mml:mi>ρ</mml:mi><mml:mo>=</mml:mo><mml:mo>min</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mi>S</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mi>S</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>γ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:math><graphic xlink:href="13059_2016_936_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula></p>
      <p>The power of <italic>γ</italic> here is a way to flatten the distribution (for <italic>γ</italic>&lt;1) or make it more pronounced (for <italic>γ</italic>&gt;1). Simulated annealing would involve running the chain while simultaneously increasing <italic>γ</italic>→<italic>∞</italic> to end up in a local maximum. Here, instead, we chose a value (depending on the data) for this parameter that allows fast discovery of the maximally scoring tree and simply run many chains, recording the maximally scoring tree we encounter.</p>
      <p>In the Bayesian framework, we can search for the MAP tree. Including the prior on all discrete components and updating <italic>S</italic>(<italic>T</italic>) accordingly, we would find the joint MAP tree and attachments with the scheme here. Averaging out the attachments instead, we can search just for the MAP tree as well. In particular, we replace <italic>S</italic>(<italic>T</italic>) by <italic>P</italic>(<italic>T</italic>,<bold><italic>θ</italic></bold>|<italic>D</italic>) in Eq. <xref rid="Equ19" ref-type="">19</xref>. We can also find jointly maximal trees and error rates by putting the error moves back in.</p>
      <sec id="Sec38">
        <title>Alternative representation for ML discovery</title>
        <p>For the ML tree with attachments, since the optimal placement for each attachment can be easily found, we are left to search over all rooted trees with (<italic>n</italic>+1) nodes. However, when <italic>m</italic>≲<italic>n</italic>, we may return to the binary genealogical tree (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">b</xref>) with <italic>m</italic> sampled cells as leaves and (<italic>m</italic>−1) internal binary divides. The mutations are placed along the edges and they are present in all cells further down that lineage. For a given genealogical tree with leaves, the optimal placement of every mutation along the edges is simple to compute. Each tree is assigned a score corresponding to the likelihood of the data given the optimal placement of the mutations, which can again be calculated in <italic>O</italic>(<italic>mn</italic>) time. The binary tree with the highest score is then the ML binary genealogical tree that directly provides the ML mutation tree with attachments when we change the representation back to mutations trees (Fig. <xref rid="Fig1" ref-type="fig">1</xref><xref rid="Fig1" ref-type="fig">f</xref>).</p>
        <p>We can search the binary tree space with analogous moves as for the mutation trees. A <italic>prune and reattach</italic> move can be performed by detaching one half of any internal binary divide (the remaining neighboring edges join together) and reinserting it into any of the edges then present. We can also <italic>swap leaf labels</italic>. The size of the relevant binary tree space is 
<disp-formula id="Equb"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\frac{m!(m-1)!}{2^{m-1}}, $$ \end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo>!</mml:mo><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2016_936_Article_Equb.gif" position="anchor"/></alternatives></disp-formula> which may be smaller than the mutation tree space of (<italic>n</italic>+1)<sup>(<italic>n</italic>−1)</sup>, or easier to search, allowing the ML tree to be discovered more quickly. This alternative representation is implemented in the SCITE software package.</p>
        <p>In the binary tree space, one can further marginalize, but this is over the mutation placement rather than the sample attachments and the resulting posterior distribution does not translate directly into one over the mutation tree space.</p>
      </sec>
    </sec>
    <sec id="Sec39">
      <title>Software availability</title>
      <p>SCITE has been implemented in C/C++ and is freely available under a GPL3 license at <ext-link ext-link-type="uri" xlink:href="https://github.com/cbg-ethz/SCITE">https://github.com/cbg-ethz/SCITE</ext-link>.</p>
    </sec>
  </sec>
  <sec id="Sec40">
    <title>Availability of data and materials</title>
    <p>The published data sets analyzed are available from the supplementary material of [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR35">35</xref>] and in Fig. 2f of [<xref ref-type="bibr" rid="CR36">36</xref>]. The data matrices are also included with SCITE.</p>
  </sec>
  <sec id="Sec41">
    <title>Ethics approval</title>
    <p>Ethics approval is not applicable for this study.</p>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec42">
        <title>Additional file</title>
        <p>
          <media position="anchor" xlink:href="13059_2016_936_MOESM1_ESM.pdf" id="MOESM1">
            <label>Additional file 1</label>
            <caption>
              <p>Supplementary figures, a supplementary table, and a description of the additional MCMC moves and their effect on convergence. (PDF 970 kb)</p>
            </caption>
          </media>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p>This paper was selected for oral presentation at RECOMB 2016 and an abstract is published in the conference proceedings</p>
    </fn>
    <fn>
      <p>
        <bold>Competing interests</bold>
      </p>
      <p>The authors declare that they have no competing interests.</p>
    </fn>
    <fn>
      <p>
        <bold>Authors’ contributions</bold>
      </p>
      <p>KJ and JK designed and implemented the method. KJ, JK, and NB wrote the manuscript. All authors read and approved the final manuscript.</p>
    </fn>
    <fn>
      <p>
        <bold>Funding</bold>
      </p>
      <p>KJ was supported by SystemsX.ch RTD Grant 2013/150 (<ext-link ext-link-type="uri" xlink:href="http://www.systemsx.ch/">http://www.systemsx.ch/</ext-link>). JK was supported by ERC Synergy Grant 609883 (<ext-link ext-link-type="uri" xlink:href="http://erc.europa.eu/">http://erc.europa.eu/</ext-link>).</p>
    </fn>
  </fn-group>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nowell</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>The clonal evolution of tumor cell populations</article-title>
        <source>Science</source>
        <year>1976</year>
        <volume>194</volume>
        <fpage>23</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1126/science.959840</pub-id>
        <?supplied-pmid 959840?>
        <pub-id pub-id-type="pmid">959840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Merlo</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Pepper</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Maley</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Cancer as an evolutionary and ecological process</article-title>
        <source>Nat Rev Cancer</source>
        <year>2006</year>
        <volume>6</volume>
        <fpage>924</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1038/nrc2013</pub-id>
        <?supplied-pmid 17109012?>
        <pub-id pub-id-type="pmid">17109012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pepper</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Scott Findlay</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kassen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Spencer</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Maley</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Synthesis: cancer research meets evolutionary biology</article-title>
        <source>Evol Appl</source>
        <year>2009</year>
        <volume>2</volume>
        <fpage>62</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1752-4571.2008.00063.x</pub-id>
        <?supplied-pmid 25567847?>
        <pub-id pub-id-type="pmid">25567847</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Van Loo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Greenman</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Raine</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ramakrishna</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The life history of 21 breast cancers</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>149</volume>
        <fpage>994</fpage>
        <lpage>1007</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.04.023</pub-id>
        <?supplied-pmid 22608083?>
        <pub-id pub-id-type="pmid">22608083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yates</surname>
            <given-names>LR</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Evolution of the cancer genome</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>795</fpage>
        <lpage>806</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3317</pub-id>
        <?supplied-pmid 23044827?>
        <pub-id pub-id-type="pmid">23044827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greaves</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maley</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Clonal evolution in cancer</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>481</volume>
        <fpage>306</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10762</pub-id>
        <?supplied-pmid 22258609?>
        <pub-id pub-id-type="pmid">22258609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Ritchey</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Lamprecht</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>McLellan</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clonal evolution in relapsed acute myeloid leukaemia revealed by whole-genome sequencing</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>481</volume>
        <fpage>506</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10738</pub-id>
        <?supplied-pmid 22237025?>
        <pub-id pub-id-type="pmid">22237025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gillies</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Verduzco</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gatenby</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary dynamics of carcinogenesis and why targeted therapy does not work</article-title>
        <source>Nat Rev Cancer</source>
        <year>2012</year>
        <volume>12</volume>
        <fpage>487</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1038/nrc3298</pub-id>
        <?supplied-pmid 22695393?>
        <pub-id pub-id-type="pmid">22695393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ortmann</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Nangalia</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Silber</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Grinfeld</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baxter</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>Massie</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Papaemmanuil</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Effect of mutation order on myeloproliferative neoplasms</article-title>
        <source>N Engl J Med</source>
        <year>2015</year>
        <volume>372</volume>
        <fpage>601</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa1412098</pub-id>
        <?supplied-pmid 25671252?>
        <pub-id pub-id-type="pmid">25671252</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stratton</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Futreal</surname>
            <given-names>PA</given-names>
          </name>
        </person-group>
        <article-title>The cancer genome</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>458</volume>
        <fpage>719</fpage>
        <lpage>24</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07943</pub-id>
        <?supplied-pmid 19360079?>
        <pub-id pub-id-type="pmid">19360079</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swanton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Intratumor heterogeneity: evolution through space and time</article-title>
        <source>Cancer Res</source>
        <year>2012</year>
        <volume>72</volume>
        <fpage>4875</fpage>
        <lpage>82</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-12-2217</pub-id>
        <?supplied-pmid 23002210?>
        <pub-id pub-id-type="pmid">23002210</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gusfield</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <source>Algorithms on strings, trees and sequences: computer science and computational biology</source>
        <year>1997</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Navin</surname>
            <given-names>NE</given-names>
          </name>
        </person-group>
        <article-title>Cancer genomics: one cell at a time</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>452</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0452-9</pub-id>
        <?supplied-pmid 25222669?>
        <pub-id pub-id-type="pmid">25222669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerstung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Beisel</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rechsteiner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wild</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Schraml</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Moch</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Reliable detection of subclonal single-nucleotide variants in tumour cell populations</article-title>
        <source>Nat Commun</source>
        <year>2012</year>
        <volume>3</volume>
        <fpage>811</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms1814</pub-id>
        <?supplied-pmid 22549840?>
        <pub-id pub-id-type="pmid">22549840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Goya</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Oloumi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Turashvili</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tse</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Haffari</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The clonal and mutational evolution spectrum of primary triple-negative breast cancers</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>486</volume>
        <fpage>395</fpage>
        <lpage>9</lpage>
        <?supplied-pmid 22495314?>
        <pub-id pub-id-type="pmid">22495314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khattra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Biele</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ha</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bouchard-Côté</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Pyclone: statistical inference of clonal population structure in cancer</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <fpage>396</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2883</pub-id>
        <?supplied-pmid 24633410?>
        <pub-id pub-id-type="pmid">24633410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ha</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khattra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ho</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Prentice</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Melnyk</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bashashati</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Titan: inference of copy number architectures in clonal cell populations from tumor whole-genome sequence data</article-title>
        <source>Genome Res</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>1881</fpage>
        <lpage>93</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.180281.114</pub-id>
        <?supplied-pmid 25060187?>
        <pub-id pub-id-type="pmid">25060187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oesper</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mahmoody</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Theta: inferring intra-tumor heterogeneity from high-throughput dna sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>80</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-7-r80</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zare</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nickerson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Blau</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Inferring clonal composition from multiple sections of a breast cancer</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>003703</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strino</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Parisi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Micsinai</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kluger</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Trap: a tree approach for fingerprinting subclonal tumor composition</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <fpage>165</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt641</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hajirasouliha</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mahmoody</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>A combinatorial approach for analyzing intra-tumor heterogeneity from high-throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>78</fpage>
        <lpage>86</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu284</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>El-Kebir</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Oesper</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Acheson-Field</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Reconstruction of clonal trees and tumor composition from multi-sample sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>62</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv261</pub-id>
        <pub-id pub-id-type="pmid">25165092</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Quinlan</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Jazaeri</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Verhaak</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>Subcloneseeker: a computational framework for reconstructing tumor clone structure for cancer variant interpretation and prioritization</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>443</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0443-x</pub-id>
        <?supplied-pmid 25160522?>
        <pub-id pub-id-type="pmid">25160522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deshwar</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Vembu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>PhyloWGS: Reconstructing subclonal composition and evolution from whole-genome sequencing of tumors</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>35</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0602-8</pub-id>
        <?supplied-pmid 25786235?>
        <pub-id pub-id-type="pmid">25786235</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Vembu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deshwar</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>
        <source>BMC Bioinform</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>35</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-35</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malikic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Donmez</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sahinalp</surname>
            <given-names>CS</given-names>
          </name>
        </person-group>
        <article-title>Clonality inference in multiple tumor samples using phylogeny</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>1349</fpage>
        <lpage>56</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv003</pub-id>
        <?supplied-pmid 25568283?>
        <pub-id pub-id-type="pmid">25568283</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Popic</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Salari</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hajirasouliha</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kashef-Haghighi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>West</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Fast and scalable inference of multi-sample cancer lineages</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>91</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0647-8</pub-id>
        <?supplied-pmid 25944252?>
        <pub-id pub-id-type="pmid">25944252</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schuh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Becq</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Humphray</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Alexa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Burns</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Clifford</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Feller</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Grocock</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Henderson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khrebtukova</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Monitoring chronic lymphocytic leukemia progression by whole genome sequencing reveals heterogeneous clonal evolution patterns</article-title>
        <source>Blood</source>
        <year>2012</year>
        <volume>120</volume>
        <fpage>4191</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2012-05-433540</pub-id>
        <?supplied-pmid 22915640?>
        <pub-id pub-id-type="pmid">22915640</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van Loo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Voet</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Single cell analysis of cancer genomes</article-title>
        <source>Curr Opinion Genet Dev</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>82</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gde.2013.12.004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shao</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell exome sequencing and monoclonal evolution of a JAK2-negative myeloproliferative neoplasm</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>148</volume>
        <fpage>873</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.02.028</pub-id>
        <?supplied-pmid 22385957?>
        <pub-id pub-id-type="pmid">22385957</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Eulenstein</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Fernandez-Baca</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sanderson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Minimum-flip supertrees: complexity and algorithms</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2006</year>
        <volume>3</volume>
        <fpage>165</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2006.26</pub-id>
        <?supplied-pmid 17048402?>
        <pub-id pub-id-type="pmid">17048402</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Gusfield</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Frid</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Integer programming formulations and computations solving phylogenetic and population genetic problems with missing or genotypic data</article-title>
        <source>Computing and combinatorics</source>
        <year>2007</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sakoparnig</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Markowetz</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>BitPhylogeny: a probabilistic framework for reconstructing intra-tumor phylogenies</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>36</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0592-6</pub-id>
        <?supplied-pmid 25786108?>
        <pub-id pub-id-type="pmid">25786108</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>KI</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Using single cell sequencing data to model the evolutionary history of a tumor</article-title>
        <source>BMC Bioinform</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>27</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-27</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Hou</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yin</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Bao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Tsang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell exome sequencing reveals single-nucleotide mutation characteristics of a kidney tumor</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>148</volume>
        <fpage>886</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.02.025</pub-id>
        <?supplied-pmid 22385958?>
        <pub-id pub-id-type="pmid">22385958</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Waters</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Unruh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roh</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Scheet</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Vattathil</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clonal evolution in breast cancer revealed by single nucleus genome sequencing</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>512</volume>
        <fpage>155</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13600</pub-id>
        <?supplied-pmid 25079324?>
        <pub-id pub-id-type="pmid">25079324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Moffa</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Uniform random generation of large acyclic digraphs</article-title>
        <source>Stat Comput</source>
        <year>2015</year>
        <volume>25</volume>
        <fpage>227</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1007/s11222-013-9428-y</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Friedman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Koller</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Being Bayesian about network structure. A Bayesian approach to structure discovery in Bayesian networks</article-title>
        <source>Mach Learn</source>
        <year>2003</year>
        <volume>50</volume>
        <fpage>95</fpage>
        <lpage>125</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1020249912095</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39</label>
      <mixed-citation publication-type="other">Kuipers J, Moffa G. Partition MCMC for inference on acyclic digraphs. J Am Stat Assoc. 2016. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.2015.1133426">http://dx.doi.org/10.1080/01621459.2015.1133426</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Markowetz</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kostka</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Troyanskaya</surname>
            <given-names>OG</given-names>
          </name>
          <name>
            <surname>Spang</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Nested effects models for high-dimensional phenotyping screens</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>305</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm178</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Madigan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>York</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Bayesian graphical models for discrete data</article-title>
        <source>Int Stat Rev</source>
        <year>1995</year>
        <volume>63</volume>
        <fpage>215</fpage>
        <lpage>32</lpage>
        <pub-id pub-id-type="doi">10.2307/1403615</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
