<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Acta Crystallogr D Biol Crystallogr</journal-id>
    <journal-id journal-id-type="publisher-id">Acta Cryst. D</journal-id>
    <journal-title-group>
      <journal-title>Acta Crystallographica Section D: Biological Crystallography</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0907-4449</issn>
    <issn pub-type="epub">1399-0047</issn>
    <publisher>
      <publisher-name>International Union of Crystallography</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3069754</article-id>
    <article-id pub-id-type="publisher-id">ba5165</article-id>
    <article-id pub-id-type="doi">10.1107/S0907444911007281</article-id>
    <article-id pub-id-type="coden">ABCRE6</article-id>
    <article-id pub-id-type="pii">S0907444911007281</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Papers</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Presenting your structures: the <italic>CCP</italic>4<italic>mg</italic> molecular-graphics software</article-title>
      <alt-title><italic>CCP</italic>4<italic>mg</italic></alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>McNicholas</surname>
          <given-names>S.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
        <xref ref-type="corresp" rid="cor">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Potterton</surname>
          <given-names>E.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wilson</surname>
          <given-names>K. S.</given-names>
        </name>
        <xref ref-type="aff" rid="a">a</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Noble</surname>
          <given-names>M. E. M.</given-names>
        </name>
        <xref ref-type="aff" rid="b">b</xref>
      </contrib>
      <aff id="a"><label>a</label>York Structural Biology Laboratory, Department of Chemistry, University of York, Heslington, York YO10 5DD, <country>England</country></aff>
      <aff id="b"><label>b</label>Department of Biochemistry, University of Oxford, South Parks Road, Oxford OX1 3QU, <country>England</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor">Correspondence e-mail: <email>mcnicholas@ysbl.york.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>4</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>3</month>
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>3</month>
      <year>2011</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>67</volume>
    <issue>Pt 4</issue>
    <issue-id pub-id-type="publisher-id">d110400</issue-id>
    <fpage>386</fpage>
    <lpage>394</lpage>
    <history>
      <date date-type="received">
        <day>04</day>
        <month>10</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>2</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© McNicholas et al. 2011</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0/uk/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original authors and source are cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:type="simple" xlink:href="http://dx.doi.org/10.1107/S0907444911007281">A full version of this article is available from Crystallography Journals Online.</self-uri>
    <abstract abstract-type="toc">
      <p>The <italic>CCP</italic>4 molecular-graphics program now uses the Qt framework to provide a modern look and feel. There are many new features including rendering for publication-quality images and sequence alignment.</p>
    </abstract>
    <abstract>
      <p><italic>CCP</italic>4<italic>mg</italic> is a molecular-graphics program that is designed to give rapid access to both straightforward and complex static and dynamic representations of macromolecular structures. It has recently been updated with a new interface that provides more sophisticated atom-selection options and a wizard to facilitate the generation of complex scenes. These scenes may contain a mixture of coordinate-derived and abstract graphical objects, including text objects, arbitrary vectors, geometric objects and imported images, which can enhance a picture and eliminate the need for subsequent editing. Scene descriptions can be saved to file and transferred to other molecules. Here, the substantially enhanced version 2 of the program, with a new underlying GUI toolkit, is described. A built-in rendering module produces publication-quality images.</p>
    </abstract>
    <kwd-group>
      <kwd><italic>CCP</italic>4<italic>mg</italic></kwd>
      <kwd>molecular graphics</kwd>
      <kwd>movies</kwd>
      <kwd>crystallographic software</kwd>
    </kwd-group>
    <conference>
      <conf-date/>
      <conf-name>Proceedings of the CCP4 study weekend</conf-name>
      <conf-loc/>
    </conference>
  </article-meta>
</front>
<body>
  <sec sec-type="" id="sec1">
    <label>1.</label>
    <title>Introduction</title>
    <p>Interactive molecular-graphics programs are central to the work performed by macromolecular crystallographers. <italic>CCP</italic>4<italic>mg</italic> has been developed as an easy-to-use yet flexible system for displaying the structure and structure-based properties of macromolecules (Potterton <italic>et al.</italic>, 2002<xref ref-type="bibr" rid="bb37"> ▶</xref>, 2004<xref ref-type="bibr" rid="bb39"> ▶</xref>). It is not the aim of this paper to provide a comprehensive review of the field of macromolecular graphics, but rather to describe the main features of <italic>CCP</italic>4<italic>mg</italic>. For the history of molecular graphics and the development of the many software packages, readers are directed to the excellent review by Lesk <italic>et al.</italic> (2008<xref ref-type="bibr" rid="bb33"> ▶</xref>). However, a brief survey of other molecular graphics helps to illustrate their broad utility in different areas of biomolecular science.</p>
    <p><italic>CCP</italic>4<italic>mg</italic> builds upon the ideas for representing macromolecular structures encoded in programs such as <italic>MolScript</italic> (Kraulis, 1991<xref ref-type="bibr" rid="bb26"> ▶</xref>) and its extended variant <italic>BobScript</italic> (Esnouf, 1999<italic>a</italic>
            <xref ref-type="bibr" rid="bb14"> ▶</xref>,<italic>b</italic>
            <xref ref-type="bibr" rid="bb15"> ▶</xref>), which both use the renderer <italic>Raster</italic>3<italic>D</italic> (Merritt &amp; Bacon, 1997<xref ref-type="bibr" rid="bb35"> ▶</xref>) to produce high-quality output. Further inspiration for <italic>CCP</italic>4<italic>mg</italic> is drawn from programs such as <italic>RIBBONS</italic> (Carson, 1997<xref ref-type="bibr" rid="bb4"> ▶</xref>), <italic>SPOCK</italic> (Christopher <italic>et al.</italic>, 1996<xref ref-type="bibr" rid="bb6"> ▶</xref>), <italic>DINO</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.dino3d.org/">http://www.dino3d.org/</ext-link>) and <italic>INSIGHT</italic> (Dayringer <italic>et al.</italic>, 1986<xref ref-type="bibr" rid="bb9"> ▶</xref>), all of which have contributed many ideas to how large structures should be visualized. <italic>MIDAS</italic> (Ferrin <italic>et al.</italic>, 1988<xref ref-type="bibr" rid="bb16"> ▶</xref>) has been a pioneering drug-design and molecular-viewing program and its successor <italic>Chimera</italic> (Petterson <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb38"> ▶</xref>) remains one of the most popular and powerful programs in the field. <italic>VMD</italic> (Humphrey <italic>et al.</italic>, 1996<xref ref-type="bibr" rid="bb24"> ▶</xref>) was created to visualize molecular dynamics and has developed as an extremely capable general display package for large structures. <italic>Swiss-PdbViewer</italic> (Guex &amp; Peitsch, 1997<xref ref-type="bibr" rid="bb22"> ▶</xref>) is a molecular-graphics program designed to work with the <italic>SWISS-MODEL</italic> server for comparative protein modelling. <italic>RasMol</italic> (Sayle &amp; Milner-White, 1995<xref ref-type="bibr" rid="bb41"> ▶</xref>; Bernstein, 2000<xref ref-type="bibr" rid="bb3"> ▶</xref>) employs efficient com­putational methods to achieve excellent performance and its command language was adopted by the popular viewer <italic>Jmol</italic> (D. Gezelter; <ext-link ext-link-type="uri" xlink:href="http://www.jmol.org">http://www.jmol.org</ext-link>). <italic>Chime</italic> (created by MDL Systems, now part of Symyx; <ext-link ext-link-type="uri" xlink:href="http://www.symyx.com/downloads/downloadable/">http://www.symyx.com/downloads/downloadable/</ext-link>) and <italic>Protein Explorer</italic> (Martz, 2002<xref ref-type="bibr" rid="bb34"> ▶</xref>) were developed as variants of <italic>RasMol</italic> to perform interactive molecular graphics within a web browser. <italic>AstexViewer</italic> (Hartshorn, 2002<xref ref-type="bibr" rid="bb23"> ▶</xref>) is another important example of a web-browser-based viewer. <italic>Cn</italic>3<italic>D</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/Structure/CN3D/cn3d.shtml">http://www.ncbi.nlm.nih.gov/Structure/CN3D/cn3d.shtml</ext-link>) is particularly well suited to the display of structural alignments of multiple proteins; it works with the NCBI’s MMDB and VAST databases of structures and alignments but not directly with PDB-format files. The SGC’s <italic>iSee</italic> (Abagyan <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb1"> ▶</xref>) program built upon Molsoft’s <italic>ICM-Browser</italic> technology provides a means of creating representations of chemical structure using a tight coupling of interactive molecular graphics, hypertext, tables <italic>etc</italic>. <italic>PyMOL</italic> (DeLano, 2002<xref ref-type="bibr" rid="bb10"> ▶</xref>) is one of the most widely used of the current generation of molecular-graphics systems, but there are many others including <italic>Qmol</italic> (Gans &amp; Shalloway, 2001<xref ref-type="bibr" rid="bb17"> ▶</xref>), <italic>YASARA</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.yasara.org">http://www.yasara.org</ext-link>) and <italic>CheVi</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.simbiosys.ca/chevi/index.html">http://www.simbiosys.ca/chevi/index.html</ext-link>).</p>
    <p>The main aim of the <italic>CCP</italic>4<italic>mg</italic> project is to make available a tool for the visualization of the static and dynamic features of macromolecular structures. The program provides tools for simply and rapidly creating complex single scenes and movies. Such tools include the automatic generation of multiple drawing styles to emphasize important structural information, the highlighting of equivalent structural features of different models by the use of structure-based and sequence-based alignment and drawing molecular surfaces over a whole structure or selected regions to focus on details of molecular-recognition sites. The prediction and visualization of quaternary structure and molecular interfaces is achieved through the use of <italic>PISA</italic> (Krissinel &amp; Henrick, 2005<xref ref-type="bibr" rid="bb28"> ▶</xref>, 2007<xref ref-type="bibr" rid="bb29"> ▶</xref>; Krissinel, 2010<xref ref-type="bibr" rid="bb27"> ▶</xref>). Electron density can be drawn in many styles and over selected subsets of atoms to highlight areas of interest. Other features include the drawing of textual labels and geometric shapes and the overlaying of two-dimensional images from files to further enhance scenes. Care has been taken to make the creation of movies in which the view is rotated, zoomed, panned <italic>etc</italic>. to show various aspects of the model as intuitive as possible. Moreover, movies can be generated from a series of coordinate files in order to highlight changes in molecular structure. <italic>CCP</italic>4<italic>mg</italic> has a built-in rendering module (the open-source RenderMan-compliant <italic>Pixie</italic> engine; <ext-link ext-link-type="uri" xlink:href="http://www.renderpixie.com/">http://www.renderpixie.com/</ext-link>) to produce high-quality images for publication; the renderer may also be used to create the individual frames of a movie.</p>
    <p><italic>CCP</italic>4<italic>mg</italic> is free software (LGPL; <ext-link ext-link-type="uri" xlink:href="http://www.gnu.org/licenses/lgpl.html">http://www.gnu.org/licenses/lgpl.html</ext-link>) and can be downloaded from the website <ext-link ext-link-type="uri" xlink:href="http://www.ccp4.ac.uk/MG/">http://www.ccp4.ac.uk/MG/</ext-link>, where detailed documentation is also provided. In addition, a set of tutorials providing a simple guide for the new user is available at <ext-link ext-link-type="uri" xlink:href="http://www.ccp4.ac.uk/MG/ccp4mg_help/tutorial/introduction.html">http://www.ccp4.ac.uk/MG/ccp4mg_help/tutorial/introduction.html</ext-link>.</p>
  </sec>
  <sec id="sec2">
    <label>2.</label>
    <title>Picture creation</title>
    <sec id="sec2.1">
      <label>2.1.</label>
      <title>Atomic model representation</title>
      <p><italic>CCP</italic>4<italic>mg</italic> can draw molecules in most commonly used styles, including ball and stick, simple lines, cylinders, space-filling spheres, ribbon cartoons for secondary structure and molecular surfaces. Other properties, for example hydrogen bonds, contacts and user-defined inter­atomic vectors, are depicted as independently defined objects. Solid representations such as surface and ribbons can be transparent, with user control of the extent of transparency.</p>
      <p>The user may colour the atoms by atom type, residue type, chain, position in chain or molecule, various physical properties or by flexible customized selections. Structures can be coloured by secondary-structure type or solvent accessibility; these properties are calculated within the program.</p>
      <p>Many different representations of many different selections of molecules can be displayed simultaneously to create complex scenes. The selections are not named in the same way as in, for example, <italic>PyMOL</italic> (DeLano, 2002<xref ref-type="bibr" rid="bb10"> ▶</xref>), but may be saved and later restored or applied to other models. There are three levels of selection.</p>
      <sec id="sec2.1.1">
        <label>2.1.1.</label>
        <title>Simple atom selections</title>
        <p>The <italic>CCP</italic>4<italic>mg</italic> interface consists of two windows (Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>). The main window contains the graphical display and a menu and toolbar for performing the most common tasks, such as file input and output.</p>
        <p>A second window provides the display table, which contains information about all the currently loaded data items such as PDB files and electron-density maps. For each data item there is a menu corresponding to the various representations derived from that item. Each display object in the table has three menu buttons controlling its key properties. For the molecular-display objects these properties are (i) the subset of atoms used, (ii) the colour scheme applied and (iii) the drawing style that has been chosen. Display objects can be easily added or deleted or the selection and the colour and drawing style can be edited to build scenes.</p>
      </sec>
      <sec id="sec2.1.2">
        <label>2.1.2.</label>
        <title>Advanced selection options</title>
        <p>The next level in sophistication is the ‘Selection browser’ widget which provides more powerful tools for editing complex definitions of subsets of atoms from the PDB files that have been loaded. Firstly, there is a tree pane, which allows the user to see and select from the molecular structure in terms of a tree of model components (peptide, nucleic acid, monomers, solvent), chains, residues and atoms. Secondly, additional widgets allow selection by criteria such as contact distance and atom and residue properties. As an example, the user can select all the amino acids in chain <italic>A</italic> and then use the neighbourhood pane to specify that only residues within 6 Å are required and finally use the residue-types pane to specify acidic residues.</p>
        <p>Internal to <italic>CCP</italic>4<italic>mg</italic> all selections are maintained as a string in a selection language; the user input to the various GUIs is converted to this selection string. The selection browser has a pane displaying the current selection command that the user can edit. Expert users may prefer the speed and flexibility of editing the selection string compared with changing the values of menus or checkboxes.</p>
        <p>Complex scenes are created by the use of multiple representations with different atom selections and drawing styles. For example, one can draw some amino-acid residues as cylinders and the rest as a ribbon, all ligands as cylinders, metal atoms as spheres and solvent, sulfates <italic>etc</italic>. as ball and stick. The scene may be enhanced by the addition of a particular set of hydrogen bonds, such as those in the vicinity of a binding site and by a molecular surface over some or all atoms.</p>
      </sec>
      <sec id="sec2.1.3">
        <label>2.1.3.</label>
        <title>The Picture wizard: automated picture styles</title>
        <p>The ‘Picture wizard’ enables the automatic creation of complex sets of selections and styles without user intervention. The wizard styles have been developed based on user input to generate informative representations relevant to the most common usages of molecular graphics. The view created may subsequently be fine-tuned by using the Selection browser and controlling drawing-style preferences. The Picture wizard is available in the file browser when the molecule is loaded and can subsequently be accessed from the display table while using the program (Fig. 2<xref ref-type="fig" rid="fig2"> ▶</xref>). The available picture styles are grouped into general schemes that include ‘bonds’, ‘ribbons’, ‘nucleic acid’, ‘ligand-binding site’, ‘interfaces’ and ‘surfaces’. A small cartoon illustrates each picture style. The power of the wizard comes from its automatic analysis of the composition of the structure so that protein, nucleic acid, ligands, binding sites, interfaces and solvent are identified heuristically and automatically and are displayed in an appropriate style. This system is not as automated as the maximally informative initial views of, for example, <italic>Chimera</italic> (Petterson <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb38"> ▶</xref>) and <italic>iSee</italic> (Abagyan <italic>et al.</italic>, 2006<xref ref-type="bibr" rid="bb1"> ▶</xref>), but may offer some an easier route into subsequent optimization.</p>
      </sec>
    </sec>
    <sec id="sec2.2">
      <label>2.2.</label>
      <title>Electron density</title>
      <p>Electron-density maps are displayed as isosurfaces with line chickenwire, cylinder chickenwire or solid surface styles; a ‘multi-chickenwire’ map display style has recently been added that draws multiple contour values simultaneously to create an enhanced solid appearance (Fig. 3<xref ref-type="fig" rid="fig3"> ▶</xref>). The map is represented internally as a ‘continuous’ crystal: the centre of the contoured volume adapts to always correspond to the centre of the current view. Molecules related to the PDB coordinates by crystallographic symmetry are generated on the fly by application of the unit-cell and symmetry operators of the map. The map may be clipped to a selected set of atoms to highlight features of particular interest within the structure.</p>
      <p>Much of the code to draw solid surface representations of electron density was donated by the <italic>Coot</italic> model-building project (Emsley &amp; Cowtan, 2004<xref ref-type="bibr" rid="bb12"> ▶</xref>; Emsley <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb13"> ▶</xref>).</p>
    </sec>
    <sec id="sec2.3">
      <label>2.3.</label>
      <title>Additional graphical objects: text annotations, overlays and vectors</title>
      <p>User-defined text annotations, which move with the structure as the view changes, can be attached to user-specified atoms in much the same way as the ‘Annotation’ feature in <italic>Cn</italic>3<italic>D</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/Structure/CN3D/cn3d.shtml">http://www.ncbi.nlm.nih.gov/Structure/CN3D/cn3d.shtml</ext-link>). In addition, a static text ‘Legend’ (any system font, bold, underlined or italic, with subscripts and superscripts and a choice of colour) can be added at a defined two-dimensional screen coordinate (Fig. 4<xref ref-type="fig" rid="fig4"> ▶</xref>). The facility for high-quality text minimizes the need to annotate images outside <italic>CCP</italic>4<italic>mg</italic>. Coupled with the facility for saving and restoring scenes, this makes editing images straightforward.</p>
      <p>Images can be overlayed on a scene in any common bitmap format or as a scalable vector graphic (SVG). In ‘Geometry’ mode clicking on atoms shows distances, angles and torsion angles. The picture created can be enhanced by the addition of ‘vectors’ which connect either a user-specified pair of atoms or user-specified Cartesian coordinates with a line or arrow and an optional text label.</p>
      <p>A recent feature allows the addition of arbitrary geometric primitives to the scene (polygons, lines, cylinders <italic>etc</italic>.) and text to enhance the information content of the structures.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <label>3.</label>
    <title>Analysis tools: surfaces, structural and sequence alignments</title>
    <sec id="sec3.1">
      <label>3.1.</label>
      <title>Surfaces</title>
      <p>Molecular surfaces (Lee &amp; Richards, 1971<xref ref-type="bibr" rid="bb32"> ▶</xref>; Connolly, 1983<xref ref-type="bibr" rid="bb7"> ▶</xref>) coloured by various physical properties, including electrostatic potential, are displayed using the <italic>CXXSurface</italic> toolkit (Gruber <italic>et al.</italic>, 2007<xref ref-type="bibr" rid="bb21"> ▶</xref>). These authors demonstrated the visualization of sequence conservation and hydrophobicity as examples of the importance of molecular surfaces in understanding the structure of biomolecules.</p>
      <p>The electrostatic potential is calculated by solving the Poisson–Boltzmann equation, <disp-formula id="fd1"><graphic xlink:href="d-67-00386-efd1"/></disp-formula>where ∊(<italic>r</italic>) is the relative permittivity at <italic>r</italic>, ρ(<italic>r</italic>) is the charge density arising from diffusable charges at <italic>r</italic> and κ<sub>0</sub> is the Debye–Hückel screening parameter. Gruber and coworkers implemented an iterative finite-difference approach to solving the problem, which uses a rapid FFT-based method to determine the protein interior; the charge distribution is smoothed within the initial potential map. The values of the potential at convergence are allocated to each of the vertices of the graphical triangles that define the molecular surface. <italic>CCP</italic>4<italic>mg</italic> displays surfaces in a range of styles: a solid surface with optional transparency, a mesh representation or as dots. Surfaces over complete models and subsets of atoms are possible.</p>
    </sec>
    <sec id="sec3.2">
      <label>3.2.</label>
      <title>Structure alignment</title>
      <p><italic>CCP</italic>4<italic>mg</italic> provides three methods for structure superposition: the secondary-structure matching (<italic>SSM</italic>) algorithm (Krissinel &amp; Hendrick, 2004<xref ref-type="bibr" rid="bb30"> ▶</xref>), close-residue matching and user-defined matching. The appropriate superposition transformation matrices can be applied to any electron-density maps associated with the superposed models.</p>
      <sec id="sec3.2.1">
        <label>3.2.1.</label>
        <title><italic>SSM</italic> 
               </title>
        <p><italic>SSM</italic> matches equivalent secondary-structure elements (SSEs) in pairs of structures. The equivalencies are determined to a first approximation by matching graphs built on a vectorial representation of the secondary-structure elements (Artymiuk <italic>et al.</italic>, 1989<xref ref-type="bibr" rid="bb2"> ▶</xref>). Equivalent SSEs are those that have a close relative orientation and separation in distance in both structures. This gives an approximate superposition that is used to provide an initial base for matching individual C<sup>α</sup> atoms. The match is then optimized using a function that balances the r.m.s.d. and the number of matched C<sup>α</sup> pairs. <italic>SSM</italic> is able to superpose both closely similar structures and those with more distant relations. <italic>SSM</italic> has been incorporated into <italic>CCP</italic>4<italic>mg</italic>, thus allowing the user to select the target molecules for multiple structure alignments and to specify the regions of the structures to be superposed.</p>
      </sec>
      <sec id="sec3.2.2">
        <label>3.2.2.</label>
        <title>Close-residue matching</title>
        <p>This enables locally optimized superposition after a global superposition by <italic>SSM</italic>. For example, the user can optimize the superposition of the residues forming a particular ligand-binding site.</p>
      </sec>
      <sec id="sec3.2.3">
        <label>3.2.3.</label>
        <title>User-defined matches</title>
        <p>This allows the user to specify equivalent individual residues or atoms by hand. There is a tool to automatically find equivalent atoms in similar residues or ligands. This is particularly useful when trying to overlay the relevant parts of non-identical ligands.</p>
      </sec>
    </sec>
    <sec id="sec3.3">
      <label>3.3.</label>
      <title>Sequence viewer</title>
      <p>Recent releases contain a protein-sequence viewer in which the user can highlight sections of the structure (Fig. 5<xref ref-type="fig" rid="fig5"> ▶</xref>). This can be performed with multiple sequences and the development of more advanced alignment tools is in hand which will provide more extensive functionality. For example, recent builds include the ability to load sequences and alignments in many formats, including <italic>Clustal</italic>, <italic>FASTA</italic>, <italic>GCG</italic>/<italic>MSF</italic> and <italic>PIR</italic>, and to generate a sequence alignment using the <italic>MUSCLE</italic> tool (Edgar, 2004<xref ref-type="bibr" rid="bb11"> ▶</xref>). Searching of databases for similar sequences to download and display any corresponding structures is also possible using the EBI/NCBI <italic>BLAST</italic> service (Johnson <italic>et al.</italic>, 2008<xref ref-type="bibr" rid="bb25"> ▶</xref>; McWilliam <italic>et al.</italic>, 2009<xref ref-type="bibr" rid="bb36"> ▶</xref>). The sequence viewer is a work in progress and does not yet provide the extensive functionalities of, for example, <italic>Multialign Viewer</italic> in <italic>Chimera</italic> (Petterson <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb38"> ▶</xref>).</p>
    </sec>
    <sec id="sec3.4">
      <label>3.4.</label>
      <title><italic>PISA</italic> 
            </title>
      <p><italic>PISA</italic> (<italic>Protein Interfaces, Surfaces and Assemblies</italic> service at the European Bioinformatics Institute; <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/msd-srv/prot_int/pistart.html">http://www.ebi.ac.uk/msd-srv/prot_int/pistart.html</ext-link>; Krissinel &amp; Henrick, 2005<xref ref-type="bibr" rid="bb28"> ▶</xref>, 2007<xref ref-type="bibr" rid="bb29"> ▶</xref>; Krissinel, 2010<xref ref-type="bibr" rid="bb27"> ▶</xref>) is a tool for the exploration of macromolecular (protein, DNA/RNA and ligand) interfaces, the prediction of probable quaternary structures (assemblies) and database searches for structurally similar interfaces and assemblies, as well as searches on various assembly and PDB-entry parameters.</p>
      <p><italic>PISA</italic> identifies the chemical monomers and the interfaces between them, including those generated by applying symmetry to the input coordinates. By evaluating the strength of interaction between the neighbouring monomers in a crystal, <italic>PISA</italic> predicts the most stable multimer likely to be the functional biological unit.</p>
      <p><italic>PISA</italic> is available as an EBI web service and also as a standalone program which has been incorporated into <italic>CCP</italic>4<italic>mg</italic> to enable molecular-graphics visualization of the results. The monomers present are listed and the user may click on them to create display objects in the graphics window and display table. Interfaces are listed and selecting one of them causes a molecular-surface object to be generated (Fig. 6<xref ref-type="fig" rid="fig6"> ▶</xref>); the user may, for example, choose to colour this by electrostatic potential.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <label>4.</label>
    <title>Publication- and presentation-quality images</title>
    <sec id="sec4.1">
      <label>4.1.</label>
      <title>Static views</title>
      <p><italic>CCP</italic>4<italic>mg</italic> offers two methods of outputting images. In the first method the pixel contents of the main OpenGL window are simply dumped to a bitmap file, while the second method is to use the included rendering program <italic>Pixie</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.renderpixie.com/">http://www.renderpixie.com/</ext-link>), which produces high-definition output and can optionally be used to generate effects such as shadows using ray tracing or ambient occlusion. The renderer is the recommended way of producing publication-quality images. The renderer input file, in Renderman Interface Bytestream (RIB) format (https://renderman.pixar.com/products/rispec/rispec_pdf/RISpec3_2.pdf), may be saved for use with external rendering programs. Outputting the scene in a format suitable for alternative external renderers or VRML, as is performed in programs such as <italic>Ribbons</italic> (Carson, 1997<xref ref-type="bibr" rid="bb4"> ▶</xref>) and <italic>RasMol</italic> (Sayle &amp; Milner-White, 1995<xref ref-type="bibr" rid="bb41"> ▶</xref>; Bernstein, 2000<xref ref-type="bibr" rid="bb3"> ▶</xref>), is a potential future development.</p>
      <p>Both the screen-dump and render methods allow the creation of stereo pairs and images with transparent backgrounds.</p>
    </sec>
    <sec id="sec4.2">
      <label>4.2.</label>
      <title>Movies</title>
      <p>To generate a movie, the user only needs to set up a few key scenes that are saved as frames in the Movie editor panel (Fig. 7<xref ref-type="fig" rid="fig7"> ▶</xref>). The program will interpolate between these frames either to show a preview of the potential movie or to create the movie. The user can choose the number of frames inserted between each key frame to control the speed of the movie and can specify the screen size, frame rate, movie format (animated GIF or MPEG) and quality. Very high quality movies can be created using the renderer to generate each frame. While the renderer is much slower than using simple screen-pixel dumps, it offers substantially enhanced capabilities, <italic>e.g.</italic> much finer interpolation between different opacities of multiple objects.</p>
      <p><italic>CCP</italic>4<italic>mg</italic> can import the trajectory files from morphing or trajectory calculations and the Movie editor will create movies from this input. All of the usual <italic>CCP</italic>4<italic>mg</italic> display features (for example, atom selections and surfaces) can be applied to the trajectory coordinates to create sophisticated movies. Future releases will enable the calculation of morphs internally and will generate series of coordinates corresponding to a vibrational normal-mode analysis.</p>
    </sec>
  </sec>
  <sec id="sec5">
    <label>5.</label>
    <title>New features in version 2</title>
    <p>In addition to several features described above, the move to a new programming toolkit (§<xref ref-type="sec" rid="sec6"/>6) has facilitated the development of a number of new features.</p>
    <sec id="sec5.1">
      <label>5.1.</label>
      <title>Toolbar and program-status history</title>
      <p>The program’s main window contains a toolbar upon which the user is able to place an icon for any of <italic>CCP</italic>4<italic>mg</italic>’s main actions. For instance, if the user is working on creating a movie the ‘Open movie’ task may be placed onto the toolbar, obviating the need to navigate through menus every time the program is launched. The toolbar by default contains some common actions, including clearing picked atom labels and navigating backwards and forwards through the new ‘history’ feature. <italic>CCP</italic>4<italic>mg</italic> saves the program status every time a significant change is made to the scene. This status specifies which files are loaded, which atoms are selected with what styles and colours, and the camera position and orientation. The user may navigate freely backwards and forwards through this status history.</p>
    </sec>
    <sec id="sec5.2">
      <label>5.2.</label>
      <title>Inbuilt help system</title>
      <p>The <italic>CCP</italic>4<italic>mg</italic> website (<ext-link ext-link-type="uri" xlink:href="http://www.ccp4.ac.uk/MG/">http://www.ccp4.ac.uk/MG/</ext-link>) has extensive HTML documentation and tutorials with help buttons throughout the program linking to the appropriate documentation. Version 2 uses the Qt Webkit tool to display help pages, replacing an earlier HTML browser that only worked in the Linux version.</p>
    </sec>
    <sec id="sec5.3">
      <label>5.3.</label>
      <title>Automatic updates</title>
      <p>Users can opt to have the program update itself by downloading a patch with the changes to the latest version. This provides a much smaller and faster download than the whole package and is very easy to use.</p>
      <p>Nightly (complete) builds of <italic>CCP</italic>4<italic>mg</italic> are available from <ext-link ext-link-type="uri" xlink:href="http://www.ysbl.york.ac.uk/~ccp4mg/nightly/">http://www.ysbl.york.ac.uk/~ccp4mg/nightly/</ext-link>.</p>
    </sec>
    <sec id="sec5.4">
      <label>5.4.</label>
      <title>Better usage of graphics hardware</title>
      <p>In addition to the hardware stereo capabilities in version 1, version 2 exploits the facilities of the Zalman ZM-220 series of monitors and can display side-by-side stereo pairs. Full-scene anti-aliasing is supported (and is the default) on all hardware and operating systems that support it. This includes most modern Macintosh, Microsoft Windows and Linux systems with discrete graphics adapters.</p>
      <p>The user can easily edit the lighting of the scene in a fully flexible manner. Some simple presets are also offered. When generating publication-quality images by rendering using ray tracing to generate shadows, the program will warn if the current lighting model is unlikely to create noticeable shadows.</p>
      <p>Full control of the depth-cue and clipping planes is provided.</p>
    </sec>
    <sec id="sec5.5">
      <label>5.5.</label>
      <title>Image rendering in batch mode</title>
      <p><italic>CCP</italic>4<italic>mg</italic> can run without a graphical display to render images of a scene specified as a <italic>CCP</italic>4<italic>mg</italic>-format picture-definition file, a language specification for which is available at <ext-link ext-link-type="uri" xlink:href="http://www.ccp4.ac.uk/MG/ccp4mg_help2/picture_definition.html">http://www.ccp4.ac.uk/MG/ccp4mg_help2/picture_definition.html</ext-link>. This, for example, allows <italic>CCP</italic>4<italic>mg</italic> to be placed at the end of a computational pipeline to generate pictures of the results or the rendering facility can be called from another molecular-graphics program. This facility is also useful for testing the non-GUI parts of the program. Such testing identified some serious bottlenecks which have subsequently been eliminated.</p>
      <p>The picture-definition language describes a single static scene comprehensively, but is not a dynamic scripting interface like those offered in <italic>Chime</italic> or <italic>RasMol</italic> (Sayle &amp; Milner-White, 1995<xref ref-type="bibr" rid="bb41"> ▶</xref>; Bernstein, 2000<xref ref-type="bibr" rid="bb3"> ▶</xref>).</p>
      <p>At present, the program will simply follow the set of commands specified on the command line and then exit. Future versions are planned to sit as a server listening for instructions.</p>
    </sec>
    <sec id="sec5.6">
      <label>5.6.</label>
      <title>Remote control</title>
      <p><italic>CCP</italic>4<italic>mg</italic> can be controlled to a limited extent by other programs. It is possible for other programs on either the local or a remote machine to move and orient the view and send files or request the opening of local files or to request the viewing of a whole scene. <italic>Coot</italic> (Emsley &amp; Cowtan, 2004<xref ref-type="bibr" rid="bb12"> ▶</xref>; Emsley <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb13"> ▶</xref>) is able to communicate with <italic>CCP</italic>4<italic>mg</italic> using the last of these methods. On systems with the appropriate software installed, <italic>CCP</italic>4<italic>mg</italic> may advertise its availability for such interaction using <italic>Zeroconf</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.zeroconf.org/">http://www.zeroconf.org/</ext-link>) or an equivalent system.</p>
      <p>The communication between programs is peformed with sockets. <italic>CCP</italic>4<italic>mg</italic> will open a socket on user request and listen for input in the background. Commands are sent as marked-up strings from client programs connected to <italic>CCP</italic>4<italic>mg</italic>’s socket. If these strings meet certain criteria then <italic>CCP</italic>4<italic>mg</italic> will interpret them as commands. For those wishing to see how this is achieved in detail, an example is distributed with the program.</p>
    </sec>
    <sec id="sec5.7">
      <label>5.7.</label>
      <title>Plug-in applications</title>
      <p>It is possible to implement additional functionality in <italic>CCP</italic>4<italic>mg</italic> in the form of plug-in applications. Since the main portion of the program is written in Python, this is very straightforward: one simply writes a Python program con­taining the plug-in initialization function and places it in the plug-ins directory. Although the entry point of the plug-in must be a Python file, the major functionality can be written in any programming language and can access the MMDB and Clipper libraries for coordinate and experimental data handling, respectively. The plug-in interface offers the ability to load custom data types and to declare methods for display-object generation and manipulation. Several of the current <italic>CCP</italic>4<italic>mg</italic> modules are implemented as such plug-ins; for example, the <italic>PISA</italic> interface, the renderer, the edit-lighting GUI, automatic updates, remote control, toolbar editing and the font browser are all implemented as plug-ins. Most new features of the program will be developed in this format. Similar ideas have previously been implemented in molecular graphics such as the core/extensions architecture of <italic>Chimera</italic> (Petterson <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb38"> ▶</xref>).</p>
      <p>The application-programming interface (API) still needs documentation, but the tools now exist for anyone to extend the capability of <italic>CCP</italic>4<italic>mg</italic>.</p>
    </sec>
    <sec id="sec5.8">
      <label>5.8.</label>
      <title>Single-window interface</title>
      <p>As of version 2.4.3, <italic>CCP</italic>4<italic>mg</italic> can operate within a single window which incorporates the display table, the graphics window and the sequence viewer (Fig. 5<xref ref-type="fig" rid="fig5"> ▶</xref>). This is not just to create a more modern look, but also to significantly enhance the program’s usability by not having multiple windows scattered across the computer screen which can confuse the user. This is an increasingly common feature of modern computer programs such as <italic>ICM Browser</italic>, a molecular-graphics system with an extremely clean single-windowed interface.</p>
    </sec>
  </sec>
  <sec id="sec6">
    <label>6.</label>
    <title>Design and implementation</title>
    <sec id="sec6.1">
      <label>6.1.</label>
      <title>The data-handling software libraries</title>
      <p>The core of <italic>CCP</italic>4<italic>mg</italic> is written in a combination of C++ and Python. C++ libraries handle the data and provide the computationally intensive tools for applications. Python is used to provide high-level program control and to implement the GUI; this area has undergone considerable change in version 2 and will be discussed at length in the next section.</p>
      <p><italic>CCP</italic>4<italic>mg</italic> uses the MMDB library developed by Eugene Krissinel for handling model data (Krissinel <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb31"> ▶</xref>). MMDB provides tools for handling PDB- and mmCIF-format files: reading and writing data, orthogonal–fractional coordinate transforms, generation of symmetry mates, editing the molecular structure plus some other higher level tasks.</p>
      <p>Crystallographic data are handled by the Clipper libraries (Cowtan, 2003<xref ref-type="bibr" rid="bb8"> ▶</xref>).</p>
      <p>The Python layer of the program communicates with the C++ libraries using the <italic>SWIG</italic> interface generator (<ext-link ext-link-type="uri" xlink:href="http://www.swig.org/">http://www.swig.org/</ext-link>).</p>
    </sec>
    <sec id="sec6.2">
      <label>6.2.</label>
      <title>Program control and the GUI</title>
      <p><italic>CCP</italic>4<italic>mg</italic> version 2 retains the features of version 1 and has many new features. The major change is the graphical user interface based on the Qt Application Framework (<ext-link ext-link-type="uri" xlink:href="http://qt.nokia.com/">http://qt.nokia.com/</ext-link>). Qt creates widgets with the correct look and feel for the underlying operating system, so the same program code creates a somewhat different user interface on Windows, Mac and Linux. Qt provides an extensive collection of C++ programming tools; besides the GUI tools, <italic>CCP</italic>4<italic>mg</italic> uses Qt for displaying SVG files, spawning threads and various graphical but non-UI tasks.</p>
      <p>Lengthy processes that would otherwise stall the GUI unacceptably (for example, downloading files and long calculations) are performed in a separate thread.</p>
      <p>Some GUI elements use the same definitions in Python as in version 1, but are now parsed to generate Qt instead of Tk widgets; other GUI elements have been written from scratch in Qt. In both approaches, all of the final GUI definitions are Python statements; thus, a Python-to-Qt (C++) bridge is required and is currently provided by the <italic>PyQt</italic> (<ext-link ext-link-type="uri" xlink:href="http://www.riverbankcomputing.co.uk/software/pyqt/intro">http://www.riverbankcomputing.co.uk/software/pyqt/intro</ext-link>) bindings package. The <italic>PySide</italic> bindings developed by Nokia will be considered as a replacement as soon as a stable version is released.</p>
    </sec>
  </sec>
  <sec id="sec7">
    <label>7.</label>
    <title>Summary and future plans</title>
    <p>We have created a much improved version of the <italic>CCP</italic>4 molecular-graphics program: <italic>CCP</italic>4<italic>mg</italic> now contains a com­prehensive set of tools for both automatic and very specific user-defined atom selections, the output image quality has been improved by the incorporation of a rendering module, interface and multimer analysis is possible using <italic>PISA</italic> and work has begun on sequence alignment and exploration features, and communication with the <italic>Coot</italic> model-building program has improved and will continue to do so.</p>
    <p>Future releases will include enhancements to the sequence viewer, including the ability to specify weighting to parts of the alignment, gap penalties <italic>etc</italic>. and the ability to change the style of the structure displayed when the user highlights residues in the sequence. Colouring the three-dimensional structure by sequence conservation will be enabled. Work on normal-mode visualization is in progress: a normal-mode program exists, a GUI needs to be written and we plan to visualize by creating animations for each mode and providing a ‘porcupine’ static representation mode. Polysaccharide cartoons and multiple bond displays (using information from the CCP4 monomer library) will be implemented.</p>
  </sec>
</body>
<back>
  <ack>
    <p>SM and EP are funded by the <funding-source>Science and Technology Facilities Council</funding-source> through CCP4.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bb1">
      <mixed-citation publication-type="other">Abagyan, R., Lee, W. H., Raush, E., Budagyan, L., Totrov, M., Sundstrom, M. &amp; Marsden, B. D. (2006). <italic>Trends Biochem. Sci.</italic> 
               <bold>31</bold>, 76–78.</mixed-citation>
    </ref>
    <ref id="bb2">
      <mixed-citation publication-type="other">Artymiuk, P. J., Rice, D. W., Mitchell, M. E. &amp; Willett, P. (1989). <italic>J. Inform. Sci.</italic> 
               <bold>15</bold>, 287–298.</mixed-citation>
    </ref>
    <ref id="bb3">
      <mixed-citation publication-type="other">Bernstein, H. J. (2000). <italic>Trends Biochem. Sci.</italic> 
               <bold>25</bold>, 453–455.</mixed-citation>
    </ref>
    <ref id="bb4">
      <mixed-citation publication-type="other">Carson, M. (1997). <italic>Methods Enzymol.</italic> 
               <bold>277</bold>, 493–505.</mixed-citation>
    </ref>
    <ref id="bb5">
      <mixed-citation publication-type="other">Chan, S. <italic>et al.</italic> (2004). <italic>J. Mol. Biol.</italic> 
               <bold>341</bold>, 503–517.</mixed-citation>
    </ref>
    <ref id="bb6">
      <mixed-citation publication-type="other">Christopher, J. A., Swanson, R. &amp; Baldwin, T. O. (1996). <italic>Comput. Chem.</italic> 
               <bold>20</bold>, 339–345.</mixed-citation>
    </ref>
    <ref id="bb7">
      <mixed-citation publication-type="other">Connolly, M. L. (1983). <italic>Science</italic>, <bold>221</bold>, 709–713.</mixed-citation>
    </ref>
    <ref id="bb8">
      <mixed-citation publication-type="other">Cowtan, K. (2003). <italic>IUCr Comput. Commun. Newsl.</italic> 
               <bold>2</bold>, 4–9.</mixed-citation>
    </ref>
    <ref id="bb9">
      <mixed-citation publication-type="other">Dayringer, H. E., Tramontano, A., Sprang, S. R. &amp; Fletterick, R. J. (1986). <italic>J. Mol. Graph.</italic> 
               <bold>4</bold>, 82–87.</mixed-citation>
    </ref>
    <ref id="bb10">
      <mixed-citation publication-type="other">DeLano, W. L. (2002). <italic>PyMOL.</italic> http://www.pymol.org.</mixed-citation>
    </ref>
    <ref id="bb11">
      <mixed-citation publication-type="other">Edgar, R. C. (2004). <italic>Nucleic Acids Res.</italic> 
               <bold>32</bold>, 1792–1797.</mixed-citation>
    </ref>
    <ref id="bb12">
      <mixed-citation publication-type="other">Emsley, P. &amp; Cowtan, K. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2126–2132.</mixed-citation>
    </ref>
    <ref id="bb13">
      <mixed-citation publication-type="other">Emsley, P., Lohkamp, B., Scott, W. G. &amp; Cowtan, K. (2010). <italic>Acta Cryst.</italic> D<bold>66</bold>, 486–501.</mixed-citation>
    </ref>
    <ref id="bb14">
      <mixed-citation publication-type="other">Esnouf, R. M. (1999<italic>a</italic>). <italic>J. Mol. Graph.</italic> 
               <bold>15</bold>, 132–134.</mixed-citation>
    </ref>
    <ref id="bb15">
      <mixed-citation publication-type="other">Esnouf, R. M. (1999<italic>b</italic>). <italic>Acta Cryst.</italic> D<bold>55</bold>, 938–940.</mixed-citation>
    </ref>
    <ref id="bb16">
      <mixed-citation publication-type="other">Ferrin, T. E., Huang, C. C., Jarvis, L. E. &amp; Langridge, R. (1988). <italic>J. Mol. Graph.</italic> 
               <bold>6</bold>, 13–27.</mixed-citation>
    </ref>
    <ref id="bb17">
      <mixed-citation publication-type="other">Gans, J. &amp; Shalloway, D. (2001). <italic>J. Mol. Graph. Model.</italic> 
               <bold>19</bold>, 557–559.</mixed-citation>
    </ref>
    <ref id="bb18">
      <mixed-citation publication-type="other">García-Nafría, J., Burchell, L., Takezawa, M., Rzechorzek, N. J., Fogg, M. J. &amp; Wilson, K. S. (2010). <italic>Acta Cryst.</italic> D<bold>66</bold>, 953–961.</mixed-citation>
    </ref>
    <ref id="bb19">
      <mixed-citation publication-type="other">González, A., Larsson, G., Persson, R. &amp; Cedergren-Zeppezauer, E. (2001). <italic>Acta Cryst.</italic> D<bold>57</bold>, 767–774.</mixed-citation>
    </ref>
    <ref id="bb20">
      <mixed-citation publication-type="other">Green, T. J. &amp; Luo, M. (2009). <italic>Proc. Natl Acad. Sci. USA</italic>, <bold>106</bold>, 11713–11718.</mixed-citation>
    </ref>
    <ref id="bb21">
      <mixed-citation publication-type="other">Gruber, J., Zawaira, A., Saunders, R., Barrett, C. P. &amp; Noble, M. E. M. (2007). <italic>Acta Cryst.</italic> D<bold>63</bold>, 50–57.</mixed-citation>
    </ref>
    <ref id="bb22">
      <mixed-citation publication-type="other">Guex, N. &amp; Peitsch, M. C. (1997). <italic>Electrophoresis</italic>, <bold>18</bold>, 2714–2723.</mixed-citation>
    </ref>
    <ref id="bb23">
      <mixed-citation publication-type="other">Hartshorn, M. J. (2002). <italic>J. Comput. Aided Mol. Des.</italic> 
               <bold>16</bold>, 871–881.</mixed-citation>
    </ref>
    <ref id="bb24">
      <mixed-citation publication-type="other">Humphrey, W., Dalke, A. &amp; Schulten, K. (1996). <italic>J. Mol. Graph.</italic> 
               <bold>14</bold>, 33–38.</mixed-citation>
    </ref>
    <ref id="bb25">
      <mixed-citation publication-type="other">Johnson, M., Zaretskaya, I., Raytselis, Y., Merezhuk, Y., McGinnis, S. &amp; Madden, T. L. (2008). <italic>Nucleic Acids Res.</italic> 
               <bold>36</bold>, W5–W9.</mixed-citation>
    </ref>
    <ref id="bb26">
      <mixed-citation publication-type="other">Kraulis, P. J. (1991). <italic>J. Appl. Cryst.</italic> 
               <bold>24</bold>, 946–950.</mixed-citation>
    </ref>
    <ref id="bb27">
      <mixed-citation publication-type="other">Krissinel, E. (2010). <italic>J. Comput. Chem.</italic> 
               <bold>31</bold>, 133–143.</mixed-citation>
    </ref>
    <ref id="bb30">
      <mixed-citation publication-type="other">Krissinel, E. &amp; Henrick, K. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2256–2268.</mixed-citation>
    </ref>
    <ref id="bb28">
      <mixed-citation publication-type="other">Krissinel, E. &amp; Henrick, K. (2005). <italic>CompLife 2005</italic>, edited by M. R. Berthold, R. Glen, K. Diederichs, O. Kohlbacher &amp; I. Fischer, pp. 163–174. Berlin/Heidelberg: Springer-Verlag.</mixed-citation>
    </ref>
    <ref id="bb29">
      <mixed-citation publication-type="other">Krissinel, E. &amp; Henrick, K. (2007). <italic>J. Mol. Biol.</italic> 
               <bold>372</bold>, 774–797.</mixed-citation>
    </ref>
    <ref id="bb31">
      <mixed-citation publication-type="other">Krissinel, E. B., Winn, M. D., Ballard, C. C., Ashton, A. W., Patel, P., Potterton, E. A., McNicholas, S. J., Cowtan, K. D. &amp; Emsley, P. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2250–2255.</mixed-citation>
    </ref>
    <ref id="bb32">
      <mixed-citation publication-type="other">Lee, B. &amp; Richards, F. M. (1971). <italic>J. Mol. Biol.</italic> 
               <bold>55</bold>, 379–400.</mixed-citation>
    </ref>
    <ref id="bb33">
      <mixed-citation publication-type="other">Lesk, A. M., Bernstein, H. J. &amp; Bernstein, F. C. (2008). <italic>Computational Structural Biology: Methods and Applications</italic>, edited by T. Schwede &amp; M. Peitsch, pp. 729–770. Singapore: World Scientific Publishing Company.</mixed-citation>
    </ref>
    <ref id="bb34">
      <mixed-citation publication-type="other">Martz, E. (2002). <italic>Trends Biochem. Sci.</italic> 
               <bold>27</bold>, 107–109.</mixed-citation>
    </ref>
    <ref id="bb36">
      <mixed-citation publication-type="other">McWilliam, H., Valentin, F., Goujon, M., Li, W., Narayanasamy, M., Martin, J., Miyar, T. &amp; Lopez, R. (2009). <italic>Nucleic Acids Res.</italic> 
               <bold>37</bold>, W6–W10.</mixed-citation>
    </ref>
    <ref id="bb35">
      <mixed-citation publication-type="other">Merritt, E. A. &amp; Bacon, D. J. (1997). <italic>Methods Enzymol.</italic> 
               <bold>277</bold>, 505–524.</mixed-citation>
    </ref>
    <ref id="bb38">
      <mixed-citation publication-type="other">Petterson, E. F., Goddard, T. D., Huang, C. C., Couch, G. S., Greenblatt, D. M., Meng, E. C. &amp; Ferrin, T. E. (2004). <italic>J. Comput. Chem.</italic> 
               <bold>25</bold>, 1605–1612.</mixed-citation>
    </ref>
    <ref id="bb37">
      <mixed-citation publication-type="other">Potterton, E., McNicholas, S., Krissinel, E., Cowtan, K. &amp; Noble, M. (2002). <italic>Acta Cryst.</italic> D<bold>58</bold>, 1955–1957.</mixed-citation>
    </ref>
    <ref id="bb39">
      <mixed-citation publication-type="other">Potterton, L., McNicholas, S., Krissinel, E., Gruber, J., Cowtan, K., Emsley, P., Murshudov, G. N., Cohen, S., Perrakis, A. &amp; Noble, M. (2004). <italic>Acta Cryst.</italic> D<bold>60</bold>, 2288–2294.</mixed-citation>
    </ref>
    <ref id="bb41">
      <mixed-citation publication-type="other">Sayle, R. &amp; Milner-White, E. J. (1995). <italic>Trends Biochem. Sci.</italic> 
               <bold>20</bold>, 374–376.</mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" position="float">
    <label>Figure 1</label>
    <caption>
      <p>The <italic>CCP</italic>4<italic>mg</italic> main window and display table. Scene automatically created with Picture wizard style ‘ligand binding site: site and broken ribbons’ for PDB entry <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1snf">1snf</ext-link> (Chan <italic>et al.</italic>, 2004<xref ref-type="bibr" rid="bb5"> ▶</xref>).</p>
    </caption>
    <graphic xlink:href="d-67-00386-fig1"/>
  </fig>
  <fig id="fig2" position="float">
    <label>Figure 2</label>
    <caption>
      <p>The Picture wizard. The selected style automatically created the scene shown in Fig. 1<xref ref-type="fig" rid="fig1"> ▶</xref>.</p>
    </caption>
    <graphic xlink:href="d-67-00386-fig2"/>
  </fig>
  <fig id="fig3" position="float">
    <label>Figure 3</label>
    <caption>
      <p>The electron-density styles possible in <italic>CCP</italic>4<italic>mg</italic>: (<italic>a</italic>) chickenwire, (<italic>b</italic>) chickenwire cylinders, (<italic>c</italic>) dots, (<italic>d</italic>) solid and (<italic>e</italic>) solid with transparency.</p>
    </caption>
    <graphic xlink:href="d-67-00386-fig3"/>
  </fig>
  <fig id="fig4" position="float">
    <label>Figure 4</label>
    <caption>
      <p>The text-display capabilities of <italic>CCP</italic>4<italic>mg</italic>. Three atoms are labelled with the default format: chain/residue number/atom name. The ligand has an annotation attached. All these rotate as the view is changed. In contrast, the ‘Legend’ is in a static user-defined screen position.</p>
    </caption>
    <graphic xlink:href="d-67-00386-fig4"/>
  </fig>
  <fig id="fig5" position="float">
    <label>Figure 5</label>
    <caption>
      <p>Structure and sequence alignment. Chain <italic>A</italic> of PDB entry <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=1eu5">1eu5</ext-link> (brown; González <italic>et al.</italic>, 2001<xref ref-type="bibr" rid="bb19"> ▶</xref>) superimposed on chain <italic>B</italic> of <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2xce">2xce</ext-link> (pink; García-Nafría <italic>et al.</italic>, 2010<xref ref-type="bibr" rid="bb18"> ▶</xref>) using <italic>SSM</italic>. The nucleotide analogue dUpNpp bound to <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=2xce">2xce</ext-link> is drawn as cylinders. The sequences, aligned using <italic>MUSCLE</italic>, are displayed in the ‘Sequence viewer’ window coloured by conservation. The residues highlighted in the sequence viewer appear as stick representations in the graphics window. This figure also demonstrates the new single-window appearance of <italic>CCP</italic>4<italic>mg</italic>, with the Sequence viewer, Display Table and Clip and Fog widgets docked in the main window.</p>
    </caption>
    <graphic xlink:href="d-67-00386-fig5"/>
  </fig>
  <fig id="fig6" position="float">
    <label>Figure 6</label>
    <caption>
      <p>Assembly prediction by <italic>PISA</italic>. (<italic>a</italic>) The original model (PDB entry <ext-link ext-link-type="uri" xlink:href="http://scripts.iucr.org/cgi-bin/cr.cgi?rm=pdb&amp;pdbId=3hhz">3hhz</ext-link>; Green &amp; Luo, 2009<xref ref-type="bibr" rid="bb20"> ▶</xref>). (<italic>b</italic>) The dimer predicted by <italic>PISA</italic>.</p>
    </caption>
    <graphic xlink:href="d-67-00386-fig6"/>
  </fig>
  <fig id="fig7" position="float">
    <label>Figure 7</label>
    <caption>
      <p>The Movie editor dialogue. The above sequence rotates an expanded view of the molecule around the <italic>y</italic> axis for 2 s, takes 2 s to zoom into a close-up view of a ligand and then rocks for 2 s with the ligand at the screen centre.</p>
    </caption>
    <graphic xlink:href="d-67-00386-fig7"/>
  </fig>
</floats-group>
